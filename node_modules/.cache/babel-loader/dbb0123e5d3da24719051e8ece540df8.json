{"ast":null,"code":"/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.7.1 (2021-03-17)\n */\n(function () {\n  'use strict';\n\n  var Cell = function (initial) {\n    var value = initial;\n\n    var get = function () {\n      return value;\n    };\n\n    var set = function (v) {\n      value = v;\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n  var hasProPlugin = function (editor) {\n    if (editor.hasPlugin('powerpaste', true)) {\n      if (typeof window.console !== 'undefined' && window.console.log) {\n        window.console.log('PowerPaste is incompatible with Paste plugin! Remove \\'paste\\' from the \\'plugins\\' option.');\n      }\n\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var get = function (clipboard, quirks) {\n    return {\n      clipboard: clipboard,\n      quirks: quirks\n    };\n  };\n\n  var noop = function () {};\n\n  var constant = function (value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n\n  var none = function () {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var eq = function (o) {\n      return o.isNone();\n    };\n\n    var call = function (thunk) {\n      return thunk();\n    };\n\n    var id = function (n) {\n      return n;\n    };\n\n    var me = {\n      fold: function (n, _s) {\n        return n();\n      },\n      is: never,\n      isSome: never,\n      isNone: always,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function (msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: constant(null),\n      getOrUndefined: constant(undefined),\n      or: id,\n      orThunk: call,\n      map: none,\n      each: noop,\n      bind: none,\n      exists: never,\n      forall: always,\n      filter: none,\n      equals: eq,\n      equals_: eq,\n      toArray: function () {\n        return [];\n      },\n      toString: constant('none()')\n    };\n    return me;\n  }();\n\n  var some = function (a) {\n    var constant_a = constant(a);\n\n    var self = function () {\n      return me;\n    };\n\n    var bind = function (f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function (n, s) {\n        return s(a);\n      },\n      is: function (v) {\n        return a === v;\n      },\n      isSome: always,\n      isNone: never,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: function (f) {\n        return some(f(a));\n      },\n      each: function (f) {\n        f(a);\n      },\n      bind: bind,\n      exists: bind,\n      forall: bind,\n      filter: function (f) {\n        return f(a) ? me : NONE;\n      },\n      toArray: function () {\n        return [a];\n      },\n      toString: function () {\n        return 'some(' + a + ')';\n      },\n      equals: function (o) {\n        return o.is(a);\n      },\n      equals_: function (o, elementEq) {\n        return o.fold(never, function (b) {\n          return elementEq(a, b);\n        });\n      }\n    };\n    return me;\n  };\n\n  var from = function (value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Optional = {\n    some: some,\n    none: none,\n    from: from\n  };\n\n  var isSimpleType = function (type) {\n    return function (value) {\n      return typeof value === type;\n    };\n  };\n\n  var isNullable = function (a) {\n    return a === null || a === undefined;\n  };\n\n  var isNonNullable = function (a) {\n    return !isNullable(a);\n  };\n\n  var isFunction = isSimpleType('function');\n  var nativeSlice = Array.prototype.slice;\n\n  var exists = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var map = function (xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var each = function (xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var filter = function (xs, pred) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        r.push(x);\n      }\n    }\n\n    return r;\n  };\n\n  var foldl = function (xs, f, acc) {\n    each(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n    return nativeSlice.call(x);\n  };\n\n  var value = function () {\n    var subject = Cell(Optional.none());\n\n    var clear = function () {\n      return subject.set(Optional.none());\n    };\n\n    var set = function (s) {\n      return subject.set(Optional.some(s));\n    };\n\n    var isSet = function () {\n      return subject.get().isSome();\n    };\n\n    var on = function (f) {\n      return subject.get().each(f);\n    };\n\n    return {\n      clear: clear,\n      set: set,\n      isSet: isSet,\n      on: on\n    };\n  };\n\n  var checkRange = function (str, substr, start) {\n    return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n  };\n\n  var startsWith = function (str, prefix) {\n    return checkRange(str, prefix, 0);\n  };\n\n  var endsWith = function (str, suffix) {\n    return checkRange(str, suffix, str.length - suffix.length);\n  };\n\n  var repeat = function (s, count) {\n    return count <= 0 ? '' : new Array(count + 1).join(s);\n  };\n\n  var global$1 = tinymce.util.Tools.resolve('tinymce.Env');\n  var global$2 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n  var global$3 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n  var global$4 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n  var firePastePreProcess = function (editor, html, internal, isWordHtml) {\n    return editor.fire('PastePreProcess', {\n      content: html,\n      internal: internal,\n      wordContent: isWordHtml\n    });\n  };\n\n  var firePastePostProcess = function (editor, node, internal, isWordHtml) {\n    return editor.fire('PastePostProcess', {\n      node: node,\n      internal: internal,\n      wordContent: isWordHtml\n    });\n  };\n\n  var firePastePlainTextToggle = function (editor, state) {\n    return editor.fire('PastePlainTextToggle', {\n      state: state\n    });\n  };\n\n  var firePaste = function (editor, ieFake) {\n    return editor.fire('paste', {\n      ieFake: ieFake\n    });\n  };\n\n  var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n  var shouldBlockDrop = function (editor) {\n    return editor.getParam('paste_block_drop', false);\n  };\n\n  var shouldPasteDataImages = function (editor) {\n    return editor.getParam('paste_data_images', false);\n  };\n\n  var shouldFilterDrop = function (editor) {\n    return editor.getParam('paste_filter_drop', true);\n  };\n\n  var getPreProcess = function (editor) {\n    return editor.getParam('paste_preprocess');\n  };\n\n  var getPostProcess = function (editor) {\n    return editor.getParam('paste_postprocess');\n  };\n\n  var getWebkitStyles = function (editor) {\n    return editor.getParam('paste_webkit_styles');\n  };\n\n  var shouldRemoveWebKitStyles = function (editor) {\n    return editor.getParam('paste_remove_styles_if_webkit', true);\n  };\n\n  var shouldMergeFormats = function (editor) {\n    return editor.getParam('paste_merge_formats', true);\n  };\n\n  var isSmartPasteEnabled = function (editor) {\n    return editor.getParam('smart_paste', true);\n  };\n\n  var isPasteAsTextEnabled = function (editor) {\n    return editor.getParam('paste_as_text', false);\n  };\n\n  var getRetainStyleProps = function (editor) {\n    return editor.getParam('paste_retain_style_properties');\n  };\n\n  var getWordValidElements = function (editor) {\n    var defaultValidElements = '-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,' + '-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,' + 'td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody';\n    return editor.getParam('paste_word_valid_elements', defaultValidElements);\n  };\n\n  var shouldConvertWordFakeLists = function (editor) {\n    return editor.getParam('paste_convert_word_fake_lists', true);\n  };\n\n  var shouldUseDefaultFilters = function (editor) {\n    return editor.getParam('paste_enable_default_filters', true);\n  };\n\n  var getValidate = function (editor) {\n    return editor.getParam('validate');\n  };\n\n  var getAllowHtmlDataUrls = function (editor) {\n    return editor.getParam('allow_html_data_urls', false, 'boolean');\n  };\n\n  var getPasteDataImages = function (editor) {\n    return editor.getParam('paste_data_images', false, 'boolean');\n  };\n\n  var getImagesDataImgFilter = function (editor) {\n    return editor.getParam('images_dataimg_filter');\n  };\n\n  var getImagesReuseFilename = function (editor) {\n    return editor.getParam('images_reuse_filename');\n  };\n\n  var getForcedRootBlock = function (editor) {\n    return editor.getParam('forced_root_block');\n  };\n\n  var getForcedRootBlockAttrs = function (editor) {\n    return editor.getParam('forced_root_block_attrs');\n  };\n\n  var getTabSpaces = function (editor) {\n    return editor.getParam('paste_tab_spaces', 4, 'number');\n  };\n\n  var getAllowedImageFileTypes = function (editor) {\n    var defaultImageFileTypes = 'jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp';\n    return global$5.explode(editor.getParam('images_file_types', defaultImageFileTypes, 'string'));\n  };\n\n  var internalMimeType = 'x-tinymce/html';\n  var internalMark = '<!-- ' + internalMimeType + ' -->';\n\n  var mark = function (html) {\n    return internalMark + html;\n  };\n\n  var unmark = function (html) {\n    return html.replace(internalMark, '');\n  };\n\n  var isMarked = function (html) {\n    return html.indexOf(internalMark) !== -1;\n  };\n\n  var internalHtmlMime = function () {\n    return internalMimeType;\n  };\n\n  var global$6 = tinymce.util.Tools.resolve('tinymce.html.Entities');\n\n  var isPlainText = function (text) {\n    return !/<(?:\\/?(?!(?:div|p|br|span)>)\\w+|(?:(?!(?:span style=\"white-space:\\s?pre;?\">)|br\\s?\\/>))\\w+\\s[^>]+)>/i.test(text);\n  };\n\n  var toBRs = function (text) {\n    return text.replace(/\\r?\\n/g, '<br>');\n  };\n\n  var openContainer = function (rootTag, rootAttrs) {\n    var key;\n    var attrs = [];\n    var tag = '<' + rootTag;\n\n    if (typeof rootAttrs === 'object') {\n      for (key in rootAttrs) {\n        if (rootAttrs.hasOwnProperty(key)) {\n          attrs.push(key + '=\"' + global$6.encodeAllRaw(rootAttrs[key]) + '\"');\n        }\n      }\n\n      if (attrs.length) {\n        tag += ' ' + attrs.join(' ');\n      }\n    }\n\n    return tag + '>';\n  };\n\n  var toBlockElements = function (text, rootTag, rootAttrs) {\n    var blocks = text.split(/\\n\\n/);\n    var tagOpen = openContainer(rootTag, rootAttrs);\n    var tagClose = '</' + rootTag + '>';\n    var paragraphs = global$5.map(blocks, function (p) {\n      return p.split(/\\n/).join('<br />');\n    });\n\n    var stitch = function (p) {\n      return tagOpen + p + tagClose;\n    };\n\n    return paragraphs.length === 1 ? paragraphs[0] : global$5.map(paragraphs, stitch).join('');\n  };\n\n  var convert = function (text, rootTag, rootAttrs) {\n    return rootTag ? toBlockElements(text, rootTag === true ? 'p' : rootTag, rootAttrs) : toBRs(text);\n  };\n\n  var global$7 = tinymce.util.Tools.resolve('tinymce.html.DomParser');\n  var global$8 = tinymce.util.Tools.resolve('tinymce.html.Serializer');\n  var nbsp = '\\xA0';\n  var global$9 = tinymce.util.Tools.resolve('tinymce.html.Node');\n  var global$a = tinymce.util.Tools.resolve('tinymce.html.Schema');\n\n  var filter$1 = function (content, items) {\n    global$5.each(items, function (v) {\n      if (v.constructor === RegExp) {\n        content = content.replace(v, '');\n      } else {\n        content = content.replace(v[0], v[1]);\n      }\n    });\n    return content;\n  };\n\n  var innerText = function (html) {\n    var schema = global$a();\n    var domParser = global$7({}, schema);\n    var text = '';\n    var shortEndedElements = schema.getShortEndedElements();\n    var ignoreElements = global$5.makeMap('script noscript style textarea video audio iframe object', ' ');\n    var blockElements = schema.getBlockElements();\n\n    var walk = function (node) {\n      var name = node.name,\n          currentNode = node;\n\n      if (name === 'br') {\n        text += '\\n';\n        return;\n      }\n\n      if (name === 'wbr') {\n        return;\n      }\n\n      if (shortEndedElements[name]) {\n        text += ' ';\n      }\n\n      if (ignoreElements[name]) {\n        text += ' ';\n        return;\n      }\n\n      if (node.type === 3) {\n        text += node.value;\n      }\n\n      if (!node.shortEnded) {\n        if (node = node.firstChild) {\n          do {\n            walk(node);\n          } while (node = node.next);\n        }\n      }\n\n      if (blockElements[name] && currentNode.next) {\n        text += '\\n';\n\n        if (name === 'p') {\n          text += '\\n';\n        }\n      }\n    };\n\n    html = filter$1(html, [/<!\\[[^\\]]+\\]>/g]);\n    walk(domParser.parse(html));\n    return text;\n  };\n\n  var trimHtml = function (html) {\n    var trimSpaces = function (all, s1, s2) {\n      if (!s1 && !s2) {\n        return ' ';\n      }\n\n      return nbsp;\n    };\n\n    html = filter$1(html, [/^[\\s\\S]*<body[^>]*>\\s*|\\s*<\\/body[^>]*>[\\s\\S]*$/ig, /<!--StartFragment-->|<!--EndFragment-->/g, [/( ?)<span class=\"Apple-converted-space\">\\u00a0<\\/span>( ?)/g, trimSpaces], /<br class=\"Apple-interchange-newline\">/g, /<br>$/i]);\n    return html;\n  };\n\n  var createIdGenerator = function (prefix) {\n    var count = 0;\n    return function () {\n      return prefix + count++;\n    };\n  };\n\n  var getImageMimeType = function (ext) {\n    var lowerExt = ext.toLowerCase();\n    var mimeOverrides = {\n      jpg: 'jpeg',\n      jpe: 'jpeg',\n      jfi: 'jpeg',\n      jif: 'jpeg',\n      jfif: 'jpeg',\n      pjpeg: 'jpeg',\n      pjp: 'jpeg',\n      svg: 'svg+xml'\n    };\n    return global$5.hasOwn(mimeOverrides, lowerExt) ? 'image/' + mimeOverrides[lowerExt] : 'image/' + lowerExt;\n  };\n\n  var isWordContent = function (content) {\n    return /<font face=\"Times New Roman\"|class=\"?Mso|style=\"[^\"]*\\bmso-|style='[^']*\\bmso-|w:WordDocument/i.test(content) || /class=\"OutlineElement/.test(content) || /id=\"?docs\\-internal\\-guid\\-/.test(content);\n  };\n\n  var isNumericList = function (text) {\n    var found;\n    var patterns = [/^[IVXLMCD]{1,2}\\.[ \\u00a0]/, /^[ivxlmcd]{1,2}\\.[ \\u00a0]/, /^[a-z]{1,2}[\\.\\)][ \\u00a0]/, /^[A-Z]{1,2}[\\.\\)][ \\u00a0]/, /^[0-9]+\\.[ \\u00a0]/, /^[\\u3007\\u4e00\\u4e8c\\u4e09\\u56db\\u4e94\\u516d\\u4e03\\u516b\\u4e5d]+\\.[ \\u00a0]/, /^[\\u58f1\\u5f10\\u53c2\\u56db\\u4f0d\\u516d\\u4e03\\u516b\\u4e5d\\u62fe]+\\.[ \\u00a0]/];\n    text = text.replace(/^[\\u00a0 ]+/, '');\n    global$5.each(patterns, function (pattern) {\n      if (pattern.test(text)) {\n        found = true;\n        return false;\n      }\n    });\n    return found;\n  };\n\n  var isBulletList = function (text) {\n    return /^[\\s\\u00a0]*[\\u2022\\u00b7\\u00a7\\u25CF]\\s*/.test(text);\n  };\n\n  var convertFakeListsToProperLists = function (node) {\n    var currentListNode,\n        prevListNode,\n        lastLevel = 1;\n\n    var getText = function (node) {\n      var txt = '';\n\n      if (node.type === 3) {\n        return node.value;\n      }\n\n      if (node = node.firstChild) {\n        do {\n          txt += getText(node);\n        } while (node = node.next);\n      }\n\n      return txt;\n    };\n\n    var trimListStart = function (node, regExp) {\n      if (node.type === 3) {\n        if (regExp.test(node.value)) {\n          node.value = node.value.replace(regExp, '');\n          return false;\n        }\n      }\n\n      if (node = node.firstChild) {\n        do {\n          if (!trimListStart(node, regExp)) {\n            return false;\n          }\n        } while (node = node.next);\n      }\n\n      return true;\n    };\n\n    var removeIgnoredNodes = function (node) {\n      if (node._listIgnore) {\n        node.remove();\n        return;\n      }\n\n      if (node = node.firstChild) {\n        do {\n          removeIgnoredNodes(node);\n        } while (node = node.next);\n      }\n    };\n\n    var convertParagraphToLi = function (paragraphNode, listName, start) {\n      var level = paragraphNode._listLevel || lastLevel;\n\n      if (level !== lastLevel) {\n        if (level < lastLevel) {\n          if (currentListNode) {\n            currentListNode = currentListNode.parent.parent;\n          }\n        } else {\n          prevListNode = currentListNode;\n          currentListNode = null;\n        }\n      }\n\n      if (!currentListNode || currentListNode.name !== listName) {\n        prevListNode = prevListNode || currentListNode;\n        currentListNode = new global$9(listName, 1);\n\n        if (start > 1) {\n          currentListNode.attr('start', '' + start);\n        }\n\n        paragraphNode.wrap(currentListNode);\n      } else {\n        currentListNode.append(paragraphNode);\n      }\n\n      paragraphNode.name = 'li';\n\n      if (level > lastLevel && prevListNode) {\n        prevListNode.lastChild.append(currentListNode);\n      }\n\n      lastLevel = level;\n      removeIgnoredNodes(paragraphNode);\n      trimListStart(paragraphNode, /^\\u00a0+/);\n      trimListStart(paragraphNode, /^\\s*([\\u2022\\u00b7\\u00a7\\u25CF]|\\w+\\.)/);\n      trimListStart(paragraphNode, /^\\u00a0+/);\n    };\n\n    var elements = [];\n    var child = node.firstChild;\n\n    while (typeof child !== 'undefined' && child !== null) {\n      elements.push(child);\n      child = child.walk();\n\n      if (child !== null) {\n        while (typeof child !== 'undefined' && child.parent !== node) {\n          child = child.walk();\n        }\n      }\n    }\n\n    for (var i = 0; i < elements.length; i++) {\n      node = elements[i];\n\n      if (node.name === 'p' && node.firstChild) {\n        var nodeText = getText(node);\n\n        if (isBulletList(nodeText)) {\n          convertParagraphToLi(node, 'ul');\n          continue;\n        }\n\n        if (isNumericList(nodeText)) {\n          var matches = /([0-9]+)\\./.exec(nodeText);\n          var start = 1;\n\n          if (matches) {\n            start = parseInt(matches[1], 10);\n          }\n\n          convertParagraphToLi(node, 'ol', start);\n          continue;\n        }\n\n        if (node._listLevel) {\n          convertParagraphToLi(node, 'ul', 1);\n          continue;\n        }\n\n        currentListNode = null;\n      } else {\n        prevListNode = currentListNode;\n        currentListNode = null;\n      }\n    }\n  };\n\n  var filterStyles = function (editor, validStyles, node, styleValue) {\n    var outputStyles = {},\n        matches;\n    var styles = editor.dom.parseStyle(styleValue);\n    global$5.each(styles, function (value, name) {\n      switch (name) {\n        case 'mso-list':\n          matches = /\\w+ \\w+([0-9]+)/i.exec(styleValue);\n\n          if (matches) {\n            node._listLevel = parseInt(matches[1], 10);\n          }\n\n          if (/Ignore/i.test(value) && node.firstChild) {\n            node._listIgnore = true;\n            node.firstChild._listIgnore = true;\n          }\n\n          break;\n\n        case 'horiz-align':\n          name = 'text-align';\n          break;\n\n        case 'vert-align':\n          name = 'vertical-align';\n          break;\n\n        case 'font-color':\n        case 'mso-foreground':\n          name = 'color';\n          break;\n\n        case 'mso-background':\n        case 'mso-highlight':\n          name = 'background';\n          break;\n\n        case 'font-weight':\n        case 'font-style':\n          if (value !== 'normal') {\n            outputStyles[name] = value;\n          }\n\n          return;\n\n        case 'mso-element':\n          if (/^(comment|comment-list)$/i.test(value)) {\n            node.remove();\n            return;\n          }\n\n          break;\n      }\n\n      if (name.indexOf('mso-comment') === 0) {\n        node.remove();\n        return;\n      }\n\n      if (name.indexOf('mso-') === 0) {\n        return;\n      }\n\n      if (getRetainStyleProps(editor) === 'all' || validStyles && validStyles[name]) {\n        outputStyles[name] = value;\n      }\n    });\n\n    if (/(bold)/i.test(outputStyles['font-weight'])) {\n      delete outputStyles['font-weight'];\n      node.wrap(new global$9('b', 1));\n    }\n\n    if (/(italic)/i.test(outputStyles['font-style'])) {\n      delete outputStyles['font-style'];\n      node.wrap(new global$9('i', 1));\n    }\n\n    outputStyles = editor.dom.serializeStyle(outputStyles, node.name);\n\n    if (outputStyles) {\n      return outputStyles;\n    }\n\n    return null;\n  };\n\n  var filterWordContent = function (editor, content) {\n    var validStyles;\n    var retainStyleProperties = getRetainStyleProps(editor);\n\n    if (retainStyleProperties) {\n      validStyles = global$5.makeMap(retainStyleProperties.split(/[, ]/));\n    }\n\n    content = filter$1(content, [/<br class=\"?Apple-interchange-newline\"?>/gi, /<b[^>]+id=\"?docs-internal-[^>]*>/gi, /<!--[\\s\\S]+?-->/gi, /<(!|script[^>]*>.*?<\\/script(?=[>\\s])|\\/?(\\?xml(:\\w+)?|img|meta|link|style|\\w:\\w+)(?=[\\s\\/>]))[^>]*>/gi, [/<(\\/?)s>/gi, '<$1strike>'], [/&nbsp;/gi, nbsp], [/<span\\s+style\\s*=\\s*\"\\s*mso-spacerun\\s*:\\s*yes\\s*;?\\s*\"\\s*>([\\s\\u00a0]*)<\\/span>/gi, function (str, spaces) {\n      return spaces.length > 0 ? spaces.replace(/./, ' ').slice(Math.floor(spaces.length / 2)).split('').join(nbsp) : '';\n    }]]);\n    var validElements = getWordValidElements(editor);\n    var schema = global$a({\n      valid_elements: validElements,\n      valid_children: '-li[p]'\n    });\n    global$5.each(schema.elements, function (rule) {\n      if (!rule.attributes.class) {\n        rule.attributes.class = {};\n        rule.attributesOrder.push('class');\n      }\n\n      if (!rule.attributes.style) {\n        rule.attributes.style = {};\n        rule.attributesOrder.push('style');\n      }\n    });\n    var domParser = global$7({}, schema);\n    domParser.addAttributeFilter('style', function (nodes) {\n      var i = nodes.length,\n          node;\n\n      while (i--) {\n        node = nodes[i];\n        node.attr('style', filterStyles(editor, validStyles, node, node.attr('style')));\n\n        if (node.name === 'span' && node.parent && !node.attributes.length) {\n          node.unwrap();\n        }\n      }\n    });\n    domParser.addAttributeFilter('class', function (nodes) {\n      var i = nodes.length,\n          node,\n          className;\n\n      while (i--) {\n        node = nodes[i];\n        className = node.attr('class');\n\n        if (/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(className)) {\n          node.remove();\n        }\n\n        node.attr('class', null);\n      }\n    });\n    domParser.addNodeFilter('del', function (nodes) {\n      var i = nodes.length;\n\n      while (i--) {\n        nodes[i].remove();\n      }\n    });\n    domParser.addNodeFilter('a', function (nodes) {\n      var i = nodes.length,\n          node,\n          href,\n          name;\n\n      while (i--) {\n        node = nodes[i];\n        href = node.attr('href');\n        name = node.attr('name');\n\n        if (href && href.indexOf('#_msocom_') !== -1) {\n          node.remove();\n          continue;\n        }\n\n        if (href && href.indexOf('file://') === 0) {\n          href = href.split('#')[1];\n\n          if (href) {\n            href = '#' + href;\n          }\n        }\n\n        if (!href && !name) {\n          node.unwrap();\n        } else {\n          if (name && !/^_?(?:toc|edn|ftn)/i.test(name)) {\n            node.unwrap();\n            continue;\n          }\n\n          node.attr({\n            href: href,\n            name: name\n          });\n        }\n      }\n    });\n    var rootNode = domParser.parse(content);\n\n    if (shouldConvertWordFakeLists(editor)) {\n      convertFakeListsToProperLists(rootNode);\n    }\n\n    content = global$8({\n      validate: getValidate(editor)\n    }, schema).serialize(rootNode);\n    return content;\n  };\n\n  var preProcess = function (editor, content) {\n    return shouldUseDefaultFilters(editor) ? filterWordContent(editor, content) : content;\n  };\n\n  var preProcess$1 = function (editor, html) {\n    var parser = global$7({}, editor.schema);\n    parser.addNodeFilter('meta', function (nodes) {\n      global$5.each(nodes, function (node) {\n        node.remove();\n      });\n    });\n    var fragment = parser.parse(html, {\n      forced_root_block: false,\n      isRootContent: true\n    });\n    return global$8({\n      validate: getValidate(editor)\n    }, editor.schema).serialize(fragment);\n  };\n\n  var processResult = function (content, cancelled) {\n    return {\n      content: content,\n      cancelled: cancelled\n    };\n  };\n\n  var postProcessFilter = function (editor, html, internal, isWordHtml) {\n    var tempBody = editor.dom.create('div', {\n      style: 'display:none'\n    }, html);\n    var postProcessArgs = firePastePostProcess(editor, tempBody, internal, isWordHtml);\n    return processResult(postProcessArgs.node.innerHTML, postProcessArgs.isDefaultPrevented());\n  };\n\n  var filterContent = function (editor, content, internal, isWordHtml) {\n    var preProcessArgs = firePastePreProcess(editor, content, internal, isWordHtml);\n    var filteredContent = preProcess$1(editor, preProcessArgs.content);\n\n    if (editor.hasEventListeners('PastePostProcess') && !preProcessArgs.isDefaultPrevented()) {\n      return postProcessFilter(editor, filteredContent, internal, isWordHtml);\n    } else {\n      return processResult(filteredContent, preProcessArgs.isDefaultPrevented());\n    }\n  };\n\n  var process = function (editor, html, internal) {\n    var isWordHtml = isWordContent(html);\n    var content = isWordHtml ? preProcess(editor, html) : html;\n    return filterContent(editor, content, internal, isWordHtml);\n  };\n\n  var pasteHtml = function (editor, html) {\n    editor.insertContent(html, {\n      merge: shouldMergeFormats(editor),\n      paste: true\n    });\n    return true;\n  };\n\n  var isAbsoluteUrl = function (url) {\n    return /^https?:\\/\\/[\\w\\?\\-\\/+=.&%@~#]+$/i.test(url);\n  };\n\n  var isImageUrl = function (editor, url) {\n    return isAbsoluteUrl(url) && exists(getAllowedImageFileTypes(editor), function (type) {\n      return endsWith(url.toLowerCase(), '.' + type.toLowerCase());\n    });\n  };\n\n  var createImage = function (editor, url, pasteHtmlFn) {\n    editor.undoManager.extra(function () {\n      pasteHtmlFn(editor, url);\n    }, function () {\n      editor.insertContent('<img src=\"' + url + '\">');\n    });\n    return true;\n  };\n\n  var createLink = function (editor, url, pasteHtmlFn) {\n    editor.undoManager.extra(function () {\n      pasteHtmlFn(editor, url);\n    }, function () {\n      editor.execCommand('mceInsertLink', false, url);\n    });\n    return true;\n  };\n\n  var linkSelection = function (editor, html, pasteHtmlFn) {\n    return editor.selection.isCollapsed() === false && isAbsoluteUrl(html) ? createLink(editor, html, pasteHtmlFn) : false;\n  };\n\n  var insertImage = function (editor, html, pasteHtmlFn) {\n    return isImageUrl(editor, html) ? createImage(editor, html, pasteHtmlFn) : false;\n  };\n\n  var smartInsertContent = function (editor, html) {\n    global$5.each([linkSelection, insertImage, pasteHtml], function (action) {\n      return action(editor, html, pasteHtml) !== true;\n    });\n  };\n\n  var insertContent = function (editor, html, pasteAsText) {\n    if (pasteAsText || isSmartPasteEnabled(editor) === false) {\n      pasteHtml(editor, html);\n    } else {\n      smartInsertContent(editor, html);\n    }\n  };\n\n  var isCollapsibleWhitespace = function (c) {\n    return ' \\f\\t\\x0B'.indexOf(c) !== -1;\n  };\n\n  var isNewLineChar = function (c) {\n    return c === '\\n' || c === '\\r';\n  };\n\n  var isNewline = function (text, idx) {\n    return idx < text.length && idx >= 0 ? isNewLineChar(text[idx]) : false;\n  };\n\n  var normalizeWhitespace = function (editor, text) {\n    var tabSpace = repeat(' ', getTabSpaces(editor));\n    var normalizedText = text.replace(/\\t/g, tabSpace);\n    var result = foldl(normalizedText, function (acc, c) {\n      if (isCollapsibleWhitespace(c) || c === nbsp) {\n        if (acc.pcIsSpace || acc.str === '' || acc.str.length === normalizedText.length - 1 || isNewline(normalizedText, acc.str.length + 1)) {\n          return {\n            pcIsSpace: false,\n            str: acc.str + nbsp\n          };\n        } else {\n          return {\n            pcIsSpace: true,\n            str: acc.str + ' '\n          };\n        }\n      } else {\n        return {\n          pcIsSpace: isNewLineChar(c),\n          str: acc.str + c\n        };\n      }\n    }, {\n      pcIsSpace: false,\n      str: ''\n    });\n    return result.str;\n  };\n\n  var doPaste = function (editor, content, internal, pasteAsText) {\n    var args = process(editor, content, internal);\n\n    if (args.cancelled === false) {\n      insertContent(editor, args.content, pasteAsText);\n    }\n  };\n\n  var pasteHtml$1 = function (editor, html, internalFlag) {\n    var internal = internalFlag ? internalFlag : isMarked(html);\n    doPaste(editor, unmark(html), internal, false);\n  };\n\n  var pasteText = function (editor, text) {\n    var encodedText = editor.dom.encode(text).replace(/\\r\\n/g, '\\n');\n    var normalizedText = normalizeWhitespace(editor, encodedText);\n    var html = convert(normalizedText, getForcedRootBlock(editor), getForcedRootBlockAttrs(editor));\n    doPaste(editor, html, false, true);\n  };\n\n  var getDataTransferItems = function (dataTransfer) {\n    var items = {};\n    var mceInternalUrlPrefix = 'data:text/mce-internal,';\n\n    if (dataTransfer) {\n      if (dataTransfer.getData) {\n        var legacyText = dataTransfer.getData('Text');\n\n        if (legacyText && legacyText.length > 0) {\n          if (legacyText.indexOf(mceInternalUrlPrefix) === -1) {\n            items['text/plain'] = legacyText;\n          }\n        }\n      }\n\n      if (dataTransfer.types) {\n        for (var i = 0; i < dataTransfer.types.length; i++) {\n          var contentType = dataTransfer.types[i];\n\n          try {\n            items[contentType] = dataTransfer.getData(contentType);\n          } catch (ex) {\n            items[contentType] = '';\n          }\n        }\n      }\n    }\n\n    return items;\n  };\n\n  var getClipboardContent = function (editor, clipboardEvent) {\n    return getDataTransferItems(clipboardEvent.clipboardData || editor.getDoc().dataTransfer);\n  };\n\n  var hasContentType = function (clipboardContent, mimeType) {\n    return mimeType in clipboardContent && clipboardContent[mimeType].length > 0;\n  };\n\n  var hasHtmlOrText = function (content) {\n    return hasContentType(content, 'text/html') || hasContentType(content, 'text/plain');\n  };\n\n  var parseDataUri = function (uri) {\n    var matches = /data:([^;]+);base64,([a-z0-9\\+\\/=]+)/i.exec(uri);\n\n    if (matches) {\n      return {\n        type: matches[1],\n        data: decodeURIComponent(matches[2])\n      };\n    } else {\n      return {\n        type: null,\n        data: null\n      };\n    }\n  };\n\n  var isValidDataUriImage = function (editor, imgElm) {\n    var filter = getImagesDataImgFilter(editor);\n    return filter ? filter(imgElm) : true;\n  };\n\n  var extractFilename = function (editor, str) {\n    var m = str.match(/([\\s\\S]+?)(?:\\.[a-z0-9.]+)$/i);\n    return isNonNullable(m) ? editor.dom.encode(m[1]) : null;\n  };\n\n  var uniqueId = createIdGenerator('mceclip');\n\n  var pasteImage = function (editor, imageItem) {\n    var _a = parseDataUri(imageItem.uri),\n        base64 = _a.data,\n        type = _a.type;\n\n    var id = uniqueId();\n    var file = imageItem.blob;\n    var img = new Image();\n    img.src = imageItem.uri;\n\n    if (isValidDataUriImage(editor, img)) {\n      var blobCache = editor.editorUpload.blobCache;\n      var blobInfo = void 0;\n      var existingBlobInfo = blobCache.getByData(base64, type);\n\n      if (!existingBlobInfo) {\n        var useFileName = getImagesReuseFilename(editor) && isNonNullable(file.name);\n        var name_1 = useFileName ? extractFilename(editor, file.name) : id;\n        var filename = useFileName ? file.name : undefined;\n        blobInfo = blobCache.create(id, file, base64, name_1, filename);\n        blobCache.add(blobInfo);\n      } else {\n        blobInfo = existingBlobInfo;\n      }\n\n      pasteHtml$1(editor, '<img src=\"' + blobInfo.blobUri() + '\">', false);\n    } else {\n      pasteHtml$1(editor, '<img src=\"' + imageItem.uri + '\">', false);\n    }\n  };\n\n  var isClipboardEvent = function (event) {\n    return event.type === 'paste';\n  };\n\n  var isDataTransferItem = function (item) {\n    return isNonNullable(item.getAsFile);\n  };\n\n  var readFilesAsDataUris = function (items) {\n    return global$3.all(map(items, function (item) {\n      return new global$3(function (resolve) {\n        var blob = isDataTransferItem(item) ? item.getAsFile() : item;\n        var reader = new window.FileReader();\n\n        reader.onload = function () {\n          resolve({\n            blob: blob,\n            uri: reader.result\n          });\n        };\n\n        reader.readAsDataURL(blob);\n      });\n    }));\n  };\n\n  var isImage = function (editor) {\n    var allowedExtensions = getAllowedImageFileTypes(editor);\n    return function (file) {\n      return startsWith(file.type, 'image/') && exists(allowedExtensions, function (extension) {\n        return getImageMimeType(extension) === file.type;\n      });\n    };\n  };\n\n  var getImagesFromDataTransfer = function (editor, dataTransfer) {\n    var items = dataTransfer.items ? map(from$1(dataTransfer.items), function (item) {\n      return item.getAsFile();\n    }) : [];\n    var files = dataTransfer.files ? from$1(dataTransfer.files) : [];\n    return filter(items.length > 0 ? items : files, isImage(editor));\n  };\n\n  var pasteImageData = function (editor, e, rng) {\n    var dataTransfer = isClipboardEvent(e) ? e.clipboardData : e.dataTransfer;\n\n    if (getPasteDataImages(editor) && dataTransfer) {\n      var images = getImagesFromDataTransfer(editor, dataTransfer);\n\n      if (images.length > 0) {\n        e.preventDefault();\n        readFilesAsDataUris(images).then(function (fileResults) {\n          if (rng) {\n            editor.selection.setRng(rng);\n          }\n\n          each(fileResults, function (result) {\n            pasteImage(editor, result);\n          });\n        });\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var isBrokenAndroidClipboardEvent = function (e) {\n    var clipboardData = e.clipboardData;\n    return navigator.userAgent.indexOf('Android') !== -1 && clipboardData && clipboardData.items && clipboardData.items.length === 0;\n  };\n\n  var isKeyboardPasteEvent = function (e) {\n    return global$4.metaKeyPressed(e) && e.keyCode === 86 || e.shiftKey && e.keyCode === 45;\n  };\n\n  var registerEventHandlers = function (editor, pasteBin, pasteFormat) {\n    var keyboardPasteEvent = value();\n    var keyboardPastePressed = value();\n    var keyboardPastePlainTextState;\n    editor.on('keyup', keyboardPastePressed.clear);\n    editor.on('keydown', function (e) {\n      var removePasteBinOnKeyUp = function (e) {\n        if (isKeyboardPasteEvent(e) && !e.isDefaultPrevented()) {\n          pasteBin.remove();\n        }\n      };\n\n      if (isKeyboardPasteEvent(e) && !e.isDefaultPrevented()) {\n        keyboardPastePlainTextState = e.shiftKey && e.keyCode === 86;\n\n        if (keyboardPastePlainTextState && global$1.webkit && navigator.userAgent.indexOf('Version/') !== -1) {\n          return;\n        }\n\n        e.stopImmediatePropagation();\n        keyboardPasteEvent.set(e);\n        keyboardPastePressed.set(true);\n\n        if (global$1.ie && keyboardPastePlainTextState) {\n          e.preventDefault();\n          firePaste(editor, true);\n          return;\n        }\n\n        pasteBin.remove();\n        pasteBin.create();\n        editor.once('keyup', removePasteBinOnKeyUp);\n        editor.once('paste', function () {\n          editor.off('keyup', removePasteBinOnKeyUp);\n        });\n      }\n    });\n\n    var insertClipboardContent = function (editor, clipboardContent, isKeyBoardPaste, plainTextMode, internal) {\n      var content;\n\n      if (hasContentType(clipboardContent, 'text/html')) {\n        content = clipboardContent['text/html'];\n      } else {\n        content = pasteBin.getHtml();\n        internal = internal ? internal : isMarked(content);\n\n        if (pasteBin.isDefaultContent(content)) {\n          plainTextMode = true;\n        }\n      }\n\n      content = trimHtml(content);\n      pasteBin.remove();\n      var isPlainTextHtml = internal === false && isPlainText(content);\n      var isImage = isImageUrl(editor, content);\n\n      if (!content.length || isPlainTextHtml && !isImage) {\n        plainTextMode = true;\n      }\n\n      if (plainTextMode || isImage) {\n        if (hasContentType(clipboardContent, 'text/plain') && isPlainTextHtml) {\n          content = clipboardContent['text/plain'];\n        } else {\n          content = innerText(content);\n        }\n      }\n\n      if (pasteBin.isDefaultContent(content)) {\n        if (!isKeyBoardPaste) {\n          editor.windowManager.alert('Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.');\n        }\n\n        return;\n      }\n\n      if (plainTextMode) {\n        pasteText(editor, content);\n      } else {\n        pasteHtml$1(editor, content, internal);\n      }\n    };\n\n    var getLastRng = function () {\n      return pasteBin.getLastRng() || editor.selection.getRng();\n    };\n\n    editor.on('paste', function (e) {\n      var isKeyboardPaste = keyboardPasteEvent.isSet() || keyboardPastePressed.isSet();\n\n      if (isKeyboardPaste) {\n        keyboardPasteEvent.clear();\n      }\n\n      var clipboardContent = getClipboardContent(editor, e);\n      var plainTextMode = pasteFormat.get() === 'text' || keyboardPastePlainTextState;\n      var internal = hasContentType(clipboardContent, internalHtmlMime());\n      keyboardPastePlainTextState = false;\n\n      if (e.isDefaultPrevented() || isBrokenAndroidClipboardEvent(e)) {\n        pasteBin.remove();\n        return;\n      }\n\n      if (!hasHtmlOrText(clipboardContent) && pasteImageData(editor, e, getLastRng())) {\n        pasteBin.remove();\n        return;\n      }\n\n      if (!isKeyboardPaste) {\n        e.preventDefault();\n      }\n\n      if (global$1.ie && (!isKeyboardPaste || e.ieFake) && !hasContentType(clipboardContent, 'text/html')) {\n        pasteBin.create();\n        editor.dom.bind(pasteBin.getEl(), 'paste', function (e) {\n          e.stopPropagation();\n        });\n        editor.getDoc().execCommand('Paste', false, null);\n        clipboardContent['text/html'] = pasteBin.getHtml();\n      }\n\n      if (hasContentType(clipboardContent, 'text/html')) {\n        e.preventDefault();\n\n        if (!internal) {\n          internal = isMarked(clipboardContent['text/html']);\n        }\n\n        insertClipboardContent(editor, clipboardContent, isKeyboardPaste, plainTextMode, internal);\n      } else {\n        global$2.setEditorTimeout(editor, function () {\n          insertClipboardContent(editor, clipboardContent, isKeyboardPaste, plainTextMode, internal);\n        }, 0);\n      }\n    });\n  };\n\n  var registerEventsAndFilters = function (editor, pasteBin, pasteFormat) {\n    registerEventHandlers(editor, pasteBin, pasteFormat);\n    var src;\n    editor.parser.addNodeFilter('img', function (nodes, name, args) {\n      var isPasteInsert = function (args) {\n        return args.data && args.data.paste === true;\n      };\n\n      var remove = function (node) {\n        if (!node.attr('data-mce-object') && src !== global$1.transparentSrc) {\n          node.remove();\n        }\n      };\n\n      var isWebKitFakeUrl = function (src) {\n        return src.indexOf('webkit-fake-url') === 0;\n      };\n\n      var isDataUri = function (src) {\n        return src.indexOf('data:') === 0;\n      };\n\n      if (!getPasteDataImages(editor) && isPasteInsert(args)) {\n        var i = nodes.length;\n\n        while (i--) {\n          src = nodes[i].attr('src');\n\n          if (!src) {\n            continue;\n          }\n\n          if (isWebKitFakeUrl(src)) {\n            remove(nodes[i]);\n          } else if (!getAllowHtmlDataUrls(editor) && isDataUri(src)) {\n            remove(nodes[i]);\n          }\n        }\n      }\n    });\n  };\n\n  var getPasteBinParent = function (editor) {\n    return global$1.ie && editor.inline ? document.body : editor.getBody();\n  };\n\n  var isExternalPasteBin = function (editor) {\n    return getPasteBinParent(editor) !== editor.getBody();\n  };\n\n  var delegatePasteEvents = function (editor, pasteBinElm, pasteBinDefaultContent) {\n    if (isExternalPasteBin(editor)) {\n      editor.dom.bind(pasteBinElm, 'paste keyup', function (_e) {\n        if (!isDefault(editor, pasteBinDefaultContent)) {\n          editor.fire('paste');\n        }\n      });\n    }\n  };\n\n  var create = function (editor, lastRngCell, pasteBinDefaultContent) {\n    var dom = editor.dom,\n        body = editor.getBody();\n    lastRngCell.set(editor.selection.getRng());\n    var pasteBinElm = editor.dom.add(getPasteBinParent(editor), 'div', {\n      'id': 'mcepastebin',\n      'class': 'mce-pastebin',\n      'contentEditable': true,\n      'data-mce-bogus': 'all',\n      'style': 'position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0'\n    }, pasteBinDefaultContent);\n\n    if (global$1.ie || global$1.gecko) {\n      dom.setStyle(pasteBinElm, 'left', dom.getStyle(body, 'direction', true) === 'rtl' ? 65535 : -65535);\n    }\n\n    dom.bind(pasteBinElm, 'beforedeactivate focusin focusout', function (e) {\n      e.stopPropagation();\n    });\n    delegatePasteEvents(editor, pasteBinElm, pasteBinDefaultContent);\n    pasteBinElm.focus();\n    editor.selection.select(pasteBinElm, true);\n  };\n\n  var remove = function (editor, lastRngCell) {\n    if (getEl(editor)) {\n      var pasteBinClone = void 0;\n      var lastRng = lastRngCell.get();\n\n      while (pasteBinClone = editor.dom.get('mcepastebin')) {\n        editor.dom.remove(pasteBinClone);\n        editor.dom.unbind(pasteBinClone);\n      }\n\n      if (lastRng) {\n        editor.selection.setRng(lastRng);\n      }\n    }\n\n    lastRngCell.set(null);\n  };\n\n  var getEl = function (editor) {\n    return editor.dom.get('mcepastebin');\n  };\n\n  var getHtml = function (editor) {\n    var copyAndRemove = function (toElm, fromElm) {\n      toElm.appendChild(fromElm);\n      editor.dom.remove(fromElm, true);\n    };\n\n    var pasteBinClones = global$5.grep(getPasteBinParent(editor).childNodes, function (elm) {\n      return elm.id === 'mcepastebin';\n    });\n    var pasteBinElm = pasteBinClones.shift();\n    global$5.each(pasteBinClones, function (pasteBinClone) {\n      copyAndRemove(pasteBinElm, pasteBinClone);\n    });\n    var dirtyWrappers = editor.dom.select('div[id=mcepastebin]', pasteBinElm);\n\n    for (var i = dirtyWrappers.length - 1; i >= 0; i--) {\n      var cleanWrapper = editor.dom.create('div');\n      pasteBinElm.insertBefore(cleanWrapper, dirtyWrappers[i]);\n      copyAndRemove(cleanWrapper, dirtyWrappers[i]);\n    }\n\n    return pasteBinElm ? pasteBinElm.innerHTML : '';\n  };\n\n  var getLastRng = function (lastRng) {\n    return lastRng.get();\n  };\n\n  var isDefaultContent = function (pasteBinDefaultContent, content) {\n    return content === pasteBinDefaultContent;\n  };\n\n  var isPasteBin = function (elm) {\n    return elm && elm.id === 'mcepastebin';\n  };\n\n  var isDefault = function (editor, pasteBinDefaultContent) {\n    var pasteBinElm = getEl(editor);\n    return isPasteBin(pasteBinElm) && isDefaultContent(pasteBinDefaultContent, pasteBinElm.innerHTML);\n  };\n\n  var PasteBin = function (editor) {\n    var lastRng = Cell(null);\n    var pasteBinDefaultContent = '%MCEPASTEBIN%';\n    return {\n      create: function () {\n        return create(editor, lastRng, pasteBinDefaultContent);\n      },\n      remove: function () {\n        return remove(editor, lastRng);\n      },\n      getEl: function () {\n        return getEl(editor);\n      },\n      getHtml: function () {\n        return getHtml(editor);\n      },\n      getLastRng: function () {\n        return getLastRng(lastRng);\n      },\n      isDefault: function () {\n        return isDefault(editor, pasteBinDefaultContent);\n      },\n      isDefaultContent: function (content) {\n        return isDefaultContent(pasteBinDefaultContent, content);\n      }\n    };\n  };\n\n  var Clipboard = function (editor, pasteFormat) {\n    var pasteBin = PasteBin(editor);\n    editor.on('PreInit', function () {\n      return registerEventsAndFilters(editor, pasteBin, pasteFormat);\n    });\n    return {\n      pasteFormat: pasteFormat,\n      pasteHtml: function (html, internalFlag) {\n        return pasteHtml$1(editor, html, internalFlag);\n      },\n      pasteText: function (text) {\n        return pasteText(editor, text);\n      },\n      pasteImageData: function (e, rng) {\n        return pasteImageData(editor, e, rng);\n      },\n      getDataTransferItems: getDataTransferItems,\n      hasHtmlOrText: hasHtmlOrText,\n      hasContentType: hasContentType\n    };\n  };\n\n  var togglePlainTextPaste = function (editor, clipboard) {\n    if (clipboard.pasteFormat.get() === 'text') {\n      clipboard.pasteFormat.set('html');\n      firePastePlainTextToggle(editor, false);\n    } else {\n      clipboard.pasteFormat.set('text');\n      firePastePlainTextToggle(editor, true);\n    }\n\n    editor.focus();\n  };\n\n  var register = function (editor, clipboard) {\n    editor.addCommand('mceTogglePlainTextPaste', function () {\n      togglePlainTextPaste(editor, clipboard);\n    });\n    editor.addCommand('mceInsertClipboardContent', function (ui, value) {\n      if (value.content) {\n        clipboard.pasteHtml(value.content, value.internal);\n      }\n\n      if (value.text) {\n        clipboard.pasteText(value.text);\n      }\n    });\n  };\n\n  var hasWorkingClipboardApi = function (clipboardData) {\n    return global$1.iOS === false && typeof (clipboardData === null || clipboardData === void 0 ? void 0 : clipboardData.setData) === 'function';\n  };\n\n  var setHtml5Clipboard = function (clipboardData, html, text) {\n    if (hasWorkingClipboardApi(clipboardData)) {\n      try {\n        clipboardData.clearData();\n        clipboardData.setData('text/html', html);\n        clipboardData.setData('text/plain', text);\n        clipboardData.setData(internalHtmlMime(), html);\n        return true;\n      } catch (e) {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  };\n\n  var setClipboardData = function (evt, data, fallback, done) {\n    if (setHtml5Clipboard(evt.clipboardData, data.html, data.text)) {\n      evt.preventDefault();\n      done();\n    } else {\n      fallback(data.html, done);\n    }\n  };\n\n  var fallback = function (editor) {\n    return function (html, done) {\n      var markedHtml = mark(html);\n      var outer = editor.dom.create('div', {\n        'contenteditable': 'false',\n        'data-mce-bogus': 'all'\n      });\n      var inner = editor.dom.create('div', {\n        contenteditable: 'true'\n      }, markedHtml);\n      editor.dom.setStyles(outer, {\n        position: 'fixed',\n        top: '0',\n        left: '-3000px',\n        width: '1000px',\n        overflow: 'hidden'\n      });\n      outer.appendChild(inner);\n      editor.dom.add(editor.getBody(), outer);\n      var range = editor.selection.getRng();\n      inner.focus();\n      var offscreenRange = editor.dom.createRng();\n      offscreenRange.selectNodeContents(inner);\n      editor.selection.setRng(offscreenRange);\n      global$2.setTimeout(function () {\n        editor.selection.setRng(range);\n        outer.parentNode.removeChild(outer);\n        done();\n      }, 0);\n    };\n  };\n\n  var getData = function (editor) {\n    return {\n      html: editor.selection.getContent({\n        contextual: true\n      }),\n      text: editor.selection.getContent({\n        format: 'text'\n      })\n    };\n  };\n\n  var isTableSelection = function (editor) {\n    return !!editor.dom.getParent(editor.selection.getStart(), 'td[data-mce-selected],th[data-mce-selected]', editor.getBody());\n  };\n\n  var hasSelectedContent = function (editor) {\n    return !editor.selection.isCollapsed() || isTableSelection(editor);\n  };\n\n  var cut = function (editor) {\n    return function (evt) {\n      if (hasSelectedContent(editor)) {\n        setClipboardData(evt, getData(editor), fallback(editor), function () {\n          if (global$1.browser.isChrome() || global$1.browser.isFirefox()) {\n            var rng_1 = editor.selection.getRng();\n            global$2.setEditorTimeout(editor, function () {\n              editor.selection.setRng(rng_1);\n              editor.execCommand('Delete');\n            }, 0);\n          } else {\n            editor.execCommand('Delete');\n          }\n        });\n      }\n    };\n  };\n\n  var copy = function (editor) {\n    return function (evt) {\n      if (hasSelectedContent(editor)) {\n        setClipboardData(evt, getData(editor), fallback(editor), noop);\n      }\n    };\n  };\n\n  var register$1 = function (editor) {\n    editor.on('cut', cut(editor));\n    editor.on('copy', copy(editor));\n  };\n\n  var global$b = tinymce.util.Tools.resolve('tinymce.dom.RangeUtils');\n\n  var getCaretRangeFromEvent = function (editor, e) {\n    return global$b.getCaretRangeFromPoint(e.clientX, e.clientY, editor.getDoc());\n  };\n\n  var isPlainTextFileUrl = function (content) {\n    var plainTextContent = content['text/plain'];\n    return plainTextContent ? plainTextContent.indexOf('file://') === 0 : false;\n  };\n\n  var setFocusedRange = function (editor, rng) {\n    editor.focus();\n    editor.selection.setRng(rng);\n  };\n\n  var setup = function (editor, clipboard, draggingInternallyState) {\n    if (shouldBlockDrop(editor)) {\n      editor.on('dragend dragover draggesture dragdrop drop drag', function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n      });\n    }\n\n    if (!shouldPasteDataImages(editor)) {\n      editor.on('drop', function (e) {\n        var dataTransfer = e.dataTransfer;\n\n        if (dataTransfer && dataTransfer.files && dataTransfer.files.length > 0) {\n          e.preventDefault();\n        }\n      });\n    }\n\n    editor.on('drop', function (e) {\n      var rng = getCaretRangeFromEvent(editor, e);\n\n      if (e.isDefaultPrevented() || draggingInternallyState.get()) {\n        return;\n      }\n\n      var dropContent = clipboard.getDataTransferItems(e.dataTransfer);\n      var internal = clipboard.hasContentType(dropContent, internalHtmlMime());\n\n      if ((!clipboard.hasHtmlOrText(dropContent) || isPlainTextFileUrl(dropContent)) && clipboard.pasteImageData(e, rng)) {\n        return;\n      }\n\n      if (rng && shouldFilterDrop(editor)) {\n        var content_1 = dropContent['mce-internal'] || dropContent['text/html'] || dropContent['text/plain'];\n\n        if (content_1) {\n          e.preventDefault();\n          global$2.setEditorTimeout(editor, function () {\n            editor.undoManager.transact(function () {\n              if (dropContent['mce-internal']) {\n                editor.execCommand('Delete');\n              }\n\n              setFocusedRange(editor, rng);\n              content_1 = trimHtml(content_1);\n\n              if (!dropContent['text/html']) {\n                clipboard.pasteText(content_1);\n              } else {\n                clipboard.pasteHtml(content_1, internal);\n              }\n            });\n          });\n        }\n      }\n    });\n    editor.on('dragstart', function (_e) {\n      draggingInternallyState.set(true);\n    });\n    editor.on('dragover dragend', function (e) {\n      if (shouldPasteDataImages(editor) && draggingInternallyState.get() === false) {\n        e.preventDefault();\n        setFocusedRange(editor, getCaretRangeFromEvent(editor, e));\n      }\n\n      if (e.type === 'dragend') {\n        draggingInternallyState.set(false);\n      }\n    });\n  };\n\n  var setup$1 = function (editor) {\n    var plugin = editor.plugins.paste;\n    var preProcess = getPreProcess(editor);\n\n    if (preProcess) {\n      editor.on('PastePreProcess', function (e) {\n        preProcess.call(plugin, plugin, e);\n      });\n    }\n\n    var postProcess = getPostProcess(editor);\n\n    if (postProcess) {\n      editor.on('PastePostProcess', function (e) {\n        postProcess.call(plugin, plugin, e);\n      });\n    }\n  };\n\n  var addPreProcessFilter = function (editor, filterFunc) {\n    editor.on('PastePreProcess', function (e) {\n      e.content = filterFunc(editor, e.content, e.internal, e.wordContent);\n    });\n  };\n\n  var addPostProcessFilter = function (editor, filterFunc) {\n    editor.on('PastePostProcess', function (e) {\n      filterFunc(editor, e.node);\n    });\n  };\n\n  var removeExplorerBrElementsAfterBlocks = function (editor, html) {\n    if (!isWordContent(html)) {\n      return html;\n    }\n\n    var blockElements = [];\n    global$5.each(editor.schema.getBlockElements(), function (block, blockName) {\n      blockElements.push(blockName);\n    });\n    var explorerBlocksRegExp = new RegExp('(?:<br>&nbsp;[\\\\s\\\\r\\\\n]+|<br>)*(<\\\\/?(' + blockElements.join('|') + ')[^>]*>)(?:<br>&nbsp;[\\\\s\\\\r\\\\n]+|<br>)*', 'g');\n    html = filter$1(html, [[explorerBlocksRegExp, '$1']]);\n    html = filter$1(html, [[/<br><br>/g, '<BR><BR>'], [/<br>/g, ' '], [/<BR><BR>/g, '<br>']]);\n    return html;\n  };\n\n  var removeWebKitStyles = function (editor, content, internal, isWordHtml) {\n    if (isWordHtml || internal) {\n      return content;\n    }\n\n    var webKitStylesSetting = getWebkitStyles(editor);\n    var webKitStyles;\n\n    if (shouldRemoveWebKitStyles(editor) === false || webKitStylesSetting === 'all') {\n      return content;\n    }\n\n    if (webKitStylesSetting) {\n      webKitStyles = webKitStylesSetting.split(/[, ]/);\n    }\n\n    if (webKitStyles) {\n      var dom_1 = editor.dom,\n          node_1 = editor.selection.getNode();\n      content = content.replace(/(<[^>]+) style=\"([^\"]*)\"([^>]*>)/gi, function (all, before, value, after) {\n        var inputStyles = dom_1.parseStyle(dom_1.decode(value));\n        var outputStyles = {};\n\n        if (webKitStyles === 'none') {\n          return before + after;\n        }\n\n        for (var i = 0; i < webKitStyles.length; i++) {\n          var inputValue = inputStyles[webKitStyles[i]],\n              currentValue = dom_1.getStyle(node_1, webKitStyles[i], true);\n\n          if (/color/.test(webKitStyles[i])) {\n            inputValue = dom_1.toHex(inputValue);\n            currentValue = dom_1.toHex(currentValue);\n          }\n\n          if (currentValue !== inputValue) {\n            outputStyles[webKitStyles[i]] = inputValue;\n          }\n        }\n\n        outputStyles = dom_1.serializeStyle(outputStyles, 'span');\n\n        if (outputStyles) {\n          return before + ' style=\"' + outputStyles + '\"' + after;\n        }\n\n        return before + after;\n      });\n    } else {\n      content = content.replace(/(<[^>]+) style=\"([^\"]*)\"([^>]*>)/gi, '$1$3');\n    }\n\n    content = content.replace(/(<[^>]+) data-mce-style=\"([^\"]+)\"([^>]*>)/gi, function (all, before, value, after) {\n      return before + ' style=\"' + value + '\"' + after;\n    });\n    return content;\n  };\n\n  var removeUnderlineAndFontInAnchor = function (editor, root) {\n    editor.$('a', root).find('font,u').each(function (i, node) {\n      editor.dom.remove(node, true);\n    });\n  };\n\n  var setup$2 = function (editor) {\n    if (global$1.webkit) {\n      addPreProcessFilter(editor, removeWebKitStyles);\n    }\n\n    if (global$1.ie) {\n      addPreProcessFilter(editor, removeExplorerBrElementsAfterBlocks);\n      addPostProcessFilter(editor, removeUnderlineAndFontInAnchor);\n    }\n  };\n\n  var makeSetupHandler = function (editor, clipboard) {\n    return function (api) {\n      api.setActive(clipboard.pasteFormat.get() === 'text');\n\n      var pastePlainTextToggleHandler = function (e) {\n        return api.setActive(e.state);\n      };\n\n      editor.on('PastePlainTextToggle', pastePlainTextToggleHandler);\n      return function () {\n        return editor.off('PastePlainTextToggle', pastePlainTextToggleHandler);\n      };\n    };\n  };\n\n  var register$2 = function (editor, clipboard) {\n    editor.ui.registry.addToggleButton('pastetext', {\n      active: false,\n      icon: 'paste-text',\n      tooltip: 'Paste as text',\n      onAction: function () {\n        return editor.execCommand('mceTogglePlainTextPaste');\n      },\n      onSetup: makeSetupHandler(editor, clipboard)\n    });\n    editor.ui.registry.addToggleMenuItem('pastetext', {\n      text: 'Paste as text',\n      icon: 'paste-text',\n      onAction: function () {\n        return editor.execCommand('mceTogglePlainTextPaste');\n      },\n      onSetup: makeSetupHandler(editor, clipboard)\n    });\n  };\n\n  function Plugin() {\n    global.add('paste', function (editor) {\n      if (hasProPlugin(editor) === false) {\n        var draggingInternallyState = Cell(false);\n        var pasteFormat = Cell(isPasteAsTextEnabled(editor) ? 'text' : 'html');\n        var clipboard = Clipboard(editor, pasteFormat);\n        var quirks = setup$2(editor);\n        register$2(editor, clipboard);\n        register(editor, clipboard);\n        setup$1(editor);\n        register$1(editor);\n        setup(editor, clipboard, draggingInternallyState);\n        return get(clipboard, quirks);\n      }\n    });\n  }\n\n  Plugin();\n})();","map":{"version":3,"sources":["/Users/katana/Desktop/Programming/Hackathons/SEED/frontend/node_modules/tinymce/plugins/paste/plugin.js"],"names":["Cell","initial","value","get","set","v","global","tinymce","util","Tools","resolve","hasProPlugin","editor","hasPlugin","window","console","log","clipboard","quirks","noop","constant","never","always","none","NONE","eq","o","isNone","call","thunk","id","n","me","fold","_s","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","some","a","constant_a","self","f","s","elementEq","b","from","Optional","isSimpleType","type","isNullable","isNonNullable","isFunction","nativeSlice","Array","prototype","slice","xs","pred","i","len","length","x","r","push","foldl","acc","from$1","subject","clear","isSet","on","checkRange","str","substr","start","startsWith","prefix","endsWith","suffix","repeat","count","join","global$1","global$2","global$3","global$4","firePastePreProcess","html","internal","isWordHtml","fire","content","wordContent","firePastePostProcess","node","firePastePlainTextToggle","state","firePaste","ieFake","global$5","shouldBlockDrop","getParam","shouldPasteDataImages","shouldFilterDrop","getPreProcess","getPostProcess","getWebkitStyles","shouldRemoveWebKitStyles","shouldMergeFormats","isSmartPasteEnabled","isPasteAsTextEnabled","getRetainStyleProps","getWordValidElements","defaultValidElements","shouldConvertWordFakeLists","shouldUseDefaultFilters","getValidate","getAllowHtmlDataUrls","getPasteDataImages","getImagesDataImgFilter","getImagesReuseFilename","getForcedRootBlock","getForcedRootBlockAttrs","getTabSpaces","getAllowedImageFileTypes","defaultImageFileTypes","explode","internalMimeType","internalMark","mark","unmark","replace","isMarked","indexOf","internalHtmlMime","global$6","isPlainText","text","test","toBRs","openContainer","rootTag","rootAttrs","key","attrs","tag","hasOwnProperty","encodeAllRaw","toBlockElements","blocks","split","tagOpen","tagClose","paragraphs","p","stitch","convert","global$7","global$8","nbsp","global$9","global$a","filter$1","items","constructor","RegExp","innerText","schema","domParser","shortEndedElements","getShortEndedElements","ignoreElements","makeMap","blockElements","getBlockElements","walk","name","currentNode","shortEnded","firstChild","next","parse","trimHtml","trimSpaces","all","s1","s2","createIdGenerator","getImageMimeType","ext","lowerExt","toLowerCase","mimeOverrides","jpg","jpe","jfi","jif","jfif","pjpeg","pjp","svg","hasOwn","isWordContent","isNumericList","found","patterns","pattern","isBulletList","convertFakeListsToProperLists","currentListNode","prevListNode","lastLevel","getText","txt","trimListStart","regExp","removeIgnoredNodes","_listIgnore","remove","convertParagraphToLi","paragraphNode","listName","level","_listLevel","parent","attr","wrap","append","lastChild","elements","child","nodeText","matches","exec","parseInt","filterStyles","validStyles","styleValue","outputStyles","styles","dom","parseStyle","serializeStyle","filterWordContent","retainStyleProperties","spaces","Math","floor","validElements","valid_elements","valid_children","rule","attributes","class","attributesOrder","style","addAttributeFilter","nodes","unwrap","className","addNodeFilter","href","rootNode","validate","serialize","preProcess","preProcess$1","parser","fragment","forced_root_block","isRootContent","processResult","cancelled","postProcessFilter","tempBody","create","postProcessArgs","innerHTML","isDefaultPrevented","filterContent","preProcessArgs","filteredContent","hasEventListeners","process","pasteHtml","insertContent","merge","paste","isAbsoluteUrl","url","isImageUrl","createImage","pasteHtmlFn","undoManager","extra","createLink","execCommand","linkSelection","selection","isCollapsed","insertImage","smartInsertContent","action","pasteAsText","isCollapsibleWhitespace","c","isNewLineChar","isNewline","idx","normalizeWhitespace","tabSpace","normalizedText","result","pcIsSpace","doPaste","args","pasteHtml$1","internalFlag","pasteText","encodedText","encode","getDataTransferItems","dataTransfer","mceInternalUrlPrefix","getData","legacyText","types","contentType","ex","getClipboardContent","clipboardEvent","clipboardData","getDoc","hasContentType","clipboardContent","mimeType","hasHtmlOrText","parseDataUri","uri","data","decodeURIComponent","isValidDataUriImage","imgElm","extractFilename","m","match","uniqueId","pasteImage","imageItem","_a","base64","file","blob","img","Image","src","blobCache","editorUpload","blobInfo","existingBlobInfo","getByData","useFileName","name_1","filename","add","blobUri","isClipboardEvent","event","isDataTransferItem","item","getAsFile","readFilesAsDataUris","reader","FileReader","onload","readAsDataURL","isImage","allowedExtensions","extension","getImagesFromDataTransfer","files","pasteImageData","e","rng","images","preventDefault","then","fileResults","setRng","isBrokenAndroidClipboardEvent","navigator","userAgent","isKeyboardPasteEvent","metaKeyPressed","keyCode","shiftKey","registerEventHandlers","pasteBin","pasteFormat","keyboardPasteEvent","keyboardPastePressed","keyboardPastePlainTextState","removePasteBinOnKeyUp","webkit","stopImmediatePropagation","ie","once","off","insertClipboardContent","isKeyBoardPaste","plainTextMode","getHtml","isDefaultContent","isPlainTextHtml","windowManager","alert","getLastRng","getRng","isKeyboardPaste","getEl","stopPropagation","setEditorTimeout","registerEventsAndFilters","isPasteInsert","transparentSrc","isWebKitFakeUrl","isDataUri","getPasteBinParent","inline","document","body","getBody","isExternalPasteBin","delegatePasteEvents","pasteBinElm","pasteBinDefaultContent","_e","isDefault","lastRngCell","gecko","setStyle","getStyle","focus","select","pasteBinClone","lastRng","unbind","copyAndRemove","toElm","fromElm","appendChild","pasteBinClones","grep","childNodes","elm","shift","dirtyWrappers","cleanWrapper","insertBefore","isPasteBin","PasteBin","Clipboard","togglePlainTextPaste","register","addCommand","ui","hasWorkingClipboardApi","iOS","setData","setHtml5Clipboard","clearData","setClipboardData","evt","fallback","done","markedHtml","outer","inner","contenteditable","setStyles","position","top","left","width","overflow","range","offscreenRange","createRng","selectNodeContents","setTimeout","parentNode","removeChild","getContent","contextual","format","isTableSelection","getParent","getStart","hasSelectedContent","cut","browser","isChrome","isFirefox","rng_1","copy","register$1","global$b","getCaretRangeFromEvent","getCaretRangeFromPoint","clientX","clientY","isPlainTextFileUrl","plainTextContent","setFocusedRange","setup","draggingInternallyState","dropContent","content_1","transact","setup$1","plugin","plugins","postProcess","addPreProcessFilter","filterFunc","addPostProcessFilter","removeExplorerBrElementsAfterBlocks","block","blockName","explorerBlocksRegExp","removeWebKitStyles","webKitStylesSetting","webKitStyles","dom_1","node_1","getNode","before","after","inputStyles","decode","inputValue","currentValue","toHex","removeUnderlineAndFontInAnchor","root","$","find","setup$2","makeSetupHandler","api","setActive","pastePlainTextToggleHandler","register$2","registry","addToggleButton","active","icon","tooltip","onAction","onSetup","addToggleMenuItem","Plugin"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.7.1 (2021-03-17)\n */\n(function () {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var hasProPlugin = function (editor) {\n      if (editor.hasPlugin('powerpaste', true)) {\n        if (typeof window.console !== 'undefined' && window.console.log) {\n          window.console.log('PowerPaste is incompatible with Paste plugin! Remove \\'paste\\' from the \\'plugins\\' option.');\n        }\n        return true;\n      } else {\n        return false;\n      }\n    };\n\n    var get = function (clipboard, quirks) {\n      return {\n        clipboard: clipboard,\n        quirks: quirks\n      };\n    };\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var isNullable = function (a) {\n      return a === null || a === undefined;\n    };\n    var isNonNullable = function (a) {\n      return !isNullable(a);\n    };\n    var isFunction = isSimpleType('function');\n\n    var nativeSlice = Array.prototype.slice;\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var value = function () {\n      var subject = Cell(Optional.none());\n      var clear = function () {\n        return subject.set(Optional.none());\n      };\n      var set = function (s) {\n        return subject.set(Optional.some(s));\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var on = function (f) {\n        return subject.get().each(f);\n      };\n      return {\n        clear: clear,\n        set: set,\n        isSet: isSet,\n        on: on\n      };\n    };\n\n    var checkRange = function (str, substr, start) {\n      return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n    };\n    var startsWith = function (str, prefix) {\n      return checkRange(str, prefix, 0);\n    };\n    var endsWith = function (str, suffix) {\n      return checkRange(str, suffix, str.length - suffix.length);\n    };\n    var repeat = function (s, count) {\n      return count <= 0 ? '' : new Array(count + 1).join(s);\n    };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var firePastePreProcess = function (editor, html, internal, isWordHtml) {\n      return editor.fire('PastePreProcess', {\n        content: html,\n        internal: internal,\n        wordContent: isWordHtml\n      });\n    };\n    var firePastePostProcess = function (editor, node, internal, isWordHtml) {\n      return editor.fire('PastePostProcess', {\n        node: node,\n        internal: internal,\n        wordContent: isWordHtml\n      });\n    };\n    var firePastePlainTextToggle = function (editor, state) {\n      return editor.fire('PastePlainTextToggle', { state: state });\n    };\n    var firePaste = function (editor, ieFake) {\n      return editor.fire('paste', { ieFake: ieFake });\n    };\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var shouldBlockDrop = function (editor) {\n      return editor.getParam('paste_block_drop', false);\n    };\n    var shouldPasteDataImages = function (editor) {\n      return editor.getParam('paste_data_images', false);\n    };\n    var shouldFilterDrop = function (editor) {\n      return editor.getParam('paste_filter_drop', true);\n    };\n    var getPreProcess = function (editor) {\n      return editor.getParam('paste_preprocess');\n    };\n    var getPostProcess = function (editor) {\n      return editor.getParam('paste_postprocess');\n    };\n    var getWebkitStyles = function (editor) {\n      return editor.getParam('paste_webkit_styles');\n    };\n    var shouldRemoveWebKitStyles = function (editor) {\n      return editor.getParam('paste_remove_styles_if_webkit', true);\n    };\n    var shouldMergeFormats = function (editor) {\n      return editor.getParam('paste_merge_formats', true);\n    };\n    var isSmartPasteEnabled = function (editor) {\n      return editor.getParam('smart_paste', true);\n    };\n    var isPasteAsTextEnabled = function (editor) {\n      return editor.getParam('paste_as_text', false);\n    };\n    var getRetainStyleProps = function (editor) {\n      return editor.getParam('paste_retain_style_properties');\n    };\n    var getWordValidElements = function (editor) {\n      var defaultValidElements = '-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,' + '-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,' + 'td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody';\n      return editor.getParam('paste_word_valid_elements', defaultValidElements);\n    };\n    var shouldConvertWordFakeLists = function (editor) {\n      return editor.getParam('paste_convert_word_fake_lists', true);\n    };\n    var shouldUseDefaultFilters = function (editor) {\n      return editor.getParam('paste_enable_default_filters', true);\n    };\n    var getValidate = function (editor) {\n      return editor.getParam('validate');\n    };\n    var getAllowHtmlDataUrls = function (editor) {\n      return editor.getParam('allow_html_data_urls', false, 'boolean');\n    };\n    var getPasteDataImages = function (editor) {\n      return editor.getParam('paste_data_images', false, 'boolean');\n    };\n    var getImagesDataImgFilter = function (editor) {\n      return editor.getParam('images_dataimg_filter');\n    };\n    var getImagesReuseFilename = function (editor) {\n      return editor.getParam('images_reuse_filename');\n    };\n    var getForcedRootBlock = function (editor) {\n      return editor.getParam('forced_root_block');\n    };\n    var getForcedRootBlockAttrs = function (editor) {\n      return editor.getParam('forced_root_block_attrs');\n    };\n    var getTabSpaces = function (editor) {\n      return editor.getParam('paste_tab_spaces', 4, 'number');\n    };\n    var getAllowedImageFileTypes = function (editor) {\n      var defaultImageFileTypes = 'jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp';\n      return global$5.explode(editor.getParam('images_file_types', defaultImageFileTypes, 'string'));\n    };\n\n    var internalMimeType = 'x-tinymce/html';\n    var internalMark = '<!-- ' + internalMimeType + ' -->';\n    var mark = function (html) {\n      return internalMark + html;\n    };\n    var unmark = function (html) {\n      return html.replace(internalMark, '');\n    };\n    var isMarked = function (html) {\n      return html.indexOf(internalMark) !== -1;\n    };\n    var internalHtmlMime = function () {\n      return internalMimeType;\n    };\n\n    var global$6 = tinymce.util.Tools.resolve('tinymce.html.Entities');\n\n    var isPlainText = function (text) {\n      return !/<(?:\\/?(?!(?:div|p|br|span)>)\\w+|(?:(?!(?:span style=\"white-space:\\s?pre;?\">)|br\\s?\\/>))\\w+\\s[^>]+)>/i.test(text);\n    };\n    var toBRs = function (text) {\n      return text.replace(/\\r?\\n/g, '<br>');\n    };\n    var openContainer = function (rootTag, rootAttrs) {\n      var key;\n      var attrs = [];\n      var tag = '<' + rootTag;\n      if (typeof rootAttrs === 'object') {\n        for (key in rootAttrs) {\n          if (rootAttrs.hasOwnProperty(key)) {\n            attrs.push(key + '=\"' + global$6.encodeAllRaw(rootAttrs[key]) + '\"');\n          }\n        }\n        if (attrs.length) {\n          tag += ' ' + attrs.join(' ');\n        }\n      }\n      return tag + '>';\n    };\n    var toBlockElements = function (text, rootTag, rootAttrs) {\n      var blocks = text.split(/\\n\\n/);\n      var tagOpen = openContainer(rootTag, rootAttrs);\n      var tagClose = '</' + rootTag + '>';\n      var paragraphs = global$5.map(blocks, function (p) {\n        return p.split(/\\n/).join('<br />');\n      });\n      var stitch = function (p) {\n        return tagOpen + p + tagClose;\n      };\n      return paragraphs.length === 1 ? paragraphs[0] : global$5.map(paragraphs, stitch).join('');\n    };\n    var convert = function (text, rootTag, rootAttrs) {\n      return rootTag ? toBlockElements(text, rootTag === true ? 'p' : rootTag, rootAttrs) : toBRs(text);\n    };\n\n    var global$7 = tinymce.util.Tools.resolve('tinymce.html.DomParser');\n\n    var global$8 = tinymce.util.Tools.resolve('tinymce.html.Serializer');\n\n    var nbsp = '\\xA0';\n\n    var global$9 = tinymce.util.Tools.resolve('tinymce.html.Node');\n\n    var global$a = tinymce.util.Tools.resolve('tinymce.html.Schema');\n\n    var filter$1 = function (content, items) {\n      global$5.each(items, function (v) {\n        if (v.constructor === RegExp) {\n          content = content.replace(v, '');\n        } else {\n          content = content.replace(v[0], v[1]);\n        }\n      });\n      return content;\n    };\n    var innerText = function (html) {\n      var schema = global$a();\n      var domParser = global$7({}, schema);\n      var text = '';\n      var shortEndedElements = schema.getShortEndedElements();\n      var ignoreElements = global$5.makeMap('script noscript style textarea video audio iframe object', ' ');\n      var blockElements = schema.getBlockElements();\n      var walk = function (node) {\n        var name = node.name, currentNode = node;\n        if (name === 'br') {\n          text += '\\n';\n          return;\n        }\n        if (name === 'wbr') {\n          return;\n        }\n        if (shortEndedElements[name]) {\n          text += ' ';\n        }\n        if (ignoreElements[name]) {\n          text += ' ';\n          return;\n        }\n        if (node.type === 3) {\n          text += node.value;\n        }\n        if (!node.shortEnded) {\n          if (node = node.firstChild) {\n            do {\n              walk(node);\n            } while (node = node.next);\n          }\n        }\n        if (blockElements[name] && currentNode.next) {\n          text += '\\n';\n          if (name === 'p') {\n            text += '\\n';\n          }\n        }\n      };\n      html = filter$1(html, [/<!\\[[^\\]]+\\]>/g]);\n      walk(domParser.parse(html));\n      return text;\n    };\n    var trimHtml = function (html) {\n      var trimSpaces = function (all, s1, s2) {\n        if (!s1 && !s2) {\n          return ' ';\n        }\n        return nbsp;\n      };\n      html = filter$1(html, [\n        /^[\\s\\S]*<body[^>]*>\\s*|\\s*<\\/body[^>]*>[\\s\\S]*$/ig,\n        /<!--StartFragment-->|<!--EndFragment-->/g,\n        [\n          /( ?)<span class=\"Apple-converted-space\">\\u00a0<\\/span>( ?)/g,\n          trimSpaces\n        ],\n        /<br class=\"Apple-interchange-newline\">/g,\n        /<br>$/i\n      ]);\n      return html;\n    };\n    var createIdGenerator = function (prefix) {\n      var count = 0;\n      return function () {\n        return prefix + count++;\n      };\n    };\n    var getImageMimeType = function (ext) {\n      var lowerExt = ext.toLowerCase();\n      var mimeOverrides = {\n        jpg: 'jpeg',\n        jpe: 'jpeg',\n        jfi: 'jpeg',\n        jif: 'jpeg',\n        jfif: 'jpeg',\n        pjpeg: 'jpeg',\n        pjp: 'jpeg',\n        svg: 'svg+xml'\n      };\n      return global$5.hasOwn(mimeOverrides, lowerExt) ? 'image/' + mimeOverrides[lowerExt] : 'image/' + lowerExt;\n    };\n\n    var isWordContent = function (content) {\n      return /<font face=\"Times New Roman\"|class=\"?Mso|style=\"[^\"]*\\bmso-|style='[^']*\\bmso-|w:WordDocument/i.test(content) || /class=\"OutlineElement/.test(content) || /id=\"?docs\\-internal\\-guid\\-/.test(content);\n    };\n    var isNumericList = function (text) {\n      var found;\n      var patterns = [\n        /^[IVXLMCD]{1,2}\\.[ \\u00a0]/,\n        /^[ivxlmcd]{1,2}\\.[ \\u00a0]/,\n        /^[a-z]{1,2}[\\.\\)][ \\u00a0]/,\n        /^[A-Z]{1,2}[\\.\\)][ \\u00a0]/,\n        /^[0-9]+\\.[ \\u00a0]/,\n        /^[\\u3007\\u4e00\\u4e8c\\u4e09\\u56db\\u4e94\\u516d\\u4e03\\u516b\\u4e5d]+\\.[ \\u00a0]/,\n        /^[\\u58f1\\u5f10\\u53c2\\u56db\\u4f0d\\u516d\\u4e03\\u516b\\u4e5d\\u62fe]+\\.[ \\u00a0]/\n      ];\n      text = text.replace(/^[\\u00a0 ]+/, '');\n      global$5.each(patterns, function (pattern) {\n        if (pattern.test(text)) {\n          found = true;\n          return false;\n        }\n      });\n      return found;\n    };\n    var isBulletList = function (text) {\n      return /^[\\s\\u00a0]*[\\u2022\\u00b7\\u00a7\\u25CF]\\s*/.test(text);\n    };\n    var convertFakeListsToProperLists = function (node) {\n      var currentListNode, prevListNode, lastLevel = 1;\n      var getText = function (node) {\n        var txt = '';\n        if (node.type === 3) {\n          return node.value;\n        }\n        if (node = node.firstChild) {\n          do {\n            txt += getText(node);\n          } while (node = node.next);\n        }\n        return txt;\n      };\n      var trimListStart = function (node, regExp) {\n        if (node.type === 3) {\n          if (regExp.test(node.value)) {\n            node.value = node.value.replace(regExp, '');\n            return false;\n          }\n        }\n        if (node = node.firstChild) {\n          do {\n            if (!trimListStart(node, regExp)) {\n              return false;\n            }\n          } while (node = node.next);\n        }\n        return true;\n      };\n      var removeIgnoredNodes = function (node) {\n        if (node._listIgnore) {\n          node.remove();\n          return;\n        }\n        if (node = node.firstChild) {\n          do {\n            removeIgnoredNodes(node);\n          } while (node = node.next);\n        }\n      };\n      var convertParagraphToLi = function (paragraphNode, listName, start) {\n        var level = paragraphNode._listLevel || lastLevel;\n        if (level !== lastLevel) {\n          if (level < lastLevel) {\n            if (currentListNode) {\n              currentListNode = currentListNode.parent.parent;\n            }\n          } else {\n            prevListNode = currentListNode;\n            currentListNode = null;\n          }\n        }\n        if (!currentListNode || currentListNode.name !== listName) {\n          prevListNode = prevListNode || currentListNode;\n          currentListNode = new global$9(listName, 1);\n          if (start > 1) {\n            currentListNode.attr('start', '' + start);\n          }\n          paragraphNode.wrap(currentListNode);\n        } else {\n          currentListNode.append(paragraphNode);\n        }\n        paragraphNode.name = 'li';\n        if (level > lastLevel && prevListNode) {\n          prevListNode.lastChild.append(currentListNode);\n        }\n        lastLevel = level;\n        removeIgnoredNodes(paragraphNode);\n        trimListStart(paragraphNode, /^\\u00a0+/);\n        trimListStart(paragraphNode, /^\\s*([\\u2022\\u00b7\\u00a7\\u25CF]|\\w+\\.)/);\n        trimListStart(paragraphNode, /^\\u00a0+/);\n      };\n      var elements = [];\n      var child = node.firstChild;\n      while (typeof child !== 'undefined' && child !== null) {\n        elements.push(child);\n        child = child.walk();\n        if (child !== null) {\n          while (typeof child !== 'undefined' && child.parent !== node) {\n            child = child.walk();\n          }\n        }\n      }\n      for (var i = 0; i < elements.length; i++) {\n        node = elements[i];\n        if (node.name === 'p' && node.firstChild) {\n          var nodeText = getText(node);\n          if (isBulletList(nodeText)) {\n            convertParagraphToLi(node, 'ul');\n            continue;\n          }\n          if (isNumericList(nodeText)) {\n            var matches = /([0-9]+)\\./.exec(nodeText);\n            var start = 1;\n            if (matches) {\n              start = parseInt(matches[1], 10);\n            }\n            convertParagraphToLi(node, 'ol', start);\n            continue;\n          }\n          if (node._listLevel) {\n            convertParagraphToLi(node, 'ul', 1);\n            continue;\n          }\n          currentListNode = null;\n        } else {\n          prevListNode = currentListNode;\n          currentListNode = null;\n        }\n      }\n    };\n    var filterStyles = function (editor, validStyles, node, styleValue) {\n      var outputStyles = {}, matches;\n      var styles = editor.dom.parseStyle(styleValue);\n      global$5.each(styles, function (value, name) {\n        switch (name) {\n        case 'mso-list':\n          matches = /\\w+ \\w+([0-9]+)/i.exec(styleValue);\n          if (matches) {\n            node._listLevel = parseInt(matches[1], 10);\n          }\n          if (/Ignore/i.test(value) && node.firstChild) {\n            node._listIgnore = true;\n            node.firstChild._listIgnore = true;\n          }\n          break;\n        case 'horiz-align':\n          name = 'text-align';\n          break;\n        case 'vert-align':\n          name = 'vertical-align';\n          break;\n        case 'font-color':\n        case 'mso-foreground':\n          name = 'color';\n          break;\n        case 'mso-background':\n        case 'mso-highlight':\n          name = 'background';\n          break;\n        case 'font-weight':\n        case 'font-style':\n          if (value !== 'normal') {\n            outputStyles[name] = value;\n          }\n          return;\n        case 'mso-element':\n          if (/^(comment|comment-list)$/i.test(value)) {\n            node.remove();\n            return;\n          }\n          break;\n        }\n        if (name.indexOf('mso-comment') === 0) {\n          node.remove();\n          return;\n        }\n        if (name.indexOf('mso-') === 0) {\n          return;\n        }\n        if (getRetainStyleProps(editor) === 'all' || validStyles && validStyles[name]) {\n          outputStyles[name] = value;\n        }\n      });\n      if (/(bold)/i.test(outputStyles['font-weight'])) {\n        delete outputStyles['font-weight'];\n        node.wrap(new global$9('b', 1));\n      }\n      if (/(italic)/i.test(outputStyles['font-style'])) {\n        delete outputStyles['font-style'];\n        node.wrap(new global$9('i', 1));\n      }\n      outputStyles = editor.dom.serializeStyle(outputStyles, node.name);\n      if (outputStyles) {\n        return outputStyles;\n      }\n      return null;\n    };\n    var filterWordContent = function (editor, content) {\n      var validStyles;\n      var retainStyleProperties = getRetainStyleProps(editor);\n      if (retainStyleProperties) {\n        validStyles = global$5.makeMap(retainStyleProperties.split(/[, ]/));\n      }\n      content = filter$1(content, [\n        /<br class=\"?Apple-interchange-newline\"?>/gi,\n        /<b[^>]+id=\"?docs-internal-[^>]*>/gi,\n        /<!--[\\s\\S]+?-->/gi,\n        /<(!|script[^>]*>.*?<\\/script(?=[>\\s])|\\/?(\\?xml(:\\w+)?|img|meta|link|style|\\w:\\w+)(?=[\\s\\/>]))[^>]*>/gi,\n        [\n          /<(\\/?)s>/gi,\n          '<$1strike>'\n        ],\n        [\n          /&nbsp;/gi,\n          nbsp\n        ],\n        [\n          /<span\\s+style\\s*=\\s*\"\\s*mso-spacerun\\s*:\\s*yes\\s*;?\\s*\"\\s*>([\\s\\u00a0]*)<\\/span>/gi,\n          function (str, spaces) {\n            return spaces.length > 0 ? spaces.replace(/./, ' ').slice(Math.floor(spaces.length / 2)).split('').join(nbsp) : '';\n          }\n        ]\n      ]);\n      var validElements = getWordValidElements(editor);\n      var schema = global$a({\n        valid_elements: validElements,\n        valid_children: '-li[p]'\n      });\n      global$5.each(schema.elements, function (rule) {\n        if (!rule.attributes.class) {\n          rule.attributes.class = {};\n          rule.attributesOrder.push('class');\n        }\n        if (!rule.attributes.style) {\n          rule.attributes.style = {};\n          rule.attributesOrder.push('style');\n        }\n      });\n      var domParser = global$7({}, schema);\n      domParser.addAttributeFilter('style', function (nodes) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          node.attr('style', filterStyles(editor, validStyles, node, node.attr('style')));\n          if (node.name === 'span' && node.parent && !node.attributes.length) {\n            node.unwrap();\n          }\n        }\n      });\n      domParser.addAttributeFilter('class', function (nodes) {\n        var i = nodes.length, node, className;\n        while (i--) {\n          node = nodes[i];\n          className = node.attr('class');\n          if (/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(className)) {\n            node.remove();\n          }\n          node.attr('class', null);\n        }\n      });\n      domParser.addNodeFilter('del', function (nodes) {\n        var i = nodes.length;\n        while (i--) {\n          nodes[i].remove();\n        }\n      });\n      domParser.addNodeFilter('a', function (nodes) {\n        var i = nodes.length, node, href, name;\n        while (i--) {\n          node = nodes[i];\n          href = node.attr('href');\n          name = node.attr('name');\n          if (href && href.indexOf('#_msocom_') !== -1) {\n            node.remove();\n            continue;\n          }\n          if (href && href.indexOf('file://') === 0) {\n            href = href.split('#')[1];\n            if (href) {\n              href = '#' + href;\n            }\n          }\n          if (!href && !name) {\n            node.unwrap();\n          } else {\n            if (name && !/^_?(?:toc|edn|ftn)/i.test(name)) {\n              node.unwrap();\n              continue;\n            }\n            node.attr({\n              href: href,\n              name: name\n            });\n          }\n        }\n      });\n      var rootNode = domParser.parse(content);\n      if (shouldConvertWordFakeLists(editor)) {\n        convertFakeListsToProperLists(rootNode);\n      }\n      content = global$8({ validate: getValidate(editor) }, schema).serialize(rootNode);\n      return content;\n    };\n    var preProcess = function (editor, content) {\n      return shouldUseDefaultFilters(editor) ? filterWordContent(editor, content) : content;\n    };\n\n    var preProcess$1 = function (editor, html) {\n      var parser = global$7({}, editor.schema);\n      parser.addNodeFilter('meta', function (nodes) {\n        global$5.each(nodes, function (node) {\n          node.remove();\n        });\n      });\n      var fragment = parser.parse(html, {\n        forced_root_block: false,\n        isRootContent: true\n      });\n      return global$8({ validate: getValidate(editor) }, editor.schema).serialize(fragment);\n    };\n    var processResult = function (content, cancelled) {\n      return {\n        content: content,\n        cancelled: cancelled\n      };\n    };\n    var postProcessFilter = function (editor, html, internal, isWordHtml) {\n      var tempBody = editor.dom.create('div', { style: 'display:none' }, html);\n      var postProcessArgs = firePastePostProcess(editor, tempBody, internal, isWordHtml);\n      return processResult(postProcessArgs.node.innerHTML, postProcessArgs.isDefaultPrevented());\n    };\n    var filterContent = function (editor, content, internal, isWordHtml) {\n      var preProcessArgs = firePastePreProcess(editor, content, internal, isWordHtml);\n      var filteredContent = preProcess$1(editor, preProcessArgs.content);\n      if (editor.hasEventListeners('PastePostProcess') && !preProcessArgs.isDefaultPrevented()) {\n        return postProcessFilter(editor, filteredContent, internal, isWordHtml);\n      } else {\n        return processResult(filteredContent, preProcessArgs.isDefaultPrevented());\n      }\n    };\n    var process = function (editor, html, internal) {\n      var isWordHtml = isWordContent(html);\n      var content = isWordHtml ? preProcess(editor, html) : html;\n      return filterContent(editor, content, internal, isWordHtml);\n    };\n\n    var pasteHtml = function (editor, html) {\n      editor.insertContent(html, {\n        merge: shouldMergeFormats(editor),\n        paste: true\n      });\n      return true;\n    };\n    var isAbsoluteUrl = function (url) {\n      return /^https?:\\/\\/[\\w\\?\\-\\/+=.&%@~#]+$/i.test(url);\n    };\n    var isImageUrl = function (editor, url) {\n      return isAbsoluteUrl(url) && exists(getAllowedImageFileTypes(editor), function (type) {\n        return endsWith(url.toLowerCase(), '.' + type.toLowerCase());\n      });\n    };\n    var createImage = function (editor, url, pasteHtmlFn) {\n      editor.undoManager.extra(function () {\n        pasteHtmlFn(editor, url);\n      }, function () {\n        editor.insertContent('<img src=\"' + url + '\">');\n      });\n      return true;\n    };\n    var createLink = function (editor, url, pasteHtmlFn) {\n      editor.undoManager.extra(function () {\n        pasteHtmlFn(editor, url);\n      }, function () {\n        editor.execCommand('mceInsertLink', false, url);\n      });\n      return true;\n    };\n    var linkSelection = function (editor, html, pasteHtmlFn) {\n      return editor.selection.isCollapsed() === false && isAbsoluteUrl(html) ? createLink(editor, html, pasteHtmlFn) : false;\n    };\n    var insertImage = function (editor, html, pasteHtmlFn) {\n      return isImageUrl(editor, html) ? createImage(editor, html, pasteHtmlFn) : false;\n    };\n    var smartInsertContent = function (editor, html) {\n      global$5.each([\n        linkSelection,\n        insertImage,\n        pasteHtml\n      ], function (action) {\n        return action(editor, html, pasteHtml) !== true;\n      });\n    };\n    var insertContent = function (editor, html, pasteAsText) {\n      if (pasteAsText || isSmartPasteEnabled(editor) === false) {\n        pasteHtml(editor, html);\n      } else {\n        smartInsertContent(editor, html);\n      }\n    };\n\n    var isCollapsibleWhitespace = function (c) {\n      return ' \\f\\t\\x0B'.indexOf(c) !== -1;\n    };\n    var isNewLineChar = function (c) {\n      return c === '\\n' || c === '\\r';\n    };\n    var isNewline = function (text, idx) {\n      return idx < text.length && idx >= 0 ? isNewLineChar(text[idx]) : false;\n    };\n    var normalizeWhitespace = function (editor, text) {\n      var tabSpace = repeat(' ', getTabSpaces(editor));\n      var normalizedText = text.replace(/\\t/g, tabSpace);\n      var result = foldl(normalizedText, function (acc, c) {\n        if (isCollapsibleWhitespace(c) || c === nbsp) {\n          if (acc.pcIsSpace || acc.str === '' || acc.str.length === normalizedText.length - 1 || isNewline(normalizedText, acc.str.length + 1)) {\n            return {\n              pcIsSpace: false,\n              str: acc.str + nbsp\n            };\n          } else {\n            return {\n              pcIsSpace: true,\n              str: acc.str + ' '\n            };\n          }\n        } else {\n          return {\n            pcIsSpace: isNewLineChar(c),\n            str: acc.str + c\n          };\n        }\n      }, {\n        pcIsSpace: false,\n        str: ''\n      });\n      return result.str;\n    };\n\n    var doPaste = function (editor, content, internal, pasteAsText) {\n      var args = process(editor, content, internal);\n      if (args.cancelled === false) {\n        insertContent(editor, args.content, pasteAsText);\n      }\n    };\n    var pasteHtml$1 = function (editor, html, internalFlag) {\n      var internal = internalFlag ? internalFlag : isMarked(html);\n      doPaste(editor, unmark(html), internal, false);\n    };\n    var pasteText = function (editor, text) {\n      var encodedText = editor.dom.encode(text).replace(/\\r\\n/g, '\\n');\n      var normalizedText = normalizeWhitespace(editor, encodedText);\n      var html = convert(normalizedText, getForcedRootBlock(editor), getForcedRootBlockAttrs(editor));\n      doPaste(editor, html, false, true);\n    };\n    var getDataTransferItems = function (dataTransfer) {\n      var items = {};\n      var mceInternalUrlPrefix = 'data:text/mce-internal,';\n      if (dataTransfer) {\n        if (dataTransfer.getData) {\n          var legacyText = dataTransfer.getData('Text');\n          if (legacyText && legacyText.length > 0) {\n            if (legacyText.indexOf(mceInternalUrlPrefix) === -1) {\n              items['text/plain'] = legacyText;\n            }\n          }\n        }\n        if (dataTransfer.types) {\n          for (var i = 0; i < dataTransfer.types.length; i++) {\n            var contentType = dataTransfer.types[i];\n            try {\n              items[contentType] = dataTransfer.getData(contentType);\n            } catch (ex) {\n              items[contentType] = '';\n            }\n          }\n        }\n      }\n      return items;\n    };\n    var getClipboardContent = function (editor, clipboardEvent) {\n      return getDataTransferItems(clipboardEvent.clipboardData || editor.getDoc().dataTransfer);\n    };\n    var hasContentType = function (clipboardContent, mimeType) {\n      return mimeType in clipboardContent && clipboardContent[mimeType].length > 0;\n    };\n    var hasHtmlOrText = function (content) {\n      return hasContentType(content, 'text/html') || hasContentType(content, 'text/plain');\n    };\n    var parseDataUri = function (uri) {\n      var matches = /data:([^;]+);base64,([a-z0-9\\+\\/=]+)/i.exec(uri);\n      if (matches) {\n        return {\n          type: matches[1],\n          data: decodeURIComponent(matches[2])\n        };\n      } else {\n        return {\n          type: null,\n          data: null\n        };\n      }\n    };\n    var isValidDataUriImage = function (editor, imgElm) {\n      var filter = getImagesDataImgFilter(editor);\n      return filter ? filter(imgElm) : true;\n    };\n    var extractFilename = function (editor, str) {\n      var m = str.match(/([\\s\\S]+?)(?:\\.[a-z0-9.]+)$/i);\n      return isNonNullable(m) ? editor.dom.encode(m[1]) : null;\n    };\n    var uniqueId = createIdGenerator('mceclip');\n    var pasteImage = function (editor, imageItem) {\n      var _a = parseDataUri(imageItem.uri), base64 = _a.data, type = _a.type;\n      var id = uniqueId();\n      var file = imageItem.blob;\n      var img = new Image();\n      img.src = imageItem.uri;\n      if (isValidDataUriImage(editor, img)) {\n        var blobCache = editor.editorUpload.blobCache;\n        var blobInfo = void 0;\n        var existingBlobInfo = blobCache.getByData(base64, type);\n        if (!existingBlobInfo) {\n          var useFileName = getImagesReuseFilename(editor) && isNonNullable(file.name);\n          var name_1 = useFileName ? extractFilename(editor, file.name) : id;\n          var filename = useFileName ? file.name : undefined;\n          blobInfo = blobCache.create(id, file, base64, name_1, filename);\n          blobCache.add(blobInfo);\n        } else {\n          blobInfo = existingBlobInfo;\n        }\n        pasteHtml$1(editor, '<img src=\"' + blobInfo.blobUri() + '\">', false);\n      } else {\n        pasteHtml$1(editor, '<img src=\"' + imageItem.uri + '\">', false);\n      }\n    };\n    var isClipboardEvent = function (event) {\n      return event.type === 'paste';\n    };\n    var isDataTransferItem = function (item) {\n      return isNonNullable(item.getAsFile);\n    };\n    var readFilesAsDataUris = function (items) {\n      return global$3.all(map(items, function (item) {\n        return new global$3(function (resolve) {\n          var blob = isDataTransferItem(item) ? item.getAsFile() : item;\n          var reader = new window.FileReader();\n          reader.onload = function () {\n            resolve({\n              blob: blob,\n              uri: reader.result\n            });\n          };\n          reader.readAsDataURL(blob);\n        });\n      }));\n    };\n    var isImage = function (editor) {\n      var allowedExtensions = getAllowedImageFileTypes(editor);\n      return function (file) {\n        return startsWith(file.type, 'image/') && exists(allowedExtensions, function (extension) {\n          return getImageMimeType(extension) === file.type;\n        });\n      };\n    };\n    var getImagesFromDataTransfer = function (editor, dataTransfer) {\n      var items = dataTransfer.items ? map(from$1(dataTransfer.items), function (item) {\n        return item.getAsFile();\n      }) : [];\n      var files = dataTransfer.files ? from$1(dataTransfer.files) : [];\n      return filter(items.length > 0 ? items : files, isImage(editor));\n    };\n    var pasteImageData = function (editor, e, rng) {\n      var dataTransfer = isClipboardEvent(e) ? e.clipboardData : e.dataTransfer;\n      if (getPasteDataImages(editor) && dataTransfer) {\n        var images = getImagesFromDataTransfer(editor, dataTransfer);\n        if (images.length > 0) {\n          e.preventDefault();\n          readFilesAsDataUris(images).then(function (fileResults) {\n            if (rng) {\n              editor.selection.setRng(rng);\n            }\n            each(fileResults, function (result) {\n              pasteImage(editor, result);\n            });\n          });\n          return true;\n        }\n      }\n      return false;\n    };\n    var isBrokenAndroidClipboardEvent = function (e) {\n      var clipboardData = e.clipboardData;\n      return navigator.userAgent.indexOf('Android') !== -1 && clipboardData && clipboardData.items && clipboardData.items.length === 0;\n    };\n    var isKeyboardPasteEvent = function (e) {\n      return global$4.metaKeyPressed(e) && e.keyCode === 86 || e.shiftKey && e.keyCode === 45;\n    };\n    var registerEventHandlers = function (editor, pasteBin, pasteFormat) {\n      var keyboardPasteEvent = value();\n      var keyboardPastePressed = value();\n      var keyboardPastePlainTextState;\n      editor.on('keyup', keyboardPastePressed.clear);\n      editor.on('keydown', function (e) {\n        var removePasteBinOnKeyUp = function (e) {\n          if (isKeyboardPasteEvent(e) && !e.isDefaultPrevented()) {\n            pasteBin.remove();\n          }\n        };\n        if (isKeyboardPasteEvent(e) && !e.isDefaultPrevented()) {\n          keyboardPastePlainTextState = e.shiftKey && e.keyCode === 86;\n          if (keyboardPastePlainTextState && global$1.webkit && navigator.userAgent.indexOf('Version/') !== -1) {\n            return;\n          }\n          e.stopImmediatePropagation();\n          keyboardPasteEvent.set(e);\n          keyboardPastePressed.set(true);\n          if (global$1.ie && keyboardPastePlainTextState) {\n            e.preventDefault();\n            firePaste(editor, true);\n            return;\n          }\n          pasteBin.remove();\n          pasteBin.create();\n          editor.once('keyup', removePasteBinOnKeyUp);\n          editor.once('paste', function () {\n            editor.off('keyup', removePasteBinOnKeyUp);\n          });\n        }\n      });\n      var insertClipboardContent = function (editor, clipboardContent, isKeyBoardPaste, plainTextMode, internal) {\n        var content;\n        if (hasContentType(clipboardContent, 'text/html')) {\n          content = clipboardContent['text/html'];\n        } else {\n          content = pasteBin.getHtml();\n          internal = internal ? internal : isMarked(content);\n          if (pasteBin.isDefaultContent(content)) {\n            plainTextMode = true;\n          }\n        }\n        content = trimHtml(content);\n        pasteBin.remove();\n        var isPlainTextHtml = internal === false && isPlainText(content);\n        var isImage = isImageUrl(editor, content);\n        if (!content.length || isPlainTextHtml && !isImage) {\n          plainTextMode = true;\n        }\n        if (plainTextMode || isImage) {\n          if (hasContentType(clipboardContent, 'text/plain') && isPlainTextHtml) {\n            content = clipboardContent['text/plain'];\n          } else {\n            content = innerText(content);\n          }\n        }\n        if (pasteBin.isDefaultContent(content)) {\n          if (!isKeyBoardPaste) {\n            editor.windowManager.alert('Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.');\n          }\n          return;\n        }\n        if (plainTextMode) {\n          pasteText(editor, content);\n        } else {\n          pasteHtml$1(editor, content, internal);\n        }\n      };\n      var getLastRng = function () {\n        return pasteBin.getLastRng() || editor.selection.getRng();\n      };\n      editor.on('paste', function (e) {\n        var isKeyboardPaste = keyboardPasteEvent.isSet() || keyboardPastePressed.isSet();\n        if (isKeyboardPaste) {\n          keyboardPasteEvent.clear();\n        }\n        var clipboardContent = getClipboardContent(editor, e);\n        var plainTextMode = pasteFormat.get() === 'text' || keyboardPastePlainTextState;\n        var internal = hasContentType(clipboardContent, internalHtmlMime());\n        keyboardPastePlainTextState = false;\n        if (e.isDefaultPrevented() || isBrokenAndroidClipboardEvent(e)) {\n          pasteBin.remove();\n          return;\n        }\n        if (!hasHtmlOrText(clipboardContent) && pasteImageData(editor, e, getLastRng())) {\n          pasteBin.remove();\n          return;\n        }\n        if (!isKeyboardPaste) {\n          e.preventDefault();\n        }\n        if (global$1.ie && (!isKeyboardPaste || e.ieFake) && !hasContentType(clipboardContent, 'text/html')) {\n          pasteBin.create();\n          editor.dom.bind(pasteBin.getEl(), 'paste', function (e) {\n            e.stopPropagation();\n          });\n          editor.getDoc().execCommand('Paste', false, null);\n          clipboardContent['text/html'] = pasteBin.getHtml();\n        }\n        if (hasContentType(clipboardContent, 'text/html')) {\n          e.preventDefault();\n          if (!internal) {\n            internal = isMarked(clipboardContent['text/html']);\n          }\n          insertClipboardContent(editor, clipboardContent, isKeyboardPaste, plainTextMode, internal);\n        } else {\n          global$2.setEditorTimeout(editor, function () {\n            insertClipboardContent(editor, clipboardContent, isKeyboardPaste, plainTextMode, internal);\n          }, 0);\n        }\n      });\n    };\n    var registerEventsAndFilters = function (editor, pasteBin, pasteFormat) {\n      registerEventHandlers(editor, pasteBin, pasteFormat);\n      var src;\n      editor.parser.addNodeFilter('img', function (nodes, name, args) {\n        var isPasteInsert = function (args) {\n          return args.data && args.data.paste === true;\n        };\n        var remove = function (node) {\n          if (!node.attr('data-mce-object') && src !== global$1.transparentSrc) {\n            node.remove();\n          }\n        };\n        var isWebKitFakeUrl = function (src) {\n          return src.indexOf('webkit-fake-url') === 0;\n        };\n        var isDataUri = function (src) {\n          return src.indexOf('data:') === 0;\n        };\n        if (!getPasteDataImages(editor) && isPasteInsert(args)) {\n          var i = nodes.length;\n          while (i--) {\n            src = nodes[i].attr('src');\n            if (!src) {\n              continue;\n            }\n            if (isWebKitFakeUrl(src)) {\n              remove(nodes[i]);\n            } else if (!getAllowHtmlDataUrls(editor) && isDataUri(src)) {\n              remove(nodes[i]);\n            }\n          }\n        }\n      });\n    };\n\n    var getPasteBinParent = function (editor) {\n      return global$1.ie && editor.inline ? document.body : editor.getBody();\n    };\n    var isExternalPasteBin = function (editor) {\n      return getPasteBinParent(editor) !== editor.getBody();\n    };\n    var delegatePasteEvents = function (editor, pasteBinElm, pasteBinDefaultContent) {\n      if (isExternalPasteBin(editor)) {\n        editor.dom.bind(pasteBinElm, 'paste keyup', function (_e) {\n          if (!isDefault(editor, pasteBinDefaultContent)) {\n            editor.fire('paste');\n          }\n        });\n      }\n    };\n    var create = function (editor, lastRngCell, pasteBinDefaultContent) {\n      var dom = editor.dom, body = editor.getBody();\n      lastRngCell.set(editor.selection.getRng());\n      var pasteBinElm = editor.dom.add(getPasteBinParent(editor), 'div', {\n        'id': 'mcepastebin',\n        'class': 'mce-pastebin',\n        'contentEditable': true,\n        'data-mce-bogus': 'all',\n        'style': 'position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0'\n      }, pasteBinDefaultContent);\n      if (global$1.ie || global$1.gecko) {\n        dom.setStyle(pasteBinElm, 'left', dom.getStyle(body, 'direction', true) === 'rtl' ? 65535 : -65535);\n      }\n      dom.bind(pasteBinElm, 'beforedeactivate focusin focusout', function (e) {\n        e.stopPropagation();\n      });\n      delegatePasteEvents(editor, pasteBinElm, pasteBinDefaultContent);\n      pasteBinElm.focus();\n      editor.selection.select(pasteBinElm, true);\n    };\n    var remove = function (editor, lastRngCell) {\n      if (getEl(editor)) {\n        var pasteBinClone = void 0;\n        var lastRng = lastRngCell.get();\n        while (pasteBinClone = editor.dom.get('mcepastebin')) {\n          editor.dom.remove(pasteBinClone);\n          editor.dom.unbind(pasteBinClone);\n        }\n        if (lastRng) {\n          editor.selection.setRng(lastRng);\n        }\n      }\n      lastRngCell.set(null);\n    };\n    var getEl = function (editor) {\n      return editor.dom.get('mcepastebin');\n    };\n    var getHtml = function (editor) {\n      var copyAndRemove = function (toElm, fromElm) {\n        toElm.appendChild(fromElm);\n        editor.dom.remove(fromElm, true);\n      };\n      var pasteBinClones = global$5.grep(getPasteBinParent(editor).childNodes, function (elm) {\n        return elm.id === 'mcepastebin';\n      });\n      var pasteBinElm = pasteBinClones.shift();\n      global$5.each(pasteBinClones, function (pasteBinClone) {\n        copyAndRemove(pasteBinElm, pasteBinClone);\n      });\n      var dirtyWrappers = editor.dom.select('div[id=mcepastebin]', pasteBinElm);\n      for (var i = dirtyWrappers.length - 1; i >= 0; i--) {\n        var cleanWrapper = editor.dom.create('div');\n        pasteBinElm.insertBefore(cleanWrapper, dirtyWrappers[i]);\n        copyAndRemove(cleanWrapper, dirtyWrappers[i]);\n      }\n      return pasteBinElm ? pasteBinElm.innerHTML : '';\n    };\n    var getLastRng = function (lastRng) {\n      return lastRng.get();\n    };\n    var isDefaultContent = function (pasteBinDefaultContent, content) {\n      return content === pasteBinDefaultContent;\n    };\n    var isPasteBin = function (elm) {\n      return elm && elm.id === 'mcepastebin';\n    };\n    var isDefault = function (editor, pasteBinDefaultContent) {\n      var pasteBinElm = getEl(editor);\n      return isPasteBin(pasteBinElm) && isDefaultContent(pasteBinDefaultContent, pasteBinElm.innerHTML);\n    };\n    var PasteBin = function (editor) {\n      var lastRng = Cell(null);\n      var pasteBinDefaultContent = '%MCEPASTEBIN%';\n      return {\n        create: function () {\n          return create(editor, lastRng, pasteBinDefaultContent);\n        },\n        remove: function () {\n          return remove(editor, lastRng);\n        },\n        getEl: function () {\n          return getEl(editor);\n        },\n        getHtml: function () {\n          return getHtml(editor);\n        },\n        getLastRng: function () {\n          return getLastRng(lastRng);\n        },\n        isDefault: function () {\n          return isDefault(editor, pasteBinDefaultContent);\n        },\n        isDefaultContent: function (content) {\n          return isDefaultContent(pasteBinDefaultContent, content);\n        }\n      };\n    };\n\n    var Clipboard = function (editor, pasteFormat) {\n      var pasteBin = PasteBin(editor);\n      editor.on('PreInit', function () {\n        return registerEventsAndFilters(editor, pasteBin, pasteFormat);\n      });\n      return {\n        pasteFormat: pasteFormat,\n        pasteHtml: function (html, internalFlag) {\n          return pasteHtml$1(editor, html, internalFlag);\n        },\n        pasteText: function (text) {\n          return pasteText(editor, text);\n        },\n        pasteImageData: function (e, rng) {\n          return pasteImageData(editor, e, rng);\n        },\n        getDataTransferItems: getDataTransferItems,\n        hasHtmlOrText: hasHtmlOrText,\n        hasContentType: hasContentType\n      };\n    };\n\n    var togglePlainTextPaste = function (editor, clipboard) {\n      if (clipboard.pasteFormat.get() === 'text') {\n        clipboard.pasteFormat.set('html');\n        firePastePlainTextToggle(editor, false);\n      } else {\n        clipboard.pasteFormat.set('text');\n        firePastePlainTextToggle(editor, true);\n      }\n      editor.focus();\n    };\n\n    var register = function (editor, clipboard) {\n      editor.addCommand('mceTogglePlainTextPaste', function () {\n        togglePlainTextPaste(editor, clipboard);\n      });\n      editor.addCommand('mceInsertClipboardContent', function (ui, value) {\n        if (value.content) {\n          clipboard.pasteHtml(value.content, value.internal);\n        }\n        if (value.text) {\n          clipboard.pasteText(value.text);\n        }\n      });\n    };\n\n    var hasWorkingClipboardApi = function (clipboardData) {\n      return global$1.iOS === false && typeof (clipboardData === null || clipboardData === void 0 ? void 0 : clipboardData.setData) === 'function';\n    };\n    var setHtml5Clipboard = function (clipboardData, html, text) {\n      if (hasWorkingClipboardApi(clipboardData)) {\n        try {\n          clipboardData.clearData();\n          clipboardData.setData('text/html', html);\n          clipboardData.setData('text/plain', text);\n          clipboardData.setData(internalHtmlMime(), html);\n          return true;\n        } catch (e) {\n          return false;\n        }\n      } else {\n        return false;\n      }\n    };\n    var setClipboardData = function (evt, data, fallback, done) {\n      if (setHtml5Clipboard(evt.clipboardData, data.html, data.text)) {\n        evt.preventDefault();\n        done();\n      } else {\n        fallback(data.html, done);\n      }\n    };\n    var fallback = function (editor) {\n      return function (html, done) {\n        var markedHtml = mark(html);\n        var outer = editor.dom.create('div', {\n          'contenteditable': 'false',\n          'data-mce-bogus': 'all'\n        });\n        var inner = editor.dom.create('div', { contenteditable: 'true' }, markedHtml);\n        editor.dom.setStyles(outer, {\n          position: 'fixed',\n          top: '0',\n          left: '-3000px',\n          width: '1000px',\n          overflow: 'hidden'\n        });\n        outer.appendChild(inner);\n        editor.dom.add(editor.getBody(), outer);\n        var range = editor.selection.getRng();\n        inner.focus();\n        var offscreenRange = editor.dom.createRng();\n        offscreenRange.selectNodeContents(inner);\n        editor.selection.setRng(offscreenRange);\n        global$2.setTimeout(function () {\n          editor.selection.setRng(range);\n          outer.parentNode.removeChild(outer);\n          done();\n        }, 0);\n      };\n    };\n    var getData = function (editor) {\n      return {\n        html: editor.selection.getContent({ contextual: true }),\n        text: editor.selection.getContent({ format: 'text' })\n      };\n    };\n    var isTableSelection = function (editor) {\n      return !!editor.dom.getParent(editor.selection.getStart(), 'td[data-mce-selected],th[data-mce-selected]', editor.getBody());\n    };\n    var hasSelectedContent = function (editor) {\n      return !editor.selection.isCollapsed() || isTableSelection(editor);\n    };\n    var cut = function (editor) {\n      return function (evt) {\n        if (hasSelectedContent(editor)) {\n          setClipboardData(evt, getData(editor), fallback(editor), function () {\n            if (global$1.browser.isChrome() || global$1.browser.isFirefox()) {\n              var rng_1 = editor.selection.getRng();\n              global$2.setEditorTimeout(editor, function () {\n                editor.selection.setRng(rng_1);\n                editor.execCommand('Delete');\n              }, 0);\n            } else {\n              editor.execCommand('Delete');\n            }\n          });\n        }\n      };\n    };\n    var copy = function (editor) {\n      return function (evt) {\n        if (hasSelectedContent(editor)) {\n          setClipboardData(evt, getData(editor), fallback(editor), noop);\n        }\n      };\n    };\n    var register$1 = function (editor) {\n      editor.on('cut', cut(editor));\n      editor.on('copy', copy(editor));\n    };\n\n    var global$b = tinymce.util.Tools.resolve('tinymce.dom.RangeUtils');\n\n    var getCaretRangeFromEvent = function (editor, e) {\n      return global$b.getCaretRangeFromPoint(e.clientX, e.clientY, editor.getDoc());\n    };\n    var isPlainTextFileUrl = function (content) {\n      var plainTextContent = content['text/plain'];\n      return plainTextContent ? plainTextContent.indexOf('file://') === 0 : false;\n    };\n    var setFocusedRange = function (editor, rng) {\n      editor.focus();\n      editor.selection.setRng(rng);\n    };\n    var setup = function (editor, clipboard, draggingInternallyState) {\n      if (shouldBlockDrop(editor)) {\n        editor.on('dragend dragover draggesture dragdrop drop drag', function (e) {\n          e.preventDefault();\n          e.stopPropagation();\n        });\n      }\n      if (!shouldPasteDataImages(editor)) {\n        editor.on('drop', function (e) {\n          var dataTransfer = e.dataTransfer;\n          if (dataTransfer && dataTransfer.files && dataTransfer.files.length > 0) {\n            e.preventDefault();\n          }\n        });\n      }\n      editor.on('drop', function (e) {\n        var rng = getCaretRangeFromEvent(editor, e);\n        if (e.isDefaultPrevented() || draggingInternallyState.get()) {\n          return;\n        }\n        var dropContent = clipboard.getDataTransferItems(e.dataTransfer);\n        var internal = clipboard.hasContentType(dropContent, internalHtmlMime());\n        if ((!clipboard.hasHtmlOrText(dropContent) || isPlainTextFileUrl(dropContent)) && clipboard.pasteImageData(e, rng)) {\n          return;\n        }\n        if (rng && shouldFilterDrop(editor)) {\n          var content_1 = dropContent['mce-internal'] || dropContent['text/html'] || dropContent['text/plain'];\n          if (content_1) {\n            e.preventDefault();\n            global$2.setEditorTimeout(editor, function () {\n              editor.undoManager.transact(function () {\n                if (dropContent['mce-internal']) {\n                  editor.execCommand('Delete');\n                }\n                setFocusedRange(editor, rng);\n                content_1 = trimHtml(content_1);\n                if (!dropContent['text/html']) {\n                  clipboard.pasteText(content_1);\n                } else {\n                  clipboard.pasteHtml(content_1, internal);\n                }\n              });\n            });\n          }\n        }\n      });\n      editor.on('dragstart', function (_e) {\n        draggingInternallyState.set(true);\n      });\n      editor.on('dragover dragend', function (e) {\n        if (shouldPasteDataImages(editor) && draggingInternallyState.get() === false) {\n          e.preventDefault();\n          setFocusedRange(editor, getCaretRangeFromEvent(editor, e));\n        }\n        if (e.type === 'dragend') {\n          draggingInternallyState.set(false);\n        }\n      });\n    };\n\n    var setup$1 = function (editor) {\n      var plugin = editor.plugins.paste;\n      var preProcess = getPreProcess(editor);\n      if (preProcess) {\n        editor.on('PastePreProcess', function (e) {\n          preProcess.call(plugin, plugin, e);\n        });\n      }\n      var postProcess = getPostProcess(editor);\n      if (postProcess) {\n        editor.on('PastePostProcess', function (e) {\n          postProcess.call(plugin, plugin, e);\n        });\n      }\n    };\n\n    var addPreProcessFilter = function (editor, filterFunc) {\n      editor.on('PastePreProcess', function (e) {\n        e.content = filterFunc(editor, e.content, e.internal, e.wordContent);\n      });\n    };\n    var addPostProcessFilter = function (editor, filterFunc) {\n      editor.on('PastePostProcess', function (e) {\n        filterFunc(editor, e.node);\n      });\n    };\n    var removeExplorerBrElementsAfterBlocks = function (editor, html) {\n      if (!isWordContent(html)) {\n        return html;\n      }\n      var blockElements = [];\n      global$5.each(editor.schema.getBlockElements(), function (block, blockName) {\n        blockElements.push(blockName);\n      });\n      var explorerBlocksRegExp = new RegExp('(?:<br>&nbsp;[\\\\s\\\\r\\\\n]+|<br>)*(<\\\\/?(' + blockElements.join('|') + ')[^>]*>)(?:<br>&nbsp;[\\\\s\\\\r\\\\n]+|<br>)*', 'g');\n      html = filter$1(html, [[\n          explorerBlocksRegExp,\n          '$1'\n        ]]);\n      html = filter$1(html, [\n        [\n          /<br><br>/g,\n          '<BR><BR>'\n        ],\n        [\n          /<br>/g,\n          ' '\n        ],\n        [\n          /<BR><BR>/g,\n          '<br>'\n        ]\n      ]);\n      return html;\n    };\n    var removeWebKitStyles = function (editor, content, internal, isWordHtml) {\n      if (isWordHtml || internal) {\n        return content;\n      }\n      var webKitStylesSetting = getWebkitStyles(editor);\n      var webKitStyles;\n      if (shouldRemoveWebKitStyles(editor) === false || webKitStylesSetting === 'all') {\n        return content;\n      }\n      if (webKitStylesSetting) {\n        webKitStyles = webKitStylesSetting.split(/[, ]/);\n      }\n      if (webKitStyles) {\n        var dom_1 = editor.dom, node_1 = editor.selection.getNode();\n        content = content.replace(/(<[^>]+) style=\"([^\"]*)\"([^>]*>)/gi, function (all, before, value, after) {\n          var inputStyles = dom_1.parseStyle(dom_1.decode(value));\n          var outputStyles = {};\n          if (webKitStyles === 'none') {\n            return before + after;\n          }\n          for (var i = 0; i < webKitStyles.length; i++) {\n            var inputValue = inputStyles[webKitStyles[i]], currentValue = dom_1.getStyle(node_1, webKitStyles[i], true);\n            if (/color/.test(webKitStyles[i])) {\n              inputValue = dom_1.toHex(inputValue);\n              currentValue = dom_1.toHex(currentValue);\n            }\n            if (currentValue !== inputValue) {\n              outputStyles[webKitStyles[i]] = inputValue;\n            }\n          }\n          outputStyles = dom_1.serializeStyle(outputStyles, 'span');\n          if (outputStyles) {\n            return before + ' style=\"' + outputStyles + '\"' + after;\n          }\n          return before + after;\n        });\n      } else {\n        content = content.replace(/(<[^>]+) style=\"([^\"]*)\"([^>]*>)/gi, '$1$3');\n      }\n      content = content.replace(/(<[^>]+) data-mce-style=\"([^\"]+)\"([^>]*>)/gi, function (all, before, value, after) {\n        return before + ' style=\"' + value + '\"' + after;\n      });\n      return content;\n    };\n    var removeUnderlineAndFontInAnchor = function (editor, root) {\n      editor.$('a', root).find('font,u').each(function (i, node) {\n        editor.dom.remove(node, true);\n      });\n    };\n    var setup$2 = function (editor) {\n      if (global$1.webkit) {\n        addPreProcessFilter(editor, removeWebKitStyles);\n      }\n      if (global$1.ie) {\n        addPreProcessFilter(editor, removeExplorerBrElementsAfterBlocks);\n        addPostProcessFilter(editor, removeUnderlineAndFontInAnchor);\n      }\n    };\n\n    var makeSetupHandler = function (editor, clipboard) {\n      return function (api) {\n        api.setActive(clipboard.pasteFormat.get() === 'text');\n        var pastePlainTextToggleHandler = function (e) {\n          return api.setActive(e.state);\n        };\n        editor.on('PastePlainTextToggle', pastePlainTextToggleHandler);\n        return function () {\n          return editor.off('PastePlainTextToggle', pastePlainTextToggleHandler);\n        };\n      };\n    };\n    var register$2 = function (editor, clipboard) {\n      editor.ui.registry.addToggleButton('pastetext', {\n        active: false,\n        icon: 'paste-text',\n        tooltip: 'Paste as text',\n        onAction: function () {\n          return editor.execCommand('mceTogglePlainTextPaste');\n        },\n        onSetup: makeSetupHandler(editor, clipboard)\n      });\n      editor.ui.registry.addToggleMenuItem('pastetext', {\n        text: 'Paste as text',\n        icon: 'paste-text',\n        onAction: function () {\n          return editor.execCommand('mceTogglePlainTextPaste');\n        },\n        onSetup: makeSetupHandler(editor, clipboard)\n      });\n    };\n\n    function Plugin () {\n      global.add('paste', function (editor) {\n        if (hasProPlugin(editor) === false) {\n          var draggingInternallyState = Cell(false);\n          var pasteFormat = Cell(isPasteAsTextEnabled(editor) ? 'text' : 'html');\n          var clipboard = Clipboard(editor, pasteFormat);\n          var quirks = setup$2(editor);\n          register$2(editor, clipboard);\n          register(editor, clipboard);\n          setup$1(editor);\n          register$1(editor);\n          setup(editor, clipboard, draggingInternallyState);\n          return get(clipboard, quirks);\n        }\n      });\n    }\n\n    Plugin();\n\n}());\n"]},"metadata":{},"sourceType":"script"}