{"ast":null,"code":"/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.7.1 (2021-03-17)\n */\n(function () {\n  'use strict';\n\n  var typeOf = function (x) {\n    if (x === null) {\n      return 'null';\n    }\n\n    if (x === undefined) {\n      return 'undefined';\n    }\n\n    var t = typeof x;\n\n    if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    }\n\n    if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    }\n\n    return t;\n  };\n\n  var isEquatableType = function (x) {\n    return ['undefined', 'boolean', 'number', 'string', 'function', 'xml', 'null'].indexOf(x) !== -1;\n  };\n\n  var sort = function (xs, compareFn) {\n    var clone = Array.prototype.slice.call(xs);\n    return clone.sort(compareFn);\n  };\n\n  var contramap = function (eqa, f) {\n    return eq(function (x, y) {\n      return eqa.eq(f(x), f(y));\n    });\n  };\n\n  var eq = function (f) {\n    return {\n      eq: f\n    };\n  };\n\n  var tripleEq = eq(function (x, y) {\n    return x === y;\n  });\n  var eqString = tripleEq;\n\n  var eqArray = function (eqa) {\n    return eq(function (x, y) {\n      if (x.length !== y.length) {\n        return false;\n      }\n\n      var len = x.length;\n\n      for (var i = 0; i < len; i++) {\n        if (!eqa.eq(x[i], y[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    });\n  };\n\n  var eqSortedArray = function (eqa, compareFn) {\n    return contramap(eqArray(eqa), function (xs) {\n      return sort(xs, compareFn);\n    });\n  };\n\n  var eqRecord = function (eqa) {\n    return eq(function (x, y) {\n      var kx = Object.keys(x);\n      var ky = Object.keys(y);\n\n      if (!eqSortedArray(eqString).eq(kx, ky)) {\n        return false;\n      }\n\n      var len = kx.length;\n\n      for (var i = 0; i < len; i++) {\n        var q = kx[i];\n\n        if (!eqa.eq(x[q], y[q])) {\n          return false;\n        }\n      }\n\n      return true;\n    });\n  };\n\n  var eqAny = eq(function (x, y) {\n    if (x === y) {\n      return true;\n    }\n\n    var tx = typeOf(x);\n    var ty = typeOf(y);\n\n    if (tx !== ty) {\n      return false;\n    }\n\n    if (isEquatableType(tx)) {\n      return x === y;\n    } else if (tx === 'array') {\n      return eqArray(eqAny).eq(x, y);\n    } else if (tx === 'object') {\n      return eqRecord(eqAny).eq(x, y);\n    }\n\n    return false;\n  });\n\n  var noop = function () {};\n\n  var compose = function (fa, fb) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return fa(fb.apply(null, args));\n    };\n  };\n\n  var compose1 = function (fbc, fab) {\n    return function (a) {\n      return fbc(fab(a));\n    };\n  };\n\n  var constant = function (value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var identity = function (x) {\n    return x;\n  };\n\n  function curry(fn) {\n    var initialArgs = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      initialArgs[_i - 1] = arguments[_i];\n    }\n\n    return function () {\n      var restArgs = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        restArgs[_i] = arguments[_i];\n      }\n\n      var all = initialArgs.concat(restArgs);\n      return fn.apply(null, all);\n    };\n  }\n\n  var not = function (f) {\n    return function (t) {\n      return !f(t);\n    };\n  };\n\n  var die = function (msg) {\n    return function () {\n      throw new Error(msg);\n    };\n  };\n\n  var apply = function (f) {\n    return f();\n  };\n\n  var call = function (f) {\n    f();\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n\n  var none = function () {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var eq = function (o) {\n      return o.isNone();\n    };\n\n    var call = function (thunk) {\n      return thunk();\n    };\n\n    var id = function (n) {\n      return n;\n    };\n\n    var me = {\n      fold: function (n, _s) {\n        return n();\n      },\n      is: never,\n      isSome: never,\n      isNone: always,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function (msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: constant(null),\n      getOrUndefined: constant(undefined),\n      or: id,\n      orThunk: call,\n      map: none,\n      each: noop,\n      bind: none,\n      exists: never,\n      forall: always,\n      filter: none,\n      equals: eq,\n      equals_: eq,\n      toArray: function () {\n        return [];\n      },\n      toString: constant('none()')\n    };\n    return me;\n  }();\n\n  var some = function (a) {\n    var constant_a = constant(a);\n\n    var self = function () {\n      return me;\n    };\n\n    var bind = function (f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function (n, s) {\n        return s(a);\n      },\n      is: function (v) {\n        return a === v;\n      },\n      isSome: always,\n      isNone: never,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: function (f) {\n        return some(f(a));\n      },\n      each: function (f) {\n        f(a);\n      },\n      bind: bind,\n      exists: bind,\n      forall: bind,\n      filter: function (f) {\n        return f(a) ? me : NONE;\n      },\n      toArray: function () {\n        return [a];\n      },\n      toString: function () {\n        return 'some(' + a + ')';\n      },\n      equals: function (o) {\n        return o.is(a);\n      },\n      equals_: function (o, elementEq) {\n        return o.fold(never, function (b) {\n          return elementEq(a, b);\n        });\n      }\n    };\n    return me;\n  };\n\n  var from = function (value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Optional = {\n    some: some,\n    none: none,\n    from: from\n  };\n\n  var typeOf$1 = function (x) {\n    var t = typeof x;\n\n    if (x === null) {\n      return 'null';\n    } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    } else {\n      return t;\n    }\n  };\n\n  var isType = function (type) {\n    return function (value) {\n      return typeOf$1(value) === type;\n    };\n  };\n\n  var isSimpleType = function (type) {\n    return function (value) {\n      return typeof value === type;\n    };\n  };\n\n  var eq$1 = function (t) {\n    return function (a) {\n      return t === a;\n    };\n  };\n\n  var isString = isType('string');\n  var isObject = isType('object');\n  var isArray = isType('array');\n  var isNull = eq$1(null);\n  var isBoolean = isSimpleType('boolean');\n  var isUndefined = eq$1(undefined);\n\n  var isNullable = function (a) {\n    return a === null || a === undefined;\n  };\n\n  var isNonNullable = function (a) {\n    return !isNullable(a);\n  };\n\n  var isFunction = isSimpleType('function');\n  var isNumber = isSimpleType('number');\n  var nativeSlice = Array.prototype.slice;\n  var nativeIndexOf = Array.prototype.indexOf;\n  var nativePush = Array.prototype.push;\n\n  var rawIndexOf = function (ts, t) {\n    return nativeIndexOf.call(ts, t);\n  };\n\n  var indexOf = function (xs, x) {\n    var r = rawIndexOf(xs, x);\n    return r === -1 ? Optional.none() : Optional.some(r);\n  };\n\n  var contains = function (xs, x) {\n    return rawIndexOf(xs, x) > -1;\n  };\n\n  var exists = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var map = function (xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var each = function (xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var eachr = function (xs, f) {\n    for (var i = xs.length - 1; i >= 0; i--) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var partition = function (xs, pred) {\n    var pass = [];\n    var fail = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      var arr = pred(x, i) ? pass : fail;\n      arr.push(x);\n    }\n\n    return {\n      pass: pass,\n      fail: fail\n    };\n  };\n\n  var filter = function (xs, pred) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        r.push(x);\n      }\n    }\n\n    return r;\n  };\n\n  var foldr = function (xs, f, acc) {\n    eachr(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var foldl = function (xs, f, acc) {\n    each(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var findUntil = function (xs, pred, until) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(x);\n      } else if (until(x, i)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var find = function (xs, pred) {\n    return findUntil(xs, pred, never);\n  };\n\n  var findIndex = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(i);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var flatten = function (xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      nativePush.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var bind = function (xs, f) {\n    return flatten(map(xs, f));\n  };\n\n  var forall = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      var x = xs[i];\n\n      if (pred(x, i) !== true) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  var reverse = function (xs) {\n    var r = nativeSlice.call(xs, 0);\n    r.reverse();\n    return r;\n  };\n\n  var difference = function (a1, a2) {\n    return filter(a1, function (x) {\n      return !contains(a2, x);\n    });\n  };\n\n  var mapToObject = function (xs, f) {\n    var r = {};\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      r[String(x)] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var sort$1 = function (xs, comparator) {\n    var copy = nativeSlice.call(xs, 0);\n    copy.sort(comparator);\n    return copy;\n  };\n\n  var get = function (xs, i) {\n    return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n  };\n\n  var head = function (xs) {\n    return get(xs, 0);\n  };\n\n  var last = function (xs) {\n    return get(xs, xs.length - 1);\n  };\n\n  var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n    return nativeSlice.call(x);\n  };\n\n  var findMap = function (arr, f) {\n    for (var i = 0; i < arr.length; i++) {\n      var r = f(arr[i], i);\n\n      if (r.isSome()) {\n        return r;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var keys = Object.keys;\n  var hasOwnProperty = Object.hasOwnProperty;\n\n  var each$1 = function (obj, f) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n      f(x, i);\n    }\n  };\n\n  var map$1 = function (obj, f) {\n    return tupleMap(obj, function (x, i) {\n      return {\n        k: i,\n        v: f(x, i)\n      };\n    });\n  };\n\n  var tupleMap = function (obj, f) {\n    var r = {};\n    each$1(obj, function (x, i) {\n      var tuple = f(x, i);\n      r[tuple.k] = tuple.v;\n    });\n    return r;\n  };\n\n  var objAcc = function (r) {\n    return function (x, i) {\n      r[i] = x;\n    };\n  };\n\n  var internalFilter = function (obj, pred, onTrue, onFalse) {\n    var r = {};\n    each$1(obj, function (x, i) {\n      (pred(x, i) ? onTrue : onFalse)(x, i);\n    });\n    return r;\n  };\n\n  var bifilter = function (obj, pred) {\n    var t = {};\n    var f = {};\n    internalFilter(obj, pred, objAcc(t), objAcc(f));\n    return {\n      t: t,\n      f: f\n    };\n  };\n\n  var filter$1 = function (obj, pred) {\n    var t = {};\n    internalFilter(obj, pred, objAcc(t), noop);\n    return t;\n  };\n\n  var mapToArray = function (obj, f) {\n    var r = [];\n    each$1(obj, function (value, name) {\n      r.push(f(value, name));\n    });\n    return r;\n  };\n\n  var values = function (obj) {\n    return mapToArray(obj, function (v) {\n      return v;\n    });\n  };\n\n  var get$1 = function (obj, key) {\n    return has(obj, key) ? Optional.from(obj[key]) : Optional.none();\n  };\n\n  var has = function (obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  var hasNonNullableKey = function (obj, key) {\n    return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n  };\n\n  var equal = function (a1, a2, eq) {\n    if (eq === void 0) {\n      eq = eqAny;\n    }\n\n    return eqRecord(eq).eq(a1, a2);\n  };\n\n  var isArray$1 = Array.isArray;\n\n  var toArray = function (obj) {\n    if (!isArray$1(obj)) {\n      var array = [];\n\n      for (var i = 0, l = obj.length; i < l; i++) {\n        array[i] = obj[i];\n      }\n\n      return array;\n    } else {\n      return obj;\n    }\n  };\n\n  var each$2 = function (o, cb, s) {\n    var n, l;\n\n    if (!o) {\n      return false;\n    }\n\n    s = s || o;\n\n    if (o.length !== undefined) {\n      for (n = 0, l = o.length; n < l; n++) {\n        if (cb.call(s, o[n], n, o) === false) {\n          return false;\n        }\n      }\n    } else {\n      for (n in o) {\n        if (o.hasOwnProperty(n)) {\n          if (cb.call(s, o[n], n, o) === false) {\n            return false;\n          }\n        }\n      }\n    }\n\n    return true;\n  };\n\n  var map$2 = function (array, callback) {\n    var out = [];\n    each$2(array, function (item, index) {\n      out.push(callback(item, index, array));\n    });\n    return out;\n  };\n\n  var filter$2 = function (a, f) {\n    var o = [];\n    each$2(a, function (v, index) {\n      if (!f || f(v, index, a)) {\n        o.push(v);\n      }\n    });\n    return o;\n  };\n\n  var indexOf$1 = function (a, v) {\n    if (a) {\n      for (var i = 0, l = a.length; i < l; i++) {\n        if (a[i] === v) {\n          return i;\n        }\n      }\n    }\n\n    return -1;\n  };\n\n  var reduce = function (collection, iteratee, accumulator, thisArg) {\n    var acc = isUndefined(accumulator) ? collection[0] : accumulator;\n\n    for (var i = 0; i < collection.length; i++) {\n      acc = iteratee.call(thisArg, acc, collection[i], i);\n    }\n\n    return acc;\n  };\n\n  var findIndex$1 = function (array, predicate, thisArg) {\n    var i, l;\n\n    for (i = 0, l = array.length; i < l; i++) {\n      if (predicate.call(thisArg, array[i], i, array)) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n\n  var last$1 = function (collection) {\n    return collection[collection.length - 1];\n  };\n\n  var __assign = function () {\n    __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n\n      return t;\n    };\n\n    return __assign.apply(this, arguments);\n  };\n\n  function __rest(s, e) {\n    var t = {};\n\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n    if (s != null && typeof Object.getOwnPropertySymbols === 'function') for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n      if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n    }\n    return t;\n  }\n\n  function __spreadArrays() {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n    for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n    return r;\n  }\n\n  var cached = function (f) {\n    var called = false;\n    var r;\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!called) {\n        called = true;\n        r = f.apply(null, args);\n      }\n\n      return r;\n    };\n  };\n\n  var DeviceType = function (os, browser, userAgent, mediaMatch) {\n    var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n    var isiPhone = os.isiOS() && !isiPad;\n    var isMobile = os.isiOS() || os.isAndroid();\n    var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n    var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n    var isPhone = isiPhone || isMobile && !isTablet;\n    var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n    var isDesktop = !isPhone && !isTablet && !iOSwebview;\n    return {\n      isiPad: constant(isiPad),\n      isiPhone: constant(isiPhone),\n      isTablet: constant(isTablet),\n      isPhone: constant(isPhone),\n      isTouch: constant(isTouch),\n      isAndroid: os.isAndroid,\n      isiOS: os.isiOS,\n      isWebView: constant(iOSwebview),\n      isDesktop: constant(isDesktop)\n    };\n  };\n\n  var firstMatch = function (regexes, s) {\n    for (var i = 0; i < regexes.length; i++) {\n      var x = regexes[i];\n\n      if (x.test(s)) {\n        return x;\n      }\n    }\n\n    return undefined;\n  };\n\n  var find$1 = function (regexes, agent) {\n    var r = firstMatch(regexes, agent);\n\n    if (!r) {\n      return {\n        major: 0,\n        minor: 0\n      };\n    }\n\n    var group = function (i) {\n      return Number(agent.replace(r, '$' + i));\n    };\n\n    return nu(group(1), group(2));\n  };\n\n  var detect = function (versionRegexes, agent) {\n    var cleanedAgent = String(agent).toLowerCase();\n\n    if (versionRegexes.length === 0) {\n      return unknown();\n    }\n\n    return find$1(versionRegexes, cleanedAgent);\n  };\n\n  var unknown = function () {\n    return nu(0, 0);\n  };\n\n  var nu = function (major, minor) {\n    return {\n      major: major,\n      minor: minor\n    };\n  };\n\n  var Version = {\n    nu: nu,\n    detect: detect,\n    unknown: unknown\n  };\n\n  var detect$1 = function (candidates, userAgent) {\n    var agent = String(userAgent).toLowerCase();\n    return find(candidates, function (candidate) {\n      return candidate.search(agent);\n    });\n  };\n\n  var detectBrowser = function (browsers, userAgent) {\n    return detect$1(browsers, userAgent).map(function (browser) {\n      var version = Version.detect(browser.versionRegexes, userAgent);\n      return {\n        current: browser.name,\n        version: version\n      };\n    });\n  };\n\n  var detectOs = function (oses, userAgent) {\n    return detect$1(oses, userAgent).map(function (os) {\n      var version = Version.detect(os.versionRegexes, userAgent);\n      return {\n        current: os.name,\n        version: version\n      };\n    });\n  };\n\n  var UaString = {\n    detectBrowser: detectBrowser,\n    detectOs: detectOs\n  };\n\n  var removeFromStart = function (str, numChars) {\n    return str.substring(numChars);\n  };\n\n  var checkRange = function (str, substr, start) {\n    return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n  };\n\n  var removeLeading = function (str, prefix) {\n    return startsWith(str, prefix) ? removeFromStart(str, prefix.length) : str;\n  };\n\n  var contains$1 = function (str, substr) {\n    return str.indexOf(substr) !== -1;\n  };\n\n  var startsWith = function (str, prefix) {\n    return checkRange(str, prefix, 0);\n  };\n\n  var blank = function (r) {\n    return function (s) {\n      return s.replace(r, '');\n    };\n  };\n\n  var trim = blank(/^\\s+|\\s+$/g);\n  var lTrim = blank(/^\\s+/g);\n  var rTrim = blank(/\\s+$/g);\n  var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n\n  var checkContains = function (target) {\n    return function (uastring) {\n      return contains$1(uastring, target);\n    };\n  };\n\n  var browsers = [{\n    name: 'Edge',\n    versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n    search: function (uastring) {\n      return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n    }\n  }, {\n    name: 'Chrome',\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/, normalVersionRegex],\n    search: function (uastring) {\n      return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n    }\n  }, {\n    name: 'IE',\n    versionRegexes: [/.*?msie\\ ?([0-9]+)\\.([0-9]+).*/, /.*?rv:([0-9]+)\\.([0-9]+).*/],\n    search: function (uastring) {\n      return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n    }\n  }, {\n    name: 'Opera',\n    versionRegexes: [normalVersionRegex, /.*?opera\\/([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('opera')\n  }, {\n    name: 'Firefox',\n    versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('firefox')\n  }, {\n    name: 'Safari',\n    versionRegexes: [normalVersionRegex, /.*?cpu os ([0-9]+)_([0-9]+).*/],\n    search: function (uastring) {\n      return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n    }\n  }];\n  var oses = [{\n    name: 'Windows',\n    search: checkContains('win'),\n    versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'iOS',\n    search: function (uastring) {\n      return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n    },\n    versionRegexes: [/.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Android',\n    search: checkContains('android'),\n    versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'OSX',\n    search: checkContains('mac os x'),\n    versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Linux',\n    search: checkContains('linux'),\n    versionRegexes: []\n  }, {\n    name: 'Solaris',\n    search: checkContains('sunos'),\n    versionRegexes: []\n  }, {\n    name: 'FreeBSD',\n    search: checkContains('freebsd'),\n    versionRegexes: []\n  }, {\n    name: 'ChromeOS',\n    search: checkContains('cros'),\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n  }];\n  var PlatformInfo = {\n    browsers: constant(browsers),\n    oses: constant(oses)\n  };\n  var edge = 'Edge';\n  var chrome = 'Chrome';\n  var ie = 'IE';\n  var opera = 'Opera';\n  var firefox = 'Firefox';\n  var safari = 'Safari';\n\n  var unknown$1 = function () {\n    return nu$1({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$1 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isBrowser = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isEdge: isBrowser(edge),\n      isChrome: isBrowser(chrome),\n      isIE: isBrowser(ie),\n      isOpera: isBrowser(opera),\n      isFirefox: isBrowser(firefox),\n      isSafari: isBrowser(safari)\n    };\n  };\n\n  var Browser = {\n    unknown: unknown$1,\n    nu: nu$1,\n    edge: constant(edge),\n    chrome: constant(chrome),\n    ie: constant(ie),\n    opera: constant(opera),\n    firefox: constant(firefox),\n    safari: constant(safari)\n  };\n  var windows = 'Windows';\n  var ios = 'iOS';\n  var android = 'Android';\n  var linux = 'Linux';\n  var osx = 'OSX';\n  var solaris = 'Solaris';\n  var freebsd = 'FreeBSD';\n  var chromeos = 'ChromeOS';\n\n  var unknown$2 = function () {\n    return nu$2({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$2 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isOS = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isWindows: isOS(windows),\n      isiOS: isOS(ios),\n      isAndroid: isOS(android),\n      isOSX: isOS(osx),\n      isLinux: isOS(linux),\n      isSolaris: isOS(solaris),\n      isFreeBSD: isOS(freebsd),\n      isChromeOS: isOS(chromeos)\n    };\n  };\n\n  var OperatingSystem = {\n    unknown: unknown$2,\n    nu: nu$2,\n    windows: constant(windows),\n    ios: constant(ios),\n    android: constant(android),\n    linux: constant(linux),\n    osx: constant(osx),\n    solaris: constant(solaris),\n    freebsd: constant(freebsd),\n    chromeos: constant(chromeos)\n  };\n\n  var detect$2 = function (userAgent, mediaMatch) {\n    var browsers = PlatformInfo.browsers();\n    var oses = PlatformInfo.oses();\n    var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n    var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n    var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n    return {\n      browser: browser,\n      os: os,\n      deviceType: deviceType\n    };\n  };\n\n  var PlatformDetection = {\n    detect: detect$2\n  };\n\n  var mediaMatch = function (query) {\n    return window.matchMedia(query).matches;\n  };\n\n  var platform = cached(function () {\n    return PlatformDetection.detect(navigator.userAgent, mediaMatch);\n  });\n\n  var detect$3 = function () {\n    return platform();\n  };\n\n  var userAgent = navigator.userAgent;\n  var platform$1 = detect$3();\n  var browser = platform$1.browser;\n  var os = platform$1.os;\n  var deviceType = platform$1.deviceType;\n  var webkit = /WebKit/.test(userAgent) && !browser.isEdge();\n  var fileApi = 'FormData' in window && 'FileReader' in window && 'URL' in window && !!URL.createObjectURL;\n  var windowsPhone = userAgent.indexOf('Windows Phone') !== -1;\n  var Env = {\n    opera: browser.isOpera(),\n    webkit: webkit,\n    ie: browser.isIE() || browser.isEdge() ? browser.version.major : false,\n    gecko: browser.isFirefox(),\n    mac: os.isOSX() || os.isiOS(),\n    iOS: deviceType.isiPad() || deviceType.isiPhone(),\n    android: os.isAndroid(),\n    contentEditable: true,\n    transparentSrc: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',\n    caretAfter: true,\n    range: window.getSelection && 'Range' in window,\n    documentMode: browser.isIE() ? document.documentMode || 7 : 10,\n    fileApi: fileApi,\n    ceFalse: true,\n    cacheSuffix: null,\n    container: null,\n    experimentalShadowDom: false,\n    canHaveCSP: !browser.isIE(),\n    desktop: deviceType.isDesktop(),\n    windowsPhone: windowsPhone,\n    browser: {\n      current: browser.current,\n      version: browser.version,\n      isChrome: browser.isChrome,\n      isEdge: browser.isEdge,\n      isFirefox: browser.isFirefox,\n      isIE: browser.isIE,\n      isOpera: browser.isOpera,\n      isSafari: browser.isSafari\n    },\n    os: {\n      current: os.current,\n      version: os.version,\n      isAndroid: os.isAndroid,\n      isChromeOS: os.isChromeOS,\n      isFreeBSD: os.isFreeBSD,\n      isiOS: os.isiOS,\n      isLinux: os.isLinux,\n      isOSX: os.isOSX,\n      isSolaris: os.isSolaris,\n      isWindows: os.isWindows\n    },\n    deviceType: {\n      isDesktop: deviceType.isDesktop,\n      isiPad: deviceType.isiPad,\n      isiPhone: deviceType.isiPhone,\n      isPhone: deviceType.isPhone,\n      isTablet: deviceType.isTablet,\n      isTouch: deviceType.isTouch,\n      isWebView: deviceType.isWebView\n    }\n  };\n  var whiteSpaceRegExp = /^\\s*|\\s*$/g;\n\n  var trim$1 = function (str) {\n    return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp, '');\n  };\n\n  var is = function (obj, type) {\n    if (!type) {\n      return obj !== undefined;\n    }\n\n    if (type === 'array' && isArray$1(obj)) {\n      return true;\n    }\n\n    return typeof obj === type;\n  };\n\n  var makeMap = function (items, delim, map) {\n    var i;\n    items = items || [];\n    delim = delim || ',';\n\n    if (typeof items === 'string') {\n      items = items.split(delim);\n    }\n\n    map = map || {};\n    i = items.length;\n\n    while (i--) {\n      map[items[i]] = {};\n    }\n\n    return map;\n  };\n\n  var hasOwnProperty$1 = function (obj, prop) {\n    return Object.prototype.hasOwnProperty.call(obj, prop);\n  };\n\n  var create = function (s, p, root) {\n    var self = this;\n    var sp,\n        scn,\n        c,\n        de = 0;\n    s = /^((static) )?([\\w.]+)(:([\\w.]+))?/.exec(s);\n    var cn = s[3].match(/(^|\\.)(\\w+)$/i)[2];\n    var ns = self.createNS(s[3].replace(/\\.\\w+$/, ''), root);\n\n    if (ns[cn]) {\n      return;\n    }\n\n    if (s[2] === 'static') {\n      ns[cn] = p;\n\n      if (this.onCreate) {\n        this.onCreate(s[2], s[3], ns[cn]);\n      }\n\n      return;\n    }\n\n    if (!p[cn]) {\n      p[cn] = noop;\n      de = 1;\n    }\n\n    ns[cn] = p[cn];\n    self.extend(ns[cn].prototype, p);\n\n    if (s[5]) {\n      sp = self.resolve(s[5]).prototype;\n      scn = s[5].match(/\\.(\\w+)$/i)[1];\n      c = ns[cn];\n\n      if (de) {\n        ns[cn] = function () {\n          return sp[scn].apply(this, arguments);\n        };\n      } else {\n        ns[cn] = function () {\n          this.parent = sp[scn];\n          return c.apply(this, arguments);\n        };\n      }\n\n      ns[cn].prototype[cn] = ns[cn];\n      self.each(sp, function (f, n) {\n        ns[cn].prototype[n] = sp[n];\n      });\n      self.each(p, function (f, n) {\n        if (sp[n]) {\n          ns[cn].prototype[n] = function () {\n            this.parent = sp[n];\n            return f.apply(this, arguments);\n          };\n        } else {\n          if (n !== cn) {\n            ns[cn].prototype[n] = f;\n          }\n        }\n      });\n    }\n\n    self.each(p.static, function (f, n) {\n      ns[cn][n] = f;\n    });\n  };\n\n  var extend = function (obj) {\n    var exts = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      exts[_i - 1] = arguments[_i];\n    }\n\n    for (var i = 0; i < exts.length; i++) {\n      var ext = exts[i];\n\n      for (var name_1 in ext) {\n        if (ext.hasOwnProperty(name_1)) {\n          var value = ext[name_1];\n\n          if (value !== undefined) {\n            obj[name_1] = value;\n          }\n        }\n      }\n    }\n\n    return obj;\n  };\n\n  var walk = function (o, f, n, s) {\n    s = s || this;\n\n    if (o) {\n      if (n) {\n        o = o[n];\n      }\n\n      each$2(o, function (o, i) {\n        if (f.call(s, o, i, n) === false) {\n          return false;\n        }\n\n        walk(o, f, n, s);\n      });\n    }\n  };\n\n  var createNS = function (n, o) {\n    var i, v;\n    o = o || window;\n    n = n.split('.');\n\n    for (i = 0; i < n.length; i++) {\n      v = n[i];\n\n      if (!o[v]) {\n        o[v] = {};\n      }\n\n      o = o[v];\n    }\n\n    return o;\n  };\n\n  var resolve = function (n, o) {\n    var i, l;\n    o = o || window;\n    n = n.split('.');\n\n    for (i = 0, l = n.length; i < l; i++) {\n      o = o[n[i]];\n\n      if (!o) {\n        break;\n      }\n    }\n\n    return o;\n  };\n\n  var explode = function (s, d) {\n    if (!s || is(s, 'array')) {\n      return s;\n    }\n\n    return map$2(s.split(d || ','), trim$1);\n  };\n\n  var _addCacheSuffix = function (url) {\n    var cacheSuffix = Env.cacheSuffix;\n\n    if (cacheSuffix) {\n      url += (url.indexOf('?') === -1 ? '?' : '&') + cacheSuffix;\n    }\n\n    return url;\n  };\n\n  var Tools = {\n    trim: trim$1,\n    isArray: isArray$1,\n    is: is,\n    toArray: toArray,\n    makeMap: makeMap,\n    each: each$2,\n    map: map$2,\n    grep: filter$2,\n    inArray: indexOf$1,\n    hasOwn: hasOwnProperty$1,\n    extend: extend,\n    create: create,\n    walk: walk,\n    createNS: createNS,\n    resolve: resolve,\n    explode: explode,\n    _addCacheSuffix: _addCacheSuffix\n  };\n\n  var fromHtml = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n\n    if (!div.hasChildNodes() || div.childNodes.length > 1) {\n      console.error('HTML does not have a single root node', html);\n      throw new Error('HTML must have a single root node');\n    }\n\n    return fromDom(div.childNodes[0]);\n  };\n\n  var fromTag = function (tag, scope) {\n    var doc = scope || document;\n    var node = doc.createElement(tag);\n    return fromDom(node);\n  };\n\n  var fromText = function (text, scope) {\n    var doc = scope || document;\n    var node = doc.createTextNode(text);\n    return fromDom(node);\n  };\n\n  var fromDom = function (node) {\n    if (node === null || node === undefined) {\n      throw new Error('Node cannot be null or undefined');\n    }\n\n    return {\n      dom: node\n    };\n  };\n\n  var fromPoint = function (docElm, x, y) {\n    return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n  };\n\n  var SugarElement = {\n    fromHtml: fromHtml,\n    fromTag: fromTag,\n    fromText: fromText,\n    fromDom: fromDom,\n    fromPoint: fromPoint\n  };\n\n  var toArray$1 = function (target, f) {\n    var r = [];\n\n    var recurse = function (e) {\n      r.push(e);\n      return f(e);\n    };\n\n    var cur = f(target);\n\n    do {\n      cur = cur.bind(recurse);\n    } while (cur.isSome());\n\n    return r;\n  };\n\n  var compareDocumentPosition = function (a, b, match) {\n    return (a.compareDocumentPosition(b) & match) !== 0;\n  };\n\n  var documentPositionContainedBy = function (a, b) {\n    return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n  };\n\n  var COMMENT = 8;\n  var DOCUMENT = 9;\n  var DOCUMENT_FRAGMENT = 11;\n  var ELEMENT = 1;\n  var TEXT = 3;\n\n  var is$1 = function (element, selector) {\n    var dom = element.dom;\n\n    if (dom.nodeType !== ELEMENT) {\n      return false;\n    } else {\n      var elem = dom;\n\n      if (elem.matches !== undefined) {\n        return elem.matches(selector);\n      } else if (elem.msMatchesSelector !== undefined) {\n        return elem.msMatchesSelector(selector);\n      } else if (elem.webkitMatchesSelector !== undefined) {\n        return elem.webkitMatchesSelector(selector);\n      } else if (elem.mozMatchesSelector !== undefined) {\n        return elem.mozMatchesSelector(selector);\n      } else {\n        throw new Error('Browser lacks native selectors');\n      }\n    }\n  };\n\n  var bypassSelector = function (dom) {\n    return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n  };\n\n  var all = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), SugarElement.fromDom);\n  };\n\n  var one = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n  };\n\n  var eq$2 = function (e1, e2) {\n    return e1.dom === e2.dom;\n  };\n\n  var regularContains = function (e1, e2) {\n    var d1 = e1.dom;\n    var d2 = e2.dom;\n    return d1 === d2 ? false : d1.contains(d2);\n  };\n\n  var ieContains = function (e1, e2) {\n    return documentPositionContainedBy(e1.dom, e2.dom);\n  };\n\n  var contains$2 = function (e1, e2) {\n    return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n  };\n\n  var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n  var name = function (element) {\n    var r = element.dom.nodeName;\n    return r.toLowerCase();\n  };\n\n  var type = function (element) {\n    return element.dom.nodeType;\n  };\n\n  var isType$1 = function (t) {\n    return function (element) {\n      return type(element) === t;\n    };\n  };\n\n  var isComment = function (element) {\n    return type(element) === COMMENT || name(element) === '#comment';\n  };\n\n  var isElement = isType$1(ELEMENT);\n  var isText = isType$1(TEXT);\n  var isDocument = isType$1(DOCUMENT);\n  var isDocumentFragment = isType$1(DOCUMENT_FRAGMENT);\n\n  var owner = function (element) {\n    return SugarElement.fromDom(element.dom.ownerDocument);\n  };\n\n  var documentOrOwner = function (dos) {\n    return isDocument(dos) ? dos : owner(dos);\n  };\n\n  var documentElement = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);\n  };\n\n  var defaultView = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n  };\n\n  var parent = function (element) {\n    return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n  };\n\n  var parents = function (element, isRoot) {\n    var stop = isFunction(isRoot) ? isRoot : never;\n    var dom = element.dom;\n    var ret = [];\n\n    while (dom.parentNode !== null && dom.parentNode !== undefined) {\n      var rawParent = dom.parentNode;\n      var p = SugarElement.fromDom(rawParent);\n      ret.push(p);\n\n      if (stop(p) === true) {\n        break;\n      } else {\n        dom = rawParent;\n      }\n    }\n\n    return ret;\n  };\n\n  var siblings = function (element) {\n    var filterSelf = function (elements) {\n      return filter(elements, function (x) {\n        return !eq$2(element, x);\n      });\n    };\n\n    return parent(element).map(children).map(filterSelf).getOr([]);\n  };\n\n  var prevSibling = function (element) {\n    return Optional.from(element.dom.previousSibling).map(SugarElement.fromDom);\n  };\n\n  var nextSibling = function (element) {\n    return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n  };\n\n  var prevSiblings = function (element) {\n    return reverse(toArray$1(element, prevSibling));\n  };\n\n  var nextSiblings = function (element) {\n    return toArray$1(element, nextSibling);\n  };\n\n  var children = function (element) {\n    return map(element.dom.childNodes, SugarElement.fromDom);\n  };\n\n  var child = function (element, index) {\n    var cs = element.dom.childNodes;\n    return Optional.from(cs[index]).map(SugarElement.fromDom);\n  };\n\n  var firstChild = function (element) {\n    return child(element, 0);\n  };\n\n  var lastChild = function (element) {\n    return child(element, element.dom.childNodes.length - 1);\n  };\n\n  var childNodesCount = function (element) {\n    return element.dom.childNodes.length;\n  };\n\n  var getHead = function (doc) {\n    var b = doc.dom.head;\n\n    if (b === null || b === undefined) {\n      throw new Error('Head is not available yet');\n    }\n\n    return SugarElement.fromDom(b);\n  };\n\n  var isShadowRoot = function (dos) {\n    return isDocumentFragment(dos) && isNonNullable(dos.dom.host);\n  };\n\n  var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n  var isSupported = constant(supported);\n  var getRootNode = supported ? function (e) {\n    return SugarElement.fromDom(e.dom.getRootNode());\n  } : documentOrOwner;\n\n  var getStyleContainer = function (dos) {\n    return isShadowRoot(dos) ? dos : getHead(documentOrOwner(dos));\n  };\n\n  var getShadowRoot = function (e) {\n    var r = getRootNode(e);\n    return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n  };\n\n  var getShadowHost = function (e) {\n    return SugarElement.fromDom(e.dom.host);\n  };\n\n  var getOriginalEventTarget = function (event) {\n    if (isSupported() && isNonNullable(event.target)) {\n      var el = SugarElement.fromDom(event.target);\n\n      if (isElement(el) && isOpenShadowHost(el)) {\n        if (event.composed && event.composedPath) {\n          var composedPath = event.composedPath();\n\n          if (composedPath) {\n            return head(composedPath);\n          }\n        }\n      }\n    }\n\n    return Optional.from(event.target);\n  };\n\n  var isOpenShadowHost = function (element) {\n    return isNonNullable(element.dom.shadowRoot);\n  };\n\n  var before = function (marker, element) {\n    var parent$1 = parent(marker);\n    parent$1.each(function (v) {\n      v.dom.insertBefore(element.dom, marker.dom);\n    });\n  };\n\n  var after = function (marker, element) {\n    var sibling = nextSibling(marker);\n    sibling.fold(function () {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        append(v, element);\n      });\n    }, function (v) {\n      before(v, element);\n    });\n  };\n\n  var prepend = function (parent, element) {\n    var firstChild$1 = firstChild(parent);\n    firstChild$1.fold(function () {\n      append(parent, element);\n    }, function (v) {\n      parent.dom.insertBefore(element.dom, v.dom);\n    });\n  };\n\n  var append = function (parent, element) {\n    parent.dom.appendChild(element.dom);\n  };\n\n  var wrap = function (element, wrapper) {\n    before(element, wrapper);\n    append(wrapper, element);\n  };\n\n  var before$1 = function (marker, elements) {\n    each(elements, function (x) {\n      before(marker, x);\n    });\n  };\n\n  var append$1 = function (parent, elements) {\n    each(elements, function (x) {\n      append(parent, x);\n    });\n  };\n\n  var empty = function (element) {\n    element.dom.textContent = '';\n    each(children(element), function (rogue) {\n      remove(rogue);\n    });\n  };\n\n  var remove = function (element) {\n    var dom = element.dom;\n\n    if (dom.parentNode !== null) {\n      dom.parentNode.removeChild(dom);\n    }\n  };\n\n  var unwrap = function (wrapper) {\n    var children$1 = children(wrapper);\n\n    if (children$1.length > 0) {\n      before$1(wrapper, children$1);\n    }\n\n    remove(wrapper);\n  };\n\n  var inBody = function (element) {\n    var dom = isText(element) ? element.dom.parentNode : element.dom;\n\n    if (dom === undefined || dom === null || dom.ownerDocument === null) {\n      return false;\n    }\n\n    var doc = dom.ownerDocument;\n    return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n      return doc.body.contains(dom);\n    }, compose1(inBody, getShadowHost));\n  };\n\n  var r = function (left, top) {\n    var translate = function (x, y) {\n      return r(left + x, top + y);\n    };\n\n    return {\n      left: left,\n      top: top,\n      translate: translate\n    };\n  };\n\n  var SugarPosition = r;\n\n  var boxPosition = function (dom) {\n    var box = dom.getBoundingClientRect();\n    return SugarPosition(box.left, box.top);\n  };\n\n  var firstDefinedOrZero = function (a, b) {\n    if (a !== undefined) {\n      return a;\n    } else {\n      return b !== undefined ? b : 0;\n    }\n  };\n\n  var absolute = function (element) {\n    var doc = element.dom.ownerDocument;\n    var body = doc.body;\n    var win = doc.defaultView;\n    var html = doc.documentElement;\n\n    if (body === element.dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n    var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n    var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n    var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n    return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n  };\n\n  var viewport = function (element) {\n    var dom = element.dom;\n    var doc = dom.ownerDocument;\n    var body = doc.body;\n\n    if (body === dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    if (!inBody(element)) {\n      return SugarPosition(0, 0);\n    }\n\n    return boxPosition(dom);\n  };\n\n  var get$2 = function (_DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n    var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n    return SugarPosition(x, y);\n  };\n\n  var to = function (x, y, _DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var win = doc.defaultView;\n\n    if (win) {\n      win.scrollTo(x, y);\n    }\n  };\n\n  var intoView = function (element, alignToTop) {\n    var isSafari = detect$3().browser.isSafari();\n\n    if (isSafari && isFunction(element.dom.scrollIntoViewIfNeeded)) {\n      element.dom.scrollIntoViewIfNeeded(false);\n    } else {\n      element.dom.scrollIntoView(alignToTop);\n    }\n  };\n\n  var get$3 = function (_win) {\n    var win = _win === undefined ? window : _win;\n    return Optional.from(win['visualViewport']);\n  };\n\n  var bounds = function (x, y, width, height) {\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height,\n      right: x + width,\n      bottom: y + height\n    };\n  };\n\n  var getBounds = function (_win) {\n    var win = _win === undefined ? window : _win;\n    var doc = win.document;\n    var scroll = get$2(SugarElement.fromDom(doc));\n    return get$3(win).fold(function () {\n      var html = win.document.documentElement;\n      var width = html.clientWidth;\n      var height = html.clientHeight;\n      return bounds(scroll.left, scroll.top, width, height);\n    }, function (visualViewport) {\n      return bounds(Math.max(visualViewport.pageLeft, scroll.left), Math.max(visualViewport.pageTop, scroll.top), visualViewport.width, visualViewport.height);\n    });\n  };\n\n  var isNodeType = function (type) {\n    return function (node) {\n      return !!node && node.nodeType === type;\n    };\n  };\n\n  var isRestrictedNode = function (node) {\n    return !!node && !Object.getPrototypeOf(node);\n  };\n\n  var isElement$1 = isNodeType(1);\n\n  var matchNodeNames = function (names) {\n    var lowercasedNames = names.map(function (s) {\n      return s.toLowerCase();\n    });\n    return function (node) {\n      if (node && node.nodeName) {\n        var nodeName = node.nodeName.toLowerCase();\n        return contains(lowercasedNames, nodeName);\n      }\n\n      return false;\n    };\n  };\n\n  var matchStyleValues = function (name, values) {\n    var items = values.toLowerCase().split(' ');\n    return function (node) {\n      var i, cssValue;\n\n      if (isElement$1(node)) {\n        for (i = 0; i < items.length; i++) {\n          var computed = node.ownerDocument.defaultView.getComputedStyle(node, null);\n          cssValue = computed ? computed.getPropertyValue(name) : null;\n\n          if (cssValue === items[i]) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var hasAttribute = function (attrName) {\n    return function (node) {\n      return isElement$1(node) && node.hasAttribute(attrName);\n    };\n  };\n\n  var hasAttributeValue = function (attrName, attrValue) {\n    return function (node) {\n      return isElement$1(node) && node.getAttribute(attrName) === attrValue;\n    };\n  };\n\n  var isBogus = function (node) {\n    return isElement$1(node) && node.hasAttribute('data-mce-bogus');\n  };\n\n  var isBogusAll = function (node) {\n    return isElement$1(node) && node.getAttribute('data-mce-bogus') === 'all';\n  };\n\n  var isTable = function (node) {\n    return isElement$1(node) && node.tagName === 'TABLE';\n  };\n\n  var hasContentEditableState = function (value) {\n    return function (node) {\n      if (isElement$1(node)) {\n        if (node.contentEditable === value) {\n          return true;\n        }\n\n        if (node.getAttribute('data-mce-contenteditable') === value) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var isTextareaOrInput = matchNodeNames(['textarea', 'input']);\n  var isText$1 = isNodeType(3);\n  var isComment$1 = isNodeType(8);\n  var isDocument$1 = isNodeType(9);\n  var isDocumentFragment$1 = isNodeType(11);\n  var isBr = matchNodeNames(['br']);\n  var isImg = matchNodeNames(['img']);\n  var isContentEditableTrue = hasContentEditableState('true');\n  var isContentEditableFalse = hasContentEditableState('false');\n  var isTableCell = matchNodeNames(['td', 'th']);\n  var isMedia = matchNodeNames(['video', 'audio', 'object', 'embed']);\n\n  var isSupported$1 = function (dom) {\n    return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n  };\n\n  var rawSet = function (dom, key, value) {\n    if (isString(value) || isBoolean(value) || isNumber(value)) {\n      dom.setAttribute(key, value + '');\n    } else {\n      console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n      throw new Error('Attribute value was not simple');\n    }\n  };\n\n  var set = function (element, key, value) {\n    rawSet(element.dom, key, value);\n  };\n\n  var setAll = function (element, attrs) {\n    var dom = element.dom;\n    each$1(attrs, function (v, k) {\n      rawSet(dom, k, v);\n    });\n  };\n\n  var get$4 = function (element, key) {\n    var v = element.dom.getAttribute(key);\n    return v === null ? undefined : v;\n  };\n\n  var getOpt = function (element, key) {\n    return Optional.from(get$4(element, key));\n  };\n\n  var has$1 = function (element, key) {\n    var dom = element.dom;\n    return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n  };\n\n  var remove$1 = function (element, key) {\n    element.dom.removeAttribute(key);\n  };\n\n  var clone = function (element) {\n    return foldl(element.dom.attributes, function (acc, attr) {\n      acc[attr.name] = attr.value;\n      return acc;\n    }, {});\n  };\n\n  var internalSet = function (dom, property, value) {\n    if (!isString(value)) {\n      console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n      throw new Error('CSS value must be a string: ' + value);\n    }\n\n    if (isSupported$1(dom)) {\n      dom.style.setProperty(property, value);\n    }\n  };\n\n  var setAll$1 = function (element, css) {\n    var dom = element.dom;\n    each$1(css, function (v, k) {\n      internalSet(dom, k, v);\n    });\n  };\n\n  var get$5 = function (element, property) {\n    var dom = element.dom;\n    var styles = window.getComputedStyle(dom);\n    var r = styles.getPropertyValue(property);\n    return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n  };\n\n  var getUnsafeProperty = function (dom, property) {\n    return isSupported$1(dom) ? dom.style.getPropertyValue(property) : '';\n  };\n\n  var getRaw = function (element, property) {\n    var dom = element.dom;\n    var raw = getUnsafeProperty(dom, property);\n    return Optional.from(raw).filter(function (r) {\n      return r.length > 0;\n    });\n  };\n\n  var getAllRaw = function (element) {\n    var css = {};\n    var dom = element.dom;\n\n    if (isSupported$1(dom)) {\n      for (var i = 0; i < dom.style.length; i++) {\n        var ruleName = dom.style.item(i);\n        css[ruleName] = dom.style[ruleName];\n      }\n    }\n\n    return css;\n  };\n\n  var reflow = function (e) {\n    return e.dom.offsetWidth;\n  };\n\n  var browser$1 = detect$3().browser;\n\n  var firstElement = function (nodes) {\n    return find(nodes, isElement);\n  };\n\n  var getTableCaptionDeltaY = function (elm) {\n    if (browser$1.isFirefox() && name(elm) === 'table') {\n      return firstElement(children(elm)).filter(function (elm) {\n        return name(elm) === 'caption';\n      }).bind(function (caption) {\n        return firstElement(nextSiblings(caption)).map(function (body) {\n          var bodyTop = body.dom.offsetTop;\n          var captionTop = caption.dom.offsetTop;\n          var captionHeight = caption.dom.offsetHeight;\n          return bodyTop <= captionTop ? -captionHeight : 0;\n        });\n      }).getOr(0);\n    } else {\n      return 0;\n    }\n  };\n\n  var hasChild = function (elm, child) {\n    return elm.children && contains(elm.children, child);\n  };\n\n  var getPos = function (body, elm, rootElm) {\n    var x = 0,\n        y = 0,\n        offsetParent;\n    var doc = body.ownerDocument;\n    var pos;\n    rootElm = rootElm ? rootElm : body;\n\n    if (elm) {\n      if (rootElm === body && elm.getBoundingClientRect && get$5(SugarElement.fromDom(body), 'position') === 'static') {\n        pos = elm.getBoundingClientRect();\n        x = pos.left + (doc.documentElement.scrollLeft || body.scrollLeft) - doc.documentElement.clientLeft;\n        y = pos.top + (doc.documentElement.scrollTop || body.scrollTop) - doc.documentElement.clientTop;\n        return {\n          x: x,\n          y: y\n        };\n      }\n\n      offsetParent = elm;\n\n      while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n        x += offsetParent.offsetLeft || 0;\n        y += offsetParent.offsetTop || 0;\n        offsetParent = offsetParent.offsetParent;\n      }\n\n      offsetParent = elm.parentNode;\n\n      while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n        x -= offsetParent.scrollLeft || 0;\n        y -= offsetParent.scrollTop || 0;\n        offsetParent = offsetParent.parentNode;\n      }\n\n      y += getTableCaptionDeltaY(SugarElement.fromDom(elm));\n    }\n\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var exports$1 = {},\n      module$1 = {\n    exports: exports$1\n  };\n\n  (function (define, exports, module, require) {\n    (function (f) {\n      if (typeof exports === 'object' && typeof module !== 'undefined') {\n        module.exports = f();\n      } else if (typeof define === 'function' && define.amd) {\n        define([], f);\n      } else {\n        var g;\n\n        if (typeof window !== 'undefined') {\n          g = window;\n        } else if (typeof global !== 'undefined') {\n          g = global;\n        } else if (typeof self !== 'undefined') {\n          g = self;\n        } else {\n          g = this;\n        }\n\n        g.EphoxContactWrapper = f();\n      }\n    })(function () {\n      return function () {\n        function r(e, n, t) {\n          function o(i, f) {\n            if (!n[i]) {\n              if (!e[i]) {\n                var c = 'function' == typeof require && require;\n                if (!f && c) return c(i, !0);\n                if (u) return u(i, !0);\n                var a = new Error('Cannot find module \\'' + i + '\\'');\n                throw a.code = 'MODULE_NOT_FOUND', a;\n              }\n\n              var p = n[i] = {\n                exports: {}\n              };\n              e[i][0].call(p.exports, function (r) {\n                var n = e[i][1][r];\n                return o(n || r);\n              }, p, p.exports, r, e, n, t);\n            }\n\n            return n[i].exports;\n          }\n\n          for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++) o(t[i]);\n\n          return o;\n        }\n\n        return r;\n      }()({\n        1: [function (require, module, exports) {\n          var process = module.exports = {};\n          var cachedSetTimeout;\n          var cachedClearTimeout;\n\n          function defaultSetTimout() {\n            throw new Error('setTimeout has not been defined');\n          }\n\n          function defaultClearTimeout() {\n            throw new Error('clearTimeout has not been defined');\n          }\n\n          (function () {\n            try {\n              if (typeof setTimeout === 'function') {\n                cachedSetTimeout = setTimeout;\n              } else {\n                cachedSetTimeout = defaultSetTimout;\n              }\n            } catch (e) {\n              cachedSetTimeout = defaultSetTimout;\n            }\n\n            try {\n              if (typeof clearTimeout === 'function') {\n                cachedClearTimeout = clearTimeout;\n              } else {\n                cachedClearTimeout = defaultClearTimeout;\n              }\n            } catch (e) {\n              cachedClearTimeout = defaultClearTimeout;\n            }\n          })();\n\n          function runTimeout(fun) {\n            if (cachedSetTimeout === setTimeout) {\n              return setTimeout(fun, 0);\n            }\n\n            if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n              cachedSetTimeout = setTimeout;\n              return setTimeout(fun, 0);\n            }\n\n            try {\n              return cachedSetTimeout(fun, 0);\n            } catch (e) {\n              try {\n                return cachedSetTimeout.call(null, fun, 0);\n              } catch (e) {\n                return cachedSetTimeout.call(this, fun, 0);\n              }\n            }\n          }\n\n          function runClearTimeout(marker) {\n            if (cachedClearTimeout === clearTimeout) {\n              return clearTimeout(marker);\n            }\n\n            if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n              cachedClearTimeout = clearTimeout;\n              return clearTimeout(marker);\n            }\n\n            try {\n              return cachedClearTimeout(marker);\n            } catch (e) {\n              try {\n                return cachedClearTimeout.call(null, marker);\n              } catch (e) {\n                return cachedClearTimeout.call(this, marker);\n              }\n            }\n          }\n\n          var queue = [];\n          var draining = false;\n          var currentQueue;\n          var queueIndex = -1;\n\n          function cleanUpNextTick() {\n            if (!draining || !currentQueue) {\n              return;\n            }\n\n            draining = false;\n\n            if (currentQueue.length) {\n              queue = currentQueue.concat(queue);\n            } else {\n              queueIndex = -1;\n            }\n\n            if (queue.length) {\n              drainQueue();\n            }\n          }\n\n          function drainQueue() {\n            if (draining) {\n              return;\n            }\n\n            var timeout = runTimeout(cleanUpNextTick);\n            draining = true;\n            var len = queue.length;\n\n            while (len) {\n              currentQueue = queue;\n              queue = [];\n\n              while (++queueIndex < len) {\n                if (currentQueue) {\n                  currentQueue[queueIndex].run();\n                }\n              }\n\n              queueIndex = -1;\n              len = queue.length;\n            }\n\n            currentQueue = null;\n            draining = false;\n            runClearTimeout(timeout);\n          }\n\n          process.nextTick = function (fun) {\n            var args = new Array(arguments.length - 1);\n\n            if (arguments.length > 1) {\n              for (var i = 1; i < arguments.length; i++) {\n                args[i - 1] = arguments[i];\n              }\n            }\n\n            queue.push(new Item(fun, args));\n\n            if (queue.length === 1 && !draining) {\n              runTimeout(drainQueue);\n            }\n          };\n\n          function Item(fun, array) {\n            this.fun = fun;\n            this.array = array;\n          }\n\n          Item.prototype.run = function () {\n            this.fun.apply(null, this.array);\n          };\n\n          process.title = 'browser';\n          process.browser = true;\n          process.env = {};\n          process.argv = [];\n          process.version = '';\n          process.versions = {};\n\n          function noop() {}\n\n          process.on = noop;\n          process.addListener = noop;\n          process.once = noop;\n          process.off = noop;\n          process.removeListener = noop;\n          process.removeAllListeners = noop;\n          process.emit = noop;\n          process.prependListener = noop;\n          process.prependOnceListener = noop;\n\n          process.listeners = function (name) {\n            return [];\n          };\n\n          process.binding = function (name) {\n            throw new Error('process.binding is not supported');\n          };\n\n          process.cwd = function () {\n            return '/';\n          };\n\n          process.chdir = function (dir) {\n            throw new Error('process.chdir is not supported');\n          };\n\n          process.umask = function () {\n            return 0;\n          };\n        }, {}],\n        2: [function (require, module, exports) {\n          (function (setImmediate) {\n            (function (root) {\n              var setTimeoutFunc = setTimeout;\n\n              function noop() {}\n\n              function bind(fn, thisArg) {\n                return function () {\n                  fn.apply(thisArg, arguments);\n                };\n              }\n\n              function Promise(fn) {\n                if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n                if (typeof fn !== 'function') throw new TypeError('not a function');\n                this._state = 0;\n                this._handled = false;\n                this._value = undefined;\n                this._deferreds = [];\n                doResolve(fn, this);\n              }\n\n              function handle(self, deferred) {\n                while (self._state === 3) {\n                  self = self._value;\n                }\n\n                if (self._state === 0) {\n                  self._deferreds.push(deferred);\n\n                  return;\n                }\n\n                self._handled = true;\n\n                Promise._immediateFn(function () {\n                  var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n\n                  if (cb === null) {\n                    (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                    return;\n                  }\n\n                  var ret;\n\n                  try {\n                    ret = cb(self._value);\n                  } catch (e) {\n                    reject(deferred.promise, e);\n                    return;\n                  }\n\n                  resolve(deferred.promise, ret);\n                });\n              }\n\n              function resolve(self, newValue) {\n                try {\n                  if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');\n\n                  if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                    var then = newValue.then;\n\n                    if (newValue instanceof Promise) {\n                      self._state = 3;\n                      self._value = newValue;\n                      finale(self);\n                      return;\n                    } else if (typeof then === 'function') {\n                      doResolve(bind(then, newValue), self);\n                      return;\n                    }\n                  }\n\n                  self._state = 1;\n                  self._value = newValue;\n                  finale(self);\n                } catch (e) {\n                  reject(self, e);\n                }\n              }\n\n              function reject(self, newValue) {\n                self._state = 2;\n                self._value = newValue;\n                finale(self);\n              }\n\n              function finale(self) {\n                if (self._state === 2 && self._deferreds.length === 0) {\n                  Promise._immediateFn(function () {\n                    if (!self._handled) {\n                      Promise._unhandledRejectionFn(self._value);\n                    }\n                  });\n                }\n\n                for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                  handle(self, self._deferreds[i]);\n                }\n\n                self._deferreds = null;\n              }\n\n              function Handler(onFulfilled, onRejected, promise) {\n                this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                this.promise = promise;\n              }\n\n              function doResolve(fn, self) {\n                var done = false;\n\n                try {\n                  fn(function (value) {\n                    if (done) return;\n                    done = true;\n                    resolve(self, value);\n                  }, function (reason) {\n                    if (done) return;\n                    done = true;\n                    reject(self, reason);\n                  });\n                } catch (ex) {\n                  if (done) return;\n                  done = true;\n                  reject(self, ex);\n                }\n              }\n\n              Promise.prototype['catch'] = function (onRejected) {\n                return this.then(null, onRejected);\n              };\n\n              Promise.prototype.then = function (onFulfilled, onRejected) {\n                var prom = new this.constructor(noop);\n                handle(this, new Handler(onFulfilled, onRejected, prom));\n                return prom;\n              };\n\n              Promise.all = function (arr) {\n                var args = Array.prototype.slice.call(arr);\n                return new Promise(function (resolve, reject) {\n                  if (args.length === 0) return resolve([]);\n                  var remaining = args.length;\n\n                  function res(i, val) {\n                    try {\n                      if (val && (typeof val === 'object' || typeof val === 'function')) {\n                        var then = val.then;\n\n                        if (typeof then === 'function') {\n                          then.call(val, function (val) {\n                            res(i, val);\n                          }, reject);\n                          return;\n                        }\n                      }\n\n                      args[i] = val;\n\n                      if (--remaining === 0) {\n                        resolve(args);\n                      }\n                    } catch (ex) {\n                      reject(ex);\n                    }\n                  }\n\n                  for (var i = 0; i < args.length; i++) {\n                    res(i, args[i]);\n                  }\n                });\n              };\n\n              Promise.resolve = function (value) {\n                if (value && typeof value === 'object' && value.constructor === Promise) {\n                  return value;\n                }\n\n                return new Promise(function (resolve) {\n                  resolve(value);\n                });\n              };\n\n              Promise.reject = function (value) {\n                return new Promise(function (resolve, reject) {\n                  reject(value);\n                });\n              };\n\n              Promise.race = function (values) {\n                return new Promise(function (resolve, reject) {\n                  for (var i = 0, len = values.length; i < len; i++) {\n                    values[i].then(resolve, reject);\n                  }\n                });\n              };\n\n              Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                setImmediate(fn);\n              } : function (fn) {\n                setTimeoutFunc(fn, 0);\n              };\n\n              Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                if (typeof console !== 'undefined' && console) {\n                  console.warn('Possible Unhandled Promise Rejection:', err);\n                }\n              };\n\n              Promise._setImmediateFn = function _setImmediateFn(fn) {\n                Promise._immediateFn = fn;\n              };\n\n              Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                Promise._unhandledRejectionFn = fn;\n              };\n\n              if (typeof module !== 'undefined' && module.exports) {\n                module.exports = Promise;\n              } else if (!root.Promise) {\n                root.Promise = Promise;\n              }\n            })(this);\n          }).call(this, require('timers').setImmediate);\n        }, {\n          'timers': 3\n        }],\n        3: [function (require, module, exports) {\n          (function (setImmediate, clearImmediate) {\n            var nextTick = require('process/browser.js').nextTick;\n\n            var apply = Function.prototype.apply;\n            var slice = Array.prototype.slice;\n            var immediateIds = {};\n            var nextImmediateId = 0;\n\n            exports.setTimeout = function () {\n              return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n            };\n\n            exports.setInterval = function () {\n              return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n            };\n\n            exports.clearTimeout = exports.clearInterval = function (timeout) {\n              timeout.close();\n            };\n\n            function Timeout(id, clearFn) {\n              this._id = id;\n              this._clearFn = clearFn;\n            }\n\n            Timeout.prototype.unref = Timeout.prototype.ref = function () {};\n\n            Timeout.prototype.close = function () {\n              this._clearFn.call(window, this._id);\n            };\n\n            exports.enroll = function (item, msecs) {\n              clearTimeout(item._idleTimeoutId);\n              item._idleTimeout = msecs;\n            };\n\n            exports.unenroll = function (item) {\n              clearTimeout(item._idleTimeoutId);\n              item._idleTimeout = -1;\n            };\n\n            exports._unrefActive = exports.active = function (item) {\n              clearTimeout(item._idleTimeoutId);\n              var msecs = item._idleTimeout;\n\n              if (msecs >= 0) {\n                item._idleTimeoutId = setTimeout(function onTimeout() {\n                  if (item._onTimeout) item._onTimeout();\n                }, msecs);\n              }\n            };\n\n            exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n              var id = nextImmediateId++;\n              var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n              immediateIds[id] = true;\n              nextTick(function onNextTick() {\n                if (immediateIds[id]) {\n                  if (args) {\n                    fn.apply(null, args);\n                  } else {\n                    fn.call(null);\n                  }\n\n                  exports.clearImmediate(id);\n                }\n              });\n              return id;\n            };\n            exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n              delete immediateIds[id];\n            };\n          }).call(this, require('timers').setImmediate, require('timers').clearImmediate);\n        }, {\n          'process/browser.js': 1,\n          'timers': 3\n        }],\n        4: [function (require, module, exports) {\n          var promisePolyfill = require('promise-polyfill');\n\n          var Global = function () {\n            if (typeof window !== 'undefined') {\n              return window;\n            } else {\n              return Function('return this;')();\n            }\n          }();\n\n          module.exports = {\n            boltExport: Global.Promise || promisePolyfill\n          };\n        }, {\n          'promise-polyfill': 2\n        }]\n      }, {}, [4])(4);\n    });\n  })(undefined, exports$1, module$1, undefined);\n\n  var Promise = module$1.exports.boltExport;\n\n  var nu$3 = function (baseFn) {\n    var data = Optional.none();\n    var callbacks = [];\n\n    var map = function (f) {\n      return nu$3(function (nCallback) {\n        get(function (data) {\n          nCallback(f(data));\n        });\n      });\n    };\n\n    var get = function (nCallback) {\n      if (isReady()) {\n        call(nCallback);\n      } else {\n        callbacks.push(nCallback);\n      }\n    };\n\n    var set = function (x) {\n      if (!isReady()) {\n        data = Optional.some(x);\n        run(callbacks);\n        callbacks = [];\n      }\n    };\n\n    var isReady = function () {\n      return data.isSome();\n    };\n\n    var run = function (cbs) {\n      each(cbs, call);\n    };\n\n    var call = function (cb) {\n      data.each(function (x) {\n        setTimeout(function () {\n          cb(x);\n        }, 0);\n      });\n    };\n\n    baseFn(set);\n    return {\n      get: get,\n      map: map,\n      isReady: isReady\n    };\n  };\n\n  var pure = function (a) {\n    return nu$3(function (callback) {\n      callback(a);\n    });\n  };\n\n  var LazyValue = {\n    nu: nu$3,\n    pure: pure\n  };\n\n  var errorReporter = function (err) {\n    setTimeout(function () {\n      throw err;\n    }, 0);\n  };\n\n  var make = function (run) {\n    var get = function (callback) {\n      run().then(callback, errorReporter);\n    };\n\n    var map = function (fab) {\n      return make(function () {\n        return run().then(fab);\n      });\n    };\n\n    var bind = function (aFutureB) {\n      return make(function () {\n        return run().then(function (v) {\n          return aFutureB(v).toPromise();\n        });\n      });\n    };\n\n    var anonBind = function (futureB) {\n      return make(function () {\n        return run().then(function () {\n          return futureB.toPromise();\n        });\n      });\n    };\n\n    var toLazy = function () {\n      return LazyValue.nu(get);\n    };\n\n    var toCached = function () {\n      var cache = null;\n      return make(function () {\n        if (cache === null) {\n          cache = run();\n        }\n\n        return cache;\n      });\n    };\n\n    var toPromise = run;\n    return {\n      map: map,\n      bind: bind,\n      anonBind: anonBind,\n      toLazy: toLazy,\n      toCached: toCached,\n      toPromise: toPromise,\n      get: get\n    };\n  };\n\n  var nu$4 = function (baseFn) {\n    return make(function () {\n      return new Promise(baseFn);\n    });\n  };\n\n  var pure$1 = function (a) {\n    return make(function () {\n      return Promise.resolve(a);\n    });\n  };\n\n  var Future = {\n    nu: nu$4,\n    pure: pure$1\n  };\n\n  var par = function (asyncValues, nu) {\n    return nu(function (callback) {\n      var r = [];\n      var count = 0;\n\n      var cb = function (i) {\n        return function (value) {\n          r[i] = value;\n          count++;\n\n          if (count >= asyncValues.length) {\n            callback(r);\n          }\n        };\n      };\n\n      if (asyncValues.length === 0) {\n        callback([]);\n      } else {\n        each(asyncValues, function (asyncValue, i) {\n          asyncValue.get(cb(i));\n        });\n      }\n    });\n  };\n\n  var par$1 = function (futures) {\n    return par(futures, Future.nu);\n  };\n\n  var value = function (o) {\n    var is = function (v) {\n      return o === v;\n    };\n\n    var or = function (_opt) {\n      return value(o);\n    };\n\n    var orThunk = function (_f) {\n      return value(o);\n    };\n\n    var map = function (f) {\n      return value(f(o));\n    };\n\n    var mapError = function (_f) {\n      return value(o);\n    };\n\n    var each = function (f) {\n      f(o);\n    };\n\n    var bind = function (f) {\n      return f(o);\n    };\n\n    var fold = function (_, onValue) {\n      return onValue(o);\n    };\n\n    var exists = function (f) {\n      return f(o);\n    };\n\n    var forall = function (f) {\n      return f(o);\n    };\n\n    var toOptional = function () {\n      return Optional.some(o);\n    };\n\n    return {\n      is: is,\n      isValue: always,\n      isError: never,\n      getOr: constant(o),\n      getOrThunk: constant(o),\n      getOrDie: constant(o),\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: each,\n      bind: bind,\n      exists: exists,\n      forall: forall,\n      toOptional: toOptional\n    };\n  };\n\n  var error = function (message) {\n    var getOrThunk = function (f) {\n      return f();\n    };\n\n    var getOrDie = function () {\n      return die(String(message))();\n    };\n\n    var or = function (opt) {\n      return opt;\n    };\n\n    var orThunk = function (f) {\n      return f();\n    };\n\n    var map = function (_f) {\n      return error(message);\n    };\n\n    var mapError = function (f) {\n      return error(f(message));\n    };\n\n    var bind = function (_f) {\n      return error(message);\n    };\n\n    var fold = function (onError, _) {\n      return onError(message);\n    };\n\n    return {\n      is: never,\n      isValue: never,\n      isError: always,\n      getOr: identity,\n      getOrThunk: getOrThunk,\n      getOrDie: getOrDie,\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: noop,\n      bind: bind,\n      exists: never,\n      forall: always,\n      toOptional: Optional.none\n    };\n  };\n\n  var fromOption = function (opt, err) {\n    return opt.fold(function () {\n      return error(err);\n    }, value);\n  };\n\n  var Result = {\n    value: value,\n    error: error,\n    fromOption: fromOption\n  };\n\n  var generate = function (cases) {\n    if (!isArray(cases)) {\n      throw new Error('cases must be an array');\n    }\n\n    if (cases.length === 0) {\n      throw new Error('there must be at least one case');\n    }\n\n    var constructors = [];\n    var adt = {};\n    each(cases, function (acase, count) {\n      var keys$1 = keys(acase);\n\n      if (keys$1.length !== 1) {\n        throw new Error('one and only one name per case');\n      }\n\n      var key = keys$1[0];\n      var value = acase[key];\n\n      if (adt[key] !== undefined) {\n        throw new Error('duplicate key detected:' + key);\n      } else if (key === 'cata') {\n        throw new Error('cannot have a case named cata (sorry)');\n      } else if (!isArray(value)) {\n        throw new Error('case arguments must be an array');\n      }\n\n      constructors.push(key);\n\n      adt[key] = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        var argLength = args.length;\n\n        if (argLength !== value.length) {\n          throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n        }\n\n        var match = function (branches) {\n          var branchKeys = keys(branches);\n\n          if (constructors.length !== branchKeys.length) {\n            throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n          }\n\n          var allReqd = forall(constructors, function (reqKey) {\n            return contains(branchKeys, reqKey);\n          });\n\n          if (!allReqd) {\n            throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n          }\n\n          return branches[key].apply(null, args);\n        };\n\n        return {\n          fold: function () {\n            var foldArgs = [];\n\n            for (var _i = 0; _i < arguments.length; _i++) {\n              foldArgs[_i] = arguments[_i];\n            }\n\n            if (foldArgs.length !== cases.length) {\n              throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n            }\n\n            var target = foldArgs[count];\n            return target.apply(null, args);\n          },\n          match: match,\n          log: function (label) {\n            console.log(label, {\n              constructors: constructors,\n              constructor: key,\n              params: args\n            });\n          }\n        };\n      };\n    });\n    return adt;\n  };\n\n  var Adt = {\n    generate: generate\n  };\n  var comparison = Adt.generate([{\n    bothErrors: ['error1', 'error2']\n  }, {\n    firstError: ['error1', 'value2']\n  }, {\n    secondError: ['value1', 'error2']\n  }, {\n    bothValues: ['value1', 'value2']\n  }]);\n\n  var unite = function (result) {\n    return result.fold(identity, identity);\n  };\n\n  function ClosestOrAncestor(is, ancestor, scope, a, isRoot) {\n    if (is(scope, a)) {\n      return Optional.some(scope);\n    } else if (isFunction(isRoot) && isRoot(scope)) {\n      return Optional.none();\n    } else {\n      return ancestor(scope, a, isRoot);\n    }\n  }\n\n  var ancestor = function (scope, predicate, isRoot) {\n    var element = scope.dom;\n    var stop = isFunction(isRoot) ? isRoot : never;\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n\n      if (predicate(el)) {\n        return Optional.some(el);\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest = function (scope, predicate, isRoot) {\n    var is = function (s, test) {\n      return test(s);\n    };\n\n    return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n  };\n\n  var sibling = function (scope, predicate) {\n    var element = scope.dom;\n\n    if (!element.parentNode) {\n      return Optional.none();\n    }\n\n    return child$1(SugarElement.fromDom(element.parentNode), function (x) {\n      return !eq$2(scope, x) && predicate(x);\n    });\n  };\n\n  var child$1 = function (scope, predicate) {\n    var pred = function (node) {\n      return predicate(SugarElement.fromDom(node));\n    };\n\n    var result = find(scope.dom.childNodes, pred);\n    return result.map(SugarElement.fromDom);\n  };\n\n  var ancestor$1 = function (scope, selector, isRoot) {\n    return ancestor(scope, function (e) {\n      return is$1(e, selector);\n    }, isRoot);\n  };\n\n  var descendant = function (scope, selector) {\n    return one(selector, scope);\n  };\n\n  var closest$1 = function (scope, selector, isRoot) {\n    var is = function (element, selector) {\n      return is$1(element, selector);\n    };\n\n    return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n  };\n\n  var promise = function () {\n    var bind = function (fn, thisArg) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        fn.apply(thisArg, args);\n      };\n    };\n\n    var isArray = Array.isArray || function (value) {\n      return Object.prototype.toString.call(value) === '[object Array]';\n    };\n\n    var Promise = function (fn) {\n      if (typeof this !== 'object') {\n        throw new TypeError('Promises must be constructed via new');\n      }\n\n      if (typeof fn !== 'function') {\n        throw new TypeError('not a function');\n      }\n\n      this._state = null;\n      this._value = null;\n      this._deferreds = [];\n      doResolve(fn, bind(resolve, this), bind(reject, this));\n    };\n\n    var asap = Promise.immediateFn || typeof setImmediate === 'function' && setImmediate || function (fn) {\n      return setTimeout(fn, 1);\n    };\n\n    function handle(deferred) {\n      var me = this;\n\n      if (this._state === null) {\n        this._deferreds.push(deferred);\n\n        return;\n      }\n\n      asap(function () {\n        var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n\n        if (cb === null) {\n          (me._state ? deferred.resolve : deferred.reject)(me._value);\n          return;\n        }\n\n        var ret;\n\n        try {\n          ret = cb(me._value);\n        } catch (e) {\n          deferred.reject(e);\n          return;\n        }\n\n        deferred.resolve(ret);\n      });\n    }\n\n    function resolve(newValue) {\n      try {\n        if (newValue === this) {\n          throw new TypeError('A promise cannot be resolved with itself.');\n        }\n\n        if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n          var then = newValue.then;\n\n          if (typeof then === 'function') {\n            doResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n            return;\n          }\n        }\n\n        this._state = true;\n        this._value = newValue;\n        finale.call(this);\n      } catch (e) {\n        reject.call(this, e);\n      }\n    }\n\n    function reject(newValue) {\n      this._state = false;\n      this._value = newValue;\n      finale.call(this);\n    }\n\n    function finale() {\n      for (var i = 0, len = this._deferreds.length; i < len; i++) {\n        handle.call(this, this._deferreds[i]);\n      }\n\n      this._deferreds = null;\n    }\n\n    function Handler(onFulfilled, onRejected, resolve, reject) {\n      this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n      this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n      this.resolve = resolve;\n      this.reject = reject;\n    }\n\n    var doResolve = function (fn, onFulfilled, onRejected) {\n      var done = false;\n\n      try {\n        fn(function (value) {\n          if (done) {\n            return;\n          }\n\n          done = true;\n          onFulfilled(value);\n        }, function (reason) {\n          if (done) {\n            return;\n          }\n\n          done = true;\n          onRejected(reason);\n        });\n      } catch (ex) {\n        if (done) {\n          return;\n        }\n\n        done = true;\n        onRejected(ex);\n      }\n    };\n\n    Promise.prototype.catch = function (onRejected) {\n      return this.then(null, onRejected);\n    };\n\n    Promise.prototype.then = function (onFulfilled, onRejected) {\n      var me = this;\n      return new Promise(function (resolve, reject) {\n        handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n      });\n    };\n\n    Promise.all = function () {\n      var values = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n      }\n\n      var args = Array.prototype.slice.call(values.length === 1 && isArray(values[0]) ? values[0] : values);\n      return new Promise(function (resolve, reject) {\n        if (args.length === 0) {\n          return resolve([]);\n        }\n\n        var remaining = args.length;\n\n        var res = function (i, val) {\n          try {\n            if (val && (typeof val === 'object' || typeof val === 'function')) {\n              var then = val.then;\n\n              if (typeof then === 'function') {\n                then.call(val, function (val) {\n                  res(i, val);\n                }, reject);\n                return;\n              }\n            }\n\n            args[i] = val;\n\n            if (--remaining === 0) {\n              resolve(args);\n            }\n          } catch (ex) {\n            reject(ex);\n          }\n        };\n\n        for (var i = 0; i < args.length; i++) {\n          res(i, args[i]);\n        }\n      });\n    };\n\n    Promise.resolve = function (value) {\n      if (value && typeof value === 'object' && value.constructor === Promise) {\n        return value;\n      }\n\n      return new Promise(function (resolve) {\n        resolve(value);\n      });\n    };\n\n    Promise.reject = function (value) {\n      return new Promise(function (resolve, reject) {\n        reject(value);\n      });\n    };\n\n    Promise.race = function (values) {\n      return new Promise(function (resolve, reject) {\n        for (var i = 0, len = values.length; i < len; i++) {\n          values[i].then(resolve, reject);\n        }\n      });\n    };\n\n    return Promise;\n  };\n\n  var promiseObj = window.Promise ? window.Promise : promise();\n  var requestAnimationFramePromise;\n\n  var requestAnimationFrame = function (callback, element) {\n    var requestAnimationFrameFunc = window.requestAnimationFrame;\n    var vendors = ['ms', 'moz', 'webkit'];\n\n    var featurefill = function (cb) {\n      window.setTimeout(cb, 0);\n    };\n\n    for (var i = 0; i < vendors.length && !requestAnimationFrameFunc; i++) {\n      requestAnimationFrameFunc = window[vendors[i] + 'RequestAnimationFrame'];\n    }\n\n    if (!requestAnimationFrameFunc) {\n      requestAnimationFrameFunc = featurefill;\n    }\n\n    requestAnimationFrameFunc(callback, element);\n  };\n\n  var wrappedSetTimeout = function (callback, time) {\n    if (typeof time !== 'number') {\n      time = 0;\n    }\n\n    return setTimeout(callback, time);\n  };\n\n  var wrappedSetInterval = function (callback, time) {\n    if (typeof time !== 'number') {\n      time = 1;\n    }\n\n    return setInterval(callback, time);\n  };\n\n  var wrappedClearTimeout = function (id) {\n    return clearTimeout(id);\n  };\n\n  var wrappedClearInterval = function (id) {\n    return clearInterval(id);\n  };\n\n  var debounce = function (callback, time) {\n    var timer;\n\n    var func = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      clearTimeout(timer);\n      timer = wrappedSetTimeout(function () {\n        callback.apply(this, args);\n      }, time);\n    };\n\n    func.stop = function () {\n      clearTimeout(timer);\n    };\n\n    return func;\n  };\n\n  var Delay = {\n    requestAnimationFrame: function (callback, element) {\n      if (requestAnimationFramePromise) {\n        requestAnimationFramePromise.then(callback);\n        return;\n      }\n\n      requestAnimationFramePromise = new promiseObj(function (resolve) {\n        if (!element) {\n          element = document.body;\n        }\n\n        requestAnimationFrame(resolve, element);\n      }).then(callback);\n    },\n    setTimeout: wrappedSetTimeout,\n    setInterval: wrappedSetInterval,\n    setEditorTimeout: function (editor, callback, time) {\n      return wrappedSetTimeout(function () {\n        if (!editor.removed) {\n          callback();\n        }\n      }, time);\n    },\n    setEditorInterval: function (editor, callback, time) {\n      var timer = wrappedSetInterval(function () {\n        if (!editor.removed) {\n          callback();\n        } else {\n          clearInterval(timer);\n        }\n      }, time);\n      return timer;\n    },\n    debounce: debounce,\n    throttle: debounce,\n    clearInterval: wrappedClearInterval,\n    clearTimeout: wrappedClearTimeout\n  };\n\n  var StyleSheetLoader = function (documentOrShadowRoot, settings) {\n    if (settings === void 0) {\n      settings = {};\n    }\n\n    var idCount = 0;\n    var loadedStates = {};\n    var edos = SugarElement.fromDom(documentOrShadowRoot);\n    var doc = documentOrOwner(edos);\n    var maxLoadTime = settings.maxLoadTime || 5000;\n\n    var _setReferrerPolicy = function (referrerPolicy) {\n      settings.referrerPolicy = referrerPolicy;\n    };\n\n    var addStyle = function (element) {\n      append(getStyleContainer(edos), element);\n    };\n\n    var removeStyle = function (id) {\n      var styleContainer = getStyleContainer(edos);\n      descendant(styleContainer, '#' + id).each(remove);\n    };\n\n    var getOrCreateState = function (url) {\n      return get$1(loadedStates, url).getOrThunk(function () {\n        return {\n          id: 'mce-u' + idCount++,\n          passed: [],\n          failed: [],\n          count: 0\n        };\n      });\n    };\n\n    var load = function (url, success, failure) {\n      var link;\n\n      var urlWithSuffix = Tools._addCacheSuffix(url);\n\n      var state = getOrCreateState(urlWithSuffix);\n      loadedStates[urlWithSuffix] = state;\n      state.count++;\n\n      var resolve = function (callbacks, status) {\n        var i = callbacks.length;\n\n        while (i--) {\n          callbacks[i]();\n        }\n\n        state.status = status;\n        state.passed = [];\n        state.failed = [];\n\n        if (link) {\n          link.onload = null;\n          link.onerror = null;\n          link = null;\n        }\n      };\n\n      var passed = function () {\n        return resolve(state.passed, 2);\n      };\n\n      var failed = function () {\n        return resolve(state.failed, 3);\n      };\n\n      var wait = function (testCallback, waitCallback) {\n        if (!testCallback()) {\n          if (Date.now() - startTime < maxLoadTime) {\n            Delay.setTimeout(waitCallback);\n          } else {\n            failed();\n          }\n        }\n      };\n\n      var waitForWebKitLinkLoaded = function () {\n        wait(function () {\n          var styleSheets = documentOrShadowRoot.styleSheets;\n          var i = styleSheets.length;\n\n          while (i--) {\n            var styleSheet = styleSheets[i];\n            var owner = styleSheet.ownerNode;\n\n            if (owner && owner.id === link.id) {\n              passed();\n              return true;\n            }\n          }\n\n          return false;\n        }, waitForWebKitLinkLoaded);\n      };\n\n      if (success) {\n        state.passed.push(success);\n      }\n\n      if (failure) {\n        state.failed.push(failure);\n      }\n\n      if (state.status === 1) {\n        return;\n      }\n\n      if (state.status === 2) {\n        passed();\n        return;\n      }\n\n      if (state.status === 3) {\n        failed();\n        return;\n      }\n\n      state.status = 1;\n      var linkElem = SugarElement.fromTag('link', doc.dom);\n      setAll(linkElem, {\n        rel: 'stylesheet',\n        type: 'text/css',\n        id: state.id\n      });\n      var startTime = Date.now();\n\n      if (settings.contentCssCors) {\n        set(linkElem, 'crossOrigin', 'anonymous');\n      }\n\n      if (settings.referrerPolicy) {\n        set(linkElem, 'referrerpolicy', settings.referrerPolicy);\n      }\n\n      link = linkElem.dom;\n      link.onload = waitForWebKitLinkLoaded;\n      link.onerror = failed;\n      addStyle(linkElem);\n      set(linkElem, 'href', urlWithSuffix);\n    };\n\n    var loadF = function (url) {\n      return Future.nu(function (resolve) {\n        load(url, compose(resolve, constant(Result.value(url))), compose(resolve, constant(Result.error(url))));\n      });\n    };\n\n    var loadAll = function (urls, success, failure) {\n      par$1(map(urls, loadF)).get(function (result) {\n        var parts = partition(result, function (r) {\n          return r.isValue();\n        });\n\n        if (parts.fail.length > 0) {\n          failure(parts.fail.map(unite));\n        } else {\n          success(parts.pass.map(unite));\n        }\n      });\n    };\n\n    var unload = function (url) {\n      var urlWithSuffix = Tools._addCacheSuffix(url);\n\n      get$1(loadedStates, urlWithSuffix).each(function (state) {\n        var count = --state.count;\n\n        if (count === 0) {\n          delete loadedStates[urlWithSuffix];\n          removeStyle(state.id);\n        }\n      });\n    };\n\n    var unloadAll = function (urls) {\n      each(urls, function (url) {\n        unload(url);\n      });\n    };\n\n    return {\n      load: load,\n      loadAll: loadAll,\n      unload: unload,\n      unloadAll: unloadAll,\n      _setReferrerPolicy: _setReferrerPolicy\n    };\n  };\n\n  var create$1 = function () {\n    var map = new WeakMap();\n\n    var forElement = function (referenceElement, settings) {\n      var root = getRootNode(referenceElement);\n      var rootDom = root.dom;\n      return Optional.from(map.get(rootDom)).getOrThunk(function () {\n        var sl = StyleSheetLoader(rootDom, settings);\n        map.set(rootDom, sl);\n        return sl;\n      });\n    };\n\n    return {\n      forElement: forElement\n    };\n  };\n\n  var instance = create$1();\n\n  var DomTreeWalker = function () {\n    function DomTreeWalker(startNode, rootNode) {\n      this.node = startNode;\n      this.rootNode = rootNode;\n      this.current = this.current.bind(this);\n      this.next = this.next.bind(this);\n      this.prev = this.prev.bind(this);\n      this.prev2 = this.prev2.bind(this);\n    }\n\n    DomTreeWalker.prototype.current = function () {\n      return this.node;\n    };\n\n    DomTreeWalker.prototype.next = function (shallow) {\n      this.node = this.findSibling(this.node, 'firstChild', 'nextSibling', shallow);\n      return this.node;\n    };\n\n    DomTreeWalker.prototype.prev = function (shallow) {\n      this.node = this.findSibling(this.node, 'lastChild', 'previousSibling', shallow);\n      return this.node;\n    };\n\n    DomTreeWalker.prototype.prev2 = function (shallow) {\n      this.node = this.findPreviousNode(this.node, 'lastChild', 'previousSibling', shallow);\n      return this.node;\n    };\n\n    DomTreeWalker.prototype.findSibling = function (node, startName, siblingName, shallow) {\n      var sibling, parent;\n\n      if (node) {\n        if (!shallow && node[startName]) {\n          return node[startName];\n        }\n\n        if (node !== this.rootNode) {\n          sibling = node[siblingName];\n\n          if (sibling) {\n            return sibling;\n          }\n\n          for (parent = node.parentNode; parent && parent !== this.rootNode; parent = parent.parentNode) {\n            sibling = parent[siblingName];\n\n            if (sibling) {\n              return sibling;\n            }\n          }\n        }\n      }\n    };\n\n    DomTreeWalker.prototype.findPreviousNode = function (node, startName, siblingName, shallow) {\n      var sibling, parent, child;\n\n      if (node) {\n        sibling = node[siblingName];\n\n        if (this.rootNode && sibling === this.rootNode) {\n          return;\n        }\n\n        if (sibling) {\n          if (!shallow) {\n            for (child = sibling[startName]; child; child = child[startName]) {\n              if (!child[startName]) {\n                return child;\n              }\n            }\n          }\n\n          return sibling;\n        }\n\n        parent = node.parentNode;\n\n        if (parent && parent !== this.rootNode) {\n          return parent;\n        }\n      }\n    };\n\n    return DomTreeWalker;\n  }();\n\n  var blocks = ['article', 'aside', 'details', 'div', 'dt', 'figcaption', 'footer', 'form', 'fieldset', 'header', 'hgroup', 'html', 'main', 'nav', 'section', 'summary', 'body', 'p', 'dl', 'multicol', 'dd', 'figure', 'address', 'center', 'blockquote', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'listing', 'xmp', 'pre', 'plaintext', 'menu', 'dir', 'ul', 'ol', 'li', 'hr', 'table', 'tbody', 'thead', 'tfoot', 'th', 'tr', 'td', 'caption'];\n  var tableCells = ['td', 'th'];\n  var tableSections = ['thead', 'tbody', 'tfoot'];\n  var textBlocks = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'div', 'address', 'pre', 'form', 'blockquote', 'center', 'dir', 'fieldset', 'header', 'footer', 'article', 'section', 'hgroup', 'aside', 'nav', 'figure'];\n  var headings = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n  var listItems = ['li', 'dd', 'dt'];\n  var lists = ['ul', 'ol', 'dl'];\n  var wsElements = ['pre', 'script', 'textarea', 'style'];\n\n  var lazyLookup = function (items) {\n    var lookup;\n    return function (node) {\n      lookup = lookup ? lookup : mapToObject(items, always);\n      return lookup.hasOwnProperty(name(node));\n    };\n  };\n\n  var isHeading = lazyLookup(headings);\n  var isBlock = lazyLookup(blocks);\n\n  var isTable$1 = function (node) {\n    return name(node) === 'table';\n  };\n\n  var isInline = function (node) {\n    return isElement(node) && !isBlock(node);\n  };\n\n  var isBr$1 = function (node) {\n    return isElement(node) && name(node) === 'br';\n  };\n\n  var isTextBlock = lazyLookup(textBlocks);\n  var isList = lazyLookup(lists);\n  var isListItem = lazyLookup(listItems);\n  var isTableSection = lazyLookup(tableSections);\n  var isTableCell$1 = lazyLookup(tableCells);\n  var isWsPreserveElement = lazyLookup(wsElements);\n\n  var ancestor$2 = function (scope, selector, isRoot) {\n    return ancestor$1(scope, selector, isRoot).isSome();\n  };\n\n  var zeroWidth = '\\uFEFF';\n  var nbsp = '\\xA0';\n\n  var isZwsp = function (char) {\n    return char === zeroWidth;\n  };\n\n  var removeZwsp = function (s) {\n    return s.replace(/\\uFEFF/g, '');\n  };\n\n  var ZWSP = zeroWidth;\n  var isZwsp$1 = isZwsp;\n  var trim$2 = removeZwsp;\n  var isElement$2 = isElement$1;\n  var isText$2 = isText$1;\n\n  var isCaretContainerBlock = function (node) {\n    if (isText$2(node)) {\n      node = node.parentNode;\n    }\n\n    return isElement$2(node) && node.hasAttribute('data-mce-caret');\n  };\n\n  var isCaretContainerInline = function (node) {\n    return isText$2(node) && isZwsp$1(node.data);\n  };\n\n  var isCaretContainer = function (node) {\n    return isCaretContainerBlock(node) || isCaretContainerInline(node);\n  };\n\n  var hasContent = function (node) {\n    return node.firstChild !== node.lastChild || !isBr(node.firstChild);\n  };\n\n  var insertInline = function (node, before) {\n    var sibling;\n    var doc = node.ownerDocument;\n    var textNode = doc.createTextNode(ZWSP);\n    var parentNode = node.parentNode;\n\n    if (!before) {\n      sibling = node.nextSibling;\n\n      if (isText$2(sibling)) {\n        if (isCaretContainer(sibling)) {\n          return sibling;\n        }\n\n        if (startsWithCaretContainer(sibling)) {\n          sibling.splitText(1);\n          return sibling;\n        }\n      }\n\n      if (node.nextSibling) {\n        parentNode.insertBefore(textNode, node.nextSibling);\n      } else {\n        parentNode.appendChild(textNode);\n      }\n    } else {\n      sibling = node.previousSibling;\n\n      if (isText$2(sibling)) {\n        if (isCaretContainer(sibling)) {\n          return sibling;\n        }\n\n        if (endsWithCaretContainer(sibling)) {\n          return sibling.splitText(sibling.data.length - 1);\n        }\n      }\n\n      parentNode.insertBefore(textNode, node);\n    }\n\n    return textNode;\n  };\n\n  var isBeforeInline = function (pos) {\n    var container = pos.container();\n\n    if (!isText$1(container)) {\n      return false;\n    }\n\n    return container.data.charAt(pos.offset()) === ZWSP || pos.isAtStart() && isCaretContainerInline(container.previousSibling);\n  };\n\n  var isAfterInline = function (pos) {\n    var container = pos.container();\n\n    if (!isText$1(container)) {\n      return false;\n    }\n\n    return container.data.charAt(pos.offset() - 1) === ZWSP || pos.isAtEnd() && isCaretContainerInline(container.nextSibling);\n  };\n\n  var createBogusBr = function () {\n    var br = document.createElement('br');\n    br.setAttribute('data-mce-bogus', '1');\n    return br;\n  };\n\n  var insertBlock = function (blockName, node, before) {\n    var doc = node.ownerDocument;\n    var blockNode = doc.createElement(blockName);\n    blockNode.setAttribute('data-mce-caret', before ? 'before' : 'after');\n    blockNode.setAttribute('data-mce-bogus', 'all');\n    blockNode.appendChild(createBogusBr());\n    var parentNode = node.parentNode;\n\n    if (!before) {\n      if (node.nextSibling) {\n        parentNode.insertBefore(blockNode, node.nextSibling);\n      } else {\n        parentNode.appendChild(blockNode);\n      }\n    } else {\n      parentNode.insertBefore(blockNode, node);\n    }\n\n    return blockNode;\n  };\n\n  var startsWithCaretContainer = function (node) {\n    return isText$2(node) && node.data[0] === ZWSP;\n  };\n\n  var endsWithCaretContainer = function (node) {\n    return isText$2(node) && node.data[node.data.length - 1] === ZWSP;\n  };\n\n  var trimBogusBr = function (elm) {\n    var brs = elm.getElementsByTagName('br');\n    var lastBr = brs[brs.length - 1];\n\n    if (isBogus(lastBr)) {\n      lastBr.parentNode.removeChild(lastBr);\n    }\n  };\n\n  var showCaretContainerBlock = function (caretContainer) {\n    if (caretContainer && caretContainer.hasAttribute('data-mce-caret')) {\n      trimBogusBr(caretContainer);\n      caretContainer.removeAttribute('data-mce-caret');\n      caretContainer.removeAttribute('data-mce-bogus');\n      caretContainer.removeAttribute('style');\n      caretContainer.removeAttribute('_moz_abspos');\n      return caretContainer;\n    }\n\n    return null;\n  };\n\n  var isRangeInCaretContainerBlock = function (range) {\n    return isCaretContainerBlock(range.startContainer);\n  };\n\n  var isContentEditableTrue$1 = isContentEditableTrue;\n  var isContentEditableFalse$1 = isContentEditableFalse;\n  var isBr$2 = isBr;\n  var isText$3 = isText$1;\n  var isInvalidTextElement = matchNodeNames(['script', 'style', 'textarea']);\n  var isAtomicInline = matchNodeNames(['img', 'input', 'textarea', 'hr', 'iframe', 'video', 'audio', 'object', 'embed']);\n  var isTable$2 = matchNodeNames(['table']);\n  var isCaretContainer$1 = isCaretContainer;\n\n  var isCaretCandidate = function (node) {\n    if (isCaretContainer$1(node)) {\n      return false;\n    }\n\n    if (isText$3(node)) {\n      return !isInvalidTextElement(node.parentNode);\n    }\n\n    return isAtomicInline(node) || isBr$2(node) || isTable$2(node) || isNonUiContentEditableFalse(node);\n  };\n\n  var isUnselectable = function (node) {\n    return isElement$1(node) && node.getAttribute('unselectable') === 'true';\n  };\n\n  var isNonUiContentEditableFalse = function (node) {\n    return isUnselectable(node) === false && isContentEditableFalse$1(node);\n  };\n\n  var isInEditable = function (node, root) {\n    for (node = node.parentNode; node && node !== root; node = node.parentNode) {\n      if (isNonUiContentEditableFalse(node)) {\n        return false;\n      }\n\n      if (isContentEditableTrue$1(node)) {\n        return true;\n      }\n    }\n\n    return true;\n  };\n\n  var isAtomicContentEditableFalse = function (node) {\n    if (!isNonUiContentEditableFalse(node)) {\n      return false;\n    }\n\n    return foldl(from$1(node.getElementsByTagName('*')), function (result, elm) {\n      return result || isContentEditableTrue$1(elm);\n    }, false) !== true;\n  };\n\n  var isAtomic = function (node) {\n    return isAtomicInline(node) || isAtomicContentEditableFalse(node);\n  };\n\n  var isEditableCaretCandidate = function (node, root) {\n    return isCaretCandidate(node) && isInEditable(node, root);\n  };\n\n  var whiteSpaceRegExp$1 = /^[ \\t\\r\\n]*$/;\n\n  var isWhitespaceText = function (text) {\n    return whiteSpaceRegExp$1.test(text);\n  };\n\n  var hasWhitespacePreserveParent = function (node, rootNode) {\n    var rootElement = SugarElement.fromDom(rootNode);\n    var startNode = SugarElement.fromDom(node);\n    return ancestor$2(startNode, 'pre,code', curry(eq$2, rootElement));\n  };\n\n  var isWhitespace = function (node, rootNode) {\n    return isText$1(node) && isWhitespaceText(node.data) && hasWhitespacePreserveParent(node, rootNode) === false;\n  };\n\n  var isNamedAnchor = function (node) {\n    return isElement$1(node) && node.nodeName === 'A' && !node.hasAttribute('href') && (node.hasAttribute('name') || node.hasAttribute('id'));\n  };\n\n  var isContent = function (node, rootNode) {\n    return isCaretCandidate(node) && isWhitespace(node, rootNode) === false || isNamedAnchor(node) || isBookmark(node);\n  };\n\n  var isBookmark = hasAttribute('data-mce-bookmark');\n  var isBogus$1 = hasAttribute('data-mce-bogus');\n  var isBogusAll$1 = hasAttributeValue('data-mce-bogus', 'all');\n\n  var isEmptyNode = function (targetNode, skipBogus) {\n    var node,\n        brCount = 0;\n\n    if (isContent(targetNode, targetNode)) {\n      return false;\n    } else {\n      node = targetNode.firstChild;\n\n      if (!node) {\n        return true;\n      }\n\n      var walker = new DomTreeWalker(node, targetNode);\n\n      do {\n        if (skipBogus) {\n          if (isBogusAll$1(node)) {\n            node = walker.next(true);\n            continue;\n          }\n\n          if (isBogus$1(node)) {\n            node = walker.next();\n            continue;\n          }\n        }\n\n        if (isBr(node)) {\n          brCount++;\n          node = walker.next();\n          continue;\n        }\n\n        if (isContent(node, targetNode)) {\n          return false;\n        }\n\n        node = walker.next();\n      } while (node);\n\n      return brCount <= 1;\n    }\n  };\n\n  var isEmpty = function (elm, skipBogus) {\n    if (skipBogus === void 0) {\n      skipBogus = true;\n    }\n\n    return isEmptyNode(elm.dom, skipBogus);\n  };\n\n  var isSpan = function (node) {\n    return node.nodeName.toLowerCase() === 'span';\n  };\n\n  var isInlineContent = function (node, root) {\n    return isNonNullable(node) && (isContent(node, root) || isInline(SugarElement.fromDom(node)));\n  };\n\n  var surroundedByInlineContent = function (node, root) {\n    var prev = new DomTreeWalker(node, root).prev(false);\n    var next = new DomTreeWalker(node, root).next(false);\n    var prevIsInline = isUndefined(prev) || isInlineContent(prev, root);\n    var nextIsInline = isUndefined(next) || isInlineContent(next, root);\n    return prevIsInline && nextIsInline;\n  };\n\n  var isBookmarkNode = function (node) {\n    return isSpan(node) && node.getAttribute('data-mce-type') === 'bookmark';\n  };\n\n  var isKeepTextNode = function (node, root) {\n    return isText$1(node) && node.data.length > 0 && surroundedByInlineContent(node, root);\n  };\n\n  var isKeepElement = function (node) {\n    return isElement$1(node) ? node.childNodes.length > 0 : false;\n  };\n\n  var isDocument$2 = function (node) {\n    return isDocumentFragment$1(node) || isDocument$1(node);\n  };\n\n  var trimNode = function (dom, node, root) {\n    var rootNode = root || node;\n\n    if (isElement$1(node) && isBookmarkNode(node)) {\n      return node;\n    }\n\n    var children = node.childNodes;\n\n    for (var i = children.length - 1; i >= 0; i--) {\n      trimNode(dom, children[i], rootNode);\n    }\n\n    if (isElement$1(node)) {\n      var currentChildren = node.childNodes;\n\n      if (currentChildren.length === 1 && isBookmarkNode(currentChildren[0])) {\n        node.parentNode.insertBefore(currentChildren[0], node);\n      }\n    }\n\n    if (!isDocument$2(node) && !isContent(node, rootNode) && !isKeepElement(node) && !isKeepTextNode(node, rootNode)) {\n      dom.remove(node);\n    }\n\n    return node;\n  };\n\n  var makeMap$1 = Tools.makeMap;\n  var attrsCharsRegExp = /[&<>\\\"\\u0060\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n  var textCharsRegExp = /[<>&\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n  var rawCharsRegExp = /[<>&\\\"\\']/g;\n  var entityRegExp = /&#([a-z0-9]+);?|&([a-z0-9]+);/gi;\n  var asciiMap = {\n    128: '\\u20AC',\n    130: '\\u201A',\n    131: '\\u0192',\n    132: '\\u201E',\n    133: '\\u2026',\n    134: '\\u2020',\n    135: '\\u2021',\n    136: '\\u02c6',\n    137: '\\u2030',\n    138: '\\u0160',\n    139: '\\u2039',\n    140: '\\u0152',\n    142: '\\u017d',\n    145: '\\u2018',\n    146: '\\u2019',\n    147: '\\u201C',\n    148: '\\u201D',\n    149: '\\u2022',\n    150: '\\u2013',\n    151: '\\u2014',\n    152: '\\u02DC',\n    153: '\\u2122',\n    154: '\\u0161',\n    155: '\\u203A',\n    156: '\\u0153',\n    158: '\\u017e',\n    159: '\\u0178'\n  };\n  var baseEntities = {\n    '\"': '&quot;',\n    '\\'': '&#39;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '&': '&amp;',\n    '`': '&#96;'\n  };\n  var reverseEntities = {\n    '&lt;': '<',\n    '&gt;': '>',\n    '&amp;': '&',\n    '&quot;': '\"',\n    '&apos;': '\\''\n  };\n\n  var nativeDecode = function (text) {\n    var elm = SugarElement.fromTag('div').dom;\n    elm.innerHTML = text;\n    return elm.textContent || elm.innerText || text;\n  };\n\n  var buildEntitiesLookup = function (items, radix) {\n    var i, chr, entity;\n    var lookup = {};\n\n    if (items) {\n      items = items.split(',');\n      radix = radix || 10;\n\n      for (i = 0; i < items.length; i += 2) {\n        chr = String.fromCharCode(parseInt(items[i], radix));\n\n        if (!baseEntities[chr]) {\n          entity = '&' + items[i + 1] + ';';\n          lookup[chr] = entity;\n          lookup[entity] = chr;\n        }\n      }\n\n      return lookup;\n    }\n  };\n\n  var namedEntities = buildEntitiesLookup('50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,' + '5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,' + '5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,' + '5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,' + '68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,' + '6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,' + '6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,' + '75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,' + '7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,' + '7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,' + 'sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,' + 'st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,' + 't9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,' + 'tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,' + 'u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,' + '81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,' + '8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,' + '8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,' + '8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,' + '8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,' + 'nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,' + 'rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,' + 'Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,' + '80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,' + '811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro', 32);\n\n  var encodeRaw = function (text, attr) {\n    return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n      return baseEntities[chr] || chr;\n    });\n  };\n\n  var encodeAllRaw = function (text) {\n    return ('' + text).replace(rawCharsRegExp, function (chr) {\n      return baseEntities[chr] || chr;\n    });\n  };\n\n  var encodeNumeric = function (text, attr) {\n    return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n      if (chr.length > 1) {\n        return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n      }\n\n      return baseEntities[chr] || '&#' + chr.charCodeAt(0) + ';';\n    });\n  };\n\n  var encodeNamed = function (text, attr, entities) {\n    entities = entities || namedEntities;\n    return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n      return baseEntities[chr] || entities[chr] || chr;\n    });\n  };\n\n  var getEncodeFunc = function (name, entities) {\n    var entitiesMap = buildEntitiesLookup(entities) || namedEntities;\n\n    var encodeNamedAndNumeric = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        if (baseEntities[chr] !== undefined) {\n          return baseEntities[chr];\n        }\n\n        if (entitiesMap[chr] !== undefined) {\n          return entitiesMap[chr];\n        }\n\n        if (chr.length > 1) {\n          return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n        }\n\n        return '&#' + chr.charCodeAt(0) + ';';\n      });\n    };\n\n    var encodeCustomNamed = function (text, attr) {\n      return encodeNamed(text, attr, entitiesMap);\n    };\n\n    var nameMap = makeMap$1(name.replace(/\\+/g, ','));\n\n    if (nameMap.named && nameMap.numeric) {\n      return encodeNamedAndNumeric;\n    }\n\n    if (nameMap.named) {\n      if (entities) {\n        return encodeCustomNamed;\n      }\n\n      return encodeNamed;\n    }\n\n    if (nameMap.numeric) {\n      return encodeNumeric;\n    }\n\n    return encodeRaw;\n  };\n\n  var decode = function (text) {\n    return text.replace(entityRegExp, function (all, numeric) {\n      if (numeric) {\n        if (numeric.charAt(0).toLowerCase() === 'x') {\n          numeric = parseInt(numeric.substr(1), 16);\n        } else {\n          numeric = parseInt(numeric, 10);\n        }\n\n        if (numeric > 65535) {\n          numeric -= 65536;\n          return String.fromCharCode(55296 + (numeric >> 10), 56320 + (numeric & 1023));\n        }\n\n        return asciiMap[numeric] || String.fromCharCode(numeric);\n      }\n\n      return reverseEntities[all] || namedEntities[all] || nativeDecode(all);\n    });\n  };\n\n  var Entities = {\n    encodeRaw: encodeRaw,\n    encodeAllRaw: encodeAllRaw,\n    encodeNumeric: encodeNumeric,\n    encodeNamed: encodeNamed,\n    getEncodeFunc: getEncodeFunc,\n    decode: decode\n  };\n  var mapCache = {},\n      dummyObj = {};\n  var makeMap$2 = Tools.makeMap,\n      each$3 = Tools.each,\n      extend$1 = Tools.extend,\n      explode$1 = Tools.explode,\n      inArray = Tools.inArray;\n\n  var split = function (items, delim) {\n    items = Tools.trim(items);\n    return items ? items.split(delim || ' ') : [];\n  };\n\n  var compileSchema = function (type) {\n    var schema = {};\n    var globalAttributes, blockContent;\n    var phrasingContent, flowContent, html4BlockContent, html4PhrasingContent;\n\n    var add = function (name, attributes, children) {\n      var ni, attributesOrder, element;\n\n      var arrayToMap = function (array, obj) {\n        var map = {};\n        var i, l;\n\n        for (i = 0, l = array.length; i < l; i++) {\n          map[array[i]] = obj || {};\n        }\n\n        return map;\n      };\n\n      children = children || [];\n      attributes = attributes || '';\n\n      if (typeof children === 'string') {\n        children = split(children);\n      }\n\n      var names = split(name);\n      ni = names.length;\n\n      while (ni--) {\n        attributesOrder = split([globalAttributes, attributes].join(' '));\n        element = {\n          attributes: arrayToMap(attributesOrder),\n          attributesOrder: attributesOrder,\n          children: arrayToMap(children, dummyObj)\n        };\n        schema[names[ni]] = element;\n      }\n    };\n\n    var addAttrs = function (name, attributes) {\n      var ni, schemaItem, i, l;\n      var names = split(name);\n      ni = names.length;\n      var attrs = split(attributes);\n\n      while (ni--) {\n        schemaItem = schema[names[ni]];\n\n        for (i = 0, l = attrs.length; i < l; i++) {\n          schemaItem.attributes[attrs[i]] = {};\n          schemaItem.attributesOrder.push(attrs[i]);\n        }\n      }\n    };\n\n    if (mapCache[type]) {\n      return mapCache[type];\n    }\n\n    globalAttributes = 'id accesskey class dir lang style tabindex title role';\n    blockContent = 'address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul';\n    phrasingContent = 'a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd ' + 'label map noscript object q s samp script select small span strong sub sup ' + 'textarea u var #text #comment';\n\n    if (type !== 'html4') {\n      globalAttributes += ' contenteditable contextmenu draggable dropzone ' + 'hidden spellcheck translate';\n      blockContent += ' article aside details dialog figure main header footer hgroup section nav';\n      phrasingContent += ' audio canvas command datalist mark meter output picture ' + 'progress time wbr video ruby bdi keygen';\n    }\n\n    if (type !== 'html5-strict') {\n      globalAttributes += ' xml:lang';\n      html4PhrasingContent = 'acronym applet basefont big font strike tt';\n      phrasingContent = [phrasingContent, html4PhrasingContent].join(' ');\n      each$3(split(html4PhrasingContent), function (name) {\n        add(name, '', phrasingContent);\n      });\n      html4BlockContent = 'center dir isindex noframes';\n      blockContent = [blockContent, html4BlockContent].join(' ');\n      flowContent = [blockContent, phrasingContent].join(' ');\n      each$3(split(html4BlockContent), function (name) {\n        add(name, '', flowContent);\n      });\n    }\n\n    flowContent = flowContent || [blockContent, phrasingContent].join(' ');\n    add('html', 'manifest', 'head body');\n    add('head', '', 'base command link meta noscript script style title');\n    add('title hr noscript br');\n    add('base', 'href target');\n    add('link', 'href rel media hreflang type sizes hreflang');\n    add('meta', 'name http-equiv content charset');\n    add('style', 'media type scoped');\n    add('script', 'src async defer type charset');\n    add('body', 'onafterprint onbeforeprint onbeforeunload onblur onerror onfocus ' + 'onhashchange onload onmessage onoffline ononline onpagehide onpageshow ' + 'onpopstate onresize onscroll onstorage onunload', flowContent);\n    add('address dt dd div caption', '', flowContent);\n    add('h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn', '', phrasingContent);\n    add('blockquote', 'cite', flowContent);\n    add('ol', 'reversed start type', 'li');\n    add('ul', '', 'li');\n    add('li', 'value', flowContent);\n    add('dl', '', 'dt dd');\n    add('a', 'href target rel media hreflang type', phrasingContent);\n    add('q', 'cite', phrasingContent);\n    add('ins del', 'cite datetime', flowContent);\n    add('img', 'src sizes srcset alt usemap ismap width height');\n    add('iframe', 'src name width height', flowContent);\n    add('embed', 'src type width height');\n    add('object', 'data type typemustmatch name usemap form width height', [flowContent, 'param'].join(' '));\n    add('param', 'name value');\n    add('map', 'name', [flowContent, 'area'].join(' '));\n    add('area', 'alt coords shape href target rel media hreflang type');\n    add('table', 'border', 'caption colgroup thead tfoot tbody tr' + (type === 'html4' ? ' col' : ''));\n    add('colgroup', 'span', 'col');\n    add('col', 'span');\n    add('tbody thead tfoot', '', 'tr');\n    add('tr', '', 'td th');\n    add('td', 'colspan rowspan headers', flowContent);\n    add('th', 'colspan rowspan headers scope abbr', flowContent);\n    add('form', 'accept-charset action autocomplete enctype method name novalidate target', flowContent);\n    add('fieldset', 'disabled form name', [flowContent, 'legend'].join(' '));\n    add('label', 'form for', phrasingContent);\n    add('input', 'accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate ' + 'formtarget height list max maxlength min multiple name pattern readonly required size src step type value width');\n    add('button', 'disabled form formaction formenctype formmethod formnovalidate formtarget name type value', type === 'html4' ? flowContent : phrasingContent);\n    add('select', 'disabled form multiple name required size', 'option optgroup');\n    add('optgroup', 'disabled label', 'option');\n    add('option', 'disabled label selected value');\n    add('textarea', 'cols dirname disabled form maxlength name readonly required rows wrap');\n    add('menu', 'type label', [flowContent, 'li'].join(' '));\n    add('noscript', '', flowContent);\n\n    if (type !== 'html4') {\n      add('wbr');\n      add('ruby', '', [phrasingContent, 'rt rp'].join(' '));\n      add('figcaption', '', flowContent);\n      add('mark rt rp summary bdi', '', phrasingContent);\n      add('canvas', 'width height', flowContent);\n      add('video', 'src crossorigin poster preload autoplay mediagroup loop ' + 'muted controls width height buffered', [flowContent, 'track source'].join(' '));\n      add('audio', 'src crossorigin preload autoplay mediagroup loop muted controls ' + 'buffered volume', [flowContent, 'track source'].join(' '));\n      add('picture', '', 'img source');\n      add('source', 'src srcset type media sizes');\n      add('track', 'kind src srclang label default');\n      add('datalist', '', [phrasingContent, 'option'].join(' '));\n      add('article section nav aside main header footer', '', flowContent);\n      add('hgroup', '', 'h1 h2 h3 h4 h5 h6');\n      add('figure', '', [flowContent, 'figcaption'].join(' '));\n      add('time', 'datetime', phrasingContent);\n      add('dialog', 'open', flowContent);\n      add('command', 'type label icon disabled checked radiogroup command');\n      add('output', 'for form name', phrasingContent);\n      add('progress', 'value max', phrasingContent);\n      add('meter', 'value min max low high optimum', phrasingContent);\n      add('details', 'open', [flowContent, 'summary'].join(' '));\n      add('keygen', 'autofocus challenge disabled form keytype name');\n    }\n\n    if (type !== 'html5-strict') {\n      addAttrs('script', 'language xml:space');\n      addAttrs('style', 'xml:space');\n      addAttrs('object', 'declare classid code codebase codetype archive standby align border hspace vspace');\n      addAttrs('embed', 'align name hspace vspace');\n      addAttrs('param', 'valuetype type');\n      addAttrs('a', 'charset name rev shape coords');\n      addAttrs('br', 'clear');\n      addAttrs('applet', 'codebase archive code object alt name width height align hspace vspace');\n      addAttrs('img', 'name longdesc align border hspace vspace');\n      addAttrs('iframe', 'longdesc frameborder marginwidth marginheight scrolling align');\n      addAttrs('font basefont', 'size color face');\n      addAttrs('input', 'usemap align');\n      addAttrs('select');\n      addAttrs('textarea');\n      addAttrs('h1 h2 h3 h4 h5 h6 div p legend caption', 'align');\n      addAttrs('ul', 'type compact');\n      addAttrs('li', 'type');\n      addAttrs('ol dl menu dir', 'compact');\n      addAttrs('pre', 'width xml:space');\n      addAttrs('hr', 'align noshade size width');\n      addAttrs('isindex', 'prompt');\n      addAttrs('table', 'summary width frame rules cellspacing cellpadding align bgcolor');\n      addAttrs('col', 'width align char charoff valign');\n      addAttrs('colgroup', 'width align char charoff valign');\n      addAttrs('thead', 'align char charoff valign');\n      addAttrs('tr', 'align char charoff valign bgcolor');\n      addAttrs('th', 'axis align char charoff valign nowrap bgcolor width height');\n      addAttrs('form', 'accept');\n      addAttrs('td', 'abbr axis scope align char charoff valign nowrap bgcolor width height');\n      addAttrs('tfoot', 'align char charoff valign');\n      addAttrs('tbody', 'align char charoff valign');\n      addAttrs('area', 'nohref');\n      addAttrs('body', 'background bgcolor text link vlink alink');\n    }\n\n    if (type !== 'html4') {\n      addAttrs('input button select textarea', 'autofocus');\n      addAttrs('input textarea', 'placeholder');\n      addAttrs('a', 'download');\n      addAttrs('link script img', 'crossorigin');\n      addAttrs('img', 'loading');\n      addAttrs('iframe', 'sandbox seamless allowfullscreen loading');\n    }\n\n    each$3(split('a form meter progress dfn'), function (name) {\n      if (schema[name]) {\n        delete schema[name].children[name];\n      }\n    });\n    delete schema.caption.children.table;\n    delete schema.script;\n    mapCache[type] = schema;\n    return schema;\n  };\n\n  var compileElementMap = function (value, mode) {\n    var styles;\n\n    if (value) {\n      styles = {};\n\n      if (typeof value === 'string') {\n        value = {\n          '*': value\n        };\n      }\n\n      each$3(value, function (value, key) {\n        styles[key] = styles[key.toUpperCase()] = mode === 'map' ? makeMap$2(value, /[, ]/) : explode$1(value, /[, ]/);\n      });\n    }\n\n    return styles;\n  };\n\n  var Schema = function (settings) {\n    var elements = {};\n    var children = {};\n    var patternElements = [];\n    var customElementsMap = {},\n        specialElements = {};\n\n    var createLookupTable = function (option, defaultValue, extendWith) {\n      var value = settings[option];\n\n      if (!value) {\n        value = mapCache[option];\n\n        if (!value) {\n          value = makeMap$2(defaultValue, ' ', makeMap$2(defaultValue.toUpperCase(), ' '));\n          value = extend$1(value, extendWith);\n          mapCache[option] = value;\n        }\n      } else {\n        value = makeMap$2(value, /[, ]/, makeMap$2(value.toUpperCase(), /[, ]/));\n      }\n\n      return value;\n    };\n\n    settings = settings || {};\n    var schemaItems = compileSchema(settings.schema);\n\n    if (settings.verify_html === false) {\n      settings.valid_elements = '*[*]';\n    }\n\n    var validStyles = compileElementMap(settings.valid_styles);\n    var invalidStyles = compileElementMap(settings.invalid_styles, 'map');\n    var validClasses = compileElementMap(settings.valid_classes, 'map');\n    var whiteSpaceElementsMap = createLookupTable('whitespace_elements', 'pre script noscript style textarea video audio iframe object code');\n    var selfClosingElementsMap = createLookupTable('self_closing_elements', 'colgroup dd dt li option p td tfoot th thead tr');\n    var shortEndedElementsMap = createLookupTable('short_ended_elements', 'area base basefont br col frame hr img input isindex link ' + 'meta param embed source wbr track');\n    var boolAttrMap = createLookupTable('boolean_attributes', 'checked compact declare defer disabled ismap multiple nohref noresize ' + 'noshade nowrap readonly selected autoplay loop controls');\n    var nonEmptyOrMoveCaretBeforeOnEnter = 'td th iframe video audio object script code';\n    var nonEmptyElementsMap = createLookupTable('non_empty_elements', nonEmptyOrMoveCaretBeforeOnEnter + ' pre', shortEndedElementsMap);\n    var moveCaretBeforeOnEnterElementsMap = createLookupTable('move_caret_before_on_enter_elements', nonEmptyOrMoveCaretBeforeOnEnter + ' table', shortEndedElementsMap);\n    var textBlockElementsMap = createLookupTable('text_block_elements', 'h1 h2 h3 h4 h5 h6 p div address pre form ' + 'blockquote center dir fieldset header footer article section hgroup aside main nav figure');\n    var blockElementsMap = createLookupTable('block_elements', 'hr table tbody thead tfoot ' + 'th tr td li ol ul caption dl dt dd noscript menu isindex option ' + 'datalist select optgroup figcaption details summary', textBlockElementsMap);\n    var textInlineElementsMap = createLookupTable('text_inline_elements', 'span strong b em i font strike u var cite ' + 'dfn code mark q sup sub samp');\n    each$3((settings.special || 'script noscript iframe noframes noembed title style textarea xmp').split(' '), function (name) {\n      specialElements[name] = new RegExp('</' + name + '[^>]*>', 'gi');\n    });\n\n    var patternToRegExp = function (str) {\n      return new RegExp('^' + str.replace(/([?+*])/g, '.$1') + '$');\n    };\n\n    var addValidElements = function (validElements) {\n      var ei, el, ai, al, matches, element, attr, attrData, elementName, attrName, attrType, attributes, attributesOrder, prefix, outputName, globalAttributes, globalAttributesOrder, value;\n      var elementRuleRegExp = /^([#+\\-])?([^\\[!\\/]+)(?:\\/([^\\[!]+))?(?:(!?)\\[([^\\]]+)])?$/,\n          attrRuleRegExp = /^([!\\-])?(\\w+[\\\\:]:\\w+|[^=:<]+)?(?:([=:<])(.*))?$/,\n          hasPatternsRegExp = /[*?+]/;\n\n      if (validElements) {\n        var validElementsArr = split(validElements, ',');\n\n        if (elements['@']) {\n          globalAttributes = elements['@'].attributes;\n          globalAttributesOrder = elements['@'].attributesOrder;\n        }\n\n        for (ei = 0, el = validElementsArr.length; ei < el; ei++) {\n          matches = elementRuleRegExp.exec(validElementsArr[ei]);\n\n          if (matches) {\n            prefix = matches[1];\n            elementName = matches[2];\n            outputName = matches[3];\n            attrData = matches[5];\n            attributes = {};\n            attributesOrder = [];\n            element = {\n              attributes: attributes,\n              attributesOrder: attributesOrder\n            };\n\n            if (prefix === '#') {\n              element.paddEmpty = true;\n            }\n\n            if (prefix === '-') {\n              element.removeEmpty = true;\n            }\n\n            if (matches[4] === '!') {\n              element.removeEmptyAttrs = true;\n            }\n\n            if (globalAttributes) {\n              each$1(globalAttributes, function (value, key) {\n                attributes[key] = value;\n              });\n              attributesOrder.push.apply(attributesOrder, globalAttributesOrder);\n            }\n\n            if (attrData) {\n              attrData = split(attrData, '|');\n\n              for (ai = 0, al = attrData.length; ai < al; ai++) {\n                matches = attrRuleRegExp.exec(attrData[ai]);\n\n                if (matches) {\n                  attr = {};\n                  attrType = matches[1];\n                  attrName = matches[2].replace(/[\\\\:]:/g, ':');\n                  prefix = matches[3];\n                  value = matches[4];\n\n                  if (attrType === '!') {\n                    element.attributesRequired = element.attributesRequired || [];\n                    element.attributesRequired.push(attrName);\n                    attr.required = true;\n                  }\n\n                  if (attrType === '-') {\n                    delete attributes[attrName];\n                    attributesOrder.splice(inArray(attributesOrder, attrName), 1);\n                    continue;\n                  }\n\n                  if (prefix) {\n                    if (prefix === '=') {\n                      element.attributesDefault = element.attributesDefault || [];\n                      element.attributesDefault.push({\n                        name: attrName,\n                        value: value\n                      });\n                      attr.defaultValue = value;\n                    }\n\n                    if (prefix === ':') {\n                      element.attributesForced = element.attributesForced || [];\n                      element.attributesForced.push({\n                        name: attrName,\n                        value: value\n                      });\n                      attr.forcedValue = value;\n                    }\n\n                    if (prefix === '<') {\n                      attr.validValues = makeMap$2(value, '?');\n                    }\n                  }\n\n                  if (hasPatternsRegExp.test(attrName)) {\n                    element.attributePatterns = element.attributePatterns || [];\n                    attr.pattern = patternToRegExp(attrName);\n                    element.attributePatterns.push(attr);\n                  } else {\n                    if (!attributes[attrName]) {\n                      attributesOrder.push(attrName);\n                    }\n\n                    attributes[attrName] = attr;\n                  }\n                }\n              }\n            }\n\n            if (!globalAttributes && elementName === '@') {\n              globalAttributes = attributes;\n              globalAttributesOrder = attributesOrder;\n            }\n\n            if (outputName) {\n              element.outputName = elementName;\n              elements[outputName] = element;\n            }\n\n            if (hasPatternsRegExp.test(elementName)) {\n              element.pattern = patternToRegExp(elementName);\n              patternElements.push(element);\n            } else {\n              elements[elementName] = element;\n            }\n          }\n        }\n      }\n    };\n\n    var setValidElements = function (validElements) {\n      elements = {};\n      patternElements = [];\n      addValidElements(validElements);\n      each$3(schemaItems, function (element, name) {\n        children[name] = element.children;\n      });\n    };\n\n    var addCustomElements = function (customElements) {\n      var customElementRegExp = /^(~)?(.+)$/;\n\n      if (customElements) {\n        mapCache.text_block_elements = mapCache.block_elements = null;\n        each$3(split(customElements, ','), function (rule) {\n          var matches = customElementRegExp.exec(rule),\n              inline = matches[1] === '~',\n              cloneName = inline ? 'span' : 'div',\n              name = matches[2];\n          children[name] = children[cloneName];\n          customElementsMap[name] = cloneName;\n\n          if (!inline) {\n            blockElementsMap[name.toUpperCase()] = {};\n            blockElementsMap[name] = {};\n          }\n\n          if (!elements[name]) {\n            var customRule = elements[cloneName];\n            customRule = extend$1({}, customRule);\n            delete customRule.removeEmptyAttrs;\n            delete customRule.removeEmpty;\n            elements[name] = customRule;\n          }\n\n          each$3(children, function (element, elmName) {\n            if (element[cloneName]) {\n              children[elmName] = element = extend$1({}, children[elmName]);\n              element[name] = element[cloneName];\n            }\n          });\n        });\n      }\n    };\n\n    var addValidChildren = function (validChildren) {\n      var childRuleRegExp = /^([+\\-]?)([A-Za-z0-9_\\-.\\u00b7\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u037d\\u037f-\\u1fff\\u200c-\\u200d\\u203f-\\u2040\\u2070-\\u218f\\u2c00-\\u2fef\\u3001-\\ud7ff\\uf900-\\ufdcf\\ufdf0-\\ufffd]+)\\[([^\\]]+)]$/;\n      mapCache[settings.schema] = null;\n\n      if (validChildren) {\n        each$3(split(validChildren, ','), function (rule) {\n          var matches = childRuleRegExp.exec(rule);\n          var parent, prefix;\n\n          if (matches) {\n            prefix = matches[1];\n\n            if (prefix) {\n              parent = children[matches[2]];\n            } else {\n              parent = children[matches[2]] = {\n                '#comment': {}\n              };\n            }\n\n            parent = children[matches[2]];\n            each$3(split(matches[3], '|'), function (child) {\n              if (prefix === '-') {\n                delete parent[child];\n              } else {\n                parent[child] = {};\n              }\n            });\n          }\n        });\n      }\n    };\n\n    var getElementRule = function (name) {\n      var element = elements[name],\n          i;\n\n      if (element) {\n        return element;\n      }\n\n      i = patternElements.length;\n\n      while (i--) {\n        element = patternElements[i];\n\n        if (element.pattern.test(name)) {\n          return element;\n        }\n      }\n    };\n\n    if (!settings.valid_elements) {\n      each$3(schemaItems, function (element, name) {\n        elements[name] = {\n          attributes: element.attributes,\n          attributesOrder: element.attributesOrder\n        };\n        children[name] = element.children;\n      });\n\n      if (settings.schema !== 'html5') {\n        each$3(split('strong/b em/i'), function (item) {\n          var items = split(item, '/');\n          elements[items[1]].outputName = items[0];\n        });\n      }\n\n      each$3(split('ol ul sub sup blockquote span font a table tbody strong em b i'), function (name) {\n        if (elements[name]) {\n          elements[name].removeEmpty = true;\n        }\n      });\n      each$3(split('p h1 h2 h3 h4 h5 h6 th td pre div address caption li'), function (name) {\n        elements[name].paddEmpty = true;\n      });\n      each$3(split('span'), function (name) {\n        elements[name].removeEmptyAttrs = true;\n      });\n    } else {\n      setValidElements(settings.valid_elements);\n    }\n\n    addCustomElements(settings.custom_elements);\n    addValidChildren(settings.valid_children);\n    addValidElements(settings.extended_valid_elements);\n    addValidChildren('+ol[ul|ol],+ul[ul|ol]');\n    each$3({\n      dd: 'dl',\n      dt: 'dl',\n      li: 'ul ol',\n      td: 'tr',\n      th: 'tr',\n      tr: 'tbody thead tfoot',\n      tbody: 'table',\n      thead: 'table',\n      tfoot: 'table',\n      legend: 'fieldset',\n      area: 'map',\n      param: 'video audio object'\n    }, function (parents, item) {\n      if (elements[item]) {\n        elements[item].parentsRequired = split(parents);\n      }\n    });\n\n    if (settings.invalid_elements) {\n      each$3(explode$1(settings.invalid_elements), function (item) {\n        if (elements[item]) {\n          delete elements[item];\n        }\n      });\n    }\n\n    if (!getElementRule('span')) {\n      addValidElements('span[!data-mce-type|*]');\n    }\n\n    var getValidStyles = function () {\n      return validStyles;\n    };\n\n    var getInvalidStyles = function () {\n      return invalidStyles;\n    };\n\n    var getValidClasses = function () {\n      return validClasses;\n    };\n\n    var getBoolAttrs = function () {\n      return boolAttrMap;\n    };\n\n    var getBlockElements = function () {\n      return blockElementsMap;\n    };\n\n    var getTextBlockElements = function () {\n      return textBlockElementsMap;\n    };\n\n    var getTextInlineElements = function () {\n      return textInlineElementsMap;\n    };\n\n    var getShortEndedElements = function () {\n      return shortEndedElementsMap;\n    };\n\n    var getSelfClosingElements = function () {\n      return selfClosingElementsMap;\n    };\n\n    var getNonEmptyElements = function () {\n      return nonEmptyElementsMap;\n    };\n\n    var getMoveCaretBeforeOnEnterElements = function () {\n      return moveCaretBeforeOnEnterElementsMap;\n    };\n\n    var getWhiteSpaceElements = function () {\n      return whiteSpaceElementsMap;\n    };\n\n    var getSpecialElements = function () {\n      return specialElements;\n    };\n\n    var isValidChild = function (name, child) {\n      var parent = children[name.toLowerCase()];\n      return !!(parent && parent[child.toLowerCase()]);\n    };\n\n    var isValid = function (name, attr) {\n      var attrPatterns, i;\n      var rule = getElementRule(name);\n\n      if (rule) {\n        if (attr) {\n          if (rule.attributes[attr]) {\n            return true;\n          }\n\n          attrPatterns = rule.attributePatterns;\n\n          if (attrPatterns) {\n            i = attrPatterns.length;\n\n            while (i--) {\n              if (attrPatterns[i].pattern.test(name)) {\n                return true;\n              }\n            }\n          }\n        } else {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    var getCustomElements = function () {\n      return customElementsMap;\n    };\n\n    return {\n      children: children,\n      elements: elements,\n      getValidStyles: getValidStyles,\n      getValidClasses: getValidClasses,\n      getBlockElements: getBlockElements,\n      getInvalidStyles: getInvalidStyles,\n      getShortEndedElements: getShortEndedElements,\n      getTextBlockElements: getTextBlockElements,\n      getTextInlineElements: getTextInlineElements,\n      getBoolAttrs: getBoolAttrs,\n      getElementRule: getElementRule,\n      getSelfClosingElements: getSelfClosingElements,\n      getNonEmptyElements: getNonEmptyElements,\n      getMoveCaretBeforeOnEnterElements: getMoveCaretBeforeOnEnterElements,\n      getWhiteSpaceElements: getWhiteSpaceElements,\n      getSpecialElements: getSpecialElements,\n      isValidChild: isValidChild,\n      isValid: isValid,\n      getCustomElements: getCustomElements,\n      addValidElements: addValidElements,\n      setValidElements: setValidElements,\n      addCustomElements: addCustomElements,\n      addValidChildren: addValidChildren\n    };\n  };\n\n  var toHex = function (match, r, g, b) {\n    var hex = function (val) {\n      val = parseInt(val, 10).toString(16);\n      return val.length > 1 ? val : '0' + val;\n    };\n\n    return '#' + hex(r) + hex(g) + hex(b);\n  };\n\n  var Styles = function (settings, schema) {\n    var _this = this;\n\n    var rgbRegExp = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*\\)/gi;\n    var urlOrStrRegExp = /(?:url(?:(?:\\(\\s*\\\"([^\\\"]+)\\\"\\s*\\))|(?:\\(\\s*\\'([^\\']+)\\'\\s*\\))|(?:\\(\\s*([^)\\s]+)\\s*\\))))|(?:\\'([^\\']+)\\')|(?:\\\"([^\\\"]+)\\\")/gi;\n    var styleRegExp = /\\s*([^:]+):\\s*([^;]+);?/g;\n    var trimRightRegExp = /\\s+$/;\n    var i;\n    var encodingLookup = {};\n    var validStyles;\n    var invalidStyles;\n    var invisibleChar = zeroWidth;\n    settings = settings || {};\n\n    if (schema) {\n      validStyles = schema.getValidStyles();\n      invalidStyles = schema.getInvalidStyles();\n    }\n\n    var encodingItems = ('\\\\\" \\\\\\' \\\\; \\\\: ; : ' + invisibleChar).split(' ');\n\n    for (i = 0; i < encodingItems.length; i++) {\n      encodingLookup[encodingItems[i]] = invisibleChar + i;\n      encodingLookup[invisibleChar + i] = encodingItems[i];\n    }\n\n    return {\n      toHex: function (color) {\n        return color.replace(rgbRegExp, toHex);\n      },\n      parse: function (css) {\n        var styles = {};\n        var matches, name, value, isEncoded;\n        var urlConverter = settings.url_converter;\n        var urlConverterScope = settings.url_converter_scope || _this;\n\n        var compress = function (prefix, suffix, noJoin) {\n          var top = styles[prefix + '-top' + suffix];\n\n          if (!top) {\n            return;\n          }\n\n          var right = styles[prefix + '-right' + suffix];\n\n          if (!right) {\n            return;\n          }\n\n          var bottom = styles[prefix + '-bottom' + suffix];\n\n          if (!bottom) {\n            return;\n          }\n\n          var left = styles[prefix + '-left' + suffix];\n\n          if (!left) {\n            return;\n          }\n\n          var box = [top, right, bottom, left];\n          i = box.length - 1;\n\n          while (i--) {\n            if (box[i] !== box[i + 1]) {\n              break;\n            }\n          }\n\n          if (i > -1 && noJoin) {\n            return;\n          }\n\n          styles[prefix + suffix] = i === -1 ? box[0] : box.join(' ');\n          delete styles[prefix + '-top' + suffix];\n          delete styles[prefix + '-right' + suffix];\n          delete styles[prefix + '-bottom' + suffix];\n          delete styles[prefix + '-left' + suffix];\n        };\n\n        var canCompress = function (key) {\n          var value = styles[key],\n              i;\n\n          if (!value) {\n            return;\n          }\n\n          value = value.split(' ');\n          i = value.length;\n\n          while (i--) {\n            if (value[i] !== value[0]) {\n              return false;\n            }\n          }\n\n          styles[key] = value[0];\n          return true;\n        };\n\n        var compress2 = function (target, a, b, c) {\n          if (!canCompress(a)) {\n            return;\n          }\n\n          if (!canCompress(b)) {\n            return;\n          }\n\n          if (!canCompress(c)) {\n            return;\n          }\n\n          styles[target] = styles[a] + ' ' + styles[b] + ' ' + styles[c];\n          delete styles[a];\n          delete styles[b];\n          delete styles[c];\n        };\n\n        var encode = function (str) {\n          isEncoded = true;\n          return encodingLookup[str];\n        };\n\n        var decode = function (str, keepSlashes) {\n          if (isEncoded) {\n            str = str.replace(/\\uFEFF[0-9]/g, function (str) {\n              return encodingLookup[str];\n            });\n          }\n\n          if (!keepSlashes) {\n            str = str.replace(/\\\\([\\'\\\";:])/g, '$1');\n          }\n\n          return str;\n        };\n\n        var decodeSingleHexSequence = function (escSeq) {\n          return String.fromCharCode(parseInt(escSeq.slice(1), 16));\n        };\n\n        var decodeHexSequences = function (value) {\n          return value.replace(/\\\\[0-9a-f]+/gi, decodeSingleHexSequence);\n        };\n\n        var processUrl = function (match, url, url2, url3, str, str2) {\n          str = str || str2;\n\n          if (str) {\n            str = decode(str);\n            return '\\'' + str.replace(/\\'/g, '\\\\\\'') + '\\'';\n          }\n\n          url = decode(url || url2 || url3);\n\n          if (!settings.allow_script_urls) {\n            var scriptUrl = url.replace(/[\\s\\r\\n]+/g, '');\n\n            if (/(java|vb)script:/i.test(scriptUrl)) {\n              return '';\n            }\n\n            if (!settings.allow_svg_data_urls && /^data:image\\/svg/i.test(scriptUrl)) {\n              return '';\n            }\n          }\n\n          if (urlConverter) {\n            url = urlConverter.call(urlConverterScope, url, 'style');\n          }\n\n          return 'url(\\'' + url.replace(/\\'/g, '\\\\\\'') + '\\')';\n        };\n\n        if (css) {\n          css = css.replace(/[\\u0000-\\u001F]/g, '');\n          css = css.replace(/\\\\[\\\"\\';:\\uFEFF]/g, encode).replace(/\\\"[^\\\"]+\\\"|\\'[^\\']+\\'/g, function (str) {\n            return str.replace(/[;:]/g, encode);\n          });\n\n          while (matches = styleRegExp.exec(css)) {\n            styleRegExp.lastIndex = matches.index + matches[0].length;\n            name = matches[1].replace(trimRightRegExp, '').toLowerCase();\n            value = matches[2].replace(trimRightRegExp, '');\n\n            if (name && value) {\n              name = decodeHexSequences(name);\n              value = decodeHexSequences(value);\n\n              if (name.indexOf(invisibleChar) !== -1 || name.indexOf('\"') !== -1) {\n                continue;\n              }\n\n              if (!settings.allow_script_urls && (name === 'behavior' || /expression\\s*\\(|\\/\\*|\\*\\//.test(value))) {\n                continue;\n              }\n\n              if (name === 'font-weight' && value === '700') {\n                value = 'bold';\n              } else if (name === 'color' || name === 'background-color') {\n                value = value.toLowerCase();\n              }\n\n              value = value.replace(rgbRegExp, toHex);\n              value = value.replace(urlOrStrRegExp, processUrl);\n              styles[name] = isEncoded ? decode(value, true) : value;\n            }\n          }\n\n          compress('border', '', true);\n          compress('border', '-width');\n          compress('border', '-color');\n          compress('border', '-style');\n          compress('padding', '');\n          compress('margin', '');\n          compress2('border', 'border-width', 'border-style', 'border-color');\n\n          if (styles.border === 'medium none') {\n            delete styles.border;\n          }\n\n          if (styles['border-image'] === 'none') {\n            delete styles['border-image'];\n          }\n        }\n\n        return styles;\n      },\n      serialize: function (styles, elementName) {\n        var css = '';\n\n        var serializeStyles = function (name) {\n          var value;\n          var styleList = validStyles[name];\n\n          if (styleList) {\n            for (var i_1 = 0, l = styleList.length; i_1 < l; i_1++) {\n              name = styleList[i_1];\n              value = styles[name];\n\n              if (value) {\n                css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n              }\n            }\n          }\n        };\n\n        var isValid = function (name, elementName) {\n          var styleMap = invalidStyles['*'];\n\n          if (styleMap && styleMap[name]) {\n            return false;\n          }\n\n          styleMap = invalidStyles[elementName];\n          return !(styleMap && styleMap[name]);\n        };\n\n        if (elementName && validStyles) {\n          serializeStyles('*');\n          serializeStyles(elementName);\n        } else {\n          each$1(styles, function (value, name) {\n            if (value && (!invalidStyles || isValid(name, elementName))) {\n              css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n            }\n          });\n        }\n\n        return css;\n      }\n    };\n  };\n\n  var eventExpandoPrefix = 'mce-data-';\n  var mouseEventRe = /^(?:mouse|contextmenu)|click/;\n  var deprecated = {\n    keyLocation: 1,\n    layerX: 1,\n    layerY: 1,\n    returnValue: 1,\n    webkitMovementX: 1,\n    webkitMovementY: 1,\n    keyIdentifier: 1,\n    mozPressure: 1\n  };\n\n  var hasIsDefaultPrevented = function (event) {\n    return event.isDefaultPrevented === returnTrue || event.isDefaultPrevented === returnFalse;\n  };\n\n  var returnFalse = never;\n  var returnTrue = always;\n\n  var addEvent = function (target, name, callback, capture) {\n    if (target.addEventListener) {\n      target.addEventListener(name, callback, capture || false);\n    } else if (target.attachEvent) {\n      target.attachEvent('on' + name, callback);\n    }\n  };\n\n  var removeEvent = function (target, name, callback, capture) {\n    if (target.removeEventListener) {\n      target.removeEventListener(name, callback, capture || false);\n    } else if (target.detachEvent) {\n      target.detachEvent('on' + name, callback);\n    }\n  };\n\n  var isMouseEvent = function (event) {\n    return mouseEventRe.test(event.type);\n  };\n\n  var fix = function (originalEvent, data) {\n    var name;\n    var event = data || {};\n\n    for (name in originalEvent) {\n      if (!deprecated[name]) {\n        event[name] = originalEvent[name];\n      }\n    }\n\n    if (!event.target) {\n      event.target = event.srcElement || document;\n    }\n\n    if (event.composedPath) {\n      event.composedPath = function () {\n        return originalEvent.composedPath();\n      };\n    }\n\n    if (originalEvent && isMouseEvent(originalEvent) && originalEvent.pageX === undefined && originalEvent.clientX !== undefined) {\n      var eventDoc = event.target.ownerDocument || document;\n      var doc = eventDoc.documentElement;\n      var body = eventDoc.body;\n      event.pageX = originalEvent.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);\n      event.pageY = originalEvent.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0);\n    }\n\n    event.preventDefault = function () {\n      event.defaultPrevented = true;\n      event.isDefaultPrevented = returnTrue;\n\n      if (originalEvent) {\n        if (originalEvent.preventDefault) {\n          originalEvent.preventDefault();\n        } else {\n          originalEvent.returnValue = false;\n        }\n      }\n    };\n\n    event.stopPropagation = function () {\n      event.cancelBubble = true;\n      event.isPropagationStopped = returnTrue;\n\n      if (originalEvent) {\n        if (originalEvent.stopPropagation) {\n          originalEvent.stopPropagation();\n        } else {\n          originalEvent.cancelBubble = true;\n        }\n      }\n    };\n\n    event.stopImmediatePropagation = function () {\n      event.isImmediatePropagationStopped = returnTrue;\n      event.stopPropagation();\n    };\n\n    if (hasIsDefaultPrevented(event) === false) {\n      event.isDefaultPrevented = event.defaultPrevented === true ? returnTrue : returnFalse;\n      event.isPropagationStopped = event.cancelBubble === true ? returnTrue : returnFalse;\n      event.isImmediatePropagationStopped = returnFalse;\n    }\n\n    if (typeof event.metaKey === 'undefined') {\n      event.metaKey = false;\n    }\n\n    return event;\n  };\n\n  var bindOnReady = function (win, callback, eventUtils) {\n    var doc = win.document,\n        event = {\n      type: 'ready'\n    };\n\n    if (eventUtils.domLoaded) {\n      callback(event);\n      return;\n    }\n\n    var isDocReady = function () {\n      return doc.readyState === 'complete' || doc.readyState === 'interactive' && doc.body;\n    };\n\n    var readyHandler = function () {\n      removeEvent(win, 'DOMContentLoaded', readyHandler);\n      removeEvent(win, 'load', readyHandler);\n\n      if (!eventUtils.domLoaded) {\n        eventUtils.domLoaded = true;\n        callback(event);\n      }\n\n      win = null;\n    };\n\n    if (isDocReady()) {\n      readyHandler();\n    } else {\n      addEvent(win, 'DOMContentLoaded', readyHandler);\n    }\n\n    if (!eventUtils.domLoaded) {\n      addEvent(win, 'load', readyHandler);\n    }\n  };\n\n  var EventUtils = function () {\n    function EventUtils() {\n      this.domLoaded = false;\n      this.events = {};\n      this.count = 1;\n      this.expando = eventExpandoPrefix + (+new Date()).toString(32);\n      this.hasMouseEnterLeave = 'onmouseenter' in document.documentElement;\n      this.hasFocusIn = 'onfocusin' in document.documentElement;\n      this.count = 1;\n    }\n\n    EventUtils.prototype.bind = function (target, names, callback, scope) {\n      var self = this;\n      var id, callbackList, i, name, fakeName, nativeHandler, capture;\n      var win = window;\n\n      var defaultNativeHandler = function (evt) {\n        self.executeHandlers(fix(evt || win.event), id);\n      };\n\n      if (!target || target.nodeType === 3 || target.nodeType === 8) {\n        return;\n      }\n\n      if (!target[self.expando]) {\n        id = self.count++;\n        target[self.expando] = id;\n        self.events[id] = {};\n      } else {\n        id = target[self.expando];\n      }\n\n      scope = scope || target;\n      var namesList = names.split(' ');\n      i = namesList.length;\n\n      while (i--) {\n        name = namesList[i];\n        nativeHandler = defaultNativeHandler;\n        fakeName = capture = false;\n\n        if (name === 'DOMContentLoaded') {\n          name = 'ready';\n        }\n\n        if (self.domLoaded && name === 'ready' && target.readyState === 'complete') {\n          callback.call(scope, fix({\n            type: name\n          }));\n          continue;\n        }\n\n        if (!self.hasMouseEnterLeave) {\n          fakeName = self.mouseEnterLeave[name];\n\n          if (fakeName) {\n            nativeHandler = function (evt) {\n              var current = evt.currentTarget;\n              var related = evt.relatedTarget;\n\n              if (related && current.contains) {\n                related = current.contains(related);\n              } else {\n                while (related && related !== current) {\n                  related = related.parentNode;\n                }\n              }\n\n              if (!related) {\n                evt = fix(evt || win.event);\n                evt.type = evt.type === 'mouseout' ? 'mouseleave' : 'mouseenter';\n                evt.target = current;\n                self.executeHandlers(evt, id);\n              }\n            };\n          }\n        }\n\n        if (!self.hasFocusIn && (name === 'focusin' || name === 'focusout')) {\n          capture = true;\n          fakeName = name === 'focusin' ? 'focus' : 'blur';\n\n          nativeHandler = function (evt) {\n            evt = fix(evt || win.event);\n            evt.type = evt.type === 'focus' ? 'focusin' : 'focusout';\n            self.executeHandlers(evt, id);\n          };\n        }\n\n        callbackList = self.events[id][name];\n\n        if (!callbackList) {\n          self.events[id][name] = callbackList = [{\n            func: callback,\n            scope: scope\n          }];\n          callbackList.fakeName = fakeName;\n          callbackList.capture = capture;\n          callbackList.nativeHandler = nativeHandler;\n\n          if (name === 'ready') {\n            bindOnReady(target, nativeHandler, self);\n          } else {\n            addEvent(target, fakeName || name, nativeHandler, capture);\n          }\n        } else {\n          if (name === 'ready' && self.domLoaded) {\n            callback(fix({\n              type: name\n            }));\n          } else {\n            callbackList.push({\n              func: callback,\n              scope: scope\n            });\n          }\n        }\n      }\n\n      target = callbackList = null;\n      return callback;\n    };\n\n    EventUtils.prototype.unbind = function (target, names, callback) {\n      var callbackList, i, ci, name, eventMap;\n\n      if (!target || target.nodeType === 3 || target.nodeType === 8) {\n        return this;\n      }\n\n      var id = target[this.expando];\n\n      if (id) {\n        eventMap = this.events[id];\n\n        if (names) {\n          var namesList = names.split(' ');\n          i = namesList.length;\n\n          while (i--) {\n            name = namesList[i];\n            callbackList = eventMap[name];\n\n            if (callbackList) {\n              if (callback) {\n                ci = callbackList.length;\n\n                while (ci--) {\n                  if (callbackList[ci].func === callback) {\n                    var nativeHandler = callbackList.nativeHandler;\n                    var fakeName = callbackList.fakeName,\n                        capture = callbackList.capture;\n                    callbackList = callbackList.slice(0, ci).concat(callbackList.slice(ci + 1));\n                    callbackList.nativeHandler = nativeHandler;\n                    callbackList.fakeName = fakeName;\n                    callbackList.capture = capture;\n                    eventMap[name] = callbackList;\n                  }\n                }\n              }\n\n              if (!callback || callbackList.length === 0) {\n                delete eventMap[name];\n                removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n              }\n            }\n          }\n        } else {\n          each$1(eventMap, function (callbackList, name) {\n            removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n          });\n          eventMap = {};\n        }\n\n        for (name in eventMap) {\n          if (has(eventMap, name)) {\n            return this;\n          }\n        }\n\n        delete this.events[id];\n\n        try {\n          delete target[this.expando];\n        } catch (ex) {\n          target[this.expando] = null;\n        }\n      }\n\n      return this;\n    };\n\n    EventUtils.prototype.fire = function (target, name, args) {\n      var id;\n\n      if (!target || target.nodeType === 3 || target.nodeType === 8) {\n        return this;\n      }\n\n      var event = fix(null, args);\n      event.type = name;\n      event.target = target;\n\n      do {\n        id = target[this.expando];\n\n        if (id) {\n          this.executeHandlers(event, id);\n        }\n\n        target = target.parentNode || target.ownerDocument || target.defaultView || target.parentWindow;\n      } while (target && !event.isPropagationStopped());\n\n      return this;\n    };\n\n    EventUtils.prototype.clean = function (target) {\n      var i, children;\n\n      if (!target || target.nodeType === 3 || target.nodeType === 8) {\n        return this;\n      }\n\n      if (target[this.expando]) {\n        this.unbind(target);\n      }\n\n      if (!target.getElementsByTagName) {\n        target = target.document;\n      }\n\n      if (target && target.getElementsByTagName) {\n        this.unbind(target);\n        children = target.getElementsByTagName('*');\n        i = children.length;\n\n        while (i--) {\n          target = children[i];\n\n          if (target[this.expando]) {\n            this.unbind(target);\n          }\n        }\n      }\n\n      return this;\n    };\n\n    EventUtils.prototype.destroy = function () {\n      this.events = {};\n    };\n\n    EventUtils.prototype.cancel = function (e) {\n      if (e) {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n      }\n\n      return false;\n    };\n\n    EventUtils.prototype.executeHandlers = function (evt, id) {\n      var container = this.events[id];\n      var callbackList = container && container[evt.type];\n\n      if (callbackList) {\n        for (var i = 0, l = callbackList.length; i < l; i++) {\n          var callback = callbackList[i];\n\n          if (callback && callback.func.call(callback.scope, evt) === false) {\n            evt.preventDefault();\n          }\n\n          if (evt.isImmediatePropagationStopped()) {\n            return;\n          }\n        }\n      }\n    };\n\n    EventUtils.Event = new EventUtils();\n    return EventUtils;\n  }();\n\n  var support,\n      Expr,\n      getText,\n      isXML,\n      tokenize,\n      compile,\n      select,\n      outermostContext,\n      sortInput,\n      hasDuplicate,\n      setDocument,\n      document$1,\n      docElem,\n      documentIsHTML,\n      rbuggyQSA,\n      rbuggyMatches,\n      matches,\n      contains$3,\n      expando = 'sizzle' + -new Date(),\n      preferredDoc = window.document,\n      dirruns = 0,\n      done = 0,\n      classCache = createCache(),\n      tokenCache = createCache(),\n      compilerCache = createCache(),\n      sortOrder = function (a, b) {\n    if (a === b) {\n      hasDuplicate = true;\n    }\n\n    return 0;\n  },\n      strundefined = typeof undefined,\n      MAX_NEGATIVE = 1 << 31,\n      hasOwn = {}.hasOwnProperty,\n      arr = [],\n      pop = arr.pop,\n      push_native = arr.push,\n      push = arr.push,\n      slice = arr.slice,\n      indexOf$2 = arr.indexOf || function (elem) {\n    var i = 0,\n        len = this.length;\n\n    for (; i < len; i++) {\n      if (this[i] === elem) {\n        return i;\n      }\n    }\n\n    return -1;\n  },\n      booleans = 'checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped',\n      whitespace = '[\\\\x20\\\\t\\\\r\\\\n\\\\f]',\n      identifier = '(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+',\n      attributes = '\\\\[' + whitespace + '*(' + identifier + ')(?:' + whitespace + '*([*^$|!~]?=)' + whitespace + '*(?:\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\"|(' + identifier + '))|)' + whitespace + '*\\\\]',\n      pseudos = ':(' + identifier + ')(?:\\\\((' + '(\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\")|' + '((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|' + attributes + ')*)|' + '.*' + ')\\\\)|)',\n      rtrim = new RegExp('^' + whitespace + '+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)' + whitespace + '+$', 'g'),\n      rcomma = new RegExp('^' + whitespace + '*,' + whitespace + '*'),\n      rcombinators = new RegExp('^' + whitespace + '*([>+~]|' + whitespace + ')' + whitespace + '*'),\n      rattributeQuotes = new RegExp('=' + whitespace + '*([^\\\\]\\'\"]*?)' + whitespace + '*\\\\]', 'g'),\n      rpseudo = new RegExp(pseudos),\n      ridentifier = new RegExp('^' + identifier + '$'),\n      matchExpr = {\n    ID: new RegExp('^#(' + identifier + ')'),\n    CLASS: new RegExp('^\\\\.(' + identifier + ')'),\n    TAG: new RegExp('^(' + identifier + '|[*])'),\n    ATTR: new RegExp('^' + attributes),\n    PSEUDO: new RegExp('^' + pseudos),\n    CHILD: new RegExp('^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(' + whitespace + '*(even|odd|(([+-]|)(\\\\d*)n|)' + whitespace + '*(?:([+-]|)' + whitespace + '*(\\\\d+)|))' + whitespace + '*\\\\)|)', 'i'),\n    bool: new RegExp('^(?:' + booleans + ')$', 'i'),\n    needsContext: new RegExp('^' + whitespace + '*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(' + whitespace + '*((?:-\\\\d)?\\\\d*)' + whitespace + '*\\\\)|)(?=[^-]|$)', 'i')\n  },\n      rinputs = /^(?:input|select|textarea|button)$/i,\n      rheader = /^h\\d$/i,\n      rnative = /^[^{]+\\{\\s*\\[native \\w/,\n      rquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,\n      rsibling = /[+~]/,\n      rescape = /'|\\\\/g,\n      runescape = new RegExp('\\\\\\\\([\\\\da-f]{1,6}' + whitespace + '?|(' + whitespace + ')|.)', 'ig'),\n      funescape = function (_, escaped, escapedWhitespace) {\n    var high = '0x' + escaped - 65536;\n    return high !== high || escapedWhitespace ? escaped : high < 0 ? String.fromCharCode(high + 65536) : String.fromCharCode(high >> 10 | 55296, high & 1023 | 56320);\n  };\n\n  try {\n    push.apply(arr = slice.call(preferredDoc.childNodes), preferredDoc.childNodes);\n    arr[preferredDoc.childNodes.length].nodeType;\n  } catch (e) {\n    push = {\n      apply: arr.length ? function (target, els) {\n        push_native.apply(target, slice.call(els));\n      } : function (target, els) {\n        var j = target.length,\n            i = 0;\n\n        while (target[j++] = els[i++]) {}\n\n        target.length = j - 1;\n      }\n    };\n  }\n\n  var Sizzle = function (selector, context, results, seed) {\n    var match, elem, m, nodeType, i, groups, old, nid, newContext, newSelector;\n\n    if ((context ? context.ownerDocument || context : preferredDoc) !== document$1) {\n      setDocument(context);\n    }\n\n    context = context || document$1;\n    results = results || [];\n\n    if (!selector || typeof selector !== 'string') {\n      return results;\n    }\n\n    if ((nodeType = context.nodeType) !== 1 && nodeType !== 9) {\n      return [];\n    }\n\n    if (documentIsHTML && !seed) {\n      if (match = rquickExpr.exec(selector)) {\n        if (m = match[1]) {\n          if (nodeType === 9) {\n            elem = context.getElementById(m);\n\n            if (elem && elem.parentNode) {\n              if (elem.id === m) {\n                results.push(elem);\n                return results;\n              }\n            } else {\n              return results;\n            }\n          } else {\n            if (context.ownerDocument && (elem = context.ownerDocument.getElementById(m)) && contains$3(context, elem) && elem.id === m) {\n              results.push(elem);\n              return results;\n            }\n          }\n        } else if (match[2]) {\n          push.apply(results, context.getElementsByTagName(selector));\n          return results;\n        } else if ((m = match[3]) && support.getElementsByClassName) {\n          push.apply(results, context.getElementsByClassName(m));\n          return results;\n        }\n      }\n\n      if (support.qsa && (!rbuggyQSA || !rbuggyQSA.test(selector))) {\n        nid = old = expando;\n        newContext = context;\n        newSelector = nodeType === 9 && selector;\n\n        if (nodeType === 1 && context.nodeName.toLowerCase() !== 'object') {\n          groups = tokenize(selector);\n\n          if (old = context.getAttribute('id')) {\n            nid = old.replace(rescape, '\\\\$&');\n          } else {\n            context.setAttribute('id', nid);\n          }\n\n          nid = '[id=\\'' + nid + '\\'] ';\n          i = groups.length;\n\n          while (i--) {\n            groups[i] = nid + toSelector(groups[i]);\n          }\n\n          newContext = rsibling.test(selector) && testContext(context.parentNode) || context;\n          newSelector = groups.join(',');\n        }\n\n        if (newSelector) {\n          try {\n            push.apply(results, newContext.querySelectorAll(newSelector));\n            return results;\n          } catch (qsaError) {} finally {\n            if (!old) {\n              context.removeAttribute('id');\n            }\n          }\n        }\n      }\n    }\n\n    return select(selector.replace(rtrim, '$1'), context, results, seed);\n  };\n\n  function createCache() {\n    var keys = [];\n\n    function cache(key, value) {\n      if (keys.push(key + ' ') > Expr.cacheLength) {\n        delete cache[keys.shift()];\n      }\n\n      return cache[key + ' '] = value;\n    }\n\n    return cache;\n  }\n\n  function markFunction(fn) {\n    fn[expando] = true;\n    return fn;\n  }\n\n  function siblingCheck(a, b) {\n    var cur = b && a,\n        diff = cur && a.nodeType === 1 && b.nodeType === 1 && (~b.sourceIndex || MAX_NEGATIVE) - (~a.sourceIndex || MAX_NEGATIVE);\n\n    if (diff) {\n      return diff;\n    }\n\n    if (cur) {\n      while (cur = cur.nextSibling) {\n        if (cur === b) {\n          return -1;\n        }\n      }\n    }\n\n    return a ? 1 : -1;\n  }\n\n  function createInputPseudo(type) {\n    return function (elem) {\n      var name = elem.nodeName.toLowerCase();\n      return name === 'input' && elem.type === type;\n    };\n  }\n\n  function createButtonPseudo(type) {\n    return function (elem) {\n      var name = elem.nodeName.toLowerCase();\n      return (name === 'input' || name === 'button') && elem.type === type;\n    };\n  }\n\n  function createPositionalPseudo(fn) {\n    return markFunction(function (argument) {\n      argument = +argument;\n      return markFunction(function (seed, matches) {\n        var j,\n            matchIndexes = fn([], seed.length, argument),\n            i = matchIndexes.length;\n\n        while (i--) {\n          if (seed[j = matchIndexes[i]]) {\n            seed[j] = !(matches[j] = seed[j]);\n          }\n        }\n      });\n    });\n  }\n\n  function testContext(context) {\n    return context && typeof context.getElementsByTagName !== strundefined && context;\n  }\n\n  support = Sizzle.support = {};\n\n  isXML = Sizzle.isXML = function (elem) {\n    var documentElement = elem && (elem.ownerDocument || elem).documentElement;\n    return documentElement ? documentElement.nodeName !== 'HTML' : false;\n  };\n\n  setDocument = Sizzle.setDocument = function (node) {\n    var hasCompare,\n        doc = node ? node.ownerDocument || node : preferredDoc,\n        parent = doc.defaultView;\n\n    function getTop(win) {\n      try {\n        return win.top;\n      } catch (ex) {}\n\n      return null;\n    }\n\n    if (doc === document$1 || doc.nodeType !== 9 || !doc.documentElement) {\n      return document$1;\n    }\n\n    document$1 = doc;\n    docElem = doc.documentElement;\n    documentIsHTML = !isXML(doc);\n\n    if (parent && parent !== getTop(parent)) {\n      if (parent.addEventListener) {\n        parent.addEventListener('unload', function () {\n          setDocument();\n        }, false);\n      } else if (parent.attachEvent) {\n        parent.attachEvent('onunload', function () {\n          setDocument();\n        });\n      }\n    }\n\n    support.attributes = true;\n    support.getElementsByTagName = true;\n    support.getElementsByClassName = rnative.test(doc.getElementsByClassName);\n    support.getById = true;\n\n    Expr.find.ID = function (id, context) {\n      if (typeof context.getElementById !== strundefined && documentIsHTML) {\n        var m = context.getElementById(id);\n        return m && m.parentNode ? [m] : [];\n      }\n    };\n\n    Expr.filter.ID = function (id) {\n      var attrId = id.replace(runescape, funescape);\n      return function (elem) {\n        return elem.getAttribute('id') === attrId;\n      };\n    };\n\n    Expr.find.TAG = support.getElementsByTagName ? function (tag, context) {\n      if (typeof context.getElementsByTagName !== strundefined) {\n        return context.getElementsByTagName(tag);\n      }\n    } : function (tag, context) {\n      var elem,\n          tmp = [],\n          i = 0,\n          results = context.getElementsByTagName(tag);\n\n      if (tag === '*') {\n        while (elem = results[i++]) {\n          if (elem.nodeType === 1) {\n            tmp.push(elem);\n          }\n        }\n\n        return tmp;\n      }\n\n      return results;\n    };\n\n    Expr.find.CLASS = support.getElementsByClassName && function (className, context) {\n      if (documentIsHTML) {\n        return context.getElementsByClassName(className);\n      }\n    };\n\n    rbuggyMatches = [];\n    rbuggyQSA = [];\n    support.disconnectedMatch = true;\n    rbuggyQSA = rbuggyQSA.length && new RegExp(rbuggyQSA.join('|'));\n    rbuggyMatches = rbuggyMatches.length && new RegExp(rbuggyMatches.join('|'));\n    hasCompare = rnative.test(docElem.compareDocumentPosition);\n    contains$3 = hasCompare || rnative.test(docElem.contains) ? function (a, b) {\n      var adown = a.nodeType === 9 ? a.documentElement : a,\n          bup = b && b.parentNode;\n      return a === bup || !!(bup && bup.nodeType === 1 && (adown.contains ? adown.contains(bup) : a.compareDocumentPosition && a.compareDocumentPosition(bup) & 16));\n    } : function (a, b) {\n      if (b) {\n        while (b = b.parentNode) {\n          if (b === a) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    };\n    sortOrder = hasCompare ? function (a, b) {\n      if (a === b) {\n        hasDuplicate = true;\n        return 0;\n      }\n\n      var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n\n      if (compare) {\n        return compare;\n      }\n\n      compare = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1;\n\n      if (compare & 1 || !support.sortDetached && b.compareDocumentPosition(a) === compare) {\n        if (a === doc || a.ownerDocument === preferredDoc && contains$3(preferredDoc, a)) {\n          return -1;\n        }\n\n        if (b === doc || b.ownerDocument === preferredDoc && contains$3(preferredDoc, b)) {\n          return 1;\n        }\n\n        return sortInput ? indexOf$2.call(sortInput, a) - indexOf$2.call(sortInput, b) : 0;\n      }\n\n      return compare & 4 ? -1 : 1;\n    } : function (a, b) {\n      if (a === b) {\n        hasDuplicate = true;\n        return 0;\n      }\n\n      var cur,\n          i = 0,\n          aup = a.parentNode,\n          bup = b.parentNode,\n          ap = [a],\n          bp = [b];\n\n      if (!aup || !bup) {\n        return a === doc ? -1 : b === doc ? 1 : aup ? -1 : bup ? 1 : sortInput ? indexOf$2.call(sortInput, a) - indexOf$2.call(sortInput, b) : 0;\n      } else if (aup === bup) {\n        return siblingCheck(a, b);\n      }\n\n      cur = a;\n\n      while (cur = cur.parentNode) {\n        ap.unshift(cur);\n      }\n\n      cur = b;\n\n      while (cur = cur.parentNode) {\n        bp.unshift(cur);\n      }\n\n      while (ap[i] === bp[i]) {\n        i++;\n      }\n\n      return i ? siblingCheck(ap[i], bp[i]) : ap[i] === preferredDoc ? -1 : bp[i] === preferredDoc ? 1 : 0;\n    };\n    return doc;\n  };\n\n  Sizzle.matches = function (expr, elements) {\n    return Sizzle(expr, null, null, elements);\n  };\n\n  Sizzle.matchesSelector = function (elem, expr) {\n    if ((elem.ownerDocument || elem) !== document$1) {\n      setDocument(elem);\n    }\n\n    expr = expr.replace(rattributeQuotes, '=\\'$1\\']');\n\n    if (support.matchesSelector && documentIsHTML && (!rbuggyMatches || !rbuggyMatches.test(expr)) && (!rbuggyQSA || !rbuggyQSA.test(expr))) {\n      try {\n        var ret = matches.call(elem, expr);\n\n        if (ret || support.disconnectedMatch || elem.document && elem.document.nodeType !== 11) {\n          return ret;\n        }\n      } catch (e) {}\n    }\n\n    return Sizzle(expr, document$1, null, [elem]).length > 0;\n  };\n\n  Sizzle.contains = function (context, elem) {\n    if ((context.ownerDocument || context) !== document$1) {\n      setDocument(context);\n    }\n\n    return contains$3(context, elem);\n  };\n\n  Sizzle.attr = function (elem, name) {\n    if ((elem.ownerDocument || elem) !== document$1) {\n      setDocument(elem);\n    }\n\n    var fn = Expr.attrHandle[name.toLowerCase()],\n        val = fn && hasOwn.call(Expr.attrHandle, name.toLowerCase()) ? fn(elem, name, !documentIsHTML) : undefined;\n    return val !== undefined ? val : support.attributes || !documentIsHTML ? elem.getAttribute(name) : (val = elem.getAttributeNode(name)) && val.specified ? val.value : null;\n  };\n\n  Sizzle.error = function (msg) {\n    throw new Error('Syntax error, unrecognized expression: ' + msg);\n  };\n\n  Sizzle.uniqueSort = function (results) {\n    var elem,\n        duplicates = [],\n        j = 0,\n        i = 0;\n    hasDuplicate = !support.detectDuplicates;\n    sortInput = !support.sortStable && results.slice(0);\n    results.sort(sortOrder);\n\n    if (hasDuplicate) {\n      while (elem = results[i++]) {\n        if (elem === results[i]) {\n          j = duplicates.push(i);\n        }\n      }\n\n      while (j--) {\n        results.splice(duplicates[j], 1);\n      }\n    }\n\n    sortInput = null;\n    return results;\n  };\n\n  getText = Sizzle.getText = function (elem) {\n    var node,\n        ret = '',\n        i = 0,\n        nodeType = elem.nodeType;\n\n    if (!nodeType) {\n      while (node = elem[i++]) {\n        ret += getText(node);\n      }\n    } else if (nodeType === 1 || nodeType === 9 || nodeType === 11) {\n      if (typeof elem.textContent === 'string') {\n        return elem.textContent;\n      } else {\n        for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n          ret += getText(elem);\n        }\n      }\n    } else if (nodeType === 3 || nodeType === 4) {\n      return elem.nodeValue;\n    }\n\n    return ret;\n  };\n\n  Expr = Sizzle.selectors = {\n    cacheLength: 50,\n    createPseudo: markFunction,\n    match: matchExpr,\n    attrHandle: {},\n    find: {},\n    relative: {\n      '>': {\n        dir: 'parentNode',\n        first: true\n      },\n      ' ': {\n        dir: 'parentNode'\n      },\n      '+': {\n        dir: 'previousSibling',\n        first: true\n      },\n      '~': {\n        dir: 'previousSibling'\n      }\n    },\n    preFilter: {\n      ATTR: function (match) {\n        match[1] = match[1].replace(runescape, funescape);\n        match[3] = (match[3] || match[4] || match[5] || '').replace(runescape, funescape);\n\n        if (match[2] === '~=') {\n          match[3] = ' ' + match[3] + ' ';\n        }\n\n        return match.slice(0, 4);\n      },\n      CHILD: function (match) {\n        match[1] = match[1].toLowerCase();\n\n        if (match[1].slice(0, 3) === 'nth') {\n          if (!match[3]) {\n            Sizzle.error(match[0]);\n          }\n\n          match[4] = +(match[4] ? match[5] + (match[6] || 1) : 2 * (match[3] === 'even' || match[3] === 'odd'));\n          match[5] = +(match[7] + match[8] || match[3] === 'odd');\n        } else if (match[3]) {\n          Sizzle.error(match[0]);\n        }\n\n        return match;\n      },\n      PSEUDO: function (match) {\n        var excess,\n            unquoted = !match[6] && match[2];\n\n        if (matchExpr.CHILD.test(match[0])) {\n          return null;\n        }\n\n        if (match[3]) {\n          match[2] = match[4] || match[5] || '';\n        } else if (unquoted && rpseudo.test(unquoted) && (excess = tokenize(unquoted, true)) && (excess = unquoted.indexOf(')', unquoted.length - excess) - unquoted.length)) {\n          match[0] = match[0].slice(0, excess);\n          match[2] = unquoted.slice(0, excess);\n        }\n\n        return match.slice(0, 3);\n      }\n    },\n    filter: {\n      TAG: function (nodeNameSelector) {\n        var nodeName = nodeNameSelector.replace(runescape, funescape).toLowerCase();\n        return nodeNameSelector === '*' ? function () {\n          return true;\n        } : function (elem) {\n          return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n        };\n      },\n      CLASS: function (className) {\n        var pattern = classCache[className + ' '];\n        return pattern || (pattern = new RegExp('(^|' + whitespace + ')' + className + '(' + whitespace + '|$)')) && classCache(className, function (elem) {\n          return pattern.test(typeof elem.className === 'string' && elem.className || typeof elem.getAttribute !== strundefined && elem.getAttribute('class') || '');\n        });\n      },\n      ATTR: function (name, operator, check) {\n        return function (elem) {\n          var result = Sizzle.attr(elem, name);\n\n          if (result == null) {\n            return operator === '!=';\n          }\n\n          if (!operator) {\n            return true;\n          }\n\n          result += '';\n          return operator === '=' ? result === check : operator === '!=' ? result !== check : operator === '^=' ? check && result.indexOf(check) === 0 : operator === '*=' ? check && result.indexOf(check) > -1 : operator === '$=' ? check && result.slice(-check.length) === check : operator === '~=' ? (' ' + result + ' ').indexOf(check) > -1 : operator === '|=' ? result === check || result.slice(0, check.length + 1) === check + '-' : false;\n        };\n      },\n      CHILD: function (type, what, argument, first, last) {\n        var simple = type.slice(0, 3) !== 'nth',\n            forward = type.slice(-4) !== 'last',\n            ofType = what === 'of-type';\n        return first === 1 && last === 0 ? function (elem) {\n          return !!elem.parentNode;\n        } : function (elem, context, xml) {\n          var cache,\n              outerCache,\n              node,\n              diff,\n              nodeIndex,\n              start,\n              dir = simple !== forward ? 'nextSibling' : 'previousSibling',\n              parent = elem.parentNode,\n              name = ofType && elem.nodeName.toLowerCase(),\n              useCache = !xml && !ofType;\n\n          if (parent) {\n            if (simple) {\n              while (dir) {\n                node = elem;\n\n                while (node = node[dir]) {\n                  if (ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) {\n                    return false;\n                  }\n                }\n\n                start = dir = type === 'only' && !start && 'nextSibling';\n              }\n\n              return true;\n            }\n\n            start = [forward ? parent.firstChild : parent.lastChild];\n\n            if (forward && useCache) {\n              outerCache = parent[expando] || (parent[expando] = {});\n              cache = outerCache[type] || [];\n              nodeIndex = cache[0] === dirruns && cache[1];\n              diff = cache[0] === dirruns && cache[2];\n              node = nodeIndex && parent.childNodes[nodeIndex];\n\n              while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                if (node.nodeType === 1 && ++diff && node === elem) {\n                  outerCache[type] = [dirruns, nodeIndex, diff];\n                  break;\n                }\n              }\n            } else if (useCache && (cache = (elem[expando] || (elem[expando] = {}))[type]) && cache[0] === dirruns) {\n              diff = cache[1];\n            } else {\n              while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                if ((ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) && ++diff) {\n                  if (useCache) {\n                    (node[expando] || (node[expando] = {}))[type] = [dirruns, diff];\n                  }\n\n                  if (node === elem) {\n                    break;\n                  }\n                }\n              }\n            }\n\n            diff -= last;\n            return diff === first || diff % first === 0 && diff / first >= 0;\n          }\n        };\n      },\n      PSEUDO: function (pseudo, argument) {\n        var args,\n            fn = Expr.pseudos[pseudo] || Expr.setFilters[pseudo.toLowerCase()] || Sizzle.error('unsupported pseudo: ' + pseudo);\n\n        if (fn[expando]) {\n          return fn(argument);\n        }\n\n        if (fn.length > 1) {\n          args = [pseudo, pseudo, '', argument];\n          return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase()) ? markFunction(function (seed, matches) {\n            var idx,\n                matched = fn(seed, argument),\n                i = matched.length;\n\n            while (i--) {\n              idx = indexOf$2.call(seed, matched[i]);\n              seed[idx] = !(matches[idx] = matched[i]);\n            }\n          }) : function (elem) {\n            return fn(elem, 0, args);\n          };\n        }\n\n        return fn;\n      }\n    },\n    pseudos: {\n      not: markFunction(function (selector) {\n        var input = [],\n            results = [],\n            matcher = compile(selector.replace(rtrim, '$1'));\n        return matcher[expando] ? markFunction(function (seed, matches, context, xml) {\n          var elem,\n              unmatched = matcher(seed, null, xml, []),\n              i = seed.length;\n\n          while (i--) {\n            if (elem = unmatched[i]) {\n              seed[i] = !(matches[i] = elem);\n            }\n          }\n        }) : function (elem, context, xml) {\n          input[0] = elem;\n          matcher(input, null, xml, results);\n          input[0] = null;\n          return !results.pop();\n        };\n      }),\n      has: markFunction(function (selector) {\n        return function (elem) {\n          return Sizzle(selector, elem).length > 0;\n        };\n      }),\n      contains: markFunction(function (text) {\n        text = text.replace(runescape, funescape);\n        return function (elem) {\n          return (elem.textContent || elem.innerText || getText(elem)).indexOf(text) > -1;\n        };\n      }),\n      lang: markFunction(function (lang) {\n        if (!ridentifier.test(lang || '')) {\n          Sizzle.error('unsupported lang: ' + lang);\n        }\n\n        lang = lang.replace(runescape, funescape).toLowerCase();\n        return function (elem) {\n          var elemLang;\n\n          do {\n            if (elemLang = documentIsHTML ? elem.lang : elem.getAttribute('xml:lang') || elem.getAttribute('lang')) {\n              elemLang = elemLang.toLowerCase();\n              return elemLang === lang || elemLang.indexOf(lang + '-') === 0;\n            }\n          } while ((elem = elem.parentNode) && elem.nodeType === 1);\n\n          return false;\n        };\n      }),\n      target: function (elem) {\n        var hash = window.location && window.location.hash;\n        return hash && hash.slice(1) === elem.id;\n      },\n      root: function (elem) {\n        return elem === docElem;\n      },\n      focus: function (elem) {\n        return elem === document$1.activeElement && (!document$1.hasFocus || document$1.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n      },\n      enabled: function (elem) {\n        return elem.disabled === false;\n      },\n      disabled: function (elem) {\n        return elem.disabled === true;\n      },\n      checked: function (elem) {\n        var nodeName = elem.nodeName.toLowerCase();\n        return nodeName === 'input' && !!elem.checked || nodeName === 'option' && !!elem.selected;\n      },\n      selected: function (elem) {\n        if (elem.parentNode) {\n          elem.parentNode.selectedIndex;\n        }\n\n        return elem.selected === true;\n      },\n      empty: function (elem) {\n        for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n          if (elem.nodeType < 6) {\n            return false;\n          }\n        }\n\n        return true;\n      },\n      parent: function (elem) {\n        return !Expr.pseudos.empty(elem);\n      },\n      header: function (elem) {\n        return rheader.test(elem.nodeName);\n      },\n      input: function (elem) {\n        return rinputs.test(elem.nodeName);\n      },\n      button: function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return name === 'input' && elem.type === 'button' || name === 'button';\n      },\n      text: function (elem) {\n        var attr;\n        return elem.nodeName.toLowerCase() === 'input' && elem.type === 'text' && ((attr = elem.getAttribute('type')) == null || attr.toLowerCase() === 'text');\n      },\n      first: createPositionalPseudo(function () {\n        return [0];\n      }),\n      last: createPositionalPseudo(function (matchIndexes, length) {\n        return [length - 1];\n      }),\n      eq: createPositionalPseudo(function (matchIndexes, length, argument) {\n        return [argument < 0 ? argument + length : argument];\n      }),\n      even: createPositionalPseudo(function (matchIndexes, length) {\n        var i = 0;\n\n        for (; i < length; i += 2) {\n          matchIndexes.push(i);\n        }\n\n        return matchIndexes;\n      }),\n      odd: createPositionalPseudo(function (matchIndexes, length) {\n        var i = 1;\n\n        for (; i < length; i += 2) {\n          matchIndexes.push(i);\n        }\n\n        return matchIndexes;\n      }),\n      lt: createPositionalPseudo(function (matchIndexes, length, argument) {\n        var i = argument < 0 ? argument + length : argument;\n\n        for (; --i >= 0;) {\n          matchIndexes.push(i);\n        }\n\n        return matchIndexes;\n      }),\n      gt: createPositionalPseudo(function (matchIndexes, length, argument) {\n        var i = argument < 0 ? argument + length : argument;\n\n        for (; ++i < length;) {\n          matchIndexes.push(i);\n        }\n\n        return matchIndexes;\n      })\n    }\n  };\n  Expr.pseudos.nth = Expr.pseudos.eq;\n  each(['radio', 'checkbox', 'file', 'password', 'image'], function (i) {\n    Expr.pseudos[i] = createInputPseudo(i);\n  });\n  each(['submit', 'reset'], function (i) {\n    Expr.pseudos[i] = createButtonPseudo(i);\n  });\n\n  function setFilters() {}\n\n  setFilters.prototype = Expr.filters = Expr.pseudos;\n  Expr.setFilters = new setFilters();\n\n  tokenize = Sizzle.tokenize = function (selector, parseOnly) {\n    var matched,\n        match,\n        tokens,\n        type,\n        soFar,\n        groups,\n        preFilters,\n        cached = tokenCache[selector + ' '];\n\n    if (cached) {\n      return parseOnly ? 0 : cached.slice(0);\n    }\n\n    soFar = selector;\n    groups = [];\n    preFilters = Expr.preFilter;\n\n    while (soFar) {\n      if (!matched || (match = rcomma.exec(soFar))) {\n        if (match) {\n          soFar = soFar.slice(match[0].length) || soFar;\n        }\n\n        groups.push(tokens = []);\n      }\n\n      matched = false;\n\n      if (match = rcombinators.exec(soFar)) {\n        matched = match.shift();\n        tokens.push({\n          value: matched,\n          type: match[0].replace(rtrim, ' ')\n        });\n        soFar = soFar.slice(matched.length);\n      }\n\n      for (type in Expr.filter) {\n        if (!Expr.filter.hasOwnProperty(type)) {\n          continue;\n        }\n\n        if ((match = matchExpr[type].exec(soFar)) && (!preFilters[type] || (match = preFilters[type](match)))) {\n          matched = match.shift();\n          tokens.push({\n            value: matched,\n            type: type,\n            matches: match\n          });\n          soFar = soFar.slice(matched.length);\n        }\n      }\n\n      if (!matched) {\n        break;\n      }\n    }\n\n    return parseOnly ? soFar.length : soFar ? Sizzle.error(selector) : tokenCache(selector, groups).slice(0);\n  };\n\n  function toSelector(tokens) {\n    var i = 0,\n        len = tokens.length,\n        selector = '';\n\n    for (; i < len; i++) {\n      selector += tokens[i].value;\n    }\n\n    return selector;\n  }\n\n  function addCombinator(matcher, combinator, base) {\n    var dir = combinator.dir,\n        checkNonElements = base && dir === 'parentNode',\n        doneName = done++;\n    return combinator.first ? function (elem, context, xml) {\n      while (elem = elem[dir]) {\n        if (elem.nodeType === 1 || checkNonElements) {\n          return matcher(elem, context, xml);\n        }\n      }\n    } : function (elem, context, xml) {\n      var oldCache,\n          outerCache,\n          newCache = [dirruns, doneName];\n\n      if (xml) {\n        while (elem = elem[dir]) {\n          if (elem.nodeType === 1 || checkNonElements) {\n            if (matcher(elem, context, xml)) {\n              return true;\n            }\n          }\n        }\n      } else {\n        while (elem = elem[dir]) {\n          if (elem.nodeType === 1 || checkNonElements) {\n            outerCache = elem[expando] || (elem[expando] = {});\n\n            if ((oldCache = outerCache[dir]) && oldCache[0] === dirruns && oldCache[1] === doneName) {\n              return newCache[2] = oldCache[2];\n            } else {\n              outerCache[dir] = newCache;\n\n              if (newCache[2] = matcher(elem, context, xml)) {\n                return true;\n              }\n            }\n          }\n        }\n      }\n    };\n  }\n\n  function elementMatcher(matchers) {\n    return matchers.length > 1 ? function (elem, context, xml) {\n      var i = matchers.length;\n\n      while (i--) {\n        if (!matchers[i](elem, context, xml)) {\n          return false;\n        }\n      }\n\n      return true;\n    } : matchers[0];\n  }\n\n  function multipleContexts(selector, contexts, results) {\n    var i = 0,\n        len = contexts.length;\n\n    for (; i < len; i++) {\n      Sizzle(selector, contexts[i], results);\n    }\n\n    return results;\n  }\n\n  function condense(unmatched, map, filter, context, xml) {\n    var elem,\n        newUnmatched = [],\n        i = 0,\n        len = unmatched.length,\n        mapped = map != null;\n\n    for (; i < len; i++) {\n      if (elem = unmatched[i]) {\n        if (!filter || filter(elem, context, xml)) {\n          newUnmatched.push(elem);\n\n          if (mapped) {\n            map.push(i);\n          }\n        }\n      }\n    }\n\n    return newUnmatched;\n  }\n\n  function setMatcher(preFilter, selector, matcher, postFilter, postFinder, postSelector) {\n    if (postFilter && !postFilter[expando]) {\n      postFilter = setMatcher(postFilter);\n    }\n\n    if (postFinder && !postFinder[expando]) {\n      postFinder = setMatcher(postFinder, postSelector);\n    }\n\n    return markFunction(function (seed, results, context, xml) {\n      var temp,\n          i,\n          elem,\n          preMap = [],\n          postMap = [],\n          preexisting = results.length,\n          elems = seed || multipleContexts(selector || '*', context.nodeType ? [context] : context, []),\n          matcherIn = preFilter && (seed || !selector) ? condense(elems, preMap, preFilter, context, xml) : elems,\n          matcherOut = matcher ? postFinder || (seed ? preFilter : preexisting || postFilter) ? [] : results : matcherIn;\n\n      if (matcher) {\n        matcher(matcherIn, matcherOut, context, xml);\n      }\n\n      if (postFilter) {\n        temp = condense(matcherOut, postMap);\n        postFilter(temp, [], context, xml);\n        i = temp.length;\n\n        while (i--) {\n          if (elem = temp[i]) {\n            matcherOut[postMap[i]] = !(matcherIn[postMap[i]] = elem);\n          }\n        }\n      }\n\n      if (seed) {\n        if (postFinder || preFilter) {\n          if (postFinder) {\n            temp = [];\n            i = matcherOut.length;\n\n            while (i--) {\n              if (elem = matcherOut[i]) {\n                temp.push(matcherIn[i] = elem);\n              }\n            }\n\n            postFinder(null, matcherOut = [], temp, xml);\n          }\n\n          i = matcherOut.length;\n\n          while (i--) {\n            if ((elem = matcherOut[i]) && (temp = postFinder ? indexOf$2.call(seed, elem) : preMap[i]) > -1) {\n              seed[temp] = !(results[temp] = elem);\n            }\n          }\n        }\n      } else {\n        matcherOut = condense(matcherOut === results ? matcherOut.splice(preexisting, matcherOut.length) : matcherOut);\n\n        if (postFinder) {\n          postFinder(null, results, matcherOut, xml);\n        } else {\n          push.apply(results, matcherOut);\n        }\n      }\n    });\n  }\n\n  function matcherFromTokens(tokens) {\n    var checkContext,\n        matcher,\n        j,\n        len = tokens.length,\n        leadingRelative = Expr.relative[tokens[0].type],\n        implicitRelative = leadingRelative || Expr.relative[' '],\n        i = leadingRelative ? 1 : 0,\n        matchContext = addCombinator(function (elem) {\n      return elem === checkContext;\n    }, implicitRelative, true),\n        matchAnyContext = addCombinator(function (elem) {\n      return indexOf$2.call(checkContext, elem) > -1;\n    }, implicitRelative, true),\n        matchers = [function (elem, context, xml) {\n      var ret = !leadingRelative && (xml || context !== outermostContext) || ((checkContext = context).nodeType ? matchContext(elem, context, xml) : matchAnyContext(elem, context, xml));\n      checkContext = null;\n      return ret;\n    }];\n\n    for (; i < len; i++) {\n      if (matcher = Expr.relative[tokens[i].type]) {\n        matchers = [addCombinator(elementMatcher(matchers), matcher)];\n      } else {\n        matcher = Expr.filter[tokens[i].type].apply(null, tokens[i].matches);\n\n        if (matcher[expando]) {\n          j = ++i;\n\n          for (; j < len; j++) {\n            if (Expr.relative[tokens[j].type]) {\n              break;\n            }\n          }\n\n          return setMatcher(i > 1 && elementMatcher(matchers), i > 1 && toSelector(tokens.slice(0, i - 1).concat({\n            value: tokens[i - 2].type === ' ' ? '*' : ''\n          })).replace(rtrim, '$1'), matcher, i < j && matcherFromTokens(tokens.slice(i, j)), j < len && matcherFromTokens(tokens = tokens.slice(j)), j < len && toSelector(tokens));\n        }\n\n        matchers.push(matcher);\n      }\n    }\n\n    return elementMatcher(matchers);\n  }\n\n  function matcherFromGroupMatchers(elementMatchers, setMatchers) {\n    var bySet = setMatchers.length > 0,\n        byElement = elementMatchers.length > 0,\n        superMatcher = function (seed, context, xml, results, outermost) {\n      var elem,\n          j,\n          matcher,\n          matchedCount = 0,\n          i = '0',\n          unmatched = seed && [],\n          setMatched = [],\n          contextBackup = outermostContext,\n          elems = seed || byElement && Expr.find.TAG('*', outermost),\n          dirrunsUnique = dirruns += contextBackup == null ? 1 : Math.random() || 0.1,\n          len = elems.length;\n\n      if (outermost) {\n        outermostContext = context !== document$1 && context;\n      }\n\n      for (; i !== len && (elem = elems[i]) != null; i++) {\n        if (byElement && elem) {\n          j = 0;\n\n          while (matcher = elementMatchers[j++]) {\n            if (matcher(elem, context, xml)) {\n              results.push(elem);\n              break;\n            }\n          }\n\n          if (outermost) {\n            dirruns = dirrunsUnique;\n          }\n        }\n\n        if (bySet) {\n          if (elem = !matcher && elem) {\n            matchedCount--;\n          }\n\n          if (seed) {\n            unmatched.push(elem);\n          }\n        }\n      }\n\n      matchedCount += i;\n\n      if (bySet && i !== matchedCount) {\n        j = 0;\n\n        while (matcher = setMatchers[j++]) {\n          matcher(unmatched, setMatched, context, xml);\n        }\n\n        if (seed) {\n          if (matchedCount > 0) {\n            while (i--) {\n              if (!(unmatched[i] || setMatched[i])) {\n                setMatched[i] = pop.call(results);\n              }\n            }\n          }\n\n          setMatched = condense(setMatched);\n        }\n\n        push.apply(results, setMatched);\n\n        if (outermost && !seed && setMatched.length > 0 && matchedCount + setMatchers.length > 1) {\n          Sizzle.uniqueSort(results);\n        }\n      }\n\n      if (outermost) {\n        dirruns = dirrunsUnique;\n        outermostContext = contextBackup;\n      }\n\n      return unmatched;\n    };\n\n    return bySet ? markFunction(superMatcher) : superMatcher;\n  }\n\n  compile = Sizzle.compile = function (selector, match) {\n    var i,\n        setMatchers = [],\n        elementMatchers = [],\n        cached = compilerCache[selector + ' '];\n\n    if (!cached) {\n      if (!match) {\n        match = tokenize(selector);\n      }\n\n      i = match.length;\n\n      while (i--) {\n        cached = matcherFromTokens(match[i]);\n\n        if (cached[expando]) {\n          setMatchers.push(cached);\n        } else {\n          elementMatchers.push(cached);\n        }\n      }\n\n      cached = compilerCache(selector, matcherFromGroupMatchers(elementMatchers, setMatchers));\n      cached.selector = selector;\n    }\n\n    return cached;\n  };\n\n  select = Sizzle.select = function (selector, context, results, seed) {\n    var i,\n        tokens,\n        token,\n        type,\n        find,\n        compiled = typeof selector === 'function' && selector,\n        match = !seed && tokenize(selector = compiled.selector || selector);\n    results = results || [];\n\n    if (match.length === 1) {\n      tokens = match[0] = match[0].slice(0);\n\n      if (tokens.length > 2 && (token = tokens[0]).type === 'ID' && support.getById && context.nodeType === 9 && documentIsHTML && Expr.relative[tokens[1].type]) {\n        context = (Expr.find.ID(token.matches[0].replace(runescape, funescape), context) || [])[0];\n\n        if (!context) {\n          return results;\n        } else if (compiled) {\n          context = context.parentNode;\n        }\n\n        selector = selector.slice(tokens.shift().value.length);\n      }\n\n      i = matchExpr.needsContext.test(selector) ? 0 : tokens.length;\n\n      while (i--) {\n        token = tokens[i];\n\n        if (Expr.relative[type = token.type]) {\n          break;\n        }\n\n        if (find = Expr.find[type]) {\n          if (seed = find(token.matches[0].replace(runescape, funescape), rsibling.test(tokens[0].type) && testContext(context.parentNode) || context)) {\n            tokens.splice(i, 1);\n            selector = seed.length && toSelector(tokens);\n\n            if (!selector) {\n              push.apply(results, seed);\n              return results;\n            }\n\n            break;\n          }\n        }\n      }\n    }\n\n    (compiled || compile(selector, match))(seed, context, !documentIsHTML, results, rsibling.test(selector) && testContext(context.parentNode) || context);\n    return results;\n  };\n\n  support.sortStable = expando.split('').sort(sortOrder).join('') === expando;\n  support.detectDuplicates = !!hasDuplicate;\n  setDocument();\n  support.sortDetached = true;\n  var doc = document;\n  var push$1 = Array.prototype.push;\n  var slice$1 = Array.prototype.slice;\n  var rquickExpr$1 = /^(?:[^#<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/;\n  var Event = EventUtils.Event;\n  var skipUniques = Tools.makeMap('children,contents,next,prev');\n\n  var isDefined = function (obj) {\n    return typeof obj !== 'undefined';\n  };\n\n  var isString$1 = function (obj) {\n    return typeof obj === 'string';\n  };\n\n  var isWindow = function (obj) {\n    return obj && obj === obj.window;\n  };\n\n  var createFragment = function (html, fragDoc) {\n    fragDoc = fragDoc || doc;\n    var container = fragDoc.createElement('div');\n    var frag = fragDoc.createDocumentFragment();\n    container.innerHTML = html;\n    var node;\n\n    while (node = container.firstChild) {\n      frag.appendChild(node);\n    }\n\n    return frag;\n  };\n\n  var domManipulate = function (targetNodes, sourceItem, callback, reverse) {\n    var i;\n\n    if (isString$1(sourceItem)) {\n      sourceItem = createFragment(sourceItem, getElementDocument(targetNodes[0]));\n    } else if (sourceItem.length && !sourceItem.nodeType) {\n      sourceItem = DomQuery.makeArray(sourceItem);\n\n      if (reverse) {\n        for (i = sourceItem.length - 1; i >= 0; i--) {\n          domManipulate(targetNodes, sourceItem[i], callback, reverse);\n        }\n      } else {\n        for (i = 0; i < sourceItem.length; i++) {\n          domManipulate(targetNodes, sourceItem[i], callback, reverse);\n        }\n      }\n\n      return targetNodes;\n    }\n\n    if (sourceItem.nodeType) {\n      i = targetNodes.length;\n\n      while (i--) {\n        callback.call(targetNodes[i], sourceItem);\n      }\n    }\n\n    return targetNodes;\n  };\n\n  var hasClass = function (node, className) {\n    return node && className && (' ' + node.className + ' ').indexOf(' ' + className + ' ') !== -1;\n  };\n\n  var wrap$1 = function (elements, wrapper, all) {\n    var lastParent, newWrapper;\n    wrapper = DomQuery(wrapper)[0];\n    elements.each(function () {\n      var self = this;\n\n      if (!all || lastParent !== self.parentNode) {\n        lastParent = self.parentNode;\n        newWrapper = wrapper.cloneNode(false);\n        self.parentNode.insertBefore(newWrapper, self);\n        newWrapper.appendChild(self);\n      } else {\n        newWrapper.appendChild(self);\n      }\n    });\n    return elements;\n  };\n\n  var numericCssMap = Tools.makeMap('fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom', ' ');\n  var booleanMap = Tools.makeMap('checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected', ' ');\n  var propFix = {\n    for: 'htmlFor',\n    class: 'className',\n    readonly: 'readOnly'\n  };\n  var cssFix = {\n    float: 'cssFloat'\n  };\n  var attrHooks = {},\n      cssHooks = {};\n\n  var DomQueryConstructor = function (selector, context) {\n    return new DomQuery.fn.init(selector, context);\n  };\n\n  var inArray$1 = function (item, array) {\n    var i;\n\n    if (array.indexOf) {\n      return array.indexOf(item);\n    }\n\n    i = array.length;\n\n    while (i--) {\n      if (array[i] === item) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n\n  var whiteSpaceRegExp$2 = /^\\s*|\\s*$/g;\n\n  var trim$3 = function (str) {\n    return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp$2, '');\n  };\n\n  var each$4 = function (obj, callback) {\n    var length, key, i, value;\n\n    if (obj) {\n      length = obj.length;\n\n      if (length === undefined) {\n        for (key in obj) {\n          if (obj.hasOwnProperty(key)) {\n            value = obj[key];\n\n            if (callback.call(value, key, value) === false) {\n              break;\n            }\n          }\n        }\n      } else {\n        for (i = 0; i < length; i++) {\n          value = obj[i];\n\n          if (callback.call(value, i, value) === false) {\n            break;\n          }\n        }\n      }\n    }\n\n    return obj;\n  };\n\n  var grep = function (array, callback) {\n    var out = [];\n    each$4(array, function (i, item) {\n      if (callback(item, i)) {\n        out.push(item);\n      }\n    });\n    return out;\n  };\n\n  var getElementDocument = function (element) {\n    if (!element) {\n      return doc;\n    }\n\n    if (element.nodeType === 9) {\n      return element;\n    }\n\n    return element.ownerDocument;\n  };\n\n  DomQueryConstructor.fn = DomQueryConstructor.prototype = {\n    constructor: DomQueryConstructor,\n    selector: '',\n    context: null,\n    length: 0,\n    init: function (selector, context) {\n      var self = this;\n      var match, node;\n\n      if (!selector) {\n        return self;\n      }\n\n      if (selector.nodeType) {\n        self.context = self[0] = selector;\n        self.length = 1;\n        return self;\n      }\n\n      if (context && context.nodeType) {\n        self.context = context;\n      } else {\n        if (context) {\n          return DomQuery(selector).attr(context);\n        }\n\n        self.context = context = document;\n      }\n\n      if (isString$1(selector)) {\n        self.selector = selector;\n\n        if (selector.charAt(0) === '<' && selector.charAt(selector.length - 1) === '>' && selector.length >= 3) {\n          match = [null, selector, null];\n        } else {\n          match = rquickExpr$1.exec(selector);\n        }\n\n        if (match) {\n          if (match[1]) {\n            node = createFragment(selector, getElementDocument(context)).firstChild;\n\n            while (node) {\n              push$1.call(self, node);\n              node = node.nextSibling;\n            }\n          } else {\n            node = getElementDocument(context).getElementById(match[2]);\n\n            if (!node) {\n              return self;\n            }\n\n            if (node.id !== match[2]) {\n              return self.find(selector);\n            }\n\n            self.length = 1;\n            self[0] = node;\n          }\n        } else {\n          return DomQuery(context).find(selector);\n        }\n      } else {\n        this.add(selector, false);\n      }\n\n      return self;\n    },\n    toArray: function () {\n      return Tools.toArray(this);\n    },\n    add: function (items, sort) {\n      var self = this;\n      var nodes, i;\n\n      if (isString$1(items)) {\n        return self.add(DomQuery(items));\n      }\n\n      if (sort !== false) {\n        nodes = DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items)));\n        self.length = nodes.length;\n\n        for (i = 0; i < nodes.length; i++) {\n          self[i] = nodes[i];\n        }\n      } else {\n        push$1.apply(self, DomQuery.makeArray(items));\n      }\n\n      return self;\n    },\n    attr: function (name, value) {\n      var self = this;\n      var hook;\n\n      if (typeof name === 'object') {\n        each$4(name, function (name, value) {\n          self.attr(name, value);\n        });\n      } else if (isDefined(value)) {\n        this.each(function () {\n          var hook;\n\n          if (this.nodeType === 1) {\n            hook = attrHooks[name];\n\n            if (hook && hook.set) {\n              hook.set(this, value);\n              return;\n            }\n\n            if (value === null) {\n              this.removeAttribute(name, 2);\n            } else {\n              this.setAttribute(name, value, 2);\n            }\n          }\n        });\n      } else {\n        if (self[0] && self[0].nodeType === 1) {\n          hook = attrHooks[name];\n\n          if (hook && hook.get) {\n            return hook.get(self[0], name);\n          }\n\n          if (booleanMap[name]) {\n            return self.prop(name) ? name : undefined;\n          }\n\n          value = self[0].getAttribute(name, 2);\n\n          if (value === null) {\n            value = undefined;\n          }\n        }\n\n        return value;\n      }\n\n      return self;\n    },\n    removeAttr: function (name) {\n      return this.attr(name, null);\n    },\n    prop: function (name, value) {\n      var self = this;\n      name = propFix[name] || name;\n\n      if (typeof name === 'object') {\n        each$4(name, function (name, value) {\n          self.prop(name, value);\n        });\n      } else if (isDefined(value)) {\n        this.each(function () {\n          if (this.nodeType === 1) {\n            this[name] = value;\n          }\n        });\n      } else {\n        if (self[0] && self[0].nodeType && name in self[0]) {\n          return self[0][name];\n        }\n\n        return value;\n      }\n\n      return self;\n    },\n    css: function (name, value) {\n      var self = this;\n      var elm, hook;\n\n      var camel = function (name) {\n        return name.replace(/-(\\D)/g, function (a, b) {\n          return b.toUpperCase();\n        });\n      };\n\n      var dashed = function (name) {\n        return name.replace(/[A-Z]/g, function (a) {\n          return '-' + a;\n        });\n      };\n\n      if (typeof name === 'object') {\n        each$4(name, function (name, value) {\n          self.css(name, value);\n        });\n      } else {\n        if (isDefined(value)) {\n          name = camel(name);\n\n          if (typeof value === 'number' && !numericCssMap[name]) {\n            value = value.toString() + 'px';\n          }\n\n          self.each(function () {\n            var style = this.style;\n            hook = cssHooks[name];\n\n            if (hook && hook.set) {\n              hook.set(this, value);\n              return;\n            }\n\n            try {\n              this.style[cssFix[name] || name] = value;\n            } catch (ex) {}\n\n            if (value === null || value === '') {\n              if (style.removeProperty) {\n                style.removeProperty(dashed(name));\n              } else {\n                style.removeAttribute(name);\n              }\n            }\n          });\n        } else {\n          elm = self[0];\n          hook = cssHooks[name];\n\n          if (hook && hook.get) {\n            return hook.get(elm);\n          }\n\n          if (elm.ownerDocument.defaultView) {\n            try {\n              return elm.ownerDocument.defaultView.getComputedStyle(elm, null).getPropertyValue(dashed(name));\n            } catch (ex) {\n              return undefined;\n            }\n          } else if (elm.currentStyle) {\n            return elm.currentStyle[camel(name)];\n          } else {\n            return '';\n          }\n        }\n      }\n\n      return self;\n    },\n    remove: function () {\n      var self = this;\n      var node,\n          i = this.length;\n\n      while (i--) {\n        node = self[i];\n        Event.clean(node);\n\n        if (node.parentNode) {\n          node.parentNode.removeChild(node);\n        }\n      }\n\n      return this;\n    },\n    empty: function () {\n      var self = this;\n      var node,\n          i = this.length;\n\n      while (i--) {\n        node = self[i];\n\n        while (node.firstChild) {\n          node.removeChild(node.firstChild);\n        }\n      }\n\n      return this;\n    },\n    html: function (value) {\n      var self = this;\n      var i;\n\n      if (isDefined(value)) {\n        i = self.length;\n\n        try {\n          while (i--) {\n            self[i].innerHTML = value;\n          }\n        } catch (ex) {\n          DomQuery(self[i]).empty().append(value);\n        }\n\n        return self;\n      }\n\n      return self[0] ? self[0].innerHTML : '';\n    },\n    text: function (value) {\n      var self = this;\n      var i;\n\n      if (isDefined(value)) {\n        i = self.length;\n\n        while (i--) {\n          if ('innerText' in self[i]) {\n            self[i].innerText = value;\n          } else {\n            self[0].textContent = value;\n          }\n        }\n\n        return self;\n      }\n\n      return self[0] ? self[0].innerText || self[0].textContent : '';\n    },\n    append: function () {\n      return domManipulate(this, arguments, function (node) {\n        if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n          this.appendChild(node);\n        }\n      });\n    },\n    prepend: function () {\n      return domManipulate(this, arguments, function (node) {\n        if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n          this.insertBefore(node, this.firstChild);\n        }\n      }, true);\n    },\n    before: function () {\n      var self = this;\n\n      if (self[0] && self[0].parentNode) {\n        return domManipulate(self, arguments, function (node) {\n          this.parentNode.insertBefore(node, this);\n        });\n      }\n\n      return self;\n    },\n    after: function () {\n      var self = this;\n\n      if (self[0] && self[0].parentNode) {\n        return domManipulate(self, arguments, function (node) {\n          this.parentNode.insertBefore(node, this.nextSibling);\n        }, true);\n      }\n\n      return self;\n    },\n    appendTo: function (val) {\n      DomQuery(val).append(this);\n      return this;\n    },\n    prependTo: function (val) {\n      DomQuery(val).prepend(this);\n      return this;\n    },\n    replaceWith: function (content) {\n      return this.before(content).remove();\n    },\n    wrap: function (content) {\n      return wrap$1(this, content);\n    },\n    wrapAll: function (content) {\n      return wrap$1(this, content, true);\n    },\n    wrapInner: function (content) {\n      this.each(function () {\n        DomQuery(this).contents().wrapAll(content);\n      });\n      return this;\n    },\n    unwrap: function () {\n      return this.parent().each(function () {\n        DomQuery(this).replaceWith(this.childNodes);\n      });\n    },\n    clone: function () {\n      var result = [];\n      this.each(function () {\n        result.push(this.cloneNode(true));\n      });\n      return DomQuery(result);\n    },\n    addClass: function (className) {\n      return this.toggleClass(className, true);\n    },\n    removeClass: function (className) {\n      return this.toggleClass(className, false);\n    },\n    toggleClass: function (className, state) {\n      var self = this;\n\n      if (typeof className !== 'string') {\n        return self;\n      }\n\n      if (className.indexOf(' ') !== -1) {\n        each$4(className.split(' '), function () {\n          self.toggleClass(this, state);\n        });\n      } else {\n        self.each(function (index, node) {\n          var classState = hasClass(node, className);\n\n          if (classState !== state) {\n            var existingClassName = node.className;\n\n            if (classState) {\n              node.className = trim$3((' ' + existingClassName + ' ').replace(' ' + className + ' ', ' '));\n            } else {\n              node.className += existingClassName ? ' ' + className : className;\n            }\n          }\n        });\n      }\n\n      return self;\n    },\n    hasClass: function (className) {\n      return hasClass(this[0], className);\n    },\n    each: function (callback) {\n      return each$4(this, callback);\n    },\n    on: function (name, callback) {\n      return this.each(function () {\n        Event.bind(this, name, callback);\n      });\n    },\n    off: function (name, callback) {\n      return this.each(function () {\n        Event.unbind(this, name, callback);\n      });\n    },\n    trigger: function (name) {\n      return this.each(function () {\n        if (typeof name === 'object') {\n          Event.fire(this, name.type, name);\n        } else {\n          Event.fire(this, name);\n        }\n      });\n    },\n    show: function () {\n      return this.css('display', '');\n    },\n    hide: function () {\n      return this.css('display', 'none');\n    },\n    slice: function () {\n      return DomQuery(slice$1.apply(this, arguments));\n    },\n    eq: function (index) {\n      return index === -1 ? this.slice(index) : this.slice(index, +index + 1);\n    },\n    first: function () {\n      return this.eq(0);\n    },\n    last: function () {\n      return this.eq(-1);\n    },\n    find: function (selector) {\n      var i, l;\n      var ret = [];\n\n      for (i = 0, l = this.length; i < l; i++) {\n        DomQuery.find(selector, this[i], ret);\n      }\n\n      return DomQuery(ret);\n    },\n    filter: function (selector) {\n      if (typeof selector === 'function') {\n        return DomQuery(grep(this.toArray(), function (item, i) {\n          return selector(i, item);\n        }));\n      }\n\n      return DomQuery(DomQuery.filter(selector, this.toArray()));\n    },\n    closest: function (selector) {\n      var result = [];\n\n      if (selector instanceof DomQuery) {\n        selector = selector[0];\n      }\n\n      this.each(function (i, node) {\n        while (node) {\n          if (typeof selector === 'string' && DomQuery(node).is(selector)) {\n            result.push(node);\n            break;\n          } else if (node === selector) {\n            result.push(node);\n            break;\n          }\n\n          node = node.parentNode;\n        }\n      });\n      return DomQuery(result);\n    },\n    offset: function (offset) {\n      var elm, doc, docElm;\n      var x = 0,\n          y = 0,\n          pos;\n\n      if (!offset) {\n        elm = this[0];\n\n        if (elm) {\n          doc = elm.ownerDocument;\n          docElm = doc.documentElement;\n\n          if (elm.getBoundingClientRect) {\n            pos = elm.getBoundingClientRect();\n            x = pos.left + (docElm.scrollLeft || doc.body.scrollLeft) - docElm.clientLeft;\n            y = pos.top + (docElm.scrollTop || doc.body.scrollTop) - docElm.clientTop;\n          }\n        }\n\n        return {\n          left: x,\n          top: y\n        };\n      }\n\n      return this.css(offset);\n    },\n    push: push$1,\n    sort: Array.prototype.sort,\n    splice: Array.prototype.splice\n  };\n  Tools.extend(DomQueryConstructor, {\n    extend: Tools.extend,\n    makeArray: function (object) {\n      if (isWindow(object) || object.nodeType) {\n        return [object];\n      }\n\n      return Tools.toArray(object);\n    },\n    inArray: inArray$1,\n    isArray: Tools.isArray,\n    each: each$4,\n    trim: trim$3,\n    grep: grep,\n    find: Sizzle,\n    expr: Sizzle.selectors,\n    unique: Sizzle.uniqueSort,\n    text: Sizzle.getText,\n    contains: Sizzle.contains,\n    filter: function (expr, elems, not) {\n      var i = elems.length;\n\n      if (not) {\n        expr = ':not(' + expr + ')';\n      }\n\n      while (i--) {\n        if (elems[i].nodeType !== 1) {\n          elems.splice(i, 1);\n        }\n      }\n\n      if (elems.length === 1) {\n        elems = DomQuery.find.matchesSelector(elems[0], expr) ? [elems[0]] : [];\n      } else {\n        elems = DomQuery.find.matches(expr, elems);\n      }\n\n      return elems;\n    }\n  });\n\n  var dir = function (el, prop, until) {\n    var matched = [];\n    var cur = el[prop];\n\n    if (typeof until !== 'string' && until instanceof DomQuery) {\n      until = until[0];\n    }\n\n    while (cur && cur.nodeType !== 9) {\n      if (until !== undefined) {\n        if (cur === until) {\n          break;\n        }\n\n        if (typeof until === 'string' && DomQuery(cur).is(until)) {\n          break;\n        }\n      }\n\n      if (cur.nodeType === 1) {\n        matched.push(cur);\n      }\n\n      cur = cur[prop];\n    }\n\n    return matched;\n  };\n\n  var sibling$1 = function (node, siblingName, nodeType, until) {\n    var result = [];\n\n    if (until instanceof DomQuery) {\n      until = until[0];\n    }\n\n    for (; node; node = node[siblingName]) {\n      if (nodeType && node.nodeType !== nodeType) {\n        continue;\n      }\n\n      if (until !== undefined) {\n        if (node === until) {\n          break;\n        }\n\n        if (typeof until === 'string' && DomQuery(node).is(until)) {\n          break;\n        }\n      }\n\n      result.push(node);\n    }\n\n    return result;\n  };\n\n  var firstSibling = function (node, siblingName, nodeType) {\n    for (node = node[siblingName]; node; node = node[siblingName]) {\n      if (node.nodeType === nodeType) {\n        return node;\n      }\n    }\n\n    return null;\n  };\n\n  each$4({\n    parent: function (node) {\n      var parent = node.parentNode;\n      return parent && parent.nodeType !== 11 ? parent : null;\n    },\n    parents: function (node) {\n      return dir(node, 'parentNode');\n    },\n    next: function (node) {\n      return firstSibling(node, 'nextSibling', 1);\n    },\n    prev: function (node) {\n      return firstSibling(node, 'previousSibling', 1);\n    },\n    children: function (node) {\n      return sibling$1(node.firstChild, 'nextSibling', 1);\n    },\n    contents: function (node) {\n      return Tools.toArray((node.nodeName === 'iframe' ? node.contentDocument || node.contentWindow.document : node).childNodes);\n    }\n  }, function (name, fn) {\n    DomQueryConstructor.fn[name] = function (selector) {\n      var self = this;\n      var result = [];\n      self.each(function () {\n        var nodes = fn.call(result, this, selector, result);\n\n        if (nodes) {\n          if (DomQuery.isArray(nodes)) {\n            result.push.apply(result, nodes);\n          } else {\n            result.push(nodes);\n          }\n        }\n      });\n\n      if (this.length > 1) {\n        if (!skipUniques[name]) {\n          result = DomQuery.unique(result);\n        }\n\n        if (name.indexOf('parents') === 0) {\n          result = result.reverse();\n        }\n      }\n\n      var wrappedResult = DomQuery(result);\n\n      if (selector) {\n        return wrappedResult.filter(selector);\n      }\n\n      return wrappedResult;\n    };\n  });\n  each$4({\n    parentsUntil: function (node, until) {\n      return dir(node, 'parentNode', until);\n    },\n    nextUntil: function (node, until) {\n      return sibling$1(node, 'nextSibling', 1, until).slice(1);\n    },\n    prevUntil: function (node, until) {\n      return sibling$1(node, 'previousSibling', 1, until).slice(1);\n    }\n  }, function (name, fn) {\n    DomQueryConstructor.fn[name] = function (selector, filter) {\n      var self = this;\n      var result = [];\n      self.each(function () {\n        var nodes = fn.call(result, this, selector, result);\n\n        if (nodes) {\n          if (DomQuery.isArray(nodes)) {\n            result.push.apply(result, nodes);\n          } else {\n            result.push(nodes);\n          }\n        }\n      });\n\n      if (this.length > 1) {\n        result = DomQuery.unique(result);\n\n        if (name.indexOf('parents') === 0 || name === 'prevUntil') {\n          result = result.reverse();\n        }\n      }\n\n      var wrappedResult = DomQuery(result);\n\n      if (filter) {\n        return wrappedResult.filter(filter);\n      }\n\n      return wrappedResult;\n    };\n  });\n\n  DomQueryConstructor.fn.is = function (selector) {\n    return !!selector && this.filter(selector).length > 0;\n  };\n\n  DomQueryConstructor.fn.init.prototype = DomQueryConstructor.fn;\n\n  DomQueryConstructor.overrideDefaults = function (callback) {\n    var defaults;\n\n    var sub = function (selector, context) {\n      defaults = defaults || callback();\n\n      if (arguments.length === 0) {\n        selector = defaults.element;\n      }\n\n      if (!context) {\n        context = defaults.context;\n      }\n\n      return new sub.fn.init(selector, context);\n    };\n\n    DomQuery.extend(sub, this);\n    return sub;\n  };\n\n  DomQueryConstructor.attrHooks = attrHooks;\n  DomQueryConstructor.cssHooks = cssHooks;\n  var DomQuery = DomQueryConstructor;\n  var each$5 = Tools.each;\n  var grep$1 = Tools.grep;\n  var isIE = Env.ie;\n  var simpleSelectorRe = /^([a-z0-9],?)+$/i;\n\n  var setupAttrHooks = function (styles, settings, getContext) {\n    var keepValues = settings.keep_values;\n    var keepUrlHook = {\n      set: function ($elm, value, name) {\n        if (settings.url_converter) {\n          value = settings.url_converter.call(settings.url_converter_scope || getContext(), value, name, $elm[0]);\n        }\n\n        $elm.attr('data-mce-' + name, value).attr(name, value);\n      },\n      get: function ($elm, name) {\n        return $elm.attr('data-mce-' + name) || $elm.attr(name);\n      }\n    };\n    var attrHooks = {\n      style: {\n        set: function ($elm, value) {\n          if (value !== null && typeof value === 'object') {\n            $elm.css(value);\n            return;\n          }\n\n          if (keepValues) {\n            $elm.attr('data-mce-style', value);\n          }\n\n          if (value !== null && typeof value === 'string') {\n            $elm.removeAttr('style');\n            $elm.css(styles.parse(value));\n          } else {\n            $elm.attr('style', value);\n          }\n        },\n        get: function ($elm) {\n          var value = $elm.attr('data-mce-style') || $elm.attr('style');\n          value = styles.serialize(styles.parse(value), $elm[0].nodeName);\n          return value;\n        }\n      }\n    };\n\n    if (keepValues) {\n      attrHooks.href = attrHooks.src = keepUrlHook;\n    }\n\n    return attrHooks;\n  };\n\n  var updateInternalStyleAttr = function (styles, $elm) {\n    var rawValue = $elm.attr('style');\n    var value = styles.serialize(styles.parse(rawValue), $elm[0].nodeName);\n\n    if (!value) {\n      value = null;\n    }\n\n    $elm.attr('data-mce-style', value);\n  };\n\n  var findNodeIndex = function (node, normalized) {\n    var idx = 0,\n        lastNodeType,\n        nodeType;\n\n    if (node) {\n      for (lastNodeType = node.nodeType, node = node.previousSibling; node; node = node.previousSibling) {\n        nodeType = node.nodeType;\n\n        if (normalized && nodeType === 3) {\n          if (nodeType === lastNodeType || !node.nodeValue.length) {\n            continue;\n          }\n        }\n\n        idx++;\n        lastNodeType = nodeType;\n      }\n    }\n\n    return idx;\n  };\n\n  var DOMUtils = function (doc, settings) {\n    if (settings === void 0) {\n      settings = {};\n    }\n\n    var addedStyles = {};\n    var win = window;\n    var files = {};\n    var counter = 0;\n    var stdMode = true;\n    var boxModel = true;\n    var styleSheetLoader = instance.forElement(SugarElement.fromDom(doc), {\n      contentCssCors: settings.contentCssCors,\n      referrerPolicy: settings.referrerPolicy\n    });\n    var boundEvents = [];\n    var schema = settings.schema ? settings.schema : Schema({});\n    var styles = Styles({\n      url_converter: settings.url_converter,\n      url_converter_scope: settings.url_converter_scope\n    }, settings.schema);\n    var events = settings.ownEvents ? new EventUtils() : EventUtils.Event;\n    var blockElementsMap = schema.getBlockElements();\n    var $ = DomQuery.overrideDefaults(function () {\n      return {\n        context: doc,\n        element: self.getRoot()\n      };\n    });\n\n    var isBlock = function (node) {\n      if (typeof node === 'string') {\n        return !!blockElementsMap[node];\n      } else if (node) {\n        var type = node.nodeType;\n\n        if (type) {\n          return !!(type === 1 && blockElementsMap[node.nodeName]);\n        }\n      }\n\n      return false;\n    };\n\n    var get = function (elm) {\n      return elm && doc && isString(elm) ? doc.getElementById(elm) : elm;\n    };\n\n    var $$ = function (elm) {\n      return $(typeof elm === 'string' ? get(elm) : elm);\n    };\n\n    var getAttrib = function (elm, name, defaultVal) {\n      var hook, value;\n      var $elm = $$(elm);\n\n      if ($elm.length) {\n        hook = attrHooks[name];\n\n        if (hook && hook.get) {\n          value = hook.get($elm, name);\n        } else {\n          value = $elm.attr(name);\n        }\n      }\n\n      if (typeof value === 'undefined') {\n        value = defaultVal || '';\n      }\n\n      return value;\n    };\n\n    var getAttribs = function (elm) {\n      var node = get(elm);\n\n      if (!node) {\n        return [];\n      }\n\n      return node.attributes;\n    };\n\n    var setAttrib = function (elm, name, value) {\n      if (value === '') {\n        value = null;\n      }\n\n      var $elm = $$(elm);\n      var originalValue = $elm.attr(name);\n\n      if (!$elm.length) {\n        return;\n      }\n\n      var hook = attrHooks[name];\n\n      if (hook && hook.set) {\n        hook.set($elm, value, name);\n      } else {\n        $elm.attr(name, value);\n      }\n\n      if (originalValue !== value && settings.onSetAttrib) {\n        settings.onSetAttrib({\n          attrElm: $elm,\n          attrName: name,\n          attrValue: value\n        });\n      }\n    };\n\n    var clone = function (node, deep) {\n      if (!isIE || node.nodeType !== 1 || deep) {\n        return node.cloneNode(deep);\n      } else {\n        var clone_1 = doc.createElement(node.nodeName);\n        each$5(getAttribs(node), function (attr) {\n          setAttrib(clone_1, attr.nodeName, getAttrib(node, attr.nodeName));\n        });\n        return clone_1;\n      }\n    };\n\n    var getRoot = function () {\n      return settings.root_element || doc.body;\n    };\n\n    var getViewPort = function (argWin) {\n      var vp = getBounds(argWin);\n      return {\n        x: vp.x,\n        y: vp.y,\n        w: vp.width,\n        h: vp.height\n      };\n    };\n\n    var getPos$1 = function (elm, rootElm) {\n      return getPos(doc.body, get(elm), rootElm);\n    };\n\n    var setStyle = function (elm, name, value) {\n      var $elm = isString(name) ? $$(elm).css(name, value) : $$(elm).css(name);\n\n      if (settings.update_styles) {\n        updateInternalStyleAttr(styles, $elm);\n      }\n    };\n\n    var setStyles = function (elm, stylesArg) {\n      var $elm = $$(elm).css(stylesArg);\n\n      if (settings.update_styles) {\n        updateInternalStyleAttr(styles, $elm);\n      }\n    };\n\n    var getStyle = function (elm, name, computed) {\n      var $elm = $$(elm);\n\n      if (computed) {\n        return $elm.css(name);\n      }\n\n      name = name.replace(/-(\\D)/g, function (a, b) {\n        return b.toUpperCase();\n      });\n\n      if (name === 'float') {\n        name = Env.browser.isIE() ? 'styleFloat' : 'cssFloat';\n      }\n\n      return $elm[0] && $elm[0].style ? $elm[0].style[name] : undefined;\n    };\n\n    var getSize = function (elm) {\n      var w, h;\n      elm = get(elm);\n      w = getStyle(elm, 'width');\n      h = getStyle(elm, 'height');\n\n      if (w.indexOf('px') === -1) {\n        w = 0;\n      }\n\n      if (h.indexOf('px') === -1) {\n        h = 0;\n      }\n\n      return {\n        w: parseInt(w, 10) || elm.offsetWidth || elm.clientWidth,\n        h: parseInt(h, 10) || elm.offsetHeight || elm.clientHeight\n      };\n    };\n\n    var getRect = function (elm) {\n      elm = get(elm);\n      var pos = getPos$1(elm);\n      var size = getSize(elm);\n      return {\n        x: pos.x,\n        y: pos.y,\n        w: size.w,\n        h: size.h\n      };\n    };\n\n    var is = function (elm, selector) {\n      var i;\n\n      if (!elm) {\n        return false;\n      }\n\n      if (!Array.isArray(elm)) {\n        if (selector === '*') {\n          return elm.nodeType === 1;\n        }\n\n        if (simpleSelectorRe.test(selector)) {\n          var selectors = selector.toLowerCase().split(/,/);\n          var elmName = elm.nodeName.toLowerCase();\n\n          for (i = selectors.length - 1; i >= 0; i--) {\n            if (selectors[i] === elmName) {\n              return true;\n            }\n          }\n\n          return false;\n        }\n\n        if (elm.nodeType && elm.nodeType !== 1) {\n          return false;\n        }\n      }\n\n      var elms = !Array.isArray(elm) ? [elm] : elm;\n      return Sizzle(selector, elms[0].ownerDocument || elms[0], null, elms).length > 0;\n    };\n\n    var getParents = function (elm, selector, root, collect) {\n      var result = [];\n      var selectorVal;\n      var node = get(elm);\n      collect = collect === undefined;\n      root = root || (getRoot().nodeName !== 'BODY' ? getRoot().parentNode : null);\n\n      if (Tools.is(selector, 'string')) {\n        selectorVal = selector;\n\n        if (selector === '*') {\n          selector = function (node) {\n            return node.nodeType === 1;\n          };\n        } else {\n          selector = function (node) {\n            return is(node, selectorVal);\n          };\n        }\n      }\n\n      while (node) {\n        if (node === root || isNullable(node.nodeType) || isDocument$1(node) || isDocumentFragment$1(node)) {\n          break;\n        }\n\n        if (!selector || typeof selector === 'function' && selector(node)) {\n          if (collect) {\n            result.push(node);\n          } else {\n            return [node];\n          }\n        }\n\n        node = node.parentNode;\n      }\n\n      return collect ? result : null;\n    };\n\n    var getParent = function (node, selector, root) {\n      var parents = getParents(node, selector, root, false);\n      return parents && parents.length > 0 ? parents[0] : null;\n    };\n\n    var _findSib = function (node, selector, name) {\n      var func = selector;\n\n      if (node) {\n        if (typeof selector === 'string') {\n          func = function (node) {\n            return is(node, selector);\n          };\n        }\n\n        for (node = node[name]; node; node = node[name]) {\n          if (typeof func === 'function' && func(node)) {\n            return node;\n          }\n        }\n      }\n\n      return null;\n    };\n\n    var getNext = function (node, selector) {\n      return _findSib(node, selector, 'nextSibling');\n    };\n\n    var getPrev = function (node, selector) {\n      return _findSib(node, selector, 'previousSibling');\n    };\n\n    var select = function (selector, scope) {\n      return Sizzle(selector, get(scope) || settings.root_element || doc, []);\n    };\n\n    var run = function (elm, func, scope) {\n      var result;\n      var node = typeof elm === 'string' ? get(elm) : elm;\n\n      if (!node) {\n        return false;\n      }\n\n      if (Tools.isArray(node) && (node.length || node.length === 0)) {\n        result = [];\n        each$5(node, function (elm, i) {\n          if (elm) {\n            result.push(func.call(scope, typeof elm === 'string' ? get(elm) : elm, i));\n          }\n        });\n        return result;\n      }\n\n      var context = scope ? scope : this;\n      return func.call(context, node);\n    };\n\n    var setAttribs = function (elm, attrs) {\n      $$(elm).each(function (i, node) {\n        each$5(attrs, function (value, name) {\n          setAttrib(node, name, value);\n        });\n      });\n    };\n\n    var setHTML = function (elm, html) {\n      var $elm = $$(elm);\n\n      if (isIE) {\n        $elm.each(function (i, target) {\n          if (target.canHaveHTML === false) {\n            return;\n          }\n\n          while (target.firstChild) {\n            target.removeChild(target.firstChild);\n          }\n\n          try {\n            target.innerHTML = '<br>' + html;\n            target.removeChild(target.firstChild);\n          } catch (ex) {\n            DomQuery('<div></div>').html('<br>' + html).contents().slice(1).appendTo(target);\n          }\n\n          return html;\n        });\n      } else {\n        $elm.html(html);\n      }\n    };\n\n    var add = function (parentElm, name, attrs, html, create) {\n      return run(parentElm, function (parentElm) {\n        var newElm = typeof name === 'string' ? doc.createElement(name) : name;\n        setAttribs(newElm, attrs);\n\n        if (html) {\n          if (typeof html !== 'string' && html.nodeType) {\n            newElm.appendChild(html);\n          } else if (typeof html === 'string') {\n            setHTML(newElm, html);\n          }\n        }\n\n        return !create ? parentElm.appendChild(newElm) : newElm;\n      });\n    };\n\n    var create = function (name, attrs, html) {\n      return add(doc.createElement(name), name, attrs, html, true);\n    };\n\n    var decode = Entities.decode;\n    var encode = Entities.encodeAllRaw;\n\n    var createHTML = function (name, attrs, html) {\n      var outHtml = '',\n          key;\n      outHtml += '<' + name;\n\n      for (key in attrs) {\n        if (attrs.hasOwnProperty(key) && attrs[key] !== null && typeof attrs[key] !== 'undefined') {\n          outHtml += ' ' + key + '=\"' + encode(attrs[key]) + '\"';\n        }\n      }\n\n      if (typeof html !== 'undefined') {\n        return outHtml + '>' + html + '</' + name + '>';\n      }\n\n      return outHtml + ' />';\n    };\n\n    var createFragment = function (html) {\n      var node;\n      var container = doc.createElement('div');\n      var frag = doc.createDocumentFragment();\n      frag.appendChild(container);\n\n      if (html) {\n        container.innerHTML = html;\n      }\n\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n\n      frag.removeChild(container);\n      return frag;\n    };\n\n    var remove = function (node, keepChildren) {\n      var $node = $$(node);\n\n      if (keepChildren) {\n        $node.each(function () {\n          var child;\n\n          while (child = this.firstChild) {\n            if (child.nodeType === 3 && child.data.length === 0) {\n              this.removeChild(child);\n            } else {\n              this.parentNode.insertBefore(child, this);\n            }\n          }\n        }).remove();\n      } else {\n        $node.remove();\n      }\n\n      return $node.length > 1 ? $node.toArray() : $node[0];\n    };\n\n    var removeAllAttribs = function (e) {\n      return run(e, function (e) {\n        var i;\n        var attrs = e.attributes;\n\n        for (i = attrs.length - 1; i >= 0; i--) {\n          e.removeAttributeNode(attrs.item(i));\n        }\n      });\n    };\n\n    var parseStyle = function (cssText) {\n      return styles.parse(cssText);\n    };\n\n    var serializeStyle = function (stylesArg, name) {\n      return styles.serialize(stylesArg, name);\n    };\n\n    var addStyle = function (cssText) {\n      var head, styleElm;\n\n      if (self !== DOMUtils.DOM && doc === document) {\n        if (addedStyles[cssText]) {\n          return;\n        }\n\n        addedStyles[cssText] = true;\n      }\n\n      styleElm = doc.getElementById('mceDefaultStyles');\n\n      if (!styleElm) {\n        styleElm = doc.createElement('style');\n        styleElm.id = 'mceDefaultStyles';\n        styleElm.type = 'text/css';\n        head = doc.getElementsByTagName('head')[0];\n\n        if (head.firstChild) {\n          head.insertBefore(styleElm, head.firstChild);\n        } else {\n          head.appendChild(styleElm);\n        }\n      }\n\n      if (styleElm.styleSheet) {\n        styleElm.styleSheet.cssText += cssText;\n      } else {\n        styleElm.appendChild(doc.createTextNode(cssText));\n      }\n    };\n\n    var loadCSS = function (urls) {\n      if (!urls) {\n        urls = '';\n      }\n\n      each(urls.split(','), function (url) {\n        files[url] = true;\n        styleSheetLoader.load(url, noop);\n      });\n    };\n\n    var toggleClass = function (elm, cls, state) {\n      $$(elm).toggleClass(cls, state).each(function () {\n        if (this.className === '') {\n          DomQuery(this).attr('class', null);\n        }\n      });\n    };\n\n    var addClass = function (elm, cls) {\n      $$(elm).addClass(cls);\n    };\n\n    var removeClass = function (elm, cls) {\n      toggleClass(elm, cls, false);\n    };\n\n    var hasClass = function (elm, cls) {\n      return $$(elm).hasClass(cls);\n    };\n\n    var show = function (elm) {\n      $$(elm).show();\n    };\n\n    var hide = function (elm) {\n      $$(elm).hide();\n    };\n\n    var isHidden = function (elm) {\n      return $$(elm).css('display') === 'none';\n    };\n\n    var uniqueId = function (prefix) {\n      return (!prefix ? 'mce_' : prefix) + counter++;\n    };\n\n    var getOuterHTML = function (elm) {\n      var node = typeof elm === 'string' ? get(elm) : elm;\n      return isElement$1(node) ? node.outerHTML : DomQuery('<div></div>').append(DomQuery(node).clone()).html();\n    };\n\n    var setOuterHTML = function (elm, html) {\n      $$(elm).each(function () {\n        try {\n          if ('outerHTML' in this) {\n            this.outerHTML = html;\n            return;\n          }\n        } catch (ex) {}\n\n        remove(DomQuery(this).html(html), true);\n      });\n    };\n\n    var insertAfter = function (node, reference) {\n      var referenceNode = get(reference);\n      return run(node, function (node) {\n        var parent = referenceNode.parentNode;\n        var nextSibling = referenceNode.nextSibling;\n\n        if (nextSibling) {\n          parent.insertBefore(node, nextSibling);\n        } else {\n          parent.appendChild(node);\n        }\n\n        return node;\n      });\n    };\n\n    var replace = function (newElm, oldElm, keepChildren) {\n      return run(oldElm, function (oldElm) {\n        if (Tools.is(oldElm, 'array')) {\n          newElm = newElm.cloneNode(true);\n        }\n\n        if (keepChildren) {\n          each$5(grep$1(oldElm.childNodes), function (node) {\n            newElm.appendChild(node);\n          });\n        }\n\n        return oldElm.parentNode.replaceChild(newElm, oldElm);\n      });\n    };\n\n    var rename = function (elm, name) {\n      var newElm;\n\n      if (elm.nodeName !== name.toUpperCase()) {\n        newElm = create(name);\n        each$5(getAttribs(elm), function (attrNode) {\n          setAttrib(newElm, attrNode.nodeName, getAttrib(elm, attrNode.nodeName));\n        });\n        replace(newElm, elm, true);\n      }\n\n      return newElm || elm;\n    };\n\n    var findCommonAncestor = function (a, b) {\n      var ps = a,\n          pe;\n\n      while (ps) {\n        pe = b;\n\n        while (pe && ps !== pe) {\n          pe = pe.parentNode;\n        }\n\n        if (ps === pe) {\n          break;\n        }\n\n        ps = ps.parentNode;\n      }\n\n      if (!ps && a.ownerDocument) {\n        return a.ownerDocument.documentElement;\n      }\n\n      return ps;\n    };\n\n    var toHex = function (rgbVal) {\n      return styles.toHex(Tools.trim(rgbVal));\n    };\n\n    var isNonEmptyElement = function (node) {\n      if (isElement$1(node)) {\n        var isNamedAnchor = node.nodeName.toLowerCase() === 'a' && !getAttrib(node, 'href') && getAttrib(node, 'id');\n\n        if (getAttrib(node, 'name') || getAttrib(node, 'data-mce-bookmark') || isNamedAnchor) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    var isEmpty = function (node, elements) {\n      var type,\n          name,\n          brCount = 0;\n\n      if (isNonEmptyElement(node)) {\n        return false;\n      }\n\n      node = node.firstChild;\n\n      if (node) {\n        var walker = new DomTreeWalker(node, node.parentNode);\n        var whitespace = schema ? schema.getWhiteSpaceElements() : {};\n        elements = elements || (schema ? schema.getNonEmptyElements() : null);\n\n        do {\n          type = node.nodeType;\n\n          if (isElement$1(node)) {\n            var bogusVal = node.getAttribute('data-mce-bogus');\n\n            if (bogusVal) {\n              node = walker.next(bogusVal === 'all');\n              continue;\n            }\n\n            name = node.nodeName.toLowerCase();\n\n            if (elements && elements[name]) {\n              if (name === 'br') {\n                brCount++;\n                node = walker.next();\n                continue;\n              }\n\n              return false;\n            }\n\n            if (isNonEmptyElement(node)) {\n              return false;\n            }\n          }\n\n          if (type === 8) {\n            return false;\n          }\n\n          if (type === 3 && !isWhitespaceText(node.nodeValue)) {\n            return false;\n          }\n\n          if (type === 3 && node.parentNode && whitespace[node.parentNode.nodeName] && isWhitespaceText(node.nodeValue)) {\n            return false;\n          }\n\n          node = walker.next();\n        } while (node);\n      }\n\n      return brCount <= 1;\n    };\n\n    var createRng = function () {\n      return doc.createRange();\n    };\n\n    var split = function (parentElm, splitElm, replacementElm) {\n      var range = createRng();\n      var beforeFragment;\n      var afterFragment;\n      var parentNode;\n\n      if (parentElm && splitElm) {\n        range.setStart(parentElm.parentNode, findNodeIndex(parentElm));\n        range.setEnd(splitElm.parentNode, findNodeIndex(splitElm));\n        beforeFragment = range.extractContents();\n        range = createRng();\n        range.setStart(splitElm.parentNode, findNodeIndex(splitElm) + 1);\n        range.setEnd(parentElm.parentNode, findNodeIndex(parentElm) + 1);\n        afterFragment = range.extractContents();\n        parentNode = parentElm.parentNode;\n        parentNode.insertBefore(trimNode(self, beforeFragment), parentElm);\n\n        if (replacementElm) {\n          parentNode.insertBefore(replacementElm, parentElm);\n        } else {\n          parentNode.insertBefore(splitElm, parentElm);\n        }\n\n        parentNode.insertBefore(trimNode(self, afterFragment), parentElm);\n        remove(parentElm);\n        return replacementElm || splitElm;\n      }\n    };\n\n    var bind = function (target, name, func, scope) {\n      if (Tools.isArray(target)) {\n        var i = target.length;\n        var rv = [];\n\n        while (i--) {\n          rv[i] = bind(target[i], name, func, scope);\n        }\n\n        return rv;\n      }\n\n      if (settings.collect && (target === doc || target === win)) {\n        boundEvents.push([target, name, func, scope]);\n      }\n\n      var output = events.bind(target, name, func, scope || self);\n      return output;\n    };\n\n    var unbind = function (target, name, func) {\n      if (Tools.isArray(target)) {\n        var i = target.length;\n        var rv = [];\n\n        while (i--) {\n          rv[i] = unbind(target[i], name, func);\n        }\n\n        return rv;\n      } else {\n        if (boundEvents.length > 0 && (target === doc || target === win)) {\n          var i = boundEvents.length;\n\n          while (i--) {\n            var item = boundEvents[i];\n\n            if (target === item[0] && (!name || name === item[1]) && (!func || func === item[2])) {\n              events.unbind(item[0], item[1], item[2]);\n            }\n          }\n        }\n\n        return events.unbind(target, name, func);\n      }\n    };\n\n    var fire = function (target, name, evt) {\n      return events.fire(target, name, evt);\n    };\n\n    var getContentEditable = function (node) {\n      if (node && isElement$1(node)) {\n        var contentEditable = node.getAttribute('data-mce-contenteditable');\n\n        if (contentEditable && contentEditable !== 'inherit') {\n          return contentEditable;\n        }\n\n        return node.contentEditable !== 'inherit' ? node.contentEditable : null;\n      } else {\n        return null;\n      }\n    };\n\n    var getContentEditableParent = function (node) {\n      var root = getRoot();\n      var state = null;\n\n      for (; node && node !== root; node = node.parentNode) {\n        state = getContentEditable(node);\n\n        if (state !== null) {\n          break;\n        }\n      }\n\n      return state;\n    };\n\n    var destroy = function () {\n      if (boundEvents.length > 0) {\n        var i = boundEvents.length;\n\n        while (i--) {\n          var item = boundEvents[i];\n          events.unbind(item[0], item[1], item[2]);\n        }\n      }\n\n      each$1(files, function (_, url) {\n        styleSheetLoader.unload(url);\n        delete files[url];\n      });\n\n      if (Sizzle.setDocument) {\n        Sizzle.setDocument();\n      }\n    };\n\n    var isChildOf = function (node, parent) {\n      while (node) {\n        if (parent === node) {\n          return true;\n        }\n\n        node = node.parentNode;\n      }\n\n      return false;\n    };\n\n    var dumpRng = function (r) {\n      return 'startContainer: ' + r.startContainer.nodeName + ', startOffset: ' + r.startOffset + ', endContainer: ' + r.endContainer.nodeName + ', endOffset: ' + r.endOffset;\n    };\n\n    var self = {\n      doc: doc,\n      settings: settings,\n      win: win,\n      files: files,\n      stdMode: stdMode,\n      boxModel: boxModel,\n      styleSheetLoader: styleSheetLoader,\n      boundEvents: boundEvents,\n      styles: styles,\n      schema: schema,\n      events: events,\n      isBlock: isBlock,\n      $: $,\n      $$: $$,\n      root: null,\n      clone: clone,\n      getRoot: getRoot,\n      getViewPort: getViewPort,\n      getRect: getRect,\n      getSize: getSize,\n      getParent: getParent,\n      getParents: getParents,\n      get: get,\n      getNext: getNext,\n      getPrev: getPrev,\n      select: select,\n      is: is,\n      add: add,\n      create: create,\n      createHTML: createHTML,\n      createFragment: createFragment,\n      remove: remove,\n      setStyle: setStyle,\n      getStyle: getStyle,\n      setStyles: setStyles,\n      removeAllAttribs: removeAllAttribs,\n      setAttrib: setAttrib,\n      setAttribs: setAttribs,\n      getAttrib: getAttrib,\n      getPos: getPos$1,\n      parseStyle: parseStyle,\n      serializeStyle: serializeStyle,\n      addStyle: addStyle,\n      loadCSS: loadCSS,\n      addClass: addClass,\n      removeClass: removeClass,\n      hasClass: hasClass,\n      toggleClass: toggleClass,\n      show: show,\n      hide: hide,\n      isHidden: isHidden,\n      uniqueId: uniqueId,\n      setHTML: setHTML,\n      getOuterHTML: getOuterHTML,\n      setOuterHTML: setOuterHTML,\n      decode: decode,\n      encode: encode,\n      insertAfter: insertAfter,\n      replace: replace,\n      rename: rename,\n      findCommonAncestor: findCommonAncestor,\n      toHex: toHex,\n      run: run,\n      getAttribs: getAttribs,\n      isEmpty: isEmpty,\n      createRng: createRng,\n      nodeIndex: findNodeIndex,\n      split: split,\n      bind: bind,\n      unbind: unbind,\n      fire: fire,\n      getContentEditable: getContentEditable,\n      getContentEditableParent: getContentEditableParent,\n      destroy: destroy,\n      isChildOf: isChildOf,\n      dumpRng: dumpRng\n    };\n    var attrHooks = setupAttrHooks(styles, settings, function () {\n      return self;\n    });\n    return self;\n  };\n\n  DOMUtils.DOM = DOMUtils(document);\n  DOMUtils.nodeIndex = findNodeIndex;\n  var DOM = DOMUtils.DOM;\n  var each$6 = Tools.each,\n      grep$2 = Tools.grep;\n  var QUEUED = 0;\n  var LOADING = 1;\n  var LOADED = 2;\n  var FAILED = 3;\n\n  var ScriptLoader = function () {\n    function ScriptLoader(settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n\n      this.states = {};\n      this.queue = [];\n      this.scriptLoadedCallbacks = {};\n      this.queueLoadedCallbacks = [];\n      this.loading = 0;\n      this.settings = settings;\n    }\n\n    ScriptLoader.prototype._setReferrerPolicy = function (referrerPolicy) {\n      this.settings.referrerPolicy = referrerPolicy;\n    };\n\n    ScriptLoader.prototype.loadScript = function (url, success, failure) {\n      var dom = DOM;\n      var elm;\n\n      var cleanup = function () {\n        dom.remove(id);\n\n        if (elm) {\n          elm.onerror = elm.onload = elm = null;\n        }\n      };\n\n      var done = function () {\n        cleanup();\n        success();\n      };\n\n      var error = function () {\n        cleanup();\n\n        if (isFunction(failure)) {\n          failure();\n        } else {\n          if (typeof console !== 'undefined' && console.log) {\n            console.log('Failed to load script: ' + url);\n          }\n        }\n      };\n\n      var id = dom.uniqueId();\n      elm = document.createElement('script');\n      elm.id = id;\n      elm.type = 'text/javascript';\n      elm.src = Tools._addCacheSuffix(url);\n\n      if (this.settings.referrerPolicy) {\n        dom.setAttrib(elm, 'referrerpolicy', this.settings.referrerPolicy);\n      }\n\n      elm.onload = done;\n      elm.onerror = error;\n      (document.getElementsByTagName('head')[0] || document.body).appendChild(elm);\n    };\n\n    ScriptLoader.prototype.isDone = function (url) {\n      return this.states[url] === LOADED;\n    };\n\n    ScriptLoader.prototype.markDone = function (url) {\n      this.states[url] = LOADED;\n    };\n\n    ScriptLoader.prototype.add = function (url, success, scope, failure) {\n      var state = this.states[url];\n      this.queue.push(url);\n\n      if (state === undefined) {\n        this.states[url] = QUEUED;\n      }\n\n      if (success) {\n        if (!this.scriptLoadedCallbacks[url]) {\n          this.scriptLoadedCallbacks[url] = [];\n        }\n\n        this.scriptLoadedCallbacks[url].push({\n          success: success,\n          failure: failure,\n          scope: scope || this\n        });\n      }\n    };\n\n    ScriptLoader.prototype.load = function (url, success, scope, failure) {\n      return this.add(url, success, scope, failure);\n    };\n\n    ScriptLoader.prototype.remove = function (url) {\n      delete this.states[url];\n      delete this.scriptLoadedCallbacks[url];\n    };\n\n    ScriptLoader.prototype.loadQueue = function (success, scope, failure) {\n      this.loadScripts(this.queue, success, scope, failure);\n    };\n\n    ScriptLoader.prototype.loadScripts = function (scripts, success, scope, failure) {\n      var self = this;\n      var failures = [];\n\n      var execCallbacks = function (name, url) {\n        each$6(self.scriptLoadedCallbacks[url], function (callback) {\n          if (isFunction(callback[name])) {\n            callback[name].call(callback.scope);\n          }\n        });\n        self.scriptLoadedCallbacks[url] = undefined;\n      };\n\n      self.queueLoadedCallbacks.push({\n        success: success,\n        failure: failure,\n        scope: scope || this\n      });\n\n      var loadScripts = function () {\n        var loadingScripts = grep$2(scripts);\n        scripts.length = 0;\n        each$6(loadingScripts, function (url) {\n          if (self.states[url] === LOADED) {\n            execCallbacks('success', url);\n            return;\n          }\n\n          if (self.states[url] === FAILED) {\n            execCallbacks('failure', url);\n            return;\n          }\n\n          if (self.states[url] !== LOADING) {\n            self.states[url] = LOADING;\n            self.loading++;\n            self.loadScript(url, function () {\n              self.states[url] = LOADED;\n              self.loading--;\n              execCallbacks('success', url);\n              loadScripts();\n            }, function () {\n              self.states[url] = FAILED;\n              self.loading--;\n              failures.push(url);\n              execCallbacks('failure', url);\n              loadScripts();\n            });\n          }\n        });\n\n        if (!self.loading) {\n          var notifyCallbacks = self.queueLoadedCallbacks.slice(0);\n          self.queueLoadedCallbacks.length = 0;\n          each$6(notifyCallbacks, function (callback) {\n            if (failures.length === 0) {\n              if (isFunction(callback.success)) {\n                callback.success.call(callback.scope);\n              }\n            } else {\n              if (isFunction(callback.failure)) {\n                callback.failure.call(callback.scope, failures);\n              }\n            }\n          });\n        }\n      };\n\n      loadScripts();\n    };\n\n    ScriptLoader.ScriptLoader = new ScriptLoader();\n    return ScriptLoader;\n  }();\n\n  var Cell = function (initial) {\n    var value = initial;\n\n    var get = function () {\n      return value;\n    };\n\n    var set = function (v) {\n      value = v;\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var isRaw = function (str) {\n    return isObject(str) && has(str, 'raw');\n  };\n\n  var isTokenised = function (str) {\n    return isArray(str) && str.length > 1;\n  };\n\n  var data = {};\n  var currentCode = Cell('en');\n\n  var getLanguageData = function () {\n    return get$1(data, currentCode.get());\n  };\n\n  var getData = function () {\n    return map$1(data, function (value) {\n      return __assign({}, value);\n    });\n  };\n\n  var setCode = function (newCode) {\n    if (newCode) {\n      currentCode.set(newCode);\n    }\n  };\n\n  var getCode = function () {\n    return currentCode.get();\n  };\n\n  var add = function (code, items) {\n    var langData = data[code];\n\n    if (!langData) {\n      data[code] = langData = {};\n    }\n\n    each$1(items, function (translation, name) {\n      langData[name.toLowerCase()] = translation;\n    });\n  };\n\n  var translate = function (text) {\n    var langData = getLanguageData().getOr({});\n\n    var toString = function (obj) {\n      if (isFunction(obj)) {\n        return Object.prototype.toString.call(obj);\n      }\n\n      return !isEmpty(obj) ? '' + obj : '';\n    };\n\n    var isEmpty = function (text) {\n      return text === '' || text === null || text === undefined;\n    };\n\n    var getLangData = function (text) {\n      var textstr = toString(text);\n      return get$1(langData, textstr.toLowerCase()).map(toString).getOr(textstr);\n    };\n\n    var removeContext = function (str) {\n      return str.replace(/{context:\\w+}$/, '');\n    };\n\n    if (isEmpty(text)) {\n      return '';\n    }\n\n    if (isRaw(text)) {\n      return toString(text.raw);\n    }\n\n    if (isTokenised(text)) {\n      var values_1 = text.slice(1);\n      var substitued = getLangData(text[0]).replace(/\\{([0-9]+)\\}/g, function ($1, $2) {\n        return has(values_1, $2) ? toString(values_1[$2]) : $1;\n      });\n      return removeContext(substitued);\n    }\n\n    return removeContext(getLangData(text));\n  };\n\n  var isRtl = function () {\n    return getLanguageData().bind(function (items) {\n      return get$1(items, '_dir');\n    }).exists(function (dir) {\n      return dir === 'rtl';\n    });\n  };\n\n  var hasCode = function (code) {\n    return has(data, code);\n  };\n\n  var I18n = {\n    getData: getData,\n    setCode: setCode,\n    getCode: getCode,\n    add: add,\n    translate: translate,\n    isRtl: isRtl,\n    hasCode: hasCode\n  };\n\n  var AddOnManager = function () {\n    var items = [];\n    var urls = {};\n    var lookup = {};\n    var _listeners = [];\n\n    var runListeners = function (name, state) {\n      var matchedListeners = filter(_listeners, function (listener) {\n        return listener.name === name && listener.state === state;\n      });\n      each(matchedListeners, function (listener) {\n        return listener.callback();\n      });\n    };\n\n    var get = function (name) {\n      if (lookup[name]) {\n        return lookup[name].instance;\n      }\n\n      return undefined;\n    };\n\n    var dependencies = function (name) {\n      var result;\n\n      if (lookup[name]) {\n        result = lookup[name].dependencies;\n      }\n\n      return result || [];\n    };\n\n    var requireLangPack = function (name, languages) {\n      if (AddOnManager.languageLoad !== false) {\n        waitFor(name, function () {\n          var language = I18n.getCode();\n          var wrappedLanguages = ',' + (languages || '') + ',';\n\n          if (!language || languages && wrappedLanguages.indexOf(',' + language + ',') === -1) {\n            return;\n          }\n\n          ScriptLoader.ScriptLoader.add(urls[name] + '/langs/' + language + '.js');\n        }, 'loaded');\n      }\n    };\n\n    var add = function (id, addOn, dependencies) {\n      var addOnConstructor = addOn;\n      items.push(addOnConstructor);\n      lookup[id] = {\n        instance: addOnConstructor,\n        dependencies: dependencies\n      };\n      runListeners(id, 'added');\n      return addOnConstructor;\n    };\n\n    var remove = function (name) {\n      delete urls[name];\n      delete lookup[name];\n    };\n\n    var createUrl = function (baseUrl, dep) {\n      if (typeof dep === 'object') {\n        return dep;\n      }\n\n      return typeof baseUrl === 'string' ? {\n        prefix: '',\n        resource: dep,\n        suffix: ''\n      } : {\n        prefix: baseUrl.prefix,\n        resource: dep,\n        suffix: baseUrl.suffix\n      };\n    };\n\n    var addComponents = function (pluginName, scripts) {\n      var pluginUrl = urls[pluginName];\n      each(scripts, function (script) {\n        ScriptLoader.ScriptLoader.add(pluginUrl + '/' + script);\n      });\n    };\n\n    var loadDependencies = function (name, addOnUrl, success, scope) {\n      var deps = dependencies(name);\n      each(deps, function (dep) {\n        var newUrl = createUrl(addOnUrl, dep);\n        load(newUrl.resource, newUrl, undefined, undefined);\n      });\n\n      if (success) {\n        if (scope) {\n          success.call(scope);\n        } else {\n          success.call(ScriptLoader);\n        }\n      }\n    };\n\n    var load = function (name, addOnUrl, success, scope, failure) {\n      if (urls[name]) {\n        return;\n      }\n\n      var urlString = typeof addOnUrl === 'string' ? addOnUrl : addOnUrl.prefix + addOnUrl.resource + addOnUrl.suffix;\n\n      if (urlString.indexOf('/') !== 0 && urlString.indexOf('://') === -1) {\n        urlString = AddOnManager.baseURL + '/' + urlString;\n      }\n\n      urls[name] = urlString.substring(0, urlString.lastIndexOf('/'));\n\n      var done = function () {\n        runListeners(name, 'loaded');\n        loadDependencies(name, addOnUrl, success, scope);\n      };\n\n      if (lookup[name]) {\n        done();\n      } else {\n        ScriptLoader.ScriptLoader.add(urlString, done, scope, failure);\n      }\n    };\n\n    var waitFor = function (name, callback, state) {\n      if (state === void 0) {\n        state = 'added';\n      }\n\n      if (has(lookup, name) && state === 'added') {\n        callback();\n      } else if (has(urls, name) && state === 'loaded') {\n        callback();\n      } else {\n        _listeners.push({\n          name: name,\n          state: state,\n          callback: callback\n        });\n      }\n    };\n\n    return {\n      items: items,\n      urls: urls,\n      lookup: lookup,\n      _listeners: _listeners,\n      get: get,\n      dependencies: dependencies,\n      requireLangPack: requireLangPack,\n      add: add,\n      remove: remove,\n      createUrl: createUrl,\n      addComponents: addComponents,\n      load: load,\n      waitFor: waitFor\n    };\n  };\n\n  AddOnManager.languageLoad = true;\n  AddOnManager.baseURL = '';\n  AddOnManager.PluginManager = AddOnManager();\n  AddOnManager.ThemeManager = AddOnManager();\n\n  var first = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (timer !== null) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (timer === null) {\n        timer = setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      }\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var last$2 = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (timer !== null) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (timer !== null) {\n        clearTimeout(timer);\n      }\n\n      timer = setTimeout(function () {\n        fn.apply(null, args);\n        timer = null;\n      }, rate);\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var read = function (element, attr) {\n    var value = get$4(element, attr);\n    return value === undefined || value === '' ? [] : value.split(' ');\n  };\n\n  var add$1 = function (element, attr, id) {\n    var old = read(element, attr);\n    var nu = old.concat([id]);\n    set(element, attr, nu.join(' '));\n    return true;\n  };\n\n  var remove$2 = function (element, attr, id) {\n    var nu = filter(read(element, attr), function (v) {\n      return v !== id;\n    });\n\n    if (nu.length > 0) {\n      set(element, attr, nu.join(' '));\n    } else {\n      remove$1(element, attr);\n    }\n\n    return false;\n  };\n\n  var supports = function (element) {\n    return element.dom.classList !== undefined;\n  };\n\n  var get$6 = function (element) {\n    return read(element, 'class');\n  };\n\n  var add$2 = function (element, clazz) {\n    return add$1(element, 'class', clazz);\n  };\n\n  var remove$3 = function (element, clazz) {\n    return remove$2(element, 'class', clazz);\n  };\n\n  var add$3 = function (element, clazz) {\n    if (supports(element)) {\n      element.dom.classList.add(clazz);\n    } else {\n      add$2(element, clazz);\n    }\n  };\n\n  var cleanClass = function (element) {\n    var classList = supports(element) ? element.dom.classList : get$6(element);\n\n    if (classList.length === 0) {\n      remove$1(element, 'class');\n    }\n  };\n\n  var remove$4 = function (element, clazz) {\n    if (supports(element)) {\n      var classList = element.dom.classList;\n      classList.remove(clazz);\n    } else {\n      remove$3(element, clazz);\n    }\n\n    cleanClass(element);\n  };\n\n  var has$2 = function (element, clazz) {\n    return supports(element) && element.dom.classList.contains(clazz);\n  };\n\n  var descendants = function (scope, predicate) {\n    var result = [];\n    each(children(scope), function (x) {\n      if (predicate(x)) {\n        result = result.concat([x]);\n      }\n\n      result = result.concat(descendants(x, predicate));\n    });\n    return result;\n  };\n\n  var descendants$1 = function (scope, selector) {\n    return all(selector, scope);\n  };\n\n  var annotation = constant('mce-annotation');\n  var dataAnnotation = constant('data-mce-annotation');\n  var dataAnnotationId = constant('data-mce-annotation-uid');\n\n  var identify = function (editor, annotationName) {\n    var rng = editor.selection.getRng();\n    var start = SugarElement.fromDom(rng.startContainer);\n    var root = SugarElement.fromDom(editor.getBody());\n    var selector = annotationName.fold(function () {\n      return '.' + annotation();\n    }, function (an) {\n      return '[' + dataAnnotation() + '=\"' + an + '\"]';\n    });\n    var newStart = child(start, rng.startOffset).getOr(start);\n    var closest = closest$1(newStart, selector, function (n) {\n      return eq$2(n, root);\n    });\n\n    var getAttr = function (c, property) {\n      if (has$1(c, property)) {\n        return Optional.some(get$4(c, property));\n      } else {\n        return Optional.none();\n      }\n    };\n\n    return closest.bind(function (c) {\n      return getAttr(c, '' + dataAnnotationId()).bind(function (uid) {\n        return getAttr(c, '' + dataAnnotation()).map(function (name) {\n          var elements = findMarkers(editor, uid);\n          return {\n            uid: uid,\n            name: name,\n            elements: elements\n          };\n        });\n      });\n    });\n  };\n\n  var isAnnotation = function (elem) {\n    return isElement(elem) && has$2(elem, annotation());\n  };\n\n  var findMarkers = function (editor, uid) {\n    var body = SugarElement.fromDom(editor.getBody());\n    return descendants$1(body, '[' + dataAnnotationId() + '=\"' + uid + '\"]');\n  };\n\n  var findAll = function (editor, name) {\n    var body = SugarElement.fromDom(editor.getBody());\n    var markers = descendants$1(body, '[' + dataAnnotation() + '=\"' + name + '\"]');\n    var directory = {};\n    each(markers, function (m) {\n      var uid = get$4(m, dataAnnotationId());\n      var nodesAlready = directory.hasOwnProperty(uid) ? directory[uid] : [];\n      directory[uid] = nodesAlready.concat([m]);\n    });\n    return directory;\n  };\n\n  var setup = function (editor, _registry) {\n    var changeCallbacks = Cell({});\n\n    var initData = function () {\n      return {\n        listeners: [],\n        previous: Cell(Optional.none())\n      };\n    };\n\n    var withCallbacks = function (name, f) {\n      updateCallbacks(name, function (data) {\n        f(data);\n        return data;\n      });\n    };\n\n    var updateCallbacks = function (name, f) {\n      var callbackMap = changeCallbacks.get();\n      var data = callbackMap.hasOwnProperty(name) ? callbackMap[name] : initData();\n      var outputData = f(data);\n      callbackMap[name] = outputData;\n      changeCallbacks.set(callbackMap);\n    };\n\n    var fireCallbacks = function (name, uid, elements) {\n      withCallbacks(name, function (data) {\n        each(data.listeners, function (f) {\n          return f(true, name, {\n            uid: uid,\n            nodes: map(elements, function (elem) {\n              return elem.dom;\n            })\n          });\n        });\n      });\n    };\n\n    var fireNoAnnotation = function (name) {\n      withCallbacks(name, function (data) {\n        each(data.listeners, function (f) {\n          return f(false, name);\n        });\n      });\n    };\n\n    var onNodeChange = last$2(function () {\n      var callbackMap = changeCallbacks.get();\n      var annotations = sort$1(keys(callbackMap));\n      each(annotations, function (name) {\n        updateCallbacks(name, function (data) {\n          var prev = data.previous.get();\n          identify(editor, Optional.some(name)).fold(function () {\n            if (prev.isSome()) {\n              fireNoAnnotation(name);\n              data.previous.set(Optional.none());\n            }\n          }, function (_a) {\n            var uid = _a.uid,\n                name = _a.name,\n                elements = _a.elements;\n\n            if (!prev.is(uid)) {\n              fireCallbacks(name, uid, elements);\n              data.previous.set(Optional.some(uid));\n            }\n          });\n          return {\n            previous: data.previous,\n            listeners: data.listeners\n          };\n        });\n      });\n    }, 30);\n    editor.on('remove', function () {\n      onNodeChange.cancel();\n    });\n    editor.on('NodeChange', function () {\n      onNodeChange.throttle();\n    });\n\n    var addListener = function (name, f) {\n      updateCallbacks(name, function (data) {\n        return {\n          previous: data.previous,\n          listeners: data.listeners.concat([f])\n        };\n      });\n    };\n\n    return {\n      addListener: addListener\n    };\n  };\n\n  var setup$1 = function (editor, registry) {\n    var identifyParserNode = function (span) {\n      return Optional.from(span.attr(dataAnnotation())).bind(registry.lookup);\n    };\n\n    editor.on('init', function () {\n      editor.serializer.addNodeFilter('span', function (spans) {\n        each(spans, function (span) {\n          identifyParserNode(span).each(function (settings) {\n            if (settings.persistent === false) {\n              span.unwrap();\n            }\n          });\n        });\n      });\n    });\n  };\n\n  var create$2 = function () {\n    var annotations = {};\n\n    var register = function (name, settings) {\n      annotations[name] = {\n        name: name,\n        settings: settings\n      };\n    };\n\n    var lookup = function (name) {\n      return annotations.hasOwnProperty(name) ? Optional.from(annotations[name]).map(function (a) {\n        return a.settings;\n      }) : Optional.none();\n    };\n\n    return {\n      register: register,\n      lookup: lookup\n    };\n  };\n\n  var unique = 0;\n\n  var generate$1 = function (prefix) {\n    var date = new Date();\n    var time = date.getTime();\n    var random = Math.floor(Math.random() * 1000000000);\n    unique++;\n    return prefix + '_' + random + unique + String(time);\n  };\n\n  var add$4 = function (element, classes) {\n    each(classes, function (x) {\n      add$3(element, x);\n    });\n  };\n\n  var fromHtml$1 = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n    return children(SugarElement.fromDom(div));\n  };\n\n  var get$7 = function (element) {\n    return element.dom.innerHTML;\n  };\n\n  var set$1 = function (element, content) {\n    var owner$1 = owner(element);\n    var docDom = owner$1.dom;\n    var fragment = SugarElement.fromDom(docDom.createDocumentFragment());\n    var contentElements = fromHtml$1(content, docDom);\n    append$1(fragment, contentElements);\n    empty(element);\n    append(element, fragment);\n  };\n\n  var clone$1 = function (original, isDeep) {\n    return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n  };\n\n  var shallow = function (original) {\n    return clone$1(original, false);\n  };\n\n  var deep = function (original) {\n    return clone$1(original, true);\n  };\n\n  var TextWalker = function (startNode, rootNode, isBoundary) {\n    if (isBoundary === void 0) {\n      isBoundary = never;\n    }\n\n    var walker = new DomTreeWalker(startNode, rootNode);\n\n    var walk = function (direction) {\n      var next;\n\n      do {\n        next = walker[direction]();\n      } while (next && !isText$1(next) && !isBoundary(next));\n\n      return Optional.from(next).filter(isText$1);\n    };\n\n    return {\n      current: function () {\n        return Optional.from(walker.current()).filter(isText$1);\n      },\n      next: function () {\n        return walk('next');\n      },\n      prev: function () {\n        return walk('prev');\n      },\n      prev2: function () {\n        return walk('prev2');\n      }\n    };\n  };\n\n  var TextSeeker = function (dom, isBoundary) {\n    var isBlockBoundary = isBoundary ? isBoundary : function (node) {\n      return dom.isBlock(node) || isBr(node) || isContentEditableFalse(node);\n    };\n\n    var walk = function (node, offset, walker, process) {\n      if (isText$1(node)) {\n        var newOffset = process(node, offset, node.data);\n\n        if (newOffset !== -1) {\n          return Optional.some({\n            container: node,\n            offset: newOffset\n          });\n        }\n      }\n\n      return walker().bind(function (next) {\n        return walk(next.container, next.offset, walker, process);\n      });\n    };\n\n    var backwards = function (node, offset, process, root) {\n      var walker = TextWalker(node, root, isBlockBoundary);\n      return walk(node, offset, function () {\n        return walker.prev().map(function (prev) {\n          return {\n            container: prev,\n            offset: prev.length\n          };\n        });\n      }, process).getOrNull();\n    };\n\n    var forwards = function (node, offset, process, root) {\n      var walker = TextWalker(node, root, isBlockBoundary);\n      return walk(node, offset, function () {\n        return walker.next().map(function (next) {\n          return {\n            container: next,\n            offset: 0\n          };\n        });\n      }, process).getOrNull();\n    };\n\n    return {\n      backwards: backwards,\n      forwards: forwards\n    };\n  };\n\n  var cat = function (arr) {\n    var r = [];\n\n    var push = function (x) {\n      r.push(x);\n    };\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i].each(push);\n    }\n\n    return r;\n  };\n\n  var lift2 = function (oa, ob, f) {\n    return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n  };\n\n  var lift3 = function (oa, ob, oc, f) {\n    return oa.isSome() && ob.isSome() && oc.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Optional.none();\n  };\n\n  var someIf = function (b, a) {\n    return b ? Optional.some(a) : Optional.none();\n  };\n\n  var round = Math.round;\n\n  var clone$2 = function (rect) {\n    if (!rect) {\n      return {\n        left: 0,\n        top: 0,\n        bottom: 0,\n        right: 0,\n        width: 0,\n        height: 0\n      };\n    }\n\n    return {\n      left: round(rect.left),\n      top: round(rect.top),\n      bottom: round(rect.bottom),\n      right: round(rect.right),\n      width: round(rect.width),\n      height: round(rect.height)\n    };\n  };\n\n  var collapse = function (rect, toStart) {\n    rect = clone$2(rect);\n\n    if (toStart) {\n      rect.right = rect.left;\n    } else {\n      rect.left = rect.left + rect.width;\n      rect.right = rect.left;\n    }\n\n    rect.width = 0;\n    return rect;\n  };\n\n  var isEqual = function (rect1, rect2) {\n    return rect1.left === rect2.left && rect1.top === rect2.top && rect1.bottom === rect2.bottom && rect1.right === rect2.right;\n  };\n\n  var isValidOverflow = function (overflowY, rect1, rect2) {\n    return overflowY >= 0 && overflowY <= Math.min(rect1.height, rect2.height) / 2;\n  };\n\n  var isAbove = function (rect1, rect2) {\n    var halfHeight = Math.min(rect2.height / 2, rect1.height / 2);\n\n    if (rect1.bottom - halfHeight < rect2.top) {\n      return true;\n    }\n\n    if (rect1.top > rect2.bottom) {\n      return false;\n    }\n\n    return isValidOverflow(rect2.top - rect1.bottom, rect1, rect2);\n  };\n\n  var isBelow = function (rect1, rect2) {\n    if (rect1.top > rect2.bottom) {\n      return true;\n    }\n\n    if (rect1.bottom < rect2.top) {\n      return false;\n    }\n\n    return isValidOverflow(rect2.bottom - rect1.top, rect1, rect2);\n  };\n\n  var containsXY = function (rect, clientX, clientY) {\n    return clientX >= rect.left && clientX <= rect.right && clientY >= rect.top && clientY <= rect.bottom;\n  };\n\n  var getSelectedNode = function (range) {\n    var startContainer = range.startContainer,\n        startOffset = range.startOffset;\n\n    if (startContainer.hasChildNodes() && range.endOffset === startOffset + 1) {\n      return startContainer.childNodes[startOffset];\n    }\n\n    return null;\n  };\n\n  var getNode = function (container, offset) {\n    if (container.nodeType === 1 && container.hasChildNodes()) {\n      if (offset >= container.childNodes.length) {\n        offset = container.childNodes.length - 1;\n      }\n\n      container = container.childNodes[offset];\n    }\n\n    return container;\n  };\n\n  var extendingChars = new RegExp('[\\u0300-\\u036f\\u0483-\\u0487\\u0488-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1-\\u05c2\\u05c4-\\u05c5\\u05c7\\u0610-\\u061a' + '\\u064b-\\u065f\\u0670\\u06d6-\\u06dc\\u06df-\\u06e4\\u06e7-\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0' + '\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0859-\\u085b\\u08e3-\\u0902\\u093a\\u093c' + '\\u0941-\\u0948\\u094d\\u0951-\\u0957\\u0962-\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2-\\u09e3' + '\\u0a01-\\u0a02\\u0a3c\\u0a41-\\u0a42\\u0a47-\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70-\\u0a71\\u0a75\\u0a81-\\u0a82\\u0abc' + '\\u0ac1-\\u0ac5\\u0ac7-\\u0ac8\\u0acd\\u0ae2-\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57' + '\\u0b62-\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c00\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55-\\u0c56' + '\\u0c62-\\u0c63\\u0c81\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc-\\u0ccd\\u0cd5-\\u0cd6\\u0ce2-\\u0ce3\\u0d01\\u0d3e\\u0d41-\\u0d44' + '\\u0d4d\\u0d57\\u0d62-\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9' + '\\u0ebb-\\u0ebc\\u0ec8-\\u0ecd\\u0f18-\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97' + '\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039-\\u103a\\u103d-\\u103e\\u1058-\\u1059\\u105e-\\u1060\\u1071-\\u1074' + '\\u1082\\u1085-\\u1086\\u108d\\u109d\\u135d-\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752-\\u1753\\u1772-\\u1773\\u17b4-\\u17b5' + '\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927-\\u1928\\u1932\\u1939-\\u193b\\u1a17-\\u1a18' + '\\u1a1b\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1ab0-\\u1abd\\u1ABE\\u1b00-\\u1b03\\u1b34' + '\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80-\\u1b81\\u1ba2-\\u1ba5\\u1ba8-\\u1ba9\\u1bab-\\u1bad\\u1be6\\u1be8-\\u1be9' + '\\u1bed\\u1bef-\\u1bf1\\u1c2c-\\u1c33\\u1c36-\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1cf4\\u1cf8-\\u1cf9' + '\\u1dc0-\\u1df5\\u1dfc-\\u1dff\\u200c-\\u200d\\u20d0-\\u20dc\\u20DD-\\u20E0\\u20e1\\u20E2-\\u20E4\\u20e5-\\u20f0\\u2cef-\\u2cf1' + '\\u2d7f\\u2de0-\\u2dff\\u302a-\\u302d\\u302e-\\u302f\\u3099-\\u309a\\ua66f\\uA670-\\uA672\\ua674-\\ua67d\\ua69e-\\ua69f\\ua6f0-\\ua6f1' + '\\ua802\\ua806\\ua80b\\ua825-\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc' + '\\ua9e5\\uaa29-\\uaa2e\\uaa31-\\uaa32\\uaa35-\\uaa36\\uaa43\\uaa4c\\uaa7c\\uaab0\\uaab2-\\uaab4\\uaab7-\\uaab8\\uaabe-\\uaabf\\uaac1' + '\\uaaec-\\uaaed\\uaaf6\\uabe5\\uabe8\\uabed\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe2f\\uff9e-\\uff9f]');\n\n  var isExtendingChar = function (ch) {\n    return typeof ch === 'string' && ch.charCodeAt(0) >= 768 && extendingChars.test(ch);\n  };\n\n  var or = function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    return function (x) {\n      for (var i = 0; i < args.length; i++) {\n        if (args[i](x)) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var and = function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    return function (x) {\n      for (var i = 0; i < args.length; i++) {\n        if (!args[i](x)) {\n          return false;\n        }\n      }\n\n      return true;\n    };\n  };\n\n  var isElement$3 = isElement$1;\n  var isCaretCandidate$1 = isCaretCandidate;\n  var isBlock$1 = matchStyleValues('display', 'block table');\n  var isFloated = matchStyleValues('float', 'left right');\n  var isValidElementCaretCandidate = and(isElement$3, isCaretCandidate$1, not(isFloated));\n  var isNotPre = not(matchStyleValues('white-space', 'pre pre-line pre-wrap'));\n  var isText$4 = isText$1;\n  var isBr$3 = isBr;\n  var nodeIndex = DOMUtils.nodeIndex;\n  var resolveIndex = getNode;\n\n  var createRange = function (doc) {\n    return 'createRange' in doc ? doc.createRange() : DOMUtils.DOM.createRng();\n  };\n\n  var isWhiteSpace = function (chr) {\n    return chr && /[\\r\\n\\t ]/.test(chr);\n  };\n\n  var isRange = function (rng) {\n    return !!rng.setStart && !!rng.setEnd;\n  };\n\n  var isHiddenWhiteSpaceRange = function (range) {\n    var container = range.startContainer;\n    var offset = range.startOffset;\n    var text;\n\n    if (isWhiteSpace(range.toString()) && isNotPre(container.parentNode) && isText$1(container)) {\n      text = container.data;\n\n      if (isWhiteSpace(text[offset - 1]) || isWhiteSpace(text[offset + 1])) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var getBrClientRect = function (brNode) {\n    var doc = brNode.ownerDocument;\n    var rng = createRange(doc);\n    var nbsp$1 = doc.createTextNode(nbsp);\n    var parentNode = brNode.parentNode;\n    parentNode.insertBefore(nbsp$1, brNode);\n    rng.setStart(nbsp$1, 0);\n    rng.setEnd(nbsp$1, 1);\n    var clientRect = clone$2(rng.getBoundingClientRect());\n    parentNode.removeChild(nbsp$1);\n    return clientRect;\n  };\n\n  var getBoundingClientRectWebKitText = function (rng) {\n    var sc = rng.startContainer;\n    var ec = rng.endContainer;\n    var so = rng.startOffset;\n    var eo = rng.endOffset;\n\n    if (sc === ec && isText$1(ec) && so === 0 && eo === 1) {\n      var newRng = rng.cloneRange();\n      newRng.setEndAfter(ec);\n      return getBoundingClientRect(newRng);\n    } else {\n      return null;\n    }\n  };\n\n  var isZeroRect = function (r) {\n    return r.left === 0 && r.right === 0 && r.top === 0 && r.bottom === 0;\n  };\n\n  var getBoundingClientRect = function (item) {\n    var clientRect;\n    var clientRects = item.getClientRects();\n\n    if (clientRects.length > 0) {\n      clientRect = clone$2(clientRects[0]);\n    } else {\n      clientRect = clone$2(item.getBoundingClientRect());\n    }\n\n    if (!isRange(item) && isBr$3(item) && isZeroRect(clientRect)) {\n      return getBrClientRect(item);\n    }\n\n    if (isZeroRect(clientRect) && isRange(item)) {\n      return getBoundingClientRectWebKitText(item);\n    }\n\n    return clientRect;\n  };\n\n  var collapseAndInflateWidth = function (clientRect, toStart) {\n    var newClientRect = collapse(clientRect, toStart);\n    newClientRect.width = 1;\n    newClientRect.right = newClientRect.left + 1;\n    return newClientRect;\n  };\n\n  var getCaretPositionClientRects = function (caretPosition) {\n    var clientRects = [];\n    var beforeNode, node;\n\n    var addUniqueAndValidRect = function (clientRect) {\n      if (clientRect.height === 0) {\n        return;\n      }\n\n      if (clientRects.length > 0) {\n        if (isEqual(clientRect, clientRects[clientRects.length - 1])) {\n          return;\n        }\n      }\n\n      clientRects.push(clientRect);\n    };\n\n    var addCharacterOffset = function (container, offset) {\n      var range = createRange(container.ownerDocument);\n\n      if (offset < container.data.length) {\n        if (isExtendingChar(container.data[offset])) {\n          return clientRects;\n        }\n\n        if (isExtendingChar(container.data[offset - 1])) {\n          range.setStart(container, offset);\n          range.setEnd(container, offset + 1);\n\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), false));\n            return clientRects;\n          }\n        }\n      }\n\n      if (offset > 0) {\n        range.setStart(container, offset - 1);\n        range.setEnd(container, offset);\n\n        if (!isHiddenWhiteSpaceRange(range)) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), false));\n        }\n      }\n\n      if (offset < container.data.length) {\n        range.setStart(container, offset);\n        range.setEnd(container, offset + 1);\n\n        if (!isHiddenWhiteSpaceRange(range)) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), true));\n        }\n      }\n    };\n\n    if (isText$4(caretPosition.container())) {\n      addCharacterOffset(caretPosition.container(), caretPosition.offset());\n      return clientRects;\n    }\n\n    if (isElement$3(caretPosition.container())) {\n      if (caretPosition.isAtEnd()) {\n        node = resolveIndex(caretPosition.container(), caretPosition.offset());\n\n        if (isText$4(node)) {\n          addCharacterOffset(node, node.data.length);\n        }\n\n        if (isValidElementCaretCandidate(node) && !isBr$3(node)) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), false));\n        }\n      } else {\n        node = resolveIndex(caretPosition.container(), caretPosition.offset());\n\n        if (isText$4(node)) {\n          addCharacterOffset(node, 0);\n        }\n\n        if (isValidElementCaretCandidate(node) && caretPosition.isAtEnd()) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), false));\n          return clientRects;\n        }\n\n        beforeNode = resolveIndex(caretPosition.container(), caretPosition.offset() - 1);\n\n        if (isValidElementCaretCandidate(beforeNode) && !isBr$3(beforeNode)) {\n          if (isBlock$1(beforeNode) || isBlock$1(node) || !isValidElementCaretCandidate(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(beforeNode), false));\n          }\n        }\n\n        if (isValidElementCaretCandidate(node)) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), true));\n        }\n      }\n    }\n\n    return clientRects;\n  };\n\n  var CaretPosition = function (container, offset, clientRects) {\n    var isAtStart = function () {\n      if (isText$4(container)) {\n        return offset === 0;\n      }\n\n      return offset === 0;\n    };\n\n    var isAtEnd = function () {\n      if (isText$4(container)) {\n        return offset >= container.data.length;\n      }\n\n      return offset >= container.childNodes.length;\n    };\n\n    var toRange = function () {\n      var range = createRange(container.ownerDocument);\n      range.setStart(container, offset);\n      range.setEnd(container, offset);\n      return range;\n    };\n\n    var getClientRects = function () {\n      if (!clientRects) {\n        clientRects = getCaretPositionClientRects(CaretPosition(container, offset));\n      }\n\n      return clientRects;\n    };\n\n    var isVisible = function () {\n      return getClientRects().length > 0;\n    };\n\n    var isEqual = function (caretPosition) {\n      return caretPosition && container === caretPosition.container() && offset === caretPosition.offset();\n    };\n\n    var getNode = function (before) {\n      return resolveIndex(container, before ? offset - 1 : offset);\n    };\n\n    return {\n      container: constant(container),\n      offset: constant(offset),\n      toRange: toRange,\n      getClientRects: getClientRects,\n      isVisible: isVisible,\n      isAtStart: isAtStart,\n      isAtEnd: isAtEnd,\n      isEqual: isEqual,\n      getNode: getNode\n    };\n  };\n\n  CaretPosition.fromRangeStart = function (range) {\n    return CaretPosition(range.startContainer, range.startOffset);\n  };\n\n  CaretPosition.fromRangeEnd = function (range) {\n    return CaretPosition(range.endContainer, range.endOffset);\n  };\n\n  CaretPosition.after = function (node) {\n    return CaretPosition(node.parentNode, nodeIndex(node) + 1);\n  };\n\n  CaretPosition.before = function (node) {\n    return CaretPosition(node.parentNode, nodeIndex(node));\n  };\n\n  CaretPosition.isAbove = function (pos1, pos2) {\n    return lift2(head(pos2.getClientRects()), last(pos1.getClientRects()), isAbove).getOr(false);\n  };\n\n  CaretPosition.isBelow = function (pos1, pos2) {\n    return lift2(last(pos2.getClientRects()), head(pos1.getClientRects()), isBelow).getOr(false);\n  };\n\n  CaretPosition.isAtStart = function (pos) {\n    return pos ? pos.isAtStart() : false;\n  };\n\n  CaretPosition.isAtEnd = function (pos) {\n    return pos ? pos.isAtEnd() : false;\n  };\n\n  CaretPosition.isTextPosition = function (pos) {\n    return pos ? isText$1(pos.container()) : false;\n  };\n\n  CaretPosition.isElementPosition = function (pos) {\n    return CaretPosition.isTextPosition(pos) === false;\n  };\n\n  var trimEmptyTextNode = function (dom, node) {\n    if (isText$1(node) && node.data.length === 0) {\n      dom.remove(node);\n    }\n  };\n\n  var insertNode = function (dom, rng, node) {\n    rng.insertNode(node);\n    trimEmptyTextNode(dom, node.previousSibling);\n    trimEmptyTextNode(dom, node.nextSibling);\n  };\n\n  var insertFragment = function (dom, rng, frag) {\n    var firstChild = Optional.from(frag.firstChild);\n    var lastChild = Optional.from(frag.lastChild);\n    rng.insertNode(frag);\n    firstChild.each(function (child) {\n      return trimEmptyTextNode(dom, child.previousSibling);\n    });\n    lastChild.each(function (child) {\n      return trimEmptyTextNode(dom, child.nextSibling);\n    });\n  };\n\n  var rangeInsertNode = function (dom, rng, node) {\n    if (isDocumentFragment$1(node)) {\n      insertFragment(dom, rng, node);\n    } else {\n      insertNode(dom, rng, node);\n    }\n  };\n\n  var isText$5 = isText$1;\n  var isBogus$2 = isBogus;\n  var nodeIndex$1 = DOMUtils.nodeIndex;\n\n  var normalizedParent = function (node) {\n    var parentNode = node.parentNode;\n\n    if (isBogus$2(parentNode)) {\n      return normalizedParent(parentNode);\n    }\n\n    return parentNode;\n  };\n\n  var getChildNodes = function (node) {\n    if (!node) {\n      return [];\n    }\n\n    return reduce(node.childNodes, function (result, node) {\n      if (isBogus$2(node) && node.nodeName !== 'BR') {\n        result = result.concat(getChildNodes(node));\n      } else {\n        result.push(node);\n      }\n\n      return result;\n    }, []);\n  };\n\n  var normalizedTextOffset = function (node, offset) {\n    while (node = node.previousSibling) {\n      if (!isText$5(node)) {\n        break;\n      }\n\n      offset += node.data.length;\n    }\n\n    return offset;\n  };\n\n  var equal$1 = function (a) {\n    return function (b) {\n      return a === b;\n    };\n  };\n\n  var normalizedNodeIndex = function (node) {\n    var nodes, index;\n    nodes = getChildNodes(normalizedParent(node));\n    index = findIndex$1(nodes, equal$1(node), node);\n    nodes = nodes.slice(0, index + 1);\n    var numTextFragments = reduce(nodes, function (result, node, i) {\n      if (isText$5(node) && isText$5(nodes[i - 1])) {\n        result++;\n      }\n\n      return result;\n    }, 0);\n    nodes = filter$2(nodes, matchNodeNames([node.nodeName]));\n    index = findIndex$1(nodes, equal$1(node), node);\n    return index - numTextFragments;\n  };\n\n  var createPathItem = function (node) {\n    var name;\n\n    if (isText$5(node)) {\n      name = 'text()';\n    } else {\n      name = node.nodeName.toLowerCase();\n    }\n\n    return name + '[' + normalizedNodeIndex(node) + ']';\n  };\n\n  var parentsUntil = function (root, node, predicate) {\n    var parents = [];\n\n    for (node = node.parentNode; node !== root; node = node.parentNode) {\n      if (predicate && predicate(node)) {\n        break;\n      }\n\n      parents.push(node);\n    }\n\n    return parents;\n  };\n\n  var create$3 = function (root, caretPosition) {\n    var container,\n        offset,\n        path = [],\n        outputOffset,\n        childNodes,\n        parents;\n    container = caretPosition.container();\n    offset = caretPosition.offset();\n\n    if (isText$5(container)) {\n      outputOffset = normalizedTextOffset(container, offset);\n    } else {\n      childNodes = container.childNodes;\n\n      if (offset >= childNodes.length) {\n        outputOffset = 'after';\n        offset = childNodes.length - 1;\n      } else {\n        outputOffset = 'before';\n      }\n\n      container = childNodes[offset];\n    }\n\n    path.push(createPathItem(container));\n    parents = parentsUntil(root, container);\n    parents = filter$2(parents, not(isBogus));\n    path = path.concat(map$2(parents, function (node) {\n      return createPathItem(node);\n    }));\n    return path.reverse().join('/') + ',' + outputOffset;\n  };\n\n  var resolvePathItem = function (node, name, index) {\n    var nodes = getChildNodes(node);\n    nodes = filter$2(nodes, function (node, index) {\n      return !isText$5(node) || !isText$5(nodes[index - 1]);\n    });\n    nodes = filter$2(nodes, matchNodeNames([name]));\n    return nodes[index];\n  };\n\n  var findTextPosition = function (container, offset) {\n    var node = container,\n        targetOffset = 0,\n        dataLen;\n\n    while (isText$5(node)) {\n      dataLen = node.data.length;\n\n      if (offset >= targetOffset && offset <= targetOffset + dataLen) {\n        container = node;\n        offset = offset - targetOffset;\n        break;\n      }\n\n      if (!isText$5(node.nextSibling)) {\n        container = node;\n        offset = dataLen;\n        break;\n      }\n\n      targetOffset += dataLen;\n      node = node.nextSibling;\n    }\n\n    if (isText$5(container) && offset > container.data.length) {\n      offset = container.data.length;\n    }\n\n    return CaretPosition(container, offset);\n  };\n\n  var resolve$1 = function (root, path) {\n    var offset;\n\n    if (!path) {\n      return null;\n    }\n\n    var parts = path.split(',');\n    var paths = parts[0].split('/');\n    offset = parts.length > 1 ? parts[1] : 'before';\n    var container = reduce(paths, function (result, value) {\n      var match = /([\\w\\-\\(\\)]+)\\[([0-9]+)\\]/.exec(value);\n\n      if (!match) {\n        return null;\n      }\n\n      if (match[1] === 'text()') {\n        match[1] = '#text';\n      }\n\n      return resolvePathItem(result, match[1], parseInt(match[2], 10));\n    }, root);\n\n    if (!container) {\n      return null;\n    }\n\n    if (!isText$5(container)) {\n      if (offset === 'after') {\n        offset = nodeIndex$1(container) + 1;\n      } else {\n        offset = nodeIndex$1(container);\n      }\n\n      return CaretPosition(container.parentNode, offset);\n    }\n\n    return findTextPosition(container, parseInt(offset, 10));\n  };\n\n  var isContentEditableFalse$2 = isContentEditableFalse;\n\n  var getNormalizedTextOffset = function (trim, container, offset) {\n    var node, trimmedOffset;\n    trimmedOffset = trim(container.data.slice(0, offset)).length;\n\n    for (node = container.previousSibling; node && isText$1(node); node = node.previousSibling) {\n      trimmedOffset += trim(node.data).length;\n    }\n\n    return trimmedOffset;\n  };\n\n  var getPoint = function (dom, trim, normalized, rng, start) {\n    var container = rng[start ? 'startContainer' : 'endContainer'];\n    var offset = rng[start ? 'startOffset' : 'endOffset'];\n    var point = [];\n    var childNodes,\n        after = 0;\n    var root = dom.getRoot();\n\n    if (isText$1(container)) {\n      point.push(normalized ? getNormalizedTextOffset(trim, container, offset) : offset);\n    } else {\n      childNodes = container.childNodes;\n\n      if (offset >= childNodes.length && childNodes.length) {\n        after = 1;\n        offset = Math.max(0, childNodes.length - 1);\n      }\n\n      point.push(dom.nodeIndex(childNodes[offset], normalized) + after);\n    }\n\n    for (; container && container !== root; container = container.parentNode) {\n      point.push(dom.nodeIndex(container, normalized));\n    }\n\n    return point;\n  };\n\n  var getLocation = function (trim, selection, normalized, rng) {\n    var dom = selection.dom,\n        bookmark = {};\n    bookmark.start = getPoint(dom, trim, normalized, rng, true);\n\n    if (!selection.isCollapsed()) {\n      bookmark.end = getPoint(dom, trim, normalized, rng, false);\n    }\n\n    return bookmark;\n  };\n\n  var findIndex$2 = function (dom, name, element) {\n    var count = 0;\n    Tools.each(dom.select(name), function (node) {\n      if (node.getAttribute('data-mce-bogus') === 'all') {\n        return;\n      }\n\n      if (node === element) {\n        return false;\n      }\n\n      count++;\n    });\n    return count;\n  };\n\n  var moveEndPoint = function (rng, start) {\n    var container, offset, childNodes;\n    var prefix = start ? 'start' : 'end';\n    container = rng[prefix + 'Container'];\n    offset = rng[prefix + 'Offset'];\n\n    if (isElement$1(container) && container.nodeName === 'TR') {\n      childNodes = container.childNodes;\n      container = childNodes[Math.min(start ? offset : offset - 1, childNodes.length - 1)];\n\n      if (container) {\n        offset = start ? 0 : container.childNodes.length;\n        rng['set' + (start ? 'Start' : 'End')](container, offset);\n      }\n    }\n  };\n\n  var normalizeTableCellSelection = function (rng) {\n    moveEndPoint(rng, true);\n    moveEndPoint(rng, false);\n    return rng;\n  };\n\n  var findSibling = function (node, offset) {\n    var sibling;\n\n    if (isElement$1(node)) {\n      node = getNode(node, offset);\n\n      if (isContentEditableFalse$2(node)) {\n        return node;\n      }\n    }\n\n    if (isCaretContainer(node)) {\n      if (isText$1(node) && isCaretContainerBlock(node)) {\n        node = node.parentNode;\n      }\n\n      sibling = node.previousSibling;\n\n      if (isContentEditableFalse$2(sibling)) {\n        return sibling;\n      }\n\n      sibling = node.nextSibling;\n\n      if (isContentEditableFalse$2(sibling)) {\n        return sibling;\n      }\n    }\n  };\n\n  var findAdjacentContentEditableFalseElm = function (rng) {\n    return findSibling(rng.startContainer, rng.startOffset) || findSibling(rng.endContainer, rng.endOffset);\n  };\n\n  var getOffsetBookmark = function (trim, normalized, selection) {\n    var element = selection.getNode();\n    var name = element ? element.nodeName : null;\n    var rng = selection.getRng();\n\n    if (isContentEditableFalse$2(element) || name === 'IMG') {\n      return {\n        name: name,\n        index: findIndex$2(selection.dom, name, element)\n      };\n    }\n\n    var sibling = findAdjacentContentEditableFalseElm(rng);\n\n    if (sibling) {\n      name = sibling.tagName;\n      return {\n        name: name,\n        index: findIndex$2(selection.dom, name, sibling)\n      };\n    }\n\n    return getLocation(trim, selection, normalized, rng);\n  };\n\n  var getCaretBookmark = function (selection) {\n    var rng = selection.getRng();\n    return {\n      start: create$3(selection.dom.getRoot(), CaretPosition.fromRangeStart(rng)),\n      end: create$3(selection.dom.getRoot(), CaretPosition.fromRangeEnd(rng))\n    };\n  };\n\n  var getRangeBookmark = function (selection) {\n    return {\n      rng: selection.getRng()\n    };\n  };\n\n  var createBookmarkSpan = function (dom, id, filled) {\n    var args = {\n      'data-mce-type': 'bookmark',\n      id: id,\n      'style': 'overflow:hidden;line-height:0px'\n    };\n    return filled ? dom.create('span', args, '&#xFEFF;') : dom.create('span', args);\n  };\n\n  var getPersistentBookmark = function (selection, filled) {\n    var dom = selection.dom;\n    var rng = selection.getRng();\n    var id = dom.uniqueId();\n    var collapsed = selection.isCollapsed();\n    var element = selection.getNode();\n    var name = element.nodeName;\n\n    if (name === 'IMG') {\n      return {\n        name: name,\n        index: findIndex$2(dom, name, element)\n      };\n    }\n\n    var rng2 = normalizeTableCellSelection(rng.cloneRange());\n\n    if (!collapsed) {\n      rng2.collapse(false);\n      var endBookmarkNode = createBookmarkSpan(dom, id + '_end', filled);\n      rangeInsertNode(dom, rng2, endBookmarkNode);\n    }\n\n    rng = normalizeTableCellSelection(rng);\n    rng.collapse(true);\n    var startBookmarkNode = createBookmarkSpan(dom, id + '_start', filled);\n    rangeInsertNode(dom, rng, startBookmarkNode);\n    selection.moveToBookmark({\n      id: id,\n      keep: true\n    });\n    return {\n      id: id\n    };\n  };\n\n  var getBookmark = function (selection, type, normalized) {\n    if (type === 2) {\n      return getOffsetBookmark(trim$2, normalized, selection);\n    } else if (type === 3) {\n      return getCaretBookmark(selection);\n    } else if (type) {\n      return getRangeBookmark(selection);\n    } else {\n      return getPersistentBookmark(selection, false);\n    }\n  };\n\n  var getUndoBookmark = curry(getOffsetBookmark, identity, true);\n  var DOM$1 = DOMUtils.DOM;\n  var defaultPreviewStyles = 'font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow';\n\n  var getBodySetting = function (editor, name, defaultValue) {\n    var value = editor.getParam(name, defaultValue);\n\n    if (value.indexOf('=') !== -1) {\n      var bodyObj = editor.getParam(name, '', 'hash');\n      return bodyObj.hasOwnProperty(editor.id) ? bodyObj[editor.id] : defaultValue;\n    } else {\n      return value;\n    }\n  };\n\n  var getIframeAttrs = function (editor) {\n    return editor.getParam('iframe_attrs', {});\n  };\n\n  var getDocType = function (editor) {\n    return editor.getParam('doctype', '<!DOCTYPE html>');\n  };\n\n  var getDocumentBaseUrl = function (editor) {\n    return editor.getParam('document_base_url', '');\n  };\n\n  var getBodyId = function (editor) {\n    return getBodySetting(editor, 'body_id', 'tinymce');\n  };\n\n  var getBodyClass = function (editor) {\n    return getBodySetting(editor, 'body_class', '');\n  };\n\n  var getContentSecurityPolicy = function (editor) {\n    return editor.getParam('content_security_policy', '');\n  };\n\n  var shouldPutBrInPre = function (editor) {\n    return editor.getParam('br_in_pre', true);\n  };\n\n  var getForcedRootBlock = function (editor) {\n    if (editor.getParam('force_p_newlines', false)) {\n      return 'p';\n    }\n\n    var block = editor.getParam('forced_root_block', 'p');\n\n    if (block === false) {\n      return '';\n    } else if (block === true) {\n      return 'p';\n    } else {\n      return block;\n    }\n  };\n\n  var getForcedRootBlockAttrs = function (editor) {\n    return editor.getParam('forced_root_block_attrs', {});\n  };\n\n  var getBrNewLineSelector = function (editor) {\n    return editor.getParam('br_newline_selector', '.mce-toc h2,figcaption,caption');\n  };\n\n  var getNoNewLineSelector = function (editor) {\n    return editor.getParam('no_newline_selector', '');\n  };\n\n  var shouldKeepStyles = function (editor) {\n    return editor.getParam('keep_styles', true);\n  };\n\n  var shouldEndContainerOnEmptyBlock = function (editor) {\n    return editor.getParam('end_container_on_empty_block', false);\n  };\n\n  var getFontStyleValues = function (editor) {\n    return Tools.explode(editor.getParam('font_size_style_values', 'xx-small,x-small,small,medium,large,x-large,xx-large'));\n  };\n\n  var getFontSizeClasses = function (editor) {\n    return Tools.explode(editor.getParam('font_size_classes', ''));\n  };\n\n  var getImagesDataImgFilter = function (editor) {\n    return editor.getParam('images_dataimg_filter', always, 'function');\n  };\n\n  var isAutomaticUploadsEnabled = function (editor) {\n    return editor.getParam('automatic_uploads', true, 'boolean');\n  };\n\n  var shouldReuseFileName = function (editor) {\n    return editor.getParam('images_reuse_filename', false, 'boolean');\n  };\n\n  var shouldReplaceBlobUris = function (editor) {\n    return editor.getParam('images_replace_blob_uris', true, 'boolean');\n  };\n\n  var getIconPackName = function (editor) {\n    return editor.getParam('icons', '', 'string');\n  };\n\n  var getIconsUrl = function (editor) {\n    return editor.getParam('icons_url', '', 'string');\n  };\n\n  var getImageUploadUrl = function (editor) {\n    return editor.getParam('images_upload_url', '', 'string');\n  };\n\n  var getImageUploadBasePath = function (editor) {\n    return editor.getParam('images_upload_base_path', '', 'string');\n  };\n\n  var getImagesUploadCredentials = function (editor) {\n    return editor.getParam('images_upload_credentials', false, 'boolean');\n  };\n\n  var getImagesUploadHandler = function (editor) {\n    return editor.getParam('images_upload_handler', null, 'function');\n  };\n\n  var shouldUseContentCssCors = function (editor) {\n    return editor.getParam('content_css_cors', false, 'boolean');\n  };\n\n  var getReferrerPolicy = function (editor) {\n    return editor.getParam('referrer_policy', '', 'string');\n  };\n\n  var getLanguageCode = function (editor) {\n    return editor.getParam('language', 'en', 'string');\n  };\n\n  var getLanguageUrl = function (editor) {\n    return editor.getParam('language_url', '', 'string');\n  };\n\n  var shouldIndentUseMargin = function (editor) {\n    return editor.getParam('indent_use_margin', false);\n  };\n\n  var getIndentation = function (editor) {\n    return editor.getParam('indentation', '40px', 'string');\n  };\n\n  var getContentCss = function (editor) {\n    var contentCss = editor.getParam('content_css');\n\n    if (isString(contentCss)) {\n      return map(contentCss.split(','), trim);\n    } else if (isArray(contentCss)) {\n      return contentCss;\n    } else if (contentCss === false || editor.inline) {\n      return [];\n    } else {\n      return ['default'];\n    }\n  };\n\n  var getFontCss = function (editor) {\n    var fontCss = editor.getParam('font_css', []);\n    return isArray(fontCss) ? fontCss : map(fontCss.split(','), trim);\n  };\n\n  var getDirectionality = function (editor) {\n    return editor.getParam('directionality', I18n.isRtl() ? 'rtl' : undefined);\n  };\n\n  var getInlineBoundarySelector = function (editor) {\n    return editor.getParam('inline_boundaries_selector', 'a[href],code,.mce-annotation', 'string');\n  };\n\n  var getObjectResizing = function (editor) {\n    var selector = editor.getParam('object_resizing');\n\n    if (selector === false || Env.iOS) {\n      return false;\n    } else {\n      return isString(selector) ? selector : 'table,img,figure.image,div,video,iframe';\n    }\n  };\n\n  var getResizeImgProportional = function (editor) {\n    return editor.getParam('resize_img_proportional', true, 'boolean');\n  };\n\n  var getPlaceholder = function (editor) {\n    return editor.getParam('placeholder', DOM$1.getAttrib(editor.getElement(), 'placeholder'), 'string');\n  };\n\n  var getEventRoot = function (editor) {\n    return editor.getParam('event_root');\n  };\n\n  var getServiceMessage = function (editor) {\n    return editor.getParam('service_message');\n  };\n\n  var getTheme = function (editor) {\n    return editor.getParam('theme');\n  };\n\n  var shouldValidate = function (editor) {\n    return editor.getParam('validate');\n  };\n\n  var isInlineBoundariesEnabled = function (editor) {\n    return editor.getParam('inline_boundaries') !== false;\n  };\n\n  var getFormats = function (editor) {\n    return editor.getParam('formats');\n  };\n\n  var getPreviewStyles = function (editor) {\n    var style = editor.getParam('preview_styles', defaultPreviewStyles);\n\n    if (isString(style)) {\n      return style;\n    } else {\n      return '';\n    }\n  };\n\n  var canFormatEmptyLines = function (editor) {\n    return editor.getParam('format_empty_lines', false, 'boolean');\n  };\n\n  var getCustomUiSelector = function (editor) {\n    return editor.getParam('custom_ui_selector', '', 'string');\n  };\n\n  var getThemeUrl = function (editor) {\n    return editor.getParam('theme_url');\n  };\n\n  var isInline$1 = function (editor) {\n    return editor.getParam('inline');\n  };\n\n  var hasHiddenInput = function (editor) {\n    return editor.getParam('hidden_input');\n  };\n\n  var shouldPatchSubmit = function (editor) {\n    return editor.getParam('submit_patch');\n  };\n\n  var isEncodingXml = function (editor) {\n    return editor.getParam('encoding') === 'xml';\n  };\n\n  var shouldAddFormSubmitTrigger = function (editor) {\n    return editor.getParam('add_form_submit_trigger');\n  };\n\n  var shouldAddUnloadTrigger = function (editor) {\n    return editor.getParam('add_unload_trigger');\n  };\n\n  var hasForcedRootBlock = function (editor) {\n    return getForcedRootBlock(editor) !== '';\n  };\n\n  var getCustomUndoRedoLevels = function (editor) {\n    return editor.getParam('custom_undo_redo_levels', 0, 'number');\n  };\n\n  var shouldDisableNodeChange = function (editor) {\n    return editor.getParam('disable_nodechange');\n  };\n\n  var isReadOnly = function (editor) {\n    return editor.getParam('readonly');\n  };\n\n  var hasContentCssCors = function (editor) {\n    return editor.getParam('content_css_cors');\n  };\n\n  var getPlugins = function (editor) {\n    return editor.getParam('plugins', '', 'string');\n  };\n\n  var getExternalPlugins = function (editor) {\n    return editor.getParam('external_plugins');\n  };\n\n  var shouldBlockUnsupportedDrop = function (editor) {\n    return editor.getParam('block_unsupported_drop', true, 'boolean');\n  };\n\n  var isVisualAidsEnabled = function (editor) {\n    return editor.getParam('visual', true, 'boolean');\n  };\n\n  var getVisualAidsTableClass = function (editor) {\n    return editor.getParam('visual_table_class', 'mce-item-table', 'string');\n  };\n\n  var getVisualAidsAnchorClass = function (editor) {\n    return editor.getParam('visual_anchor_class', 'mce-item-anchor', 'string');\n  };\n\n  var isElement$4 = isElement$1;\n  var isText$6 = isText$1;\n\n  var removeNode = function (node) {\n    var parentNode = node.parentNode;\n\n    if (parentNode) {\n      parentNode.removeChild(node);\n    }\n  };\n\n  var trimCount = function (text) {\n    var trimmedText = trim$2(text);\n    return {\n      count: text.length - trimmedText.length,\n      text: trimmedText\n    };\n  };\n\n  var deleteZwspChars = function (caretContainer) {\n    var idx;\n\n    while ((idx = caretContainer.data.lastIndexOf(ZWSP)) !== -1) {\n      caretContainer.deleteData(idx, 1);\n    }\n  };\n\n  var removeUnchanged = function (caretContainer, pos) {\n    remove$5(caretContainer);\n    return pos;\n  };\n\n  var removeTextAndReposition = function (caretContainer, pos) {\n    var before = trimCount(caretContainer.data.substr(0, pos.offset()));\n    var after = trimCount(caretContainer.data.substr(pos.offset()));\n    var text = before.text + after.text;\n\n    if (text.length > 0) {\n      deleteZwspChars(caretContainer);\n      return CaretPosition(caretContainer, pos.offset() - before.count);\n    } else {\n      return pos;\n    }\n  };\n\n  var removeElementAndReposition = function (caretContainer, pos) {\n    var parentNode = pos.container();\n    var newPosition = indexOf(from$1(parentNode.childNodes), caretContainer).map(function (index) {\n      return index < pos.offset() ? CaretPosition(parentNode, pos.offset() - 1) : pos;\n    }).getOr(pos);\n    remove$5(caretContainer);\n    return newPosition;\n  };\n\n  var removeTextCaretContainer = function (caretContainer, pos) {\n    return isText$6(caretContainer) && pos.container() === caretContainer ? removeTextAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n  };\n\n  var removeElementCaretContainer = function (caretContainer, pos) {\n    return pos.container() === caretContainer.parentNode ? removeElementAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n  };\n\n  var removeAndReposition = function (container, pos) {\n    return CaretPosition.isTextPosition(pos) ? removeTextCaretContainer(container, pos) : removeElementCaretContainer(container, pos);\n  };\n\n  var remove$5 = function (caretContainerNode) {\n    if (isElement$4(caretContainerNode) && isCaretContainer(caretContainerNode)) {\n      if (hasContent(caretContainerNode)) {\n        caretContainerNode.removeAttribute('data-mce-caret');\n      } else {\n        removeNode(caretContainerNode);\n      }\n    }\n\n    if (isText$6(caretContainerNode)) {\n      deleteZwspChars(caretContainerNode);\n\n      if (caretContainerNode.data.length === 0) {\n        removeNode(caretContainerNode);\n      }\n    }\n  };\n\n  var browser$2 = detect$3().browser;\n  var isContentEditableFalse$3 = isContentEditableFalse;\n  var isMedia$1 = isMedia;\n  var isTableCell$2 = isTableCell;\n  var inlineFakeCaretSelector = '*[contentEditable=false],video,audio,embed,object';\n\n  var getAbsoluteClientRect = function (root, element, before) {\n    var clientRect = collapse(element.getBoundingClientRect(), before);\n    var docElm, scrollX, scrollY, margin, rootRect;\n\n    if (root.tagName === 'BODY') {\n      docElm = root.ownerDocument.documentElement;\n      scrollX = root.scrollLeft || docElm.scrollLeft;\n      scrollY = root.scrollTop || docElm.scrollTop;\n    } else {\n      rootRect = root.getBoundingClientRect();\n      scrollX = root.scrollLeft - rootRect.left;\n      scrollY = root.scrollTop - rootRect.top;\n    }\n\n    clientRect.left += scrollX;\n    clientRect.right += scrollX;\n    clientRect.top += scrollY;\n    clientRect.bottom += scrollY;\n    clientRect.width = 1;\n    margin = element.offsetWidth - element.clientWidth;\n\n    if (margin > 0) {\n      if (before) {\n        margin *= -1;\n      }\n\n      clientRect.left += margin;\n      clientRect.right += margin;\n    }\n\n    return clientRect;\n  };\n\n  var trimInlineCaretContainers = function (root) {\n    var fakeCaretTargetNodes = descendants$1(SugarElement.fromDom(root), inlineFakeCaretSelector);\n\n    for (var i = 0; i < fakeCaretTargetNodes.length; i++) {\n      var node = fakeCaretTargetNodes[i].dom;\n      var sibling = node.previousSibling;\n\n      if (endsWithCaretContainer(sibling)) {\n        var data = sibling.data;\n\n        if (data.length === 1) {\n          sibling.parentNode.removeChild(sibling);\n        } else {\n          sibling.deleteData(data.length - 1, 1);\n        }\n      }\n\n      sibling = node.nextSibling;\n\n      if (startsWithCaretContainer(sibling)) {\n        var data = sibling.data;\n\n        if (data.length === 1) {\n          sibling.parentNode.removeChild(sibling);\n        } else {\n          sibling.deleteData(0, 1);\n        }\n      }\n    }\n  };\n\n  var FakeCaret = function (editor, root, isBlock, hasFocus) {\n    var lastVisualCaret = Cell(Optional.none());\n    var cursorInterval, caretContainerNode;\n    var rootBlock = getForcedRootBlock(editor);\n    var caretBlock = rootBlock.length > 0 ? rootBlock : 'p';\n\n    var show = function (before, element) {\n      var clientRect, rng;\n      hide();\n\n      if (isTableCell$2(element)) {\n        return null;\n      }\n\n      if (isBlock(element)) {\n        caretContainerNode = insertBlock(caretBlock, element, before);\n        clientRect = getAbsoluteClientRect(root, element, before);\n        DomQuery(caretContainerNode).css('top', clientRect.top);\n        var caret = DomQuery('<div class=\"mce-visual-caret\" data-mce-bogus=\"all\"></div>').css(clientRect).appendTo(root)[0];\n        lastVisualCaret.set(Optional.some({\n          caret: caret,\n          element: element,\n          before: before\n        }));\n        lastVisualCaret.get().each(function (caretState) {\n          if (before) {\n            DomQuery(caretState.caret).addClass('mce-visual-caret-before');\n          }\n        });\n        startBlink();\n        rng = element.ownerDocument.createRange();\n        rng.setStart(caretContainerNode, 0);\n        rng.setEnd(caretContainerNode, 0);\n      } else {\n        caretContainerNode = insertInline(element, before);\n        rng = element.ownerDocument.createRange();\n\n        if (isInlineFakeCaretTarget(caretContainerNode.nextSibling)) {\n          rng.setStart(caretContainerNode, 0);\n          rng.setEnd(caretContainerNode, 0);\n        } else {\n          rng.setStart(caretContainerNode, 1);\n          rng.setEnd(caretContainerNode, 1);\n        }\n\n        return rng;\n      }\n\n      return rng;\n    };\n\n    var hide = function () {\n      trimInlineCaretContainers(root);\n\n      if (caretContainerNode) {\n        remove$5(caretContainerNode);\n        caretContainerNode = null;\n      }\n\n      lastVisualCaret.get().each(function (caretState) {\n        DomQuery(caretState.caret).remove();\n        lastVisualCaret.set(Optional.none());\n      });\n\n      if (cursorInterval) {\n        Delay.clearInterval(cursorInterval);\n        cursorInterval = null;\n      }\n    };\n\n    var startBlink = function () {\n      cursorInterval = Delay.setInterval(function () {\n        if (hasFocus()) {\n          DomQuery('div.mce-visual-caret', root).toggleClass('mce-visual-caret-hidden');\n        } else {\n          DomQuery('div.mce-visual-caret', root).addClass('mce-visual-caret-hidden');\n        }\n      }, 500);\n    };\n\n    var reposition = function () {\n      lastVisualCaret.get().each(function (caretState) {\n        var clientRect = getAbsoluteClientRect(root, caretState.element, caretState.before);\n        DomQuery(caretState.caret).css(__assign({}, clientRect));\n      });\n    };\n\n    var destroy = function () {\n      return Delay.clearInterval(cursorInterval);\n    };\n\n    var getCss = function () {\n      return '.mce-visual-caret {' + 'position: absolute;' + 'background-color: black;' + 'background-color: currentcolor;' + '}' + '.mce-visual-caret-hidden {' + 'display: none;' + '}' + '*[data-mce-caret] {' + 'position: absolute;' + 'left: -1000px;' + 'right: auto;' + 'top: 0;' + 'margin: 0;' + 'padding: 0;' + '}';\n    };\n\n    return {\n      show: show,\n      hide: hide,\n      getCss: getCss,\n      reposition: reposition,\n      destroy: destroy\n    };\n  };\n\n  var isFakeCaretTableBrowser = function () {\n    return browser$2.isIE() || browser$2.isEdge() || browser$2.isFirefox();\n  };\n\n  var isInlineFakeCaretTarget = function (node) {\n    return isContentEditableFalse$3(node) || isMedia$1(node);\n  };\n\n  var isFakeCaretTarget = function (node) {\n    return isInlineFakeCaretTarget(node) || isTable(node) && isFakeCaretTableBrowser();\n  };\n\n  var isContentEditableFalse$4 = isContentEditableFalse;\n  var isMedia$2 = isMedia;\n  var isBlockLike = matchStyleValues('display', 'block table table-cell table-caption list-item');\n  var isCaretContainer$2 = isCaretContainer;\n  var isCaretContainerBlock$1 = isCaretContainerBlock;\n  var isElement$5 = isElement$1;\n  var isCaretCandidate$2 = isCaretCandidate;\n\n  var isForwards = function (direction) {\n    return direction > 0;\n  };\n\n  var isBackwards = function (direction) {\n    return direction < 0;\n  };\n\n  var skipCaretContainers = function (walk, shallow) {\n    var node;\n\n    while (node = walk(shallow)) {\n      if (!isCaretContainerBlock$1(node)) {\n        return node;\n      }\n    }\n\n    return null;\n  };\n\n  var findNode = function (node, direction, predicateFn, rootNode, shallow) {\n    var walker = new DomTreeWalker(node, rootNode);\n    var isCefOrCaretContainer = isContentEditableFalse$4(node) || isCaretContainerBlock$1(node);\n\n    if (isBackwards(direction)) {\n      if (isCefOrCaretContainer) {\n        node = skipCaretContainers(walker.prev.bind(walker), true);\n\n        if (predicateFn(node)) {\n          return node;\n        }\n      }\n\n      while (node = skipCaretContainers(walker.prev.bind(walker), shallow)) {\n        if (predicateFn(node)) {\n          return node;\n        }\n      }\n    }\n\n    if (isForwards(direction)) {\n      if (isCefOrCaretContainer) {\n        node = skipCaretContainers(walker.next.bind(walker), true);\n\n        if (predicateFn(node)) {\n          return node;\n        }\n      }\n\n      while (node = skipCaretContainers(walker.next.bind(walker), shallow)) {\n        if (predicateFn(node)) {\n          return node;\n        }\n      }\n    }\n\n    return null;\n  };\n\n  var getParentBlock = function (node, rootNode) {\n    while (node && node !== rootNode) {\n      if (isBlockLike(node)) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var isInSameBlock = function (caretPosition1, caretPosition2, rootNode) {\n    return getParentBlock(caretPosition1.container(), rootNode) === getParentBlock(caretPosition2.container(), rootNode);\n  };\n\n  var getChildNodeAtRelativeOffset = function (relativeOffset, caretPosition) {\n    if (!caretPosition) {\n      return null;\n    }\n\n    var container = caretPosition.container();\n    var offset = caretPosition.offset();\n\n    if (!isElement$5(container)) {\n      return null;\n    }\n\n    return container.childNodes[offset + relativeOffset];\n  };\n\n  var beforeAfter = function (before, node) {\n    var range = node.ownerDocument.createRange();\n\n    if (before) {\n      range.setStartBefore(node);\n      range.setEndBefore(node);\n    } else {\n      range.setStartAfter(node);\n      range.setEndAfter(node);\n    }\n\n    return range;\n  };\n\n  var isNodesInSameBlock = function (root, node1, node2) {\n    return getParentBlock(node1, root) === getParentBlock(node2, root);\n  };\n\n  var lean = function (left, root, node) {\n    var sibling, siblingName;\n\n    if (left) {\n      siblingName = 'previousSibling';\n    } else {\n      siblingName = 'nextSibling';\n    }\n\n    while (node && node !== root) {\n      sibling = node[siblingName];\n\n      if (isCaretContainer$2(sibling)) {\n        sibling = sibling[siblingName];\n      }\n\n      if (isContentEditableFalse$4(sibling) || isMedia$2(sibling)) {\n        if (isNodesInSameBlock(root, sibling, node)) {\n          return sibling;\n        }\n\n        break;\n      }\n\n      if (isCaretCandidate$2(sibling)) {\n        break;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var before$2 = curry(beforeAfter, true);\n  var after$1 = curry(beforeAfter, false);\n\n  var normalizeRange = function (direction, root, range) {\n    var node, container, location;\n    var leanLeft = curry(lean, true, root);\n    var leanRight = curry(lean, false, root);\n    container = range.startContainer;\n    var offset = range.startOffset;\n\n    if (isCaretContainerBlock(container)) {\n      if (!isElement$5(container)) {\n        container = container.parentNode;\n      }\n\n      location = container.getAttribute('data-mce-caret');\n\n      if (location === 'before') {\n        node = container.nextSibling;\n\n        if (isFakeCaretTarget(node)) {\n          return before$2(node);\n        }\n      }\n\n      if (location === 'after') {\n        node = container.previousSibling;\n\n        if (isFakeCaretTarget(node)) {\n          return after$1(node);\n        }\n      }\n    }\n\n    if (!range.collapsed) {\n      return range;\n    }\n\n    if (isText$1(container)) {\n      if (isCaretContainer$2(container)) {\n        if (direction === 1) {\n          node = leanRight(container);\n\n          if (node) {\n            return before$2(node);\n          }\n\n          node = leanLeft(container);\n\n          if (node) {\n            return after$1(node);\n          }\n        }\n\n        if (direction === -1) {\n          node = leanLeft(container);\n\n          if (node) {\n            return after$1(node);\n          }\n\n          node = leanRight(container);\n\n          if (node) {\n            return before$2(node);\n          }\n        }\n\n        return range;\n      }\n\n      if (endsWithCaretContainer(container) && offset >= container.data.length - 1) {\n        if (direction === 1) {\n          node = leanRight(container);\n\n          if (node) {\n            return before$2(node);\n          }\n        }\n\n        return range;\n      }\n\n      if (startsWithCaretContainer(container) && offset <= 1) {\n        if (direction === -1) {\n          node = leanLeft(container);\n\n          if (node) {\n            return after$1(node);\n          }\n        }\n\n        return range;\n      }\n\n      if (offset === container.data.length) {\n        node = leanRight(container);\n\n        if (node) {\n          return before$2(node);\n        }\n\n        return range;\n      }\n\n      if (offset === 0) {\n        node = leanLeft(container);\n\n        if (node) {\n          return after$1(node);\n        }\n\n        return range;\n      }\n    }\n\n    return range;\n  };\n\n  var getRelativeCefElm = function (forward, caretPosition) {\n    return Optional.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, caretPosition)).filter(isContentEditableFalse$4);\n  };\n\n  var getNormalizedRangeEndPoint = function (direction, root, range) {\n    var normalizedRange = normalizeRange(direction, root, range);\n\n    if (direction === -1) {\n      return CaretPosition.fromRangeStart(normalizedRange);\n    }\n\n    return CaretPosition.fromRangeEnd(normalizedRange);\n  };\n\n  var getElementFromPosition = function (pos) {\n    return Optional.from(pos.getNode()).map(SugarElement.fromDom);\n  };\n\n  var getElementFromPrevPosition = function (pos) {\n    return Optional.from(pos.getNode(true)).map(SugarElement.fromDom);\n  };\n\n  var getVisualCaretPosition = function (walkFn, caretPosition) {\n    while (caretPosition = walkFn(caretPosition)) {\n      if (caretPosition.isVisible()) {\n        return caretPosition;\n      }\n    }\n\n    return caretPosition;\n  };\n\n  var isMoveInsideSameBlock = function (from, to) {\n    var inSameBlock = isInSameBlock(from, to);\n\n    if (!inSameBlock && isBr(from.getNode())) {\n      return true;\n    }\n\n    return inSameBlock;\n  };\n\n  var HDirection;\n\n  (function (HDirection) {\n    HDirection[HDirection['Backwards'] = -1] = 'Backwards';\n    HDirection[HDirection['Forwards'] = 1] = 'Forwards';\n  })(HDirection || (HDirection = {}));\n\n  var isContentEditableFalse$5 = isContentEditableFalse;\n  var isText$7 = isText$1;\n  var isElement$6 = isElement$1;\n  var isBr$4 = isBr;\n  var isCaretCandidate$3 = isCaretCandidate;\n  var isAtomic$1 = isAtomic;\n  var isEditableCaretCandidate$1 = isEditableCaretCandidate;\n\n  var getParents = function (node, root) {\n    var parents = [];\n\n    while (node && node !== root) {\n      parents.push(node);\n      node = node.parentNode;\n    }\n\n    return parents;\n  };\n\n  var nodeAtIndex = function (container, offset) {\n    if (container.hasChildNodes() && offset < container.childNodes.length) {\n      return container.childNodes[offset];\n    }\n\n    return null;\n  };\n\n  var getCaretCandidatePosition = function (direction, node) {\n    if (isForwards(direction)) {\n      if (isCaretCandidate$3(node.previousSibling) && !isText$7(node.previousSibling)) {\n        return CaretPosition.before(node);\n      }\n\n      if (isText$7(node)) {\n        return CaretPosition(node, 0);\n      }\n    }\n\n    if (isBackwards(direction)) {\n      if (isCaretCandidate$3(node.nextSibling) && !isText$7(node.nextSibling)) {\n        return CaretPosition.after(node);\n      }\n\n      if (isText$7(node)) {\n        return CaretPosition(node, node.data.length);\n      }\n    }\n\n    if (isBackwards(direction)) {\n      if (isBr$4(node)) {\n        return CaretPosition.before(node);\n      }\n\n      return CaretPosition.after(node);\n    }\n\n    return CaretPosition.before(node);\n  };\n\n  var moveForwardFromBr = function (root, nextNode) {\n    var nextSibling = nextNode.nextSibling;\n\n    if (nextSibling && isCaretCandidate$3(nextSibling)) {\n      if (isText$7(nextSibling)) {\n        return CaretPosition(nextSibling, 0);\n      } else {\n        return CaretPosition.before(nextSibling);\n      }\n    } else {\n      return findCaretPosition(HDirection.Forwards, CaretPosition.after(nextNode), root);\n    }\n  };\n\n  var findCaretPosition = function (direction, startPos, root) {\n    var node, nextNode, innerNode;\n    var caretPosition;\n\n    if (!isElement$6(root) || !startPos) {\n      return null;\n    }\n\n    if (startPos.isEqual(CaretPosition.after(root)) && root.lastChild) {\n      caretPosition = CaretPosition.after(root.lastChild);\n\n      if (isBackwards(direction) && isCaretCandidate$3(root.lastChild) && isElement$6(root.lastChild)) {\n        return isBr$4(root.lastChild) ? CaretPosition.before(root.lastChild) : caretPosition;\n      }\n    } else {\n      caretPosition = startPos;\n    }\n\n    var container = caretPosition.container();\n    var offset = caretPosition.offset();\n\n    if (isText$7(container)) {\n      if (isBackwards(direction) && offset > 0) {\n        return CaretPosition(container, --offset);\n      }\n\n      if (isForwards(direction) && offset < container.length) {\n        return CaretPosition(container, ++offset);\n      }\n\n      node = container;\n    } else {\n      if (isBackwards(direction) && offset > 0) {\n        nextNode = nodeAtIndex(container, offset - 1);\n\n        if (isCaretCandidate$3(nextNode)) {\n          if (!isAtomic$1(nextNode)) {\n            innerNode = findNode(nextNode, direction, isEditableCaretCandidate$1, nextNode);\n\n            if (innerNode) {\n              if (isText$7(innerNode)) {\n                return CaretPosition(innerNode, innerNode.data.length);\n              }\n\n              return CaretPosition.after(innerNode);\n            }\n          }\n\n          if (isText$7(nextNode)) {\n            return CaretPosition(nextNode, nextNode.data.length);\n          }\n\n          return CaretPosition.before(nextNode);\n        }\n      }\n\n      if (isForwards(direction) && offset < container.childNodes.length) {\n        nextNode = nodeAtIndex(container, offset);\n\n        if (isCaretCandidate$3(nextNode)) {\n          if (isBr$4(nextNode)) {\n            return moveForwardFromBr(root, nextNode);\n          }\n\n          if (!isAtomic$1(nextNode)) {\n            innerNode = findNode(nextNode, direction, isEditableCaretCandidate$1, nextNode);\n\n            if (innerNode) {\n              if (isText$7(innerNode)) {\n                return CaretPosition(innerNode, 0);\n              }\n\n              return CaretPosition.before(innerNode);\n            }\n          }\n\n          if (isText$7(nextNode)) {\n            return CaretPosition(nextNode, 0);\n          }\n\n          return CaretPosition.after(nextNode);\n        }\n      }\n\n      node = nextNode ? nextNode : caretPosition.getNode();\n    }\n\n    if (isForwards(direction) && caretPosition.isAtEnd() || isBackwards(direction) && caretPosition.isAtStart()) {\n      node = findNode(node, direction, always, root, true);\n\n      if (isEditableCaretCandidate$1(node, root)) {\n        return getCaretCandidatePosition(direction, node);\n      }\n    }\n\n    nextNode = findNode(node, direction, isEditableCaretCandidate$1, root);\n    var rootContentEditableFalseElm = last$1(filter(getParents(container, root), isContentEditableFalse$5));\n\n    if (rootContentEditableFalseElm && (!nextNode || !rootContentEditableFalseElm.contains(nextNode))) {\n      if (isForwards(direction)) {\n        caretPosition = CaretPosition.after(rootContentEditableFalseElm);\n      } else {\n        caretPosition = CaretPosition.before(rootContentEditableFalseElm);\n      }\n\n      return caretPosition;\n    }\n\n    if (nextNode) {\n      return getCaretCandidatePosition(direction, nextNode);\n    }\n\n    return null;\n  };\n\n  var CaretWalker = function (root) {\n    return {\n      next: function (caretPosition) {\n        return findCaretPosition(HDirection.Forwards, caretPosition, root);\n      },\n      prev: function (caretPosition) {\n        return findCaretPosition(HDirection.Backwards, caretPosition, root);\n      }\n    };\n  };\n\n  var walkToPositionIn = function (forward, root, start) {\n    var position = forward ? CaretPosition.before(start) : CaretPosition.after(start);\n    return fromPosition(forward, root, position);\n  };\n\n  var afterElement = function (node) {\n    return isBr(node) ? CaretPosition.before(node) : CaretPosition.after(node);\n  };\n\n  var isBeforeOrStart = function (position) {\n    if (CaretPosition.isTextPosition(position)) {\n      return position.offset() === 0;\n    } else {\n      return isCaretCandidate(position.getNode());\n    }\n  };\n\n  var isAfterOrEnd = function (position) {\n    if (CaretPosition.isTextPosition(position)) {\n      var container = position.container();\n      return position.offset() === container.data.length;\n    } else {\n      return isCaretCandidate(position.getNode(true));\n    }\n  };\n\n  var isBeforeAfterSameElement = function (from, to) {\n    return !CaretPosition.isTextPosition(from) && !CaretPosition.isTextPosition(to) && from.getNode() === to.getNode(true);\n  };\n\n  var isAtBr = function (position) {\n    return !CaretPosition.isTextPosition(position) && isBr(position.getNode());\n  };\n\n  var shouldSkipPosition = function (forward, from, to) {\n    if (forward) {\n      return !isBeforeAfterSameElement(from, to) && !isAtBr(from) && isAfterOrEnd(from) && isBeforeOrStart(to);\n    } else {\n      return !isBeforeAfterSameElement(to, from) && isBeforeOrStart(from) && isAfterOrEnd(to);\n    }\n  };\n\n  var fromPosition = function (forward, root, pos) {\n    var walker = CaretWalker(root);\n    return Optional.from(forward ? walker.next(pos) : walker.prev(pos));\n  };\n\n  var navigate = function (forward, root, from) {\n    return fromPosition(forward, root, from).bind(function (to) {\n      if (isInSameBlock(from, to, root) && shouldSkipPosition(forward, from, to)) {\n        return fromPosition(forward, root, to);\n      } else {\n        return Optional.some(to);\n      }\n    });\n  };\n\n  var navigateIgnore = function (forward, root, from, ignoreFilter) {\n    return navigate(forward, root, from).bind(function (pos) {\n      return ignoreFilter(pos) ? navigateIgnore(forward, root, pos, ignoreFilter) : Optional.some(pos);\n    });\n  };\n\n  var positionIn = function (forward, element) {\n    var startNode = forward ? element.firstChild : element.lastChild;\n\n    if (isText$1(startNode)) {\n      return Optional.some(CaretPosition(startNode, forward ? 0 : startNode.data.length));\n    } else if (startNode) {\n      if (isCaretCandidate(startNode)) {\n        return Optional.some(forward ? CaretPosition.before(startNode) : afterElement(startNode));\n      } else {\n        return walkToPositionIn(forward, element, startNode);\n      }\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var nextPosition = curry(fromPosition, true);\n  var prevPosition = curry(fromPosition, false);\n  var firstPositionIn = curry(positionIn, true);\n  var lastPositionIn = curry(positionIn, false);\n  var CARET_ID = '_mce_caret';\n\n  var isCaretNode = function (node) {\n    return isElement$1(node) && node.id === CARET_ID;\n  };\n\n  var getParentCaretContainer = function (body, node) {\n    while (node && node !== body) {\n      if (node.id === CARET_ID) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var isStringPathBookmark = function (bookmark) {\n    return isString(bookmark.start);\n  };\n\n  var isRangeBookmark = function (bookmark) {\n    return bookmark.hasOwnProperty('rng');\n  };\n\n  var isIdBookmark = function (bookmark) {\n    return bookmark.hasOwnProperty('id');\n  };\n\n  var isIndexBookmark = function (bookmark) {\n    return bookmark.hasOwnProperty('name');\n  };\n\n  var isPathBookmark = function (bookmark) {\n    return Tools.isArray(bookmark.start);\n  };\n\n  var addBogus = function (dom, node) {\n    if (isElement$1(node) && dom.isBlock(node) && !node.innerHTML && !Env.ie) {\n      node.innerHTML = '<br data-mce-bogus=\"1\" />';\n    }\n\n    return node;\n  };\n\n  var resolveCaretPositionBookmark = function (dom, bookmark) {\n    var pos;\n    var rng = dom.createRng();\n    pos = resolve$1(dom.getRoot(), bookmark.start);\n    rng.setStart(pos.container(), pos.offset());\n    pos = resolve$1(dom.getRoot(), bookmark.end);\n    rng.setEnd(pos.container(), pos.offset());\n    return rng;\n  };\n\n  var insertZwsp = function (node, rng) {\n    var textNode = node.ownerDocument.createTextNode(ZWSP);\n    node.appendChild(textNode);\n    rng.setStart(textNode, 0);\n    rng.setEnd(textNode, 0);\n  };\n\n  var isEmpty$1 = function (node) {\n    return node.hasChildNodes() === false;\n  };\n\n  var tryFindRangePosition = function (node, rng) {\n    return lastPositionIn(node).fold(never, function (pos) {\n      rng.setStart(pos.container(), pos.offset());\n      rng.setEnd(pos.container(), pos.offset());\n      return true;\n    });\n  };\n\n  var padEmptyCaretContainer = function (root, node, rng) {\n    if (isEmpty$1(node) && getParentCaretContainer(root, node)) {\n      insertZwsp(node, rng);\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var setEndPoint = function (dom, start, bookmark, rng) {\n    var point = bookmark[start ? 'start' : 'end'];\n    var i, node, offset, children;\n    var root = dom.getRoot();\n\n    if (point) {\n      offset = point[0];\n\n      for (node = root, i = point.length - 1; i >= 1; i--) {\n        children = node.childNodes;\n\n        if (padEmptyCaretContainer(root, node, rng)) {\n          return true;\n        }\n\n        if (point[i] > children.length - 1) {\n          if (padEmptyCaretContainer(root, node, rng)) {\n            return true;\n          }\n\n          return tryFindRangePosition(node, rng);\n        }\n\n        node = children[point[i]];\n      }\n\n      if (node.nodeType === 3) {\n        offset = Math.min(point[0], node.nodeValue.length);\n      }\n\n      if (node.nodeType === 1) {\n        offset = Math.min(point[0], node.childNodes.length);\n      }\n\n      if (start) {\n        rng.setStart(node, offset);\n      } else {\n        rng.setEnd(node, offset);\n      }\n    }\n\n    return true;\n  };\n\n  var isValidTextNode = function (node) {\n    return isText$1(node) && node.data.length > 0;\n  };\n\n  var restoreEndPoint = function (dom, suffix, bookmark) {\n    var marker = dom.get(bookmark.id + '_' + suffix),\n        node,\n        idx,\n        next,\n        prev;\n    var keep = bookmark.keep;\n    var container, offset;\n\n    if (marker) {\n      node = marker.parentNode;\n\n      if (suffix === 'start') {\n        if (!keep) {\n          idx = dom.nodeIndex(marker);\n        } else {\n          if (marker.hasChildNodes()) {\n            node = marker.firstChild;\n            idx = 1;\n          } else if (isValidTextNode(marker.nextSibling)) {\n            node = marker.nextSibling;\n            idx = 0;\n          } else if (isValidTextNode(marker.previousSibling)) {\n            node = marker.previousSibling;\n            idx = marker.previousSibling.data.length;\n          } else {\n            node = marker.parentNode;\n            idx = dom.nodeIndex(marker) + 1;\n          }\n        }\n\n        container = node;\n        offset = idx;\n      } else {\n        if (!keep) {\n          idx = dom.nodeIndex(marker);\n        } else {\n          if (marker.hasChildNodes()) {\n            node = marker.firstChild;\n            idx = 1;\n          } else if (isValidTextNode(marker.previousSibling)) {\n            node = marker.previousSibling;\n            idx = marker.previousSibling.data.length;\n          } else {\n            node = marker.parentNode;\n            idx = dom.nodeIndex(marker);\n          }\n        }\n\n        container = node;\n        offset = idx;\n      }\n\n      if (!keep) {\n        prev = marker.previousSibling;\n        next = marker.nextSibling;\n        Tools.each(Tools.grep(marker.childNodes), function (node) {\n          if (isText$1(node)) {\n            node.nodeValue = node.nodeValue.replace(/\\uFEFF/g, '');\n          }\n        });\n\n        while (marker = dom.get(bookmark.id + '_' + suffix)) {\n          dom.remove(marker, true);\n        }\n\n        if (prev && next && prev.nodeType === next.nodeType && isText$1(prev) && !Env.opera) {\n          idx = prev.nodeValue.length;\n          prev.appendData(next.nodeValue);\n          dom.remove(next);\n          container = prev;\n          offset = idx;\n        }\n      }\n\n      return Optional.some(CaretPosition(container, offset));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var resolvePaths = function (dom, bookmark) {\n    var rng = dom.createRng();\n\n    if (setEndPoint(dom, true, bookmark, rng) && setEndPoint(dom, false, bookmark, rng)) {\n      return Optional.some(rng);\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var resolveId = function (dom, bookmark) {\n    var startPos = restoreEndPoint(dom, 'start', bookmark);\n    var endPos = restoreEndPoint(dom, 'end', bookmark);\n    return lift2(startPos, endPos.or(startPos), function (spos, epos) {\n      var rng = dom.createRng();\n      rng.setStart(addBogus(dom, spos.container()), spos.offset());\n      rng.setEnd(addBogus(dom, epos.container()), epos.offset());\n      return rng;\n    });\n  };\n\n  var resolveIndex$1 = function (dom, bookmark) {\n    return Optional.from(dom.select(bookmark.name)[bookmark.index]).map(function (elm) {\n      var rng = dom.createRng();\n      rng.selectNode(elm);\n      return rng;\n    });\n  };\n\n  var resolve$2 = function (selection, bookmark) {\n    var dom = selection.dom;\n\n    if (bookmark) {\n      if (isPathBookmark(bookmark)) {\n        return resolvePaths(dom, bookmark);\n      } else if (isStringPathBookmark(bookmark)) {\n        return Optional.some(resolveCaretPositionBookmark(dom, bookmark));\n      } else if (isIdBookmark(bookmark)) {\n        return resolveId(dom, bookmark);\n      } else if (isIndexBookmark(bookmark)) {\n        return resolveIndex$1(dom, bookmark);\n      } else if (isRangeBookmark(bookmark)) {\n        return Optional.some(bookmark.rng);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var getBookmark$1 = function (selection, type, normalized) {\n    return getBookmark(selection, type, normalized);\n  };\n\n  var moveToBookmark = function (selection, bookmark) {\n    resolve$2(selection, bookmark).each(function (rng) {\n      selection.setRng(rng);\n    });\n  };\n\n  var isBookmarkNode$1 = function (node) {\n    return isElement$1(node) && node.tagName === 'SPAN' && node.getAttribute('data-mce-type') === 'bookmark';\n  };\n\n  var is$2 = function (expected) {\n    return function (actual) {\n      return expected === actual;\n    };\n  };\n\n  var isNbsp = is$2(nbsp);\n\n  var isWhiteSpace$1 = function (chr) {\n    return chr !== '' && ' \\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n  };\n\n  var isContent$1 = function (chr) {\n    return !isWhiteSpace$1(chr) && !isNbsp(chr);\n  };\n\n  var isNode = function (node) {\n    return !!node.nodeType;\n  };\n\n  var isInlineBlock = function (node) {\n    return node && /^(IMG)$/.test(node.nodeName);\n  };\n\n  var moveStart = function (dom, selection, rng) {\n    var offset = rng.startOffset;\n    var container = rng.startContainer,\n        walker,\n        node,\n        nodes;\n\n    if (rng.startContainer === rng.endContainer) {\n      if (isInlineBlock(rng.startContainer.childNodes[rng.startOffset])) {\n        return;\n      }\n    }\n\n    if (container.nodeType === 1) {\n      nodes = container.childNodes;\n\n      if (offset < nodes.length) {\n        container = nodes[offset];\n        walker = new DomTreeWalker(container, dom.getParent(container, dom.isBlock));\n      } else {\n        container = nodes[nodes.length - 1];\n        walker = new DomTreeWalker(container, dom.getParent(container, dom.isBlock));\n        walker.next(true);\n      }\n\n      for (node = walker.current(); node; node = walker.next()) {\n        if (node.nodeType === 3 && !isWhiteSpaceNode(node)) {\n          rng.setStart(node, 0);\n          selection.setRng(rng);\n          return;\n        }\n      }\n    }\n  };\n\n  var getNonWhiteSpaceSibling = function (node, next, inc) {\n    if (node) {\n      var nextName = next ? 'nextSibling' : 'previousSibling';\n\n      for (node = inc ? node : node[nextName]; node; node = node[nextName]) {\n        if (node.nodeType === 1 || !isWhiteSpaceNode(node)) {\n          return node;\n        }\n      }\n    }\n  };\n\n  var isTextBlock$1 = function (editor, name) {\n    if (isNode(name)) {\n      name = name.nodeName;\n    }\n\n    return !!editor.schema.getTextBlockElements()[name.toLowerCase()];\n  };\n\n  var isValid = function (ed, parent, child) {\n    return ed.schema.isValidChild(parent, child);\n  };\n\n  var isWhiteSpaceNode = function (node, allowSpaces) {\n    if (allowSpaces === void 0) {\n      allowSpaces = false;\n    }\n\n    if (isNonNullable(node) && isText$1(node)) {\n      var data = allowSpaces ? node.data.replace(/ /g, '\\xA0') : node.data;\n      return isWhitespaceText(data);\n    } else {\n      return false;\n    }\n  };\n\n  var isEmptyTextNode = function (node) {\n    return isNonNullable(node) && isText$1(node) && node.length === 0;\n  };\n\n  var replaceVars = function (value, vars) {\n    if (typeof value !== 'string') {\n      value = value(vars);\n    } else if (vars) {\n      value = value.replace(/%(\\w+)/g, function (str, name) {\n        return vars[name] || str;\n      });\n    }\n\n    return value;\n  };\n\n  var isEq = function (str1, str2) {\n    str1 = str1 || '';\n    str2 = str2 || '';\n    str1 = '' + (str1.nodeName || str1);\n    str2 = '' + (str2.nodeName || str2);\n    return str1.toLowerCase() === str2.toLowerCase();\n  };\n\n  var normalizeStyleValue = function (dom, value, name) {\n    if (name === 'color' || name === 'backgroundColor') {\n      value = dom.toHex(value);\n    }\n\n    if (name === 'fontWeight' && value === 700) {\n      value = 'bold';\n    }\n\n    if (name === 'fontFamily') {\n      value = value.replace(/[\\'\\\"]/g, '').replace(/,\\s+/g, ',');\n    }\n\n    return '' + value;\n  };\n\n  var getStyle = function (dom, node, name) {\n    return normalizeStyleValue(dom, dom.getStyle(node, name), name);\n  };\n\n  var getTextDecoration = function (dom, node) {\n    var decoration;\n    dom.getParent(node, function (n) {\n      decoration = dom.getStyle(n, 'text-decoration');\n      return decoration && decoration !== 'none';\n    });\n    return decoration;\n  };\n\n  var getParents$1 = function (dom, node, selector) {\n    return dom.getParents(node, selector, dom.getRoot());\n  };\n\n  var isVariableFormatName = function (editor, formatName) {\n    var hasVariableValues = function (format) {\n      var isVariableValue = function (val) {\n        return val.length > 1 && val.charAt(0) === '%';\n      };\n\n      return exists(['styles', 'attributes'], function (key) {\n        return get$1(format, key).exists(function (field) {\n          var fieldValues = isArray(field) ? field : values(field);\n          return exists(fieldValues, isVariableValue);\n        });\n      });\n    };\n\n    return exists(editor.formatter.get(formatName), hasVariableValues);\n  };\n\n  var areSimilarFormats = function (editor, formatName, otherFormatName) {\n    var validKeys = ['inline', 'block', 'selector', 'attributes', 'styles', 'classes'];\n\n    var filterObj = function (format) {\n      return filter$1(format, function (_, key) {\n        return exists(validKeys, function (validKey) {\n          return validKey === key;\n        });\n      });\n    };\n\n    return exists(editor.formatter.get(formatName), function (fmt1) {\n      var filteredFmt1 = filterObj(fmt1);\n      return exists(editor.formatter.get(otherFormatName), function (fmt2) {\n        var filteredFmt2 = filterObj(fmt2);\n        return equal(filteredFmt1, filteredFmt2);\n      });\n    });\n  };\n\n  var isBlockFormat = function (format) {\n    return hasNonNullableKey(format, 'block');\n  };\n\n  var isSelectorFormat = function (format) {\n    return hasNonNullableKey(format, 'selector');\n  };\n\n  var isInlineFormat = function (format) {\n    return hasNonNullableKey(format, 'inline');\n  };\n\n  var isBookmarkNode$2 = isBookmarkNode$1;\n  var getParents$2 = getParents$1;\n  var isWhiteSpaceNode$1 = isWhiteSpaceNode;\n  var isTextBlock$2 = isTextBlock$1;\n\n  var isBogusBr = function (node) {\n    return isBr(node) && node.getAttribute('data-mce-bogus') && !node.nextSibling;\n  };\n\n  var findParentContentEditable = function (dom, node) {\n    var parent = node;\n\n    while (parent) {\n      if (isElement$1(parent) && dom.getContentEditable(parent)) {\n        return dom.getContentEditable(parent) === 'false' ? parent : node;\n      }\n\n      parent = parent.parentNode;\n    }\n\n    return node;\n  };\n\n  var walkText = function (start, node, offset, predicate) {\n    var str = node.data;\n\n    for (var i = offset; start ? i >= 0 : i < str.length; start ? i-- : i++) {\n      if (predicate(str.charAt(i))) {\n        return start ? i + 1 : i;\n      }\n    }\n\n    return -1;\n  };\n\n  var findSpace = function (start, node, offset) {\n    return walkText(start, node, offset, function (c) {\n      return isNbsp(c) || isWhiteSpace$1(c);\n    });\n  };\n\n  var findContent = function (start, node, offset) {\n    return walkText(start, node, offset, isContent$1);\n  };\n\n  var findWordEndPoint = function (dom, body, container, offset, start, includeTrailingSpaces) {\n    var lastTextNode;\n    var rootNode = dom.getParent(container, dom.isBlock) || body;\n\n    var walk = function (container, offset, pred) {\n      var textSeeker = TextSeeker(dom);\n      var walker = start ? textSeeker.backwards : textSeeker.forwards;\n      return Optional.from(walker(container, offset, function (text, textOffset) {\n        if (isBookmarkNode$2(text.parentNode)) {\n          return -1;\n        } else {\n          lastTextNode = text;\n          return pred(start, text, textOffset);\n        }\n      }, rootNode));\n    };\n\n    var spaceResult = walk(container, offset, findSpace);\n    return spaceResult.bind(function (result) {\n      return includeTrailingSpaces ? walk(result.container, result.offset + (start ? -1 : 0), findContent) : Optional.some(result);\n    }).orThunk(function () {\n      return lastTextNode ? Optional.some({\n        container: lastTextNode,\n        offset: start ? 0 : lastTextNode.length\n      }) : Optional.none();\n    });\n  };\n\n  var findSelectorEndPoint = function (dom, format, rng, container, siblingName) {\n    if (isText$1(container) && container.nodeValue.length === 0 && container[siblingName]) {\n      container = container[siblingName];\n    }\n\n    var parents = getParents$2(dom, container);\n\n    for (var i = 0; i < parents.length; i++) {\n      for (var y = 0; y < format.length; y++) {\n        var curFormat = format[y];\n\n        if ('collapsed' in curFormat && curFormat.collapsed !== rng.collapsed) {\n          continue;\n        }\n\n        if (dom.is(parents[i], curFormat.selector)) {\n          return parents[i];\n        }\n      }\n    }\n\n    return container;\n  };\n\n  var findBlockEndPoint = function (editor, format, container, siblingName) {\n    var node;\n    var dom = editor.dom;\n    var root = dom.getRoot();\n\n    if (!format[0].wrapper) {\n      node = dom.getParent(container, format[0].block, root);\n    }\n\n    if (!node) {\n      var scopeRoot = dom.getParent(container, 'LI,TD,TH');\n      node = dom.getParent(isText$1(container) ? container.parentNode : container, function (node) {\n        return node !== root && isTextBlock$2(editor, node);\n      }, scopeRoot);\n    }\n\n    if (node && format[0].wrapper) {\n      node = getParents$2(dom, node, 'ul,ol').reverse()[0] || node;\n    }\n\n    if (!node) {\n      node = container;\n\n      while (node[siblingName] && !dom.isBlock(node[siblingName])) {\n        node = node[siblingName];\n\n        if (isEq(node, 'br')) {\n          break;\n        }\n      }\n    }\n\n    return node || container;\n  };\n\n  var isAtBlockBoundary = function (dom, root, container, siblingName) {\n    var parent = container.parentNode;\n\n    if (isNonNullable(container[siblingName])) {\n      return false;\n    } else if (parent === root || isNullable(parent) || dom.isBlock(parent)) {\n      return true;\n    } else {\n      return isAtBlockBoundary(dom, root, parent, siblingName);\n    }\n  };\n\n  var findParentContainer = function (dom, format, container, offset, start) {\n    var parent = container;\n    var sibling;\n    var siblingName = start ? 'previousSibling' : 'nextSibling';\n    var root = dom.getRoot();\n\n    if (isText$1(container) && !isWhiteSpaceNode$1(container)) {\n      if (start ? offset > 0 : offset < container.data.length) {\n        return container;\n      }\n    }\n\n    while (true) {\n      if (!format[0].block_expand && dom.isBlock(parent)) {\n        return parent;\n      }\n\n      for (sibling = parent[siblingName]; sibling; sibling = sibling[siblingName]) {\n        var allowSpaces = isText$1(sibling) && !isAtBlockBoundary(dom, root, sibling, siblingName);\n\n        if (!isBookmarkNode$2(sibling) && !isBogusBr(sibling) && !isWhiteSpaceNode$1(sibling, allowSpaces)) {\n          return parent;\n        }\n      }\n\n      if (parent === root || parent.parentNode === root) {\n        container = parent;\n        break;\n      }\n\n      parent = parent.parentNode;\n    }\n\n    return container;\n  };\n\n  var isSelfOrParentBookmark = function (container) {\n    return isBookmarkNode$2(container.parentNode) || isBookmarkNode$2(container);\n  };\n\n  var expandRng = function (editor, rng, format, includeTrailingSpace) {\n    if (includeTrailingSpace === void 0) {\n      includeTrailingSpace = false;\n    }\n\n    var startContainer = rng.startContainer,\n        startOffset = rng.startOffset,\n        endContainer = rng.endContainer,\n        endOffset = rng.endOffset;\n    var dom = editor.dom;\n\n    if (isElement$1(startContainer) && startContainer.hasChildNodes()) {\n      startContainer = getNode(startContainer, startOffset);\n\n      if (isText$1(startContainer)) {\n        startOffset = 0;\n      }\n    }\n\n    if (isElement$1(endContainer) && endContainer.hasChildNodes()) {\n      endContainer = getNode(endContainer, rng.collapsed ? endOffset : endOffset - 1);\n\n      if (isText$1(endContainer)) {\n        endOffset = endContainer.nodeValue.length;\n      }\n    }\n\n    startContainer = findParentContentEditable(dom, startContainer);\n    endContainer = findParentContentEditable(dom, endContainer);\n\n    if (isSelfOrParentBookmark(startContainer)) {\n      startContainer = isBookmarkNode$2(startContainer) ? startContainer : startContainer.parentNode;\n\n      if (rng.collapsed) {\n        startContainer = startContainer.previousSibling || startContainer;\n      } else {\n        startContainer = startContainer.nextSibling || startContainer;\n      }\n\n      if (isText$1(startContainer)) {\n        startOffset = rng.collapsed ? startContainer.length : 0;\n      }\n    }\n\n    if (isSelfOrParentBookmark(endContainer)) {\n      endContainer = isBookmarkNode$2(endContainer) ? endContainer : endContainer.parentNode;\n\n      if (rng.collapsed) {\n        endContainer = endContainer.nextSibling || endContainer;\n      } else {\n        endContainer = endContainer.previousSibling || endContainer;\n      }\n\n      if (isText$1(endContainer)) {\n        endOffset = rng.collapsed ? 0 : endContainer.length;\n      }\n    }\n\n    if (rng.collapsed) {\n      var startPoint = findWordEndPoint(dom, editor.getBody(), startContainer, startOffset, true, includeTrailingSpace);\n      startPoint.each(function (_a) {\n        var container = _a.container,\n            offset = _a.offset;\n        startContainer = container;\n        startOffset = offset;\n      });\n      var endPoint = findWordEndPoint(dom, editor.getBody(), endContainer, endOffset, false, includeTrailingSpace);\n      endPoint.each(function (_a) {\n        var container = _a.container,\n            offset = _a.offset;\n        endContainer = container;\n        endOffset = offset;\n      });\n    }\n\n    if (format[0].inline || format[0].block_expand) {\n      if (!format[0].inline || !isText$1(startContainer) || startOffset === 0) {\n        startContainer = findParentContainer(dom, format, startContainer, startOffset, true);\n      }\n\n      if (!format[0].inline || !isText$1(endContainer) || endOffset === endContainer.nodeValue.length) {\n        endContainer = findParentContainer(dom, format, endContainer, endOffset, false);\n      }\n    }\n\n    if (format[0].selector && format[0].expand !== false && !format[0].inline) {\n      startContainer = findSelectorEndPoint(dom, format, rng, startContainer, 'previousSibling');\n      endContainer = findSelectorEndPoint(dom, format, rng, endContainer, 'nextSibling');\n    }\n\n    if (format[0].block || format[0].selector) {\n      startContainer = findBlockEndPoint(editor, format, startContainer, 'previousSibling');\n      endContainer = findBlockEndPoint(editor, format, endContainer, 'nextSibling');\n\n      if (format[0].block) {\n        if (!dom.isBlock(startContainer)) {\n          startContainer = findParentContainer(dom, format, startContainer, startOffset, true);\n        }\n\n        if (!dom.isBlock(endContainer)) {\n          endContainer = findParentContainer(dom, format, endContainer, endOffset, false);\n        }\n      }\n    }\n\n    if (isElement$1(startContainer)) {\n      startOffset = dom.nodeIndex(startContainer);\n      startContainer = startContainer.parentNode;\n    }\n\n    if (isElement$1(endContainer)) {\n      endOffset = dom.nodeIndex(endContainer) + 1;\n      endContainer = endContainer.parentNode;\n    }\n\n    return {\n      startContainer: startContainer,\n      startOffset: startOffset,\n      endContainer: endContainer,\n      endOffset: endOffset\n    };\n  };\n\n  var clampToExistingChildren = function (container, index) {\n    var childNodes = container.childNodes;\n\n    if (index >= childNodes.length) {\n      index = childNodes.length - 1;\n    } else if (index < 0) {\n      index = 0;\n    }\n\n    return childNodes[index] || container;\n  };\n\n  var getEndChild = function (container, index) {\n    return clampToExistingChildren(container, index - 1);\n  };\n\n  var walk$1 = function (dom, rng, callback) {\n    var startContainer = rng.startContainer;\n    var startOffset = rng.startOffset;\n    var endContainer = rng.endContainer;\n    var endOffset = rng.endOffset;\n\n    var exclude = function (nodes) {\n      var node;\n      node = nodes[0];\n\n      if (node.nodeType === 3 && node === startContainer && startOffset >= node.nodeValue.length) {\n        nodes.splice(0, 1);\n      }\n\n      node = nodes[nodes.length - 1];\n\n      if (endOffset === 0 && nodes.length > 0 && node === endContainer && node.nodeType === 3) {\n        nodes.splice(nodes.length - 1, 1);\n      }\n\n      return nodes;\n    };\n\n    var collectSiblings = function (node, name, endNode) {\n      var siblings = [];\n\n      for (; node && node !== endNode; node = node[name]) {\n        siblings.push(node);\n      }\n\n      return siblings;\n    };\n\n    var findEndPoint = function (node, root) {\n      do {\n        if (node.parentNode === root) {\n          return node;\n        }\n\n        node = node.parentNode;\n      } while (node);\n    };\n\n    var walkBoundary = function (startNode, endNode, next) {\n      var siblingName = next ? 'nextSibling' : 'previousSibling';\n\n      for (var node = startNode, parent_1 = node.parentNode; node && node !== endNode; node = parent_1) {\n        parent_1 = node.parentNode;\n        var siblings_1 = collectSiblings(node === startNode ? node : node[siblingName], siblingName);\n\n        if (siblings_1.length) {\n          if (!next) {\n            siblings_1.reverse();\n          }\n\n          callback(exclude(siblings_1));\n        }\n      }\n    };\n\n    if (startContainer.nodeType === 1 && startContainer.hasChildNodes()) {\n      startContainer = clampToExistingChildren(startContainer, startOffset);\n    }\n\n    if (endContainer.nodeType === 1 && endContainer.hasChildNodes()) {\n      endContainer = getEndChild(endContainer, endOffset);\n    }\n\n    if (startContainer === endContainer) {\n      return callback(exclude([startContainer]));\n    }\n\n    var ancestor = dom.findCommonAncestor(startContainer, endContainer);\n\n    for (var node = startContainer; node; node = node.parentNode) {\n      if (node === endContainer) {\n        return walkBoundary(startContainer, ancestor, true);\n      }\n\n      if (node === ancestor) {\n        break;\n      }\n    }\n\n    for (var node = endContainer; node; node = node.parentNode) {\n      if (node === startContainer) {\n        return walkBoundary(endContainer, ancestor);\n      }\n\n      if (node === ancestor) {\n        break;\n      }\n    }\n\n    var startPoint = findEndPoint(startContainer, ancestor) || startContainer;\n    var endPoint = findEndPoint(endContainer, ancestor) || endContainer;\n    walkBoundary(startContainer, startPoint, true);\n    var siblings = collectSiblings(startPoint === startContainer ? startPoint : startPoint.nextSibling, 'nextSibling', endPoint === endContainer ? endPoint.nextSibling : endPoint);\n\n    if (siblings.length) {\n      callback(exclude(siblings));\n    }\n\n    walkBoundary(endContainer, endPoint);\n  };\n\n  var getRanges = function (selection) {\n    var ranges = [];\n\n    if (selection) {\n      for (var i = 0; i < selection.rangeCount; i++) {\n        ranges.push(selection.getRangeAt(i));\n      }\n    }\n\n    return ranges;\n  };\n\n  var getSelectedNodes = function (ranges) {\n    return bind(ranges, function (range) {\n      var node = getSelectedNode(range);\n      return node ? [SugarElement.fromDom(node)] : [];\n    });\n  };\n\n  var hasMultipleRanges = function (selection) {\n    return getRanges(selection).length > 1;\n  };\n\n  var getCellsFromRanges = function (ranges) {\n    return filter(getSelectedNodes(ranges), isTableCell$1);\n  };\n\n  var getCellsFromElement = function (elm) {\n    return descendants$1(elm, 'td[data-mce-selected],th[data-mce-selected]');\n  };\n\n  var getCellsFromElementOrRanges = function (ranges, element) {\n    var selectedCells = getCellsFromElement(element);\n    return selectedCells.length > 0 ? selectedCells : getCellsFromRanges(ranges);\n  };\n\n  var getCellsFromEditor = function (editor) {\n    return getCellsFromElementOrRanges(getRanges(editor.selection.getSel()), SugarElement.fromDom(editor.getBody()));\n  };\n\n  var getStartNode = function (rng) {\n    var sc = rng.startContainer,\n        so = rng.startOffset;\n\n    if (isText$1(sc)) {\n      return so === 0 ? Optional.some(SugarElement.fromDom(sc)) : Optional.none();\n    } else {\n      return Optional.from(sc.childNodes[so]).map(SugarElement.fromDom);\n    }\n  };\n\n  var getEndNode = function (rng) {\n    var ec = rng.endContainer,\n        eo = rng.endOffset;\n\n    if (isText$1(ec)) {\n      return eo === ec.data.length ? Optional.some(SugarElement.fromDom(ec)) : Optional.none();\n    } else {\n      return Optional.from(ec.childNodes[eo - 1]).map(SugarElement.fromDom);\n    }\n  };\n\n  var getFirstChildren = function (node) {\n    return firstChild(node).fold(constant([node]), function (child) {\n      return [node].concat(getFirstChildren(child));\n    });\n  };\n\n  var getLastChildren = function (node) {\n    return lastChild(node).fold(constant([node]), function (child) {\n      if (name(child) === 'br') {\n        return prevSibling(child).map(function (sibling) {\n          return [node].concat(getLastChildren(sibling));\n        }).getOr([]);\n      } else {\n        return [node].concat(getLastChildren(child));\n      }\n    });\n  };\n\n  var hasAllContentsSelected = function (elm, rng) {\n    return lift2(getStartNode(rng), getEndNode(rng), function (startNode, endNode) {\n      var start = find(getFirstChildren(elm), curry(eq$2, startNode));\n      var end = find(getLastChildren(elm), curry(eq$2, endNode));\n      return start.isSome() && end.isSome();\n    }).getOr(false);\n  };\n\n  var moveEndPoint$1 = function (dom, rng, node, start) {\n    var root = node,\n        walker = new DomTreeWalker(node, root);\n    var moveCaretBeforeOnEnterElementsMap = filter$1(dom.schema.getMoveCaretBeforeOnEnterElements(), function (_, name) {\n      return !contains(['td', 'th', 'table'], name.toLowerCase());\n    });\n\n    do {\n      if (isText$1(node) && Tools.trim(node.nodeValue).length !== 0) {\n        if (start) {\n          rng.setStart(node, 0);\n        } else {\n          rng.setEnd(node, node.nodeValue.length);\n        }\n\n        return;\n      }\n\n      if (moveCaretBeforeOnEnterElementsMap[node.nodeName]) {\n        if (start) {\n          rng.setStartBefore(node);\n        } else {\n          if (node.nodeName === 'BR') {\n            rng.setEndBefore(node);\n          } else {\n            rng.setEndAfter(node);\n          }\n        }\n\n        return;\n      }\n    } while (node = start ? walker.next() : walker.prev());\n\n    if (root.nodeName === 'BODY') {\n      if (start) {\n        rng.setStart(root, 0);\n      } else {\n        rng.setEnd(root, root.childNodes.length);\n      }\n    }\n  };\n\n  var hasAnyRanges = function (editor) {\n    var sel = editor.selection.getSel();\n    return sel && sel.rangeCount > 0;\n  };\n\n  var runOnRanges = function (editor, executor) {\n    var fakeSelectionNodes = getCellsFromEditor(editor);\n\n    if (fakeSelectionNodes.length > 0) {\n      each(fakeSelectionNodes, function (elem) {\n        var node = elem.dom;\n        var fakeNodeRng = editor.dom.createRng();\n        fakeNodeRng.setStartBefore(node);\n        fakeNodeRng.setEndAfter(node);\n        executor(fakeNodeRng, true);\n      });\n    } else {\n      executor(editor.selection.getRng(), false);\n    }\n  };\n\n  var preserve = function (selection, fillBookmark, executor) {\n    var bookmark = getPersistentBookmark(selection, fillBookmark);\n    executor(bookmark);\n    selection.moveToBookmark(bookmark);\n  };\n\n  var NodeValue = function (is, name) {\n    var get = function (element) {\n      if (!is(element)) {\n        throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n      }\n\n      return getOption(element).getOr('');\n    };\n\n    var getOption = function (element) {\n      return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n    };\n\n    var set = function (element, value) {\n      if (!is(element)) {\n        throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n      }\n\n      element.dom.nodeValue = value;\n    };\n\n    return {\n      get: get,\n      getOption: getOption,\n      set: set\n    };\n  };\n\n  var api = NodeValue(isText, 'text');\n\n  var get$8 = function (element) {\n    return api.get(element);\n  };\n\n  var isZeroWidth = function (elem) {\n    return isText(elem) && get$8(elem) === ZWSP;\n  };\n\n  var context = function (editor, elem, wrapName, nodeName) {\n    return parent(elem).fold(function () {\n      return 'skipping';\n    }, function (parent) {\n      if (nodeName === 'br' || isZeroWidth(elem)) {\n        return 'valid';\n      } else if (isAnnotation(elem)) {\n        return 'existing';\n      } else if (isCaretNode(elem.dom)) {\n        return 'caret';\n      } else if (!isValid(editor, wrapName, nodeName) || !isValid(editor, name(parent), wrapName)) {\n        return 'invalid-child';\n      } else {\n        return 'valid';\n      }\n    });\n  };\n\n  var applyWordGrab = function (editor, rng) {\n    var r = expandRng(editor, rng, [{\n      inline: true\n    }]);\n    rng.setStart(r.startContainer, r.startOffset);\n    rng.setEnd(r.endContainer, r.endOffset);\n    editor.selection.setRng(rng);\n  };\n\n  var makeAnnotation = function (eDoc, _a, annotationName, decorate) {\n    var _b = _a.uid,\n        uid = _b === void 0 ? generate$1('mce-annotation') : _b,\n        data = __rest(_a, ['uid']);\n\n    var master = SugarElement.fromTag('span', eDoc);\n    add$3(master, annotation());\n    set(master, '' + dataAnnotationId(), uid);\n    set(master, '' + dataAnnotation(), annotationName);\n\n    var _c = decorate(uid, data),\n        _d = _c.attributes,\n        attributes = _d === void 0 ? {} : _d,\n        _e = _c.classes,\n        classes = _e === void 0 ? [] : _e;\n\n    setAll(master, attributes);\n    add$4(master, classes);\n    return master;\n  };\n\n  var annotate = function (editor, rng, annotationName, decorate, data) {\n    var newWrappers = [];\n    var master = makeAnnotation(editor.getDoc(), data, annotationName, decorate);\n    var wrapper = Cell(Optional.none());\n\n    var finishWrapper = function () {\n      wrapper.set(Optional.none());\n    };\n\n    var getOrOpenWrapper = function () {\n      return wrapper.get().getOrThunk(function () {\n        var nu = shallow(master);\n        newWrappers.push(nu);\n        wrapper.set(Optional.some(nu));\n        return nu;\n      });\n    };\n\n    var processElements = function (elems) {\n      each(elems, processElement);\n    };\n\n    var processElement = function (elem) {\n      var ctx = context(editor, elem, 'span', name(elem));\n\n      switch (ctx) {\n        case 'invalid-child':\n          {\n            finishWrapper();\n            var children$1 = children(elem);\n            processElements(children$1);\n            finishWrapper();\n            break;\n          }\n\n        case 'valid':\n          {\n            var w = getOrOpenWrapper();\n            wrap(elem, w);\n            break;\n          }\n      }\n    };\n\n    var processNodes = function (nodes) {\n      var elems = map(nodes, SugarElement.fromDom);\n      processElements(elems);\n    };\n\n    walk$1(editor.dom, rng, function (nodes) {\n      finishWrapper();\n      processNodes(nodes);\n    });\n    return newWrappers;\n  };\n\n  var annotateWithBookmark = function (editor, name, settings, data) {\n    editor.undoManager.transact(function () {\n      var selection = editor.selection;\n      var initialRng = selection.getRng();\n      var hasFakeSelection = getCellsFromEditor(editor).length > 0;\n\n      if (initialRng.collapsed && !hasFakeSelection) {\n        applyWordGrab(editor, initialRng);\n      }\n\n      if (selection.getRng().collapsed && !hasFakeSelection) {\n        var wrapper = makeAnnotation(editor.getDoc(), data, name, settings.decorate);\n        set$1(wrapper, nbsp);\n        selection.getRng().insertNode(wrapper.dom);\n        selection.select(wrapper.dom);\n      } else {\n        preserve(selection, false, function () {\n          runOnRanges(editor, function (selectionRng) {\n            annotate(editor, selectionRng, name, settings.decorate, data);\n          });\n        });\n      }\n    });\n  };\n\n  var Annotator = function (editor) {\n    var registry = create$2();\n    setup$1(editor, registry);\n    var changes = setup(editor);\n    return {\n      register: function (name, settings) {\n        registry.register(name, settings);\n      },\n      annotate: function (name, data) {\n        registry.lookup(name).each(function (settings) {\n          annotateWithBookmark(editor, name, settings, data);\n        });\n      },\n      annotationChanged: function (name, callback) {\n        changes.addListener(name, callback);\n      },\n      remove: function (name) {\n        identify(editor, Optional.some(name)).each(function (_a) {\n          var elements = _a.elements;\n          each(elements, unwrap);\n        });\n      },\n      getAll: function (name) {\n        var directory = findAll(editor, name);\n        return map$1(directory, function (elems) {\n          return map(elems, function (elem) {\n            return elem.dom;\n          });\n        });\n      }\n    };\n  };\n\n  var BookmarkManager = function (selection) {\n    return {\n      getBookmark: curry(getBookmark$1, selection),\n      moveToBookmark: curry(moveToBookmark, selection)\n    };\n  };\n\n  BookmarkManager.isBookmarkNode = isBookmarkNode$1;\n\n  var getContentEditableRoot = function (root, node) {\n    while (node && node !== root) {\n      if (isContentEditableTrue(node) || isContentEditableFalse(node)) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var isXYWithinRange = function (clientX, clientY, range) {\n    if (range.collapsed) {\n      return false;\n    }\n\n    if (Env.browser.isIE() && range.startOffset === range.endOffset - 1 && range.startContainer === range.endContainer) {\n      var elm = range.startContainer.childNodes[range.startOffset];\n\n      if (isElement$1(elm)) {\n        return exists(elm.getClientRects(), function (rect) {\n          return containsXY(rect, clientX, clientY);\n        });\n      }\n    }\n\n    return exists(range.getClientRects(), function (rect) {\n      return containsXY(rect, clientX, clientY);\n    });\n  };\n\n  var firePreProcess = function (editor, args) {\n    return editor.fire('PreProcess', args);\n  };\n\n  var firePostProcess = function (editor, args) {\n    return editor.fire('PostProcess', args);\n  };\n\n  var fireRemove = function (editor) {\n    return editor.fire('remove');\n  };\n\n  var fireDetach = function (editor) {\n    return editor.fire('detach');\n  };\n\n  var fireSwitchMode = function (editor, mode) {\n    return editor.fire('SwitchMode', {\n      mode: mode\n    });\n  };\n\n  var fireObjectResizeStart = function (editor, target, width, height, origin) {\n    editor.fire('ObjectResizeStart', {\n      target: target,\n      width: width,\n      height: height,\n      origin: origin\n    });\n  };\n\n  var fireObjectResized = function (editor, target, width, height, origin) {\n    editor.fire('ObjectResized', {\n      target: target,\n      width: width,\n      height: height,\n      origin: origin\n    });\n  };\n\n  var firePreInit = function (editor) {\n    return editor.fire('PreInit');\n  };\n\n  var firePostRender = function (editor) {\n    return editor.fire('PostRender');\n  };\n\n  var fireInit = function (editor) {\n    return editor.fire('Init');\n  };\n\n  var firePlaceholderToggle = function (editor, state) {\n    return editor.fire('PlaceholderToggle', {\n      state: state\n    });\n  };\n\n  var fireError = function (editor, errorType, error) {\n    return editor.fire(errorType, error);\n  };\n\n  var VK = {\n    BACKSPACE: 8,\n    DELETE: 46,\n    DOWN: 40,\n    ENTER: 13,\n    LEFT: 37,\n    RIGHT: 39,\n    SPACEBAR: 32,\n    TAB: 9,\n    UP: 38,\n    END: 35,\n    HOME: 36,\n    modifierPressed: function (e) {\n      return e.shiftKey || e.ctrlKey || e.altKey || VK.metaKeyPressed(e);\n    },\n    metaKeyPressed: function (e) {\n      return Env.mac ? e.metaKey : e.ctrlKey && !e.altKey;\n    }\n  };\n  var isContentEditableFalse$6 = isContentEditableFalse;\n\n  var ControlSelection = function (selection, editor) {\n    var elementSelectionAttr = 'data-mce-selected';\n    var dom = editor.dom,\n        each$2 = Tools.each;\n    var selectedElm, selectedElmGhost, resizeHelper, selectedHandle, resizeBackdrop;\n    var startX, startY, selectedElmX, selectedElmY, startW, startH, ratio, resizeStarted;\n    var width, height;\n    var editableDoc = editor.getDoc(),\n        rootDocument = document;\n    var abs = Math.abs,\n        round = Math.round,\n        rootElement = editor.getBody();\n    var startScrollWidth, startScrollHeight;\n    var resizeHandles = {\n      nw: [0, 0, -1, -1],\n      ne: [1, 0, 1, -1],\n      se: [1, 1, 1, 1],\n      sw: [0, 1, -1, 1]\n    };\n\n    var isImage = function (elm) {\n      return elm && (elm.nodeName === 'IMG' || editor.dom.is(elm, 'figure.image'));\n    };\n\n    var isMedia$1 = function (elm) {\n      return isMedia(elm) || dom.hasClass(elm, 'mce-preview-object');\n    };\n\n    var isEventOnImageOutsideRange = function (evt, range) {\n      if (evt.type === 'longpress' || evt.type.indexOf('touch') === 0) {\n        var touch = evt.touches[0];\n        return isImage(evt.target) && !isXYWithinRange(touch.clientX, touch.clientY, range);\n      } else {\n        return isImage(evt.target) && !isXYWithinRange(evt.clientX, evt.clientY, range);\n      }\n    };\n\n    var contextMenuSelectImage = function (evt) {\n      var target = evt.target;\n\n      if (isEventOnImageOutsideRange(evt, editor.selection.getRng()) && !evt.isDefaultPrevented()) {\n        editor.selection.select(target);\n      }\n    };\n\n    var getResizeTargets = function (elm) {\n      if (dom.is(elm, 'figure.image')) {\n        return [elm.querySelector('img')];\n      } else if (dom.hasClass(elm, 'mce-preview-object') && isNonNullable(elm.firstElementChild)) {\n        return [elm, elm.firstElementChild];\n      } else {\n        return [elm];\n      }\n    };\n\n    var isResizable = function (elm) {\n      var selector = getObjectResizing(editor);\n\n      if (!selector) {\n        return false;\n      }\n\n      if (elm.getAttribute('data-mce-resize') === 'false') {\n        return false;\n      }\n\n      if (elm === editor.getBody()) {\n        return false;\n      }\n\n      if (dom.hasClass(elm, 'mce-preview-object')) {\n        return is$1(SugarElement.fromDom(elm.firstElementChild), selector);\n      } else {\n        return is$1(SugarElement.fromDom(elm), selector);\n      }\n    };\n\n    var createGhostElement = function (elm) {\n      if (isMedia$1(elm)) {\n        return dom.create('img', {\n          src: Env.transparentSrc\n        });\n      } else {\n        return elm.cloneNode(true);\n      }\n    };\n\n    var setSizeProp = function (element, name, value) {\n      if (isNonNullable(value)) {\n        var targets = getResizeTargets(element);\n        each(targets, function (target) {\n          if (target.style[name] || !editor.schema.isValid(target.nodeName.toLowerCase(), name)) {\n            dom.setStyle(target, name, value);\n          } else {\n            dom.setAttrib(target, name, '' + value);\n          }\n        });\n      }\n    };\n\n    var setGhostElmSize = function (ghostElm, width, height) {\n      setSizeProp(ghostElm, 'width', width);\n      setSizeProp(ghostElm, 'height', height);\n    };\n\n    var resizeGhostElement = function (e) {\n      var deltaX, deltaY, proportional;\n      var resizeHelperX, resizeHelperY;\n      deltaX = e.screenX - startX;\n      deltaY = e.screenY - startY;\n      width = deltaX * selectedHandle[2] + startW;\n      height = deltaY * selectedHandle[3] + startH;\n      width = width < 5 ? 5 : width;\n      height = height < 5 ? 5 : height;\n\n      if ((isImage(selectedElm) || isMedia$1(selectedElm)) && getResizeImgProportional(editor) !== false) {\n        proportional = !VK.modifierPressed(e);\n      } else {\n        proportional = VK.modifierPressed(e);\n      }\n\n      if (proportional) {\n        if (abs(deltaX) > abs(deltaY)) {\n          height = round(width * ratio);\n          width = round(height / ratio);\n        } else {\n          width = round(height / ratio);\n          height = round(width * ratio);\n        }\n      }\n\n      setGhostElmSize(selectedElmGhost, width, height);\n      resizeHelperX = selectedHandle.startPos.x + deltaX;\n      resizeHelperY = selectedHandle.startPos.y + deltaY;\n      resizeHelperX = resizeHelperX > 0 ? resizeHelperX : 0;\n      resizeHelperY = resizeHelperY > 0 ? resizeHelperY : 0;\n      dom.setStyles(resizeHelper, {\n        left: resizeHelperX,\n        top: resizeHelperY,\n        display: 'block'\n      });\n      resizeHelper.innerHTML = width + ' &times; ' + height;\n\n      if (selectedHandle[2] < 0 && selectedElmGhost.clientWidth <= width) {\n        dom.setStyle(selectedElmGhost, 'left', selectedElmX + (startW - width));\n      }\n\n      if (selectedHandle[3] < 0 && selectedElmGhost.clientHeight <= height) {\n        dom.setStyle(selectedElmGhost, 'top', selectedElmY + (startH - height));\n      }\n\n      deltaX = rootElement.scrollWidth - startScrollWidth;\n      deltaY = rootElement.scrollHeight - startScrollHeight;\n\n      if (deltaX + deltaY !== 0) {\n        dom.setStyles(resizeHelper, {\n          left: resizeHelperX - deltaX,\n          top: resizeHelperY - deltaY\n        });\n      }\n\n      if (!resizeStarted) {\n        fireObjectResizeStart(editor, selectedElm, startW, startH, 'corner-' + selectedHandle.name);\n        resizeStarted = true;\n      }\n    };\n\n    var endGhostResize = function () {\n      var wasResizeStarted = resizeStarted;\n      resizeStarted = false;\n\n      if (wasResizeStarted) {\n        setSizeProp(selectedElm, 'width', width);\n        setSizeProp(selectedElm, 'height', height);\n      }\n\n      dom.unbind(editableDoc, 'mousemove', resizeGhostElement);\n      dom.unbind(editableDoc, 'mouseup', endGhostResize);\n\n      if (rootDocument !== editableDoc) {\n        dom.unbind(rootDocument, 'mousemove', resizeGhostElement);\n        dom.unbind(rootDocument, 'mouseup', endGhostResize);\n      }\n\n      dom.remove(selectedElmGhost);\n      dom.remove(resizeHelper);\n      dom.remove(resizeBackdrop);\n      showResizeRect(selectedElm);\n\n      if (wasResizeStarted) {\n        fireObjectResized(editor, selectedElm, width, height, 'corner-' + selectedHandle.name);\n        dom.setAttrib(selectedElm, 'style', dom.getAttrib(selectedElm, 'style'));\n      }\n\n      editor.nodeChanged();\n    };\n\n    var showResizeRect = function (targetElm) {\n      unbindResizeHandleEvents();\n      var position = dom.getPos(targetElm, rootElement);\n      var selectedElmX = position.x;\n      var selectedElmY = position.y;\n      var rect = targetElm.getBoundingClientRect();\n      var targetWidth = rect.width || rect.right - rect.left;\n      var targetHeight = rect.height || rect.bottom - rect.top;\n\n      if (selectedElm !== targetElm) {\n        hideResizeRect();\n        selectedElm = targetElm;\n        width = height = 0;\n      }\n\n      var e = editor.fire('ObjectSelected', {\n        target: targetElm\n      });\n      var selectedValue = dom.getAttrib(selectedElm, elementSelectionAttr, '1');\n\n      if (isResizable(targetElm) && !e.isDefaultPrevented()) {\n        each$2(resizeHandles, function (handle, name) {\n          var handleElm;\n\n          var startDrag = function (e) {\n            var target = getResizeTargets(selectedElm)[0];\n            startX = e.screenX;\n            startY = e.screenY;\n            startW = target.clientWidth;\n            startH = target.clientHeight;\n            ratio = startH / startW;\n            selectedHandle = handle;\n            selectedHandle.name = name;\n            selectedHandle.startPos = {\n              x: targetWidth * handle[0] + selectedElmX,\n              y: targetHeight * handle[1] + selectedElmY\n            };\n            startScrollWidth = rootElement.scrollWidth;\n            startScrollHeight = rootElement.scrollHeight;\n            resizeBackdrop = dom.add(rootElement, 'div', {\n              class: 'mce-resize-backdrop'\n            });\n            dom.setStyles(resizeBackdrop, {\n              position: 'fixed',\n              left: '0',\n              top: '0',\n              width: '100%',\n              height: '100%'\n            });\n            selectedElmGhost = createGhostElement(selectedElm);\n            dom.addClass(selectedElmGhost, 'mce-clonedresizable');\n            dom.setAttrib(selectedElmGhost, 'data-mce-bogus', 'all');\n            selectedElmGhost.contentEditable = 'false';\n            dom.setStyles(selectedElmGhost, {\n              left: selectedElmX,\n              top: selectedElmY,\n              margin: 0\n            });\n            setGhostElmSize(selectedElmGhost, targetWidth, targetHeight);\n            selectedElmGhost.removeAttribute(elementSelectionAttr);\n            rootElement.appendChild(selectedElmGhost);\n            dom.bind(editableDoc, 'mousemove', resizeGhostElement);\n            dom.bind(editableDoc, 'mouseup', endGhostResize);\n\n            if (rootDocument !== editableDoc) {\n              dom.bind(rootDocument, 'mousemove', resizeGhostElement);\n              dom.bind(rootDocument, 'mouseup', endGhostResize);\n            }\n\n            resizeHelper = dom.add(rootElement, 'div', {\n              'class': 'mce-resize-helper',\n              'data-mce-bogus': 'all'\n            }, startW + ' &times; ' + startH);\n          };\n\n          handleElm = dom.get('mceResizeHandle' + name);\n\n          if (handleElm) {\n            dom.remove(handleElm);\n          }\n\n          handleElm = dom.add(rootElement, 'div', {\n            'id': 'mceResizeHandle' + name,\n            'data-mce-bogus': 'all',\n            'class': 'mce-resizehandle',\n            'unselectable': true,\n            'style': 'cursor:' + name + '-resize; margin:0; padding:0'\n          });\n\n          if (Env.ie === 11) {\n            handleElm.contentEditable = false;\n          }\n\n          dom.bind(handleElm, 'mousedown', function (e) {\n            e.stopImmediatePropagation();\n            e.preventDefault();\n            startDrag(e);\n          });\n          handle.elm = handleElm;\n          dom.setStyles(handleElm, {\n            left: targetWidth * handle[0] + selectedElmX - handleElm.offsetWidth / 2,\n            top: targetHeight * handle[1] + selectedElmY - handleElm.offsetHeight / 2\n          });\n        });\n      } else {\n        hideResizeRect();\n      }\n\n      if (!dom.getAttrib(selectedElm, elementSelectionAttr)) {\n        selectedElm.setAttribute(elementSelectionAttr, selectedValue);\n      }\n    };\n\n    var hideResizeRect = function () {\n      unbindResizeHandleEvents();\n\n      if (selectedElm) {\n        selectedElm.removeAttribute(elementSelectionAttr);\n      }\n\n      each$1(resizeHandles, function (value, name) {\n        var handleElm = dom.get('mceResizeHandle' + name);\n\n        if (handleElm) {\n          dom.unbind(handleElm);\n          dom.remove(handleElm);\n        }\n      });\n    };\n\n    var updateResizeRect = function (e) {\n      var startElm, controlElm;\n\n      var isChildOrEqual = function (node, parent) {\n        if (node) {\n          do {\n            if (node === parent) {\n              return true;\n            }\n          } while (node = node.parentNode);\n        }\n      };\n\n      if (resizeStarted || editor.removed) {\n        return;\n      }\n\n      each$2(dom.select('img[data-mce-selected],hr[data-mce-selected]'), function (img) {\n        img.removeAttribute(elementSelectionAttr);\n      });\n      controlElm = e.type === 'mousedown' ? e.target : selection.getNode();\n      controlElm = dom.$(controlElm).closest('table,img,figure.image,hr,video,span.mce-preview-object')[0];\n\n      if (isChildOrEqual(controlElm, rootElement)) {\n        disableGeckoResize();\n        startElm = selection.getStart(true);\n\n        if (isChildOrEqual(startElm, controlElm) && isChildOrEqual(selection.getEnd(true), controlElm)) {\n          showResizeRect(controlElm);\n          return;\n        }\n      }\n\n      hideResizeRect();\n    };\n\n    var isWithinContentEditableFalse = function (elm) {\n      return isContentEditableFalse$6(getContentEditableRoot(editor.getBody(), elm));\n    };\n\n    var unbindResizeHandleEvents = function () {\n      each$1(resizeHandles, function (handle) {\n        if (handle.elm) {\n          dom.unbind(handle.elm);\n          delete handle.elm;\n        }\n      });\n    };\n\n    var disableGeckoResize = function () {\n      try {\n        editor.getDoc().execCommand('enableObjectResizing', false, 'false');\n      } catch (ex) {}\n    };\n\n    editor.on('init', function () {\n      disableGeckoResize();\n\n      if (Env.browser.isIE() || Env.browser.isEdge()) {\n        editor.on('mousedown click', function (e) {\n          var target = e.target,\n              nodeName = target.nodeName;\n\n          if (!resizeStarted && /^(TABLE|IMG|HR)$/.test(nodeName) && !isWithinContentEditableFalse(target)) {\n            if (e.button !== 2) {\n              editor.selection.select(target, nodeName === 'TABLE');\n            }\n\n            if (e.type === 'mousedown') {\n              editor.nodeChanged();\n            }\n          }\n        });\n\n        var handleMSControlSelect_1 = function (e) {\n          var delayedSelect = function (node) {\n            Delay.setEditorTimeout(editor, function () {\n              return editor.selection.select(node);\n            });\n          };\n\n          if (isWithinContentEditableFalse(e.target) || isMedia(e.target)) {\n            e.preventDefault();\n            delayedSelect(e.target);\n            return;\n          }\n\n          if (/^(TABLE|IMG|HR)$/.test(e.target.nodeName)) {\n            e.preventDefault();\n\n            if (e.target.tagName === 'IMG') {\n              delayedSelect(e.target);\n            }\n          }\n        };\n\n        dom.bind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n        editor.on('remove', function () {\n          return dom.unbind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n        });\n      }\n\n      var throttledUpdateResizeRect = Delay.throttle(function (e) {\n        if (!editor.composing) {\n          updateResizeRect(e);\n        }\n      });\n      editor.on('nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged', throttledUpdateResizeRect);\n      editor.on('keyup compositionend', function (e) {\n        if (selectedElm && selectedElm.nodeName === 'TABLE') {\n          throttledUpdateResizeRect(e);\n        }\n      });\n      editor.on('hide blur', hideResizeRect);\n      editor.on('contextmenu longpress', contextMenuSelectImage, true);\n    });\n    editor.on('remove', unbindResizeHandleEvents);\n\n    var destroy = function () {\n      selectedElm = selectedElmGhost = resizeBackdrop = null;\n    };\n\n    return {\n      isResizable: isResizable,\n      showResizeRect: showResizeRect,\n      hideResizeRect: hideResizeRect,\n      updateResizeRect: updateResizeRect,\n      destroy: destroy\n    };\n  };\n\n  var hasCeProperty = function (node) {\n    return isContentEditableTrue(node) || isContentEditableFalse(node);\n  };\n\n  var findParent = function (node, rootNode, predicate) {\n    while (node && node !== rootNode) {\n      if (predicate(node)) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var findClosestIeRange = function (clientX, clientY, doc) {\n    var rects;\n    var element = doc.elementFromPoint(clientX, clientY);\n    var rng = doc.body.createTextRange();\n\n    if (!element || element.tagName === 'HTML') {\n      element = doc.body;\n    }\n\n    rng.moveToElementText(element);\n    rects = Tools.toArray(rng.getClientRects());\n    rects = rects.sort(function (a, b) {\n      a = Math.abs(Math.max(a.top - clientY, a.bottom - clientY));\n      b = Math.abs(Math.max(b.top - clientY, b.bottom - clientY));\n      return a - b;\n    });\n\n    if (rects.length > 0) {\n      clientY = (rects[0].bottom + rects[0].top) / 2;\n\n      try {\n        rng.moveToPoint(clientX, clientY);\n        rng.collapse(true);\n        return rng;\n      } catch (ex) {}\n    }\n\n    return null;\n  };\n\n  var moveOutOfContentEditableFalse = function (rng, rootNode) {\n    var parentElement = rng && rng.parentElement ? rng.parentElement() : null;\n    return isContentEditableFalse(findParent(parentElement, rootNode, hasCeProperty)) ? null : rng;\n  };\n\n  var fromPoint$1 = function (clientX, clientY, doc) {\n    var rng, point;\n    var pointDoc = doc;\n\n    if (pointDoc.caretPositionFromPoint) {\n      point = pointDoc.caretPositionFromPoint(clientX, clientY);\n\n      if (point) {\n        rng = doc.createRange();\n        rng.setStart(point.offsetNode, point.offset);\n        rng.collapse(true);\n      }\n    } else if (doc.caretRangeFromPoint) {\n      rng = doc.caretRangeFromPoint(clientX, clientY);\n    } else if (pointDoc.body.createTextRange) {\n      rng = pointDoc.body.createTextRange();\n\n      try {\n        rng.moveToPoint(clientX, clientY);\n        rng.collapse(true);\n      } catch (ex) {\n        rng = findClosestIeRange(clientX, clientY, doc);\n      }\n\n      return moveOutOfContentEditableFalse(rng, doc.body);\n    }\n\n    return rng;\n  };\n\n  var isEq$1 = function (rng1, rng2) {\n    return rng1 && rng2 && rng1.startContainer === rng2.startContainer && rng1.startOffset === rng2.startOffset && rng1.endContainer === rng2.endContainer && rng1.endOffset === rng2.endOffset;\n  };\n\n  var findParent$1 = function (node, rootNode, predicate) {\n    while (node && node !== rootNode) {\n      if (predicate(node)) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var hasParent = function (node, rootNode, predicate) {\n    return findParent$1(node, rootNode, predicate) !== null;\n  };\n\n  var hasParentWithName = function (node, rootNode, name) {\n    return hasParent(node, rootNode, function (node) {\n      return node.nodeName === name;\n    });\n  };\n\n  var isTable$3 = function (node) {\n    return node && node.nodeName === 'TABLE';\n  };\n\n  var isTableCell$3 = function (node) {\n    return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n  };\n\n  var isCeFalseCaretContainer = function (node, rootNode) {\n    return isCaretContainer(node) && hasParent(node, rootNode, isCaretNode) === false;\n  };\n\n  var hasBrBeforeAfter = function (dom, node, left) {\n    var walker = new DomTreeWalker(node, dom.getParent(node.parentNode, dom.isBlock) || dom.getRoot());\n\n    while (node = walker[left ? 'prev' : 'next']()) {\n      if (isBr(node)) {\n        return true;\n      }\n    }\n  };\n\n  var isPrevNode = function (node, name) {\n    return node.previousSibling && node.previousSibling.nodeName === name;\n  };\n\n  var hasContentEditableFalseParent = function (body, node) {\n    while (node && node !== body) {\n      if (isContentEditableFalse(node)) {\n        return true;\n      }\n\n      node = node.parentNode;\n    }\n\n    return false;\n  };\n\n  var findTextNodeRelative = function (dom, isAfterNode, collapsed, left, startNode) {\n    var lastInlineElement;\n    var body = dom.getRoot();\n    var node;\n    var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n    var parentBlockContainer = dom.getParent(startNode.parentNode, dom.isBlock) || body;\n\n    if (left && isBr(startNode) && isAfterNode && dom.isEmpty(parentBlockContainer)) {\n      return Optional.some(CaretPosition(startNode.parentNode, dom.nodeIndex(startNode)));\n    }\n\n    var walker = new DomTreeWalker(startNode, parentBlockContainer);\n\n    while (node = walker[left ? 'prev' : 'next']()) {\n      if (dom.getContentEditableParent(node) === 'false' || isCeFalseCaretContainer(node, body)) {\n        return Optional.none();\n      }\n\n      if (isText$1(node) && node.nodeValue.length > 0) {\n        if (hasParentWithName(node, body, 'A') === false) {\n          return Optional.some(CaretPosition(node, left ? node.nodeValue.length : 0));\n        }\n\n        return Optional.none();\n      }\n\n      if (dom.isBlock(node) || nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n        return Optional.none();\n      }\n\n      lastInlineElement = node;\n    }\n\n    if (collapsed && lastInlineElement) {\n      return Optional.some(CaretPosition(lastInlineElement, 0));\n    }\n\n    return Optional.none();\n  };\n\n  var normalizeEndPoint = function (dom, collapsed, start, rng) {\n    var container, offset;\n    var body = dom.getRoot();\n    var node;\n    var directionLeft,\n        normalized = false;\n    container = rng[(start ? 'start' : 'end') + 'Container'];\n    offset = rng[(start ? 'start' : 'end') + 'Offset'];\n    var isAfterNode = isElement$1(container) && offset === container.childNodes.length;\n    var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n    directionLeft = start;\n\n    if (isCaretContainer(container)) {\n      return Optional.none();\n    }\n\n    if (isElement$1(container) && offset > container.childNodes.length - 1) {\n      directionLeft = false;\n    }\n\n    if (isDocument$1(container)) {\n      container = body;\n      offset = 0;\n    }\n\n    if (container === body) {\n      if (directionLeft) {\n        node = container.childNodes[offset > 0 ? offset - 1 : 0];\n\n        if (node) {\n          if (isCaretContainer(node)) {\n            return Optional.none();\n          }\n\n          if (nonEmptyElementsMap[node.nodeName] || isTable$3(node)) {\n            return Optional.none();\n          }\n        }\n      }\n\n      if (container.hasChildNodes()) {\n        offset = Math.min(!directionLeft && offset > 0 ? offset - 1 : offset, container.childNodes.length - 1);\n        container = container.childNodes[offset];\n        offset = isText$1(container) && isAfterNode ? container.data.length : 0;\n\n        if (!collapsed && container === body.lastChild && isTable$3(container)) {\n          return Optional.none();\n        }\n\n        if (hasContentEditableFalseParent(body, container) || isCaretContainer(container)) {\n          return Optional.none();\n        }\n\n        if (container.hasChildNodes() && isTable$3(container) === false) {\n          node = container;\n          var walker = new DomTreeWalker(container, body);\n\n          do {\n            if (isContentEditableFalse(node) || isCaretContainer(node)) {\n              normalized = false;\n              break;\n            }\n\n            if (isText$1(node) && node.nodeValue.length > 0) {\n              offset = directionLeft ? 0 : node.nodeValue.length;\n              container = node;\n              normalized = true;\n              break;\n            }\n\n            if (nonEmptyElementsMap[node.nodeName.toLowerCase()] && !isTableCell$3(node)) {\n              offset = dom.nodeIndex(node);\n              container = node.parentNode;\n\n              if (!directionLeft) {\n                offset++;\n              }\n\n              normalized = true;\n              break;\n            }\n          } while (node = directionLeft ? walker.next() : walker.prev());\n        }\n      }\n    }\n\n    if (collapsed) {\n      if (isText$1(container) && offset === 0) {\n        findTextNodeRelative(dom, isAfterNode, collapsed, true, container).each(function (pos) {\n          container = pos.container();\n          offset = pos.offset();\n          normalized = true;\n        });\n      }\n\n      if (isElement$1(container)) {\n        node = container.childNodes[offset];\n\n        if (!node) {\n          node = container.childNodes[offset - 1];\n        }\n\n        if (node && isBr(node) && !isPrevNode(node, 'A') && !hasBrBeforeAfter(dom, node, false) && !hasBrBeforeAfter(dom, node, true)) {\n          findTextNodeRelative(dom, isAfterNode, collapsed, true, node).each(function (pos) {\n            container = pos.container();\n            offset = pos.offset();\n            normalized = true;\n          });\n        }\n      }\n    }\n\n    if (directionLeft && !collapsed && isText$1(container) && offset === container.nodeValue.length) {\n      findTextNodeRelative(dom, isAfterNode, collapsed, false, container).each(function (pos) {\n        container = pos.container();\n        offset = pos.offset();\n        normalized = true;\n      });\n    }\n\n    return normalized ? Optional.some(CaretPosition(container, offset)) : Optional.none();\n  };\n\n  var normalize = function (dom, rng) {\n    var collapsed = rng.collapsed,\n        normRng = rng.cloneRange();\n    var startPos = CaretPosition.fromRangeStart(rng);\n    normalizeEndPoint(dom, collapsed, true, normRng).each(function (pos) {\n      if (!collapsed || !CaretPosition.isAbove(startPos, pos)) {\n        normRng.setStart(pos.container(), pos.offset());\n      }\n    });\n\n    if (!collapsed) {\n      normalizeEndPoint(dom, collapsed, false, normRng).each(function (pos) {\n        normRng.setEnd(pos.container(), pos.offset());\n      });\n    }\n\n    if (collapsed) {\n      normRng.collapse(true);\n    }\n\n    return isEq$1(rng, normRng) ? Optional.none() : Optional.some(normRng);\n  };\n\n  var splitText = function (node, offset) {\n    return node.splitText(offset);\n  };\n\n  var split$1 = function (rng) {\n    var startContainer = rng.startContainer,\n        startOffset = rng.startOffset,\n        endContainer = rng.endContainer,\n        endOffset = rng.endOffset;\n\n    if (startContainer === endContainer && isText$1(startContainer)) {\n      if (startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n        endContainer = splitText(startContainer, startOffset);\n        startContainer = endContainer.previousSibling;\n\n        if (endOffset > startOffset) {\n          endOffset = endOffset - startOffset;\n          startContainer = endContainer = splitText(endContainer, endOffset).previousSibling;\n          endOffset = endContainer.nodeValue.length;\n          startOffset = 0;\n        } else {\n          endOffset = 0;\n        }\n      }\n    } else {\n      if (isText$1(startContainer) && startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n        startContainer = splitText(startContainer, startOffset);\n        startOffset = 0;\n      }\n\n      if (isText$1(endContainer) && endOffset > 0 && endOffset < endContainer.nodeValue.length) {\n        endContainer = splitText(endContainer, endOffset).previousSibling;\n        endOffset = endContainer.nodeValue.length;\n      }\n    }\n\n    return {\n      startContainer: startContainer,\n      startOffset: startOffset,\n      endContainer: endContainer,\n      endOffset: endOffset\n    };\n  };\n\n  var RangeUtils = function (dom) {\n    var walk = function (rng, callback) {\n      return walk$1(dom, rng, callback);\n    };\n\n    var split = split$1;\n\n    var normalize$1 = function (rng) {\n      return normalize(dom, rng).fold(never, function (normalizedRng) {\n        rng.setStart(normalizedRng.startContainer, normalizedRng.startOffset);\n        rng.setEnd(normalizedRng.endContainer, normalizedRng.endOffset);\n        return true;\n      });\n    };\n\n    return {\n      walk: walk,\n      split: split,\n      normalize: normalize$1\n    };\n  };\n\n  RangeUtils.compareRanges = isEq$1;\n  RangeUtils.getCaretRangeFromPoint = fromPoint$1;\n  RangeUtils.getSelectedNode = getSelectedNode;\n  RangeUtils.getNode = getNode;\n\n  var Dimension = function (name, getOffset) {\n    var set = function (element, h) {\n      if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n        throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n      }\n\n      var dom = element.dom;\n\n      if (isSupported$1(dom)) {\n        dom.style[name] = h + 'px';\n      }\n    };\n\n    var get = function (element) {\n      var r = getOffset(element);\n\n      if (r <= 0 || r === null) {\n        var css = get$5(element, name);\n        return parseFloat(css) || 0;\n      }\n\n      return r;\n    };\n\n    var getOuter = get;\n\n    var aggregate = function (element, properties) {\n      return foldl(properties, function (acc, property) {\n        var val = get$5(element, property);\n        var value = val === undefined ? 0 : parseInt(val, 10);\n        return isNaN(value) ? acc : acc + value;\n      }, 0);\n    };\n\n    var max = function (element, value, properties) {\n      var cumulativeInclusions = aggregate(element, properties);\n      var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n      return absoluteMax;\n    };\n\n    return {\n      set: set,\n      get: get,\n      getOuter: getOuter,\n      aggregate: aggregate,\n      max: max\n    };\n  };\n\n  var api$1 = Dimension('height', function (element) {\n    var dom = element.dom;\n    return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n  });\n\n  var get$9 = function (element) {\n    return api$1.get(element);\n  };\n\n  var walkUp = function (navigation, doc) {\n    var frame = navigation.view(doc);\n    return frame.fold(constant([]), function (f) {\n      var parent = navigation.owner(f);\n      var rest = walkUp(navigation, parent);\n      return [f].concat(rest);\n    });\n  };\n\n  var pathTo = function (element, navigation) {\n    var d = navigation.owner(element);\n    return walkUp(navigation, d);\n  };\n\n  var view = function (doc) {\n    var _a;\n\n    var element = doc.dom === document ? Optional.none() : Optional.from((_a = doc.dom.defaultView) === null || _a === void 0 ? void 0 : _a.frameElement);\n    return element.map(SugarElement.fromDom);\n  };\n\n  var owner$1 = function (element) {\n    return documentOrOwner(element);\n  };\n\n  var Navigation = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    view: view,\n    owner: owner$1\n  });\n\n  var find$2 = function (element) {\n    var doc = SugarElement.fromDom(document);\n    var scroll = get$2(doc);\n    var frames = pathTo(element, Navigation);\n    var offset = viewport(element);\n    var r = foldr(frames, function (b, a) {\n      var loc = viewport(a);\n      return {\n        left: b.left + loc.left,\n        top: b.top + loc.top\n      };\n    }, {\n      left: 0,\n      top: 0\n    });\n    return SugarPosition(r.left + offset.left + scroll.left, r.top + offset.top + scroll.top);\n  };\n\n  var excludeFromDescend = function (element) {\n    return name(element) === 'textarea';\n  };\n\n  var fireScrollIntoViewEvent = function (editor, data) {\n    var scrollEvent = editor.fire('ScrollIntoView', data);\n    return scrollEvent.isDefaultPrevented();\n  };\n\n  var fireAfterScrollIntoViewEvent = function (editor, data) {\n    editor.fire('AfterScrollIntoView', data);\n  };\n\n  var descend = function (element, offset) {\n    var children$1 = children(element);\n\n    if (children$1.length === 0 || excludeFromDescend(element)) {\n      return {\n        element: element,\n        offset: offset\n      };\n    } else if (offset < children$1.length && !excludeFromDescend(children$1[offset])) {\n      return {\n        element: children$1[offset],\n        offset: 0\n      };\n    } else {\n      var last = children$1[children$1.length - 1];\n\n      if (excludeFromDescend(last)) {\n        return {\n          element: element,\n          offset: offset\n        };\n      } else {\n        if (name(last) === 'img') {\n          return {\n            element: last,\n            offset: 1\n          };\n        } else if (isText(last)) {\n          return {\n            element: last,\n            offset: get$8(last).length\n          };\n        } else {\n          return {\n            element: last,\n            offset: children(last).length\n          };\n        }\n      }\n    }\n  };\n\n  var markerInfo = function (element, cleanupFun) {\n    var pos = absolute(element);\n    var height = get$9(element);\n    return {\n      element: element,\n      bottom: pos.top + height,\n      height: height,\n      pos: pos,\n      cleanup: cleanupFun\n    };\n  };\n\n  var createMarker = function (element, offset) {\n    var startPoint = descend(element, offset);\n    var span = SugarElement.fromHtml('<span data-mce-bogus=\"all\">' + ZWSP + '</span>');\n    before(startPoint.element, span);\n    return markerInfo(span, function () {\n      return remove(span);\n    });\n  };\n\n  var elementMarker = function (element) {\n    return markerInfo(SugarElement.fromDom(element), noop);\n  };\n\n  var withMarker = function (editor, f, rng, alignToTop) {\n    preserveWith(editor, function (_s, _e) {\n      return applyWithMarker(editor, f, rng, alignToTop);\n    }, rng);\n  };\n\n  var withScrollEvents = function (editor, doc, f, marker, alignToTop) {\n    var data = {\n      elm: marker.element.dom,\n      alignToTop: alignToTop\n    };\n\n    if (fireScrollIntoViewEvent(editor, data)) {\n      return;\n    }\n\n    var scrollTop = get$2(doc).top;\n    f(doc, scrollTop, marker, alignToTop);\n    fireAfterScrollIntoViewEvent(editor, data);\n  };\n\n  var applyWithMarker = function (editor, f, rng, alignToTop) {\n    var body = SugarElement.fromDom(editor.getBody());\n    var doc = SugarElement.fromDom(editor.getDoc());\n    reflow(body);\n    var marker = createMarker(SugarElement.fromDom(rng.startContainer), rng.startOffset);\n    withScrollEvents(editor, doc, f, marker, alignToTop);\n    marker.cleanup();\n  };\n\n  var withElement = function (editor, element, f, alignToTop) {\n    var doc = SugarElement.fromDom(editor.getDoc());\n    withScrollEvents(editor, doc, f, elementMarker(element), alignToTop);\n  };\n\n  var preserveWith = function (editor, f, rng) {\n    var startElement = rng.startContainer;\n    var startOffset = rng.startOffset;\n    var endElement = rng.endContainer;\n    var endOffset = rng.endOffset;\n    f(SugarElement.fromDom(startElement), SugarElement.fromDom(endElement));\n    var newRng = editor.dom.createRng();\n    newRng.setStart(startElement, startOffset);\n    newRng.setEnd(endElement, endOffset);\n    editor.selection.setRng(rng);\n  };\n\n  var scrollToMarker = function (marker, viewHeight, alignToTop, doc) {\n    var pos = marker.pos;\n\n    if (alignToTop) {\n      to(pos.left, pos.top, doc);\n    } else {\n      var y = pos.top - viewHeight + marker.height;\n      to(pos.left, y, doc);\n    }\n  };\n\n  var intoWindowIfNeeded = function (doc, scrollTop, viewHeight, marker, alignToTop) {\n    var viewportBottom = viewHeight + scrollTop;\n    var markerTop = marker.pos.top;\n    var markerBottom = marker.bottom;\n    var largerThanViewport = markerBottom - markerTop >= viewHeight;\n\n    if (markerTop < scrollTop) {\n      scrollToMarker(marker, viewHeight, alignToTop !== false, doc);\n    } else if (markerTop > viewportBottom) {\n      var align = largerThanViewport ? alignToTop !== false : alignToTop === true;\n      scrollToMarker(marker, viewHeight, align, doc);\n    } else if (markerBottom > viewportBottom && !largerThanViewport) {\n      scrollToMarker(marker, viewHeight, alignToTop === true, doc);\n    }\n  };\n\n  var intoWindow = function (doc, scrollTop, marker, alignToTop) {\n    var viewHeight = doc.dom.defaultView.innerHeight;\n    intoWindowIfNeeded(doc, scrollTop, viewHeight, marker, alignToTop);\n  };\n\n  var intoFrame = function (doc, scrollTop, marker, alignToTop) {\n    var frameViewHeight = doc.dom.defaultView.innerHeight;\n    intoWindowIfNeeded(doc, scrollTop, frameViewHeight, marker, alignToTop);\n    var op = find$2(marker.element);\n    var viewportBounds = getBounds(window);\n\n    if (op.top < viewportBounds.y) {\n      intoView(marker.element, alignToTop !== false);\n    } else if (op.top > viewportBounds.bottom) {\n      intoView(marker.element, alignToTop === true);\n    }\n  };\n\n  var rangeIntoWindow = function (editor, rng, alignToTop) {\n    return withMarker(editor, intoWindow, rng, alignToTop);\n  };\n\n  var elementIntoWindow = function (editor, element, alignToTop) {\n    return withElement(editor, element, intoWindow, alignToTop);\n  };\n\n  var rangeIntoFrame = function (editor, rng, alignToTop) {\n    return withMarker(editor, intoFrame, rng, alignToTop);\n  };\n\n  var elementIntoFrame = function (editor, element, alignToTop) {\n    return withElement(editor, element, intoFrame, alignToTop);\n  };\n\n  var scrollElementIntoView = function (editor, element, alignToTop) {\n    var scroller = editor.inline ? elementIntoWindow : elementIntoFrame;\n    scroller(editor, element, alignToTop);\n  };\n\n  var scrollRangeIntoView = function (editor, rng, alignToTop) {\n    var scroller = editor.inline ? rangeIntoWindow : rangeIntoFrame;\n    scroller(editor, rng, alignToTop);\n  };\n\n  var getDocument = function () {\n    return SugarElement.fromDom(document);\n  };\n\n  var focus = function (element) {\n    return element.dom.focus();\n  };\n\n  var hasFocus = function (element) {\n    var root = getRootNode(element).dom;\n    return element.dom === root.activeElement;\n  };\n\n  var active = function (root) {\n    if (root === void 0) {\n      root = getDocument();\n    }\n\n    return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);\n  };\n\n  var search = function (element) {\n    return active(getRootNode(element)).filter(function (e) {\n      return element.dom.contains(e.dom);\n    });\n  };\n\n  var create$4 = function (start, soffset, finish, foffset) {\n    return {\n      start: start,\n      soffset: soffset,\n      finish: finish,\n      foffset: foffset\n    };\n  };\n\n  var SimRange = {\n    create: create$4\n  };\n  var adt = Adt.generate([{\n    before: ['element']\n  }, {\n    on: ['element', 'offset']\n  }, {\n    after: ['element']\n  }]);\n\n  var cata = function (subject, onBefore, onOn, onAfter) {\n    return subject.fold(onBefore, onOn, onAfter);\n  };\n\n  var getStart = function (situ) {\n    return situ.fold(identity, identity, identity);\n  };\n\n  var before$3 = adt.before;\n  var on = adt.on;\n  var after$2 = adt.after;\n  var Situ = {\n    before: before$3,\n    on: on,\n    after: after$2,\n    cata: cata,\n    getStart: getStart\n  };\n  var adt$1 = Adt.generate([{\n    domRange: ['rng']\n  }, {\n    relative: ['startSitu', 'finishSitu']\n  }, {\n    exact: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var exactFromRange = function (simRange) {\n    return adt$1.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n  };\n\n  var getStart$1 = function (selection) {\n    return selection.match({\n      domRange: function (rng) {\n        return SugarElement.fromDom(rng.startContainer);\n      },\n      relative: function (startSitu, _finishSitu) {\n        return Situ.getStart(startSitu);\n      },\n      exact: function (start, _soffset, _finish, _foffset) {\n        return start;\n      }\n    });\n  };\n\n  var domRange = adt$1.domRange;\n  var relative = adt$1.relative;\n  var exact = adt$1.exact;\n\n  var getWin = function (selection) {\n    var start = getStart$1(selection);\n    return defaultView(start);\n  };\n\n  var range = SimRange.create;\n  var SimSelection = {\n    domRange: domRange,\n    relative: relative,\n    exact: exact,\n    exactFromRange: exactFromRange,\n    getWin: getWin,\n    range: range\n  };\n  var browser$3 = detect$3().browser;\n\n  var clamp = function (offset, element) {\n    var max = isText(element) ? get$8(element).length : children(element).length + 1;\n\n    if (offset > max) {\n      return max;\n    } else if (offset < 0) {\n      return 0;\n    }\n\n    return offset;\n  };\n\n  var normalizeRng = function (rng) {\n    return SimSelection.range(rng.start, clamp(rng.soffset, rng.start), rng.finish, clamp(rng.foffset, rng.finish));\n  };\n\n  var isOrContains = function (root, elm) {\n    return !isRestrictedNode(elm.dom) && (contains$2(root, elm) || eq$2(root, elm));\n  };\n\n  var isRngInRoot = function (root) {\n    return function (rng) {\n      return isOrContains(root, rng.start) && isOrContains(root, rng.finish);\n    };\n  };\n\n  var shouldStore = function (editor) {\n    return editor.inline === true || browser$3.isIE();\n  };\n\n  var nativeRangeToSelectionRange = function (r) {\n    return SimSelection.range(SugarElement.fromDom(r.startContainer), r.startOffset, SugarElement.fromDom(r.endContainer), r.endOffset);\n  };\n\n  var readRange = function (win) {\n    var selection = win.getSelection();\n    var rng = !selection || selection.rangeCount === 0 ? Optional.none() : Optional.from(selection.getRangeAt(0));\n    return rng.map(nativeRangeToSelectionRange);\n  };\n\n  var getBookmark$2 = function (root) {\n    var win = defaultView(root);\n    return readRange(win.dom).filter(isRngInRoot(root));\n  };\n\n  var validate = function (root, bookmark) {\n    return Optional.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng);\n  };\n\n  var bookmarkToNativeRng = function (bookmark) {\n    var rng = document.createRange();\n\n    try {\n      rng.setStart(bookmark.start.dom, bookmark.soffset);\n      rng.setEnd(bookmark.finish.dom, bookmark.foffset);\n      return Optional.some(rng);\n    } catch (_) {\n      return Optional.none();\n    }\n  };\n\n  var store = function (editor) {\n    var newBookmark = shouldStore(editor) ? getBookmark$2(SugarElement.fromDom(editor.getBody())) : Optional.none();\n    editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n  };\n\n  var storeNative = function (editor, rng) {\n    var root = SugarElement.fromDom(editor.getBody());\n    var range = shouldStore(editor) ? Optional.from(rng) : Optional.none();\n    var newBookmark = range.map(nativeRangeToSelectionRange).filter(isRngInRoot(root));\n    editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n  };\n\n  var getRng = function (editor) {\n    var bookmark = editor.bookmark ? editor.bookmark : Optional.none();\n    return bookmark.bind(function (x) {\n      return validate(SugarElement.fromDom(editor.getBody()), x);\n    }).bind(bookmarkToNativeRng);\n  };\n\n  var restore = function (editor) {\n    getRng(editor).each(function (rng) {\n      return editor.selection.setRng(rng);\n    });\n  };\n\n  var isEditorUIElement = function (elm) {\n    var className = elm.className.toString();\n    return className.indexOf('tox-') !== -1 || className.indexOf('mce-') !== -1;\n  };\n\n  var FocusManager = {\n    isEditorUIElement: isEditorUIElement\n  };\n\n  var isManualNodeChange = function (e) {\n    return e.type === 'nodechange' && e.selectionChange;\n  };\n\n  var registerPageMouseUp = function (editor, throttledStore) {\n    var mouseUpPage = function () {\n      throttledStore.throttle();\n    };\n\n    DOMUtils.DOM.bind(document, 'mouseup', mouseUpPage);\n    editor.on('remove', function () {\n      DOMUtils.DOM.unbind(document, 'mouseup', mouseUpPage);\n    });\n  };\n\n  var registerFocusOut = function (editor) {\n    editor.on('focusout', function () {\n      store(editor);\n    });\n  };\n\n  var registerMouseUp = function (editor, throttledStore) {\n    editor.on('mouseup touchend', function (_e) {\n      throttledStore.throttle();\n    });\n  };\n\n  var registerEditorEvents = function (editor, throttledStore) {\n    var browser = detect$3().browser;\n\n    if (browser.isIE()) {\n      registerFocusOut(editor);\n    } else {\n      registerMouseUp(editor, throttledStore);\n    }\n\n    editor.on('keyup NodeChange', function (e) {\n      if (!isManualNodeChange(e)) {\n        store(editor);\n      }\n    });\n  };\n\n  var register = function (editor) {\n    var throttledStore = first(function () {\n      store(editor);\n    }, 0);\n    editor.on('init', function () {\n      if (editor.inline) {\n        registerPageMouseUp(editor, throttledStore);\n      }\n\n      registerEditorEvents(editor, throttledStore);\n    });\n    editor.on('remove', function () {\n      throttledStore.cancel();\n    });\n  };\n\n  var documentFocusInHandler;\n  var DOM$2 = DOMUtils.DOM;\n\n  var isEditorUIElement$1 = function (elm) {\n    return FocusManager.isEditorUIElement(elm);\n  };\n\n  var isEditorContentAreaElement = function (elm) {\n    var classList = elm.classList;\n\n    if (classList !== undefined) {\n      return classList.contains('tox-edit-area') || classList.contains('tox-edit-area__iframe') || classList.contains('mce-content-body');\n    } else {\n      return false;\n    }\n  };\n\n  var isUIElement = function (editor, elm) {\n    var customSelector = getCustomUiSelector(editor);\n    var parent = DOM$2.getParent(elm, function (elm) {\n      return isEditorUIElement$1(elm) || (customSelector ? editor.dom.is(elm, customSelector) : false);\n    });\n    return parent !== null;\n  };\n\n  var getActiveElement = function (editor) {\n    try {\n      var root = getRootNode(SugarElement.fromDom(editor.getElement()));\n      return active(root).fold(function () {\n        return document.body;\n      }, function (x) {\n        return x.dom;\n      });\n    } catch (ex) {\n      return document.body;\n    }\n  };\n\n  var registerEvents = function (editorManager, e) {\n    var editor = e.editor;\n    register(editor);\n    editor.on('focusin', function () {\n      var focusedEditor = editorManager.focusedEditor;\n\n      if (focusedEditor !== editor) {\n        if (focusedEditor) {\n          focusedEditor.fire('blur', {\n            focusedEditor: editor\n          });\n        }\n\n        editorManager.setActive(editor);\n        editorManager.focusedEditor = editor;\n        editor.fire('focus', {\n          blurredEditor: focusedEditor\n        });\n        editor.focus(true);\n      }\n    });\n    editor.on('focusout', function () {\n      Delay.setEditorTimeout(editor, function () {\n        var focusedEditor = editorManager.focusedEditor;\n\n        if (!isUIElement(editor, getActiveElement(editor)) && focusedEditor === editor) {\n          editor.fire('blur', {\n            focusedEditor: null\n          });\n          editorManager.focusedEditor = null;\n        }\n      });\n    });\n\n    if (!documentFocusInHandler) {\n      documentFocusInHandler = function (e) {\n        var activeEditor = editorManager.activeEditor;\n\n        if (activeEditor) {\n          getOriginalEventTarget(e).each(function (target) {\n            if (target.ownerDocument === document) {\n              if (target !== document.body && !isUIElement(activeEditor, target) && editorManager.focusedEditor === activeEditor) {\n                activeEditor.fire('blur', {\n                  focusedEditor: null\n                });\n                editorManager.focusedEditor = null;\n              }\n            }\n          });\n        }\n      };\n\n      DOM$2.bind(document, 'focusin', documentFocusInHandler);\n    }\n  };\n\n  var unregisterDocumentEvents = function (editorManager, e) {\n    if (editorManager.focusedEditor === e.editor) {\n      editorManager.focusedEditor = null;\n    }\n\n    if (!editorManager.activeEditor) {\n      DOM$2.unbind(document, 'focusin', documentFocusInHandler);\n      documentFocusInHandler = null;\n    }\n  };\n\n  var setup$2 = function (editorManager) {\n    editorManager.on('AddEditor', curry(registerEvents, editorManager));\n    editorManager.on('RemoveEditor', curry(unregisterDocumentEvents, editorManager));\n  };\n\n  var getContentEditableHost = function (editor, node) {\n    return editor.dom.getParent(node, function (node) {\n      return editor.dom.getContentEditable(node) === 'true';\n    });\n  };\n\n  var getCollapsedNode = function (rng) {\n    return rng.collapsed ? Optional.from(getNode(rng.startContainer, rng.startOffset)).map(SugarElement.fromDom) : Optional.none();\n  };\n\n  var getFocusInElement = function (root, rng) {\n    return getCollapsedNode(rng).bind(function (node) {\n      if (isTableSection(node)) {\n        return Optional.some(node);\n      } else if (contains$2(root, node) === false) {\n        return Optional.some(root);\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var normalizeSelection = function (editor, rng) {\n    getFocusInElement(SugarElement.fromDom(editor.getBody()), rng).bind(function (elm) {\n      return firstPositionIn(elm.dom);\n    }).fold(function () {\n      editor.selection.normalize();\n      return;\n    }, function (caretPos) {\n      return editor.selection.setRng(caretPos.toRange());\n    });\n  };\n\n  var focusBody = function (body) {\n    if (body.setActive) {\n      try {\n        body.setActive();\n      } catch (ex) {\n        body.focus();\n      }\n    } else {\n      body.focus();\n    }\n  };\n\n  var hasElementFocus = function (elm) {\n    return hasFocus(elm) || search(elm).isSome();\n  };\n\n  var hasIframeFocus = function (editor) {\n    return editor.iframeElement && hasFocus(SugarElement.fromDom(editor.iframeElement));\n  };\n\n  var hasInlineFocus = function (editor) {\n    var rawBody = editor.getBody();\n    return rawBody && hasElementFocus(SugarElement.fromDom(rawBody));\n  };\n\n  var hasUiFocus = function (editor) {\n    var dos = getRootNode(SugarElement.fromDom(editor.getElement()));\n    return active(dos).filter(function (elem) {\n      return !isEditorContentAreaElement(elem.dom) && isUIElement(editor, elem.dom);\n    }).isSome();\n  };\n\n  var hasFocus$1 = function (editor) {\n    return editor.inline ? hasInlineFocus(editor) : hasIframeFocus(editor);\n  };\n\n  var hasEditorOrUiFocus = function (editor) {\n    return hasFocus$1(editor) || hasUiFocus(editor);\n  };\n\n  var focusEditor = function (editor) {\n    var selection = editor.selection;\n    var body = editor.getBody();\n    var rng = selection.getRng();\n    editor.quirks.refreshContentEditable();\n\n    if (editor.bookmark !== undefined && hasFocus$1(editor) === false) {\n      getRng(editor).each(function (bookmarkRng) {\n        editor.selection.setRng(bookmarkRng);\n        rng = bookmarkRng;\n      });\n    }\n\n    var contentEditableHost = getContentEditableHost(editor, selection.getNode());\n\n    if (editor.$.contains(body, contentEditableHost)) {\n      focusBody(contentEditableHost);\n      normalizeSelection(editor, rng);\n      activateEditor(editor);\n      return;\n    }\n\n    if (!editor.inline) {\n      if (!Env.opera) {\n        focusBody(body);\n      }\n\n      editor.getWin().focus();\n    }\n\n    if (Env.gecko || editor.inline) {\n      focusBody(body);\n      normalizeSelection(editor, rng);\n    }\n\n    activateEditor(editor);\n  };\n\n  var activateEditor = function (editor) {\n    return editor.editorManager.setActive(editor);\n  };\n\n  var focus$1 = function (editor, skipFocus) {\n    if (editor.removed) {\n      return;\n    }\n\n    skipFocus ? activateEditor(editor) : focusEditor(editor);\n  };\n\n  var getEndpointElement = function (root, rng, start, real, resolve) {\n    var container = start ? rng.startContainer : rng.endContainer;\n    var offset = start ? rng.startOffset : rng.endOffset;\n    return Optional.from(container).map(SugarElement.fromDom).map(function (elm) {\n      return !real || !rng.collapsed ? child(elm, resolve(elm, offset)).getOr(elm) : elm;\n    }).bind(function (elm) {\n      return isElement(elm) ? Optional.some(elm) : parent(elm).filter(isElement);\n    }).map(function (elm) {\n      return elm.dom;\n    }).getOr(root);\n  };\n\n  var getStart$2 = function (root, rng, real) {\n    return getEndpointElement(root, rng, true, real, function (elm, offset) {\n      return Math.min(childNodesCount(elm), offset);\n    });\n  };\n\n  var getEnd = function (root, rng, real) {\n    return getEndpointElement(root, rng, false, real, function (elm, offset) {\n      return offset > 0 ? offset - 1 : offset;\n    });\n  };\n\n  var skipEmptyTextNodes = function (node, forwards) {\n    var orig = node;\n\n    while (node && isText$1(node) && node.length === 0) {\n      node = forwards ? node.nextSibling : node.previousSibling;\n    }\n\n    return node || orig;\n  };\n\n  var getNode$1 = function (root, rng) {\n    var elm, startContainer, endContainer;\n\n    if (!rng) {\n      return root;\n    }\n\n    startContainer = rng.startContainer;\n    endContainer = rng.endContainer;\n    var startOffset = rng.startOffset;\n    var endOffset = rng.endOffset;\n    elm = rng.commonAncestorContainer;\n\n    if (!rng.collapsed) {\n      if (startContainer === endContainer) {\n        if (endOffset - startOffset < 2) {\n          if (startContainer.hasChildNodes()) {\n            elm = startContainer.childNodes[startOffset];\n          }\n        }\n      }\n\n      if (startContainer.nodeType === 3 && endContainer.nodeType === 3) {\n        if (startContainer.length === startOffset) {\n          startContainer = skipEmptyTextNodes(startContainer.nextSibling, true);\n        } else {\n          startContainer = startContainer.parentNode;\n        }\n\n        if (endOffset === 0) {\n          endContainer = skipEmptyTextNodes(endContainer.previousSibling, false);\n        } else {\n          endContainer = endContainer.parentNode;\n        }\n\n        if (startContainer && startContainer === endContainer) {\n          return startContainer;\n        }\n      }\n    }\n\n    if (elm && elm.nodeType === 3) {\n      return elm.parentNode;\n    }\n\n    return elm;\n  };\n\n  var getSelectedBlocks = function (dom, rng, startElm, endElm) {\n    var node;\n    var selectedBlocks = [];\n    var root = dom.getRoot();\n    startElm = dom.getParent(startElm || getStart$2(root, rng, rng.collapsed), dom.isBlock);\n    endElm = dom.getParent(endElm || getEnd(root, rng, rng.collapsed), dom.isBlock);\n\n    if (startElm && startElm !== root) {\n      selectedBlocks.push(startElm);\n    }\n\n    if (startElm && endElm && startElm !== endElm) {\n      node = startElm;\n      var walker = new DomTreeWalker(startElm, root);\n\n      while ((node = walker.next()) && node !== endElm) {\n        if (dom.isBlock(node)) {\n          selectedBlocks.push(node);\n        }\n      }\n    }\n\n    if (endElm && startElm !== endElm && endElm !== root) {\n      selectedBlocks.push(endElm);\n    }\n\n    return selectedBlocks;\n  };\n\n  var select$1 = function (dom, node, content) {\n    return Optional.from(node).map(function (node) {\n      var idx = dom.nodeIndex(node);\n      var rng = dom.createRng();\n      rng.setStart(node.parentNode, idx);\n      rng.setEnd(node.parentNode, idx + 1);\n\n      if (content) {\n        moveEndPoint$1(dom, rng, node, true);\n        moveEndPoint$1(dom, rng, node, false);\n      }\n\n      return rng;\n    });\n  };\n\n  var processRanges = function (editor, ranges) {\n    return map(ranges, function (range) {\n      var evt = editor.fire('GetSelectionRange', {\n        range: range\n      });\n      return evt.range !== range ? evt.range : range;\n    });\n  };\n\n  var typeLookup = {\n    '#text': 3,\n    '#comment': 8,\n    '#cdata': 4,\n    '#pi': 7,\n    '#doctype': 10,\n    '#document-fragment': 11\n  };\n\n  var walk$2 = function (node, root, prev) {\n    var startName = prev ? 'lastChild' : 'firstChild';\n    var siblingName = prev ? 'prev' : 'next';\n\n    if (node[startName]) {\n      return node[startName];\n    }\n\n    if (node !== root) {\n      var sibling = node[siblingName];\n\n      if (sibling) {\n        return sibling;\n      }\n\n      for (var parent_1 = node.parent; parent_1 && parent_1 !== root; parent_1 = parent_1.parent) {\n        sibling = parent_1[siblingName];\n\n        if (sibling) {\n          return sibling;\n        }\n      }\n    }\n  };\n\n  var isEmptyTextNode$1 = function (node) {\n    if (!isWhitespaceText(node.value)) {\n      return false;\n    }\n\n    var parentNode = node.parent;\n\n    if (parentNode && (parentNode.name !== 'span' || parentNode.attr('style')) && /^[ ]+$/.test(node.value)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  var isNonEmptyElement = function (node) {\n    var isNamedAnchor = node.name === 'a' && !node.attr('href') && node.attr('id');\n    return node.attr('name') || node.attr('id') && !node.firstChild || node.attr('data-mce-bookmark') || isNamedAnchor;\n  };\n\n  var AstNode = function () {\n    function AstNode(name, type) {\n      this.name = name;\n      this.type = type;\n\n      if (type === 1) {\n        this.attributes = [];\n        this.attributes.map = {};\n      }\n    }\n\n    AstNode.create = function (name, attrs) {\n      var node = new AstNode(name, typeLookup[name] || 1);\n\n      if (attrs) {\n        each$1(attrs, function (value, attrName) {\n          node.attr(attrName, value);\n        });\n      }\n\n      return node;\n    };\n\n    AstNode.prototype.replace = function (node) {\n      var self = this;\n\n      if (node.parent) {\n        node.remove();\n      }\n\n      self.insert(node, self);\n      self.remove();\n      return self;\n    };\n\n    AstNode.prototype.attr = function (name, value) {\n      var self = this;\n      var attrs;\n\n      if (typeof name !== 'string') {\n        if (name !== undefined && name !== null) {\n          each$1(name, function (value, key) {\n            self.attr(key, value);\n          });\n        }\n\n        return self;\n      }\n\n      if (attrs = self.attributes) {\n        if (value !== undefined) {\n          if (value === null) {\n            if (name in attrs.map) {\n              delete attrs.map[name];\n              var i = attrs.length;\n\n              while (i--) {\n                if (attrs[i].name === name) {\n                  attrs.splice(i, 1);\n                  return self;\n                }\n              }\n            }\n\n            return self;\n          }\n\n          if (name in attrs.map) {\n            var i = attrs.length;\n\n            while (i--) {\n              if (attrs[i].name === name) {\n                attrs[i].value = value;\n                break;\n              }\n            }\n          } else {\n            attrs.push({\n              name: name,\n              value: value\n            });\n          }\n\n          attrs.map[name] = value;\n          return self;\n        }\n\n        return attrs.map[name];\n      }\n    };\n\n    AstNode.prototype.clone = function () {\n      var self = this;\n      var clone = new AstNode(self.name, self.type);\n      var selfAttrs;\n\n      if (selfAttrs = self.attributes) {\n        var cloneAttrs = [];\n        cloneAttrs.map = {};\n\n        for (var i = 0, l = selfAttrs.length; i < l; i++) {\n          var selfAttr = selfAttrs[i];\n\n          if (selfAttr.name !== 'id') {\n            cloneAttrs[cloneAttrs.length] = {\n              name: selfAttr.name,\n              value: selfAttr.value\n            };\n            cloneAttrs.map[selfAttr.name] = selfAttr.value;\n          }\n        }\n\n        clone.attributes = cloneAttrs;\n      }\n\n      clone.value = self.value;\n      clone.shortEnded = self.shortEnded;\n      return clone;\n    };\n\n    AstNode.prototype.wrap = function (wrapper) {\n      var self = this;\n      self.parent.insert(wrapper, self);\n      wrapper.append(self);\n      return self;\n    };\n\n    AstNode.prototype.unwrap = function () {\n      var self = this;\n\n      for (var node = self.firstChild; node;) {\n        var next = node.next;\n        self.insert(node, self, true);\n        node = next;\n      }\n\n      self.remove();\n    };\n\n    AstNode.prototype.remove = function () {\n      var self = this,\n          parent = self.parent,\n          next = self.next,\n          prev = self.prev;\n\n      if (parent) {\n        if (parent.firstChild === self) {\n          parent.firstChild = next;\n\n          if (next) {\n            next.prev = null;\n          }\n        } else {\n          prev.next = next;\n        }\n\n        if (parent.lastChild === self) {\n          parent.lastChild = prev;\n\n          if (prev) {\n            prev.next = null;\n          }\n        } else {\n          next.prev = prev;\n        }\n\n        self.parent = self.next = self.prev = null;\n      }\n\n      return self;\n    };\n\n    AstNode.prototype.append = function (node) {\n      var self = this;\n\n      if (node.parent) {\n        node.remove();\n      }\n\n      var last = self.lastChild;\n\n      if (last) {\n        last.next = node;\n        node.prev = last;\n        self.lastChild = node;\n      } else {\n        self.lastChild = self.firstChild = node;\n      }\n\n      node.parent = self;\n      return node;\n    };\n\n    AstNode.prototype.insert = function (node, refNode, before) {\n      if (node.parent) {\n        node.remove();\n      }\n\n      var parent = refNode.parent || this;\n\n      if (before) {\n        if (refNode === parent.firstChild) {\n          parent.firstChild = node;\n        } else {\n          refNode.prev.next = node;\n        }\n\n        node.prev = refNode.prev;\n        node.next = refNode;\n        refNode.prev = node;\n      } else {\n        if (refNode === parent.lastChild) {\n          parent.lastChild = node;\n        } else {\n          refNode.next.prev = node;\n        }\n\n        node.next = refNode.next;\n        node.prev = refNode;\n        refNode.next = node;\n      }\n\n      node.parent = parent;\n      return node;\n    };\n\n    AstNode.prototype.getAll = function (name) {\n      var self = this;\n      var collection = [];\n\n      for (var node = self.firstChild; node; node = walk$2(node, self)) {\n        if (node.name === name) {\n          collection.push(node);\n        }\n      }\n\n      return collection;\n    };\n\n    AstNode.prototype.empty = function () {\n      var self = this;\n\n      if (self.firstChild) {\n        var nodes = [];\n\n        for (var node = self.firstChild; node; node = walk$2(node, self)) {\n          nodes.push(node);\n        }\n\n        var i = nodes.length;\n\n        while (i--) {\n          var node = nodes[i];\n          node.parent = node.firstChild = node.lastChild = node.next = node.prev = null;\n        }\n      }\n\n      self.firstChild = self.lastChild = null;\n      return self;\n    };\n\n    AstNode.prototype.isEmpty = function (elements, whitespace, predicate) {\n      if (whitespace === void 0) {\n        whitespace = {};\n      }\n\n      var self = this;\n      var node = self.firstChild;\n\n      if (isNonEmptyElement(self)) {\n        return false;\n      }\n\n      if (node) {\n        do {\n          if (node.type === 1) {\n            if (node.attr('data-mce-bogus')) {\n              continue;\n            }\n\n            if (elements[node.name]) {\n              return false;\n            }\n\n            if (isNonEmptyElement(node)) {\n              return false;\n            }\n          }\n\n          if (node.type === 8) {\n            return false;\n          }\n\n          if (node.type === 3 && !isEmptyTextNode$1(node)) {\n            return false;\n          }\n\n          if (node.type === 3 && node.parent && whitespace[node.parent.name] && isWhitespaceText(node.value)) {\n            return false;\n          }\n\n          if (predicate && predicate(node)) {\n            return false;\n          }\n        } while (node = walk$2(node, self));\n      }\n\n      return true;\n    };\n\n    AstNode.prototype.walk = function (prev) {\n      return walk$2(this, null, prev);\n    };\n\n    return AstNode;\n  }();\n\n  var extractBase64DataUris = function (html) {\n    var dataImageUri = /data:[^;]+;base64,([a-z0-9\\+\\/=]+)/gi;\n    var chunks = [];\n    var uris = {};\n    var prefix = generate$1('img');\n    var matches;\n    var index = 0;\n    var count = 0;\n\n    while (matches = dataImageUri.exec(html)) {\n      var uri = matches[0];\n      var imageId = prefix + '_' + count++;\n      uris[imageId] = uri;\n\n      if (index < matches.index) {\n        chunks.push(html.substr(index, matches.index - index));\n      }\n\n      chunks.push(imageId);\n      index = matches.index + uri.length;\n    }\n\n    var re = new RegExp(prefix + '_[0-9]+', 'g');\n\n    if (index === 0) {\n      return {\n        prefix: prefix,\n        uris: uris,\n        html: html,\n        re: re\n      };\n    } else {\n      if (index < html.length) {\n        chunks.push(html.substr(index));\n      }\n\n      return {\n        prefix: prefix,\n        uris: uris,\n        html: chunks.join(''),\n        re: re\n      };\n    }\n  };\n\n  var restoreDataUris = function (html, result) {\n    return html.replace(result.re, function (imageId) {\n      return get$1(result.uris, imageId).getOr(imageId);\n    });\n  };\n\n  var parseDataUri = function (uri) {\n    var matches = /data:([^;]+);base64,([a-z0-9\\+\\/=]+)/i.exec(uri);\n\n    if (matches) {\n      return Optional.some({\n        type: matches[1],\n        data: decodeURIComponent(matches[2])\n      });\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var safeSvgDataUrlElements = ['img', 'video'];\n\n  var isValidPrefixAttrName = function (name) {\n    return name.indexOf('data-') === 0 || name.indexOf('aria-') === 0;\n  };\n\n  var blockSvgDataUris = function (allowSvgDataUrls, tagName) {\n    var allowed = isNullable(allowSvgDataUrls) ? contains(safeSvgDataUrlElements, tagName) : allowSvgDataUrls;\n    return !allowed;\n  };\n\n  var isInvalidUri = function (settings, uri, tagName) {\n    if (settings.allow_html_data_urls) {\n      return false;\n    } else if (/^data:image\\//i.test(uri)) {\n      return blockSvgDataUris(settings.allow_svg_data_urls, tagName) && /^data:image\\/svg\\+xml/i.test(uri);\n    } else {\n      return /^data:/i.test(uri);\n    }\n  };\n\n  var findEndTagIndex = function (schema, html, startIndex) {\n    var count = 1,\n        index,\n        matches;\n    var shortEndedElements = schema.getShortEndedElements();\n    var tokenRegExp = /<([!?\\/])?([A-Za-z0-9\\-_:.]+)(\\s(?:[^'\">]+(?:\"[^\"]*\"|'[^']*'))*[^\"'>]*(?:\"[^\">]*|'[^'>]*)?|\\s*|\\/)>/g;\n    tokenRegExp.lastIndex = index = startIndex;\n\n    while (matches = tokenRegExp.exec(html)) {\n      index = tokenRegExp.lastIndex;\n\n      if (matches[1] === '/') {\n        count--;\n      } else if (!matches[1]) {\n        if (matches[2] in shortEndedElements) {\n          continue;\n        }\n\n        count++;\n      }\n\n      if (count === 0) {\n        break;\n      }\n    }\n\n    return index;\n  };\n\n  var isConditionalComment = function (html, startIndex) {\n    return /^\\s*\\[if [\\w\\W]+\\]>.*<!\\[endif\\](--!?)?>/.test(html.substr(startIndex));\n  };\n\n  var findCommentEndIndex = function (html, isBogus, startIndex) {\n    if (startIndex === void 0) {\n      startIndex = 0;\n    }\n\n    var lcHtml = html.toLowerCase();\n\n    if (lcHtml.indexOf('[if ', startIndex) !== -1 && isConditionalComment(lcHtml, startIndex)) {\n      var endIfIndex = lcHtml.indexOf('[endif]', startIndex);\n      return lcHtml.indexOf('>', endIfIndex);\n    } else {\n      if (isBogus) {\n        var endIndex = lcHtml.indexOf('>', startIndex);\n        return endIndex !== -1 ? endIndex : lcHtml.length;\n      } else {\n        var endCommentRegexp = /--!?>/g;\n        endCommentRegexp.lastIndex = startIndex;\n        var match = endCommentRegexp.exec(html);\n        return match ? match.index + match[0].length : lcHtml.length;\n      }\n    }\n  };\n\n  var checkBogusAttribute = function (regExp, attrString) {\n    var matches = regExp.exec(attrString);\n\n    if (matches) {\n      var name_1 = matches[1];\n      var value = matches[2];\n      return typeof name_1 === 'string' && name_1.toLowerCase() === 'data-mce-bogus' ? value : null;\n    } else {\n      return null;\n    }\n  };\n\n  var SaxParser = function (settings, schema) {\n    if (schema === void 0) {\n      schema = Schema();\n    }\n\n    settings = settings || {};\n\n    if (settings.fix_self_closing !== false) {\n      settings.fix_self_closing = true;\n    }\n\n    var comment = settings.comment ? settings.comment : noop;\n    var cdata = settings.cdata ? settings.cdata : noop;\n    var text = settings.text ? settings.text : noop;\n    var start = settings.start ? settings.start : noop;\n    var end = settings.end ? settings.end : noop;\n    var pi = settings.pi ? settings.pi : noop;\n    var doctype = settings.doctype ? settings.doctype : noop;\n\n    var parseInternal = function (base64Extract, format) {\n      if (format === void 0) {\n        format = 'html';\n      }\n\n      var html = base64Extract.html;\n      var matches,\n          index = 0,\n          value,\n          endRegExp;\n      var stack = [];\n      var attrList, i, textData, name;\n      var isInternalElement, isShortEnded;\n      var elementRule, isValidElement, attr, attribsValue, validAttributesMap, validAttributePatterns;\n      var attributesRequired, attributesDefault, attributesForced;\n      var anyAttributesRequired,\n          attrValue,\n          idCount = 0;\n      var decode = Entities.decode;\n      var filteredUrlAttrs = Tools.makeMap('src,href,data,background,action,formaction,poster,xlink:href');\n      var scriptUriRegExp = /((java|vb)script|mhtml):/i;\n      var parsingMode = format === 'html' ? 0 : 1;\n\n      var processEndTag = function (name) {\n        var pos, i;\n        pos = stack.length;\n\n        while (pos--) {\n          if (stack[pos].name === name) {\n            break;\n          }\n        }\n\n        if (pos >= 0) {\n          for (i = stack.length - 1; i >= pos; i--) {\n            name = stack[i];\n\n            if (name.valid) {\n              end(name.name);\n            }\n          }\n\n          stack.length = pos;\n        }\n      };\n\n      var processText = function (value, raw) {\n        return text(restoreDataUris(value, base64Extract), raw);\n      };\n\n      var processComment = function (value) {\n        if (value === '') {\n          return;\n        }\n\n        if (value.charAt(0) === '>') {\n          value = ' ' + value;\n        }\n\n        if (!settings.allow_conditional_comments && value.substr(0, 3).toLowerCase() === '[if') {\n          value = ' ' + value;\n        }\n\n        comment(restoreDataUris(value, base64Extract));\n      };\n\n      var processAttr = function (value) {\n        return restoreDataUris(value, base64Extract);\n      };\n\n      var processMalformedComment = function (value, startIndex) {\n        var startTag = value || '';\n        var isBogus = !startsWith(startTag, '--');\n        var endIndex = findCommentEndIndex(html, isBogus, startIndex);\n        value = html.substr(startIndex, endIndex - startIndex);\n        processComment(isBogus ? startTag + value : value);\n        return endIndex + 1;\n      };\n\n      var parseAttribute = function (tagName, name, value, val2, val3) {\n        var attrRule, i;\n        var trimRegExp = /[\\s\\u0000-\\u001F]+/g;\n        name = name.toLowerCase();\n        value = processAttr(name in fillAttrsMap ? name : decode(value || val2 || val3 || ''));\n\n        if (validate && !isInternalElement && isValidPrefixAttrName(name) === false) {\n          attrRule = validAttributesMap[name];\n\n          if (!attrRule && validAttributePatterns) {\n            i = validAttributePatterns.length;\n\n            while (i--) {\n              attrRule = validAttributePatterns[i];\n\n              if (attrRule.pattern.test(name)) {\n                break;\n              }\n            }\n\n            if (i === -1) {\n              attrRule = null;\n            }\n          }\n\n          if (!attrRule) {\n            return;\n          }\n\n          if (attrRule.validValues && !(value in attrRule.validValues)) {\n            return;\n          }\n        }\n\n        if (filteredUrlAttrs[name] && !settings.allow_script_urls) {\n          var uri = value.replace(trimRegExp, '');\n\n          try {\n            uri = decodeURIComponent(uri);\n          } catch (ex) {\n            uri = unescape(uri);\n          }\n\n          if (scriptUriRegExp.test(uri)) {\n            return;\n          }\n\n          if (isInvalidUri(settings, uri, tagName)) {\n            return;\n          }\n        }\n\n        if (isInternalElement && (name in filteredUrlAttrs || name.indexOf('on') === 0)) {\n          return;\n        }\n\n        attrList.map[name] = value;\n        attrList.push({\n          name: name,\n          value: value\n        });\n      };\n\n      var tokenRegExp = new RegExp('<(?:' + '(?:!--([\\\\w\\\\W]*?)--!?>)|' + '(?:!\\\\[CDATA\\\\[([\\\\w\\\\W]*?)\\\\]\\\\]>)|' + '(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\\\w\\\\W]*?)>)|' + '(?:!(--)?)|' + '(?:\\\\?([^\\\\s\\\\/<>]+) ?([\\\\w\\\\W]*?)[?/]>)|' + '(?:\\\\/([A-Za-z][A-Za-z0-9\\\\-_\\\\:\\\\.]*)>)|' + '(?:([A-Za-z][A-Za-z0-9\\\\-_:.]*)(\\\\s(?:[^\\'\">]+(?:\"[^\"]*\"|\\'[^\\']*\\'))*[^\"\\'>]*(?:\"[^\">]*|\\'[^\\'>]*)?|\\\\s*|\\\\/)>)' + ')', 'g');\n      var attrRegExp = /([\\w:\\-]+)(?:\\s*=\\s*(?:(?:\\\"((?:[^\\\"])*)\\\")|(?:\\'((?:[^\\'])*)\\')|([^>\\s]+)))?/g;\n      var shortEndedElements = schema.getShortEndedElements();\n      var selfClosing = settings.self_closing_elements || schema.getSelfClosingElements();\n      var fillAttrsMap = schema.getBoolAttrs();\n      var validate = settings.validate;\n      var removeInternalElements = settings.remove_internals;\n      var fixSelfClosing = settings.fix_self_closing;\n      var specialElements = schema.getSpecialElements();\n      var processHtml = html + '>';\n\n      while (matches = tokenRegExp.exec(processHtml)) {\n        var matchText = matches[0];\n\n        if (index < matches.index) {\n          processText(decode(html.substr(index, matches.index - index)));\n        }\n\n        if (value = matches[7]) {\n          value = value.toLowerCase();\n\n          if (value.charAt(0) === ':') {\n            value = value.substr(1);\n          }\n\n          processEndTag(value);\n        } else if (value = matches[8]) {\n          if (matches.index + matchText.length > html.length) {\n            processText(decode(html.substr(matches.index)));\n            index = matches.index + matchText.length;\n            continue;\n          }\n\n          value = value.toLowerCase();\n\n          if (value.charAt(0) === ':') {\n            value = value.substr(1);\n          }\n\n          isShortEnded = value in shortEndedElements;\n\n          if (fixSelfClosing && selfClosing[value] && stack.length > 0 && stack[stack.length - 1].name === value) {\n            processEndTag(value);\n          }\n\n          var bogusValue = checkBogusAttribute(attrRegExp, matches[9]);\n\n          if (bogusValue !== null) {\n            if (bogusValue === 'all') {\n              index = findEndTagIndex(schema, html, tokenRegExp.lastIndex);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n\n            isValidElement = false;\n          }\n\n          if (!validate || (elementRule = schema.getElementRule(value))) {\n            isValidElement = true;\n\n            if (validate) {\n              validAttributesMap = elementRule.attributes;\n              validAttributePatterns = elementRule.attributePatterns;\n            }\n\n            if (attribsValue = matches[9]) {\n              isInternalElement = attribsValue.indexOf('data-mce-type') !== -1;\n\n              if (isInternalElement && removeInternalElements) {\n                isValidElement = false;\n              }\n\n              attrList = [];\n              attrList.map = {};\n              attribsValue.replace(attrRegExp, function (match, name, val, val2, val3) {\n                parseAttribute(value, name, val, val2, val3);\n                return '';\n              });\n            } else {\n              attrList = [];\n              attrList.map = {};\n            }\n\n            if (validate && !isInternalElement) {\n              attributesRequired = elementRule.attributesRequired;\n              attributesDefault = elementRule.attributesDefault;\n              attributesForced = elementRule.attributesForced;\n              anyAttributesRequired = elementRule.removeEmptyAttrs;\n\n              if (anyAttributesRequired && !attrList.length) {\n                isValidElement = false;\n              }\n\n              if (attributesForced) {\n                i = attributesForced.length;\n\n                while (i--) {\n                  attr = attributesForced[i];\n                  name = attr.name;\n                  attrValue = attr.value;\n\n                  if (attrValue === '{$uid}') {\n                    attrValue = 'mce_' + idCount++;\n                  }\n\n                  attrList.map[name] = attrValue;\n                  attrList.push({\n                    name: name,\n                    value: attrValue\n                  });\n                }\n              }\n\n              if (attributesDefault) {\n                i = attributesDefault.length;\n\n                while (i--) {\n                  attr = attributesDefault[i];\n                  name = attr.name;\n\n                  if (!(name in attrList.map)) {\n                    attrValue = attr.value;\n\n                    if (attrValue === '{$uid}') {\n                      attrValue = 'mce_' + idCount++;\n                    }\n\n                    attrList.map[name] = attrValue;\n                    attrList.push({\n                      name: name,\n                      value: attrValue\n                    });\n                  }\n                }\n              }\n\n              if (attributesRequired) {\n                i = attributesRequired.length;\n\n                while (i--) {\n                  if (attributesRequired[i] in attrList.map) {\n                    break;\n                  }\n                }\n\n                if (i === -1) {\n                  isValidElement = false;\n                }\n              }\n\n              if (attr = attrList.map['data-mce-bogus']) {\n                if (attr === 'all') {\n                  index = findEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                  tokenRegExp.lastIndex = index;\n                  continue;\n                }\n\n                isValidElement = false;\n              }\n            }\n\n            if (isValidElement) {\n              start(value, attrList, isShortEnded);\n            }\n          } else {\n            isValidElement = false;\n          }\n\n          if (endRegExp = specialElements[value]) {\n            endRegExp.lastIndex = index = matches.index + matchText.length;\n\n            if (matches = endRegExp.exec(html)) {\n              if (isValidElement) {\n                textData = html.substr(index, matches.index - index);\n              }\n\n              index = matches.index + matches[0].length;\n            } else {\n              textData = html.substr(index);\n              index = html.length;\n            }\n\n            if (isValidElement) {\n              if (textData.length > 0) {\n                processText(textData, true);\n              }\n\n              end(value);\n            }\n\n            tokenRegExp.lastIndex = index;\n            continue;\n          }\n\n          if (!isShortEnded) {\n            if (!attribsValue || attribsValue.indexOf('/') !== attribsValue.length - 1) {\n              stack.push({\n                name: value,\n                valid: isValidElement\n              });\n            } else if (isValidElement) {\n              end(value);\n            }\n          }\n        } else if (value = matches[1]) {\n          processComment(value);\n        } else if (value = matches[2]) {\n          var isValidCdataSection = parsingMode === 1 || settings.preserve_cdata || stack.length > 0 && schema.isValidChild(stack[stack.length - 1].name, '#cdata');\n\n          if (isValidCdataSection) {\n            cdata(value);\n          } else {\n            index = processMalformedComment('', matches.index + 2);\n            tokenRegExp.lastIndex = index;\n            continue;\n          }\n        } else if (value = matches[3]) {\n          doctype(value);\n        } else if ((value = matches[4]) || matchText === '<!') {\n          index = processMalformedComment(value, matches.index + matchText.length);\n          tokenRegExp.lastIndex = index;\n          continue;\n        } else if (value = matches[5]) {\n          if (parsingMode === 1) {\n            pi(value, matches[6]);\n          } else {\n            index = processMalformedComment('?', matches.index + 2);\n            tokenRegExp.lastIndex = index;\n            continue;\n          }\n        }\n\n        index = matches.index + matchText.length;\n      }\n\n      if (index < html.length) {\n        processText(decode(html.substr(index)));\n      }\n\n      for (i = stack.length - 1; i >= 0; i--) {\n        value = stack[i];\n\n        if (value.valid) {\n          end(value.name);\n        }\n      }\n    };\n\n    var parse = function (html, format) {\n      if (format === void 0) {\n        format = 'html';\n      }\n\n      parseInternal(extractBase64DataUris(html), format);\n    };\n\n    return {\n      parse: parse\n    };\n  };\n\n  SaxParser.findEndTag = findEndTagIndex;\n\n  var trimHtml = function (tempAttrs, html) {\n    var trimContentRegExp = new RegExp(['\\\\s?(' + tempAttrs.join('|') + ')=\"[^\"]+\"'].join('|'), 'gi');\n    return html.replace(trimContentRegExp, '');\n  };\n\n  var trimInternal = function (serializer, html) {\n    var content = html;\n    var bogusAllRegExp = /<(\\w+) [^>]*data-mce-bogus=\"all\"[^>]*>/g;\n    var endTagIndex, index, matchLength, matches;\n    var schema = serializer.schema;\n    content = trimHtml(serializer.getTempAttrs(), content);\n    var shortEndedElements = schema.getShortEndedElements();\n\n    while (matches = bogusAllRegExp.exec(content)) {\n      index = bogusAllRegExp.lastIndex;\n      matchLength = matches[0].length;\n\n      if (shortEndedElements[matches[1]]) {\n        endTagIndex = index;\n      } else {\n        endTagIndex = SaxParser.findEndTag(schema, content, index);\n      }\n\n      content = content.substring(0, index - matchLength) + content.substring(endTagIndex);\n      bogusAllRegExp.lastIndex = index - matchLength;\n    }\n\n    return trim$2(content);\n  };\n\n  var trimExternal = trimInternal;\n\n  var trimEmptyContents = function (editor, html) {\n    var blockName = getForcedRootBlock(editor);\n    var emptyRegExp = new RegExp('^(<' + blockName + '[^>]*>(&nbsp;|&#160;|\\\\s|\\xA0|<br \\\\/>|)<\\\\/' + blockName + '>[\\r\\n]*|<br \\\\/>[\\r\\n]*)$');\n    return html.replace(emptyRegExp, '');\n  };\n\n  var getContentFromBody = function (editor, args, format, body) {\n    var content;\n    args.format = format;\n    args.get = true;\n    args.getInner = true;\n\n    if (!args.no_events) {\n      editor.fire('BeforeGetContent', args);\n    }\n\n    if (args.format === 'raw') {\n      content = Tools.trim(trimExternal(editor.serializer, body.innerHTML));\n    } else if (args.format === 'text') {\n      content = editor.dom.isEmpty(body) ? '' : trim$2(body.innerText || body.textContent);\n    } else if (args.format === 'tree') {\n      content = editor.serializer.serialize(body, args);\n    } else {\n      content = trimEmptyContents(editor, editor.serializer.serialize(body, args));\n    }\n\n    if (!contains(['text', 'tree'], args.format) && !isWsPreserveElement(SugarElement.fromDom(body))) {\n      args.content = Tools.trim(content);\n    } else {\n      args.content = content;\n    }\n\n    if (!args.no_events) {\n      editor.fire('GetContent', args);\n    }\n\n    return args.content;\n  };\n\n  var getContentInternal = function (editor, args, format) {\n    return Optional.from(editor.getBody()).fold(constant(args.format === 'tree' ? new AstNode('body', 11) : ''), function (body) {\n      return getContentFromBody(editor, args, format, body);\n    });\n  };\n\n  var each$7 = Tools.each;\n\n  var ElementUtils = function (dom) {\n    var compare = function (node1, node2) {\n      if (node1.nodeName !== node2.nodeName) {\n        return false;\n      }\n\n      var getAttribs = function (node) {\n        var attribs = {};\n        each$7(dom.getAttribs(node), function (attr) {\n          var name = attr.nodeName.toLowerCase();\n\n          if (name.indexOf('_') !== 0 && name !== 'style' && name.indexOf('data-') !== 0) {\n            attribs[name] = dom.getAttrib(node, name);\n          }\n        });\n        return attribs;\n      };\n\n      var compareObjects = function (obj1, obj2) {\n        var value, name;\n\n        for (name in obj1) {\n          if (obj1.hasOwnProperty(name)) {\n            value = obj2[name];\n\n            if (typeof value === 'undefined') {\n              return false;\n            }\n\n            if (obj1[name] !== value) {\n              return false;\n            }\n\n            delete obj2[name];\n          }\n        }\n\n        for (name in obj2) {\n          if (obj2.hasOwnProperty(name)) {\n            return false;\n          }\n        }\n\n        return true;\n      };\n\n      if (!compareObjects(getAttribs(node1), getAttribs(node2))) {\n        return false;\n      }\n\n      if (!compareObjects(dom.parseStyle(dom.getAttrib(node1, 'style')), dom.parseStyle(dom.getAttrib(node2, 'style')))) {\n        return false;\n      }\n\n      return !isBookmarkNode$1(node1) && !isBookmarkNode$1(node2);\n    };\n\n    return {\n      compare: compare\n    };\n  };\n\n  var makeMap$3 = Tools.makeMap;\n\n  var Writer = function (settings) {\n    var html = [];\n    settings = settings || {};\n    var indent = settings.indent;\n    var indentBefore = makeMap$3(settings.indent_before || '');\n    var indentAfter = makeMap$3(settings.indent_after || '');\n    var encode = Entities.getEncodeFunc(settings.entity_encoding || 'raw', settings.entities);\n    var htmlOutput = settings.element_format === 'html';\n    return {\n      start: function (name, attrs, empty) {\n        var i, l, attr, value;\n\n        if (indent && indentBefore[name] && html.length > 0) {\n          value = html[html.length - 1];\n\n          if (value.length > 0 && value !== '\\n') {\n            html.push('\\n');\n          }\n        }\n\n        html.push('<', name);\n\n        if (attrs) {\n          for (i = 0, l = attrs.length; i < l; i++) {\n            attr = attrs[i];\n            html.push(' ', attr.name, '=\"', encode(attr.value, true), '\"');\n          }\n        }\n\n        if (!empty || htmlOutput) {\n          html[html.length] = '>';\n        } else {\n          html[html.length] = ' />';\n        }\n\n        if (empty && indent && indentAfter[name] && html.length > 0) {\n          value = html[html.length - 1];\n\n          if (value.length > 0 && value !== '\\n') {\n            html.push('\\n');\n          }\n        }\n      },\n      end: function (name) {\n        var value;\n        html.push('</', name, '>');\n\n        if (indent && indentAfter[name] && html.length > 0) {\n          value = html[html.length - 1];\n\n          if (value.length > 0 && value !== '\\n') {\n            html.push('\\n');\n          }\n        }\n      },\n      text: function (text, raw) {\n        if (text.length > 0) {\n          html[html.length] = raw ? text : encode(text);\n        }\n      },\n      cdata: function (text) {\n        html.push('<![CDATA[', text, ']]>');\n      },\n      comment: function (text) {\n        html.push('<!--', text, '-->');\n      },\n      pi: function (name, text) {\n        if (text) {\n          html.push('<?', name, ' ', encode(text), '?>');\n        } else {\n          html.push('<?', name, '?>');\n        }\n\n        if (indent) {\n          html.push('\\n');\n        }\n      },\n      doctype: function (text) {\n        html.push('<!DOCTYPE', text, '>', indent ? '\\n' : '');\n      },\n      reset: function () {\n        html.length = 0;\n      },\n      getContent: function () {\n        return html.join('').replace(/\\n$/, '');\n      }\n    };\n  };\n\n  var HtmlSerializer = function (settings, schema) {\n    if (schema === void 0) {\n      schema = Schema();\n    }\n\n    var writer = Writer(settings);\n    settings = settings || {};\n    settings.validate = 'validate' in settings ? settings.validate : true;\n\n    var serialize = function (node) {\n      var validate = settings.validate;\n      var handlers = {\n        3: function (node) {\n          writer.text(node.value, node.raw);\n        },\n        8: function (node) {\n          writer.comment(node.value);\n        },\n        7: function (node) {\n          writer.pi(node.name, node.value);\n        },\n        10: function (node) {\n          writer.doctype(node.value);\n        },\n        4: function (node) {\n          writer.cdata(node.value);\n        },\n        11: function (node) {\n          if (node = node.firstChild) {\n            do {\n              walk(node);\n            } while (node = node.next);\n          }\n        }\n      };\n      writer.reset();\n\n      var walk = function (node) {\n        var handler = handlers[node.type];\n        var name, isEmpty, attrs, attrName, attrValue, sortedAttrs, i, l, elementRule;\n\n        if (!handler) {\n          name = node.name;\n          isEmpty = node.shortEnded;\n          attrs = node.attributes;\n\n          if (validate && attrs && attrs.length > 1) {\n            sortedAttrs = [];\n            sortedAttrs.map = {};\n            elementRule = schema.getElementRule(node.name);\n\n            if (elementRule) {\n              for (i = 0, l = elementRule.attributesOrder.length; i < l; i++) {\n                attrName = elementRule.attributesOrder[i];\n\n                if (attrName in attrs.map) {\n                  attrValue = attrs.map[attrName];\n                  sortedAttrs.map[attrName] = attrValue;\n                  sortedAttrs.push({\n                    name: attrName,\n                    value: attrValue\n                  });\n                }\n              }\n\n              for (i = 0, l = attrs.length; i < l; i++) {\n                attrName = attrs[i].name;\n\n                if (!(attrName in sortedAttrs.map)) {\n                  attrValue = attrs.map[attrName];\n                  sortedAttrs.map[attrName] = attrValue;\n                  sortedAttrs.push({\n                    name: attrName,\n                    value: attrValue\n                  });\n                }\n              }\n\n              attrs = sortedAttrs;\n            }\n          }\n\n          writer.start(node.name, attrs, isEmpty);\n\n          if (!isEmpty) {\n            if (node = node.firstChild) {\n              do {\n                walk(node);\n              } while (node = node.next);\n            }\n\n            writer.end(name);\n          }\n        } else {\n          handler(node);\n        }\n      };\n\n      if (node.type === 1 && !settings.inner) {\n        walk(node);\n      } else {\n        handlers[11](node);\n      }\n\n      return writer.getContent();\n    };\n\n    return {\n      serialize: serialize\n    };\n  };\n\n  var isChar = function (forward, predicate, pos) {\n    return Optional.from(pos.container()).filter(isText$1).exists(function (text) {\n      var delta = forward ? 0 : -1;\n      return predicate(text.data.charAt(pos.offset() + delta));\n    });\n  };\n\n  var isBeforeSpace = curry(isChar, true, isWhiteSpace$1);\n  var isAfterSpace = curry(isChar, false, isWhiteSpace$1);\n\n  var isEmptyText = function (pos) {\n    var container = pos.container();\n    return isText$1(container) && (container.data.length === 0 || isZwsp$1(container.data) && BookmarkManager.isBookmarkNode(container.parentNode));\n  };\n\n  var matchesElementPosition = function (before, predicate) {\n    return function (pos) {\n      return Optional.from(getChildNodeAtRelativeOffset(before ? 0 : -1, pos)).filter(predicate).isSome();\n    };\n  };\n\n  var isImageBlock = function (node) {\n    return isImg(node) && get$5(SugarElement.fromDom(node), 'display') === 'block';\n  };\n\n  var isCefNode = function (node) {\n    return isContentEditableFalse(node) && !isBogusAll(node);\n  };\n\n  var isBeforeImageBlock = matchesElementPosition(true, isImageBlock);\n  var isAfterImageBlock = matchesElementPosition(false, isImageBlock);\n  var isBeforeMedia = matchesElementPosition(true, isMedia);\n  var isAfterMedia = matchesElementPosition(false, isMedia);\n  var isBeforeTable = matchesElementPosition(true, isTable);\n  var isAfterTable = matchesElementPosition(false, isTable);\n  var isBeforeContentEditableFalse = matchesElementPosition(true, isCefNode);\n  var isAfterContentEditableFalse = matchesElementPosition(false, isCefNode);\n\n  var getLastChildren$1 = function (elm) {\n    var children = [];\n    var rawNode = elm.dom;\n\n    while (rawNode) {\n      children.push(SugarElement.fromDom(rawNode));\n      rawNode = rawNode.lastChild;\n    }\n\n    return children;\n  };\n\n  var removeTrailingBr = function (elm) {\n    var allBrs = descendants$1(elm, 'br');\n    var brs = filter(getLastChildren$1(elm).slice(-1), isBr$1);\n\n    if (allBrs.length === brs.length) {\n      each(brs, remove);\n    }\n  };\n\n  var fillWithPaddingBr = function (elm) {\n    empty(elm);\n    append(elm, SugarElement.fromHtml('<br data-mce-bogus=\"1\">'));\n  };\n\n  var trimBlockTrailingBr = function (elm) {\n    lastChild(elm).each(function (lastChild) {\n      prevSibling(lastChild).each(function (lastChildPrevSibling) {\n        if (isBlock(elm) && isBr$1(lastChild) && isBlock(lastChildPrevSibling)) {\n          remove(lastChild);\n        }\n      });\n    });\n  };\n\n  var dropLast = function (xs) {\n    return xs.slice(0, -1);\n  };\n\n  var parentsUntil$1 = function (start, root, predicate) {\n    if (contains$2(root, start)) {\n      return dropLast(parents(start, function (elm) {\n        return predicate(elm) || eq$2(elm, root);\n      }));\n    } else {\n      return [];\n    }\n  };\n\n  var parents$1 = function (start, root) {\n    return parentsUntil$1(start, root, never);\n  };\n\n  var parentsAndSelf = function (start, root) {\n    return [start].concat(parents$1(start, root));\n  };\n\n  var navigateIgnoreEmptyTextNodes = function (forward, root, from) {\n    return navigateIgnore(forward, root, from, isEmptyText);\n  };\n\n  var getClosestBlock = function (root, pos) {\n    return find(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock);\n  };\n\n  var isAtBeforeAfterBlockBoundary = function (forward, root, pos) {\n    return navigateIgnoreEmptyTextNodes(forward, root.dom, pos).forall(function (newPos) {\n      return getClosestBlock(root, pos).fold(function () {\n        return isInSameBlock(newPos, pos, root.dom) === false;\n      }, function (fromBlock) {\n        return isInSameBlock(newPos, pos, root.dom) === false && contains$2(fromBlock, SugarElement.fromDom(newPos.container()));\n      });\n    });\n  };\n\n  var isAtBlockBoundary$1 = function (forward, root, pos) {\n    return getClosestBlock(root, pos).fold(function () {\n      return navigateIgnoreEmptyTextNodes(forward, root.dom, pos).forall(function (newPos) {\n        return isInSameBlock(newPos, pos, root.dom) === false;\n      });\n    }, function (parent) {\n      return navigateIgnoreEmptyTextNodes(forward, parent.dom, pos).isNone();\n    });\n  };\n\n  var isAtStartOfBlock = curry(isAtBlockBoundary$1, false);\n  var isAtEndOfBlock = curry(isAtBlockBoundary$1, true);\n  var isBeforeBlock = curry(isAtBeforeAfterBlockBoundary, false);\n  var isAfterBlock = curry(isAtBeforeAfterBlockBoundary, true);\n\n  var isBr$5 = function (pos) {\n    return getElementFromPosition(pos).exists(isBr$1);\n  };\n\n  var findBr = function (forward, root, pos) {\n    var parentBlocks = filter(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock);\n    var scope = head(parentBlocks).getOr(root);\n    return fromPosition(forward, scope.dom, pos).filter(isBr$5);\n  };\n\n  var isBeforeBr = function (root, pos) {\n    return getElementFromPosition(pos).exists(isBr$1) || findBr(true, root, pos).isSome();\n  };\n\n  var isAfterBr = function (root, pos) {\n    return getElementFromPrevPosition(pos).exists(isBr$1) || findBr(false, root, pos).isSome();\n  };\n\n  var findPreviousBr = curry(findBr, false);\n  var findNextBr = curry(findBr, true);\n\n  var isInMiddleOfText = function (pos) {\n    return CaretPosition.isTextPosition(pos) && !pos.isAtStart() && !pos.isAtEnd();\n  };\n\n  var getClosestBlock$1 = function (root, pos) {\n    var parentBlocks = filter(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock);\n    return head(parentBlocks).getOr(root);\n  };\n\n  var hasSpaceBefore = function (root, pos) {\n    if (isInMiddleOfText(pos)) {\n      return isAfterSpace(pos);\n    } else {\n      return isAfterSpace(pos) || prevPosition(getClosestBlock$1(root, pos).dom, pos).exists(isAfterSpace);\n    }\n  };\n\n  var hasSpaceAfter = function (root, pos) {\n    if (isInMiddleOfText(pos)) {\n      return isBeforeSpace(pos);\n    } else {\n      return isBeforeSpace(pos) || nextPosition(getClosestBlock$1(root, pos).dom, pos).exists(isBeforeSpace);\n    }\n  };\n\n  var isPreValue = function (value) {\n    return contains(['pre', 'pre-wrap'], value);\n  };\n\n  var isInPre = function (pos) {\n    return getElementFromPosition(pos).bind(function (elm) {\n      return closest(elm, isElement);\n    }).exists(function (elm) {\n      return isPreValue(get$5(elm, 'white-space'));\n    });\n  };\n\n  var isAtBeginningOfBody = function (root, pos) {\n    return prevPosition(root.dom, pos).isNone();\n  };\n\n  var isAtEndOfBody = function (root, pos) {\n    return nextPosition(root.dom, pos).isNone();\n  };\n\n  var isAtLineBoundary = function (root, pos) {\n    return isAtBeginningOfBody(root, pos) || isAtEndOfBody(root, pos) || isAtStartOfBlock(root, pos) || isAtEndOfBlock(root, pos) || isAfterBr(root, pos) || isBeforeBr(root, pos);\n  };\n\n  var needsToHaveNbsp = function (root, pos) {\n    if (isInPre(pos)) {\n      return false;\n    } else {\n      return isAtLineBoundary(root, pos) || hasSpaceBefore(root, pos) || hasSpaceAfter(root, pos);\n    }\n  };\n\n  var needsToBeNbspLeft = function (root, pos) {\n    if (isInPre(pos)) {\n      return false;\n    } else {\n      return isAtStartOfBlock(root, pos) || isBeforeBlock(root, pos) || isAfterBr(root, pos) || hasSpaceBefore(root, pos);\n    }\n  };\n\n  var leanRight = function (pos) {\n    var container = pos.container();\n    var offset = pos.offset();\n\n    if (isText$1(container) && offset < container.data.length) {\n      return CaretPosition(container, offset + 1);\n    } else {\n      return pos;\n    }\n  };\n\n  var needsToBeNbspRight = function (root, pos) {\n    if (isInPre(pos)) {\n      return false;\n    } else {\n      return isAtEndOfBlock(root, pos) || isAfterBlock(root, pos) || isBeforeBr(root, pos) || hasSpaceAfter(root, pos);\n    }\n  };\n\n  var needsToBeNbsp = function (root, pos) {\n    return needsToBeNbspLeft(root, pos) || needsToBeNbspRight(root, leanRight(pos));\n  };\n\n  var isNbspAt = function (text, offset) {\n    return isNbsp(text.charAt(offset));\n  };\n\n  var hasNbsp = function (pos) {\n    var container = pos.container();\n    return isText$1(container) && contains$1(container.data, nbsp);\n  };\n\n  var normalizeNbspMiddle = function (text) {\n    var chars = text.split('');\n    return map(chars, function (chr, i) {\n      if (isNbsp(chr) && i > 0 && i < chars.length - 1 && isContent$1(chars[i - 1]) && isContent$1(chars[i + 1])) {\n        return ' ';\n      } else {\n        return chr;\n      }\n    }).join('');\n  };\n\n  var normalizeNbspAtStart = function (root, node) {\n    var text = node.data;\n    var firstPos = CaretPosition(node, 0);\n\n    if (isNbspAt(text, 0) && !needsToBeNbsp(root, firstPos)) {\n      node.data = ' ' + text.slice(1);\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var normalizeNbspInMiddleOfTextNode = function (node) {\n    var text = node.data;\n    var newText = normalizeNbspMiddle(text);\n\n    if (newText !== text) {\n      node.data = newText;\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var normalizeNbspAtEnd = function (root, node) {\n    var text = node.data;\n    var lastPos = CaretPosition(node, text.length - 1);\n\n    if (isNbspAt(text, text.length - 1) && !needsToBeNbsp(root, lastPos)) {\n      node.data = text.slice(0, -1) + ' ';\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var normalizeNbsps = function (root, pos) {\n    return Optional.some(pos).filter(hasNbsp).bind(function (pos) {\n      var container = pos.container();\n      var normalized = normalizeNbspAtStart(root, container) || normalizeNbspInMiddleOfTextNode(container) || normalizeNbspAtEnd(root, container);\n      return normalized ? Optional.some(pos) : Optional.none();\n    });\n  };\n\n  var normalizeNbspsInEditor = function (editor) {\n    var root = SugarElement.fromDom(editor.getBody());\n\n    if (editor.selection.isCollapsed()) {\n      normalizeNbsps(root, CaretPosition.fromRangeStart(editor.selection.getRng())).each(function (pos) {\n        editor.selection.setRng(pos.toRange());\n      });\n    }\n  };\n\n  var normalizeContent = function (content, isStartOfContent, isEndOfContent) {\n    var result = foldl(content, function (acc, c) {\n      if (isWhiteSpace$1(c) || isNbsp(c)) {\n        if (acc.previousCharIsSpace || acc.str === '' && isStartOfContent || acc.str.length === content.length - 1 && isEndOfContent) {\n          return {\n            previousCharIsSpace: false,\n            str: acc.str + nbsp\n          };\n        } else {\n          return {\n            previousCharIsSpace: true,\n            str: acc.str + ' '\n          };\n        }\n      } else {\n        return {\n          previousCharIsSpace: false,\n          str: acc.str + c\n        };\n      }\n    }, {\n      previousCharIsSpace: false,\n      str: ''\n    });\n    return result.str;\n  };\n\n  var normalize$1 = function (node, offset, count) {\n    if (count === 0) {\n      return;\n    }\n\n    var elm = SugarElement.fromDom(node);\n    var root = ancestor(elm, isBlock).getOr(elm);\n    var whitespace = node.data.slice(offset, offset + count);\n    var isEndOfContent = offset + count >= node.data.length && needsToBeNbspRight(root, CaretPosition(node, node.data.length));\n    var isStartOfContent = offset === 0 && needsToBeNbspLeft(root, CaretPosition(node, 0));\n    node.replaceData(offset, count, normalizeContent(whitespace, isStartOfContent, isEndOfContent));\n  };\n\n  var normalizeWhitespaceAfter = function (node, offset) {\n    var content = node.data.slice(offset);\n    var whitespaceCount = content.length - lTrim(content).length;\n    return normalize$1(node, offset, whitespaceCount);\n  };\n\n  var normalizeWhitespaceBefore = function (node, offset) {\n    var content = node.data.slice(0, offset);\n    var whitespaceCount = content.length - rTrim(content).length;\n    return normalize$1(node, offset - whitespaceCount, whitespaceCount);\n  };\n\n  var mergeTextNodes = function (prevNode, nextNode, normalizeWhitespace, mergeToPrev) {\n    if (mergeToPrev === void 0) {\n      mergeToPrev = true;\n    }\n\n    var whitespaceOffset = rTrim(prevNode.data).length;\n    var newNode = mergeToPrev ? prevNode : nextNode;\n    var removeNode = mergeToPrev ? nextNode : prevNode;\n\n    if (mergeToPrev) {\n      newNode.appendData(removeNode.data);\n    } else {\n      newNode.insertData(0, removeNode.data);\n    }\n\n    remove(SugarElement.fromDom(removeNode));\n\n    if (normalizeWhitespace) {\n      normalizeWhitespaceAfter(newNode, whitespaceOffset);\n    }\n\n    return newNode;\n  };\n\n  var needsReposition = function (pos, elm) {\n    var container = pos.container();\n    var offset = pos.offset();\n    return CaretPosition.isTextPosition(pos) === false && container === elm.parentNode && offset > CaretPosition.before(elm).offset();\n  };\n\n  var reposition = function (elm, pos) {\n    return needsReposition(pos, elm) ? CaretPosition(pos.container(), pos.offset() - 1) : pos;\n  };\n\n  var beforeOrStartOf = function (node) {\n    return isText$1(node) ? CaretPosition(node, 0) : CaretPosition.before(node);\n  };\n\n  var afterOrEndOf = function (node) {\n    return isText$1(node) ? CaretPosition(node, node.data.length) : CaretPosition.after(node);\n  };\n\n  var getPreviousSiblingCaretPosition = function (elm) {\n    if (isCaretCandidate(elm.previousSibling)) {\n      return Optional.some(afterOrEndOf(elm.previousSibling));\n    } else {\n      return elm.previousSibling ? lastPositionIn(elm.previousSibling) : Optional.none();\n    }\n  };\n\n  var getNextSiblingCaretPosition = function (elm) {\n    if (isCaretCandidate(elm.nextSibling)) {\n      return Optional.some(beforeOrStartOf(elm.nextSibling));\n    } else {\n      return elm.nextSibling ? firstPositionIn(elm.nextSibling) : Optional.none();\n    }\n  };\n\n  var findCaretPositionBackwardsFromElm = function (rootElement, elm) {\n    var startPosition = CaretPosition.before(elm.previousSibling ? elm.previousSibling : elm.parentNode);\n    return prevPosition(rootElement, startPosition).fold(function () {\n      return nextPosition(rootElement, CaretPosition.after(elm));\n    }, Optional.some);\n  };\n\n  var findCaretPositionForwardsFromElm = function (rootElement, elm) {\n    return nextPosition(rootElement, CaretPosition.after(elm)).fold(function () {\n      return prevPosition(rootElement, CaretPosition.before(elm));\n    }, Optional.some);\n  };\n\n  var findCaretPositionBackwards = function (rootElement, elm) {\n    return getPreviousSiblingCaretPosition(elm).orThunk(function () {\n      return getNextSiblingCaretPosition(elm);\n    }).orThunk(function () {\n      return findCaretPositionBackwardsFromElm(rootElement, elm);\n    });\n  };\n\n  var findCaretPositionForward = function (rootElement, elm) {\n    return getNextSiblingCaretPosition(elm).orThunk(function () {\n      return getPreviousSiblingCaretPosition(elm);\n    }).orThunk(function () {\n      return findCaretPositionForwardsFromElm(rootElement, elm);\n    });\n  };\n\n  var findCaretPosition$1 = function (forward, rootElement, elm) {\n    return forward ? findCaretPositionForward(rootElement, elm) : findCaretPositionBackwards(rootElement, elm);\n  };\n\n  var findCaretPosOutsideElmAfterDelete = function (forward, rootElement, elm) {\n    return findCaretPosition$1(forward, rootElement, elm).map(curry(reposition, elm));\n  };\n\n  var setSelection = function (editor, forward, pos) {\n    pos.fold(function () {\n      editor.focus();\n    }, function (pos) {\n      editor.selection.setRng(pos.toRange(), forward);\n    });\n  };\n\n  var eqRawNode = function (rawNode) {\n    return function (elm) {\n      return elm.dom === rawNode;\n    };\n  };\n\n  var isBlock$2 = function (editor, elm) {\n    return elm && has(editor.schema.getBlockElements(), name(elm));\n  };\n\n  var paddEmptyBlock = function (elm) {\n    if (isEmpty(elm)) {\n      var br = SugarElement.fromHtml('<br data-mce-bogus=\"1\">');\n      empty(elm);\n      append(elm, br);\n      return Optional.some(CaretPosition.before(br.dom));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var deleteNormalized = function (elm, afterDeletePosOpt, normalizeWhitespace) {\n    var prevTextOpt = prevSibling(elm).filter(isText);\n    var nextTextOpt = nextSibling(elm).filter(isText);\n    remove(elm);\n    return lift3(prevTextOpt, nextTextOpt, afterDeletePosOpt, function (prev, next, pos) {\n      var prevNode = prev.dom,\n          nextNode = next.dom;\n      var offset = prevNode.data.length;\n      mergeTextNodes(prevNode, nextNode, normalizeWhitespace);\n      return pos.container() === nextNode ? CaretPosition(prevNode, offset) : pos;\n    }).orThunk(function () {\n      if (normalizeWhitespace) {\n        prevTextOpt.each(function (elm) {\n          return normalizeWhitespaceBefore(elm.dom, elm.dom.length);\n        });\n        nextTextOpt.each(function (elm) {\n          return normalizeWhitespaceAfter(elm.dom, 0);\n        });\n      }\n\n      return afterDeletePosOpt;\n    });\n  };\n\n  var isInlineElement = function (editor, element) {\n    return has(editor.schema.getTextInlineElements(), name(element));\n  };\n\n  var deleteElement = function (editor, forward, elm, moveCaret) {\n    if (moveCaret === void 0) {\n      moveCaret = true;\n    }\n\n    var afterDeletePos = findCaretPosOutsideElmAfterDelete(forward, editor.getBody(), elm.dom);\n    var parentBlock = ancestor(elm, curry(isBlock$2, editor), eqRawNode(editor.getBody()));\n    var normalizedAfterDeletePos = deleteNormalized(elm, afterDeletePos, isInlineElement(editor, elm));\n\n    if (editor.dom.isEmpty(editor.getBody())) {\n      editor.setContent('');\n      editor.selection.setCursorLocation();\n    } else {\n      parentBlock.bind(paddEmptyBlock).fold(function () {\n        if (moveCaret) {\n          setSelection(editor, forward, normalizedAfterDeletePos);\n        }\n      }, function (paddPos) {\n        if (moveCaret) {\n          setSelection(editor, forward, Optional.some(paddPos));\n        }\n      });\n    }\n  };\n\n  var tableCellRng = function (start, end) {\n    return {\n      start: start,\n      end: end\n    };\n  };\n\n  var tableSelection = function (rng, table, cells) {\n    return {\n      rng: rng,\n      table: table,\n      cells: cells\n    };\n  };\n\n  var deleteAction = Adt.generate([{\n    removeTable: ['element']\n  }, {\n    emptyCells: ['cells']\n  }, {\n    deleteCellSelection: ['rng', 'cell']\n  }]);\n\n  var isRootFromElement = function (root) {\n    return function (cur) {\n      return eq$2(root, cur);\n    };\n  };\n\n  var getClosestCell = function (container, isRoot) {\n    return closest$1(SugarElement.fromDom(container), 'td,th', isRoot);\n  };\n\n  var getClosestTable = function (cell, isRoot) {\n    return ancestor$1(cell, 'table', isRoot);\n  };\n\n  var isExpandedCellRng = function (cellRng) {\n    return !eq$2(cellRng.start, cellRng.end);\n  };\n\n  var getTableFromCellRng = function (cellRng, isRoot) {\n    return getClosestTable(cellRng.start, isRoot).bind(function (startParentTable) {\n      return getClosestTable(cellRng.end, isRoot).bind(function (endParentTable) {\n        return someIf(eq$2(startParentTable, endParentTable), startParentTable);\n      });\n    });\n  };\n\n  var isSingleCellTable = function (cellRng, isRoot) {\n    return !isExpandedCellRng(cellRng) && getTableFromCellRng(cellRng, isRoot).exists(function (table) {\n      var rows = table.dom.rows;\n      return rows.length === 1 && rows[0].cells.length === 1;\n    });\n  };\n\n  var getTableCells = function (table) {\n    return descendants$1(table, 'td,th');\n  };\n\n  var getCellRng = function (rng, isRoot) {\n    var startCell = getClosestCell(rng.startContainer, isRoot);\n    var endCell = getClosestCell(rng.endContainer, isRoot);\n    return lift2(startCell, endCell, tableCellRng);\n  };\n\n  var getCellRangeFromStartTable = function (cellRng, isRoot) {\n    return getClosestTable(cellRng.start, isRoot).bind(function (table) {\n      return last(getTableCells(table)).map(function (endCell) {\n        return tableCellRng(cellRng.start, endCell);\n      });\n    });\n  };\n\n  var partialSelection = function (isRoot, rng) {\n    var startCell = getClosestCell(rng.startContainer, isRoot);\n    var endCell = getClosestCell(rng.endContainer, isRoot);\n    return rng.collapsed ? Optional.none() : lift2(startCell, endCell, tableCellRng).fold(function () {\n      return startCell.fold(function () {\n        return endCell.bind(function (endCell) {\n          return getClosestTable(endCell, isRoot).bind(function (table) {\n            return head(getTableCells(table)).map(function (startCell) {\n              return tableCellRng(startCell, endCell);\n            });\n          });\n        });\n      }, function (startCell) {\n        return getClosestTable(startCell, isRoot).bind(function (table) {\n          return last(getTableCells(table)).map(function (endCell) {\n            return tableCellRng(startCell, endCell);\n          });\n        });\n      });\n    }, function (cellRng) {\n      return isWithinSameTable(isRoot, cellRng) ? Optional.none() : getCellRangeFromStartTable(cellRng, isRoot);\n    });\n  };\n\n  var isWithinSameTable = function (isRoot, cellRng) {\n    return getTableFromCellRng(cellRng, isRoot).isSome();\n  };\n\n  var getTableSelectionFromCellRng = function (cellRng, isRoot) {\n    return getTableFromCellRng(cellRng, isRoot).map(function (table) {\n      return tableSelection(cellRng, table, getTableCells(table));\n    });\n  };\n\n  var getTableSelection = function (optCellRng, rng, isRoot) {\n    return optCellRng.filter(function (cellRng) {\n      return isExpandedCellRng(cellRng) && isWithinSameTable(isRoot, cellRng);\n    }).orThunk(function () {\n      return partialSelection(isRoot, rng);\n    }).bind(function (cRng) {\n      return getTableSelectionFromCellRng(cRng, isRoot);\n    });\n  };\n\n  var getCellIndex = function (cells, cell) {\n    return findIndex(cells, function (x) {\n      return eq$2(x, cell);\n    });\n  };\n\n  var getSelectedCells = function (tableSelection) {\n    return lift2(getCellIndex(tableSelection.cells, tableSelection.rng.start), getCellIndex(tableSelection.cells, tableSelection.rng.end), function (startIndex, endIndex) {\n      return tableSelection.cells.slice(startIndex, endIndex + 1);\n    });\n  };\n\n  var isSingleCellTableContentSelected = function (optCellRng, rng, isRoot) {\n    return optCellRng.filter(function (cellRng) {\n      return isSingleCellTable(cellRng, isRoot) && hasAllContentsSelected(cellRng.start, rng);\n    }).map(function (cellRng) {\n      return cellRng.start;\n    });\n  };\n\n  var getAction = function (tableSelection) {\n    return getSelectedCells(tableSelection).map(function (selected) {\n      var cells = tableSelection.cells;\n      return selected.length === cells.length ? deleteAction.removeTable(tableSelection.table) : deleteAction.emptyCells(selected);\n    });\n  };\n\n  var getActionFromRange = function (root, rng) {\n    var isRoot = isRootFromElement(root);\n    var optCellRng = getCellRng(rng, isRoot);\n    return isSingleCellTableContentSelected(optCellRng, rng, isRoot).map(function (cell) {\n      return deleteAction.deleteCellSelection(rng, cell);\n    }).orThunk(function () {\n      return getTableSelection(optCellRng, rng, isRoot).bind(getAction);\n    });\n  };\n\n  var freefallRtl = function (root) {\n    var child = isComment(root) ? prevSibling(root) : lastChild(root);\n    return child.bind(freefallRtl).orThunk(function () {\n      return Optional.some(root);\n    });\n  };\n\n  var emptyCells = function (editor, cells) {\n    each(cells, fillWithPaddingBr);\n    editor.selection.setCursorLocation(cells[0].dom, 0);\n    return true;\n  };\n\n  var deleteCellContents = function (editor, rng, cell) {\n    rng.deleteContents();\n    var lastNode = freefallRtl(cell).getOr(cell);\n    var lastBlock = SugarElement.fromDom(editor.dom.getParent(lastNode.dom, editor.dom.isBlock));\n\n    if (isEmpty(lastBlock)) {\n      fillWithPaddingBr(lastBlock);\n      editor.selection.setCursorLocation(lastBlock.dom, 0);\n    }\n\n    if (!eq$2(cell, lastBlock)) {\n      var additionalCleanupNodes = parent(lastBlock).is(cell) ? [] : siblings(lastBlock);\n      each(additionalCleanupNodes.concat(children(cell)), function (node) {\n        if (!eq$2(node, lastBlock) && !contains$2(node, lastBlock)) {\n          remove(node);\n        }\n      });\n    }\n\n    return true;\n  };\n\n  var deleteTableElement = function (editor, table) {\n    deleteElement(editor, false, table);\n    return true;\n  };\n\n  var deleteCellRange = function (editor, rootElm, rng) {\n    return getActionFromRange(rootElm, rng).map(function (action) {\n      return action.fold(curry(deleteTableElement, editor), curry(emptyCells, editor), curry(deleteCellContents, editor));\n    });\n  };\n\n  var deleteCaptionRange = function (editor, caption) {\n    return emptyElement(editor, caption);\n  };\n\n  var deleteTableRange = function (editor, rootElm, rng, startElm) {\n    return getParentCaption(rootElm, startElm).fold(function () {\n      return deleteCellRange(editor, rootElm, rng);\n    }, function (caption) {\n      return deleteCaptionRange(editor, caption);\n    }).getOr(false);\n  };\n\n  var deleteRange = function (editor, startElm) {\n    var rootNode = SugarElement.fromDom(editor.getBody());\n    var rng = editor.selection.getRng();\n    var selectedCells = getCellsFromEditor(editor);\n    return selectedCells.length !== 0 ? emptyCells(editor, selectedCells) : deleteTableRange(editor, rootNode, rng, startElm);\n  };\n\n  var getParentCell = function (rootElm, elm) {\n    return find(parentsAndSelf(elm, rootElm), isTableCell$1);\n  };\n\n  var getParentCaption = function (rootElm, elm) {\n    return find(parentsAndSelf(elm, rootElm), function (elm) {\n      return name(elm) === 'caption';\n    });\n  };\n\n  var deleteBetweenCells = function (editor, rootElm, forward, fromCell, from) {\n    return navigate(forward, editor.getBody(), from).bind(function (to) {\n      return getParentCell(rootElm, SugarElement.fromDom(to.getNode())).map(function (toCell) {\n        return eq$2(toCell, fromCell) === false;\n      });\n    });\n  };\n\n  var emptyElement = function (editor, elm) {\n    fillWithPaddingBr(elm);\n    editor.selection.setCursorLocation(elm.dom, 0);\n    return Optional.some(true);\n  };\n\n  var isDeleteOfLastCharPos = function (fromCaption, forward, from, to) {\n    return firstPositionIn(fromCaption.dom).bind(function (first) {\n      return lastPositionIn(fromCaption.dom).map(function (last) {\n        return forward ? from.isEqual(first) && to.isEqual(last) : from.isEqual(last) && to.isEqual(first);\n      });\n    }).getOr(true);\n  };\n\n  var emptyCaretCaption = function (editor, elm) {\n    return emptyElement(editor, elm);\n  };\n\n  var validateCaretCaption = function (rootElm, fromCaption, to) {\n    return getParentCaption(rootElm, SugarElement.fromDom(to.getNode())).map(function (toCaption) {\n      return eq$2(toCaption, fromCaption) === false;\n    });\n  };\n\n  var deleteCaretInsideCaption = function (editor, rootElm, forward, fromCaption, from) {\n    return navigate(forward, editor.getBody(), from).bind(function (to) {\n      return isDeleteOfLastCharPos(fromCaption, forward, from, to) ? emptyCaretCaption(editor, fromCaption) : validateCaretCaption(rootElm, fromCaption, to);\n    }).or(Optional.some(true));\n  };\n\n  var deleteCaretCells = function (editor, forward, rootElm, startElm) {\n    var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return getParentCell(rootElm, startElm).bind(function (fromCell) {\n      return isEmpty(fromCell) ? emptyElement(editor, fromCell) : deleteBetweenCells(editor, rootElm, forward, fromCell, from);\n    }).getOr(false);\n  };\n\n  var deleteCaretCaption = function (editor, forward, rootElm, fromCaption) {\n    var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return isEmpty(fromCaption) ? emptyElement(editor, fromCaption) : deleteCaretInsideCaption(editor, rootElm, forward, fromCaption, from);\n  };\n\n  var isNearTable = function (forward, pos) {\n    return forward ? isBeforeTable(pos) : isAfterTable(pos);\n  };\n\n  var isBeforeOrAfterTable = function (editor, forward) {\n    var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return isNearTable(forward, fromPos) || fromPosition(forward, editor.getBody(), fromPos).exists(function (pos) {\n      return isNearTable(forward, pos);\n    });\n  };\n\n  var deleteCaret = function (editor, forward, startElm) {\n    var rootElm = SugarElement.fromDom(editor.getBody());\n    return getParentCaption(rootElm, startElm).fold(function () {\n      return deleteCaretCells(editor, forward, rootElm, startElm) || isBeforeOrAfterTable(editor, forward);\n    }, function (fromCaption) {\n      return deleteCaretCaption(editor, forward, rootElm, fromCaption).getOr(false);\n    });\n  };\n\n  var backspaceDelete = function (editor, forward) {\n    var startElm = SugarElement.fromDom(editor.selection.getStart(true));\n    var cells = getCellsFromEditor(editor);\n    return editor.selection.isCollapsed() && cells.length === 0 ? deleteCaret(editor, forward, startElm) : deleteRange(editor, startElm);\n  };\n\n  var createRange$1 = function (sc, so, ec, eo) {\n    var rng = document.createRange();\n    rng.setStart(sc, so);\n    rng.setEnd(ec, eo);\n    return rng;\n  };\n\n  var normalizeBlockSelectionRange = function (rng) {\n    var startPos = CaretPosition.fromRangeStart(rng);\n    var endPos = CaretPosition.fromRangeEnd(rng);\n    var rootNode = rng.commonAncestorContainer;\n    return fromPosition(false, rootNode, endPos).map(function (newEndPos) {\n      if (!isInSameBlock(startPos, endPos, rootNode) && isInSameBlock(startPos, newEndPos, rootNode)) {\n        return createRange$1(startPos.container(), startPos.offset(), newEndPos.container(), newEndPos.offset());\n      } else {\n        return rng;\n      }\n    }).getOr(rng);\n  };\n\n  var normalize$2 = function (rng) {\n    return rng.collapsed ? rng : normalizeBlockSelectionRange(rng);\n  };\n\n  var hasOnlyOneChild = function (node) {\n    return node.firstChild && node.firstChild === node.lastChild;\n  };\n\n  var isPaddingNode = function (node) {\n    return node.name === 'br' || node.value === nbsp;\n  };\n\n  var isPaddedEmptyBlock = function (schema, node) {\n    var blockElements = schema.getBlockElements();\n    return blockElements[node.name] && hasOnlyOneChild(node) && isPaddingNode(node.firstChild);\n  };\n\n  var isEmptyFragmentElement = function (schema, node) {\n    var nonEmptyElements = schema.getNonEmptyElements();\n    return node && (node.isEmpty(nonEmptyElements) || isPaddedEmptyBlock(schema, node));\n  };\n\n  var isListFragment = function (schema, fragment) {\n    var firstChild = fragment.firstChild;\n    var lastChild = fragment.lastChild;\n\n    if (firstChild && firstChild.name === 'meta') {\n      firstChild = firstChild.next;\n    }\n\n    if (lastChild && lastChild.attr('id') === 'mce_marker') {\n      lastChild = lastChild.prev;\n    }\n\n    if (isEmptyFragmentElement(schema, lastChild)) {\n      lastChild = lastChild.prev;\n    }\n\n    if (!firstChild || firstChild !== lastChild) {\n      return false;\n    }\n\n    return firstChild.name === 'ul' || firstChild.name === 'ol';\n  };\n\n  var cleanupDomFragment = function (domFragment) {\n    var firstChild = domFragment.firstChild;\n    var lastChild = domFragment.lastChild;\n\n    if (firstChild && firstChild.nodeName === 'META') {\n      firstChild.parentNode.removeChild(firstChild);\n    }\n\n    if (lastChild && lastChild.id === 'mce_marker') {\n      lastChild.parentNode.removeChild(lastChild);\n    }\n\n    return domFragment;\n  };\n\n  var toDomFragment = function (dom, serializer, fragment) {\n    var html = serializer.serialize(fragment);\n    var domFragment = dom.createFragment(html);\n    return cleanupDomFragment(domFragment);\n  };\n\n  var listItems$1 = function (elm) {\n    return Tools.grep(elm.childNodes, function (child) {\n      return child.nodeName === 'LI';\n    });\n  };\n\n  var isPadding = function (node) {\n    return node.data === nbsp || isBr(node);\n  };\n\n  var isListItemPadded = function (node) {\n    return node && node.firstChild && node.firstChild === node.lastChild && isPadding(node.firstChild);\n  };\n\n  var isEmptyOrPadded = function (elm) {\n    return !elm.firstChild || isListItemPadded(elm);\n  };\n\n  var trimListItems = function (elms) {\n    return elms.length > 0 && isEmptyOrPadded(elms[elms.length - 1]) ? elms.slice(0, -1) : elms;\n  };\n\n  var getParentLi = function (dom, node) {\n    var parentBlock = dom.getParent(node, dom.isBlock);\n    return parentBlock && parentBlock.nodeName === 'LI' ? parentBlock : null;\n  };\n\n  var isParentBlockLi = function (dom, node) {\n    return !!getParentLi(dom, node);\n  };\n\n  var getSplit = function (parentNode, rng) {\n    var beforeRng = rng.cloneRange();\n    var afterRng = rng.cloneRange();\n    beforeRng.setStartBefore(parentNode);\n    afterRng.setEndAfter(parentNode);\n    return [beforeRng.cloneContents(), afterRng.cloneContents()];\n  };\n\n  var findFirstIn = function (node, rootNode) {\n    var caretPos = CaretPosition.before(node);\n    var caretWalker = CaretWalker(rootNode);\n    var newCaretPos = caretWalker.next(caretPos);\n    return newCaretPos ? newCaretPos.toRange() : null;\n  };\n\n  var findLastOf = function (node, rootNode) {\n    var caretPos = CaretPosition.after(node);\n    var caretWalker = CaretWalker(rootNode);\n    var newCaretPos = caretWalker.prev(caretPos);\n    return newCaretPos ? newCaretPos.toRange() : null;\n  };\n\n  var insertMiddle = function (target, elms, rootNode, rng) {\n    var parts = getSplit(target, rng);\n    var parentElm = target.parentNode;\n    parentElm.insertBefore(parts[0], target);\n    Tools.each(elms, function (li) {\n      parentElm.insertBefore(li, target);\n    });\n    parentElm.insertBefore(parts[1], target);\n    parentElm.removeChild(target);\n    return findLastOf(elms[elms.length - 1], rootNode);\n  };\n\n  var insertBefore = function (target, elms, rootNode) {\n    var parentElm = target.parentNode;\n    Tools.each(elms, function (elm) {\n      parentElm.insertBefore(elm, target);\n    });\n    return findFirstIn(target, rootNode);\n  };\n\n  var insertAfter = function (target, elms, rootNode, dom) {\n    dom.insertAfter(elms.reverse(), target);\n    return findLastOf(elms[0], rootNode);\n  };\n\n  var insertAtCaret = function (serializer, dom, rng, fragment) {\n    var domFragment = toDomFragment(dom, serializer, fragment);\n    var liTarget = getParentLi(dom, rng.startContainer);\n    var liElms = trimListItems(listItems$1(domFragment.firstChild));\n    var BEGINNING = 1,\n        END = 2;\n    var rootNode = dom.getRoot();\n\n    var isAt = function (location) {\n      var caretPos = CaretPosition.fromRangeStart(rng);\n      var caretWalker = CaretWalker(dom.getRoot());\n      var newPos = location === BEGINNING ? caretWalker.prev(caretPos) : caretWalker.next(caretPos);\n      return newPos ? getParentLi(dom, newPos.getNode()) !== liTarget : true;\n    };\n\n    if (isAt(BEGINNING)) {\n      return insertBefore(liTarget, liElms, rootNode);\n    } else if (isAt(END)) {\n      return insertAfter(liTarget, liElms, rootNode, dom);\n    }\n\n    return insertMiddle(liTarget, liElms, rootNode, rng);\n  };\n\n  var trimOrPadLeftRight = function (dom, rng, html) {\n    var root = SugarElement.fromDom(dom.getRoot());\n\n    if (needsToBeNbspLeft(root, CaretPosition.fromRangeStart(rng))) {\n      html = html.replace(/^ /, '&nbsp;');\n    } else {\n      html = html.replace(/^&nbsp;/, ' ');\n    }\n\n    if (needsToBeNbspRight(root, CaretPosition.fromRangeEnd(rng))) {\n      html = html.replace(/(&nbsp;| )(<br( \\/)>)?$/, '&nbsp;');\n    } else {\n      html = html.replace(/&nbsp;(<br( \\/)?>)?$/, ' ');\n    }\n\n    return html;\n  };\n\n  var isTableCell$4 = isTableCell;\n\n  var isTableCellContentSelected = function (dom, rng, cell) {\n    if (cell !== null) {\n      var endCell = dom.getParent(rng.endContainer, isTableCell$4);\n      return cell === endCell && hasAllContentsSelected(SugarElement.fromDom(cell), rng);\n    } else {\n      return false;\n    }\n  };\n\n  var validInsertion = function (editor, value, parentNode) {\n    if (parentNode.getAttribute('data-mce-bogus') === 'all') {\n      parentNode.parentNode.insertBefore(editor.dom.createFragment(value), parentNode);\n    } else {\n      var node = parentNode.firstChild;\n      var node2 = parentNode.lastChild;\n\n      if (!node || node === node2 && node.nodeName === 'BR') {\n        editor.dom.setHTML(parentNode, value);\n      } else {\n        editor.selection.setContent(value);\n      }\n    }\n  };\n\n  var trimBrsFromTableCell = function (dom, elm) {\n    Optional.from(dom.getParent(elm, 'td,th')).map(SugarElement.fromDom).each(trimBlockTrailingBr);\n  };\n\n  var reduceInlineTextElements = function (editor, merge) {\n    var textInlineElements = editor.schema.getTextInlineElements();\n    var dom = editor.dom;\n\n    if (merge) {\n      var root_1 = editor.getBody(),\n          elementUtils_1 = ElementUtils(dom);\n      Tools.each(dom.select('*[data-mce-fragment]'), function (node) {\n        for (var testNode = node.parentNode; testNode && testNode !== root_1; testNode = testNode.parentNode) {\n          if (textInlineElements[node.nodeName.toLowerCase()] && elementUtils_1.compare(testNode, node)) {\n            dom.remove(node, true);\n          }\n        }\n      });\n    }\n  };\n\n  var markFragmentElements = function (fragment) {\n    var node = fragment;\n\n    while (node = node.walk()) {\n      if (node.type === 1) {\n        node.attr('data-mce-fragment', '1');\n      }\n    }\n  };\n\n  var unmarkFragmentElements = function (elm) {\n    Tools.each(elm.getElementsByTagName('*'), function (elm) {\n      elm.removeAttribute('data-mce-fragment');\n    });\n  };\n\n  var isPartOfFragment = function (node) {\n    return !!node.getAttribute('data-mce-fragment');\n  };\n\n  var canHaveChildren = function (editor, node) {\n    return node && !editor.schema.getShortEndedElements()[node.nodeName];\n  };\n\n  var moveSelectionToMarker = function (editor, marker) {\n    var nextRng;\n    var dom = editor.dom,\n        selection = editor.selection;\n    var node2;\n\n    var getContentEditableFalseParent = function (node) {\n      var root = editor.getBody();\n\n      for (; node && node !== root; node = node.parentNode) {\n        if (dom.getContentEditable(node) === 'false') {\n          return node;\n        }\n      }\n\n      return null;\n    };\n\n    if (!marker) {\n      return;\n    }\n\n    selection.scrollIntoView(marker);\n    var parentEditableFalseElm = getContentEditableFalseParent(marker);\n\n    if (parentEditableFalseElm) {\n      dom.remove(marker);\n      selection.select(parentEditableFalseElm);\n      return;\n    }\n\n    var rng = dom.createRng();\n    var node = marker.previousSibling;\n\n    if (node && node.nodeType === 3) {\n      rng.setStart(node, node.nodeValue.length);\n\n      if (!Env.ie) {\n        node2 = marker.nextSibling;\n\n        if (node2 && node2.nodeType === 3) {\n          node.appendData(node2.data);\n          node2.parentNode.removeChild(node2);\n        }\n      }\n    } else {\n      rng.setStartBefore(marker);\n      rng.setEndBefore(marker);\n    }\n\n    var findNextCaretRng = function (rng) {\n      var caretPos = CaretPosition.fromRangeStart(rng);\n      var caretWalker = CaretWalker(editor.getBody());\n      caretPos = caretWalker.next(caretPos);\n\n      if (caretPos) {\n        return caretPos.toRange();\n      }\n    };\n\n    var parentBlock = dom.getParent(marker, dom.isBlock);\n    dom.remove(marker);\n\n    if (parentBlock && dom.isEmpty(parentBlock)) {\n      editor.$(parentBlock).empty();\n      rng.setStart(parentBlock, 0);\n      rng.setEnd(parentBlock, 0);\n\n      if (!isTableCell$4(parentBlock) && !isPartOfFragment(parentBlock) && (nextRng = findNextCaretRng(rng))) {\n        rng = nextRng;\n        dom.remove(parentBlock);\n      } else {\n        dom.add(parentBlock, dom.create('br', {\n          'data-mce-bogus': '1'\n        }));\n      }\n    }\n\n    selection.setRng(rng);\n  };\n\n  var deleteSelectedContent = function (editor) {\n    var dom = editor.dom;\n    var rng = normalize$2(editor.selection.getRng());\n    editor.selection.setRng(rng);\n    var startCell = dom.getParent(rng.startContainer, isTableCell$4);\n\n    if (isTableCellContentSelected(dom, rng, startCell)) {\n      deleteCellContents(editor, rng, SugarElement.fromDom(startCell));\n    } else {\n      editor.getDoc().execCommand('Delete', false, null);\n    }\n  };\n\n  var insertHtmlAtCaret = function (editor, value, details) {\n    var parentNode, rootNode, args;\n    var marker, rng, node;\n    var selection = editor.selection,\n        dom = editor.dom;\n\n    if (/^ | $/.test(value)) {\n      value = trimOrPadLeftRight(dom, selection.getRng(), value);\n    }\n\n    var parser = editor.parser;\n    var merge = details.merge;\n    var serializer = HtmlSerializer({\n      validate: shouldValidate(editor)\n    }, editor.schema);\n    var bookmarkHtml = '<span id=\"mce_marker\" data-mce-type=\"bookmark\">&#xFEFF;</span>';\n    args = {\n      content: value,\n      format: 'html',\n      selection: true,\n      paste: details.paste\n    };\n    args = editor.fire('BeforeSetContent', args);\n\n    if (args.isDefaultPrevented()) {\n      editor.fire('SetContent', {\n        content: args.content,\n        format: 'html',\n        selection: true,\n        paste: details.paste\n      });\n      return;\n    }\n\n    value = args.content;\n\n    if (value.indexOf('{$caret}') === -1) {\n      value += '{$caret}';\n    }\n\n    value = value.replace(/\\{\\$caret\\}/, bookmarkHtml);\n    rng = selection.getRng();\n    var caretElement = rng.startContainer || (rng.parentElement ? rng.parentElement() : null);\n    var body = editor.getBody();\n\n    if (caretElement === body && selection.isCollapsed()) {\n      if (dom.isBlock(body.firstChild) && canHaveChildren(editor, body.firstChild) && dom.isEmpty(body.firstChild)) {\n        rng = dom.createRng();\n        rng.setStart(body.firstChild, 0);\n        rng.setEnd(body.firstChild, 0);\n        selection.setRng(rng);\n      }\n    }\n\n    if (!selection.isCollapsed()) {\n      deleteSelectedContent(editor);\n    }\n\n    parentNode = selection.getNode();\n    var parserArgs = {\n      context: parentNode.nodeName.toLowerCase(),\n      data: details.data,\n      insert: true\n    };\n    var fragment = parser.parse(value, parserArgs);\n\n    if (details.paste === true && isListFragment(editor.schema, fragment) && isParentBlockLi(dom, parentNode)) {\n      rng = insertAtCaret(serializer, dom, selection.getRng(), fragment);\n      selection.setRng(rng);\n      editor.fire('SetContent', args);\n      return;\n    }\n\n    markFragmentElements(fragment);\n    node = fragment.lastChild;\n\n    if (node.attr('id') === 'mce_marker') {\n      marker = node;\n\n      for (node = node.prev; node; node = node.walk(true)) {\n        if (node.type === 3 || !dom.isBlock(node.name)) {\n          if (editor.schema.isValidChild(node.parent.name, 'span')) {\n            node.parent.insert(marker, node, node.name === 'br');\n          }\n\n          break;\n        }\n      }\n    }\n\n    editor._selectionOverrides.showBlockCaretContainer(parentNode);\n\n    if (!parserArgs.invalid) {\n      value = serializer.serialize(fragment);\n      validInsertion(editor, value, parentNode);\n    } else {\n      editor.selection.setContent(bookmarkHtml);\n      parentNode = selection.getNode();\n      rootNode = editor.getBody();\n\n      if (parentNode.nodeType === 9) {\n        parentNode = node = rootNode;\n      } else {\n        node = parentNode;\n      }\n\n      while (node !== rootNode) {\n        parentNode = node;\n        node = node.parentNode;\n      }\n\n      value = parentNode === rootNode ? rootNode.innerHTML : dom.getOuterHTML(parentNode);\n      value = serializer.serialize(parser.parse(value.replace(/<span (id=\"mce_marker\"|id=mce_marker).+?<\\/span>/i, function () {\n        return serializer.serialize(fragment);\n      })));\n\n      if (parentNode === rootNode) {\n        dom.setHTML(rootNode, value);\n      } else {\n        dom.setOuterHTML(parentNode, value);\n      }\n    }\n\n    reduceInlineTextElements(editor, merge);\n    moveSelectionToMarker(editor, dom.get('mce_marker'));\n    unmarkFragmentElements(editor.getBody());\n    trimBrsFromTableCell(dom, selection.getStart());\n    editor.fire('SetContent', args);\n    editor.addVisual();\n  };\n\n  var traverse = function (node, fn) {\n    fn(node);\n\n    if (node.firstChild) {\n      traverse(node.firstChild, fn);\n    }\n\n    if (node.next) {\n      traverse(node.next, fn);\n    }\n  };\n\n  var findMatchingNodes = function (nodeFilters, attributeFilters, node) {\n    var nodeMatches = {};\n    var attrMatches = {};\n    var matches = [];\n\n    if (node.firstChild) {\n      traverse(node.firstChild, function (node) {\n        each(nodeFilters, function (filter) {\n          if (filter.name === node.name) {\n            if (nodeMatches[filter.name]) {\n              nodeMatches[filter.name].nodes.push(node);\n            } else {\n              nodeMatches[filter.name] = {\n                filter: filter,\n                nodes: [node]\n              };\n            }\n          }\n        });\n        each(attributeFilters, function (filter) {\n          if (typeof node.attr(filter.name) === 'string') {\n            if (attrMatches[filter.name]) {\n              attrMatches[filter.name].nodes.push(node);\n            } else {\n              attrMatches[filter.name] = {\n                filter: filter,\n                nodes: [node]\n              };\n            }\n          }\n        });\n      });\n    }\n\n    for (var name_1 in nodeMatches) {\n      if (nodeMatches.hasOwnProperty(name_1)) {\n        matches.push(nodeMatches[name_1]);\n      }\n    }\n\n    for (var name_2 in attrMatches) {\n      if (attrMatches.hasOwnProperty(name_2)) {\n        matches.push(attrMatches[name_2]);\n      }\n    }\n\n    return matches;\n  };\n\n  var filter$3 = function (nodeFilters, attributeFilters, node) {\n    var matches = findMatchingNodes(nodeFilters, attributeFilters, node);\n    each(matches, function (match) {\n      each(match.filter.callbacks, function (callback) {\n        callback(match.nodes, match.filter.name, {});\n      });\n    });\n  };\n\n  var defaultFormat = 'html';\n\n  var isTreeNode = function (content) {\n    return content instanceof AstNode;\n  };\n\n  var moveSelection = function (editor) {\n    if (hasFocus$1(editor)) {\n      firstPositionIn(editor.getBody()).each(function (pos) {\n        var node = pos.getNode();\n        var caretPos = isTable(node) ? firstPositionIn(node).getOr(pos) : pos;\n        editor.selection.setRng(caretPos.toRange());\n      });\n    }\n  };\n\n  var setEditorHtml = function (editor, html) {\n    editor.dom.setHTML(editor.getBody(), html);\n    moveSelection(editor);\n  };\n\n  var setContentString = function (editor, body, content, args) {\n    var forcedRootBlockName, padd;\n\n    if (content.length === 0 || /^\\s+$/.test(content)) {\n      padd = '<br data-mce-bogus=\"1\">';\n\n      if (body.nodeName === 'TABLE') {\n        content = '<tr><td>' + padd + '</td></tr>';\n      } else if (/^(UL|OL)$/.test(body.nodeName)) {\n        content = '<li>' + padd + '</li>';\n      }\n\n      forcedRootBlockName = getForcedRootBlock(editor);\n\n      if (forcedRootBlockName && editor.schema.isValidChild(body.nodeName.toLowerCase(), forcedRootBlockName.toLowerCase())) {\n        content = padd;\n        content = editor.dom.createHTML(forcedRootBlockName, getForcedRootBlockAttrs(editor), content);\n      } else if (!content) {\n        content = '<br data-mce-bogus=\"1\">';\n      }\n\n      setEditorHtml(editor, content);\n      editor.fire('SetContent', args);\n    } else {\n      if (args.format !== 'raw') {\n        content = HtmlSerializer({\n          validate: editor.validate\n        }, editor.schema).serialize(editor.parser.parse(content, {\n          isRootContent: true,\n          insert: true\n        }));\n      }\n\n      args.content = isWsPreserveElement(SugarElement.fromDom(body)) ? content : Tools.trim(content);\n      setEditorHtml(editor, args.content);\n\n      if (!args.no_events) {\n        editor.fire('SetContent', args);\n      }\n    }\n\n    return args.content;\n  };\n\n  var setContentTree = function (editor, body, content, args) {\n    filter$3(editor.parser.getNodeFilters(), editor.parser.getAttributeFilters(), content);\n    var html = HtmlSerializer({\n      validate: editor.validate\n    }, editor.schema).serialize(content);\n    args.content = isWsPreserveElement(SugarElement.fromDom(body)) ? html : Tools.trim(html);\n    setEditorHtml(editor, args.content);\n\n    if (!args.no_events) {\n      editor.fire('SetContent', args);\n    }\n\n    return content;\n  };\n\n  var setContentInternal = function (editor, content, args) {\n    args.format = args.format ? args.format : defaultFormat;\n    args.set = true;\n    args.content = isTreeNode(content) ? '' : content;\n\n    if (!args.no_events) {\n      editor.fire('BeforeSetContent', args);\n    }\n\n    if (!isTreeNode(content)) {\n      content = args.content;\n    }\n\n    return Optional.from(editor.getBody()).fold(constant(content), function (body) {\n      return isTreeNode(content) ? setContentTree(editor, body, content, args) : setContentString(editor, body, content, args);\n    });\n  };\n\n  var sibling$2 = function (scope, predicate) {\n    return sibling(scope, predicate).isSome();\n  };\n\n  var ensureIsRoot = function (isRoot) {\n    return isFunction(isRoot) ? isRoot : never;\n  };\n\n  var ancestor$3 = function (scope, transform, isRoot) {\n    var element = scope.dom;\n    var stop = ensureIsRoot(isRoot);\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n      var transformed = transform(el);\n\n      if (transformed.isSome()) {\n        return transformed;\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest$2 = function (scope, transform, isRoot) {\n    var current = transform(scope);\n    var stop = ensureIsRoot(isRoot);\n    return current.orThunk(function () {\n      return stop(scope) ? Optional.none() : ancestor$3(scope, transform, stop);\n    });\n  };\n\n  var isEq$2 = isEq;\n\n  var matchesUnInheritedFormatSelector = function (ed, node, name) {\n    var formatList = ed.formatter.get(name);\n\n    if (formatList) {\n      for (var i = 0; i < formatList.length; i++) {\n        if (formatList[i].inherit === false && ed.dom.is(node, formatList[i].selector)) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  };\n\n  var matchParents = function (editor, node, name, vars) {\n    var root = editor.dom.getRoot();\n\n    if (node === root) {\n      return false;\n    }\n\n    node = editor.dom.getParent(node, function (node) {\n      if (matchesUnInheritedFormatSelector(editor, node, name)) {\n        return true;\n      }\n\n      return node.parentNode === root || !!matchNode(editor, node, name, vars, true);\n    });\n    return matchNode(editor, node, name, vars);\n  };\n\n  var matchName = function (dom, node, format) {\n    if (isEq$2(node, format.inline)) {\n      return true;\n    }\n\n    if (isEq$2(node, format.block)) {\n      return true;\n    }\n\n    if (format.selector) {\n      return node.nodeType === 1 && dom.is(node, format.selector);\n    }\n  };\n\n  var matchItems = function (dom, node, format, itemName, similar, vars) {\n    var key, value;\n    var items = format[itemName];\n    var i;\n\n    if (format.onmatch) {\n      return format.onmatch(node, format, itemName);\n    }\n\n    if (items) {\n      if (typeof items.length === 'undefined') {\n        for (key in items) {\n          if (items.hasOwnProperty(key)) {\n            if (itemName === 'attributes') {\n              value = dom.getAttrib(node, key);\n            } else {\n              value = getStyle(dom, node, key);\n            }\n\n            if (similar && !value && !format.exact) {\n              return;\n            }\n\n            if ((!similar || format.exact) && !isEq$2(value, normalizeStyleValue(dom, replaceVars(items[key], vars), key))) {\n              return;\n            }\n          }\n        }\n      } else {\n        for (i = 0; i < items.length; i++) {\n          if (itemName === 'attributes' ? dom.getAttrib(node, items[i]) : getStyle(dom, node, items[i])) {\n            return format;\n          }\n        }\n      }\n    }\n\n    return format;\n  };\n\n  var matchNode = function (ed, node, name, vars, similar) {\n    var formatList = ed.formatter.get(name);\n    var format, i, x, classes;\n    var dom = ed.dom;\n\n    if (formatList && node) {\n      for (i = 0; i < formatList.length; i++) {\n        format = formatList[i];\n\n        if (matchName(ed.dom, node, format) && matchItems(dom, node, format, 'attributes', similar, vars) && matchItems(dom, node, format, 'styles', similar, vars)) {\n          if (classes = format.classes) {\n            for (x = 0; x < classes.length; x++) {\n              if (!ed.dom.hasClass(node, classes[x])) {\n                return;\n              }\n            }\n          }\n\n          return format;\n        }\n      }\n    }\n  };\n\n  var match = function (editor, name, vars, node) {\n    if (node) {\n      return matchParents(editor, node, name, vars);\n    }\n\n    node = editor.selection.getNode();\n\n    if (matchParents(editor, node, name, vars)) {\n      return true;\n    }\n\n    var startNode = editor.selection.getStart();\n\n    if (startNode !== node) {\n      if (matchParents(editor, startNode, name, vars)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var matchAll = function (editor, names, vars) {\n    var matchedFormatNames = [];\n    var checkedMap = {};\n    var startElement = editor.selection.getStart();\n    editor.dom.getParent(startElement, function (node) {\n      for (var i = 0; i < names.length; i++) {\n        var name_1 = names[i];\n\n        if (!checkedMap[name_1] && matchNode(editor, node, name_1, vars)) {\n          checkedMap[name_1] = true;\n          matchedFormatNames.push(name_1);\n        }\n      }\n    }, editor.dom.getRoot());\n    return matchedFormatNames;\n  };\n\n  var closest$3 = function (editor, names) {\n    var isRoot = function (elm) {\n      return eq$2(elm, SugarElement.fromDom(editor.getBody()));\n    };\n\n    var match = function (elm, name) {\n      return matchNode(editor, elm.dom, name) ? Optional.some(name) : Optional.none();\n    };\n\n    return Optional.from(editor.selection.getStart(true)).bind(function (rawElm) {\n      return closest$2(SugarElement.fromDom(rawElm), function (elm) {\n        return findMap(names, function (name) {\n          return match(elm, name);\n        });\n      }, isRoot);\n    }).getOrNull();\n  };\n\n  var canApply = function (editor, name) {\n    var formatList = editor.formatter.get(name);\n    var startNode, parents, i, x, selector;\n    var dom = editor.dom;\n\n    if (formatList) {\n      startNode = editor.selection.getStart();\n      parents = getParents$1(dom, startNode);\n\n      for (x = formatList.length - 1; x >= 0; x--) {\n        selector = formatList[x].selector;\n\n        if (!selector || formatList[x].defaultBlock) {\n          return true;\n        }\n\n        for (i = parents.length - 1; i >= 0; i--) {\n          if (dom.is(parents[i], selector)) {\n            return true;\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  var matchAllOnNode = function (editor, node, formatNames) {\n    return foldl(formatNames, function (acc, name) {\n      var matchSimilar = isVariableFormatName(editor, name);\n\n      if (editor.formatter.matchNode(node, name, {}, matchSimilar)) {\n        return acc.concat([name]);\n      } else {\n        return acc;\n      }\n    }, []);\n  };\n\n  var ZWSP$1 = ZWSP,\n      CARET_ID$1 = '_mce_caret';\n\n  var importNode = function (ownerDocument, node) {\n    return ownerDocument.importNode(node, true);\n  };\n\n  var getEmptyCaretContainers = function (node) {\n    var nodes = [];\n\n    while (node) {\n      if (node.nodeType === 3 && node.nodeValue !== ZWSP$1 || node.childNodes.length > 1) {\n        return [];\n      }\n\n      if (node.nodeType === 1) {\n        nodes.push(node);\n      }\n\n      node = node.firstChild;\n    }\n\n    return nodes;\n  };\n\n  var isCaretContainerEmpty = function (node) {\n    return getEmptyCaretContainers(node).length > 0;\n  };\n\n  var findFirstTextNode = function (node) {\n    if (node) {\n      var walker = new DomTreeWalker(node, node);\n\n      for (node = walker.current(); node; node = walker.next()) {\n        if (isText$1(node)) {\n          return node;\n        }\n      }\n    }\n\n    return null;\n  };\n\n  var createCaretContainer = function (fill) {\n    var caretContainer = SugarElement.fromTag('span');\n    setAll(caretContainer, {\n      'id': CARET_ID$1,\n      'data-mce-bogus': '1',\n      'data-mce-type': 'format-caret'\n    });\n\n    if (fill) {\n      append(caretContainer, SugarElement.fromText(ZWSP$1));\n    }\n\n    return caretContainer;\n  };\n\n  var trimZwspFromCaretContainer = function (caretContainerNode) {\n    var textNode = findFirstTextNode(caretContainerNode);\n\n    if (textNode && textNode.nodeValue.charAt(0) === ZWSP$1) {\n      textNode.deleteData(0, 1);\n    }\n\n    return textNode;\n  };\n\n  var removeCaretContainerNode = function (editor, node, moveCaret) {\n    if (moveCaret === void 0) {\n      moveCaret = true;\n    }\n\n    var dom = editor.dom,\n        selection = editor.selection;\n\n    if (isCaretContainerEmpty(node)) {\n      deleteElement(editor, false, SugarElement.fromDom(node), moveCaret);\n    } else {\n      var rng = selection.getRng();\n      var block = dom.getParent(node, dom.isBlock);\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n      var textNode = trimZwspFromCaretContainer(node);\n      dom.remove(node, true);\n\n      if (startContainer === textNode && startOffset > 0) {\n        rng.setStart(textNode, startOffset - 1);\n      }\n\n      if (endContainer === textNode && endOffset > 0) {\n        rng.setEnd(textNode, endOffset - 1);\n      }\n\n      if (block && dom.isEmpty(block)) {\n        fillWithPaddingBr(SugarElement.fromDom(block));\n      }\n\n      selection.setRng(rng);\n    }\n  };\n\n  var removeCaretContainer = function (editor, node, moveCaret) {\n    if (moveCaret === void 0) {\n      moveCaret = true;\n    }\n\n    var dom = editor.dom,\n        selection = editor.selection;\n\n    if (!node) {\n      node = getParentCaretContainer(editor.getBody(), selection.getStart());\n\n      if (!node) {\n        while (node = dom.get(CARET_ID$1)) {\n          removeCaretContainerNode(editor, node, false);\n        }\n      }\n    } else {\n      removeCaretContainerNode(editor, node, moveCaret);\n    }\n  };\n\n  var insertCaretContainerNode = function (editor, caretContainer, formatNode) {\n    var dom = editor.dom,\n        block = dom.getParent(formatNode, curry(isTextBlock$1, editor));\n\n    if (block && dom.isEmpty(block)) {\n      formatNode.parentNode.replaceChild(caretContainer, formatNode);\n    } else {\n      removeTrailingBr(SugarElement.fromDom(formatNode));\n\n      if (dom.isEmpty(formatNode)) {\n        formatNode.parentNode.replaceChild(caretContainer, formatNode);\n      } else {\n        dom.insertAfter(caretContainer, formatNode);\n      }\n    }\n  };\n\n  var appendNode = function (parentNode, node) {\n    parentNode.appendChild(node);\n    return node;\n  };\n\n  var insertFormatNodesIntoCaretContainer = function (formatNodes, caretContainer) {\n    var innerMostFormatNode = foldr(formatNodes, function (parentNode, formatNode) {\n      return appendNode(parentNode, formatNode.cloneNode(false));\n    }, caretContainer);\n    return appendNode(innerMostFormatNode, innerMostFormatNode.ownerDocument.createTextNode(ZWSP$1));\n  };\n\n  var cleanFormatNode = function (editor, caretContainer, formatNode, name, vars, similar) {\n    var formatter = editor.formatter;\n    var dom = editor.dom;\n    var validFormats = filter(keys(formatter.get()), function (formatName) {\n      return formatName !== name && !contains$1(formatName, 'removeformat');\n    });\n    var matchedFormats = matchAllOnNode(editor, formatNode, validFormats);\n    var uniqueFormats = filter(matchedFormats, function (fmtName) {\n      return !areSimilarFormats(editor, fmtName, name);\n    });\n\n    if (uniqueFormats.length > 0) {\n      var clonedFormatNode = formatNode.cloneNode(false);\n      dom.add(caretContainer, clonedFormatNode);\n      formatter.remove(name, vars, clonedFormatNode, similar);\n      dom.remove(clonedFormatNode);\n      return Optional.some(clonedFormatNode);\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var applyCaretFormat = function (editor, name, vars) {\n    var caretContainer, textNode;\n    var selection = editor.selection;\n    var selectionRng = selection.getRng();\n    var offset = selectionRng.startOffset;\n    var container = selectionRng.startContainer;\n    var text = container.nodeValue;\n    caretContainer = getParentCaretContainer(editor.getBody(), selection.getStart());\n\n    if (caretContainer) {\n      textNode = findFirstTextNode(caretContainer);\n    }\n\n    var wordcharRegex = /[^\\s\\u00a0\\u00ad\\u200b\\ufeff]/;\n\n    if (text && offset > 0 && offset < text.length && wordcharRegex.test(text.charAt(offset)) && wordcharRegex.test(text.charAt(offset - 1))) {\n      var bookmark = selection.getBookmark();\n      selectionRng.collapse(true);\n      var rng = expandRng(editor, selectionRng, editor.formatter.get(name));\n      rng = split$1(rng);\n      editor.formatter.apply(name, vars, rng);\n      selection.moveToBookmark(bookmark);\n    } else {\n      if (!caretContainer || textNode.nodeValue !== ZWSP$1) {\n        caretContainer = importNode(editor.getDoc(), createCaretContainer(true).dom);\n        textNode = caretContainer.firstChild;\n        selectionRng.insertNode(caretContainer);\n        offset = 1;\n        editor.formatter.apply(name, vars, caretContainer);\n      } else {\n        editor.formatter.apply(name, vars, caretContainer);\n      }\n\n      selection.setCursorLocation(textNode, offset);\n    }\n  };\n\n  var removeCaretFormat = function (editor, name, vars, similar) {\n    var dom = editor.dom;\n    var selection = editor.selection;\n    var hasContentAfter, node, formatNode;\n    var parents = [];\n    var rng = selection.getRng();\n    var container = rng.startContainer;\n    var offset = rng.startOffset;\n    node = container;\n\n    if (container.nodeType === 3) {\n      if (offset !== container.nodeValue.length) {\n        hasContentAfter = true;\n      }\n\n      node = node.parentNode;\n    }\n\n    while (node) {\n      if (matchNode(editor, node, name, vars, similar)) {\n        formatNode = node;\n        break;\n      }\n\n      if (node.nextSibling) {\n        hasContentAfter = true;\n      }\n\n      parents.push(node);\n      node = node.parentNode;\n    }\n\n    if (!formatNode) {\n      return;\n    }\n\n    if (hasContentAfter) {\n      var bookmark = selection.getBookmark();\n      rng.collapse(true);\n      var expandedRng = expandRng(editor, rng, editor.formatter.get(name), true);\n      expandedRng = split$1(expandedRng);\n      editor.formatter.remove(name, vars, expandedRng, similar);\n      selection.moveToBookmark(bookmark);\n    } else {\n      var caretContainer = getParentCaretContainer(editor.getBody(), formatNode);\n      var newCaretContainer = createCaretContainer(false).dom;\n      insertCaretContainerNode(editor, newCaretContainer, caretContainer !== null ? caretContainer : formatNode);\n      var cleanedFormatNode = cleanFormatNode(editor, newCaretContainer, formatNode, name, vars, similar);\n      var caretTextNode = insertFormatNodesIntoCaretContainer(parents.concat(cleanedFormatNode.toArray()), newCaretContainer);\n      removeCaretContainerNode(editor, caretContainer, false);\n      selection.setCursorLocation(caretTextNode, 1);\n\n      if (dom.isEmpty(formatNode)) {\n        dom.remove(formatNode);\n      }\n    }\n  };\n\n  var disableCaretContainer = function (editor, keyCode) {\n    var selection = editor.selection,\n        body = editor.getBody();\n    removeCaretContainer(editor, null, false);\n\n    if ((keyCode === 8 || keyCode === 46) && selection.isCollapsed() && selection.getStart().innerHTML === ZWSP$1) {\n      removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n    }\n\n    if (keyCode === 37 || keyCode === 39) {\n      removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n    }\n  };\n\n  var setup$3 = function (editor) {\n    editor.on('mouseup keydown', function (e) {\n      disableCaretContainer(editor, e.keyCode);\n    });\n  };\n\n  var replaceWithCaretFormat = function (targetNode, formatNodes) {\n    var caretContainer = createCaretContainer(false);\n    var innerMost = insertFormatNodesIntoCaretContainer(formatNodes, caretContainer.dom);\n    before(SugarElement.fromDom(targetNode), caretContainer);\n    remove(SugarElement.fromDom(targetNode));\n    return CaretPosition(innerMost, 0);\n  };\n\n  var isFormatElement = function (editor, element) {\n    var inlineElements = editor.schema.getTextInlineElements();\n    return inlineElements.hasOwnProperty(name(element)) && !isCaretNode(element.dom) && !isBogus(element.dom);\n  };\n\n  var isEmptyCaretFormatElement = function (element) {\n    return isCaretNode(element.dom) && isCaretContainerEmpty(element.dom);\n  };\n\n  var postProcessHooks = {};\n  var filter$4 = filter$2;\n  var each$8 = each$2;\n\n  var addPostProcessHook = function (name, hook) {\n    var hooks = postProcessHooks[name];\n\n    if (!hooks) {\n      postProcessHooks[name] = [];\n    }\n\n    postProcessHooks[name].push(hook);\n  };\n\n  var postProcess = function (name, editor) {\n    each$8(postProcessHooks[name], function (hook) {\n      hook(editor);\n    });\n  };\n\n  addPostProcessHook('pre', function (editor) {\n    var rng = editor.selection.getRng();\n    var blocks;\n\n    var hasPreSibling = function (pre) {\n      return isPre(pre.previousSibling) && indexOf$1(blocks, pre.previousSibling) !== -1;\n    };\n\n    var joinPre = function (pre1, pre2) {\n      DomQuery(pre2).remove();\n      DomQuery(pre1).append('<br><br>').append(pre2.childNodes);\n    };\n\n    var isPre = matchNodeNames(['pre']);\n\n    if (!rng.collapsed) {\n      blocks = editor.selection.getSelectedBlocks();\n      each$8(filter$4(filter$4(blocks, isPre), hasPreSibling), function (pre) {\n        joinPre(pre.previousSibling, pre);\n      });\n    }\n  });\n  var each$9 = Tools.each;\n\n  var isElementNode = function (node) {\n    return isElement$1(node) && !isBookmarkNode$1(node) && !isCaretNode(node) && !isBogus(node);\n  };\n\n  var findElementSibling = function (node, siblingName) {\n    var sibling;\n\n    for (sibling = node; sibling; sibling = sibling[siblingName]) {\n      if (isText$1(sibling) && sibling.nodeValue.length !== 0) {\n        return node;\n      }\n\n      if (isElement$1(sibling) && !isBookmarkNode$1(sibling)) {\n        return sibling;\n      }\n    }\n\n    return node;\n  };\n\n  var mergeSiblingsNodes = function (dom, prev, next) {\n    var sibling, tmpSibling;\n    var elementUtils = ElementUtils(dom);\n\n    if (prev && next) {\n      prev = findElementSibling(prev, 'previousSibling');\n      next = findElementSibling(next, 'nextSibling');\n\n      if (elementUtils.compare(prev, next)) {\n        for (sibling = prev.nextSibling; sibling && sibling !== next;) {\n          tmpSibling = sibling;\n          sibling = sibling.nextSibling;\n          prev.appendChild(tmpSibling);\n        }\n\n        dom.remove(next);\n        Tools.each(Tools.grep(next.childNodes), function (node) {\n          prev.appendChild(node);\n        });\n        return prev;\n      }\n    }\n\n    return next;\n  };\n\n  var mergeSiblings = function (dom, format, vars, node) {\n    if (node && format.merge_siblings !== false) {\n      var newNode = mergeSiblingsNodes(dom, getNonWhiteSpaceSibling(node), node);\n      mergeSiblingsNodes(dom, newNode, getNonWhiteSpaceSibling(newNode, true));\n    }\n  };\n\n  var clearChildStyles = function (dom, format, node) {\n    if (format.clear_child_styles) {\n      var selector = format.links ? '*:not(a)' : '*';\n      each$9(dom.select(selector, node), function (node) {\n        if (isElementNode(node)) {\n          each$9(format.styles, function (value, name) {\n            dom.setStyle(node, name, '');\n          });\n        }\n      });\n    }\n  };\n\n  var processChildElements = function (node, filter, process) {\n    each$9(node.childNodes, function (node) {\n      if (isElementNode(node)) {\n        if (filter(node)) {\n          process(node);\n        }\n\n        if (node.hasChildNodes()) {\n          processChildElements(node, filter, process);\n        }\n      }\n    });\n  };\n\n  var unwrapEmptySpan = function (dom, node) {\n    if (node.nodeName === 'SPAN' && dom.getAttribs(node).length === 0) {\n      dom.remove(node, true);\n    }\n  };\n\n  var hasStyle = function (dom, name) {\n    return function (node) {\n      return !!(node && getStyle(dom, node, name));\n    };\n  };\n\n  var applyStyle = function (dom, name, value) {\n    return function (node) {\n      dom.setStyle(node, name, value);\n\n      if (node.getAttribute('style') === '') {\n        node.removeAttribute('style');\n      }\n\n      unwrapEmptySpan(dom, node);\n    };\n  };\n\n  var removeResult = Adt.generate([{\n    keep: []\n  }, {\n    rename: ['name']\n  }, {\n    removed: []\n  }]);\n  var MCE_ATTR_RE = /^(src|href|style)$/;\n  var each$a = Tools.each;\n  var isEq$3 = isEq;\n\n  var isTableCellOrRow = function (node) {\n    return /^(TR|TH|TD)$/.test(node.nodeName);\n  };\n\n  var isChildOfInlineParent = function (dom, node, parent) {\n    return dom.isChildOf(node, parent) && node !== parent && !dom.isBlock(parent);\n  };\n\n  var getContainer = function (ed, rng, start) {\n    var container, offset;\n    container = rng[start ? 'startContainer' : 'endContainer'];\n    offset = rng[start ? 'startOffset' : 'endOffset'];\n\n    if (isElement$1(container)) {\n      var lastIdx = container.childNodes.length - 1;\n\n      if (!start && offset) {\n        offset--;\n      }\n\n      container = container.childNodes[offset > lastIdx ? lastIdx : offset];\n    }\n\n    if (isText$1(container) && start && offset >= container.nodeValue.length) {\n      container = new DomTreeWalker(container, ed.getBody()).next() || container;\n    }\n\n    if (isText$1(container) && !start && offset === 0) {\n      container = new DomTreeWalker(container, ed.getBody()).prev() || container;\n    }\n\n    return container;\n  };\n\n  var normalizeTableSelection = function (node, start) {\n    var prop = start ? 'firstChild' : 'lastChild';\n\n    if (isTableCellOrRow(node) && node[prop]) {\n      var childNode = node[prop];\n\n      if (node.nodeName === 'TR') {\n        return childNode[prop] || childNode;\n      } else {\n        return childNode;\n      }\n    }\n\n    return node;\n  };\n\n  var wrap$2 = function (dom, node, name, attrs) {\n    var wrapper = dom.create(name, attrs);\n    node.parentNode.insertBefore(wrapper, node);\n    wrapper.appendChild(node);\n    return wrapper;\n  };\n\n  var wrapWithSiblings = function (dom, node, next, name, attrs) {\n    var start = SugarElement.fromDom(node);\n    var wrapper = SugarElement.fromDom(dom.create(name, attrs));\n    var siblings = next ? nextSiblings(start) : prevSiblings(start);\n    append$1(wrapper, siblings);\n\n    if (next) {\n      before(start, wrapper);\n      prepend(wrapper, start);\n    } else {\n      after(start, wrapper);\n      append(wrapper, start);\n    }\n\n    return wrapper.dom;\n  };\n\n  var matchName$1 = function (dom, node, format) {\n    if (isEq$3(node, format.inline)) {\n      return true;\n    }\n\n    if (isEq$3(node, format.block)) {\n      return true;\n    }\n\n    if (format.selector) {\n      return isElement$1(node) && dom.is(node, format.selector);\n    }\n  };\n\n  var isColorFormatAndAnchor = function (node, format) {\n    return format.links && node.nodeName === 'A';\n  };\n\n  var find$3 = function (dom, node, next, inc) {\n    node = getNonWhiteSpaceSibling(node, next, inc);\n    return !node || node.nodeName === 'BR' || dom.isBlock(node);\n  };\n\n  var removeNode$1 = function (ed, node, format) {\n    var parentNode = node.parentNode;\n    var rootBlockElm;\n    var dom = ed.dom,\n        forcedRootBlock = getForcedRootBlock(ed);\n\n    if (format.block) {\n      if (!forcedRootBlock) {\n        if (dom.isBlock(node) && !dom.isBlock(parentNode)) {\n          if (!find$3(dom, node, false) && !find$3(dom, node.firstChild, true, true)) {\n            node.insertBefore(dom.create('br'), node.firstChild);\n          }\n\n          if (!find$3(dom, node, true) && !find$3(dom, node.lastChild, false, true)) {\n            node.appendChild(dom.create('br'));\n          }\n        }\n      } else {\n        if (parentNode === dom.getRoot()) {\n          if (!format.list_block || !isEq$3(node, format.list_block)) {\n            each(from$1(node.childNodes), function (node) {\n              if (isValid(ed, forcedRootBlock, node.nodeName.toLowerCase())) {\n                if (!rootBlockElm) {\n                  rootBlockElm = wrap$2(dom, node, forcedRootBlock);\n                  dom.setAttribs(rootBlockElm, ed.settings.forced_root_block_attrs);\n                } else {\n                  rootBlockElm.appendChild(node);\n                }\n              } else {\n                rootBlockElm = 0;\n              }\n            });\n          }\n        }\n      }\n    }\n\n    if (format.selector && format.inline && !isEq$3(format.inline, node)) {\n      return;\n    }\n\n    dom.remove(node, true);\n  };\n\n  var removeFormatInternal = function (ed, format, vars, node, compareNode) {\n    var stylesModified;\n    var dom = ed.dom;\n\n    if (!matchName$1(dom, node, format) && !isColorFormatAndAnchor(node, format)) {\n      return removeResult.keep();\n    }\n\n    var elm = node;\n\n    if (format.inline && format.remove === 'all' && isArray(format.preserve_attributes)) {\n      var attrsToPreserve = filter(dom.getAttribs(elm), function (attr) {\n        return contains(format.preserve_attributes, attr.name.toLowerCase());\n      });\n      dom.removeAllAttribs(elm);\n      each(attrsToPreserve, function (attr) {\n        return dom.setAttrib(elm, attr.name, attr.value);\n      });\n\n      if (attrsToPreserve.length > 0) {\n        return removeResult.rename('span');\n      }\n    }\n\n    if (format.remove !== 'all') {\n      each$a(format.styles, function (value, name) {\n        value = normalizeStyleValue(dom, replaceVars(value, vars), name + '');\n\n        if (isNumber(name)) {\n          name = value;\n          compareNode = null;\n        }\n\n        if (format.remove_similar || !compareNode || isEq$3(getStyle(dom, compareNode, name), value)) {\n          dom.setStyle(elm, name, '');\n        }\n\n        stylesModified = true;\n      });\n\n      if (stylesModified && dom.getAttrib(elm, 'style') === '') {\n        elm.removeAttribute('style');\n        elm.removeAttribute('data-mce-style');\n      }\n\n      each$a(format.attributes, function (value, name) {\n        var valueOut;\n        value = replaceVars(value, vars);\n\n        if (isNumber(name)) {\n          name = value;\n          compareNode = null;\n        }\n\n        if (format.remove_similar || !compareNode || isEq$3(dom.getAttrib(compareNode, name), value)) {\n          if (name === 'class') {\n            value = dom.getAttrib(elm, name);\n\n            if (value) {\n              valueOut = '';\n              each(value.split(/\\s+/), function (cls) {\n                if (/mce\\-\\w+/.test(cls)) {\n                  valueOut += (valueOut ? ' ' : '') + cls;\n                }\n              });\n\n              if (valueOut) {\n                dom.setAttrib(elm, name, valueOut);\n                return;\n              }\n            }\n          }\n\n          if (name === 'class') {\n            elm.removeAttribute('className');\n          }\n\n          if (MCE_ATTR_RE.test(name)) {\n            elm.removeAttribute('data-mce-' + name);\n          }\n\n          elm.removeAttribute(name);\n        }\n      });\n      each$a(format.classes, function (value) {\n        value = replaceVars(value, vars);\n\n        if (!compareNode || dom.hasClass(compareNode, value)) {\n          dom.removeClass(elm, value);\n        }\n      });\n      var attrs = dom.getAttribs(elm);\n\n      for (var i = 0; i < attrs.length; i++) {\n        var attrName = attrs[i].nodeName;\n\n        if (attrName.indexOf('_') !== 0 && attrName.indexOf('data-') !== 0) {\n          return removeResult.keep();\n        }\n      }\n    }\n\n    if (format.remove !== 'none') {\n      removeNode$1(ed, elm, format);\n      return removeResult.removed();\n    }\n\n    return removeResult.keep();\n  };\n\n  var removeFormat = function (ed, format, vars, node, compareNode) {\n    return removeFormatInternal(ed, format, vars, node, compareNode).fold(never, function (newName) {\n      ed.dom.rename(node, newName);\n      return true;\n    }, always);\n  };\n\n  var findFormatRoot = function (editor, container, name, vars, similar) {\n    var formatRoot;\n    each(getParents$1(editor.dom, container.parentNode).reverse(), function (parent) {\n      if (!formatRoot && parent.id !== '_start' && parent.id !== '_end') {\n        var format = matchNode(editor, parent, name, vars, similar);\n\n        if (format && format.split !== false) {\n          formatRoot = parent;\n        }\n      }\n    });\n    return formatRoot;\n  };\n\n  var removeFormatFromClone = function (editor, format, vars, clone) {\n    return removeFormatInternal(editor, format, vars, clone, clone).fold(constant(clone), function (newName) {\n      var fragment = editor.dom.createFragment();\n      fragment.appendChild(clone);\n      return editor.dom.rename(clone, newName);\n    }, constant(null));\n  };\n\n  var wrapAndSplit = function (editor, formatList, formatRoot, container, target, split, format, vars) {\n    var clone, lastClone, firstClone;\n    var dom = editor.dom;\n\n    if (formatRoot) {\n      var formatRootParent = formatRoot.parentNode;\n\n      for (var parent_1 = container.parentNode; parent_1 && parent_1 !== formatRootParent; parent_1 = parent_1.parentNode) {\n        clone = dom.clone(parent_1, false);\n\n        for (var i = 0; i < formatList.length; i++) {\n          clone = removeFormatFromClone(editor, formatList[i], vars, clone);\n\n          if (clone === null) {\n            break;\n          }\n        }\n\n        if (clone) {\n          if (lastClone) {\n            clone.appendChild(lastClone);\n          }\n\n          if (!firstClone) {\n            firstClone = clone;\n          }\n\n          lastClone = clone;\n        }\n      }\n\n      if (split && (!format.mixed || !dom.isBlock(formatRoot))) {\n        container = dom.split(formatRoot, container);\n      }\n\n      if (lastClone) {\n        target.parentNode.insertBefore(lastClone, target);\n        firstClone.appendChild(target);\n\n        if (format.inline) {\n          mergeSiblings(dom, format, vars, lastClone);\n        }\n      }\n    }\n\n    return container;\n  };\n\n  var remove$6 = function (ed, name, vars, node, similar) {\n    var formatList = ed.formatter.get(name);\n    var format = formatList[0];\n    var contentEditable = true;\n    var dom = ed.dom;\n    var selection = ed.selection;\n\n    var splitToFormatRoot = function (container) {\n      var formatRoot = findFormatRoot(ed, container, name, vars, similar);\n      return wrapAndSplit(ed, formatList, formatRoot, container, container, true, format, vars);\n    };\n\n    var isRemoveBookmarkNode = function (node) {\n      return isBookmarkNode$1(node) && isElement$1(node) && (node.id === '_start' || node.id === '_end');\n    };\n\n    var process = function (node) {\n      var lastContentEditable, hasContentEditableState;\n\n      if (isElement$1(node) && dom.getContentEditable(node)) {\n        lastContentEditable = contentEditable;\n        contentEditable = dom.getContentEditable(node) === 'true';\n        hasContentEditableState = true;\n      }\n\n      var children = from$1(node.childNodes);\n\n      if (contentEditable && !hasContentEditableState) {\n        for (var i = 0; i < formatList.length; i++) {\n          if (removeFormat(ed, formatList[i], vars, node, node)) {\n            break;\n          }\n        }\n      }\n\n      if (format.deep) {\n        if (children.length) {\n          for (var i = 0; i < children.length; i++) {\n            process(children[i]);\n          }\n\n          if (hasContentEditableState) {\n            contentEditable = lastContentEditable;\n          }\n        }\n      }\n    };\n\n    var unwrap = function (start) {\n      var node = dom.get(start ? '_start' : '_end');\n      var out = node[start ? 'firstChild' : 'lastChild'];\n\n      if (isRemoveBookmarkNode(out)) {\n        out = out[start ? 'firstChild' : 'lastChild'];\n      }\n\n      if (isText$1(out) && out.data.length === 0) {\n        out = start ? node.previousSibling || node.nextSibling : node.nextSibling || node.previousSibling;\n      }\n\n      dom.remove(node, true);\n      return out;\n    };\n\n    var removeRngStyle = function (rng) {\n      var startContainer, endContainer;\n      var expandedRng = expandRng(ed, rng, formatList, rng.collapsed);\n\n      if (format.split) {\n        expandedRng = split$1(expandedRng);\n        startContainer = getContainer(ed, expandedRng, true);\n        endContainer = getContainer(ed, expandedRng);\n\n        if (startContainer !== endContainer) {\n          startContainer = normalizeTableSelection(startContainer, true);\n          endContainer = normalizeTableSelection(endContainer, false);\n\n          if (isChildOfInlineParent(dom, startContainer, endContainer)) {\n            var marker = Optional.from(startContainer.firstChild).getOr(startContainer);\n            splitToFormatRoot(wrapWithSiblings(dom, marker, true, 'span', {\n              'id': '_start',\n              'data-mce-type': 'bookmark'\n            }));\n            unwrap(true);\n            return;\n          }\n\n          if (isChildOfInlineParent(dom, endContainer, startContainer)) {\n            var marker = Optional.from(endContainer.lastChild).getOr(endContainer);\n            splitToFormatRoot(wrapWithSiblings(dom, marker, false, 'span', {\n              'id': '_end',\n              'data-mce-type': 'bookmark'\n            }));\n            unwrap(false);\n            return;\n          }\n\n          startContainer = wrap$2(dom, startContainer, 'span', {\n            'id': '_start',\n            'data-mce-type': 'bookmark'\n          });\n          endContainer = wrap$2(dom, endContainer, 'span', {\n            'id': '_end',\n            'data-mce-type': 'bookmark'\n          });\n          var newRng = dom.createRng();\n          newRng.setStartAfter(startContainer);\n          newRng.setEndBefore(endContainer);\n          walk$1(dom, newRng, function (nodes) {\n            each(nodes, function (n) {\n              if (!isBookmarkNode$1(n) && !isBookmarkNode$1(n.parentNode)) {\n                splitToFormatRoot(n);\n              }\n            });\n          });\n          splitToFormatRoot(startContainer);\n          splitToFormatRoot(endContainer);\n          startContainer = unwrap(true);\n          endContainer = unwrap();\n        } else {\n          startContainer = endContainer = splitToFormatRoot(startContainer);\n        }\n\n        expandedRng.startContainer = startContainer.parentNode ? startContainer.parentNode : startContainer;\n        expandedRng.startOffset = dom.nodeIndex(startContainer);\n        expandedRng.endContainer = endContainer.parentNode ? endContainer.parentNode : endContainer;\n        expandedRng.endOffset = dom.nodeIndex(endContainer) + 1;\n      }\n\n      walk$1(dom, expandedRng, function (nodes) {\n        each(nodes, function (node) {\n          process(node);\n          var textDecorations = ['underline', 'line-through', 'overline'];\n          each(textDecorations, function (decoration) {\n            if (isElement$1(node) && ed.dom.getStyle(node, 'text-decoration') === decoration && node.parentNode && getTextDecoration(dom, node.parentNode) === decoration) {\n              removeFormat(ed, {\n                deep: false,\n                exact: true,\n                inline: 'span',\n                styles: {\n                  textDecoration: decoration\n                }\n              }, null, node);\n            }\n          });\n        });\n      });\n    };\n\n    if (node) {\n      if (isNode(node)) {\n        var rng = dom.createRng();\n        rng.setStartBefore(node);\n        rng.setEndAfter(node);\n        removeRngStyle(rng);\n      } else {\n        removeRngStyle(node);\n      }\n\n      return;\n    }\n\n    if (dom.getContentEditable(selection.getNode()) === 'false') {\n      node = selection.getNode();\n\n      for (var i = 0; i < formatList.length; i++) {\n        if (formatList[i].ceFalseOverride) {\n          if (removeFormat(ed, formatList[i], vars, node, node)) {\n            break;\n          }\n        }\n      }\n\n      return;\n    }\n\n    if (!selection.isCollapsed() || !format.inline || getCellsFromEditor(ed).length) {\n      preserve(selection, true, function () {\n        runOnRanges(ed, removeRngStyle);\n      });\n\n      if (format.inline && match(ed, name, vars, selection.getStart())) {\n        moveStart(dom, selection, selection.getRng());\n      }\n\n      ed.nodeChanged();\n    } else {\n      removeCaretFormat(ed, name, vars, similar);\n    }\n  };\n\n  var each$b = Tools.each;\n\n  var mergeTextDecorationsAndColor = function (dom, format, vars, node) {\n    var processTextDecorationsAndColor = function (n) {\n      if (n.nodeType === 1 && n.parentNode && n.parentNode.nodeType === 1) {\n        var textDecoration = getTextDecoration(dom, n.parentNode);\n\n        if (dom.getStyle(n, 'color') && textDecoration) {\n          dom.setStyle(n, 'text-decoration', textDecoration);\n        } else if (dom.getStyle(n, 'text-decoration') === textDecoration) {\n          dom.setStyle(n, 'text-decoration', null);\n        }\n      }\n    };\n\n    if (format.styles && (format.styles.color || format.styles.textDecoration)) {\n      Tools.walk(node, processTextDecorationsAndColor, 'childNodes');\n      processTextDecorationsAndColor(node);\n    }\n  };\n\n  var mergeBackgroundColorAndFontSize = function (dom, format, vars, node) {\n    if (format.styles && format.styles.backgroundColor) {\n      processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'backgroundColor', replaceVars(format.styles.backgroundColor, vars)));\n    }\n  };\n\n  var mergeSubSup = function (dom, format, vars, node) {\n    if (format.inline === 'sub' || format.inline === 'sup') {\n      processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'fontSize', ''));\n      dom.remove(dom.select(format.inline === 'sup' ? 'sub' : 'sup', node), true);\n    }\n  };\n\n  var mergeWithChildren = function (editor, formatList, vars, node) {\n    each$b(formatList, function (format) {\n      each$b(editor.dom.select(format.inline, node), function (child) {\n        if (!isElementNode(child)) {\n          return;\n        }\n\n        removeFormat(editor, format, vars, child, format.exact ? child : null);\n      });\n      clearChildStyles(editor.dom, format, node);\n    });\n  };\n\n  var mergeWithParents = function (editor, format, name, vars, node) {\n    if (matchNode(editor, node.parentNode, name, vars)) {\n      if (removeFormat(editor, format, vars, node)) {\n        return;\n      }\n    }\n\n    if (format.merge_with_parents) {\n      editor.dom.getParent(node.parentNode, function (parent) {\n        if (matchNode(editor, parent, name, vars)) {\n          removeFormat(editor, format, vars, node);\n          return true;\n        }\n      });\n    }\n  };\n\n  var each$c = Tools.each;\n\n  var hasFormatProperty = function (format, prop) {\n    return hasNonNullableKey(format, prop);\n  };\n\n  var isElementNode$1 = function (node) {\n    return node && node.nodeType === 1 && !isBookmarkNode$1(node) && !isCaretNode(node) && !isBogus(node);\n  };\n\n  var canFormatBR = function (editor, format, node, parentName) {\n    if (canFormatEmptyLines(editor) && isInlineFormat(format)) {\n      var validBRParentElements = __assign(__assign({}, editor.schema.getTextBlockElements()), {\n        td: {},\n        th: {},\n        li: {},\n        dt: {},\n        dd: {},\n        figcaption: {},\n        caption: {},\n        details: {},\n        summary: {}\n      });\n\n      var hasCaretNodeSibling = sibling$2(SugarElement.fromDom(node), function (sibling) {\n        return isCaretNode(sibling.dom);\n      });\n      return hasNonNullableKey(validBRParentElements, parentName) && isEmpty(SugarElement.fromDom(node.parentNode), false) && !hasCaretNodeSibling;\n    } else {\n      return false;\n    }\n  };\n\n  var applyFormat = function (ed, name, vars, node) {\n    var formatList = ed.formatter.get(name);\n    var format = formatList[0];\n    var isCollapsed = !node && ed.selection.isCollapsed();\n    var dom = ed.dom;\n    var selection = ed.selection;\n\n    var setElementFormat = function (elm, fmt) {\n      fmt = fmt || format;\n\n      if (elm) {\n        if (fmt.onformat) {\n          fmt.onformat(elm, fmt, vars, node);\n        }\n\n        each$c(fmt.styles, function (value, name) {\n          dom.setStyle(elm, name, replaceVars(value, vars));\n        });\n\n        if (fmt.styles) {\n          var styleVal = dom.getAttrib(elm, 'style');\n\n          if (styleVal) {\n            dom.setAttrib(elm, 'data-mce-style', styleVal);\n          }\n        }\n\n        each$c(fmt.attributes, function (value, name) {\n          dom.setAttrib(elm, name, replaceVars(value, vars));\n        });\n        each$c(fmt.classes, function (value) {\n          value = replaceVars(value, vars);\n\n          if (!dom.hasClass(elm, value)) {\n            dom.addClass(elm, value);\n          }\n        });\n      }\n    };\n\n    var applyNodeStyle = function (formatList, node) {\n      var found = false;\n\n      if (!isSelectorFormat(format)) {\n        return false;\n      }\n\n      each$c(formatList, function (format) {\n        if ('collapsed' in format && format.collapsed !== isCollapsed) {\n          return;\n        }\n\n        if (dom.is(node, format.selector) && !isCaretNode(node)) {\n          setElementFormat(node, format);\n          found = true;\n          return false;\n        }\n      });\n      return found;\n    };\n\n    var applyRngStyle = function (dom, rng, bookmark, nodeSpecific) {\n      var newWrappers = [];\n      var contentEditable = true;\n      var wrapName = format.inline || format.block;\n      var wrapElm = dom.create(wrapName);\n      setElementFormat(wrapElm);\n      walk$1(dom, rng, function (nodes) {\n        var currentWrapElm;\n\n        var process = function (node) {\n          var hasContentEditableState = false;\n          var lastContentEditable = contentEditable;\n          var nodeName = node.nodeName.toLowerCase();\n          var parentName = node.parentNode.nodeName.toLowerCase();\n\n          if (isElement$1(node) && dom.getContentEditable(node)) {\n            lastContentEditable = contentEditable;\n            contentEditable = dom.getContentEditable(node) === 'true';\n            hasContentEditableState = true;\n          }\n\n          if (isBr(node) && !canFormatBR(ed, format, node, parentName)) {\n            currentWrapElm = null;\n\n            if (isBlockFormat(format)) {\n              dom.remove(node);\n            }\n\n            return;\n          }\n\n          if (format.wrapper && matchNode(ed, node, name, vars)) {\n            currentWrapElm = null;\n            return;\n          }\n\n          if (contentEditable && !hasContentEditableState && isBlockFormat(format) && !format.wrapper && isTextBlock$1(ed, nodeName) && isValid(ed, parentName, wrapName)) {\n            var elm = dom.rename(node, wrapName);\n            setElementFormat(elm);\n            newWrappers.push(elm);\n            currentWrapElm = null;\n            return;\n          }\n\n          if (isSelectorFormat(format)) {\n            var found = applyNodeStyle(formatList, node);\n\n            if (!hasFormatProperty(format, 'inline') || found) {\n              currentWrapElm = null;\n              return;\n            }\n          }\n\n          if (contentEditable && !hasContentEditableState && isValid(ed, wrapName, nodeName) && isValid(ed, parentName, wrapName) && !(!nodeSpecific && node.nodeType === 3 && node.nodeValue.length === 1 && node.nodeValue.charCodeAt(0) === 65279) && !isCaretNode(node) && (!hasFormatProperty(format, 'inline') || !dom.isBlock(node))) {\n            if (!currentWrapElm) {\n              currentWrapElm = dom.clone(wrapElm, false);\n              node.parentNode.insertBefore(currentWrapElm, node);\n              newWrappers.push(currentWrapElm);\n            }\n\n            currentWrapElm.appendChild(node);\n          } else {\n            currentWrapElm = null;\n            each$c(Tools.grep(node.childNodes), process);\n\n            if (hasContentEditableState) {\n              contentEditable = lastContentEditable;\n            }\n\n            currentWrapElm = null;\n          }\n        };\n\n        each$c(nodes, process);\n      });\n\n      if (format.links === true) {\n        each$c(newWrappers, function (node) {\n          var process = function (node) {\n            if (node.nodeName === 'A') {\n              setElementFormat(node, format);\n            }\n\n            each$c(Tools.grep(node.childNodes), process);\n          };\n\n          process(node);\n        });\n      }\n\n      each$c(newWrappers, function (node) {\n        var getChildCount = function (node) {\n          var count = 0;\n          each$c(node.childNodes, function (node) {\n            if (!isEmptyTextNode(node) && !isBookmarkNode$1(node)) {\n              count++;\n            }\n          });\n          return count;\n        };\n\n        var getChildElementNode = function (root) {\n          var child = false;\n          each$c(root.childNodes, function (node) {\n            if (isElementNode$1(node)) {\n              child = node;\n              return false;\n            }\n          });\n          return child;\n        };\n\n        var mergeStyles = function (node) {\n          var clone;\n          var child = getChildElementNode(node);\n\n          if (child && !isBookmarkNode$1(child) && matchName(dom, child, format)) {\n            clone = dom.clone(child, false);\n            setElementFormat(clone);\n            dom.replace(clone, node, true);\n            dom.remove(child, true);\n          }\n\n          return clone || node;\n        };\n\n        var childCount = getChildCount(node);\n\n        if ((newWrappers.length > 1 || !dom.isBlock(node)) && childCount === 0) {\n          dom.remove(node, true);\n          return;\n        }\n\n        if (isInlineFormat(format) || format.wrapper) {\n          if (!format.exact && childCount === 1) {\n            node = mergeStyles(node);\n          }\n\n          mergeWithChildren(ed, formatList, vars, node);\n          mergeWithParents(ed, format, name, vars, node);\n          mergeBackgroundColorAndFontSize(dom, format, vars, node);\n          mergeTextDecorationsAndColor(dom, format, vars, node);\n          mergeSubSup(dom, format, vars, node);\n          mergeSiblings(dom, format, vars, node);\n        }\n      });\n    };\n\n    if (dom.getContentEditable(selection.getNode()) === 'false') {\n      node = selection.getNode();\n\n      for (var i = 0, l = formatList.length; i < l; i++) {\n        var formatItem = formatList[i];\n\n        if (formatItem.ceFalseOverride && isSelectorFormat(formatItem) && dom.is(node, formatItem.selector)) {\n          setElementFormat(node, formatItem);\n          return;\n        }\n      }\n\n      return;\n    }\n\n    if (format) {\n      if (node) {\n        if (isNode(node)) {\n          if (!applyNodeStyle(formatList, node)) {\n            var rng = dom.createRng();\n            rng.setStartBefore(node);\n            rng.setEndAfter(node);\n            applyRngStyle(dom, expandRng(ed, rng, formatList), null, true);\n          }\n        } else {\n          applyRngStyle(dom, node, null, true);\n        }\n      } else {\n        if (!isCollapsed || !isInlineFormat(format) || getCellsFromEditor(ed).length) {\n          var curSelNode = selection.getNode();\n          var firstFormat = formatList[0];\n\n          if (!ed.settings.forced_root_block && firstFormat.defaultBlock && !dom.getParent(curSelNode, dom.isBlock)) {\n            applyFormat(ed, firstFormat.defaultBlock);\n          }\n\n          selection.setRng(normalize$2(selection.getRng()));\n          preserve(selection, true, function (bookmark) {\n            runOnRanges(ed, function (selectionRng, fake) {\n              var expandedRng = fake ? selectionRng : expandRng(ed, selectionRng, formatList);\n              applyRngStyle(dom, expandedRng);\n            });\n          });\n          moveStart(dom, selection, selection.getRng());\n          ed.nodeChanged();\n        } else {\n          applyCaretFormat(ed, name, vars);\n        }\n      }\n\n      postProcess(name, ed);\n    }\n  };\n\n  var setup$4 = function (registeredFormatListeners, editor) {\n    var currentFormats = Cell({});\n    registeredFormatListeners.set({});\n    editor.on('NodeChange', function (e) {\n      updateAndFireChangeCallbacks(editor, e.element, currentFormats, registeredFormatListeners.get());\n    });\n  };\n\n  var updateAndFireChangeCallbacks = function (editor, elm, currentFormats, formatChangeData) {\n    var formatsList = keys(currentFormats.get());\n    var newFormats = {};\n    var matchedFormats = {};\n    var parents = filter(getParents$1(editor.dom, elm), function (node) {\n      return node.nodeType === 1 && !node.getAttribute('data-mce-bogus');\n    });\n    each$1(formatChangeData, function (data, format) {\n      Tools.each(parents, function (node) {\n        if (editor.formatter.matchNode(node, format, {}, data.similar)) {\n          if (formatsList.indexOf(format) === -1) {\n            each(data.callbacks, function (callback) {\n              callback(true, {\n                node: node,\n                format: format,\n                parents: parents\n              });\n            });\n            newFormats[format] = data.callbacks;\n          }\n\n          matchedFormats[format] = data.callbacks;\n          return false;\n        }\n\n        if (matchesUnInheritedFormatSelector(editor, node, format)) {\n          return false;\n        }\n      });\n    });\n    var remainingFormats = filterRemainingFormats(currentFormats.get(), matchedFormats, elm, parents);\n    currentFormats.set(__assign(__assign({}, newFormats), remainingFormats));\n  };\n\n  var filterRemainingFormats = function (currentFormats, matchedFormats, elm, parents) {\n    return bifilter(currentFormats, function (callbacks, format) {\n      if (!has(matchedFormats, format)) {\n        each(callbacks, function (callback) {\n          callback(false, {\n            node: elm,\n            format: format,\n            parents: parents\n          });\n        });\n        return false;\n      } else {\n        return true;\n      }\n    }).t;\n  };\n\n  var addListeners = function (registeredFormatListeners, formats, callback, similar) {\n    var formatChangeItems = registeredFormatListeners.get();\n    each(formats.split(','), function (format) {\n      if (!formatChangeItems[format]) {\n        formatChangeItems[format] = {\n          similar: similar,\n          callbacks: []\n        };\n      }\n\n      formatChangeItems[format].callbacks.push(callback);\n    });\n    registeredFormatListeners.set(formatChangeItems);\n  };\n\n  var removeListeners = function (registeredFormatListeners, formats, callback) {\n    var formatChangeItems = registeredFormatListeners.get();\n    each(formats.split(','), function (format) {\n      formatChangeItems[format].callbacks = filter(formatChangeItems[format].callbacks, function (c) {\n        return c !== callback;\n      });\n\n      if (formatChangeItems[format].callbacks.length === 0) {\n        delete formatChangeItems[format];\n      }\n    });\n    registeredFormatListeners.set(formatChangeItems);\n  };\n\n  var formatChangedInternal = function (editor, registeredFormatListeners, formats, callback, similar) {\n    if (registeredFormatListeners.get() === null) {\n      setup$4(registeredFormatListeners, editor);\n    }\n\n    addListeners(registeredFormatListeners, formats, callback, similar);\n    return {\n      unbind: function () {\n        return removeListeners(registeredFormatListeners, formats, callback);\n      }\n    };\n  };\n\n  var toggle = function (editor, name, vars, node) {\n    var fmt = editor.formatter.get(name);\n\n    if (match(editor, name, vars, node) && (!('toggle' in fmt[0]) || fmt[0].toggle)) {\n      remove$6(editor, name, vars, node);\n    } else {\n      applyFormat(editor, name, vars, node);\n    }\n  };\n\n  var fromElements = function (elements, scope) {\n    var doc = scope || document;\n    var fragment = doc.createDocumentFragment();\n    each(elements, function (element) {\n      fragment.appendChild(element.dom);\n    });\n    return SugarElement.fromDom(fragment);\n  };\n\n  var tableModel = function (element, width, rows) {\n    return {\n      element: element,\n      width: width,\n      rows: rows\n    };\n  };\n\n  var tableRow = function (element, cells) {\n    return {\n      element: element,\n      cells: cells\n    };\n  };\n\n  var cellPosition = function (x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var getSpan = function (td, key) {\n    var value = parseInt(get$4(td, key), 10);\n    return isNaN(value) ? 1 : value;\n  };\n\n  var fillout = function (table, x, y, tr, td) {\n    var rowspan = getSpan(td, 'rowspan');\n    var colspan = getSpan(td, 'colspan');\n    var rows = table.rows;\n\n    for (var y2 = y; y2 < y + rowspan; y2++) {\n      if (!rows[y2]) {\n        rows[y2] = tableRow(deep(tr), []);\n      }\n\n      for (var x2 = x; x2 < x + colspan; x2++) {\n        var cells = rows[y2].cells;\n        cells[x2] = y2 === y && x2 === x ? td : shallow(td);\n      }\n    }\n  };\n\n  var cellExists = function (table, x, y) {\n    var rows = table.rows;\n    var cells = rows[y] ? rows[y].cells : [];\n    return !!cells[x];\n  };\n\n  var skipCellsX = function (table, x, y) {\n    while (cellExists(table, x, y)) {\n      x++;\n    }\n\n    return x;\n  };\n\n  var getWidth = function (rows) {\n    return foldl(rows, function (acc, row) {\n      return row.cells.length > acc ? row.cells.length : acc;\n    }, 0);\n  };\n\n  var findElementPos = function (table, element) {\n    var rows = table.rows;\n\n    for (var y = 0; y < rows.length; y++) {\n      var cells = rows[y].cells;\n\n      for (var x = 0; x < cells.length; x++) {\n        if (eq$2(cells[x], element)) {\n          return Optional.some(cellPosition(x, y));\n        }\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var extractRows = function (table, sx, sy, ex, ey) {\n    var newRows = [];\n    var rows = table.rows;\n\n    for (var y = sy; y <= ey; y++) {\n      var cells = rows[y].cells;\n      var slice = sx < ex ? cells.slice(sx, ex + 1) : cells.slice(ex, sx + 1);\n      newRows.push(tableRow(rows[y].element, slice));\n    }\n\n    return newRows;\n  };\n\n  var subTable = function (table, startPos, endPos) {\n    var sx = startPos.x,\n        sy = startPos.y;\n    var ex = endPos.x,\n        ey = endPos.y;\n    var newRows = sy < ey ? extractRows(table, sx, sy, ex, ey) : extractRows(table, sx, ey, ex, sy);\n    return tableModel(table.element, getWidth(newRows), newRows);\n  };\n\n  var createDomTable = function (table, rows) {\n    var tableElement = shallow(table.element);\n    var tableBody = SugarElement.fromTag('tbody');\n    append$1(tableBody, rows);\n    append(tableElement, tableBody);\n    return tableElement;\n  };\n\n  var modelRowsToDomRows = function (table) {\n    return map(table.rows, function (row) {\n      var cells = map(row.cells, function (cell) {\n        var td = deep(cell);\n        remove$1(td, 'colspan');\n        remove$1(td, 'rowspan');\n        return td;\n      });\n      var tr = shallow(row.element);\n      append$1(tr, cells);\n      return tr;\n    });\n  };\n\n  var fromDom$1 = function (tableElm) {\n    var table = tableModel(shallow(tableElm), 0, []);\n    each(descendants$1(tableElm, 'tr'), function (tr, y) {\n      each(descendants$1(tr, 'td,th'), function (td, x) {\n        fillout(table, skipCellsX(table, x, y), y, tr, td);\n      });\n    });\n    return tableModel(table.element, getWidth(table.rows), table.rows);\n  };\n\n  var toDom = function (table) {\n    return createDomTable(table, modelRowsToDomRows(table));\n  };\n\n  var subsection = function (table, startElement, endElement) {\n    return findElementPos(table, startElement).bind(function (startPos) {\n      return findElementPos(table, endElement).map(function (endPos) {\n        return subTable(table, startPos, endPos);\n      });\n    });\n  };\n\n  var findParentListContainer = function (parents) {\n    return find(parents, function (elm) {\n      return name(elm) === 'ul' || name(elm) === 'ol';\n    });\n  };\n\n  var getFullySelectedListWrappers = function (parents, rng) {\n    return find(parents, function (elm) {\n      return name(elm) === 'li' && hasAllContentsSelected(elm, rng);\n    }).fold(constant([]), function (_li) {\n      return findParentListContainer(parents).map(function (listCont) {\n        var listElm = SugarElement.fromTag(name(listCont));\n        var listStyles = filter$1(getAllRaw(listCont), function (_style, name) {\n          return startsWith(name, 'list-style');\n        });\n        setAll$1(listElm, listStyles);\n        return [SugarElement.fromTag('li'), listElm];\n      }).getOr([]);\n    });\n  };\n\n  var wrap$3 = function (innerElm, elms) {\n    var wrapped = foldl(elms, function (acc, elm) {\n      append(elm, acc);\n      return elm;\n    }, innerElm);\n    return elms.length > 0 ? fromElements([wrapped]) : wrapped;\n  };\n\n  var directListWrappers = function (commonAnchorContainer) {\n    if (isListItem(commonAnchorContainer)) {\n      return parent(commonAnchorContainer).filter(isList).fold(constant([]), function (listElm) {\n        return [commonAnchorContainer, listElm];\n      });\n    } else {\n      return isList(commonAnchorContainer) ? [commonAnchorContainer] : [];\n    }\n  };\n\n  var getWrapElements = function (rootNode, rng) {\n    var commonAnchorContainer = SugarElement.fromDom(rng.commonAncestorContainer);\n    var parents = parentsAndSelf(commonAnchorContainer, rootNode);\n    var wrapElements = filter(parents, function (elm) {\n      return isInline(elm) || isHeading(elm);\n    });\n    var listWrappers = getFullySelectedListWrappers(parents, rng);\n    var allWrappers = wrapElements.concat(listWrappers.length ? listWrappers : directListWrappers(commonAnchorContainer));\n    return map(allWrappers, shallow);\n  };\n\n  var emptyFragment = function () {\n    return fromElements([]);\n  };\n\n  var getFragmentFromRange = function (rootNode, rng) {\n    return wrap$3(SugarElement.fromDom(rng.cloneContents()), getWrapElements(rootNode, rng));\n  };\n\n  var getParentTable = function (rootElm, cell) {\n    return ancestor$1(cell, 'table', curry(eq$2, rootElm));\n  };\n\n  var getTableFragment = function (rootNode, selectedTableCells) {\n    return getParentTable(rootNode, selectedTableCells[0]).bind(function (tableElm) {\n      var firstCell = selectedTableCells[0];\n      var lastCell = selectedTableCells[selectedTableCells.length - 1];\n      var fullTableModel = fromDom$1(tableElm);\n      return subsection(fullTableModel, firstCell, lastCell).map(function (sectionedTableModel) {\n        return fromElements([toDom(sectionedTableModel)]);\n      });\n    }).getOrThunk(emptyFragment);\n  };\n\n  var getSelectionFragment = function (rootNode, ranges) {\n    return ranges.length > 0 && ranges[0].collapsed ? emptyFragment() : getFragmentFromRange(rootNode, ranges[0]);\n  };\n\n  var read$1 = function (rootNode, ranges) {\n    var selectedCells = getCellsFromElementOrRanges(ranges, rootNode);\n    return selectedCells.length > 0 ? getTableFragment(rootNode, selectedCells) : getSelectionFragment(rootNode, ranges);\n  };\n\n  var trimLeadingCollapsibleText = function (text) {\n    return text.replace(/^[ \\f\\n\\r\\t\\v]+/, '');\n  };\n\n  var isCollapsibleWhitespace = function (text, index) {\n    return index >= 0 && index < text.length && isWhiteSpace$1(text.charAt(index));\n  };\n\n  var getInnerText = function (bin, shouldTrim) {\n    var text = trim$2(bin.innerText);\n    return shouldTrim ? trimLeadingCollapsibleText(text) : text;\n  };\n\n  var getContextNodeName = function (parentBlockOpt) {\n    return parentBlockOpt.map(function (block) {\n      return block.nodeName;\n    }).getOr('div').toLowerCase();\n  };\n\n  var getTextContent = function (editor) {\n    return Optional.from(editor.selection.getRng()).map(function (rng) {\n      var parentBlockOpt = Optional.from(editor.dom.getParent(rng.commonAncestorContainer, editor.dom.isBlock));\n      var body = editor.getBody();\n      var contextNodeName = getContextNodeName(parentBlockOpt);\n      var shouldTrimSpaces = Env.browser.isIE() && contextNodeName !== 'pre';\n      var bin = editor.dom.add(body, contextNodeName, {\n        'data-mce-bogus': 'all',\n        'style': 'overflow: hidden; opacity: 0;'\n      }, rng.cloneContents());\n      var text = getInnerText(bin, shouldTrimSpaces);\n      var nonRenderedText = trim$2(bin.textContent);\n      editor.dom.remove(bin);\n\n      if (isCollapsibleWhitespace(nonRenderedText, 0) || isCollapsibleWhitespace(nonRenderedText, nonRenderedText.length - 1)) {\n        var parentBlock = parentBlockOpt.getOr(body);\n        var parentBlockText = getInnerText(parentBlock, shouldTrimSpaces);\n        var textIndex = parentBlockText.indexOf(text);\n\n        if (textIndex === -1) {\n          return text;\n        } else {\n          var hasProceedingSpace = isCollapsibleWhitespace(parentBlockText, textIndex - 1);\n          var hasTrailingSpace = isCollapsibleWhitespace(parentBlockText, textIndex + text.length);\n          return (hasProceedingSpace ? ' ' : '') + text + (hasTrailingSpace ? ' ' : '');\n        }\n      } else {\n        return text;\n      }\n    }).getOr('');\n  };\n\n  var getSerializedContent = function (editor, args) {\n    var rng = editor.selection.getRng(),\n        tmpElm = editor.dom.create('body');\n    var sel = editor.selection.getSel();\n    var ranges = processRanges(editor, getRanges(sel));\n    var fragment = args.contextual ? read$1(SugarElement.fromDom(editor.getBody()), ranges).dom : rng.cloneContents();\n\n    if (fragment) {\n      tmpElm.appendChild(fragment);\n    }\n\n    return editor.selection.serializer.serialize(tmpElm, args);\n  };\n\n  var getSelectedContentInternal = function (editor, format, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    args.get = true;\n    args.format = format;\n    args.selection = true;\n    args = editor.fire('BeforeGetContent', args);\n\n    if (args.isDefaultPrevented()) {\n      editor.fire('GetContent', args);\n      return args.content;\n    }\n\n    if (args.format === 'text') {\n      return getTextContent(editor);\n    } else {\n      args.getInner = true;\n      var content = getSerializedContent(editor, args);\n\n      if (args.format === 'tree') {\n        return content;\n      } else {\n        args.content = editor.selection.isCollapsed() ? '' : content;\n        editor.fire('GetContent', args);\n        return args.content;\n      }\n    }\n  };\n\n  var KEEP = 0,\n      INSERT = 1,\n      DELETE = 2;\n\n  var diff = function (left, right) {\n    var size = left.length + right.length + 2;\n    var vDown = new Array(size);\n    var vUp = new Array(size);\n\n    var snake = function (start, end, diag) {\n      return {\n        start: start,\n        end: end,\n        diag: diag\n      };\n    };\n\n    var buildScript = function (start1, end1, start2, end2, script) {\n      var middle = getMiddleSnake(start1, end1, start2, end2);\n\n      if (middle === null || middle.start === end1 && middle.diag === end1 - end2 || middle.end === start1 && middle.diag === start1 - start2) {\n        var i = start1;\n        var j = start2;\n\n        while (i < end1 || j < end2) {\n          if (i < end1 && j < end2 && left[i] === right[j]) {\n            script.push([KEEP, left[i]]);\n            ++i;\n            ++j;\n          } else {\n            if (end1 - start1 > end2 - start2) {\n              script.push([DELETE, left[i]]);\n              ++i;\n            } else {\n              script.push([INSERT, right[j]]);\n              ++j;\n            }\n          }\n        }\n      } else {\n        buildScript(start1, middle.start, start2, middle.start - middle.diag, script);\n\n        for (var i2 = middle.start; i2 < middle.end; ++i2) {\n          script.push([KEEP, left[i2]]);\n        }\n\n        buildScript(middle.end, end1, middle.end - middle.diag, end2, script);\n      }\n    };\n\n    var buildSnake = function (start, diag, end1, end2) {\n      var end = start;\n\n      while (end - diag < end2 && end < end1 && left[end] === right[end - diag]) {\n        ++end;\n      }\n\n      return snake(start, end, diag);\n    };\n\n    var getMiddleSnake = function (start1, end1, start2, end2) {\n      var m = end1 - start1;\n      var n = end2 - start2;\n\n      if (m === 0 || n === 0) {\n        return null;\n      }\n\n      var delta = m - n;\n      var sum = n + m;\n      var offset = (sum % 2 === 0 ? sum : sum + 1) / 2;\n      vDown[1 + offset] = start1;\n      vUp[1 + offset] = end1 + 1;\n      var d, k, i, x, y;\n\n      for (d = 0; d <= offset; ++d) {\n        for (k = -d; k <= d; k += 2) {\n          i = k + offset;\n\n          if (k === -d || k !== d && vDown[i - 1] < vDown[i + 1]) {\n            vDown[i] = vDown[i + 1];\n          } else {\n            vDown[i] = vDown[i - 1] + 1;\n          }\n\n          x = vDown[i];\n          y = x - start1 + start2 - k;\n\n          while (x < end1 && y < end2 && left[x] === right[y]) {\n            vDown[i] = ++x;\n            ++y;\n          }\n\n          if (delta % 2 !== 0 && delta - d <= k && k <= delta + d) {\n            if (vUp[i - delta] <= vDown[i]) {\n              return buildSnake(vUp[i - delta], k + start1 - start2, end1, end2);\n            }\n          }\n        }\n\n        for (k = delta - d; k <= delta + d; k += 2) {\n          i = k + offset - delta;\n\n          if (k === delta - d || k !== delta + d && vUp[i + 1] <= vUp[i - 1]) {\n            vUp[i] = vUp[i + 1] - 1;\n          } else {\n            vUp[i] = vUp[i - 1];\n          }\n\n          x = vUp[i] - 1;\n          y = x - start1 + start2 - k;\n\n          while (x >= start1 && y >= start2 && left[x] === right[y]) {\n            vUp[i] = x--;\n            y--;\n          }\n\n          if (delta % 2 === 0 && -d <= k && k <= d) {\n            if (vUp[i] <= vDown[i + delta]) {\n              return buildSnake(vUp[i], k + start1 - start2, end1, end2);\n            }\n          }\n        }\n      }\n    };\n\n    var script = [];\n    buildScript(0, left.length, 0, right.length, script);\n    return script;\n  };\n\n  var getOuterHtml = function (elm) {\n    if (isElement$1(elm)) {\n      return elm.outerHTML;\n    } else if (isText$1(elm)) {\n      return Entities.encodeRaw(elm.data, false);\n    } else if (isComment$1(elm)) {\n      return '<!--' + elm.data + '-->';\n    }\n\n    return '';\n  };\n\n  var createFragment$1 = function (html) {\n    var node;\n    var container = document.createElement('div');\n    var frag = document.createDocumentFragment();\n\n    if (html) {\n      container.innerHTML = html;\n    }\n\n    while (node = container.firstChild) {\n      frag.appendChild(node);\n    }\n\n    return frag;\n  };\n\n  var insertAt = function (elm, html, index) {\n    var fragment = createFragment$1(html);\n\n    if (elm.hasChildNodes() && index < elm.childNodes.length) {\n      var target = elm.childNodes[index];\n      target.parentNode.insertBefore(fragment, target);\n    } else {\n      elm.appendChild(fragment);\n    }\n  };\n\n  var removeAt = function (elm, index) {\n    if (elm.hasChildNodes() && index < elm.childNodes.length) {\n      var target = elm.childNodes[index];\n      target.parentNode.removeChild(target);\n    }\n  };\n\n  var applyDiff = function (diff, elm) {\n    var index = 0;\n    each(diff, function (action) {\n      if (action[0] === KEEP) {\n        index++;\n      } else if (action[0] === INSERT) {\n        insertAt(elm, action[1], index);\n        index++;\n      } else if (action[0] === DELETE) {\n        removeAt(elm, index);\n      }\n    });\n  };\n\n  var read$2 = function (elm) {\n    return filter(map(from$1(elm.childNodes), getOuterHtml), function (item) {\n      return item.length > 0;\n    });\n  };\n\n  var write = function (fragments, elm) {\n    var currentFragments = map(from$1(elm.childNodes), getOuterHtml);\n    applyDiff(diff(currentFragments, fragments), elm);\n    return elm;\n  };\n\n  var undoLevelDocument = Cell(Optional.none());\n\n  var lazyTempDocument = function () {\n    return undoLevelDocument.get().getOrThunk(function () {\n      var doc = document.implementation.createHTMLDocument('undo');\n      undoLevelDocument.set(Optional.some(doc));\n      return doc;\n    });\n  };\n\n  var hasIframes = function (html) {\n    return html.indexOf('</iframe>') !== -1;\n  };\n\n  var createFragmentedLevel = function (fragments) {\n    return {\n      type: 'fragmented',\n      fragments: fragments,\n      content: '',\n      bookmark: null,\n      beforeBookmark: null\n    };\n  };\n\n  var createCompleteLevel = function (content) {\n    return {\n      type: 'complete',\n      fragments: null,\n      content: content,\n      bookmark: null,\n      beforeBookmark: null\n    };\n  };\n\n  var createFromEditor = function (editor) {\n    var fragments = read$2(editor.getBody());\n    var trimmedFragments = bind(fragments, function (html) {\n      var trimmed = trimInternal(editor.serializer, html);\n      return trimmed.length > 0 ? [trimmed] : [];\n    });\n    var content = trimmedFragments.join('');\n    return hasIframes(content) ? createFragmentedLevel(trimmedFragments) : createCompleteLevel(content);\n  };\n\n  var applyToEditor = function (editor, level, before) {\n    if (level.type === 'fragmented') {\n      write(level.fragments, editor.getBody());\n    } else {\n      editor.setContent(level.content, {\n        format: 'raw'\n      });\n    }\n\n    editor.selection.moveToBookmark(before ? level.beforeBookmark : level.bookmark);\n  };\n\n  var getLevelContent = function (level) {\n    return level.type === 'fragmented' ? level.fragments.join('') : level.content;\n  };\n\n  var getCleanLevelContent = function (level) {\n    var elm = SugarElement.fromTag('body', lazyTempDocument());\n    set$1(elm, getLevelContent(level));\n    each(descendants$1(elm, '*[data-mce-bogus]'), unwrap);\n    return get$7(elm);\n  };\n\n  var hasEqualContent = function (level1, level2) {\n    return getLevelContent(level1) === getLevelContent(level2);\n  };\n\n  var hasEqualCleanedContent = function (level1, level2) {\n    return getCleanLevelContent(level1) === getCleanLevelContent(level2);\n  };\n\n  var isEq$4 = function (level1, level2) {\n    if (!level1 || !level2) {\n      return false;\n    } else if (hasEqualContent(level1, level2)) {\n      return true;\n    } else {\n      return hasEqualCleanedContent(level1, level2);\n    }\n  };\n\n  var isUnlocked = function (locks) {\n    return locks.get() === 0;\n  };\n\n  var setTyping = function (undoManager, typing, locks) {\n    if (isUnlocked(locks)) {\n      undoManager.typing = typing;\n    }\n  };\n\n  var endTyping = function (undoManager, locks) {\n    if (undoManager.typing) {\n      setTyping(undoManager, false, locks);\n      undoManager.add();\n    }\n  };\n\n  var endTypingLevelIgnoreLocks = function (undoManager) {\n    if (undoManager.typing) {\n      undoManager.typing = false;\n      undoManager.add();\n    }\n  };\n\n  var beforeChange = function (editor, locks, beforeBookmark) {\n    if (isUnlocked(locks)) {\n      beforeBookmark.set(Optional.some(getUndoBookmark(editor.selection)));\n    }\n  };\n\n  var addUndoLevel = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n    var currentLevel = createFromEditor(editor);\n    level = level || {};\n    level = Tools.extend(level, currentLevel);\n\n    if (isUnlocked(locks) === false || editor.removed) {\n      return null;\n    }\n\n    var lastLevel = undoManager.data[index.get()];\n\n    if (editor.fire('BeforeAddUndo', {\n      level: level,\n      lastLevel: lastLevel,\n      originalEvent: event\n    }).isDefaultPrevented()) {\n      return null;\n    }\n\n    if (lastLevel && isEq$4(lastLevel, level)) {\n      return null;\n    }\n\n    if (undoManager.data[index.get()]) {\n      beforeBookmark.get().each(function (bm) {\n        undoManager.data[index.get()].beforeBookmark = bm;\n      });\n    }\n\n    var customUndoRedoLevels = getCustomUndoRedoLevels(editor);\n\n    if (customUndoRedoLevels) {\n      if (undoManager.data.length > customUndoRedoLevels) {\n        for (var i = 0; i < undoManager.data.length - 1; i++) {\n          undoManager.data[i] = undoManager.data[i + 1];\n        }\n\n        undoManager.data.length--;\n        index.set(undoManager.data.length);\n      }\n    }\n\n    level.bookmark = getUndoBookmark(editor.selection);\n\n    if (index.get() < undoManager.data.length - 1) {\n      undoManager.data.length = index.get() + 1;\n    }\n\n    undoManager.data.push(level);\n    index.set(undoManager.data.length - 1);\n    var args = {\n      level: level,\n      lastLevel: lastLevel,\n      originalEvent: event\n    };\n\n    if (index.get() > 0) {\n      editor.setDirty(true);\n      editor.fire('AddUndo', args);\n      editor.fire('change', args);\n    } else {\n      editor.fire('AddUndo', args);\n    }\n\n    return level;\n  };\n\n  var clear = function (editor, undoManager, index) {\n    undoManager.data = [];\n    index.set(0);\n    undoManager.typing = false;\n    editor.fire('ClearUndos');\n  };\n\n  var extra = function (editor, undoManager, index, callback1, callback2) {\n    if (undoManager.transact(callback1)) {\n      var bookmark = undoManager.data[index.get()].bookmark;\n      var lastLevel = undoManager.data[index.get() - 1];\n      applyToEditor(editor, lastLevel, true);\n\n      if (undoManager.transact(callback2)) {\n        undoManager.data[index.get() - 1].beforeBookmark = bookmark;\n      }\n    }\n  };\n\n  var redo = function (editor, index, data) {\n    var level;\n\n    if (index.get() < data.length - 1) {\n      index.set(index.get() + 1);\n      level = data[index.get()];\n      applyToEditor(editor, level, false);\n      editor.setDirty(true);\n      editor.fire('Redo', {\n        level: level\n      });\n    }\n\n    return level;\n  };\n\n  var undo = function (editor, undoManager, locks, index) {\n    var level;\n\n    if (undoManager.typing) {\n      undoManager.add();\n      undoManager.typing = false;\n      setTyping(undoManager, false, locks);\n    }\n\n    if (index.get() > 0) {\n      index.set(index.get() - 1);\n      level = undoManager.data[index.get()];\n      applyToEditor(editor, level, true);\n      editor.setDirty(true);\n      editor.fire('Undo', {\n        level: level\n      });\n    }\n\n    return level;\n  };\n\n  var reset = function (undoManager) {\n    undoManager.clear();\n    undoManager.add();\n  };\n\n  var hasUndo = function (editor, undoManager, index) {\n    return index.get() > 0 || undoManager.typing && undoManager.data[0] && !isEq$4(createFromEditor(editor), undoManager.data[0]);\n  };\n\n  var hasRedo = function (undoManager, index) {\n    return index.get() < undoManager.data.length - 1 && !undoManager.typing;\n  };\n\n  var transact = function (undoManager, locks, callback) {\n    endTyping(undoManager, locks);\n    undoManager.beforeChange();\n    undoManager.ignore(callback);\n    return undoManager.add();\n  };\n\n  var ignore = function (locks, callback) {\n    try {\n      locks.set(locks.get() + 1);\n      callback();\n    } finally {\n      locks.set(locks.get() - 1);\n    }\n  };\n\n  var addVisualInternal = function (editor, elm) {\n    var dom = editor.dom;\n    var scope = isNonNullable(elm) ? elm : editor.getBody();\n\n    if (isUndefined(editor.hasVisual)) {\n      editor.hasVisual = isVisualAidsEnabled(editor);\n    }\n\n    each(dom.select('table,a', scope), function (matchedElm) {\n      switch (matchedElm.nodeName) {\n        case 'TABLE':\n          var cls = getVisualAidsTableClass(editor);\n          var value = dom.getAttrib(matchedElm, 'border');\n\n          if ((!value || value === '0') && editor.hasVisual) {\n            dom.addClass(matchedElm, cls);\n          } else {\n            dom.removeClass(matchedElm, cls);\n          }\n\n          break;\n\n        case 'A':\n          if (!dom.getAttrib(matchedElm, 'href')) {\n            var value_1 = dom.getAttrib(matchedElm, 'name') || matchedElm.id;\n            var cls_1 = getVisualAidsAnchorClass(editor);\n\n            if (value_1 && editor.hasVisual) {\n              dom.addClass(matchedElm, cls_1);\n            } else {\n              dom.removeClass(matchedElm, cls_1);\n            }\n          }\n\n          break;\n      }\n    });\n    editor.fire('VisualAid', {\n      element: elm,\n      hasVisual: editor.hasVisual\n    });\n  };\n\n  var makePlainAdaptor = function (editor) {\n    return {\n      undoManager: {\n        beforeChange: function (locks, beforeBookmark) {\n          return beforeChange(editor, locks, beforeBookmark);\n        },\n        addUndoLevel: function (undoManager, index, locks, beforeBookmark, level, event) {\n          return addUndoLevel(editor, undoManager, index, locks, beforeBookmark, level, event);\n        },\n        undo: function (undoManager, locks, index) {\n          return undo(editor, undoManager, locks, index);\n        },\n        redo: function (index, data) {\n          return redo(editor, index, data);\n        },\n        clear: function (undoManager, index) {\n          return clear(editor, undoManager, index);\n        },\n        reset: function (undoManager) {\n          return reset(undoManager);\n        },\n        hasUndo: function (undoManager, index) {\n          return hasUndo(editor, undoManager, index);\n        },\n        hasRedo: function (undoManager, index) {\n          return hasRedo(undoManager, index);\n        },\n        transact: function (undoManager, locks, callback) {\n          return transact(undoManager, locks, callback);\n        },\n        ignore: function (locks, callback) {\n          return ignore(locks, callback);\n        },\n        extra: function (undoManager, index, callback1, callback2) {\n          return extra(editor, undoManager, index, callback1, callback2);\n        }\n      },\n      formatter: {\n        match: function (name, vars, node) {\n          return match(editor, name, vars, node);\n        },\n        matchAll: function (names, vars) {\n          return matchAll(editor, names, vars);\n        },\n        matchNode: function (node, name, vars, similar) {\n          return matchNode(editor, node, name, vars, similar);\n        },\n        canApply: function (name) {\n          return canApply(editor, name);\n        },\n        closest: function (names) {\n          return closest$3(editor, names);\n        },\n        apply: function (name, vars, node) {\n          return applyFormat(editor, name, vars, node);\n        },\n        remove: function (name, vars, node, similar) {\n          return remove$6(editor, name, vars, node, similar);\n        },\n        toggle: function (name, vars, node) {\n          return toggle(editor, name, vars, node);\n        },\n        formatChanged: function (registeredFormatListeners, formats, callback, similar) {\n          return formatChangedInternal(editor, registeredFormatListeners, formats, callback, similar);\n        }\n      },\n      editor: {\n        getContent: function (args, format) {\n          return getContentInternal(editor, args, format);\n        },\n        setContent: function (content, args) {\n          return setContentInternal(editor, content, args);\n        },\n        insertContent: function (value, details) {\n          return insertHtmlAtCaret(editor, value, details);\n        },\n        addVisual: function (elm) {\n          return addVisualInternal(editor, elm);\n        }\n      },\n      selection: {\n        getContent: function (format, args) {\n          return getSelectedContentInternal(editor, format, args);\n        }\n      },\n      raw: {\n        getModel: function () {\n          return Optional.none();\n        }\n      }\n    };\n  };\n\n  var makeRtcAdaptor = function (rtcEditor) {\n    var defaultVars = function (vars) {\n      return isObject(vars) ? vars : {};\n    };\n\n    var unsupported = die('Unimplemented feature for rtc');\n    var undoManager = rtcEditor.undoManager,\n        formatter = rtcEditor.formatter,\n        editor = rtcEditor.editor,\n        selection = rtcEditor.selection,\n        raw = rtcEditor.raw;\n    var ignore = noop;\n    return {\n      undoManager: {\n        beforeChange: ignore,\n        addUndoLevel: unsupported,\n        undo: function () {\n          return undoManager.undo();\n        },\n        redo: function () {\n          return undoManager.redo();\n        },\n        clear: function () {\n          return undoManager.clear();\n        },\n        reset: function () {\n          return undoManager.reset();\n        },\n        hasUndo: function () {\n          return undoManager.hasUndo();\n        },\n        hasRedo: function () {\n          return undoManager.hasRedo();\n        },\n        transact: function (_undoManager, _locks, fn) {\n          return undoManager.transact(fn);\n        },\n        ignore: function (_locks, callback) {\n          return undoManager.ignore(callback);\n        },\n        extra: function (_undoManager, _index, callback1, callback2) {\n          return undoManager.extra(callback1, callback2);\n        }\n      },\n      formatter: {\n        match: function (name, vars, _node) {\n          return formatter.match(name, defaultVars(vars));\n        },\n        matchAll: unsupported,\n        matchNode: unsupported,\n        canApply: function (name) {\n          return formatter.canApply(name);\n        },\n        closest: function (names) {\n          return formatter.closest(names);\n        },\n        apply: function (name, vars, _node) {\n          return formatter.apply(name, defaultVars(vars));\n        },\n        remove: function (name, vars, _node, _similar) {\n          return formatter.remove(name, defaultVars(vars));\n        },\n        toggle: function (name, vars, _node) {\n          return formatter.toggle(name, defaultVars(vars));\n        },\n        formatChanged: function (_rfl, formats, callback, similar) {\n          return formatter.formatChanged(formats, callback, similar);\n        }\n      },\n      editor: {\n        getContent: function (args, _format) {\n          return editor.getContent(args);\n        },\n        setContent: function (content, args) {\n          return editor.setContent(content, args);\n        },\n        insertContent: function (content, _details) {\n          return editor.insertContent(content);\n        },\n        addVisual: ignore\n      },\n      selection: {\n        getContent: function (_format, args) {\n          return selection.getContent(args);\n        }\n      },\n      raw: {\n        getModel: function () {\n          return Optional.some(raw.getRawModel());\n        }\n      }\n    };\n  };\n\n  var makeNoopAdaptor = function () {\n    var nul = constant(null);\n    var empty = constant('');\n    return {\n      undoManager: {\n        beforeChange: noop,\n        addUndoLevel: nul,\n        undo: nul,\n        redo: nul,\n        clear: noop,\n        reset: noop,\n        hasUndo: never,\n        hasRedo: never,\n        transact: nul,\n        ignore: noop,\n        extra: noop\n      },\n      formatter: {\n        match: never,\n        matchAll: constant([]),\n        matchNode: never,\n        canApply: never,\n        closest: empty,\n        apply: noop,\n        remove: noop,\n        toggle: noop,\n        formatChanged: constant({\n          unbind: noop\n        })\n      },\n      editor: {\n        getContent: empty,\n        setContent: empty,\n        insertContent: noop,\n        addVisual: noop\n      },\n      selection: {\n        getContent: empty\n      },\n      raw: {\n        getModel: constant(Optional.none())\n      }\n    };\n  };\n\n  var isRtc = function (editor) {\n    return has(editor.plugins, 'rtc');\n  };\n\n  var setup$5 = function (editor) {\n    var editorCast = editor;\n    return get$1(editor.plugins, 'rtc').fold(function () {\n      editorCast.rtcInstance = makePlainAdaptor(editor);\n      return Optional.none();\n    }, function (rtc) {\n      return Optional.some(rtc.setup().then(function (rtcEditor) {\n        editorCast.rtcInstance = makeRtcAdaptor(rtcEditor);\n        return rtcEditor.rtc.isRemote;\n      }, function (err) {\n        editorCast.rtcInstance = makeNoopAdaptor();\n        return promiseObj.reject(err);\n      }));\n    });\n  };\n\n  var getRtcInstanceWithFallback = function (editor) {\n    return editor.rtcInstance ? editor.rtcInstance : makePlainAdaptor(editor);\n  };\n\n  var getRtcInstanceWithError = function (editor) {\n    var rtcInstance = editor.rtcInstance;\n\n    if (!rtcInstance) {\n      throw new Error('Failed to get RTC instance not yet initialized.');\n    } else {\n      return rtcInstance;\n    }\n  };\n\n  var beforeChange$1 = function (editor, locks, beforeBookmark) {\n    getRtcInstanceWithError(editor).undoManager.beforeChange(locks, beforeBookmark);\n  };\n\n  var addUndoLevel$1 = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n    return getRtcInstanceWithError(editor).undoManager.addUndoLevel(undoManager, index, locks, beforeBookmark, level, event);\n  };\n\n  var undo$1 = function (editor, undoManager, locks, index) {\n    return getRtcInstanceWithError(editor).undoManager.undo(undoManager, locks, index);\n  };\n\n  var redo$1 = function (editor, index, data) {\n    return getRtcInstanceWithError(editor).undoManager.redo(index, data);\n  };\n\n  var clear$1 = function (editor, undoManager, index) {\n    getRtcInstanceWithError(editor).undoManager.clear(undoManager, index);\n  };\n\n  var reset$1 = function (editor, undoManager) {\n    getRtcInstanceWithError(editor).undoManager.reset(undoManager);\n  };\n\n  var hasUndo$1 = function (editor, undoManager, index) {\n    return getRtcInstanceWithError(editor).undoManager.hasUndo(undoManager, index);\n  };\n\n  var hasRedo$1 = function (editor, undoManager, index) {\n    return getRtcInstanceWithError(editor).undoManager.hasRedo(undoManager, index);\n  };\n\n  var transact$1 = function (editor, undoManager, locks, callback) {\n    return getRtcInstanceWithError(editor).undoManager.transact(undoManager, locks, callback);\n  };\n\n  var ignore$1 = function (editor, locks, callback) {\n    getRtcInstanceWithError(editor).undoManager.ignore(locks, callback);\n  };\n\n  var extra$1 = function (editor, undoManager, index, callback1, callback2) {\n    getRtcInstanceWithError(editor).undoManager.extra(undoManager, index, callback1, callback2);\n  };\n\n  var matchFormat = function (editor, name, vars, node) {\n    return getRtcInstanceWithError(editor).formatter.match(name, vars, node);\n  };\n\n  var matchAllFormats = function (editor, names, vars) {\n    return getRtcInstanceWithError(editor).formatter.matchAll(names, vars);\n  };\n\n  var matchNodeFormat = function (editor, node, name, vars, similar) {\n    return getRtcInstanceWithError(editor).formatter.matchNode(node, name, vars, similar);\n  };\n\n  var canApplyFormat = function (editor, name) {\n    return getRtcInstanceWithError(editor).formatter.canApply(name);\n  };\n\n  var closestFormat = function (editor, names) {\n    return getRtcInstanceWithError(editor).formatter.closest(names);\n  };\n\n  var applyFormat$1 = function (editor, name, vars, node) {\n    getRtcInstanceWithError(editor).formatter.apply(name, vars, node);\n  };\n\n  var removeFormat$1 = function (editor, name, vars, node, similar) {\n    getRtcInstanceWithError(editor).formatter.remove(name, vars, node, similar);\n  };\n\n  var toggleFormat = function (editor, name, vars, node) {\n    getRtcInstanceWithError(editor).formatter.toggle(name, vars, node);\n  };\n\n  var formatChanged = function (editor, registeredFormatListeners, formats, callback, similar) {\n    if (similar === void 0) {\n      similar = false;\n    }\n\n    return getRtcInstanceWithError(editor).formatter.formatChanged(registeredFormatListeners, formats, callback, similar);\n  };\n\n  var getContent = function (editor, args, format) {\n    return getRtcInstanceWithFallback(editor).editor.getContent(args, format);\n  };\n\n  var setContent = function (editor, content, args) {\n    return getRtcInstanceWithFallback(editor).editor.setContent(content, args);\n  };\n\n  var insertContent = function (editor, value, details) {\n    return getRtcInstanceWithFallback(editor).editor.insertContent(value, details);\n  };\n\n  var getSelectedContent = function (editor, format, args) {\n    return getRtcInstanceWithError(editor).selection.getContent(format, args);\n  };\n\n  var addVisual = function (editor, elm) {\n    return getRtcInstanceWithError(editor).editor.addVisual(elm);\n  };\n\n  var getContent$1 = function (editor, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    var format = args.format ? args.format : 'html';\n    return getSelectedContent(editor, format, args);\n  };\n\n  var removeEmpty = function (text) {\n    if (text.dom.length === 0) {\n      remove(text);\n      return Optional.none();\n    } else {\n      return Optional.some(text);\n    }\n  };\n\n  var walkPastBookmark = function (node, start) {\n    return node.filter(function (elm) {\n      return BookmarkManager.isBookmarkNode(elm.dom);\n    }).bind(start ? nextSibling : prevSibling);\n  };\n\n  var merge = function (outer, inner, rng, start) {\n    var outerElm = outer.dom;\n    var innerElm = inner.dom;\n    var oldLength = start ? outerElm.length : innerElm.length;\n\n    if (start) {\n      mergeTextNodes(outerElm, innerElm, false, !start);\n      rng.setStart(innerElm, oldLength);\n    } else {\n      mergeTextNodes(innerElm, outerElm, false, !start);\n      rng.setEnd(innerElm, oldLength);\n    }\n  };\n\n  var normalizeTextIfRequired = function (inner, start) {\n    parent(inner).each(function (root) {\n      var text = inner.dom;\n\n      if (start && needsToBeNbspLeft(root, CaretPosition(text, 0))) {\n        normalizeWhitespaceAfter(text, 0);\n      } else if (!start && needsToBeNbspRight(root, CaretPosition(text, text.length))) {\n        normalizeWhitespaceBefore(text, text.length);\n      }\n    });\n  };\n\n  var mergeAndNormalizeText = function (outerNode, innerNode, rng, start) {\n    outerNode.bind(function (outer) {\n      var normalizer = start ? normalizeWhitespaceBefore : normalizeWhitespaceAfter;\n      normalizer(outer.dom, start ? outer.dom.length : 0);\n      return innerNode.filter(isText).map(function (inner) {\n        return merge(outer, inner, rng, start);\n      });\n    }).orThunk(function () {\n      var innerTextNode = walkPastBookmark(innerNode, start).or(innerNode).filter(isText);\n      return innerTextNode.map(function (inner) {\n        return normalizeTextIfRequired(inner, start);\n      });\n    });\n  };\n\n  var rngSetContent = function (rng, fragment) {\n    var firstChild = Optional.from(fragment.firstChild).map(SugarElement.fromDom);\n    var lastChild = Optional.from(fragment.lastChild).map(SugarElement.fromDom);\n    rng.deleteContents();\n    rng.insertNode(fragment);\n    var prevText = firstChild.bind(prevSibling).filter(isText).bind(removeEmpty);\n    var nextText = lastChild.bind(nextSibling).filter(isText).bind(removeEmpty);\n    mergeAndNormalizeText(prevText, firstChild, rng, true);\n    mergeAndNormalizeText(nextText, lastChild, rng, false);\n    rng.collapse(false);\n  };\n\n  var setupArgs = function (args, content) {\n    return __assign(__assign({\n      format: 'html'\n    }, args), {\n      set: true,\n      selection: true,\n      content: content\n    });\n  };\n\n  var cleanContent = function (editor, args) {\n    if (args.format !== 'raw') {\n      var rng = editor.selection.getRng();\n      var contextBlock = editor.dom.getParent(rng.commonAncestorContainer, editor.dom.isBlock);\n      var contextArgs = contextBlock ? {\n        context: contextBlock.nodeName.toLowerCase()\n      } : {};\n      var node = editor.parser.parse(args.content, __assign(__assign({\n        isRootContent: true,\n        forced_root_block: false\n      }, contextArgs), args));\n      return HtmlSerializer({\n        validate: editor.validate\n      }, editor.schema).serialize(node);\n    } else {\n      return args.content;\n    }\n  };\n\n  var setContent$1 = function (editor, content, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    var contentArgs = setupArgs(args, content);\n\n    if (!contentArgs.no_events) {\n      contentArgs = editor.fire('BeforeSetContent', contentArgs);\n\n      if (contentArgs.isDefaultPrevented()) {\n        editor.fire('SetContent', contentArgs);\n        return;\n      }\n    }\n\n    args.content = cleanContent(editor, contentArgs);\n    var rng = editor.selection.getRng();\n    rngSetContent(rng, rng.createContextualFragment(args.content));\n    editor.selection.setRng(rng);\n    scrollRangeIntoView(editor, rng);\n\n    if (!contentArgs.no_events) {\n      editor.fire('SetContent', contentArgs);\n    }\n  };\n\n  var deleteFromCallbackMap = function (callbackMap, selector, callback) {\n    if (callbackMap && callbackMap.hasOwnProperty(selector)) {\n      var newCallbacks = filter(callbackMap[selector], function (cb) {\n        return cb !== callback;\n      });\n\n      if (newCallbacks.length === 0) {\n        delete callbackMap[selector];\n      } else {\n        callbackMap[selector] = newCallbacks;\n      }\n    }\n  };\n\n  function SelectorChanged(dom, editor) {\n    var selectorChangedData;\n    var currentSelectors;\n    return {\n      selectorChangedWithUnbind: function (selector, callback) {\n        if (!selectorChangedData) {\n          selectorChangedData = {};\n          currentSelectors = {};\n          editor.on('NodeChange', function (e) {\n            var node = e.element,\n                parents = dom.getParents(node, null, dom.getRoot()),\n                matchedSelectors = {};\n            Tools.each(selectorChangedData, function (callbacks, selector) {\n              Tools.each(parents, function (node) {\n                if (dom.is(node, selector)) {\n                  if (!currentSelectors[selector]) {\n                    Tools.each(callbacks, function (callback) {\n                      callback(true, {\n                        node: node,\n                        selector: selector,\n                        parents: parents\n                      });\n                    });\n                    currentSelectors[selector] = callbacks;\n                  }\n\n                  matchedSelectors[selector] = callbacks;\n                  return false;\n                }\n              });\n            });\n            Tools.each(currentSelectors, function (callbacks, selector) {\n              if (!matchedSelectors[selector]) {\n                delete currentSelectors[selector];\n                Tools.each(callbacks, function (callback) {\n                  callback(false, {\n                    node: node,\n                    selector: selector,\n                    parents: parents\n                  });\n                });\n              }\n            });\n          });\n        }\n\n        if (!selectorChangedData[selector]) {\n          selectorChangedData[selector] = [];\n        }\n\n        selectorChangedData[selector].push(callback);\n        return {\n          unbind: function () {\n            deleteFromCallbackMap(selectorChangedData, selector, callback);\n            deleteFromCallbackMap(currentSelectors, selector, callback);\n          }\n        };\n      }\n    };\n  }\n\n  var isNativeIeSelection = function (rng) {\n    return !!rng.select;\n  };\n\n  var isAttachedToDom = function (node) {\n    return !!(node && node.ownerDocument) && contains$2(SugarElement.fromDom(node.ownerDocument), SugarElement.fromDom(node));\n  };\n\n  var isValidRange = function (rng) {\n    if (!rng) {\n      return false;\n    } else if (isNativeIeSelection(rng)) {\n      return true;\n    } else {\n      return isAttachedToDom(rng.startContainer) && isAttachedToDom(rng.endContainer);\n    }\n  };\n\n  var EditorSelection = function (dom, win, serializer, editor) {\n    var selectedRange;\n    var explicitRange;\n    var selectorChangedWithUnbind = SelectorChanged(dom, editor).selectorChangedWithUnbind;\n\n    var setCursorLocation = function (node, offset) {\n      var rng = dom.createRng();\n\n      if (isNonNullable(node) && isNonNullable(offset)) {\n        rng.setStart(node, offset);\n        rng.setEnd(node, offset);\n        setRng(rng);\n        collapse(false);\n      } else {\n        moveEndPoint$1(dom, rng, editor.getBody(), true);\n        setRng(rng);\n      }\n    };\n\n    var getContent = function (args) {\n      return getContent$1(editor, args);\n    };\n\n    var setContent = function (content, args) {\n      return setContent$1(editor, content, args);\n    };\n\n    var getStart = function (real) {\n      return getStart$2(editor.getBody(), getRng$1(), real);\n    };\n\n    var getEnd$1 = function (real) {\n      return getEnd(editor.getBody(), getRng$1(), real);\n    };\n\n    var getBookmark = function (type, normalized) {\n      return bookmarkManager.getBookmark(type, normalized);\n    };\n\n    var moveToBookmark = function (bookmark) {\n      return bookmarkManager.moveToBookmark(bookmark);\n    };\n\n    var select = function (node, content) {\n      select$1(dom, node, content).each(setRng);\n      return node;\n    };\n\n    var isCollapsed = function () {\n      var rng = getRng$1(),\n          sel = getSel();\n\n      if (!rng || rng.item) {\n        return false;\n      }\n\n      if (rng.compareEndPoints) {\n        return rng.compareEndPoints('StartToEnd', rng) === 0;\n      }\n\n      return !sel || rng.collapsed;\n    };\n\n    var collapse = function (toStart) {\n      var rng = getRng$1();\n      rng.collapse(!!toStart);\n      setRng(rng);\n    };\n\n    var getSel = function () {\n      return win.getSelection ? win.getSelection() : win.document.selection;\n    };\n\n    var getRng$1 = function () {\n      var selection, rng, elm;\n\n      var tryCompareBoundaryPoints = function (how, sourceRange, destinationRange) {\n        try {\n          return sourceRange.compareBoundaryPoints(how, destinationRange);\n        } catch (ex) {\n          return -1;\n        }\n      };\n\n      var doc = win.document;\n\n      if (editor.bookmark !== undefined && hasFocus$1(editor) === false) {\n        var bookmark = getRng(editor);\n\n        if (bookmark.isSome()) {\n          return bookmark.map(function (r) {\n            return processRanges(editor, [r])[0];\n          }).getOr(doc.createRange());\n        }\n      }\n\n      try {\n        if ((selection = getSel()) && !isRestrictedNode(selection.anchorNode)) {\n          if (selection.rangeCount > 0) {\n            rng = selection.getRangeAt(0);\n          } else {\n            rng = selection.createRange ? selection.createRange() : doc.createRange();\n          }\n\n          rng = processRanges(editor, [rng])[0];\n        }\n      } catch (ex) {}\n\n      if (!rng) {\n        rng = doc.createRange ? doc.createRange() : doc.body.createTextRange();\n      }\n\n      if (rng.setStart && rng.startContainer.nodeType === 9 && rng.collapsed) {\n        elm = dom.getRoot();\n        rng.setStart(elm, 0);\n        rng.setEnd(elm, 0);\n      }\n\n      if (selectedRange && explicitRange) {\n        if (tryCompareBoundaryPoints(rng.START_TO_START, rng, selectedRange) === 0 && tryCompareBoundaryPoints(rng.END_TO_END, rng, selectedRange) === 0) {\n          rng = explicitRange;\n        } else {\n          selectedRange = null;\n          explicitRange = null;\n        }\n      }\n\n      return rng;\n    };\n\n    var setRng = function (rng, forward) {\n      var node;\n\n      if (!isValidRange(rng)) {\n        return;\n      }\n\n      var ieRange = isNativeIeSelection(rng) ? rng : null;\n\n      if (ieRange) {\n        explicitRange = null;\n\n        try {\n          ieRange.select();\n        } catch (ex) {}\n\n        return;\n      }\n\n      var sel = getSel();\n      var evt = editor.fire('SetSelectionRange', {\n        range: rng,\n        forward: forward\n      });\n      rng = evt.range;\n\n      if (sel) {\n        explicitRange = rng;\n\n        try {\n          sel.removeAllRanges();\n          sel.addRange(rng);\n        } catch (ex) {}\n\n        if (forward === false && sel.extend) {\n          sel.collapse(rng.endContainer, rng.endOffset);\n          sel.extend(rng.startContainer, rng.startOffset);\n        }\n\n        selectedRange = sel.rangeCount > 0 ? sel.getRangeAt(0) : null;\n      }\n\n      if (!rng.collapsed && rng.startContainer === rng.endContainer && sel.setBaseAndExtent && !Env.ie) {\n        if (rng.endOffset - rng.startOffset < 2) {\n          if (rng.startContainer.hasChildNodes()) {\n            node = rng.startContainer.childNodes[rng.startOffset];\n\n            if (node && node.tagName === 'IMG') {\n              sel.setBaseAndExtent(rng.startContainer, rng.startOffset, rng.endContainer, rng.endOffset);\n\n              if (sel.anchorNode !== rng.startContainer || sel.focusNode !== rng.endContainer) {\n                sel.setBaseAndExtent(node, 0, node, 1);\n              }\n            }\n          }\n        }\n      }\n\n      editor.fire('AfterSetSelectionRange', {\n        range: rng,\n        forward: forward\n      });\n    };\n\n    var setNode = function (elm) {\n      setContent(dom.getOuterHTML(elm));\n      return elm;\n    };\n\n    var getNode = function () {\n      return getNode$1(editor.getBody(), getRng$1());\n    };\n\n    var getSelectedBlocks$1 = function (startElm, endElm) {\n      return getSelectedBlocks(dom, getRng$1(), startElm, endElm);\n    };\n\n    var isForward = function () {\n      var sel = getSel();\n      var anchorNode = sel === null || sel === void 0 ? void 0 : sel.anchorNode;\n      var focusNode = sel === null || sel === void 0 ? void 0 : sel.focusNode;\n\n      if (!sel || !anchorNode || !focusNode || isRestrictedNode(anchorNode) || isRestrictedNode(focusNode)) {\n        return true;\n      }\n\n      var anchorRange = dom.createRng();\n      anchorRange.setStart(anchorNode, sel.anchorOffset);\n      anchorRange.collapse(true);\n      var focusRange = dom.createRng();\n      focusRange.setStart(focusNode, sel.focusOffset);\n      focusRange.collapse(true);\n      return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START, focusRange) <= 0;\n    };\n\n    var normalize$1 = function () {\n      var rng = getRng$1();\n      var sel = getSel();\n\n      if (!hasMultipleRanges(sel) && hasAnyRanges(editor)) {\n        var normRng = normalize(dom, rng);\n        normRng.each(function (normRng) {\n          setRng(normRng, isForward());\n        });\n        return normRng.getOr(rng);\n      }\n\n      return rng;\n    };\n\n    var selectorChanged = function (selector, callback) {\n      selectorChangedWithUnbind(selector, callback);\n      return exports;\n    };\n\n    var getScrollContainer = function () {\n      var scrollContainer;\n      var node = dom.getRoot();\n\n      while (node && node.nodeName !== 'BODY') {\n        if (node.scrollHeight > node.clientHeight) {\n          scrollContainer = node;\n          break;\n        }\n\n        node = node.parentNode;\n      }\n\n      return scrollContainer;\n    };\n\n    var scrollIntoView = function (elm, alignToTop) {\n      return scrollElementIntoView(editor, elm, alignToTop);\n    };\n\n    var placeCaretAt = function (clientX, clientY) {\n      return setRng(fromPoint$1(clientX, clientY, editor.getDoc()));\n    };\n\n    var getBoundingClientRect = function () {\n      var rng = getRng$1();\n      return rng.collapsed ? CaretPosition.fromRangeStart(rng).getClientRects()[0] : rng.getBoundingClientRect();\n    };\n\n    var destroy = function () {\n      win = selectedRange = explicitRange = null;\n      controlSelection.destroy();\n    };\n\n    var exports = {\n      bookmarkManager: null,\n      controlSelection: null,\n      dom: dom,\n      win: win,\n      serializer: serializer,\n      editor: editor,\n      collapse: collapse,\n      setCursorLocation: setCursorLocation,\n      getContent: getContent,\n      setContent: setContent,\n      getBookmark: getBookmark,\n      moveToBookmark: moveToBookmark,\n      select: select,\n      isCollapsed: isCollapsed,\n      isForward: isForward,\n      setNode: setNode,\n      getNode: getNode,\n      getSel: getSel,\n      setRng: setRng,\n      getRng: getRng$1,\n      getStart: getStart,\n      getEnd: getEnd$1,\n      getSelectedBlocks: getSelectedBlocks$1,\n      normalize: normalize$1,\n      selectorChanged: selectorChanged,\n      selectorChangedWithUnbind: selectorChangedWithUnbind,\n      getScrollContainer: getScrollContainer,\n      scrollIntoView: scrollIntoView,\n      placeCaretAt: placeCaretAt,\n      getBoundingClientRect: getBoundingClientRect,\n      destroy: destroy\n    };\n    var bookmarkManager = BookmarkManager(exports);\n    var controlSelection = ControlSelection(exports, editor);\n    exports.bookmarkManager = bookmarkManager;\n    exports.controlSelection = controlSelection;\n    return exports;\n  };\n\n  var removeAttrs = function (node, names) {\n    each(names, function (name) {\n      node.attr(name, null);\n    });\n  };\n\n  var addFontToSpansFilter = function (domParser, styles, fontSizes) {\n    domParser.addNodeFilter('font', function (nodes) {\n      each(nodes, function (node) {\n        var props = styles.parse(node.attr('style'));\n        var color = node.attr('color');\n        var face = node.attr('face');\n        var size = node.attr('size');\n\n        if (color) {\n          props.color = color;\n        }\n\n        if (face) {\n          props['font-family'] = face;\n        }\n\n        if (size) {\n          props['font-size'] = fontSizes[parseInt(node.attr('size'), 10) - 1];\n        }\n\n        node.name = 'span';\n        node.attr('style', styles.serialize(props));\n        removeAttrs(node, ['color', 'face', 'size']);\n      });\n    });\n  };\n\n  var addStrikeToSpanFilter = function (domParser, styles) {\n    domParser.addNodeFilter('strike', function (nodes) {\n      each(nodes, function (node) {\n        var props = styles.parse(node.attr('style'));\n        props['text-decoration'] = 'line-through';\n        node.name = 'span';\n        node.attr('style', styles.serialize(props));\n      });\n    });\n  };\n\n  var addFilters = function (domParser, settings) {\n    var styles = Styles();\n\n    if (settings.convert_fonts_to_spans) {\n      addFontToSpansFilter(domParser, styles, Tools.explode(settings.font_size_legacy_values));\n    }\n\n    addStrikeToSpanFilter(domParser, styles);\n  };\n\n  var register$1 = function (domParser, settings) {\n    if (settings.inline_styles) {\n      addFilters(domParser, settings);\n    }\n  };\n\n  var blobUriToBlob = function (url) {\n    return new promiseObj(function (resolve, reject) {\n      var rejectWithError = function () {\n        reject('Cannot convert ' + url + ' to Blob. Resource might not exist or is inaccessible.');\n      };\n\n      try {\n        var xhr_1 = new XMLHttpRequest();\n        xhr_1.open('GET', url, true);\n        xhr_1.responseType = 'blob';\n\n        xhr_1.onload = function () {\n          if (xhr_1.status === 200) {\n            resolve(xhr_1.response);\n          } else {\n            rejectWithError();\n          }\n        };\n\n        xhr_1.onerror = rejectWithError;\n        xhr_1.send();\n      } catch (ex) {\n        rejectWithError();\n      }\n    });\n  };\n\n  var parseDataUri$1 = function (uri) {\n    var type;\n    var uriParts = decodeURIComponent(uri).split(',');\n    var matches = /data:([^;]+)/.exec(uriParts[0]);\n\n    if (matches) {\n      type = matches[1];\n    }\n\n    return {\n      type: type,\n      data: uriParts[1]\n    };\n  };\n\n  var buildBlob = function (type, data) {\n    var str;\n\n    try {\n      str = atob(data);\n    } catch (e) {\n      return Optional.none();\n    }\n\n    var arr = new Uint8Array(str.length);\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i] = str.charCodeAt(i);\n    }\n\n    return Optional.some(new Blob([arr], {\n      type: type\n    }));\n  };\n\n  var dataUriToBlob = function (uri) {\n    return new promiseObj(function (resolve) {\n      var _a = parseDataUri$1(uri),\n          type = _a.type,\n          data = _a.data;\n\n      buildBlob(type, data).fold(function () {\n        return resolve(new Blob([]));\n      }, resolve);\n    });\n  };\n\n  var uriToBlob = function (url) {\n    if (url.indexOf('blob:') === 0) {\n      return blobUriToBlob(url);\n    }\n\n    if (url.indexOf('data:') === 0) {\n      return dataUriToBlob(url);\n    }\n\n    return null;\n  };\n\n  var blobToDataUri = function (blob) {\n    return new promiseObj(function (resolve) {\n      var reader = new FileReader();\n\n      reader.onloadend = function () {\n        resolve(reader.result);\n      };\n\n      reader.readAsDataURL(blob);\n    });\n  };\n\n  var count = 0;\n\n  var uniqueId = function (prefix) {\n    return (prefix || 'blobid') + count++;\n  };\n\n  var imageToBlobInfo = function (blobCache, img, resolve, reject) {\n    var base64, blobInfo;\n\n    if (img.src.indexOf('blob:') === 0) {\n      blobInfo = blobCache.getByUri(img.src);\n\n      if (blobInfo) {\n        resolve({\n          image: img,\n          blobInfo: blobInfo\n        });\n      } else {\n        uriToBlob(img.src).then(function (blob) {\n          blobToDataUri(blob).then(function (dataUri) {\n            base64 = parseDataUri$1(dataUri).data;\n            blobInfo = blobCache.create(uniqueId(), blob, base64);\n            blobCache.add(blobInfo);\n            resolve({\n              image: img,\n              blobInfo: blobInfo\n            });\n          });\n        }, function (err) {\n          reject(err);\n        });\n      }\n\n      return;\n    }\n\n    var _a = parseDataUri$1(img.src),\n        data = _a.data,\n        type = _a.type;\n\n    base64 = data;\n    blobInfo = blobCache.getByData(base64, type);\n\n    if (blobInfo) {\n      resolve({\n        image: img,\n        blobInfo: blobInfo\n      });\n    } else {\n      uriToBlob(img.src).then(function (blob) {\n        blobInfo = blobCache.create(uniqueId(), blob, base64);\n        blobCache.add(blobInfo);\n        resolve({\n          image: img,\n          blobInfo: blobInfo\n        });\n      }, function (err) {\n        reject(err);\n      });\n    }\n  };\n\n  var getAllImages = function (elm) {\n    return elm ? from$1(elm.getElementsByTagName('img')) : [];\n  };\n\n  var ImageScanner = function (uploadStatus, blobCache) {\n    var cachedPromises = {};\n\n    var findAll = function (elm, predicate) {\n      if (!predicate) {\n        predicate = always;\n      }\n\n      var images = filter(getAllImages(elm), function (img) {\n        var src = img.src;\n\n        if (!Env.fileApi) {\n          return false;\n        }\n\n        if (img.hasAttribute('data-mce-bogus')) {\n          return false;\n        }\n\n        if (img.hasAttribute('data-mce-placeholder')) {\n          return false;\n        }\n\n        if (!src || src === Env.transparentSrc) {\n          return false;\n        }\n\n        if (src.indexOf('blob:') === 0) {\n          return !uploadStatus.isUploaded(src) && predicate(img);\n        }\n\n        if (src.indexOf('data:') === 0) {\n          return predicate(img);\n        }\n\n        return false;\n      });\n      var promises = map(images, function (img) {\n        if (cachedPromises[img.src] !== undefined) {\n          return new promiseObj(function (resolve) {\n            cachedPromises[img.src].then(function (imageInfo) {\n              if (typeof imageInfo === 'string') {\n                return imageInfo;\n              }\n\n              resolve({\n                image: img,\n                blobInfo: imageInfo.blobInfo\n              });\n            });\n          });\n        }\n\n        var newPromise = new promiseObj(function (resolve, reject) {\n          imageToBlobInfo(blobCache, img, resolve, reject);\n        }).then(function (result) {\n          delete cachedPromises[result.image.src];\n          return result;\n        }).catch(function (error) {\n          delete cachedPromises[img.src];\n          return error;\n        });\n        cachedPromises[img.src] = newPromise;\n        return newPromise;\n      });\n      return promiseObj.all(promises);\n    };\n\n    return {\n      findAll: findAll\n    };\n  };\n\n  var paddEmptyNode = function (settings, args, blockElements, node) {\n    var brPreferred = settings.padd_empty_with_br || args.insert;\n\n    if (brPreferred && blockElements[node.name]) {\n      node.empty().append(new AstNode('br', 1)).shortEnded = true;\n    } else {\n      node.empty().append(new AstNode('#text', 3)).value = nbsp;\n    }\n  };\n\n  var isPaddedWithNbsp = function (node) {\n    return hasOnlyChild(node, '#text') && node.firstChild.value === nbsp;\n  };\n\n  var hasOnlyChild = function (node, name) {\n    return node && node.firstChild && node.firstChild === node.lastChild && node.firstChild.name === name;\n  };\n\n  var isPadded = function (schema, node) {\n    var rule = schema.getElementRule(node.name);\n    return rule && rule.paddEmpty;\n  };\n\n  var isEmpty$2 = function (schema, nonEmptyElements, whitespaceElements, node) {\n    return node.isEmpty(nonEmptyElements, whitespaceElements, function (node) {\n      return isPadded(schema, node);\n    });\n  };\n\n  var isLineBreakNode = function (node, blockElements) {\n    return node && (blockElements[node.name] || node.name === 'br');\n  };\n\n  var isBogusImage = function (img) {\n    return img.attr('data-mce-bogus');\n  };\n\n  var isInternalImageSource = function (img) {\n    return img.attr('src') === Env.transparentSrc || img.attr('data-mce-placeholder');\n  };\n\n  var isValidDataImg = function (img, settings) {\n    if (settings.images_dataimg_filter) {\n      var imgElem_1 = new Image();\n      imgElem_1.src = img.attr('src');\n      each$1(img.attributes.map, function (value, key) {\n        imgElem_1.setAttribute(key, value);\n      });\n      return settings.images_dataimg_filter(imgElem_1);\n    } else {\n      return true;\n    }\n  };\n\n  var registerBase64ImageFilter = function (parser, settings) {\n    var blobCache = settings.blob_cache;\n\n    var processImage = function (img) {\n      var inputSrc = img.attr('src');\n\n      if (isInternalImageSource(img) || isBogusImage(img)) {\n        return;\n      }\n\n      parseDataUri(inputSrc).filter(function () {\n        return isValidDataImg(img, settings);\n      }).bind(function (_a) {\n        var type = _a.type,\n            data = _a.data;\n        return Optional.from(blobCache.getByData(data, type)).orThunk(function () {\n          return buildBlob(type, data).map(function (blob) {\n            var blobInfo = blobCache.create(uniqueId(), blob, data);\n            blobCache.add(blobInfo);\n            return blobInfo;\n          });\n        });\n      }).each(function (blobInfo) {\n        img.attr('src', blobInfo.blobUri());\n      });\n    };\n\n    if (blobCache) {\n      parser.addAttributeFilter('src', function (nodes) {\n        return each(nodes, processImage);\n      });\n    }\n  };\n\n  var register$2 = function (parser, settings) {\n    var schema = parser.schema;\n\n    if (settings.remove_trailing_brs) {\n      parser.addNodeFilter('br', function (nodes, _, args) {\n        var i;\n        var l = nodes.length;\n        var node;\n        var blockElements = Tools.extend({}, schema.getBlockElements());\n        var nonEmptyElements = schema.getNonEmptyElements();\n        var parent, lastParent, prev, prevName;\n        var whiteSpaceElements = schema.getWhiteSpaceElements();\n        var elementRule, textNode;\n        blockElements.body = 1;\n\n        for (i = 0; i < l; i++) {\n          node = nodes[i];\n          parent = node.parent;\n\n          if (blockElements[node.parent.name] && node === parent.lastChild) {\n            prev = node.prev;\n\n            while (prev) {\n              prevName = prev.name;\n\n              if (prevName !== 'span' || prev.attr('data-mce-type') !== 'bookmark') {\n                if (prevName === 'br') {\n                  node = null;\n                }\n\n                break;\n              }\n\n              prev = prev.prev;\n            }\n\n            if (node) {\n              node.remove();\n\n              if (isEmpty$2(schema, nonEmptyElements, whiteSpaceElements, parent)) {\n                elementRule = schema.getElementRule(parent.name);\n\n                if (elementRule) {\n                  if (elementRule.removeEmpty) {\n                    parent.remove();\n                  } else if (elementRule.paddEmpty) {\n                    paddEmptyNode(settings, args, blockElements, parent);\n                  }\n                }\n              }\n            }\n          } else {\n            lastParent = node;\n\n            while (parent && parent.firstChild === lastParent && parent.lastChild === lastParent) {\n              lastParent = parent;\n\n              if (blockElements[parent.name]) {\n                break;\n              }\n\n              parent = parent.parent;\n            }\n\n            if (lastParent === parent && settings.padd_empty_with_br !== true) {\n              textNode = new AstNode('#text', 3);\n              textNode.value = nbsp;\n              node.replace(textNode);\n            }\n          }\n        }\n      });\n    }\n\n    parser.addAttributeFilter('href', function (nodes) {\n      var i = nodes.length;\n\n      var appendRel = function (rel) {\n        var parts = rel.split(' ').filter(function (p) {\n          return p.length > 0;\n        });\n        return parts.concat(['noopener']).sort().join(' ');\n      };\n\n      var addNoOpener = function (rel) {\n        var newRel = rel ? Tools.trim(rel) : '';\n\n        if (!/\\b(noopener)\\b/g.test(newRel)) {\n          return appendRel(newRel);\n        } else {\n          return newRel;\n        }\n      };\n\n      if (!settings.allow_unsafe_link_target) {\n        while (i--) {\n          var node = nodes[i];\n\n          if (node.name === 'a' && node.attr('target') === '_blank') {\n            node.attr('rel', addNoOpener(node.attr('rel')));\n          }\n        }\n      }\n    });\n\n    if (!settings.allow_html_in_named_anchor) {\n      parser.addAttributeFilter('id,name', function (nodes) {\n        var i = nodes.length,\n            sibling,\n            prevSibling,\n            parent,\n            node;\n\n        while (i--) {\n          node = nodes[i];\n\n          if (node.name === 'a' && node.firstChild && !node.attr('href')) {\n            parent = node.parent;\n            sibling = node.lastChild;\n\n            do {\n              prevSibling = sibling.prev;\n              parent.insert(sibling, node);\n              sibling = prevSibling;\n            } while (sibling);\n          }\n        }\n      });\n    }\n\n    if (settings.fix_list_elements) {\n      parser.addNodeFilter('ul,ol', function (nodes) {\n        var i = nodes.length,\n            node,\n            parentNode;\n\n        while (i--) {\n          node = nodes[i];\n          parentNode = node.parent;\n\n          if (parentNode.name === 'ul' || parentNode.name === 'ol') {\n            if (node.prev && node.prev.name === 'li') {\n              node.prev.append(node);\n            } else {\n              var li = new AstNode('li', 1);\n              li.attr('style', 'list-style-type: none');\n              node.wrap(li);\n            }\n          }\n        }\n      });\n    }\n\n    if (settings.validate && schema.getValidClasses()) {\n      parser.addAttributeFilter('class', function (nodes) {\n        var i = nodes.length,\n            node,\n            classList,\n            ci,\n            className,\n            classValue;\n        var validClasses = schema.getValidClasses();\n        var validClassesMap, valid;\n\n        while (i--) {\n          node = nodes[i];\n          classList = node.attr('class').split(' ');\n          classValue = '';\n\n          for (ci = 0; ci < classList.length; ci++) {\n            className = classList[ci];\n            valid = false;\n            validClassesMap = validClasses['*'];\n\n            if (validClassesMap && validClassesMap[className]) {\n              valid = true;\n            }\n\n            validClassesMap = validClasses[node.name];\n\n            if (!valid && validClassesMap && validClassesMap[className]) {\n              valid = true;\n            }\n\n            if (valid) {\n              if (classValue) {\n                classValue += ' ';\n              }\n\n              classValue += className;\n            }\n          }\n\n          if (!classValue.length) {\n            classValue = null;\n          }\n\n          node.attr('class', classValue);\n        }\n      });\n    }\n\n    registerBase64ImageFilter(parser, settings);\n  };\n\n  var makeMap$4 = Tools.makeMap,\n      each$d = Tools.each,\n      explode$2 = Tools.explode,\n      extend$2 = Tools.extend;\n\n  var DomParser = function (settings, schema) {\n    if (schema === void 0) {\n      schema = Schema();\n    }\n\n    var nodeFilters = {};\n    var attributeFilters = [];\n    var matchedNodes = {};\n    var matchedAttributes = {};\n    settings = settings || {};\n    settings.validate = 'validate' in settings ? settings.validate : true;\n    settings.root_name = settings.root_name || 'body';\n\n    var fixInvalidChildren = function (nodes) {\n      var ni, node, parent, parents, newParent, currentNode, tempNode, childNode, i;\n      var sibling, nextNode;\n      var nonSplitableElements = makeMap$4('tr,td,th,tbody,thead,tfoot,table');\n      var nonEmptyElements = schema.getNonEmptyElements();\n      var whitespaceElements = schema.getWhiteSpaceElements();\n      var textBlockElements = schema.getTextBlockElements();\n      var specialElements = schema.getSpecialElements();\n\n      for (ni = 0; ni < nodes.length; ni++) {\n        node = nodes[ni];\n\n        if (!node.parent || node.fixed) {\n          continue;\n        }\n\n        if (textBlockElements[node.name] && node.parent.name === 'li') {\n          sibling = node.next;\n\n          while (sibling) {\n            if (textBlockElements[sibling.name]) {\n              sibling.name = 'li';\n              sibling.fixed = true;\n              node.parent.insert(sibling, node.parent);\n            } else {\n              break;\n            }\n\n            sibling = sibling.next;\n          }\n\n          node.unwrap(node);\n          continue;\n        }\n\n        parents = [node];\n\n        for (parent = node.parent; parent && !schema.isValidChild(parent.name, node.name) && !nonSplitableElements[parent.name]; parent = parent.parent) {\n          parents.push(parent);\n        }\n\n        if (parent && parents.length > 1) {\n          parents.reverse();\n          newParent = currentNode = filterNode(parents[0].clone());\n\n          for (i = 0; i < parents.length - 1; i++) {\n            if (schema.isValidChild(currentNode.name, parents[i].name)) {\n              tempNode = filterNode(parents[i].clone());\n              currentNode.append(tempNode);\n            } else {\n              tempNode = currentNode;\n            }\n\n            for (childNode = parents[i].firstChild; childNode && childNode !== parents[i + 1];) {\n              nextNode = childNode.next;\n              tempNode.append(childNode);\n              childNode = nextNode;\n            }\n\n            currentNode = tempNode;\n          }\n\n          if (!isEmpty$2(schema, nonEmptyElements, whitespaceElements, newParent)) {\n            parent.insert(newParent, parents[0], true);\n            parent.insert(node, newParent);\n          } else {\n            parent.insert(node, parents[0], true);\n          }\n\n          parent = parents[0];\n\n          if (isEmpty$2(schema, nonEmptyElements, whitespaceElements, parent) || hasOnlyChild(parent, 'br')) {\n            parent.empty().remove();\n          }\n        } else if (node.parent) {\n          if (node.name === 'li') {\n            sibling = node.prev;\n\n            if (sibling && (sibling.name === 'ul' || sibling.name === 'ol')) {\n              sibling.append(node);\n              continue;\n            }\n\n            sibling = node.next;\n\n            if (sibling && (sibling.name === 'ul' || sibling.name === 'ol')) {\n              sibling.insert(node, sibling.firstChild, true);\n              continue;\n            }\n\n            node.wrap(filterNode(new AstNode('ul', 1)));\n            continue;\n          }\n\n          if (schema.isValidChild(node.parent.name, 'div') && schema.isValidChild('div', node.name)) {\n            node.wrap(filterNode(new AstNode('div', 1)));\n          } else {\n            if (specialElements[node.name]) {\n              node.empty().remove();\n            } else {\n              node.unwrap();\n            }\n          }\n        }\n      }\n    };\n\n    var filterNode = function (node) {\n      var i, name, list;\n      name = node.name;\n\n      if (name in nodeFilters) {\n        list = matchedNodes[name];\n\n        if (list) {\n          list.push(node);\n        } else {\n          matchedNodes[name] = [node];\n        }\n      }\n\n      i = attributeFilters.length;\n\n      while (i--) {\n        name = attributeFilters[i].name;\n\n        if (name in node.attributes.map) {\n          list = matchedAttributes[name];\n\n          if (list) {\n            list.push(node);\n          } else {\n            matchedAttributes[name] = [node];\n          }\n        }\n      }\n\n      return node;\n    };\n\n    var addNodeFilter = function (name, callback) {\n      each$d(explode$2(name), function (name) {\n        var list = nodeFilters[name];\n\n        if (!list) {\n          nodeFilters[name] = list = [];\n        }\n\n        list.push(callback);\n      });\n    };\n\n    var getNodeFilters = function () {\n      var out = [];\n\n      for (var name_1 in nodeFilters) {\n        if (nodeFilters.hasOwnProperty(name_1)) {\n          out.push({\n            name: name_1,\n            callbacks: nodeFilters[name_1]\n          });\n        }\n      }\n\n      return out;\n    };\n\n    var addAttributeFilter = function (name, callback) {\n      each$d(explode$2(name), function (name) {\n        var i;\n\n        for (i = 0; i < attributeFilters.length; i++) {\n          if (attributeFilters[i].name === name) {\n            attributeFilters[i].callbacks.push(callback);\n            return;\n          }\n        }\n\n        attributeFilters.push({\n          name: name,\n          callbacks: [callback]\n        });\n      });\n    };\n\n    var getAttributeFilters = function () {\n      return [].concat(attributeFilters);\n    };\n\n    var parse = function (html, args) {\n      var nodes, i, l, fi, fl, list, name;\n      var invalidChildren = [];\n      var isInWhiteSpacePreservedElement;\n      var node;\n\n      var getRootBlockName = function (name) {\n        if (name === false) {\n          return '';\n        } else if (name === true) {\n          return 'p';\n        } else {\n          return name;\n        }\n      };\n\n      args = args || {};\n      matchedNodes = {};\n      matchedAttributes = {};\n      var blockElements = extend$2(makeMap$4('script,style,head,html,body,title,meta,param'), schema.getBlockElements());\n      var nonEmptyElements = schema.getNonEmptyElements();\n      var children = schema.children;\n      var validate = settings.validate;\n      var forcedRootBlockName = 'forced_root_block' in args ? args.forced_root_block : settings.forced_root_block;\n      var rootBlockName = getRootBlockName(forcedRootBlockName);\n      var whiteSpaceElements = schema.getWhiteSpaceElements();\n      var startWhiteSpaceRegExp = /^[ \\t\\r\\n]+/;\n      var endWhiteSpaceRegExp = /[ \\t\\r\\n]+$/;\n      var allWhiteSpaceRegExp = /[ \\t\\r\\n]+/g;\n      var isAllWhiteSpaceRegExp = /^[ \\t\\r\\n]+$/;\n      isInWhiteSpacePreservedElement = whiteSpaceElements.hasOwnProperty(args.context) || whiteSpaceElements.hasOwnProperty(settings.root_name);\n\n      var addRootBlocks = function () {\n        var node = rootNode.firstChild,\n            next,\n            rootBlockNode;\n\n        var trim = function (rootBlockNode) {\n          if (rootBlockNode) {\n            node = rootBlockNode.firstChild;\n\n            if (node && node.type === 3) {\n              node.value = node.value.replace(startWhiteSpaceRegExp, '');\n            }\n\n            node = rootBlockNode.lastChild;\n\n            if (node && node.type === 3) {\n              node.value = node.value.replace(endWhiteSpaceRegExp, '');\n            }\n          }\n        };\n\n        if (!schema.isValidChild(rootNode.name, rootBlockName.toLowerCase())) {\n          return;\n        }\n\n        while (node) {\n          next = node.next;\n\n          if (node.type === 3 || node.type === 1 && node.name !== 'p' && !blockElements[node.name] && !node.attr('data-mce-type')) {\n            if (!rootBlockNode) {\n              rootBlockNode = createNode(rootBlockName, 1);\n              rootBlockNode.attr(settings.forced_root_block_attrs);\n              rootNode.insert(rootBlockNode, node);\n              rootBlockNode.append(node);\n            } else {\n              rootBlockNode.append(node);\n            }\n          } else {\n            trim(rootBlockNode);\n            rootBlockNode = null;\n          }\n\n          node = next;\n        }\n\n        trim(rootBlockNode);\n      };\n\n      var createNode = function (name, type) {\n        var node = new AstNode(name, type);\n        var list;\n\n        if (name in nodeFilters) {\n          list = matchedNodes[name];\n\n          if (list) {\n            list.push(node);\n          } else {\n            matchedNodes[name] = [node];\n          }\n        }\n\n        return node;\n      };\n\n      var removeWhitespaceBefore = function (node) {\n        var textNode, textNodeNext, textVal, sibling;\n        var blockElements = schema.getBlockElements();\n\n        for (textNode = node.prev; textNode && textNode.type === 3;) {\n          textVal = textNode.value.replace(endWhiteSpaceRegExp, '');\n\n          if (textVal.length > 0) {\n            textNode.value = textVal;\n            return;\n          }\n\n          textNodeNext = textNode.next;\n\n          if (textNodeNext) {\n            if (textNodeNext.type === 3 && textNodeNext.value.length) {\n              textNode = textNode.prev;\n              continue;\n            }\n\n            if (!blockElements[textNodeNext.name] && textNodeNext.name !== 'script' && textNodeNext.name !== 'style') {\n              textNode = textNode.prev;\n              continue;\n            }\n          }\n\n          sibling = textNode.prev;\n          textNode.remove();\n          textNode = sibling;\n        }\n      };\n\n      var cloneAndExcludeBlocks = function (input) {\n        var name;\n        var output = {};\n\n        for (name in input) {\n          if (name !== 'li' && name !== 'p') {\n            output[name] = input[name];\n          }\n        }\n\n        return output;\n      };\n\n      var parser = SaxParser({\n        validate: validate,\n        allow_html_data_urls: settings.allow_html_data_urls,\n        allow_svg_data_urls: settings.allow_svg_data_urls,\n        allow_script_urls: settings.allow_script_urls,\n        allow_conditional_comments: settings.allow_conditional_comments,\n        preserve_cdata: settings.preserve_cdata,\n        self_closing_elements: cloneAndExcludeBlocks(schema.getSelfClosingElements()),\n        cdata: function (text) {\n          node.append(createNode('#cdata', 4)).value = text;\n        },\n        text: function (text, raw) {\n          var textNode;\n\n          if (!isInWhiteSpacePreservedElement) {\n            text = text.replace(allWhiteSpaceRegExp, ' ');\n\n            if (isLineBreakNode(node.lastChild, blockElements)) {\n              text = text.replace(startWhiteSpaceRegExp, '');\n            }\n          }\n\n          if (text.length !== 0) {\n            textNode = createNode('#text', 3);\n            textNode.raw = !!raw;\n            node.append(textNode).value = text;\n          }\n        },\n        comment: function (text) {\n          node.append(createNode('#comment', 8)).value = text;\n        },\n        pi: function (name, text) {\n          node.append(createNode(name, 7)).value = text;\n          removeWhitespaceBefore(node);\n        },\n        doctype: function (text) {\n          var newNode = node.append(createNode('#doctype', 10));\n          newNode.value = text;\n          removeWhitespaceBefore(node);\n        },\n        start: function (name, attrs, empty) {\n          var newNode, attrFiltersLen, attrName, parent;\n          var elementRule = validate ? schema.getElementRule(name) : {};\n\n          if (elementRule) {\n            newNode = createNode(elementRule.outputName || name, 1);\n            newNode.attributes = attrs;\n            newNode.shortEnded = empty;\n            node.append(newNode);\n            parent = children[node.name];\n\n            if (parent && children[newNode.name] && !parent[newNode.name]) {\n              invalidChildren.push(newNode);\n            }\n\n            attrFiltersLen = attributeFilters.length;\n\n            while (attrFiltersLen--) {\n              attrName = attributeFilters[attrFiltersLen].name;\n\n              if (attrName in attrs.map) {\n                list = matchedAttributes[attrName];\n\n                if (list) {\n                  list.push(newNode);\n                } else {\n                  matchedAttributes[attrName] = [newNode];\n                }\n              }\n            }\n\n            if (blockElements[name]) {\n              removeWhitespaceBefore(newNode);\n            }\n\n            if (!empty) {\n              node = newNode;\n            }\n\n            if (!isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n              isInWhiteSpacePreservedElement = true;\n            }\n          }\n        },\n        end: function (name) {\n          var textNode, text, sibling, tempNode;\n          var elementRule = validate ? schema.getElementRule(name) : {};\n\n          if (elementRule) {\n            if (blockElements[name]) {\n              if (!isInWhiteSpacePreservedElement) {\n                textNode = node.firstChild;\n\n                if (textNode && textNode.type === 3) {\n                  text = textNode.value.replace(startWhiteSpaceRegExp, '');\n\n                  if (text.length > 0) {\n                    textNode.value = text;\n                    textNode = textNode.next;\n                  } else {\n                    sibling = textNode.next;\n                    textNode.remove();\n                    textNode = sibling;\n\n                    while (textNode && textNode.type === 3) {\n                      text = textNode.value;\n                      sibling = textNode.next;\n\n                      if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                        textNode.remove();\n                        textNode = sibling;\n                      }\n\n                      textNode = sibling;\n                    }\n                  }\n                }\n\n                textNode = node.lastChild;\n\n                if (textNode && textNode.type === 3) {\n                  text = textNode.value.replace(endWhiteSpaceRegExp, '');\n\n                  if (text.length > 0) {\n                    textNode.value = text;\n                    textNode = textNode.prev;\n                  } else {\n                    sibling = textNode.prev;\n                    textNode.remove();\n                    textNode = sibling;\n\n                    while (textNode && textNode.type === 3) {\n                      text = textNode.value;\n                      sibling = textNode.prev;\n\n                      if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                        textNode.remove();\n                        textNode = sibling;\n                      }\n\n                      textNode = sibling;\n                    }\n                  }\n                }\n              }\n            }\n\n            if (isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n              isInWhiteSpacePreservedElement = false;\n            }\n\n            if (elementRule.removeEmpty && isEmpty$2(schema, nonEmptyElements, whiteSpaceElements, node)) {\n              tempNode = node.parent;\n\n              if (blockElements[node.name]) {\n                node.empty().remove();\n              } else {\n                node.unwrap();\n              }\n\n              node = tempNode;\n              return;\n            }\n\n            if (elementRule.paddEmpty && (isPaddedWithNbsp(node) || isEmpty$2(schema, nonEmptyElements, whiteSpaceElements, node))) {\n              paddEmptyNode(settings, args, blockElements, node);\n            }\n\n            node = node.parent;\n          }\n        }\n      }, schema);\n      var rootNode = node = new AstNode(args.context || settings.root_name, 11);\n      parser.parse(html, args.format);\n\n      if (validate && invalidChildren.length) {\n        if (!args.context) {\n          fixInvalidChildren(invalidChildren);\n        } else {\n          args.invalid = true;\n        }\n      }\n\n      if (rootBlockName && (rootNode.name === 'body' || args.isRootContent)) {\n        addRootBlocks();\n      }\n\n      if (!args.invalid) {\n        for (name in matchedNodes) {\n          if (!matchedNodes.hasOwnProperty(name)) {\n            continue;\n          }\n\n          list = nodeFilters[name];\n          nodes = matchedNodes[name];\n          fi = nodes.length;\n\n          while (fi--) {\n            if (!nodes[fi].parent) {\n              nodes.splice(fi, 1);\n            }\n          }\n\n          for (i = 0, l = list.length; i < l; i++) {\n            list[i](nodes, name, args);\n          }\n        }\n\n        for (i = 0, l = attributeFilters.length; i < l; i++) {\n          list = attributeFilters[i];\n\n          if (list.name in matchedAttributes) {\n            nodes = matchedAttributes[list.name];\n            fi = nodes.length;\n\n            while (fi--) {\n              if (!nodes[fi].parent) {\n                nodes.splice(fi, 1);\n              }\n            }\n\n            for (fi = 0, fl = list.callbacks.length; fi < fl; fi++) {\n              list.callbacks[fi](nodes, list.name, args);\n            }\n          }\n        }\n      }\n\n      return rootNode;\n    };\n\n    var exports = {\n      schema: schema,\n      addAttributeFilter: addAttributeFilter,\n      getAttributeFilters: getAttributeFilters,\n      addNodeFilter: addNodeFilter,\n      getNodeFilters: getNodeFilters,\n      filterNode: filterNode,\n      parse: parse\n    };\n    register$2(exports, settings);\n    register$1(exports, settings);\n    return exports;\n  };\n\n  var register$3 = function (htmlParser, settings, dom) {\n    htmlParser.addAttributeFilter('data-mce-tabindex', function (nodes, name) {\n      var i = nodes.length,\n          node;\n\n      while (i--) {\n        node = nodes[i];\n        node.attr('tabindex', node.attr('data-mce-tabindex'));\n        node.attr(name, null);\n      }\n    });\n    htmlParser.addAttributeFilter('src,href,style', function (nodes, name) {\n      var i = nodes.length,\n          node,\n          value;\n      var internalName = 'data-mce-' + name;\n      var urlConverter = settings.url_converter;\n      var urlConverterScope = settings.url_converter_scope;\n\n      while (i--) {\n        node = nodes[i];\n        value = node.attr(internalName);\n\n        if (value !== undefined) {\n          node.attr(name, value.length > 0 ? value : null);\n          node.attr(internalName, null);\n        } else {\n          value = node.attr(name);\n\n          if (name === 'style') {\n            value = dom.serializeStyle(dom.parseStyle(value), node.name);\n          } else if (urlConverter) {\n            value = urlConverter.call(urlConverterScope, value, name, node.name);\n          }\n\n          node.attr(name, value.length > 0 ? value : null);\n        }\n      }\n    });\n    htmlParser.addAttributeFilter('class', function (nodes) {\n      var i = nodes.length,\n          node,\n          value;\n\n      while (i--) {\n        node = nodes[i];\n        value = node.attr('class');\n\n        if (value) {\n          value = node.attr('class').replace(/(?:^|\\s)mce-item-\\w+(?!\\S)/g, '');\n          node.attr('class', value.length > 0 ? value : null);\n        }\n      }\n    });\n    htmlParser.addAttributeFilter('data-mce-type', function (nodes, name, args) {\n      var i = nodes.length,\n          node;\n\n      while (i--) {\n        node = nodes[i];\n\n        if (node.attr('data-mce-type') === 'bookmark' && !args.cleanup) {\n          var hasChildren = Optional.from(node.firstChild).exists(function (firstChild) {\n            return !isZwsp$1(firstChild.value);\n          });\n\n          if (hasChildren) {\n            node.unwrap();\n          } else {\n            node.remove();\n          }\n        }\n      }\n    });\n    htmlParser.addNodeFilter('noscript', function (nodes) {\n      var i = nodes.length,\n          node;\n\n      while (i--) {\n        node = nodes[i].firstChild;\n\n        if (node) {\n          node.value = Entities.decode(node.value);\n        }\n      }\n    });\n    htmlParser.addNodeFilter('script,style', function (nodes, name) {\n      var i = nodes.length,\n          node,\n          value,\n          type;\n\n      var trim = function (value) {\n        return value.replace(/(<!--\\[CDATA\\[|\\]\\]-->)/g, '\\n').replace(/^[\\r\\n]*|[\\r\\n]*$/g, '').replace(/^\\s*((<!--)?(\\s*\\/\\/)?\\s*<!\\[CDATA\\[|(<!--\\s*)?\\/\\*\\s*<!\\[CDATA\\[\\s*\\*\\/|(\\/\\/)?\\s*<!--|\\/\\*\\s*<!--\\s*\\*\\/)\\s*[\\r\\n]*/gi, '').replace(/\\s*(\\/\\*\\s*\\]\\]>\\s*\\*\\/(-->)?|\\s*\\/\\/\\s*\\]\\]>(-->)?|\\/\\/\\s*(-->)?|\\]\\]>|\\/\\*\\s*-->\\s*\\*\\/|\\s*-->\\s*)\\s*$/g, '');\n      };\n\n      while (i--) {\n        node = nodes[i];\n        value = node.firstChild ? node.firstChild.value : '';\n\n        if (name === 'script') {\n          type = node.attr('type');\n\n          if (type) {\n            node.attr('type', type === 'mce-no/type' ? null : type.replace(/^mce\\-/, ''));\n          }\n\n          if (settings.element_format === 'xhtml' && value.length > 0) {\n            node.firstChild.value = '// <![CDATA[\\n' + trim(value) + '\\n// ]]>';\n          }\n        } else {\n          if (settings.element_format === 'xhtml' && value.length > 0) {\n            node.firstChild.value = '<!--\\n' + trim(value) + '\\n-->';\n          }\n        }\n      }\n    });\n    htmlParser.addNodeFilter('#comment', function (nodes) {\n      var i = nodes.length,\n          node;\n\n      while (i--) {\n        node = nodes[i];\n\n        if (settings.preserve_cdata && node.value.indexOf('[CDATA[') === 0) {\n          node.name = '#cdata';\n          node.type = 4;\n          node.value = dom.decode(node.value.replace(/^\\[CDATA\\[|\\]\\]$/g, ''));\n        } else if (node.value.indexOf('mce:protected ') === 0) {\n          node.name = '#text';\n          node.type = 3;\n          node.raw = true;\n          node.value = unescape(node.value).substr(14);\n        }\n      }\n    });\n    htmlParser.addNodeFilter('xml:namespace,input', function (nodes, name) {\n      var i = nodes.length,\n          node;\n\n      while (i--) {\n        node = nodes[i];\n\n        if (node.type === 7) {\n          node.remove();\n        } else if (node.type === 1) {\n          if (name === 'input' && !node.attr('type')) {\n            node.attr('type', 'text');\n          }\n        }\n      }\n    });\n    htmlParser.addAttributeFilter('data-mce-type', function (nodes) {\n      each(nodes, function (node) {\n        if (node.attr('data-mce-type') === 'format-caret') {\n          if (node.isEmpty(htmlParser.schema.getNonEmptyElements())) {\n            node.remove();\n          } else {\n            node.unwrap();\n          }\n        }\n      });\n    });\n    htmlParser.addAttributeFilter('data-mce-src,data-mce-href,data-mce-style,' + 'data-mce-selected,data-mce-expando,' + 'data-mce-type,data-mce-resize,data-mce-placeholder', function (nodes, name) {\n      var i = nodes.length;\n\n      while (i--) {\n        nodes[i].attr(name, null);\n      }\n    });\n  };\n\n  var trimTrailingBr = function (rootNode) {\n    var isBr = function (node) {\n      return node && node.name === 'br';\n    };\n\n    var brNode1 = rootNode.lastChild;\n\n    if (isBr(brNode1)) {\n      var brNode2 = brNode1.prev;\n\n      if (isBr(brNode2)) {\n        brNode1.remove();\n        brNode2.remove();\n      }\n    }\n  };\n\n  var preProcess = function (editor, node, args) {\n    var doc, oldDoc;\n    var dom = editor.dom;\n    node = node.cloneNode(true);\n    var impl = document.implementation;\n\n    if (impl.createHTMLDocument) {\n      doc = impl.createHTMLDocument('');\n      Tools.each(node.nodeName === 'BODY' ? node.childNodes : [node], function (node) {\n        doc.body.appendChild(doc.importNode(node, true));\n      });\n\n      if (node.nodeName !== 'BODY') {\n        node = doc.body.firstChild;\n      } else {\n        node = doc.body;\n      }\n\n      oldDoc = dom.doc;\n      dom.doc = doc;\n    }\n\n    firePreProcess(editor, __assign(__assign({}, args), {\n      node: node\n    }));\n\n    if (oldDoc) {\n      dom.doc = oldDoc;\n    }\n\n    return node;\n  };\n\n  var shouldFireEvent = function (editor, args) {\n    return editor && editor.hasEventListeners('PreProcess') && !args.no_events;\n  };\n\n  var process = function (editor, node, args) {\n    return shouldFireEvent(editor, args) ? preProcess(editor, node, args) : node;\n  };\n\n  var addTempAttr = function (htmlParser, tempAttrs, name) {\n    if (Tools.inArray(tempAttrs, name) === -1) {\n      htmlParser.addAttributeFilter(name, function (nodes, name) {\n        var i = nodes.length;\n\n        while (i--) {\n          nodes[i].attr(name, null);\n        }\n      });\n      tempAttrs.push(name);\n    }\n  };\n\n  var postProcess$1 = function (editor, args, content) {\n    if (!args.no_events && editor) {\n      var outArgs = firePostProcess(editor, __assign(__assign({}, args), {\n        content: content\n      }));\n      return outArgs.content;\n    } else {\n      return content;\n    }\n  };\n\n  var getHtmlFromNode = function (dom, node, args) {\n    var html = trim$2(args.getInner ? node.innerHTML : dom.getOuterHTML(node));\n    return args.selection || isWsPreserveElement(SugarElement.fromDom(node)) ? html : Tools.trim(html);\n  };\n\n  var parseHtml = function (htmlParser, html, args) {\n    var parserArgs = args.selection ? __assign({\n      forced_root_block: false\n    }, args) : args;\n    var rootNode = htmlParser.parse(html, parserArgs);\n    trimTrailingBr(rootNode);\n    return rootNode;\n  };\n\n  var serializeNode = function (settings, schema, node) {\n    var htmlSerializer = HtmlSerializer(settings, schema);\n    return htmlSerializer.serialize(node);\n  };\n\n  var toHtml = function (editor, settings, schema, rootNode, args) {\n    var content = serializeNode(settings, schema, rootNode);\n    return postProcess$1(editor, args, content);\n  };\n\n  var DomSerializerImpl = function (settings, editor) {\n    var tempAttrs = ['data-mce-selected'];\n    var dom = editor && editor.dom ? editor.dom : DOMUtils.DOM;\n    var schema = editor && editor.schema ? editor.schema : Schema(settings);\n    settings.entity_encoding = settings.entity_encoding || 'named';\n    settings.remove_trailing_brs = 'remove_trailing_brs' in settings ? settings.remove_trailing_brs : true;\n    var htmlParser = DomParser(settings, schema);\n    register$3(htmlParser, settings, dom);\n\n    var serialize = function (node, parserArgs) {\n      if (parserArgs === void 0) {\n        parserArgs = {};\n      }\n\n      var args = __assign({\n        format: 'html'\n      }, parserArgs);\n\n      var targetNode = process(editor, node, args);\n      var html = getHtmlFromNode(dom, targetNode, args);\n      var rootNode = parseHtml(htmlParser, html, args);\n      return args.format === 'tree' ? rootNode : toHtml(editor, settings, schema, rootNode, args);\n    };\n\n    return {\n      schema: schema,\n      addNodeFilter: htmlParser.addNodeFilter,\n      addAttributeFilter: htmlParser.addAttributeFilter,\n      serialize: serialize,\n      addRules: function (rules) {\n        schema.addValidElements(rules);\n      },\n      setRules: function (rules) {\n        schema.setValidElements(rules);\n      },\n      addTempAttr: curry(addTempAttr, htmlParser, tempAttrs),\n      getTempAttrs: constant(tempAttrs),\n      getNodeFilters: htmlParser.getNodeFilters,\n      getAttributeFilters: htmlParser.getAttributeFilters\n    };\n  };\n\n  var DomSerializer = function (settings, editor) {\n    var domSerializer = DomSerializerImpl(settings, editor);\n    return {\n      schema: domSerializer.schema,\n      addNodeFilter: domSerializer.addNodeFilter,\n      addAttributeFilter: domSerializer.addAttributeFilter,\n      serialize: domSerializer.serialize,\n      addRules: domSerializer.addRules,\n      setRules: domSerializer.setRules,\n      addTempAttr: domSerializer.addTempAttr,\n      getTempAttrs: domSerializer.getTempAttrs,\n      getNodeFilters: domSerializer.getNodeFilters,\n      getAttributeFilters: domSerializer.getAttributeFilters\n    };\n  };\n\n  var defaultFormat$1 = 'html';\n\n  var getContent$2 = function (editor, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    var format = args.format ? args.format : defaultFormat$1;\n    return getContent(editor, args, format);\n  };\n\n  var setContent$2 = function (editor, content, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    return setContent(editor, content, args);\n  };\n\n  var DOM$3 = DOMUtils.DOM;\n\n  var restoreOriginalStyles = function (editor) {\n    DOM$3.setStyle(editor.id, 'display', editor.orgDisplay);\n  };\n\n  var safeDestroy = function (x) {\n    return Optional.from(x).each(function (x) {\n      return x.destroy();\n    });\n  };\n\n  var clearDomReferences = function (editor) {\n    editor.contentAreaContainer = editor.formElement = editor.container = editor.editorContainer = null;\n    editor.bodyElement = editor.contentDocument = editor.contentWindow = null;\n    editor.iframeElement = editor.targetElm = null;\n\n    if (editor.selection) {\n      editor.selection = editor.selection.win = editor.selection.dom = editor.selection.dom.doc = null;\n    }\n  };\n\n  var restoreForm = function (editor) {\n    var form = editor.formElement;\n\n    if (form) {\n      if (form._mceOldSubmit) {\n        form.submit = form._mceOldSubmit;\n        form._mceOldSubmit = null;\n      }\n\n      DOM$3.unbind(form, 'submit reset', editor.formEventDelegate);\n    }\n  };\n\n  var remove$7 = function (editor) {\n    if (!editor.removed) {\n      var _selectionOverrides = editor._selectionOverrides,\n          editorUpload = editor.editorUpload;\n      var body = editor.getBody();\n      var element = editor.getElement();\n\n      if (body) {\n        editor.save({\n          is_removing: true\n        });\n      }\n\n      editor.removed = true;\n      editor.unbindAllNativeEvents();\n\n      if (editor.hasHiddenInput && element) {\n        DOM$3.remove(element.nextSibling);\n      }\n\n      fireRemove(editor);\n      editor.editorManager.remove(editor);\n\n      if (!editor.inline && body) {\n        restoreOriginalStyles(editor);\n      }\n\n      fireDetach(editor);\n      DOM$3.remove(editor.getContainer());\n      safeDestroy(_selectionOverrides);\n      safeDestroy(editorUpload);\n      editor.destroy();\n    }\n  };\n\n  var destroy = function (editor, automatic) {\n    var selection = editor.selection,\n        dom = editor.dom;\n\n    if (editor.destroyed) {\n      return;\n    }\n\n    if (!automatic && !editor.removed) {\n      editor.remove();\n      return;\n    }\n\n    if (!automatic) {\n      editor.editorManager.off('beforeunload', editor._beforeUnload);\n\n      if (editor.theme && editor.theme.destroy) {\n        editor.theme.destroy();\n      }\n\n      safeDestroy(selection);\n      safeDestroy(dom);\n    }\n\n    restoreForm(editor);\n    clearDomReferences(editor);\n    editor.destroyed = true;\n  };\n\n  var hasOwnProperty$2 = Object.prototype.hasOwnProperty;\n\n  var deep$1 = function (old, nu) {\n    var bothObjects = isObject(old) && isObject(nu);\n    return bothObjects ? deepMerge(old, nu) : nu;\n  };\n\n  var baseMerge = function (merger) {\n    return function () {\n      var objects = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        objects[_i] = arguments[_i];\n      }\n\n      if (objects.length === 0) {\n        throw new Error('Can\\'t merge zero objects');\n      }\n\n      var ret = {};\n\n      for (var j = 0; j < objects.length; j++) {\n        var curObject = objects[j];\n\n        for (var key in curObject) {\n          if (hasOwnProperty$2.call(curObject, key)) {\n            ret[key] = merger(ret[key], curObject[key]);\n          }\n        }\n      }\n\n      return ret;\n    };\n  };\n\n  var deepMerge = baseMerge(deep$1);\n\n  var sectionResult = function (sections, settings) {\n    return {\n      sections: constant(sections),\n      settings: constant(settings)\n    };\n  };\n\n  var deviceDetection = detect$3().deviceType;\n  var isTouch = deviceDetection.isTouch();\n  var isPhone = deviceDetection.isPhone();\n  var isTablet = deviceDetection.isTablet();\n  var legacyMobilePlugins = ['lists', 'autolink', 'autosave'];\n  var defaultTouchSettings = {\n    table_grid: false,\n    object_resizing: false,\n    resize: false\n  };\n\n  var normalizePlugins = function (plugins) {\n    var pluginNames = isArray(plugins) ? plugins.join(' ') : plugins;\n    var trimmedPlugins = map(isString(pluginNames) ? pluginNames.split(' ') : [], trim);\n    return filter(trimmedPlugins, function (item) {\n      return item.length > 0;\n    });\n  };\n\n  var filterLegacyMobilePlugins = function (plugins) {\n    return filter(plugins, curry(contains, legacyMobilePlugins));\n  };\n\n  var extractSections = function (keys, settings) {\n    var result = bifilter(settings, function (value, key) {\n      return contains(keys, key);\n    });\n    return sectionResult(result.t, result.f);\n  };\n\n  var getSection = function (sectionResult, name, defaults) {\n    if (defaults === void 0) {\n      defaults = {};\n    }\n\n    var sections = sectionResult.sections();\n    var sectionSettings = sections.hasOwnProperty(name) ? sections[name] : {};\n    return Tools.extend({}, defaults, sectionSettings);\n  };\n\n  var hasSection = function (sectionResult, name) {\n    return sectionResult.sections().hasOwnProperty(name);\n  };\n\n  var isSectionTheme = function (sectionResult, name, theme) {\n    var section = sectionResult.sections();\n    return hasSection(sectionResult, name) && section[name].theme === theme;\n  };\n\n  var getSectionConfig = function (sectionResult, name) {\n    return hasSection(sectionResult, name) ? sectionResult.sections()[name] : {};\n  };\n\n  var getToolbarMode = function (settings, defaultVal) {\n    return get$1(settings, 'toolbar_mode').orThunk(function () {\n      return get$1(settings, 'toolbar_drawer').map(function (val) {\n        return val === false ? 'wrap' : val;\n      });\n    }).getOr(defaultVal);\n  };\n\n  var getDefaultSettings = function (settings, id, documentBaseUrl, isTouch, editor) {\n    var baseDefaults = {\n      id: id,\n      theme: 'silver',\n      toolbar_mode: getToolbarMode(settings, 'floating'),\n      plugins: '',\n      document_base_url: documentBaseUrl,\n      add_form_submit_trigger: true,\n      submit_patch: true,\n      add_unload_trigger: true,\n      convert_urls: true,\n      relative_urls: true,\n      remove_script_host: true,\n      object_resizing: true,\n      doctype: '<!DOCTYPE html>',\n      visual: true,\n      font_size_legacy_values: 'xx-small,small,medium,large,x-large,xx-large,300%',\n      forced_root_block: 'p',\n      hidden_input: true,\n      inline_styles: true,\n      convert_fonts_to_spans: true,\n      indent: true,\n      indent_before: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n      indent_after: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n      entity_encoding: 'named',\n      url_converter: editor.convertURL,\n      url_converter_scope: editor\n    };\n    return __assign(__assign({}, baseDefaults), isTouch ? defaultTouchSettings : {});\n  };\n\n  var getDefaultMobileSettings = function (mobileSettings, isPhone) {\n    var defaultMobileSettings = {\n      resize: false,\n      toolbar_mode: getToolbarMode(mobileSettings, 'scrolling'),\n      toolbar_sticky: false\n    };\n    var defaultPhoneSettings = {\n      menubar: false\n    };\n    return __assign(__assign(__assign({}, defaultTouchSettings), defaultMobileSettings), isPhone ? defaultPhoneSettings : {});\n  };\n\n  var getExternalPlugins$1 = function (overrideSettings, settings) {\n    var userDefinedExternalPlugins = settings.external_plugins ? settings.external_plugins : {};\n\n    if (overrideSettings && overrideSettings.external_plugins) {\n      return Tools.extend({}, overrideSettings.external_plugins, userDefinedExternalPlugins);\n    } else {\n      return userDefinedExternalPlugins;\n    }\n  };\n\n  var combinePlugins = function (forcedPlugins, plugins) {\n    return [].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins));\n  };\n\n  var getPlatformPlugins = function (isMobileDevice, sectionResult, desktopPlugins, mobilePlugins) {\n    if (isMobileDevice && isSectionTheme(sectionResult, 'mobile', 'mobile')) {\n      return filterLegacyMobilePlugins(mobilePlugins);\n    } else if (isMobileDevice && hasSection(sectionResult, 'mobile')) {\n      return mobilePlugins;\n    } else {\n      return desktopPlugins;\n    }\n  };\n\n  var processPlugins = function (isMobileDevice, sectionResult, defaultOverrideSettings, settings) {\n    var forcedPlugins = normalizePlugins(defaultOverrideSettings.forced_plugins);\n    var desktopPlugins = normalizePlugins(settings.plugins);\n    var mobileConfig = getSectionConfig(sectionResult, 'mobile');\n    var mobilePlugins = mobileConfig.plugins ? normalizePlugins(mobileConfig.plugins) : desktopPlugins;\n    var platformPlugins = getPlatformPlugins(isMobileDevice, sectionResult, desktopPlugins, mobilePlugins);\n    var combinedPlugins = combinePlugins(forcedPlugins, platformPlugins);\n\n    if (Env.browser.isIE() && contains(combinedPlugins, 'rtc')) {\n      throw new Error('RTC plugin is not supported on IE 11.');\n    }\n\n    return Tools.extend(settings, {\n      plugins: combinedPlugins.join(' ')\n    });\n  };\n\n  var isOnMobile = function (isMobileDevice, sectionResult) {\n    return isMobileDevice && hasSection(sectionResult, 'mobile');\n  };\n\n  var combineSettings = function (isMobileDevice, isPhone, defaultSettings, defaultOverrideSettings, settings) {\n    var defaultDeviceSettings = isMobileDevice ? {\n      mobile: getDefaultMobileSettings(settings.mobile || {}, isPhone)\n    } : {};\n    var sectionResult = extractSections(['mobile'], deepMerge(defaultDeviceSettings, settings));\n    var extendedSettings = Tools.extend(defaultSettings, defaultOverrideSettings, sectionResult.settings(), isOnMobile(isMobileDevice, sectionResult) ? getSection(sectionResult, 'mobile') : {}, {\n      validate: true,\n      external_plugins: getExternalPlugins$1(defaultOverrideSettings, sectionResult.settings())\n    });\n    return processPlugins(isMobileDevice, sectionResult, defaultOverrideSettings, extendedSettings);\n  };\n\n  var getEditorSettings = function (editor, id, documentBaseUrl, defaultOverrideSettings, settings) {\n    var defaultSettings = getDefaultSettings(settings, id, documentBaseUrl, isTouch, editor);\n    return combineSettings(isPhone || isTablet, isPhone, defaultSettings, defaultOverrideSettings, settings);\n  };\n\n  var getFiltered = function (predicate, editor, name) {\n    return Optional.from(editor.settings[name]).filter(predicate);\n  };\n\n  var getParamObject = function (value) {\n    var output = {};\n\n    if (typeof value === 'string') {\n      each(value.indexOf('=') > 0 ? value.split(/[;,](?![^=;,]*(?:[;,]|$))/) : value.split(','), function (val) {\n        var arr = val.split('=');\n\n        if (arr.length > 1) {\n          output[Tools.trim(arr[0])] = Tools.trim(arr[1]);\n        } else {\n          output[Tools.trim(arr[0])] = Tools.trim(arr[0]);\n        }\n      });\n    } else {\n      output = value;\n    }\n\n    return output;\n  };\n\n  var isArrayOf = function (p) {\n    return function (a) {\n      return isArray(a) && forall(a, p);\n    };\n  };\n\n  var getParam = function (editor, name, defaultVal, type) {\n    var value = name in editor.settings ? editor.settings[name] : defaultVal;\n\n    if (type === 'hash') {\n      return getParamObject(value);\n    } else if (type === 'string') {\n      return getFiltered(isString, editor, name).getOr(defaultVal);\n    } else if (type === 'number') {\n      return getFiltered(isNumber, editor, name).getOr(defaultVal);\n    } else if (type === 'boolean') {\n      return getFiltered(isBoolean, editor, name).getOr(defaultVal);\n    } else if (type === 'object') {\n      return getFiltered(isObject, editor, name).getOr(defaultVal);\n    } else if (type === 'array') {\n      return getFiltered(isArray, editor, name).getOr(defaultVal);\n    } else if (type === 'string[]') {\n      return getFiltered(isArrayOf(isString), editor, name).getOr(defaultVal);\n    } else if (type === 'function') {\n      return getFiltered(isFunction, editor, name).getOr(defaultVal);\n    } else {\n      return value;\n    }\n  };\n\n  var CreateIconManager = function () {\n    var lookup = {};\n\n    var add = function (id, iconPack) {\n      lookup[id] = iconPack;\n    };\n\n    var get = function (id) {\n      if (lookup[id]) {\n        return lookup[id];\n      }\n\n      return {\n        icons: {}\n      };\n    };\n\n    var has$1 = function (id) {\n      return has(lookup, id);\n    };\n\n    return {\n      add: add,\n      get: get,\n      has: has$1\n    };\n  };\n\n  var IconManager = CreateIconManager();\n\n  var getProp = function (propName, elm) {\n    var rawElm = elm.dom;\n    return rawElm[propName];\n  };\n\n  var getComputedSizeProp = function (propName, elm) {\n    return parseInt(get$5(elm, propName), 10);\n  };\n\n  var getClientWidth = curry(getProp, 'clientWidth');\n  var getClientHeight = curry(getProp, 'clientHeight');\n  var getMarginTop = curry(getComputedSizeProp, 'margin-top');\n  var getMarginLeft = curry(getComputedSizeProp, 'margin-left');\n\n  var getBoundingClientRect$1 = function (elm) {\n    return elm.dom.getBoundingClientRect();\n  };\n\n  var isInsideElementContentArea = function (bodyElm, clientX, clientY) {\n    var clientWidth = getClientWidth(bodyElm);\n    var clientHeight = getClientHeight(bodyElm);\n    return clientX >= 0 && clientY >= 0 && clientX <= clientWidth && clientY <= clientHeight;\n  };\n\n  var transpose = function (inline, elm, clientX, clientY) {\n    var clientRect = getBoundingClientRect$1(elm);\n    var deltaX = inline ? clientRect.left + elm.dom.clientLeft + getMarginLeft(elm) : 0;\n    var deltaY = inline ? clientRect.top + elm.dom.clientTop + getMarginTop(elm) : 0;\n    var x = clientX - deltaX;\n    var y = clientY - deltaY;\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var isXYInContentArea = function (editor, clientX, clientY) {\n    var bodyElm = SugarElement.fromDom(editor.getBody());\n    var targetElm = editor.inline ? bodyElm : documentElement(bodyElm);\n    var transposedPoint = transpose(editor.inline, targetElm, clientX, clientY);\n    return isInsideElementContentArea(targetElm, transposedPoint.x, transposedPoint.y);\n  };\n\n  var fromDomSafe = function (node) {\n    return Optional.from(node).map(SugarElement.fromDom);\n  };\n\n  var isEditorAttachedToDom = function (editor) {\n    var rawContainer = editor.inline ? editor.getBody() : editor.getContentAreaContainer();\n    return fromDomSafe(rawContainer).map(inBody).getOr(false);\n  };\n\n  var NotificationManagerImpl = function () {\n    var unimplemented = function () {\n      throw new Error('Theme did not provide a NotificationManager implementation.');\n    };\n\n    return {\n      open: unimplemented,\n      close: unimplemented,\n      reposition: unimplemented,\n      getArgs: unimplemented\n    };\n  };\n\n  var NotificationManager = function (editor) {\n    var notifications = [];\n\n    var getImplementation = function () {\n      var theme = editor.theme;\n      return theme && theme.getNotificationManagerImpl ? theme.getNotificationManagerImpl() : NotificationManagerImpl();\n    };\n\n    var getTopNotification = function () {\n      return Optional.from(notifications[0]);\n    };\n\n    var isEqual = function (a, b) {\n      return a.type === b.type && a.text === b.text && !a.progressBar && !a.timeout && !b.progressBar && !b.timeout;\n    };\n\n    var reposition = function () {\n      if (notifications.length > 0) {\n        getImplementation().reposition(notifications);\n      }\n    };\n\n    var addNotification = function (notification) {\n      notifications.push(notification);\n    };\n\n    var closeNotification = function (notification) {\n      findIndex(notifications, function (otherNotification) {\n        return otherNotification === notification;\n      }).each(function (index) {\n        notifications.splice(index, 1);\n      });\n    };\n\n    var open = function (spec, fireEvent) {\n      if (fireEvent === void 0) {\n        fireEvent = true;\n      }\n\n      if (editor.removed || !isEditorAttachedToDom(editor)) {\n        return;\n      }\n\n      if (fireEvent) {\n        editor.fire('BeforeOpenNotification', {\n          notification: spec\n        });\n      }\n\n      return find(notifications, function (notification) {\n        return isEqual(getImplementation().getArgs(notification), spec);\n      }).getOrThunk(function () {\n        editor.editorManager.setActive(editor);\n        var notification = getImplementation().open(spec, function () {\n          closeNotification(notification);\n          reposition();\n          getTopNotification().fold(function () {\n            return editor.focus();\n          }, function (top) {\n            return focus(SugarElement.fromDom(top.getEl()));\n          });\n        });\n        addNotification(notification);\n        reposition();\n        editor.fire('OpenNotification', __assign({}, notification));\n        return notification;\n      });\n    };\n\n    var close = function () {\n      getTopNotification().each(function (notification) {\n        getImplementation().close(notification);\n        closeNotification(notification);\n        reposition();\n      });\n    };\n\n    var getNotifications = function () {\n      return notifications;\n    };\n\n    var registerEvents = function (editor) {\n      editor.on('SkinLoaded', function () {\n        var serviceMessage = getServiceMessage(editor);\n\n        if (serviceMessage) {\n          open({\n            text: serviceMessage,\n            type: 'warning',\n            timeout: 0\n          }, false);\n        }\n      });\n      editor.on('ResizeEditor ResizeWindow NodeChange', function () {\n        Delay.requestAnimationFrame(reposition);\n      });\n      editor.on('remove', function () {\n        each(notifications.slice(), function (notification) {\n          getImplementation().close(notification);\n        });\n      });\n    };\n\n    registerEvents(editor);\n    return {\n      open: open,\n      close: close,\n      getNotifications: getNotifications\n    };\n  };\n\n  var PluginManager = AddOnManager.PluginManager;\n  var ThemeManager = AddOnManager.ThemeManager;\n\n  function WindowManagerImpl() {\n    var unimplemented = function () {\n      throw new Error('Theme did not provide a WindowManager implementation.');\n    };\n\n    return {\n      open: unimplemented,\n      openUrl: unimplemented,\n      alert: unimplemented,\n      confirm: unimplemented,\n      close: unimplemented,\n      getParams: unimplemented,\n      setParams: unimplemented\n    };\n  }\n\n  var WindowManager = function (editor) {\n    var dialogs = [];\n\n    var getImplementation = function () {\n      var theme = editor.theme;\n      return theme && theme.getWindowManagerImpl ? theme.getWindowManagerImpl() : WindowManagerImpl();\n    };\n\n    var funcBind = function (scope, f) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return f ? f.apply(scope, args) : undefined;\n      };\n    };\n\n    var fireOpenEvent = function (dialog) {\n      editor.fire('OpenWindow', {\n        dialog: dialog\n      });\n    };\n\n    var fireCloseEvent = function (dialog) {\n      editor.fire('CloseWindow', {\n        dialog: dialog\n      });\n    };\n\n    var addDialog = function (dialog) {\n      dialogs.push(dialog);\n      fireOpenEvent(dialog);\n    };\n\n    var closeDialog = function (dialog) {\n      fireCloseEvent(dialog);\n      dialogs = filter(dialogs, function (otherDialog) {\n        return otherDialog !== dialog;\n      });\n\n      if (dialogs.length === 0) {\n        editor.focus();\n      }\n    };\n\n    var getTopDialog = function () {\n      return Optional.from(dialogs[dialogs.length - 1]);\n    };\n\n    var storeSelectionAndOpenDialog = function (openDialog) {\n      editor.editorManager.setActive(editor);\n      store(editor);\n      var dialog = openDialog();\n      addDialog(dialog);\n      return dialog;\n    };\n\n    var open = function (args, params) {\n      return storeSelectionAndOpenDialog(function () {\n        return getImplementation().open(args, params, closeDialog);\n      });\n    };\n\n    var openUrl = function (args) {\n      return storeSelectionAndOpenDialog(function () {\n        return getImplementation().openUrl(args, closeDialog);\n      });\n    };\n\n    var alert = function (message, callback, scope) {\n      var windowManagerImpl = getImplementation();\n      windowManagerImpl.alert(message, funcBind(scope ? scope : windowManagerImpl, callback));\n    };\n\n    var confirm = function (message, callback, scope) {\n      var windowManagerImpl = getImplementation();\n      windowManagerImpl.confirm(message, funcBind(scope ? scope : windowManagerImpl, callback));\n    };\n\n    var close = function () {\n      getTopDialog().each(function (dialog) {\n        getImplementation().close(dialog);\n        closeDialog(dialog);\n      });\n    };\n\n    editor.on('remove', function () {\n      each(dialogs, function (dialog) {\n        getImplementation().close(dialog);\n      });\n    });\n    return {\n      open: open,\n      openUrl: openUrl,\n      alert: alert,\n      confirm: confirm,\n      close: close\n    };\n  };\n\n  var displayNotification = function (editor, message) {\n    editor.notificationManager.open({\n      type: 'error',\n      text: message\n    });\n  };\n\n  var displayError = function (editor, message) {\n    if (editor._skinLoaded) {\n      displayNotification(editor, message);\n    } else {\n      editor.on('SkinLoaded', function () {\n        displayNotification(editor, message);\n      });\n    }\n  };\n\n  var uploadError = function (editor, message) {\n    displayError(editor, I18n.translate(['Failed to upload image: {0}', message]));\n  };\n\n  var logError = function (editor, errorType, msg) {\n    fireError(editor, errorType, {\n      message: msg\n    });\n    console.error(msg);\n  };\n\n  var createLoadError = function (type, url, name) {\n    return name ? 'Failed to load ' + type + ': ' + name + ' from url ' + url : 'Failed to load ' + type + ' url: ' + url;\n  };\n\n  var pluginLoadError = function (editor, url, name) {\n    logError(editor, 'PluginLoadError', createLoadError('plugin', url, name));\n  };\n\n  var iconsLoadError = function (editor, url, name) {\n    logError(editor, 'IconsLoadError', createLoadError('icons', url, name));\n  };\n\n  var languageLoadError = function (editor, url, name) {\n    logError(editor, 'LanguageLoadError', createLoadError('language', url, name));\n  };\n\n  var pluginInitError = function (editor, name, err) {\n    var message = I18n.translate(['Failed to initialize plugin: {0}', name]);\n    fireError(editor, 'PluginLoadError', {\n      message: message\n    });\n    initError(message, err);\n    displayError(editor, message);\n  };\n\n  var initError = function (message) {\n    var x = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      x[_i - 1] = arguments[_i];\n    }\n\n    var console = window.console;\n\n    if (console) {\n      if (console.error) {\n        console.error.apply(console, __spreadArrays([message], x));\n      } else {\n        console.log.apply(console, __spreadArrays([message], x));\n      }\n    }\n  };\n\n  var isContentCssSkinName = function (url) {\n    return /^[a-z0-9\\-]+$/i.test(url);\n  };\n\n  var getContentCssUrls = function (editor) {\n    return transformToUrls(editor, getContentCss(editor));\n  };\n\n  var getFontCssUrls = function (editor) {\n    return transformToUrls(editor, getFontCss(editor));\n  };\n\n  var transformToUrls = function (editor, cssLinks) {\n    var skinUrl = editor.editorManager.baseURL + '/skins/content';\n    var suffix = editor.editorManager.suffix;\n    var contentCssFile = 'content' + suffix + '.css';\n    var inline = editor.inline === true;\n    return map(cssLinks, function (url) {\n      if (isContentCssSkinName(url) && !inline) {\n        return skinUrl + '/' + url + '/' + contentCssFile;\n      } else {\n        return editor.documentBaseURI.toAbsolute(url);\n      }\n    });\n  };\n\n  var appendContentCssFromSettings = function (editor) {\n    editor.contentCSS = editor.contentCSS.concat(getContentCssUrls(editor), getFontCssUrls(editor));\n  };\n\n  var UploadStatus = function () {\n    var PENDING = 1,\n        UPLOADED = 2;\n    var blobUriStatuses = {};\n\n    var createStatus = function (status, resultUri) {\n      return {\n        status: status,\n        resultUri: resultUri\n      };\n    };\n\n    var hasBlobUri = function (blobUri) {\n      return blobUri in blobUriStatuses;\n    };\n\n    var getResultUri = function (blobUri) {\n      var result = blobUriStatuses[blobUri];\n      return result ? result.resultUri : null;\n    };\n\n    var isPending = function (blobUri) {\n      return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === PENDING : false;\n    };\n\n    var isUploaded = function (blobUri) {\n      return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === UPLOADED : false;\n    };\n\n    var markPending = function (blobUri) {\n      blobUriStatuses[blobUri] = createStatus(PENDING, null);\n    };\n\n    var markUploaded = function (blobUri, resultUri) {\n      blobUriStatuses[blobUri] = createStatus(UPLOADED, resultUri);\n    };\n\n    var removeFailed = function (blobUri) {\n      delete blobUriStatuses[blobUri];\n    };\n\n    var destroy = function () {\n      blobUriStatuses = {};\n    };\n\n    return {\n      hasBlobUri: hasBlobUri,\n      getResultUri: getResultUri,\n      isPending: isPending,\n      isUploaded: isUploaded,\n      markPending: markPending,\n      markUploaded: markUploaded,\n      removeFailed: removeFailed,\n      destroy: destroy\n    };\n  };\n\n  var count$1 = 0;\n\n  var seed = function () {\n    var rnd = function () {\n      return Math.round(Math.random() * 4294967295).toString(36);\n    };\n\n    var now = new Date().getTime();\n    return 's' + now.toString(36) + rnd() + rnd() + rnd();\n  };\n\n  var uuid = function (prefix) {\n    return prefix + count$1++ + seed();\n  };\n\n  var BlobCache = function () {\n    var cache = [];\n\n    var mimeToExt = function (mime) {\n      var mimes = {\n        'image/jpeg': 'jpg',\n        'image/jpg': 'jpg',\n        'image/gif': 'gif',\n        'image/png': 'png',\n        'image/apng': 'apng',\n        'image/avif': 'avif',\n        'image/svg+xml': 'svg',\n        'image/webp': 'webp',\n        'image/bmp': 'bmp',\n        'image/tiff': 'tiff'\n      };\n      return mimes[mime.toLowerCase()] || 'dat';\n    };\n\n    var create = function (o, blob, base64, name, filename) {\n      if (isString(o)) {\n        var id = o;\n        return toBlobInfo({\n          id: id,\n          name: name,\n          filename: filename,\n          blob: blob,\n          base64: base64\n        });\n      } else if (isObject(o)) {\n        return toBlobInfo(o);\n      } else {\n        throw new Error('Unknown input type');\n      }\n    };\n\n    var toBlobInfo = function (o) {\n      if (!o.blob || !o.base64) {\n        throw new Error('blob and base64 representations of the image are required for BlobInfo to be created');\n      }\n\n      var id = o.id || uuid('blobid');\n      var name = o.name || id;\n      var blob = o.blob;\n      return {\n        id: constant(id),\n        name: constant(name),\n        filename: constant(o.filename || name + '.' + mimeToExt(blob.type)),\n        blob: constant(blob),\n        base64: constant(o.base64),\n        blobUri: constant(o.blobUri || URL.createObjectURL(blob)),\n        uri: constant(o.uri)\n      };\n    };\n\n    var add = function (blobInfo) {\n      if (!get(blobInfo.id())) {\n        cache.push(blobInfo);\n      }\n    };\n\n    var findFirst = function (predicate) {\n      return find(cache, predicate).getOrUndefined();\n    };\n\n    var get = function (id) {\n      return findFirst(function (cachedBlobInfo) {\n        return cachedBlobInfo.id() === id;\n      });\n    };\n\n    var getByUri = function (blobUri) {\n      return findFirst(function (blobInfo) {\n        return blobInfo.blobUri() === blobUri;\n      });\n    };\n\n    var getByData = function (base64, type) {\n      return findFirst(function (blobInfo) {\n        return blobInfo.base64() === base64 && blobInfo.blob().type === type;\n      });\n    };\n\n    var removeByUri = function (blobUri) {\n      cache = filter(cache, function (blobInfo) {\n        if (blobInfo.blobUri() === blobUri) {\n          URL.revokeObjectURL(blobInfo.blobUri());\n          return false;\n        }\n\n        return true;\n      });\n    };\n\n    var destroy = function () {\n      each(cache, function (cachedBlobInfo) {\n        URL.revokeObjectURL(cachedBlobInfo.blobUri());\n      });\n      cache = [];\n    };\n\n    return {\n      create: create,\n      add: add,\n      get: get,\n      getByUri: getByUri,\n      getByData: getByData,\n      findFirst: findFirst,\n      removeByUri: removeByUri,\n      destroy: destroy\n    };\n  };\n\n  var Uploader = function (uploadStatus, settings) {\n    var pendingPromises = {};\n\n    var pathJoin = function (path1, path2) {\n      if (path1) {\n        return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n      }\n\n      return path2;\n    };\n\n    var defaultHandler = function (blobInfo, success, failure, progress) {\n      var xhr = new XMLHttpRequest();\n      xhr.open('POST', settings.url);\n      xhr.withCredentials = settings.credentials;\n\n      xhr.upload.onprogress = function (e) {\n        progress(e.loaded / e.total * 100);\n      };\n\n      xhr.onerror = function () {\n        failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n      };\n\n      xhr.onload = function () {\n        if (xhr.status < 200 || xhr.status >= 300) {\n          failure('HTTP Error: ' + xhr.status);\n          return;\n        }\n\n        var json = JSON.parse(xhr.responseText);\n\n        if (!json || typeof json.location !== 'string') {\n          failure('Invalid JSON: ' + xhr.responseText);\n          return;\n        }\n\n        success(pathJoin(settings.basePath, json.location));\n      };\n\n      var formData = new FormData();\n      formData.append('file', blobInfo.blob(), blobInfo.filename());\n      xhr.send(formData);\n    };\n\n    var noUpload = function () {\n      return new promiseObj(function (resolve) {\n        resolve([]);\n      });\n    };\n\n    var handlerSuccess = function (blobInfo, url) {\n      return {\n        url: url,\n        blobInfo: blobInfo,\n        status: true\n      };\n    };\n\n    var handlerFailure = function (blobInfo, message, options) {\n      return {\n        url: '',\n        blobInfo: blobInfo,\n        status: false,\n        error: {\n          message: message,\n          options: options\n        }\n      };\n    };\n\n    var resolvePending = function (blobUri, result) {\n      Tools.each(pendingPromises[blobUri], function (resolve) {\n        resolve(result);\n      });\n      delete pendingPromises[blobUri];\n    };\n\n    var uploadBlobInfo = function (blobInfo, handler, openNotification) {\n      uploadStatus.markPending(blobInfo.blobUri());\n      return new promiseObj(function (resolve) {\n        var notification, progress;\n\n        try {\n          var closeNotification_1 = function () {\n            if (notification) {\n              notification.close();\n              progress = noop;\n            }\n          };\n\n          var success = function (url) {\n            closeNotification_1();\n            uploadStatus.markUploaded(blobInfo.blobUri(), url);\n            resolvePending(blobInfo.blobUri(), handlerSuccess(blobInfo, url));\n            resolve(handlerSuccess(blobInfo, url));\n          };\n\n          var failure = function (error, options) {\n            var failureOptions = options ? options : {};\n            closeNotification_1();\n            uploadStatus.removeFailed(blobInfo.blobUri());\n            resolvePending(blobInfo.blobUri(), handlerFailure(blobInfo, error, failureOptions));\n            resolve(handlerFailure(blobInfo, error, failureOptions));\n          };\n\n          progress = function (percent) {\n            if (percent < 0 || percent > 100) {\n              return;\n            }\n\n            Optional.from(notification).orThunk(function () {\n              return Optional.from(openNotification).map(apply);\n            }).each(function (n) {\n              notification = n;\n              n.progressBar.value(percent);\n            });\n          };\n\n          handler(blobInfo, success, failure, progress);\n        } catch (ex) {\n          resolve(handlerFailure(blobInfo, ex.message, {}));\n        }\n      });\n    };\n\n    var isDefaultHandler = function (handler) {\n      return handler === defaultHandler;\n    };\n\n    var pendingUploadBlobInfo = function (blobInfo) {\n      var blobUri = blobInfo.blobUri();\n      return new promiseObj(function (resolve) {\n        pendingPromises[blobUri] = pendingPromises[blobUri] || [];\n        pendingPromises[blobUri].push(resolve);\n      });\n    };\n\n    var uploadBlobs = function (blobInfos, openNotification) {\n      blobInfos = Tools.grep(blobInfos, function (blobInfo) {\n        return !uploadStatus.isUploaded(blobInfo.blobUri());\n      });\n      return promiseObj.all(Tools.map(blobInfos, function (blobInfo) {\n        return uploadStatus.isPending(blobInfo.blobUri()) ? pendingUploadBlobInfo(blobInfo) : uploadBlobInfo(blobInfo, settings.handler, openNotification);\n      }));\n    };\n\n    var upload = function (blobInfos, openNotification) {\n      return !settings.url && isDefaultHandler(settings.handler) ? noUpload() : uploadBlobs(blobInfos, openNotification);\n    };\n\n    if (isFunction(settings.handler) === false) {\n      settings.handler = defaultHandler;\n    }\n\n    return {\n      upload: upload\n    };\n  };\n\n  var openNotification = function (editor) {\n    return function () {\n      return editor.notificationManager.open({\n        text: editor.translate('Image uploading...'),\n        type: 'info',\n        timeout: -1,\n        progressBar: true\n      });\n    };\n  };\n\n  var createUploader = function (editor, uploadStatus) {\n    return Uploader(uploadStatus, {\n      url: getImageUploadUrl(editor),\n      basePath: getImageUploadBasePath(editor),\n      credentials: getImagesUploadCredentials(editor),\n      handler: getImagesUploadHandler(editor)\n    });\n  };\n\n  var ImageUploader = function (editor) {\n    var uploadStatus = UploadStatus();\n    var uploader = createUploader(editor, uploadStatus);\n    return {\n      upload: function (blobInfos, showNotification) {\n        if (showNotification === void 0) {\n          showNotification = true;\n        }\n\n        return uploader.upload(blobInfos, showNotification ? openNotification(editor) : undefined);\n      }\n    };\n  };\n\n  var UploadChangeHandler = function (editor) {\n    var lastChangedLevel = Cell(null);\n    editor.on('change AddUndo', function (e) {\n      lastChangedLevel.set(__assign({}, e.level));\n    });\n\n    var fireIfChanged = function () {\n      var data = editor.undoManager.data;\n      last(data).filter(function (level) {\n        return !isEq$4(lastChangedLevel.get(), level);\n      }).each(function (level) {\n        editor.setDirty(true);\n        editor.fire('change', {\n          level: level,\n          lastLevel: get(data, data.length - 2).getOrNull()\n        });\n      });\n    };\n\n    return {\n      fireIfChanged: fireIfChanged\n    };\n  };\n\n  var EditorUpload = function (editor) {\n    var blobCache = BlobCache();\n    var uploader, imageScanner;\n    var uploadStatus = UploadStatus();\n    var urlFilters = [];\n    var changeHandler = UploadChangeHandler(editor);\n\n    var aliveGuard = function (callback) {\n      return function (result) {\n        if (editor.selection) {\n          return callback(result);\n        }\n\n        return [];\n      };\n    };\n\n    var cacheInvalidator = function (url) {\n      return url + (url.indexOf('?') === -1 ? '?' : '&') + new Date().getTime();\n    };\n\n    var replaceString = function (content, search, replace) {\n      var index = 0;\n\n      do {\n        index = content.indexOf(search, index);\n\n        if (index !== -1) {\n          content = content.substring(0, index) + replace + content.substr(index + search.length);\n          index += replace.length - search.length + 1;\n        }\n      } while (index !== -1);\n\n      return content;\n    };\n\n    var replaceImageUrl = function (content, targetUrl, replacementUrl) {\n      var replacementString = 'src=\"' + replacementUrl + '\"' + (replacementUrl === Env.transparentSrc ? ' data-mce-placeholder=\"1\"' : '');\n      content = replaceString(content, 'src=\"' + targetUrl + '\"', replacementString);\n      content = replaceString(content, 'data-mce-src=\"' + targetUrl + '\"', 'data-mce-src=\"' + replacementUrl + '\"');\n      return content;\n    };\n\n    var replaceUrlInUndoStack = function (targetUrl, replacementUrl) {\n      each(editor.undoManager.data, function (level) {\n        if (level.type === 'fragmented') {\n          level.fragments = map(level.fragments, function (fragment) {\n            return replaceImageUrl(fragment, targetUrl, replacementUrl);\n          });\n        } else {\n          level.content = replaceImageUrl(level.content, targetUrl, replacementUrl);\n        }\n      });\n    };\n\n    var replaceImageUriInView = function (image, resultUri) {\n      var src = editor.convertURL(resultUri, 'src');\n      replaceUrlInUndoStack(image.src, resultUri);\n      editor.$(image).attr({\n        'src': shouldReuseFileName(editor) ? cacheInvalidator(resultUri) : resultUri,\n        'data-mce-src': src\n      });\n    };\n\n    var uploadImages = function (callback) {\n      if (!uploader) {\n        uploader = createUploader(editor, uploadStatus);\n      }\n\n      return scanForImages().then(aliveGuard(function (imageInfos) {\n        var blobInfos = map(imageInfos, function (imageInfo) {\n          return imageInfo.blobInfo;\n        });\n        return uploader.upload(blobInfos, openNotification(editor)).then(aliveGuard(function (result) {\n          var imagesToRemove = [];\n          var filteredResult = map(result, function (uploadInfo, index) {\n            var blobInfo = imageInfos[index].blobInfo;\n            var image = imageInfos[index].image;\n\n            if (uploadInfo.status && shouldReplaceBlobUris(editor)) {\n              blobCache.removeByUri(image.src);\n              replaceImageUriInView(image, uploadInfo.url);\n            } else if (uploadInfo.error) {\n              if (uploadInfo.error.options.remove) {\n                replaceUrlInUndoStack(image.getAttribute('src'), Env.transparentSrc);\n                imagesToRemove.push(image);\n              }\n\n              uploadError(editor, uploadInfo.error.message);\n            }\n\n            return {\n              element: image,\n              status: uploadInfo.status,\n              uploadUri: uploadInfo.url,\n              blobInfo: blobInfo\n            };\n          });\n\n          if (filteredResult.length > 0) {\n            changeHandler.fireIfChanged();\n          }\n\n          if (imagesToRemove.length > 0) {\n            if (isRtc(editor)) {\n              console.error('Removing images on failed uploads is currently unsupported for RTC');\n            } else {\n              editor.undoManager.transact(function () {\n                each(imagesToRemove, function (element) {\n                  editor.dom.remove(element);\n                  blobCache.removeByUri(element.src);\n                });\n              });\n            }\n          }\n\n          if (callback) {\n            callback(filteredResult);\n          }\n\n          return filteredResult;\n        }));\n      }));\n    };\n\n    var uploadImagesAuto = function (callback) {\n      if (isAutomaticUploadsEnabled(editor)) {\n        return uploadImages(callback);\n      }\n    };\n\n    var isValidDataUriImage = function (imgElm) {\n      if (forall(urlFilters, function (filter) {\n        return filter(imgElm);\n      }) === false) {\n        return false;\n      }\n\n      if (imgElm.getAttribute('src').indexOf('data:') === 0) {\n        var dataImgFilter = getImagesDataImgFilter(editor);\n        return dataImgFilter(imgElm);\n      }\n\n      return true;\n    };\n\n    var addFilter = function (filter) {\n      urlFilters.push(filter);\n    };\n\n    var scanForImages = function () {\n      if (!imageScanner) {\n        imageScanner = ImageScanner(uploadStatus, blobCache);\n      }\n\n      return imageScanner.findAll(editor.getBody(), isValidDataUriImage).then(aliveGuard(function (result) {\n        result = filter(result, function (resultItem) {\n          if (typeof resultItem === 'string') {\n            displayError(editor, resultItem);\n            return false;\n          }\n\n          return true;\n        });\n        each(result, function (resultItem) {\n          replaceUrlInUndoStack(resultItem.image.src, resultItem.blobInfo.blobUri());\n          resultItem.image.src = resultItem.blobInfo.blobUri();\n          resultItem.image.removeAttribute('data-mce-src');\n        });\n        return result;\n      }));\n    };\n\n    var destroy = function () {\n      blobCache.destroy();\n      uploadStatus.destroy();\n      imageScanner = uploader = null;\n    };\n\n    var replaceBlobUris = function (content) {\n      return content.replace(/src=\"(blob:[^\"]+)\"/g, function (match, blobUri) {\n        var resultUri = uploadStatus.getResultUri(blobUri);\n\n        if (resultUri) {\n          return 'src=\"' + resultUri + '\"';\n        }\n\n        var blobInfo = blobCache.getByUri(blobUri);\n\n        if (!blobInfo) {\n          blobInfo = foldl(editor.editorManager.get(), function (result, editor) {\n            return result || editor.editorUpload && editor.editorUpload.blobCache.getByUri(blobUri);\n          }, null);\n        }\n\n        if (blobInfo) {\n          var blob = blobInfo.blob();\n          return 'src=\"data:' + blob.type + ';base64,' + blobInfo.base64() + '\"';\n        }\n\n        return match;\n      });\n    };\n\n    editor.on('SetContent', function () {\n      if (isAutomaticUploadsEnabled(editor)) {\n        uploadImagesAuto();\n      } else {\n        scanForImages();\n      }\n    });\n    editor.on('RawSaveContent', function (e) {\n      e.content = replaceBlobUris(e.content);\n    });\n    editor.on('GetContent', function (e) {\n      if (e.source_view || e.format === 'raw' || e.format === 'tree') {\n        return;\n      }\n\n      e.content = replaceBlobUris(e.content);\n    });\n    editor.on('PostRender', function () {\n      editor.parser.addNodeFilter('img', function (images) {\n        each(images, function (img) {\n          var src = img.attr('src');\n\n          if (blobCache.getByUri(src)) {\n            return;\n          }\n\n          var resultUri = uploadStatus.getResultUri(src);\n\n          if (resultUri) {\n            img.attr('src', resultUri);\n          }\n        });\n      });\n    });\n    return {\n      blobCache: blobCache,\n      addFilter: addFilter,\n      uploadImages: uploadImages,\n      uploadImagesAuto: uploadImagesAuto,\n      scanForImages: scanForImages,\n      destroy: destroy\n    };\n  };\n\n  var get$a = function (dom) {\n    var formats = {\n      valigntop: [{\n        selector: 'td,th',\n        styles: {\n          verticalAlign: 'top'\n        }\n      }],\n      valignmiddle: [{\n        selector: 'td,th',\n        styles: {\n          verticalAlign: 'middle'\n        }\n      }],\n      valignbottom: [{\n        selector: 'td,th',\n        styles: {\n          verticalAlign: 'bottom'\n        }\n      }],\n      alignleft: [{\n        selector: 'figure.image',\n        collapsed: false,\n        classes: 'align-left',\n        ceFalseOverride: true,\n        preview: 'font-family font-size'\n      }, {\n        selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n        styles: {\n          textAlign: 'left'\n        },\n        inherit: false,\n        preview: false,\n        defaultBlock: 'div'\n      }, {\n        selector: 'img,table',\n        collapsed: false,\n        styles: {\n          float: 'left'\n        },\n        preview: 'font-family font-size'\n      }],\n      aligncenter: [{\n        selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n        styles: {\n          textAlign: 'center'\n        },\n        inherit: false,\n        preview: 'font-family font-size',\n        defaultBlock: 'div'\n      }, {\n        selector: 'figure.image',\n        collapsed: false,\n        classes: 'align-center',\n        ceFalseOverride: true,\n        preview: 'font-family font-size'\n      }, {\n        selector: 'img',\n        collapsed: false,\n        styles: {\n          display: 'block',\n          marginLeft: 'auto',\n          marginRight: 'auto'\n        },\n        preview: false\n      }, {\n        selector: 'table',\n        collapsed: false,\n        styles: {\n          marginLeft: 'auto',\n          marginRight: 'auto'\n        },\n        preview: 'font-family font-size'\n      }],\n      alignright: [{\n        selector: 'figure.image',\n        collapsed: false,\n        classes: 'align-right',\n        ceFalseOverride: true,\n        preview: 'font-family font-size'\n      }, {\n        selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n        styles: {\n          textAlign: 'right'\n        },\n        inherit: false,\n        preview: 'font-family font-size',\n        defaultBlock: 'div'\n      }, {\n        selector: 'img,table',\n        collapsed: false,\n        styles: {\n          float: 'right'\n        },\n        preview: 'font-family font-size'\n      }],\n      alignjustify: [{\n        selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n        styles: {\n          textAlign: 'justify'\n        },\n        inherit: false,\n        defaultBlock: 'div',\n        preview: 'font-family font-size'\n      }],\n      bold: [{\n        inline: 'strong',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }, {\n        inline: 'span',\n        styles: {\n          fontWeight: 'bold'\n        }\n      }, {\n        inline: 'b',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }],\n      italic: [{\n        inline: 'em',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }, {\n        inline: 'span',\n        styles: {\n          fontStyle: 'italic'\n        }\n      }, {\n        inline: 'i',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }],\n      underline: [{\n        inline: 'span',\n        styles: {\n          textDecoration: 'underline'\n        },\n        exact: true\n      }, {\n        inline: 'u',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }],\n      strikethrough: [{\n        inline: 'span',\n        styles: {\n          textDecoration: 'line-through'\n        },\n        exact: true\n      }, {\n        inline: 'strike',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }, {\n        inline: 's',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }],\n      forecolor: {\n        inline: 'span',\n        styles: {\n          color: '%value'\n        },\n        links: true,\n        remove_similar: true,\n        clear_child_styles: true\n      },\n      hilitecolor: {\n        inline: 'span',\n        styles: {\n          backgroundColor: '%value'\n        },\n        links: true,\n        remove_similar: true,\n        clear_child_styles: true\n      },\n      fontname: {\n        inline: 'span',\n        toggle: false,\n        styles: {\n          fontFamily: '%value'\n        },\n        clear_child_styles: true\n      },\n      fontsize: {\n        inline: 'span',\n        toggle: false,\n        styles: {\n          fontSize: '%value'\n        },\n        clear_child_styles: true\n      },\n      lineheight: {\n        selector: 'h1,h2,h3,h4,h5,h6,p,li,td,th,div',\n        defaultBlock: 'p',\n        styles: {\n          lineHeight: '%value'\n        }\n      },\n      fontsize_class: {\n        inline: 'span',\n        attributes: {\n          class: '%value'\n        }\n      },\n      blockquote: {\n        block: 'blockquote',\n        wrapper: true,\n        remove: 'all'\n      },\n      subscript: {\n        inline: 'sub'\n      },\n      superscript: {\n        inline: 'sup'\n      },\n      code: {\n        inline: 'code'\n      },\n      link: {\n        inline: 'a',\n        selector: 'a',\n        remove: 'all',\n        split: true,\n        deep: true,\n        onmatch: function (node, _fmt, _itemName) {\n          return isElement$1(node) && node.hasAttribute('href');\n        },\n        onformat: function (elm, _fmt, vars) {\n          Tools.each(vars, function (value, key) {\n            dom.setAttrib(elm, key, value);\n          });\n        }\n      },\n      removeformat: [{\n        selector: 'b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins',\n        remove: 'all',\n        split: true,\n        expand: false,\n        block_expand: true,\n        deep: true\n      }, {\n        selector: 'span',\n        attributes: ['style', 'class'],\n        remove: 'empty',\n        split: true,\n        expand: false,\n        deep: true\n      }, {\n        selector: '*',\n        attributes: ['style', 'class'],\n        split: false,\n        expand: false,\n        deep: true\n      }]\n    };\n    Tools.each('p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp'.split(/\\s/), function (name) {\n      formats[name] = {\n        block: name,\n        remove: 'all'\n      };\n    });\n    return formats;\n  };\n\n  var FormatRegistry = function (editor) {\n    var formats = {};\n\n    var get = function (name) {\n      return name ? formats[name] : formats;\n    };\n\n    var has$1 = function (name) {\n      return has(formats, name);\n    };\n\n    var register = function (name, format) {\n      if (name) {\n        if (typeof name !== 'string') {\n          Tools.each(name, function (format, name) {\n            register(name, format);\n          });\n        } else {\n          if (!isArray(format)) {\n            format = [format];\n          }\n\n          Tools.each(format, function (format) {\n            if (typeof format.deep === 'undefined') {\n              format.deep = !format.selector;\n            }\n\n            if (typeof format.split === 'undefined') {\n              format.split = !format.selector || format.inline;\n            }\n\n            if (typeof format.remove === 'undefined' && format.selector && !format.inline) {\n              format.remove = 'none';\n            }\n\n            if (format.selector && format.inline) {\n              format.mixed = true;\n              format.block_expand = true;\n            }\n\n            if (typeof format.classes === 'string') {\n              format.classes = format.classes.split(/\\s+/);\n            }\n          });\n          formats[name] = format;\n        }\n      }\n    };\n\n    var unregister = function (name) {\n      if (name && formats[name]) {\n        delete formats[name];\n      }\n\n      return formats;\n    };\n\n    register(get$a(editor.dom));\n    register(getFormats(editor));\n    return {\n      get: get,\n      has: has$1,\n      register: register,\n      unregister: unregister\n    };\n  };\n\n  var each$e = Tools.each;\n  var dom = DOMUtils.DOM;\n\n  var parsedSelectorToHtml = function (ancestry, editor) {\n    var elm, item, fragment;\n    var schema = editor && editor.schema || Schema({});\n\n    var decorate = function (elm, item) {\n      if (item.classes.length) {\n        dom.addClass(elm, item.classes.join(' '));\n      }\n\n      dom.setAttribs(elm, item.attrs);\n    };\n\n    var createElement = function (sItem) {\n      item = typeof sItem === 'string' ? {\n        name: sItem,\n        classes: [],\n        attrs: {}\n      } : sItem;\n      var elm = dom.create(item.name);\n      decorate(elm, item);\n      return elm;\n    };\n\n    var getRequiredParent = function (elm, candidate) {\n      var name = typeof elm !== 'string' ? elm.nodeName.toLowerCase() : elm;\n      var elmRule = schema.getElementRule(name);\n      var parentsRequired = elmRule && elmRule.parentsRequired;\n\n      if (parentsRequired && parentsRequired.length) {\n        return candidate && Tools.inArray(parentsRequired, candidate) !== -1 ? candidate : parentsRequired[0];\n      } else {\n        return false;\n      }\n    };\n\n    var wrapInHtml = function (elm, ancestry, siblings) {\n      var parent, parentCandidate;\n      var ancestor = ancestry.length > 0 && ancestry[0];\n      var ancestorName = ancestor && ancestor.name;\n      var parentRequired = getRequiredParent(elm, ancestorName);\n\n      if (parentRequired) {\n        if (ancestorName === parentRequired) {\n          parentCandidate = ancestry[0];\n          ancestry = ancestry.slice(1);\n        } else {\n          parentCandidate = parentRequired;\n        }\n      } else if (ancestor) {\n        parentCandidate = ancestry[0];\n        ancestry = ancestry.slice(1);\n      } else if (!siblings) {\n        return elm;\n      }\n\n      if (parentCandidate) {\n        parent = createElement(parentCandidate);\n        parent.appendChild(elm);\n      }\n\n      if (siblings) {\n        if (!parent) {\n          parent = dom.create('div');\n          parent.appendChild(elm);\n        }\n\n        Tools.each(siblings, function (sibling) {\n          var siblingElm = createElement(sibling);\n          parent.insertBefore(siblingElm, elm);\n        });\n      }\n\n      return wrapInHtml(parent, ancestry, parentCandidate && parentCandidate.siblings);\n    };\n\n    if (ancestry && ancestry.length) {\n      item = ancestry[0];\n      elm = createElement(item);\n      fragment = dom.create('div');\n      fragment.appendChild(wrapInHtml(elm, ancestry.slice(1), item.siblings));\n      return fragment;\n    } else {\n      return '';\n    }\n  };\n\n  var parseSelectorItem = function (item) {\n    var tagName;\n    var obj = {\n      classes: [],\n      attrs: {}\n    };\n    item = obj.selector = Tools.trim(item);\n\n    if (item !== '*') {\n      tagName = item.replace(/(?:([#\\.]|::?)([\\w\\-]+)|(\\[)([^\\]]+)\\]?)/g, function ($0, $1, $2, $3, $4) {\n        switch ($1) {\n          case '#':\n            obj.attrs.id = $2;\n            break;\n\n          case '.':\n            obj.classes.push($2);\n            break;\n\n          case ':':\n            if (Tools.inArray('checked disabled enabled read-only required'.split(' '), $2) !== -1) {\n              obj.attrs[$2] = $2;\n            }\n\n            break;\n        }\n\n        if ($3 === '[') {\n          var m = $4.match(/([\\w\\-]+)(?:\\=\\\"([^\\\"]+))?/);\n\n          if (m) {\n            obj.attrs[m[1]] = m[2];\n          }\n        }\n\n        return '';\n      });\n    }\n\n    obj.name = tagName || 'div';\n    return obj;\n  };\n\n  var parseSelector = function (selector) {\n    if (!selector || typeof selector !== 'string') {\n      return [];\n    }\n\n    selector = selector.split(/\\s*,\\s*/)[0];\n    selector = selector.replace(/\\s*(~\\+|~|\\+|>)\\s*/g, '$1');\n    return Tools.map(selector.split(/(?:>|\\s+(?![^\\[\\]]+\\]))/), function (item) {\n      var siblings = Tools.map(item.split(/(?:~\\+|~|\\+)/), parseSelectorItem);\n      var obj = siblings.pop();\n\n      if (siblings.length) {\n        obj.siblings = siblings;\n      }\n\n      return obj;\n    }).reverse();\n  };\n\n  var getCssText = function (editor, format) {\n    var name, previewFrag;\n    var previewCss = '',\n        parentFontSize;\n    var previewStyles = getPreviewStyles(editor);\n\n    if (previewStyles === '') {\n      return '';\n    }\n\n    var removeVars = function (val) {\n      return val.replace(/%(\\w+)/g, '');\n    };\n\n    if (typeof format === 'string') {\n      format = editor.formatter.get(format);\n\n      if (!format) {\n        return;\n      }\n\n      format = format[0];\n    }\n\n    if ('preview' in format) {\n      var previewOpt = get$1(format, 'preview');\n\n      if (previewOpt.is(false)) {\n        return '';\n      } else {\n        previewStyles = previewOpt.getOr(previewStyles);\n      }\n    }\n\n    name = format.block || format.inline || 'span';\n    var items = parseSelector(format.selector);\n\n    if (items.length) {\n      if (!items[0].name) {\n        items[0].name = name;\n      }\n\n      name = format.selector;\n      previewFrag = parsedSelectorToHtml(items, editor);\n    } else {\n      previewFrag = parsedSelectorToHtml([name], editor);\n    }\n\n    var previewElm = dom.select(name, previewFrag)[0] || previewFrag.firstChild;\n    each$e(format.styles, function (value, name) {\n      var newValue = removeVars(value);\n\n      if (newValue) {\n        dom.setStyle(previewElm, name, newValue);\n      }\n    });\n    each$e(format.attributes, function (value, name) {\n      var newValue = removeVars(value);\n\n      if (newValue) {\n        dom.setAttrib(previewElm, name, newValue);\n      }\n    });\n    each$e(format.classes, function (value) {\n      var newValue = removeVars(value);\n\n      if (!dom.hasClass(previewElm, newValue)) {\n        dom.addClass(previewElm, newValue);\n      }\n    });\n    editor.fire('PreviewFormats');\n    dom.setStyles(previewFrag, {\n      position: 'absolute',\n      left: -65535\n    });\n    editor.getBody().appendChild(previewFrag);\n    parentFontSize = dom.getStyle(editor.getBody(), 'fontSize', true);\n    parentFontSize = /px$/.test(parentFontSize) ? parseInt(parentFontSize, 10) : 0;\n    each$e(previewStyles.split(' '), function (name) {\n      var value = dom.getStyle(previewElm, name, true);\n\n      if (name === 'background-color' && /transparent|rgba\\s*\\([^)]+,\\s*0\\)/.test(value)) {\n        value = dom.getStyle(editor.getBody(), name, true);\n\n        if (dom.toHex(value).toLowerCase() === '#ffffff') {\n          return;\n        }\n      }\n\n      if (name === 'color') {\n        if (dom.toHex(value).toLowerCase() === '#000000') {\n          return;\n        }\n      }\n\n      if (name === 'font-size') {\n        if (/em|%$/.test(value)) {\n          if (parentFontSize === 0) {\n            return;\n          }\n\n          var numValue = parseFloat(value) / (/%$/.test(value) ? 100 : 1);\n          value = numValue * parentFontSize + 'px';\n        }\n      }\n\n      if (name === 'border' && value) {\n        previewCss += 'padding:0 2px;';\n      }\n\n      previewCss += name + ':' + value + ';';\n    });\n    editor.fire('AfterPreviewFormats');\n    dom.remove(previewFrag);\n    return previewCss;\n  };\n\n  var setup$6 = function (editor) {\n    editor.addShortcut('meta+b', '', 'Bold');\n    editor.addShortcut('meta+i', '', 'Italic');\n    editor.addShortcut('meta+u', '', 'Underline');\n\n    for (var i = 1; i <= 6; i++) {\n      editor.addShortcut('access+' + i, '', ['FormatBlock', false, 'h' + i]);\n    }\n\n    editor.addShortcut('access+7', '', ['FormatBlock', false, 'p']);\n    editor.addShortcut('access+8', '', ['FormatBlock', false, 'div']);\n    editor.addShortcut('access+9', '', ['FormatBlock', false, 'address']);\n  };\n\n  var Formatter = function (editor) {\n    var formats = FormatRegistry(editor);\n    var formatChangeState = Cell(null);\n    setup$6(editor);\n    setup$3(editor);\n    return {\n      get: formats.get,\n      has: formats.has,\n      register: formats.register,\n      unregister: formats.unregister,\n      apply: function (name, vars, node) {\n        applyFormat$1(editor, name, vars, node);\n      },\n      remove: function (name, vars, node, similar) {\n        removeFormat$1(editor, name, vars, node, similar);\n      },\n      toggle: function (name, vars, node) {\n        toggleFormat(editor, name, vars, node);\n      },\n      match: function (name, vars, node) {\n        return matchFormat(editor, name, vars, node);\n      },\n      closest: function (names) {\n        return closestFormat(editor, names);\n      },\n      matchAll: function (names, vars) {\n        return matchAllFormats(editor, names, vars);\n      },\n      matchNode: function (node, names, vars, similar) {\n        return matchNodeFormat(editor, node, names, vars, similar);\n      },\n      canApply: function (name) {\n        return canApplyFormat(editor, name);\n      },\n      formatChanged: function (formats, callback, similar) {\n        return formatChanged(editor, formatChangeState, formats, callback, similar);\n      },\n      getCssText: curry(getCssText, editor)\n    };\n  };\n\n  var registerEvents$1 = function (editor, undoManager, locks) {\n    var isFirstTypedCharacter = Cell(false);\n\n    var addNonTypingUndoLevel = function (e) {\n      setTyping(undoManager, false, locks);\n      undoManager.add({}, e);\n    };\n\n    editor.on('init', function () {\n      undoManager.add();\n    });\n    editor.on('BeforeExecCommand', function (e) {\n      var cmd = e.command.toLowerCase();\n\n      if (cmd !== 'undo' && cmd !== 'redo' && cmd !== 'mcerepaint') {\n        endTyping(undoManager, locks);\n        undoManager.beforeChange();\n      }\n    });\n    editor.on('ExecCommand', function (e) {\n      var cmd = e.command.toLowerCase();\n\n      if (cmd !== 'undo' && cmd !== 'redo' && cmd !== 'mcerepaint') {\n        addNonTypingUndoLevel(e);\n      }\n    });\n    editor.on('ObjectResizeStart cut', function () {\n      undoManager.beforeChange();\n    });\n    editor.on('SaveContent ObjectResized blur', addNonTypingUndoLevel);\n    editor.on('dragend', addNonTypingUndoLevel);\n    editor.on('keyup', function (e) {\n      var keyCode = e.keyCode;\n\n      if (e.isDefaultPrevented()) {\n        return;\n      }\n\n      if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45 || e.ctrlKey) {\n        addNonTypingUndoLevel();\n        editor.nodeChanged();\n      }\n\n      if (keyCode === 46 || keyCode === 8) {\n        editor.nodeChanged();\n      }\n\n      if (isFirstTypedCharacter.get() && undoManager.typing && isEq$4(createFromEditor(editor), undoManager.data[0]) === false) {\n        if (editor.isDirty() === false) {\n          editor.setDirty(true);\n          editor.fire('change', {\n            level: undoManager.data[0],\n            lastLevel: null\n          });\n        }\n\n        editor.fire('TypingUndo');\n        isFirstTypedCharacter.set(false);\n        editor.nodeChanged();\n      }\n    });\n    editor.on('keydown', function (e) {\n      var keyCode = e.keyCode;\n\n      if (e.isDefaultPrevented()) {\n        return;\n      }\n\n      if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45) {\n        if (undoManager.typing) {\n          addNonTypingUndoLevel(e);\n        }\n\n        return;\n      }\n\n      var modKey = e.ctrlKey && !e.altKey || e.metaKey;\n\n      if ((keyCode < 16 || keyCode > 20) && keyCode !== 224 && keyCode !== 91 && !undoManager.typing && !modKey) {\n        undoManager.beforeChange();\n        setTyping(undoManager, true, locks);\n        undoManager.add({}, e);\n        isFirstTypedCharacter.set(true);\n      }\n    });\n    editor.on('mousedown', function (e) {\n      if (undoManager.typing) {\n        addNonTypingUndoLevel(e);\n      }\n    });\n\n    var isInsertReplacementText = function (event) {\n      return event.inputType === 'insertReplacementText';\n    };\n\n    var isInsertTextDataNull = function (event) {\n      return event.inputType === 'insertText' && event.data === null;\n    };\n\n    var isInsertFromPasteOrDrop = function (event) {\n      return event.inputType === 'insertFromPaste' || event.inputType === 'insertFromDrop';\n    };\n\n    editor.on('input', function (e) {\n      if (e.inputType && (isInsertReplacementText(e) || isInsertTextDataNull(e) || isInsertFromPasteOrDrop(e))) {\n        addNonTypingUndoLevel(e);\n      }\n    });\n    editor.on('AddUndo Undo Redo ClearUndos', function (e) {\n      if (!e.isDefaultPrevented()) {\n        editor.nodeChanged();\n      }\n    });\n  };\n\n  var addKeyboardShortcuts = function (editor) {\n    editor.addShortcut('meta+z', '', 'Undo');\n    editor.addShortcut('meta+y,meta+shift+z', '', 'Redo');\n  };\n\n  var UndoManager = function (editor) {\n    var beforeBookmark = Cell(Optional.none());\n    var locks = Cell(0);\n    var index = Cell(0);\n    var undoManager = {\n      data: [],\n      typing: false,\n      beforeChange: function () {\n        beforeChange$1(editor, locks, beforeBookmark);\n      },\n      add: function (level, event) {\n        return addUndoLevel$1(editor, undoManager, index, locks, beforeBookmark, level, event);\n      },\n      undo: function () {\n        return undo$1(editor, undoManager, locks, index);\n      },\n      redo: function () {\n        return redo$1(editor, index, undoManager.data);\n      },\n      clear: function () {\n        clear$1(editor, undoManager, index);\n      },\n      reset: function () {\n        reset$1(editor, undoManager);\n      },\n      hasUndo: function () {\n        return hasUndo$1(editor, undoManager, index);\n      },\n      hasRedo: function () {\n        return hasRedo$1(editor, undoManager, index);\n      },\n      transact: function (callback) {\n        return transact$1(editor, undoManager, locks, callback);\n      },\n      ignore: function (callback) {\n        ignore$1(editor, locks, callback);\n      },\n      extra: function (callback1, callback2) {\n        extra$1(editor, undoManager, index, callback1, callback2);\n      }\n    };\n\n    if (!isRtc(editor)) {\n      registerEvents$1(editor, undoManager, locks);\n    }\n\n    addKeyboardShortcuts(editor);\n    return undoManager;\n  };\n\n  var nonTypingKeycodes = [9, 27, VK.HOME, VK.END, 19, 20, 44, 144, 145, 33, 34, 45, 16, 17, 18, 91, 92, 93, VK.DOWN, VK.UP, VK.LEFT, VK.RIGHT].concat(Env.browser.isFirefox() ? [224] : []);\n  var placeholderAttr = 'data-mce-placeholder';\n\n  var isKeyboardEvent = function (e) {\n    return e.type === 'keydown' || e.type === 'keyup';\n  };\n\n  var isDeleteEvent = function (e) {\n    var keyCode = e.keyCode;\n    return keyCode === VK.BACKSPACE || keyCode === VK.DELETE;\n  };\n\n  var isNonTypingKeyboardEvent = function (e) {\n    if (isKeyboardEvent(e)) {\n      var keyCode = e.keyCode;\n      return !isDeleteEvent(e) && (VK.metaKeyPressed(e) || e.altKey || keyCode >= 112 && keyCode <= 123 || contains(nonTypingKeycodes, keyCode));\n    } else {\n      return false;\n    }\n  };\n\n  var isTypingKeyboardEvent = function (e) {\n    return isKeyboardEvent(e) && !(isDeleteEvent(e) || e.type === 'keyup' && e.keyCode === 229);\n  };\n\n  var isVisuallyEmpty = function (dom, rootElm, forcedRootBlock) {\n    if (isEmpty(SugarElement.fromDom(rootElm), false)) {\n      var isForcedRootBlockFalse = forcedRootBlock === '';\n      var firstElement = rootElm.firstElementChild;\n\n      if (!firstElement) {\n        return true;\n      } else if (dom.getStyle(rootElm.firstElementChild, 'padding-left') || dom.getStyle(rootElm.firstElementChild, 'padding-right')) {\n        return false;\n      } else {\n        return isForcedRootBlockFalse ? !dom.isBlock(firstElement) : forcedRootBlock === firstElement.nodeName.toLowerCase();\n      }\n    } else {\n      return false;\n    }\n  };\n\n  var setup$7 = function (editor) {\n    var dom = editor.dom;\n    var rootBlock = getForcedRootBlock(editor);\n    var placeholder = getPlaceholder(editor);\n\n    var updatePlaceholder = function (e, initial) {\n      if (isNonTypingKeyboardEvent(e)) {\n        return;\n      }\n\n      var body = editor.getBody();\n      var showPlaceholder = isTypingKeyboardEvent(e) ? false : isVisuallyEmpty(dom, body, rootBlock);\n      var isPlaceholderShown = dom.getAttrib(body, placeholderAttr) !== '';\n\n      if (isPlaceholderShown !== showPlaceholder || initial) {\n        dom.setAttrib(body, placeholderAttr, showPlaceholder ? placeholder : null);\n        dom.setAttrib(body, 'aria-placeholder', showPlaceholder ? placeholder : null);\n        firePlaceholderToggle(editor, showPlaceholder);\n        editor.on(showPlaceholder ? 'keydown' : 'keyup', updatePlaceholder);\n        editor.off(showPlaceholder ? 'keyup' : 'keydown', updatePlaceholder);\n      }\n    };\n\n    if (placeholder) {\n      editor.on('init', function (e) {\n        updatePlaceholder(e, true);\n        editor.on('change SetContent ExecCommand', updatePlaceholder);\n        editor.on('paste', function (e) {\n          return Delay.setEditorTimeout(editor, function () {\n            return updatePlaceholder(e);\n          });\n        });\n      });\n    }\n  };\n\n  var strongRtl = /[\\u0591-\\u07FF\\uFB1D-\\uFDFF\\uFE70-\\uFEFC]/;\n\n  var hasStrongRtl = function (text) {\n    return strongRtl.test(text);\n  };\n\n  var isInlineTarget = function (editor, elm) {\n    return is$1(SugarElement.fromDom(elm), getInlineBoundarySelector(editor));\n  };\n\n  var isRtl$1 = function (element) {\n    return DOMUtils.DOM.getStyle(element, 'direction', true) === 'rtl' || hasStrongRtl(element.textContent);\n  };\n\n  var findInlineParents = function (isInlineTarget, rootNode, pos) {\n    return filter(DOMUtils.DOM.getParents(pos.container(), '*', rootNode), isInlineTarget);\n  };\n\n  var findRootInline = function (isInlineTarget, rootNode, pos) {\n    var parents = findInlineParents(isInlineTarget, rootNode, pos);\n    return Optional.from(parents[parents.length - 1]);\n  };\n\n  var hasSameParentBlock = function (rootNode, node1, node2) {\n    var block1 = getParentBlock(node1, rootNode);\n    var block2 = getParentBlock(node2, rootNode);\n    return block1 && block1 === block2;\n  };\n\n  var isAtZwsp = function (pos) {\n    return isBeforeInline(pos) || isAfterInline(pos);\n  };\n\n  var normalizePosition = function (forward, pos) {\n    if (!pos) {\n      return pos;\n    }\n\n    var container = pos.container(),\n        offset = pos.offset();\n\n    if (forward) {\n      if (isCaretContainerInline(container)) {\n        if (isText$1(container.nextSibling)) {\n          return CaretPosition(container.nextSibling, 0);\n        } else {\n          return CaretPosition.after(container);\n        }\n      } else {\n        return isBeforeInline(pos) ? CaretPosition(container, offset + 1) : pos;\n      }\n    } else {\n      if (isCaretContainerInline(container)) {\n        if (isText$1(container.previousSibling)) {\n          return CaretPosition(container.previousSibling, container.previousSibling.data.length);\n        } else {\n          return CaretPosition.before(container);\n        }\n      } else {\n        return isAfterInline(pos) ? CaretPosition(container, offset - 1) : pos;\n      }\n    }\n  };\n\n  var normalizeForwards = curry(normalizePosition, true);\n  var normalizeBackwards = curry(normalizePosition, false);\n\n  var isBeforeRoot = function (rootNode) {\n    return function (elm) {\n      return eq$2(rootNode, SugarElement.fromDom(elm.dom.parentNode));\n    };\n  };\n\n  var getParentBlock$1 = function (rootNode, elm) {\n    return contains$2(rootNode, elm) ? closest(elm, function (element) {\n      return isTextBlock(element) || isListItem(element);\n    }, isBeforeRoot(rootNode)) : Optional.none();\n  };\n\n  var placeCaretInEmptyBody = function (editor) {\n    var body = editor.getBody();\n    var node = body.firstChild && editor.dom.isBlock(body.firstChild) ? body.firstChild : body;\n    editor.selection.setCursorLocation(node, 0);\n  };\n\n  var paddEmptyBody = function (editor) {\n    if (editor.dom.isEmpty(editor.getBody())) {\n      editor.setContent('');\n      placeCaretInEmptyBody(editor);\n    }\n  };\n\n  var willDeleteLastPositionInElement = function (forward, fromPos, elm) {\n    return lift2(firstPositionIn(elm), lastPositionIn(elm), function (firstPos, lastPos) {\n      var normalizedFirstPos = normalizePosition(true, firstPos);\n      var normalizedLastPos = normalizePosition(false, lastPos);\n      var normalizedFromPos = normalizePosition(false, fromPos);\n\n      if (forward) {\n        return nextPosition(elm, normalizedFromPos).exists(function (nextPos) {\n          return nextPos.isEqual(normalizedLastPos) && fromPos.isEqual(normalizedFirstPos);\n        });\n      } else {\n        return prevPosition(elm, normalizedFromPos).exists(function (prevPos) {\n          return prevPos.isEqual(normalizedFirstPos) && fromPos.isEqual(normalizedLastPos);\n        });\n      }\n    }).getOr(true);\n  };\n\n  var blockPosition = function (block, position) {\n    return {\n      block: block,\n      position: position\n    };\n  };\n\n  var blockBoundary = function (from, to) {\n    return {\n      from: from,\n      to: to\n    };\n  };\n\n  var getBlockPosition = function (rootNode, pos) {\n    var rootElm = SugarElement.fromDom(rootNode);\n    var containerElm = SugarElement.fromDom(pos.container());\n    return getParentBlock$1(rootElm, containerElm).map(function (block) {\n      return blockPosition(block, pos);\n    });\n  };\n\n  var isDifferentBlocks = function (blockBoundary) {\n    return eq$2(blockBoundary.from.block, blockBoundary.to.block) === false;\n  };\n\n  var hasSameParent = function (blockBoundary) {\n    return parent(blockBoundary.from.block).bind(function (parent1) {\n      return parent(blockBoundary.to.block).filter(function (parent2) {\n        return eq$2(parent1, parent2);\n      });\n    }).isSome();\n  };\n\n  var isEditable = function (blockBoundary) {\n    return isContentEditableFalse(blockBoundary.from.block.dom) === false && isContentEditableFalse(blockBoundary.to.block.dom) === false;\n  };\n\n  var skipLastBr = function (rootNode, forward, blockPosition) {\n    if (isBr(blockPosition.position.getNode()) && isEmpty(blockPosition.block) === false) {\n      return positionIn(false, blockPosition.block.dom).bind(function (lastPositionInBlock) {\n        if (lastPositionInBlock.isEqual(blockPosition.position)) {\n          return fromPosition(forward, rootNode, lastPositionInBlock).bind(function (to) {\n            return getBlockPosition(rootNode, to);\n          });\n        } else {\n          return Optional.some(blockPosition);\n        }\n      }).getOr(blockPosition);\n    } else {\n      return blockPosition;\n    }\n  };\n\n  var readFromRange = function (rootNode, forward, rng) {\n    var fromBlockPos = getBlockPosition(rootNode, CaretPosition.fromRangeStart(rng));\n    var toBlockPos = fromBlockPos.bind(function (blockPos) {\n      return fromPosition(forward, rootNode, blockPos.position).bind(function (to) {\n        return getBlockPosition(rootNode, to).map(function (blockPos) {\n          return skipLastBr(rootNode, forward, blockPos);\n        });\n      });\n    });\n    return lift2(fromBlockPos, toBlockPos, blockBoundary).filter(function (blockBoundary) {\n      return isDifferentBlocks(blockBoundary) && hasSameParent(blockBoundary) && isEditable(blockBoundary);\n    });\n  };\n\n  var read$3 = function (rootNode, forward, rng) {\n    return rng.collapsed ? readFromRange(rootNode, forward, rng) : Optional.none();\n  };\n\n  var getChildrenUntilBlockBoundary = function (block) {\n    var children$1 = children(block);\n    return findIndex(children$1, isBlock).fold(function () {\n      return children$1;\n    }, function (index) {\n      return children$1.slice(0, index);\n    });\n  };\n\n  var extractChildren = function (block) {\n    var children = getChildrenUntilBlockBoundary(block);\n    each(children, remove);\n    return children;\n  };\n\n  var removeEmptyRoot = function (rootNode, block) {\n    var parents = parentsAndSelf(block, rootNode);\n    return find(parents.reverse(), function (element) {\n      return isEmpty(element);\n    }).each(remove);\n  };\n\n  var isEmptyBefore = function (el) {\n    return filter(prevSiblings(el), function (el) {\n      return !isEmpty(el);\n    }).length === 0;\n  };\n\n  var nestedBlockMerge = function (rootNode, fromBlock, toBlock, insertionPoint) {\n    if (isEmpty(toBlock)) {\n      fillWithPaddingBr(toBlock);\n      return firstPositionIn(toBlock.dom);\n    }\n\n    if (isEmptyBefore(insertionPoint) && isEmpty(fromBlock)) {\n      before(insertionPoint, SugarElement.fromTag('br'));\n    }\n\n    var position = prevPosition(toBlock.dom, CaretPosition.before(insertionPoint.dom));\n    each(extractChildren(fromBlock), function (child) {\n      before(insertionPoint, child);\n    });\n    removeEmptyRoot(rootNode, fromBlock);\n    return position;\n  };\n\n  var sidelongBlockMerge = function (rootNode, fromBlock, toBlock) {\n    if (isEmpty(toBlock)) {\n      remove(toBlock);\n\n      if (isEmpty(fromBlock)) {\n        fillWithPaddingBr(fromBlock);\n      }\n\n      return firstPositionIn(fromBlock.dom);\n    }\n\n    var position = lastPositionIn(toBlock.dom);\n    each(extractChildren(fromBlock), function (child) {\n      append(toBlock, child);\n    });\n    removeEmptyRoot(rootNode, fromBlock);\n    return position;\n  };\n\n  var findInsertionPoint = function (toBlock, block) {\n    var parentsAndSelf$1 = parentsAndSelf(block, toBlock);\n    return Optional.from(parentsAndSelf$1[parentsAndSelf$1.length - 1]);\n  };\n\n  var getInsertionPoint = function (fromBlock, toBlock) {\n    return contains$2(toBlock, fromBlock) ? findInsertionPoint(toBlock, fromBlock) : Optional.none();\n  };\n\n  var trimBr = function (first, block) {\n    positionIn(first, block.dom).map(function (position) {\n      return position.getNode();\n    }).map(SugarElement.fromDom).filter(isBr$1).each(remove);\n  };\n\n  var mergeBlockInto = function (rootNode, fromBlock, toBlock) {\n    trimBr(true, fromBlock);\n    trimBr(false, toBlock);\n    return getInsertionPoint(fromBlock, toBlock).fold(curry(sidelongBlockMerge, rootNode, fromBlock, toBlock), curry(nestedBlockMerge, rootNode, fromBlock, toBlock));\n  };\n\n  var mergeBlocks = function (rootNode, forward, block1, block2) {\n    return forward ? mergeBlockInto(rootNode, block2, block1) : mergeBlockInto(rootNode, block1, block2);\n  };\n\n  var backspaceDelete$1 = function (editor, forward) {\n    var rootNode = SugarElement.fromDom(editor.getBody());\n    var position = read$3(rootNode.dom, forward, editor.selection.getRng()).bind(function (blockBoundary) {\n      return mergeBlocks(rootNode, forward, blockBoundary.from.block, blockBoundary.to.block);\n    });\n    position.each(function (pos) {\n      editor.selection.setRng(pos.toRange());\n    });\n    return position.isSome();\n  };\n\n  var deleteRangeMergeBlocks = function (rootNode, selection) {\n    var rng = selection.getRng();\n    return lift2(getParentBlock$1(rootNode, SugarElement.fromDom(rng.startContainer)), getParentBlock$1(rootNode, SugarElement.fromDom(rng.endContainer)), function (block1, block2) {\n      if (eq$2(block1, block2) === false) {\n        rng.deleteContents();\n        mergeBlocks(rootNode, true, block1, block2).each(function (pos) {\n          selection.setRng(pos.toRange());\n        });\n        return true;\n      } else {\n        return false;\n      }\n    }).getOr(false);\n  };\n\n  var isRawNodeInTable = function (root, rawNode) {\n    var node = SugarElement.fromDom(rawNode);\n    var isRoot = curry(eq$2, root);\n    return ancestor(node, isTableCell$1, isRoot).isSome();\n  };\n\n  var isSelectionInTable = function (root, rng) {\n    return isRawNodeInTable(root, rng.startContainer) || isRawNodeInTable(root, rng.endContainer);\n  };\n\n  var isEverythingSelected = function (root, rng) {\n    var noPrevious = prevPosition(root.dom, CaretPosition.fromRangeStart(rng)).isNone();\n    var noNext = nextPosition(root.dom, CaretPosition.fromRangeEnd(rng)).isNone();\n    return !isSelectionInTable(root, rng) && noPrevious && noNext;\n  };\n\n  var emptyEditor = function (editor) {\n    editor.setContent('');\n    editor.selection.setCursorLocation();\n    return true;\n  };\n\n  var deleteRange$1 = function (editor) {\n    var rootNode = SugarElement.fromDom(editor.getBody());\n    var rng = editor.selection.getRng();\n    return isEverythingSelected(rootNode, rng) ? emptyEditor(editor) : deleteRangeMergeBlocks(rootNode, editor.selection);\n  };\n\n  var backspaceDelete$2 = function (editor, _forward) {\n    return editor.selection.isCollapsed() ? false : deleteRange$1(editor);\n  };\n\n  var isContentEditableTrue$2 = isContentEditableTrue;\n  var isContentEditableFalse$7 = isContentEditableFalse;\n\n  var showCaret = function (direction, editor, node, before, scrollIntoView) {\n    return Optional.from(editor._selectionOverrides.showCaret(direction, node, before, scrollIntoView));\n  };\n\n  var getNodeRange = function (node) {\n    var rng = node.ownerDocument.createRange();\n    rng.selectNode(node);\n    return rng;\n  };\n\n  var selectNode = function (editor, node) {\n    var e = editor.fire('BeforeObjectSelected', {\n      target: node\n    });\n\n    if (e.isDefaultPrevented()) {\n      return Optional.none();\n    }\n\n    return Optional.some(getNodeRange(node));\n  };\n\n  var renderCaretAtRange = function (editor, range, scrollIntoView) {\n    var normalizedRange = normalizeRange(1, editor.getBody(), range);\n    var caretPosition = CaretPosition.fromRangeStart(normalizedRange);\n    var caretPositionNode = caretPosition.getNode();\n\n    if (isInlineFakeCaretTarget(caretPositionNode)) {\n      return showCaret(1, editor, caretPositionNode, !caretPosition.isAtEnd(), false);\n    }\n\n    var caretPositionBeforeNode = caretPosition.getNode(true);\n\n    if (isInlineFakeCaretTarget(caretPositionBeforeNode)) {\n      return showCaret(1, editor, caretPositionBeforeNode, false, false);\n    }\n\n    var ceRoot = editor.dom.getParent(caretPosition.getNode(), function (node) {\n      return isContentEditableFalse$7(node) || isContentEditableTrue$2(node);\n    });\n\n    if (isInlineFakeCaretTarget(ceRoot)) {\n      return showCaret(1, editor, ceRoot, false, scrollIntoView);\n    }\n\n    return Optional.none();\n  };\n\n  var renderRangeCaret = function (editor, range, scrollIntoView) {\n    return range.collapsed ? renderCaretAtRange(editor, range, scrollIntoView).getOr(range) : range;\n  };\n\n  var isBeforeBoundary = function (pos) {\n    return isBeforeContentEditableFalse(pos) || isBeforeMedia(pos);\n  };\n\n  var isAfterBoundary = function (pos) {\n    return isAfterContentEditableFalse(pos) || isAfterMedia(pos);\n  };\n\n  var trimEmptyTextNode$1 = function (dom, node) {\n    if (isText$1(node) && node.data.length === 0) {\n      dom.remove(node);\n    }\n  };\n\n  var deleteContentAndShowCaret = function (editor, range, node, direction, forward, peekCaretPosition) {\n    showCaret(direction, editor, peekCaretPosition.getNode(!forward), forward, true).each(function (caretRange) {\n      if (range.collapsed) {\n        var deleteRange = range.cloneRange();\n\n        if (forward) {\n          deleteRange.setEnd(caretRange.startContainer, caretRange.startOffset);\n        } else {\n          deleteRange.setStart(caretRange.endContainer, caretRange.endOffset);\n        }\n\n        deleteRange.deleteContents();\n      } else {\n        range.deleteContents();\n      }\n\n      editor.selection.setRng(caretRange);\n    });\n    trimEmptyTextNode$1(editor.dom, node);\n    return true;\n  };\n\n  var deleteBoundaryText = function (editor, forward) {\n    var range = editor.selection.getRng();\n\n    if (!isText$1(range.commonAncestorContainer)) {\n      return false;\n    }\n\n    var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n    var caretWalker = CaretWalker(editor.getBody());\n    var getNextPosFn = curry(getVisualCaretPosition, forward ? caretWalker.next : caretWalker.prev);\n    var isBeforeFn = forward ? isBeforeBoundary : isAfterBoundary;\n    var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n    var nextCaretPosition = normalizePosition(forward, getNextPosFn(caretPosition));\n\n    if (!nextCaretPosition || !isMoveInsideSameBlock(caretPosition, nextCaretPosition)) {\n      return false;\n    } else if (isBeforeFn(nextCaretPosition)) {\n      return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, nextCaretPosition);\n    }\n\n    var peekCaretPosition = getNextPosFn(nextCaretPosition);\n\n    if (peekCaretPosition && isBeforeFn(peekCaretPosition)) {\n      if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n        return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, peekCaretPosition);\n      }\n    }\n\n    return false;\n  };\n\n  var backspaceDelete$3 = function (editor, forward) {\n    return deleteBoundaryText(editor, forward);\n  };\n\n  var isCompoundElement = function (node) {\n    return isTableCell$1(SugarElement.fromDom(node)) || isListItem(SugarElement.fromDom(node));\n  };\n\n  var DeleteAction = Adt.generate([{\n    remove: ['element']\n  }, {\n    moveToElement: ['element']\n  }, {\n    moveToPosition: ['position']\n  }]);\n\n  var isAtContentEditableBlockCaret = function (forward, from) {\n    var elm = from.getNode(forward === false);\n    var caretLocation = forward ? 'after' : 'before';\n    return isElement$1(elm) && elm.getAttribute('data-mce-caret') === caretLocation;\n  };\n\n  var isDeleteFromCefDifferentBlocks = function (root, forward, from, to) {\n    var inSameBlock = function (elm) {\n      return isInline(SugarElement.fromDom(elm)) && !isInSameBlock(from, to, root);\n    };\n\n    return getRelativeCefElm(!forward, from).fold(function () {\n      return getRelativeCefElm(forward, to).fold(never, inSameBlock);\n    }, inSameBlock);\n  };\n\n  var deleteEmptyBlockOrMoveToCef = function (root, forward, from, to) {\n    var toCefElm = to.getNode(forward === false);\n    return getParentBlock$1(SugarElement.fromDom(root), SugarElement.fromDom(from.getNode())).map(function (blockElm) {\n      return isEmpty(blockElm) ? DeleteAction.remove(blockElm.dom) : DeleteAction.moveToElement(toCefElm);\n    }).orThunk(function () {\n      return Optional.some(DeleteAction.moveToElement(toCefElm));\n    });\n  };\n\n  var findCefPosition = function (root, forward, from) {\n    return fromPosition(forward, root, from).bind(function (to) {\n      if (isCompoundElement(to.getNode())) {\n        return Optional.none();\n      } else if (isDeleteFromCefDifferentBlocks(root, forward, from, to)) {\n        return Optional.none();\n      } else if (forward && isContentEditableFalse(to.getNode())) {\n        return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n      } else if (forward === false && isContentEditableFalse(to.getNode(true))) {\n        return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n      } else if (forward && isAfterContentEditableFalse(from)) {\n        return Optional.some(DeleteAction.moveToPosition(to));\n      } else if (forward === false && isBeforeContentEditableFalse(from)) {\n        return Optional.some(DeleteAction.moveToPosition(to));\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var getContentEditableBlockAction = function (forward, elm) {\n    if (forward && isContentEditableFalse(elm.nextSibling)) {\n      return Optional.some(DeleteAction.moveToElement(elm.nextSibling));\n    } else if (forward === false && isContentEditableFalse(elm.previousSibling)) {\n      return Optional.some(DeleteAction.moveToElement(elm.previousSibling));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var skipMoveToActionFromInlineCefToContent = function (root, from, deleteAction) {\n    return deleteAction.fold(function (elm) {\n      return Optional.some(DeleteAction.remove(elm));\n    }, function (elm) {\n      return Optional.some(DeleteAction.moveToElement(elm));\n    }, function (to) {\n      if (isInSameBlock(from, to, root)) {\n        return Optional.none();\n      } else {\n        return Optional.some(DeleteAction.moveToPosition(to));\n      }\n    });\n  };\n\n  var getContentEditableAction = function (root, forward, from) {\n    if (isAtContentEditableBlockCaret(forward, from)) {\n      return getContentEditableBlockAction(forward, from.getNode(forward === false)).fold(function () {\n        return findCefPosition(root, forward, from);\n      }, Optional.some);\n    } else {\n      return findCefPosition(root, forward, from).bind(function (deleteAction) {\n        return skipMoveToActionFromInlineCefToContent(root, from, deleteAction);\n      });\n    }\n  };\n\n  var read$4 = function (root, forward, rng) {\n    var normalizedRange = normalizeRange(forward ? 1 : -1, root, rng);\n    var from = CaretPosition.fromRangeStart(normalizedRange);\n    var rootElement = SugarElement.fromDom(root);\n\n    if (forward === false && isAfterContentEditableFalse(from)) {\n      return Optional.some(DeleteAction.remove(from.getNode(true)));\n    } else if (forward && isBeforeContentEditableFalse(from)) {\n      return Optional.some(DeleteAction.remove(from.getNode()));\n    } else if (forward === false && isBeforeContentEditableFalse(from) && isAfterBr(rootElement, from)) {\n      return findPreviousBr(rootElement, from).map(function (br) {\n        return DeleteAction.remove(br.getNode());\n      });\n    } else if (forward && isAfterContentEditableFalse(from) && isBeforeBr(rootElement, from)) {\n      return findNextBr(rootElement, from).map(function (br) {\n        return DeleteAction.remove(br.getNode());\n      });\n    } else {\n      return getContentEditableAction(root, forward, from);\n    }\n  };\n\n  var deleteElement$1 = function (editor, forward) {\n    return function (element) {\n      editor._selectionOverrides.hideFakeCaret();\n\n      deleteElement(editor, forward, SugarElement.fromDom(element));\n      return true;\n    };\n  };\n\n  var moveToElement = function (editor, forward) {\n    return function (element) {\n      var pos = forward ? CaretPosition.before(element) : CaretPosition.after(element);\n      editor.selection.setRng(pos.toRange());\n      return true;\n    };\n  };\n\n  var moveToPosition = function (editor) {\n    return function (pos) {\n      editor.selection.setRng(pos.toRange());\n      return true;\n    };\n  };\n\n  var getAncestorCe = function (editor, node) {\n    return Optional.from(getContentEditableRoot(editor.getBody(), node));\n  };\n\n  var backspaceDeleteCaret = function (editor, forward) {\n    var selectedNode = editor.selection.getNode();\n    return getAncestorCe(editor, selectedNode).filter(isContentEditableFalse).fold(function () {\n      return read$4(editor.getBody(), forward, editor.selection.getRng()).exists(function (deleteAction) {\n        return deleteAction.fold(deleteElement$1(editor, forward), moveToElement(editor, forward), moveToPosition(editor));\n      });\n    }, always);\n  };\n\n  var deleteOffscreenSelection = function (rootElement) {\n    each(descendants$1(rootElement, '.mce-offscreen-selection'), remove);\n  };\n\n  var backspaceDeleteRange = function (editor, forward) {\n    var selectedNode = editor.selection.getNode();\n\n    if (isContentEditableFalse(selectedNode)) {\n      var hasCefAncestor = getAncestorCe(editor, selectedNode.parentNode).filter(isContentEditableFalse);\n      return hasCefAncestor.fold(function () {\n        deleteOffscreenSelection(SugarElement.fromDom(editor.getBody()));\n        deleteElement(editor, forward, SugarElement.fromDom(editor.selection.getNode()));\n        paddEmptyBody(editor);\n        return true;\n      }, always);\n    }\n\n    return false;\n  };\n\n  var paddEmptyElement = function (editor) {\n    var dom = editor.dom,\n        selection = editor.selection;\n    var ceRoot = getContentEditableRoot(editor.getBody(), selection.getNode());\n\n    if (isContentEditableTrue(ceRoot) && dom.isBlock(ceRoot) && dom.isEmpty(ceRoot)) {\n      var br = dom.create('br', {\n        'data-mce-bogus': '1'\n      });\n      dom.setHTML(ceRoot, '');\n      ceRoot.appendChild(br);\n      selection.setRng(CaretPosition.before(br).toRange());\n    }\n\n    return true;\n  };\n\n  var backspaceDelete$4 = function (editor, forward) {\n    if (editor.selection.isCollapsed()) {\n      return backspaceDeleteCaret(editor, forward);\n    } else {\n      return backspaceDeleteRange(editor, forward);\n    }\n  };\n\n  var deleteCaret$1 = function (editor, forward) {\n    var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return fromPosition(forward, editor.getBody(), fromPos).filter(function (pos) {\n      return forward ? isBeforeImageBlock(pos) : isAfterImageBlock(pos);\n    }).bind(function (pos) {\n      return Optional.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, pos));\n    }).exists(function (elm) {\n      editor.selection.select(elm);\n      return true;\n    });\n  };\n\n  var backspaceDelete$5 = function (editor, forward) {\n    return editor.selection.isCollapsed() ? deleteCaret$1(editor, forward) : false;\n  };\n\n  var isText$8 = isText$1;\n\n  var startsWithCaretContainer$1 = function (node) {\n    return isText$8(node) && node.data[0] === ZWSP;\n  };\n\n  var endsWithCaretContainer$1 = function (node) {\n    return isText$8(node) && node.data[node.data.length - 1] === ZWSP;\n  };\n\n  var createZwsp = function (node) {\n    return node.ownerDocument.createTextNode(ZWSP);\n  };\n\n  var insertBefore$1 = function (node) {\n    if (isText$8(node.previousSibling)) {\n      if (endsWithCaretContainer$1(node.previousSibling)) {\n        return node.previousSibling;\n      } else {\n        node.previousSibling.appendData(ZWSP);\n        return node.previousSibling;\n      }\n    } else if (isText$8(node)) {\n      if (startsWithCaretContainer$1(node)) {\n        return node;\n      } else {\n        node.insertData(0, ZWSP);\n        return node;\n      }\n    } else {\n      var newNode = createZwsp(node);\n      node.parentNode.insertBefore(newNode, node);\n      return newNode;\n    }\n  };\n\n  var insertAfter$1 = function (node) {\n    if (isText$8(node.nextSibling)) {\n      if (startsWithCaretContainer$1(node.nextSibling)) {\n        return node.nextSibling;\n      } else {\n        node.nextSibling.insertData(0, ZWSP);\n        return node.nextSibling;\n      }\n    } else if (isText$8(node)) {\n      if (endsWithCaretContainer$1(node)) {\n        return node;\n      } else {\n        node.appendData(ZWSP);\n        return node;\n      }\n    } else {\n      var newNode = createZwsp(node);\n\n      if (node.nextSibling) {\n        node.parentNode.insertBefore(newNode, node.nextSibling);\n      } else {\n        node.parentNode.appendChild(newNode);\n      }\n\n      return newNode;\n    }\n  };\n\n  var insertInline$1 = function (before, node) {\n    return before ? insertBefore$1(node) : insertAfter$1(node);\n  };\n\n  var insertInlineBefore = curry(insertInline$1, true);\n  var insertInlineAfter = curry(insertInline$1, false);\n\n  var insertInlinePos = function (pos, before) {\n    if (isText$1(pos.container())) {\n      return insertInline$1(before, pos.container());\n    } else {\n      return insertInline$1(before, pos.getNode());\n    }\n  };\n\n  var isPosCaretContainer = function (pos, caret) {\n    var caretNode = caret.get();\n    return caretNode && pos.container() === caretNode && isCaretContainerInline(caretNode);\n  };\n\n  var renderCaret = function (caret, location) {\n    return location.fold(function (element) {\n      remove$5(caret.get());\n      var text = insertInlineBefore(element);\n      caret.set(text);\n      return Optional.some(CaretPosition(text, text.length - 1));\n    }, function (element) {\n      return firstPositionIn(element).map(function (pos) {\n        if (!isPosCaretContainer(pos, caret)) {\n          remove$5(caret.get());\n          var text = insertInlinePos(pos, true);\n          caret.set(text);\n          return CaretPosition(text, 1);\n        } else {\n          return CaretPosition(caret.get(), 1);\n        }\n      });\n    }, function (element) {\n      return lastPositionIn(element).map(function (pos) {\n        if (!isPosCaretContainer(pos, caret)) {\n          remove$5(caret.get());\n          var text = insertInlinePos(pos, false);\n          caret.set(text);\n          return CaretPosition(text, text.length - 1);\n        } else {\n          return CaretPosition(caret.get(), caret.get().length - 1);\n        }\n      });\n    }, function (element) {\n      remove$5(caret.get());\n      var text = insertInlineAfter(element);\n      caret.set(text);\n      return Optional.some(CaretPosition(text, 1));\n    });\n  };\n\n  var evaluateUntil = function (fns, args) {\n    for (var i = 0; i < fns.length; i++) {\n      var result = fns[i].apply(null, args);\n\n      if (result.isSome()) {\n        return result;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var Location = Adt.generate([{\n    before: ['element']\n  }, {\n    start: ['element']\n  }, {\n    end: ['element']\n  }, {\n    after: ['element']\n  }]);\n\n  var rescope = function (rootNode, node) {\n    var parentBlock = getParentBlock(node, rootNode);\n    return parentBlock ? parentBlock : rootNode;\n  };\n\n  var before$4 = function (isInlineTarget, rootNode, pos) {\n    var nPos = normalizeForwards(pos);\n    var scope = rescope(rootNode, nPos.container());\n    return findRootInline(isInlineTarget, scope, nPos).fold(function () {\n      return nextPosition(scope, nPos).bind(curry(findRootInline, isInlineTarget, scope)).map(function (inline) {\n        return Location.before(inline);\n      });\n    }, Optional.none);\n  };\n\n  var isNotInsideFormatCaretContainer = function (rootNode, elm) {\n    return getParentCaretContainer(rootNode, elm) === null;\n  };\n\n  var findInsideRootInline = function (isInlineTarget, rootNode, pos) {\n    return findRootInline(isInlineTarget, rootNode, pos).filter(curry(isNotInsideFormatCaretContainer, rootNode));\n  };\n\n  var start = function (isInlineTarget, rootNode, pos) {\n    var nPos = normalizeBackwards(pos);\n    return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n      var prevPos = prevPosition(inline, nPos);\n      return prevPos.isNone() ? Optional.some(Location.start(inline)) : Optional.none();\n    });\n  };\n\n  var end = function (isInlineTarget, rootNode, pos) {\n    var nPos = normalizeForwards(pos);\n    return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n      var nextPos = nextPosition(inline, nPos);\n      return nextPos.isNone() ? Optional.some(Location.end(inline)) : Optional.none();\n    });\n  };\n\n  var after$3 = function (isInlineTarget, rootNode, pos) {\n    var nPos = normalizeBackwards(pos);\n    var scope = rescope(rootNode, nPos.container());\n    return findRootInline(isInlineTarget, scope, nPos).fold(function () {\n      return prevPosition(scope, nPos).bind(curry(findRootInline, isInlineTarget, scope)).map(function (inline) {\n        return Location.after(inline);\n      });\n    }, Optional.none);\n  };\n\n  var isValidLocation = function (location) {\n    return isRtl$1(getElement(location)) === false;\n  };\n\n  var readLocation = function (isInlineTarget, rootNode, pos) {\n    var location = evaluateUntil([before$4, start, end, after$3], [isInlineTarget, rootNode, pos]);\n    return location.filter(isValidLocation);\n  };\n\n  var getElement = function (location) {\n    return location.fold(identity, identity, identity, identity);\n  };\n\n  var getName = function (location) {\n    return location.fold(constant('before'), constant('start'), constant('end'), constant('after'));\n  };\n\n  var outside = function (location) {\n    return location.fold(Location.before, Location.before, Location.after, Location.after);\n  };\n\n  var inside = function (location) {\n    return location.fold(Location.start, Location.start, Location.end, Location.end);\n  };\n\n  var isEq$5 = function (location1, location2) {\n    return getName(location1) === getName(location2) && getElement(location1) === getElement(location2);\n  };\n\n  var betweenInlines = function (forward, isInlineTarget, rootNode, from, to, location) {\n    return lift2(findRootInline(isInlineTarget, rootNode, from), findRootInline(isInlineTarget, rootNode, to), function (fromInline, toInline) {\n      if (fromInline !== toInline && hasSameParentBlock(rootNode, fromInline, toInline)) {\n        return Location.after(forward ? fromInline : toInline);\n      } else {\n        return location;\n      }\n    }).getOr(location);\n  };\n\n  var skipNoMovement = function (fromLocation, toLocation) {\n    return fromLocation.fold(always, function (fromLocation) {\n      return !isEq$5(fromLocation, toLocation);\n    });\n  };\n\n  var findLocationTraverse = function (forward, isInlineTarget, rootNode, fromLocation, pos) {\n    var from = normalizePosition(forward, pos);\n    var to = fromPosition(forward, rootNode, from).map(curry(normalizePosition, forward));\n    var location = to.fold(function () {\n      return fromLocation.map(outside);\n    }, function (to) {\n      return readLocation(isInlineTarget, rootNode, to).map(curry(betweenInlines, forward, isInlineTarget, rootNode, from, to)).filter(curry(skipNoMovement, fromLocation));\n    });\n    return location.filter(isValidLocation);\n  };\n\n  var findLocationSimple = function (forward, location) {\n    if (forward) {\n      return location.fold(compose(Optional.some, Location.start), Optional.none, compose(Optional.some, Location.after), Optional.none);\n    } else {\n      return location.fold(Optional.none, compose(Optional.some, Location.before), Optional.none, compose(Optional.some, Location.end));\n    }\n  };\n\n  var findLocation = function (forward, isInlineTarget, rootNode, pos) {\n    var from = normalizePosition(forward, pos);\n    var fromLocation = readLocation(isInlineTarget, rootNode, from);\n    return readLocation(isInlineTarget, rootNode, from).bind(curry(findLocationSimple, forward)).orThunk(function () {\n      return findLocationTraverse(forward, isInlineTarget, rootNode, fromLocation, pos);\n    });\n  };\n\n  var prevLocation = curry(findLocation, false);\n  var nextLocation = curry(findLocation, true);\n\n  var hasSelectionModifyApi = function (editor) {\n    return isFunction(editor.selection.getSel().modify);\n  };\n\n  var moveRel = function (forward, selection, pos) {\n    var delta = forward ? 1 : -1;\n    selection.setRng(CaretPosition(pos.container(), pos.offset() + delta).toRange());\n    selection.getSel().modify('move', forward ? 'forward' : 'backward', 'word');\n    return true;\n  };\n\n  var moveByWord = function (forward, editor) {\n    var rng = editor.selection.getRng();\n    var pos = forward ? CaretPosition.fromRangeEnd(rng) : CaretPosition.fromRangeStart(rng);\n\n    if (!hasSelectionModifyApi(editor)) {\n      return false;\n    } else if (forward && isBeforeInline(pos)) {\n      return moveRel(true, editor.selection, pos);\n    } else if (!forward && isAfterInline(pos)) {\n      return moveRel(false, editor.selection, pos);\n    } else {\n      return false;\n    }\n  };\n\n  var setCaretPosition = function (editor, pos) {\n    var rng = editor.dom.createRng();\n    rng.setStart(pos.container(), pos.offset());\n    rng.setEnd(pos.container(), pos.offset());\n    editor.selection.setRng(rng);\n  };\n\n  var setSelected = function (state, elm) {\n    if (state) {\n      elm.setAttribute('data-mce-selected', 'inline-boundary');\n    } else {\n      elm.removeAttribute('data-mce-selected');\n    }\n  };\n\n  var renderCaretLocation = function (editor, caret, location) {\n    return renderCaret(caret, location).map(function (pos) {\n      setCaretPosition(editor, pos);\n      return location;\n    });\n  };\n\n  var findLocation$1 = function (editor, caret, forward) {\n    var rootNode = editor.getBody();\n    var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    var location = findLocation(forward, isInlineTarget$1, rootNode, from);\n    return location.bind(function (location) {\n      return renderCaretLocation(editor, caret, location);\n    });\n  };\n\n  var toggleInlines = function (isInlineTarget, dom, elms) {\n    var inlineBoundaries = map(descendants$1(SugarElement.fromDom(dom.getRoot()), '*[data-mce-selected=\"inline-boundary\"]'), function (e) {\n      return e.dom;\n    });\n    var selectedInlines = filter(inlineBoundaries, isInlineTarget);\n    var targetInlines = filter(elms, isInlineTarget);\n    each(difference(selectedInlines, targetInlines), curry(setSelected, false));\n    each(difference(targetInlines, selectedInlines), curry(setSelected, true));\n  };\n\n  var safeRemoveCaretContainer = function (editor, caret) {\n    if (editor.selection.isCollapsed() && editor.composing !== true && caret.get()) {\n      var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n\n      if (CaretPosition.isTextPosition(pos) && isAtZwsp(pos) === false) {\n        setCaretPosition(editor, removeAndReposition(caret.get(), pos));\n        caret.set(null);\n      }\n    }\n  };\n\n  var renderInsideInlineCaret = function (isInlineTarget, editor, caret, elms) {\n    if (editor.selection.isCollapsed()) {\n      var inlines = filter(elms, isInlineTarget);\n      each(inlines, function (_inline) {\n        var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n        readLocation(isInlineTarget, editor.getBody(), pos).bind(function (location) {\n          return renderCaretLocation(editor, caret, location);\n        });\n      });\n    }\n  };\n\n  var move = function (editor, caret, forward) {\n    return isInlineBoundariesEnabled(editor) ? findLocation$1(editor, caret, forward).isSome() : false;\n  };\n\n  var moveWord = function (forward, editor, _caret) {\n    return isInlineBoundariesEnabled(editor) ? moveByWord(forward, editor) : false;\n  };\n\n  var setupSelectedState = function (editor) {\n    var caret = Cell(null);\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    editor.on('NodeChange', function (e) {\n      if (isInlineBoundariesEnabled(editor) && !(Env.browser.isIE() && e.initial)) {\n        toggleInlines(isInlineTarget$1, editor.dom, e.parents);\n        safeRemoveCaretContainer(editor, caret);\n        renderInsideInlineCaret(isInlineTarget$1, editor, caret, e.parents);\n      }\n    });\n    return caret;\n  };\n\n  var moveNextWord = curry(moveWord, true);\n  var movePrevWord = curry(moveWord, false);\n\n  var rangeFromPositions = function (from, to) {\n    var range = document.createRange();\n    range.setStart(from.container(), from.offset());\n    range.setEnd(to.container(), to.offset());\n    return range;\n  };\n\n  var hasOnlyTwoOrLessPositionsLeft = function (elm) {\n    return lift2(firstPositionIn(elm), lastPositionIn(elm), function (firstPos, lastPos) {\n      var normalizedFirstPos = normalizePosition(true, firstPos);\n      var normalizedLastPos = normalizePosition(false, lastPos);\n      return nextPosition(elm, normalizedFirstPos).forall(function (pos) {\n        return pos.isEqual(normalizedLastPos);\n      });\n    }).getOr(true);\n  };\n\n  var setCaretLocation = function (editor, caret) {\n    return function (location) {\n      return renderCaret(caret, location).exists(function (pos) {\n        setCaretPosition(editor, pos);\n        return true;\n      });\n    };\n  };\n\n  var deleteFromTo = function (editor, caret, from, to) {\n    var rootNode = editor.getBody();\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    editor.undoManager.ignore(function () {\n      editor.selection.setRng(rangeFromPositions(from, to));\n      editor.execCommand('Delete');\n      readLocation(isInlineTarget$1, rootNode, CaretPosition.fromRangeStart(editor.selection.getRng())).map(inside).map(setCaretLocation(editor, caret));\n    });\n    editor.nodeChanged();\n  };\n\n  var rescope$1 = function (rootNode, node) {\n    var parentBlock = getParentBlock(node, rootNode);\n    return parentBlock ? parentBlock : rootNode;\n  };\n\n  var backspaceDeleteCollapsed = function (editor, caret, forward, from) {\n    var rootNode = rescope$1(editor.getBody(), from.container());\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    var fromLocation = readLocation(isInlineTarget$1, rootNode, from);\n    return fromLocation.bind(function (location) {\n      if (forward) {\n        return location.fold(constant(Optional.some(inside(location))), Optional.none, constant(Optional.some(outside(location))), Optional.none);\n      } else {\n        return location.fold(Optional.none, constant(Optional.some(outside(location))), Optional.none, constant(Optional.some(inside(location))));\n      }\n    }).map(setCaretLocation(editor, caret)).getOrThunk(function () {\n      var toPosition = navigate(forward, rootNode, from);\n      var toLocation = toPosition.bind(function (pos) {\n        return readLocation(isInlineTarget$1, rootNode, pos);\n      });\n      return lift2(fromLocation, toLocation, function () {\n        return findRootInline(isInlineTarget$1, rootNode, from).exists(function (elm) {\n          if (hasOnlyTwoOrLessPositionsLeft(elm)) {\n            deleteElement(editor, forward, SugarElement.fromDom(elm));\n            return true;\n          } else {\n            return false;\n          }\n        });\n      }).orThunk(function () {\n        return toLocation.bind(function (_) {\n          return toPosition.map(function (to) {\n            if (forward) {\n              deleteFromTo(editor, caret, from, to);\n            } else {\n              deleteFromTo(editor, caret, to, from);\n            }\n\n            return true;\n          });\n        });\n      }).getOr(false);\n    });\n  };\n\n  var backspaceDelete$6 = function (editor, caret, forward) {\n    if (editor.selection.isCollapsed() && isInlineBoundariesEnabled(editor)) {\n      var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return backspaceDeleteCollapsed(editor, caret, forward, from);\n    }\n\n    return false;\n  };\n\n  var getParentInlines = function (rootElm, startElm) {\n    var parents = parentsAndSelf(startElm, rootElm);\n    return findIndex(parents, isBlock).fold(constant(parents), function (index) {\n      return parents.slice(0, index);\n    });\n  };\n\n  var hasOnlyOneChild$1 = function (elm) {\n    return children(elm).length === 1;\n  };\n\n  var deleteLastPosition = function (forward, editor, target, parentInlines) {\n    var isFormatElement$1 = curry(isFormatElement, editor);\n    var formatNodes = map(filter(parentInlines, isFormatElement$1), function (elm) {\n      return elm.dom;\n    });\n\n    if (formatNodes.length === 0) {\n      deleteElement(editor, forward, target);\n    } else {\n      var pos = replaceWithCaretFormat(target.dom, formatNodes);\n      editor.selection.setRng(pos.toRange());\n    }\n  };\n\n  var deleteCaret$2 = function (editor, forward) {\n    var rootElm = SugarElement.fromDom(editor.getBody());\n    var startElm = SugarElement.fromDom(editor.selection.getStart());\n    var parentInlines = filter(getParentInlines(rootElm, startElm), hasOnlyOneChild$1);\n    return last(parentInlines).exists(function (target) {\n      var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n\n      if (willDeleteLastPositionInElement(forward, fromPos, target.dom) && !isEmptyCaretFormatElement(target)) {\n        deleteLastPosition(forward, editor, target, parentInlines);\n        return true;\n      } else {\n        return false;\n      }\n    });\n  };\n\n  var backspaceDelete$7 = function (editor, forward) {\n    return editor.selection.isCollapsed() ? deleteCaret$2(editor, forward) : false;\n  };\n\n  var deleteElement$2 = function (editor, forward, element) {\n    editor._selectionOverrides.hideFakeCaret();\n\n    deleteElement(editor, forward, SugarElement.fromDom(element));\n    return true;\n  };\n\n  var deleteCaret$3 = function (editor, forward) {\n    var isNearMedia = forward ? isBeforeMedia : isAfterMedia;\n    var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n    var fromPos = getNormalizedRangeEndPoint(direction, editor.getBody(), editor.selection.getRng());\n\n    if (isNearMedia(fromPos)) {\n      return deleteElement$2(editor, forward, fromPos.getNode(!forward));\n    } else {\n      return Optional.from(normalizePosition(forward, fromPos)).filter(function (pos) {\n        return isNearMedia(pos) && isMoveInsideSameBlock(fromPos, pos);\n      }).exists(function (pos) {\n        return deleteElement$2(editor, forward, pos.getNode(!forward));\n      });\n    }\n  };\n\n  var deleteRange$2 = function (editor, forward) {\n    var selectedNode = editor.selection.getNode();\n    return isMedia(selectedNode) ? deleteElement$2(editor, forward, selectedNode) : false;\n  };\n\n  var backspaceDelete$8 = function (editor, forward) {\n    return editor.selection.isCollapsed() ? deleteCaret$3(editor, forward) : deleteRange$2(editor, forward);\n  };\n\n  var isEditable$1 = function (target) {\n    return closest(target, function (elm) {\n      return isContentEditableTrue(elm.dom) || isContentEditableFalse(elm.dom);\n    }).exists(function (elm) {\n      return isContentEditableTrue(elm.dom);\n    });\n  };\n\n  var parseIndentValue = function (value) {\n    var number = parseInt(value, 10);\n    return isNaN(number) ? 0 : number;\n  };\n\n  var getIndentStyleName = function (useMargin, element) {\n    var indentStyleName = useMargin || isTable$1(element) ? 'margin' : 'padding';\n    var suffix = get$5(element, 'direction') === 'rtl' ? '-right' : '-left';\n    return indentStyleName + suffix;\n  };\n\n  var indentElement = function (dom, command, useMargin, value, unit, element) {\n    var indentStyleName = getIndentStyleName(useMargin, SugarElement.fromDom(element));\n\n    if (command === 'outdent') {\n      var styleValue = Math.max(0, parseIndentValue(element.style[indentStyleName]) - value);\n      dom.setStyle(element, indentStyleName, styleValue ? styleValue + unit : '');\n    } else {\n      var styleValue = parseIndentValue(element.style[indentStyleName]) + value + unit;\n      dom.setStyle(element, indentStyleName, styleValue);\n    }\n  };\n\n  var validateBlocks = function (editor, blocks) {\n    return forall(blocks, function (block) {\n      var indentStyleName = getIndentStyleName(shouldIndentUseMargin(editor), block);\n      var intentValue = getRaw(block, indentStyleName).map(parseIndentValue).getOr(0);\n      var contentEditable = editor.dom.getContentEditable(block.dom);\n      return contentEditable !== 'false' && intentValue > 0;\n    });\n  };\n\n  var canOutdent = function (editor) {\n    var blocks = getBlocksToIndent(editor);\n    return !editor.mode.isReadOnly() && (blocks.length > 1 || validateBlocks(editor, blocks));\n  };\n\n  var isListComponent = function (el) {\n    return isList(el) || isListItem(el);\n  };\n\n  var parentIsListComponent = function (el) {\n    return parent(el).map(isListComponent).getOr(false);\n  };\n\n  var getBlocksToIndent = function (editor) {\n    return filter(map(editor.selection.getSelectedBlocks(), SugarElement.fromDom), function (el) {\n      return !isListComponent(el) && !parentIsListComponent(el) && isEditable$1(el);\n    });\n  };\n\n  var handle = function (editor, command) {\n    var dom = editor.dom,\n        selection = editor.selection,\n        formatter = editor.formatter;\n    var indentation = getIndentation(editor);\n    var indentUnit = /[a-z%]+$/i.exec(indentation)[0];\n    var indentValue = parseInt(indentation, 10);\n    var useMargin = shouldIndentUseMargin(editor);\n    var forcedRootBlock = getForcedRootBlock(editor);\n\n    if (!editor.queryCommandState('InsertUnorderedList') && !editor.queryCommandState('InsertOrderedList')) {\n      if (forcedRootBlock === '' && !dom.getParent(selection.getNode(), dom.isBlock)) {\n        formatter.apply('div');\n      }\n    }\n\n    each(getBlocksToIndent(editor), function (block) {\n      indentElement(dom, command, useMargin, indentValue, indentUnit, block.dom);\n    });\n  };\n\n  var backspaceDelete$9 = function (editor, _forward) {\n    if (editor.selection.isCollapsed() && canOutdent(editor)) {\n      var dom = editor.dom;\n      var rng = editor.selection.getRng();\n      var pos = CaretPosition.fromRangeStart(rng);\n      var block = dom.getParent(rng.startContainer, dom.isBlock);\n\n      if (block !== null && isAtStartOfBlock(SugarElement.fromDom(block), pos)) {\n        handle(editor, 'outdent');\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var nativeCommand = function (editor, command) {\n    editor.getDoc().execCommand(command, false, null);\n  };\n\n  var deleteCommand = function (editor, caret) {\n    if (backspaceDelete$9(editor)) {\n      return;\n    } else if (backspaceDelete$4(editor, false)) {\n      return;\n    } else if (backspaceDelete$3(editor, false)) {\n      return;\n    } else if (backspaceDelete$6(editor, caret, false)) {\n      return;\n    } else if (backspaceDelete$1(editor, false)) {\n      return;\n    } else if (backspaceDelete(editor)) {\n      return;\n    } else if (backspaceDelete$5(editor, false)) {\n      return;\n    } else if (backspaceDelete$8(editor, false)) {\n      return;\n    } else if (backspaceDelete$2(editor)) {\n      return;\n    } else if (backspaceDelete$7(editor, false)) {\n      return;\n    } else {\n      nativeCommand(editor, 'Delete');\n      paddEmptyBody(editor);\n    }\n  };\n\n  var forwardDeleteCommand = function (editor, caret) {\n    if (backspaceDelete$4(editor, true)) {\n      return;\n    } else if (backspaceDelete$3(editor, true)) {\n      return;\n    } else if (backspaceDelete$6(editor, caret, true)) {\n      return;\n    } else if (backspaceDelete$1(editor, true)) {\n      return;\n    } else if (backspaceDelete(editor)) {\n      return;\n    } else if (backspaceDelete$5(editor, true)) {\n      return;\n    } else if (backspaceDelete$8(editor, true)) {\n      return;\n    } else if (backspaceDelete$2(editor)) {\n      return;\n    } else if (backspaceDelete$7(editor, true)) {\n      return;\n    } else {\n      nativeCommand(editor, 'ForwardDelete');\n    }\n  };\n\n  var setup$8 = function (editor, caret) {\n    editor.addCommand('delete', function () {\n      deleteCommand(editor, caret);\n    });\n    editor.addCommand('forwardDelete', function () {\n      forwardDeleteCommand(editor, caret);\n    });\n  };\n\n  var SIGNIFICANT_MOVE = 5;\n  var LONGPRESS_DELAY = 400;\n\n  var getTouch = function (event) {\n    if (event.touches === undefined || event.touches.length !== 1) {\n      return Optional.none();\n    }\n\n    return Optional.some(event.touches[0]);\n  };\n\n  var isFarEnough = function (touch, data) {\n    var distX = Math.abs(touch.clientX - data.x);\n    var distY = Math.abs(touch.clientY - data.y);\n    return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n  };\n\n  var setup$9 = function (editor) {\n    var startData = Cell(Optional.none());\n    var longpressFired = Cell(false);\n    var debounceLongpress = last$2(function (e) {\n      editor.fire('longpress', __assign(__assign({}, e), {\n        type: 'longpress'\n      }));\n      longpressFired.set(true);\n    }, LONGPRESS_DELAY);\n    editor.on('touchstart', function (e) {\n      getTouch(e).each(function (touch) {\n        debounceLongpress.cancel();\n        var data = {\n          x: touch.clientX,\n          y: touch.clientY,\n          target: e.target\n        };\n        debounceLongpress.throttle(e);\n        longpressFired.set(false);\n        startData.set(Optional.some(data));\n      });\n    }, true);\n    editor.on('touchmove', function (e) {\n      debounceLongpress.cancel();\n      getTouch(e).each(function (touch) {\n        startData.get().each(function (data) {\n          if (isFarEnough(touch, data)) {\n            startData.set(Optional.none());\n            longpressFired.set(false);\n            editor.fire('longpresscancel');\n          }\n        });\n      });\n    }, true);\n    editor.on('touchend touchcancel', function (e) {\n      debounceLongpress.cancel();\n\n      if (e.type === 'touchcancel') {\n        return;\n      }\n\n      startData.get().filter(function (data) {\n        return data.target.isEqualNode(e.target);\n      }).each(function () {\n        if (longpressFired.get()) {\n          e.preventDefault();\n        } else {\n          editor.fire('tap', __assign(__assign({}, e), {\n            type: 'tap'\n          }));\n        }\n      });\n    }, true);\n  };\n\n  var isBlockElement = function (blockElements, node) {\n    return blockElements.hasOwnProperty(node.nodeName);\n  };\n\n  var isValidTarget = function (blockElements, node) {\n    if (isText$1(node)) {\n      return true;\n    } else if (isElement$1(node)) {\n      return !isBlockElement(blockElements, node) && !isBookmarkNode$1(node);\n    } else {\n      return false;\n    }\n  };\n\n  var hasBlockParent = function (blockElements, root, node) {\n    return exists(parents$1(SugarElement.fromDom(node), SugarElement.fromDom(root)), function (elm) {\n      return isBlockElement(blockElements, elm.dom);\n    });\n  };\n\n  var shouldRemoveTextNode = function (blockElements, node) {\n    if (isText$1(node)) {\n      if (node.nodeValue.length === 0) {\n        return true;\n      } else if (/^\\s+$/.test(node.nodeValue) && (!node.nextSibling || isBlockElement(blockElements, node.nextSibling))) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var addRootBlocks = function (editor) {\n    var dom = editor.dom,\n        selection = editor.selection;\n    var schema = editor.schema,\n        blockElements = schema.getBlockElements();\n    var node = selection.getStart();\n    var rootNode = editor.getBody();\n    var rootBlockNode, tempNode, wrapped;\n    var forcedRootBlock = getForcedRootBlock(editor);\n\n    if (!node || !isElement$1(node) || !forcedRootBlock) {\n      return;\n    }\n\n    var rootNodeName = rootNode.nodeName.toLowerCase();\n\n    if (!schema.isValidChild(rootNodeName, forcedRootBlock.toLowerCase()) || hasBlockParent(blockElements, rootNode, node)) {\n      return;\n    }\n\n    var rng = selection.getRng();\n    var startContainer = rng.startContainer;\n    var startOffset = rng.startOffset;\n    var endContainer = rng.endContainer;\n    var endOffset = rng.endOffset;\n    var restoreSelection = hasFocus$1(editor);\n    node = rootNode.firstChild;\n\n    while (node) {\n      if (isValidTarget(blockElements, node)) {\n        if (shouldRemoveTextNode(blockElements, node)) {\n          tempNode = node;\n          node = node.nextSibling;\n          dom.remove(tempNode);\n          continue;\n        }\n\n        if (!rootBlockNode) {\n          rootBlockNode = dom.create(forcedRootBlock, getForcedRootBlockAttrs(editor));\n          node.parentNode.insertBefore(rootBlockNode, node);\n          wrapped = true;\n        }\n\n        tempNode = node;\n        node = node.nextSibling;\n        rootBlockNode.appendChild(tempNode);\n      } else {\n        rootBlockNode = null;\n        node = node.nextSibling;\n      }\n    }\n\n    if (wrapped && restoreSelection) {\n      rng.setStart(startContainer, startOffset);\n      rng.setEnd(endContainer, endOffset);\n      selection.setRng(rng);\n      editor.nodeChanged();\n    }\n  };\n\n  var setup$a = function (editor) {\n    if (getForcedRootBlock(editor)) {\n      editor.on('NodeChange', curry(addRootBlocks, editor));\n    }\n  };\n\n  var findBlockCaretContainer = function (editor) {\n    return descendant(SugarElement.fromDom(editor.getBody()), '*[data-mce-caret]').fold(constant(null), function (elm) {\n      return elm.dom;\n    });\n  };\n\n  var removeIeControlRect = function (editor) {\n    editor.selection.setRng(editor.selection.getRng());\n  };\n\n  var showBlockCaretContainer = function (editor, blockCaretContainer) {\n    if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n      showCaretContainerBlock(blockCaretContainer);\n      removeIeControlRect(editor);\n      editor.selection.scrollIntoView(blockCaretContainer);\n    }\n  };\n\n  var handleBlockContainer = function (editor, e) {\n    var blockCaretContainer = findBlockCaretContainer(editor);\n\n    if (!blockCaretContainer) {\n      return;\n    }\n\n    if (e.type === 'compositionstart') {\n      e.preventDefault();\n      e.stopPropagation();\n      showBlockCaretContainer(editor, blockCaretContainer);\n      return;\n    }\n\n    if (hasContent(blockCaretContainer)) {\n      showBlockCaretContainer(editor, blockCaretContainer);\n      editor.undoManager.add();\n    }\n  };\n\n  var setup$b = function (editor) {\n    editor.on('keyup compositionstart', curry(handleBlockContainer, editor));\n  };\n\n  var BreakType;\n\n  (function (BreakType) {\n    BreakType[BreakType['Br'] = 0] = 'Br';\n    BreakType[BreakType['Block'] = 1] = 'Block';\n    BreakType[BreakType['Wrap'] = 2] = 'Wrap';\n    BreakType[BreakType['Eol'] = 3] = 'Eol';\n  })(BreakType || (BreakType = {}));\n\n  var flip = function (direction, positions) {\n    return direction === HDirection.Backwards ? reverse(positions) : positions;\n  };\n\n  var walk$3 = function (direction, caretWalker, pos) {\n    return direction === HDirection.Forwards ? caretWalker.next(pos) : caretWalker.prev(pos);\n  };\n\n  var getBreakType = function (scope, direction, currentPos, nextPos) {\n    if (isBr(nextPos.getNode(direction === HDirection.Forwards))) {\n      return BreakType.Br;\n    } else if (isInSameBlock(currentPos, nextPos) === false) {\n      return BreakType.Block;\n    } else {\n      return BreakType.Wrap;\n    }\n  };\n\n  var getPositionsUntil = function (predicate, direction, scope, start) {\n    var caretWalker = CaretWalker(scope);\n    var currentPos = start,\n        nextPos;\n    var positions = [];\n\n    while (currentPos) {\n      nextPos = walk$3(direction, caretWalker, currentPos);\n\n      if (!nextPos) {\n        break;\n      }\n\n      if (isBr(nextPos.getNode(false))) {\n        if (direction === HDirection.Forwards) {\n          return {\n            positions: flip(direction, positions).concat([nextPos]),\n            breakType: BreakType.Br,\n            breakAt: Optional.some(nextPos)\n          };\n        } else {\n          return {\n            positions: flip(direction, positions),\n            breakType: BreakType.Br,\n            breakAt: Optional.some(nextPos)\n          };\n        }\n      }\n\n      if (!nextPos.isVisible()) {\n        currentPos = nextPos;\n        continue;\n      }\n\n      if (predicate(currentPos, nextPos)) {\n        var breakType = getBreakType(scope, direction, currentPos, nextPos);\n        return {\n          positions: flip(direction, positions),\n          breakType: breakType,\n          breakAt: Optional.some(nextPos)\n        };\n      }\n\n      positions.push(nextPos);\n      currentPos = nextPos;\n    }\n\n    return {\n      positions: flip(direction, positions),\n      breakType: BreakType.Eol,\n      breakAt: Optional.none()\n    };\n  };\n\n  var getAdjacentLinePositions = function (direction, getPositionsUntilBreak, scope, start) {\n    return getPositionsUntilBreak(scope, start).breakAt.map(function (pos) {\n      var positions = getPositionsUntilBreak(scope, pos).positions;\n      return direction === HDirection.Backwards ? positions.concat(pos) : [pos].concat(positions);\n    }).getOr([]);\n  };\n\n  var findClosestHorizontalPositionFromPoint = function (positions, x) {\n    return foldl(positions, function (acc, newPos) {\n      return acc.fold(function () {\n        return Optional.some(newPos);\n      }, function (lastPos) {\n        return lift2(head(lastPos.getClientRects()), head(newPos.getClientRects()), function (lastRect, newRect) {\n          var lastDist = Math.abs(x - lastRect.left);\n          var newDist = Math.abs(x - newRect.left);\n          return newDist <= lastDist ? newPos : lastPos;\n        }).or(acc);\n      });\n    }, Optional.none());\n  };\n\n  var findClosestHorizontalPosition = function (positions, pos) {\n    return head(pos.getClientRects()).bind(function (targetRect) {\n      return findClosestHorizontalPositionFromPoint(positions, targetRect.left);\n    });\n  };\n\n  var getPositionsUntilPreviousLine = curry(getPositionsUntil, CaretPosition.isAbove, -1);\n  var getPositionsUntilNextLine = curry(getPositionsUntil, CaretPosition.isBelow, 1);\n\n  var isAtFirstLine = function (scope, pos) {\n    return getPositionsUntilPreviousLine(scope, pos).breakAt.isNone();\n  };\n\n  var isAtLastLine = function (scope, pos) {\n    return getPositionsUntilNextLine(scope, pos).breakAt.isNone();\n  };\n\n  var getPositionsAbove = curry(getAdjacentLinePositions, -1, getPositionsUntilPreviousLine);\n  var getPositionsBelow = curry(getAdjacentLinePositions, 1, getPositionsUntilNextLine);\n\n  var getFirstLinePositions = function (scope) {\n    return firstPositionIn(scope).map(function (pos) {\n      return [pos].concat(getPositionsUntilNextLine(scope, pos).positions);\n    }).getOr([]);\n  };\n\n  var getLastLinePositions = function (scope) {\n    return lastPositionIn(scope).map(function (pos) {\n      return getPositionsUntilPreviousLine(scope, pos).positions.concat(pos);\n    }).getOr([]);\n  };\n\n  var getNodeClientRects = function (node) {\n    var toArrayWithNode = function (clientRects) {\n      return map(clientRects, function (clientRect) {\n        clientRect = clone$2(clientRect);\n        clientRect.node = node;\n        return clientRect;\n      });\n    };\n\n    if (isElement$1(node)) {\n      return toArrayWithNode(node.getClientRects());\n    }\n\n    if (isText$1(node)) {\n      var rng = node.ownerDocument.createRange();\n      rng.setStart(node, 0);\n      rng.setEnd(node, node.data.length);\n      return toArrayWithNode(rng.getClientRects());\n    }\n  };\n\n  var getClientRects = function (nodes) {\n    return bind(nodes, getNodeClientRects);\n  };\n\n  var VDirection;\n\n  (function (VDirection) {\n    VDirection[VDirection['Up'] = -1] = 'Up';\n    VDirection[VDirection['Down'] = 1] = 'Down';\n  })(VDirection || (VDirection = {}));\n\n  var findUntil$1 = function (direction, root, predicateFn, node) {\n    while (node = findNode(node, direction, isEditableCaretCandidate, root)) {\n      if (predicateFn(node)) {\n        return;\n      }\n    }\n  };\n\n  var walkUntil = function (direction, isAboveFn, isBeflowFn, root, predicateFn, caretPosition) {\n    var line = 0;\n    var result = [];\n\n    var add = function (node) {\n      var i, clientRect, clientRects;\n      clientRects = getClientRects([node]);\n\n      if (direction === -1) {\n        clientRects = clientRects.reverse();\n      }\n\n      for (i = 0; i < clientRects.length; i++) {\n        clientRect = clientRects[i];\n\n        if (isBeflowFn(clientRect, targetClientRect)) {\n          continue;\n        }\n\n        if (result.length > 0 && isAboveFn(clientRect, last$1(result))) {\n          line++;\n        }\n\n        clientRect.line = line;\n\n        if (predicateFn(clientRect)) {\n          return true;\n        }\n\n        result.push(clientRect);\n      }\n    };\n\n    var targetClientRect = last$1(caretPosition.getClientRects());\n\n    if (!targetClientRect) {\n      return result;\n    }\n\n    var node = caretPosition.getNode();\n    add(node);\n    findUntil$1(direction, root, add, node);\n    return result;\n  };\n\n  var aboveLineNumber = function (lineNumber, clientRect) {\n    return clientRect.line > lineNumber;\n  };\n\n  var isLineNumber = function (lineNumber, clientRect) {\n    return clientRect.line === lineNumber;\n  };\n\n  var upUntil = curry(walkUntil, VDirection.Up, isAbove, isBelow);\n  var downUntil = curry(walkUntil, VDirection.Down, isBelow, isAbove);\n\n  var positionsUntil = function (direction, root, predicateFn, node) {\n    var caretWalker = CaretWalker(root);\n    var walkFn, isBelowFn, isAboveFn, caretPosition;\n    var result = [];\n    var line = 0,\n        clientRect;\n\n    var getClientRect = function (caretPosition) {\n      if (direction === 1) {\n        return last$1(caretPosition.getClientRects());\n      }\n\n      return last$1(caretPosition.getClientRects());\n    };\n\n    if (direction === 1) {\n      walkFn = caretWalker.next;\n      isBelowFn = isBelow;\n      isAboveFn = isAbove;\n      caretPosition = CaretPosition.after(node);\n    } else {\n      walkFn = caretWalker.prev;\n      isBelowFn = isAbove;\n      isAboveFn = isBelow;\n      caretPosition = CaretPosition.before(node);\n    }\n\n    var targetClientRect = getClientRect(caretPosition);\n\n    do {\n      if (!caretPosition.isVisible()) {\n        continue;\n      }\n\n      clientRect = getClientRect(caretPosition);\n\n      if (isAboveFn(clientRect, targetClientRect)) {\n        continue;\n      }\n\n      if (result.length > 0 && isBelowFn(clientRect, last$1(result))) {\n        line++;\n      }\n\n      clientRect = clone$2(clientRect);\n      clientRect.position = caretPosition;\n      clientRect.line = line;\n\n      if (predicateFn(clientRect)) {\n        return result;\n      }\n\n      result.push(clientRect);\n    } while (caretPosition = walkFn(caretPosition));\n\n    return result;\n  };\n\n  var isAboveLine = function (lineNumber) {\n    return function (clientRect) {\n      return aboveLineNumber(lineNumber, clientRect);\n    };\n  };\n\n  var isLine = function (lineNumber) {\n    return function (clientRect) {\n      return isLineNumber(lineNumber, clientRect);\n    };\n  };\n\n  var isContentEditableFalse$8 = isContentEditableFalse;\n  var findNode$1 = findNode;\n\n  var distanceToRectLeft = function (clientRect, clientX) {\n    return Math.abs(clientRect.left - clientX);\n  };\n\n  var distanceToRectRight = function (clientRect, clientX) {\n    return Math.abs(clientRect.right - clientX);\n  };\n\n  var isInsideX = function (clientX, clientRect) {\n    return clientX >= clientRect.left && clientX <= clientRect.right;\n  };\n\n  var isInsideY = function (clientY, clientRect) {\n    return clientY >= clientRect.top && clientY <= clientRect.bottom;\n  };\n\n  var findClosestClientRect = function (clientRects, clientX) {\n    return reduce(clientRects, function (oldClientRect, clientRect) {\n      var oldDistance = Math.min(distanceToRectLeft(oldClientRect, clientX), distanceToRectRight(oldClientRect, clientX));\n      var newDistance = Math.min(distanceToRectLeft(clientRect, clientX), distanceToRectRight(clientRect, clientX));\n\n      if (isInsideX(clientX, clientRect)) {\n        return clientRect;\n      }\n\n      if (isInsideX(clientX, oldClientRect)) {\n        return oldClientRect;\n      }\n\n      if (newDistance === oldDistance && isContentEditableFalse$8(clientRect.node)) {\n        return clientRect;\n      }\n\n      if (newDistance < oldDistance) {\n        return clientRect;\n      }\n\n      return oldClientRect;\n    });\n  };\n\n  var walkUntil$1 = function (direction, root, predicateFn, startNode, includeChildren) {\n    var node = findNode$1(startNode, direction, isEditableCaretCandidate, root, !includeChildren);\n\n    do {\n      if (!node || predicateFn(node)) {\n        return;\n      }\n    } while (node = findNode$1(node, direction, isEditableCaretCandidate, root));\n  };\n\n  var findLineNodeRects = function (root, targetNodeRect, includeChildren) {\n    if (includeChildren === void 0) {\n      includeChildren = true;\n    }\n\n    var clientRects = [];\n\n    var collect = function (checkPosFn, node) {\n      var lineRects = filter(getClientRects([node]), function (clientRect) {\n        return !checkPosFn(clientRect, targetNodeRect);\n      });\n      clientRects = clientRects.concat(lineRects);\n      return lineRects.length === 0;\n    };\n\n    clientRects.push(targetNodeRect);\n    walkUntil$1(VDirection.Up, root, curry(collect, isAbove), targetNodeRect.node, includeChildren);\n    walkUntil$1(VDirection.Down, root, curry(collect, isBelow), targetNodeRect.node, includeChildren);\n    return clientRects;\n  };\n\n  var getFakeCaretTargets = function (root) {\n    return filter(from$1(root.getElementsByTagName('*')), isFakeCaretTarget);\n  };\n\n  var caretInfo = function (clientRect, clientX) {\n    return {\n      node: clientRect.node,\n      before: distanceToRectLeft(clientRect, clientX) < distanceToRectRight(clientRect, clientX)\n    };\n  };\n\n  var closestFakeCaret = function (root, clientX, clientY) {\n    var fakeTargetNodeRects = getClientRects(getFakeCaretTargets(root));\n    var targetNodeRects = filter(fakeTargetNodeRects, curry(isInsideY, clientY));\n    var closestNodeRect = findClosestClientRect(targetNodeRects, clientX);\n\n    if (closestNodeRect) {\n      var includeChildren = !isTable(closestNodeRect.node) && !isMedia(closestNodeRect.node);\n      closestNodeRect = findClosestClientRect(findLineNodeRects(root, closestNodeRect, includeChildren), clientX);\n\n      if (closestNodeRect && isFakeCaretTarget(closestNodeRect.node)) {\n        return caretInfo(closestNodeRect, clientX);\n      }\n    }\n\n    return null;\n  };\n\n  var moveToRange = function (editor, rng) {\n    editor.selection.setRng(rng);\n    scrollRangeIntoView(editor, editor.selection.getRng());\n  };\n\n  var renderRangeCaretOpt = function (editor, range, scrollIntoView) {\n    return Optional.some(renderRangeCaret(editor, range, scrollIntoView));\n  };\n\n  var moveHorizontally = function (editor, direction, range, isBefore, isAfter, isElement) {\n    var forwards = direction === HDirection.Forwards;\n    var caretWalker = CaretWalker(editor.getBody());\n    var getNextPosFn = curry(getVisualCaretPosition, forwards ? caretWalker.next : caretWalker.prev);\n    var isBeforeFn = forwards ? isBefore : isAfter;\n\n    if (!range.collapsed) {\n      var node = getSelectedNode(range);\n\n      if (isElement(node)) {\n        return showCaret(direction, editor, node, direction === HDirection.Backwards, false);\n      }\n    }\n\n    var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n\n    if (isBeforeFn(caretPosition)) {\n      return selectNode(editor, caretPosition.getNode(!forwards));\n    }\n\n    var nextCaretPosition = normalizePosition(forwards, getNextPosFn(caretPosition));\n    var rangeIsInContainerBlock = isRangeInCaretContainerBlock(range);\n\n    if (!nextCaretPosition) {\n      return rangeIsInContainerBlock ? Optional.some(range) : Optional.none();\n    }\n\n    if (isBeforeFn(nextCaretPosition)) {\n      return showCaret(direction, editor, nextCaretPosition.getNode(!forwards), forwards, false);\n    }\n\n    var peekCaretPosition = getNextPosFn(nextCaretPosition);\n\n    if (peekCaretPosition && isBeforeFn(peekCaretPosition)) {\n      if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n        return showCaret(direction, editor, peekCaretPosition.getNode(!forwards), forwards, false);\n      }\n    }\n\n    if (rangeIsInContainerBlock) {\n      return renderRangeCaretOpt(editor, nextCaretPosition.toRange(), false);\n    }\n\n    return Optional.none();\n  };\n\n  var moveVertically = function (editor, direction, range, isBefore, isAfter, isElement) {\n    var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n    var caretClientRect = last$1(caretPosition.getClientRects());\n    var forwards = direction === VDirection.Down;\n\n    if (!caretClientRect) {\n      return Optional.none();\n    }\n\n    var walkerFn = forwards ? downUntil : upUntil;\n    var linePositions = walkerFn(editor.getBody(), isAboveLine(1), caretPosition);\n    var nextLinePositions = filter(linePositions, isLine(1));\n    var clientX = caretClientRect.left;\n    var nextLineRect = findClosestClientRect(nextLinePositions, clientX);\n\n    if (nextLineRect && isElement(nextLineRect.node)) {\n      var dist1 = Math.abs(clientX - nextLineRect.left);\n      var dist2 = Math.abs(clientX - nextLineRect.right);\n      return showCaret(direction, editor, nextLineRect.node, dist1 < dist2, false);\n    }\n\n    var currentNode;\n\n    if (isBefore(caretPosition)) {\n      currentNode = caretPosition.getNode();\n    } else if (isAfter(caretPosition)) {\n      currentNode = caretPosition.getNode(true);\n    } else {\n      currentNode = getSelectedNode(range);\n    }\n\n    if (currentNode) {\n      var caretPositions = positionsUntil(direction, editor.getBody(), isAboveLine(1), currentNode);\n      var closestNextLineRect = findClosestClientRect(filter(caretPositions, isLine(1)), clientX);\n\n      if (closestNextLineRect) {\n        return renderRangeCaretOpt(editor, closestNextLineRect.position.toRange(), false);\n      }\n\n      closestNextLineRect = last$1(filter(caretPositions, isLine(0)));\n\n      if (closestNextLineRect) {\n        return renderRangeCaretOpt(editor, closestNextLineRect.position.toRange(), false);\n      }\n    }\n\n    if (nextLinePositions.length === 0) {\n      return getLineEndPoint(editor, forwards).filter(forwards ? isAfter : isBefore).map(function (pos) {\n        return renderRangeCaret(editor, pos.toRange(), false);\n      });\n    }\n\n    return Optional.none();\n  };\n\n  var getLineEndPoint = function (editor, forward) {\n    var rng = editor.selection.getRng();\n    var body = editor.getBody();\n\n    if (forward) {\n      var from = CaretPosition.fromRangeEnd(rng);\n      var result = getPositionsUntilNextLine(body, from);\n      return last(result.positions);\n    } else {\n      var from = CaretPosition.fromRangeStart(rng);\n      var result = getPositionsUntilPreviousLine(body, from);\n      return head(result.positions);\n    }\n  };\n\n  var moveToLineEndPoint = function (editor, forward, isElementPosition) {\n    return getLineEndPoint(editor, forward).filter(isElementPosition).exists(function (pos) {\n      editor.selection.setRng(pos.toRange());\n      return true;\n    });\n  };\n\n  var isContentEditableFalse$9 = isContentEditableFalse;\n\n  var moveToCeFalseHorizontally = function (direction, editor, range) {\n    return moveHorizontally(editor, direction, range, isBeforeContentEditableFalse, isAfterContentEditableFalse, isContentEditableFalse$9);\n  };\n\n  var moveToCeFalseVertically = function (direction, editor, range) {\n    var isBefore = function (caretPosition) {\n      return isBeforeContentEditableFalse(caretPosition) || isBeforeTable(caretPosition);\n    };\n\n    var isAfter = function (caretPosition) {\n      return isAfterContentEditableFalse(caretPosition) || isAfterTable(caretPosition);\n    };\n\n    return moveVertically(editor, direction, range, isBefore, isAfter, isContentEditableFalse$9);\n  };\n\n  var createTextBlock = function (editor) {\n    var textBlock = editor.dom.create(getForcedRootBlock(editor));\n\n    if (!Env.ie || Env.ie >= 11) {\n      textBlock.innerHTML = '<br data-mce-bogus=\"1\">';\n    }\n\n    return textBlock;\n  };\n\n  var exitPreBlock = function (editor, direction, range) {\n    var caretWalker = CaretWalker(editor.getBody());\n    var getVisualCaretPosition$1 = curry(getVisualCaretPosition, direction === 1 ? caretWalker.next : caretWalker.prev);\n\n    if (range.collapsed && hasForcedRootBlock(editor)) {\n      var pre = editor.dom.getParent(range.startContainer, 'PRE');\n\n      if (!pre) {\n        return;\n      }\n\n      var caretPos = getVisualCaretPosition$1(CaretPosition.fromRangeStart(range));\n\n      if (!caretPos) {\n        var newBlock = createTextBlock(editor);\n\n        if (direction === 1) {\n          editor.$(pre).after(newBlock);\n        } else {\n          editor.$(pre).before(newBlock);\n        }\n\n        editor.selection.select(newBlock, true);\n        editor.selection.collapse();\n      }\n    }\n  };\n\n  var getHorizontalRange = function (editor, forward) {\n    var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n    var range = editor.selection.getRng();\n    return moveToCeFalseHorizontally(direction, editor, range).orThunk(function () {\n      exitPreBlock(editor, direction, range);\n      return Optional.none();\n    });\n  };\n\n  var getVerticalRange = function (editor, down) {\n    var direction = down ? 1 : -1;\n    var range = editor.selection.getRng();\n    return moveToCeFalseVertically(direction, editor, range).orThunk(function () {\n      exitPreBlock(editor, direction, range);\n      return Optional.none();\n    });\n  };\n\n  var moveH = function (editor, forward) {\n    return getHorizontalRange(editor, forward).exists(function (newRange) {\n      moveToRange(editor, newRange);\n      return true;\n    });\n  };\n\n  var moveV = function (editor, down) {\n    return getVerticalRange(editor, down).exists(function (newRange) {\n      moveToRange(editor, newRange);\n      return true;\n    });\n  };\n\n  var moveToLineEndPoint$1 = function (editor, forward) {\n    var isCefPosition = forward ? isAfterContentEditableFalse : isBeforeContentEditableFalse;\n    return moveToLineEndPoint(editor, forward, isCefPosition);\n  };\n\n  var isTarget = function (node) {\n    return contains(['figcaption'], name(node));\n  };\n\n  var rangeBefore = function (target) {\n    var rng = document.createRange();\n    rng.setStartBefore(target.dom);\n    rng.setEndBefore(target.dom);\n    return rng;\n  };\n\n  var insertElement = function (root, elm, forward) {\n    if (forward) {\n      append(root, elm);\n    } else {\n      prepend(root, elm);\n    }\n  };\n\n  var insertBr = function (root, forward) {\n    var br = SugarElement.fromTag('br');\n    insertElement(root, br, forward);\n    return rangeBefore(br);\n  };\n\n  var insertBlock$1 = function (root, forward, blockName, attrs) {\n    var block = SugarElement.fromTag(blockName);\n    var br = SugarElement.fromTag('br');\n    setAll(block, attrs);\n    append(block, br);\n    insertElement(root, block, forward);\n    return rangeBefore(br);\n  };\n\n  var insertEmptyLine = function (root, rootBlockName, attrs, forward) {\n    if (rootBlockName === '') {\n      return insertBr(root, forward);\n    } else {\n      return insertBlock$1(root, forward, rootBlockName, attrs);\n    }\n  };\n\n  var getClosestTargetBlock = function (pos, root) {\n    var isRoot = curry(eq$2, root);\n    return closest(SugarElement.fromDom(pos.container()), isBlock, isRoot).filter(isTarget);\n  };\n\n  var isAtFirstOrLastLine = function (root, forward, pos) {\n    return forward ? isAtLastLine(root.dom, pos) : isAtFirstLine(root.dom, pos);\n  };\n\n  var moveCaretToNewEmptyLine = function (editor, forward) {\n    var root = SugarElement.fromDom(editor.getBody());\n    var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n    var rootBlock = getForcedRootBlock(editor);\n    var rootBlockAttrs = getForcedRootBlockAttrs(editor);\n    return getClosestTargetBlock(pos, root).exists(function () {\n      if (isAtFirstOrLastLine(root, forward, pos)) {\n        var rng = insertEmptyLine(root, rootBlock, rootBlockAttrs, forward);\n        editor.selection.setRng(rng);\n        return true;\n      } else {\n        return false;\n      }\n    });\n  };\n\n  var moveV$1 = function (editor, forward) {\n    if (editor.selection.isCollapsed()) {\n      return moveCaretToNewEmptyLine(editor, forward);\n    } else {\n      return false;\n    }\n  };\n\n  var defaultPatterns = function (patterns) {\n    return map(patterns, function (pattern) {\n      return __assign({\n        shiftKey: false,\n        altKey: false,\n        ctrlKey: false,\n        metaKey: false,\n        keyCode: 0,\n        action: noop\n      }, pattern);\n    });\n  };\n\n  var matchesEvent = function (pattern, evt) {\n    return evt.keyCode === pattern.keyCode && evt.shiftKey === pattern.shiftKey && evt.altKey === pattern.altKey && evt.ctrlKey === pattern.ctrlKey && evt.metaKey === pattern.metaKey;\n  };\n\n  var match$1 = function (patterns, evt) {\n    return bind(defaultPatterns(patterns), function (pattern) {\n      return matchesEvent(pattern, evt) ? [pattern] : [];\n    });\n  };\n\n  var action = function (f) {\n    var x = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      x[_i - 1] = arguments[_i];\n    }\n\n    return function () {\n      return f.apply(null, x);\n    };\n  };\n\n  var execute = function (patterns, evt) {\n    return find(match$1(patterns, evt), function (pattern) {\n      return pattern.action();\n    });\n  };\n\n  var moveH$1 = function (editor, forward) {\n    var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n    var range = editor.selection.getRng();\n    return moveHorizontally(editor, direction, range, isBeforeMedia, isAfterMedia, isMedia).exists(function (newRange) {\n      moveToRange(editor, newRange);\n      return true;\n    });\n  };\n\n  var moveV$2 = function (editor, down) {\n    var direction = down ? 1 : -1;\n    var range = editor.selection.getRng();\n    return moveVertically(editor, direction, range, isBeforeMedia, isAfterMedia, isMedia).exists(function (newRange) {\n      moveToRange(editor, newRange);\n      return true;\n    });\n  };\n\n  var moveToLineEndPoint$2 = function (editor, forward) {\n    var isNearMedia = forward ? isAfterMedia : isBeforeMedia;\n    return moveToLineEndPoint(editor, forward, isNearMedia);\n  };\n\n  var deflate = function (rect, delta) {\n    return {\n      left: rect.left - delta,\n      top: rect.top - delta,\n      right: rect.right + delta * 2,\n      bottom: rect.bottom + delta * 2,\n      width: rect.width + delta,\n      height: rect.height + delta\n    };\n  };\n\n  var getCorners = function (getYAxisValue, tds) {\n    return bind(tds, function (td) {\n      var rect = deflate(clone$2(td.getBoundingClientRect()), -1);\n      return [{\n        x: rect.left,\n        y: getYAxisValue(rect),\n        cell: td\n      }, {\n        x: rect.right,\n        y: getYAxisValue(rect),\n        cell: td\n      }];\n    });\n  };\n\n  var findClosestCorner = function (corners, x, y) {\n    return foldl(corners, function (acc, newCorner) {\n      return acc.fold(function () {\n        return Optional.some(newCorner);\n      }, function (oldCorner) {\n        var oldDist = Math.sqrt(Math.abs(oldCorner.x - x) + Math.abs(oldCorner.y - y));\n        var newDist = Math.sqrt(Math.abs(newCorner.x - x) + Math.abs(newCorner.y - y));\n        return Optional.some(newDist < oldDist ? newCorner : oldCorner);\n      });\n    }, Optional.none());\n  };\n\n  var getClosestCell$1 = function (getYAxisValue, isTargetCorner, table, x, y) {\n    var cells = descendants$1(SugarElement.fromDom(table), 'td,th,caption').map(function (e) {\n      return e.dom;\n    });\n    var corners = filter(getCorners(getYAxisValue, cells), function (corner) {\n      return isTargetCorner(corner, y);\n    });\n    return findClosestCorner(corners, x, y).map(function (corner) {\n      return corner.cell;\n    });\n  };\n\n  var getBottomValue = function (rect) {\n    return rect.bottom;\n  };\n\n  var getTopValue = function (rect) {\n    return rect.top;\n  };\n\n  var isAbove$1 = function (corner, y) {\n    return corner.y < y;\n  };\n\n  var isBelow$1 = function (corner, y) {\n    return corner.y > y;\n  };\n\n  var getClosestCellAbove = curry(getClosestCell$1, getBottomValue, isAbove$1);\n  var getClosestCellBelow = curry(getClosestCell$1, getTopValue, isBelow$1);\n\n  var findClosestPositionInAboveCell = function (table, pos) {\n    return head(pos.getClientRects()).bind(function (rect) {\n      return getClosestCellAbove(table, rect.left, rect.top);\n    }).bind(function (cell) {\n      return findClosestHorizontalPosition(getLastLinePositions(cell), pos);\n    });\n  };\n\n  var findClosestPositionInBelowCell = function (table, pos) {\n    return last(pos.getClientRects()).bind(function (rect) {\n      return getClosestCellBelow(table, rect.left, rect.top);\n    }).bind(function (cell) {\n      return findClosestHorizontalPosition(getFirstLinePositions(cell), pos);\n    });\n  };\n\n  var hasNextBreak = function (getPositionsUntil, scope, lineInfo) {\n    return lineInfo.breakAt.exists(function (breakPos) {\n      return getPositionsUntil(scope, breakPos).breakAt.isSome();\n    });\n  };\n\n  var startsWithWrapBreak = function (lineInfo) {\n    return lineInfo.breakType === BreakType.Wrap && lineInfo.positions.length === 0;\n  };\n\n  var startsWithBrBreak = function (lineInfo) {\n    return lineInfo.breakType === BreakType.Br && lineInfo.positions.length === 1;\n  };\n\n  var isAtTableCellLine = function (getPositionsUntil, scope, pos) {\n    var lineInfo = getPositionsUntil(scope, pos);\n\n    if (startsWithWrapBreak(lineInfo) || !isBr(pos.getNode()) && startsWithBrBreak(lineInfo)) {\n      return !hasNextBreak(getPositionsUntil, scope, lineInfo);\n    } else {\n      return lineInfo.breakAt.isNone();\n    }\n  };\n\n  var isAtFirstTableCellLine = curry(isAtTableCellLine, getPositionsUntilPreviousLine);\n  var isAtLastTableCellLine = curry(isAtTableCellLine, getPositionsUntilNextLine);\n\n  var isCaretAtStartOrEndOfTable = function (forward, rng, table) {\n    var caretPos = CaretPosition.fromRangeStart(rng);\n    return positionIn(!forward, table).exists(function (pos) {\n      return pos.isEqual(caretPos);\n    });\n  };\n\n  var navigateHorizontally = function (editor, forward, table, _td) {\n    var rng = editor.selection.getRng();\n    var direction = forward ? 1 : -1;\n\n    if (isFakeCaretTableBrowser() && isCaretAtStartOrEndOfTable(forward, rng, table)) {\n      showCaret(direction, editor, table, !forward, false).each(function (newRng) {\n        moveToRange(editor, newRng);\n      });\n      return true;\n    }\n\n    return false;\n  };\n\n  var getClosestAbovePosition = function (root, table, start) {\n    return findClosestPositionInAboveCell(table, start).orThunk(function () {\n      return head(start.getClientRects()).bind(function (rect) {\n        return findClosestHorizontalPositionFromPoint(getPositionsAbove(root, CaretPosition.before(table)), rect.left);\n      });\n    }).getOr(CaretPosition.before(table));\n  };\n\n  var getClosestBelowPosition = function (root, table, start) {\n    return findClosestPositionInBelowCell(table, start).orThunk(function () {\n      return head(start.getClientRects()).bind(function (rect) {\n        return findClosestHorizontalPositionFromPoint(getPositionsBelow(root, CaretPosition.after(table)), rect.left);\n      });\n    }).getOr(CaretPosition.after(table));\n  };\n\n  var getTable = function (previous, pos) {\n    var node = pos.getNode(previous);\n    return isElement$1(node) && node.nodeName === 'TABLE' ? Optional.some(node) : Optional.none();\n  };\n\n  var renderBlock = function (down, editor, table, pos) {\n    var forcedRootBlock = getForcedRootBlock(editor);\n\n    if (forcedRootBlock) {\n      editor.undoManager.transact(function () {\n        var element = SugarElement.fromTag(forcedRootBlock);\n        setAll(element, getForcedRootBlockAttrs(editor));\n        append(element, SugarElement.fromTag('br'));\n\n        if (down) {\n          after(SugarElement.fromDom(table), element);\n        } else {\n          before(SugarElement.fromDom(table), element);\n        }\n\n        var rng = editor.dom.createRng();\n        rng.setStart(element.dom, 0);\n        rng.setEnd(element.dom, 0);\n        moveToRange(editor, rng);\n      });\n    } else {\n      moveToRange(editor, pos.toRange());\n    }\n  };\n\n  var moveCaret = function (editor, down, pos) {\n    var table = down ? getTable(true, pos) : getTable(false, pos);\n    var last = down === false;\n    table.fold(function () {\n      return moveToRange(editor, pos.toRange());\n    }, function (table) {\n      return positionIn(last, editor.getBody()).filter(function (lastPos) {\n        return lastPos.isEqual(pos);\n      }).fold(function () {\n        return moveToRange(editor, pos.toRange());\n      }, function (_) {\n        return renderBlock(down, editor, table, pos);\n      });\n    });\n  };\n\n  var navigateVertically = function (editor, down, table, td) {\n    var rng = editor.selection.getRng();\n    var pos = CaretPosition.fromRangeStart(rng);\n    var root = editor.getBody();\n\n    if (!down && isAtFirstTableCellLine(td, pos)) {\n      var newPos = getClosestAbovePosition(root, table, pos);\n      moveCaret(editor, down, newPos);\n      return true;\n    } else if (down && isAtLastTableCellLine(td, pos)) {\n      var newPos = getClosestBelowPosition(root, table, pos);\n      moveCaret(editor, down, newPos);\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var move$1 = function (editor, forward, mover) {\n    return Optional.from(editor.dom.getParent(editor.selection.getNode(), 'td,th')).bind(function (td) {\n      return Optional.from(editor.dom.getParent(td, 'table')).map(function (table) {\n        return mover(editor, forward, table, td);\n      });\n    }).getOr(false);\n  };\n\n  var moveH$2 = function (editor, forward) {\n    return move$1(editor, forward, navigateHorizontally);\n  };\n\n  var moveV$3 = function (editor, forward) {\n    return move$1(editor, forward, navigateVertically);\n  };\n\n  var executeKeydownOverride = function (editor, caret, evt) {\n    var os = detect$3().os;\n    execute([{\n      keyCode: VK.RIGHT,\n      action: action(moveH, editor, true)\n    }, {\n      keyCode: VK.LEFT,\n      action: action(moveH, editor, false)\n    }, {\n      keyCode: VK.UP,\n      action: action(moveV, editor, false)\n    }, {\n      keyCode: VK.DOWN,\n      action: action(moveV, editor, true)\n    }, {\n      keyCode: VK.RIGHT,\n      action: action(moveH$2, editor, true)\n    }, {\n      keyCode: VK.LEFT,\n      action: action(moveH$2, editor, false)\n    }, {\n      keyCode: VK.UP,\n      action: action(moveV$3, editor, false)\n    }, {\n      keyCode: VK.DOWN,\n      action: action(moveV$3, editor, true)\n    }, {\n      keyCode: VK.RIGHT,\n      action: action(moveH$1, editor, true)\n    }, {\n      keyCode: VK.LEFT,\n      action: action(moveH$1, editor, false)\n    }, {\n      keyCode: VK.UP,\n      action: action(moveV$2, editor, false)\n    }, {\n      keyCode: VK.DOWN,\n      action: action(moveV$2, editor, true)\n    }, {\n      keyCode: VK.RIGHT,\n      action: action(move, editor, caret, true)\n    }, {\n      keyCode: VK.LEFT,\n      action: action(move, editor, caret, false)\n    }, {\n      keyCode: VK.RIGHT,\n      ctrlKey: !os.isOSX(),\n      altKey: os.isOSX(),\n      action: action(moveNextWord, editor, caret)\n    }, {\n      keyCode: VK.LEFT,\n      ctrlKey: !os.isOSX(),\n      altKey: os.isOSX(),\n      action: action(movePrevWord, editor, caret)\n    }, {\n      keyCode: VK.UP,\n      action: action(moveV$1, editor, false)\n    }, {\n      keyCode: VK.DOWN,\n      action: action(moveV$1, editor, true)\n    }], evt).each(function (_) {\n      evt.preventDefault();\n    });\n  };\n\n  var setup$c = function (editor, caret) {\n    editor.on('keydown', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeydownOverride(editor, caret, evt);\n      }\n    });\n  };\n\n  var executeKeydownOverride$1 = function (editor, caret, evt) {\n    execute([{\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$9, editor, false)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$4, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$4, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$3, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$3, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$6, editor, caret, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$6, editor, caret, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$5, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$5, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$8, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$8, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$2, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$2, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$1, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$1, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$7, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$7, editor, true)\n    }], evt).each(function (_) {\n      evt.preventDefault();\n    });\n  };\n\n  var executeKeyupOverride = function (editor, evt) {\n    execute([{\n      keyCode: VK.BACKSPACE,\n      action: action(paddEmptyElement, editor)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(paddEmptyElement, editor)\n    }], evt);\n  };\n\n  var setup$d = function (editor, caret) {\n    editor.on('keydown', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeydownOverride$1(editor, caret, evt);\n      }\n    });\n    editor.on('keyup', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeyupOverride(editor, evt);\n      }\n    });\n  };\n\n  var firstNonWhiteSpaceNodeSibling = function (node) {\n    while (node) {\n      if (node.nodeType === 1 || node.nodeType === 3 && node.data && /[\\r\\n\\s]/.test(node.data)) {\n        return node;\n      }\n\n      node = node.nextSibling;\n    }\n  };\n\n  var moveToCaretPosition = function (editor, root) {\n    var node,\n        lastNode = root;\n    var dom = editor.dom;\n    var moveCaretBeforeOnEnterElementsMap = editor.schema.getMoveCaretBeforeOnEnterElements();\n\n    if (!root) {\n      return;\n    }\n\n    if (/^(LI|DT|DD)$/.test(root.nodeName)) {\n      var firstChild = firstNonWhiteSpaceNodeSibling(root.firstChild);\n\n      if (firstChild && /^(UL|OL|DL)$/.test(firstChild.nodeName)) {\n        root.insertBefore(dom.doc.createTextNode(nbsp), root.firstChild);\n      }\n    }\n\n    var rng = dom.createRng();\n    root.normalize();\n\n    if (root.hasChildNodes()) {\n      var walker = new DomTreeWalker(root, root);\n\n      while (node = walker.current()) {\n        if (isText$1(node)) {\n          rng.setStart(node, 0);\n          rng.setEnd(node, 0);\n          break;\n        }\n\n        if (moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]) {\n          rng.setStartBefore(node);\n          rng.setEndBefore(node);\n          break;\n        }\n\n        lastNode = node;\n        node = walker.next();\n      }\n\n      if (!node) {\n        rng.setStart(lastNode, 0);\n        rng.setEnd(lastNode, 0);\n      }\n    } else {\n      if (isBr(root)) {\n        if (root.nextSibling && dom.isBlock(root.nextSibling)) {\n          rng.setStartBefore(root);\n          rng.setEndBefore(root);\n        } else {\n          rng.setStartAfter(root);\n          rng.setEndAfter(root);\n        }\n      } else {\n        rng.setStart(root, 0);\n        rng.setEnd(root, 0);\n      }\n    }\n\n    editor.selection.setRng(rng);\n    scrollRangeIntoView(editor, rng);\n  };\n\n  var getEditableRoot = function (dom, node) {\n    var root = dom.getRoot();\n    var parent, editableRoot;\n    parent = node;\n\n    while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n      if (dom.getContentEditable(parent) === 'true') {\n        editableRoot = parent;\n      }\n\n      parent = parent.parentNode;\n    }\n\n    return parent !== root ? editableRoot : root;\n  };\n\n  var getParentBlock$2 = function (editor) {\n    return Optional.from(editor.dom.getParent(editor.selection.getStart(true), editor.dom.isBlock));\n  };\n\n  var getParentBlockName = function (editor) {\n    return getParentBlock$2(editor).fold(constant(''), function (parentBlock) {\n      return parentBlock.nodeName.toUpperCase();\n    });\n  };\n\n  var isListItemParentBlock = function (editor) {\n    return getParentBlock$2(editor).filter(function (elm) {\n      return isListItem(SugarElement.fromDom(elm));\n    }).isSome();\n  };\n\n  var hasFirstChild = function (elm, name) {\n    return elm.firstChild && elm.firstChild.nodeName === name;\n  };\n\n  var isFirstChild = function (elm) {\n    var _a;\n\n    return ((_a = elm.parentNode) === null || _a === void 0 ? void 0 : _a.firstChild) === elm;\n  };\n\n  var hasParent$1 = function (elm, parentName) {\n    return elm && elm.parentNode && elm.parentNode.nodeName === parentName;\n  };\n\n  var isListBlock = function (elm) {\n    return elm && /^(OL|UL|LI)$/.test(elm.nodeName);\n  };\n\n  var isNestedList = function (elm) {\n    return isListBlock(elm) && isListBlock(elm.parentNode);\n  };\n\n  var getContainerBlock = function (containerBlock) {\n    var containerBlockParent = containerBlock.parentNode;\n\n    if (/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)) {\n      return containerBlockParent;\n    }\n\n    return containerBlock;\n  };\n\n  var isFirstOrLastLi = function (containerBlock, parentBlock, first) {\n    var node = containerBlock[first ? 'firstChild' : 'lastChild'];\n\n    while (node) {\n      if (isElement$1(node)) {\n        break;\n      }\n\n      node = node[first ? 'nextSibling' : 'previousSibling'];\n    }\n\n    return node === parentBlock;\n  };\n\n  var insert = function (editor, createNewBlock, containerBlock, parentBlock, newBlockName) {\n    var dom = editor.dom;\n    var rng = editor.selection.getRng();\n\n    if (containerBlock === editor.getBody()) {\n      return;\n    }\n\n    if (isNestedList(containerBlock)) {\n      newBlockName = 'LI';\n    }\n\n    var newBlock = newBlockName ? createNewBlock(newBlockName) : dom.create('BR');\n\n    if (isFirstOrLastLi(containerBlock, parentBlock, true) && isFirstOrLastLi(containerBlock, parentBlock, false)) {\n      if (hasParent$1(containerBlock, 'LI')) {\n        var containerBlockParent = getContainerBlock(containerBlock);\n        dom.insertAfter(newBlock, containerBlockParent);\n\n        if (isFirstChild(containerBlock)) {\n          dom.remove(containerBlockParent);\n        } else {\n          dom.remove(containerBlock);\n        }\n      } else {\n        dom.replace(newBlock, containerBlock);\n      }\n    } else if (isFirstOrLastLi(containerBlock, parentBlock, true)) {\n      if (hasParent$1(containerBlock, 'LI')) {\n        dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n        newBlock.appendChild(dom.doc.createTextNode(' '));\n        newBlock.appendChild(containerBlock);\n      } else {\n        containerBlock.parentNode.insertBefore(newBlock, containerBlock);\n      }\n\n      dom.remove(parentBlock);\n    } else if (isFirstOrLastLi(containerBlock, parentBlock, false)) {\n      dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n      dom.remove(parentBlock);\n    } else {\n      containerBlock = getContainerBlock(containerBlock);\n      var tmpRng = rng.cloneRange();\n      tmpRng.setStartAfter(parentBlock);\n      tmpRng.setEndAfter(containerBlock);\n      var fragment = tmpRng.extractContents();\n\n      if (newBlockName === 'LI' && hasFirstChild(fragment, 'LI')) {\n        newBlock = fragment.firstChild;\n        dom.insertAfter(fragment, containerBlock);\n      } else {\n        dom.insertAfter(fragment, containerBlock);\n        dom.insertAfter(newBlock, containerBlock);\n      }\n\n      dom.remove(parentBlock);\n    }\n\n    moveToCaretPosition(editor, newBlock);\n  };\n\n  var trimZwsp = function (fragment) {\n    each(descendants(SugarElement.fromDom(fragment), isText), function (text) {\n      var rawNode = text.dom;\n      rawNode.nodeValue = trim$2(rawNode.nodeValue);\n    });\n  };\n\n  var isEmptyAnchor = function (dom, elm) {\n    return elm && elm.nodeName === 'A' && dom.isEmpty(elm);\n  };\n\n  var isTableCell$5 = function (node) {\n    return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n  };\n\n  var emptyBlock = function (elm) {\n    elm.innerHTML = '<br data-mce-bogus=\"1\">';\n  };\n\n  var containerAndSiblingName = function (container, nodeName) {\n    return container.nodeName === nodeName || container.previousSibling && container.previousSibling.nodeName === nodeName;\n  };\n\n  var canSplitBlock = function (dom, node) {\n    return node && dom.isBlock(node) && !/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName) && !/^(fixed|absolute)/i.test(node.style.position) && dom.getContentEditable(node) !== 'true';\n  };\n\n  var trimInlineElementsOnLeftSideOfBlock = function (dom, nonEmptyElementsMap, block) {\n    var node = block;\n    var firstChilds = [];\n    var i;\n\n    if (!node) {\n      return;\n    }\n\n    while (node = node.firstChild) {\n      if (dom.isBlock(node)) {\n        return;\n      }\n\n      if (isElement$1(node) && !nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n        firstChilds.push(node);\n      }\n    }\n\n    i = firstChilds.length;\n\n    while (i--) {\n      node = firstChilds[i];\n\n      if (!node.hasChildNodes() || node.firstChild === node.lastChild && node.firstChild.nodeValue === '') {\n        dom.remove(node);\n      } else {\n        if (isEmptyAnchor(dom, node)) {\n          dom.remove(node);\n        }\n      }\n    }\n  };\n\n  var normalizeZwspOffset = function (start, container, offset) {\n    if (isText$1(container) === false) {\n      return offset;\n    } else if (start) {\n      return offset === 1 && container.data.charAt(offset - 1) === ZWSP ? 0 : offset;\n    } else {\n      return offset === container.data.length - 1 && container.data.charAt(offset) === ZWSP ? container.data.length : offset;\n    }\n  };\n\n  var includeZwspInRange = function (rng) {\n    var newRng = rng.cloneRange();\n    newRng.setStart(rng.startContainer, normalizeZwspOffset(true, rng.startContainer, rng.startOffset));\n    newRng.setEnd(rng.endContainer, normalizeZwspOffset(false, rng.endContainer, rng.endOffset));\n    return newRng;\n  };\n\n  var trimLeadingLineBreaks = function (node) {\n    do {\n      if (isText$1(node)) {\n        node.nodeValue = node.nodeValue.replace(/^[\\r\\n]+/, '');\n      }\n\n      node = node.firstChild;\n    } while (node);\n  };\n\n  var getEditableRoot$1 = function (dom, node) {\n    var root = dom.getRoot();\n    var parent, editableRoot;\n    parent = node;\n\n    while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n      if (dom.getContentEditable(parent) === 'true') {\n        editableRoot = parent;\n      }\n\n      parent = parent.parentNode;\n    }\n\n    return parent !== root ? editableRoot : root;\n  };\n\n  var applyAttributes = function (editor, node, forcedRootBlockAttrs) {\n    var dom = editor.dom;\n    Optional.from(forcedRootBlockAttrs.style).map(dom.parseStyle).each(function (attrStyles) {\n      var currentStyles = getAllRaw(SugarElement.fromDom(node));\n\n      var newStyles = __assign(__assign({}, currentStyles), attrStyles);\n\n      dom.setStyles(node, newStyles);\n    });\n    var attrClassesOpt = Optional.from(forcedRootBlockAttrs.class).map(function (attrClasses) {\n      return attrClasses.split(/\\s+/);\n    });\n    var currentClassesOpt = Optional.from(node.className).map(function (currentClasses) {\n      return filter(currentClasses.split(/\\s+/), function (clazz) {\n        return clazz !== '';\n      });\n    });\n    lift2(attrClassesOpt, currentClassesOpt, function (attrClasses, currentClasses) {\n      var filteredClasses = filter(currentClasses, function (clazz) {\n        return !contains(attrClasses, clazz);\n      });\n\n      var newClasses = __spreadArrays(attrClasses, filteredClasses);\n\n      dom.setAttrib(node, 'class', newClasses.join(' '));\n    });\n    var appliedAttrs = ['style', 'class'];\n    var remainingAttrs = filter$1(forcedRootBlockAttrs, function (_, attrs) {\n      return !contains(appliedAttrs, attrs);\n    });\n    dom.setAttribs(node, remainingAttrs);\n  };\n\n  var setForcedBlockAttrs = function (editor, node) {\n    var forcedRootBlockName = getForcedRootBlock(editor);\n\n    if (forcedRootBlockName && forcedRootBlockName.toLowerCase() === node.tagName.toLowerCase()) {\n      var forcedRootBlockAttrs = getForcedRootBlockAttrs(editor);\n      applyAttributes(editor, node, forcedRootBlockAttrs);\n    }\n  };\n\n  var wrapSelfAndSiblingsInDefaultBlock = function (editor, newBlockName, rng, container, offset) {\n    var newBlock, parentBlock, startNode, node, next, rootBlockName;\n    var blockName = newBlockName || 'P';\n    var dom = editor.dom,\n        editableRoot = getEditableRoot$1(dom, container);\n    parentBlock = dom.getParent(container, dom.isBlock);\n\n    if (!parentBlock || !canSplitBlock(dom, parentBlock)) {\n      parentBlock = parentBlock || editableRoot;\n\n      if (parentBlock === editor.getBody() || isTableCell$5(parentBlock)) {\n        rootBlockName = parentBlock.nodeName.toLowerCase();\n      } else {\n        rootBlockName = parentBlock.parentNode.nodeName.toLowerCase();\n      }\n\n      if (!parentBlock.hasChildNodes()) {\n        newBlock = dom.create(blockName);\n        setForcedBlockAttrs(editor, newBlock);\n        parentBlock.appendChild(newBlock);\n        rng.setStart(newBlock, 0);\n        rng.setEnd(newBlock, 0);\n        return newBlock;\n      }\n\n      node = container;\n\n      while (node.parentNode !== parentBlock) {\n        node = node.parentNode;\n      }\n\n      while (node && !dom.isBlock(node)) {\n        startNode = node;\n        node = node.previousSibling;\n      }\n\n      if (startNode && editor.schema.isValidChild(rootBlockName, blockName.toLowerCase())) {\n        newBlock = dom.create(blockName);\n        setForcedBlockAttrs(editor, newBlock);\n        startNode.parentNode.insertBefore(newBlock, startNode);\n        node = startNode;\n\n        while (node && !dom.isBlock(node)) {\n          next = node.nextSibling;\n          newBlock.appendChild(node);\n          node = next;\n        }\n\n        rng.setStart(container, offset);\n        rng.setEnd(container, offset);\n      }\n    }\n\n    return container;\n  };\n\n  var addBrToBlockIfNeeded = function (dom, block) {\n    block.normalize();\n    var lastChild = block.lastChild;\n\n    if (!lastChild || /^(left|right)$/gi.test(dom.getStyle(lastChild, 'float', true))) {\n      dom.add(block, 'br');\n    }\n  };\n\n  var insert$1 = function (editor, evt) {\n    var tmpRng, container, offset, parentBlock;\n    var newBlock, fragment, containerBlock, parentBlockName, newBlockName, isAfterLastNodeInContainer;\n    var dom = editor.dom;\n    var schema = editor.schema,\n        nonEmptyElementsMap = schema.getNonEmptyElements();\n    var rng = editor.selection.getRng();\n\n    var createNewBlock = function (name) {\n      var node = container,\n          block,\n          clonedNode,\n          caretNode;\n      var textInlineElements = schema.getTextInlineElements();\n\n      if (name || parentBlockName === 'TABLE' || parentBlockName === 'HR') {\n        block = dom.create(name || newBlockName);\n      } else {\n        block = parentBlock.cloneNode(false);\n      }\n\n      caretNode = block;\n\n      if (shouldKeepStyles(editor) === false) {\n        dom.setAttrib(block, 'style', null);\n        dom.setAttrib(block, 'class', null);\n      } else {\n        do {\n          if (textInlineElements[node.nodeName]) {\n            if (isCaretNode(node) || isBookmarkNode$1(node)) {\n              continue;\n            }\n\n            clonedNode = node.cloneNode(false);\n            dom.setAttrib(clonedNode, 'id', '');\n\n            if (block.hasChildNodes()) {\n              clonedNode.appendChild(block.firstChild);\n              block.appendChild(clonedNode);\n            } else {\n              caretNode = clonedNode;\n              block.appendChild(clonedNode);\n            }\n          }\n        } while ((node = node.parentNode) && node !== editableRoot);\n      }\n\n      setForcedBlockAttrs(editor, block);\n      emptyBlock(caretNode);\n      return block;\n    };\n\n    var isCaretAtStartOrEndOfBlock = function (start) {\n      var node, name;\n      var normalizedOffset = normalizeZwspOffset(start, container, offset);\n\n      if (isText$1(container) && (start ? normalizedOffset > 0 : normalizedOffset < container.nodeValue.length)) {\n        return false;\n      }\n\n      if (container.parentNode === parentBlock && isAfterLastNodeInContainer && !start) {\n        return true;\n      }\n\n      if (start && isElement$1(container) && container === parentBlock.firstChild) {\n        return true;\n      }\n\n      if (containerAndSiblingName(container, 'TABLE') || containerAndSiblingName(container, 'HR')) {\n        return isAfterLastNodeInContainer && !start || !isAfterLastNodeInContainer && start;\n      }\n\n      var walker = new DomTreeWalker(container, parentBlock);\n\n      if (isText$1(container)) {\n        if (start && normalizedOffset === 0) {\n          walker.prev();\n        } else if (!start && normalizedOffset === container.nodeValue.length) {\n          walker.next();\n        }\n      }\n\n      while (node = walker.current()) {\n        if (isElement$1(node)) {\n          if (!node.getAttribute('data-mce-bogus')) {\n            name = node.nodeName.toLowerCase();\n\n            if (nonEmptyElementsMap[name] && name !== 'br') {\n              return false;\n            }\n          }\n        } else if (isText$1(node) && !isWhitespaceText(node.nodeValue)) {\n          return false;\n        }\n\n        if (start) {\n          walker.prev();\n        } else {\n          walker.next();\n        }\n      }\n\n      return true;\n    };\n\n    var insertNewBlockAfter = function () {\n      if (/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName) && containerBlockName !== 'HGROUP') {\n        newBlock = createNewBlock(newBlockName);\n      } else {\n        newBlock = createNewBlock();\n      }\n\n      if (shouldEndContainerOnEmptyBlock(editor) && canSplitBlock(dom, containerBlock) && dom.isEmpty(parentBlock)) {\n        newBlock = dom.split(containerBlock, parentBlock);\n      } else {\n        dom.insertAfter(newBlock, parentBlock);\n      }\n\n      moveToCaretPosition(editor, newBlock);\n    };\n\n    normalize(dom, rng).each(function (normRng) {\n      rng.setStart(normRng.startContainer, normRng.startOffset);\n      rng.setEnd(normRng.endContainer, normRng.endOffset);\n    });\n    container = rng.startContainer;\n    offset = rng.startOffset;\n    newBlockName = getForcedRootBlock(editor);\n    var shiftKey = !!(evt && evt.shiftKey);\n    var ctrlKey = !!(evt && evt.ctrlKey);\n\n    if (isElement$1(container) && container.hasChildNodes()) {\n      isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n      container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n\n      if (isAfterLastNodeInContainer && isText$1(container)) {\n        offset = container.nodeValue.length;\n      } else {\n        offset = 0;\n      }\n    }\n\n    var editableRoot = getEditableRoot$1(dom, container);\n\n    if (!editableRoot) {\n      return;\n    }\n\n    if (newBlockName && !shiftKey || !newBlockName && shiftKey) {\n      container = wrapSelfAndSiblingsInDefaultBlock(editor, newBlockName, rng, container, offset);\n    }\n\n    parentBlock = dom.getParent(container, dom.isBlock);\n    containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n    parentBlockName = parentBlock ? parentBlock.nodeName.toUpperCase() : '';\n    var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n\n    if (containerBlockName === 'LI' && !ctrlKey) {\n      parentBlock = containerBlock;\n      containerBlock = containerBlock.parentNode;\n      parentBlockName = containerBlockName;\n    }\n\n    if (/^(LI|DT|DD)$/.test(parentBlockName)) {\n      if (dom.isEmpty(parentBlock)) {\n        insert(editor, createNewBlock, containerBlock, parentBlock, newBlockName);\n        return;\n      }\n    }\n\n    if (newBlockName && parentBlock === editor.getBody()) {\n      return;\n    }\n\n    newBlockName = newBlockName || 'P';\n\n    if (isCaretContainerBlock(parentBlock)) {\n      newBlock = showCaretContainerBlock(parentBlock);\n\n      if (dom.isEmpty(parentBlock)) {\n        emptyBlock(parentBlock);\n      }\n\n      setForcedBlockAttrs(editor, newBlock);\n      moveToCaretPosition(editor, newBlock);\n    } else if (isCaretAtStartOrEndOfBlock()) {\n      insertNewBlockAfter();\n    } else if (isCaretAtStartOrEndOfBlock(true)) {\n      newBlock = parentBlock.parentNode.insertBefore(createNewBlock(), parentBlock);\n      moveToCaretPosition(editor, containerAndSiblingName(parentBlock, 'HR') ? newBlock : parentBlock);\n    } else {\n      tmpRng = includeZwspInRange(rng).cloneRange();\n      tmpRng.setEndAfter(parentBlock);\n      fragment = tmpRng.extractContents();\n      trimZwsp(fragment);\n      trimLeadingLineBreaks(fragment);\n      newBlock = fragment.firstChild;\n      dom.insertAfter(fragment, parentBlock);\n      trimInlineElementsOnLeftSideOfBlock(dom, nonEmptyElementsMap, newBlock);\n      addBrToBlockIfNeeded(dom, parentBlock);\n\n      if (dom.isEmpty(parentBlock)) {\n        emptyBlock(parentBlock);\n      }\n\n      newBlock.normalize();\n\n      if (dom.isEmpty(newBlock)) {\n        dom.remove(newBlock);\n        insertNewBlockAfter();\n      } else {\n        setForcedBlockAttrs(editor, newBlock);\n        moveToCaretPosition(editor, newBlock);\n      }\n    }\n\n    dom.setAttrib(newBlock, 'id', '');\n    editor.fire('NewBlock', {\n      newBlock: newBlock\n    });\n  };\n\n  var hasRightSideContent = function (schema, container, parentBlock) {\n    var walker = new DomTreeWalker(container, parentBlock);\n    var node;\n    var nonEmptyElementsMap = schema.getNonEmptyElements();\n\n    while (node = walker.next()) {\n      if (nonEmptyElementsMap[node.nodeName.toLowerCase()] || node.length > 0) {\n        return true;\n      }\n    }\n  };\n\n  var moveSelectionToBr = function (editor, brElm, extraBr) {\n    var rng = editor.dom.createRng();\n\n    if (!extraBr) {\n      rng.setStartAfter(brElm);\n      rng.setEndAfter(brElm);\n    } else {\n      rng.setStartBefore(brElm);\n      rng.setEndBefore(brElm);\n    }\n\n    editor.selection.setRng(rng);\n    scrollRangeIntoView(editor, rng);\n  };\n\n  var insertBrAtCaret = function (editor, evt) {\n    var selection = editor.selection;\n    var dom = editor.dom;\n    var rng = selection.getRng();\n    var brElm;\n    var extraBr;\n    normalize(dom, rng).each(function (normRng) {\n      rng.setStart(normRng.startContainer, normRng.startOffset);\n      rng.setEnd(normRng.endContainer, normRng.endOffset);\n    });\n    var offset = rng.startOffset;\n    var container = rng.startContainer;\n\n    if (container.nodeType === 1 && container.hasChildNodes()) {\n      var isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n      container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n\n      if (isAfterLastNodeInContainer && container.nodeType === 3) {\n        offset = container.nodeValue.length;\n      } else {\n        offset = 0;\n      }\n    }\n\n    var parentBlock = dom.getParent(container, dom.isBlock);\n    var containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n    var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n    var isControlKey = !!(evt && evt.ctrlKey);\n\n    if (containerBlockName === 'LI' && !isControlKey) {\n      parentBlock = containerBlock;\n    }\n\n    if (container && container.nodeType === 3 && offset >= container.nodeValue.length) {\n      if (!hasRightSideContent(editor.schema, container, parentBlock)) {\n        brElm = dom.create('br');\n        rng.insertNode(brElm);\n        rng.setStartAfter(brElm);\n        rng.setEndAfter(brElm);\n        extraBr = true;\n      }\n    }\n\n    brElm = dom.create('br');\n    rangeInsertNode(dom, rng, brElm);\n    moveSelectionToBr(editor, brElm, extraBr);\n    editor.undoManager.add();\n  };\n\n  var insertBrBefore = function (editor, inline) {\n    var br = SugarElement.fromTag('br');\n    before(SugarElement.fromDom(inline), br);\n    editor.undoManager.add();\n  };\n\n  var insertBrAfter = function (editor, inline) {\n    if (!hasBrAfter(editor.getBody(), inline)) {\n      after(SugarElement.fromDom(inline), SugarElement.fromTag('br'));\n    }\n\n    var br = SugarElement.fromTag('br');\n    after(SugarElement.fromDom(inline), br);\n    moveSelectionToBr(editor, br.dom, false);\n    editor.undoManager.add();\n  };\n\n  var isBeforeBr$1 = function (pos) {\n    return isBr(pos.getNode());\n  };\n\n  var hasBrAfter = function (rootNode, startNode) {\n    if (isBeforeBr$1(CaretPosition.after(startNode))) {\n      return true;\n    } else {\n      return nextPosition(rootNode, CaretPosition.after(startNode)).map(function (pos) {\n        return isBr(pos.getNode());\n      }).getOr(false);\n    }\n  };\n\n  var isAnchorLink = function (elm) {\n    return elm && elm.nodeName === 'A' && 'href' in elm;\n  };\n\n  var isInsideAnchor = function (location) {\n    return location.fold(never, isAnchorLink, isAnchorLink, never);\n  };\n\n  var readInlineAnchorLocation = function (editor) {\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    var position = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return readLocation(isInlineTarget$1, editor.getBody(), position).filter(isInsideAnchor);\n  };\n\n  var insertBrOutsideAnchor = function (editor, location) {\n    location.fold(noop, curry(insertBrBefore, editor), curry(insertBrAfter, editor), noop);\n  };\n\n  var insert$2 = function (editor, evt) {\n    var anchorLocation = readInlineAnchorLocation(editor);\n\n    if (anchorLocation.isSome()) {\n      anchorLocation.each(curry(insertBrOutsideAnchor, editor));\n    } else {\n      insertBrAtCaret(editor, evt);\n    }\n  };\n\n  var matchesSelector = function (editor, selector) {\n    return getParentBlock$2(editor).filter(function (parentBlock) {\n      return selector.length > 0 && is$1(SugarElement.fromDom(parentBlock), selector);\n    }).isSome();\n  };\n\n  var shouldInsertBr = function (editor) {\n    return matchesSelector(editor, getBrNewLineSelector(editor));\n  };\n\n  var shouldBlockNewLine = function (editor) {\n    return matchesSelector(editor, getNoNewLineSelector(editor));\n  };\n\n  var newLineAction = Adt.generate([{\n    br: []\n  }, {\n    block: []\n  }, {\n    none: []\n  }]);\n\n  var shouldBlockNewLine$1 = function (editor, _shiftKey) {\n    return shouldBlockNewLine(editor);\n  };\n\n  var isBrMode = function (requiredState) {\n    return function (editor, _shiftKey) {\n      var brMode = getForcedRootBlock(editor) === '';\n      return brMode === requiredState;\n    };\n  };\n\n  var inListBlock = function (requiredState) {\n    return function (editor, _shiftKey) {\n      return isListItemParentBlock(editor) === requiredState;\n    };\n  };\n\n  var inBlock = function (blockName, requiredState) {\n    return function (editor, _shiftKey) {\n      var state = getParentBlockName(editor) === blockName.toUpperCase();\n      return state === requiredState;\n    };\n  };\n\n  var inPreBlock = function (requiredState) {\n    return inBlock('pre', requiredState);\n  };\n\n  var inSummaryBlock = function () {\n    return inBlock('summary', true);\n  };\n\n  var shouldPutBrInPre$1 = function (requiredState) {\n    return function (editor, _shiftKey) {\n      return shouldPutBrInPre(editor) === requiredState;\n    };\n  };\n\n  var inBrContext = function (editor, _shiftKey) {\n    return shouldInsertBr(editor);\n  };\n\n  var hasShiftKey = function (_editor, shiftKey) {\n    return shiftKey;\n  };\n\n  var canInsertIntoEditableRoot = function (editor) {\n    var forcedRootBlock = getForcedRootBlock(editor);\n    var rootEditable = getEditableRoot(editor.dom, editor.selection.getStart());\n    return rootEditable && editor.schema.isValidChild(rootEditable.nodeName, forcedRootBlock ? forcedRootBlock : 'P');\n  };\n\n  var match$2 = function (predicates, action) {\n    return function (editor, shiftKey) {\n      var isMatch = foldl(predicates, function (res, p) {\n        return res && p(editor, shiftKey);\n      }, true);\n      return isMatch ? Optional.some(action) : Optional.none();\n    };\n  };\n\n  var getAction$1 = function (editor, evt) {\n    return evaluateUntil([match$2([shouldBlockNewLine$1], newLineAction.none()), match$2([inSummaryBlock()], newLineAction.br()), match$2([inPreBlock(true), shouldPutBrInPre$1(false), hasShiftKey], newLineAction.br()), match$2([inPreBlock(true), shouldPutBrInPre$1(false)], newLineAction.block()), match$2([inPreBlock(true), shouldPutBrInPre$1(true), hasShiftKey], newLineAction.block()), match$2([inPreBlock(true), shouldPutBrInPre$1(true)], newLineAction.br()), match$2([inListBlock(true), hasShiftKey], newLineAction.br()), match$2([inListBlock(true)], newLineAction.block()), match$2([isBrMode(true), hasShiftKey, canInsertIntoEditableRoot], newLineAction.block()), match$2([isBrMode(true)], newLineAction.br()), match$2([inBrContext], newLineAction.br()), match$2([isBrMode(false), hasShiftKey], newLineAction.br()), match$2([canInsertIntoEditableRoot], newLineAction.block())], [editor, !!(evt && evt.shiftKey)]).getOr(newLineAction.none());\n  };\n\n  var insert$3 = function (editor, evt) {\n    getAction$1(editor, evt).fold(function () {\n      insert$2(editor, evt);\n    }, function () {\n      insert$1(editor, evt);\n    }, noop);\n  };\n\n  var handleEnterKeyEvent = function (editor, event) {\n    if (event.isDefaultPrevented()) {\n      return;\n    }\n\n    event.preventDefault();\n    endTypingLevelIgnoreLocks(editor.undoManager);\n    editor.undoManager.transact(function () {\n      if (editor.selection.isCollapsed() === false) {\n        editor.execCommand('Delete');\n      }\n\n      insert$3(editor, event);\n    });\n  };\n\n  var setup$e = function (editor) {\n    editor.on('keydown', function (event) {\n      if (event.keyCode === VK.ENTER) {\n        handleEnterKeyEvent(editor, event);\n      }\n    });\n  };\n\n  var executeKeydownOverride$2 = function (editor, evt) {\n    execute([{\n      keyCode: VK.END,\n      action: action(moveToLineEndPoint$1, editor, true)\n    }, {\n      keyCode: VK.HOME,\n      action: action(moveToLineEndPoint$1, editor, false)\n    }, {\n      keyCode: VK.END,\n      action: action(moveToLineEndPoint$2, editor, true)\n    }, {\n      keyCode: VK.HOME,\n      action: action(moveToLineEndPoint$2, editor, false)\n    }], evt).each(function (_) {\n      evt.preventDefault();\n    });\n  };\n\n  var setup$f = function (editor) {\n    editor.on('keydown', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeydownOverride$2(editor, evt);\n      }\n    });\n  };\n\n  var browser$4 = detect$3().browser;\n\n  var setupIeInput = function (editor) {\n    var keypressThrotter = first(function () {\n      if (!editor.composing) {\n        normalizeNbspsInEditor(editor);\n      }\n    }, 0);\n\n    if (browser$4.isIE()) {\n      editor.on('keypress', function (_e) {\n        keypressThrotter.throttle();\n      });\n      editor.on('remove', function (_e) {\n        keypressThrotter.cancel();\n      });\n    }\n  };\n\n  var setup$g = function (editor) {\n    setupIeInput(editor);\n    editor.on('input', function (e) {\n      if (e.isComposing === false) {\n        normalizeNbspsInEditor(editor);\n      }\n    });\n  };\n\n  var insertTextAtPosition = function (text, pos) {\n    var container = pos.container();\n    var offset = pos.offset();\n\n    if (isText$1(container)) {\n      container.insertData(offset, text);\n      return Optional.some(CaretPosition(container, offset + text.length));\n    } else {\n      return getElementFromPosition(pos).map(function (elm) {\n        var textNode = SugarElement.fromText(text);\n\n        if (pos.isAtEnd()) {\n          after(elm, textNode);\n        } else {\n          before(elm, textNode);\n        }\n\n        return CaretPosition(textNode.dom, text.length);\n      });\n    }\n  };\n\n  var insertNbspAtPosition = curry(insertTextAtPosition, nbsp);\n  var insertSpaceAtPosition = curry(insertTextAtPosition, ' ');\n\n  var locationToCaretPosition = function (root) {\n    return function (location) {\n      return location.fold(function (element) {\n        return prevPosition(root.dom, CaretPosition.before(element));\n      }, function (element) {\n        return firstPositionIn(element);\n      }, function (element) {\n        return lastPositionIn(element);\n      }, function (element) {\n        return nextPosition(root.dom, CaretPosition.after(element));\n      });\n    };\n  };\n\n  var insertInlineBoundarySpaceOrNbsp = function (root, pos) {\n    return function (checkPos) {\n      return needsToHaveNbsp(root, checkPos) ? insertNbspAtPosition(pos) : insertSpaceAtPosition(pos);\n    };\n  };\n\n  var setSelection$1 = function (editor) {\n    return function (pos) {\n      editor.selection.setRng(pos.toRange());\n      editor.nodeChanged();\n      return true;\n    };\n  };\n\n  var insertSpaceOrNbspAtSelection = function (editor) {\n    var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n    var root = SugarElement.fromDom(editor.getBody());\n\n    if (editor.selection.isCollapsed()) {\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      var caretPosition = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return readLocation(isInlineTarget$1, editor.getBody(), caretPosition).bind(locationToCaretPosition(root)).bind(insertInlineBoundarySpaceOrNbsp(root, pos)).exists(setSelection$1(editor));\n    } else {\n      return false;\n    }\n  };\n\n  var executeKeydownOverride$3 = function (editor, evt) {\n    execute([{\n      keyCode: VK.SPACEBAR,\n      action: action(insertSpaceOrNbspAtSelection, editor)\n    }], evt).each(function (_) {\n      evt.preventDefault();\n    });\n  };\n\n  var setup$h = function (editor) {\n    editor.on('keydown', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeydownOverride$3(editor, evt);\n      }\n    });\n  };\n\n  var registerKeyboardOverrides = function (editor) {\n    var caret = setupSelectedState(editor);\n    setup$b(editor);\n    setup$c(editor, caret);\n    setup$d(editor, caret);\n    setup$e(editor);\n    setup$h(editor);\n    setup$g(editor);\n    setup$f(editor);\n    return caret;\n  };\n\n  var setup$i = function (editor) {\n    if (!isRtc(editor)) {\n      return registerKeyboardOverrides(editor);\n    } else {\n      return Cell(null);\n    }\n  };\n\n  var NodeChange = function () {\n    function NodeChange(editor) {\n      this.lastPath = [];\n      this.editor = editor;\n      var lastRng;\n      var self = this;\n\n      if (!('onselectionchange' in editor.getDoc())) {\n        editor.on('NodeChange click mouseup keyup focus', function (e) {\n          var nativeRng = editor.selection.getRng();\n          var fakeRng = {\n            startContainer: nativeRng.startContainer,\n            startOffset: nativeRng.startOffset,\n            endContainer: nativeRng.endContainer,\n            endOffset: nativeRng.endOffset\n          };\n\n          if (e.type === 'nodechange' || !isEq$1(fakeRng, lastRng)) {\n            editor.fire('SelectionChange');\n          }\n\n          lastRng = fakeRng;\n        });\n      }\n\n      editor.on('contextmenu', function () {\n        editor.fire('SelectionChange');\n      });\n      editor.on('SelectionChange', function () {\n        var startElm = editor.selection.getStart(true);\n\n        if (!startElm || !Env.range && editor.selection.isCollapsed()) {\n          return;\n        }\n\n        if (hasAnyRanges(editor) && !self.isSameElementPath(startElm) && editor.dom.isChildOf(startElm, editor.getBody())) {\n          editor.nodeChanged({\n            selectionChange: true\n          });\n        }\n      });\n      editor.on('mouseup', function (e) {\n        if (!e.isDefaultPrevented() && hasAnyRanges(editor)) {\n          if (editor.selection.getNode().nodeName === 'IMG') {\n            Delay.setEditorTimeout(editor, function () {\n              editor.nodeChanged();\n            });\n          } else {\n            editor.nodeChanged();\n          }\n        }\n      });\n    }\n\n    NodeChange.prototype.nodeChanged = function (args) {\n      var selection = this.editor.selection;\n      var node, parents, root;\n\n      if (this.editor.initialized && selection && !shouldDisableNodeChange(this.editor) && !this.editor.mode.isReadOnly()) {\n        root = this.editor.getBody();\n        node = selection.getStart(true) || root;\n\n        if (node.ownerDocument !== this.editor.getDoc() || !this.editor.dom.isChildOf(node, root)) {\n          node = root;\n        }\n\n        parents = [];\n        this.editor.dom.getParent(node, function (node) {\n          if (node === root) {\n            return true;\n          }\n\n          parents.push(node);\n        });\n        args = args || {};\n        args.element = node;\n        args.parents = parents;\n        this.editor.fire('NodeChange', args);\n      }\n    };\n\n    NodeChange.prototype.isSameElementPath = function (startElm) {\n      var i;\n      var currentPath = this.editor.$(startElm).parentsUntil(this.editor.getBody()).add(startElm);\n\n      if (currentPath.length === this.lastPath.length) {\n        for (i = currentPath.length; i >= 0; i--) {\n          if (currentPath[i] !== this.lastPath[i]) {\n            break;\n          }\n        }\n\n        if (i === -1) {\n          this.lastPath = currentPath;\n          return true;\n        }\n      }\n\n      this.lastPath = currentPath;\n      return false;\n    };\n\n    return NodeChange;\n  }();\n\n  var preventSummaryToggle = function (editor) {\n    editor.on('click', function (e) {\n      if (editor.dom.getParent(e.target, 'details')) {\n        e.preventDefault();\n      }\n    });\n  };\n\n  var filterDetails = function (editor) {\n    editor.parser.addNodeFilter('details', function (elms) {\n      each(elms, function (details) {\n        details.attr('data-mce-open', details.attr('open'));\n        details.attr('open', 'open');\n      });\n    });\n    editor.serializer.addNodeFilter('details', function (elms) {\n      each(elms, function (details) {\n        var open = details.attr('data-mce-open');\n        details.attr('open', isString(open) ? open : null);\n        details.attr('data-mce-open', null);\n      });\n    });\n  };\n\n  var setup$j = function (editor) {\n    preventSummaryToggle(editor);\n    filterDetails(editor);\n  };\n\n  var isTextBlockNode = function (node) {\n    return isElement$1(node) && isTextBlock(SugarElement.fromDom(node));\n  };\n\n  var normalizeSelection$1 = function (editor) {\n    var rng = editor.selection.getRng();\n    var startPos = CaretPosition.fromRangeStart(rng);\n    var endPos = CaretPosition.fromRangeEnd(rng);\n\n    if (CaretPosition.isElementPosition(startPos)) {\n      var container = startPos.container();\n\n      if (isTextBlockNode(container)) {\n        firstPositionIn(container).each(function (pos) {\n          return rng.setStart(pos.container(), pos.offset());\n        });\n      }\n    }\n\n    if (CaretPosition.isElementPosition(endPos)) {\n      var container = startPos.container();\n\n      if (isTextBlockNode(container)) {\n        lastPositionIn(container).each(function (pos) {\n          return rng.setEnd(pos.container(), pos.offset());\n        });\n      }\n    }\n\n    editor.selection.setRng(normalize$2(rng));\n  };\n\n  var setup$k = function (editor) {\n    editor.on('click', function (e) {\n      if (e.detail >= 3) {\n        normalizeSelection$1(editor);\n      }\n    });\n  };\n\n  var value$1 = function () {\n    var subject = Cell(Optional.none());\n\n    var clear = function () {\n      return subject.set(Optional.none());\n    };\n\n    var set = function (s) {\n      return subject.set(Optional.some(s));\n    };\n\n    var isSet = function () {\n      return subject.get().isSome();\n    };\n\n    var on = function (f) {\n      return subject.get().each(f);\n    };\n\n    return {\n      clear: clear,\n      set: set,\n      isSet: isSet,\n      on: on\n    };\n  };\n\n  var getAbsolutePosition = function (elm) {\n    var clientRect = elm.getBoundingClientRect();\n    var doc = elm.ownerDocument;\n    var docElem = doc.documentElement;\n    var win = doc.defaultView;\n    return {\n      top: clientRect.top + win.pageYOffset - docElem.clientTop,\n      left: clientRect.left + win.pageXOffset - docElem.clientLeft\n    };\n  };\n\n  var getBodyPosition = function (editor) {\n    return editor.inline ? getAbsolutePosition(editor.getBody()) : {\n      left: 0,\n      top: 0\n    };\n  };\n\n  var getScrollPosition = function (editor) {\n    var body = editor.getBody();\n    return editor.inline ? {\n      left: body.scrollLeft,\n      top: body.scrollTop\n    } : {\n      left: 0,\n      top: 0\n    };\n  };\n\n  var getBodyScroll = function (editor) {\n    var body = editor.getBody(),\n        docElm = editor.getDoc().documentElement;\n    var inlineScroll = {\n      left: body.scrollLeft,\n      top: body.scrollTop\n    };\n    var iframeScroll = {\n      left: body.scrollLeft || docElm.scrollLeft,\n      top: body.scrollTop || docElm.scrollTop\n    };\n    return editor.inline ? inlineScroll : iframeScroll;\n  };\n\n  var getMousePosition = function (editor, event) {\n    if (event.target.ownerDocument !== editor.getDoc()) {\n      var iframePosition = getAbsolutePosition(editor.getContentAreaContainer());\n      var scrollPosition = getBodyScroll(editor);\n      return {\n        left: event.pageX - iframePosition.left + scrollPosition.left,\n        top: event.pageY - iframePosition.top + scrollPosition.top\n      };\n    }\n\n    return {\n      left: event.pageX,\n      top: event.pageY\n    };\n  };\n\n  var calculatePosition = function (bodyPosition, scrollPosition, mousePosition) {\n    return {\n      pageX: mousePosition.left - bodyPosition.left + scrollPosition.left,\n      pageY: mousePosition.top - bodyPosition.top + scrollPosition.top\n    };\n  };\n\n  var calc = function (editor, event) {\n    return calculatePosition(getBodyPosition(editor), getScrollPosition(editor), getMousePosition(editor, event));\n  };\n\n  var isContentEditableFalse$a = isContentEditableFalse,\n      isContentEditableTrue$3 = isContentEditableTrue;\n\n  var isDraggable = function (rootElm, elm) {\n    return isContentEditableFalse$a(elm) && elm !== rootElm;\n  };\n\n  var isValidDropTarget = function (editor, targetElement, dragElement) {\n    if (targetElement === dragElement || editor.dom.isChildOf(targetElement, dragElement)) {\n      return false;\n    }\n\n    return !isContentEditableFalse$a(targetElement);\n  };\n\n  var cloneElement = function (elm) {\n    var cloneElm = elm.cloneNode(true);\n    cloneElm.removeAttribute('data-mce-selected');\n    return cloneElm;\n  };\n\n  var createGhost = function (editor, elm, width, height) {\n    var dom = editor.dom;\n    var clonedElm = elm.cloneNode(true);\n    dom.setStyles(clonedElm, {\n      width: width,\n      height: height\n    });\n    dom.setAttrib(clonedElm, 'data-mce-selected', null);\n    var ghostElm = dom.create('div', {\n      'class': 'mce-drag-container',\n      'data-mce-bogus': 'all',\n      'unselectable': 'on',\n      'contenteditable': 'false'\n    });\n    dom.setStyles(ghostElm, {\n      position: 'absolute',\n      opacity: 0.5,\n      overflow: 'hidden',\n      border: 0,\n      padding: 0,\n      margin: 0,\n      width: width,\n      height: height\n    });\n    dom.setStyles(clonedElm, {\n      margin: 0,\n      boxSizing: 'border-box'\n    });\n    ghostElm.appendChild(clonedElm);\n    return ghostElm;\n  };\n\n  var appendGhostToBody = function (ghostElm, bodyElm) {\n    if (ghostElm.parentNode !== bodyElm) {\n      bodyElm.appendChild(ghostElm);\n    }\n  };\n\n  var moveGhost = function (ghostElm, position, width, height, maxX, maxY) {\n    var overflowX = 0,\n        overflowY = 0;\n    ghostElm.style.left = position.pageX + 'px';\n    ghostElm.style.top = position.pageY + 'px';\n\n    if (position.pageX + width > maxX) {\n      overflowX = position.pageX + width - maxX;\n    }\n\n    if (position.pageY + height > maxY) {\n      overflowY = position.pageY + height - maxY;\n    }\n\n    ghostElm.style.width = width - overflowX + 'px';\n    ghostElm.style.height = height - overflowY + 'px';\n  };\n\n  var removeElement = function (elm) {\n    if (elm && elm.parentNode) {\n      elm.parentNode.removeChild(elm);\n    }\n  };\n\n  var isLeftMouseButtonPressed = function (e) {\n    return e.button === 0;\n  };\n\n  var applyRelPos = function (state, position) {\n    return {\n      pageX: position.pageX - state.relX,\n      pageY: position.pageY + 5\n    };\n  };\n\n  var start$1 = function (state, editor) {\n    return function (e) {\n      if (isLeftMouseButtonPressed(e)) {\n        var ceElm = find(editor.dom.getParents(e.target), or(isContentEditableFalse$a, isContentEditableTrue$3)).getOr(null);\n\n        if (isDraggable(editor.getBody(), ceElm)) {\n          var elmPos = editor.dom.getPos(ceElm);\n          var bodyElm = editor.getBody();\n          var docElm = editor.getDoc().documentElement;\n          state.set({\n            element: ceElm,\n            dragging: false,\n            screenX: e.screenX,\n            screenY: e.screenY,\n            maxX: (editor.inline ? bodyElm.scrollWidth : docElm.offsetWidth) - 2,\n            maxY: (editor.inline ? bodyElm.scrollHeight : docElm.offsetHeight) - 2,\n            relX: e.pageX - elmPos.x,\n            relY: e.pageY - elmPos.y,\n            width: ceElm.offsetWidth,\n            height: ceElm.offsetHeight,\n            ghost: createGhost(editor, ceElm, ceElm.offsetWidth, ceElm.offsetHeight)\n          });\n        }\n      }\n    };\n  };\n\n  var move$2 = function (state, editor) {\n    var throttledPlaceCaretAt = Delay.throttle(function (clientX, clientY) {\n      editor._selectionOverrides.hideFakeCaret();\n\n      editor.selection.placeCaretAt(clientX, clientY);\n    }, 0);\n    editor.on('remove', throttledPlaceCaretAt.stop);\n    return function (e) {\n      return state.on(function (state) {\n        var movement = Math.max(Math.abs(e.screenX - state.screenX), Math.abs(e.screenY - state.screenY));\n\n        if (!state.dragging && movement > 10) {\n          var args = editor.fire('dragstart', {\n            target: state.element\n          });\n\n          if (args.isDefaultPrevented()) {\n            return;\n          }\n\n          state.dragging = true;\n          editor.focus();\n        }\n\n        if (state.dragging) {\n          var targetPos = applyRelPos(state, calc(editor, e));\n          appendGhostToBody(state.ghost, editor.getBody());\n          moveGhost(state.ghost, targetPos, state.width, state.height, state.maxX, state.maxY);\n          throttledPlaceCaretAt(e.clientX, e.clientY);\n        }\n      });\n    };\n  };\n\n  var getRawTarget = function (selection) {\n    var rng = selection.getSel().getRangeAt(0);\n    var startContainer = rng.startContainer;\n    return startContainer.nodeType === 3 ? startContainer.parentNode : startContainer;\n  };\n\n  var drop = function (state, editor) {\n    return function (e) {\n      state.on(function (state) {\n        if (state.dragging) {\n          if (isValidDropTarget(editor, getRawTarget(editor.selection), state.element)) {\n            var targetClone_1 = cloneElement(state.element);\n            var args = editor.fire('drop', {\n              clientX: e.clientX,\n              clientY: e.clientY\n            });\n\n            if (!args.isDefaultPrevented()) {\n              editor.undoManager.transact(function () {\n                removeElement(state.element);\n                editor.insertContent(editor.dom.getOuterHTML(targetClone_1));\n\n                editor._selectionOverrides.hideFakeCaret();\n              });\n            }\n          }\n        }\n      });\n      removeDragState(state);\n    };\n  };\n\n  var stop = function (state, editor) {\n    return function () {\n      state.on(function (state) {\n        if (state.dragging) {\n          editor.fire('dragend');\n        }\n      });\n      removeDragState(state);\n    };\n  };\n\n  var removeDragState = function (state) {\n    state.on(function (state) {\n      removeElement(state.ghost);\n    });\n    state.clear();\n  };\n\n  var bindFakeDragEvents = function (editor) {\n    var state = value$1();\n    var pageDom = DOMUtils.DOM;\n    var rootDocument = document;\n    var dragStartHandler = start$1(state, editor);\n    var dragHandler = move$2(state, editor);\n    var dropHandler = drop(state, editor);\n    var dragEndHandler = stop(state, editor);\n    editor.on('mousedown', dragStartHandler);\n    editor.on('mousemove', dragHandler);\n    editor.on('mouseup', dropHandler);\n    pageDom.bind(rootDocument, 'mousemove', dragHandler);\n    pageDom.bind(rootDocument, 'mouseup', dragEndHandler);\n    editor.on('remove', function () {\n      pageDom.unbind(rootDocument, 'mousemove', dragHandler);\n      pageDom.unbind(rootDocument, 'mouseup', dragEndHandler);\n    });\n  };\n\n  var blockIeDrop = function (editor) {\n    editor.on('drop', function (e) {\n      var realTarget = typeof e.clientX !== 'undefined' ? editor.getDoc().elementFromPoint(e.clientX, e.clientY) : null;\n\n      if (isContentEditableFalse$a(realTarget) || editor.dom.getContentEditableParent(realTarget) === 'false') {\n        e.preventDefault();\n      }\n    });\n  };\n\n  var blockUnsupportedFileDrop = function (editor) {\n    var preventFileDrop = function (e) {\n      if (!e.isDefaultPrevented()) {\n        var dataTransfer = e.dataTransfer;\n\n        if (dataTransfer && (contains(dataTransfer.types, 'Files') || dataTransfer.files.length > 0)) {\n          e.preventDefault();\n\n          if (e.type === 'drop') {\n            displayError(editor, 'Dropped file type is not supported');\n          }\n        }\n      }\n    };\n\n    var preventFileDropIfUIElement = function (e) {\n      if (isUIElement(editor, e.target)) {\n        preventFileDrop(e);\n      }\n    };\n\n    var setup = function () {\n      var pageDom = DOMUtils.DOM;\n      var dom = editor.dom;\n      var doc = document;\n      var editorRoot = editor.inline ? editor.getBody() : editor.getDoc();\n      var eventNames = ['drop', 'dragover'];\n      each(eventNames, function (name) {\n        pageDom.bind(doc, name, preventFileDropIfUIElement);\n        dom.bind(editorRoot, name, preventFileDrop);\n      });\n      editor.on('remove', function () {\n        each(eventNames, function (name) {\n          pageDom.unbind(doc, name, preventFileDropIfUIElement);\n          dom.unbind(editorRoot, name, preventFileDrop);\n        });\n      });\n    };\n\n    editor.on('init', function () {\n      Delay.setEditorTimeout(editor, setup, 0);\n    });\n  };\n\n  var init = function (editor) {\n    bindFakeDragEvents(editor);\n    blockIeDrop(editor);\n\n    if (shouldBlockUnsupportedDrop(editor)) {\n      blockUnsupportedFileDrop(editor);\n    }\n  };\n\n  var setup$l = function (editor) {\n    var renderFocusCaret = first(function () {\n      if (!editor.removed && editor.getBody().contains(document.activeElement)) {\n        var rng = editor.selection.getRng();\n\n        if (rng.collapsed) {\n          var caretRange = renderRangeCaret(editor, rng, false);\n          editor.selection.setRng(caretRange);\n        }\n      }\n    }, 0);\n    editor.on('focus', function () {\n      renderFocusCaret.throttle();\n    });\n    editor.on('blur', function () {\n      renderFocusCaret.cancel();\n    });\n  };\n\n  var setup$m = function (editor) {\n    editor.on('init', function () {\n      editor.on('focusin', function (e) {\n        var target = e.target;\n\n        if (isMedia(target)) {\n          var ceRoot = getContentEditableRoot(editor.getBody(), target);\n          var node = isContentEditableFalse(ceRoot) ? ceRoot : target;\n\n          if (editor.selection.getNode() !== node) {\n            selectNode(editor, node).each(function (rng) {\n              return editor.selection.setRng(rng);\n            });\n          }\n        }\n      });\n    });\n  };\n\n  var isContentEditableTrue$4 = isContentEditableTrue;\n  var isContentEditableFalse$b = isContentEditableFalse;\n\n  var getContentEditableRoot$1 = function (editor, node) {\n    return getContentEditableRoot(editor.getBody(), node);\n  };\n\n  var SelectionOverrides = function (editor) {\n    var selection = editor.selection,\n        dom = editor.dom;\n    var isBlock = dom.isBlock;\n    var rootNode = editor.getBody();\n    var fakeCaret = FakeCaret(editor, rootNode, isBlock, function () {\n      return hasFocus$1(editor);\n    });\n    var realSelectionId = 'sel-' + dom.uniqueId();\n    var elementSelectionAttr = 'data-mce-selected';\n    var selectedElement;\n\n    var isFakeSelectionElement = function (node) {\n      return dom.hasClass(node, 'mce-offscreen-selection');\n    };\n\n    var isFakeSelectionTargetElement = function (node) {\n      return node !== rootNode && (isContentEditableFalse$b(node) || isMedia(node)) && dom.isChildOf(node, rootNode);\n    };\n\n    var isNearFakeSelectionElement = function (pos) {\n      return isBeforeContentEditableFalse(pos) || isAfterContentEditableFalse(pos) || isBeforeMedia(pos) || isAfterMedia(pos);\n    };\n\n    var getRealSelectionElement = function () {\n      var container = dom.get(realSelectionId);\n      return container ? container.getElementsByTagName('*')[0] : container;\n    };\n\n    var setRange = function (range) {\n      if (range) {\n        selection.setRng(range);\n      }\n    };\n\n    var getRange = selection.getRng;\n\n    var showCaret = function (direction, node, before, scrollIntoView) {\n      if (scrollIntoView === void 0) {\n        scrollIntoView = true;\n      }\n\n      var e = editor.fire('ShowCaret', {\n        target: node,\n        direction: direction,\n        before: before\n      });\n\n      if (e.isDefaultPrevented()) {\n        return null;\n      }\n\n      if (scrollIntoView) {\n        selection.scrollIntoView(node, direction === -1);\n      }\n\n      return fakeCaret.show(before, node);\n    };\n\n    var showBlockCaretContainer = function (blockCaretContainer) {\n      if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n        showCaretContainerBlock(blockCaretContainer);\n        setRange(getRange());\n        selection.scrollIntoView(blockCaretContainer);\n      }\n    };\n\n    var registerEvents = function () {\n      editor.on('mouseup', function (e) {\n        var range = getRange();\n\n        if (range.collapsed && isXYInContentArea(editor, e.clientX, e.clientY)) {\n          renderCaretAtRange(editor, range, false).each(setRange);\n        }\n      });\n      editor.on('click', function (e) {\n        var contentEditableRoot = getContentEditableRoot$1(editor, e.target);\n\n        if (contentEditableRoot) {\n          if (isContentEditableFalse$b(contentEditableRoot)) {\n            e.preventDefault();\n            editor.focus();\n          }\n\n          if (isContentEditableTrue$4(contentEditableRoot)) {\n            if (dom.isChildOf(contentEditableRoot, selection.getNode())) {\n              removeElementSelection();\n            }\n          }\n        }\n      });\n      editor.on('blur NewBlock', removeElementSelection);\n      editor.on('ResizeWindow FullscreenStateChanged', fakeCaret.reposition);\n\n      var hasNormalCaretPosition = function (elm) {\n        var caretWalker = CaretWalker(elm);\n\n        if (!elm.firstChild) {\n          return false;\n        }\n\n        var startPos = CaretPosition.before(elm.firstChild);\n        var newPos = caretWalker.next(startPos);\n        return newPos && !isNearFakeSelectionElement(newPos);\n      };\n\n      var isInSameBlock = function (node1, node2) {\n        var block1 = dom.getParent(node1, isBlock);\n        var block2 = dom.getParent(node2, isBlock);\n        return block1 === block2;\n      };\n\n      var hasBetterMouseTarget = function (targetNode, caretNode) {\n        var targetBlock = dom.getParent(targetNode, isBlock);\n        var caretBlock = dom.getParent(caretNode, isBlock);\n\n        if (targetBlock && targetNode !== caretBlock && dom.isChildOf(targetBlock, caretBlock) && isContentEditableFalse$b(getContentEditableRoot$1(editor, targetBlock)) === false) {\n          return true;\n        }\n\n        return targetBlock && !isInSameBlock(targetBlock, caretBlock) && hasNormalCaretPosition(targetBlock);\n      };\n\n      editor.on('tap', function (e) {\n        var targetElm = e.target;\n        var contentEditableRoot = getContentEditableRoot$1(editor, targetElm);\n\n        if (isContentEditableFalse$b(contentEditableRoot)) {\n          e.preventDefault();\n          selectNode(editor, contentEditableRoot).each(setElementSelection);\n        } else if (isFakeSelectionTargetElement(targetElm)) {\n          selectNode(editor, targetElm).each(setElementSelection);\n        }\n      }, true);\n      editor.on('mousedown', function (e) {\n        var targetElm = e.target;\n\n        if (targetElm !== rootNode && targetElm.nodeName !== 'HTML' && !dom.isChildOf(targetElm, rootNode)) {\n          return;\n        }\n\n        if (isXYInContentArea(editor, e.clientX, e.clientY) === false) {\n          return;\n        }\n\n        var contentEditableRoot = getContentEditableRoot$1(editor, targetElm);\n\n        if (contentEditableRoot) {\n          if (isContentEditableFalse$b(contentEditableRoot)) {\n            e.preventDefault();\n            selectNode(editor, contentEditableRoot).each(setElementSelection);\n          } else {\n            removeElementSelection();\n\n            if (!(isContentEditableTrue$4(contentEditableRoot) && e.shiftKey) && !isXYWithinRange(e.clientX, e.clientY, selection.getRng())) {\n              hideFakeCaret();\n              selection.placeCaretAt(e.clientX, e.clientY);\n            }\n          }\n        } else if (isFakeSelectionTargetElement(targetElm)) {\n          selectNode(editor, targetElm).each(setElementSelection);\n        } else if (isFakeCaretTarget(targetElm) === false) {\n          removeElementSelection();\n          hideFakeCaret();\n          var fakeCaretInfo = closestFakeCaret(rootNode, e.clientX, e.clientY);\n\n          if (fakeCaretInfo) {\n            if (!hasBetterMouseTarget(targetElm, fakeCaretInfo.node)) {\n              e.preventDefault();\n              var range = showCaret(1, fakeCaretInfo.node, fakeCaretInfo.before, false);\n              editor.getBody().focus();\n              setRange(range);\n            }\n          }\n        }\n      });\n      editor.on('keypress', function (e) {\n        if (VK.modifierPressed(e)) {\n          return;\n        }\n\n        if (isContentEditableFalse$b(selection.getNode())) {\n          e.preventDefault();\n        }\n      });\n      editor.on('GetSelectionRange', function (e) {\n        var rng = e.range;\n\n        if (selectedElement) {\n          if (!selectedElement.parentNode) {\n            selectedElement = null;\n            return;\n          }\n\n          rng = rng.cloneRange();\n          rng.selectNode(selectedElement);\n          e.range = rng;\n        }\n      });\n      editor.on('SetSelectionRange', function (e) {\n        e.range = normalizeShortEndedElementSelection(e.range);\n        var rng = setElementSelection(e.range, e.forward);\n\n        if (rng) {\n          e.range = rng;\n        }\n      });\n\n      var isPasteBin = function (node) {\n        return node.id === 'mcepastebin';\n      };\n\n      editor.on('AfterSetSelectionRange', function (e) {\n        var rng = e.range;\n        var parentNode = rng.startContainer.parentNode;\n\n        if (!isRangeInCaretContainer(rng) && !isPasteBin(parentNode)) {\n          hideFakeCaret();\n        }\n\n        if (!isFakeSelectionElement(parentNode)) {\n          removeElementSelection();\n        }\n      });\n      editor.on('copy', function (e) {\n        var clipboardData = e.clipboardData;\n\n        if (!e.isDefaultPrevented() && e.clipboardData && !Env.ie) {\n          var realSelectionElement = getRealSelectionElement();\n\n          if (realSelectionElement) {\n            e.preventDefault();\n            clipboardData.clearData();\n            clipboardData.setData('text/html', realSelectionElement.outerHTML);\n            clipboardData.setData('text/plain', realSelectionElement.outerText || realSelectionElement.innerText);\n          }\n        }\n      });\n      init(editor);\n      setup$l(editor);\n      setup$m(editor);\n    };\n\n    var isWithinCaretContainer = function (node) {\n      return isCaretContainer(node) || startsWithCaretContainer(node) || endsWithCaretContainer(node);\n    };\n\n    var isRangeInCaretContainer = function (rng) {\n      return isWithinCaretContainer(rng.startContainer) || isWithinCaretContainer(rng.endContainer);\n    };\n\n    var normalizeShortEndedElementSelection = function (rng) {\n      var shortEndedElements = editor.schema.getShortEndedElements();\n      var newRng = dom.createRng();\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n\n      if (has(shortEndedElements, startContainer.nodeName.toLowerCase())) {\n        if (startOffset === 0) {\n          newRng.setStartBefore(startContainer);\n        } else {\n          newRng.setStartAfter(startContainer);\n        }\n      } else {\n        newRng.setStart(startContainer, startOffset);\n      }\n\n      if (has(shortEndedElements, endContainer.nodeName.toLowerCase())) {\n        if (endOffset === 0) {\n          newRng.setEndBefore(endContainer);\n        } else {\n          newRng.setEndAfter(endContainer);\n        }\n      } else {\n        newRng.setEnd(endContainer, endOffset);\n      }\n\n      return newRng;\n    };\n\n    var setupOffscreenSelection = function (node, targetClone, origTargetClone) {\n      var $ = editor.$;\n      var $realSelectionContainer = descendant(SugarElement.fromDom(editor.getBody()), '#' + realSelectionId).fold(function () {\n        return $([]);\n      }, function (elm) {\n        return $([elm.dom]);\n      });\n\n      if ($realSelectionContainer.length === 0) {\n        $realSelectionContainer = $('<div data-mce-bogus=\"all\" class=\"mce-offscreen-selection\"></div>').attr('id', realSelectionId);\n        $realSelectionContainer.appendTo(editor.getBody());\n      }\n\n      var newRange = dom.createRng();\n\n      if (targetClone === origTargetClone && Env.ie) {\n        $realSelectionContainer.empty().append('<p style=\"font-size: 0\" data-mce-bogus=\"all\">\\xA0</p>').append(targetClone);\n        newRange.setStartAfter($realSelectionContainer[0].firstChild.firstChild);\n        newRange.setEndAfter(targetClone);\n      } else {\n        $realSelectionContainer.empty().append(nbsp).append(targetClone).append(nbsp);\n        newRange.setStart($realSelectionContainer[0].firstChild, 1);\n        newRange.setEnd($realSelectionContainer[0].lastChild, 0);\n      }\n\n      $realSelectionContainer.css({\n        top: dom.getPos(node, editor.getBody()).y\n      });\n      $realSelectionContainer[0].focus();\n      var sel = selection.getSel();\n      sel.removeAllRanges();\n      sel.addRange(newRange);\n      return newRange;\n    };\n\n    var selectElement = function (elm) {\n      var targetClone = elm.cloneNode(true);\n      var e = editor.fire('ObjectSelected', {\n        target: elm,\n        targetClone: targetClone\n      });\n\n      if (e.isDefaultPrevented()) {\n        return null;\n      }\n\n      var range = setupOffscreenSelection(elm, e.targetClone, targetClone);\n      var nodeElm = SugarElement.fromDom(elm);\n      each(descendants$1(SugarElement.fromDom(editor.getBody()), '*[data-mce-selected]'), function (elm) {\n        if (!eq$2(nodeElm, elm)) {\n          remove$1(elm, elementSelectionAttr);\n        }\n      });\n\n      if (!dom.getAttrib(elm, elementSelectionAttr)) {\n        elm.setAttribute(elementSelectionAttr, '1');\n      }\n\n      selectedElement = elm;\n      hideFakeCaret();\n      return range;\n    };\n\n    var setElementSelection = function (range, forward) {\n      if (!range) {\n        return null;\n      }\n\n      if (range.collapsed) {\n        if (!isRangeInCaretContainer(range)) {\n          var dir = forward ? 1 : -1;\n          var caretPosition = getNormalizedRangeEndPoint(dir, rootNode, range);\n          var beforeNode = caretPosition.getNode(!forward);\n\n          if (isFakeCaretTarget(beforeNode)) {\n            return showCaret(dir, beforeNode, forward ? !caretPosition.isAtEnd() : false, false);\n          }\n\n          var afterNode = caretPosition.getNode(forward);\n\n          if (isFakeCaretTarget(afterNode)) {\n            return showCaret(dir, afterNode, forward ? false : !caretPosition.isAtEnd(), false);\n          }\n        }\n\n        return null;\n      }\n\n      var startContainer = range.startContainer;\n      var startOffset = range.startOffset;\n      var endOffset = range.endOffset;\n\n      if (startContainer.nodeType === 3 && startOffset === 0 && isContentEditableFalse$b(startContainer.parentNode)) {\n        startContainer = startContainer.parentNode;\n        startOffset = dom.nodeIndex(startContainer);\n        startContainer = startContainer.parentNode;\n      }\n\n      if (startContainer.nodeType !== 1) {\n        return null;\n      }\n\n      if (endOffset === startOffset + 1 && startContainer === range.endContainer) {\n        var node = startContainer.childNodes[startOffset];\n\n        if (isFakeSelectionTargetElement(node)) {\n          return selectElement(node);\n        }\n      }\n\n      return null;\n    };\n\n    var removeElementSelection = function () {\n      if (selectedElement) {\n        selectedElement.removeAttribute(elementSelectionAttr);\n      }\n\n      descendant(SugarElement.fromDom(editor.getBody()), '#' + realSelectionId).each(remove);\n      selectedElement = null;\n    };\n\n    var destroy = function () {\n      fakeCaret.destroy();\n      selectedElement = null;\n    };\n\n    var hideFakeCaret = function () {\n      fakeCaret.hide();\n    };\n\n    if (Env.ceFalse) {\n      registerEvents();\n    }\n\n    return {\n      showCaret: showCaret,\n      showBlockCaretContainer: showBlockCaretContainer,\n      hideFakeCaret: hideFakeCaret,\n      destroy: destroy\n    };\n  };\n\n  var Quirks = function (editor) {\n    var each = Tools.each;\n    var BACKSPACE = VK.BACKSPACE,\n        DELETE = VK.DELETE,\n        dom = editor.dom,\n        selection = editor.selection,\n        parser = editor.parser;\n    var isGecko = Env.gecko,\n        isIE = Env.ie,\n        isWebKit = Env.webkit;\n    var mceInternalUrlPrefix = 'data:text/mce-internal,';\n    var mceInternalDataType = isIE ? 'Text' : 'URL';\n\n    var setEditorCommandState = function (cmd, state) {\n      try {\n        editor.getDoc().execCommand(cmd, false, state);\n      } catch (ex) {}\n    };\n\n    var isDefaultPrevented = function (e) {\n      return e.isDefaultPrevented();\n    };\n\n    var setMceInternalContent = function (e) {\n      var selectionHtml, internalContent;\n\n      if (e.dataTransfer) {\n        if (editor.selection.isCollapsed() && e.target.tagName === 'IMG') {\n          selection.select(e.target);\n        }\n\n        selectionHtml = editor.selection.getContent();\n\n        if (selectionHtml.length > 0) {\n          internalContent = mceInternalUrlPrefix + escape(editor.id) + ',' + escape(selectionHtml);\n          e.dataTransfer.setData(mceInternalDataType, internalContent);\n        }\n      }\n    };\n\n    var getMceInternalContent = function (e) {\n      var internalContent;\n\n      if (e.dataTransfer) {\n        internalContent = e.dataTransfer.getData(mceInternalDataType);\n\n        if (internalContent && internalContent.indexOf(mceInternalUrlPrefix) >= 0) {\n          internalContent = internalContent.substr(mceInternalUrlPrefix.length).split(',');\n          return {\n            id: unescape(internalContent[0]),\n            html: unescape(internalContent[1])\n          };\n        }\n      }\n\n      return null;\n    };\n\n    var insertClipboardContents = function (content, internal) {\n      if (editor.queryCommandSupported('mceInsertClipboardContent')) {\n        editor.execCommand('mceInsertClipboardContent', false, {\n          content: content,\n          internal: internal\n        });\n      } else {\n        editor.execCommand('mceInsertContent', false, content);\n      }\n    };\n\n    var emptyEditorWhenDeleting = function () {\n      var serializeRng = function (rng) {\n        var body = dom.create('body');\n        var contents = rng.cloneContents();\n        body.appendChild(contents);\n        return selection.serializer.serialize(body, {\n          format: 'html'\n        });\n      };\n\n      var allContentsSelected = function (rng) {\n        var selection = serializeRng(rng);\n        var allRng = dom.createRng();\n        allRng.selectNode(editor.getBody());\n        var allSelection = serializeRng(allRng);\n        return selection === allSelection;\n      };\n\n      editor.on('keydown', function (e) {\n        var keyCode = e.keyCode;\n        var isCollapsed, body;\n\n        if (!isDefaultPrevented(e) && (keyCode === DELETE || keyCode === BACKSPACE)) {\n          isCollapsed = editor.selection.isCollapsed();\n          body = editor.getBody();\n\n          if (isCollapsed && !dom.isEmpty(body)) {\n            return;\n          }\n\n          if (!isCollapsed && !allContentsSelected(editor.selection.getRng())) {\n            return;\n          }\n\n          e.preventDefault();\n          editor.setContent('');\n\n          if (body.firstChild && dom.isBlock(body.firstChild)) {\n            editor.selection.setCursorLocation(body.firstChild, 0);\n          } else {\n            editor.selection.setCursorLocation(body, 0);\n          }\n\n          editor.nodeChanged();\n        }\n      });\n    };\n\n    var selectAll = function () {\n      editor.shortcuts.add('meta+a', null, 'SelectAll');\n    };\n\n    var inputMethodFocus = function () {\n      if (!editor.inline) {\n        dom.bind(editor.getDoc(), 'mousedown mouseup', function (e) {\n          var rng;\n\n          if (e.target === editor.getDoc().documentElement) {\n            rng = selection.getRng();\n            editor.getBody().focus();\n\n            if (e.type === 'mousedown') {\n              if (isCaretContainer(rng.startContainer)) {\n                return;\n              }\n\n              selection.placeCaretAt(e.clientX, e.clientY);\n            } else {\n              selection.setRng(rng);\n            }\n          }\n        });\n      }\n    };\n\n    var removeHrOnBackspace = function () {\n      editor.on('keydown', function (e) {\n        if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n          if (!editor.getBody().getElementsByTagName('hr').length) {\n            return;\n          }\n\n          if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n            var node = selection.getNode();\n            var previousSibling = node.previousSibling;\n\n            if (node.nodeName === 'HR') {\n              dom.remove(node);\n              e.preventDefault();\n              return;\n            }\n\n            if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'hr') {\n              dom.remove(previousSibling);\n              e.preventDefault();\n            }\n          }\n        }\n      });\n    };\n\n    var focusBody = function () {\n      if (!Range.prototype.getClientRects) {\n        editor.on('mousedown', function (e) {\n          if (!isDefaultPrevented(e) && e.target.nodeName === 'HTML') {\n            var body_1 = editor.getBody();\n            body_1.blur();\n            Delay.setEditorTimeout(editor, function () {\n              body_1.focus();\n            });\n          }\n        });\n      }\n    };\n\n    var selectControlElements = function () {\n      editor.on('click', function (e) {\n        var target = e.target;\n\n        if (/^(IMG|HR)$/.test(target.nodeName) && dom.getContentEditableParent(target) !== 'false') {\n          e.preventDefault();\n          editor.selection.select(target);\n          editor.nodeChanged();\n        }\n\n        if (target.nodeName === 'A' && dom.hasClass(target, 'mce-item-anchor')) {\n          e.preventDefault();\n          selection.select(target);\n        }\n      });\n    };\n\n    var removeStylesWhenDeletingAcrossBlockElements = function () {\n      var getAttributeApplyFunction = function () {\n        var template = dom.getAttribs(selection.getStart().cloneNode(false));\n        return function () {\n          var target = selection.getStart();\n\n          if (target !== editor.getBody()) {\n            dom.setAttrib(target, 'style', null);\n            each(template, function (attr) {\n              target.setAttributeNode(attr.cloneNode(true));\n            });\n          }\n        };\n      };\n\n      var isSelectionAcrossElements = function () {\n        return !selection.isCollapsed() && dom.getParent(selection.getStart(), dom.isBlock) !== dom.getParent(selection.getEnd(), dom.isBlock);\n      };\n\n      editor.on('keypress', function (e) {\n        var applyAttributes;\n\n        if (!isDefaultPrevented(e) && (e.keyCode === 8 || e.keyCode === 46) && isSelectionAcrossElements()) {\n          applyAttributes = getAttributeApplyFunction();\n          editor.getDoc().execCommand('delete', false, null);\n          applyAttributes();\n          e.preventDefault();\n          return false;\n        }\n      });\n      dom.bind(editor.getDoc(), 'cut', function (e) {\n        var applyAttributes;\n\n        if (!isDefaultPrevented(e) && isSelectionAcrossElements()) {\n          applyAttributes = getAttributeApplyFunction();\n          Delay.setEditorTimeout(editor, function () {\n            applyAttributes();\n          });\n        }\n      });\n    };\n\n    var disableBackspaceIntoATable = function () {\n      editor.on('keydown', function (e) {\n        if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n          if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n            var previousSibling = selection.getNode().previousSibling;\n\n            if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'table') {\n              e.preventDefault();\n              return false;\n            }\n          }\n        }\n      });\n    };\n\n    var removeBlockQuoteOnBackSpace = function () {\n      editor.on('keydown', function (e) {\n        var rng, parent;\n\n        if (isDefaultPrevented(e) || e.keyCode !== VK.BACKSPACE) {\n          return;\n        }\n\n        rng = selection.getRng();\n        var container = rng.startContainer;\n        var offset = rng.startOffset;\n        var root = dom.getRoot();\n        parent = container;\n\n        if (!rng.collapsed || offset !== 0) {\n          return;\n        }\n\n        while (parent && parent.parentNode && parent.parentNode.firstChild === parent && parent.parentNode !== root) {\n          parent = parent.parentNode;\n        }\n\n        if (parent.tagName === 'BLOCKQUOTE') {\n          editor.formatter.toggle('blockquote', null, parent);\n          rng = dom.createRng();\n          rng.setStart(container, 0);\n          rng.setEnd(container, 0);\n          selection.setRng(rng);\n        }\n      });\n    };\n\n    var setGeckoEditingOptions = function () {\n      var setOpts = function () {\n        setEditorCommandState('StyleWithCSS', false);\n        setEditorCommandState('enableInlineTableEditing', false);\n\n        if (!getObjectResizing(editor)) {\n          setEditorCommandState('enableObjectResizing', false);\n        }\n      };\n\n      if (!isReadOnly(editor)) {\n        editor.on('BeforeExecCommand mousedown', setOpts);\n      }\n    };\n\n    var addBrAfterLastLinks = function () {\n      var fixLinks = function () {\n        each(dom.select('a'), function (node) {\n          var parentNode = node.parentNode;\n          var root = dom.getRoot();\n\n          if (parentNode.lastChild === node) {\n            while (parentNode && !dom.isBlock(parentNode)) {\n              if (parentNode.parentNode.lastChild !== parentNode || parentNode === root) {\n                return;\n              }\n\n              parentNode = parentNode.parentNode;\n            }\n\n            dom.add(parentNode, 'br', {\n              'data-mce-bogus': 1\n            });\n          }\n        });\n      };\n\n      editor.on('SetContent ExecCommand', function (e) {\n        if (e.type === 'setcontent' || e.command === 'mceInsertLink') {\n          fixLinks();\n        }\n      });\n    };\n\n    var setDefaultBlockType = function () {\n      if (getForcedRootBlock(editor)) {\n        editor.on('init', function () {\n          setEditorCommandState('DefaultParagraphSeparator', getForcedRootBlock(editor));\n        });\n      }\n    };\n\n    var normalizeSelection = function () {\n      editor.on('keyup focusin mouseup', function (e) {\n        if (!VK.modifierPressed(e)) {\n          selection.normalize();\n        }\n      }, true);\n    };\n\n    var showBrokenImageIcon = function () {\n      editor.contentStyles.push('img:-moz-broken {' + '-moz-force-broken-image-icon:1;' + 'min-width:24px;' + 'min-height:24px' + '}');\n    };\n\n    var restoreFocusOnKeyDown = function () {\n      if (!editor.inline) {\n        editor.on('keydown', function () {\n          if (document.activeElement === document.body) {\n            editor.getWin().focus();\n          }\n        });\n      }\n    };\n\n    var bodyHeight = function () {\n      if (!editor.inline) {\n        editor.contentStyles.push('body {min-height: 150px}');\n        editor.on('click', function (e) {\n          var rng;\n\n          if (e.target.nodeName === 'HTML') {\n            if (Env.ie > 11) {\n              editor.getBody().focus();\n              return;\n            }\n\n            rng = editor.selection.getRng();\n            editor.getBody().focus();\n            editor.selection.setRng(rng);\n            editor.selection.normalize();\n            editor.nodeChanged();\n          }\n        });\n      }\n    };\n\n    var blockCmdArrowNavigation = function () {\n      if (Env.mac) {\n        editor.on('keydown', function (e) {\n          if (VK.metaKeyPressed(e) && !e.shiftKey && (e.keyCode === 37 || e.keyCode === 39)) {\n            e.preventDefault();\n            var selection_1 = editor.selection.getSel();\n            selection_1.modify('move', e.keyCode === 37 ? 'backward' : 'forward', 'lineboundary');\n          }\n        });\n      }\n    };\n\n    var disableAutoUrlDetect = function () {\n      setEditorCommandState('AutoUrlDetect', false);\n    };\n\n    var tapLinksAndImages = function () {\n      editor.on('click', function (e) {\n        var elm = e.target;\n\n        do {\n          if (elm.tagName === 'A') {\n            e.preventDefault();\n            return;\n          }\n        } while (elm = elm.parentNode);\n      });\n      editor.contentStyles.push('.mce-content-body {-webkit-touch-callout: none}');\n    };\n\n    var blockFormSubmitInsideEditor = function () {\n      editor.on('init', function () {\n        editor.dom.bind(editor.getBody(), 'submit', function (e) {\n          e.preventDefault();\n        });\n      });\n    };\n\n    var removeAppleInterchangeBrs = function () {\n      parser.addNodeFilter('br', function (nodes) {\n        var i = nodes.length;\n\n        while (i--) {\n          if (nodes[i].attr('class') === 'Apple-interchange-newline') {\n            nodes[i].remove();\n          }\n        }\n      });\n    };\n\n    var ieInternalDragAndDrop = function () {\n      editor.on('dragstart', function (e) {\n        setMceInternalContent(e);\n      });\n      editor.on('drop', function (e) {\n        if (!isDefaultPrevented(e)) {\n          var internalContent = getMceInternalContent(e);\n\n          if (internalContent && internalContent.id !== editor.id) {\n            e.preventDefault();\n            var rng = fromPoint$1(e.x, e.y, editor.getDoc());\n            selection.setRng(rng);\n            insertClipboardContents(internalContent.html, true);\n          }\n        }\n      });\n    };\n\n    var refreshContentEditable = noop;\n\n    var isHidden = function () {\n      if (!isGecko || editor.removed) {\n        return false;\n      }\n\n      var sel = editor.selection.getSel();\n      return !sel || !sel.rangeCount || sel.rangeCount === 0;\n    };\n\n    removeBlockQuoteOnBackSpace();\n    emptyEditorWhenDeleting();\n\n    if (!Env.windowsPhone) {\n      normalizeSelection();\n    }\n\n    if (isWebKit) {\n      inputMethodFocus();\n      selectControlElements();\n      setDefaultBlockType();\n      blockFormSubmitInsideEditor();\n      disableBackspaceIntoATable();\n      removeAppleInterchangeBrs();\n\n      if (Env.iOS) {\n        restoreFocusOnKeyDown();\n        bodyHeight();\n        tapLinksAndImages();\n      } else {\n        selectAll();\n      }\n    }\n\n    if (Env.ie >= 11) {\n      bodyHeight();\n      disableBackspaceIntoATable();\n    }\n\n    if (Env.ie) {\n      selectAll();\n      disableAutoUrlDetect();\n      ieInternalDragAndDrop();\n    }\n\n    if (isGecko) {\n      removeHrOnBackspace();\n      focusBody();\n      removeStylesWhenDeletingAcrossBlockElements();\n      setGeckoEditingOptions();\n      addBrAfterLastLinks();\n      showBrokenImageIcon();\n      blockCmdArrowNavigation();\n      disableBackspaceIntoATable();\n    }\n\n    return {\n      refreshContentEditable: refreshContentEditable,\n      isHidden: isHidden\n    };\n  };\n\n  var DOM$4 = DOMUtils.DOM;\n\n  var appendStyle = function (editor, text) {\n    var body = SugarElement.fromDom(editor.getBody());\n    var container = getStyleContainer(getRootNode(body));\n    var style = SugarElement.fromTag('style');\n    set(style, 'type', 'text/css');\n    append(style, SugarElement.fromText(text));\n    append(container, style);\n    editor.on('remove', function () {\n      remove(style);\n    });\n  };\n\n  var getRootName = function (editor) {\n    return editor.inline ? editor.getElement().nodeName.toLowerCase() : undefined;\n  };\n\n  var removeUndefined = function (obj) {\n    return filter$1(obj, function (v) {\n      return isUndefined(v) === false;\n    });\n  };\n\n  var mkParserSettings = function (editor) {\n    var settings = editor.settings;\n    var blobCache = editor.editorUpload.blobCache;\n    return removeUndefined({\n      allow_conditional_comments: settings.allow_conditional_comments,\n      allow_html_data_urls: settings.allow_html_data_urls,\n      allow_svg_data_urls: settings.allow_svg_data_urls,\n      allow_html_in_named_anchor: settings.allow_html_in_named_anchor,\n      allow_script_urls: settings.allow_script_urls,\n      allow_unsafe_link_target: settings.allow_unsafe_link_target,\n      convert_fonts_to_spans: settings.convert_fonts_to_spans,\n      fix_list_elements: settings.fix_list_elements,\n      font_size_legacy_values: settings.font_size_legacy_values,\n      forced_root_block: settings.forced_root_block,\n      forced_root_block_attrs: settings.forced_root_block_attrs,\n      padd_empty_with_br: settings.padd_empty_with_br,\n      preserve_cdata: settings.preserve_cdata,\n      remove_trailing_brs: settings.remove_trailing_brs,\n      inline_styles: settings.inline_styles,\n      root_name: getRootName(editor),\n      validate: true,\n      blob_cache: blobCache,\n      images_dataimg_filter: settings.images_dataimg_filter\n    });\n  };\n\n  var mkSerializerSettings = function (editor) {\n    var settings = editor.settings;\n    return __assign(__assign({}, mkParserSettings(editor)), removeUndefined({\n      url_converter: settings.url_converter,\n      url_converter_scope: settings.url_converter_scope,\n      element_format: settings.element_format,\n      entities: settings.entities,\n      entity_encoding: settings.entity_encoding,\n      indent: settings.indent,\n      indent_after: settings.indent_after,\n      indent_before: settings.indent_before,\n      block_elements: settings.block_elements,\n      boolean_attributes: settings.boolean_attributes,\n      custom_elements: settings.custom_elements,\n      extended_valid_elements: settings.extended_valid_elements,\n      invalid_elements: settings.invalid_elements,\n      invalid_styles: settings.invalid_styles,\n      move_caret_before_on_enter_elements: settings.move_caret_before_on_enter_elements,\n      non_empty_elements: settings.non_empty_elements,\n      schema: settings.schema,\n      self_closing_elements: settings.self_closing_elements,\n      short_ended_elements: settings.short_ended_elements,\n      special: settings.special,\n      text_block_elements: settings.text_block_elements,\n      text_inline_elements: settings.text_inline_elements,\n      valid_children: settings.valid_children,\n      valid_classes: settings.valid_classes,\n      valid_elements: settings.valid_elements,\n      valid_styles: settings.valid_styles,\n      verify_html: settings.verify_html,\n      whitespace_elements: settings.whitespace_elements\n    }));\n  };\n\n  var createParser = function (editor) {\n    var parser = DomParser(mkParserSettings(editor), editor.schema);\n    parser.addAttributeFilter('src,href,style,tabindex', function (nodes, name) {\n      var i = nodes.length,\n          node,\n          value;\n      var dom = editor.dom;\n      var internalName = 'data-mce-' + name;\n\n      while (i--) {\n        node = nodes[i];\n        value = node.attr(name);\n\n        if (value && !node.attr(internalName)) {\n          if (value.indexOf('data:') === 0 || value.indexOf('blob:') === 0) {\n            continue;\n          }\n\n          if (name === 'style') {\n            value = dom.serializeStyle(dom.parseStyle(value), node.name);\n\n            if (!value.length) {\n              value = null;\n            }\n\n            node.attr(internalName, value);\n            node.attr(name, value);\n          } else if (name === 'tabindex') {\n            node.attr(internalName, value);\n            node.attr(name, null);\n          } else {\n            node.attr(internalName, editor.convertURL(value, name, node.name));\n          }\n        }\n      }\n    });\n    parser.addNodeFilter('script', function (nodes) {\n      var i = nodes.length;\n\n      while (i--) {\n        var node = nodes[i];\n        var type = node.attr('type') || 'no/type';\n\n        if (type.indexOf('mce-') !== 0) {\n          node.attr('type', 'mce-' + type);\n        }\n      }\n    });\n\n    if (editor.settings.preserve_cdata) {\n      parser.addNodeFilter('#cdata', function (nodes) {\n        var i = nodes.length;\n\n        while (i--) {\n          var node = nodes[i];\n          node.type = 8;\n          node.name = '#comment';\n          node.value = '[CDATA[' + editor.dom.encode(node.value) + ']]';\n        }\n      });\n    }\n\n    parser.addNodeFilter('p,h1,h2,h3,h4,h5,h6,div', function (nodes) {\n      var i = nodes.length;\n      var nonEmptyElements = editor.schema.getNonEmptyElements();\n\n      while (i--) {\n        var node = nodes[i];\n\n        if (node.isEmpty(nonEmptyElements) && node.getAll('br').length === 0) {\n          node.append(new AstNode('br', 1)).shortEnded = true;\n        }\n      }\n    });\n    return parser;\n  };\n\n  var autoFocus = function (editor) {\n    if (editor.settings.auto_focus) {\n      Delay.setEditorTimeout(editor, function () {\n        var focusEditor;\n\n        if (editor.settings.auto_focus === true) {\n          focusEditor = editor;\n        } else {\n          focusEditor = editor.editorManager.get(editor.settings.auto_focus);\n        }\n\n        if (!focusEditor.destroyed) {\n          focusEditor.focus();\n        }\n      }, 100);\n    }\n  };\n\n  var moveSelectionToFirstCaretPosition = function (editor) {\n    var root = editor.dom.getRoot();\n\n    if (!editor.inline && (!hasAnyRanges(editor) || editor.selection.getStart(true) === root)) {\n      firstPositionIn(root).each(function (pos) {\n        var node = pos.getNode();\n        var caretPos = isTable(node) ? firstPositionIn(node).getOr(pos) : pos;\n\n        if (Env.browser.isIE()) {\n          storeNative(editor, caretPos.toRange());\n        } else {\n          editor.selection.setRng(caretPos.toRange());\n        }\n      });\n    }\n  };\n\n  var initEditor = function (editor) {\n    editor.bindPendingEventDelegates();\n    editor.initialized = true;\n    fireInit(editor);\n    editor.focus(true);\n    moveSelectionToFirstCaretPosition(editor);\n    editor.nodeChanged({\n      initial: true\n    });\n    editor.execCallback('init_instance_callback', editor);\n    autoFocus(editor);\n  };\n\n  var getStyleSheetLoader = function (editor) {\n    return editor.inline ? editor.ui.styleSheetLoader : editor.dom.styleSheetLoader;\n  };\n\n  var makeStylesheetLoadingPromises = function (editor, css, framedFonts) {\n    var promises = [new promiseObj(function (resolve, reject) {\n      return getStyleSheetLoader(editor).loadAll(css, resolve, reject);\n    })];\n\n    if (editor.inline) {\n      return promises;\n    } else {\n      return promises.concat([new promiseObj(function (resolve, reject) {\n        return editor.ui.styleSheetLoader.loadAll(framedFonts, resolve, reject);\n      })]);\n    }\n  };\n\n  var loadContentCss = function (editor, css) {\n    var styleSheetLoader = getStyleSheetLoader(editor);\n    var fontCss = getFontCss(editor);\n\n    var removeCss = function () {\n      styleSheetLoader.unloadAll(css);\n\n      if (!editor.inline) {\n        editor.ui.styleSheetLoader.unloadAll(fontCss);\n      }\n    };\n\n    var loaded = function () {\n      if (editor.removed) {\n        removeCss();\n      } else {\n        editor.on('remove', removeCss);\n        initEditor(editor);\n      }\n    };\n\n    promiseObj.all(makeStylesheetLoadingPromises(editor, css, fontCss)).then(loaded).catch(loaded);\n  };\n\n  var preInit = function (editor, rtcMode) {\n    var settings = editor.settings,\n        doc = editor.getDoc(),\n        body = editor.getBody();\n\n    if (!settings.browser_spellcheck && !settings.gecko_spellcheck) {\n      doc.body.spellcheck = false;\n      DOM$4.setAttrib(body, 'spellcheck', 'false');\n    }\n\n    editor.quirks = Quirks(editor);\n    firePostRender(editor);\n    var directionality = getDirectionality(editor);\n\n    if (directionality !== undefined) {\n      body.dir = directionality;\n    }\n\n    if (settings.protect) {\n      editor.on('BeforeSetContent', function (e) {\n        Tools.each(settings.protect, function (pattern) {\n          e.content = e.content.replace(pattern, function (str) {\n            return '<!--mce:protected ' + escape(str) + '-->';\n          });\n        });\n      });\n    }\n\n    editor.on('SetContent', function () {\n      editor.addVisual(editor.getBody());\n    });\n\n    if (rtcMode === false) {\n      editor.load({\n        initial: true,\n        format: 'html'\n      });\n    }\n\n    editor.startContent = editor.getContent({\n      format: 'raw'\n    });\n    editor.on('compositionstart compositionend', function (e) {\n      editor.composing = e.type === 'compositionstart';\n    });\n\n    if (editor.contentStyles.length > 0) {\n      var contentCssText_1 = '';\n      Tools.each(editor.contentStyles, function (style) {\n        contentCssText_1 += style + '\\r\\n';\n      });\n      editor.dom.addStyle(contentCssText_1);\n    }\n\n    loadContentCss(editor, editor.contentCSS);\n\n    if (settings.content_style) {\n      appendStyle(editor, settings.content_style);\n    }\n  };\n\n  var initContentBody = function (editor, skipWrite) {\n    var settings = editor.settings;\n    var targetElm = editor.getElement();\n    var doc = editor.getDoc();\n\n    if (!settings.inline) {\n      editor.getElement().style.visibility = editor.orgVisibility;\n    }\n\n    if (!skipWrite && !editor.inline) {\n      doc.open();\n      doc.write(editor.iframeHTML);\n      doc.close();\n    }\n\n    if (editor.inline) {\n      DOM$4.addClass(targetElm, 'mce-content-body');\n      editor.contentDocument = doc = document;\n      editor.contentWindow = window;\n      editor.bodyElement = targetElm;\n      editor.contentAreaContainer = targetElm;\n    }\n\n    var body = editor.getBody();\n    body.disabled = true;\n    editor.readonly = !!settings.readonly;\n\n    if (!editor.readonly) {\n      if (editor.inline && DOM$4.getStyle(body, 'position', true) === 'static') {\n        body.style.position = 'relative';\n      }\n\n      body.contentEditable = editor.getParam('content_editable_state', true);\n    }\n\n    body.disabled = false;\n    editor.editorUpload = EditorUpload(editor);\n    editor.schema = Schema(settings);\n    editor.dom = DOMUtils(doc, {\n      keep_values: true,\n      url_converter: editor.convertURL,\n      url_converter_scope: editor,\n      hex_colors: settings.force_hex_style_colors,\n      update_styles: true,\n      root_element: editor.inline ? editor.getBody() : null,\n      collect: function () {\n        return editor.inline;\n      },\n      schema: editor.schema,\n      contentCssCors: shouldUseContentCssCors(editor),\n      referrerPolicy: getReferrerPolicy(editor),\n      onSetAttrib: function (e) {\n        editor.fire('SetAttrib', e);\n      }\n    });\n    editor.parser = createParser(editor);\n    editor.serializer = DomSerializer(mkSerializerSettings(editor), editor);\n    editor.selection = EditorSelection(editor.dom, editor.getWin(), editor.serializer, editor);\n    editor.annotator = Annotator(editor);\n    editor.formatter = Formatter(editor);\n    editor.undoManager = UndoManager(editor);\n    editor._nodeChangeDispatcher = new NodeChange(editor);\n    editor._selectionOverrides = SelectionOverrides(editor);\n    setup$9(editor);\n    setup$j(editor);\n\n    if (!isRtc(editor)) {\n      setup$k(editor);\n    }\n\n    var caret = setup$i(editor);\n    setup$8(editor, caret);\n    setup$a(editor);\n    setup$7(editor);\n    firePreInit(editor);\n    setup$5(editor).fold(function () {\n      preInit(editor, false);\n    }, function (loadingRtc) {\n      editor.setProgressState(true);\n      loadingRtc.then(function (rtcMode) {\n        editor.setProgressState(false);\n        preInit(editor, rtcMode);\n      }, function (err) {\n        editor.notificationManager.open({\n          type: 'error',\n          text: String(err)\n        });\n        preInit(editor, true);\n      });\n    });\n  };\n\n  var DOM$5 = DOMUtils.DOM;\n\n  var relaxDomain = function (editor, ifr) {\n    if (document.domain !== window.location.hostname && Env.browser.isIE()) {\n      var bodyUuid = uuid('mce');\n\n      editor[bodyUuid] = function () {\n        initContentBody(editor);\n      };\n\n      var domainRelaxUrl = 'javascript:(function(){' + 'document.open();document.domain=\"' + document.domain + '\";' + 'var ed = window.parent.tinymce.get(\"' + editor.id + '\");document.write(ed.iframeHTML);' + 'document.close();ed.' + bodyUuid + '(true);})()';\n      DOM$5.setAttrib(ifr, 'src', domainRelaxUrl);\n      return true;\n    }\n\n    return false;\n  };\n\n  var createIframeElement = function (id, title, height, customAttrs) {\n    var iframe = SugarElement.fromTag('iframe');\n    setAll(iframe, customAttrs);\n    setAll(iframe, {\n      id: id + '_ifr',\n      frameBorder: '0',\n      allowTransparency: 'true',\n      title: title\n    });\n    add$3(iframe, 'tox-edit-area__iframe');\n    return iframe;\n  };\n\n  var getIframeHtml = function (editor) {\n    var iframeHTML = getDocType(editor) + '<html><head>';\n\n    if (getDocumentBaseUrl(editor) !== editor.documentBaseUrl) {\n      iframeHTML += '<base href=\"' + editor.documentBaseURI.getURI() + '\" />';\n    }\n\n    iframeHTML += '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />';\n    var bodyId = getBodyId(editor);\n    var bodyClass = getBodyClass(editor);\n\n    if (getContentSecurityPolicy(editor)) {\n      iframeHTML += '<meta http-equiv=\"Content-Security-Policy\" content=\"' + getContentSecurityPolicy(editor) + '\" />';\n    }\n\n    iframeHTML += '</head><body id=\"' + bodyId + '\" class=\"mce-content-body ' + bodyClass + '\" data-id=\"' + editor.id + '\"><br></body></html>';\n    return iframeHTML;\n  };\n\n  var createIframe = function (editor, o) {\n    var title = editor.editorManager.translate('Rich Text Area. Press ALT-0 for help.');\n    var ifr = createIframeElement(editor.id, title, o.height, getIframeAttrs(editor)).dom;\n\n    ifr.onload = function () {\n      ifr.onload = null;\n      editor.fire('load');\n    };\n\n    var isDomainRelaxed = relaxDomain(editor, ifr);\n    editor.contentAreaContainer = o.iframeContainer;\n    editor.iframeElement = ifr;\n    editor.iframeHTML = getIframeHtml(editor);\n    DOM$5.add(o.iframeContainer, ifr);\n    return isDomainRelaxed;\n  };\n\n  var init$1 = function (editor, boxInfo) {\n    var isDomainRelaxed = createIframe(editor, boxInfo);\n\n    if (boxInfo.editorContainer) {\n      DOM$5.get(boxInfo.editorContainer).style.display = editor.orgDisplay;\n      editor.hidden = DOM$5.isHidden(boxInfo.editorContainer);\n    }\n\n    editor.getElement().style.display = 'none';\n    DOM$5.setAttrib(editor.id, 'aria-hidden', 'true');\n\n    if (!isDomainRelaxed) {\n      initContentBody(editor);\n    }\n  };\n\n  var DOM$6 = DOMUtils.DOM;\n\n  var initPlugin = function (editor, initializedPlugins, plugin) {\n    var Plugin = PluginManager.get(plugin);\n    var pluginUrl = PluginManager.urls[plugin] || editor.documentBaseUrl.replace(/\\/$/, '');\n    plugin = Tools.trim(plugin);\n\n    if (Plugin && Tools.inArray(initializedPlugins, plugin) === -1) {\n      Tools.each(PluginManager.dependencies(plugin), function (dep) {\n        initPlugin(editor, initializedPlugins, dep);\n      });\n\n      if (editor.plugins[plugin]) {\n        return;\n      }\n\n      try {\n        var pluginInstance = new Plugin(editor, pluginUrl, editor.$);\n        editor.plugins[plugin] = pluginInstance;\n\n        if (pluginInstance.init) {\n          pluginInstance.init(editor, pluginUrl);\n          initializedPlugins.push(plugin);\n        }\n      } catch (e) {\n        pluginInitError(editor, plugin, e);\n      }\n    }\n  };\n\n  var trimLegacyPrefix = function (name) {\n    return name.replace(/^\\-/, '');\n  };\n\n  var initPlugins = function (editor) {\n    var initializedPlugins = [];\n    Tools.each(getPlugins(editor).split(/[ ,]/), function (name) {\n      initPlugin(editor, initializedPlugins, trimLegacyPrefix(name));\n    });\n  };\n\n  var initIcons = function (editor) {\n    var iconPackName = Tools.trim(getIconPackName(editor));\n    var currentIcons = editor.ui.registry.getAll().icons;\n\n    var loadIcons = __assign(__assign({}, IconManager.get('default').icons), IconManager.get(iconPackName).icons);\n\n    each$1(loadIcons, function (svgData, icon) {\n      if (!has(currentIcons, icon)) {\n        editor.ui.registry.addIcon(icon, svgData);\n      }\n    });\n  };\n\n  var initTheme = function (editor) {\n    var theme = getTheme(editor);\n\n    if (isString(theme)) {\n      editor.settings.theme = trimLegacyPrefix(theme);\n      var Theme = ThemeManager.get(theme);\n      editor.theme = new Theme(editor, ThemeManager.urls[theme]);\n\n      if (editor.theme.init) {\n        editor.theme.init(editor, ThemeManager.urls[theme] || editor.documentBaseUrl.replace(/\\/$/, ''), editor.$);\n      }\n    } else {\n      editor.theme = {};\n    }\n  };\n\n  var renderFromLoadedTheme = function (editor) {\n    return editor.theme.renderUI();\n  };\n\n  var renderFromThemeFunc = function (editor) {\n    var elm = editor.getElement();\n    var theme = getTheme(editor);\n    var info = theme(editor, elm);\n\n    if (info.editorContainer.nodeType) {\n      info.editorContainer.id = info.editorContainer.id || editor.id + '_parent';\n    }\n\n    if (info.iframeContainer && info.iframeContainer.nodeType) {\n      info.iframeContainer.id = info.iframeContainer.id || editor.id + '_iframecontainer';\n    }\n\n    info.height = info.iframeHeight ? info.iframeHeight : elm.offsetHeight;\n    return info;\n  };\n\n  var createThemeFalseResult = function (element) {\n    return {\n      editorContainer: element,\n      iframeContainer: element,\n      api: {}\n    };\n  };\n\n  var renderThemeFalseIframe = function (targetElement) {\n    var iframeContainer = DOM$6.create('div');\n    DOM$6.insertAfter(iframeContainer, targetElement);\n    return createThemeFalseResult(iframeContainer);\n  };\n\n  var renderThemeFalse = function (editor) {\n    var targetElement = editor.getElement();\n    return editor.inline ? createThemeFalseResult(null) : renderThemeFalseIframe(targetElement);\n  };\n\n  var renderThemeUi = function (editor) {\n    var elm = editor.getElement();\n    editor.orgDisplay = elm.style.display;\n\n    if (isString(getTheme(editor))) {\n      return renderFromLoadedTheme(editor);\n    } else if (isFunction(getTheme(editor))) {\n      return renderFromThemeFunc(editor);\n    } else {\n      return renderThemeFalse(editor);\n    }\n  };\n\n  var augmentEditorUiApi = function (editor, api) {\n    var uiApiFacade = {\n      show: Optional.from(api.show).getOr(noop),\n      hide: Optional.from(api.hide).getOr(noop),\n      disable: Optional.from(api.disable).getOr(noop),\n      isDisabled: Optional.from(api.isDisabled).getOr(never),\n      enable: function () {\n        if (!editor.mode.isReadOnly()) {\n          Optional.from(api.enable).map(call);\n        }\n      }\n    };\n    editor.ui = __assign(__assign({}, editor.ui), uiApiFacade);\n  };\n\n  var init$2 = function (editor) {\n    editor.fire('ScriptsLoaded');\n    initIcons(editor);\n    initTheme(editor);\n    initPlugins(editor);\n    var renderInfo = renderThemeUi(editor);\n    augmentEditorUiApi(editor, Optional.from(renderInfo.api).getOr({}));\n    var boxInfo = {\n      editorContainer: renderInfo.editorContainer,\n      iframeContainer: renderInfo.iframeContainer\n    };\n    editor.editorContainer = boxInfo.editorContainer ? boxInfo.editorContainer : null;\n    appendContentCssFromSettings(editor);\n\n    if (editor.inline) {\n      return initContentBody(editor);\n    } else {\n      return init$1(editor, boxInfo);\n    }\n  };\n\n  var DOM$7 = DOMUtils.DOM;\n\n  var hasSkipLoadPrefix = function (name) {\n    return name.charAt(0) === '-';\n  };\n\n  var loadLanguage = function (scriptLoader, editor) {\n    var languageCode = getLanguageCode(editor);\n    var languageUrl = getLanguageUrl(editor);\n\n    if (I18n.hasCode(languageCode) === false && languageCode !== 'en') {\n      var url_1 = languageUrl !== '' ? languageUrl : editor.editorManager.baseURL + '/langs/' + languageCode + '.js';\n      scriptLoader.add(url_1, noop, undefined, function () {\n        languageLoadError(editor, url_1, languageCode);\n      });\n    }\n  };\n\n  var loadTheme = function (scriptLoader, editor, suffix, callback) {\n    var theme = getTheme(editor);\n\n    if (isString(theme)) {\n      if (!hasSkipLoadPrefix(theme) && !ThemeManager.urls.hasOwnProperty(theme)) {\n        var themeUrl = getThemeUrl(editor);\n\n        if (themeUrl) {\n          ThemeManager.load(theme, editor.documentBaseURI.toAbsolute(themeUrl));\n        } else {\n          ThemeManager.load(theme, 'themes/' + theme + '/theme' + suffix + '.js');\n        }\n      }\n\n      scriptLoader.loadQueue(function () {\n        ThemeManager.waitFor(theme, callback);\n      });\n    } else {\n      callback();\n    }\n  };\n\n  var getIconsUrlMetaFromUrl = function (editor) {\n    return Optional.from(getIconsUrl(editor)).filter(function (url) {\n      return url.length > 0;\n    }).map(function (url) {\n      return {\n        url: url,\n        name: Optional.none()\n      };\n    });\n  };\n\n  var getIconsUrlMetaFromName = function (editor, name, suffix) {\n    return Optional.from(name).filter(function (name) {\n      return name.length > 0 && !IconManager.has(name);\n    }).map(function (name) {\n      return {\n        url: editor.editorManager.baseURL + '/icons/' + name + '/icons' + suffix + '.js',\n        name: Optional.some(name)\n      };\n    });\n  };\n\n  var loadIcons = function (scriptLoader, editor, suffix) {\n    var defaultIconsUrl = getIconsUrlMetaFromName(editor, 'default', suffix);\n    var customIconsUrl = getIconsUrlMetaFromUrl(editor).orThunk(function () {\n      return getIconsUrlMetaFromName(editor, getIconPackName(editor), '');\n    });\n    each(cat([defaultIconsUrl, customIconsUrl]), function (urlMeta) {\n      scriptLoader.add(urlMeta.url, noop, undefined, function () {\n        iconsLoadError(editor, urlMeta.url, urlMeta.name.getOrUndefined());\n      });\n    });\n  };\n\n  var loadPlugins = function (editor, suffix) {\n    Tools.each(getExternalPlugins(editor), function (url, name) {\n      PluginManager.load(name, url, noop, undefined, function () {\n        pluginLoadError(editor, url, name);\n      });\n      editor.settings.plugins += ' ' + name;\n    });\n    Tools.each(getPlugins(editor).split(/[ ,]/), function (plugin) {\n      plugin = Tools.trim(plugin);\n\n      if (plugin && !PluginManager.urls[plugin]) {\n        if (hasSkipLoadPrefix(plugin)) {\n          plugin = plugin.substr(1, plugin.length);\n          var dependencies = PluginManager.dependencies(plugin);\n          Tools.each(dependencies, function (depPlugin) {\n            var defaultSettings = {\n              prefix: 'plugins/',\n              resource: depPlugin,\n              suffix: '/plugin' + suffix + '.js'\n            };\n            var dep = PluginManager.createUrl(defaultSettings, depPlugin);\n            PluginManager.load(dep.resource, dep, noop, undefined, function () {\n              pluginLoadError(editor, dep.prefix + dep.resource + dep.suffix, dep.resource);\n            });\n          });\n        } else {\n          var url_2 = {\n            prefix: 'plugins/',\n            resource: plugin,\n            suffix: '/plugin' + suffix + '.js'\n          };\n          PluginManager.load(plugin, url_2, noop, undefined, function () {\n            pluginLoadError(editor, url_2.prefix + url_2.resource + url_2.suffix, plugin);\n          });\n        }\n      }\n    });\n  };\n\n  var loadScripts = function (editor, suffix) {\n    var scriptLoader = ScriptLoader.ScriptLoader;\n    loadTheme(scriptLoader, editor, suffix, function () {\n      loadLanguage(scriptLoader, editor);\n      loadIcons(scriptLoader, editor, suffix);\n      loadPlugins(editor, suffix);\n      scriptLoader.loadQueue(function () {\n        if (!editor.removed) {\n          init$2(editor);\n        }\n      }, editor, function () {\n        if (!editor.removed) {\n          init$2(editor);\n        }\n      });\n    });\n  };\n\n  var getStyleSheetLoader$1 = function (element, editor) {\n    return instance.forElement(element, {\n      contentCssCors: hasContentCssCors(editor),\n      referrerPolicy: getReferrerPolicy(editor)\n    });\n  };\n\n  var render = function (editor) {\n    var id = editor.id;\n    I18n.setCode(getLanguageCode(editor));\n\n    var readyHandler = function () {\n      DOM$7.unbind(window, 'ready', readyHandler);\n      editor.render();\n    };\n\n    if (!EventUtils.Event.domLoaded) {\n      DOM$7.bind(window, 'ready', readyHandler);\n      return;\n    }\n\n    if (!editor.getElement()) {\n      return;\n    }\n\n    if (!Env.contentEditable) {\n      return;\n    }\n\n    var element = SugarElement.fromDom(editor.getElement());\n    var snapshot = clone(element);\n    editor.on('remove', function () {\n      eachr(element.dom.attributes, function (attr) {\n        return remove$1(element, attr.name);\n      });\n      setAll(element, snapshot);\n    });\n    editor.ui.styleSheetLoader = getStyleSheetLoader$1(element, editor);\n\n    if (!isInline$1(editor)) {\n      editor.orgVisibility = editor.getElement().style.visibility;\n      editor.getElement().style.visibility = 'hidden';\n    } else {\n      editor.inline = true;\n    }\n\n    var form = editor.getElement().form || DOM$7.getParent(id, 'form');\n\n    if (form) {\n      editor.formElement = form;\n\n      if (hasHiddenInput(editor) && !isTextareaOrInput(editor.getElement())) {\n        DOM$7.insertAfter(DOM$7.create('input', {\n          type: 'hidden',\n          name: id\n        }), id);\n        editor.hasHiddenInput = true;\n      }\n\n      editor.formEventDelegate = function (e) {\n        editor.fire(e.type, e);\n      };\n\n      DOM$7.bind(form, 'submit reset', editor.formEventDelegate);\n      editor.on('reset', function () {\n        editor.resetContent();\n      });\n\n      if (shouldPatchSubmit(editor) && !form.submit.nodeType && !form.submit.length && !form._mceOldSubmit) {\n        form._mceOldSubmit = form.submit;\n\n        form.submit = function () {\n          editor.editorManager.triggerSave();\n          editor.setDirty(false);\n          return form._mceOldSubmit(form);\n        };\n      }\n    }\n\n    editor.windowManager = WindowManager(editor);\n    editor.notificationManager = NotificationManager(editor);\n\n    if (isEncodingXml(editor)) {\n      editor.on('GetContent', function (e) {\n        if (e.save) {\n          e.content = DOM$7.encode(e.content);\n        }\n      });\n    }\n\n    if (shouldAddFormSubmitTrigger(editor)) {\n      editor.on('submit', function () {\n        if (editor.initialized) {\n          editor.save();\n        }\n      });\n    }\n\n    if (shouldAddUnloadTrigger(editor)) {\n      editor._beforeUnload = function () {\n        if (editor.initialized && !editor.destroyed && !editor.isHidden()) {\n          editor.save({\n            format: 'raw',\n            no_events: true,\n            set_dirty: false\n          });\n        }\n      };\n\n      editor.editorManager.on('BeforeUnload', editor._beforeUnload);\n    }\n\n    editor.editorManager.add(editor);\n    loadScripts(editor, editor.suffix);\n  };\n\n  var addVisual$1 = function (editor, elm) {\n    return addVisual(editor, elm);\n  };\n\n  var legacyPropNames = {\n    'font-size': 'size',\n    'font-family': 'face'\n  };\n\n  var getSpecifiedFontProp = function (propName, rootElm, elm) {\n    var getProperty = function (elm) {\n      return getRaw(elm, propName).orThunk(function () {\n        if (name(elm) === 'font') {\n          return get$1(legacyPropNames, propName).bind(function (legacyPropName) {\n            return getOpt(elm, legacyPropName);\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n\n    var isRoot = function (elm) {\n      return eq$2(SugarElement.fromDom(rootElm), elm);\n    };\n\n    return closest$2(SugarElement.fromDom(elm), function (elm) {\n      return getProperty(elm);\n    }, isRoot);\n  };\n\n  var normalizeFontFamily = function (fontFamily) {\n    return fontFamily.replace(/[\\'\\\"\\\\]/g, '').replace(/,\\s+/g, ',');\n  };\n\n  var getComputedFontProp = function (propName, elm) {\n    return Optional.from(DOMUtils.DOM.getStyle(elm, propName, true));\n  };\n\n  var getFontProp = function (propName) {\n    return function (rootElm, elm) {\n      return Optional.from(elm).map(SugarElement.fromDom).filter(isElement).bind(function (element) {\n        return getSpecifiedFontProp(propName, rootElm, element.dom).or(getComputedFontProp(propName, element.dom));\n      }).getOr('');\n    };\n  };\n\n  var getFontSize = getFontProp('font-size');\n  var getFontFamily = compose(normalizeFontFamily, getFontProp('font-family'));\n\n  var findFirstCaretElement = function (editor) {\n    return firstPositionIn(editor.getBody()).map(function (caret) {\n      var container = caret.container();\n      return isText$1(container) ? container.parentNode : container;\n    });\n  };\n\n  var getCaretElement = function (editor) {\n    return Optional.from(editor.selection.getRng()).bind(function (rng) {\n      var root = editor.getBody();\n      var atStartOfNode = rng.startContainer === root && rng.startOffset === 0;\n      return atStartOfNode ? Optional.none() : Optional.from(editor.selection.getStart(true));\n    });\n  };\n\n  var mapRange = function (editor, mapper) {\n    return getCaretElement(editor).orThunk(curry(findFirstCaretElement, editor)).map(SugarElement.fromDom).filter(isElement).map(mapper);\n  };\n\n  var fromFontSizeNumber = function (editor, value) {\n    if (/^[0-9.]+$/.test(value)) {\n      var fontSizeNumber = parseInt(value, 10);\n\n      if (fontSizeNumber >= 1 && fontSizeNumber <= 7) {\n        var fontSizes = getFontStyleValues(editor);\n        var fontClasses = getFontSizeClasses(editor);\n\n        if (fontClasses) {\n          return fontClasses[fontSizeNumber - 1] || value;\n        } else {\n          return fontSizes[fontSizeNumber - 1] || value;\n        }\n      } else {\n        return value;\n      }\n    } else {\n      return value;\n    }\n  };\n\n  var normalizeFontNames = function (font) {\n    var fonts = font.split(/\\s*,\\s*/);\n    return map(fonts, function (font) {\n      if (font.indexOf(' ') !== -1 && !(startsWith(font, '\"') || startsWith(font, '\\''))) {\n        return '\\'' + font + '\\'';\n      } else {\n        return font;\n      }\n    }).join(',');\n  };\n\n  var fontNameAction = function (editor, value) {\n    var font = fromFontSizeNumber(editor, value);\n    editor.formatter.toggle('fontname', {\n      value: normalizeFontNames(font)\n    });\n    editor.nodeChanged();\n  };\n\n  var fontNameQuery = function (editor) {\n    return mapRange(editor, function (elm) {\n      return getFontFamily(editor.getBody(), elm.dom);\n    }).getOr('');\n  };\n\n  var fontSizeAction = function (editor, value) {\n    editor.formatter.toggle('fontsize', {\n      value: fromFontSizeNumber(editor, value)\n    });\n    editor.nodeChanged();\n  };\n\n  var fontSizeQuery = function (editor) {\n    return mapRange(editor, function (elm) {\n      return getFontSize(editor.getBody(), elm.dom);\n    }).getOr('');\n  };\n\n  var lineHeightQuery = function (editor) {\n    return mapRange(editor, function (elm) {\n      var root = SugarElement.fromDom(editor.getBody());\n      var specifiedStyle = closest$2(elm, function (elm) {\n        return getRaw(elm, 'line-height');\n      }, curry(eq$2, root));\n\n      var computedStyle = function () {\n        var lineHeight = parseFloat(get$5(elm, 'line-height'));\n        var fontSize = parseFloat(get$5(elm, 'font-size'));\n        return String(lineHeight / fontSize);\n      };\n\n      return specifiedStyle.getOrThunk(computedStyle);\n    }).getOr('');\n  };\n\n  var lineHeightAction = function (editor, lineHeight) {\n    editor.undoManager.transact(function () {\n      editor.formatter.toggle('lineheight', {\n        value: String(lineHeight)\n      });\n      editor.nodeChanged();\n    });\n  };\n\n  var processValue = function (value) {\n    var details;\n\n    if (typeof value !== 'string') {\n      details = Tools.extend({\n        paste: value.paste,\n        data: {\n          paste: value.paste\n        }\n      }, value);\n      return {\n        content: value.content,\n        details: details\n      };\n    }\n\n    return {\n      content: value,\n      details: {}\n    };\n  };\n\n  var insertAtCaret$1 = function (editor, value) {\n    var result = processValue(value);\n    insertContent(editor, result.content, result.details);\n  };\n\n  var each$f = Tools.each;\n  var map$3 = Tools.map,\n      inArray$2 = Tools.inArray;\n\n  var EditorCommands = function () {\n    function EditorCommands(editor) {\n      this.commands = {\n        state: {},\n        exec: {},\n        value: {}\n      };\n      this.editor = editor;\n      this.setupCommands(editor);\n    }\n\n    EditorCommands.prototype.execCommand = function (command, ui, value, args) {\n      var func,\n          state = false;\n      var self = this;\n\n      if (self.editor.removed) {\n        return;\n      }\n\n      if (!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command) && (!args || !args.skip_focus)) {\n        self.editor.focus();\n      } else {\n        restore(self.editor);\n      }\n\n      args = self.editor.fire('BeforeExecCommand', {\n        command: command,\n        ui: ui,\n        value: value\n      });\n\n      if (args.isDefaultPrevented()) {\n        return false;\n      }\n\n      var customCommand = command.toLowerCase();\n\n      if (func = self.commands.exec[customCommand]) {\n        func(customCommand, ui, value);\n        self.editor.fire('ExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        return true;\n      }\n\n      each$f(this.editor.plugins, function (p) {\n        if (p.execCommand && p.execCommand(command, ui, value)) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          state = true;\n          return false;\n        }\n      });\n\n      if (state) {\n        return state;\n      }\n\n      if (self.editor.theme && self.editor.theme.execCommand && self.editor.theme.execCommand(command, ui, value)) {\n        self.editor.fire('ExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        return true;\n      }\n\n      try {\n        state = self.editor.getDoc().execCommand(command, ui, value);\n      } catch (ex) {}\n\n      if (state) {\n        self.editor.fire('ExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        return true;\n      }\n\n      return false;\n    };\n\n    EditorCommands.prototype.queryCommandState = function (command) {\n      var func;\n\n      if (this.editor.quirks.isHidden() || this.editor.removed) {\n        return;\n      }\n\n      command = command.toLowerCase();\n\n      if (func = this.commands.state[command]) {\n        return func(command);\n      }\n\n      try {\n        return this.editor.getDoc().queryCommandState(command);\n      } catch (ex) {}\n\n      return false;\n    };\n\n    EditorCommands.prototype.queryCommandValue = function (command) {\n      var func;\n\n      if (this.editor.quirks.isHidden() || this.editor.removed) {\n        return;\n      }\n\n      command = command.toLowerCase();\n\n      if (func = this.commands.value[command]) {\n        return func(command);\n      }\n\n      try {\n        return this.editor.getDoc().queryCommandValue(command);\n      } catch (ex) {}\n    };\n\n    EditorCommands.prototype.addCommands = function (commandList, type) {\n      if (type === void 0) {\n        type = 'exec';\n      }\n\n      var self = this;\n      each$f(commandList, function (callback, command) {\n        each$f(command.toLowerCase().split(','), function (command) {\n          self.commands[type][command] = callback;\n        });\n      });\n    };\n\n    EditorCommands.prototype.addCommand = function (command, callback, scope) {\n      var _this = this;\n\n      command = command.toLowerCase();\n\n      this.commands.exec[command] = function (command, ui, value, args) {\n        return callback.call(scope || _this.editor, ui, value, args);\n      };\n    };\n\n    EditorCommands.prototype.queryCommandSupported = function (command) {\n      command = command.toLowerCase();\n\n      if (this.commands.exec[command]) {\n        return true;\n      }\n\n      try {\n        return this.editor.getDoc().queryCommandSupported(command);\n      } catch (ex) {}\n\n      return false;\n    };\n\n    EditorCommands.prototype.addQueryStateHandler = function (command, callback, scope) {\n      var _this = this;\n\n      command = command.toLowerCase();\n\n      this.commands.state[command] = function () {\n        return callback.call(scope || _this.editor);\n      };\n    };\n\n    EditorCommands.prototype.addQueryValueHandler = function (command, callback, scope) {\n      var _this = this;\n\n      command = command.toLowerCase();\n\n      this.commands.value[command] = function () {\n        return callback.call(scope || _this.editor);\n      };\n    };\n\n    EditorCommands.prototype.hasCustomCommand = function (command) {\n      command = command.toLowerCase();\n      return !!this.commands.exec[command];\n    };\n\n    EditorCommands.prototype.execNativeCommand = function (command, ui, value) {\n      if (ui === undefined) {\n        ui = false;\n      }\n\n      if (value === undefined) {\n        value = null;\n      }\n\n      return this.editor.getDoc().execCommand(command, ui, value);\n    };\n\n    EditorCommands.prototype.isFormatMatch = function (name) {\n      return this.editor.formatter.match(name);\n    };\n\n    EditorCommands.prototype.toggleFormat = function (name, value) {\n      this.editor.formatter.toggle(name, value ? {\n        value: value\n      } : undefined);\n      this.editor.nodeChanged();\n    };\n\n    EditorCommands.prototype.storeSelection = function (type) {\n      this.selectionBookmark = this.editor.selection.getBookmark(type);\n    };\n\n    EditorCommands.prototype.restoreSelection = function () {\n      this.editor.selection.moveToBookmark(this.selectionBookmark);\n    };\n\n    EditorCommands.prototype.setupCommands = function (editor) {\n      var self = this;\n      this.addCommands({\n        'mceResetDesignMode,mceBeginUndoLevel': noop,\n        'mceEndUndoLevel,mceAddUndoLevel': function () {\n          editor.undoManager.add();\n        },\n        'Cut,Copy,Paste': function (command) {\n          var doc = editor.getDoc();\n          var failed;\n\n          try {\n            self.execNativeCommand(command);\n          } catch (ex) {\n            failed = true;\n          }\n\n          if (command === 'paste' && !doc.queryCommandEnabled(command)) {\n            failed = true;\n          }\n\n          if (failed || !doc.queryCommandSupported(command)) {\n            var msg = editor.translate('Your browser doesn\\'t support direct access to the clipboard. ' + 'Please use the Ctrl+X/C/V keyboard shortcuts instead.');\n\n            if (Env.mac) {\n              msg = msg.replace(/Ctrl\\+/g, '\\u2318+');\n            }\n\n            editor.notificationManager.open({\n              text: msg,\n              type: 'error'\n            });\n          }\n        },\n        'unlink': function () {\n          if (editor.selection.isCollapsed()) {\n            var elm = editor.dom.getParent(editor.selection.getStart(), 'a');\n\n            if (elm) {\n              editor.dom.remove(elm, true);\n            }\n\n            return;\n          }\n\n          editor.formatter.remove('link');\n        },\n        'JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone': function (command) {\n          var align = command.substring(7);\n\n          if (align === 'full') {\n            align = 'justify';\n          }\n\n          each$f('left,center,right,justify'.split(','), function (name) {\n            if (align !== name) {\n              editor.formatter.remove('align' + name);\n            }\n          });\n\n          if (align !== 'none') {\n            self.toggleFormat('align' + align);\n          }\n        },\n        'InsertUnorderedList,InsertOrderedList': function (command) {\n          var listParent;\n          self.execNativeCommand(command);\n          var listElm = editor.dom.getParent(editor.selection.getNode(), 'ol,ul');\n\n          if (listElm) {\n            listParent = listElm.parentNode;\n\n            if (/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)) {\n              self.storeSelection();\n              editor.dom.split(listParent, listElm);\n              self.restoreSelection();\n            }\n          }\n        },\n        'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n          self.toggleFormat(command);\n        },\n        'ForeColor,HiliteColor': function (command, ui, value) {\n          self.toggleFormat(command, value);\n        },\n        'FontName': function (command, ui, value) {\n          fontNameAction(editor, value);\n        },\n        'FontSize': function (command, ui, value) {\n          fontSizeAction(editor, value);\n        },\n        'LineHeight': function (command, ui, value) {\n          lineHeightAction(editor, value);\n        },\n        'RemoveFormat': function (command) {\n          editor.formatter.remove(command);\n        },\n        'mceBlockQuote': function () {\n          self.toggleFormat('blockquote');\n        },\n        'FormatBlock': function (command, ui, value) {\n          return self.toggleFormat(value || 'p');\n        },\n        'mceCleanup': function () {\n          var bookmark = editor.selection.getBookmark();\n          editor.setContent(editor.getContent());\n          editor.selection.moveToBookmark(bookmark);\n        },\n        'mceRemoveNode': function (command, ui, value) {\n          var node = value || editor.selection.getNode();\n\n          if (node !== editor.getBody()) {\n            self.storeSelection();\n            editor.dom.remove(node, true);\n            self.restoreSelection();\n          }\n        },\n        'mceSelectNodeDepth': function (command, ui, value) {\n          var counter = 0;\n          editor.dom.getParent(editor.selection.getNode(), function (node) {\n            if (node.nodeType === 1 && counter++ === value) {\n              editor.selection.select(node);\n              return false;\n            }\n          }, editor.getBody());\n        },\n        'mceSelectNode': function (command, ui, value) {\n          editor.selection.select(value);\n        },\n        'mceInsertContent': function (command, ui, value) {\n          insertAtCaret$1(editor, value);\n        },\n        'mceInsertRawHTML': function (command, ui, value) {\n          editor.selection.setContent('tiny_mce_marker');\n          var content = editor.getContent();\n          editor.setContent(content.replace(/tiny_mce_marker/g, function () {\n            return value;\n          }));\n        },\n        'mceInsertNewLine': function (command, ui, value) {\n          insert$3(editor, value);\n        },\n        'mceToggleFormat': function (command, ui, value) {\n          self.toggleFormat(value);\n        },\n        'mceSetContent': function (command, ui, value) {\n          editor.setContent(value);\n        },\n        'Indent,Outdent': function (command) {\n          handle(editor, command);\n        },\n        'mceRepaint': noop,\n        'InsertHorizontalRule': function () {\n          editor.execCommand('mceInsertContent', false, '<hr />');\n        },\n        'mceToggleVisualAid': function () {\n          editor.hasVisual = !editor.hasVisual;\n          editor.addVisual();\n        },\n        'mceReplaceContent': function (command, ui, value) {\n          editor.execCommand('mceInsertContent', false, value.replace(/\\{\\$selection\\}/g, editor.selection.getContent({\n            format: 'text'\n          })));\n        },\n        'mceInsertLink': function (command, ui, value) {\n          if (typeof value === 'string') {\n            value = {\n              href: value\n            };\n          }\n\n          var anchor = editor.dom.getParent(editor.selection.getNode(), 'a');\n          value.href = value.href.replace(/ /g, '%20');\n\n          if (!anchor || !value.href) {\n            editor.formatter.remove('link');\n          }\n\n          if (value.href) {\n            editor.formatter.apply('link', value, anchor);\n          }\n        },\n        'selectAll': function () {\n          var editingHost = editor.dom.getParent(editor.selection.getStart(), isContentEditableTrue);\n\n          if (editingHost) {\n            var rng = editor.dom.createRng();\n            rng.selectNodeContents(editingHost);\n            editor.selection.setRng(rng);\n          }\n        },\n        'mceNewDocument': function () {\n          editor.setContent('');\n        },\n        'InsertLineBreak': function (command, ui, value) {\n          insert$2(editor, value);\n          return true;\n        }\n      });\n\n      var alignStates = function (name) {\n        return function () {\n          var selection = editor.selection;\n          var nodes = selection.isCollapsed() ? [editor.dom.getParent(selection.getNode(), editor.dom.isBlock)] : selection.getSelectedBlocks();\n          var matches = map$3(nodes, function (node) {\n            return !!editor.formatter.matchNode(node, name);\n          });\n          return inArray$2(matches, true) !== -1;\n        };\n      };\n\n      self.addCommands({\n        'JustifyLeft': alignStates('alignleft'),\n        'JustifyCenter': alignStates('aligncenter'),\n        'JustifyRight': alignStates('alignright'),\n        'JustifyFull': alignStates('alignjustify'),\n        'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n          return self.isFormatMatch(command);\n        },\n        'mceBlockQuote': function () {\n          return self.isFormatMatch('blockquote');\n        },\n        'Outdent': function () {\n          return canOutdent(editor);\n        },\n        'InsertUnorderedList,InsertOrderedList': function (command) {\n          var list = editor.dom.getParent(editor.selection.getNode(), 'ul,ol');\n          return list && (command === 'insertunorderedlist' && list.tagName === 'UL' || command === 'insertorderedlist' && list.tagName === 'OL');\n        }\n      }, 'state');\n      self.addCommands({\n        Undo: function () {\n          editor.undoManager.undo();\n        },\n        Redo: function () {\n          editor.undoManager.redo();\n        }\n      });\n      self.addQueryValueHandler('FontName', function () {\n        return fontNameQuery(editor);\n      }, this);\n      self.addQueryValueHandler('FontSize', function () {\n        return fontSizeQuery(editor);\n      }, this);\n      self.addQueryValueHandler('LineHeight', function () {\n        return lineHeightQuery(editor);\n      }, this);\n    };\n\n    return EditorCommands;\n  }();\n\n  var internalContentEditableAttr = 'data-mce-contenteditable';\n\n  var toggleClass = function (elm, cls, state) {\n    if (has$2(elm, cls) && state === false) {\n      remove$4(elm, cls);\n    } else if (state) {\n      add$3(elm, cls);\n    }\n  };\n\n  var setEditorCommandState = function (editor, cmd, state) {\n    try {\n      editor.getDoc().execCommand(cmd, false, String(state));\n    } catch (ex) {}\n  };\n\n  var setContentEditable = function (elm, state) {\n    elm.dom.contentEditable = state ? 'true' : 'false';\n  };\n\n  var switchOffContentEditableTrue = function (elm) {\n    each(descendants$1(elm, '*[contenteditable=\"true\"]'), function (elm) {\n      set(elm, internalContentEditableAttr, 'true');\n      setContentEditable(elm, false);\n    });\n  };\n\n  var switchOnContentEditableTrue = function (elm) {\n    each(descendants$1(elm, '*[' + internalContentEditableAttr + '=\"true\"]'), function (elm) {\n      remove$1(elm, internalContentEditableAttr);\n      setContentEditable(elm, true);\n    });\n  };\n\n  var removeFakeSelection = function (editor) {\n    Optional.from(editor.selection.getNode()).each(function (elm) {\n      elm.removeAttribute('data-mce-selected');\n    });\n  };\n\n  var restoreFakeSelection = function (editor) {\n    editor.selection.setRng(editor.selection.getRng());\n  };\n\n  var toggleReadOnly = function (editor, state) {\n    var body = SugarElement.fromDom(editor.getBody());\n    toggleClass(body, 'mce-content-readonly', state);\n\n    if (state) {\n      editor.selection.controlSelection.hideResizeRect();\n\n      editor._selectionOverrides.hideFakeCaret();\n\n      removeFakeSelection(editor);\n      editor.readonly = true;\n      setContentEditable(body, false);\n      switchOffContentEditableTrue(body);\n    } else {\n      editor.readonly = false;\n      setContentEditable(body, true);\n      switchOnContentEditableTrue(body);\n      setEditorCommandState(editor, 'StyleWithCSS', false);\n      setEditorCommandState(editor, 'enableInlineTableEditing', false);\n      setEditorCommandState(editor, 'enableObjectResizing', false);\n\n      if (hasEditorOrUiFocus(editor)) {\n        editor.focus();\n      }\n\n      restoreFakeSelection(editor);\n      editor.nodeChanged();\n    }\n  };\n\n  var isReadOnly$1 = function (editor) {\n    return editor.readonly;\n  };\n\n  var registerFilters = function (editor) {\n    editor.parser.addAttributeFilter('contenteditable', function (nodes) {\n      if (isReadOnly$1(editor)) {\n        each(nodes, function (node) {\n          node.attr(internalContentEditableAttr, node.attr('contenteditable'));\n          node.attr('contenteditable', 'false');\n        });\n      }\n    });\n    editor.serializer.addAttributeFilter(internalContentEditableAttr, function (nodes) {\n      if (isReadOnly$1(editor)) {\n        each(nodes, function (node) {\n          node.attr('contenteditable', node.attr(internalContentEditableAttr));\n        });\n      }\n    });\n    editor.serializer.addTempAttr(internalContentEditableAttr);\n  };\n\n  var registerReadOnlyContentFilters = function (editor) {\n    if (editor.serializer) {\n      registerFilters(editor);\n    } else {\n      editor.on('PreInit', function () {\n        registerFilters(editor);\n      });\n    }\n  };\n\n  var isClickEvent = function (e) {\n    return e.type === 'click';\n  };\n\n  var getAnchorHrefOpt = function (editor, elm) {\n    var isRoot = function (elm) {\n      return eq$2(elm, SugarElement.fromDom(editor.getBody()));\n    };\n\n    return closest$1(elm, 'a', isRoot).bind(function (a) {\n      return getOpt(a, 'href');\n    });\n  };\n\n  var processReadonlyEvents = function (editor, e) {\n    if (isClickEvent(e) && !VK.metaKeyPressed(e)) {\n      var elm = SugarElement.fromDom(e.target);\n      getAnchorHrefOpt(editor, elm).each(function (href) {\n        e.preventDefault();\n\n        if (/^#/.test(href)) {\n          var targetEl = editor.dom.select(href + ',[name=\"' + removeLeading(href, '#') + '\"]');\n\n          if (targetEl.length) {\n            editor.selection.scrollIntoView(targetEl[0], true);\n          }\n        } else {\n          window.open(href, '_blank', 'rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes');\n        }\n      });\n    }\n  };\n\n  var registerReadOnlySelectionBlockers = function (editor) {\n    editor.on('ShowCaret', function (e) {\n      if (isReadOnly$1(editor)) {\n        e.preventDefault();\n      }\n    });\n    editor.on('ObjectSelected', function (e) {\n      if (isReadOnly$1(editor)) {\n        e.preventDefault();\n      }\n    });\n  };\n\n  var nativeEvents = Tools.makeMap('focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange ' + 'mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover ' + 'draggesture dragdrop drop drag submit ' + 'compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel', ' ');\n\n  var EventDispatcher = function () {\n    function EventDispatcher(settings) {\n      this.bindings = {};\n      this.settings = settings || {};\n      this.scope = this.settings.scope || this;\n      this.toggleEvent = this.settings.toggleEvent || never;\n    }\n\n    EventDispatcher.isNative = function (name) {\n      return !!nativeEvents[name.toLowerCase()];\n    };\n\n    EventDispatcher.prototype.fire = function (nameIn, argsIn) {\n      var name = nameIn.toLowerCase();\n      var args = argsIn || {};\n      args.type = name;\n\n      if (!args.target) {\n        args.target = this.scope;\n      }\n\n      if (!args.preventDefault) {\n        args.preventDefault = function () {\n          args.isDefaultPrevented = always;\n        };\n\n        args.stopPropagation = function () {\n          args.isPropagationStopped = always;\n        };\n\n        args.stopImmediatePropagation = function () {\n          args.isImmediatePropagationStopped = always;\n        };\n\n        args.isDefaultPrevented = never;\n        args.isPropagationStopped = never;\n        args.isImmediatePropagationStopped = never;\n      }\n\n      if (this.settings.beforeFire) {\n        this.settings.beforeFire(args);\n      }\n\n      var handlers = this.bindings[name];\n\n      if (handlers) {\n        for (var i = 0, l = handlers.length; i < l; i++) {\n          var callback = handlers[i];\n\n          if (callback.once) {\n            this.off(name, callback.func);\n          }\n\n          if (args.isImmediatePropagationStopped()) {\n            args.stopPropagation();\n            return args;\n          }\n\n          if (callback.func.call(this.scope, args) === false) {\n            args.preventDefault();\n            return args;\n          }\n        }\n      }\n\n      return args;\n    };\n\n    EventDispatcher.prototype.on = function (name, callback, prepend, extra) {\n      if (callback === false) {\n        callback = never;\n      }\n\n      if (callback) {\n        var wrappedCallback = {\n          func: callback\n        };\n\n        if (extra) {\n          Tools.extend(wrappedCallback, extra);\n        }\n\n        var names = name.toLowerCase().split(' ');\n        var i = names.length;\n\n        while (i--) {\n          var currentName = names[i];\n          var handlers = this.bindings[currentName];\n\n          if (!handlers) {\n            handlers = this.bindings[currentName] = [];\n            this.toggleEvent(currentName, true);\n          }\n\n          if (prepend) {\n            handlers.unshift(wrappedCallback);\n          } else {\n            handlers.push(wrappedCallback);\n          }\n        }\n      }\n\n      return this;\n    };\n\n    EventDispatcher.prototype.off = function (name, callback) {\n      var _this = this;\n\n      if (name) {\n        var names = name.toLowerCase().split(' ');\n        var i = names.length;\n\n        while (i--) {\n          var currentName = names[i];\n          var handlers = this.bindings[currentName];\n\n          if (!currentName) {\n            each$1(this.bindings, function (_value, bindingName) {\n              _this.toggleEvent(bindingName, false);\n\n              delete _this.bindings[bindingName];\n            });\n            return this;\n          }\n\n          if (handlers) {\n            if (!callback) {\n              handlers.length = 0;\n            } else {\n              var hi = handlers.length;\n\n              while (hi--) {\n                if (handlers[hi].func === callback) {\n                  handlers = handlers.slice(0, hi).concat(handlers.slice(hi + 1));\n                  this.bindings[currentName] = handlers;\n                }\n              }\n            }\n\n            if (!handlers.length) {\n              this.toggleEvent(name, false);\n              delete this.bindings[currentName];\n            }\n          }\n        }\n      } else {\n        each$1(this.bindings, function (_value, name) {\n          _this.toggleEvent(name, false);\n        });\n        this.bindings = {};\n      }\n\n      return this;\n    };\n\n    EventDispatcher.prototype.once = function (name, callback, prepend) {\n      return this.on(name, callback, prepend, {\n        once: true\n      });\n    };\n\n    EventDispatcher.prototype.has = function (name) {\n      name = name.toLowerCase();\n      return !(!this.bindings[name] || this.bindings[name].length === 0);\n    };\n\n    return EventDispatcher;\n  }();\n\n  var getEventDispatcher = function (obj) {\n    if (!obj._eventDispatcher) {\n      obj._eventDispatcher = new EventDispatcher({\n        scope: obj,\n        toggleEvent: function (name, state) {\n          if (EventDispatcher.isNative(name) && obj.toggleNativeEvent) {\n            obj.toggleNativeEvent(name, state);\n          }\n        }\n      });\n    }\n\n    return obj._eventDispatcher;\n  };\n\n  var Observable = {\n    fire: function (name, args, bubble) {\n      var self = this;\n\n      if (self.removed && name !== 'remove' && name !== 'detach') {\n        return args;\n      }\n\n      var dispatcherArgs = getEventDispatcher(self).fire(name, args);\n\n      if (bubble !== false && self.parent) {\n        var parent_1 = self.parent();\n\n        while (parent_1 && !dispatcherArgs.isPropagationStopped()) {\n          parent_1.fire(name, dispatcherArgs, false);\n          parent_1 = parent_1.parent();\n        }\n      }\n\n      return dispatcherArgs;\n    },\n    on: function (name, callback, prepend) {\n      return getEventDispatcher(this).on(name, callback, prepend);\n    },\n    off: function (name, callback) {\n      return getEventDispatcher(this).off(name, callback);\n    },\n    once: function (name, callback) {\n      return getEventDispatcher(this).once(name, callback);\n    },\n    hasEventListeners: function (name) {\n      return getEventDispatcher(this).has(name);\n    }\n  };\n  var DOM$8 = DOMUtils.DOM;\n  var customEventRootDelegates;\n\n  var getEventTarget = function (editor, eventName) {\n    if (eventName === 'selectionchange') {\n      return editor.getDoc();\n    }\n\n    if (!editor.inline && /^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)) {\n      return editor.getDoc().documentElement;\n    }\n\n    var eventRoot = getEventRoot(editor);\n\n    if (eventRoot) {\n      if (!editor.eventRoot) {\n        editor.eventRoot = DOM$8.select(eventRoot)[0];\n      }\n\n      return editor.eventRoot;\n    }\n\n    return editor.getBody();\n  };\n\n  var isListening = function (editor) {\n    return !editor.hidden && !isReadOnly$1(editor);\n  };\n\n  var fireEvent = function (editor, eventName, e) {\n    if (isListening(editor)) {\n      editor.fire(eventName, e);\n    } else if (isReadOnly$1(editor)) {\n      processReadonlyEvents(editor, e);\n    }\n  };\n\n  var bindEventDelegate = function (editor, eventName) {\n    var delegate;\n\n    if (!editor.delegates) {\n      editor.delegates = {};\n    }\n\n    if (editor.delegates[eventName] || editor.removed) {\n      return;\n    }\n\n    var eventRootElm = getEventTarget(editor, eventName);\n\n    if (getEventRoot(editor)) {\n      if (!customEventRootDelegates) {\n        customEventRootDelegates = {};\n        editor.editorManager.on('removeEditor', function () {\n          if (!editor.editorManager.activeEditor) {\n            if (customEventRootDelegates) {\n              each$1(customEventRootDelegates, function (_value, name) {\n                editor.dom.unbind(getEventTarget(editor, name));\n              });\n              customEventRootDelegates = null;\n            }\n          }\n        });\n      }\n\n      if (customEventRootDelegates[eventName]) {\n        return;\n      }\n\n      delegate = function (e) {\n        var target = e.target;\n        var editors = editor.editorManager.get();\n        var i = editors.length;\n\n        while (i--) {\n          var body = editors[i].getBody();\n\n          if (body === target || DOM$8.isChildOf(target, body)) {\n            fireEvent(editors[i], eventName, e);\n          }\n        }\n      };\n\n      customEventRootDelegates[eventName] = delegate;\n      DOM$8.bind(eventRootElm, eventName, delegate);\n    } else {\n      delegate = function (e) {\n        fireEvent(editor, eventName, e);\n      };\n\n      DOM$8.bind(eventRootElm, eventName, delegate);\n      editor.delegates[eventName] = delegate;\n    }\n  };\n\n  var EditorObservable = __assign(__assign({}, Observable), {\n    bindPendingEventDelegates: function () {\n      var self = this;\n      Tools.each(self._pendingNativeEvents, function (name) {\n        bindEventDelegate(self, name);\n      });\n    },\n    toggleNativeEvent: function (name, state) {\n      var self = this;\n\n      if (name === 'focus' || name === 'blur') {\n        return;\n      }\n\n      if (state) {\n        if (self.initialized) {\n          bindEventDelegate(self, name);\n        } else {\n          if (!self._pendingNativeEvents) {\n            self._pendingNativeEvents = [name];\n          } else {\n            self._pendingNativeEvents.push(name);\n          }\n        }\n      } else if (self.initialized) {\n        self.dom.unbind(getEventTarget(self, name), name, self.delegates[name]);\n        delete self.delegates[name];\n      }\n    },\n    unbindAllNativeEvents: function () {\n      var self = this;\n      var body = self.getBody();\n      var dom = self.dom;\n\n      if (self.delegates) {\n        each$1(self.delegates, function (value, name) {\n          self.dom.unbind(getEventTarget(self, name), name, value);\n        });\n        delete self.delegates;\n      }\n\n      if (!self.inline && body && dom) {\n        body.onload = null;\n        dom.unbind(self.getWin());\n        dom.unbind(self.getDoc());\n      }\n\n      if (dom) {\n        dom.unbind(body);\n        dom.unbind(self.getContainer());\n      }\n    }\n  });\n\n  var defaultModes = ['design', 'readonly'];\n\n  var switchToMode = function (editor, activeMode, availableModes, mode) {\n    var oldMode = availableModes[activeMode.get()];\n    var newMode = availableModes[mode];\n\n    try {\n      newMode.activate();\n    } catch (e) {\n      console.error('problem while activating editor mode ' + mode + ':', e);\n      return;\n    }\n\n    oldMode.deactivate();\n\n    if (oldMode.editorReadOnly !== newMode.editorReadOnly) {\n      toggleReadOnly(editor, newMode.editorReadOnly);\n    }\n\n    activeMode.set(mode);\n    fireSwitchMode(editor, mode);\n  };\n\n  var setMode = function (editor, availableModes, activeMode, mode) {\n    if (mode === activeMode.get()) {\n      return;\n    } else if (!has(availableModes, mode)) {\n      throw new Error('Editor mode \\'' + mode + '\\' is invalid');\n    }\n\n    if (editor.initialized) {\n      switchToMode(editor, activeMode, availableModes, mode);\n    } else {\n      editor.on('init', function () {\n        return switchToMode(editor, activeMode, availableModes, mode);\n      });\n    }\n  };\n\n  var registerMode = function (availableModes, mode, api) {\n    var _a;\n\n    if (contains(defaultModes, mode)) {\n      throw new Error('Cannot override default mode ' + mode);\n    }\n\n    return __assign(__assign({}, availableModes), (_a = {}, _a[mode] = __assign(__assign({}, api), {\n      deactivate: function () {\n        try {\n          api.deactivate();\n        } catch (e) {\n          console.error('problem while deactivating editor mode ' + mode + ':', e);\n        }\n      }\n    }), _a));\n  };\n\n  var create$5 = function (editor) {\n    var activeMode = Cell('design');\n    var availableModes = Cell({\n      design: {\n        activate: noop,\n        deactivate: noop,\n        editorReadOnly: false\n      },\n      readonly: {\n        activate: noop,\n        deactivate: noop,\n        editorReadOnly: true\n      }\n    });\n    registerReadOnlyContentFilters(editor);\n    registerReadOnlySelectionBlockers(editor);\n    return {\n      isReadOnly: function () {\n        return isReadOnly$1(editor);\n      },\n      set: function (mode) {\n        return setMode(editor, availableModes.get(), activeMode, mode);\n      },\n      get: function () {\n        return activeMode.get();\n      },\n      register: function (mode, api) {\n        availableModes.set(registerMode(availableModes.get(), mode, api));\n      }\n    };\n  };\n\n  var each$g = Tools.each,\n      explode$3 = Tools.explode;\n  var keyCodeLookup = {\n    f1: 112,\n    f2: 113,\n    f3: 114,\n    f4: 115,\n    f5: 116,\n    f6: 117,\n    f7: 118,\n    f8: 119,\n    f9: 120,\n    f10: 121,\n    f11: 122,\n    f12: 123\n  };\n  var modifierNames = Tools.makeMap('alt,ctrl,shift,meta,access');\n\n  var parseShortcut = function (pattern) {\n    var key;\n    var shortcut = {};\n    each$g(explode$3(pattern.toLowerCase(), '+'), function (value) {\n      if (value in modifierNames) {\n        shortcut[value] = true;\n      } else {\n        if (/^[0-9]{2,}$/.test(value)) {\n          shortcut.keyCode = parseInt(value, 10);\n        } else {\n          shortcut.charCode = value.charCodeAt(0);\n          shortcut.keyCode = keyCodeLookup[value] || value.toUpperCase().charCodeAt(0);\n        }\n      }\n    });\n    var id = [shortcut.keyCode];\n\n    for (key in modifierNames) {\n      if (shortcut[key]) {\n        id.push(key);\n      } else {\n        shortcut[key] = false;\n      }\n    }\n\n    shortcut.id = id.join(',');\n\n    if (shortcut.access) {\n      shortcut.alt = true;\n\n      if (Env.mac) {\n        shortcut.ctrl = true;\n      } else {\n        shortcut.shift = true;\n      }\n    }\n\n    if (shortcut.meta) {\n      if (Env.mac) {\n        shortcut.meta = true;\n      } else {\n        shortcut.ctrl = true;\n        shortcut.meta = false;\n      }\n    }\n\n    return shortcut;\n  };\n\n  var Shortcuts = function () {\n    function Shortcuts(editor) {\n      this.shortcuts = {};\n      this.pendingPatterns = [];\n      this.editor = editor;\n      var self = this;\n      editor.on('keyup keypress keydown', function (e) {\n        if ((self.hasModifier(e) || self.isFunctionKey(e)) && !e.isDefaultPrevented()) {\n          each$g(self.shortcuts, function (shortcut) {\n            if (self.matchShortcut(e, shortcut)) {\n              self.pendingPatterns = shortcut.subpatterns.slice(0);\n\n              if (e.type === 'keydown') {\n                self.executeShortcutAction(shortcut);\n              }\n\n              return true;\n            }\n          });\n\n          if (self.matchShortcut(e, self.pendingPatterns[0])) {\n            if (self.pendingPatterns.length === 1) {\n              if (e.type === 'keydown') {\n                self.executeShortcutAction(self.pendingPatterns[0]);\n              }\n            }\n\n            self.pendingPatterns.shift();\n          }\n        }\n      });\n    }\n\n    Shortcuts.prototype.add = function (pattern, desc, cmdFunc, scope) {\n      var self = this;\n      var func = self.normalizeCommandFunc(cmdFunc);\n      each$g(explode$3(Tools.trim(pattern)), function (pattern) {\n        var shortcut = self.createShortcut(pattern, desc, func, scope);\n        self.shortcuts[shortcut.id] = shortcut;\n      });\n      return true;\n    };\n\n    Shortcuts.prototype.remove = function (pattern) {\n      var shortcut = this.createShortcut(pattern);\n\n      if (this.shortcuts[shortcut.id]) {\n        delete this.shortcuts[shortcut.id];\n        return true;\n      }\n\n      return false;\n    };\n\n    Shortcuts.prototype.normalizeCommandFunc = function (cmdFunc) {\n      var self = this;\n      var cmd = cmdFunc;\n\n      if (typeof cmd === 'string') {\n        return function () {\n          self.editor.execCommand(cmd, false, null);\n        };\n      } else if (Tools.isArray(cmd)) {\n        return function () {\n          self.editor.execCommand(cmd[0], cmd[1], cmd[2]);\n        };\n      } else {\n        return cmd;\n      }\n    };\n\n    Shortcuts.prototype.createShortcut = function (pattern, desc, cmdFunc, scope) {\n      var shortcuts = Tools.map(explode$3(pattern, '>'), parseShortcut);\n      shortcuts[shortcuts.length - 1] = Tools.extend(shortcuts[shortcuts.length - 1], {\n        func: cmdFunc,\n        scope: scope || this.editor\n      });\n      return Tools.extend(shortcuts[0], {\n        desc: this.editor.translate(desc),\n        subpatterns: shortcuts.slice(1)\n      });\n    };\n\n    Shortcuts.prototype.hasModifier = function (e) {\n      return e.altKey || e.ctrlKey || e.metaKey;\n    };\n\n    Shortcuts.prototype.isFunctionKey = function (e) {\n      return e.type === 'keydown' && e.keyCode >= 112 && e.keyCode <= 123;\n    };\n\n    Shortcuts.prototype.matchShortcut = function (e, shortcut) {\n      if (!shortcut) {\n        return false;\n      }\n\n      if (shortcut.ctrl !== e.ctrlKey || shortcut.meta !== e.metaKey) {\n        return false;\n      }\n\n      if (shortcut.alt !== e.altKey || shortcut.shift !== e.shiftKey) {\n        return false;\n      }\n\n      if (e.keyCode === shortcut.keyCode || e.charCode && e.charCode === shortcut.charCode) {\n        e.preventDefault();\n        return true;\n      }\n\n      return false;\n    };\n\n    Shortcuts.prototype.executeShortcutAction = function (shortcut) {\n      return shortcut.func ? shortcut.func.call(shortcut.scope) : null;\n    };\n\n    return Shortcuts;\n  }();\n\n  var create$6 = function () {\n    var buttons = {};\n    var menuItems = {};\n    var popups = {};\n    var icons = {};\n    var contextMenus = {};\n    var contextToolbars = {};\n    var sidebars = {};\n\n    var add = function (collection, type) {\n      return function (name, spec) {\n        return collection[name.toLowerCase()] = __assign(__assign({}, spec), {\n          type: type\n        });\n      };\n    };\n\n    var addIcon = function (name, svgData) {\n      return icons[name.toLowerCase()] = svgData;\n    };\n\n    return {\n      addButton: add(buttons, 'button'),\n      addGroupToolbarButton: add(buttons, 'grouptoolbarbutton'),\n      addToggleButton: add(buttons, 'togglebutton'),\n      addMenuButton: add(buttons, 'menubutton'),\n      addSplitButton: add(buttons, 'splitbutton'),\n      addMenuItem: add(menuItems, 'menuitem'),\n      addNestedMenuItem: add(menuItems, 'nestedmenuitem'),\n      addToggleMenuItem: add(menuItems, 'togglemenuitem'),\n      addAutocompleter: add(popups, 'autocompleter'),\n      addContextMenu: add(contextMenus, 'contextmenu'),\n      addContextToolbar: add(contextToolbars, 'contexttoolbar'),\n      addContextForm: add(contextToolbars, 'contextform'),\n      addSidebar: add(sidebars, 'sidebar'),\n      addIcon: addIcon,\n      getAll: function () {\n        return {\n          buttons: buttons,\n          menuItems: menuItems,\n          icons: icons,\n          popups: popups,\n          contextMenus: contextMenus,\n          contextToolbars: contextToolbars,\n          sidebars: sidebars\n        };\n      }\n    };\n  };\n\n  var registry = function () {\n    var bridge = create$6();\n    return {\n      addAutocompleter: bridge.addAutocompleter,\n      addButton: bridge.addButton,\n      addContextForm: bridge.addContextForm,\n      addContextMenu: bridge.addContextMenu,\n      addContextToolbar: bridge.addContextToolbar,\n      addIcon: bridge.addIcon,\n      addMenuButton: bridge.addMenuButton,\n      addMenuItem: bridge.addMenuItem,\n      addNestedMenuItem: bridge.addNestedMenuItem,\n      addSidebar: bridge.addSidebar,\n      addSplitButton: bridge.addSplitButton,\n      addToggleButton: bridge.addToggleButton,\n      addGroupToolbarButton: bridge.addGroupToolbarButton,\n      addToggleMenuItem: bridge.addToggleMenuItem,\n      getAll: bridge.getAll\n    };\n  };\n\n  var each$h = Tools.each,\n      trim$4 = Tools.trim;\n  var queryParts = 'source protocol authority userInfo user password host port relative path directory file query anchor'.split(' ');\n  var DEFAULT_PORTS = {\n    ftp: 21,\n    http: 80,\n    https: 443,\n    mailto: 25\n  };\n\n  var URI = function () {\n    function URI(url, settings) {\n      url = trim$4(url);\n      this.settings = settings || {};\n      var baseUri = this.settings.base_uri;\n      var self = this;\n\n      if (/^([\\w\\-]+):([^\\/]{2})/i.test(url) || /^\\s*#/.test(url)) {\n        self.source = url;\n        return;\n      }\n\n      var isProtocolRelative = url.indexOf('//') === 0;\n\n      if (url.indexOf('/') === 0 && !isProtocolRelative) {\n        url = (baseUri ? baseUri.protocol || 'http' : 'http') + '://mce_host' + url;\n      }\n\n      if (!/^[\\w\\-]*:?\\/\\//.test(url)) {\n        var baseUrl = this.settings.base_uri ? this.settings.base_uri.path : new URI(document.location.href).directory;\n\n        if (this.settings.base_uri && this.settings.base_uri.protocol == '') {\n          url = '//mce_host' + self.toAbsPath(baseUrl, url);\n        } else {\n          var match = /([^#?]*)([#?]?.*)/.exec(url);\n          url = (baseUri && baseUri.protocol || 'http') + '://mce_host' + self.toAbsPath(baseUrl, match[1]) + match[2];\n        }\n      }\n\n      url = url.replace(/@@/g, '(mce_at)');\n      var urlMatch = /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@\\/]*):?([^:@\\/]*))?@)?(\\[[a-zA-Z0-9:.%]+\\]|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(url);\n      each$h(queryParts, function (v, i) {\n        var part = urlMatch[i];\n\n        if (part) {\n          part = part.replace(/\\(mce_at\\)/g, '@@');\n        }\n\n        self[v] = part;\n      });\n\n      if (baseUri) {\n        if (!self.protocol) {\n          self.protocol = baseUri.protocol;\n        }\n\n        if (!self.userInfo) {\n          self.userInfo = baseUri.userInfo;\n        }\n\n        if (!self.port && self.host === 'mce_host') {\n          self.port = baseUri.port;\n        }\n\n        if (!self.host || self.host === 'mce_host') {\n          self.host = baseUri.host;\n        }\n\n        self.source = '';\n      }\n\n      if (isProtocolRelative) {\n        self.protocol = '';\n      }\n    }\n\n    URI.parseDataUri = function (uri) {\n      var type;\n      var uriComponents = decodeURIComponent(uri).split(',');\n      var matches = /data:([^;]+)/.exec(uriComponents[0]);\n\n      if (matches) {\n        type = matches[1];\n      }\n\n      return {\n        type: type,\n        data: uriComponents[1]\n      };\n    };\n\n    URI.getDocumentBaseUrl = function (loc) {\n      var baseUrl;\n\n      if (loc.protocol.indexOf('http') !== 0 && loc.protocol !== 'file:') {\n        baseUrl = loc.href;\n      } else {\n        baseUrl = loc.protocol + '//' + loc.host + loc.pathname;\n      }\n\n      if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(baseUrl)) {\n        baseUrl = baseUrl.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n\n        if (!/[\\/\\\\]$/.test(baseUrl)) {\n          baseUrl += '/';\n        }\n      }\n\n      return baseUrl;\n    };\n\n    URI.prototype.setPath = function (path) {\n      var pathMatch = /^(.*?)\\/?(\\w+)?$/.exec(path);\n      this.path = pathMatch[0];\n      this.directory = pathMatch[1];\n      this.file = pathMatch[2];\n      this.source = '';\n      this.getURI();\n    };\n\n    URI.prototype.toRelative = function (uri) {\n      var output;\n\n      if (uri === './') {\n        return uri;\n      }\n\n      var relativeUri = new URI(uri, {\n        base_uri: this\n      });\n\n      if (relativeUri.host !== 'mce_host' && this.host !== relativeUri.host && relativeUri.host || this.port !== relativeUri.port || this.protocol !== relativeUri.protocol && relativeUri.protocol !== '') {\n        return relativeUri.getURI();\n      }\n\n      var tu = this.getURI(),\n          uu = relativeUri.getURI();\n\n      if (tu === uu || tu.charAt(tu.length - 1) === '/' && tu.substr(0, tu.length - 1) === uu) {\n        return tu;\n      }\n\n      output = this.toRelPath(this.path, relativeUri.path);\n\n      if (relativeUri.query) {\n        output += '?' + relativeUri.query;\n      }\n\n      if (relativeUri.anchor) {\n        output += '#' + relativeUri.anchor;\n      }\n\n      return output;\n    };\n\n    URI.prototype.toAbsolute = function (uri, noHost) {\n      var absoluteUri = new URI(uri, {\n        base_uri: this\n      });\n      return absoluteUri.getURI(noHost && this.isSameOrigin(absoluteUri));\n    };\n\n    URI.prototype.isSameOrigin = function (uri) {\n      if (this.host == uri.host && this.protocol == uri.protocol) {\n        if (this.port == uri.port) {\n          return true;\n        }\n\n        var defaultPort = DEFAULT_PORTS[this.protocol];\n\n        if (defaultPort && (this.port || defaultPort) == (uri.port || defaultPort)) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    URI.prototype.toRelPath = function (base, path) {\n      var breakPoint = 0,\n          out = '',\n          i,\n          l;\n      var normalizedBase = base.substring(0, base.lastIndexOf('/')).split('/');\n      var items = path.split('/');\n\n      if (normalizedBase.length >= items.length) {\n        for (i = 0, l = normalizedBase.length; i < l; i++) {\n          if (i >= items.length || normalizedBase[i] !== items[i]) {\n            breakPoint = i + 1;\n            break;\n          }\n        }\n      }\n\n      if (normalizedBase.length < items.length) {\n        for (i = 0, l = items.length; i < l; i++) {\n          if (i >= normalizedBase.length || normalizedBase[i] !== items[i]) {\n            breakPoint = i + 1;\n            break;\n          }\n        }\n      }\n\n      if (breakPoint === 1) {\n        return path;\n      }\n\n      for (i = 0, l = normalizedBase.length - (breakPoint - 1); i < l; i++) {\n        out += '../';\n      }\n\n      for (i = breakPoint - 1, l = items.length; i < l; i++) {\n        if (i !== breakPoint - 1) {\n          out += '/' + items[i];\n        } else {\n          out += items[i];\n        }\n      }\n\n      return out;\n    };\n\n    URI.prototype.toAbsPath = function (base, path) {\n      var i,\n          nb = 0,\n          o = [],\n          outPath;\n      var tr = /\\/$/.test(path) ? '/' : '';\n      var normalizedBase = base.split('/');\n      var normalizedPath = path.split('/');\n      each$h(normalizedBase, function (k) {\n        if (k) {\n          o.push(k);\n        }\n      });\n      normalizedBase = o;\n\n      for (i = normalizedPath.length - 1, o = []; i >= 0; i--) {\n        if (normalizedPath[i].length === 0 || normalizedPath[i] === '.') {\n          continue;\n        }\n\n        if (normalizedPath[i] === '..') {\n          nb++;\n          continue;\n        }\n\n        if (nb > 0) {\n          nb--;\n          continue;\n        }\n\n        o.push(normalizedPath[i]);\n      }\n\n      i = normalizedBase.length - nb;\n\n      if (i <= 0) {\n        outPath = reverse(o).join('/');\n      } else {\n        outPath = normalizedBase.slice(0, i).join('/') + '/' + reverse(o).join('/');\n      }\n\n      if (outPath.indexOf('/') !== 0) {\n        outPath = '/' + outPath;\n      }\n\n      if (tr && outPath.lastIndexOf('/') !== outPath.length - 1) {\n        outPath += tr;\n      }\n\n      return outPath;\n    };\n\n    URI.prototype.getURI = function (noProtoHost) {\n      if (noProtoHost === void 0) {\n        noProtoHost = false;\n      }\n\n      var s;\n\n      if (!this.source || noProtoHost) {\n        s = '';\n\n        if (!noProtoHost) {\n          if (this.protocol) {\n            s += this.protocol + '://';\n          } else {\n            s += '//';\n          }\n\n          if (this.userInfo) {\n            s += this.userInfo + '@';\n          }\n\n          if (this.host) {\n            s += this.host;\n          }\n\n          if (this.port) {\n            s += ':' + this.port;\n          }\n        }\n\n        if (this.path) {\n          s += this.path;\n        }\n\n        if (this.query) {\n          s += '?' + this.query;\n        }\n\n        if (this.anchor) {\n          s += '#' + this.anchor;\n        }\n\n        this.source = s;\n      }\n\n      return this.source;\n    };\n\n    return URI;\n  }();\n\n  var DOM$9 = DOMUtils.DOM;\n  var extend$3 = Tools.extend,\n      each$i = Tools.each;\n  var resolve$3 = Tools.resolve;\n  var ie$1 = Env.ie;\n\n  var Editor = function () {\n    function Editor(id, settings, editorManager) {\n      var _this = this;\n\n      this.plugins = {};\n      this.contentCSS = [];\n      this.contentStyles = [];\n      this.loadedCSS = {};\n      this.isNotDirty = false;\n      this.editorManager = editorManager;\n      this.documentBaseUrl = editorManager.documentBaseURL;\n      extend$3(this, EditorObservable);\n      this.settings = getEditorSettings(this, id, this.documentBaseUrl, editorManager.defaultSettings, settings);\n\n      if (this.settings.suffix) {\n        editorManager.suffix = this.settings.suffix;\n      }\n\n      this.suffix = editorManager.suffix;\n\n      if (this.settings.base_url) {\n        editorManager._setBaseUrl(this.settings.base_url);\n      }\n\n      this.baseUri = editorManager.baseURI;\n\n      if (this.settings.referrer_policy) {\n        ScriptLoader.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy);\n\n        DOMUtils.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy);\n      }\n\n      AddOnManager.languageLoad = this.settings.language_load;\n      AddOnManager.baseURL = editorManager.baseURL;\n      this.id = id;\n      this.setDirty(false);\n      this.documentBaseURI = new URI(this.settings.document_base_url, {\n        base_uri: this.baseUri\n      });\n      this.baseURI = this.baseUri;\n      this.inline = !!this.settings.inline;\n      this.shortcuts = new Shortcuts(this);\n      this.editorCommands = new EditorCommands(this);\n\n      if (this.settings.cache_suffix) {\n        Env.cacheSuffix = this.settings.cache_suffix.replace(/^[\\?\\&]+/, '');\n      }\n\n      this.ui = {\n        registry: registry(),\n        styleSheetLoader: undefined,\n        show: noop,\n        hide: noop,\n        enable: noop,\n        disable: noop,\n        isDisabled: never\n      };\n      var self = this;\n      var modeInstance = create$5(self);\n      this.mode = modeInstance;\n      this.setMode = modeInstance.set;\n      editorManager.fire('SetupEditor', {\n        editor: this\n      });\n      this.execCallback('setup', this);\n      this.$ = DomQuery.overrideDefaults(function () {\n        return {\n          context: _this.inline ? _this.getBody() : _this.getDoc(),\n          element: _this.getBody()\n        };\n      });\n    }\n\n    Editor.prototype.render = function () {\n      render(this);\n    };\n\n    Editor.prototype.focus = function (skipFocus) {\n      focus$1(this, skipFocus);\n    };\n\n    Editor.prototype.hasFocus = function () {\n      return hasFocus$1(this);\n    };\n\n    Editor.prototype.execCallback = function (name) {\n      var x = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n\n      var self = this;\n      var callback = self.settings[name],\n          scope;\n\n      if (!callback) {\n        return;\n      }\n\n      if (self.callbackLookup && (scope = self.callbackLookup[name])) {\n        callback = scope.func;\n        scope = scope.scope;\n      }\n\n      if (typeof callback === 'string') {\n        scope = callback.replace(/\\.\\w+$/, '');\n        scope = scope ? resolve$3(scope) : 0;\n        callback = resolve$3(callback);\n        self.callbackLookup = self.callbackLookup || {};\n        self.callbackLookup[name] = {\n          func: callback,\n          scope: scope\n        };\n      }\n\n      return callback.apply(scope || self, x);\n    };\n\n    Editor.prototype.translate = function (text) {\n      return I18n.translate(text);\n    };\n\n    Editor.prototype.getParam = function (name, defaultVal, type) {\n      return getParam(this, name, defaultVal, type);\n    };\n\n    Editor.prototype.hasPlugin = function (name, loaded) {\n      var hasPlugin = contains(getPlugins(this).split(/[ ,]/), name);\n\n      if (hasPlugin) {\n        return loaded ? PluginManager.get(name) !== undefined : true;\n      } else {\n        return false;\n      }\n    };\n\n    Editor.prototype.nodeChanged = function (args) {\n      this._nodeChangeDispatcher.nodeChanged(args);\n    };\n\n    Editor.prototype.addCommand = function (name, callback, scope) {\n      this.editorCommands.addCommand(name, callback, scope);\n    };\n\n    Editor.prototype.addQueryStateHandler = function (name, callback, scope) {\n      this.editorCommands.addQueryStateHandler(name, callback, scope);\n    };\n\n    Editor.prototype.addQueryValueHandler = function (name, callback, scope) {\n      this.editorCommands.addQueryValueHandler(name, callback, scope);\n    };\n\n    Editor.prototype.addShortcut = function (pattern, desc, cmdFunc, scope) {\n      this.shortcuts.add(pattern, desc, cmdFunc, scope);\n    };\n\n    Editor.prototype.execCommand = function (cmd, ui, value, args) {\n      return this.editorCommands.execCommand(cmd, ui, value, args);\n    };\n\n    Editor.prototype.queryCommandState = function (cmd) {\n      return this.editorCommands.queryCommandState(cmd);\n    };\n\n    Editor.prototype.queryCommandValue = function (cmd) {\n      return this.editorCommands.queryCommandValue(cmd);\n    };\n\n    Editor.prototype.queryCommandSupported = function (cmd) {\n      return this.editorCommands.queryCommandSupported(cmd);\n    };\n\n    Editor.prototype.show = function () {\n      var self = this;\n\n      if (self.hidden) {\n        self.hidden = false;\n\n        if (self.inline) {\n          self.getBody().contentEditable = 'true';\n        } else {\n          DOM$9.show(self.getContainer());\n          DOM$9.hide(self.id);\n        }\n\n        self.load();\n        self.fire('show');\n      }\n    };\n\n    Editor.prototype.hide = function () {\n      var self = this,\n          doc = self.getDoc();\n\n      if (!self.hidden) {\n        if (ie$1 && doc && !self.inline) {\n          doc.execCommand('SelectAll');\n        }\n\n        self.save();\n\n        if (self.inline) {\n          self.getBody().contentEditable = 'false';\n\n          if (self === self.editorManager.focusedEditor) {\n            self.editorManager.focusedEditor = null;\n          }\n        } else {\n          DOM$9.hide(self.getContainer());\n          DOM$9.setStyle(self.id, 'display', self.orgDisplay);\n        }\n\n        self.hidden = true;\n        self.fire('hide');\n      }\n    };\n\n    Editor.prototype.isHidden = function () {\n      return !!this.hidden;\n    };\n\n    Editor.prototype.setProgressState = function (state, time) {\n      this.fire('ProgressState', {\n        state: state,\n        time: time\n      });\n    };\n\n    Editor.prototype.load = function (args) {\n      var self = this;\n      var elm = self.getElement(),\n          html;\n\n      if (self.removed) {\n        return '';\n      }\n\n      if (elm) {\n        args = args || {};\n        args.load = true;\n        var value = isTextareaOrInput(elm) ? elm.value : elm.innerHTML;\n        html = self.setContent(value, args);\n        args.element = elm;\n\n        if (!args.no_events) {\n          self.fire('LoadContent', args);\n        }\n\n        args.element = elm = null;\n        return html;\n      }\n    };\n\n    Editor.prototype.save = function (args) {\n      var self = this;\n      var elm = self.getElement(),\n          html,\n          form;\n\n      if (!elm || !self.initialized || self.removed) {\n        return;\n      }\n\n      args = args || {};\n      args.save = true;\n      args.element = elm;\n      html = args.content = self.getContent(args);\n\n      if (!args.no_events) {\n        self.fire('SaveContent', args);\n      }\n\n      if (args.format === 'raw') {\n        self.fire('RawSaveContent', args);\n      }\n\n      html = args.content;\n\n      if (!isTextareaOrInput(elm)) {\n        if (args.is_removing || !self.inline) {\n          elm.innerHTML = html;\n        }\n\n        if (form = DOM$9.getParent(self.id, 'form')) {\n          each$i(form.elements, function (elm) {\n            if (elm.name === self.id) {\n              elm.value = html;\n              return false;\n            }\n          });\n        }\n      } else {\n        elm.value = html;\n      }\n\n      args.element = elm = null;\n\n      if (args.set_dirty !== false) {\n        self.setDirty(false);\n      }\n\n      return html;\n    };\n\n    Editor.prototype.setContent = function (content, args) {\n      return setContent$2(this, content, args);\n    };\n\n    Editor.prototype.getContent = function (args) {\n      return getContent$2(this, args);\n    };\n\n    Editor.prototype.insertContent = function (content, args) {\n      if (args) {\n        content = extend$3({\n          content: content\n        }, args);\n      }\n\n      this.execCommand('mceInsertContent', false, content);\n    };\n\n    Editor.prototype.resetContent = function (initialContent) {\n      if (initialContent === undefined) {\n        setContent$2(this, this.startContent, {\n          format: 'raw'\n        });\n      } else {\n        setContent$2(this, initialContent);\n      }\n\n      this.undoManager.reset();\n      this.setDirty(false);\n      this.nodeChanged();\n    };\n\n    Editor.prototype.isDirty = function () {\n      return !this.isNotDirty;\n    };\n\n    Editor.prototype.setDirty = function (state) {\n      var oldState = !this.isNotDirty;\n      this.isNotDirty = !state;\n\n      if (state && state !== oldState) {\n        this.fire('dirty');\n      }\n    };\n\n    Editor.prototype.getContainer = function () {\n      var self = this;\n\n      if (!self.container) {\n        self.container = DOM$9.get(self.editorContainer || self.id + '_parent');\n      }\n\n      return self.container;\n    };\n\n    Editor.prototype.getContentAreaContainer = function () {\n      return this.contentAreaContainer;\n    };\n\n    Editor.prototype.getElement = function () {\n      if (!this.targetElm) {\n        this.targetElm = DOM$9.get(this.id);\n      }\n\n      return this.targetElm;\n    };\n\n    Editor.prototype.getWin = function () {\n      var self = this;\n      var elm;\n\n      if (!self.contentWindow) {\n        elm = self.iframeElement;\n\n        if (elm) {\n          self.contentWindow = elm.contentWindow;\n        }\n      }\n\n      return self.contentWindow;\n    };\n\n    Editor.prototype.getDoc = function () {\n      var self = this;\n      var win;\n\n      if (!self.contentDocument) {\n        win = self.getWin();\n\n        if (win) {\n          self.contentDocument = win.document;\n        }\n      }\n\n      return self.contentDocument;\n    };\n\n    Editor.prototype.getBody = function () {\n      var doc = this.getDoc();\n      return this.bodyElement || (doc ? doc.body : null);\n    };\n\n    Editor.prototype.convertURL = function (url, name, elm) {\n      var self = this,\n          settings = self.settings;\n\n      if (settings.urlconverter_callback) {\n        return self.execCallback('urlconverter_callback', url, elm, true, name);\n      }\n\n      if (!settings.convert_urls || elm && elm.nodeName === 'LINK' || url.indexOf('file:') === 0 || url.length === 0) {\n        return url;\n      }\n\n      if (settings.relative_urls) {\n        return self.documentBaseURI.toRelative(url);\n      }\n\n      url = self.documentBaseURI.toAbsolute(url, settings.remove_script_host);\n      return url;\n    };\n\n    Editor.prototype.addVisual = function (elm) {\n      addVisual$1(this, elm);\n    };\n\n    Editor.prototype.remove = function () {\n      remove$7(this);\n    };\n\n    Editor.prototype.destroy = function (automatic) {\n      destroy(this, automatic);\n    };\n\n    Editor.prototype.uploadImages = function (callback) {\n      return this.editorUpload.uploadImages(callback);\n    };\n\n    Editor.prototype._scanForImages = function () {\n      return this.editorUpload.scanForImages();\n    };\n\n    Editor.prototype.addButton = function () {\n      throw new Error('editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead');\n    };\n\n    Editor.prototype.addSidebar = function () {\n      throw new Error('editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead');\n    };\n\n    Editor.prototype.addMenuItem = function () {\n      throw new Error('editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead');\n    };\n\n    Editor.prototype.addContextToolbar = function () {\n      throw new Error('editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead');\n    };\n\n    return Editor;\n  }();\n\n  var DOM$a = DOMUtils.DOM;\n  var explode$4 = Tools.explode,\n      each$j = Tools.each,\n      extend$4 = Tools.extend;\n  var instanceCounter = 0,\n      boundGlobalEvents = false;\n  var beforeUnloadDelegate;\n  var legacyEditors = [];\n  var editors = [];\n\n  var isValidLegacyKey = function (id) {\n    return id !== 'length';\n  };\n\n  var globalEventDelegate = function (e) {\n    var type = e.type;\n    each$j(EditorManager.get(), function (editor) {\n      switch (type) {\n        case 'scroll':\n          editor.fire('ScrollWindow', e);\n          break;\n\n        case 'resize':\n          editor.fire('ResizeWindow', e);\n          break;\n      }\n    });\n  };\n\n  var toggleGlobalEvents = function (state) {\n    if (state !== boundGlobalEvents) {\n      if (state) {\n        DomQuery(window).on('resize scroll', globalEventDelegate);\n      } else {\n        DomQuery(window).off('resize scroll', globalEventDelegate);\n      }\n\n      boundGlobalEvents = state;\n    }\n  };\n\n  var removeEditorFromList = function (targetEditor) {\n    var oldEditors = editors;\n    delete legacyEditors[targetEditor.id];\n\n    for (var i = 0; i < legacyEditors.length; i++) {\n      if (legacyEditors[i] === targetEditor) {\n        legacyEditors.splice(i, 1);\n        break;\n      }\n    }\n\n    editors = filter(editors, function (editor) {\n      return targetEditor !== editor;\n    });\n\n    if (EditorManager.activeEditor === targetEditor) {\n      EditorManager.activeEditor = editors.length > 0 ? editors[0] : null;\n    }\n\n    if (EditorManager.focusedEditor === targetEditor) {\n      EditorManager.focusedEditor = null;\n    }\n\n    return oldEditors.length !== editors.length;\n  };\n\n  var purgeDestroyedEditor = function (editor) {\n    if (editor && editor.initialized && !(editor.getContainer() || editor.getBody()).parentNode) {\n      removeEditorFromList(editor);\n      editor.unbindAllNativeEvents();\n      editor.destroy(true);\n      editor.removed = true;\n      editor = null;\n    }\n\n    return editor;\n  };\n\n  var isQuirksMode = document.compatMode !== 'CSS1Compat';\n\n  var EditorManager = __assign(__assign({}, Observable), {\n    baseURI: null,\n    baseURL: null,\n    defaultSettings: {},\n    documentBaseURL: null,\n    suffix: null,\n    $: DomQuery,\n    majorVersion: '5',\n    minorVersion: '7.1',\n    releaseDate: '2021-03-17',\n    editors: legacyEditors,\n    i18n: I18n,\n    activeEditor: null,\n    focusedEditor: null,\n    settings: {},\n    setup: function () {\n      var self = this;\n      var baseURL,\n          documentBaseURL,\n          suffix = '';\n      documentBaseURL = URI.getDocumentBaseUrl(document.location);\n\n      if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(documentBaseURL)) {\n        documentBaseURL = documentBaseURL.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n\n        if (!/[\\/\\\\]$/.test(documentBaseURL)) {\n          documentBaseURL += '/';\n        }\n      }\n\n      var preInit = window.tinymce || window.tinyMCEPreInit;\n\n      if (preInit) {\n        baseURL = preInit.base || preInit.baseURL;\n        suffix = preInit.suffix;\n      } else {\n        var scripts = document.getElementsByTagName('script');\n\n        for (var i = 0; i < scripts.length; i++) {\n          var src = scripts[i].src || '';\n\n          if (src === '') {\n            continue;\n          }\n\n          var srcScript = src.substring(src.lastIndexOf('/'));\n\n          if (/tinymce(\\.full|\\.jquery|)(\\.min|\\.dev|)\\.js/.test(src)) {\n            if (srcScript.indexOf('.min') !== -1) {\n              suffix = '.min';\n            }\n\n            baseURL = src.substring(0, src.lastIndexOf('/'));\n            break;\n          }\n        }\n\n        if (!baseURL && document.currentScript) {\n          var src = document.currentScript.src;\n\n          if (src.indexOf('.min') !== -1) {\n            suffix = '.min';\n          }\n\n          baseURL = src.substring(0, src.lastIndexOf('/'));\n        }\n      }\n\n      self.baseURL = new URI(documentBaseURL).toAbsolute(baseURL);\n      self.documentBaseURL = documentBaseURL;\n      self.baseURI = new URI(self.baseURL);\n      self.suffix = suffix;\n      setup$2(self);\n    },\n    overrideDefaults: function (defaultSettings) {\n      var baseUrl = defaultSettings.base_url;\n\n      if (baseUrl) {\n        this._setBaseUrl(baseUrl);\n      }\n\n      var suffix = defaultSettings.suffix;\n\n      if (defaultSettings.suffix) {\n        this.suffix = suffix;\n      }\n\n      this.defaultSettings = defaultSettings;\n      var pluginBaseUrls = defaultSettings.plugin_base_urls;\n\n      if (pluginBaseUrls !== undefined) {\n        each$1(pluginBaseUrls, function (pluginBaseUrl, pluginName) {\n          AddOnManager.PluginManager.urls[pluginName] = pluginBaseUrl;\n        });\n      }\n    },\n    init: function (settings) {\n      var self = this;\n      var result;\n      var invalidInlineTargets = Tools.makeMap('area base basefont br col frame hr img input isindex link meta param embed source wbr track ' + 'colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu', ' ');\n\n      var isInvalidInlineTarget = function (settings, elm) {\n        return settings.inline && elm.tagName.toLowerCase() in invalidInlineTargets;\n      };\n\n      var createId = function (elm) {\n        var id = elm.id;\n\n        if (!id) {\n          id = get$1(elm, 'name').filter(function (name) {\n            return !DOM$a.get(name);\n          }).getOrThunk(DOM$a.uniqueId);\n          elm.setAttribute('id', id);\n        }\n\n        return id;\n      };\n\n      var execCallback = function (name) {\n        var callback = settings[name];\n\n        if (!callback) {\n          return;\n        }\n\n        return callback.apply(self, []);\n      };\n\n      var hasClass = function (elm, className) {\n        return className.constructor === RegExp ? className.test(elm.className) : DOM$a.hasClass(elm, className);\n      };\n\n      var findTargets = function (settings) {\n        var targets = [];\n\n        if (Env.browser.isIE() && Env.browser.version.major < 11) {\n          initError('TinyMCE does not support the browser you are using. For a list of supported' + ' browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/');\n          return [];\n        } else if (isQuirksMode) {\n          initError('Failed to initialize the editor as the document is not in standards mode. ' + 'TinyMCE requires standards mode.');\n          return [];\n        }\n\n        if (settings.types) {\n          each$j(settings.types, function (type) {\n            targets = targets.concat(DOM$a.select(type.selector));\n          });\n          return targets;\n        } else if (settings.selector) {\n          return DOM$a.select(settings.selector);\n        } else if (settings.target) {\n          return [settings.target];\n        }\n\n        switch (settings.mode) {\n          case 'exact':\n            var l = settings.elements || '';\n\n            if (l.length > 0) {\n              each$j(explode$4(l), function (id) {\n                var elm = DOM$a.get(id);\n\n                if (elm) {\n                  targets.push(elm);\n                } else {\n                  each$j(document.forms, function (f) {\n                    each$j(f.elements, function (e) {\n                      if (e.name === id) {\n                        id = 'mce_editor_' + instanceCounter++;\n                        DOM$a.setAttrib(e, 'id', id);\n                        targets.push(e);\n                      }\n                    });\n                  });\n                }\n              });\n            }\n\n            break;\n\n          case 'textareas':\n          case 'specific_textareas':\n            each$j(DOM$a.select('textarea'), function (elm) {\n              if (settings.editor_deselector && hasClass(elm, settings.editor_deselector)) {\n                return;\n              }\n\n              if (!settings.editor_selector || hasClass(elm, settings.editor_selector)) {\n                targets.push(elm);\n              }\n            });\n            break;\n        }\n\n        return targets;\n      };\n\n      var provideResults = function (editors) {\n        result = editors;\n      };\n\n      var initEditors = function () {\n        var initCount = 0;\n        var editors = [];\n        var targets;\n\n        var createEditor = function (id, settings, targetElm) {\n          var editor = new Editor(id, settings, self);\n          editors.push(editor);\n          editor.on('init', function () {\n            if (++initCount === targets.length) {\n              provideResults(editors);\n            }\n          });\n          editor.targetElm = editor.targetElm || targetElm;\n          editor.render();\n        };\n\n        DOM$a.unbind(window, 'ready', initEditors);\n        execCallback('onpageload');\n        targets = DomQuery.unique(findTargets(settings));\n\n        if (settings.types) {\n          each$j(settings.types, function (type) {\n            Tools.each(targets, function (elm) {\n              if (DOM$a.is(elm, type.selector)) {\n                createEditor(createId(elm), extend$4({}, settings, type), elm);\n                return false;\n              }\n\n              return true;\n            });\n          });\n          return;\n        }\n\n        Tools.each(targets, function (elm) {\n          purgeDestroyedEditor(self.get(elm.id));\n        });\n        targets = Tools.grep(targets, function (elm) {\n          return !self.get(elm.id);\n        });\n\n        if (targets.length === 0) {\n          provideResults([]);\n        } else {\n          each$j(targets, function (elm) {\n            if (isInvalidInlineTarget(settings, elm)) {\n              initError('Could not initialize inline editor on invalid inline target element', elm);\n            } else {\n              createEditor(createId(elm), settings, elm);\n            }\n          });\n        }\n      };\n\n      self.settings = settings;\n      DOM$a.bind(window, 'ready', initEditors);\n      return new promiseObj(function (resolve) {\n        if (result) {\n          resolve(result);\n        } else {\n          provideResults = function (editors) {\n            resolve(editors);\n          };\n        }\n      });\n    },\n    get: function (id) {\n      if (arguments.length === 0) {\n        return editors.slice(0);\n      } else if (isString(id)) {\n        return find(editors, function (editor) {\n          return editor.id === id;\n        }).getOr(null);\n      } else if (isNumber(id)) {\n        return editors[id] ? editors[id] : null;\n      } else {\n        return null;\n      }\n    },\n    add: function (editor) {\n      var self = this;\n      var existingEditor = legacyEditors[editor.id];\n\n      if (existingEditor === editor) {\n        return editor;\n      }\n\n      if (self.get(editor.id) === null) {\n        if (isValidLegacyKey(editor.id)) {\n          legacyEditors[editor.id] = editor;\n        }\n\n        legacyEditors.push(editor);\n        editors.push(editor);\n      }\n\n      toggleGlobalEvents(true);\n      self.activeEditor = editor;\n      self.fire('AddEditor', {\n        editor: editor\n      });\n\n      if (!beforeUnloadDelegate) {\n        beforeUnloadDelegate = function (e) {\n          var event = self.fire('BeforeUnload');\n\n          if (event.returnValue) {\n            e.preventDefault();\n            e.returnValue = event.returnValue;\n            return event.returnValue;\n          }\n        };\n\n        window.addEventListener('beforeunload', beforeUnloadDelegate);\n      }\n\n      return editor;\n    },\n    createEditor: function (id, settings) {\n      return this.add(new Editor(id, settings, this));\n    },\n    remove: function (selector) {\n      var self = this;\n      var i, editor;\n\n      if (!selector) {\n        for (i = editors.length - 1; i >= 0; i--) {\n          self.remove(editors[i]);\n        }\n\n        return;\n      }\n\n      if (isString(selector)) {\n        each$j(DOM$a.select(selector), function (elm) {\n          editor = self.get(elm.id);\n\n          if (editor) {\n            self.remove(editor);\n          }\n        });\n        return;\n      }\n\n      editor = selector;\n\n      if (isNull(self.get(editor.id))) {\n        return null;\n      }\n\n      if (removeEditorFromList(editor)) {\n        self.fire('RemoveEditor', {\n          editor: editor\n        });\n      }\n\n      if (editors.length === 0) {\n        window.removeEventListener('beforeunload', beforeUnloadDelegate);\n      }\n\n      editor.remove();\n      toggleGlobalEvents(editors.length > 0);\n      return editor;\n    },\n    execCommand: function (cmd, ui, value) {\n      var self = this,\n          editor = self.get(value);\n\n      switch (cmd) {\n        case 'mceAddEditor':\n          if (!self.get(value)) {\n            new Editor(value, self.settings, self).render();\n          }\n\n          return true;\n\n        case 'mceRemoveEditor':\n          if (editor) {\n            editor.remove();\n          }\n\n          return true;\n\n        case 'mceToggleEditor':\n          if (!editor) {\n            self.execCommand('mceAddEditor', false, value);\n            return true;\n          }\n\n          if (editor.isHidden()) {\n            editor.show();\n          } else {\n            editor.hide();\n          }\n\n          return true;\n      }\n\n      if (self.activeEditor) {\n        return self.activeEditor.execCommand(cmd, ui, value);\n      }\n\n      return false;\n    },\n    triggerSave: function () {\n      each$j(editors, function (editor) {\n        editor.save();\n      });\n    },\n    addI18n: function (code, items) {\n      I18n.add(code, items);\n    },\n    translate: function (text) {\n      return I18n.translate(text);\n    },\n    setActive: function (editor) {\n      var activeEditor = this.activeEditor;\n\n      if (this.activeEditor !== editor) {\n        if (activeEditor) {\n          activeEditor.fire('deactivate', {\n            relatedTarget: editor\n          });\n        }\n\n        editor.fire('activate', {\n          relatedTarget: activeEditor\n        });\n      }\n\n      this.activeEditor = editor;\n    },\n    _setBaseUrl: function (baseUrl) {\n      this.baseURL = new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\\/+$/, ''));\n      this.baseURI = new URI(this.baseURL);\n    }\n  });\n\n  EditorManager.setup();\n  var min = Math.min,\n      max = Math.max,\n      round$1 = Math.round;\n\n  var relativePosition = function (rect, targetRect, rel) {\n    var x = targetRect.x;\n    var y = targetRect.y;\n    var w = rect.w;\n    var h = rect.h;\n    var targetW = targetRect.w;\n    var targetH = targetRect.h;\n    var relChars = (rel || '').split('');\n\n    if (relChars[0] === 'b') {\n      y += targetH;\n    }\n\n    if (relChars[1] === 'r') {\n      x += targetW;\n    }\n\n    if (relChars[0] === 'c') {\n      y += round$1(targetH / 2);\n    }\n\n    if (relChars[1] === 'c') {\n      x += round$1(targetW / 2);\n    }\n\n    if (relChars[3] === 'b') {\n      y -= h;\n    }\n\n    if (relChars[4] === 'r') {\n      x -= w;\n    }\n\n    if (relChars[3] === 'c') {\n      y -= round$1(h / 2);\n    }\n\n    if (relChars[4] === 'c') {\n      x -= round$1(w / 2);\n    }\n\n    return create$7(x, y, w, h);\n  };\n\n  var findBestRelativePosition = function (rect, targetRect, constrainRect, rels) {\n    var pos, i;\n\n    for (i = 0; i < rels.length; i++) {\n      pos = relativePosition(rect, targetRect, rels[i]);\n\n      if (pos.x >= constrainRect.x && pos.x + pos.w <= constrainRect.w + constrainRect.x && pos.y >= constrainRect.y && pos.y + pos.h <= constrainRect.h + constrainRect.y) {\n        return rels[i];\n      }\n    }\n\n    return null;\n  };\n\n  var inflate = function (rect, w, h) {\n    return create$7(rect.x - w, rect.y - h, rect.w + w * 2, rect.h + h * 2);\n  };\n\n  var intersect = function (rect, cropRect) {\n    var x1 = max(rect.x, cropRect.x);\n    var y1 = max(rect.y, cropRect.y);\n    var x2 = min(rect.x + rect.w, cropRect.x + cropRect.w);\n    var y2 = min(rect.y + rect.h, cropRect.y + cropRect.h);\n\n    if (x2 - x1 < 0 || y2 - y1 < 0) {\n      return null;\n    }\n\n    return create$7(x1, y1, x2 - x1, y2 - y1);\n  };\n\n  var clamp$1 = function (rect, clampRect, fixedSize) {\n    var x1 = rect.x;\n    var y1 = rect.y;\n    var x2 = rect.x + rect.w;\n    var y2 = rect.y + rect.h;\n    var cx2 = clampRect.x + clampRect.w;\n    var cy2 = clampRect.y + clampRect.h;\n    var underflowX1 = max(0, clampRect.x - x1);\n    var underflowY1 = max(0, clampRect.y - y1);\n    var overflowX2 = max(0, x2 - cx2);\n    var overflowY2 = max(0, y2 - cy2);\n    x1 += underflowX1;\n    y1 += underflowY1;\n\n    if (fixedSize) {\n      x2 += underflowX1;\n      y2 += underflowY1;\n      x1 -= overflowX2;\n      y1 -= overflowY2;\n    }\n\n    x2 -= overflowX2;\n    y2 -= overflowY2;\n    return create$7(x1, y1, x2 - x1, y2 - y1);\n  };\n\n  var create$7 = function (x, y, w, h) {\n    return {\n      x: x,\n      y: y,\n      w: w,\n      h: h\n    };\n  };\n\n  var fromClientRect = function (clientRect) {\n    return create$7(clientRect.left, clientRect.top, clientRect.width, clientRect.height);\n  };\n\n  var Rect = {\n    inflate: inflate,\n    relativePosition: relativePosition,\n    findBestRelativePosition: findBestRelativePosition,\n    intersect: intersect,\n    clamp: clamp$1,\n    create: create$7,\n    fromClientRect: fromClientRect\n  };\n\n  var awaiter = function (resolveCb, rejectCb, timeout) {\n    if (timeout === void 0) {\n      timeout = 1000;\n    }\n\n    var done = false;\n    var timer = null;\n\n    var complete = function (completer) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        if (!done) {\n          done = true;\n\n          if (timer !== null) {\n            clearTimeout(timer);\n            timer = null;\n          }\n\n          completer.apply(null, args);\n        }\n      };\n    };\n\n    var resolve = complete(resolveCb);\n    var reject = complete(rejectCb);\n\n    var start = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!done && timer === null) {\n        timer = setTimeout(function () {\n          return reject.apply(null, args);\n        }, timeout);\n      }\n    };\n\n    return {\n      start: start,\n      resolve: resolve,\n      reject: reject\n    };\n  };\n\n  var create$8 = function () {\n    var tasks = {};\n    var resultFns = {};\n\n    var load = function (id, url) {\n      var loadErrMsg = 'Script at URL \"' + url + '\" failed to load';\n      var runErrMsg = 'Script at URL \"' + url + '\" did not call `tinymce.Resource.add(\\'' + id + '\\', data)` within 1 second';\n\n      if (tasks[id] !== undefined) {\n        return tasks[id];\n      } else {\n        var task = new promiseObj(function (resolve, reject) {\n          var waiter = awaiter(resolve, reject);\n          resultFns[id] = waiter.resolve;\n          ScriptLoader.ScriptLoader.loadScript(url, function () {\n            return waiter.start(runErrMsg);\n          }, function () {\n            return waiter.reject(loadErrMsg);\n          });\n        });\n        tasks[id] = task;\n        return task;\n      }\n    };\n\n    var add = function (id, data) {\n      if (resultFns[id] !== undefined) {\n        resultFns[id](data);\n        delete resultFns[id];\n      }\n\n      tasks[id] = promiseObj.resolve(data);\n    };\n\n    return {\n      load: load,\n      add: add\n    };\n  };\n\n  var Resource = create$8();\n  var each$k = Tools.each,\n      extend$5 = Tools.extend;\n  var extendClass, initializing;\n\n  var Class = function () {};\n\n  Class.extend = extendClass = function (props) {\n    var self = this;\n    var _super = self.prototype;\n\n    var Class = function () {\n      var i, mixins, mixin;\n      var self = this;\n\n      if (!initializing) {\n        if (self.init) {\n          self.init.apply(self, arguments);\n        }\n\n        mixins = self.Mixins;\n\n        if (mixins) {\n          i = mixins.length;\n\n          while (i--) {\n            mixin = mixins[i];\n\n            if (mixin.init) {\n              mixin.init.apply(self, arguments);\n            }\n          }\n        }\n      }\n    };\n\n    var dummy = function () {\n      return this;\n    };\n\n    var createMethod = function (name, fn) {\n      return function () {\n        var self = this;\n        var tmp = self._super;\n        self._super = _super[name];\n        var ret = fn.apply(self, arguments);\n        self._super = tmp;\n        return ret;\n      };\n    };\n\n    initializing = true;\n    var prototype = new self();\n    initializing = false;\n\n    if (props.Mixins) {\n      each$k(props.Mixins, function (mixin) {\n        for (var name_1 in mixin) {\n          if (name_1 !== 'init') {\n            props[name_1] = mixin[name_1];\n          }\n        }\n      });\n\n      if (_super.Mixins) {\n        props.Mixins = _super.Mixins.concat(props.Mixins);\n      }\n    }\n\n    if (props.Methods) {\n      each$k(props.Methods.split(','), function (name) {\n        props[name] = dummy;\n      });\n    }\n\n    if (props.Properties) {\n      each$k(props.Properties.split(','), function (name) {\n        var fieldName = '_' + name;\n\n        props[name] = function (value) {\n          var self = this;\n\n          if (value !== undefined) {\n            self[fieldName] = value;\n            return self;\n          }\n\n          return self[fieldName];\n        };\n      });\n    }\n\n    if (props.Statics) {\n      each$k(props.Statics, function (func, name) {\n        Class[name] = func;\n      });\n    }\n\n    if (props.Defaults && _super.Defaults) {\n      props.Defaults = extend$5({}, _super.Defaults, props.Defaults);\n    }\n\n    each$1(props, function (member, name) {\n      if (typeof member === 'function' && _super[name]) {\n        prototype[name] = createMethod(name, member);\n      } else {\n        prototype[name] = member;\n      }\n    });\n    Class.prototype = prototype;\n    Class.constructor = Class;\n    Class.extend = extendClass;\n    return Class;\n  };\n\n  var min$1 = Math.min,\n      max$1 = Math.max,\n      round$2 = Math.round;\n\n  var Color = function (value) {\n    var self = {};\n    var r = 0,\n        g = 0,\n        b = 0;\n\n    var rgb2hsv = function (r, g, b) {\n      var h, s, v;\n      h = 0;\n      s = 0;\n      v = 0;\n      r = r / 255;\n      g = g / 255;\n      b = b / 255;\n      var minRGB = min$1(r, min$1(g, b));\n      var maxRGB = max$1(r, max$1(g, b));\n\n      if (minRGB === maxRGB) {\n        v = minRGB;\n        return {\n          h: 0,\n          s: 0,\n          v: v * 100\n        };\n      }\n\n      var d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n      h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n      h = 60 * (h - d / (maxRGB - minRGB));\n      s = (maxRGB - minRGB) / maxRGB;\n      v = maxRGB;\n      return {\n        h: round$2(h),\n        s: round$2(s * 100),\n        v: round$2(v * 100)\n      };\n    };\n\n    var hsvToRgb = function (hue, saturation, brightness) {\n      hue = (parseInt(hue, 10) || 0) % 360;\n      saturation = parseInt(saturation, 10) / 100;\n      brightness = parseInt(brightness, 10) / 100;\n      saturation = max$1(0, min$1(saturation, 1));\n      brightness = max$1(0, min$1(brightness, 1));\n\n      if (saturation === 0) {\n        r = g = b = round$2(255 * brightness);\n        return;\n      }\n\n      var side = hue / 60;\n      var chroma = brightness * saturation;\n      var x = chroma * (1 - Math.abs(side % 2 - 1));\n      var match = brightness - chroma;\n\n      switch (Math.floor(side)) {\n        case 0:\n          r = chroma;\n          g = x;\n          b = 0;\n          break;\n\n        case 1:\n          r = x;\n          g = chroma;\n          b = 0;\n          break;\n\n        case 2:\n          r = 0;\n          g = chroma;\n          b = x;\n          break;\n\n        case 3:\n          r = 0;\n          g = x;\n          b = chroma;\n          break;\n\n        case 4:\n          r = x;\n          g = 0;\n          b = chroma;\n          break;\n\n        case 5:\n          r = chroma;\n          g = 0;\n          b = x;\n          break;\n\n        default:\n          r = g = b = 0;\n      }\n\n      r = round$2(255 * (r + match));\n      g = round$2(255 * (g + match));\n      b = round$2(255 * (b + match));\n    };\n\n    var toHex = function () {\n      var hex = function (val) {\n        val = parseInt(val, 10).toString(16);\n        return val.length > 1 ? val : '0' + val;\n      };\n\n      return '#' + hex(r) + hex(g) + hex(b);\n    };\n\n    var toRgb = function () {\n      return {\n        r: r,\n        g: g,\n        b: b\n      };\n    };\n\n    var toHsv = function () {\n      return rgb2hsv(r, g, b);\n    };\n\n    var parse = function (value) {\n      var matches;\n\n      if (typeof value === 'object') {\n        if ('r' in value) {\n          r = value.r;\n          g = value.g;\n          b = value.b;\n        } else if ('v' in value) {\n          hsvToRgb(value.h, value.s, value.v);\n        }\n      } else {\n        if (matches = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)[^\\)]*\\)/gi.exec(value)) {\n          r = parseInt(matches[1], 10);\n          g = parseInt(matches[2], 10);\n          b = parseInt(matches[3], 10);\n        } else if (matches = /#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value)) {\n          r = parseInt(matches[1], 16);\n          g = parseInt(matches[2], 16);\n          b = parseInt(matches[3], 16);\n        } else if (matches = /#([0-F])([0-F])([0-F])/gi.exec(value)) {\n          r = parseInt(matches[1] + matches[1], 16);\n          g = parseInt(matches[2] + matches[2], 16);\n          b = parseInt(matches[3] + matches[3], 16);\n        }\n      }\n\n      r = r < 0 ? 0 : r > 255 ? 255 : r;\n      g = g < 0 ? 0 : g > 255 ? 255 : g;\n      b = b < 0 ? 0 : b > 255 ? 255 : b;\n      return self;\n    };\n\n    if (value) {\n      parse(value);\n    }\n\n    self.toRgb = toRgb;\n    self.toHsv = toHsv;\n    self.toHex = toHex;\n    self.parse = parse;\n    return self;\n  };\n\n  var serialize = function (obj) {\n    var data = JSON.stringify(obj);\n\n    if (!isString(data)) {\n      return data;\n    }\n\n    return data.replace(/[\\u0080-\\uFFFF]/g, function (match) {\n      var hexCode = match.charCodeAt(0).toString(16);\n      return '\\\\u' + '0000'.substring(hexCode.length) + hexCode;\n    });\n  };\n\n  var JSONUtils = {\n    serialize: serialize,\n    parse: function (text) {\n      try {\n        return JSON.parse(text);\n      } catch (ex) {}\n    }\n  };\n  var JSONP = {\n    callbacks: {},\n    count: 0,\n    send: function (settings) {\n      var self = this,\n          dom = DOMUtils.DOM,\n          count = settings.count !== undefined ? settings.count : self.count;\n      var id = 'tinymce_jsonp_' + count;\n\n      self.callbacks[count] = function (json) {\n        dom.remove(id);\n        delete self.callbacks[count];\n        settings.callback(json);\n      };\n\n      dom.add(dom.doc.body, 'script', {\n        id: id,\n        src: settings.url,\n        type: 'text/javascript'\n      });\n      self.count++;\n    }\n  };\n\n  var XHR = __assign(__assign({}, Observable), {\n    send: function (settings) {\n      var xhr,\n          count = 0;\n\n      var ready = function () {\n        if (!settings.async || xhr.readyState === 4 || count++ > 10000) {\n          if (settings.success && count < 10000 && xhr.status === 200) {\n            settings.success.call(settings.success_scope, '' + xhr.responseText, xhr, settings);\n          } else if (settings.error) {\n            settings.error.call(settings.error_scope, count > 10000 ? 'TIMED_OUT' : 'GENERAL', xhr, settings);\n          }\n\n          xhr = null;\n        } else {\n          Delay.setTimeout(ready, 10);\n        }\n      };\n\n      settings.scope = settings.scope || this;\n      settings.success_scope = settings.success_scope || settings.scope;\n      settings.error_scope = settings.error_scope || settings.scope;\n      settings.async = settings.async !== false;\n      settings.data = settings.data || '';\n      XHR.fire('beforeInitialize', {\n        settings: settings\n      });\n      xhr = new XMLHttpRequest();\n\n      if (xhr.overrideMimeType) {\n        xhr.overrideMimeType(settings.content_type);\n      }\n\n      xhr.open(settings.type || (settings.data ? 'POST' : 'GET'), settings.url, settings.async);\n\n      if (settings.crossDomain) {\n        xhr.withCredentials = true;\n      }\n\n      if (settings.content_type) {\n        xhr.setRequestHeader('Content-Type', settings.content_type);\n      }\n\n      if (settings.requestheaders) {\n        Tools.each(settings.requestheaders, function (header) {\n          xhr.setRequestHeader(header.key, header.value);\n        });\n      }\n\n      xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n      xhr = XHR.fire('beforeSend', {\n        xhr: xhr,\n        settings: settings\n      }).xhr;\n      xhr.send(settings.data);\n\n      if (!settings.async) {\n        return ready();\n      }\n\n      Delay.setTimeout(ready, 10);\n    }\n  });\n\n  var extend$6 = Tools.extend;\n\n  var JSONRequest = function () {\n    function JSONRequest(settings) {\n      this.settings = extend$6({}, settings);\n      this.count = 0;\n    }\n\n    JSONRequest.sendRPC = function (o) {\n      return new JSONRequest().send(o);\n    };\n\n    JSONRequest.prototype.send = function (args) {\n      var ecb = args.error,\n          scb = args.success;\n      var xhrArgs = extend$6(this.settings, args);\n\n      xhrArgs.success = function (c, x) {\n        c = JSONUtils.parse(c);\n\n        if (typeof c === 'undefined') {\n          c = {\n            error: 'JSON Parse error.'\n          };\n        }\n\n        if (c.error) {\n          ecb.call(xhrArgs.error_scope || xhrArgs.scope, c.error, x);\n        } else {\n          scb.call(xhrArgs.success_scope || xhrArgs.scope, c.result);\n        }\n      };\n\n      xhrArgs.error = function (ty, x) {\n        if (ecb) {\n          ecb.call(xhrArgs.error_scope || xhrArgs.scope, ty, x);\n        }\n      };\n\n      xhrArgs.data = JSONUtils.serialize({\n        id: args.id || 'c' + this.count++,\n        method: args.method,\n        params: args.params\n      });\n      xhrArgs.content_type = 'application/json';\n      XHR.send(xhrArgs);\n    };\n\n    return JSONRequest;\n  }();\n\n  var create$9 = function () {\n    return function () {\n      var data = {};\n      var keys = [];\n      var storage = {\n        getItem: function (key) {\n          var item = data[key];\n          return item ? item : null;\n        },\n        setItem: function (key, value) {\n          keys.push(key);\n          data[key] = String(value);\n        },\n        key: function (index) {\n          return keys[index];\n        },\n        removeItem: function (key) {\n          keys = keys.filter(function (k) {\n            return k === key;\n          });\n          delete data[key];\n        },\n        clear: function () {\n          keys = [];\n          data = {};\n        },\n        length: 0\n      };\n      Object.defineProperty(storage, 'length', {\n        get: function () {\n          return keys.length;\n        },\n        configurable: false,\n        enumerable: false\n      });\n      return storage;\n    }();\n  };\n\n  var localStorage;\n\n  try {\n    var test = '__storage_test__';\n    localStorage = window.localStorage;\n    localStorage.setItem(test, test);\n    localStorage.removeItem(test);\n  } catch (e) {\n    localStorage = create$9();\n  }\n\n  var LocalStorage = localStorage;\n  var publicApi = {\n    geom: {\n      Rect: Rect\n    },\n    util: {\n      Promise: promiseObj,\n      Delay: Delay,\n      Tools: Tools,\n      VK: VK,\n      URI: URI,\n      Class: Class,\n      EventDispatcher: EventDispatcher,\n      Observable: Observable,\n      I18n: I18n,\n      XHR: XHR,\n      JSON: JSONUtils,\n      JSONRequest: JSONRequest,\n      JSONP: JSONP,\n      LocalStorage: LocalStorage,\n      Color: Color,\n      ImageUploader: ImageUploader\n    },\n    dom: {\n      EventUtils: EventUtils,\n      Sizzle: Sizzle,\n      DomQuery: DomQuery,\n      TreeWalker: DomTreeWalker,\n      TextSeeker: TextSeeker,\n      DOMUtils: DOMUtils,\n      ScriptLoader: ScriptLoader,\n      RangeUtils: RangeUtils,\n      Serializer: DomSerializer,\n      StyleSheetLoader: StyleSheetLoader,\n      ControlSelection: ControlSelection,\n      BookmarkManager: BookmarkManager,\n      Selection: EditorSelection,\n      Event: EventUtils.Event\n    },\n    html: {\n      Styles: Styles,\n      Entities: Entities,\n      Node: AstNode,\n      Schema: Schema,\n      SaxParser: SaxParser,\n      DomParser: DomParser,\n      Writer: Writer,\n      Serializer: HtmlSerializer\n    },\n    Env: Env,\n    AddOnManager: AddOnManager,\n    Annotator: Annotator,\n    Formatter: Formatter,\n    UndoManager: UndoManager,\n    EditorCommands: EditorCommands,\n    WindowManager: WindowManager,\n    NotificationManager: NotificationManager,\n    EditorObservable: EditorObservable,\n    Shortcuts: Shortcuts,\n    Editor: Editor,\n    FocusManager: FocusManager,\n    EditorManager: EditorManager,\n    DOM: DOMUtils.DOM,\n    ScriptLoader: ScriptLoader.ScriptLoader,\n    PluginManager: PluginManager,\n    ThemeManager: ThemeManager,\n    IconManager: IconManager,\n    Resource: Resource,\n    trim: Tools.trim,\n    isArray: Tools.isArray,\n    is: Tools.is,\n    toArray: Tools.toArray,\n    makeMap: Tools.makeMap,\n    each: Tools.each,\n    map: Tools.map,\n    grep: Tools.grep,\n    inArray: Tools.inArray,\n    extend: Tools.extend,\n    create: Tools.create,\n    walk: Tools.walk,\n    createNS: Tools.createNS,\n    resolve: Tools.resolve,\n    explode: Tools.explode,\n    _addCacheSuffix: Tools._addCacheSuffix,\n    isOpera: Env.opera,\n    isWebKit: Env.webkit,\n    isIE: Env.ie,\n    isGecko: Env.gecko,\n    isMac: Env.mac\n  };\n  var tinymce = Tools.extend(EditorManager, publicApi);\n\n  var exportToModuleLoaders = function (tinymce) {\n    if (typeof module === 'object') {\n      try {\n        module.exports = tinymce;\n      } catch (_) {}\n    }\n  };\n\n  var exportToWindowGlobal = function (tinymce) {\n    window.tinymce = tinymce;\n    window.tinyMCE = tinymce;\n  };\n\n  exportToWindowGlobal(tinymce);\n  exportToModuleLoaders(tinymce);\n})();","map":{"version":3,"sources":["/Users/katana/Desktop/Programming/Hackathons/SEED/frontend/node_modules/tinymce/tinymce.js"],"names":["typeOf","x","undefined","t","Array","prototype","isPrototypeOf","constructor","name","String","isEquatableType","indexOf","sort","xs","compareFn","clone","slice","call","contramap","eqa","f","eq","y","tripleEq","eqString","eqArray","length","len","i","eqSortedArray","eqRecord","kx","Object","keys","ky","q","eqAny","tx","ty","noop","compose","fa","fb","args","_i","arguments","apply","compose1","fbc","fab","a","constant","value","identity","curry","fn","initialArgs","restArgs","all","concat","not","die","msg","Error","never","always","none","NONE","o","isNone","thunk","id","n","me","fold","_s","is","isSome","getOr","getOrThunk","getOrDie","getOrNull","getOrUndefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","some","constant_a","self","s","v","elementEq","b","from","Optional","typeOf$1","isType","type","isSimpleType","eq$1","isString","isObject","isArray","isNull","isBoolean","isUndefined","isNullable","isNonNullable","isFunction","isNumber","nativeSlice","nativeIndexOf","nativePush","push","rawIndexOf","ts","r","contains","pred","eachr","partition","pass","fail","arr","foldr","acc","foldl","findUntil","until","find","findIndex","flatten","reverse","difference","a1","a2","mapToObject","sort$1","comparator","copy","get","head","last","from$1","findMap","hasOwnProperty","each$1","obj","props","k","map$1","tupleMap","tuple","objAcc","internalFilter","onTrue","onFalse","bifilter","filter$1","mapToArray","values","get$1","key","has","hasNonNullableKey","equal","isArray$1","array","l","each$2","cb","map$2","callback","out","item","index","filter$2","indexOf$1","reduce","collection","iteratee","accumulator","thisArg","findIndex$1","predicate","last$1","__assign","assign","p","__rest","e","getOwnPropertySymbols","propertyIsEnumerable","__spreadArrays","il","j","jl","cached","called","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiOS","test","isiPhone","isMobile","isAndroid","isTouch","isTablet","isPhone","iOSwebview","isSafari","isDesktop","isWebView","firstMatch","regexes","find$1","agent","major","minor","group","Number","replace","nu","detect","versionRegexes","cleanedAgent","toLowerCase","unknown","Version","detect$1","candidates","candidate","search","detectBrowser","browsers","version","current","detectOs","oses","UaString","removeFromStart","str","numChars","substring","checkRange","substr","start","removeLeading","prefix","startsWith","contains$1","blank","trim","lTrim","rTrim","normalVersionRegex","checkContains","target","uastring","PlatformInfo","edge","chrome","ie","opera","firefox","safari","unknown$1","nu$1","info","isBrowser","isEdge","isChrome","isIE","isOpera","isFirefox","Browser","windows","ios","android","linux","osx","solaris","freebsd","chromeos","unknown$2","nu$2","isOS","isWindows","isOSX","isLinux","isSolaris","isFreeBSD","isChromeOS","OperatingSystem","detect$2","deviceType","PlatformDetection","query","window","matchMedia","matches","platform","navigator","detect$3","platform$1","webkit","fileApi","URL","createObjectURL","windowsPhone","Env","gecko","mac","iOS","contentEditable","transparentSrc","caretAfter","range","getSelection","documentMode","document","ceFalse","cacheSuffix","container","experimentalShadowDom","canHaveCSP","desktop","whiteSpaceRegExp","trim$1","makeMap","items","delim","split","hasOwnProperty$1","prop","create","root","sp","scn","c","de","exec","cn","match","ns","createNS","onCreate","extend","resolve","parent","static","exts","ext","name_1","walk","explode","d","_addCacheSuffix","url","Tools","grep","inArray","hasOwn","fromHtml","html","scope","doc","div","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromDom","fromTag","tag","node","fromText","text","createTextNode","dom","fromPoint","docElm","elementFromPoint","SugarElement","toArray$1","recurse","cur","compareDocumentPosition","documentPositionContainedBy","Node","DOCUMENT_POSITION_CONTAINED_BY","COMMENT","DOCUMENT","DOCUMENT_FRAGMENT","ELEMENT","TEXT","is$1","element","selector","nodeType","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","base","querySelectorAll","one","querySelector","eq$2","e1","e2","regularContains","d1","d2","ieContains","contains$2","Global","Function","nodeName","isType$1","isComment","isElement","isText","isDocument","isDocumentFragment","owner","ownerDocument","documentOrOwner","dos","documentElement","defaultView","parentNode","parents","isRoot","stop","ret","rawParent","siblings","filterSelf","elements","children","prevSibling","previousSibling","nextSibling","prevSiblings","nextSiblings","child","cs","firstChild","lastChild","childNodesCount","getHead","isShadowRoot","host","supported","Element","attachShadow","getRootNode","isSupported","getStyleContainer","getShadowRoot","getShadowHost","getOriginalEventTarget","event","el","isOpenShadowHost","composed","composedPath","shadowRoot","before","marker","parent$1","insertBefore","after","sibling","append","prepend","firstChild$1","appendChild","wrap","wrapper","before$1","append$1","empty","textContent","rogue","remove","removeChild","unwrap","children$1","inBody","body","left","top","translate","SugarPosition","boxPosition","box","getBoundingClientRect","firstDefinedOrZero","absolute","win","offsetLeft","offsetTop","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","viewport","get$2","_DOC","to","scrollTo","intoView","alignToTop","scrollIntoViewIfNeeded","scrollIntoView","get$3","_win","bounds","width","height","right","bottom","getBounds","scroll","clientWidth","clientHeight","visualViewport","Math","max","pageLeft","pageTop","isNodeType","isRestrictedNode","getPrototypeOf","isElement$1","matchNodeNames","names","lowercasedNames","matchStyleValues","cssValue","computed","getComputedStyle","getPropertyValue","hasAttribute","attrName","hasAttributeValue","attrValue","getAttribute","isBogus","isBogusAll","isTable","tagName","hasContentEditableState","isTextareaOrInput","isText$1","isComment$1","isDocument$1","isDocumentFragment$1","isBr","isImg","isContentEditableTrue","isContentEditableFalse","isTableCell","isMedia","isSupported$1","style","rawSet","setAttribute","set","setAll","attrs","get$4","getOpt","has$1","remove$1","removeAttribute","attributes","attr","internalSet","property","setProperty","setAll$1","css","get$5","styles","getUnsafeProperty","getRaw","raw","getAllRaw","ruleName","reflow","offsetWidth","browser$1","firstElement","nodes","getTableCaptionDeltaY","elm","caption","bodyTop","captionTop","captionHeight","offsetHeight","hasChild","getPos","rootElm","offsetParent","pos","exports$1","module$1","exports","define","module","require","amd","g","global","EphoxContactWrapper","u","code","process","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","setTimeout","clearTimeout","runTimeout","fun","runClearTimeout","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","run","nextTick","Item","title","env","argv","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","setImmediate","setTimeoutFunc","Promise","TypeError","_state","_handled","_value","_deferreds","doResolve","handle","deferred","_immediateFn","onFulfilled","onRejected","reject","promise","newValue","then","finale","_unhandledRejectionFn","Handler","done","reason","ex","prom","remaining","res","val","race","err","warn","_setImmediateFn","_setUnhandledRejectionFn","clearImmediate","immediateIds","nextImmediateId","Timeout","setInterval","clearInterval","close","clearFn","_id","_clearFn","unref","ref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","onTimeout","_onTimeout","onNextTick","promisePolyfill","boltExport","nu$3","baseFn","data","callbacks","nCallback","isReady","cbs","pure","LazyValue","errorReporter","make","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","cache","nu$4","pure$1","Future","par","asyncValues","count","asyncValue","par$1","futures","_opt","_f","mapError","_","onValue","toOptional","isValue","isError","message","opt","onError","fromOption","Result","generate","cases","constructors","adt","acase","keys$1","argLength","branches","branchKeys","join","allReqd","reqKey","foldArgs","log","label","params","Adt","comparison","bothErrors","firstError","secondError","bothValues","unite","result","ClosestOrAncestor","ancestor","closest","child$1","ancestor$1","descendant","closest$1","asap","immediateFn","catch","promiseObj","requestAnimationFramePromise","requestAnimationFrame","requestAnimationFrameFunc","vendors","featurefill","wrappedSetTimeout","time","wrappedSetInterval","wrappedClearTimeout","wrappedClearInterval","debounce","timer","func","Delay","setEditorTimeout","editor","removed","setEditorInterval","throttle","StyleSheetLoader","documentOrShadowRoot","settings","idCount","loadedStates","edos","maxLoadTime","_setReferrerPolicy","referrerPolicy","addStyle","removeStyle","styleContainer","getOrCreateState","passed","failed","load","success","failure","link","urlWithSuffix","state","status","onload","onerror","wait","testCallback","waitCallback","Date","now","startTime","waitForWebKitLinkLoaded","styleSheets","styleSheet","ownerNode","linkElem","rel","contentCssCors","loadF","loadAll","urls","parts","unload","unloadAll","create$1","WeakMap","forElement","referenceElement","rootDom","sl","instance","DomTreeWalker","startNode","rootNode","next","prev","prev2","shallow","findSibling","findPreviousNode","startName","siblingName","blocks","tableCells","tableSections","textBlocks","headings","listItems","lists","wsElements","lazyLookup","lookup","isHeading","isBlock","isTable$1","isInline","isBr$1","isTextBlock","isList","isListItem","isTableSection","isTableCell$1","isWsPreserveElement","ancestor$2","zeroWidth","nbsp","isZwsp","char","removeZwsp","ZWSP","isZwsp$1","trim$2","isElement$2","isText$2","isCaretContainerBlock","isCaretContainerInline","isCaretContainer","hasContent","insertInline","textNode","startsWithCaretContainer","splitText","endsWithCaretContainer","isBeforeInline","charAt","offset","isAtStart","isAfterInline","isAtEnd","createBogusBr","br","insertBlock","blockName","blockNode","trimBogusBr","brs","getElementsByTagName","lastBr","showCaretContainerBlock","caretContainer","isRangeInCaretContainerBlock","startContainer","isContentEditableTrue$1","isContentEditableFalse$1","isBr$2","isText$3","isInvalidTextElement","isAtomicInline","isTable$2","isCaretContainer$1","isCaretCandidate","isNonUiContentEditableFalse","isUnselectable","isInEditable","isAtomicContentEditableFalse","isAtomic","isEditableCaretCandidate","whiteSpaceRegExp$1","isWhitespaceText","hasWhitespacePreserveParent","rootElement","isWhitespace","isNamedAnchor","isContent","isBookmark","isBogus$1","isBogusAll$1","isEmptyNode","targetNode","skipBogus","brCount","walker","isEmpty","isSpan","isInlineContent","surroundedByInlineContent","prevIsInline","nextIsInline","isBookmarkNode","isKeepTextNode","isKeepElement","isDocument$2","trimNode","currentChildren","makeMap$1","attrsCharsRegExp","textCharsRegExp","rawCharsRegExp","entityRegExp","asciiMap","baseEntities","reverseEntities","nativeDecode","innerText","buildEntitiesLookup","radix","chr","entity","fromCharCode","parseInt","namedEntities","encodeRaw","encodeAllRaw","encodeNumeric","charCodeAt","encodeNamed","entities","getEncodeFunc","entitiesMap","encodeNamedAndNumeric","encodeCustomNamed","nameMap","named","numeric","decode","Entities","mapCache","dummyObj","makeMap$2","each$3","extend$1","explode$1","compileSchema","schema","globalAttributes","blockContent","phrasingContent","flowContent","html4BlockContent","html4PhrasingContent","add","ni","attributesOrder","arrayToMap","addAttrs","schemaItem","table","script","compileElementMap","mode","toUpperCase","Schema","patternElements","customElementsMap","specialElements","createLookupTable","option","defaultValue","extendWith","schemaItems","verify_html","valid_elements","validStyles","valid_styles","invalidStyles","invalid_styles","validClasses","valid_classes","whiteSpaceElementsMap","selfClosingElementsMap","shortEndedElementsMap","boolAttrMap","nonEmptyOrMoveCaretBeforeOnEnter","nonEmptyElementsMap","moveCaretBeforeOnEnterElementsMap","textBlockElementsMap","blockElementsMap","textInlineElementsMap","special","RegExp","patternToRegExp","addValidElements","validElements","ei","ai","al","attrData","elementName","attrType","outputName","globalAttributesOrder","elementRuleRegExp","attrRuleRegExp","hasPatternsRegExp","validElementsArr","paddEmpty","removeEmpty","removeEmptyAttrs","attributesRequired","required","splice","attributesDefault","attributesForced","forcedValue","validValues","attributePatterns","pattern","setValidElements","addCustomElements","customElements","customElementRegExp","text_block_elements","block_elements","rule","inline","cloneName","customRule","elmName","addValidChildren","validChildren","childRuleRegExp","getElementRule","custom_elements","valid_children","extended_valid_elements","dd","dt","li","td","th","tr","tbody","thead","tfoot","legend","area","param","parentsRequired","invalid_elements","getValidStyles","getInvalidStyles","getValidClasses","getBoolAttrs","getBlockElements","getTextBlockElements","getTextInlineElements","getShortEndedElements","getSelfClosingElements","getNonEmptyElements","getMoveCaretBeforeOnEnterElements","getWhiteSpaceElements","getSpecialElements","isValidChild","isValid","attrPatterns","getCustomElements","toHex","hex","Styles","_this","rgbRegExp","urlOrStrRegExp","styleRegExp","trimRightRegExp","encodingLookup","invisibleChar","encodingItems","color","parse","isEncoded","urlConverter","url_converter","urlConverterScope","url_converter_scope","compress","suffix","noJoin","canCompress","compress2","encode","keepSlashes","decodeSingleHexSequence","escSeq","decodeHexSequences","processUrl","url2","url3","str2","allow_script_urls","scriptUrl","allow_svg_data_urls","lastIndex","border","serialize","serializeStyles","styleList","i_1","styleMap","eventExpandoPrefix","mouseEventRe","deprecated","keyLocation","layerX","layerY","returnValue","webkitMovementX","webkitMovementY","keyIdentifier","mozPressure","hasIsDefaultPrevented","isDefaultPrevented","returnTrue","returnFalse","addEvent","capture","addEventListener","attachEvent","removeEvent","removeEventListener","detachEvent","isMouseEvent","fix","originalEvent","srcElement","pageX","clientX","eventDoc","pageY","clientY","preventDefault","defaultPrevented","stopPropagation","cancelBubble","isPropagationStopped","stopImmediatePropagation","isImmediatePropagationStopped","metaKey","bindOnReady","eventUtils","domLoaded","isDocReady","readyState","readyHandler","EventUtils","events","expando","hasMouseEnterLeave","hasFocusIn","callbackList","fakeName","nativeHandler","defaultNativeHandler","evt","executeHandlers","namesList","mouseEnterLeave","currentTarget","related","relatedTarget","unbind","ci","eventMap","fire","parentWindow","clean","destroy","cancel","Event","support","Expr","getText","isXML","tokenize","compile","select","outermostContext","sortInput","hasDuplicate","setDocument","document$1","docElem","documentIsHTML","rbuggyQSA","rbuggyMatches","contains$3","preferredDoc","dirruns","classCache","createCache","tokenCache","compilerCache","sortOrder","strundefined","MAX_NEGATIVE","pop","push_native","indexOf$2","booleans","whitespace","identifier","pseudos","rtrim","rcomma","rcombinators","rattributeQuotes","rpseudo","ridentifier","matchExpr","ID","CLASS","TAG","ATTR","PSEUDO","CHILD","bool","needsContext","rinputs","rheader","rnative","rquickExpr","rsibling","rescape","runescape","funescape","escaped","escapedWhitespace","high","els","Sizzle","context","results","seed","m","groups","old","nid","newContext","newSelector","getElementById","getElementsByClassName","qsa","toSelector","testContext","qsaError","cacheLength","shift","markFunction","siblingCheck","diff","sourceIndex","createInputPseudo","createButtonPseudo","createPositionalPseudo","argument","matchIndexes","hasCompare","getTop","getById","attrId","tmp","className","disconnectedMatch","adown","bup","compare","sortDetached","aup","ap","bp","unshift","expr","matchesSelector","attrHandle","getAttributeNode","specified","uniqueSort","duplicates","detectDuplicates","sortStable","nodeValue","selectors","createPseudo","relative","first","preFilter","excess","unquoted","nodeNameSelector","operator","check","what","simple","forward","ofType","xml","outerCache","nodeIndex","useCache","pseudo","setFilters","idx","matched","input","matcher","unmatched","lang","elemLang","hash","location","focus","activeElement","hasFocus","href","tabIndex","enabled","disabled","checked","selected","selectedIndex","header","button","even","odd","lt","gt","nth","filters","parseOnly","tokens","soFar","preFilters","addCombinator","combinator","checkNonElements","doneName","oldCache","newCache","elementMatcher","matchers","multipleContexts","contexts","condense","newUnmatched","mapped","setMatcher","postFilter","postFinder","postSelector","temp","preMap","postMap","preexisting","elems","matcherIn","matcherOut","matcherFromTokens","checkContext","leadingRelative","implicitRelative","matchContext","matchAnyContext","matcherFromGroupMatchers","elementMatchers","setMatchers","bySet","byElement","superMatcher","outermost","matchedCount","setMatched","contextBackup","dirrunsUnique","random","token","compiled","push$1","slice$1","rquickExpr$1","skipUniques","isDefined","isString$1","isWindow","createFragment","fragDoc","frag","createDocumentFragment","domManipulate","targetNodes","sourceItem","getElementDocument","DomQuery","makeArray","hasClass","wrap$1","lastParent","newWrapper","cloneNode","numericCssMap","booleanMap","propFix","for","class","readonly","cssFix","float","attrHooks","cssHooks","DomQueryConstructor","init","inArray$1","whiteSpaceRegExp$2","trim$3","each$4","unique","hook","removeAttr","camel","dashed","removeProperty","currentStyle","appendTo","prependTo","replaceWith","content","wrapAll","wrapInner","contents","addClass","toggleClass","removeClass","classState","existingClassName","trigger","show","hide","object","sibling$1","firstSibling","contentDocument","contentWindow","wrappedResult","parentsUntil","nextUntil","prevUntil","overrideDefaults","defaults","sub","each$5","grep$1","simpleSelectorRe","setupAttrHooks","getContext","keepValues","keep_values","keepUrlHook","$elm","src","updateInternalStyleAttr","rawValue","findNodeIndex","normalized","lastNodeType","DOMUtils","addedStyles","files","counter","stdMode","boxModel","styleSheetLoader","boundEvents","ownEvents","$","getRoot","$$","getAttrib","defaultVal","getAttribs","setAttrib","originalValue","onSetAttrib","attrElm","deep","clone_1","root_element","getViewPort","argWin","vp","w","h","getPos$1","setStyle","update_styles","setStyles","stylesArg","getStyle","getSize","getRect","size","elms","getParents","collect","selectorVal","getParent","_findSib","getNext","getPrev","setAttribs","setHTML","canHaveHTML","parentElm","newElm","createHTML","outHtml","keepChildren","$node","removeAllAttribs","removeAttributeNode","parseStyle","cssText","serializeStyle","styleElm","DOM","loadCSS","cls","isHidden","uniqueId","getOuterHTML","outerHTML","setOuterHTML","insertAfter","reference","referenceNode","oldElm","replaceChild","rename","attrNode","findCommonAncestor","ps","pe","rgbVal","isNonEmptyElement","bogusVal","createRng","createRange","splitElm","replacementElm","beforeFragment","afterFragment","setStart","setEnd","extractContents","rv","output","getContentEditable","getContentEditableParent","isChildOf","dumpRng","startOffset","endContainer","endOffset","each$6","grep$2","QUEUED","LOADING","LOADED","FAILED","ScriptLoader","states","scriptLoadedCallbacks","queueLoadedCallbacks","loading","loadScript","cleanup","isDone","markDone","loadQueue","loadScripts","scripts","failures","execCallbacks","loadingScripts","notifyCallbacks","Cell","initial","isRaw","isTokenised","currentCode","getLanguageData","getData","setCode","newCode","getCode","langData","translation","getLangData","textstr","removeContext","values_1","substitued","$1","$2","isRtl","hasCode","I18n","AddOnManager","_listeners","runListeners","matchedListeners","listener","dependencies","requireLangPack","languages","languageLoad","waitFor","language","wrappedLanguages","addOn","addOnConstructor","createUrl","baseUrl","dep","resource","addComponents","pluginName","pluginUrl","loadDependencies","addOnUrl","deps","newUrl","urlString","baseURL","lastIndexOf","PluginManager","ThemeManager","rate","last$2","read","add$1","remove$2","supports","classList","get$6","add$2","clazz","remove$3","add$3","cleanClass","remove$4","has$2","descendants","descendants$1","annotation","dataAnnotation","dataAnnotationId","identify","annotationName","rng","selection","getRng","getBody","an","newStart","getAttr","uid","findMarkers","isAnnotation","findAll","markers","directory","nodesAlready","setup","_registry","changeCallbacks","initData","previous","withCallbacks","updateCallbacks","callbackMap","outputData","fireCallbacks","fireNoAnnotation","onNodeChange","annotations","_a","setup$1","registry","identifyParserNode","span","serializer","addNodeFilter","spans","persistent","create$2","register","generate$1","date","getTime","floor","add$4","classes","fromHtml$1","get$7","set$1","owner$1","docDom","fragment","contentElements","clone$1","original","isDeep","TextWalker","isBoundary","direction","TextSeeker","isBlockBoundary","newOffset","backwards","forwards","cat","lift2","oa","ob","lift3","oc","someIf","round","clone$2","rect","collapse","toStart","isEqual","rect1","rect2","isValidOverflow","overflowY","min","isAbove","halfHeight","isBelow","containsXY","getSelectedNode","getNode","extendingChars","isExtendingChar","ch","and","isElement$3","isCaretCandidate$1","isBlock$1","isFloated","isValidElementCaretCandidate","isNotPre","isText$4","isBr$3","resolveIndex","isWhiteSpace","isRange","isHiddenWhiteSpaceRange","getBrClientRect","brNode","nbsp$1","clientRect","getBoundingClientRectWebKitText","sc","ec","so","eo","newRng","cloneRange","setEndAfter","isZeroRect","clientRects","getClientRects","collapseAndInflateWidth","newClientRect","getCaretPositionClientRects","caretPosition","beforeNode","addUniqueAndValidRect","addCharacterOffset","CaretPosition","toRange","isVisible","fromRangeStart","fromRangeEnd","pos1","pos2","isTextPosition","isElementPosition","trimEmptyTextNode","insertNode","insertFragment","rangeInsertNode","isText$5","isBogus$2","nodeIndex$1","normalizedParent","getChildNodes","normalizedTextOffset","equal$1","normalizedNodeIndex","numTextFragments","createPathItem","create$3","path","outputOffset","resolvePathItem","findTextPosition","targetOffset","dataLen","resolve$1","paths","isContentEditableFalse$2","getNormalizedTextOffset","trimmedOffset","getPoint","point","getLocation","bookmark","isCollapsed","end","findIndex$2","moveEndPoint","normalizeTableCellSelection","findAdjacentContentEditableFalseElm","getOffsetBookmark","getCaretBookmark","getRangeBookmark","createBookmarkSpan","filled","getPersistentBookmark","collapsed","rng2","endBookmarkNode","startBookmarkNode","moveToBookmark","keep","getBookmark","getUndoBookmark","DOM$1","defaultPreviewStyles","getBodySetting","getParam","bodyObj","getIframeAttrs","getDocType","getDocumentBaseUrl","getBodyId","getBodyClass","getContentSecurityPolicy","shouldPutBrInPre","getForcedRootBlock","block","getForcedRootBlockAttrs","getBrNewLineSelector","getNoNewLineSelector","shouldKeepStyles","shouldEndContainerOnEmptyBlock","getFontStyleValues","getFontSizeClasses","getImagesDataImgFilter","isAutomaticUploadsEnabled","shouldReuseFileName","shouldReplaceBlobUris","getIconPackName","getIconsUrl","getImageUploadUrl","getImageUploadBasePath","getImagesUploadCredentials","getImagesUploadHandler","shouldUseContentCssCors","getReferrerPolicy","getLanguageCode","getLanguageUrl","shouldIndentUseMargin","getIndentation","getContentCss","contentCss","getFontCss","fontCss","getDirectionality","getInlineBoundarySelector","getObjectResizing","getResizeImgProportional","getPlaceholder","getElement","getEventRoot","getServiceMessage","getTheme","shouldValidate","isInlineBoundariesEnabled","getFormats","getPreviewStyles","canFormatEmptyLines","getCustomUiSelector","getThemeUrl","isInline$1","hasHiddenInput","shouldPatchSubmit","isEncodingXml","shouldAddFormSubmitTrigger","shouldAddUnloadTrigger","hasForcedRootBlock","getCustomUndoRedoLevels","shouldDisableNodeChange","isReadOnly","hasContentCssCors","getPlugins","getExternalPlugins","shouldBlockUnsupportedDrop","isVisualAidsEnabled","getVisualAidsTableClass","getVisualAidsAnchorClass","isElement$4","isText$6","removeNode","trimCount","trimmedText","deleteZwspChars","deleteData","removeUnchanged","remove$5","removeTextAndReposition","removeElementAndReposition","newPosition","removeTextCaretContainer","removeElementCaretContainer","removeAndReposition","caretContainerNode","browser$2","isContentEditableFalse$3","isMedia$1","isTableCell$2","inlineFakeCaretSelector","getAbsoluteClientRect","scrollX","scrollY","margin","rootRect","trimInlineCaretContainers","fakeCaretTargetNodes","FakeCaret","lastVisualCaret","cursorInterval","rootBlock","caretBlock","caret","caretState","startBlink","isInlineFakeCaretTarget","reposition","getCss","isFakeCaretTableBrowser","isFakeCaretTarget","isContentEditableFalse$4","isMedia$2","isBlockLike","isCaretContainer$2","isCaretContainerBlock$1","isElement$5","isCaretCandidate$2","isForwards","isBackwards","skipCaretContainers","findNode","predicateFn","isCefOrCaretContainer","getParentBlock","isInSameBlock","caretPosition1","caretPosition2","getChildNodeAtRelativeOffset","relativeOffset","beforeAfter","setStartBefore","setEndBefore","setStartAfter","isNodesInSameBlock","node1","node2","lean","before$2","after$1","normalizeRange","leanLeft","leanRight","getRelativeCefElm","getNormalizedRangeEndPoint","normalizedRange","getElementFromPosition","getElementFromPrevPosition","getVisualCaretPosition","walkFn","isMoveInsideSameBlock","inSameBlock","HDirection","isContentEditableFalse$5","isText$7","isElement$6","isBr$4","isCaretCandidate$3","isAtomic$1","isEditableCaretCandidate$1","nodeAtIndex","getCaretCandidatePosition","moveForwardFromBr","nextNode","findCaretPosition","Forwards","startPos","innerNode","rootContentEditableFalseElm","CaretWalker","Backwards","walkToPositionIn","position","fromPosition","afterElement","isBeforeOrStart","isAfterOrEnd","isBeforeAfterSameElement","isAtBr","shouldSkipPosition","navigate","navigateIgnore","ignoreFilter","positionIn","nextPosition","prevPosition","firstPositionIn","lastPositionIn","CARET_ID","isCaretNode","getParentCaretContainer","isStringPathBookmark","isRangeBookmark","isIdBookmark","isIndexBookmark","isPathBookmark","addBogus","resolveCaretPositionBookmark","insertZwsp","isEmpty$1","tryFindRangePosition","padEmptyCaretContainer","setEndPoint","isValidTextNode","restoreEndPoint","appendData","resolvePaths","resolveId","endPos","spos","epos","resolveIndex$1","selectNode","resolve$2","getBookmark$1","setRng","isBookmarkNode$1","is$2","expected","actual","isNbsp","isWhiteSpace$1","isContent$1","isNode","isInlineBlock","moveStart","isWhiteSpaceNode","getNonWhiteSpaceSibling","inc","nextName","isTextBlock$1","ed","allowSpaces","isEmptyTextNode","replaceVars","vars","isEq","str1","normalizeStyleValue","getTextDecoration","decoration","getParents$1","isVariableFormatName","formatName","hasVariableValues","format","isVariableValue","field","fieldValues","formatter","areSimilarFormats","otherFormatName","validKeys","filterObj","validKey","fmt1","filteredFmt1","fmt2","filteredFmt2","isBlockFormat","isSelectorFormat","isInlineFormat","isBookmarkNode$2","getParents$2","isWhiteSpaceNode$1","isTextBlock$2","isBogusBr","findParentContentEditable","walkText","findSpace","findContent","findWordEndPoint","includeTrailingSpaces","lastTextNode","textSeeker","textOffset","spaceResult","findSelectorEndPoint","curFormat","findBlockEndPoint","scopeRoot","isAtBlockBoundary","findParentContainer","block_expand","isSelfOrParentBookmark","expandRng","includeTrailingSpace","startPoint","endPoint","expand","clampToExistingChildren","getEndChild","walk$1","exclude","collectSiblings","endNode","findEndPoint","walkBoundary","parent_1","siblings_1","getRanges","ranges","rangeCount","getRangeAt","getSelectedNodes","hasMultipleRanges","getCellsFromRanges","getCellsFromElement","getCellsFromElementOrRanges","selectedCells","getCellsFromEditor","getSel","getStartNode","getEndNode","getFirstChildren","getLastChildren","hasAllContentsSelected","moveEndPoint$1","hasAnyRanges","sel","runOnRanges","executor","fakeSelectionNodes","fakeNodeRng","preserve","fillBookmark","NodeValue","getOption","api","get$8","isZeroWidth","wrapName","applyWordGrab","makeAnnotation","eDoc","decorate","_b","master","_c","_d","_e","annotate","newWrappers","getDoc","finishWrapper","getOrOpenWrapper","processElements","processElement","ctx","processNodes","annotateWithBookmark","undoManager","transact","initialRng","hasFakeSelection","selectionRng","Annotator","changes","annotationChanged","getAll","BookmarkManager","getContentEditableRoot","isXYWithinRange","firePreProcess","firePostProcess","fireRemove","fireDetach","fireSwitchMode","fireObjectResizeStart","origin","fireObjectResized","firePreInit","firePostRender","fireInit","firePlaceholderToggle","fireError","errorType","VK","BACKSPACE","DELETE","DOWN","ENTER","LEFT","RIGHT","SPACEBAR","TAB","UP","END","HOME","modifierPressed","shiftKey","ctrlKey","altKey","metaKeyPressed","isContentEditableFalse$6","ControlSelection","elementSelectionAttr","selectedElm","selectedElmGhost","resizeHelper","selectedHandle","resizeBackdrop","startX","startY","selectedElmX","selectedElmY","startW","startH","ratio","resizeStarted","editableDoc","rootDocument","abs","startScrollWidth","startScrollHeight","resizeHandles","nw","ne","se","sw","isImage","isEventOnImageOutsideRange","touch","touches","contextMenuSelectImage","getResizeTargets","firstElementChild","isResizable","createGhostElement","setSizeProp","targets","setGhostElmSize","ghostElm","resizeGhostElement","deltaX","deltaY","proportional","resizeHelperX","resizeHelperY","screenX","screenY","display","scrollWidth","scrollHeight","endGhostResize","wasResizeStarted","showResizeRect","nodeChanged","targetElm","unbindResizeHandleEvents","targetWidth","targetHeight","hideResizeRect","selectedValue","handleElm","startDrag","updateResizeRect","startElm","controlElm","isChildOrEqual","img","disableGeckoResize","getStart","getEnd","isWithinContentEditableFalse","execCommand","handleMSControlSelect_1","delayedSelect","throttledUpdateResizeRect","composing","hasCeProperty","findParent","findClosestIeRange","rects","createTextRange","moveToElementText","moveToPoint","moveOutOfContentEditableFalse","parentElement","fromPoint$1","pointDoc","caretPositionFromPoint","offsetNode","caretRangeFromPoint","isEq$1","rng1","findParent$1","hasParent","hasParentWithName","isTable$3","isTableCell$3","isCeFalseCaretContainer","hasBrBeforeAfter","isPrevNode","hasContentEditableFalseParent","findTextNodeRelative","isAfterNode","lastInlineElement","parentBlockContainer","normalizeEndPoint","directionLeft","normalize","normRng","split$1","RangeUtils","normalize$1","normalizedRng","compareRanges","getCaretRangeFromPoint","Dimension","getOffset","parseFloat","getOuter","aggregate","properties","isNaN","cumulativeInclusions","absoluteMax","api$1","get$9","walkUp","navigation","frame","view","rest","pathTo","frameElement","Navigation","freeze","__proto__","find$2","frames","loc","excludeFromDescend","fireScrollIntoViewEvent","scrollEvent","fireAfterScrollIntoViewEvent","descend","markerInfo","cleanupFun","createMarker","elementMarker","withMarker","preserveWith","applyWithMarker","withScrollEvents","withElement","startElement","endElement","scrollToMarker","viewHeight","intoWindowIfNeeded","viewportBottom","markerTop","markerBottom","largerThanViewport","align","intoWindow","innerHeight","intoFrame","frameViewHeight","op","viewportBounds","rangeIntoWindow","elementIntoWindow","rangeIntoFrame","elementIntoFrame","scrollElementIntoView","scroller","scrollRangeIntoView","getDocument","create$4","soffset","finish","foffset","SimRange","cata","subject","onBefore","onOn","onAfter","situ","before$3","after$2","Situ","adt$1","domRange","exact","exactFromRange","simRange","getStart$1","startSitu","_finishSitu","_soffset","_finish","_foffset","getWin","SimSelection","browser$3","clamp","normalizeRng","isOrContains","isRngInRoot","shouldStore","nativeRangeToSelectionRange","readRange","getBookmark$2","validate","bookmarkToNativeRng","store","newBookmark","storeNative","restore","isEditorUIElement","FocusManager","isManualNodeChange","selectionChange","registerPageMouseUp","throttledStore","mouseUpPage","registerFocusOut","registerMouseUp","registerEditorEvents","documentFocusInHandler","DOM$2","isEditorUIElement$1","isEditorContentAreaElement","isUIElement","customSelector","getActiveElement","registerEvents","editorManager","focusedEditor","setActive","blurredEditor","activeEditor","unregisterDocumentEvents","setup$2","getContentEditableHost","getCollapsedNode","getFocusInElement","normalizeSelection","caretPos","focusBody","hasElementFocus","hasIframeFocus","iframeElement","hasInlineFocus","rawBody","hasUiFocus","hasFocus$1","hasEditorOrUiFocus","focusEditor","quirks","refreshContentEditable","bookmarkRng","contentEditableHost","activateEditor","focus$1","skipFocus","getEndpointElement","real","getStart$2","skipEmptyTextNodes","orig","getNode$1","commonAncestorContainer","getSelectedBlocks","endElm","selectedBlocks","select$1","processRanges","typeLookup","walk$2","isEmptyTextNode$1","AstNode","insert","selfAttrs","cloneAttrs","selfAttr","shortEnded","refNode","extractBase64DataUris","dataImageUri","chunks","uris","uri","imageId","re","restoreDataUris","parseDataUri","decodeURIComponent","safeSvgDataUrlElements","isValidPrefixAttrName","blockSvgDataUris","allowSvgDataUrls","allowed","isInvalidUri","allow_html_data_urls","findEndTagIndex","startIndex","shortEndedElements","tokenRegExp","isConditionalComment","findCommentEndIndex","lcHtml","endIfIndex","endIndex","endCommentRegexp","checkBogusAttribute","regExp","attrString","SaxParser","fix_self_closing","comment","cdata","pi","doctype","parseInternal","base64Extract","endRegExp","stack","attrList","textData","isInternalElement","isShortEnded","elementRule","isValidElement","attribsValue","validAttributesMap","validAttributePatterns","anyAttributesRequired","filteredUrlAttrs","scriptUriRegExp","parsingMode","processEndTag","valid","processText","processComment","allow_conditional_comments","processAttr","processMalformedComment","startTag","parseAttribute","val2","val3","attrRule","trimRegExp","fillAttrsMap","unescape","attrRegExp","selfClosing","self_closing_elements","removeInternalElements","remove_internals","fixSelfClosing","processHtml","matchText","bogusValue","isValidCdataSection","preserve_cdata","findEndTag","trimHtml","tempAttrs","trimContentRegExp","trimInternal","bogusAllRegExp","endTagIndex","matchLength","getTempAttrs","trimExternal","trimEmptyContents","emptyRegExp","getContentFromBody","getInner","no_events","getContentInternal","each$7","ElementUtils","attribs","compareObjects","obj1","obj2","makeMap$3","Writer","indent","indentBefore","indent_before","indentAfter","indent_after","entity_encoding","htmlOutput","element_format","reset","getContent","HtmlSerializer","writer","handlers","handler","sortedAttrs","inner","isChar","delta","isBeforeSpace","isAfterSpace","isEmptyText","matchesElementPosition","isImageBlock","isCefNode","isBeforeImageBlock","isAfterImageBlock","isBeforeMedia","isAfterMedia","isBeforeTable","isAfterTable","isBeforeContentEditableFalse","isAfterContentEditableFalse","getLastChildren$1","rawNode","removeTrailingBr","allBrs","fillWithPaddingBr","trimBlockTrailingBr","lastChildPrevSibling","dropLast","parentsUntil$1","parents$1","parentsAndSelf","navigateIgnoreEmptyTextNodes","getClosestBlock","isAtBeforeAfterBlockBoundary","newPos","fromBlock","isAtBlockBoundary$1","isAtStartOfBlock","isAtEndOfBlock","isBeforeBlock","isAfterBlock","isBr$5","findBr","parentBlocks","isBeforeBr","isAfterBr","findPreviousBr","findNextBr","isInMiddleOfText","getClosestBlock$1","hasSpaceBefore","hasSpaceAfter","isPreValue","isInPre","isAtBeginningOfBody","isAtEndOfBody","isAtLineBoundary","needsToHaveNbsp","needsToBeNbspLeft","needsToBeNbspRight","needsToBeNbsp","isNbspAt","hasNbsp","normalizeNbspMiddle","chars","normalizeNbspAtStart","firstPos","normalizeNbspInMiddleOfTextNode","newText","normalizeNbspAtEnd","lastPos","normalizeNbsps","normalizeNbspsInEditor","normalizeContent","isStartOfContent","isEndOfContent","previousCharIsSpace","replaceData","normalizeWhitespaceAfter","whitespaceCount","normalizeWhitespaceBefore","mergeTextNodes","prevNode","normalizeWhitespace","mergeToPrev","whitespaceOffset","newNode","insertData","needsReposition","beforeOrStartOf","afterOrEndOf","getPreviousSiblingCaretPosition","getNextSiblingCaretPosition","findCaretPositionBackwardsFromElm","startPosition","findCaretPositionForwardsFromElm","findCaretPositionBackwards","findCaretPositionForward","findCaretPosition$1","findCaretPosOutsideElmAfterDelete","setSelection","eqRawNode","isBlock$2","paddEmptyBlock","deleteNormalized","afterDeletePosOpt","prevTextOpt","nextTextOpt","isInlineElement","deleteElement","moveCaret","afterDeletePos","parentBlock","normalizedAfterDeletePos","setContent","setCursorLocation","paddPos","tableCellRng","tableSelection","cells","deleteAction","removeTable","emptyCells","deleteCellSelection","isRootFromElement","getClosestCell","getClosestTable","cell","isExpandedCellRng","cellRng","getTableFromCellRng","startParentTable","endParentTable","isSingleCellTable","rows","getTableCells","getCellRng","startCell","endCell","getCellRangeFromStartTable","partialSelection","isWithinSameTable","getTableSelectionFromCellRng","getTableSelection","optCellRng","cRng","getCellIndex","getSelectedCells","isSingleCellTableContentSelected","getAction","getActionFromRange","freefallRtl","deleteCellContents","deleteContents","lastNode","lastBlock","additionalCleanupNodes","deleteTableElement","deleteCellRange","action","deleteCaptionRange","emptyElement","deleteTableRange","getParentCaption","deleteRange","getParentCell","deleteBetweenCells","fromCell","toCell","isDeleteOfLastCharPos","fromCaption","emptyCaretCaption","validateCaretCaption","toCaption","deleteCaretInsideCaption","deleteCaretCells","deleteCaretCaption","isNearTable","isBeforeOrAfterTable","fromPos","deleteCaret","backspaceDelete","createRange$1","normalizeBlockSelectionRange","newEndPos","normalize$2","hasOnlyOneChild","isPaddingNode","isPaddedEmptyBlock","blockElements","isEmptyFragmentElement","nonEmptyElements","isListFragment","cleanupDomFragment","domFragment","toDomFragment","listItems$1","isPadding","isListItemPadded","isEmptyOrPadded","trimListItems","getParentLi","isParentBlockLi","getSplit","beforeRng","afterRng","cloneContents","findFirstIn","caretWalker","newCaretPos","findLastOf","insertMiddle","insertAtCaret","liTarget","liElms","BEGINNING","isAt","trimOrPadLeftRight","isTableCell$4","isTableCellContentSelected","validInsertion","trimBrsFromTableCell","reduceInlineTextElements","merge","textInlineElements","root_1","elementUtils_1","testNode","markFragmentElements","unmarkFragmentElements","isPartOfFragment","canHaveChildren","moveSelectionToMarker","nextRng","getContentEditableFalseParent","parentEditableFalseElm","findNextCaretRng","deleteSelectedContent","insertHtmlAtCaret","details","parser","bookmarkHtml","paste","caretElement","parserArgs","_selectionOverrides","showBlockCaretContainer","invalid","addVisual","traverse","findMatchingNodes","nodeFilters","attributeFilters","nodeMatches","attrMatches","name_2","filter$3","defaultFormat","isTreeNode","moveSelection","setEditorHtml","setContentString","forcedRootBlockName","padd","isRootContent","setContentTree","getNodeFilters","getAttributeFilters","setContentInternal","sibling$2","ensureIsRoot","ancestor$3","transform","transformed","closest$2","isEq$2","matchesUnInheritedFormatSelector","formatList","inherit","matchParents","matchNode","matchName","matchItems","itemName","similar","onmatch","matchAll","matchedFormatNames","checkedMap","closest$3","rawElm","canApply","defaultBlock","matchAllOnNode","formatNames","matchSimilar","ZWSP$1","CARET_ID$1","importNode","getEmptyCaretContainers","isCaretContainerEmpty","findFirstTextNode","createCaretContainer","fill","trimZwspFromCaretContainer","removeCaretContainerNode","removeCaretContainer","insertCaretContainerNode","formatNode","appendNode","insertFormatNodesIntoCaretContainer","formatNodes","innerMostFormatNode","cleanFormatNode","validFormats","matchedFormats","uniqueFormats","fmtName","clonedFormatNode","applyCaretFormat","wordcharRegex","removeCaretFormat","hasContentAfter","expandedRng","newCaretContainer","cleanedFormatNode","caretTextNode","disableCaretContainer","keyCode","setup$3","replaceWithCaretFormat","innerMost","isFormatElement","inlineElements","isEmptyCaretFormatElement","postProcessHooks","filter$4","each$8","addPostProcessHook","hooks","postProcess","hasPreSibling","pre","isPre","joinPre","pre1","pre2","each$9","isElementNode","findElementSibling","mergeSiblingsNodes","tmpSibling","elementUtils","mergeSiblings","merge_siblings","clearChildStyles","clear_child_styles","links","processChildElements","unwrapEmptySpan","hasStyle","applyStyle","removeResult","MCE_ATTR_RE","each$a","isEq$3","isTableCellOrRow","isChildOfInlineParent","getContainer","lastIdx","normalizeTableSelection","childNode","wrap$2","wrapWithSiblings","matchName$1","isColorFormatAndAnchor","find$3","removeNode$1","rootBlockElm","forcedRootBlock","list_block","forced_root_block_attrs","removeFormatInternal","compareNode","stylesModified","preserve_attributes","attrsToPreserve","remove_similar","valueOut","removeFormat","newName","findFormatRoot","formatRoot","removeFormatFromClone","wrapAndSplit","lastClone","firstClone","formatRootParent","mixed","remove$6","splitToFormatRoot","isRemoveBookmarkNode","lastContentEditable","removeRngStyle","textDecorations","textDecoration","ceFalseOverride","each$b","mergeTextDecorationsAndColor","processTextDecorationsAndColor","mergeBackgroundColorAndFontSize","backgroundColor","mergeSubSup","mergeWithChildren","mergeWithParents","merge_with_parents","each$c","hasFormatProperty","isElementNode$1","canFormatBR","parentName","validBRParentElements","figcaption","summary","hasCaretNodeSibling","applyFormat","setElementFormat","fmt","onformat","styleVal","applyNodeStyle","found","applyRngStyle","nodeSpecific","wrapElm","currentWrapElm","getChildCount","getChildElementNode","mergeStyles","childCount","formatItem","curSelNode","firstFormat","forced_root_block","fake","setup$4","registeredFormatListeners","currentFormats","updateAndFireChangeCallbacks","formatChangeData","formatsList","newFormats","remainingFormats","filterRemainingFormats","addListeners","formats","formatChangeItems","removeListeners","formatChangedInternal","toggle","fromElements","tableModel","tableRow","cellPosition","getSpan","fillout","rowspan","colspan","y2","x2","cellExists","skipCellsX","getWidth","row","findElementPos","extractRows","sx","sy","ey","newRows","subTable","createDomTable","tableElement","tableBody","modelRowsToDomRows","fromDom$1","tableElm","toDom","subsection","findParentListContainer","getFullySelectedListWrappers","_li","listCont","listElm","listStyles","_style","wrap$3","innerElm","wrapped","directListWrappers","commonAnchorContainer","getWrapElements","wrapElements","listWrappers","allWrappers","emptyFragment","getFragmentFromRange","getParentTable","getTableFragment","selectedTableCells","firstCell","lastCell","fullTableModel","sectionedTableModel","getSelectionFragment","read$1","trimLeadingCollapsibleText","isCollapsibleWhitespace","getInnerText","bin","shouldTrim","getContextNodeName","parentBlockOpt","getTextContent","contextNodeName","shouldTrimSpaces","nonRenderedText","parentBlockText","textIndex","hasProceedingSpace","hasTrailingSpace","getSerializedContent","tmpElm","contextual","getSelectedContentInternal","KEEP","INSERT","vDown","vUp","snake","diag","buildScript","start1","end1","start2","end2","middle","getMiddleSnake","i2","buildSnake","sum","getOuterHtml","createFragment$1","insertAt","removeAt","applyDiff","read$2","write","fragments","currentFragments","undoLevelDocument","lazyTempDocument","implementation","createHTMLDocument","hasIframes","createFragmentedLevel","beforeBookmark","createCompleteLevel","createFromEditor","trimmedFragments","trimmed","applyToEditor","level","getLevelContent","getCleanLevelContent","hasEqualContent","level1","level2","hasEqualCleanedContent","isEq$4","isUnlocked","locks","setTyping","typing","endTyping","endTypingLevelIgnoreLocks","beforeChange","addUndoLevel","currentLevel","lastLevel","bm","customUndoRedoLevels","setDirty","clear","extra","callback1","callback2","redo","undo","hasUndo","hasRedo","ignore","addVisualInternal","hasVisual","matchedElm","value_1","cls_1","makePlainAdaptor","formatChanged","insertContent","getModel","makeRtcAdaptor","rtcEditor","defaultVars","unsupported","_undoManager","_locks","_index","_node","_similar","_rfl","_format","_details","getRawModel","makeNoopAdaptor","nul","isRtc","plugins","setup$5","editorCast","rtcInstance","rtc","isRemote","getRtcInstanceWithFallback","getRtcInstanceWithError","beforeChange$1","addUndoLevel$1","undo$1","redo$1","clear$1","reset$1","hasUndo$1","hasRedo$1","transact$1","ignore$1","extra$1","matchFormat","matchAllFormats","matchNodeFormat","canApplyFormat","closestFormat","applyFormat$1","removeFormat$1","toggleFormat","getSelectedContent","getContent$1","walkPastBookmark","outer","outerElm","oldLength","normalizeTextIfRequired","mergeAndNormalizeText","outerNode","normalizer","innerTextNode","rngSetContent","prevText","nextText","setupArgs","cleanContent","contextBlock","contextArgs","setContent$1","contentArgs","createContextualFragment","deleteFromCallbackMap","newCallbacks","SelectorChanged","selectorChangedData","currentSelectors","selectorChangedWithUnbind","matchedSelectors","isNativeIeSelection","isAttachedToDom","isValidRange","EditorSelection","selectedRange","explicitRange","getRng$1","getEnd$1","bookmarkManager","compareEndPoints","tryCompareBoundaryPoints","how","sourceRange","destinationRange","compareBoundaryPoints","anchorNode","START_TO_START","END_TO_END","ieRange","removeAllRanges","addRange","setBaseAndExtent","focusNode","setNode","getSelectedBlocks$1","isForward","anchorRange","anchorOffset","focusRange","focusOffset","selectorChanged","getScrollContainer","scrollContainer","placeCaretAt","controlSelection","removeAttrs","addFontToSpansFilter","domParser","fontSizes","face","addStrikeToSpanFilter","addFilters","convert_fonts_to_spans","font_size_legacy_values","register$1","inline_styles","blobUriToBlob","rejectWithError","xhr_1","XMLHttpRequest","open","responseType","response","send","parseDataUri$1","uriParts","buildBlob","atob","Uint8Array","Blob","dataUriToBlob","uriToBlob","blobToDataUri","blob","reader","FileReader","onloadend","readAsDataURL","imageToBlobInfo","blobCache","base64","blobInfo","getByUri","image","dataUri","getByData","getAllImages","ImageScanner","uploadStatus","cachedPromises","images","isUploaded","promises","imageInfo","newPromise","paddEmptyNode","brPreferred","padd_empty_with_br","isPaddedWithNbsp","hasOnlyChild","isPadded","isEmpty$2","whitespaceElements","isLineBreakNode","isBogusImage","isInternalImageSource","isValidDataImg","images_dataimg_filter","imgElem_1","Image","registerBase64ImageFilter","blob_cache","processImage","inputSrc","blobUri","addAttributeFilter","register$2","remove_trailing_brs","prevName","whiteSpaceElements","appendRel","addNoOpener","newRel","allow_unsafe_link_target","allow_html_in_named_anchor","fix_list_elements","classValue","validClassesMap","makeMap$4","each$d","explode$2","extend$2","DomParser","matchedNodes","matchedAttributes","root_name","fixInvalidChildren","newParent","currentNode","tempNode","nonSplitableElements","textBlockElements","fixed","filterNode","list","fi","fl","invalidChildren","isInWhiteSpacePreservedElement","getRootBlockName","rootBlockName","startWhiteSpaceRegExp","endWhiteSpaceRegExp","allWhiteSpaceRegExp","isAllWhiteSpaceRegExp","addRootBlocks","rootBlockNode","createNode","removeWhitespaceBefore","textNodeNext","textVal","cloneAndExcludeBlocks","attrFiltersLen","register$3","htmlParser","internalName","hasChildren","trimTrailingBr","brNode1","brNode2","preProcess","oldDoc","impl","shouldFireEvent","hasEventListeners","addTempAttr","postProcess$1","outArgs","getHtmlFromNode","parseHtml","serializeNode","htmlSerializer","toHtml","DomSerializerImpl","addRules","rules","setRules","DomSerializer","domSerializer","defaultFormat$1","getContent$2","setContent$2","DOM$3","restoreOriginalStyles","orgDisplay","safeDestroy","clearDomReferences","contentAreaContainer","formElement","editorContainer","bodyElement","restoreForm","form","_mceOldSubmit","submit","formEventDelegate","remove$7","editorUpload","save","is_removing","unbindAllNativeEvents","automatic","destroyed","_beforeUnload","theme","hasOwnProperty$2","deep$1","bothObjects","deepMerge","baseMerge","merger","objects","curObject","sectionResult","sections","deviceDetection","legacyMobilePlugins","defaultTouchSettings","table_grid","object_resizing","resize","normalizePlugins","pluginNames","trimmedPlugins","filterLegacyMobilePlugins","extractSections","getSection","sectionSettings","hasSection","isSectionTheme","section","getSectionConfig","getToolbarMode","getDefaultSettings","documentBaseUrl","baseDefaults","toolbar_mode","document_base_url","add_form_submit_trigger","submit_patch","add_unload_trigger","convert_urls","relative_urls","remove_script_host","visual","hidden_input","convertURL","getDefaultMobileSettings","mobileSettings","defaultMobileSettings","toolbar_sticky","defaultPhoneSettings","menubar","getExternalPlugins$1","overrideSettings","userDefinedExternalPlugins","external_plugins","combinePlugins","forcedPlugins","getPlatformPlugins","isMobileDevice","desktopPlugins","mobilePlugins","processPlugins","defaultOverrideSettings","forced_plugins","mobileConfig","platformPlugins","combinedPlugins","isOnMobile","combineSettings","defaultSettings","defaultDeviceSettings","mobile","extendedSettings","getEditorSettings","getFiltered","getParamObject","isArrayOf","CreateIconManager","iconPack","icons","IconManager","getProp","propName","getComputedSizeProp","getClientWidth","getClientHeight","getMarginTop","getMarginLeft","getBoundingClientRect$1","isInsideElementContentArea","bodyElm","transpose","isXYInContentArea","transposedPoint","fromDomSafe","isEditorAttachedToDom","rawContainer","getContentAreaContainer","NotificationManagerImpl","unimplemented","getArgs","NotificationManager","notifications","getImplementation","getNotificationManagerImpl","getTopNotification","progressBar","addNotification","notification","closeNotification","otherNotification","spec","fireEvent","getEl","getNotifications","serviceMessage","WindowManagerImpl","openUrl","alert","confirm","getParams","setParams","WindowManager","dialogs","getWindowManagerImpl","funcBind","fireOpenEvent","dialog","fireCloseEvent","addDialog","closeDialog","otherDialog","getTopDialog","storeSelectionAndOpenDialog","openDialog","windowManagerImpl","displayNotification","notificationManager","displayError","_skinLoaded","uploadError","logError","createLoadError","pluginLoadError","iconsLoadError","languageLoadError","pluginInitError","initError","isContentCssSkinName","getContentCssUrls","transformToUrls","getFontCssUrls","cssLinks","skinUrl","contentCssFile","documentBaseURI","toAbsolute","appendContentCssFromSettings","contentCSS","UploadStatus","PENDING","UPLOADED","blobUriStatuses","createStatus","resultUri","hasBlobUri","getResultUri","isPending","markPending","markUploaded","removeFailed","count$1","rnd","uuid","BlobCache","mimeToExt","mime","mimes","filename","toBlobInfo","findFirst","cachedBlobInfo","removeByUri","revokeObjectURL","Uploader","pendingPromises","pathJoin","path1","path2","defaultHandler","progress","xhr","withCredentials","credentials","upload","onprogress","loaded","total","json","JSON","responseText","basePath","formData","FormData","noUpload","handlerSuccess","handlerFailure","options","resolvePending","uploadBlobInfo","openNotification","closeNotification_1","failureOptions","percent","isDefaultHandler","pendingUploadBlobInfo","uploadBlobs","blobInfos","createUploader","ImageUploader","uploader","showNotification","UploadChangeHandler","lastChangedLevel","fireIfChanged","EditorUpload","imageScanner","urlFilters","changeHandler","aliveGuard","cacheInvalidator","replaceString","replaceImageUrl","targetUrl","replacementUrl","replacementString","replaceUrlInUndoStack","replaceImageUriInView","uploadImages","scanForImages","imageInfos","imagesToRemove","filteredResult","uploadInfo","uploadUri","uploadImagesAuto","isValidDataUriImage","imgElm","dataImgFilter","addFilter","resultItem","replaceBlobUris","source_view","get$a","valigntop","verticalAlign","valignmiddle","valignbottom","alignleft","preview","textAlign","aligncenter","marginLeft","marginRight","alignright","alignjustify","bold","fontWeight","italic","fontStyle","underline","strikethrough","forecolor","hilitecolor","fontname","fontFamily","fontsize","fontSize","lineheight","lineHeight","fontsize_class","blockquote","subscript","superscript","_fmt","_itemName","removeformat","FormatRegistry","unregister","each$e","parsedSelectorToHtml","ancestry","sItem","getRequiredParent","elmRule","wrapInHtml","parentCandidate","ancestorName","parentRequired","siblingElm","parseSelectorItem","$0","$3","$4","parseSelector","getCssText","previewFrag","previewCss","parentFontSize","previewStyles","removeVars","previewOpt","previewElm","numValue","setup$6","addShortcut","Formatter","formatChangeState","registerEvents$1","isFirstTypedCharacter","addNonTypingUndoLevel","cmd","command","isDirty","modKey","isInsertReplacementText","inputType","isInsertTextDataNull","isInsertFromPasteOrDrop","addKeyboardShortcuts","UndoManager","nonTypingKeycodes","placeholderAttr","isKeyboardEvent","isDeleteEvent","isNonTypingKeyboardEvent","isTypingKeyboardEvent","isVisuallyEmpty","isForcedRootBlockFalse","setup$7","placeholder","updatePlaceholder","showPlaceholder","isPlaceholderShown","strongRtl","hasStrongRtl","isInlineTarget","isRtl$1","findInlineParents","findRootInline","hasSameParentBlock","block1","block2","isAtZwsp","normalizePosition","normalizeForwards","normalizeBackwards","isBeforeRoot","getParentBlock$1","placeCaretInEmptyBody","paddEmptyBody","willDeleteLastPositionInElement","normalizedFirstPos","normalizedLastPos","normalizedFromPos","nextPos","prevPos","blockPosition","blockBoundary","getBlockPosition","containerElm","isDifferentBlocks","hasSameParent","parent1","parent2","isEditable","skipLastBr","lastPositionInBlock","readFromRange","fromBlockPos","toBlockPos","blockPos","read$3","getChildrenUntilBlockBoundary","extractChildren","removeEmptyRoot","isEmptyBefore","nestedBlockMerge","toBlock","insertionPoint","sidelongBlockMerge","findInsertionPoint","parentsAndSelf$1","getInsertionPoint","trimBr","mergeBlockInto","mergeBlocks","backspaceDelete$1","deleteRangeMergeBlocks","isRawNodeInTable","isSelectionInTable","isEverythingSelected","noPrevious","noNext","emptyEditor","deleteRange$1","backspaceDelete$2","_forward","isContentEditableTrue$2","isContentEditableFalse$7","showCaret","getNodeRange","renderCaretAtRange","caretPositionNode","caretPositionBeforeNode","ceRoot","renderRangeCaret","isBeforeBoundary","isAfterBoundary","trimEmptyTextNode$1","deleteContentAndShowCaret","peekCaretPosition","caretRange","deleteBoundaryText","getNextPosFn","isBeforeFn","nextCaretPosition","backspaceDelete$3","isCompoundElement","DeleteAction","moveToElement","moveToPosition","isAtContentEditableBlockCaret","caretLocation","isDeleteFromCefDifferentBlocks","deleteEmptyBlockOrMoveToCef","toCefElm","blockElm","findCefPosition","getContentEditableBlockAction","skipMoveToActionFromInlineCefToContent","getContentEditableAction","read$4","deleteElement$1","hideFakeCaret","getAncestorCe","backspaceDeleteCaret","selectedNode","deleteOffscreenSelection","backspaceDeleteRange","hasCefAncestor","paddEmptyElement","backspaceDelete$4","deleteCaret$1","backspaceDelete$5","isText$8","startsWithCaretContainer$1","endsWithCaretContainer$1","createZwsp","insertBefore$1","insertAfter$1","insertInline$1","insertInlineBefore","insertInlineAfter","insertInlinePos","isPosCaretContainer","caretNode","renderCaret","evaluateUntil","fns","Location","rescope","before$4","nPos","isNotInsideFormatCaretContainer","findInsideRootInline","after$3","isValidLocation","readLocation","getName","outside","inside","isEq$5","location1","location2","betweenInlines","fromInline","toInline","skipNoMovement","fromLocation","toLocation","findLocationTraverse","findLocationSimple","findLocation","prevLocation","nextLocation","hasSelectionModifyApi","modify","moveRel","moveByWord","setCaretPosition","setSelected","renderCaretLocation","findLocation$1","isInlineTarget$1","toggleInlines","inlineBoundaries","selectedInlines","targetInlines","safeRemoveCaretContainer","renderInsideInlineCaret","inlines","_inline","move","moveWord","_caret","setupSelectedState","moveNextWord","movePrevWord","rangeFromPositions","hasOnlyTwoOrLessPositionsLeft","setCaretLocation","deleteFromTo","rescope$1","backspaceDeleteCollapsed","toPosition","backspaceDelete$6","getParentInlines","hasOnlyOneChild$1","deleteLastPosition","parentInlines","isFormatElement$1","deleteCaret$2","backspaceDelete$7","deleteElement$2","deleteCaret$3","isNearMedia","deleteRange$2","backspaceDelete$8","isEditable$1","parseIndentValue","number","getIndentStyleName","useMargin","indentStyleName","indentElement","unit","styleValue","validateBlocks","intentValue","canOutdent","getBlocksToIndent","isListComponent","parentIsListComponent","indentation","indentUnit","indentValue","queryCommandState","backspaceDelete$9","nativeCommand","deleteCommand","forwardDeleteCommand","setup$8","addCommand","SIGNIFICANT_MOVE","LONGPRESS_DELAY","getTouch","isFarEnough","distX","distY","setup$9","startData","longpressFired","debounceLongpress","isEqualNode","isBlockElement","isValidTarget","hasBlockParent","shouldRemoveTextNode","rootNodeName","restoreSelection","setup$a","findBlockCaretContainer","removeIeControlRect","blockCaretContainer","handleBlockContainer","setup$b","BreakType","flip","positions","walk$3","getBreakType","currentPos","Br","Block","Wrap","getPositionsUntil","breakType","breakAt","Eol","getAdjacentLinePositions","getPositionsUntilBreak","findClosestHorizontalPositionFromPoint","lastRect","newRect","lastDist","newDist","findClosestHorizontalPosition","targetRect","getPositionsUntilPreviousLine","getPositionsUntilNextLine","isAtFirstLine","isAtLastLine","getPositionsAbove","getPositionsBelow","getFirstLinePositions","getLastLinePositions","getNodeClientRects","toArrayWithNode","VDirection","findUntil$1","walkUntil","isAboveFn","isBeflowFn","line","targetClientRect","aboveLineNumber","lineNumber","isLineNumber","upUntil","Up","downUntil","Down","positionsUntil","isBelowFn","getClientRect","isAboveLine","isLine","isContentEditableFalse$8","findNode$1","distanceToRectLeft","distanceToRectRight","isInsideX","isInsideY","findClosestClientRect","oldClientRect","oldDistance","newDistance","walkUntil$1","includeChildren","findLineNodeRects","targetNodeRect","checkPosFn","lineRects","getFakeCaretTargets","caretInfo","closestFakeCaret","fakeTargetNodeRects","targetNodeRects","closestNodeRect","moveToRange","renderRangeCaretOpt","moveHorizontally","isBefore","isAfter","rangeIsInContainerBlock","moveVertically","caretClientRect","walkerFn","linePositions","nextLinePositions","nextLineRect","dist1","dist2","caretPositions","closestNextLineRect","getLineEndPoint","moveToLineEndPoint","isContentEditableFalse$9","moveToCeFalseHorizontally","moveToCeFalseVertically","createTextBlock","textBlock","exitPreBlock","getVisualCaretPosition$1","newBlock","getHorizontalRange","getVerticalRange","down","moveH","newRange","moveV","moveToLineEndPoint$1","isCefPosition","isTarget","rangeBefore","insertElement","insertBr","insertBlock$1","insertEmptyLine","getClosestTargetBlock","isAtFirstOrLastLine","moveCaretToNewEmptyLine","rootBlockAttrs","moveV$1","defaultPatterns","patterns","matchesEvent","match$1","execute","moveH$1","moveV$2","moveToLineEndPoint$2","deflate","getCorners","getYAxisValue","tds","findClosestCorner","corners","newCorner","oldCorner","oldDist","sqrt","getClosestCell$1","isTargetCorner","corner","getBottomValue","getTopValue","isAbove$1","isBelow$1","getClosestCellAbove","getClosestCellBelow","findClosestPositionInAboveCell","findClosestPositionInBelowCell","hasNextBreak","lineInfo","breakPos","startsWithWrapBreak","startsWithBrBreak","isAtTableCellLine","isAtFirstTableCellLine","isAtLastTableCellLine","isCaretAtStartOrEndOfTable","navigateHorizontally","_td","getClosestAbovePosition","getClosestBelowPosition","getTable","renderBlock","navigateVertically","move$1","mover","moveH$2","moveV$3","executeKeydownOverride","setup$c","executeKeydownOverride$1","executeKeyupOverride","setup$d","firstNonWhiteSpaceNodeSibling","moveToCaretPosition","getEditableRoot","editableRoot","getParentBlock$2","getParentBlockName","isListItemParentBlock","hasFirstChild","isFirstChild","hasParent$1","isListBlock","isNestedList","getContainerBlock","containerBlock","containerBlockParent","isFirstOrLastLi","createNewBlock","newBlockName","tmpRng","trimZwsp","isEmptyAnchor","isTableCell$5","emptyBlock","containerAndSiblingName","canSplitBlock","trimInlineElementsOnLeftSideOfBlock","firstChilds","normalizeZwspOffset","includeZwspInRange","trimLeadingLineBreaks","getEditableRoot$1","applyAttributes","forcedRootBlockAttrs","attrStyles","currentStyles","newStyles","attrClassesOpt","attrClasses","currentClassesOpt","currentClasses","filteredClasses","newClasses","appliedAttrs","remainingAttrs","setForcedBlockAttrs","wrapSelfAndSiblingsInDefaultBlock","addBrToBlockIfNeeded","insert$1","parentBlockName","isAfterLastNodeInContainer","clonedNode","isCaretAtStartOrEndOfBlock","normalizedOffset","insertNewBlockAfter","containerBlockName","hasRightSideContent","moveSelectionToBr","brElm","extraBr","insertBrAtCaret","isControlKey","insertBrBefore","insertBrAfter","hasBrAfter","isBeforeBr$1","isAnchorLink","isInsideAnchor","readInlineAnchorLocation","insertBrOutsideAnchor","insert$2","anchorLocation","shouldInsertBr","shouldBlockNewLine","newLineAction","shouldBlockNewLine$1","_shiftKey","isBrMode","requiredState","brMode","inListBlock","inBlock","inPreBlock","inSummaryBlock","shouldPutBrInPre$1","inBrContext","hasShiftKey","_editor","canInsertIntoEditableRoot","rootEditable","match$2","predicates","isMatch","getAction$1","insert$3","handleEnterKeyEvent","setup$e","executeKeydownOverride$2","setup$f","browser$4","setupIeInput","keypressThrotter","setup$g","isComposing","insertTextAtPosition","insertNbspAtPosition","insertSpaceAtPosition","locationToCaretPosition","insertInlineBoundarySpaceOrNbsp","checkPos","setSelection$1","insertSpaceOrNbspAtSelection","executeKeydownOverride$3","setup$h","registerKeyboardOverrides","setup$i","NodeChange","lastPath","lastRng","nativeRng","fakeRng","isSameElementPath","initialized","currentPath","preventSummaryToggle","filterDetails","setup$j","isTextBlockNode","normalizeSelection$1","setup$k","detail","value$1","isSet","getAbsolutePosition","getBodyPosition","getScrollPosition","getBodyScroll","inlineScroll","iframeScroll","getMousePosition","iframePosition","scrollPosition","calculatePosition","bodyPosition","mousePosition","calc","isContentEditableFalse$a","isContentEditableTrue$3","isDraggable","isValidDropTarget","targetElement","dragElement","cloneElement","cloneElm","createGhost","clonedElm","opacity","overflow","padding","boxSizing","appendGhostToBody","moveGhost","maxX","maxY","overflowX","removeElement","isLeftMouseButtonPressed","applyRelPos","relX","start$1","ceElm","elmPos","dragging","relY","ghost","move$2","throttledPlaceCaretAt","movement","targetPos","getRawTarget","drop","targetClone_1","removeDragState","bindFakeDragEvents","pageDom","dragStartHandler","dragHandler","dropHandler","dragEndHandler","blockIeDrop","realTarget","blockUnsupportedFileDrop","preventFileDrop","dataTransfer","types","preventFileDropIfUIElement","editorRoot","eventNames","setup$l","renderFocusCaret","setup$m","isContentEditableTrue$4","isContentEditableFalse$b","getContentEditableRoot$1","SelectionOverrides","fakeCaret","realSelectionId","selectedElement","isFakeSelectionElement","isFakeSelectionTargetElement","isNearFakeSelectionElement","getRealSelectionElement","setRange","getRange","contentEditableRoot","removeElementSelection","hasNormalCaretPosition","hasBetterMouseTarget","targetBlock","setElementSelection","fakeCaretInfo","normalizeShortEndedElementSelection","isPasteBin","isRangeInCaretContainer","clipboardData","realSelectionElement","clearData","setData","outerText","isWithinCaretContainer","setupOffscreenSelection","targetClone","origTargetClone","$realSelectionContainer","selectElement","nodeElm","afterNode","Quirks","isGecko","isWebKit","mceInternalUrlPrefix","mceInternalDataType","setEditorCommandState","setMceInternalContent","selectionHtml","internalContent","escape","getMceInternalContent","insertClipboardContents","internal","queryCommandSupported","emptyEditorWhenDeleting","serializeRng","allContentsSelected","allRng","allSelection","selectAll","shortcuts","inputMethodFocus","removeHrOnBackspace","Range","body_1","blur","selectControlElements","removeStylesWhenDeletingAcrossBlockElements","getAttributeApplyFunction","template","setAttributeNode","isSelectionAcrossElements","disableBackspaceIntoATable","removeBlockQuoteOnBackSpace","setGeckoEditingOptions","setOpts","addBrAfterLastLinks","fixLinks","setDefaultBlockType","showBrokenImageIcon","contentStyles","restoreFocusOnKeyDown","bodyHeight","blockCmdArrowNavigation","selection_1","disableAutoUrlDetect","tapLinksAndImages","blockFormSubmitInsideEditor","removeAppleInterchangeBrs","ieInternalDragAndDrop","DOM$4","appendStyle","getRootName","removeUndefined","mkParserSettings","mkSerializerSettings","boolean_attributes","move_caret_before_on_enter_elements","non_empty_elements","short_ended_elements","text_inline_elements","whitespace_elements","createParser","autoFocus","auto_focus","moveSelectionToFirstCaretPosition","initEditor","bindPendingEventDelegates","execCallback","getStyleSheetLoader","ui","makeStylesheetLoadingPromises","framedFonts","loadContentCss","removeCss","preInit","rtcMode","browser_spellcheck","gecko_spellcheck","spellcheck","directionality","protect","startContent","contentCssText_1","content_style","initContentBody","skipWrite","visibility","orgVisibility","iframeHTML","hex_colors","force_hex_style_colors","annotator","_nodeChangeDispatcher","loadingRtc","setProgressState","DOM$5","relaxDomain","ifr","domain","hostname","bodyUuid","domainRelaxUrl","createIframeElement","customAttrs","iframe","frameBorder","allowTransparency","getIframeHtml","getURI","bodyId","bodyClass","createIframe","isDomainRelaxed","iframeContainer","init$1","boxInfo","hidden","DOM$6","initPlugin","initializedPlugins","plugin","Plugin","pluginInstance","trimLegacyPrefix","initPlugins","initIcons","iconPackName","currentIcons","loadIcons","svgData","icon","addIcon","initTheme","Theme","renderFromLoadedTheme","renderUI","renderFromThemeFunc","iframeHeight","createThemeFalseResult","renderThemeFalseIframe","renderThemeFalse","renderThemeUi","augmentEditorUiApi","uiApiFacade","disable","isDisabled","enable","init$2","renderInfo","DOM$7","hasSkipLoadPrefix","loadLanguage","scriptLoader","languageCode","languageUrl","url_1","loadTheme","themeUrl","getIconsUrlMetaFromUrl","getIconsUrlMetaFromName","defaultIconsUrl","customIconsUrl","urlMeta","loadPlugins","depPlugin","url_2","getStyleSheetLoader$1","render","snapshot","resetContent","triggerSave","windowManager","set_dirty","addVisual$1","legacyPropNames","getSpecifiedFontProp","getProperty","legacyPropName","normalizeFontFamily","getComputedFontProp","getFontProp","getFontSize","getFontFamily","findFirstCaretElement","getCaretElement","atStartOfNode","mapRange","mapper","fromFontSizeNumber","fontSizeNumber","fontClasses","normalizeFontNames","font","fonts","fontNameAction","fontNameQuery","fontSizeAction","fontSizeQuery","lineHeightQuery","specifiedStyle","computedStyle","lineHeightAction","processValue","insertAtCaret$1","each$f","map$3","inArray$2","EditorCommands","commands","setupCommands","skip_focus","customCommand","queryCommandValue","addCommands","commandList","addQueryStateHandler","addQueryValueHandler","hasCustomCommand","execNativeCommand","isFormatMatch","storeSelection","selectionBookmark","queryCommandEnabled","listParent","anchor","editingHost","selectNodeContents","alignStates","Undo","Redo","internalContentEditableAttr","setContentEditable","switchOffContentEditableTrue","switchOnContentEditableTrue","removeFakeSelection","restoreFakeSelection","toggleReadOnly","isReadOnly$1","registerFilters","registerReadOnlyContentFilters","isClickEvent","getAnchorHrefOpt","processReadonlyEvents","targetEl","registerReadOnlySelectionBlockers","nativeEvents","EventDispatcher","bindings","toggleEvent","isNative","nameIn","argsIn","beforeFire","wrappedCallback","currentName","bindingName","hi","getEventDispatcher","_eventDispatcher","toggleNativeEvent","Observable","bubble","dispatcherArgs","DOM$8","customEventRootDelegates","getEventTarget","eventName","eventRoot","isListening","bindEventDelegate","delegate","delegates","eventRootElm","editors","EditorObservable","_pendingNativeEvents","defaultModes","switchToMode","activeMode","availableModes","oldMode","newMode","activate","deactivate","editorReadOnly","setMode","registerMode","create$5","design","each$g","explode$3","keyCodeLookup","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","modifierNames","parseShortcut","shortcut","charCode","access","alt","ctrl","meta","Shortcuts","pendingPatterns","hasModifier","isFunctionKey","matchShortcut","subpatterns","executeShortcutAction","desc","cmdFunc","normalizeCommandFunc","createShortcut","create$6","buttons","menuItems","popups","contextMenus","contextToolbars","sidebars","addButton","addGroupToolbarButton","addToggleButton","addMenuButton","addSplitButton","addMenuItem","addNestedMenuItem","addToggleMenuItem","addAutocompleter","addContextMenu","addContextToolbar","addContextForm","addSidebar","bridge","each$h","trim$4","queryParts","DEFAULT_PORTS","ftp","http","https","mailto","URI","baseUri","base_uri","source","isProtocolRelative","protocol","toAbsPath","urlMatch","part","userInfo","port","uriComponents","pathname","setPath","pathMatch","file","toRelative","relativeUri","tu","uu","toRelPath","noHost","absoluteUri","isSameOrigin","defaultPort","breakPoint","normalizedBase","nb","outPath","normalizedPath","noProtoHost","DOM$9","extend$3","each$i","resolve$3","ie$1","Editor","loadedCSS","isNotDirty","documentBaseURL","base_url","_setBaseUrl","baseURI","referrer_policy","language_load","editorCommands","cache_suffix","modeInstance","callbackLookup","hasPlugin","initialContent","oldState","urlconverter_callback","_scanForImages","DOM$a","explode$4","each$j","extend$4","instanceCounter","boundGlobalEvents","beforeUnloadDelegate","legacyEditors","isValidLegacyKey","globalEventDelegate","EditorManager","toggleGlobalEvents","removeEditorFromList","targetEditor","oldEditors","purgeDestroyedEditor","isQuirksMode","compatMode","majorVersion","minorVersion","releaseDate","i18n","tinymce","tinyMCEPreInit","srcScript","currentScript","pluginBaseUrls","plugin_base_urls","pluginBaseUrl","invalidInlineTargets","isInvalidInlineTarget","createId","findTargets","forms","editor_deselector","editor_selector","provideResults","initEditors","initCount","createEditor","existingEditor","addI18n","round$1","relativePosition","targetW","targetH","relChars","create$7","findBestRelativePosition","constrainRect","rels","inflate","intersect","cropRect","x1","y1","clamp$1","clampRect","fixedSize","cx2","cy2","underflowX1","underflowY1","overflowX2","overflowY2","fromClientRect","Rect","awaiter","resolveCb","rejectCb","complete","completer","create$8","tasks","resultFns","loadErrMsg","runErrMsg","task","waiter","Resource","each$k","extend$5","extendClass","initializing","Class","_super","mixins","mixin","Mixins","dummy","createMethod","Methods","Properties","fieldName","Statics","Defaults","member","min$1","max$1","round$2","Color","rgb2hsv","minRGB","maxRGB","hsvToRgb","hue","saturation","brightness","side","chroma","toRgb","toHsv","stringify","hexCode","JSONUtils","JSONP","XHR","ready","async","success_scope","error_scope","overrideMimeType","content_type","crossDomain","setRequestHeader","requestheaders","extend$6","JSONRequest","sendRPC","ecb","scb","xhrArgs","method","create$9","storage","getItem","setItem","removeItem","defineProperty","configurable","enumerable","localStorage","LocalStorage","publicApi","geom","util","TreeWalker","Serializer","Selection","isMac","exportToModuleLoaders","exportToWindowGlobal","tinyMCE"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACC,aAAY;AACT;;AAEA,MAAIA,MAAM,GAAG,UAAUC,CAAV,EAAa;AACxB,QAAIA,CAAC,KAAK,IAAV,EAAgB;AACd,aAAO,MAAP;AACD;;AACD,QAAIA,CAAC,KAAKC,SAAV,EAAqB;AACnB,aAAO,WAAP;AACD;;AACD,QAAIC,CAAC,GAAG,OAAOF,CAAf;;AACA,QAAIE,CAAC,KAAK,QAAN,KAAmBC,KAAK,CAACC,SAAN,CAAgBC,aAAhB,CAA8BL,CAA9B,KAAoCA,CAAC,CAACM,WAAF,IAAiBN,CAAC,CAACM,WAAF,CAAcC,IAAd,KAAuB,OAA/F,CAAJ,EAA6G;AAC3G,aAAO,OAAP;AACD;;AACD,QAAIL,CAAC,KAAK,QAAN,KAAmBM,MAAM,CAACJ,SAAP,CAAiBC,aAAjB,CAA+BL,CAA/B,KAAqCA,CAAC,CAACM,WAAF,IAAiBN,CAAC,CAACM,WAAF,CAAcC,IAAd,KAAuB,QAAhG,CAAJ,EAA+G;AAC7G,aAAO,QAAP;AACD;;AACD,WAAOL,CAAP;AACD,GAfD;;AAgBA,MAAIO,eAAe,GAAG,UAAUT,CAAV,EAAa;AACjC,WAAO,CACL,WADK,EAEL,SAFK,EAGL,QAHK,EAIL,QAJK,EAKL,UALK,EAML,KANK,EAOL,MAPK,EAQLU,OARK,CAQGV,CARH,MAQU,CAAC,CARlB;AASD,GAVD;;AAYA,MAAIW,IAAI,GAAG,UAAUC,EAAV,EAAcC,SAAd,EAAyB;AAClC,QAAIC,KAAK,GAAGX,KAAK,CAACC,SAAN,CAAgBW,KAAhB,CAAsBC,IAAtB,CAA2BJ,EAA3B,CAAZ;AACA,WAAOE,KAAK,CAACH,IAAN,CAAWE,SAAX,CAAP;AACD,GAHD;;AAKA,MAAII,SAAS,GAAG,UAAUC,GAAV,EAAeC,CAAf,EAAkB;AAChC,WAAOC,EAAE,CAAC,UAAUpB,CAAV,EAAaqB,CAAb,EAAgB;AACxB,aAAOH,GAAG,CAACE,EAAJ,CAAOD,CAAC,CAACnB,CAAD,CAAR,EAAamB,CAAC,CAACE,CAAD,CAAd,CAAP;AACD,KAFQ,CAAT;AAGD,GAJD;;AAKA,MAAID,EAAE,GAAG,UAAUD,CAAV,EAAa;AACpB,WAAO;AAAEC,MAAAA,EAAE,EAAED;AAAN,KAAP;AACD,GAFD;;AAGA,MAAIG,QAAQ,GAAGF,EAAE,CAAC,UAAUpB,CAAV,EAAaqB,CAAb,EAAgB;AAChC,WAAOrB,CAAC,KAAKqB,CAAb;AACD,GAFgB,CAAjB;AAGA,MAAIE,QAAQ,GAAGD,QAAf;;AACA,MAAIE,OAAO,GAAG,UAAUN,GAAV,EAAe;AAC3B,WAAOE,EAAE,CAAC,UAAUpB,CAAV,EAAaqB,CAAb,EAAgB;AACxB,UAAIrB,CAAC,CAACyB,MAAF,KAAaJ,CAAC,CAACI,MAAnB,EAA2B;AACzB,eAAO,KAAP;AACD;;AACD,UAAIC,GAAG,GAAG1B,CAAC,CAACyB,MAAZ;;AACA,WAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,GAApB,EAAyBC,CAAC,EAA1B,EAA8B;AAC5B,YAAI,CAACT,GAAG,CAACE,EAAJ,CAAOpB,CAAC,CAAC2B,CAAD,CAAR,EAAaN,CAAC,CAACM,CAAD,CAAd,CAAL,EAAyB;AACvB,iBAAO,KAAP;AACD;AACF;;AACD,aAAO,IAAP;AACD,KAXQ,CAAT;AAYD,GAbD;;AAcA,MAAIC,aAAa,GAAG,UAAUV,GAAV,EAAeL,SAAf,EAA0B;AAC5C,WAAOI,SAAS,CAACO,OAAO,CAACN,GAAD,CAAR,EAAe,UAAUN,EAAV,EAAc;AAC3C,aAAOD,IAAI,CAACC,EAAD,EAAKC,SAAL,CAAX;AACD,KAFe,CAAhB;AAGD,GAJD;;AAKA,MAAIgB,QAAQ,GAAG,UAAUX,GAAV,EAAe;AAC5B,WAAOE,EAAE,CAAC,UAAUpB,CAAV,EAAaqB,CAAb,EAAgB;AACxB,UAAIS,EAAE,GAAGC,MAAM,CAACC,IAAP,CAAYhC,CAAZ,CAAT;AACA,UAAIiC,EAAE,GAAGF,MAAM,CAACC,IAAP,CAAYX,CAAZ,CAAT;;AACA,UAAI,CAACO,aAAa,CAACL,QAAD,CAAb,CAAwBH,EAAxB,CAA2BU,EAA3B,EAA+BG,EAA/B,CAAL,EAAyC;AACvC,eAAO,KAAP;AACD;;AACD,UAAIP,GAAG,GAAGI,EAAE,CAACL,MAAb;;AACA,WAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,GAApB,EAAyBC,CAAC,EAA1B,EAA8B;AAC5B,YAAIO,CAAC,GAAGJ,EAAE,CAACH,CAAD,CAAV;;AACA,YAAI,CAACT,GAAG,CAACE,EAAJ,CAAOpB,CAAC,CAACkC,CAAD,CAAR,EAAab,CAAC,CAACa,CAAD,CAAd,CAAL,EAAyB;AACvB,iBAAO,KAAP;AACD;AACF;;AACD,aAAO,IAAP;AACD,KAdQ,CAAT;AAeD,GAhBD;;AAiBA,MAAIC,KAAK,GAAGf,EAAE,CAAC,UAAUpB,CAAV,EAAaqB,CAAb,EAAgB;AAC7B,QAAIrB,CAAC,KAAKqB,CAAV,EAAa;AACX,aAAO,IAAP;AACD;;AACD,QAAIe,EAAE,GAAGrC,MAAM,CAACC,CAAD,CAAf;AACA,QAAIqC,EAAE,GAAGtC,MAAM,CAACsB,CAAD,CAAf;;AACA,QAAIe,EAAE,KAAKC,EAAX,EAAe;AACb,aAAO,KAAP;AACD;;AACD,QAAI5B,eAAe,CAAC2B,EAAD,CAAnB,EAAyB;AACvB,aAAOpC,CAAC,KAAKqB,CAAb;AACD,KAFD,MAEO,IAAIe,EAAE,KAAK,OAAX,EAAoB;AACzB,aAAOZ,OAAO,CAACW,KAAD,CAAP,CAAef,EAAf,CAAkBpB,CAAlB,EAAqBqB,CAArB,CAAP;AACD,KAFM,MAEA,IAAIe,EAAE,KAAK,QAAX,EAAqB;AAC1B,aAAOP,QAAQ,CAACM,KAAD,CAAR,CAAgBf,EAAhB,CAAmBpB,CAAnB,EAAsBqB,CAAtB,CAAP;AACD;;AACD,WAAO,KAAP;AACD,GAjBa,CAAd;;AAmBA,MAAIiB,IAAI,GAAG,YAAY,CACtB,CADD;;AAEA,MAAIC,OAAO,GAAG,UAAUC,EAAV,EAAcC,EAAd,EAAkB;AAC9B,WAAO,YAAY;AACjB,UAAIC,IAAI,GAAG,EAAX;;AACA,WAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CD,QAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWC,SAAS,CAACD,EAAD,CAApB;AACD;;AACD,aAAOH,EAAE,CAACC,EAAE,CAACI,KAAH,CAAS,IAAT,EAAeH,IAAf,CAAD,CAAT;AACD,KAND;AAOD,GARD;;AASA,MAAII,QAAQ,GAAG,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACjC,WAAO,UAAUC,CAAV,EAAa;AAClB,aAAOF,GAAG,CAACC,GAAG,CAACC,CAAD,CAAJ,CAAV;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIC,QAAQ,GAAG,UAAUC,KAAV,EAAiB;AAC9B,WAAO,YAAY;AACjB,aAAOA,KAAP;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIC,QAAQ,GAAG,UAAUpD,CAAV,EAAa;AAC1B,WAAOA,CAAP;AACD,GAFD;;AAGA,WAASqD,KAAT,CAAeC,EAAf,EAAmB;AACjB,QAAIC,WAAW,GAAG,EAAlB;;AACA,SAAK,IAAIZ,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CY,MAAAA,WAAW,CAACZ,EAAE,GAAG,CAAN,CAAX,GAAsBC,SAAS,CAACD,EAAD,CAA/B;AACD;;AACD,WAAO,YAAY;AACjB,UAAIa,QAAQ,GAAG,EAAf;;AACA,WAAK,IAAIb,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5Ca,QAAAA,QAAQ,CAACb,EAAD,CAAR,GAAeC,SAAS,CAACD,EAAD,CAAxB;AACD;;AACD,UAAIc,GAAG,GAAGF,WAAW,CAACG,MAAZ,CAAmBF,QAAnB,CAAV;AACA,aAAOF,EAAE,CAACT,KAAH,CAAS,IAAT,EAAeY,GAAf,CAAP;AACD,KAPD;AAQD;;AACD,MAAIE,GAAG,GAAG,UAAUxC,CAAV,EAAa;AACrB,WAAO,UAAUjB,CAAV,EAAa;AAClB,aAAO,CAACiB,CAAC,CAACjB,CAAD,CAAT;AACD,KAFD;AAGD,GAJD;;AAKA,MAAI0D,GAAG,GAAG,UAAUC,GAAV,EAAe;AACvB,WAAO,YAAY;AACjB,YAAM,IAAIC,KAAJ,CAAUD,GAAV,CAAN;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIhB,KAAK,GAAG,UAAU1B,CAAV,EAAa;AACvB,WAAOA,CAAC,EAAR;AACD,GAFD;;AAGA,MAAIH,IAAI,GAAG,UAAUG,CAAV,EAAa;AACtBA,IAAAA,CAAC;AACF,GAFD;;AAGA,MAAI4C,KAAK,GAAGb,QAAQ,CAAC,KAAD,CAApB;AACA,MAAIc,MAAM,GAAGd,QAAQ,CAAC,IAAD,CAArB;;AAEA,MAAIe,IAAI,GAAG,YAAY;AACrB,WAAOC,IAAP;AACD,GAFD;;AAGA,MAAIA,IAAI,GAAG,YAAY;AACrB,QAAI9C,EAAE,GAAG,UAAU+C,CAAV,EAAa;AACpB,aAAOA,CAAC,CAACC,MAAF,EAAP;AACD,KAFD;;AAGA,QAAIpD,IAAI,GAAG,UAAUqD,KAAV,EAAiB;AAC1B,aAAOA,KAAK,EAAZ;AACD,KAFD;;AAGA,QAAIC,EAAE,GAAG,UAAUC,CAAV,EAAa;AACpB,aAAOA,CAAP;AACD,KAFD;;AAGA,QAAIC,EAAE,GAAG;AACPC,MAAAA,IAAI,EAAE,UAAUF,CAAV,EAAaG,EAAb,EAAiB;AACrB,eAAOH,CAAC,EAAR;AACD,OAHM;AAIPI,MAAAA,EAAE,EAAEZ,KAJG;AAKPa,MAAAA,MAAM,EAAEb,KALD;AAMPK,MAAAA,MAAM,EAAEJ,MAND;AAOPa,MAAAA,KAAK,EAAEP,EAPA;AAQPQ,MAAAA,UAAU,EAAE9D,IARL;AASP+D,MAAAA,QAAQ,EAAE,UAAUlB,GAAV,EAAe;AACvB,cAAM,IAAIC,KAAJ,CAAUD,GAAG,IAAI,iCAAjB,CAAN;AACD,OAXM;AAYPmB,MAAAA,SAAS,EAAE9B,QAAQ,CAAC,IAAD,CAZZ;AAaP+B,MAAAA,cAAc,EAAE/B,QAAQ,CAACjD,SAAD,CAbjB;AAcPiF,MAAAA,EAAE,EAAEZ,EAdG;AAePa,MAAAA,OAAO,EAAEnE,IAfF;AAgBPoE,MAAAA,GAAG,EAAEnB,IAhBE;AAiBPoB,MAAAA,IAAI,EAAE/C,IAjBC;AAkBPgD,MAAAA,IAAI,EAAErB,IAlBC;AAmBPsB,MAAAA,MAAM,EAAExB,KAnBD;AAoBPyB,MAAAA,MAAM,EAAExB,MApBD;AAqBPyB,MAAAA,MAAM,EAAExB,IArBD;AAsBPyB,MAAAA,MAAM,EAAEtE,EAtBD;AAuBPuE,MAAAA,OAAO,EAAEvE,EAvBF;AAwBPwE,MAAAA,OAAO,EAAE,YAAY;AACnB,eAAO,EAAP;AACD,OA1BM;AA2BPC,MAAAA,QAAQ,EAAE3C,QAAQ,CAAC,QAAD;AA3BX,KAAT;AA6BA,WAAOsB,EAAP;AACD,GAxCU,EAAX;;AAyCA,MAAIsB,IAAI,GAAG,UAAU7C,CAAV,EAAa;AACtB,QAAI8C,UAAU,GAAG7C,QAAQ,CAACD,CAAD,CAAzB;;AACA,QAAI+C,IAAI,GAAG,YAAY;AACrB,aAAOxB,EAAP;AACD,KAFD;;AAGA,QAAIc,IAAI,GAAG,UAAUnE,CAAV,EAAa;AACtB,aAAOA,CAAC,CAAC8B,CAAD,CAAR;AACD,KAFD;;AAGA,QAAIuB,EAAE,GAAG;AACPC,MAAAA,IAAI,EAAE,UAAUF,CAAV,EAAa0B,CAAb,EAAgB;AACpB,eAAOA,CAAC,CAAChD,CAAD,CAAR;AACD,OAHM;AAIP0B,MAAAA,EAAE,EAAE,UAAUuB,CAAV,EAAa;AACf,eAAOjD,CAAC,KAAKiD,CAAb;AACD,OANM;AAOPtB,MAAAA,MAAM,EAAEZ,MAPD;AAQPI,MAAAA,MAAM,EAAEL,KARD;AASPc,MAAAA,KAAK,EAAEkB,UATA;AAUPjB,MAAAA,UAAU,EAAEiB,UAVL;AAWPhB,MAAAA,QAAQ,EAAEgB,UAXH;AAYPf,MAAAA,SAAS,EAAEe,UAZJ;AAaPd,MAAAA,cAAc,EAAEc,UAbT;AAcPb,MAAAA,EAAE,EAAEc,IAdG;AAePb,MAAAA,OAAO,EAAEa,IAfF;AAgBPZ,MAAAA,GAAG,EAAE,UAAUjE,CAAV,EAAa;AAChB,eAAO2E,IAAI,CAAC3E,CAAC,CAAC8B,CAAD,CAAF,CAAX;AACD,OAlBM;AAmBPoC,MAAAA,IAAI,EAAE,UAAUlE,CAAV,EAAa;AACjBA,QAAAA,CAAC,CAAC8B,CAAD,CAAD;AACD,OArBM;AAsBPqC,MAAAA,IAAI,EAAEA,IAtBC;AAuBPC,MAAAA,MAAM,EAAED,IAvBD;AAwBPE,MAAAA,MAAM,EAAEF,IAxBD;AAyBPG,MAAAA,MAAM,EAAE,UAAUtE,CAAV,EAAa;AACnB,eAAOA,CAAC,CAAC8B,CAAD,CAAD,GAAOuB,EAAP,GAAYN,IAAnB;AACD,OA3BM;AA4BP0B,MAAAA,OAAO,EAAE,YAAY;AACnB,eAAO,CAAC3C,CAAD,CAAP;AACD,OA9BM;AA+BP4C,MAAAA,QAAQ,EAAE,YAAY;AACpB,eAAO,UAAU5C,CAAV,GAAc,GAArB;AACD,OAjCM;AAkCPyC,MAAAA,MAAM,EAAE,UAAUvB,CAAV,EAAa;AACnB,eAAOA,CAAC,CAACQ,EAAF,CAAK1B,CAAL,CAAP;AACD,OApCM;AAqCP0C,MAAAA,OAAO,EAAE,UAAUxB,CAAV,EAAagC,SAAb,EAAwB;AAC/B,eAAOhC,CAAC,CAACM,IAAF,CAAOV,KAAP,EAAc,UAAUqC,CAAV,EAAa;AAChC,iBAAOD,SAAS,CAAClD,CAAD,EAAImD,CAAJ,CAAhB;AACD,SAFM,CAAP;AAGD;AAzCM,KAAT;AA2CA,WAAO5B,EAAP;AACD,GApDD;;AAqDA,MAAI6B,IAAI,GAAG,UAAUlD,KAAV,EAAiB;AAC1B,WAAOA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAKlD,SAA5B,GAAwCiE,IAAxC,GAA+C4B,IAAI,CAAC3C,KAAD,CAA1D;AACD,GAFD;;AAGA,MAAImD,QAAQ,GAAG;AACbR,IAAAA,IAAI,EAAEA,IADO;AAEb7B,IAAAA,IAAI,EAAEA,IAFO;AAGboC,IAAAA,IAAI,EAAEA;AAHO,GAAf;;AAMA,MAAIE,QAAQ,GAAG,UAAUvG,CAAV,EAAa;AAC1B,QAAIE,CAAC,GAAG,OAAOF,CAAf;;AACA,QAAIA,CAAC,KAAK,IAAV,EAAgB;AACd,aAAO,MAAP;AACD,KAFD,MAEO,IAAIE,CAAC,KAAK,QAAN,KAAmBC,KAAK,CAACC,SAAN,CAAgBC,aAAhB,CAA8BL,CAA9B,KAAoCA,CAAC,CAACM,WAAF,IAAiBN,CAAC,CAACM,WAAF,CAAcC,IAAd,KAAuB,OAA/F,CAAJ,EAA6G;AAClH,aAAO,OAAP;AACD,KAFM,MAEA,IAAIL,CAAC,KAAK,QAAN,KAAmBM,MAAM,CAACJ,SAAP,CAAiBC,aAAjB,CAA+BL,CAA/B,KAAqCA,CAAC,CAACM,WAAF,IAAiBN,CAAC,CAACM,WAAF,CAAcC,IAAd,KAAuB,QAAhG,CAAJ,EAA+G;AACpH,aAAO,QAAP;AACD,KAFM,MAEA;AACL,aAAOL,CAAP;AACD;AACF,GAXD;;AAYA,MAAIsG,MAAM,GAAG,UAAUC,IAAV,EAAgB;AAC3B,WAAO,UAAUtD,KAAV,EAAiB;AACtB,aAAOoD,QAAQ,CAACpD,KAAD,CAAR,KAAoBsD,IAA3B;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIC,YAAY,GAAG,UAAUD,IAAV,EAAgB;AACjC,WAAO,UAAUtD,KAAV,EAAiB;AACtB,aAAO,OAAOA,KAAP,KAAiBsD,IAAxB;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIE,IAAI,GAAG,UAAUzG,CAAV,EAAa;AACtB,WAAO,UAAU+C,CAAV,EAAa;AAClB,aAAO/C,CAAC,KAAK+C,CAAb;AACD,KAFD;AAGD,GAJD;;AAKA,MAAI2D,QAAQ,GAAGJ,MAAM,CAAC,QAAD,CAArB;AACA,MAAIK,QAAQ,GAAGL,MAAM,CAAC,QAAD,CAArB;AACA,MAAIM,OAAO,GAAGN,MAAM,CAAC,OAAD,CAApB;AACA,MAAIO,MAAM,GAAGJ,IAAI,CAAC,IAAD,CAAjB;AACA,MAAIK,SAAS,GAAGN,YAAY,CAAC,SAAD,CAA5B;AACA,MAAIO,WAAW,GAAGN,IAAI,CAAC1G,SAAD,CAAtB;;AACA,MAAIiH,UAAU,GAAG,UAAUjE,CAAV,EAAa;AAC5B,WAAOA,CAAC,KAAK,IAAN,IAAcA,CAAC,KAAKhD,SAA3B;AACD,GAFD;;AAGA,MAAIkH,aAAa,GAAG,UAAUlE,CAAV,EAAa;AAC/B,WAAO,CAACiE,UAAU,CAACjE,CAAD,CAAlB;AACD,GAFD;;AAGA,MAAImE,UAAU,GAAGV,YAAY,CAAC,UAAD,CAA7B;AACA,MAAIW,QAAQ,GAAGX,YAAY,CAAC,QAAD,CAA3B;AAEA,MAAIY,WAAW,GAAGnH,KAAK,CAACC,SAAN,CAAgBW,KAAlC;AACA,MAAIwG,aAAa,GAAGpH,KAAK,CAACC,SAAN,CAAgBM,OAApC;AACA,MAAI8G,UAAU,GAAGrH,KAAK,CAACC,SAAN,CAAgBqH,IAAjC;;AACA,MAAIC,UAAU,GAAG,UAAUC,EAAV,EAAczH,CAAd,EAAiB;AAChC,WAAOqH,aAAa,CAACvG,IAAd,CAAmB2G,EAAnB,EAAuBzH,CAAvB,CAAP;AACD,GAFD;;AAGA,MAAIQ,OAAO,GAAG,UAAUE,EAAV,EAAcZ,CAAd,EAAiB;AAC7B,QAAI4H,CAAC,GAAGF,UAAU,CAAC9G,EAAD,EAAKZ,CAAL,CAAlB;AACA,WAAO4H,CAAC,KAAK,CAAC,CAAP,GAAWtB,QAAQ,CAACrC,IAAT,EAAX,GAA6BqC,QAAQ,CAACR,IAAT,CAAc8B,CAAd,CAApC;AACD,GAHD;;AAIA,MAAIC,QAAQ,GAAG,UAAUjH,EAAV,EAAcZ,CAAd,EAAiB;AAC9B,WAAO0H,UAAU,CAAC9G,EAAD,EAAKZ,CAAL,CAAV,GAAoB,CAAC,CAA5B;AACD,GAFD;;AAGA,MAAIuF,MAAM,GAAG,UAAU3E,EAAV,EAAckH,IAAd,EAAoB;AAC/B,SAAK,IAAInG,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAGd,EAAE,CAACa,MAAzB,EAAiCE,CAAC,GAAGD,GAArC,EAA0CC,CAAC,EAA3C,EAA+C;AAC7C,UAAI3B,CAAC,GAAGY,EAAE,CAACe,CAAD,CAAV;;AACA,UAAImG,IAAI,CAAC9H,CAAD,EAAI2B,CAAJ,CAAR,EAAgB;AACd,eAAO,IAAP;AACD;AACF;;AACD,WAAO,KAAP;AACD,GARD;;AASA,MAAIyD,GAAG,GAAG,UAAUxE,EAAV,EAAcO,CAAd,EAAiB;AACzB,QAAIO,GAAG,GAAGd,EAAE,CAACa,MAAb;AACA,QAAImG,CAAC,GAAG,IAAIzH,KAAJ,CAAUuB,GAAV,CAAR;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,GAApB,EAAyBC,CAAC,EAA1B,EAA8B;AAC5B,UAAI3B,CAAC,GAAGY,EAAE,CAACe,CAAD,CAAV;AACAiG,MAAAA,CAAC,CAACjG,CAAD,CAAD,GAAOR,CAAC,CAACnB,CAAD,EAAI2B,CAAJ,CAAR;AACD;;AACD,WAAOiG,CAAP;AACD,GARD;;AASA,MAAIvC,IAAI,GAAG,UAAUzE,EAAV,EAAcO,CAAd,EAAiB;AAC1B,SAAK,IAAIQ,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAGd,EAAE,CAACa,MAAzB,EAAiCE,CAAC,GAAGD,GAArC,EAA0CC,CAAC,EAA3C,EAA+C;AAC7C,UAAI3B,CAAC,GAAGY,EAAE,CAACe,CAAD,CAAV;AACAR,MAAAA,CAAC,CAACnB,CAAD,EAAI2B,CAAJ,CAAD;AACD;AACF,GALD;;AAMA,MAAIoG,KAAK,GAAG,UAAUnH,EAAV,EAAcO,CAAd,EAAiB;AAC3B,SAAK,IAAIQ,CAAC,GAAGf,EAAE,CAACa,MAAH,GAAY,CAAzB,EAA4BE,CAAC,IAAI,CAAjC,EAAoCA,CAAC,EAArC,EAAyC;AACvC,UAAI3B,CAAC,GAAGY,EAAE,CAACe,CAAD,CAAV;AACAR,MAAAA,CAAC,CAACnB,CAAD,EAAI2B,CAAJ,CAAD;AACD;AACF,GALD;;AAMA,MAAIqG,SAAS,GAAG,UAAUpH,EAAV,EAAckH,IAAd,EAAoB;AAClC,QAAIG,IAAI,GAAG,EAAX;AACA,QAAIC,IAAI,GAAG,EAAX;;AACA,SAAK,IAAIvG,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAGd,EAAE,CAACa,MAAzB,EAAiCE,CAAC,GAAGD,GAArC,EAA0CC,CAAC,EAA3C,EAA+C;AAC7C,UAAI3B,CAAC,GAAGY,EAAE,CAACe,CAAD,CAAV;AACA,UAAIwG,GAAG,GAAGL,IAAI,CAAC9H,CAAD,EAAI2B,CAAJ,CAAJ,GAAasG,IAAb,GAAoBC,IAA9B;AACAC,MAAAA,GAAG,CAACV,IAAJ,CAASzH,CAAT;AACD;;AACD,WAAO;AACLiI,MAAAA,IAAI,EAAEA,IADD;AAELC,MAAAA,IAAI,EAAEA;AAFD,KAAP;AAID,GAZD;;AAaA,MAAIzC,MAAM,GAAG,UAAU7E,EAAV,EAAckH,IAAd,EAAoB;AAC/B,QAAIF,CAAC,GAAG,EAAR;;AACA,SAAK,IAAIjG,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAGd,EAAE,CAACa,MAAzB,EAAiCE,CAAC,GAAGD,GAArC,EAA0CC,CAAC,EAA3C,EAA+C;AAC7C,UAAI3B,CAAC,GAAGY,EAAE,CAACe,CAAD,CAAV;;AACA,UAAImG,IAAI,CAAC9H,CAAD,EAAI2B,CAAJ,CAAR,EAAgB;AACdiG,QAAAA,CAAC,CAACH,IAAF,CAAOzH,CAAP;AACD;AACF;;AACD,WAAO4H,CAAP;AACD,GATD;;AAUA,MAAIQ,KAAK,GAAG,UAAUxH,EAAV,EAAcO,CAAd,EAAiBkH,GAAjB,EAAsB;AAChCN,IAAAA,KAAK,CAACnH,EAAD,EAAK,UAAUZ,CAAV,EAAa;AACrBqI,MAAAA,GAAG,GAAGlH,CAAC,CAACkH,GAAD,EAAMrI,CAAN,CAAP;AACD,KAFI,CAAL;AAGA,WAAOqI,GAAP;AACD,GALD;;AAMA,MAAIC,KAAK,GAAG,UAAU1H,EAAV,EAAcO,CAAd,EAAiBkH,GAAjB,EAAsB;AAChChD,IAAAA,IAAI,CAACzE,EAAD,EAAK,UAAUZ,CAAV,EAAa;AACpBqI,MAAAA,GAAG,GAAGlH,CAAC,CAACkH,GAAD,EAAMrI,CAAN,CAAP;AACD,KAFG,CAAJ;AAGA,WAAOqI,GAAP;AACD,GALD;;AAMA,MAAIE,SAAS,GAAG,UAAU3H,EAAV,EAAckH,IAAd,EAAoBU,KAApB,EAA2B;AACzC,SAAK,IAAI7G,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAGd,EAAE,CAACa,MAAzB,EAAiCE,CAAC,GAAGD,GAArC,EAA0CC,CAAC,EAA3C,EAA+C;AAC7C,UAAI3B,CAAC,GAAGY,EAAE,CAACe,CAAD,CAAV;;AACA,UAAImG,IAAI,CAAC9H,CAAD,EAAI2B,CAAJ,CAAR,EAAgB;AACd,eAAO2E,QAAQ,CAACR,IAAT,CAAc9F,CAAd,CAAP;AACD,OAFD,MAEO,IAAIwI,KAAK,CAACxI,CAAD,EAAI2B,CAAJ,CAAT,EAAiB;AACtB;AACD;AACF;;AACD,WAAO2E,QAAQ,CAACrC,IAAT,EAAP;AACD,GAVD;;AAWA,MAAIwE,IAAI,GAAG,UAAU7H,EAAV,EAAckH,IAAd,EAAoB;AAC7B,WAAOS,SAAS,CAAC3H,EAAD,EAAKkH,IAAL,EAAW/D,KAAX,CAAhB;AACD,GAFD;;AAGA,MAAI2E,SAAS,GAAG,UAAU9H,EAAV,EAAckH,IAAd,EAAoB;AAClC,SAAK,IAAInG,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAGd,EAAE,CAACa,MAAzB,EAAiCE,CAAC,GAAGD,GAArC,EAA0CC,CAAC,EAA3C,EAA+C;AAC7C,UAAI3B,CAAC,GAAGY,EAAE,CAACe,CAAD,CAAV;;AACA,UAAImG,IAAI,CAAC9H,CAAD,EAAI2B,CAAJ,CAAR,EAAgB;AACd,eAAO2E,QAAQ,CAACR,IAAT,CAAcnE,CAAd,CAAP;AACD;AACF;;AACD,WAAO2E,QAAQ,CAACrC,IAAT,EAAP;AACD,GARD;;AASA,MAAI0E,OAAO,GAAG,UAAU/H,EAAV,EAAc;AAC1B,QAAIgH,CAAC,GAAG,EAAR;;AACA,SAAK,IAAIjG,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAGd,EAAE,CAACa,MAAzB,EAAiCE,CAAC,GAAGD,GAArC,EAA0C,EAAEC,CAA5C,EAA+C;AAC7C,UAAI,CAACmF,OAAO,CAAClG,EAAE,CAACe,CAAD,CAAH,CAAZ,EAAqB;AACnB,cAAM,IAAImC,KAAJ,CAAU,sBAAsBnC,CAAtB,GAA0B,4BAA1B,GAAyDf,EAAnE,CAAN;AACD;;AACD4G,MAAAA,UAAU,CAAC3E,KAAX,CAAiB+E,CAAjB,EAAoBhH,EAAE,CAACe,CAAD,CAAtB;AACD;;AACD,WAAOiG,CAAP;AACD,GATD;;AAUA,MAAItC,IAAI,GAAG,UAAU1E,EAAV,EAAcO,CAAd,EAAiB;AAC1B,WAAOwH,OAAO,CAACvD,GAAG,CAACxE,EAAD,EAAKO,CAAL,CAAJ,CAAd;AACD,GAFD;;AAGA,MAAIqE,MAAM,GAAG,UAAU5E,EAAV,EAAckH,IAAd,EAAoB;AAC/B,SAAK,IAAInG,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAGd,EAAE,CAACa,MAAzB,EAAiCE,CAAC,GAAGD,GAArC,EAA0C,EAAEC,CAA5C,EAA+C;AAC7C,UAAI3B,CAAC,GAAGY,EAAE,CAACe,CAAD,CAAV;;AACA,UAAImG,IAAI,CAAC9H,CAAD,EAAI2B,CAAJ,CAAJ,KAAe,IAAnB,EAAyB;AACvB,eAAO,KAAP;AACD;AACF;;AACD,WAAO,IAAP;AACD,GARD;;AASA,MAAIiH,OAAO,GAAG,UAAUhI,EAAV,EAAc;AAC1B,QAAIgH,CAAC,GAAGN,WAAW,CAACtG,IAAZ,CAAiBJ,EAAjB,EAAqB,CAArB,CAAR;AACAgH,IAAAA,CAAC,CAACgB,OAAF;AACA,WAAOhB,CAAP;AACD,GAJD;;AAKA,MAAIiB,UAAU,GAAG,UAAUC,EAAV,EAAcC,EAAd,EAAkB;AACjC,WAAOtD,MAAM,CAACqD,EAAD,EAAK,UAAU9I,CAAV,EAAa;AAC7B,aAAO,CAAC6H,QAAQ,CAACkB,EAAD,EAAK/I,CAAL,CAAhB;AACD,KAFY,CAAb;AAGD,GAJD;;AAKA,MAAIgJ,WAAW,GAAG,UAAUpI,EAAV,EAAcO,CAAd,EAAiB;AACjC,QAAIyG,CAAC,GAAG,EAAR;;AACA,SAAK,IAAIjG,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAGd,EAAE,CAACa,MAAzB,EAAiCE,CAAC,GAAGD,GAArC,EAA0CC,CAAC,EAA3C,EAA+C;AAC7C,UAAI3B,CAAC,GAAGY,EAAE,CAACe,CAAD,CAAV;AACAiG,MAAAA,CAAC,CAACpH,MAAM,CAACR,CAAD,CAAP,CAAD,GAAemB,CAAC,CAACnB,CAAD,EAAI2B,CAAJ,CAAhB;AACD;;AACD,WAAOiG,CAAP;AACD,GAPD;;AAQA,MAAIqB,MAAM,GAAG,UAAUrI,EAAV,EAAcsI,UAAd,EAA0B;AACrC,QAAIC,IAAI,GAAG7B,WAAW,CAACtG,IAAZ,CAAiBJ,EAAjB,EAAqB,CAArB,CAAX;AACAuI,IAAAA,IAAI,CAACxI,IAAL,CAAUuI,UAAV;AACA,WAAOC,IAAP;AACD,GAJD;;AAKA,MAAIC,GAAG,GAAG,UAAUxI,EAAV,EAAce,CAAd,EAAiB;AACzB,WAAOA,CAAC,IAAI,CAAL,IAAUA,CAAC,GAAGf,EAAE,CAACa,MAAjB,GAA0B6E,QAAQ,CAACR,IAAT,CAAclF,EAAE,CAACe,CAAD,CAAhB,CAA1B,GAAiD2E,QAAQ,CAACrC,IAAT,EAAxD;AACD,GAFD;;AAGA,MAAIoF,IAAI,GAAG,UAAUzI,EAAV,EAAc;AACvB,WAAOwI,GAAG,CAACxI,EAAD,EAAK,CAAL,CAAV;AACD,GAFD;;AAGA,MAAI0I,IAAI,GAAG,UAAU1I,EAAV,EAAc;AACvB,WAAOwI,GAAG,CAACxI,EAAD,EAAKA,EAAE,CAACa,MAAH,GAAY,CAAjB,CAAV;AACD,GAFD;;AAGA,MAAI8H,MAAM,GAAGnC,UAAU,CAACjH,KAAK,CAACkG,IAAP,CAAV,GAAyBlG,KAAK,CAACkG,IAA/B,GAAsC,UAAUrG,CAAV,EAAa;AAC9D,WAAOsH,WAAW,CAACtG,IAAZ,CAAiBhB,CAAjB,CAAP;AACD,GAFD;;AAGA,MAAIwJ,OAAO,GAAG,UAAUrB,GAAV,EAAehH,CAAf,EAAkB;AAC9B,SAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwG,GAAG,CAAC1G,MAAxB,EAAgCE,CAAC,EAAjC,EAAqC;AACnC,UAAIiG,CAAC,GAAGzG,CAAC,CAACgH,GAAG,CAACxG,CAAD,CAAJ,EAASA,CAAT,CAAT;;AACA,UAAIiG,CAAC,CAAChD,MAAF,EAAJ,EAAgB;AACd,eAAOgD,CAAP;AACD;AACF;;AACD,WAAOtB,QAAQ,CAACrC,IAAT,EAAP;AACD,GARD;;AAUA,MAAIjC,IAAI,GAAGD,MAAM,CAACC,IAAlB;AACA,MAAIyH,cAAc,GAAG1H,MAAM,CAAC0H,cAA5B;;AACA,MAAIC,MAAM,GAAG,UAAUC,GAAV,EAAexI,CAAf,EAAkB;AAC7B,QAAIyI,KAAK,GAAG5H,IAAI,CAAC2H,GAAD,CAAhB;;AACA,SAAK,IAAIE,CAAC,GAAG,CAAR,EAAWnI,GAAG,GAAGkI,KAAK,CAACnI,MAA5B,EAAoCoI,CAAC,GAAGnI,GAAxC,EAA6CmI,CAAC,EAA9C,EAAkD;AAChD,UAAIlI,CAAC,GAAGiI,KAAK,CAACC,CAAD,CAAb;AACA,UAAI7J,CAAC,GAAG2J,GAAG,CAAChI,CAAD,CAAX;AACAR,MAAAA,CAAC,CAACnB,CAAD,EAAI2B,CAAJ,CAAD;AACD;AACF,GAPD;;AAQA,MAAImI,KAAK,GAAG,UAAUH,GAAV,EAAexI,CAAf,EAAkB;AAC5B,WAAO4I,QAAQ,CAACJ,GAAD,EAAM,UAAU3J,CAAV,EAAa2B,CAAb,EAAgB;AACnC,aAAO;AACLkI,QAAAA,CAAC,EAAElI,CADE;AAELuE,QAAAA,CAAC,EAAE/E,CAAC,CAACnB,CAAD,EAAI2B,CAAJ;AAFC,OAAP;AAID,KALc,CAAf;AAMD,GAPD;;AAQA,MAAIoI,QAAQ,GAAG,UAAUJ,GAAV,EAAexI,CAAf,EAAkB;AAC/B,QAAIyG,CAAC,GAAG,EAAR;AACA8B,IAAAA,MAAM,CAACC,GAAD,EAAM,UAAU3J,CAAV,EAAa2B,CAAb,EAAgB;AAC1B,UAAIqI,KAAK,GAAG7I,CAAC,CAACnB,CAAD,EAAI2B,CAAJ,CAAb;AACAiG,MAAAA,CAAC,CAACoC,KAAK,CAACH,CAAP,CAAD,GAAaG,KAAK,CAAC9D,CAAnB;AACD,KAHK,CAAN;AAIA,WAAO0B,CAAP;AACD,GAPD;;AAQA,MAAIqC,MAAM,GAAG,UAAUrC,CAAV,EAAa;AACxB,WAAO,UAAU5H,CAAV,EAAa2B,CAAb,EAAgB;AACrBiG,MAAAA,CAAC,CAACjG,CAAD,CAAD,GAAO3B,CAAP;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIkK,cAAc,GAAG,UAAUP,GAAV,EAAe7B,IAAf,EAAqBqC,MAArB,EAA6BC,OAA7B,EAAsC;AACzD,QAAIxC,CAAC,GAAG,EAAR;AACA8B,IAAAA,MAAM,CAACC,GAAD,EAAM,UAAU3J,CAAV,EAAa2B,CAAb,EAAgB;AAC1B,OAACmG,IAAI,CAAC9H,CAAD,EAAI2B,CAAJ,CAAJ,GAAawI,MAAb,GAAsBC,OAAvB,EAAgCpK,CAAhC,EAAmC2B,CAAnC;AACD,KAFK,CAAN;AAGA,WAAOiG,CAAP;AACD,GAND;;AAOA,MAAIyC,QAAQ,GAAG,UAAUV,GAAV,EAAe7B,IAAf,EAAqB;AAClC,QAAI5H,CAAC,GAAG,EAAR;AACA,QAAIiB,CAAC,GAAG,EAAR;AACA+I,IAAAA,cAAc,CAACP,GAAD,EAAM7B,IAAN,EAAYmC,MAAM,CAAC/J,CAAD,CAAlB,EAAuB+J,MAAM,CAAC9I,CAAD,CAA7B,CAAd;AACA,WAAO;AACLjB,MAAAA,CAAC,EAAEA,CADE;AAELiB,MAAAA,CAAC,EAAEA;AAFE,KAAP;AAID,GARD;;AASA,MAAImJ,QAAQ,GAAG,UAAUX,GAAV,EAAe7B,IAAf,EAAqB;AAClC,QAAI5H,CAAC,GAAG,EAAR;AACAgK,IAAAA,cAAc,CAACP,GAAD,EAAM7B,IAAN,EAAYmC,MAAM,CAAC/J,CAAD,CAAlB,EAAuBoC,IAAvB,CAAd;AACA,WAAOpC,CAAP;AACD,GAJD;;AAKA,MAAIqK,UAAU,GAAG,UAAUZ,GAAV,EAAexI,CAAf,EAAkB;AACjC,QAAIyG,CAAC,GAAG,EAAR;AACA8B,IAAAA,MAAM,CAACC,GAAD,EAAM,UAAUxG,KAAV,EAAiB5C,IAAjB,EAAuB;AACjCqH,MAAAA,CAAC,CAACH,IAAF,CAAOtG,CAAC,CAACgC,KAAD,EAAQ5C,IAAR,CAAR;AACD,KAFK,CAAN;AAGA,WAAOqH,CAAP;AACD,GAND;;AAOA,MAAI4C,MAAM,GAAG,UAAUb,GAAV,EAAe;AAC1B,WAAOY,UAAU,CAACZ,GAAD,EAAM,UAAUzD,CAAV,EAAa;AAClC,aAAOA,CAAP;AACD,KAFgB,CAAjB;AAGD,GAJD;;AAKA,MAAIuE,KAAK,GAAG,UAAUd,GAAV,EAAee,GAAf,EAAoB;AAC9B,WAAOC,GAAG,CAAChB,GAAD,EAAMe,GAAN,CAAH,GAAgBpE,QAAQ,CAACD,IAAT,CAAcsD,GAAG,CAACe,GAAD,CAAjB,CAAhB,GAA0CpE,QAAQ,CAACrC,IAAT,EAAjD;AACD,GAFD;;AAGA,MAAI0G,GAAG,GAAG,UAAUhB,GAAV,EAAee,GAAf,EAAoB;AAC5B,WAAOjB,cAAc,CAACzI,IAAf,CAAoB2I,GAApB,EAAyBe,GAAzB,CAAP;AACD,GAFD;;AAGA,MAAIE,iBAAiB,GAAG,UAAUjB,GAAV,EAAee,GAAf,EAAoB;AAC1C,WAAOC,GAAG,CAAChB,GAAD,EAAMe,GAAN,CAAH,IAAiBf,GAAG,CAACe,GAAD,CAAH,KAAazK,SAA9B,IAA2C0J,GAAG,CAACe,GAAD,CAAH,KAAa,IAA/D;AACD,GAFD;;AAGA,MAAIG,KAAK,GAAG,UAAU/B,EAAV,EAAcC,EAAd,EAAkB3H,EAAlB,EAAsB;AAChC,QAAIA,EAAE,KAAK,KAAK,CAAhB,EAAmB;AACjBA,MAAAA,EAAE,GAAGe,KAAL;AACD;;AACD,WAAON,QAAQ,CAACT,EAAD,CAAR,CAAaA,EAAb,CAAgB0H,EAAhB,EAAoBC,EAApB,CAAP;AACD,GALD;;AAOA,MAAI+B,SAAS,GAAG3K,KAAK,CAAC2G,OAAtB;;AACA,MAAIlB,OAAO,GAAG,UAAU+D,GAAV,EAAe;AAC3B,QAAI,CAACmB,SAAS,CAACnB,GAAD,CAAd,EAAqB;AACnB,UAAIoB,KAAK,GAAG,EAAZ;;AACA,WAAK,IAAIpJ,CAAC,GAAG,CAAR,EAAWqJ,CAAC,GAAGrB,GAAG,CAAClI,MAAxB,EAAgCE,CAAC,GAAGqJ,CAApC,EAAuCrJ,CAAC,EAAxC,EAA4C;AAC1CoJ,QAAAA,KAAK,CAACpJ,CAAD,CAAL,GAAWgI,GAAG,CAAChI,CAAD,CAAd;AACD;;AACD,aAAOoJ,KAAP;AACD,KAND,MAMO;AACL,aAAOpB,GAAP;AACD;AACF,GAVD;;AAWA,MAAIsB,MAAM,GAAG,UAAU9G,CAAV,EAAa+G,EAAb,EAAiBjF,CAAjB,EAAoB;AAC/B,QAAI1B,CAAJ,EAAOyG,CAAP;;AACA,QAAI,CAAC7G,CAAL,EAAQ;AACN,aAAO,KAAP;AACD;;AACD8B,IAAAA,CAAC,GAAGA,CAAC,IAAI9B,CAAT;;AACA,QAAIA,CAAC,CAAC1C,MAAF,KAAaxB,SAAjB,EAA4B;AAC1B,WAAKsE,CAAC,GAAG,CAAJ,EAAOyG,CAAC,GAAG7G,CAAC,CAAC1C,MAAlB,EAA0B8C,CAAC,GAAGyG,CAA9B,EAAiCzG,CAAC,EAAlC,EAAsC;AACpC,YAAI2G,EAAE,CAAClK,IAAH,CAAQiF,CAAR,EAAW9B,CAAC,CAACI,CAAD,CAAZ,EAAiBA,CAAjB,EAAoBJ,CAApB,MAA2B,KAA/B,EAAsC;AACpC,iBAAO,KAAP;AACD;AACF;AACF,KAND,MAMO;AACL,WAAKI,CAAL,IAAUJ,CAAV,EAAa;AACX,YAAIA,CAAC,CAACsF,cAAF,CAAiBlF,CAAjB,CAAJ,EAAyB;AACvB,cAAI2G,EAAE,CAAClK,IAAH,CAAQiF,CAAR,EAAW9B,CAAC,CAACI,CAAD,CAAZ,EAAiBA,CAAjB,EAAoBJ,CAApB,MAA2B,KAA/B,EAAsC;AACpC,mBAAO,KAAP;AACD;AACF;AACF;AACF;;AACD,WAAO,IAAP;AACD,GAtBD;;AAuBA,MAAIgH,KAAK,GAAG,UAAUJ,KAAV,EAAiBK,QAAjB,EAA2B;AACrC,QAAIC,GAAG,GAAG,EAAV;AACAJ,IAAAA,MAAM,CAACF,KAAD,EAAQ,UAAUO,IAAV,EAAgBC,KAAhB,EAAuB;AACnCF,MAAAA,GAAG,CAAC5D,IAAJ,CAAS2D,QAAQ,CAACE,IAAD,EAAOC,KAAP,EAAcR,KAAd,CAAjB;AACD,KAFK,CAAN;AAGA,WAAOM,GAAP;AACD,GAND;;AAOA,MAAIG,QAAQ,GAAG,UAAUvI,CAAV,EAAa9B,CAAb,EAAgB;AAC7B,QAAIgD,CAAC,GAAG,EAAR;AACA8G,IAAAA,MAAM,CAAChI,CAAD,EAAI,UAAUiD,CAAV,EAAaqF,KAAb,EAAoB;AAC5B,UAAI,CAACpK,CAAD,IAAMA,CAAC,CAAC+E,CAAD,EAAIqF,KAAJ,EAAWtI,CAAX,CAAX,EAA0B;AACxBkB,QAAAA,CAAC,CAACsD,IAAF,CAAOvB,CAAP;AACD;AACF,KAJK,CAAN;AAKA,WAAO/B,CAAP;AACD,GARD;;AASA,MAAIsH,SAAS,GAAG,UAAUxI,CAAV,EAAaiD,CAAb,EAAgB;AAC9B,QAAIjD,CAAJ,EAAO;AACL,WAAK,IAAItB,CAAC,GAAG,CAAR,EAAWqJ,CAAC,GAAG/H,CAAC,CAACxB,MAAtB,EAA8BE,CAAC,GAAGqJ,CAAlC,EAAqCrJ,CAAC,EAAtC,EAA0C;AACxC,YAAIsB,CAAC,CAACtB,CAAD,CAAD,KAASuE,CAAb,EAAgB;AACd,iBAAOvE,CAAP;AACD;AACF;AACF;;AACD,WAAO,CAAC,CAAR;AACD,GATD;;AAUA,MAAI+J,MAAM,GAAG,UAAUC,UAAV,EAAsBC,QAAtB,EAAgCC,WAAhC,EAA6CC,OAA7C,EAAsD;AACjE,QAAIzD,GAAG,GAAGpB,WAAW,CAAC4E,WAAD,CAAX,GAA2BF,UAAU,CAAC,CAAD,CAArC,GAA2CE,WAArD;;AACA,SAAK,IAAIlK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgK,UAAU,CAAClK,MAA/B,EAAuCE,CAAC,EAAxC,EAA4C;AAC1C0G,MAAAA,GAAG,GAAGuD,QAAQ,CAAC5K,IAAT,CAAc8K,OAAd,EAAuBzD,GAAvB,EAA4BsD,UAAU,CAAChK,CAAD,CAAtC,EAA2CA,CAA3C,CAAN;AACD;;AACD,WAAO0G,GAAP;AACD,GAND;;AAOA,MAAI0D,WAAW,GAAG,UAAUhB,KAAV,EAAiBiB,SAAjB,EAA4BF,OAA5B,EAAqC;AACrD,QAAInK,CAAJ,EAAOqJ,CAAP;;AACA,SAAKrJ,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAGD,KAAK,CAACtJ,MAAtB,EAA8BE,CAAC,GAAGqJ,CAAlC,EAAqCrJ,CAAC,EAAtC,EAA0C;AACxC,UAAIqK,SAAS,CAAChL,IAAV,CAAe8K,OAAf,EAAwBf,KAAK,CAACpJ,CAAD,CAA7B,EAAkCA,CAAlC,EAAqCoJ,KAArC,CAAJ,EAAiD;AAC/C,eAAOpJ,CAAP;AACD;AACF;;AACD,WAAO,CAAC,CAAR;AACD,GARD;;AASA,MAAIsK,MAAM,GAAG,UAAUN,UAAV,EAAsB;AACjC,WAAOA,UAAU,CAACA,UAAU,CAAClK,MAAX,GAAoB,CAArB,CAAjB;AACD,GAFD;;AAIA,MAAIyK,QAAQ,GAAG,YAAY;AACzBA,IAAAA,QAAQ,GAAGnK,MAAM,CAACoK,MAAP,IAAiB,SAASD,QAAT,CAAkBhM,CAAlB,EAAqB;AAC/C,WAAK,IAAI+F,CAAJ,EAAOtE,CAAC,GAAG,CAAX,EAAc4C,CAAC,GAAG3B,SAAS,CAACnB,MAAjC,EAAyCE,CAAC,GAAG4C,CAA7C,EAAgD5C,CAAC,EAAjD,EAAqD;AACnDsE,QAAAA,CAAC,GAAGrD,SAAS,CAACjB,CAAD,CAAb;;AACA,aAAK,IAAIyK,CAAT,IAAcnG,CAAd,EACE,IAAIlE,MAAM,CAAC3B,SAAP,CAAiBqJ,cAAjB,CAAgCzI,IAAhC,CAAqCiF,CAArC,EAAwCmG,CAAxC,CAAJ,EACElM,CAAC,CAACkM,CAAD,CAAD,GAAOnG,CAAC,CAACmG,CAAD,CAAR;AACL;;AACD,aAAOlM,CAAP;AACD,KARD;;AASA,WAAOgM,QAAQ,CAACrJ,KAAT,CAAe,IAAf,EAAqBD,SAArB,CAAP;AACD,GAXD;;AAYA,WAASyJ,MAAT,CAAgBpG,CAAhB,EAAmBqG,CAAnB,EAAsB;AACpB,QAAIpM,CAAC,GAAG,EAAR;;AACA,SAAK,IAAIkM,CAAT,IAAcnG,CAAd,EACE,IAAIlE,MAAM,CAAC3B,SAAP,CAAiBqJ,cAAjB,CAAgCzI,IAAhC,CAAqCiF,CAArC,EAAwCmG,CAAxC,KAA8CE,CAAC,CAAC5L,OAAF,CAAU0L,CAAV,IAAe,CAAjE,EACElM,CAAC,CAACkM,CAAD,CAAD,GAAOnG,CAAC,CAACmG,CAAD,CAAR;;AACJ,QAAInG,CAAC,IAAI,IAAL,IAAa,OAAOlE,MAAM,CAACwK,qBAAd,KAAwC,UAAzD,EACE,KAAK,IAAI5K,CAAC,GAAG,CAAR,EAAWyK,CAAC,GAAGrK,MAAM,CAACwK,qBAAP,CAA6BtG,CAA7B,CAApB,EAAqDtE,CAAC,GAAGyK,CAAC,CAAC3K,MAA3D,EAAmEE,CAAC,EAApE,EAAwE;AACtE,UAAI2K,CAAC,CAAC5L,OAAF,CAAU0L,CAAC,CAACzK,CAAD,CAAX,IAAkB,CAAlB,IAAuBI,MAAM,CAAC3B,SAAP,CAAiBoM,oBAAjB,CAAsCxL,IAAtC,CAA2CiF,CAA3C,EAA8CmG,CAAC,CAACzK,CAAD,CAA/C,CAA3B,EACEzB,CAAC,CAACkM,CAAC,CAACzK,CAAD,CAAF,CAAD,GAAUsE,CAAC,CAACmG,CAAC,CAACzK,CAAD,CAAF,CAAX;AACH;AACH,WAAOzB,CAAP;AACD;;AACD,WAASuM,cAAT,GAA0B;AACxB,SAAK,IAAIxG,CAAC,GAAG,CAAR,EAAWtE,CAAC,GAAG,CAAf,EAAkB+K,EAAE,GAAG9J,SAAS,CAACnB,MAAtC,EAA8CE,CAAC,GAAG+K,EAAlD,EAAsD/K,CAAC,EAAvD,EACEsE,CAAC,IAAIrD,SAAS,CAACjB,CAAD,CAAT,CAAaF,MAAlB;;AACF,SAAK,IAAImG,CAAC,GAAGzH,KAAK,CAAC8F,CAAD,CAAb,EAAkB4D,CAAC,GAAG,CAAtB,EAAyBlI,CAAC,GAAG,CAAlC,EAAqCA,CAAC,GAAG+K,EAAzC,EAA6C/K,CAAC,EAA9C,EACE,KAAK,IAAIsB,CAAC,GAAGL,SAAS,CAACjB,CAAD,CAAjB,EAAsBgL,CAAC,GAAG,CAA1B,EAA6BC,EAAE,GAAG3J,CAAC,CAACxB,MAAzC,EAAiDkL,CAAC,GAAGC,EAArD,EAAyDD,CAAC,IAAI9C,CAAC,EAA/D,EACEjC,CAAC,CAACiC,CAAD,CAAD,GAAO5G,CAAC,CAAC0J,CAAD,CAAR;;AACJ,WAAO/E,CAAP;AACD;;AAED,MAAIiF,MAAM,GAAG,UAAU1L,CAAV,EAAa;AACxB,QAAI2L,MAAM,GAAG,KAAb;AACA,QAAIlF,CAAJ;AACA,WAAO,YAAY;AACjB,UAAIlF,IAAI,GAAG,EAAX;;AACA,WAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CD,QAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWC,SAAS,CAACD,EAAD,CAApB;AACD;;AACD,UAAI,CAACmK,MAAL,EAAa;AACXA,QAAAA,MAAM,GAAG,IAAT;AACAlF,QAAAA,CAAC,GAAGzG,CAAC,CAAC0B,KAAF,CAAQ,IAAR,EAAcH,IAAd,CAAJ;AACD;;AACD,aAAOkF,CAAP;AACD,KAVD;AAWD,GAdD;;AAgBA,MAAImF,UAAU,GAAG,UAAUC,EAAV,EAAcC,OAAd,EAAuBC,SAAvB,EAAkCC,UAAlC,EAA8C;AAC7D,QAAIC,MAAM,GAAGJ,EAAE,CAACK,KAAH,MAAc,QAAQC,IAAR,CAAaJ,SAAb,MAA4B,IAAvD;AACA,QAAIK,QAAQ,GAAGP,EAAE,CAACK,KAAH,MAAc,CAACD,MAA9B;AACA,QAAII,QAAQ,GAAGR,EAAE,CAACK,KAAH,MAAcL,EAAE,CAACS,SAAH,EAA7B;AACA,QAAIC,OAAO,GAAGF,QAAQ,IAAIL,UAAU,CAAC,kBAAD,CAApC;AACA,QAAIQ,QAAQ,GAAGP,MAAM,IAAI,CAACG,QAAD,IAAaC,QAAb,IAAyBL,UAAU,CAAC,0BAAD,CAA5D;AACA,QAAIS,OAAO,GAAGL,QAAQ,IAAIC,QAAQ,IAAI,CAACG,QAAvC;AACA,QAAIE,UAAU,GAAGZ,OAAO,CAACa,QAAR,MAAsBd,EAAE,CAACK,KAAH,EAAtB,IAAoC,UAAUC,IAAV,CAAeJ,SAAf,MAA8B,KAAnF;AACA,QAAIa,SAAS,GAAG,CAACH,OAAD,IAAY,CAACD,QAAb,IAAyB,CAACE,UAA1C;AACA,WAAO;AACLT,MAAAA,MAAM,EAAElK,QAAQ,CAACkK,MAAD,CADX;AAELG,MAAAA,QAAQ,EAAErK,QAAQ,CAACqK,QAAD,CAFb;AAGLI,MAAAA,QAAQ,EAAEzK,QAAQ,CAACyK,QAAD,CAHb;AAILC,MAAAA,OAAO,EAAE1K,QAAQ,CAAC0K,OAAD,CAJZ;AAKLF,MAAAA,OAAO,EAAExK,QAAQ,CAACwK,OAAD,CALZ;AAMLD,MAAAA,SAAS,EAAET,EAAE,CAACS,SANT;AAOLJ,MAAAA,KAAK,EAAEL,EAAE,CAACK,KAPL;AAQLW,MAAAA,SAAS,EAAE9K,QAAQ,CAAC2K,UAAD,CARd;AASLE,MAAAA,SAAS,EAAE7K,QAAQ,CAAC6K,SAAD;AATd,KAAP;AAWD,GApBD;;AAsBA,MAAIE,UAAU,GAAG,UAAUC,OAAV,EAAmBjI,CAAnB,EAAsB;AACrC,SAAK,IAAItE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuM,OAAO,CAACzM,MAA5B,EAAoCE,CAAC,EAArC,EAAyC;AACvC,UAAI3B,CAAC,GAAGkO,OAAO,CAACvM,CAAD,CAAf;;AACA,UAAI3B,CAAC,CAACsN,IAAF,CAAOrH,CAAP,CAAJ,EAAe;AACb,eAAOjG,CAAP;AACD;AACF;;AACD,WAAOC,SAAP;AACD,GARD;;AASA,MAAIkO,MAAM,GAAG,UAAUD,OAAV,EAAmBE,KAAnB,EAA0B;AACrC,QAAIxG,CAAC,GAAGqG,UAAU,CAACC,OAAD,EAAUE,KAAV,CAAlB;;AACA,QAAI,CAACxG,CAAL,EAAQ;AACN,aAAO;AACLyG,QAAAA,KAAK,EAAE,CADF;AAELC,QAAAA,KAAK,EAAE;AAFF,OAAP;AAID;;AACD,QAAIC,KAAK,GAAG,UAAU5M,CAAV,EAAa;AACvB,aAAO6M,MAAM,CAACJ,KAAK,CAACK,OAAN,CAAc7G,CAAd,EAAiB,MAAMjG,CAAvB,CAAD,CAAb;AACD,KAFD;;AAGA,WAAO+M,EAAE,CAACH,KAAK,CAAC,CAAD,CAAN,EAAWA,KAAK,CAAC,CAAD,CAAhB,CAAT;AACD,GAZD;;AAaA,MAAII,MAAM,GAAG,UAAUC,cAAV,EAA0BR,KAA1B,EAAiC;AAC5C,QAAIS,YAAY,GAAGrO,MAAM,CAAC4N,KAAD,CAAN,CAAcU,WAAd,EAAnB;;AACA,QAAIF,cAAc,CAACnN,MAAf,KAA0B,CAA9B,EAAiC;AAC/B,aAAOsN,OAAO,EAAd;AACD;;AACD,WAAOZ,MAAM,CAACS,cAAD,EAAiBC,YAAjB,CAAb;AACD,GAND;;AAOA,MAAIE,OAAO,GAAG,YAAY;AACxB,WAAOL,EAAE,CAAC,CAAD,EAAI,CAAJ,CAAT;AACD,GAFD;;AAGA,MAAIA,EAAE,GAAG,UAAUL,KAAV,EAAiBC,KAAjB,EAAwB;AAC/B,WAAO;AACLD,MAAAA,KAAK,EAAEA,KADF;AAELC,MAAAA,KAAK,EAAEA;AAFF,KAAP;AAID,GALD;;AAMA,MAAIU,OAAO,GAAG;AACZN,IAAAA,EAAE,EAAEA,EADQ;AAEZC,IAAAA,MAAM,EAAEA,MAFI;AAGZI,IAAAA,OAAO,EAAEA;AAHG,GAAd;;AAMA,MAAIE,QAAQ,GAAG,UAAUC,UAAV,EAAsBhC,SAAtB,EAAiC;AAC9C,QAAIkB,KAAK,GAAG5N,MAAM,CAAC0M,SAAD,CAAN,CAAkB4B,WAAlB,EAAZ;AACA,WAAOrG,IAAI,CAACyG,UAAD,EAAa,UAAUC,SAAV,EAAqB;AAC3C,aAAOA,SAAS,CAACC,MAAV,CAAiBhB,KAAjB,CAAP;AACD,KAFU,CAAX;AAGD,GALD;;AAMA,MAAIiB,aAAa,GAAG,UAAUC,QAAV,EAAoBpC,SAApB,EAA+B;AACjD,WAAO+B,QAAQ,CAACK,QAAD,EAAWpC,SAAX,CAAR,CAA8B9H,GAA9B,CAAkC,UAAU6H,OAAV,EAAmB;AAC1D,UAAIsC,OAAO,GAAGP,OAAO,CAACL,MAAR,CAAe1B,OAAO,CAAC2B,cAAvB,EAAuC1B,SAAvC,CAAd;AACA,aAAO;AACLsC,QAAAA,OAAO,EAAEvC,OAAO,CAAC1M,IADZ;AAELgP,QAAAA,OAAO,EAAEA;AAFJ,OAAP;AAID,KANM,CAAP;AAOD,GARD;;AASA,MAAIE,QAAQ,GAAG,UAAUC,IAAV,EAAgBxC,SAAhB,EAA2B;AACxC,WAAO+B,QAAQ,CAACS,IAAD,EAAOxC,SAAP,CAAR,CAA0B9H,GAA1B,CAA8B,UAAU4H,EAAV,EAAc;AACjD,UAAIuC,OAAO,GAAGP,OAAO,CAACL,MAAR,CAAe3B,EAAE,CAAC4B,cAAlB,EAAkC1B,SAAlC,CAAd;AACA,aAAO;AACLsC,QAAAA,OAAO,EAAExC,EAAE,CAACzM,IADP;AAELgP,QAAAA,OAAO,EAAEA;AAFJ,OAAP;AAID,KANM,CAAP;AAOD,GARD;;AASA,MAAII,QAAQ,GAAG;AACbN,IAAAA,aAAa,EAAEA,aADF;AAEbI,IAAAA,QAAQ,EAAEA;AAFG,GAAf;;AAKA,MAAIG,eAAe,GAAG,UAAUC,GAAV,EAAeC,QAAf,EAAyB;AAC7C,WAAOD,GAAG,CAACE,SAAJ,CAAcD,QAAd,CAAP;AACD,GAFD;;AAIA,MAAIE,UAAU,GAAG,UAAUH,GAAV,EAAeI,MAAf,EAAuBC,KAAvB,EAA8B;AAC7C,WAAOD,MAAM,KAAK,EAAX,IAAiBJ,GAAG,CAACpO,MAAJ,IAAcwO,MAAM,CAACxO,MAArB,IAA+BoO,GAAG,CAACI,MAAJ,CAAWC,KAAX,EAAkBA,KAAK,GAAGD,MAAM,CAACxO,MAAjC,MAA6CwO,MAApG;AACD,GAFD;;AAGA,MAAIE,aAAa,GAAG,UAAUN,GAAV,EAAeO,MAAf,EAAuB;AACzC,WAAOC,UAAU,CAACR,GAAD,EAAMO,MAAN,CAAV,GAA0BR,eAAe,CAACC,GAAD,EAAMO,MAAM,CAAC3O,MAAb,CAAzC,GAAgEoO,GAAvE;AACD,GAFD;;AAGA,MAAIS,UAAU,GAAG,UAAUT,GAAV,EAAeI,MAAf,EAAuB;AACtC,WAAOJ,GAAG,CAACnP,OAAJ,CAAYuP,MAAZ,MAAwB,CAAC,CAAhC;AACD,GAFD;;AAGA,MAAII,UAAU,GAAG,UAAUR,GAAV,EAAeO,MAAf,EAAuB;AACtC,WAAOJ,UAAU,CAACH,GAAD,EAAMO,MAAN,EAAc,CAAd,CAAjB;AACD,GAFD;;AAGA,MAAIG,KAAK,GAAG,UAAU3I,CAAV,EAAa;AACvB,WAAO,UAAU3B,CAAV,EAAa;AAClB,aAAOA,CAAC,CAACwI,OAAF,CAAU7G,CAAV,EAAa,EAAb,CAAP;AACD,KAFD;AAGD,GAJD;;AAKA,MAAI4I,IAAI,GAAGD,KAAK,CAAC,YAAD,CAAhB;AACA,MAAIE,KAAK,GAAGF,KAAK,CAAC,OAAD,CAAjB;AACA,MAAIG,KAAK,GAAGH,KAAK,CAAC,OAAD,CAAjB;AAEA,MAAII,kBAAkB,GAAG,qCAAzB;;AACA,MAAIC,aAAa,GAAG,UAAUC,MAAV,EAAkB;AACpC,WAAO,UAAUC,QAAV,EAAoB;AACzB,aAAOR,UAAU,CAACQ,QAAD,EAAWD,MAAX,CAAjB;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIvB,QAAQ,GAAG,CACb;AACE/O,IAAAA,IAAI,EAAE,MADR;AAEEqO,IAAAA,cAAc,EAAE,CAAC,gCAAD,CAFlB;AAGEQ,IAAAA,MAAM,EAAE,UAAU0B,QAAV,EAAoB;AAC1B,aAAOR,UAAU,CAACQ,QAAD,EAAW,OAAX,CAAV,IAAiCR,UAAU,CAACQ,QAAD,EAAW,QAAX,CAA3C,IAAmER,UAAU,CAACQ,QAAD,EAAW,QAAX,CAA7E,IAAqGR,UAAU,CAACQ,QAAD,EAAW,aAAX,CAAtH;AACD;AALH,GADa,EAQb;AACEvQ,IAAAA,IAAI,EAAE,QADR;AAEEqO,IAAAA,cAAc,EAAE,CACd,iCADc,EAEd+B,kBAFc,CAFlB;AAMEvB,IAAAA,MAAM,EAAE,UAAU0B,QAAV,EAAoB;AAC1B,aAAOR,UAAU,CAACQ,QAAD,EAAW,QAAX,CAAV,IAAkC,CAACR,UAAU,CAACQ,QAAD,EAAW,aAAX,CAApD;AACD;AARH,GARa,EAkBb;AACEvQ,IAAAA,IAAI,EAAE,IADR;AAEEqO,IAAAA,cAAc,EAAE,CACd,gCADc,EAEd,4BAFc,CAFlB;AAMEQ,IAAAA,MAAM,EAAE,UAAU0B,QAAV,EAAoB;AAC1B,aAAOR,UAAU,CAACQ,QAAD,EAAW,MAAX,CAAV,IAAgCR,UAAU,CAACQ,QAAD,EAAW,SAAX,CAAjD;AACD;AARH,GAlBa,EA4Bb;AACEvQ,IAAAA,IAAI,EAAE,OADR;AAEEqO,IAAAA,cAAc,EAAE,CACd+B,kBADc,EAEd,gCAFc,CAFlB;AAMEvB,IAAAA,MAAM,EAAEwB,aAAa,CAAC,OAAD;AANvB,GA5Ba,EAoCb;AACErQ,IAAAA,IAAI,EAAE,SADR;AAEEqO,IAAAA,cAAc,EAAE,CAAC,qCAAD,CAFlB;AAGEQ,IAAAA,MAAM,EAAEwB,aAAa,CAAC,SAAD;AAHvB,GApCa,EAyCb;AACErQ,IAAAA,IAAI,EAAE,QADR;AAEEqO,IAAAA,cAAc,EAAE,CACd+B,kBADc,EAEd,+BAFc,CAFlB;AAMEvB,IAAAA,MAAM,EAAE,UAAU0B,QAAV,EAAoB;AAC1B,aAAO,CAACR,UAAU,CAACQ,QAAD,EAAW,QAAX,CAAV,IAAkCR,UAAU,CAACQ,QAAD,EAAW,SAAX,CAA7C,KAAuER,UAAU,CAACQ,QAAD,EAAW,aAAX,CAAxF;AACD;AARH,GAzCa,CAAf;AAoDA,MAAIpB,IAAI,GAAG,CACT;AACEnP,IAAAA,IAAI,EAAE,SADR;AAEE6O,IAAAA,MAAM,EAAEwB,aAAa,CAAC,KAAD,CAFvB;AAGEhC,IAAAA,cAAc,EAAE,CAAC,uCAAD;AAHlB,GADS,EAMT;AACErO,IAAAA,IAAI,EAAE,KADR;AAEE6O,IAAAA,MAAM,EAAE,UAAU0B,QAAV,EAAoB;AAC1B,aAAOR,UAAU,CAACQ,QAAD,EAAW,QAAX,CAAV,IAAkCR,UAAU,CAACQ,QAAD,EAAW,MAAX,CAAnD;AACD,KAJH;AAKElC,IAAAA,cAAc,EAAE,CACd,qCADc,EAEd,8BAFc,EAGd,qCAHc;AALlB,GANS,EAiBT;AACErO,IAAAA,IAAI,EAAE,SADR;AAEE6O,IAAAA,MAAM,EAAEwB,aAAa,CAAC,SAAD,CAFvB;AAGEhC,IAAAA,cAAc,EAAE,CAAC,mCAAD;AAHlB,GAjBS,EAsBT;AACErO,IAAAA,IAAI,EAAE,KADR;AAEE6O,IAAAA,MAAM,EAAEwB,aAAa,CAAC,UAAD,CAFvB;AAGEhC,IAAAA,cAAc,EAAE,CAAC,qCAAD;AAHlB,GAtBS,EA2BT;AACErO,IAAAA,IAAI,EAAE,OADR;AAEE6O,IAAAA,MAAM,EAAEwB,aAAa,CAAC,OAAD,CAFvB;AAGEhC,IAAAA,cAAc,EAAE;AAHlB,GA3BS,EAgCT;AACErO,IAAAA,IAAI,EAAE,SADR;AAEE6O,IAAAA,MAAM,EAAEwB,aAAa,CAAC,OAAD,CAFvB;AAGEhC,IAAAA,cAAc,EAAE;AAHlB,GAhCS,EAqCT;AACErO,IAAAA,IAAI,EAAE,SADR;AAEE6O,IAAAA,MAAM,EAAEwB,aAAa,CAAC,SAAD,CAFvB;AAGEhC,IAAAA,cAAc,EAAE;AAHlB,GArCS,EA0CT;AACErO,IAAAA,IAAI,EAAE,UADR;AAEE6O,IAAAA,MAAM,EAAEwB,aAAa,CAAC,MAAD,CAFvB;AAGEhC,IAAAA,cAAc,EAAE,CAAC,iCAAD;AAHlB,GA1CS,CAAX;AAgDA,MAAImC,YAAY,GAAG;AACjBzB,IAAAA,QAAQ,EAAEpM,QAAQ,CAACoM,QAAD,CADD;AAEjBI,IAAAA,IAAI,EAAExM,QAAQ,CAACwM,IAAD;AAFG,GAAnB;AAKA,MAAIsB,IAAI,GAAG,MAAX;AACA,MAAIC,MAAM,GAAG,QAAb;AACA,MAAIC,EAAE,GAAG,IAAT;AACA,MAAIC,KAAK,GAAG,OAAZ;AACA,MAAIC,OAAO,GAAG,SAAd;AACA,MAAIC,MAAM,GAAG,QAAb;;AACA,MAAIC,SAAS,GAAG,YAAY;AAC1B,WAAOC,IAAI,CAAC;AACV/B,MAAAA,OAAO,EAAEvP,SADC;AAEVsP,MAAAA,OAAO,EAAEP,OAAO,CAACD,OAAR;AAFC,KAAD,CAAX;AAID,GALD;;AAMA,MAAIwC,IAAI,GAAG,UAAUC,IAAV,EAAgB;AACzB,QAAIhC,OAAO,GAAGgC,IAAI,CAAChC,OAAnB;AACA,QAAID,OAAO,GAAGiC,IAAI,CAACjC,OAAnB;;AACA,QAAIkC,SAAS,GAAG,UAAUlR,IAAV,EAAgB;AAC9B,aAAO,YAAY;AACjB,eAAOiP,OAAO,KAAKjP,IAAnB;AACD,OAFD;AAGD,KAJD;;AAKA,WAAO;AACLiP,MAAAA,OAAO,EAAEA,OADJ;AAELD,MAAAA,OAAO,EAAEA,OAFJ;AAGLmC,MAAAA,MAAM,EAAED,SAAS,CAACT,IAAD,CAHZ;AAILW,MAAAA,QAAQ,EAAEF,SAAS,CAACR,MAAD,CAJd;AAKLW,MAAAA,IAAI,EAAEH,SAAS,CAACP,EAAD,CALV;AAMLW,MAAAA,OAAO,EAAEJ,SAAS,CAACN,KAAD,CANb;AAOLW,MAAAA,SAAS,EAAEL,SAAS,CAACL,OAAD,CAPf;AAQLtD,MAAAA,QAAQ,EAAE2D,SAAS,CAACJ,MAAD;AARd,KAAP;AAUD,GAlBD;;AAmBA,MAAIU,OAAO,GAAG;AACZhD,IAAAA,OAAO,EAAEuC,SADG;AAEZ5C,IAAAA,EAAE,EAAE6C,IAFQ;AAGZP,IAAAA,IAAI,EAAE9N,QAAQ,CAAC8N,IAAD,CAHF;AAIZC,IAAAA,MAAM,EAAE/N,QAAQ,CAAC+N,MAAD,CAJJ;AAKZC,IAAAA,EAAE,EAAEhO,QAAQ,CAACgO,EAAD,CALA;AAMZC,IAAAA,KAAK,EAAEjO,QAAQ,CAACiO,KAAD,CANH;AAOZC,IAAAA,OAAO,EAAElO,QAAQ,CAACkO,OAAD,CAPL;AAQZC,IAAAA,MAAM,EAAEnO,QAAQ,CAACmO,MAAD;AARJ,GAAd;AAWA,MAAIW,OAAO,GAAG,SAAd;AACA,MAAIC,GAAG,GAAG,KAAV;AACA,MAAIC,OAAO,GAAG,SAAd;AACA,MAAIC,KAAK,GAAG,OAAZ;AACA,MAAIC,GAAG,GAAG,KAAV;AACA,MAAIC,OAAO,GAAG,SAAd;AACA,MAAIC,OAAO,GAAG,SAAd;AACA,MAAIC,QAAQ,GAAG,UAAf;;AACA,MAAIC,SAAS,GAAG,YAAY;AAC1B,WAAOC,IAAI,CAAC;AACVjD,MAAAA,OAAO,EAAEvP,SADC;AAEVsP,MAAAA,OAAO,EAAEP,OAAO,CAACD,OAAR;AAFC,KAAD,CAAX;AAID,GALD;;AAMA,MAAI0D,IAAI,GAAG,UAAUjB,IAAV,EAAgB;AACzB,QAAIhC,OAAO,GAAGgC,IAAI,CAAChC,OAAnB;AACA,QAAID,OAAO,GAAGiC,IAAI,CAACjC,OAAnB;;AACA,QAAImD,IAAI,GAAG,UAAUnS,IAAV,EAAgB;AACzB,aAAO,YAAY;AACjB,eAAOiP,OAAO,KAAKjP,IAAnB;AACD,OAFD;AAGD,KAJD;;AAKA,WAAO;AACLiP,MAAAA,OAAO,EAAEA,OADJ;AAELD,MAAAA,OAAO,EAAEA,OAFJ;AAGLoD,MAAAA,SAAS,EAAED,IAAI,CAACV,OAAD,CAHV;AAIL3E,MAAAA,KAAK,EAAEqF,IAAI,CAACT,GAAD,CAJN;AAKLxE,MAAAA,SAAS,EAAEiF,IAAI,CAACR,OAAD,CALV;AAMLU,MAAAA,KAAK,EAAEF,IAAI,CAACN,GAAD,CANN;AAOLS,MAAAA,OAAO,EAAEH,IAAI,CAACP,KAAD,CAPR;AAQLW,MAAAA,SAAS,EAAEJ,IAAI,CAACL,OAAD,CARV;AASLU,MAAAA,SAAS,EAAEL,IAAI,CAACJ,OAAD,CATV;AAULU,MAAAA,UAAU,EAAEN,IAAI,CAACH,QAAD;AAVX,KAAP;AAYD,GApBD;;AAqBA,MAAIU,eAAe,GAAG;AACpBlE,IAAAA,OAAO,EAAEyD,SADW;AAEpB9D,IAAAA,EAAE,EAAE+D,IAFgB;AAGpBT,IAAAA,OAAO,EAAE9O,QAAQ,CAAC8O,OAAD,CAHG;AAIpBC,IAAAA,GAAG,EAAE/O,QAAQ,CAAC+O,GAAD,CAJO;AAKpBC,IAAAA,OAAO,EAAEhP,QAAQ,CAACgP,OAAD,CALG;AAMpBC,IAAAA,KAAK,EAAEjP,QAAQ,CAACiP,KAAD,CANK;AAOpBC,IAAAA,GAAG,EAAElP,QAAQ,CAACkP,GAAD,CAPO;AAQpBC,IAAAA,OAAO,EAAEnP,QAAQ,CAACmP,OAAD,CARG;AASpBC,IAAAA,OAAO,EAAEpP,QAAQ,CAACoP,OAAD,CATG;AAUpBC,IAAAA,QAAQ,EAAErP,QAAQ,CAACqP,QAAD;AAVE,GAAtB;;AAaA,MAAIW,QAAQ,GAAG,UAAUhG,SAAV,EAAqBC,UAArB,EAAiC;AAC9C,QAAImC,QAAQ,GAAGyB,YAAY,CAACzB,QAAb,EAAf;AACA,QAAII,IAAI,GAAGqB,YAAY,CAACrB,IAAb,EAAX;AACA,QAAIzC,OAAO,GAAG0C,QAAQ,CAACN,aAAT,CAAuBC,QAAvB,EAAiCpC,SAAjC,EAA4CzI,IAA5C,CAAiDsN,OAAO,CAAChD,OAAzD,EAAkEgD,OAAO,CAACrD,EAA1E,CAAd;AACA,QAAI1B,EAAE,GAAG2C,QAAQ,CAACF,QAAT,CAAkBC,IAAlB,EAAwBxC,SAAxB,EAAmCzI,IAAnC,CAAwCwO,eAAe,CAAClE,OAAxD,EAAiEkE,eAAe,CAACvE,EAAjF,CAAT;AACA,QAAIyE,UAAU,GAAGpG,UAAU,CAACC,EAAD,EAAKC,OAAL,EAAcC,SAAd,EAAyBC,UAAzB,CAA3B;AACA,WAAO;AACLF,MAAAA,OAAO,EAAEA,OADJ;AAELD,MAAAA,EAAE,EAAEA,EAFC;AAGLmG,MAAAA,UAAU,EAAEA;AAHP,KAAP;AAKD,GAXD;;AAYA,MAAIC,iBAAiB,GAAG;AAAEzE,IAAAA,MAAM,EAAEuE;AAAV,GAAxB;;AAEA,MAAI/F,UAAU,GAAG,UAAUkG,KAAV,EAAiB;AAChC,WAAOC,MAAM,CAACC,UAAP,CAAkBF,KAAlB,EAAyBG,OAAhC;AACD,GAFD;;AAGA,MAAIC,QAAQ,GAAG5G,MAAM,CAAC,YAAY;AAChC,WAAOuG,iBAAiB,CAACzE,MAAlB,CAAyB+E,SAAS,CAACxG,SAAnC,EAA8CC,UAA9C,CAAP;AACD,GAFoB,CAArB;;AAGA,MAAIwG,QAAQ,GAAG,YAAY;AACzB,WAAOF,QAAQ,EAAf;AACD,GAFD;;AAIA,MAAIvG,SAAS,GAAGwG,SAAS,CAACxG,SAA1B;AACA,MAAI0G,UAAU,GAAGD,QAAQ,EAAzB;AACA,MAAI1G,OAAO,GAAG2G,UAAU,CAAC3G,OAAzB;AACA,MAAID,EAAE,GAAG4G,UAAU,CAAC5G,EAApB;AACA,MAAImG,UAAU,GAAGS,UAAU,CAACT,UAA5B;AACA,MAAIU,MAAM,GAAG,SAASvG,IAAT,CAAcJ,SAAd,KAA4B,CAACD,OAAO,CAACyE,MAAR,EAA1C;AACA,MAAIoC,OAAO,GAAG,cAAcR,MAAd,IAAwB,gBAAgBA,MAAxC,IAAkD,SAASA,MAA3D,IAAqE,CAAC,CAACS,GAAG,CAACC,eAAzF;AACA,MAAIC,YAAY,GAAG/G,SAAS,CAACxM,OAAV,CAAkB,eAAlB,MAAuC,CAAC,CAA3D;AACA,MAAIwT,GAAG,GAAG;AACR/C,IAAAA,KAAK,EAAElE,OAAO,CAAC4E,OAAR,EADC;AAERgC,IAAAA,MAAM,EAAEA,MAFA;AAGR3C,IAAAA,EAAE,EAAEjE,OAAO,CAAC2E,IAAR,MAAkB3E,OAAO,CAACyE,MAAR,EAAlB,GAAqCzE,OAAO,CAACsC,OAAR,CAAgBlB,KAArD,GAA6D,KAHzD;AAIR8F,IAAAA,KAAK,EAAElH,OAAO,CAAC6E,SAAR,EAJC;AAKRsC,IAAAA,GAAG,EAAEpH,EAAE,CAAC4F,KAAH,MAAc5F,EAAE,CAACK,KAAH,EALX;AAMRgH,IAAAA,GAAG,EAAElB,UAAU,CAAC/F,MAAX,MAAuB+F,UAAU,CAAC5F,QAAX,EANpB;AAOR2E,IAAAA,OAAO,EAAElF,EAAE,CAACS,SAAH,EAPD;AAQR6G,IAAAA,eAAe,EAAE,IART;AASRC,IAAAA,cAAc,EAAE,gFATR;AAURC,IAAAA,UAAU,EAAE,IAVJ;AAWRC,IAAAA,KAAK,EAAEnB,MAAM,CAACoB,YAAP,IAAuB,WAAWpB,MAXjC;AAYRqB,IAAAA,YAAY,EAAE1H,OAAO,CAAC2E,IAAR,KAAiBgD,QAAQ,CAACD,YAAT,IAAyB,CAA1C,GAA8C,EAZpD;AAaRb,IAAAA,OAAO,EAAEA,OAbD;AAcRe,IAAAA,OAAO,EAAE,IAdD;AAeRC,IAAAA,WAAW,EAAE,IAfL;AAgBRC,IAAAA,SAAS,EAAE,IAhBH;AAiBRC,IAAAA,qBAAqB,EAAE,KAjBf;AAkBRC,IAAAA,UAAU,EAAE,CAAChI,OAAO,CAAC2E,IAAR,EAlBL;AAmBRsD,IAAAA,OAAO,EAAE/B,UAAU,CAACpF,SAAX,EAnBD;AAoBRkG,IAAAA,YAAY,EAAEA,YApBN;AAqBRhH,IAAAA,OAAO,EAAE;AACPuC,MAAAA,OAAO,EAAEvC,OAAO,CAACuC,OADV;AAEPD,MAAAA,OAAO,EAAEtC,OAAO,CAACsC,OAFV;AAGPoC,MAAAA,QAAQ,EAAE1E,OAAO,CAAC0E,QAHX;AAIPD,MAAAA,MAAM,EAAEzE,OAAO,CAACyE,MAJT;AAKPI,MAAAA,SAAS,EAAE7E,OAAO,CAAC6E,SALZ;AAMPF,MAAAA,IAAI,EAAE3E,OAAO,CAAC2E,IANP;AAOPC,MAAAA,OAAO,EAAE5E,OAAO,CAAC4E,OAPV;AAQP/D,MAAAA,QAAQ,EAAEb,OAAO,CAACa;AARX,KArBD;AA+BRd,IAAAA,EAAE,EAAE;AACFwC,MAAAA,OAAO,EAAExC,EAAE,CAACwC,OADV;AAEFD,MAAAA,OAAO,EAAEvC,EAAE,CAACuC,OAFV;AAGF9B,MAAAA,SAAS,EAAET,EAAE,CAACS,SAHZ;AAIFuF,MAAAA,UAAU,EAAEhG,EAAE,CAACgG,UAJb;AAKFD,MAAAA,SAAS,EAAE/F,EAAE,CAAC+F,SALZ;AAMF1F,MAAAA,KAAK,EAAEL,EAAE,CAACK,KANR;AAOFwF,MAAAA,OAAO,EAAE7F,EAAE,CAAC6F,OAPV;AAQFD,MAAAA,KAAK,EAAE5F,EAAE,CAAC4F,KARR;AASFE,MAAAA,SAAS,EAAE9F,EAAE,CAAC8F,SATZ;AAUFH,MAAAA,SAAS,EAAE3F,EAAE,CAAC2F;AAVZ,KA/BI;AA2CRQ,IAAAA,UAAU,EAAE;AACVpF,MAAAA,SAAS,EAAEoF,UAAU,CAACpF,SADZ;AAEVX,MAAAA,MAAM,EAAE+F,UAAU,CAAC/F,MAFT;AAGVG,MAAAA,QAAQ,EAAE4F,UAAU,CAAC5F,QAHX;AAIVK,MAAAA,OAAO,EAAEuF,UAAU,CAACvF,OAJV;AAKVD,MAAAA,QAAQ,EAAEwF,UAAU,CAACxF,QALX;AAMVD,MAAAA,OAAO,EAAEyF,UAAU,CAACzF,OANV;AAOVM,MAAAA,SAAS,EAAEmF,UAAU,CAACnF;AAPZ;AA3CJ,GAAV;AAsDA,MAAImH,gBAAgB,GAAG,YAAvB;;AACA,MAAIC,MAAM,GAAG,UAAUvF,GAAV,EAAe;AAC1B,WAAOA,GAAG,KAAK,IAAR,IAAgBA,GAAG,KAAK5P,SAAxB,GAAoC,EAApC,GAAyC,CAAC,KAAK4P,GAAN,EAAWpB,OAAX,CAAmB0G,gBAAnB,EAAqC,EAArC,CAAhD;AACD,GAFD;;AAGA,MAAIxQ,EAAE,GAAG,UAAUgF,GAAV,EAAelD,IAAf,EAAqB;AAC5B,QAAI,CAACA,IAAL,EAAW;AACT,aAAOkD,GAAG,KAAK1J,SAAf;AACD;;AACD,QAAIwG,IAAI,KAAK,OAAT,IAAoBqE,SAAS,CAACnB,GAAD,CAAjC,EAAwC;AACtC,aAAO,IAAP;AACD;;AACD,WAAO,OAAOA,GAAP,KAAelD,IAAtB;AACD,GARD;;AASA,MAAI4O,OAAO,GAAG,UAAUC,KAAV,EAAiBC,KAAjB,EAAwBnQ,GAAxB,EAA6B;AACzC,QAAIzD,CAAJ;AACA2T,IAAAA,KAAK,GAAGA,KAAK,IAAI,EAAjB;AACAC,IAAAA,KAAK,GAAGA,KAAK,IAAI,GAAjB;;AACA,QAAI,OAAOD,KAAP,KAAiB,QAArB,EAA+B;AAC7BA,MAAAA,KAAK,GAAGA,KAAK,CAACE,KAAN,CAAYD,KAAZ,CAAR;AACD;;AACDnQ,IAAAA,GAAG,GAAGA,GAAG,IAAI,EAAb;AACAzD,IAAAA,CAAC,GAAG2T,KAAK,CAAC7T,MAAV;;AACA,WAAOE,CAAC,EAAR,EAAY;AACVyD,MAAAA,GAAG,CAACkQ,KAAK,CAAC3T,CAAD,CAAN,CAAH,GAAgB,EAAhB;AACD;;AACD,WAAOyD,GAAP;AACD,GAbD;;AAcA,MAAIqQ,gBAAgB,GAAG,UAAU9L,GAAV,EAAe+L,IAAf,EAAqB;AAC1C,WAAO3T,MAAM,CAAC3B,SAAP,CAAiBqJ,cAAjB,CAAgCzI,IAAhC,CAAqC2I,GAArC,EAA0C+L,IAA1C,CAAP;AACD,GAFD;;AAGA,MAAIC,MAAM,GAAG,UAAU1P,CAAV,EAAamG,CAAb,EAAgBwJ,IAAhB,EAAsB;AACjC,QAAI5P,IAAI,GAAG,IAAX;AACA,QAAI6P,EAAJ;AAAA,QAAQC,GAAR;AAAA,QAAaC,CAAb;AAAA,QAAgBC,EAAE,GAAG,CAArB;AACA/P,IAAAA,CAAC,GAAG,oCAAoCgQ,IAApC,CAAyChQ,CAAzC,CAAJ;AACA,QAAIiQ,EAAE,GAAGjQ,CAAC,CAAC,CAAD,CAAD,CAAKkQ,KAAL,CAAW,eAAX,EAA4B,CAA5B,CAAT;AACA,QAAIC,EAAE,GAAGpQ,IAAI,CAACqQ,QAAL,CAAcpQ,CAAC,CAAC,CAAD,CAAD,CAAKwI,OAAL,CAAa,QAAb,EAAuB,EAAvB,CAAd,EAA0CmH,IAA1C,CAAT;;AACA,QAAIQ,EAAE,CAACF,EAAD,CAAN,EAAY;AACV;AACD;;AACD,QAAIjQ,CAAC,CAAC,CAAD,CAAD,KAAS,QAAb,EAAuB;AACrBmQ,MAAAA,EAAE,CAACF,EAAD,CAAF,GAAS9J,CAAT;;AACA,UAAI,KAAKkK,QAAT,EAAmB;AACjB,aAAKA,QAAL,CAAcrQ,CAAC,CAAC,CAAD,CAAf,EAAoBA,CAAC,CAAC,CAAD,CAArB,EAA0BmQ,EAAE,CAACF,EAAD,CAA5B;AACD;;AACD;AACD;;AACD,QAAI,CAAC9J,CAAC,CAAC8J,EAAD,CAAN,EAAY;AACV9J,MAAAA,CAAC,CAAC8J,EAAD,CAAD,GAAQ5T,IAAR;AACA0T,MAAAA,EAAE,GAAG,CAAL;AACD;;AACDI,IAAAA,EAAE,CAACF,EAAD,CAAF,GAAS9J,CAAC,CAAC8J,EAAD,CAAV;AACAlQ,IAAAA,IAAI,CAACuQ,MAAL,CAAYH,EAAE,CAACF,EAAD,CAAF,CAAO9V,SAAnB,EAA8BgM,CAA9B;;AACA,QAAInG,CAAC,CAAC,CAAD,CAAL,EAAU;AACR4P,MAAAA,EAAE,GAAG7P,IAAI,CAACwQ,OAAL,CAAavQ,CAAC,CAAC,CAAD,CAAd,EAAmB7F,SAAxB;AACA0V,MAAAA,GAAG,GAAG7P,CAAC,CAAC,CAAD,CAAD,CAAKkQ,KAAL,CAAW,WAAX,EAAwB,CAAxB,CAAN;AACAJ,MAAAA,CAAC,GAAGK,EAAE,CAACF,EAAD,CAAN;;AACA,UAAIF,EAAJ,EAAQ;AACNI,QAAAA,EAAE,CAACF,EAAD,CAAF,GAAS,YAAY;AACnB,iBAAOL,EAAE,CAACC,GAAD,CAAF,CAAQjT,KAAR,CAAc,IAAd,EAAoBD,SAApB,CAAP;AACD,SAFD;AAGD,OAJD,MAIO;AACLwT,QAAAA,EAAE,CAACF,EAAD,CAAF,GAAS,YAAY;AACnB,eAAKO,MAAL,GAAcZ,EAAE,CAACC,GAAD,CAAhB;AACA,iBAAOC,CAAC,CAAClT,KAAF,CAAQ,IAAR,EAAcD,SAAd,CAAP;AACD,SAHD;AAID;;AACDwT,MAAAA,EAAE,CAACF,EAAD,CAAF,CAAO9V,SAAP,CAAiB8V,EAAjB,IAAuBE,EAAE,CAACF,EAAD,CAAzB;AACAlQ,MAAAA,IAAI,CAACX,IAAL,CAAUwQ,EAAV,EAAc,UAAU1U,CAAV,EAAaoD,CAAb,EAAgB;AAC5B6R,QAAAA,EAAE,CAACF,EAAD,CAAF,CAAO9V,SAAP,CAAiBmE,CAAjB,IAAsBsR,EAAE,CAACtR,CAAD,CAAxB;AACD,OAFD;AAGAyB,MAAAA,IAAI,CAACX,IAAL,CAAU+G,CAAV,EAAa,UAAUjL,CAAV,EAAaoD,CAAb,EAAgB;AAC3B,YAAIsR,EAAE,CAACtR,CAAD,CAAN,EAAW;AACT6R,UAAAA,EAAE,CAACF,EAAD,CAAF,CAAO9V,SAAP,CAAiBmE,CAAjB,IAAsB,YAAY;AAChC,iBAAKkS,MAAL,GAAcZ,EAAE,CAACtR,CAAD,CAAhB;AACA,mBAAOpD,CAAC,CAAC0B,KAAF,CAAQ,IAAR,EAAcD,SAAd,CAAP;AACD,WAHD;AAID,SALD,MAKO;AACL,cAAI2B,CAAC,KAAK2R,EAAV,EAAc;AACZE,YAAAA,EAAE,CAACF,EAAD,CAAF,CAAO9V,SAAP,CAAiBmE,CAAjB,IAAsBpD,CAAtB;AACD;AACF;AACF,OAXD;AAYD;;AACD6E,IAAAA,IAAI,CAACX,IAAL,CAAU+G,CAAC,CAACsK,MAAZ,EAAoB,UAAUvV,CAAV,EAAaoD,CAAb,EAAgB;AAClC6R,MAAAA,EAAE,CAACF,EAAD,CAAF,CAAO3R,CAAP,IAAYpD,CAAZ;AACD,KAFD;AAGD,GAxDD;;AAyDA,MAAIoV,MAAM,GAAG,UAAU5M,GAAV,EAAe;AAC1B,QAAIgN,IAAI,GAAG,EAAX;;AACA,SAAK,IAAIhU,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CgU,MAAAA,IAAI,CAAChU,EAAE,GAAG,CAAN,CAAJ,GAAeC,SAAS,CAACD,EAAD,CAAxB;AACD;;AACD,SAAK,IAAIhB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgV,IAAI,CAAClV,MAAzB,EAAiCE,CAAC,EAAlC,EAAsC;AACpC,UAAIiV,GAAG,GAAGD,IAAI,CAAChV,CAAD,CAAd;;AACA,WAAK,IAAIkV,MAAT,IAAmBD,GAAnB,EAAwB;AACtB,YAAIA,GAAG,CAACnN,cAAJ,CAAmBoN,MAAnB,CAAJ,EAAgC;AAC9B,cAAI1T,KAAK,GAAGyT,GAAG,CAACC,MAAD,CAAf;;AACA,cAAI1T,KAAK,KAAKlD,SAAd,EAAyB;AACvB0J,YAAAA,GAAG,CAACkN,MAAD,CAAH,GAAc1T,KAAd;AACD;AACF;AACF;AACF;;AACD,WAAOwG,GAAP;AACD,GAjBD;;AAkBA,MAAImN,IAAI,GAAG,UAAU3S,CAAV,EAAahD,CAAb,EAAgBoD,CAAhB,EAAmB0B,CAAnB,EAAsB;AAC/BA,IAAAA,CAAC,GAAGA,CAAC,IAAI,IAAT;;AACA,QAAI9B,CAAJ,EAAO;AACL,UAAII,CAAJ,EAAO;AACLJ,QAAAA,CAAC,GAAGA,CAAC,CAACI,CAAD,CAAL;AACD;;AACD0G,MAAAA,MAAM,CAAC9G,CAAD,EAAI,UAAUA,CAAV,EAAaxC,CAAb,EAAgB;AACxB,YAAIR,CAAC,CAACH,IAAF,CAAOiF,CAAP,EAAU9B,CAAV,EAAaxC,CAAb,EAAgB4C,CAAhB,MAAuB,KAA3B,EAAkC;AAChC,iBAAO,KAAP;AACD;;AACDuS,QAAAA,IAAI,CAAC3S,CAAD,EAAIhD,CAAJ,EAAOoD,CAAP,EAAU0B,CAAV,CAAJ;AACD,OALK,CAAN;AAMD;AACF,GAbD;;AAcA,MAAIoQ,QAAQ,GAAG,UAAU9R,CAAV,EAAaJ,CAAb,EAAgB;AAC7B,QAAIxC,CAAJ,EAAOuE,CAAP;AACA/B,IAAAA,CAAC,GAAGA,CAAC,IAAImP,MAAT;AACA/O,IAAAA,CAAC,GAAGA,CAAC,CAACiR,KAAF,CAAQ,GAAR,CAAJ;;AACA,SAAK7T,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG4C,CAAC,CAAC9C,MAAlB,EAA0BE,CAAC,EAA3B,EAA+B;AAC7BuE,MAAAA,CAAC,GAAG3B,CAAC,CAAC5C,CAAD,CAAL;;AACA,UAAI,CAACwC,CAAC,CAAC+B,CAAD,CAAN,EAAW;AACT/B,QAAAA,CAAC,CAAC+B,CAAD,CAAD,GAAO,EAAP;AACD;;AACD/B,MAAAA,CAAC,GAAGA,CAAC,CAAC+B,CAAD,CAAL;AACD;;AACD,WAAO/B,CAAP;AACD,GAZD;;AAaA,MAAIqS,OAAO,GAAG,UAAUjS,CAAV,EAAaJ,CAAb,EAAgB;AAC5B,QAAIxC,CAAJ,EAAOqJ,CAAP;AACA7G,IAAAA,CAAC,GAAGA,CAAC,IAAImP,MAAT;AACA/O,IAAAA,CAAC,GAAGA,CAAC,CAACiR,KAAF,CAAQ,GAAR,CAAJ;;AACA,SAAK7T,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAGzG,CAAC,CAAC9C,MAAlB,EAA0BE,CAAC,GAAGqJ,CAA9B,EAAiCrJ,CAAC,EAAlC,EAAsC;AACpCwC,MAAAA,CAAC,GAAGA,CAAC,CAACI,CAAC,CAAC5C,CAAD,CAAF,CAAL;;AACA,UAAI,CAACwC,CAAL,EAAQ;AACN;AACD;AACF;;AACD,WAAOA,CAAP;AACD,GAXD;;AAYA,MAAI4S,OAAO,GAAG,UAAU9Q,CAAV,EAAa+Q,CAAb,EAAgB;AAC5B,QAAI,CAAC/Q,CAAD,IAAMtB,EAAE,CAACsB,CAAD,EAAI,OAAJ,CAAZ,EAA0B;AACxB,aAAOA,CAAP;AACD;;AACD,WAAOkF,KAAK,CAAClF,CAAC,CAACuP,KAAF,CAAQwB,CAAC,IAAI,GAAb,CAAD,EAAoB5B,MAApB,CAAZ;AACD,GALD;;AAMA,MAAI6B,eAAe,GAAG,UAAUC,GAAV,EAAe;AACnC,QAAIpC,WAAW,GAAGZ,GAAG,CAACY,WAAtB;;AACA,QAAIA,WAAJ,EAAiB;AACfoC,MAAAA,GAAG,IAAI,CAACA,GAAG,CAACxW,OAAJ,CAAY,GAAZ,MAAqB,CAAC,CAAtB,GAA0B,GAA1B,GAAgC,GAAjC,IAAwCoU,WAA/C;AACD;;AACD,WAAOoC,GAAP;AACD,GAND;;AAOA,MAAIC,KAAK,GAAG;AACV3G,IAAAA,IAAI,EAAE4E,MADI;AAEVtO,IAAAA,OAAO,EAAEgE,SAFC;AAGVnG,IAAAA,EAAE,EAAEA,EAHM;AAIViB,IAAAA,OAAO,EAAEA,OAJC;AAKVyP,IAAAA,OAAO,EAAEA,OALC;AAMVhQ,IAAAA,IAAI,EAAE4F,MANI;AAOV7F,IAAAA,GAAG,EAAE+F,KAPK;AAQViM,IAAAA,IAAI,EAAE5L,QARI;AASV6L,IAAAA,OAAO,EAAE5L,SATC;AAUV6L,IAAAA,MAAM,EAAE7B,gBAVE;AAWVc,IAAAA,MAAM,EAAEA,MAXE;AAYVZ,IAAAA,MAAM,EAAEA,MAZE;AAaVmB,IAAAA,IAAI,EAAEA,IAbI;AAcVT,IAAAA,QAAQ,EAAEA,QAdA;AAeVG,IAAAA,OAAO,EAAEA,OAfC;AAgBVO,IAAAA,OAAO,EAAEA,OAhBC;AAiBVE,IAAAA,eAAe,EAAEA;AAjBP,GAAZ;;AAoBA,MAAIM,QAAQ,GAAG,UAAUC,IAAV,EAAgBC,KAAhB,EAAuB;AACpC,QAAIC,GAAG,GAAGD,KAAK,IAAI7C,QAAnB;AACA,QAAI+C,GAAG,GAAGD,GAAG,CAACE,aAAJ,CAAkB,KAAlB,CAAV;AACAD,IAAAA,GAAG,CAACE,SAAJ,GAAgBL,IAAhB;;AACA,QAAI,CAACG,GAAG,CAACG,aAAJ,EAAD,IAAwBH,GAAG,CAACI,UAAJ,CAAetW,MAAf,GAAwB,CAApD,EAAuD;AACrDuW,MAAAA,OAAO,CAACC,KAAR,CAAc,uCAAd,EAAuDT,IAAvD;AACA,YAAM,IAAI1T,KAAJ,CAAU,mCAAV,CAAN;AACD;;AACD,WAAOoU,OAAO,CAACP,GAAG,CAACI,UAAJ,CAAe,CAAf,CAAD,CAAd;AACD,GATD;;AAUA,MAAII,OAAO,GAAG,UAAUC,GAAV,EAAeX,KAAf,EAAsB;AAClC,QAAIC,GAAG,GAAGD,KAAK,IAAI7C,QAAnB;AACA,QAAIyD,IAAI,GAAGX,GAAG,CAACE,aAAJ,CAAkBQ,GAAlB,CAAX;AACA,WAAOF,OAAO,CAACG,IAAD,CAAd;AACD,GAJD;;AAKA,MAAIC,QAAQ,GAAG,UAAUC,IAAV,EAAgBd,KAAhB,EAAuB;AACpC,QAAIC,GAAG,GAAGD,KAAK,IAAI7C,QAAnB;AACA,QAAIyD,IAAI,GAAGX,GAAG,CAACc,cAAJ,CAAmBD,IAAnB,CAAX;AACA,WAAOL,OAAO,CAACG,IAAD,CAAd;AACD,GAJD;;AAKA,MAAIH,OAAO,GAAG,UAAUG,IAAV,EAAgB;AAC5B,QAAIA,IAAI,KAAK,IAAT,IAAiBA,IAAI,KAAKpY,SAA9B,EAAyC;AACvC,YAAM,IAAI6D,KAAJ,CAAU,kCAAV,CAAN;AACD;;AACD,WAAO;AAAE2U,MAAAA,GAAG,EAAEJ;AAAP,KAAP;AACD,GALD;;AAMA,MAAIK,SAAS,GAAG,UAAUC,MAAV,EAAkB3Y,CAAlB,EAAqBqB,CAArB,EAAwB;AACtC,WAAOiF,QAAQ,CAACD,IAAT,CAAcsS,MAAM,CAACF,GAAP,CAAWG,gBAAX,CAA4B5Y,CAA5B,EAA+BqB,CAA/B,CAAd,EAAiD+D,GAAjD,CAAqD8S,OAArD,CAAP;AACD,GAFD;;AAGA,MAAIW,YAAY,GAAG;AACjBtB,IAAAA,QAAQ,EAAEA,QADO;AAEjBY,IAAAA,OAAO,EAAEA,OAFQ;AAGjBG,IAAAA,QAAQ,EAAEA,QAHO;AAIjBJ,IAAAA,OAAO,EAAEA,OAJQ;AAKjBQ,IAAAA,SAAS,EAAEA;AALM,GAAnB;;AAQA,MAAII,SAAS,GAAG,UAAUjI,MAAV,EAAkB1P,CAAlB,EAAqB;AACnC,QAAIyG,CAAC,GAAG,EAAR;;AACA,QAAImR,OAAO,GAAG,UAAUzM,CAAV,EAAa;AACzB1E,MAAAA,CAAC,CAACH,IAAF,CAAO6E,CAAP;AACA,aAAOnL,CAAC,CAACmL,CAAD,CAAR;AACD,KAHD;;AAIA,QAAI0M,GAAG,GAAG7X,CAAC,CAAC0P,MAAD,CAAX;;AACA,OAAG;AACDmI,MAAAA,GAAG,GAAGA,GAAG,CAAC1T,IAAJ,CAASyT,OAAT,CAAN;AACD,KAFD,QAESC,GAAG,CAACpU,MAAJ,EAFT;;AAGA,WAAOgD,CAAP;AACD,GAXD;;AAaA,MAAIqR,uBAAuB,GAAG,UAAUhW,CAAV,EAAamD,CAAb,EAAgB+P,KAAhB,EAAuB;AACnD,WAAO,CAAClT,CAAC,CAACgW,uBAAF,CAA0B7S,CAA1B,IAA+B+P,KAAhC,MAA2C,CAAlD;AACD,GAFD;;AAGA,MAAI+C,2BAA2B,GAAG,UAAUjW,CAAV,EAAamD,CAAb,EAAgB;AAChD,WAAO6S,uBAAuB,CAAChW,CAAD,EAAImD,CAAJ,EAAO+S,IAAI,CAACC,8BAAZ,CAA9B;AACD,GAFD;;AAIA,MAAIC,OAAO,GAAG,CAAd;AACA,MAAIC,QAAQ,GAAG,CAAf;AACA,MAAIC,iBAAiB,GAAG,EAAxB;AACA,MAAIC,OAAO,GAAG,CAAd;AACA,MAAIC,IAAI,GAAG,CAAX;;AAEA,MAAIC,IAAI,GAAG,UAAUC,OAAV,EAAmBC,QAAnB,EAA6B;AACtC,QAAInB,GAAG,GAAGkB,OAAO,CAAClB,GAAlB;;AACA,QAAIA,GAAG,CAACoB,QAAJ,KAAiBL,OAArB,EAA8B;AAC5B,aAAO,KAAP;AACD,KAFD,MAEO;AACL,UAAIM,IAAI,GAAGrB,GAAX;;AACA,UAAIqB,IAAI,CAACtG,OAAL,KAAiBvT,SAArB,EAAgC;AAC9B,eAAO6Z,IAAI,CAACtG,OAAL,CAAaoG,QAAb,CAAP;AACD,OAFD,MAEO,IAAIE,IAAI,CAACC,iBAAL,KAA2B9Z,SAA/B,EAA0C;AAC/C,eAAO6Z,IAAI,CAACC,iBAAL,CAAuBH,QAAvB,CAAP;AACD,OAFM,MAEA,IAAIE,IAAI,CAACE,qBAAL,KAA+B/Z,SAAnC,EAA8C;AACnD,eAAO6Z,IAAI,CAACE,qBAAL,CAA2BJ,QAA3B,CAAP;AACD,OAFM,MAEA,IAAIE,IAAI,CAACG,kBAAL,KAA4Bha,SAAhC,EAA2C;AAChD,eAAO6Z,IAAI,CAACG,kBAAL,CAAwBL,QAAxB,CAAP;AACD,OAFM,MAEA;AACL,cAAM,IAAI9V,KAAJ,CAAU,gCAAV,CAAN;AACD;AACF;AACF,GAlBD;;AAmBA,MAAIoW,cAAc,GAAG,UAAUzB,GAAV,EAAe;AAClC,WAAOA,GAAG,CAACoB,QAAJ,KAAiBL,OAAjB,IAA4Bf,GAAG,CAACoB,QAAJ,KAAiBP,QAA7C,IAAyDb,GAAG,CAACoB,QAAJ,KAAiBN,iBAA1E,IAA+Fd,GAAG,CAAC0B,iBAAJ,KAA0B,CAAhI;AACD,GAFD;;AAGA,MAAI1W,GAAG,GAAG,UAAUmW,QAAV,EAAoBnC,KAApB,EAA2B;AACnC,QAAI2C,IAAI,GAAG3C,KAAK,KAAKxX,SAAV,GAAsB2U,QAAtB,GAAiC6C,KAAK,CAACgB,GAAlD;AACA,WAAOyB,cAAc,CAACE,IAAD,CAAd,GAAuB,EAAvB,GAA4BhV,GAAG,CAACgV,IAAI,CAACC,gBAAL,CAAsBT,QAAtB,CAAD,EAAkCf,YAAY,CAACX,OAA/C,CAAtC;AACD,GAHD;;AAIA,MAAIoC,GAAG,GAAG,UAAUV,QAAV,EAAoBnC,KAApB,EAA2B;AACnC,QAAI2C,IAAI,GAAG3C,KAAK,KAAKxX,SAAV,GAAsB2U,QAAtB,GAAiC6C,KAAK,CAACgB,GAAlD;AACA,WAAOyB,cAAc,CAACE,IAAD,CAAd,GAAuB9T,QAAQ,CAACrC,IAAT,EAAvB,GAAyCqC,QAAQ,CAACD,IAAT,CAAc+T,IAAI,CAACG,aAAL,CAAmBX,QAAnB,CAAd,EAA4CxU,GAA5C,CAAgDyT,YAAY,CAACX,OAA7D,CAAhD;AACD,GAHD;;AAKA,MAAIsC,IAAI,GAAG,UAAUC,EAAV,EAAcC,EAAd,EAAkB;AAC3B,WAAOD,EAAE,CAAChC,GAAH,KAAWiC,EAAE,CAACjC,GAArB;AACD,GAFD;;AAGA,MAAIkC,eAAe,GAAG,UAAUF,EAAV,EAAcC,EAAd,EAAkB;AACtC,QAAIE,EAAE,GAAGH,EAAE,CAAChC,GAAZ;AACA,QAAIoC,EAAE,GAAGH,EAAE,CAACjC,GAAZ;AACA,WAAOmC,EAAE,KAAKC,EAAP,GAAY,KAAZ,GAAoBD,EAAE,CAAC/S,QAAH,CAAYgT,EAAZ,CAA3B;AACD,GAJD;;AAKA,MAAIC,UAAU,GAAG,UAAUL,EAAV,EAAcC,EAAd,EAAkB;AACjC,WAAOxB,2BAA2B,CAACuB,EAAE,CAAChC,GAAJ,EAASiC,EAAE,CAACjC,GAAZ,CAAlC;AACD,GAFD;;AAGA,MAAIsC,UAAU,GAAG,UAAUN,EAAV,EAAcC,EAAd,EAAkB;AACjC,WAAO/G,QAAQ,GAAG1G,OAAX,CAAmB2E,IAAnB,KAA4BkJ,UAAU,CAACL,EAAD,EAAKC,EAAL,CAAtC,GAAiDC,eAAe,CAACF,EAAD,EAAKC,EAAL,CAAvE;AACD,GAFD;;AAIA,MAAIM,MAAM,GAAG,OAAO1H,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC2H,QAAQ,CAAC,cAAD,CAAR,EAAtD;;AAEA,MAAI1a,IAAI,GAAG,UAAUoZ,OAAV,EAAmB;AAC5B,QAAI/R,CAAC,GAAG+R,OAAO,CAAClB,GAAR,CAAYyC,QAApB;AACA,WAAOtT,CAAC,CAACkH,WAAF,EAAP;AACD,GAHD;;AAIA,MAAIrI,IAAI,GAAG,UAAUkT,OAAV,EAAmB;AAC5B,WAAOA,OAAO,CAAClB,GAAR,CAAYoB,QAAnB;AACD,GAFD;;AAGA,MAAIsB,QAAQ,GAAG,UAAUjb,CAAV,EAAa;AAC1B,WAAO,UAAUyZ,OAAV,EAAmB;AACxB,aAAOlT,IAAI,CAACkT,OAAD,CAAJ,KAAkBzZ,CAAzB;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIkb,SAAS,GAAG,UAAUzB,OAAV,EAAmB;AACjC,WAAOlT,IAAI,CAACkT,OAAD,CAAJ,KAAkBN,OAAlB,IAA6B9Y,IAAI,CAACoZ,OAAD,CAAJ,KAAkB,UAAtD;AACD,GAFD;;AAGA,MAAI0B,SAAS,GAAGF,QAAQ,CAAC3B,OAAD,CAAxB;AACA,MAAI8B,MAAM,GAAGH,QAAQ,CAAC1B,IAAD,CAArB;AACA,MAAI8B,UAAU,GAAGJ,QAAQ,CAAC7B,QAAD,CAAzB;AACA,MAAIkC,kBAAkB,GAAGL,QAAQ,CAAC5B,iBAAD,CAAjC;;AAEA,MAAIkC,KAAK,GAAG,UAAU9B,OAAV,EAAmB;AAC7B,WAAOd,YAAY,CAACX,OAAb,CAAqByB,OAAO,CAAClB,GAAR,CAAYiD,aAAjC,CAAP;AACD,GAFD;;AAGA,MAAIC,eAAe,GAAG,UAAUC,GAAV,EAAe;AACnC,WAAOL,UAAU,CAACK,GAAD,CAAV,GAAkBA,GAAlB,GAAwBH,KAAK,CAACG,GAAD,CAApC;AACD,GAFD;;AAGA,MAAIC,eAAe,GAAG,UAAUlC,OAAV,EAAmB;AACvC,WAAOd,YAAY,CAACX,OAAb,CAAqByD,eAAe,CAAChC,OAAD,CAAf,CAAyBlB,GAAzB,CAA6BoD,eAAlD,CAAP;AACD,GAFD;;AAGA,MAAIC,WAAW,GAAG,UAAUnC,OAAV,EAAmB;AACnC,WAAOd,YAAY,CAACX,OAAb,CAAqByD,eAAe,CAAChC,OAAD,CAAf,CAAyBlB,GAAzB,CAA6BqD,WAAlD,CAAP;AACD,GAFD;;AAGA,MAAIrF,MAAM,GAAG,UAAUkD,OAAV,EAAmB;AAC9B,WAAOrT,QAAQ,CAACD,IAAT,CAAcsT,OAAO,CAAClB,GAAR,CAAYsD,UAA1B,EAAsC3W,GAAtC,CAA0CyT,YAAY,CAACX,OAAvD,CAAP;AACD,GAFD;;AAGA,MAAI8D,OAAO,GAAG,UAAUrC,OAAV,EAAmBsC,MAAnB,EAA2B;AACvC,QAAIC,IAAI,GAAG9U,UAAU,CAAC6U,MAAD,CAAV,GAAqBA,MAArB,GAA8BlY,KAAzC;AACA,QAAI0U,GAAG,GAAGkB,OAAO,CAAClB,GAAlB;AACA,QAAI0D,GAAG,GAAG,EAAV;;AACA,WAAO1D,GAAG,CAACsD,UAAJ,KAAmB,IAAnB,IAA2BtD,GAAG,CAACsD,UAAJ,KAAmB9b,SAArD,EAAgE;AAC9D,UAAImc,SAAS,GAAG3D,GAAG,CAACsD,UAApB;AACA,UAAI3P,CAAC,GAAGyM,YAAY,CAACX,OAAb,CAAqBkE,SAArB,CAAR;AACAD,MAAAA,GAAG,CAAC1U,IAAJ,CAAS2E,CAAT;;AACA,UAAI8P,IAAI,CAAC9P,CAAD,CAAJ,KAAY,IAAhB,EAAsB;AACpB;AACD,OAFD,MAEO;AACLqM,QAAAA,GAAG,GAAG2D,SAAN;AACD;AACF;;AACD,WAAOD,GAAP;AACD,GAfD;;AAgBA,MAAIE,QAAQ,GAAG,UAAU1C,OAAV,EAAmB;AAChC,QAAI2C,UAAU,GAAG,UAAUC,QAAV,EAAoB;AACnC,aAAO9W,MAAM,CAAC8W,QAAD,EAAW,UAAUvc,CAAV,EAAa;AACnC,eAAO,CAACwa,IAAI,CAACb,OAAD,EAAU3Z,CAAV,CAAZ;AACD,OAFY,CAAb;AAGD,KAJD;;AAKA,WAAOyW,MAAM,CAACkD,OAAD,CAAN,CAAgBvU,GAAhB,CAAoBoX,QAApB,EAA8BpX,GAA9B,CAAkCkX,UAAlC,EAA8CzX,KAA9C,CAAoD,EAApD,CAAP;AACD,GAPD;;AAQA,MAAI4X,WAAW,GAAG,UAAU9C,OAAV,EAAmB;AACnC,WAAOrT,QAAQ,CAACD,IAAT,CAAcsT,OAAO,CAAClB,GAAR,CAAYiE,eAA1B,EAA2CtX,GAA3C,CAA+CyT,YAAY,CAACX,OAA5D,CAAP;AACD,GAFD;;AAGA,MAAIyE,WAAW,GAAG,UAAUhD,OAAV,EAAmB;AACnC,WAAOrT,QAAQ,CAACD,IAAT,CAAcsT,OAAO,CAAClB,GAAR,CAAYkE,WAA1B,EAAuCvX,GAAvC,CAA2CyT,YAAY,CAACX,OAAxD,CAAP;AACD,GAFD;;AAGA,MAAI0E,YAAY,GAAG,UAAUjD,OAAV,EAAmB;AACpC,WAAO/Q,OAAO,CAACkQ,SAAS,CAACa,OAAD,EAAU8C,WAAV,CAAV,CAAd;AACD,GAFD;;AAGA,MAAII,YAAY,GAAG,UAAUlD,OAAV,EAAmB;AACpC,WAAOb,SAAS,CAACa,OAAD,EAAUgD,WAAV,CAAhB;AACD,GAFD;;AAGA,MAAIH,QAAQ,GAAG,UAAU7C,OAAV,EAAmB;AAChC,WAAOvU,GAAG,CAACuU,OAAO,CAAClB,GAAR,CAAYV,UAAb,EAAyBc,YAAY,CAACX,OAAtC,CAAV;AACD,GAFD;;AAGA,MAAI4E,KAAK,GAAG,UAAUnD,OAAV,EAAmBpO,KAAnB,EAA0B;AACpC,QAAIwR,EAAE,GAAGpD,OAAO,CAAClB,GAAR,CAAYV,UAArB;AACA,WAAOzR,QAAQ,CAACD,IAAT,CAAc0W,EAAE,CAACxR,KAAD,CAAhB,EAAyBnG,GAAzB,CAA6ByT,YAAY,CAACX,OAA1C,CAAP;AACD,GAHD;;AAIA,MAAI8E,UAAU,GAAG,UAAUrD,OAAV,EAAmB;AAClC,WAAOmD,KAAK,CAACnD,OAAD,EAAU,CAAV,CAAZ;AACD,GAFD;;AAGA,MAAIsD,SAAS,GAAG,UAAUtD,OAAV,EAAmB;AACjC,WAAOmD,KAAK,CAACnD,OAAD,EAAUA,OAAO,CAAClB,GAAR,CAAYV,UAAZ,CAAuBtW,MAAvB,GAAgC,CAA1C,CAAZ;AACD,GAFD;;AAGA,MAAIyb,eAAe,GAAG,UAAUvD,OAAV,EAAmB;AACvC,WAAOA,OAAO,CAAClB,GAAR,CAAYV,UAAZ,CAAuBtW,MAA9B;AACD,GAFD;;AAIA,MAAI0b,OAAO,GAAG,UAAUzF,GAAV,EAAe;AAC3B,QAAItR,CAAC,GAAGsR,GAAG,CAACe,GAAJ,CAAQpP,IAAhB;;AACA,QAAIjD,CAAC,KAAK,IAAN,IAAcA,CAAC,KAAKnG,SAAxB,EAAmC;AACjC,YAAM,IAAI6D,KAAJ,CAAU,2BAAV,CAAN;AACD;;AACD,WAAO+U,YAAY,CAACX,OAAb,CAAqB9R,CAArB,CAAP;AACD,GAND;;AAQA,MAAIgX,YAAY,GAAG,UAAUxB,GAAV,EAAe;AAChC,WAAOJ,kBAAkB,CAACI,GAAD,CAAlB,IAA2BzU,aAAa,CAACyU,GAAG,CAACnD,GAAJ,CAAQ4E,IAAT,CAA/C;AACD,GAFD;;AAGA,MAAIC,SAAS,GAAGlW,UAAU,CAACmW,OAAO,CAACnd,SAAR,CAAkBod,YAAnB,CAAV,IAA8CpW,UAAU,CAAC+R,IAAI,CAAC/Y,SAAL,CAAeqd,WAAhB,CAAxE;AACA,MAAIC,WAAW,GAAGxa,QAAQ,CAACoa,SAAD,CAA1B;AACA,MAAIG,WAAW,GAAGH,SAAS,GAAG,UAAUhR,CAAV,EAAa;AACzC,WAAOuM,YAAY,CAACX,OAAb,CAAqB5L,CAAC,CAACmM,GAAF,CAAMgF,WAAN,EAArB,CAAP;AACD,GAF0B,GAEvB9B,eAFJ;;AAGA,MAAIgC,iBAAiB,GAAG,UAAU/B,GAAV,EAAe;AACrC,WAAOwB,YAAY,CAACxB,GAAD,CAAZ,GAAoBA,GAApB,GAA0BuB,OAAO,CAACxB,eAAe,CAACC,GAAD,CAAhB,CAAxC;AACD,GAFD;;AAGA,MAAIgC,aAAa,GAAG,UAAUtR,CAAV,EAAa;AAC/B,QAAI1E,CAAC,GAAG6V,WAAW,CAACnR,CAAD,CAAnB;AACA,WAAO8Q,YAAY,CAACxV,CAAD,CAAZ,GAAkBtB,QAAQ,CAACR,IAAT,CAAc8B,CAAd,CAAlB,GAAqCtB,QAAQ,CAACrC,IAAT,EAA5C;AACD,GAHD;;AAIA,MAAI4Z,aAAa,GAAG,UAAUvR,CAAV,EAAa;AAC/B,WAAOuM,YAAY,CAACX,OAAb,CAAqB5L,CAAC,CAACmM,GAAF,CAAM4E,IAA3B,CAAP;AACD,GAFD;;AAGA,MAAIS,sBAAsB,GAAG,UAAUC,KAAV,EAAiB;AAC5C,QAAIL,WAAW,MAAMvW,aAAa,CAAC4W,KAAK,CAAClN,MAAP,CAAlC,EAAkD;AAChD,UAAImN,EAAE,GAAGnF,YAAY,CAACX,OAAb,CAAqB6F,KAAK,CAAClN,MAA3B,CAAT;;AACA,UAAIwK,SAAS,CAAC2C,EAAD,CAAT,IAAiBC,gBAAgB,CAACD,EAAD,CAArC,EAA2C;AACzC,YAAID,KAAK,CAACG,QAAN,IAAkBH,KAAK,CAACI,YAA5B,EAA0C;AACxC,cAAIA,YAAY,GAAGJ,KAAK,CAACI,YAAN,EAAnB;;AACA,cAAIA,YAAJ,EAAkB;AAChB,mBAAO9U,IAAI,CAAC8U,YAAD,CAAX;AACD;AACF;AACF;AACF;;AACD,WAAO7X,QAAQ,CAACD,IAAT,CAAc0X,KAAK,CAAClN,MAApB,CAAP;AACD,GAbD;;AAcA,MAAIoN,gBAAgB,GAAG,UAAUtE,OAAV,EAAmB;AACxC,WAAOxS,aAAa,CAACwS,OAAO,CAAClB,GAAR,CAAY2F,UAAb,CAApB;AACD,GAFD;;AAIA,MAAIC,MAAM,GAAG,UAAUC,MAAV,EAAkB3E,OAAlB,EAA2B;AACtC,QAAI4E,QAAQ,GAAG9H,MAAM,CAAC6H,MAAD,CAArB;AACAC,IAAAA,QAAQ,CAAClZ,IAAT,CAAc,UAAUa,CAAV,EAAa;AACzBA,MAAAA,CAAC,CAACuS,GAAF,CAAM+F,YAAN,CAAmB7E,OAAO,CAAClB,GAA3B,EAAgC6F,MAAM,CAAC7F,GAAvC;AACD,KAFD;AAGD,GALD;;AAMA,MAAIgG,KAAK,GAAG,UAAUH,MAAV,EAAkB3E,OAAlB,EAA2B;AACrC,QAAI+E,OAAO,GAAG/B,WAAW,CAAC2B,MAAD,CAAzB;AACAI,IAAAA,OAAO,CAACja,IAAR,CAAa,YAAY;AACvB,UAAI8Z,QAAQ,GAAG9H,MAAM,CAAC6H,MAAD,CAArB;AACAC,MAAAA,QAAQ,CAAClZ,IAAT,CAAc,UAAUa,CAAV,EAAa;AACzByY,QAAAA,MAAM,CAACzY,CAAD,EAAIyT,OAAJ,CAAN;AACD,OAFD;AAGD,KALD,EAKG,UAAUzT,CAAV,EAAa;AACdmY,MAAAA,MAAM,CAACnY,CAAD,EAAIyT,OAAJ,CAAN;AACD,KAPD;AAQD,GAVD;;AAWA,MAAIiF,OAAO,GAAG,UAAUnI,MAAV,EAAkBkD,OAAlB,EAA2B;AACvC,QAAIkF,YAAY,GAAG7B,UAAU,CAACvG,MAAD,CAA7B;AACAoI,IAAAA,YAAY,CAACpa,IAAb,CAAkB,YAAY;AAC5Bka,MAAAA,MAAM,CAAClI,MAAD,EAASkD,OAAT,CAAN;AACD,KAFD,EAEG,UAAUzT,CAAV,EAAa;AACduQ,MAAAA,MAAM,CAACgC,GAAP,CAAW+F,YAAX,CAAwB7E,OAAO,CAAClB,GAAhC,EAAqCvS,CAAC,CAACuS,GAAvC;AACD,KAJD;AAKD,GAPD;;AAQA,MAAIkG,MAAM,GAAG,UAAUlI,MAAV,EAAkBkD,OAAlB,EAA2B;AACtClD,IAAAA,MAAM,CAACgC,GAAP,CAAWqG,WAAX,CAAuBnF,OAAO,CAAClB,GAA/B;AACD,GAFD;;AAGA,MAAIsG,IAAI,GAAG,UAAUpF,OAAV,EAAmBqF,OAAnB,EAA4B;AACrCX,IAAAA,MAAM,CAAC1E,OAAD,EAAUqF,OAAV,CAAN;AACAL,IAAAA,MAAM,CAACK,OAAD,EAAUrF,OAAV,CAAN;AACD,GAHD;;AAKA,MAAIsF,QAAQ,GAAG,UAAUX,MAAV,EAAkB/B,QAAlB,EAA4B;AACzClX,IAAAA,IAAI,CAACkX,QAAD,EAAW,UAAUvc,CAAV,EAAa;AAC1Bqe,MAAAA,MAAM,CAACC,MAAD,EAASte,CAAT,CAAN;AACD,KAFG,CAAJ;AAGD,GAJD;;AAKA,MAAIkf,QAAQ,GAAG,UAAUzI,MAAV,EAAkB8F,QAAlB,EAA4B;AACzClX,IAAAA,IAAI,CAACkX,QAAD,EAAW,UAAUvc,CAAV,EAAa;AAC1B2e,MAAAA,MAAM,CAAClI,MAAD,EAASzW,CAAT,CAAN;AACD,KAFG,CAAJ;AAGD,GAJD;;AAMA,MAAImf,KAAK,GAAG,UAAUxF,OAAV,EAAmB;AAC7BA,IAAAA,OAAO,CAAClB,GAAR,CAAY2G,WAAZ,GAA0B,EAA1B;AACA/Z,IAAAA,IAAI,CAACmX,QAAQ,CAAC7C,OAAD,CAAT,EAAoB,UAAU0F,KAAV,EAAiB;AACvCC,MAAAA,MAAM,CAACD,KAAD,CAAN;AACD,KAFG,CAAJ;AAGD,GALD;;AAMA,MAAIC,MAAM,GAAG,UAAU3F,OAAV,EAAmB;AAC9B,QAAIlB,GAAG,GAAGkB,OAAO,CAAClB,GAAlB;;AACA,QAAIA,GAAG,CAACsD,UAAJ,KAAmB,IAAvB,EAA6B;AAC3BtD,MAAAA,GAAG,CAACsD,UAAJ,CAAewD,WAAf,CAA2B9G,GAA3B;AACD;AACF,GALD;;AAMA,MAAI+G,MAAM,GAAG,UAAUR,OAAV,EAAmB;AAC9B,QAAIS,UAAU,GAAGjD,QAAQ,CAACwC,OAAD,CAAzB;;AACA,QAAIS,UAAU,CAAChe,MAAX,GAAoB,CAAxB,EAA2B;AACzBwd,MAAAA,QAAQ,CAACD,OAAD,EAAUS,UAAV,CAAR;AACD;;AACDH,IAAAA,MAAM,CAACN,OAAD,CAAN;AACD,GAND;;AAQA,MAAIU,MAAM,GAAG,UAAU/F,OAAV,EAAmB;AAC9B,QAAIlB,GAAG,GAAG6C,MAAM,CAAC3B,OAAD,CAAN,GAAkBA,OAAO,CAAClB,GAAR,CAAYsD,UAA9B,GAA2CpC,OAAO,CAAClB,GAA7D;;AACA,QAAIA,GAAG,KAAKxY,SAAR,IAAqBwY,GAAG,KAAK,IAA7B,IAAqCA,GAAG,CAACiD,aAAJ,KAAsB,IAA/D,EAAqE;AACnE,aAAO,KAAP;AACD;;AACD,QAAIhE,GAAG,GAAGe,GAAG,CAACiD,aAAd;AACA,WAAOkC,aAAa,CAAC/E,YAAY,CAACX,OAAb,CAAqBO,GAArB,CAAD,CAAb,CAAyChU,IAAzC,CAA8C,YAAY;AAC/D,aAAOiT,GAAG,CAACiI,IAAJ,CAAS9X,QAAT,CAAkB4Q,GAAlB,CAAP;AACD,KAFM,EAEJ3V,QAAQ,CAAC4c,MAAD,EAAS7B,aAAT,CAFJ,CAAP;AAGD,GATD;;AAWA,MAAIjW,CAAC,GAAG,UAAUgY,IAAV,EAAgBC,GAAhB,EAAqB;AAC3B,QAAIC,SAAS,GAAG,UAAU9f,CAAV,EAAaqB,CAAb,EAAgB;AAC9B,aAAOuG,CAAC,CAACgY,IAAI,GAAG5f,CAAR,EAAW6f,GAAG,GAAGxe,CAAjB,CAAR;AACD,KAFD;;AAGA,WAAO;AACLue,MAAAA,IAAI,EAAEA,IADD;AAELC,MAAAA,GAAG,EAAEA,GAFA;AAGLC,MAAAA,SAAS,EAAEA;AAHN,KAAP;AAKD,GATD;;AAUA,MAAIC,aAAa,GAAGnY,CAApB;;AAEA,MAAIoY,WAAW,GAAG,UAAUvH,GAAV,EAAe;AAC/B,QAAIwH,GAAG,GAAGxH,GAAG,CAACyH,qBAAJ,EAAV;AACA,WAAOH,aAAa,CAACE,GAAG,CAACL,IAAL,EAAWK,GAAG,CAACJ,GAAf,CAApB;AACD,GAHD;;AAIA,MAAIM,kBAAkB,GAAG,UAAUld,CAAV,EAAamD,CAAb,EAAgB;AACvC,QAAInD,CAAC,KAAKhD,SAAV,EAAqB;AACnB,aAAOgD,CAAP;AACD,KAFD,MAEO;AACL,aAAOmD,CAAC,KAAKnG,SAAN,GAAkBmG,CAAlB,GAAsB,CAA7B;AACD;AACF,GAND;;AAOA,MAAIga,QAAQ,GAAG,UAAUzG,OAAV,EAAmB;AAChC,QAAIjC,GAAG,GAAGiC,OAAO,CAAClB,GAAR,CAAYiD,aAAtB;AACA,QAAIiE,IAAI,GAAGjI,GAAG,CAACiI,IAAf;AACA,QAAIU,GAAG,GAAG3I,GAAG,CAACoE,WAAd;AACA,QAAItE,IAAI,GAAGE,GAAG,CAACmE,eAAf;;AACA,QAAI8D,IAAI,KAAKhG,OAAO,CAAClB,GAArB,EAA0B;AACxB,aAAOsH,aAAa,CAACJ,IAAI,CAACW,UAAN,EAAkBX,IAAI,CAACY,SAAvB,CAApB;AACD;;AACD,QAAIC,SAAS,GAAGL,kBAAkB,CAACE,GAAG,KAAK,IAAR,IAAgBA,GAAG,KAAK,KAAK,CAA7B,GAAiC,KAAK,CAAtC,GAA0CA,GAAG,CAACI,WAA/C,EAA4DjJ,IAAI,CAACgJ,SAAjE,CAAlC;AACA,QAAIE,UAAU,GAAGP,kBAAkB,CAACE,GAAG,KAAK,IAAR,IAAgBA,GAAG,KAAK,KAAK,CAA7B,GAAiC,KAAK,CAAtC,GAA0CA,GAAG,CAACM,WAA/C,EAA4DnJ,IAAI,CAACkJ,UAAjE,CAAnC;AACA,QAAIE,SAAS,GAAGT,kBAAkB,CAAC3I,IAAI,CAACoJ,SAAN,EAAiBjB,IAAI,CAACiB,SAAtB,CAAlC;AACA,QAAIC,UAAU,GAAGV,kBAAkB,CAAC3I,IAAI,CAACqJ,UAAN,EAAkBlB,IAAI,CAACkB,UAAvB,CAAnC;AACA,WAAOC,QAAQ,CAACnH,OAAD,CAAR,CAAkBmG,SAAlB,CAA4BY,UAAU,GAAGG,UAAzC,EAAqDL,SAAS,GAAGI,SAAjE,CAAP;AACD,GAbD;;AAcA,MAAIE,QAAQ,GAAG,UAAUnH,OAAV,EAAmB;AAChC,QAAIlB,GAAG,GAAGkB,OAAO,CAAClB,GAAlB;AACA,QAAIf,GAAG,GAAGe,GAAG,CAACiD,aAAd;AACA,QAAIiE,IAAI,GAAGjI,GAAG,CAACiI,IAAf;;AACA,QAAIA,IAAI,KAAKlH,GAAb,EAAkB;AAChB,aAAOsH,aAAa,CAACJ,IAAI,CAACW,UAAN,EAAkBX,IAAI,CAACY,SAAvB,CAApB;AACD;;AACD,QAAI,CAACb,MAAM,CAAC/F,OAAD,CAAX,EAAsB;AACpB,aAAOoG,aAAa,CAAC,CAAD,EAAI,CAAJ,CAApB;AACD;;AACD,WAAOC,WAAW,CAACvH,GAAD,CAAlB;AACD,GAXD;;AAaA,MAAIsI,KAAK,GAAG,UAAUC,IAAV,EAAgB;AAC1B,QAAItJ,GAAG,GAAGsJ,IAAI,KAAK/gB,SAAT,GAAqB+gB,IAAI,CAACvI,GAA1B,GAAgC7D,QAA1C;AACA,QAAI5U,CAAC,GAAG0X,GAAG,CAACiI,IAAJ,CAASe,UAAT,IAAuBhJ,GAAG,CAACmE,eAAJ,CAAoB6E,UAAnD;AACA,QAAIrf,CAAC,GAAGqW,GAAG,CAACiI,IAAJ,CAASa,SAAT,IAAsB9I,GAAG,CAACmE,eAAJ,CAAoB2E,SAAlD;AACA,WAAOT,aAAa,CAAC/f,CAAD,EAAIqB,CAAJ,CAApB;AACD,GALD;;AAMA,MAAI4f,EAAE,GAAG,UAAUjhB,CAAV,EAAaqB,CAAb,EAAgB2f,IAAhB,EAAsB;AAC7B,QAAItJ,GAAG,GAAGsJ,IAAI,KAAK/gB,SAAT,GAAqB+gB,IAAI,CAACvI,GAA1B,GAAgC7D,QAA1C;AACA,QAAIyL,GAAG,GAAG3I,GAAG,CAACoE,WAAd;;AACA,QAAIuE,GAAJ,EAAS;AACPA,MAAAA,GAAG,CAACa,QAAJ,CAAalhB,CAAb,EAAgBqB,CAAhB;AACD;AACF,GAND;;AAOA,MAAI8f,QAAQ,GAAG,UAAUxH,OAAV,EAAmByH,UAAnB,EAA+B;AAC5C,QAAItT,QAAQ,GAAG6F,QAAQ,GAAG1G,OAAX,CAAmBa,QAAnB,EAAf;;AACA,QAAIA,QAAQ,IAAI1G,UAAU,CAACuS,OAAO,CAAClB,GAAR,CAAY4I,sBAAb,CAA1B,EAAgE;AAC9D1H,MAAAA,OAAO,CAAClB,GAAR,CAAY4I,sBAAZ,CAAmC,KAAnC;AACD,KAFD,MAEO;AACL1H,MAAAA,OAAO,CAAClB,GAAR,CAAY6I,cAAZ,CAA2BF,UAA3B;AACD;AACF,GAPD;;AASA,MAAIG,KAAK,GAAG,UAAUC,IAAV,EAAgB;AAC1B,QAAInB,GAAG,GAAGmB,IAAI,KAAKvhB,SAAT,GAAqBqT,MAArB,GAA8BkO,IAAxC;AACA,WAAOlb,QAAQ,CAACD,IAAT,CAAcga,GAAG,CAAC,gBAAD,CAAjB,CAAP;AACD,GAHD;;AAIA,MAAIoB,MAAM,GAAG,UAAUzhB,CAAV,EAAaqB,CAAb,EAAgBqgB,KAAhB,EAAuBC,MAAvB,EAA+B;AAC1C,WAAO;AACL3hB,MAAAA,CAAC,EAAEA,CADE;AAELqB,MAAAA,CAAC,EAAEA,CAFE;AAGLqgB,MAAAA,KAAK,EAAEA,KAHF;AAILC,MAAAA,MAAM,EAAEA,MAJH;AAKLC,MAAAA,KAAK,EAAE5hB,CAAC,GAAG0hB,KALN;AAMLG,MAAAA,MAAM,EAAExgB,CAAC,GAAGsgB;AANP,KAAP;AAQD,GATD;;AAUA,MAAIG,SAAS,GAAG,UAAUN,IAAV,EAAgB;AAC9B,QAAInB,GAAG,GAAGmB,IAAI,KAAKvhB,SAAT,GAAqBqT,MAArB,GAA8BkO,IAAxC;AACA,QAAI9J,GAAG,GAAG2I,GAAG,CAACzL,QAAd;AACA,QAAImN,MAAM,GAAGhB,KAAK,CAAClI,YAAY,CAACX,OAAb,CAAqBR,GAArB,CAAD,CAAlB;AACA,WAAO6J,KAAK,CAAClB,GAAD,CAAL,CAAW5b,IAAX,CAAgB,YAAY;AACjC,UAAI+S,IAAI,GAAG6I,GAAG,CAACzL,QAAJ,CAAaiH,eAAxB;AACA,UAAI6F,KAAK,GAAGlK,IAAI,CAACwK,WAAjB;AACA,UAAIL,MAAM,GAAGnK,IAAI,CAACyK,YAAlB;AACA,aAAOR,MAAM,CAACM,MAAM,CAACnC,IAAR,EAAcmC,MAAM,CAAClC,GAArB,EAA0B6B,KAA1B,EAAiCC,MAAjC,CAAb;AACD,KALM,EAKJ,UAAUO,cAAV,EAA0B;AAC3B,aAAOT,MAAM,CAACU,IAAI,CAACC,GAAL,CAASF,cAAc,CAACG,QAAxB,EAAkCN,MAAM,CAACnC,IAAzC,CAAD,EAAiDuC,IAAI,CAACC,GAAL,CAASF,cAAc,CAACI,OAAxB,EAAiCP,MAAM,CAAClC,GAAxC,CAAjD,EAA+FqC,cAAc,CAACR,KAA9G,EAAqHQ,cAAc,CAACP,MAApI,CAAb;AACD,KAPM,CAAP;AAQD,GAZD;;AAcA,MAAIY,UAAU,GAAG,UAAU9b,IAAV,EAAgB;AAC/B,WAAO,UAAU4R,IAAV,EAAgB;AACrB,aAAO,CAAC,CAACA,IAAF,IAAUA,IAAI,CAACwB,QAAL,KAAkBpT,IAAnC;AACD,KAFD;AAGD,GAJD;;AAKA,MAAI+b,gBAAgB,GAAG,UAAUnK,IAAV,EAAgB;AACrC,WAAO,CAAC,CAACA,IAAF,IAAU,CAACtW,MAAM,CAAC0gB,cAAP,CAAsBpK,IAAtB,CAAlB;AACD,GAFD;;AAGA,MAAIqK,WAAW,GAAGH,UAAU,CAAC,CAAD,CAA5B;;AACA,MAAII,cAAc,GAAG,UAAUC,KAAV,EAAiB;AACpC,QAAIC,eAAe,GAAGD,KAAK,CAACxd,GAAN,CAAU,UAAUa,CAAV,EAAa;AAC3C,aAAOA,CAAC,CAAC6I,WAAF,EAAP;AACD,KAFqB,CAAtB;AAGA,WAAO,UAAUuJ,IAAV,EAAgB;AACrB,UAAIA,IAAI,IAAIA,IAAI,CAAC6C,QAAjB,EAA2B;AACzB,YAAIA,QAAQ,GAAG7C,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,EAAf;AACA,eAAOjH,QAAQ,CAACgb,eAAD,EAAkB3H,QAAlB,CAAf;AACD;;AACD,aAAO,KAAP;AACD,KAND;AAOD,GAXD;;AAYA,MAAI4H,gBAAgB,GAAG,UAAUviB,IAAV,EAAgBiK,MAAhB,EAAwB;AAC7C,QAAI8K,KAAK,GAAG9K,MAAM,CAACsE,WAAP,GAAqB0G,KAArB,CAA2B,GAA3B,CAAZ;AACA,WAAO,UAAU6C,IAAV,EAAgB;AACrB,UAAI1W,CAAJ,EAAOohB,QAAP;;AACA,UAAIL,WAAW,CAACrK,IAAD,CAAf,EAAuB;AACrB,aAAK1W,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG2T,KAAK,CAAC7T,MAAtB,EAA8BE,CAAC,EAA/B,EAAmC;AACjC,cAAIqhB,QAAQ,GAAG3K,IAAI,CAACqD,aAAL,CAAmBI,WAAnB,CAA+BmH,gBAA/B,CAAgD5K,IAAhD,EAAsD,IAAtD,CAAf;AACA0K,UAAAA,QAAQ,GAAGC,QAAQ,GAAGA,QAAQ,CAACE,gBAAT,CAA0B3iB,IAA1B,CAAH,GAAqC,IAAxD;;AACA,cAAIwiB,QAAQ,KAAKzN,KAAK,CAAC3T,CAAD,CAAtB,EAA2B;AACzB,mBAAO,IAAP;AACD;AACF;AACF;;AACD,aAAO,KAAP;AACD,KAZD;AAaD,GAfD;;AAgBA,MAAIwhB,YAAY,GAAG,UAAUC,QAAV,EAAoB;AACrC,WAAO,UAAU/K,IAAV,EAAgB;AACrB,aAAOqK,WAAW,CAACrK,IAAD,CAAX,IAAqBA,IAAI,CAAC8K,YAAL,CAAkBC,QAAlB,CAA5B;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIC,iBAAiB,GAAG,UAAUD,QAAV,EAAoBE,SAApB,EAA+B;AACrD,WAAO,UAAUjL,IAAV,EAAgB;AACrB,aAAOqK,WAAW,CAACrK,IAAD,CAAX,IAAqBA,IAAI,CAACkL,YAAL,CAAkBH,QAAlB,MAAgCE,SAA5D;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIE,OAAO,GAAG,UAAUnL,IAAV,EAAgB;AAC5B,WAAOqK,WAAW,CAACrK,IAAD,CAAX,IAAqBA,IAAI,CAAC8K,YAAL,CAAkB,gBAAlB,CAA5B;AACD,GAFD;;AAGA,MAAIM,UAAU,GAAG,UAAUpL,IAAV,EAAgB;AAC/B,WAAOqK,WAAW,CAACrK,IAAD,CAAX,IAAqBA,IAAI,CAACkL,YAAL,CAAkB,gBAAlB,MAAwC,KAApE;AACD,GAFD;;AAGA,MAAIG,OAAO,GAAG,UAAUrL,IAAV,EAAgB;AAC5B,WAAOqK,WAAW,CAACrK,IAAD,CAAX,IAAqBA,IAAI,CAACsL,OAAL,KAAiB,OAA7C;AACD,GAFD;;AAGA,MAAIC,uBAAuB,GAAG,UAAUzgB,KAAV,EAAiB;AAC7C,WAAO,UAAUkV,IAAV,EAAgB;AACrB,UAAIqK,WAAW,CAACrK,IAAD,CAAf,EAAuB;AACrB,YAAIA,IAAI,CAAC/D,eAAL,KAAyBnR,KAA7B,EAAoC;AAClC,iBAAO,IAAP;AACD;;AACD,YAAIkV,IAAI,CAACkL,YAAL,CAAkB,0BAAlB,MAAkDpgB,KAAtD,EAA6D;AAC3D,iBAAO,IAAP;AACD;AACF;;AACD,aAAO,KAAP;AACD,KAVD;AAWD,GAZD;;AAaA,MAAI0gB,iBAAiB,GAAGlB,cAAc,CAAC,CACrC,UADqC,EAErC,OAFqC,CAAD,CAAtC;AAIA,MAAImB,QAAQ,GAAGvB,UAAU,CAAC,CAAD,CAAzB;AACA,MAAIwB,WAAW,GAAGxB,UAAU,CAAC,CAAD,CAA5B;AACA,MAAIyB,YAAY,GAAGzB,UAAU,CAAC,CAAD,CAA7B;AACA,MAAI0B,oBAAoB,GAAG1B,UAAU,CAAC,EAAD,CAArC;AACA,MAAI2B,IAAI,GAAGvB,cAAc,CAAC,CAAC,IAAD,CAAD,CAAzB;AACA,MAAIwB,KAAK,GAAGxB,cAAc,CAAC,CAAC,KAAD,CAAD,CAA1B;AACA,MAAIyB,qBAAqB,GAAGR,uBAAuB,CAAC,MAAD,CAAnD;AACA,MAAIS,sBAAsB,GAAGT,uBAAuB,CAAC,OAAD,CAApD;AACA,MAAIU,WAAW,GAAG3B,cAAc,CAAC,CAC/B,IAD+B,EAE/B,IAF+B,CAAD,CAAhC;AAIA,MAAI4B,OAAO,GAAG5B,cAAc,CAAC,CAC3B,OAD2B,EAE3B,OAF2B,EAG3B,QAH2B,EAI3B,OAJ2B,CAAD,CAA5B;;AAOA,MAAI6B,aAAa,GAAG,UAAU/L,GAAV,EAAe;AACjC,WAAOA,GAAG,CAACgM,KAAJ,KAAcxkB,SAAd,IAA2BmH,UAAU,CAACqR,GAAG,CAACgM,KAAJ,CAAUvB,gBAAX,CAA5C;AACD,GAFD;;AAIA,MAAIwB,MAAM,GAAG,UAAUjM,GAAV,EAAe/N,GAAf,EAAoBvH,KAApB,EAA2B;AACtC,QAAIyD,QAAQ,CAACzD,KAAD,CAAR,IAAmB6D,SAAS,CAAC7D,KAAD,CAA5B,IAAuCkE,QAAQ,CAAClE,KAAD,CAAnD,EAA4D;AAC1DsV,MAAAA,GAAG,CAACkM,YAAJ,CAAiBja,GAAjB,EAAsBvH,KAAK,GAAG,EAA9B;AACD,KAFD,MAEO;AACL6U,MAAAA,OAAO,CAACC,KAAR,CAAc,qCAAd,EAAqDvN,GAArD,EAA0D,WAA1D,EAAuEvH,KAAvE,EAA8E,aAA9E,EAA6FsV,GAA7F;AACA,YAAM,IAAI3U,KAAJ,CAAU,gCAAV,CAAN;AACD;AACF,GAPD;;AAQA,MAAI8gB,GAAG,GAAG,UAAUjL,OAAV,EAAmBjP,GAAnB,EAAwBvH,KAAxB,EAA+B;AACvCuhB,IAAAA,MAAM,CAAC/K,OAAO,CAAClB,GAAT,EAAc/N,GAAd,EAAmBvH,KAAnB,CAAN;AACD,GAFD;;AAGA,MAAI0hB,MAAM,GAAG,UAAUlL,OAAV,EAAmBmL,KAAnB,EAA0B;AACrC,QAAIrM,GAAG,GAAGkB,OAAO,CAAClB,GAAlB;AACA/O,IAAAA,MAAM,CAACob,KAAD,EAAQ,UAAU5e,CAAV,EAAa2D,CAAb,EAAgB;AAC5B6a,MAAAA,MAAM,CAACjM,GAAD,EAAM5O,CAAN,EAAS3D,CAAT,CAAN;AACD,KAFK,CAAN;AAGD,GALD;;AAMA,MAAI6e,KAAK,GAAG,UAAUpL,OAAV,EAAmBjP,GAAnB,EAAwB;AAClC,QAAIxE,CAAC,GAAGyT,OAAO,CAAClB,GAAR,CAAY8K,YAAZ,CAAyB7Y,GAAzB,CAAR;AACA,WAAOxE,CAAC,KAAK,IAAN,GAAajG,SAAb,GAAyBiG,CAAhC;AACD,GAHD;;AAIA,MAAI8e,MAAM,GAAG,UAAUrL,OAAV,EAAmBjP,GAAnB,EAAwB;AACnC,WAAOpE,QAAQ,CAACD,IAAT,CAAc0e,KAAK,CAACpL,OAAD,EAAUjP,GAAV,CAAnB,CAAP;AACD,GAFD;;AAGA,MAAIua,KAAK,GAAG,UAAUtL,OAAV,EAAmBjP,GAAnB,EAAwB;AAClC,QAAI+N,GAAG,GAAGkB,OAAO,CAAClB,GAAlB;AACA,WAAOA,GAAG,IAAIA,GAAG,CAAC0K,YAAX,GAA0B1K,GAAG,CAAC0K,YAAJ,CAAiBzY,GAAjB,CAA1B,GAAkD,KAAzD;AACD,GAHD;;AAIA,MAAIwa,QAAQ,GAAG,UAAUvL,OAAV,EAAmBjP,GAAnB,EAAwB;AACrCiP,IAAAA,OAAO,CAAClB,GAAR,CAAY0M,eAAZ,CAA4Bza,GAA5B;AACD,GAFD;;AAGA,MAAI5J,KAAK,GAAG,UAAU6Y,OAAV,EAAmB;AAC7B,WAAOrR,KAAK,CAACqR,OAAO,CAAClB,GAAR,CAAY2M,UAAb,EAAyB,UAAU/c,GAAV,EAAegd,IAAf,EAAqB;AACxDhd,MAAAA,GAAG,CAACgd,IAAI,CAAC9kB,IAAN,CAAH,GAAiB8kB,IAAI,CAACliB,KAAtB;AACA,aAAOkF,GAAP;AACD,KAHW,EAGT,EAHS,CAAZ;AAID,GALD;;AAOA,MAAIid,WAAW,GAAG,UAAU7M,GAAV,EAAe8M,QAAf,EAAyBpiB,KAAzB,EAAgC;AAChD,QAAI,CAACyD,QAAQ,CAACzD,KAAD,CAAb,EAAsB;AACpB6U,MAAAA,OAAO,CAACC,KAAR,CAAc,oCAAd,EAAoDsN,QAApD,EAA8D,WAA9D,EAA2EpiB,KAA3E,EAAkF,aAAlF,EAAiGsV,GAAjG;AACA,YAAM,IAAI3U,KAAJ,CAAU,iCAAiCX,KAA3C,CAAN;AACD;;AACD,QAAIqhB,aAAa,CAAC/L,GAAD,CAAjB,EAAwB;AACtBA,MAAAA,GAAG,CAACgM,KAAJ,CAAUe,WAAV,CAAsBD,QAAtB,EAAgCpiB,KAAhC;AACD;AACF,GARD;;AASA,MAAIsiB,QAAQ,GAAG,UAAU9L,OAAV,EAAmB+L,GAAnB,EAAwB;AACrC,QAAIjN,GAAG,GAAGkB,OAAO,CAAClB,GAAlB;AACA/O,IAAAA,MAAM,CAACgc,GAAD,EAAM,UAAUxf,CAAV,EAAa2D,CAAb,EAAgB;AAC1Byb,MAAAA,WAAW,CAAC7M,GAAD,EAAM5O,CAAN,EAAS3D,CAAT,CAAX;AACD,KAFK,CAAN;AAGD,GALD;;AAMA,MAAIyf,KAAK,GAAG,UAAUhM,OAAV,EAAmB4L,QAAnB,EAA6B;AACvC,QAAI9M,GAAG,GAAGkB,OAAO,CAAClB,GAAlB;AACA,QAAImN,MAAM,GAAGtS,MAAM,CAAC2P,gBAAP,CAAwBxK,GAAxB,CAAb;AACA,QAAI7Q,CAAC,GAAGge,MAAM,CAAC1C,gBAAP,CAAwBqC,QAAxB,CAAR;AACA,WAAO3d,CAAC,KAAK,EAAN,IAAY,CAAC8X,MAAM,CAAC/F,OAAD,CAAnB,GAA+BkM,iBAAiB,CAACpN,GAAD,EAAM8M,QAAN,CAAhD,GAAkE3d,CAAzE;AACD,GALD;;AAMA,MAAIie,iBAAiB,GAAG,UAAUpN,GAAV,EAAe8M,QAAf,EAAyB;AAC/C,WAAOf,aAAa,CAAC/L,GAAD,CAAb,GAAqBA,GAAG,CAACgM,KAAJ,CAAUvB,gBAAV,CAA2BqC,QAA3B,CAArB,GAA4D,EAAnE;AACD,GAFD;;AAGA,MAAIO,MAAM,GAAG,UAAUnM,OAAV,EAAmB4L,QAAnB,EAA6B;AACxC,QAAI9M,GAAG,GAAGkB,OAAO,CAAClB,GAAlB;AACA,QAAIsN,GAAG,GAAGF,iBAAiB,CAACpN,GAAD,EAAM8M,QAAN,CAA3B;AACA,WAAOjf,QAAQ,CAACD,IAAT,CAAc0f,GAAd,EAAmBtgB,MAAnB,CAA0B,UAAUmC,CAAV,EAAa;AAC5C,aAAOA,CAAC,CAACnG,MAAF,GAAW,CAAlB;AACD,KAFM,CAAP;AAGD,GAND;;AAOA,MAAIukB,SAAS,GAAG,UAAUrM,OAAV,EAAmB;AACjC,QAAI+L,GAAG,GAAG,EAAV;AACA,QAAIjN,GAAG,GAAGkB,OAAO,CAAClB,GAAlB;;AACA,QAAI+L,aAAa,CAAC/L,GAAD,CAAjB,EAAwB;AACtB,WAAK,IAAI9W,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8W,GAAG,CAACgM,KAAJ,CAAUhjB,MAA9B,EAAsCE,CAAC,EAAvC,EAA2C;AACzC,YAAIskB,QAAQ,GAAGxN,GAAG,CAACgM,KAAJ,CAAUnZ,IAAV,CAAe3J,CAAf,CAAf;AACA+jB,QAAAA,GAAG,CAACO,QAAD,CAAH,GAAgBxN,GAAG,CAACgM,KAAJ,CAAUwB,QAAV,CAAhB;AACD;AACF;;AACD,WAAOP,GAAP;AACD,GAVD;;AAWA,MAAIQ,MAAM,GAAG,UAAU5Z,CAAV,EAAa;AACxB,WAAOA,CAAC,CAACmM,GAAF,CAAM0N,WAAb;AACD,GAFD;;AAIA,MAAIC,SAAS,GAAGzS,QAAQ,GAAG1G,OAA3B;;AACA,MAAIoZ,YAAY,GAAG,UAAUC,KAAV,EAAiB;AAClC,WAAO7d,IAAI,CAAC6d,KAAD,EAAQjL,SAAR,CAAX;AACD,GAFD;;AAGA,MAAIkL,qBAAqB,GAAG,UAAUC,GAAV,EAAe;AACzC,QAAIJ,SAAS,CAACtU,SAAV,MAAyBvR,IAAI,CAACimB,GAAD,CAAJ,KAAc,OAA3C,EAAoD;AAClD,aAAOH,YAAY,CAAC7J,QAAQ,CAACgK,GAAD,CAAT,CAAZ,CAA4B/gB,MAA5B,CAAmC,UAAU+gB,GAAV,EAAe;AACvD,eAAOjmB,IAAI,CAACimB,GAAD,CAAJ,KAAc,SAArB;AACD,OAFM,EAEJlhB,IAFI,CAEC,UAAUmhB,OAAV,EAAmB;AACzB,eAAOJ,YAAY,CAACxJ,YAAY,CAAC4J,OAAD,CAAb,CAAZ,CAAoCrhB,GAApC,CAAwC,UAAUua,IAAV,EAAgB;AAC7D,cAAI+G,OAAO,GAAG/G,IAAI,CAAClH,GAAL,CAAS8H,SAAvB;AACA,cAAIoG,UAAU,GAAGF,OAAO,CAAChO,GAAR,CAAY8H,SAA7B;AACA,cAAIqG,aAAa,GAAGH,OAAO,CAAChO,GAAR,CAAYoO,YAAhC;AACA,iBAAOH,OAAO,IAAIC,UAAX,GAAwB,CAACC,aAAzB,GAAyC,CAAhD;AACD,SALM,CAAP;AAMD,OATM,EASJ/hB,KATI,CASE,CATF,CAAP;AAUD,KAXD,MAWO;AACL,aAAO,CAAP;AACD;AACF,GAfD;;AAgBA,MAAIiiB,QAAQ,GAAG,UAAUN,GAAV,EAAe1J,KAAf,EAAsB;AACnC,WAAO0J,GAAG,CAAChK,QAAJ,IAAgB3U,QAAQ,CAAC2e,GAAG,CAAChK,QAAL,EAAeM,KAAf,CAA/B;AACD,GAFD;;AAGA,MAAIiK,MAAM,GAAG,UAAUpH,IAAV,EAAgB6G,GAAhB,EAAqBQ,OAArB,EAA8B;AACzC,QAAIhnB,CAAC,GAAG,CAAR;AAAA,QAAWqB,CAAC,GAAG,CAAf;AAAA,QAAkB4lB,YAAlB;AACA,QAAIvP,GAAG,GAAGiI,IAAI,CAACjE,aAAf;AACA,QAAIwL,GAAJ;AACAF,IAAAA,OAAO,GAAGA,OAAO,GAAGA,OAAH,GAAarH,IAA9B;;AACA,QAAI6G,GAAJ,EAAS;AACP,UAAIQ,OAAO,KAAKrH,IAAZ,IAAoB6G,GAAG,CAACtG,qBAAxB,IAAiDyF,KAAK,CAAC9M,YAAY,CAACX,OAAb,CAAqByH,IAArB,CAAD,EAA6B,UAA7B,CAAL,KAAkD,QAAvG,EAAiH;AAC/GuH,QAAAA,GAAG,GAAGV,GAAG,CAACtG,qBAAJ,EAAN;AACAlgB,QAAAA,CAAC,GAAGknB,GAAG,CAACtH,IAAJ,IAAYlI,GAAG,CAACmE,eAAJ,CAAoB6E,UAApB,IAAkCf,IAAI,CAACe,UAAnD,IAAiEhJ,GAAG,CAACmE,eAAJ,CAAoBgF,UAAzF;AACAxf,QAAAA,CAAC,GAAG6lB,GAAG,CAACrH,GAAJ,IAAWnI,GAAG,CAACmE,eAAJ,CAAoB2E,SAApB,IAAiCb,IAAI,CAACa,SAAjD,IAA8D9I,GAAG,CAACmE,eAAJ,CAAoB+E,SAAtF;AACA,eAAO;AACL5gB,UAAAA,CAAC,EAAEA,CADE;AAELqB,UAAAA,CAAC,EAAEA;AAFE,SAAP;AAID;;AACD4lB,MAAAA,YAAY,GAAGT,GAAf;;AACA,aAAOS,YAAY,IAAIA,YAAY,KAAKD,OAAjC,IAA4CC,YAAY,CAACpN,QAAzD,IAAqE,CAACiN,QAAQ,CAACG,YAAD,EAAeD,OAAf,CAArF,EAA8G;AAC5GhnB,QAAAA,CAAC,IAAIinB,YAAY,CAAC3G,UAAb,IAA2B,CAAhC;AACAjf,QAAAA,CAAC,IAAI4lB,YAAY,CAAC1G,SAAb,IAA0B,CAA/B;AACA0G,QAAAA,YAAY,GAAGA,YAAY,CAACA,YAA5B;AACD;;AACDA,MAAAA,YAAY,GAAGT,GAAG,CAACzK,UAAnB;;AACA,aAAOkL,YAAY,IAAIA,YAAY,KAAKD,OAAjC,IAA4CC,YAAY,CAACpN,QAAzD,IAAqE,CAACiN,QAAQ,CAACG,YAAD,EAAeD,OAAf,CAArF,EAA8G;AAC5GhnB,QAAAA,CAAC,IAAIinB,YAAY,CAACvG,UAAb,IAA2B,CAAhC;AACArf,QAAAA,CAAC,IAAI4lB,YAAY,CAACzG,SAAb,IAA0B,CAA/B;AACAyG,QAAAA,YAAY,GAAGA,YAAY,CAAClL,UAA5B;AACD;;AACD1a,MAAAA,CAAC,IAAIklB,qBAAqB,CAAC1N,YAAY,CAACX,OAAb,CAAqBsO,GAArB,CAAD,CAA1B;AACD;;AACD,WAAO;AACLxmB,MAAAA,CAAC,EAAEA,CADE;AAELqB,MAAAA,CAAC,EAAEA;AAFE,KAAP;AAID,GAjCD;;AAmCA,MAAI8lB,SAAS,GAAG,EAAhB;AAAA,MAAoBC,QAAQ,GAAG;AAAEC,IAAAA,OAAO,EAAEF;AAAX,GAA/B;;AACC,aAAUG,MAAV,EAAkBD,OAAlB,EAA2BE,MAA3B,EAAmCC,OAAnC,EAA4C;AAC1C,eAAUrmB,CAAV,EAAa;AACZ,UAAI,OAAOkmB,OAAP,KAAmB,QAAnB,IAA+B,OAAOE,MAAP,KAAkB,WAArD,EAAkE;AAChEA,QAAAA,MAAM,CAACF,OAAP,GAAiBlmB,CAAC,EAAlB;AACD,OAFD,MAEO,IAAI,OAAOmmB,MAAP,KAAkB,UAAlB,IAAgCA,MAAM,CAACG,GAA3C,EAAgD;AACrDH,QAAAA,MAAM,CAAC,EAAD,EAAKnmB,CAAL,CAAN;AACD,OAFM,MAEA;AACL,YAAIumB,CAAJ;;AACA,YAAI,OAAOpU,MAAP,KAAkB,WAAtB,EAAmC;AACjCoU,UAAAA,CAAC,GAAGpU,MAAJ;AACD,SAFD,MAEO,IAAI,OAAOqU,MAAP,KAAkB,WAAtB,EAAmC;AACxCD,UAAAA,CAAC,GAAGC,MAAJ;AACD,SAFM,MAEA,IAAI,OAAO3hB,IAAP,KAAgB,WAApB,EAAiC;AACtC0hB,UAAAA,CAAC,GAAG1hB,IAAJ;AACD,SAFM,MAEA;AACL0hB,UAAAA,CAAC,GAAG,IAAJ;AACD;;AACDA,QAAAA,CAAC,CAACE,mBAAF,GAAwBzmB,CAAC,EAAzB;AACD;AACF,KAlBA,EAkBC,YAAY;AACZ,aAAO,YAAY;AACjB,iBAASyG,CAAT,CAAW0E,CAAX,EAAc/H,CAAd,EAAiBrE,CAAjB,EAAoB;AAClB,mBAASiE,CAAT,CAAWxC,CAAX,EAAcR,CAAd,EAAiB;AACf,gBAAI,CAACoD,CAAC,CAAC5C,CAAD,CAAN,EAAW;AACT,kBAAI,CAAC2K,CAAC,CAAC3K,CAAD,CAAN,EAAW;AACT,oBAAIoU,CAAC,GAAG,cAAc,OAAOyR,OAArB,IAAgCA,OAAxC;AACA,oBAAI,CAACrmB,CAAD,IAAM4U,CAAV,EACE,OAAOA,CAAC,CAACpU,CAAD,EAAI,CAAC,CAAL,CAAR;AACF,oBAAIkmB,CAAJ,EACE,OAAOA,CAAC,CAAClmB,CAAD,EAAI,CAAC,CAAL,CAAR;AACF,oBAAIsB,CAAC,GAAG,IAAIa,KAAJ,CAAU,0BAA0BnC,CAA1B,GAA8B,IAAxC,CAAR;AACA,sBAAMsB,CAAC,CAAC6kB,IAAF,GAAS,kBAAT,EAA6B7kB,CAAnC;AACD;;AACD,kBAAImJ,CAAC,GAAG7H,CAAC,CAAC5C,CAAD,CAAD,GAAO;AAAE0lB,gBAAAA,OAAO,EAAE;AAAX,eAAf;AACA/a,cAAAA,CAAC,CAAC3K,CAAD,CAAD,CAAK,CAAL,EAAQX,IAAR,CAAaoL,CAAC,CAACib,OAAf,EAAwB,UAAUzf,CAAV,EAAa;AACnC,oBAAIrD,CAAC,GAAG+H,CAAC,CAAC3K,CAAD,CAAD,CAAK,CAAL,EAAQiG,CAAR,CAAR;AACA,uBAAOzD,CAAC,CAACI,CAAC,IAAIqD,CAAN,CAAR;AACD,eAHD,EAGGwE,CAHH,EAGMA,CAAC,CAACib,OAHR,EAGiBzf,CAHjB,EAGoB0E,CAHpB,EAGuB/H,CAHvB,EAG0BrE,CAH1B;AAID;;AACD,mBAAOqE,CAAC,CAAC5C,CAAD,CAAD,CAAK0lB,OAAZ;AACD;;AACD,eAAK,IAAIQ,CAAC,GAAG,cAAc,OAAOL,OAArB,IAAgCA,OAAxC,EAAiD7lB,CAAC,GAAG,CAA1D,EAA6DA,CAAC,GAAGzB,CAAC,CAACuB,MAAnE,EAA2EE,CAAC,EAA5E,EACEwC,CAAC,CAACjE,CAAC,CAACyB,CAAD,CAAF,CAAD;;AACF,iBAAOwC,CAAP;AACD;;AACD,eAAOyD,CAAP;AACD,OA1BM,GA0BH;AACF,WAAG,CACD,UAAU4f,OAAV,EAAmBD,MAAnB,EAA2BF,OAA3B,EAAoC;AAClC,cAAIU,OAAO,GAAGR,MAAM,CAACF,OAAP,GAAiB,EAA/B;AACA,cAAIW,gBAAJ;AACA,cAAIC,kBAAJ;;AACA,mBAASC,gBAAT,GAA4B;AAC1B,kBAAM,IAAIpkB,KAAJ,CAAU,iCAAV,CAAN;AACD;;AACD,mBAASqkB,mBAAT,GAA+B;AAC7B,kBAAM,IAAIrkB,KAAJ,CAAU,mCAAV,CAAN;AACD;;AACA,uBAAY;AACX,gBAAI;AACF,kBAAI,OAAOskB,UAAP,KAAsB,UAA1B,EAAsC;AACpCJ,gBAAAA,gBAAgB,GAAGI,UAAnB;AACD,eAFD,MAEO;AACLJ,gBAAAA,gBAAgB,GAAGE,gBAAnB;AACD;AACF,aAND,CAME,OAAO5b,CAAP,EAAU;AACV0b,cAAAA,gBAAgB,GAAGE,gBAAnB;AACD;;AACD,gBAAI;AACF,kBAAI,OAAOG,YAAP,KAAwB,UAA5B,EAAwC;AACtCJ,gBAAAA,kBAAkB,GAAGI,YAArB;AACD,eAFD,MAEO;AACLJ,gBAAAA,kBAAkB,GAAGE,mBAArB;AACD;AACF,aAND,CAME,OAAO7b,CAAP,EAAU;AACV2b,cAAAA,kBAAkB,GAAGE,mBAArB;AACD;AACF,WAnBA,GAAD;;AAoBA,mBAASG,UAAT,CAAoBC,GAApB,EAAyB;AACvB,gBAAIP,gBAAgB,KAAKI,UAAzB,EAAqC;AACnC,qBAAOA,UAAU,CAACG,GAAD,EAAM,CAAN,CAAjB;AACD;;AACD,gBAAI,CAACP,gBAAgB,KAAKE,gBAArB,IAAyC,CAACF,gBAA3C,KAAgEI,UAApE,EAAgF;AAC9EJ,cAAAA,gBAAgB,GAAGI,UAAnB;AACA,qBAAOA,UAAU,CAACG,GAAD,EAAM,CAAN,CAAjB;AACD;;AACD,gBAAI;AACF,qBAAOP,gBAAgB,CAACO,GAAD,EAAM,CAAN,CAAvB;AACD,aAFD,CAEE,OAAOjc,CAAP,EAAU;AACV,kBAAI;AACF,uBAAO0b,gBAAgB,CAAChnB,IAAjB,CAAsB,IAAtB,EAA4BunB,GAA5B,EAAiC,CAAjC,CAAP;AACD,eAFD,CAEE,OAAOjc,CAAP,EAAU;AACV,uBAAO0b,gBAAgB,CAAChnB,IAAjB,CAAsB,IAAtB,EAA4BunB,GAA5B,EAAiC,CAAjC,CAAP;AACD;AACF;AACF;;AACD,mBAASC,eAAT,CAAyBlK,MAAzB,EAAiC;AAC/B,gBAAI2J,kBAAkB,KAAKI,YAA3B,EAAyC;AACvC,qBAAOA,YAAY,CAAC/J,MAAD,CAAnB;AACD;;AACD,gBAAI,CAAC2J,kBAAkB,KAAKE,mBAAvB,IAA8C,CAACF,kBAAhD,KAAuEI,YAA3E,EAAyF;AACvFJ,cAAAA,kBAAkB,GAAGI,YAArB;AACA,qBAAOA,YAAY,CAAC/J,MAAD,CAAnB;AACD;;AACD,gBAAI;AACF,qBAAO2J,kBAAkB,CAAC3J,MAAD,CAAzB;AACD,aAFD,CAEE,OAAOhS,CAAP,EAAU;AACV,kBAAI;AACF,uBAAO2b,kBAAkB,CAACjnB,IAAnB,CAAwB,IAAxB,EAA8Bsd,MAA9B,CAAP;AACD,eAFD,CAEE,OAAOhS,CAAP,EAAU;AACV,uBAAO2b,kBAAkB,CAACjnB,IAAnB,CAAwB,IAAxB,EAA8Bsd,MAA9B,CAAP;AACD;AACF;AACF;;AACD,cAAImK,KAAK,GAAG,EAAZ;AACA,cAAIC,QAAQ,GAAG,KAAf;AACA,cAAIC,YAAJ;AACA,cAAIC,UAAU,GAAG,CAAC,CAAlB;;AACA,mBAASC,eAAT,GAA2B;AACzB,gBAAI,CAACH,QAAD,IAAa,CAACC,YAAlB,EAAgC;AAC9B;AACD;;AACDD,YAAAA,QAAQ,GAAG,KAAX;;AACA,gBAAIC,YAAY,CAAClnB,MAAjB,EAAyB;AACvBgnB,cAAAA,KAAK,GAAGE,YAAY,CAACjlB,MAAb,CAAoB+kB,KAApB,CAAR;AACD,aAFD,MAEO;AACLG,cAAAA,UAAU,GAAG,CAAC,CAAd;AACD;;AACD,gBAAIH,KAAK,CAAChnB,MAAV,EAAkB;AAChBqnB,cAAAA,UAAU;AACX;AACF;;AACD,mBAASA,UAAT,GAAsB;AACpB,gBAAIJ,QAAJ,EAAc;AACZ;AACD;;AACD,gBAAIK,OAAO,GAAGT,UAAU,CAACO,eAAD,CAAxB;AACAH,YAAAA,QAAQ,GAAG,IAAX;AACA,gBAAIhnB,GAAG,GAAG+mB,KAAK,CAAChnB,MAAhB;;AACA,mBAAOC,GAAP,EAAY;AACVinB,cAAAA,YAAY,GAAGF,KAAf;AACAA,cAAAA,KAAK,GAAG,EAAR;;AACA,qBAAO,EAAEG,UAAF,GAAelnB,GAAtB,EAA2B;AACzB,oBAAIinB,YAAJ,EAAkB;AAChBA,kBAAAA,YAAY,CAACC,UAAD,CAAZ,CAAyBI,GAAzB;AACD;AACF;;AACDJ,cAAAA,UAAU,GAAG,CAAC,CAAd;AACAlnB,cAAAA,GAAG,GAAG+mB,KAAK,CAAChnB,MAAZ;AACD;;AACDknB,YAAAA,YAAY,GAAG,IAAf;AACAD,YAAAA,QAAQ,GAAG,KAAX;AACAF,YAAAA,eAAe,CAACO,OAAD,CAAf;AACD;;AACDhB,UAAAA,OAAO,CAACkB,QAAR,GAAmB,UAAUV,GAAV,EAAe;AAChC,gBAAI7lB,IAAI,GAAG,IAAIvC,KAAJ,CAAUyC,SAAS,CAACnB,MAAV,GAAmB,CAA7B,CAAX;;AACA,gBAAImB,SAAS,CAACnB,MAAV,GAAmB,CAAvB,EAA0B;AACxB,mBAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiB,SAAS,CAACnB,MAA9B,EAAsCE,CAAC,EAAvC,EAA2C;AACzCe,gBAAAA,IAAI,CAACf,CAAC,GAAG,CAAL,CAAJ,GAAciB,SAAS,CAACjB,CAAD,CAAvB;AACD;AACF;;AACD8mB,YAAAA,KAAK,CAAChhB,IAAN,CAAW,IAAIyhB,IAAJ,CAASX,GAAT,EAAc7lB,IAAd,CAAX;;AACA,gBAAI+lB,KAAK,CAAChnB,MAAN,KAAiB,CAAjB,IAAsB,CAACinB,QAA3B,EAAqC;AACnCJ,cAAAA,UAAU,CAACQ,UAAD,CAAV;AACD;AACF,WAXD;;AAYA,mBAASI,IAAT,CAAcX,GAAd,EAAmBxd,KAAnB,EAA0B;AACxB,iBAAKwd,GAAL,GAAWA,GAAX;AACA,iBAAKxd,KAAL,GAAaA,KAAb;AACD;;AACDme,UAAAA,IAAI,CAAC9oB,SAAL,CAAe4oB,GAAf,GAAqB,YAAY;AAC/B,iBAAKT,GAAL,CAAS1lB,KAAT,CAAe,IAAf,EAAqB,KAAKkI,KAA1B;AACD,WAFD;;AAGAgd,UAAAA,OAAO,CAACoB,KAAR,GAAgB,SAAhB;AACApB,UAAAA,OAAO,CAAC9a,OAAR,GAAkB,IAAlB;AACA8a,UAAAA,OAAO,CAACqB,GAAR,GAAc,EAAd;AACArB,UAAAA,OAAO,CAACsB,IAAR,GAAe,EAAf;AACAtB,UAAAA,OAAO,CAACxY,OAAR,GAAkB,EAAlB;AACAwY,UAAAA,OAAO,CAACuB,QAAR,GAAmB,EAAnB;;AACA,mBAAShnB,IAAT,GAAgB,CACf;;AACDylB,UAAAA,OAAO,CAACwB,EAAR,GAAajnB,IAAb;AACAylB,UAAAA,OAAO,CAACyB,WAAR,GAAsBlnB,IAAtB;AACAylB,UAAAA,OAAO,CAAC0B,IAAR,GAAennB,IAAf;AACAylB,UAAAA,OAAO,CAAC2B,GAAR,GAAcpnB,IAAd;AACAylB,UAAAA,OAAO,CAAC4B,cAAR,GAAyBrnB,IAAzB;AACAylB,UAAAA,OAAO,CAAC6B,kBAAR,GAA6BtnB,IAA7B;AACAylB,UAAAA,OAAO,CAAC8B,IAAR,GAAevnB,IAAf;AACAylB,UAAAA,OAAO,CAAC+B,eAAR,GAA0BxnB,IAA1B;AACAylB,UAAAA,OAAO,CAACgC,mBAAR,GAA8BznB,IAA9B;;AACAylB,UAAAA,OAAO,CAACiC,SAAR,GAAoB,UAAUzpB,IAAV,EAAgB;AAClC,mBAAO,EAAP;AACD,WAFD;;AAGAwnB,UAAAA,OAAO,CAACkC,OAAR,GAAkB,UAAU1pB,IAAV,EAAgB;AAChC,kBAAM,IAAIuD,KAAJ,CAAU,kCAAV,CAAN;AACD,WAFD;;AAGAikB,UAAAA,OAAO,CAACmC,GAAR,GAAc,YAAY;AACxB,mBAAO,GAAP;AACD,WAFD;;AAGAnC,UAAAA,OAAO,CAACoC,KAAR,GAAgB,UAAUC,GAAV,EAAe;AAC7B,kBAAM,IAAItmB,KAAJ,CAAU,gCAAV,CAAN;AACD,WAFD;;AAGAikB,UAAAA,OAAO,CAACsC,KAAR,GAAgB,YAAY;AAC1B,mBAAO,CAAP;AACD,WAFD;AAGD,SA9JA,EA+JD,EA/JC,CADD;AAkKF,WAAG,CACD,UAAU7C,OAAV,EAAmBD,MAAnB,EAA2BF,OAA3B,EAAoC;AACjC,qBAAUiD,YAAV,EAAwB;AACtB,uBAAU1U,IAAV,EAAgB;AACf,kBAAI2U,cAAc,GAAGnC,UAArB;;AACA,uBAAS9lB,IAAT,GAAgB,CACf;;AACD,uBAASgD,IAAT,CAAchC,EAAd,EAAkBwI,OAAlB,EAA2B;AACzB,uBAAO,YAAY;AACjBxI,kBAAAA,EAAE,CAACT,KAAH,CAASiJ,OAAT,EAAkBlJ,SAAlB;AACD,iBAFD;AAGD;;AACD,uBAAS4nB,OAAT,CAAiBlnB,EAAjB,EAAqB;AACnB,oBAAI,OAAO,IAAP,KAAgB,QAApB,EACE,MAAM,IAAImnB,SAAJ,CAAc,sCAAd,CAAN;AACF,oBAAI,OAAOnnB,EAAP,KAAc,UAAlB,EACE,MAAM,IAAImnB,SAAJ,CAAc,gBAAd,CAAN;AACF,qBAAKC,MAAL,GAAc,CAAd;AACA,qBAAKC,QAAL,GAAgB,KAAhB;AACA,qBAAKC,MAAL,GAAc3qB,SAAd;AACA,qBAAK4qB,UAAL,GAAkB,EAAlB;AACAC,gBAAAA,SAAS,CAACxnB,EAAD,EAAK,IAAL,CAAT;AACD;;AACD,uBAASynB,MAAT,CAAgB/kB,IAAhB,EAAsBglB,QAAtB,EAAgC;AAC9B,uBAAOhlB,IAAI,CAAC0kB,MAAL,KAAgB,CAAvB,EAA0B;AACxB1kB,kBAAAA,IAAI,GAAGA,IAAI,CAAC4kB,MAAZ;AACD;;AACD,oBAAI5kB,IAAI,CAAC0kB,MAAL,KAAgB,CAApB,EAAuB;AACrB1kB,kBAAAA,IAAI,CAAC6kB,UAAL,CAAgBpjB,IAAhB,CAAqBujB,QAArB;;AACA;AACD;;AACDhlB,gBAAAA,IAAI,CAAC2kB,QAAL,GAAgB,IAAhB;;AACAH,gBAAAA,OAAO,CAACS,YAAR,CAAqB,YAAY;AAC/B,sBAAI/f,EAAE,GAAGlF,IAAI,CAAC0kB,MAAL,KAAgB,CAAhB,GAAoBM,QAAQ,CAACE,WAA7B,GAA2CF,QAAQ,CAACG,UAA7D;;AACA,sBAAIjgB,EAAE,KAAK,IAAX,EAAiB;AACf,qBAAClF,IAAI,CAAC0kB,MAAL,KAAgB,CAAhB,GAAoBlU,OAApB,GAA8B4U,MAA/B,EAAuCJ,QAAQ,CAACK,OAAhD,EAAyDrlB,IAAI,CAAC4kB,MAA9D;AACA;AACD;;AACD,sBAAIzO,GAAJ;;AACA,sBAAI;AACFA,oBAAAA,GAAG,GAAGjR,EAAE,CAAClF,IAAI,CAAC4kB,MAAN,CAAR;AACD,mBAFD,CAEE,OAAOte,CAAP,EAAU;AACV8e,oBAAAA,MAAM,CAACJ,QAAQ,CAACK,OAAV,EAAmB/e,CAAnB,CAAN;AACA;AACD;;AACDkK,kBAAAA,OAAO,CAACwU,QAAQ,CAACK,OAAV,EAAmBlP,GAAnB,CAAP;AACD,iBAdD;AAeD;;AACD,uBAAS3F,OAAT,CAAiBxQ,IAAjB,EAAuBslB,QAAvB,EAAiC;AAC/B,oBAAI;AACF,sBAAIA,QAAQ,KAAKtlB,IAAjB,EACE,MAAM,IAAIykB,SAAJ,CAAc,2CAAd,CAAN;;AACF,sBAAIa,QAAQ,KAAK,OAAOA,QAAP,KAAoB,QAApB,IAAgC,OAAOA,QAAP,KAAoB,UAAzD,CAAZ,EAAkF;AAChF,wBAAIC,IAAI,GAAGD,QAAQ,CAACC,IAApB;;AACA,wBAAID,QAAQ,YAAYd,OAAxB,EAAiC;AAC/BxkB,sBAAAA,IAAI,CAAC0kB,MAAL,GAAc,CAAd;AACA1kB,sBAAAA,IAAI,CAAC4kB,MAAL,GAAcU,QAAd;AACAE,sBAAAA,MAAM,CAACxlB,IAAD,CAAN;AACA;AACD,qBALD,MAKO,IAAI,OAAOulB,IAAP,KAAgB,UAApB,EAAgC;AACrCT,sBAAAA,SAAS,CAACxlB,IAAI,CAACimB,IAAD,EAAOD,QAAP,CAAL,EAAuBtlB,IAAvB,CAAT;AACA;AACD;AACF;;AACDA,kBAAAA,IAAI,CAAC0kB,MAAL,GAAc,CAAd;AACA1kB,kBAAAA,IAAI,CAAC4kB,MAAL,GAAcU,QAAd;AACAE,kBAAAA,MAAM,CAACxlB,IAAD,CAAN;AACD,iBAlBD,CAkBE,OAAOsG,CAAP,EAAU;AACV8e,kBAAAA,MAAM,CAACplB,IAAD,EAAOsG,CAAP,CAAN;AACD;AACF;;AACD,uBAAS8e,MAAT,CAAgBplB,IAAhB,EAAsBslB,QAAtB,EAAgC;AAC9BtlB,gBAAAA,IAAI,CAAC0kB,MAAL,GAAc,CAAd;AACA1kB,gBAAAA,IAAI,CAAC4kB,MAAL,GAAcU,QAAd;AACAE,gBAAAA,MAAM,CAACxlB,IAAD,CAAN;AACD;;AACD,uBAASwlB,MAAT,CAAgBxlB,IAAhB,EAAsB;AACpB,oBAAIA,IAAI,CAAC0kB,MAAL,KAAgB,CAAhB,IAAqB1kB,IAAI,CAAC6kB,UAAL,CAAgBppB,MAAhB,KAA2B,CAApD,EAAuD;AACrD+oB,kBAAAA,OAAO,CAACS,YAAR,CAAqB,YAAY;AAC/B,wBAAI,CAACjlB,IAAI,CAAC2kB,QAAV,EAAoB;AAClBH,sBAAAA,OAAO,CAACiB,qBAAR,CAA8BzlB,IAAI,CAAC4kB,MAAnC;AACD;AACF,mBAJD;AAKD;;AACD,qBAAK,IAAIjpB,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAGsE,IAAI,CAAC6kB,UAAL,CAAgBppB,MAAtC,EAA8CE,CAAC,GAAGD,GAAlD,EAAuDC,CAAC,EAAxD,EAA4D;AAC1DopB,kBAAAA,MAAM,CAAC/kB,IAAD,EAAOA,IAAI,CAAC6kB,UAAL,CAAgBlpB,CAAhB,CAAP,CAAN;AACD;;AACDqE,gBAAAA,IAAI,CAAC6kB,UAAL,GAAkB,IAAlB;AACD;;AACD,uBAASa,OAAT,CAAiBR,WAAjB,EAA8BC,UAA9B,EAA0CE,OAA1C,EAAmD;AACjD,qBAAKH,WAAL,GAAmB,OAAOA,WAAP,KAAuB,UAAvB,GAAoCA,WAApC,GAAkD,IAArE;AACA,qBAAKC,UAAL,GAAkB,OAAOA,UAAP,KAAsB,UAAtB,GAAmCA,UAAnC,GAAgD,IAAlE;AACA,qBAAKE,OAAL,GAAeA,OAAf;AACD;;AACD,uBAASP,SAAT,CAAmBxnB,EAAnB,EAAuB0C,IAAvB,EAA6B;AAC3B,oBAAI2lB,IAAI,GAAG,KAAX;;AACA,oBAAI;AACFroB,kBAAAA,EAAE,CAAC,UAAUH,KAAV,EAAiB;AAClB,wBAAIwoB,IAAJ,EACE;AACFA,oBAAAA,IAAI,GAAG,IAAP;AACAnV,oBAAAA,OAAO,CAACxQ,IAAD,EAAO7C,KAAP,CAAP;AACD,mBALC,EAKC,UAAUyoB,MAAV,EAAkB;AACnB,wBAAID,IAAJ,EACE;AACFA,oBAAAA,IAAI,GAAG,IAAP;AACAP,oBAAAA,MAAM,CAACplB,IAAD,EAAO4lB,MAAP,CAAN;AACD,mBAVC,CAAF;AAWD,iBAZD,CAYE,OAAOC,EAAP,EAAW;AACX,sBAAIF,IAAJ,EACE;AACFA,kBAAAA,IAAI,GAAG,IAAP;AACAP,kBAAAA,MAAM,CAACplB,IAAD,EAAO6lB,EAAP,CAAN;AACD;AACF;;AACDrB,cAAAA,OAAO,CAACpqB,SAAR,CAAkB,OAAlB,IAA6B,UAAU+qB,UAAV,EAAsB;AACjD,uBAAO,KAAKI,IAAL,CAAU,IAAV,EAAgBJ,UAAhB,CAAP;AACD,eAFD;;AAGAX,cAAAA,OAAO,CAACpqB,SAAR,CAAkBmrB,IAAlB,GAAyB,UAAUL,WAAV,EAAuBC,UAAvB,EAAmC;AAC1D,oBAAIW,IAAI,GAAG,IAAI,KAAKxrB,WAAT,CAAqBgC,IAArB,CAAX;AACAyoB,gBAAAA,MAAM,CAAC,IAAD,EAAO,IAAIW,OAAJ,CAAYR,WAAZ,EAAyBC,UAAzB,EAAqCW,IAArC,CAAP,CAAN;AACA,uBAAOA,IAAP;AACD,eAJD;;AAKAtB,cAAAA,OAAO,CAAC/mB,GAAR,GAAc,UAAU0E,GAAV,EAAe;AAC3B,oBAAIzF,IAAI,GAAGvC,KAAK,CAACC,SAAN,CAAgBW,KAAhB,CAAsBC,IAAtB,CAA2BmH,GAA3B,CAAX;AACA,uBAAO,IAAIqiB,OAAJ,CAAY,UAAUhU,OAAV,EAAmB4U,MAAnB,EAA2B;AAC5C,sBAAI1oB,IAAI,CAACjB,MAAL,KAAgB,CAApB,EACE,OAAO+U,OAAO,CAAC,EAAD,CAAd;AACF,sBAAIuV,SAAS,GAAGrpB,IAAI,CAACjB,MAArB;;AACA,2BAASuqB,GAAT,CAAarqB,CAAb,EAAgBsqB,GAAhB,EAAqB;AACnB,wBAAI;AACF,0BAAIA,GAAG,KAAK,OAAOA,GAAP,KAAe,QAAf,IAA2B,OAAOA,GAAP,KAAe,UAA/C,CAAP,EAAmE;AACjE,4BAAIV,IAAI,GAAGU,GAAG,CAACV,IAAf;;AACA,4BAAI,OAAOA,IAAP,KAAgB,UAApB,EAAgC;AAC9BA,0BAAAA,IAAI,CAACvqB,IAAL,CAAUirB,GAAV,EAAe,UAAUA,GAAV,EAAe;AAC5BD,4BAAAA,GAAG,CAACrqB,CAAD,EAAIsqB,GAAJ,CAAH;AACD,2BAFD,EAEGb,MAFH;AAGA;AACD;AACF;;AACD1oB,sBAAAA,IAAI,CAACf,CAAD,CAAJ,GAAUsqB,GAAV;;AACA,0BAAI,EAAEF,SAAF,KAAgB,CAApB,EAAuB;AACrBvV,wBAAAA,OAAO,CAAC9T,IAAD,CAAP;AACD;AACF,qBAdD,CAcE,OAAOmpB,EAAP,EAAW;AACXT,sBAAAA,MAAM,CAACS,EAAD,CAAN;AACD;AACF;;AACD,uBAAK,IAAIlqB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGe,IAAI,CAACjB,MAAzB,EAAiCE,CAAC,EAAlC,EAAsC;AACpCqqB,oBAAAA,GAAG,CAACrqB,CAAD,EAAIe,IAAI,CAACf,CAAD,CAAR,CAAH;AACD;AACF,iBA1BM,CAAP;AA2BD,eA7BD;;AA8BA6oB,cAAAA,OAAO,CAAChU,OAAR,GAAkB,UAAUrT,KAAV,EAAiB;AACjC,oBAAIA,KAAK,IAAI,OAAOA,KAAP,KAAiB,QAA1B,IAAsCA,KAAK,CAAC7C,WAAN,KAAsBkqB,OAAhE,EAAyE;AACvE,yBAAOrnB,KAAP;AACD;;AACD,uBAAO,IAAIqnB,OAAJ,CAAY,UAAUhU,OAAV,EAAmB;AACpCA,kBAAAA,OAAO,CAACrT,KAAD,CAAP;AACD,iBAFM,CAAP;AAGD,eAPD;;AAQAqnB,cAAAA,OAAO,CAACY,MAAR,GAAiB,UAAUjoB,KAAV,EAAiB;AAChC,uBAAO,IAAIqnB,OAAJ,CAAY,UAAUhU,OAAV,EAAmB4U,MAAnB,EAA2B;AAC5CA,kBAAAA,MAAM,CAACjoB,KAAD,CAAN;AACD,iBAFM,CAAP;AAGD,eAJD;;AAKAqnB,cAAAA,OAAO,CAAC0B,IAAR,GAAe,UAAU1hB,MAAV,EAAkB;AAC/B,uBAAO,IAAIggB,OAAJ,CAAY,UAAUhU,OAAV,EAAmB4U,MAAnB,EAA2B;AAC5C,uBAAK,IAAIzpB,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAG8I,MAAM,CAAC/I,MAA7B,EAAqCE,CAAC,GAAGD,GAAzC,EAA8CC,CAAC,EAA/C,EAAmD;AACjD6I,oBAAAA,MAAM,CAAC7I,CAAD,CAAN,CAAU4pB,IAAV,CAAe/U,OAAf,EAAwB4U,MAAxB;AACD;AACF,iBAJM,CAAP;AAKD,eAND;;AAOAZ,cAAAA,OAAO,CAACS,YAAR,GAAuB,OAAOX,YAAP,KAAwB,UAAxB,GAAqC,UAAUhnB,EAAV,EAAc;AACxEgnB,gBAAAA,YAAY,CAAChnB,EAAD,CAAZ;AACD,eAFsB,GAEnB,UAAUA,EAAV,EAAc;AAChBinB,gBAAAA,cAAc,CAACjnB,EAAD,EAAK,CAAL,CAAd;AACD,eAJD;;AAKAknB,cAAAA,OAAO,CAACiB,qBAAR,GAAgC,SAASA,qBAAT,CAA+BU,GAA/B,EAAoC;AAClE,oBAAI,OAAOnU,OAAP,KAAmB,WAAnB,IAAkCA,OAAtC,EAA+C;AAC7CA,kBAAAA,OAAO,CAACoU,IAAR,CAAa,uCAAb,EAAsDD,GAAtD;AACD;AACF,eAJD;;AAKA3B,cAAAA,OAAO,CAAC6B,eAAR,GAA0B,SAASA,eAAT,CAAyB/oB,EAAzB,EAA6B;AACrDknB,gBAAAA,OAAO,CAACS,YAAR,GAAuB3nB,EAAvB;AACD,eAFD;;AAGAknB,cAAAA,OAAO,CAAC8B,wBAAR,GAAmC,SAASA,wBAAT,CAAkChpB,EAAlC,EAAsC;AACvEknB,gBAAAA,OAAO,CAACiB,qBAAR,GAAgCnoB,EAAhC;AACD,eAFD;;AAGA,kBAAI,OAAOikB,MAAP,KAAkB,WAAlB,IAAiCA,MAAM,CAACF,OAA5C,EAAqD;AACnDE,gBAAAA,MAAM,CAACF,OAAP,GAAiBmD,OAAjB;AACD,eAFD,MAEO,IAAI,CAAC5U,IAAI,CAAC4U,OAAV,EAAmB;AACxB5U,gBAAAA,IAAI,CAAC4U,OAAL,GAAeA,OAAf;AACD;AACF,aA/LA,EA+LC,IA/LD,CAAD;AAgMD,WAjMA,EAiMCxpB,IAjMD,CAiMM,IAjMN,EAiMYwmB,OAAO,CAAC,QAAD,CAAP,CAAkB8C,YAjM9B,CAAD;AAkMD,SApMA,EAqMD;AAAE,oBAAU;AAAZ,SArMC,CAlKD;AAyWF,WAAG,CACD,UAAU9C,OAAV,EAAmBD,MAAnB,EAA2BF,OAA3B,EAAoC;AACjC,qBAAUiD,YAAV,EAAwBiC,cAAxB,EAAwC;AACvC,gBAAItD,QAAQ,GAAGzB,OAAO,CAAC,oBAAD,CAAP,CAA8ByB,QAA7C;;AACA,gBAAIpmB,KAAK,GAAGoY,QAAQ,CAAC7a,SAAT,CAAmByC,KAA/B;AACA,gBAAI9B,KAAK,GAAGZ,KAAK,CAACC,SAAN,CAAgBW,KAA5B;AACA,gBAAIyrB,YAAY,GAAG,EAAnB;AACA,gBAAIC,eAAe,GAAG,CAAtB;;AACApF,YAAAA,OAAO,CAACe,UAAR,GAAqB,YAAY;AAC/B,qBAAO,IAAIsE,OAAJ,CAAY7pB,KAAK,CAAC7B,IAAN,CAAWonB,UAAX,EAAuB9U,MAAvB,EAA+B1Q,SAA/B,CAAZ,EAAuDylB,YAAvD,CAAP;AACD,aAFD;;AAGAhB,YAAAA,OAAO,CAACsF,WAAR,GAAsB,YAAY;AAChC,qBAAO,IAAID,OAAJ,CAAY7pB,KAAK,CAAC7B,IAAN,CAAW2rB,WAAX,EAAwBrZ,MAAxB,EAAgC1Q,SAAhC,CAAZ,EAAwDgqB,aAAxD,CAAP;AACD,aAFD;;AAGAvF,YAAAA,OAAO,CAACgB,YAAR,GAAuBhB,OAAO,CAACuF,aAAR,GAAwB,UAAU7D,OAAV,EAAmB;AAChEA,cAAAA,OAAO,CAAC8D,KAAR;AACD,aAFD;;AAGA,qBAASH,OAAT,CAAiBpoB,EAAjB,EAAqBwoB,OAArB,EAA8B;AAC5B,mBAAKC,GAAL,GAAWzoB,EAAX;AACA,mBAAK0oB,QAAL,GAAgBF,OAAhB;AACD;;AACDJ,YAAAA,OAAO,CAACtsB,SAAR,CAAkB6sB,KAAlB,GAA0BP,OAAO,CAACtsB,SAAR,CAAkB8sB,GAAlB,GAAwB,YAAY,CAC7D,CADD;;AAEAR,YAAAA,OAAO,CAACtsB,SAAR,CAAkBysB,KAAlB,GAA0B,YAAY;AACpC,mBAAKG,QAAL,CAAchsB,IAAd,CAAmBsS,MAAnB,EAA2B,KAAKyZ,GAAhC;AACD,aAFD;;AAGA1F,YAAAA,OAAO,CAAC8F,MAAR,GAAiB,UAAU7hB,IAAV,EAAgB8hB,KAAhB,EAAuB;AACtC/E,cAAAA,YAAY,CAAC/c,IAAI,CAAC+hB,cAAN,CAAZ;AACA/hB,cAAAA,IAAI,CAACgiB,YAAL,GAAoBF,KAApB;AACD,aAHD;;AAIA/F,YAAAA,OAAO,CAACkG,QAAR,GAAmB,UAAUjiB,IAAV,EAAgB;AACjC+c,cAAAA,YAAY,CAAC/c,IAAI,CAAC+hB,cAAN,CAAZ;AACA/hB,cAAAA,IAAI,CAACgiB,YAAL,GAAoB,CAAC,CAArB;AACD,aAHD;;AAIAjG,YAAAA,OAAO,CAACmG,YAAR,GAAuBnG,OAAO,CAACoG,MAAR,GAAiB,UAAUniB,IAAV,EAAgB;AACtD+c,cAAAA,YAAY,CAAC/c,IAAI,CAAC+hB,cAAN,CAAZ;AACA,kBAAID,KAAK,GAAG9hB,IAAI,CAACgiB,YAAjB;;AACA,kBAAIF,KAAK,IAAI,CAAb,EAAgB;AACd9hB,gBAAAA,IAAI,CAAC+hB,cAAL,GAAsBjF,UAAU,CAAC,SAASsF,SAAT,GAAqB;AACpD,sBAAIpiB,IAAI,CAACqiB,UAAT,EACEriB,IAAI,CAACqiB,UAAL;AACH,iBAH+B,EAG7BP,KAH6B,CAAhC;AAID;AACF,aATD;;AAUA/F,YAAAA,OAAO,CAACiD,YAAR,GAAuB,OAAOA,YAAP,KAAwB,UAAxB,GAAqCA,YAArC,GAAoD,UAAUhnB,EAAV,EAAc;AACvF,kBAAIgB,EAAE,GAAGmoB,eAAe,EAAxB;AACA,kBAAI/pB,IAAI,GAAGE,SAAS,CAACnB,MAAV,GAAmB,CAAnB,GAAuB,KAAvB,GAA+BV,KAAK,CAACC,IAAN,CAAW4B,SAAX,EAAsB,CAAtB,CAA1C;AACA4pB,cAAAA,YAAY,CAACloB,EAAD,CAAZ,GAAmB,IAAnB;AACA2kB,cAAAA,QAAQ,CAAC,SAAS2E,UAAT,GAAsB;AAC7B,oBAAIpB,YAAY,CAACloB,EAAD,CAAhB,EAAsB;AACpB,sBAAI5B,IAAJ,EAAU;AACRY,oBAAAA,EAAE,CAACT,KAAH,CAAS,IAAT,EAAeH,IAAf;AACD,mBAFD,MAEO;AACLY,oBAAAA,EAAE,CAACtC,IAAH,CAAQ,IAAR;AACD;;AACDqmB,kBAAAA,OAAO,CAACkF,cAAR,CAAuBjoB,EAAvB;AACD;AACF,eATO,CAAR;AAUA,qBAAOA,EAAP;AACD,aAfD;AAgBA+iB,YAAAA,OAAO,CAACkF,cAAR,GAAyB,OAAOA,cAAP,KAA0B,UAA1B,GAAuCA,cAAvC,GAAwD,UAAUjoB,EAAV,EAAc;AAC7F,qBAAOkoB,YAAY,CAACloB,EAAD,CAAnB;AACD,aAFD;AAGD,WA7DA,EA6DCtD,IA7DD,CA6DM,IA7DN,EA6DYwmB,OAAO,CAAC,QAAD,CAAP,CAAkB8C,YA7D9B,EA6D4C9C,OAAO,CAAC,QAAD,CAAP,CAAkB+E,cA7D9D,CAAD;AA8DD,SAhEA,EAiED;AACE,gCAAsB,CADxB;AAEE,oBAAU;AAFZ,SAjEC,CAzWD;AA+aF,WAAG,CACD,UAAU/E,OAAV,EAAmBD,MAAnB,EAA2BF,OAA3B,EAAoC;AAClC,cAAIwG,eAAe,GAAGrG,OAAO,CAAC,kBAAD,CAA7B;;AACA,cAAIxM,MAAM,GAAG,YAAY;AACvB,gBAAI,OAAO1H,MAAP,KAAkB,WAAtB,EAAmC;AACjC,qBAAOA,MAAP;AACD,aAFD,MAEO;AACL,qBAAO2H,QAAQ,CAAC,cAAD,CAAR,EAAP;AACD;AACF,WANY,EAAb;;AAOAsM,UAAAA,MAAM,CAACF,OAAP,GAAiB;AAAEyG,YAAAA,UAAU,EAAE9S,MAAM,CAACwP,OAAP,IAAkBqD;AAAhC,WAAjB;AACD,SAXA,EAYD;AAAE,8BAAoB;AAAtB,SAZC;AA/aD,OA1BG,EAudJ,EAvdI,EAudA,CAAC,CAAD,CAvdA,EAudK,CAvdL,CAAP;AAwdD,KA3eA,CAAD;AA4eD,GA7eA,EA6eC5tB,SA7eD,EA6eYknB,SA7eZ,EA6euBC,QA7evB,EA6eiCnnB,SA7ejC,CAAD;;AA8eA,MAAIuqB,OAAO,GAAGpD,QAAQ,CAACC,OAAT,CAAiByG,UAA/B;;AAEA,MAAIC,IAAI,GAAG,UAAUC,MAAV,EAAkB;AAC3B,QAAIC,IAAI,GAAG3nB,QAAQ,CAACrC,IAAT,EAAX;AACA,QAAIiqB,SAAS,GAAG,EAAhB;;AACA,QAAI9oB,GAAG,GAAG,UAAUjE,CAAV,EAAa;AACrB,aAAO4sB,IAAI,CAAC,UAAUI,SAAV,EAAqB;AAC/B/kB,QAAAA,GAAG,CAAC,UAAU6kB,IAAV,EAAgB;AAClBE,UAAAA,SAAS,CAAChtB,CAAC,CAAC8sB,IAAD,CAAF,CAAT;AACD,SAFE,CAAH;AAGD,OAJU,CAAX;AAKD,KAND;;AAOA,QAAI7kB,GAAG,GAAG,UAAU+kB,SAAV,EAAqB;AAC7B,UAAIC,OAAO,EAAX,EAAe;AACbptB,QAAAA,IAAI,CAACmtB,SAAD,CAAJ;AACD,OAFD,MAEO;AACLD,QAAAA,SAAS,CAACzmB,IAAV,CAAe0mB,SAAf;AACD;AACF,KAND;;AAOA,QAAIvJ,GAAG,GAAG,UAAU5kB,CAAV,EAAa;AACrB,UAAI,CAACouB,OAAO,EAAZ,EAAgB;AACdH,QAAAA,IAAI,GAAG3nB,QAAQ,CAACR,IAAT,CAAc9F,CAAd,CAAP;AACAgpB,QAAAA,GAAG,CAACkF,SAAD,CAAH;AACAA,QAAAA,SAAS,GAAG,EAAZ;AACD;AACF,KAND;;AAOA,QAAIE,OAAO,GAAG,YAAY;AACxB,aAAOH,IAAI,CAACrpB,MAAL,EAAP;AACD,KAFD;;AAGA,QAAIokB,GAAG,GAAG,UAAUqF,GAAV,EAAe;AACvBhpB,MAAAA,IAAI,CAACgpB,GAAD,EAAMrtB,IAAN,CAAJ;AACD,KAFD;;AAGA,QAAIA,IAAI,GAAG,UAAUkK,EAAV,EAAc;AACvB+iB,MAAAA,IAAI,CAAC5oB,IAAL,CAAU,UAAUrF,CAAV,EAAa;AACrBooB,QAAAA,UAAU,CAAC,YAAY;AACrBld,UAAAA,EAAE,CAAClL,CAAD,CAAF;AACD,SAFS,EAEP,CAFO,CAAV;AAGD,OAJD;AAKD,KAND;;AAOAguB,IAAAA,MAAM,CAACpJ,GAAD,CAAN;AACA,WAAO;AACLxb,MAAAA,GAAG,EAAEA,GADA;AAELhE,MAAAA,GAAG,EAAEA,GAFA;AAGLgpB,MAAAA,OAAO,EAAEA;AAHJ,KAAP;AAKD,GA3CD;;AA4CA,MAAIE,IAAI,GAAG,UAAUrrB,CAAV,EAAa;AACtB,WAAO8qB,IAAI,CAAC,UAAU3iB,QAAV,EAAoB;AAC9BA,MAAAA,QAAQ,CAACnI,CAAD,CAAR;AACD,KAFU,CAAX;AAGD,GAJD;;AAKA,MAAIsrB,SAAS,GAAG;AACd7f,IAAAA,EAAE,EAAEqf,IADU;AAEdO,IAAAA,IAAI,EAAEA;AAFQ,GAAhB;;AAKA,MAAIE,aAAa,GAAG,UAAUrC,GAAV,EAAe;AACjC/D,IAAAA,UAAU,CAAC,YAAY;AACrB,YAAM+D,GAAN;AACD,KAFS,EAEP,CAFO,CAAV;AAGD,GAJD;;AAKA,MAAIsC,IAAI,GAAG,UAAUzF,GAAV,EAAe;AACxB,QAAI5f,GAAG,GAAG,UAAUgC,QAAV,EAAoB;AAC5B4d,MAAAA,GAAG,GAAGuC,IAAN,CAAWngB,QAAX,EAAqBojB,aAArB;AACD,KAFD;;AAGA,QAAIppB,GAAG,GAAG,UAAUpC,GAAV,EAAe;AACvB,aAAOyrB,IAAI,CAAC,YAAY;AACtB,eAAOzF,GAAG,GAAGuC,IAAN,CAAWvoB,GAAX,CAAP;AACD,OAFU,CAAX;AAGD,KAJD;;AAKA,QAAIsC,IAAI,GAAG,UAAUopB,QAAV,EAAoB;AAC7B,aAAOD,IAAI,CAAC,YAAY;AACtB,eAAOzF,GAAG,GAAGuC,IAAN,CAAW,UAAUrlB,CAAV,EAAa;AAC7B,iBAAOwoB,QAAQ,CAACxoB,CAAD,CAAR,CAAYyoB,SAAZ,EAAP;AACD,SAFM,CAAP;AAGD,OAJU,CAAX;AAKD,KAND;;AAOA,QAAIC,QAAQ,GAAG,UAAUC,OAAV,EAAmB;AAChC,aAAOJ,IAAI,CAAC,YAAY;AACtB,eAAOzF,GAAG,GAAGuC,IAAN,CAAW,YAAY;AAC5B,iBAAOsD,OAAO,CAACF,SAAR,EAAP;AACD,SAFM,CAAP;AAGD,OAJU,CAAX;AAKD,KAND;;AAOA,QAAIG,MAAM,GAAG,YAAY;AACvB,aAAOP,SAAS,CAAC7f,EAAV,CAAatF,GAAb,CAAP;AACD,KAFD;;AAGA,QAAI2lB,QAAQ,GAAG,YAAY;AACzB,UAAIC,KAAK,GAAG,IAAZ;AACA,aAAOP,IAAI,CAAC,YAAY;AACtB,YAAIO,KAAK,KAAK,IAAd,EAAoB;AAClBA,UAAAA,KAAK,GAAGhG,GAAG,EAAX;AACD;;AACD,eAAOgG,KAAP;AACD,OALU,CAAX;AAMD,KARD;;AASA,QAAIL,SAAS,GAAG3F,GAAhB;AACA,WAAO;AACL5jB,MAAAA,GAAG,EAAEA,GADA;AAELE,MAAAA,IAAI,EAAEA,IAFD;AAGLspB,MAAAA,QAAQ,EAAEA,QAHL;AAILE,MAAAA,MAAM,EAAEA,MAJH;AAKLC,MAAAA,QAAQ,EAAEA,QALL;AAMLJ,MAAAA,SAAS,EAAEA,SANN;AAOLvlB,MAAAA,GAAG,EAAEA;AAPA,KAAP;AASD,GA7CD;;AA8CA,MAAI6lB,IAAI,GAAG,UAAUjB,MAAV,EAAkB;AAC3B,WAAOS,IAAI,CAAC,YAAY;AACtB,aAAO,IAAIjE,OAAJ,CAAYwD,MAAZ,CAAP;AACD,KAFU,CAAX;AAGD,GAJD;;AAKA,MAAIkB,MAAM,GAAG,UAAUjsB,CAAV,EAAa;AACxB,WAAOwrB,IAAI,CAAC,YAAY;AACtB,aAAOjE,OAAO,CAAChU,OAAR,CAAgBvT,CAAhB,CAAP;AACD,KAFU,CAAX;AAGD,GAJD;;AAKA,MAAIksB,MAAM,GAAG;AACXzgB,IAAAA,EAAE,EAAEugB,IADO;AAEXX,IAAAA,IAAI,EAAEY;AAFK,GAAb;;AAKA,MAAIE,GAAG,GAAG,UAAUC,WAAV,EAAuB3gB,EAAvB,EAA2B;AACnC,WAAOA,EAAE,CAAC,UAAUtD,QAAV,EAAoB;AAC5B,UAAIxD,CAAC,GAAG,EAAR;AACA,UAAI0nB,KAAK,GAAG,CAAZ;;AACA,UAAIpkB,EAAE,GAAG,UAAUvJ,CAAV,EAAa;AACpB,eAAO,UAAUwB,KAAV,EAAiB;AACtByE,UAAAA,CAAC,CAACjG,CAAD,CAAD,GAAOwB,KAAP;AACAmsB,UAAAA,KAAK;;AACL,cAAIA,KAAK,IAAID,WAAW,CAAC5tB,MAAzB,EAAiC;AAC/B2J,YAAAA,QAAQ,CAACxD,CAAD,CAAR;AACD;AACF,SAND;AAOD,OARD;;AASA,UAAIynB,WAAW,CAAC5tB,MAAZ,KAAuB,CAA3B,EAA8B;AAC5B2J,QAAAA,QAAQ,CAAC,EAAD,CAAR;AACD,OAFD,MAEO;AACL/F,QAAAA,IAAI,CAACgqB,WAAD,EAAc,UAAUE,UAAV,EAAsB5tB,CAAtB,EAAyB;AACzC4tB,UAAAA,UAAU,CAACnmB,GAAX,CAAe8B,EAAE,CAACvJ,CAAD,CAAjB;AACD,SAFG,CAAJ;AAGD;AACF,KAnBQ,CAAT;AAoBD,GArBD;;AAuBA,MAAI6tB,KAAK,GAAG,UAAUC,OAAV,EAAmB;AAC7B,WAAOL,GAAG,CAACK,OAAD,EAAUN,MAAM,CAACzgB,EAAjB,CAAV;AACD,GAFD;;AAIA,MAAIvL,KAAK,GAAG,UAAUgB,CAAV,EAAa;AACvB,QAAIQ,EAAE,GAAG,UAAUuB,CAAV,EAAa;AACpB,aAAO/B,CAAC,KAAK+B,CAAb;AACD,KAFD;;AAGA,QAAIhB,EAAE,GAAG,UAAUwqB,IAAV,EAAgB;AACvB,aAAOvsB,KAAK,CAACgB,CAAD,CAAZ;AACD,KAFD;;AAGA,QAAIgB,OAAO,GAAG,UAAUwqB,EAAV,EAAc;AAC1B,aAAOxsB,KAAK,CAACgB,CAAD,CAAZ;AACD,KAFD;;AAGA,QAAIiB,GAAG,GAAG,UAAUjE,CAAV,EAAa;AACrB,aAAOgC,KAAK,CAAChC,CAAC,CAACgD,CAAD,CAAF,CAAZ;AACD,KAFD;;AAGA,QAAIyrB,QAAQ,GAAG,UAAUD,EAAV,EAAc;AAC3B,aAAOxsB,KAAK,CAACgB,CAAD,CAAZ;AACD,KAFD;;AAGA,QAAIkB,IAAI,GAAG,UAAUlE,CAAV,EAAa;AACtBA,MAAAA,CAAC,CAACgD,CAAD,CAAD;AACD,KAFD;;AAGA,QAAImB,IAAI,GAAG,UAAUnE,CAAV,EAAa;AACtB,aAAOA,CAAC,CAACgD,CAAD,CAAR;AACD,KAFD;;AAGA,QAAIM,IAAI,GAAG,UAAUorB,CAAV,EAAaC,OAAb,EAAsB;AAC/B,aAAOA,OAAO,CAAC3rB,CAAD,CAAd;AACD,KAFD;;AAGA,QAAIoB,MAAM,GAAG,UAAUpE,CAAV,EAAa;AACxB,aAAOA,CAAC,CAACgD,CAAD,CAAR;AACD,KAFD;;AAGA,QAAIqB,MAAM,GAAG,UAAUrE,CAAV,EAAa;AACxB,aAAOA,CAAC,CAACgD,CAAD,CAAR;AACD,KAFD;;AAGA,QAAI4rB,UAAU,GAAG,YAAY;AAC3B,aAAOzpB,QAAQ,CAACR,IAAT,CAAc3B,CAAd,CAAP;AACD,KAFD;;AAGA,WAAO;AACLQ,MAAAA,EAAE,EAAEA,EADC;AAELqrB,MAAAA,OAAO,EAAEhsB,MAFJ;AAGLisB,MAAAA,OAAO,EAAElsB,KAHJ;AAILc,MAAAA,KAAK,EAAE3B,QAAQ,CAACiB,CAAD,CAJV;AAKLW,MAAAA,UAAU,EAAE5B,QAAQ,CAACiB,CAAD,CALf;AAMLY,MAAAA,QAAQ,EAAE7B,QAAQ,CAACiB,CAAD,CANb;AAOLe,MAAAA,EAAE,EAAEA,EAPC;AAQLC,MAAAA,OAAO,EAAEA,OARJ;AASLV,MAAAA,IAAI,EAAEA,IATD;AAULW,MAAAA,GAAG,EAAEA,GAVA;AAWLwqB,MAAAA,QAAQ,EAAEA,QAXL;AAYLvqB,MAAAA,IAAI,EAAEA,IAZD;AAaLC,MAAAA,IAAI,EAAEA,IAbD;AAcLC,MAAAA,MAAM,EAAEA,MAdH;AAeLC,MAAAA,MAAM,EAAEA,MAfH;AAgBLuqB,MAAAA,UAAU,EAAEA;AAhBP,KAAP;AAkBD,GApDD;;AAqDA,MAAI9X,KAAK,GAAG,UAAUiY,OAAV,EAAmB;AAC7B,QAAIprB,UAAU,GAAG,UAAU3D,CAAV,EAAa;AAC5B,aAAOA,CAAC,EAAR;AACD,KAFD;;AAGA,QAAI4D,QAAQ,GAAG,YAAY;AACzB,aAAOnB,GAAG,CAACpD,MAAM,CAAC0vB,OAAD,CAAP,CAAH,EAAP;AACD,KAFD;;AAGA,QAAIhrB,EAAE,GAAG,UAAUirB,GAAV,EAAe;AACtB,aAAOA,GAAP;AACD,KAFD;;AAGA,QAAIhrB,OAAO,GAAG,UAAUhE,CAAV,EAAa;AACzB,aAAOA,CAAC,EAAR;AACD,KAFD;;AAGA,QAAIiE,GAAG,GAAG,UAAUuqB,EAAV,EAAc;AACtB,aAAO1X,KAAK,CAACiY,OAAD,CAAZ;AACD,KAFD;;AAGA,QAAIN,QAAQ,GAAG,UAAUzuB,CAAV,EAAa;AAC1B,aAAO8W,KAAK,CAAC9W,CAAC,CAAC+uB,OAAD,CAAF,CAAZ;AACD,KAFD;;AAGA,QAAI5qB,IAAI,GAAG,UAAUqqB,EAAV,EAAc;AACvB,aAAO1X,KAAK,CAACiY,OAAD,CAAZ;AACD,KAFD;;AAGA,QAAIzrB,IAAI,GAAG,UAAU2rB,OAAV,EAAmBP,CAAnB,EAAsB;AAC/B,aAAOO,OAAO,CAACF,OAAD,CAAd;AACD,KAFD;;AAGA,WAAO;AACLvrB,MAAAA,EAAE,EAAEZ,KADC;AAELisB,MAAAA,OAAO,EAAEjsB,KAFJ;AAGLksB,MAAAA,OAAO,EAAEjsB,MAHJ;AAILa,MAAAA,KAAK,EAAEzB,QAJF;AAKL0B,MAAAA,UAAU,EAAEA,UALP;AAMLC,MAAAA,QAAQ,EAAEA,QANL;AAOLG,MAAAA,EAAE,EAAEA,EAPC;AAQLC,MAAAA,OAAO,EAAEA,OARJ;AASLV,MAAAA,IAAI,EAAEA,IATD;AAULW,MAAAA,GAAG,EAAEA,GAVA;AAWLwqB,MAAAA,QAAQ,EAAEA,QAXL;AAYLvqB,MAAAA,IAAI,EAAE/C,IAZD;AAaLgD,MAAAA,IAAI,EAAEA,IAbD;AAcLC,MAAAA,MAAM,EAAExB,KAdH;AAeLyB,MAAAA,MAAM,EAAExB,MAfH;AAgBL+rB,MAAAA,UAAU,EAAEzpB,QAAQ,CAACrC;AAhBhB,KAAP;AAkBD,GA3CD;;AA4CA,MAAIosB,UAAU,GAAG,UAAUF,GAAV,EAAehE,GAAf,EAAoB;AACnC,WAAOgE,GAAG,CAAC1rB,IAAJ,CAAS,YAAY;AAC1B,aAAOwT,KAAK,CAACkU,GAAD,CAAZ;AACD,KAFM,EAEJhpB,KAFI,CAAP;AAGD,GAJD;;AAKA,MAAImtB,MAAM,GAAG;AACXntB,IAAAA,KAAK,EAAEA,KADI;AAEX8U,IAAAA,KAAK,EAAEA,KAFI;AAGXoY,IAAAA,UAAU,EAAEA;AAHD,GAAb;;AAMA,MAAIE,QAAQ,GAAG,UAAUC,KAAV,EAAiB;AAC9B,QAAI,CAAC1pB,OAAO,CAAC0pB,KAAD,CAAZ,EAAqB;AACnB,YAAM,IAAI1sB,KAAJ,CAAU,wBAAV,CAAN;AACD;;AACD,QAAI0sB,KAAK,CAAC/uB,MAAN,KAAiB,CAArB,EAAwB;AACtB,YAAM,IAAIqC,KAAJ,CAAU,iCAAV,CAAN;AACD;;AACD,QAAI2sB,YAAY,GAAG,EAAnB;AACA,QAAIC,GAAG,GAAG,EAAV;AACArrB,IAAAA,IAAI,CAACmrB,KAAD,EAAQ,UAAUG,KAAV,EAAiBrB,KAAjB,EAAwB;AAClC,UAAIsB,MAAM,GAAG5uB,IAAI,CAAC2uB,KAAD,CAAjB;;AACA,UAAIC,MAAM,CAACnvB,MAAP,KAAkB,CAAtB,EAAyB;AACvB,cAAM,IAAIqC,KAAJ,CAAU,gCAAV,CAAN;AACD;;AACD,UAAI4G,GAAG,GAAGkmB,MAAM,CAAC,CAAD,CAAhB;AACA,UAAIztB,KAAK,GAAGwtB,KAAK,CAACjmB,GAAD,CAAjB;;AACA,UAAIgmB,GAAG,CAAChmB,GAAD,CAAH,KAAazK,SAAjB,EAA4B;AAC1B,cAAM,IAAI6D,KAAJ,CAAU,4BAA4B4G,GAAtC,CAAN;AACD,OAFD,MAEO,IAAIA,GAAG,KAAK,MAAZ,EAAoB;AACzB,cAAM,IAAI5G,KAAJ,CAAU,uCAAV,CAAN;AACD,OAFM,MAEA,IAAI,CAACgD,OAAO,CAAC3D,KAAD,CAAZ,EAAqB;AAC1B,cAAM,IAAIW,KAAJ,CAAU,iCAAV,CAAN;AACD;;AACD2sB,MAAAA,YAAY,CAAChpB,IAAb,CAAkBiD,GAAlB;;AACAgmB,MAAAA,GAAG,CAAChmB,GAAD,CAAH,GAAW,YAAY;AACrB,YAAIhI,IAAI,GAAG,EAAX;;AACA,aAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CD,UAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWC,SAAS,CAACD,EAAD,CAApB;AACD;;AACD,YAAIkuB,SAAS,GAAGnuB,IAAI,CAACjB,MAArB;;AACA,YAAIovB,SAAS,KAAK1tB,KAAK,CAAC1B,MAAxB,EAAgC;AAC9B,gBAAM,IAAIqC,KAAJ,CAAU,uCAAuC4G,GAAvC,GAA6C,aAA7C,GAA6DvH,KAAK,CAAC1B,MAAnE,GAA4E,IAA5E,GAAmF0B,KAAnF,GAA2F,SAA3F,GAAuG0tB,SAAjH,CAAN;AACD;;AACD,YAAI1a,KAAK,GAAG,UAAU2a,QAAV,EAAoB;AAC9B,cAAIC,UAAU,GAAG/uB,IAAI,CAAC8uB,QAAD,CAArB;;AACA,cAAIL,YAAY,CAAChvB,MAAb,KAAwBsvB,UAAU,CAACtvB,MAAvC,EAA+C;AAC7C,kBAAM,IAAIqC,KAAJ,CAAU,mDAAmD2sB,YAAY,CAACO,IAAb,CAAkB,GAAlB,CAAnD,GAA4E,YAA5E,GAA2FD,UAAU,CAACC,IAAX,CAAgB,GAAhB,CAArG,CAAN;AACD;;AACD,cAAIC,OAAO,GAAGzrB,MAAM,CAACirB,YAAD,EAAe,UAAUS,MAAV,EAAkB;AACnD,mBAAOrpB,QAAQ,CAACkpB,UAAD,EAAaG,MAAb,CAAf;AACD,WAFmB,CAApB;;AAGA,cAAI,CAACD,OAAL,EAAc;AACZ,kBAAM,IAAIntB,KAAJ,CAAU,kEAAkEitB,UAAU,CAACC,IAAX,CAAgB,IAAhB,CAAlE,GAA0F,cAA1F,GAA2GP,YAAY,CAACO,IAAb,CAAkB,IAAlB,CAArH,CAAN;AACD;;AACD,iBAAOF,QAAQ,CAACpmB,GAAD,CAAR,CAAc7H,KAAd,CAAoB,IAApB,EAA0BH,IAA1B,CAAP;AACD,SAZD;;AAaA,eAAO;AACL+B,UAAAA,IAAI,EAAE,YAAY;AAChB,gBAAI0sB,QAAQ,GAAG,EAAf;;AACA,iBAAK,IAAIxuB,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CwuB,cAAAA,QAAQ,CAACxuB,EAAD,CAAR,GAAeC,SAAS,CAACD,EAAD,CAAxB;AACD;;AACD,gBAAIwuB,QAAQ,CAAC1vB,MAAT,KAAoB+uB,KAAK,CAAC/uB,MAA9B,EAAsC;AACpC,oBAAM,IAAIqC,KAAJ,CAAU,iDAAiD0sB,KAAK,CAAC/uB,MAAvD,GAAgE,QAAhE,GAA2E0vB,QAAQ,CAAC1vB,MAA9F,CAAN;AACD;;AACD,gBAAIoP,MAAM,GAAGsgB,QAAQ,CAAC7B,KAAD,CAArB;AACA,mBAAOze,MAAM,CAAChO,KAAP,CAAa,IAAb,EAAmBH,IAAnB,CAAP;AACD,WAXI;AAYLyT,UAAAA,KAAK,EAAEA,KAZF;AAaLib,UAAAA,GAAG,EAAE,UAAUC,KAAV,EAAiB;AACpBrZ,YAAAA,OAAO,CAACoZ,GAAR,CAAYC,KAAZ,EAAmB;AACjBZ,cAAAA,YAAY,EAAEA,YADG;AAEjBnwB,cAAAA,WAAW,EAAEoK,GAFI;AAGjB4mB,cAAAA,MAAM,EAAE5uB;AAHS,aAAnB;AAKD;AAnBI,SAAP;AAqBD,OA3CD;AA4CD,KA3DG,CAAJ;AA4DA,WAAOguB,GAAP;AACD,GAtED;;AAuEA,MAAIa,GAAG,GAAG;AAAEhB,IAAAA,QAAQ,EAAEA;AAAZ,GAAV;AAEA,MAAIiB,UAAU,GAAGD,GAAG,CAAChB,QAAJ,CAAa,CAC5B;AACEkB,IAAAA,UAAU,EAAE,CACV,QADU,EAEV,QAFU;AADd,GAD4B,EAO5B;AACEC,IAAAA,UAAU,EAAE,CACV,QADU,EAEV,QAFU;AADd,GAP4B,EAa5B;AACEC,IAAAA,WAAW,EAAE,CACX,QADW,EAEX,QAFW;AADf,GAb4B,EAmB5B;AACEC,IAAAA,UAAU,EAAE,CACV,QADU,EAEV,QAFU;AADd,GAnB4B,CAAb,CAAjB;;AA0BA,MAAIC,KAAK,GAAG,UAAUC,MAAV,EAAkB;AAC5B,WAAOA,MAAM,CAACrtB,IAAP,CAAYrB,QAAZ,EAAsBA,QAAtB,CAAP;AACD,GAFD;;AAIA,WAAS2uB,iBAAT,CAA4BptB,EAA5B,EAAgCqtB,QAAhC,EAA0Cva,KAA1C,EAAiDxU,CAAjD,EAAoDgZ,MAApD,EAA4D;AAC1D,QAAItX,EAAE,CAAC8S,KAAD,EAAQxU,CAAR,CAAN,EAAkB;AAChB,aAAOqD,QAAQ,CAACR,IAAT,CAAc2R,KAAd,CAAP;AACD,KAFD,MAEO,IAAIrQ,UAAU,CAAC6U,MAAD,CAAV,IAAsBA,MAAM,CAACxE,KAAD,CAAhC,EAAyC;AAC9C,aAAOnR,QAAQ,CAACrC,IAAT,EAAP;AACD,KAFM,MAEA;AACL,aAAO+tB,QAAQ,CAACva,KAAD,EAAQxU,CAAR,EAAWgZ,MAAX,CAAf;AACD;AACF;;AAED,MAAI+V,QAAQ,GAAG,UAAUva,KAAV,EAAiBzL,SAAjB,EAA4BiQ,MAA5B,EAAoC;AACjD,QAAItC,OAAO,GAAGlC,KAAK,CAACgB,GAApB;AACA,QAAIyD,IAAI,GAAG9U,UAAU,CAAC6U,MAAD,CAAV,GAAqBA,MAArB,GAA8BlY,KAAzC;;AACA,WAAO4V,OAAO,CAACoC,UAAf,EAA2B;AACzBpC,MAAAA,OAAO,GAAGA,OAAO,CAACoC,UAAlB;AACA,UAAIiC,EAAE,GAAGnF,YAAY,CAACX,OAAb,CAAqByB,OAArB,CAAT;;AACA,UAAI3N,SAAS,CAACgS,EAAD,CAAb,EAAmB;AACjB,eAAO1X,QAAQ,CAACR,IAAT,CAAckY,EAAd,CAAP;AACD,OAFD,MAEO,IAAI9B,IAAI,CAAC8B,EAAD,CAAR,EAAc;AACnB;AACD;AACF;;AACD,WAAO1X,QAAQ,CAACrC,IAAT,EAAP;AACD,GAbD;;AAcA,MAAIguB,OAAO,GAAG,UAAUxa,KAAV,EAAiBzL,SAAjB,EAA4BiQ,MAA5B,EAAoC;AAChD,QAAItX,EAAE,GAAG,UAAUsB,CAAV,EAAaqH,IAAb,EAAmB;AAC1B,aAAOA,IAAI,CAACrH,CAAD,CAAX;AACD,KAFD;;AAGA,WAAO8rB,iBAAiB,CAACptB,EAAD,EAAKqtB,QAAL,EAAeva,KAAf,EAAsBzL,SAAtB,EAAiCiQ,MAAjC,CAAxB;AACD,GALD;;AAMA,MAAIyC,OAAO,GAAG,UAAUjH,KAAV,EAAiBzL,SAAjB,EAA4B;AACxC,QAAI2N,OAAO,GAAGlC,KAAK,CAACgB,GAApB;;AACA,QAAI,CAACkB,OAAO,CAACoC,UAAb,EAAyB;AACvB,aAAOzV,QAAQ,CAACrC,IAAT,EAAP;AACD;;AACD,WAAOiuB,OAAO,CAACrZ,YAAY,CAACX,OAAb,CAAqByB,OAAO,CAACoC,UAA7B,CAAD,EAA2C,UAAU/b,CAAV,EAAa;AACpE,aAAO,CAACwa,IAAI,CAAC/C,KAAD,EAAQzX,CAAR,CAAL,IAAmBgM,SAAS,CAAChM,CAAD,CAAnC;AACD,KAFa,CAAd;AAGD,GARD;;AASA,MAAIkyB,OAAO,GAAG,UAAUza,KAAV,EAAiBzL,SAAjB,EAA4B;AACxC,QAAIlE,IAAI,GAAG,UAAUuQ,IAAV,EAAgB;AACzB,aAAOrM,SAAS,CAAC6M,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAD,CAAhB;AACD,KAFD;;AAGA,QAAIyZ,MAAM,GAAGrpB,IAAI,CAACgP,KAAK,CAACgB,GAAN,CAAUV,UAAX,EAAuBjQ,IAAvB,CAAjB;AACA,WAAOgqB,MAAM,CAAC1sB,GAAP,CAAWyT,YAAY,CAACX,OAAxB,CAAP;AACD,GAND;;AAQA,MAAIia,UAAU,GAAG,UAAU1a,KAAV,EAAiBmC,QAAjB,EAA2BqC,MAA3B,EAAmC;AAClD,WAAO+V,QAAQ,CAACva,KAAD,EAAQ,UAAUnL,CAAV,EAAa;AAClC,aAAOoN,IAAI,CAACpN,CAAD,EAAIsN,QAAJ,CAAX;AACD,KAFc,EAEZqC,MAFY,CAAf;AAGD,GAJD;;AAKA,MAAImW,UAAU,GAAG,UAAU3a,KAAV,EAAiBmC,QAAjB,EAA2B;AAC1C,WAAOU,GAAG,CAACV,QAAD,EAAWnC,KAAX,CAAV;AACD,GAFD;;AAGA,MAAI4a,SAAS,GAAG,UAAU5a,KAAV,EAAiBmC,QAAjB,EAA2BqC,MAA3B,EAAmC;AACjD,QAAItX,EAAE,GAAG,UAAUgV,OAAV,EAAmBC,QAAnB,EAA6B;AACpC,aAAOF,IAAI,CAACC,OAAD,EAAUC,QAAV,CAAX;AACD,KAFD;;AAGA,WAAOmY,iBAAiB,CAACptB,EAAD,EAAKwtB,UAAL,EAAiB1a,KAAjB,EAAwBmC,QAAxB,EAAkCqC,MAAlC,CAAxB;AACD,GALD;;AAOA,MAAIoP,OAAO,GAAG,YAAY;AACxB,QAAI/lB,IAAI,GAAG,UAAUhC,EAAV,EAAcwI,OAAd,EAAuB;AAChC,aAAO,YAAY;AACjB,YAAIpJ,IAAI,GAAG,EAAX;;AACA,aAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CD,UAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWC,SAAS,CAACD,EAAD,CAApB;AACD;;AACDW,QAAAA,EAAE,CAACT,KAAH,CAASiJ,OAAT,EAAkBpJ,IAAlB;AACD,OAND;AAOD,KARD;;AASA,QAAIoE,OAAO,GAAG3G,KAAK,CAAC2G,OAAN,IAAiB,UAAU3D,KAAV,EAAiB;AAC9C,aAAOpB,MAAM,CAAC3B,SAAP,CAAiByF,QAAjB,CAA0B7E,IAA1B,CAA+BmC,KAA/B,MAA0C,gBAAjD;AACD,KAFD;;AAGA,QAAIqnB,OAAO,GAAG,UAAUlnB,EAAV,EAAc;AAC1B,UAAI,OAAO,IAAP,KAAgB,QAApB,EAA8B;AAC5B,cAAM,IAAImnB,SAAJ,CAAc,sCAAd,CAAN;AACD;;AACD,UAAI,OAAOnnB,EAAP,KAAc,UAAlB,EAA8B;AAC5B,cAAM,IAAImnB,SAAJ,CAAc,gBAAd,CAAN;AACD;;AACD,WAAKC,MAAL,GAAc,IAAd;AACA,WAAKE,MAAL,GAAc,IAAd;AACA,WAAKC,UAAL,GAAkB,EAAlB;AACAC,MAAAA,SAAS,CAACxnB,EAAD,EAAKgC,IAAI,CAACkR,OAAD,EAAU,IAAV,CAAT,EAA0BlR,IAAI,CAAC8lB,MAAD,EAAS,IAAT,CAA9B,CAAT;AACD,KAXD;;AAYA,QAAIkH,IAAI,GAAG9H,OAAO,CAAC+H,WAAR,IAAuB,OAAOjI,YAAP,KAAwB,UAAxB,IAAsCA,YAA7D,IAA6E,UAAUhnB,EAAV,EAAc;AACpG,aAAO8kB,UAAU,CAAC9kB,EAAD,EAAK,CAAL,CAAjB;AACD,KAFD;;AAGA,aAASynB,MAAT,CAAgBC,QAAhB,EAA0B;AACxB,UAAIxmB,EAAE,GAAG,IAAT;;AACA,UAAI,KAAKkmB,MAAL,KAAgB,IAApB,EAA0B;AACxB,aAAKG,UAAL,CAAgBpjB,IAAhB,CAAqBujB,QAArB;;AACA;AACD;;AACDsH,MAAAA,IAAI,CAAC,YAAY;AACf,YAAIpnB,EAAE,GAAG1G,EAAE,CAACkmB,MAAH,GAAYM,QAAQ,CAACE,WAArB,GAAmCF,QAAQ,CAACG,UAArD;;AACA,YAAIjgB,EAAE,KAAK,IAAX,EAAiB;AACf,WAAC1G,EAAE,CAACkmB,MAAH,GAAYM,QAAQ,CAACxU,OAArB,GAA+BwU,QAAQ,CAACI,MAAzC,EAAiD5mB,EAAE,CAAComB,MAApD;AACA;AACD;;AACD,YAAIzO,GAAJ;;AACA,YAAI;AACFA,UAAAA,GAAG,GAAGjR,EAAE,CAAC1G,EAAE,CAAComB,MAAJ,CAAR;AACD,SAFD,CAEE,OAAOte,CAAP,EAAU;AACV0e,UAAAA,QAAQ,CAACI,MAAT,CAAgB9e,CAAhB;AACA;AACD;;AACD0e,QAAAA,QAAQ,CAACxU,OAAT,CAAiB2F,GAAjB;AACD,OAdG,CAAJ;AAeD;;AACD,aAAS3F,OAAT,CAAiB8U,QAAjB,EAA2B;AACzB,UAAI;AACF,YAAIA,QAAQ,KAAK,IAAjB,EAAuB;AACrB,gBAAM,IAAIb,SAAJ,CAAc,2CAAd,CAAN;AACD;;AACD,YAAIa,QAAQ,KAAK,OAAOA,QAAP,KAAoB,QAApB,IAAgC,OAAOA,QAAP,KAAoB,UAAzD,CAAZ,EAAkF;AAChF,cAAIC,IAAI,GAAGD,QAAQ,CAACC,IAApB;;AACA,cAAI,OAAOA,IAAP,KAAgB,UAApB,EAAgC;AAC9BT,YAAAA,SAAS,CAACxlB,IAAI,CAACimB,IAAD,EAAOD,QAAP,CAAL,EAAuBhmB,IAAI,CAACkR,OAAD,EAAU,IAAV,CAA3B,EAA4ClR,IAAI,CAAC8lB,MAAD,EAAS,IAAT,CAAhD,CAAT;AACA;AACD;AACF;;AACD,aAAKV,MAAL,GAAc,IAAd;AACA,aAAKE,MAAL,GAAcU,QAAd;AACAE,QAAAA,MAAM,CAACxqB,IAAP,CAAY,IAAZ;AACD,OAdD,CAcE,OAAOsL,CAAP,EAAU;AACV8e,QAAAA,MAAM,CAACpqB,IAAP,CAAY,IAAZ,EAAkBsL,CAAlB;AACD;AACF;;AACD,aAAS8e,MAAT,CAAgBE,QAAhB,EAA0B;AACxB,WAAKZ,MAAL,GAAc,KAAd;AACA,WAAKE,MAAL,GAAcU,QAAd;AACAE,MAAAA,MAAM,CAACxqB,IAAP,CAAY,IAAZ;AACD;;AACD,aAASwqB,MAAT,GAAkB;AAChB,WAAK,IAAI7pB,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAG,KAAKmpB,UAAL,CAAgBppB,MAAtC,EAA8CE,CAAC,GAAGD,GAAlD,EAAuDC,CAAC,EAAxD,EAA4D;AAC1DopB,QAAAA,MAAM,CAAC/pB,IAAP,CAAY,IAAZ,EAAkB,KAAK6pB,UAAL,CAAgBlpB,CAAhB,CAAlB;AACD;;AACD,WAAKkpB,UAAL,GAAkB,IAAlB;AACD;;AACD,aAASa,OAAT,CAAiBR,WAAjB,EAA8BC,UAA9B,EAA0C3U,OAA1C,EAAmD4U,MAAnD,EAA2D;AACzD,WAAKF,WAAL,GAAmB,OAAOA,WAAP,KAAuB,UAAvB,GAAoCA,WAApC,GAAkD,IAArE;AACA,WAAKC,UAAL,GAAkB,OAAOA,UAAP,KAAsB,UAAtB,GAAmCA,UAAnC,GAAgD,IAAlE;AACA,WAAK3U,OAAL,GAAeA,OAAf;AACA,WAAK4U,MAAL,GAAcA,MAAd;AACD;;AACD,QAAIN,SAAS,GAAG,UAAUxnB,EAAV,EAAc4nB,WAAd,EAA2BC,UAA3B,EAAuC;AACrD,UAAIQ,IAAI,GAAG,KAAX;;AACA,UAAI;AACFroB,QAAAA,EAAE,CAAC,UAAUH,KAAV,EAAiB;AAClB,cAAIwoB,IAAJ,EAAU;AACR;AACD;;AACDA,UAAAA,IAAI,GAAG,IAAP;AACAT,UAAAA,WAAW,CAAC/nB,KAAD,CAAX;AACD,SANC,EAMC,UAAUyoB,MAAV,EAAkB;AACnB,cAAID,IAAJ,EAAU;AACR;AACD;;AACDA,UAAAA,IAAI,GAAG,IAAP;AACAR,UAAAA,UAAU,CAACS,MAAD,CAAV;AACD,SAZC,CAAF;AAaD,OAdD,CAcE,OAAOC,EAAP,EAAW;AACX,YAAIF,IAAJ,EAAU;AACR;AACD;;AACDA,QAAAA,IAAI,GAAG,IAAP;AACAR,QAAAA,UAAU,CAACU,EAAD,CAAV;AACD;AACF,KAvBD;;AAwBArB,IAAAA,OAAO,CAACpqB,SAAR,CAAkBoyB,KAAlB,GAA0B,UAAUrH,UAAV,EAAsB;AAC9C,aAAO,KAAKI,IAAL,CAAU,IAAV,EAAgBJ,UAAhB,CAAP;AACD,KAFD;;AAGAX,IAAAA,OAAO,CAACpqB,SAAR,CAAkBmrB,IAAlB,GAAyB,UAAUL,WAAV,EAAuBC,UAAvB,EAAmC;AAC1D,UAAI3mB,EAAE,GAAG,IAAT;AACA,aAAO,IAAIgmB,OAAJ,CAAY,UAAUhU,OAAV,EAAmB4U,MAAnB,EAA2B;AAC5CL,QAAAA,MAAM,CAAC/pB,IAAP,CAAYwD,EAAZ,EAAgB,IAAIknB,OAAJ,CAAYR,WAAZ,EAAyBC,UAAzB,EAAqC3U,OAArC,EAA8C4U,MAA9C,CAAhB;AACD,OAFM,CAAP;AAGD,KALD;;AAMAZ,IAAAA,OAAO,CAAC/mB,GAAR,GAAc,YAAY;AACxB,UAAI+G,MAAM,GAAG,EAAb;;AACA,WAAK,IAAI7H,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5C6H,QAAAA,MAAM,CAAC7H,EAAD,CAAN,GAAaC,SAAS,CAACD,EAAD,CAAtB;AACD;;AACD,UAAID,IAAI,GAAGvC,KAAK,CAACC,SAAN,CAAgBW,KAAhB,CAAsBC,IAAtB,CAA2BwJ,MAAM,CAAC/I,MAAP,KAAkB,CAAlB,IAAuBqF,OAAO,CAAC0D,MAAM,CAAC,CAAD,CAAP,CAA9B,GAA4CA,MAAM,CAAC,CAAD,CAAlD,GAAwDA,MAAnF,CAAX;AACA,aAAO,IAAIggB,OAAJ,CAAY,UAAUhU,OAAV,EAAmB4U,MAAnB,EAA2B;AAC5C,YAAI1oB,IAAI,CAACjB,MAAL,KAAgB,CAApB,EAAuB;AACrB,iBAAO+U,OAAO,CAAC,EAAD,CAAd;AACD;;AACD,YAAIuV,SAAS,GAAGrpB,IAAI,CAACjB,MAArB;;AACA,YAAIuqB,GAAG,GAAG,UAAUrqB,CAAV,EAAasqB,GAAb,EAAkB;AAC1B,cAAI;AACF,gBAAIA,GAAG,KAAK,OAAOA,GAAP,KAAe,QAAf,IAA2B,OAAOA,GAAP,KAAe,UAA/C,CAAP,EAAmE;AACjE,kBAAIV,IAAI,GAAGU,GAAG,CAACV,IAAf;;AACA,kBAAI,OAAOA,IAAP,KAAgB,UAApB,EAAgC;AAC9BA,gBAAAA,IAAI,CAACvqB,IAAL,CAAUirB,GAAV,EAAe,UAAUA,GAAV,EAAe;AAC5BD,kBAAAA,GAAG,CAACrqB,CAAD,EAAIsqB,GAAJ,CAAH;AACD,iBAFD,EAEGb,MAFH;AAGA;AACD;AACF;;AACD1oB,YAAAA,IAAI,CAACf,CAAD,CAAJ,GAAUsqB,GAAV;;AACA,gBAAI,EAAEF,SAAF,KAAgB,CAApB,EAAuB;AACrBvV,cAAAA,OAAO,CAAC9T,IAAD,CAAP;AACD;AACF,WAdD,CAcE,OAAOmpB,EAAP,EAAW;AACXT,YAAAA,MAAM,CAACS,EAAD,CAAN;AACD;AACF,SAlBD;;AAmBA,aAAK,IAAIlqB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGe,IAAI,CAACjB,MAAzB,EAAiCE,CAAC,EAAlC,EAAsC;AACpCqqB,UAAAA,GAAG,CAACrqB,CAAD,EAAIe,IAAI,CAACf,CAAD,CAAR,CAAH;AACD;AACF,OA3BM,CAAP;AA4BD,KAlCD;;AAmCA6oB,IAAAA,OAAO,CAAChU,OAAR,GAAkB,UAAUrT,KAAV,EAAiB;AACjC,UAAIA,KAAK,IAAI,OAAOA,KAAP,KAAiB,QAA1B,IAAsCA,KAAK,CAAC7C,WAAN,KAAsBkqB,OAAhE,EAAyE;AACvE,eAAOrnB,KAAP;AACD;;AACD,aAAO,IAAIqnB,OAAJ,CAAY,UAAUhU,OAAV,EAAmB;AACpCA,QAAAA,OAAO,CAACrT,KAAD,CAAP;AACD,OAFM,CAAP;AAGD,KAPD;;AAQAqnB,IAAAA,OAAO,CAACY,MAAR,GAAiB,UAAUjoB,KAAV,EAAiB;AAChC,aAAO,IAAIqnB,OAAJ,CAAY,UAAUhU,OAAV,EAAmB4U,MAAnB,EAA2B;AAC5CA,QAAAA,MAAM,CAACjoB,KAAD,CAAN;AACD,OAFM,CAAP;AAGD,KAJD;;AAKAqnB,IAAAA,OAAO,CAAC0B,IAAR,GAAe,UAAU1hB,MAAV,EAAkB;AAC/B,aAAO,IAAIggB,OAAJ,CAAY,UAAUhU,OAAV,EAAmB4U,MAAnB,EAA2B;AAC5C,aAAK,IAAIzpB,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAG8I,MAAM,CAAC/I,MAA7B,EAAqCE,CAAC,GAAGD,GAAzC,EAA8CC,CAAC,EAA/C,EAAmD;AACjD6I,UAAAA,MAAM,CAAC7I,CAAD,CAAN,CAAU4pB,IAAV,CAAe/U,OAAf,EAAwB4U,MAAxB;AACD;AACF,OAJM,CAAP;AAKD,KAND;;AAOA,WAAOZ,OAAP;AACD,GA/KD;;AAgLA,MAAIiI,UAAU,GAAGnf,MAAM,CAACkX,OAAP,GAAiBlX,MAAM,CAACkX,OAAxB,GAAkCa,OAAO,EAA1D;AAEA,MAAIqH,4BAAJ;;AACA,MAAIC,qBAAqB,GAAG,UAAUvnB,QAAV,EAAoBuO,OAApB,EAA6B;AACvD,QAAIiZ,yBAAyB,GAAGtf,MAAM,CAACqf,qBAAvC;AACA,QAAIE,OAAO,GAAG,CACZ,IADY,EAEZ,KAFY,EAGZ,QAHY,CAAd;;AAKA,QAAIC,WAAW,GAAG,UAAU5nB,EAAV,EAAc;AAC9BoI,MAAAA,MAAM,CAAC8U,UAAP,CAAkBld,EAAlB,EAAsB,CAAtB;AACD,KAFD;;AAGA,SAAK,IAAIvJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGkxB,OAAO,CAACpxB,MAAZ,IAAsB,CAACmxB,yBAAvC,EAAkEjxB,CAAC,EAAnE,EAAuE;AACrEixB,MAAAA,yBAAyB,GAAGtf,MAAM,CAACuf,OAAO,CAAClxB,CAAD,CAAP,GAAa,uBAAd,CAAlC;AACD;;AACD,QAAI,CAACixB,yBAAL,EAAgC;AAC9BA,MAAAA,yBAAyB,GAAGE,WAA5B;AACD;;AACDF,IAAAA,yBAAyB,CAACxnB,QAAD,EAAWuO,OAAX,CAAzB;AACD,GAjBD;;AAkBA,MAAIoZ,iBAAiB,GAAG,UAAU3nB,QAAV,EAAoB4nB,IAApB,EAA0B;AAChD,QAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC5BA,MAAAA,IAAI,GAAG,CAAP;AACD;;AACD,WAAO5K,UAAU,CAAChd,QAAD,EAAW4nB,IAAX,CAAjB;AACD,GALD;;AAMA,MAAIC,kBAAkB,GAAG,UAAU7nB,QAAV,EAAoB4nB,IAApB,EAA0B;AACjD,QAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC5BA,MAAAA,IAAI,GAAG,CAAP;AACD;;AACD,WAAOrG,WAAW,CAACvhB,QAAD,EAAW4nB,IAAX,CAAlB;AACD,GALD;;AAMA,MAAIE,mBAAmB,GAAG,UAAU5uB,EAAV,EAAc;AACtC,WAAO+jB,YAAY,CAAC/jB,EAAD,CAAnB;AACD,GAFD;;AAGA,MAAI6uB,oBAAoB,GAAG,UAAU7uB,EAAV,EAAc;AACvC,WAAOsoB,aAAa,CAACtoB,EAAD,CAApB;AACD,GAFD;;AAGA,MAAI8uB,QAAQ,GAAG,UAAUhoB,QAAV,EAAoB4nB,IAApB,EAA0B;AACvC,QAAIK,KAAJ;;AACA,QAAIC,IAAI,GAAG,YAAY;AACrB,UAAI5wB,IAAI,GAAG,EAAX;;AACA,WAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CD,QAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWC,SAAS,CAACD,EAAD,CAApB;AACD;;AACD0lB,MAAAA,YAAY,CAACgL,KAAD,CAAZ;AACAA,MAAAA,KAAK,GAAGN,iBAAiB,CAAC,YAAY;AACpC3nB,QAAAA,QAAQ,CAACvI,KAAT,CAAe,IAAf,EAAqBH,IAArB;AACD,OAFwB,EAEtBswB,IAFsB,CAAzB;AAGD,KATD;;AAUAM,IAAAA,IAAI,CAACpX,IAAL,GAAY,YAAY;AACtBmM,MAAAA,YAAY,CAACgL,KAAD,CAAZ;AACD,KAFD;;AAGA,WAAOC,IAAP;AACD,GAhBD;;AAiBA,MAAIC,KAAK,GAAG;AACVZ,IAAAA,qBAAqB,EAAE,UAAUvnB,QAAV,EAAoBuO,OAApB,EAA6B;AAClD,UAAI+Y,4BAAJ,EAAkC;AAChCA,QAAAA,4BAA4B,CAACnH,IAA7B,CAAkCngB,QAAlC;AACA;AACD;;AACDsnB,MAAAA,4BAA4B,GAAG,IAAID,UAAJ,CAAe,UAAUjc,OAAV,EAAmB;AAC/D,YAAI,CAACmD,OAAL,EAAc;AACZA,UAAAA,OAAO,GAAG/E,QAAQ,CAAC+K,IAAnB;AACD;;AACDgT,QAAAA,qBAAqB,CAACnc,OAAD,EAAUmD,OAAV,CAArB;AACD,OAL8B,EAK5B4R,IAL4B,CAKvBngB,QALuB,CAA/B;AAMD,KAZS;AAaVgd,IAAAA,UAAU,EAAE2K,iBAbF;AAcVpG,IAAAA,WAAW,EAAEsG,kBAdH;AAeVO,IAAAA,gBAAgB,EAAE,UAAUC,MAAV,EAAkBroB,QAAlB,EAA4B4nB,IAA5B,EAAkC;AAClD,aAAOD,iBAAiB,CAAC,YAAY;AACnC,YAAI,CAACU,MAAM,CAACC,OAAZ,EAAqB;AACnBtoB,UAAAA,QAAQ;AACT;AACF,OAJuB,EAIrB4nB,IAJqB,CAAxB;AAKD,KArBS;AAsBVW,IAAAA,iBAAiB,EAAE,UAAUF,MAAV,EAAkBroB,QAAlB,EAA4B4nB,IAA5B,EAAkC;AACnD,UAAIK,KAAK,GAAGJ,kBAAkB,CAAC,YAAY;AACzC,YAAI,CAACQ,MAAM,CAACC,OAAZ,EAAqB;AACnBtoB,UAAAA,QAAQ;AACT,SAFD,MAEO;AACLwhB,UAAAA,aAAa,CAACyG,KAAD,CAAb;AACD;AACF,OAN6B,EAM3BL,IAN2B,CAA9B;AAOA,aAAOK,KAAP;AACD,KA/BS;AAgCVD,IAAAA,QAAQ,EAAEA,QAhCA;AAiCVQ,IAAAA,QAAQ,EAAER,QAjCA;AAkCVxG,IAAAA,aAAa,EAAEuG,oBAlCL;AAmCV9K,IAAAA,YAAY,EAAE6K;AAnCJ,GAAZ;;AAsCA,MAAIW,gBAAgB,GAAG,UAAUC,oBAAV,EAAgCC,QAAhC,EAA0C;AAC/D,QAAIA,QAAQ,KAAK,KAAK,CAAtB,EAAyB;AACvBA,MAAAA,QAAQ,GAAG,EAAX;AACD;;AACD,QAAIC,OAAO,GAAG,CAAd;AACA,QAAIC,YAAY,GAAG,EAAnB;AACA,QAAIC,IAAI,GAAGrb,YAAY,CAACX,OAAb,CAAqB4b,oBAArB,CAAX;AACA,QAAIpc,GAAG,GAAGiE,eAAe,CAACuY,IAAD,CAAzB;AACA,QAAIC,WAAW,GAAGJ,QAAQ,CAACI,WAAT,IAAwB,IAA1C;;AACA,QAAIC,kBAAkB,GAAG,UAAUC,cAAV,EAA0B;AACjDN,MAAAA,QAAQ,CAACM,cAAT,GAA0BA,cAA1B;AACD,KAFD;;AAGA,QAAIC,QAAQ,GAAG,UAAU3a,OAAV,EAAmB;AAChCgF,MAAAA,MAAM,CAAChB,iBAAiB,CAACuW,IAAD,CAAlB,EAA0Bva,OAA1B,CAAN;AACD,KAFD;;AAGA,QAAI4a,WAAW,GAAG,UAAUjwB,EAAV,EAAc;AAC9B,UAAIkwB,cAAc,GAAG7W,iBAAiB,CAACuW,IAAD,CAAtC;AACA9B,MAAAA,UAAU,CAACoC,cAAD,EAAiB,MAAMlwB,EAAvB,CAAV,CAAqCe,IAArC,CAA0Cia,MAA1C;AACD,KAHD;;AAIA,QAAImV,gBAAgB,GAAG,UAAUvd,GAAV,EAAe;AACpC,aAAOzM,KAAK,CAACwpB,YAAD,EAAe/c,GAAf,CAAL,CAAyBpS,UAAzB,CAAoC,YAAY;AACrD,eAAO;AACLR,UAAAA,EAAE,EAAE,UAAU0vB,OAAO,EADhB;AAELU,UAAAA,MAAM,EAAE,EAFH;AAGLC,UAAAA,MAAM,EAAE,EAHH;AAILrF,UAAAA,KAAK,EAAE;AAJF,SAAP;AAMD,OAPM,CAAP;AAQD,KATD;;AAUA,QAAIsF,IAAI,GAAG,UAAU1d,GAAV,EAAe2d,OAAf,EAAwBC,OAAxB,EAAiC;AAC1C,UAAIC,IAAJ;;AACA,UAAIC,aAAa,GAAG7d,KAAK,CAACF,eAAN,CAAsBC,GAAtB,CAApB;;AACA,UAAI+d,KAAK,GAAGR,gBAAgB,CAACO,aAAD,CAA5B;AACAf,MAAAA,YAAY,CAACe,aAAD,CAAZ,GAA8BC,KAA9B;AACAA,MAAAA,KAAK,CAAC3F,KAAN;;AACA,UAAI9Y,OAAO,GAAG,UAAU0X,SAAV,EAAqBgH,MAArB,EAA6B;AACzC,YAAIvzB,CAAC,GAAGusB,SAAS,CAACzsB,MAAlB;;AACA,eAAOE,CAAC,EAAR,EAAY;AACVusB,UAAAA,SAAS,CAACvsB,CAAD,CAAT;AACD;;AACDszB,QAAAA,KAAK,CAACC,MAAN,GAAeA,MAAf;AACAD,QAAAA,KAAK,CAACP,MAAN,GAAe,EAAf;AACAO,QAAAA,KAAK,CAACN,MAAN,GAAe,EAAf;;AACA,YAAII,IAAJ,EAAU;AACRA,UAAAA,IAAI,CAACI,MAAL,GAAc,IAAd;AACAJ,UAAAA,IAAI,CAACK,OAAL,GAAe,IAAf;AACAL,UAAAA,IAAI,GAAG,IAAP;AACD;AACF,OAbD;;AAcA,UAAIL,MAAM,GAAG,YAAY;AACvB,eAAOle,OAAO,CAACye,KAAK,CAACP,MAAP,EAAe,CAAf,CAAd;AACD,OAFD;;AAGA,UAAIC,MAAM,GAAG,YAAY;AACvB,eAAOne,OAAO,CAACye,KAAK,CAACN,MAAP,EAAe,CAAf,CAAd;AACD,OAFD;;AAGA,UAAIU,IAAI,GAAG,UAAUC,YAAV,EAAwBC,YAAxB,EAAsC;AAC/C,YAAI,CAACD,YAAY,EAAjB,EAAqB;AACnB,cAAIE,IAAI,CAACC,GAAL,KAAaC,SAAb,GAAyBvB,WAA7B,EAA0C;AACxCZ,YAAAA,KAAK,CAACnL,UAAN,CAAiBmN,YAAjB;AACD,WAFD,MAEO;AACLZ,YAAAA,MAAM;AACP;AACF;AACF,OARD;;AASA,UAAIgB,uBAAuB,GAAG,YAAY;AACxCN,QAAAA,IAAI,CAAC,YAAY;AACf,cAAIO,WAAW,GAAG9B,oBAAoB,CAAC8B,WAAvC;AACA,cAAIj0B,CAAC,GAAGi0B,WAAW,CAACn0B,MAApB;;AACA,iBAAOE,CAAC,EAAR,EAAY;AACV,gBAAIk0B,UAAU,GAAGD,WAAW,CAACj0B,CAAD,CAA5B;AACA,gBAAI8Z,KAAK,GAAGoa,UAAU,CAACC,SAAvB;;AACA,gBAAIra,KAAK,IAAIA,KAAK,CAACnX,EAAN,KAAaywB,IAAI,CAACzwB,EAA/B,EAAmC;AACjCowB,cAAAA,MAAM;AACN,qBAAO,IAAP;AACD;AACF;;AACD,iBAAO,KAAP;AACD,SAZG,EAYDiB,uBAZC,CAAJ;AAaD,OAdD;;AAeA,UAAId,OAAJ,EAAa;AACXI,QAAAA,KAAK,CAACP,MAAN,CAAajtB,IAAb,CAAkBotB,OAAlB;AACD;;AACD,UAAIC,OAAJ,EAAa;AACXG,QAAAA,KAAK,CAACN,MAAN,CAAaltB,IAAb,CAAkBqtB,OAAlB;AACD;;AACD,UAAIG,KAAK,CAACC,MAAN,KAAiB,CAArB,EAAwB;AACtB;AACD;;AACD,UAAID,KAAK,CAACC,MAAN,KAAiB,CAArB,EAAwB;AACtBR,QAAAA,MAAM;AACN;AACD;;AACD,UAAIO,KAAK,CAACC,MAAN,KAAiB,CAArB,EAAwB;AACtBP,QAAAA,MAAM;AACN;AACD;;AACDM,MAAAA,KAAK,CAACC,MAAN,GAAe,CAAf;AACA,UAAIa,QAAQ,GAAGld,YAAY,CAACV,OAAb,CAAqB,MAArB,EAA6BT,GAAG,CAACe,GAAjC,CAAf;AACAoM,MAAAA,MAAM,CAACkR,QAAD,EAAW;AACfC,QAAAA,GAAG,EAAE,YADU;AAEfvvB,QAAAA,IAAI,EAAE,UAFS;AAGfnC,QAAAA,EAAE,EAAE2wB,KAAK,CAAC3wB;AAHK,OAAX,CAAN;AAKA,UAAIoxB,SAAS,GAAGF,IAAI,CAACC,GAAL,EAAhB;;AACA,UAAI1B,QAAQ,CAACkC,cAAb,EAA6B;AAC3BrR,QAAAA,GAAG,CAACmR,QAAD,EAAW,aAAX,EAA0B,WAA1B,CAAH;AACD;;AACD,UAAIhC,QAAQ,CAACM,cAAb,EAA6B;AAC3BzP,QAAAA,GAAG,CAACmR,QAAD,EAAW,gBAAX,EAA6BhC,QAAQ,CAACM,cAAtC,CAAH;AACD;;AACDU,MAAAA,IAAI,GAAGgB,QAAQ,CAACtd,GAAhB;AACAsc,MAAAA,IAAI,CAACI,MAAL,GAAcQ,uBAAd;AACAZ,MAAAA,IAAI,CAACK,OAAL,GAAeT,MAAf;AACAL,MAAAA,QAAQ,CAACyB,QAAD,CAAR;AACAnR,MAAAA,GAAG,CAACmR,QAAD,EAAW,MAAX,EAAmBf,aAAnB,CAAH;AACD,KAtFD;;AAuFA,QAAIkB,KAAK,GAAG,UAAUhf,GAAV,EAAe;AACzB,aAAOiY,MAAM,CAACzgB,EAAP,CAAU,UAAU8H,OAAV,EAAmB;AAClCoe,QAAAA,IAAI,CAAC1d,GAAD,EAAM3U,OAAO,CAACiU,OAAD,EAAUtT,QAAQ,CAACotB,MAAM,CAACntB,KAAP,CAAa+T,GAAb,CAAD,CAAlB,CAAb,EAAqD3U,OAAO,CAACiU,OAAD,EAAUtT,QAAQ,CAACotB,MAAM,CAACrY,KAAP,CAAaf,GAAb,CAAD,CAAlB,CAA5D,CAAJ;AACD,OAFM,CAAP;AAGD,KAJD;;AAKA,QAAIif,OAAO,GAAG,UAAUC,IAAV,EAAgBvB,OAAhB,EAAyBC,OAAzB,EAAkC;AAC9CtF,MAAAA,KAAK,CAACpqB,GAAG,CAACgxB,IAAD,EAAOF,KAAP,CAAJ,CAAL,CAAwB9sB,GAAxB,CAA4B,UAAU0oB,MAAV,EAAkB;AAC5C,YAAIuE,KAAK,GAAGruB,SAAS,CAAC8pB,MAAD,EAAS,UAAUlqB,CAAV,EAAa;AACzC,iBAAOA,CAAC,CAACooB,OAAF,EAAP;AACD,SAFoB,CAArB;;AAGA,YAAIqG,KAAK,CAACnuB,IAAN,CAAWzG,MAAX,GAAoB,CAAxB,EAA2B;AACzBqzB,UAAAA,OAAO,CAACuB,KAAK,CAACnuB,IAAN,CAAW9C,GAAX,CAAeysB,KAAf,CAAD,CAAP;AACD,SAFD,MAEO;AACLgD,UAAAA,OAAO,CAACwB,KAAK,CAACpuB,IAAN,CAAW7C,GAAX,CAAeysB,KAAf,CAAD,CAAP;AACD;AACF,OATD;AAUD,KAXD;;AAYA,QAAIyE,MAAM,GAAG,UAAUpf,GAAV,EAAe;AAC1B,UAAI8d,aAAa,GAAG7d,KAAK,CAACF,eAAN,CAAsBC,GAAtB,CAApB;;AACAzM,MAAAA,KAAK,CAACwpB,YAAD,EAAee,aAAf,CAAL,CAAmC3vB,IAAnC,CAAwC,UAAU4vB,KAAV,EAAiB;AACvD,YAAI3F,KAAK,GAAG,EAAE2F,KAAK,CAAC3F,KAApB;;AACA,YAAIA,KAAK,KAAK,CAAd,EAAiB;AACf,iBAAO2E,YAAY,CAACe,aAAD,CAAnB;AACAT,UAAAA,WAAW,CAACU,KAAK,CAAC3wB,EAAP,CAAX;AACD;AACF,OAND;AAOD,KATD;;AAUA,QAAIiyB,SAAS,GAAG,UAAUH,IAAV,EAAgB;AAC9B/wB,MAAAA,IAAI,CAAC+wB,IAAD,EAAO,UAAUlf,GAAV,EAAe;AACxBof,QAAAA,MAAM,CAACpf,GAAD,CAAN;AACD,OAFG,CAAJ;AAGD,KAJD;;AAKA,WAAO;AACL0d,MAAAA,IAAI,EAAEA,IADD;AAELuB,MAAAA,OAAO,EAAEA,OAFJ;AAGLG,MAAAA,MAAM,EAAEA,MAHH;AAILC,MAAAA,SAAS,EAAEA,SAJN;AAKLnC,MAAAA,kBAAkB,EAAEA;AALf,KAAP;AAOD,GA3JD;;AA6JA,MAAIoC,QAAQ,GAAG,YAAY;AACzB,QAAIpxB,GAAG,GAAG,IAAIqxB,OAAJ,EAAV;;AACA,QAAIC,UAAU,GAAG,UAAUC,gBAAV,EAA4B5C,QAA5B,EAAsC;AACrD,UAAIne,IAAI,GAAG6H,WAAW,CAACkZ,gBAAD,CAAtB;AACA,UAAIC,OAAO,GAAGhhB,IAAI,CAAC6C,GAAnB;AACA,aAAOnS,QAAQ,CAACD,IAAT,CAAcjB,GAAG,CAACgE,GAAJ,CAAQwtB,OAAR,CAAd,EAAgC9xB,UAAhC,CAA2C,YAAY;AAC5D,YAAI+xB,EAAE,GAAGhD,gBAAgB,CAAC+C,OAAD,EAAU7C,QAAV,CAAzB;AACA3uB,QAAAA,GAAG,CAACwf,GAAJ,CAAQgS,OAAR,EAAiBC,EAAjB;AACA,eAAOA,EAAP;AACD,OAJM,CAAP;AAKD,KARD;;AASA,WAAO;AAAEH,MAAAA,UAAU,EAAEA;AAAd,KAAP;AACD,GAZD;;AAaA,MAAII,QAAQ,GAAGN,QAAQ,EAAvB;;AAEA,MAAIO,aAAa,GAAG,YAAY;AAC9B,aAASA,aAAT,CAAuBC,SAAvB,EAAkCC,QAAlC,EAA4C;AAC1C,WAAK5e,IAAL,GAAY2e,SAAZ;AACA,WAAKC,QAAL,GAAgBA,QAAhB;AACA,WAAKznB,OAAL,GAAe,KAAKA,OAAL,CAAalK,IAAb,CAAkB,IAAlB,CAAf;AACA,WAAK4xB,IAAL,GAAY,KAAKA,IAAL,CAAU5xB,IAAV,CAAe,IAAf,CAAZ;AACA,WAAK6xB,IAAL,GAAY,KAAKA,IAAL,CAAU7xB,IAAV,CAAe,IAAf,CAAZ;AACA,WAAK8xB,KAAL,GAAa,KAAKA,KAAL,CAAW9xB,IAAX,CAAgB,IAAhB,CAAb;AACD;;AACDyxB,IAAAA,aAAa,CAAC32B,SAAd,CAAwBoP,OAAxB,GAAkC,YAAY;AAC5C,aAAO,KAAK6I,IAAZ;AACD,KAFD;;AAGA0e,IAAAA,aAAa,CAAC32B,SAAd,CAAwB82B,IAAxB,GAA+B,UAAUG,OAAV,EAAmB;AAChD,WAAKhf,IAAL,GAAY,KAAKif,WAAL,CAAiB,KAAKjf,IAAtB,EAA4B,YAA5B,EAA0C,aAA1C,EAAyDgf,OAAzD,CAAZ;AACA,aAAO,KAAKhf,IAAZ;AACD,KAHD;;AAIA0e,IAAAA,aAAa,CAAC32B,SAAd,CAAwB+2B,IAAxB,GAA+B,UAAUE,OAAV,EAAmB;AAChD,WAAKhf,IAAL,GAAY,KAAKif,WAAL,CAAiB,KAAKjf,IAAtB,EAA4B,WAA5B,EAAyC,iBAAzC,EAA4Dgf,OAA5D,CAAZ;AACA,aAAO,KAAKhf,IAAZ;AACD,KAHD;;AAIA0e,IAAAA,aAAa,CAAC32B,SAAd,CAAwBg3B,KAAxB,GAAgC,UAAUC,OAAV,EAAmB;AACjD,WAAKhf,IAAL,GAAY,KAAKkf,gBAAL,CAAsB,KAAKlf,IAA3B,EAAiC,WAAjC,EAA8C,iBAA9C,EAAiEgf,OAAjE,CAAZ;AACA,aAAO,KAAKhf,IAAZ;AACD,KAHD;;AAIA0e,IAAAA,aAAa,CAAC32B,SAAd,CAAwBk3B,WAAxB,GAAsC,UAAUjf,IAAV,EAAgBmf,SAAhB,EAA2BC,WAA3B,EAAwCJ,OAAxC,EAAiD;AACrF,UAAI3Y,OAAJ,EAAajI,MAAb;;AACA,UAAI4B,IAAJ,EAAU;AACR,YAAI,CAACgf,OAAD,IAAYhf,IAAI,CAACmf,SAAD,CAApB,EAAiC;AAC/B,iBAAOnf,IAAI,CAACmf,SAAD,CAAX;AACD;;AACD,YAAInf,IAAI,KAAK,KAAK4e,QAAlB,EAA4B;AAC1BvY,UAAAA,OAAO,GAAGrG,IAAI,CAACof,WAAD,CAAd;;AACA,cAAI/Y,OAAJ,EAAa;AACX,mBAAOA,OAAP;AACD;;AACD,eAAKjI,MAAM,GAAG4B,IAAI,CAAC0D,UAAnB,EAA+BtF,MAAM,IAAIA,MAAM,KAAK,KAAKwgB,QAAzD,EAAmExgB,MAAM,GAAGA,MAAM,CAACsF,UAAnF,EAA+F;AAC7F2C,YAAAA,OAAO,GAAGjI,MAAM,CAACghB,WAAD,CAAhB;;AACA,gBAAI/Y,OAAJ,EAAa;AACX,qBAAOA,OAAP;AACD;AACF;AACF;AACF;AACF,KAnBD;;AAoBAqY,IAAAA,aAAa,CAAC32B,SAAd,CAAwBm3B,gBAAxB,GAA2C,UAAUlf,IAAV,EAAgBmf,SAAhB,EAA2BC,WAA3B,EAAwCJ,OAAxC,EAAiD;AAC1F,UAAI3Y,OAAJ,EAAajI,MAAb,EAAqBqG,KAArB;;AACA,UAAIzE,IAAJ,EAAU;AACRqG,QAAAA,OAAO,GAAGrG,IAAI,CAACof,WAAD,CAAd;;AACA,YAAI,KAAKR,QAAL,IAAiBvY,OAAO,KAAK,KAAKuY,QAAtC,EAAgD;AAC9C;AACD;;AACD,YAAIvY,OAAJ,EAAa;AACX,cAAI,CAAC2Y,OAAL,EAAc;AACZ,iBAAKva,KAAK,GAAG4B,OAAO,CAAC8Y,SAAD,CAApB,EAAiC1a,KAAjC,EAAwCA,KAAK,GAAGA,KAAK,CAAC0a,SAAD,CAArD,EAAkE;AAChE,kBAAI,CAAC1a,KAAK,CAAC0a,SAAD,CAAV,EAAuB;AACrB,uBAAO1a,KAAP;AACD;AACF;AACF;;AACD,iBAAO4B,OAAP;AACD;;AACDjI,QAAAA,MAAM,GAAG4B,IAAI,CAAC0D,UAAd;;AACA,YAAItF,MAAM,IAAIA,MAAM,KAAK,KAAKwgB,QAA9B,EAAwC;AACtC,iBAAOxgB,MAAP;AACD;AACF;AACF,KAtBD;;AAuBA,WAAOsgB,aAAP;AACD,GApEmB,EAApB;;AAsEA,MAAIW,MAAM,GAAG,CACX,SADW,EAEX,OAFW,EAGX,SAHW,EAIX,KAJW,EAKX,IALW,EAMX,YANW,EAOX,QAPW,EAQX,MARW,EASX,UATW,EAUX,QAVW,EAWX,QAXW,EAYX,MAZW,EAaX,MAbW,EAcX,KAdW,EAeX,SAfW,EAgBX,SAhBW,EAiBX,MAjBW,EAkBX,GAlBW,EAmBX,IAnBW,EAoBX,UApBW,EAqBX,IArBW,EAsBX,QAtBW,EAuBX,SAvBW,EAwBX,QAxBW,EAyBX,YAzBW,EA0BX,IA1BW,EA2BX,IA3BW,EA4BX,IA5BW,EA6BX,IA7BW,EA8BX,IA9BW,EA+BX,IA/BW,EAgCX,SAhCW,EAiCX,KAjCW,EAkCX,KAlCW,EAmCX,WAnCW,EAoCX,MApCW,EAqCX,KArCW,EAsCX,IAtCW,EAuCX,IAvCW,EAwCX,IAxCW,EAyCX,IAzCW,EA0CX,OA1CW,EA2CX,OA3CW,EA4CX,OA5CW,EA6CX,OA7CW,EA8CX,IA9CW,EA+CX,IA/CW,EAgDX,IAhDW,EAiDX,SAjDW,CAAb;AAmDA,MAAIC,UAAU,GAAG,CACf,IADe,EAEf,IAFe,CAAjB;AAIA,MAAIC,aAAa,GAAG,CAClB,OADkB,EAElB,OAFkB,EAGlB,OAHkB,CAApB;AAKA,MAAIC,UAAU,GAAG,CACf,IADe,EAEf,IAFe,EAGf,IAHe,EAIf,IAJe,EAKf,IALe,EAMf,IANe,EAOf,GAPe,EAQf,KARe,EASf,SATe,EAUf,KAVe,EAWf,MAXe,EAYf,YAZe,EAaf,QAbe,EAcf,KAde,EAef,UAfe,EAgBf,QAhBe,EAiBf,QAjBe,EAkBf,SAlBe,EAmBf,SAnBe,EAoBf,QApBe,EAqBf,OArBe,EAsBf,KAtBe,EAuBf,QAvBe,CAAjB;AAyBA,MAAIC,QAAQ,GAAG,CACb,IADa,EAEb,IAFa,EAGb,IAHa,EAIb,IAJa,EAKb,IALa,EAMb,IANa,CAAf;AAQA,MAAIC,SAAS,GAAG,CACd,IADc,EAEd,IAFc,EAGd,IAHc,CAAhB;AAKA,MAAIC,KAAK,GAAG,CACV,IADU,EAEV,IAFU,EAGV,IAHU,CAAZ;AAKA,MAAIC,UAAU,GAAG,CACf,KADe,EAEf,QAFe,EAGf,UAHe,EAIf,OAJe,CAAjB;;AAMA,MAAIC,UAAU,GAAG,UAAU5iB,KAAV,EAAiB;AAChC,QAAI6iB,MAAJ;AACA,WAAO,UAAU9f,IAAV,EAAgB;AACrB8f,MAAAA,MAAM,GAAGA,MAAM,GAAGA,MAAH,GAAYnvB,WAAW,CAACsM,KAAD,EAAQtR,MAAR,CAAtC;AACA,aAAOm0B,MAAM,CAAC1uB,cAAP,CAAsBlJ,IAAI,CAAC8X,IAAD,CAA1B,CAAP;AACD,KAHD;AAID,GAND;;AAOA,MAAI+f,SAAS,GAAGF,UAAU,CAACJ,QAAD,CAA1B;AACA,MAAIO,OAAO,GAAGH,UAAU,CAACR,MAAD,CAAxB;;AACA,MAAIY,SAAS,GAAG,UAAUjgB,IAAV,EAAgB;AAC9B,WAAO9X,IAAI,CAAC8X,IAAD,CAAJ,KAAe,OAAtB;AACD,GAFD;;AAGA,MAAIkgB,QAAQ,GAAG,UAAUlgB,IAAV,EAAgB;AAC7B,WAAOgD,SAAS,CAAChD,IAAD,CAAT,IAAmB,CAACggB,OAAO,CAAChgB,IAAD,CAAlC;AACD,GAFD;;AAGA,MAAImgB,MAAM,GAAG,UAAUngB,IAAV,EAAgB;AAC3B,WAAOgD,SAAS,CAAChD,IAAD,CAAT,IAAmB9X,IAAI,CAAC8X,IAAD,CAAJ,KAAe,IAAzC;AACD,GAFD;;AAGA,MAAIogB,WAAW,GAAGP,UAAU,CAACL,UAAD,CAA5B;AACA,MAAIa,MAAM,GAAGR,UAAU,CAACF,KAAD,CAAvB;AACA,MAAIW,UAAU,GAAGT,UAAU,CAACH,SAAD,CAA3B;AACA,MAAIa,cAAc,GAAGV,UAAU,CAACN,aAAD,CAA/B;AACA,MAAIiB,aAAa,GAAGX,UAAU,CAACP,UAAD,CAA9B;AACA,MAAImB,mBAAmB,GAAGZ,UAAU,CAACD,UAAD,CAApC;;AAEA,MAAIc,UAAU,GAAG,UAAUthB,KAAV,EAAiBmC,QAAjB,EAA2BqC,MAA3B,EAAmC;AAClD,WAAOkW,UAAU,CAAC1a,KAAD,EAAQmC,QAAR,EAAkBqC,MAAlB,CAAV,CAAoCrX,MAApC,EAAP;AACD,GAFD;;AAIA,MAAIo0B,SAAS,GAAG,QAAhB;AACA,MAAIC,IAAI,GAAG,MAAX;;AACA,MAAIC,MAAM,GAAG,UAAUC,IAAV,EAAgB;AAC3B,WAAOA,IAAI,KAAKH,SAAhB;AACD,GAFD;;AAGA,MAAII,UAAU,GAAG,UAAUnzB,CAAV,EAAa;AAC5B,WAAOA,CAAC,CAACwI,OAAF,CAAU,SAAV,EAAqB,EAArB,CAAP;AACD,GAFD;;AAIA,MAAI4qB,IAAI,GAAGL,SAAX;AACA,MAAIM,QAAQ,GAAGJ,MAAf;AACA,MAAIK,MAAM,GAAGH,UAAb;AAEA,MAAII,WAAW,GAAG9W,WAAlB;AACA,MAAI+W,QAAQ,GAAG3V,QAAf;;AACA,MAAI4V,qBAAqB,GAAG,UAAUrhB,IAAV,EAAgB;AAC1C,QAAIohB,QAAQ,CAACphB,IAAD,CAAZ,EAAoB;AAClBA,MAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,WAAOyd,WAAW,CAACnhB,IAAD,CAAX,IAAqBA,IAAI,CAAC8K,YAAL,CAAkB,gBAAlB,CAA5B;AACD,GALD;;AAMA,MAAIwW,sBAAsB,GAAG,UAAUthB,IAAV,EAAgB;AAC3C,WAAOohB,QAAQ,CAACphB,IAAD,CAAR,IAAkBihB,QAAQ,CAACjhB,IAAI,CAAC4V,IAAN,CAAjC;AACD,GAFD;;AAGA,MAAI2L,gBAAgB,GAAG,UAAUvhB,IAAV,EAAgB;AACrC,WAAOqhB,qBAAqB,CAACrhB,IAAD,CAArB,IAA+BshB,sBAAsB,CAACthB,IAAD,CAA5D;AACD,GAFD;;AAGA,MAAIwhB,UAAU,GAAG,UAAUxhB,IAAV,EAAgB;AAC/B,WAAOA,IAAI,CAAC2E,UAAL,KAAoB3E,IAAI,CAAC4E,SAAzB,IAAsC,CAACiH,IAAI,CAAC7L,IAAI,CAAC2E,UAAN,CAAlD;AACD,GAFD;;AAGA,MAAI8c,YAAY,GAAG,UAAUzhB,IAAV,EAAgBgG,MAAhB,EAAwB;AACzC,QAAIK,OAAJ;AACA,QAAIhH,GAAG,GAAGW,IAAI,CAACqD,aAAf;AACA,QAAIqe,QAAQ,GAAGriB,GAAG,CAACc,cAAJ,CAAmB6gB,IAAnB,CAAf;AACA,QAAItd,UAAU,GAAG1D,IAAI,CAAC0D,UAAtB;;AACA,QAAI,CAACsC,MAAL,EAAa;AACXK,MAAAA,OAAO,GAAGrG,IAAI,CAACsE,WAAf;;AACA,UAAI8c,QAAQ,CAAC/a,OAAD,CAAZ,EAAuB;AACrB,YAAIkb,gBAAgB,CAAClb,OAAD,CAApB,EAA+B;AAC7B,iBAAOA,OAAP;AACD;;AACD,YAAIsb,wBAAwB,CAACtb,OAAD,CAA5B,EAAuC;AACrCA,UAAAA,OAAO,CAACub,SAAR,CAAkB,CAAlB;AACA,iBAAOvb,OAAP;AACD;AACF;;AACD,UAAIrG,IAAI,CAACsE,WAAT,EAAsB;AACpBZ,QAAAA,UAAU,CAACyC,YAAX,CAAwBub,QAAxB,EAAkC1hB,IAAI,CAACsE,WAAvC;AACD,OAFD,MAEO;AACLZ,QAAAA,UAAU,CAAC+C,WAAX,CAAuBib,QAAvB;AACD;AACF,KAhBD,MAgBO;AACLrb,MAAAA,OAAO,GAAGrG,IAAI,CAACqE,eAAf;;AACA,UAAI+c,QAAQ,CAAC/a,OAAD,CAAZ,EAAuB;AACrB,YAAIkb,gBAAgB,CAAClb,OAAD,CAApB,EAA+B;AAC7B,iBAAOA,OAAP;AACD;;AACD,YAAIwb,sBAAsB,CAACxb,OAAD,CAA1B,EAAqC;AACnC,iBAAOA,OAAO,CAACub,SAAR,CAAkBvb,OAAO,CAACuP,IAAR,CAAaxsB,MAAb,GAAsB,CAAxC,CAAP;AACD;AACF;;AACDsa,MAAAA,UAAU,CAACyC,YAAX,CAAwBub,QAAxB,EAAkC1hB,IAAlC;AACD;;AACD,WAAO0hB,QAAP;AACD,GAlCD;;AAmCA,MAAII,cAAc,GAAG,UAAUjT,GAAV,EAAe;AAClC,QAAInS,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,EAAhB;;AACA,QAAI,CAAC+O,QAAQ,CAAC/O,SAAD,CAAb,EAA0B;AACxB,aAAO,KAAP;AACD;;AACD,WAAOA,SAAS,CAACkZ,IAAV,CAAemM,MAAf,CAAsBlT,GAAG,CAACmT,MAAJ,EAAtB,MAAwChB,IAAxC,IAAgDnS,GAAG,CAACoT,SAAJ,MAAmBX,sBAAsB,CAAC5kB,SAAS,CAAC2H,eAAX,CAAhG;AACD,GAND;;AAOA,MAAI6d,aAAa,GAAG,UAAUrT,GAAV,EAAe;AACjC,QAAInS,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,EAAhB;;AACA,QAAI,CAAC+O,QAAQ,CAAC/O,SAAD,CAAb,EAA0B;AACxB,aAAO,KAAP;AACD;;AACD,WAAOA,SAAS,CAACkZ,IAAV,CAAemM,MAAf,CAAsBlT,GAAG,CAACmT,MAAJ,KAAe,CAArC,MAA4ChB,IAA5C,IAAoDnS,GAAG,CAACsT,OAAJ,MAAiBb,sBAAsB,CAAC5kB,SAAS,CAAC4H,WAAX,CAAlG;AACD,GAND;;AAOA,MAAI8d,aAAa,GAAG,YAAY;AAC9B,QAAIC,EAAE,GAAG9lB,QAAQ,CAACgD,aAAT,CAAuB,IAAvB,CAAT;AACA8iB,IAAAA,EAAE,CAAC/V,YAAH,CAAgB,gBAAhB,EAAkC,GAAlC;AACA,WAAO+V,EAAP;AACD,GAJD;;AAKA,MAAIC,WAAW,GAAG,UAAUC,SAAV,EAAqBviB,IAArB,EAA2BgG,MAA3B,EAAmC;AACnD,QAAI3G,GAAG,GAAGW,IAAI,CAACqD,aAAf;AACA,QAAImf,SAAS,GAAGnjB,GAAG,CAACE,aAAJ,CAAkBgjB,SAAlB,CAAhB;AACAC,IAAAA,SAAS,CAAClW,YAAV,CAAuB,gBAAvB,EAAyCtG,MAAM,GAAG,QAAH,GAAc,OAA7D;AACAwc,IAAAA,SAAS,CAAClW,YAAV,CAAuB,gBAAvB,EAAyC,KAAzC;AACAkW,IAAAA,SAAS,CAAC/b,WAAV,CAAsB2b,aAAa,EAAnC;AACA,QAAI1e,UAAU,GAAG1D,IAAI,CAAC0D,UAAtB;;AACA,QAAI,CAACsC,MAAL,EAAa;AACX,UAAIhG,IAAI,CAACsE,WAAT,EAAsB;AACpBZ,QAAAA,UAAU,CAACyC,YAAX,CAAwBqc,SAAxB,EAAmCxiB,IAAI,CAACsE,WAAxC;AACD,OAFD,MAEO;AACLZ,QAAAA,UAAU,CAAC+C,WAAX,CAAuB+b,SAAvB;AACD;AACF,KAND,MAMO;AACL9e,MAAAA,UAAU,CAACyC,YAAX,CAAwBqc,SAAxB,EAAmCxiB,IAAnC;AACD;;AACD,WAAOwiB,SAAP;AACD,GAjBD;;AAkBA,MAAIb,wBAAwB,GAAG,UAAU3hB,IAAV,EAAgB;AAC7C,WAAOohB,QAAQ,CAACphB,IAAD,CAAR,IAAkBA,IAAI,CAAC4V,IAAL,CAAU,CAAV,MAAiBoL,IAA1C;AACD,GAFD;;AAGA,MAAIa,sBAAsB,GAAG,UAAU7hB,IAAV,EAAgB;AAC3C,WAAOohB,QAAQ,CAACphB,IAAD,CAAR,IAAkBA,IAAI,CAAC4V,IAAL,CAAU5V,IAAI,CAAC4V,IAAL,CAAUxsB,MAAV,GAAmB,CAA7B,MAAoC43B,IAA7D;AACD,GAFD;;AAGA,MAAIyB,WAAW,GAAG,UAAUtU,GAAV,EAAe;AAC/B,QAAIuU,GAAG,GAAGvU,GAAG,CAACwU,oBAAJ,CAAyB,IAAzB,CAAV;AACA,QAAIC,MAAM,GAAGF,GAAG,CAACA,GAAG,CAACt5B,MAAJ,GAAa,CAAd,CAAhB;;AACA,QAAI+hB,OAAO,CAACyX,MAAD,CAAX,EAAqB;AACnBA,MAAAA,MAAM,CAAClf,UAAP,CAAkBwD,WAAlB,CAA8B0b,MAA9B;AACD;AACF,GAND;;AAOA,MAAIC,uBAAuB,GAAG,UAAUC,cAAV,EAA0B;AACtD,QAAIA,cAAc,IAAIA,cAAc,CAAChY,YAAf,CAA4B,gBAA5B,CAAtB,EAAqE;AACnE2X,MAAAA,WAAW,CAACK,cAAD,CAAX;AACAA,MAAAA,cAAc,CAAChW,eAAf,CAA+B,gBAA/B;AACAgW,MAAAA,cAAc,CAAChW,eAAf,CAA+B,gBAA/B;AACAgW,MAAAA,cAAc,CAAChW,eAAf,CAA+B,OAA/B;AACAgW,MAAAA,cAAc,CAAChW,eAAf,CAA+B,aAA/B;AACA,aAAOgW,cAAP;AACD;;AACD,WAAO,IAAP;AACD,GAVD;;AAWA,MAAIC,4BAA4B,GAAG,UAAU3mB,KAAV,EAAiB;AAClD,WAAOilB,qBAAqB,CAACjlB,KAAK,CAAC4mB,cAAP,CAA5B;AACD,GAFD;;AAIA,MAAIC,uBAAuB,GAAGlX,qBAA9B;AACA,MAAImX,wBAAwB,GAAGlX,sBAA/B;AACA,MAAImX,MAAM,GAAGtX,IAAb;AACA,MAAIuX,QAAQ,GAAG3X,QAAf;AACA,MAAI4X,oBAAoB,GAAG/Y,cAAc,CAAC,CACxC,QADwC,EAExC,OAFwC,EAGxC,UAHwC,CAAD,CAAzC;AAKA,MAAIgZ,cAAc,GAAGhZ,cAAc,CAAC,CAClC,KADkC,EAElC,OAFkC,EAGlC,UAHkC,EAIlC,IAJkC,EAKlC,QALkC,EAMlC,OANkC,EAOlC,OAPkC,EAQlC,QARkC,EASlC,OATkC,CAAD,CAAnC;AAWA,MAAIiZ,SAAS,GAAGjZ,cAAc,CAAC,CAAC,OAAD,CAAD,CAA9B;AACA,MAAIkZ,kBAAkB,GAAGjC,gBAAzB;;AACA,MAAIkC,gBAAgB,GAAG,UAAUzjB,IAAV,EAAgB;AACrC,QAAIwjB,kBAAkB,CAACxjB,IAAD,CAAtB,EAA8B;AAC5B,aAAO,KAAP;AACD;;AACD,QAAIojB,QAAQ,CAACpjB,IAAD,CAAZ,EAAoB;AAClB,aAAO,CAACqjB,oBAAoB,CAACrjB,IAAI,CAAC0D,UAAN,CAA5B;AACD;;AACD,WAAO4f,cAAc,CAACtjB,IAAD,CAAd,IAAwBmjB,MAAM,CAACnjB,IAAD,CAA9B,IAAwCujB,SAAS,CAACvjB,IAAD,CAAjD,IAA2D0jB,2BAA2B,CAAC1jB,IAAD,CAA7F;AACD,GARD;;AASA,MAAI2jB,cAAc,GAAG,UAAU3jB,IAAV,EAAgB;AACnC,WAAOqK,WAAW,CAACrK,IAAD,CAAX,IAAqBA,IAAI,CAACkL,YAAL,CAAkB,cAAlB,MAAsC,MAAlE;AACD,GAFD;;AAGA,MAAIwY,2BAA2B,GAAG,UAAU1jB,IAAV,EAAgB;AAChD,WAAO2jB,cAAc,CAAC3jB,IAAD,CAAd,KAAyB,KAAzB,IAAkCkjB,wBAAwB,CAACljB,IAAD,CAAjE;AACD,GAFD;;AAGA,MAAI4jB,YAAY,GAAG,UAAU5jB,IAAV,EAAgBzC,IAAhB,EAAsB;AACvC,SAAKyC,IAAI,GAAGA,IAAI,CAAC0D,UAAjB,EAA6B1D,IAAI,IAAIA,IAAI,KAAKzC,IAA9C,EAAoDyC,IAAI,GAAGA,IAAI,CAAC0D,UAAhE,EAA4E;AAC1E,UAAIggB,2BAA2B,CAAC1jB,IAAD,CAA/B,EAAuC;AACrC,eAAO,KAAP;AACD;;AACD,UAAIijB,uBAAuB,CAACjjB,IAAD,CAA3B,EAAmC;AACjC,eAAO,IAAP;AACD;AACF;;AACD,WAAO,IAAP;AACD,GAVD;;AAWA,MAAI6jB,4BAA4B,GAAG,UAAU7jB,IAAV,EAAgB;AACjD,QAAI,CAAC0jB,2BAA2B,CAAC1jB,IAAD,CAAhC,EAAwC;AACtC,aAAO,KAAP;AACD;;AACD,WAAO/P,KAAK,CAACiB,MAAM,CAAC8O,IAAI,CAAC2iB,oBAAL,CAA0B,GAA1B,CAAD,CAAP,EAAyC,UAAUlJ,MAAV,EAAkBtL,GAAlB,EAAuB;AAC1E,aAAOsL,MAAM,IAAIwJ,uBAAuB,CAAC9U,GAAD,CAAxC;AACD,KAFW,EAET,KAFS,CAAL,KAEO,IAFd;AAGD,GAPD;;AAQA,MAAI2V,QAAQ,GAAG,UAAU9jB,IAAV,EAAgB;AAC7B,WAAOsjB,cAAc,CAACtjB,IAAD,CAAd,IAAwB6jB,4BAA4B,CAAC7jB,IAAD,CAA3D;AACD,GAFD;;AAGA,MAAI+jB,wBAAwB,GAAG,UAAU/jB,IAAV,EAAgBzC,IAAhB,EAAsB;AACnD,WAAOkmB,gBAAgB,CAACzjB,IAAD,CAAhB,IAA0B4jB,YAAY,CAAC5jB,IAAD,EAAOzC,IAAP,CAA7C;AACD,GAFD;;AAIA,MAAIymB,kBAAkB,GAAG,cAAzB;;AACA,MAAIC,gBAAgB,GAAG,UAAU/jB,IAAV,EAAgB;AACrC,WAAO8jB,kBAAkB,CAAC/uB,IAAnB,CAAwBiL,IAAxB,CAAP;AACD,GAFD;;AAIA,MAAIgkB,2BAA2B,GAAG,UAAUlkB,IAAV,EAAgB4e,QAAhB,EAA0B;AAC1D,QAAIuF,WAAW,GAAG3jB,YAAY,CAACX,OAAb,CAAqB+e,QAArB,CAAlB;AACA,QAAID,SAAS,GAAGne,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAhB;AACA,WAAO0gB,UAAU,CAAC/B,SAAD,EAAY,UAAZ,EAAwB3zB,KAAK,CAACmX,IAAD,EAAOgiB,WAAP,CAA7B,CAAjB;AACD,GAJD;;AAKA,MAAIC,YAAY,GAAG,UAAUpkB,IAAV,EAAgB4e,QAAhB,EAA0B;AAC3C,WAAOnT,QAAQ,CAACzL,IAAD,CAAR,IAAkBikB,gBAAgB,CAACjkB,IAAI,CAAC4V,IAAN,CAAlC,IAAiDsO,2BAA2B,CAAClkB,IAAD,EAAO4e,QAAP,CAA3B,KAAgD,KAAxG;AACD,GAFD;;AAGA,MAAIyF,aAAa,GAAG,UAAUrkB,IAAV,EAAgB;AAClC,WAAOqK,WAAW,CAACrK,IAAD,CAAX,IAAqBA,IAAI,CAAC6C,QAAL,KAAkB,GAAvC,IAA8C,CAAC7C,IAAI,CAAC8K,YAAL,CAAkB,MAAlB,CAA/C,KAA6E9K,IAAI,CAAC8K,YAAL,CAAkB,MAAlB,KAA6B9K,IAAI,CAAC8K,YAAL,CAAkB,IAAlB,CAA1G,CAAP;AACD,GAFD;;AAGA,MAAIwZ,SAAS,GAAG,UAAUtkB,IAAV,EAAgB4e,QAAhB,EAA0B;AACxC,WAAO6E,gBAAgB,CAACzjB,IAAD,CAAhB,IAA0BokB,YAAY,CAACpkB,IAAD,EAAO4e,QAAP,CAAZ,KAAiC,KAA3D,IAAoEyF,aAAa,CAACrkB,IAAD,CAAjF,IAA2FukB,UAAU,CAACvkB,IAAD,CAA5G;AACD,GAFD;;AAGA,MAAIukB,UAAU,GAAGzZ,YAAY,CAAC,mBAAD,CAA7B;AACA,MAAI0Z,SAAS,GAAG1Z,YAAY,CAAC,gBAAD,CAA5B;AACA,MAAI2Z,YAAY,GAAGzZ,iBAAiB,CAAC,gBAAD,EAAmB,KAAnB,CAApC;;AACA,MAAI0Z,WAAW,GAAG,UAAUC,UAAV,EAAsBC,SAAtB,EAAiC;AACjD,QAAI5kB,IAAJ;AAAA,QAAU6kB,OAAO,GAAG,CAApB;;AACA,QAAIP,SAAS,CAACK,UAAD,EAAaA,UAAb,CAAb,EAAuC;AACrC,aAAO,KAAP;AACD,KAFD,MAEO;AACL3kB,MAAAA,IAAI,GAAG2kB,UAAU,CAAChgB,UAAlB;;AACA,UAAI,CAAC3E,IAAL,EAAW;AACT,eAAO,IAAP;AACD;;AACD,UAAI8kB,MAAM,GAAG,IAAIpG,aAAJ,CAAkB1e,IAAlB,EAAwB2kB,UAAxB,CAAb;;AACA,SAAG;AACD,YAAIC,SAAJ,EAAe;AACb,cAAIH,YAAY,CAACzkB,IAAD,CAAhB,EAAwB;AACtBA,YAAAA,IAAI,GAAG8kB,MAAM,CAACjG,IAAP,CAAY,IAAZ,CAAP;AACA;AACD;;AACD,cAAI2F,SAAS,CAACxkB,IAAD,CAAb,EAAqB;AACnBA,YAAAA,IAAI,GAAG8kB,MAAM,CAACjG,IAAP,EAAP;AACA;AACD;AACF;;AACD,YAAIhT,IAAI,CAAC7L,IAAD,CAAR,EAAgB;AACd6kB,UAAAA,OAAO;AACP7kB,UAAAA,IAAI,GAAG8kB,MAAM,CAACjG,IAAP,EAAP;AACA;AACD;;AACD,YAAIyF,SAAS,CAACtkB,IAAD,EAAO2kB,UAAP,CAAb,EAAiC;AAC/B,iBAAO,KAAP;AACD;;AACD3kB,QAAAA,IAAI,GAAG8kB,MAAM,CAACjG,IAAP,EAAP;AACD,OApBD,QAoBS7e,IApBT;;AAqBA,aAAO6kB,OAAO,IAAI,CAAlB;AACD;AACF,GAjCD;;AAkCA,MAAIE,OAAO,GAAG,UAAU5W,GAAV,EAAeyW,SAAf,EAA0B;AACtC,QAAIA,SAAS,KAAK,KAAK,CAAvB,EAA0B;AACxBA,MAAAA,SAAS,GAAG,IAAZ;AACD;;AACD,WAAOF,WAAW,CAACvW,GAAG,CAAC/N,GAAL,EAAUwkB,SAAV,CAAlB;AACD,GALD;;AAOA,MAAII,MAAM,GAAG,UAAUhlB,IAAV,EAAgB;AAC3B,WAAOA,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,OAAgC,MAAvC;AACD,GAFD;;AAGA,MAAIwuB,eAAe,GAAG,UAAUjlB,IAAV,EAAgBzC,IAAhB,EAAsB;AAC1C,WAAOzO,aAAa,CAACkR,IAAD,CAAb,KAAwBskB,SAAS,CAACtkB,IAAD,EAAOzC,IAAP,CAAT,IAAyB2iB,QAAQ,CAAC1f,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAD,CAAzD,CAAP;AACD,GAFD;;AAGA,MAAIklB,yBAAyB,GAAG,UAAUllB,IAAV,EAAgBzC,IAAhB,EAAsB;AACpD,QAAIuhB,IAAI,GAAG,IAAIJ,aAAJ,CAAkB1e,IAAlB,EAAwBzC,IAAxB,EAA8BuhB,IAA9B,CAAmC,KAAnC,CAAX;AACA,QAAID,IAAI,GAAG,IAAIH,aAAJ,CAAkB1e,IAAlB,EAAwBzC,IAAxB,EAA8BshB,IAA9B,CAAmC,KAAnC,CAAX;AACA,QAAIsG,YAAY,GAAGv2B,WAAW,CAACkwB,IAAD,CAAX,IAAqBmG,eAAe,CAACnG,IAAD,EAAOvhB,IAAP,CAAvD;AACA,QAAI6nB,YAAY,GAAGx2B,WAAW,CAACiwB,IAAD,CAAX,IAAqBoG,eAAe,CAACpG,IAAD,EAAOthB,IAAP,CAAvD;AACA,WAAO4nB,YAAY,IAAIC,YAAvB;AACD,GAND;;AAOA,MAAIC,cAAc,GAAG,UAAUrlB,IAAV,EAAgB;AACnC,WAAOglB,MAAM,CAAChlB,IAAD,CAAN,IAAgBA,IAAI,CAACkL,YAAL,CAAkB,eAAlB,MAAuC,UAA9D;AACD,GAFD;;AAGA,MAAIoa,cAAc,GAAG,UAAUtlB,IAAV,EAAgBzC,IAAhB,EAAsB;AACzC,WAAOkO,QAAQ,CAACzL,IAAD,CAAR,IAAkBA,IAAI,CAAC4V,IAAL,CAAUxsB,MAAV,GAAmB,CAArC,IAA0C87B,yBAAyB,CAACllB,IAAD,EAAOzC,IAAP,CAA1E;AACD,GAFD;;AAGA,MAAIgoB,aAAa,GAAG,UAAUvlB,IAAV,EAAgB;AAClC,WAAOqK,WAAW,CAACrK,IAAD,CAAX,GAAoBA,IAAI,CAACN,UAAL,CAAgBtW,MAAhB,GAAyB,CAA7C,GAAiD,KAAxD;AACD,GAFD;;AAGA,MAAIo8B,YAAY,GAAG,UAAUxlB,IAAV,EAAgB;AACjC,WAAO4L,oBAAoB,CAAC5L,IAAD,CAApB,IAA8B2L,YAAY,CAAC3L,IAAD,CAAjD;AACD,GAFD;;AAGA,MAAIylB,QAAQ,GAAG,UAAUrlB,GAAV,EAAeJ,IAAf,EAAqBzC,IAArB,EAA2B;AACxC,QAAIqhB,QAAQ,GAAGrhB,IAAI,IAAIyC,IAAvB;;AACA,QAAIqK,WAAW,CAACrK,IAAD,CAAX,IAAqBqlB,cAAc,CAACrlB,IAAD,CAAvC,EAA+C;AAC7C,aAAOA,IAAP;AACD;;AACD,QAAImE,QAAQ,GAAGnE,IAAI,CAACN,UAApB;;AACA,SAAK,IAAIpW,CAAC,GAAG6a,QAAQ,CAAC/a,MAAT,GAAkB,CAA/B,EAAkCE,CAAC,IAAI,CAAvC,EAA0CA,CAAC,EAA3C,EAA+C;AAC7Cm8B,MAAAA,QAAQ,CAACrlB,GAAD,EAAM+D,QAAQ,CAAC7a,CAAD,CAAd,EAAmBs1B,QAAnB,CAAR;AACD;;AACD,QAAIvU,WAAW,CAACrK,IAAD,CAAf,EAAuB;AACrB,UAAI0lB,eAAe,GAAG1lB,IAAI,CAACN,UAA3B;;AACA,UAAIgmB,eAAe,CAACt8B,MAAhB,KAA2B,CAA3B,IAAgCi8B,cAAc,CAACK,eAAe,CAAC,CAAD,CAAhB,CAAlD,EAAwE;AACtE1lB,QAAAA,IAAI,CAAC0D,UAAL,CAAgByC,YAAhB,CAA6Buf,eAAe,CAAC,CAAD,CAA5C,EAAiD1lB,IAAjD;AACD;AACF;;AACD,QAAI,CAACwlB,YAAY,CAACxlB,IAAD,CAAb,IAAuB,CAACskB,SAAS,CAACtkB,IAAD,EAAO4e,QAAP,CAAjC,IAAqD,CAAC2G,aAAa,CAACvlB,IAAD,CAAnE,IAA6E,CAACslB,cAAc,CAACtlB,IAAD,EAAO4e,QAAP,CAAhG,EAAkH;AAChHxe,MAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX;AACD;;AACD,WAAOA,IAAP;AACD,GAnBD;;AAqBA,MAAI2lB,SAAS,GAAG7mB,KAAK,CAAC9B,OAAtB;AACA,MAAI4oB,gBAAgB,GAAG,yEAAvB;AACA,MAAIC,eAAe,GAAG,iEAAtB;AACA,MAAIC,cAAc,GAAG,YAArB;AACA,MAAIC,YAAY,GAAG,iCAAnB;AACA,MAAIC,QAAQ,GAAG;AACb,SAAK,QADQ;AAEb,SAAK,QAFQ;AAGb,SAAK,QAHQ;AAIb,SAAK,QAJQ;AAKb,SAAK,QALQ;AAMb,SAAK,QANQ;AAOb,SAAK,QAPQ;AAQb,SAAK,QARQ;AASb,SAAK,QATQ;AAUb,SAAK,QAVQ;AAWb,SAAK,QAXQ;AAYb,SAAK,QAZQ;AAab,SAAK,QAbQ;AAcb,SAAK,QAdQ;AAeb,SAAK,QAfQ;AAgBb,SAAK,QAhBQ;AAiBb,SAAK,QAjBQ;AAkBb,SAAK,QAlBQ;AAmBb,SAAK,QAnBQ;AAoBb,SAAK,QApBQ;AAqBb,SAAK,QArBQ;AAsBb,SAAK,QAtBQ;AAuBb,SAAK,QAvBQ;AAwBb,SAAK,QAxBQ;AAyBb,SAAK,QAzBQ;AA0Bb,SAAK,QA1BQ;AA2Bb,SAAK;AA3BQ,GAAf;AA6BA,MAAIC,YAAY,GAAG;AACjB,SAAK,QADY;AAEjB,UAAM,OAFW;AAGjB,SAAK,MAHY;AAIjB,SAAK,MAJY;AAKjB,SAAK,OALY;AAMjB,SAAK;AANY,GAAnB;AAQA,MAAIC,eAAe,GAAG;AACpB,YAAQ,GADY;AAEpB,YAAQ,GAFY;AAGpB,aAAS,GAHW;AAIpB,cAAU,GAJU;AAKpB,cAAU;AALU,GAAtB;;AAOA,MAAIC,YAAY,GAAG,UAAUjmB,IAAV,EAAgB;AACjC,QAAIiO,GAAG,GAAG3N,YAAY,CAACV,OAAb,CAAqB,KAArB,EAA4BM,GAAtC;AACA+N,IAAAA,GAAG,CAAC3O,SAAJ,GAAgBU,IAAhB;AACA,WAAOiO,GAAG,CAACpH,WAAJ,IAAmBoH,GAAG,CAACiY,SAAvB,IAAoClmB,IAA3C;AACD,GAJD;;AAKA,MAAImmB,mBAAmB,GAAG,UAAUppB,KAAV,EAAiBqpB,KAAjB,EAAwB;AAChD,QAAIh9B,CAAJ,EAAOi9B,GAAP,EAAYC,MAAZ;AACA,QAAI1G,MAAM,GAAG,EAAb;;AACA,QAAI7iB,KAAJ,EAAW;AACTA,MAAAA,KAAK,GAAGA,KAAK,CAACE,KAAN,CAAY,GAAZ,CAAR;AACAmpB,MAAAA,KAAK,GAAGA,KAAK,IAAI,EAAjB;;AACA,WAAKh9B,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG2T,KAAK,CAAC7T,MAAtB,EAA8BE,CAAC,IAAI,CAAnC,EAAsC;AACpCi9B,QAAAA,GAAG,GAAGp+B,MAAM,CAACs+B,YAAP,CAAoBC,QAAQ,CAACzpB,KAAK,CAAC3T,CAAD,CAAN,EAAWg9B,KAAX,CAA5B,CAAN;;AACA,YAAI,CAACL,YAAY,CAACM,GAAD,CAAjB,EAAwB;AACtBC,UAAAA,MAAM,GAAG,MAAMvpB,KAAK,CAAC3T,CAAC,GAAG,CAAL,CAAX,GAAqB,GAA9B;AACAw2B,UAAAA,MAAM,CAACyG,GAAD,CAAN,GAAcC,MAAd;AACA1G,UAAAA,MAAM,CAAC0G,MAAD,CAAN,GAAiBD,GAAjB;AACD;AACF;;AACD,aAAOzG,MAAP;AACD;AACF,GAhBD;;AAiBA,MAAI6G,aAAa,GAAGN,mBAAmB,CAAC,yFAAyF,0FAAzF,GAAsL,6FAAtL,GAAsR,uFAAtR,GAAgX,6FAAhX,GAAgd,wFAAhd,GAA2iB,8FAA3iB,GAA4oB,gGAA5oB,GAA+uB,8FAA/uB,GAAg1B,2FAAh1B,GAA86B,wFAA96B,GAAygC,sFAAzgC,GAAkmC,yFAAlmC,GAA8rC,yFAA9rC,GAA0xC,2FAA1xC,GAAw3C,8FAAx3C,GAAy9C,6FAAz9C,GAAyjD,gGAAzjD,GAA4pD,mGAA5pD,GAAkwD,mGAAlwD,GAAw2D,mGAAx2D,GAA88D,kGAA98D,GAAmjE,kGAAnjE,GAAwpE,qGAAxpE,GAAgwE,sDAAjwE,EAAyzE,EAAzzE,CAAvC;;AACA,MAAIO,SAAS,GAAG,UAAU1mB,IAAV,EAAgB8M,IAAhB,EAAsB;AACpC,WAAO9M,IAAI,CAAC9J,OAAL,CAAa4W,IAAI,GAAG4Y,gBAAH,GAAsBC,eAAvC,EAAwD,UAAUU,GAAV,EAAe;AAC5E,aAAON,YAAY,CAACM,GAAD,CAAZ,IAAqBA,GAA5B;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAIM,YAAY,GAAG,UAAU3mB,IAAV,EAAgB;AACjC,WAAO,CAAC,KAAKA,IAAN,EAAY9J,OAAZ,CAAoB0vB,cAApB,EAAoC,UAAUS,GAAV,EAAe;AACxD,aAAON,YAAY,CAACM,GAAD,CAAZ,IAAqBA,GAA5B;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAIO,aAAa,GAAG,UAAU5mB,IAAV,EAAgB8M,IAAhB,EAAsB;AACxC,WAAO9M,IAAI,CAAC9J,OAAL,CAAa4W,IAAI,GAAG4Y,gBAAH,GAAsBC,eAAvC,EAAwD,UAAUU,GAAV,EAAe;AAC5E,UAAIA,GAAG,CAACn9B,MAAJ,GAAa,CAAjB,EAAoB;AAClB,eAAO,QAAQ,CAACm9B,GAAG,CAACQ,UAAJ,CAAe,CAAf,IAAoB,KAArB,IAA8B,IAA9B,IAAsCR,GAAG,CAACQ,UAAJ,CAAe,CAAf,IAAoB,KAA1D,IAAmE,KAA3E,IAAoF,GAA3F;AACD;;AACD,aAAOd,YAAY,CAACM,GAAD,CAAZ,IAAqB,OAAOA,GAAG,CAACQ,UAAJ,CAAe,CAAf,CAAP,GAA2B,GAAvD;AACD,KALM,CAAP;AAMD,GAPD;;AAQA,MAAIC,WAAW,GAAG,UAAU9mB,IAAV,EAAgB8M,IAAhB,EAAsBia,QAAtB,EAAgC;AAChDA,IAAAA,QAAQ,GAAGA,QAAQ,IAAIN,aAAvB;AACA,WAAOzmB,IAAI,CAAC9J,OAAL,CAAa4W,IAAI,GAAG4Y,gBAAH,GAAsBC,eAAvC,EAAwD,UAAUU,GAAV,EAAe;AAC5E,aAAON,YAAY,CAACM,GAAD,CAAZ,IAAqBU,QAAQ,CAACV,GAAD,CAA7B,IAAsCA,GAA7C;AACD,KAFM,CAAP;AAGD,GALD;;AAMA,MAAIW,aAAa,GAAG,UAAUh/B,IAAV,EAAgB++B,QAAhB,EAA0B;AAC5C,QAAIE,WAAW,GAAGd,mBAAmB,CAACY,QAAD,CAAnB,IAAiCN,aAAnD;;AACA,QAAIS,qBAAqB,GAAG,UAAUlnB,IAAV,EAAgB8M,IAAhB,EAAsB;AAChD,aAAO9M,IAAI,CAAC9J,OAAL,CAAa4W,IAAI,GAAG4Y,gBAAH,GAAsBC,eAAvC,EAAwD,UAAUU,GAAV,EAAe;AAC5E,YAAIN,YAAY,CAACM,GAAD,CAAZ,KAAsB3+B,SAA1B,EAAqC;AACnC,iBAAOq+B,YAAY,CAACM,GAAD,CAAnB;AACD;;AACD,YAAIY,WAAW,CAACZ,GAAD,CAAX,KAAqB3+B,SAAzB,EAAoC;AAClC,iBAAOu/B,WAAW,CAACZ,GAAD,CAAlB;AACD;;AACD,YAAIA,GAAG,CAACn9B,MAAJ,GAAa,CAAjB,EAAoB;AAClB,iBAAO,QAAQ,CAACm9B,GAAG,CAACQ,UAAJ,CAAe,CAAf,IAAoB,KAArB,IAA8B,IAA9B,IAAsCR,GAAG,CAACQ,UAAJ,CAAe,CAAf,IAAoB,KAA1D,IAAmE,KAA3E,IAAoF,GAA3F;AACD;;AACD,eAAO,OAAOR,GAAG,CAACQ,UAAJ,CAAe,CAAf,CAAP,GAA2B,GAAlC;AACD,OAXM,CAAP;AAYD,KAbD;;AAcA,QAAIM,iBAAiB,GAAG,UAAUnnB,IAAV,EAAgB8M,IAAhB,EAAsB;AAC5C,aAAOga,WAAW,CAAC9mB,IAAD,EAAO8M,IAAP,EAAama,WAAb,CAAlB;AACD,KAFD;;AAGA,QAAIG,OAAO,GAAG3B,SAAS,CAACz9B,IAAI,CAACkO,OAAL,CAAa,KAAb,EAAoB,GAApB,CAAD,CAAvB;;AACA,QAAIkxB,OAAO,CAACC,KAAR,IAAiBD,OAAO,CAACE,OAA7B,EAAsC;AACpC,aAAOJ,qBAAP;AACD;;AACD,QAAIE,OAAO,CAACC,KAAZ,EAAmB;AACjB,UAAIN,QAAJ,EAAc;AACZ,eAAOI,iBAAP;AACD;;AACD,aAAOL,WAAP;AACD;;AACD,QAAIM,OAAO,CAACE,OAAZ,EAAqB;AACnB,aAAOV,aAAP;AACD;;AACD,WAAOF,SAAP;AACD,GAjCD;;AAkCA,MAAIa,MAAM,GAAG,UAAUvnB,IAAV,EAAgB;AAC3B,WAAOA,IAAI,CAAC9J,OAAL,CAAa2vB,YAAb,EAA2B,UAAU36B,GAAV,EAAeo8B,OAAf,EAAwB;AACxD,UAAIA,OAAJ,EAAa;AACX,YAAIA,OAAO,CAACzF,MAAR,CAAe,CAAf,EAAkBtrB,WAAlB,OAAoC,GAAxC,EAA6C;AAC3C+wB,UAAAA,OAAO,GAAGd,QAAQ,CAACc,OAAO,CAAC5vB,MAAR,CAAe,CAAf,CAAD,EAAoB,EAApB,CAAlB;AACD,SAFD,MAEO;AACL4vB,UAAAA,OAAO,GAAGd,QAAQ,CAACc,OAAD,EAAU,EAAV,CAAlB;AACD;;AACD,YAAIA,OAAO,GAAG,KAAd,EAAqB;AACnBA,UAAAA,OAAO,IAAI,KAAX;AACA,iBAAOr/B,MAAM,CAACs+B,YAAP,CAAoB,SAASe,OAAO,IAAI,EAApB,CAApB,EAA6C,SAASA,OAAO,GAAG,IAAnB,CAA7C,CAAP;AACD;;AACD,eAAOxB,QAAQ,CAACwB,OAAD,CAAR,IAAqBr/B,MAAM,CAACs+B,YAAP,CAAoBe,OAApB,CAA5B;AACD;;AACD,aAAOtB,eAAe,CAAC96B,GAAD,CAAf,IAAwBu7B,aAAa,CAACv7B,GAAD,CAArC,IAA8C+6B,YAAY,CAAC/6B,GAAD,CAAjE;AACD,KAdM,CAAP;AAeD,GAhBD;;AAiBA,MAAIs8B,QAAQ,GAAG;AACbd,IAAAA,SAAS,EAAEA,SADE;AAEbC,IAAAA,YAAY,EAAEA,YAFD;AAGbC,IAAAA,aAAa,EAAEA,aAHF;AAIbE,IAAAA,WAAW,EAAEA,WAJA;AAKbE,IAAAA,aAAa,EAAEA,aALF;AAMbO,IAAAA,MAAM,EAAEA;AANK,GAAf;AASA,MAAIE,QAAQ,GAAG,EAAf;AAAA,MAAmBC,QAAQ,GAAG,EAA9B;AACA,MAAIC,SAAS,GAAG/oB,KAAK,CAAC9B,OAAtB;AAAA,MAA+B8qB,MAAM,GAAGhpB,KAAK,CAAC9R,IAA9C;AAAA,MAAoD+6B,QAAQ,GAAGjpB,KAAK,CAACZ,MAArE;AAAA,MAA6E8pB,SAAS,GAAGlpB,KAAK,CAACJ,OAA/F;AAAA,MAAwGM,OAAO,GAAGF,KAAK,CAACE,OAAxH;;AACA,MAAI7B,KAAK,GAAG,UAAUF,KAAV,EAAiBC,KAAjB,EAAwB;AAClCD,IAAAA,KAAK,GAAG6B,KAAK,CAAC3G,IAAN,CAAW8E,KAAX,CAAR;AACA,WAAOA,KAAK,GAAGA,KAAK,CAACE,KAAN,CAAYD,KAAK,IAAI,GAArB,CAAH,GAA+B,EAA3C;AACD,GAHD;;AAIA,MAAI+qB,aAAa,GAAG,UAAU75B,IAAV,EAAgB;AAClC,QAAI85B,MAAM,GAAG,EAAb;AACA,QAAIC,gBAAJ,EAAsBC,YAAtB;AACA,QAAIC,eAAJ,EAAqBC,WAArB,EAAkCC,iBAAlC,EAAqDC,oBAArD;;AACA,QAAIC,GAAG,GAAG,UAAUvgC,IAAV,EAAgB6kB,UAAhB,EAA4B5I,QAA5B,EAAsC;AAC9C,UAAIukB,EAAJ,EAAQC,eAAR,EAAyBrnB,OAAzB;;AACA,UAAIsnB,UAAU,GAAG,UAAUl2B,KAAV,EAAiBpB,GAAjB,EAAsB;AACrC,YAAIvE,GAAG,GAAG,EAAV;AACA,YAAIzD,CAAJ,EAAOqJ,CAAP;;AACA,aAAKrJ,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAGD,KAAK,CAACtJ,MAAtB,EAA8BE,CAAC,GAAGqJ,CAAlC,EAAqCrJ,CAAC,EAAtC,EAA0C;AACxCyD,UAAAA,GAAG,CAAC2F,KAAK,CAACpJ,CAAD,CAAN,CAAH,GAAgBgI,GAAG,IAAI,EAAvB;AACD;;AACD,eAAOvE,GAAP;AACD,OAPD;;AAQAoX,MAAAA,QAAQ,GAAGA,QAAQ,IAAI,EAAvB;AACA4I,MAAAA,UAAU,GAAGA,UAAU,IAAI,EAA3B;;AACA,UAAI,OAAO5I,QAAP,KAAoB,QAAxB,EAAkC;AAChCA,QAAAA,QAAQ,GAAGhH,KAAK,CAACgH,QAAD,CAAhB;AACD;;AACD,UAAIoG,KAAK,GAAGpN,KAAK,CAACjV,IAAD,CAAjB;AACAwgC,MAAAA,EAAE,GAAGne,KAAK,CAACnhB,MAAX;;AACA,aAAOs/B,EAAE,EAAT,EAAa;AACXC,QAAAA,eAAe,GAAGxrB,KAAK,CAAC,CACtBgrB,gBADsB,EAEtBpb,UAFsB,EAGtB4L,IAHsB,CAGjB,GAHiB,CAAD,CAAvB;AAIArX,QAAAA,OAAO,GAAG;AACRyL,UAAAA,UAAU,EAAE6b,UAAU,CAACD,eAAD,CADd;AAERA,UAAAA,eAAe,EAAEA,eAFT;AAGRxkB,UAAAA,QAAQ,EAAEykB,UAAU,CAACzkB,QAAD,EAAWyjB,QAAX;AAHZ,SAAV;AAKAM,QAAAA,MAAM,CAAC3d,KAAK,CAACme,EAAD,CAAN,CAAN,GAAoBpnB,OAApB;AACD;AACF,KA7BD;;AA8BA,QAAIunB,QAAQ,GAAG,UAAU3gC,IAAV,EAAgB6kB,UAAhB,EAA4B;AACzC,UAAI2b,EAAJ,EAAQI,UAAR,EAAoBx/B,CAApB,EAAuBqJ,CAAvB;AACA,UAAI4X,KAAK,GAAGpN,KAAK,CAACjV,IAAD,CAAjB;AACAwgC,MAAAA,EAAE,GAAGne,KAAK,CAACnhB,MAAX;AACA,UAAIqjB,KAAK,GAAGtP,KAAK,CAAC4P,UAAD,CAAjB;;AACA,aAAO2b,EAAE,EAAT,EAAa;AACXI,QAAAA,UAAU,GAAGZ,MAAM,CAAC3d,KAAK,CAACme,EAAD,CAAN,CAAnB;;AACA,aAAKp/B,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAG8Z,KAAK,CAACrjB,MAAtB,EAA8BE,CAAC,GAAGqJ,CAAlC,EAAqCrJ,CAAC,EAAtC,EAA0C;AACxCw/B,UAAAA,UAAU,CAAC/b,UAAX,CAAsBN,KAAK,CAACnjB,CAAD,CAA3B,IAAkC,EAAlC;AACAw/B,UAAAA,UAAU,CAACH,eAAX,CAA2Bv5B,IAA3B,CAAgCqd,KAAK,CAACnjB,CAAD,CAArC;AACD;AACF;AACF,KAZD;;AAaA,QAAIq+B,QAAQ,CAACv5B,IAAD,CAAZ,EAAoB;AAClB,aAAOu5B,QAAQ,CAACv5B,IAAD,CAAf;AACD;;AACD+5B,IAAAA,gBAAgB,GAAG,uDAAnB;AACAC,IAAAA,YAAY,GAAG,qFAAf;AACAC,IAAAA,eAAe,GAAG,kFAAkF,6EAAlF,GAAkK,+BAApL;;AACA,QAAIj6B,IAAI,KAAK,OAAb,EAAsB;AACpB+5B,MAAAA,gBAAgB,IAAI,qDAAqD,6BAAzE;AACAC,MAAAA,YAAY,IAAI,4EAAhB;AACAC,MAAAA,eAAe,IAAI,8DAA8D,yCAAjF;AACD;;AACD,QAAIj6B,IAAI,KAAK,cAAb,EAA6B;AAC3B+5B,MAAAA,gBAAgB,IAAI,WAApB;AACAK,MAAAA,oBAAoB,GAAG,4CAAvB;AACAH,MAAAA,eAAe,GAAG,CAChBA,eADgB,EAEhBG,oBAFgB,EAGhB7P,IAHgB,CAGX,GAHW,CAAlB;AAIAmP,MAAAA,MAAM,CAAC3qB,KAAK,CAACqrB,oBAAD,CAAN,EAA8B,UAAUtgC,IAAV,EAAgB;AAClDugC,QAAAA,GAAG,CAACvgC,IAAD,EAAO,EAAP,EAAWmgC,eAAX,CAAH;AACD,OAFK,CAAN;AAGAE,MAAAA,iBAAiB,GAAG,6BAApB;AACAH,MAAAA,YAAY,GAAG,CACbA,YADa,EAEbG,iBAFa,EAGb5P,IAHa,CAGR,GAHQ,CAAf;AAIA2P,MAAAA,WAAW,GAAG,CACZF,YADY,EAEZC,eAFY,EAGZ1P,IAHY,CAGP,GAHO,CAAd;AAIAmP,MAAAA,MAAM,CAAC3qB,KAAK,CAACorB,iBAAD,CAAN,EAA2B,UAAUrgC,IAAV,EAAgB;AAC/CugC,QAAAA,GAAG,CAACvgC,IAAD,EAAO,EAAP,EAAWogC,WAAX,CAAH;AACD,OAFK,CAAN;AAGD;;AACDA,IAAAA,WAAW,GAAGA,WAAW,IAAI,CAC3BF,YAD2B,EAE3BC,eAF2B,EAG3B1P,IAH2B,CAGtB,GAHsB,CAA7B;AAIA8P,IAAAA,GAAG,CAAC,MAAD,EAAS,UAAT,EAAqB,WAArB,CAAH;AACAA,IAAAA,GAAG,CAAC,MAAD,EAAS,EAAT,EAAa,oDAAb,CAAH;AACAA,IAAAA,GAAG,CAAC,sBAAD,CAAH;AACAA,IAAAA,GAAG,CAAC,MAAD,EAAS,aAAT,CAAH;AACAA,IAAAA,GAAG,CAAC,MAAD,EAAS,6CAAT,CAAH;AACAA,IAAAA,GAAG,CAAC,MAAD,EAAS,iCAAT,CAAH;AACAA,IAAAA,GAAG,CAAC,OAAD,EAAU,mBAAV,CAAH;AACAA,IAAAA,GAAG,CAAC,QAAD,EAAW,8BAAX,CAAH;AACAA,IAAAA,GAAG,CAAC,MAAD,EAAS,sEAAsE,yEAAtE,GAAkJ,iDAA3J,EAA8MH,WAA9M,CAAH;AACAG,IAAAA,GAAG,CAAC,2BAAD,EAA8B,EAA9B,EAAkCH,WAAlC,CAAH;AACAG,IAAAA,GAAG,CAAC,yGAAD,EAA4G,EAA5G,EAAgHJ,eAAhH,CAAH;AACAI,IAAAA,GAAG,CAAC,YAAD,EAAe,MAAf,EAAuBH,WAAvB,CAAH;AACAG,IAAAA,GAAG,CAAC,IAAD,EAAO,qBAAP,EAA8B,IAA9B,CAAH;AACAA,IAAAA,GAAG,CAAC,IAAD,EAAO,EAAP,EAAW,IAAX,CAAH;AACAA,IAAAA,GAAG,CAAC,IAAD,EAAO,OAAP,EAAgBH,WAAhB,CAAH;AACAG,IAAAA,GAAG,CAAC,IAAD,EAAO,EAAP,EAAW,OAAX,CAAH;AACAA,IAAAA,GAAG,CAAC,GAAD,EAAM,qCAAN,EAA6CJ,eAA7C,CAAH;AACAI,IAAAA,GAAG,CAAC,GAAD,EAAM,MAAN,EAAcJ,eAAd,CAAH;AACAI,IAAAA,GAAG,CAAC,SAAD,EAAY,eAAZ,EAA6BH,WAA7B,CAAH;AACAG,IAAAA,GAAG,CAAC,KAAD,EAAQ,gDAAR,CAAH;AACAA,IAAAA,GAAG,CAAC,QAAD,EAAW,uBAAX,EAAoCH,WAApC,CAAH;AACAG,IAAAA,GAAG,CAAC,OAAD,EAAU,uBAAV,CAAH;AACAA,IAAAA,GAAG,CAAC,QAAD,EAAW,uDAAX,EAAoE,CACrEH,WADqE,EAErE,OAFqE,EAGrE3P,IAHqE,CAGhE,GAHgE,CAApE,CAAH;AAIA8P,IAAAA,GAAG,CAAC,OAAD,EAAU,YAAV,CAAH;AACAA,IAAAA,GAAG,CAAC,KAAD,EAAQ,MAAR,EAAgB,CACjBH,WADiB,EAEjB,MAFiB,EAGjB3P,IAHiB,CAGZ,GAHY,CAAhB,CAAH;AAIA8P,IAAAA,GAAG,CAAC,MAAD,EAAS,sDAAT,CAAH;AACAA,IAAAA,GAAG,CAAC,OAAD,EAAU,QAAV,EAAoB,2CAA2Cr6B,IAAI,KAAK,OAAT,GAAmB,MAAnB,GAA4B,EAAvE,CAApB,CAAH;AACAq6B,IAAAA,GAAG,CAAC,UAAD,EAAa,MAAb,EAAqB,KAArB,CAAH;AACAA,IAAAA,GAAG,CAAC,KAAD,EAAQ,MAAR,CAAH;AACAA,IAAAA,GAAG,CAAC,mBAAD,EAAsB,EAAtB,EAA0B,IAA1B,CAAH;AACAA,IAAAA,GAAG,CAAC,IAAD,EAAO,EAAP,EAAW,OAAX,CAAH;AACAA,IAAAA,GAAG,CAAC,IAAD,EAAO,yBAAP,EAAkCH,WAAlC,CAAH;AACAG,IAAAA,GAAG,CAAC,IAAD,EAAO,oCAAP,EAA6CH,WAA7C,CAAH;AACAG,IAAAA,GAAG,CAAC,MAAD,EAAS,0EAAT,EAAqFH,WAArF,CAAH;AACAG,IAAAA,GAAG,CAAC,UAAD,EAAa,oBAAb,EAAmC,CACpCH,WADoC,EAEpC,QAFoC,EAGpC3P,IAHoC,CAG/B,GAH+B,CAAnC,CAAH;AAIA8P,IAAAA,GAAG,CAAC,OAAD,EAAU,UAAV,EAAsBJ,eAAtB,CAAH;AACAI,IAAAA,GAAG,CAAC,OAAD,EAAU,4GAA4G,iHAAtH,CAAH;AACAA,IAAAA,GAAG,CAAC,QAAD,EAAW,2FAAX,EAAwGr6B,IAAI,KAAK,OAAT,GAAmBk6B,WAAnB,GAAiCD,eAAzI,CAAH;AACAI,IAAAA,GAAG,CAAC,QAAD,EAAW,2CAAX,EAAwD,iBAAxD,CAAH;AACAA,IAAAA,GAAG,CAAC,UAAD,EAAa,gBAAb,EAA+B,QAA/B,CAAH;AACAA,IAAAA,GAAG,CAAC,QAAD,EAAW,+BAAX,CAAH;AACAA,IAAAA,GAAG,CAAC,UAAD,EAAa,uEAAb,CAAH;AACAA,IAAAA,GAAG,CAAC,MAAD,EAAS,YAAT,EAAuB,CACxBH,WADwB,EAExB,IAFwB,EAGxB3P,IAHwB,CAGnB,GAHmB,CAAvB,CAAH;AAIA8P,IAAAA,GAAG,CAAC,UAAD,EAAa,EAAb,EAAiBH,WAAjB,CAAH;;AACA,QAAIl6B,IAAI,KAAK,OAAb,EAAsB;AACpBq6B,MAAAA,GAAG,CAAC,KAAD,CAAH;AACAA,MAAAA,GAAG,CAAC,MAAD,EAAS,EAAT,EAAa,CACdJ,eADc,EAEd,OAFc,EAGd1P,IAHc,CAGT,GAHS,CAAb,CAAH;AAIA8P,MAAAA,GAAG,CAAC,YAAD,EAAe,EAAf,EAAmBH,WAAnB,CAAH;AACAG,MAAAA,GAAG,CAAC,wBAAD,EAA2B,EAA3B,EAA+BJ,eAA/B,CAAH;AACAI,MAAAA,GAAG,CAAC,QAAD,EAAW,cAAX,EAA2BH,WAA3B,CAAH;AACAG,MAAAA,GAAG,CAAC,OAAD,EAAU,6DAA6D,sCAAvE,EAA+G,CAChHH,WADgH,EAEhH,cAFgH,EAGhH3P,IAHgH,CAG3G,GAH2G,CAA/G,CAAH;AAIA8P,MAAAA,GAAG,CAAC,OAAD,EAAU,qEAAqE,iBAA/E,EAAkG,CACnGH,WADmG,EAEnG,cAFmG,EAGnG3P,IAHmG,CAG9F,GAH8F,CAAlG,CAAH;AAIA8P,MAAAA,GAAG,CAAC,SAAD,EAAY,EAAZ,EAAgB,YAAhB,CAAH;AACAA,MAAAA,GAAG,CAAC,QAAD,EAAW,6BAAX,CAAH;AACAA,MAAAA,GAAG,CAAC,OAAD,EAAU,gCAAV,CAAH;AACAA,MAAAA,GAAG,CAAC,UAAD,EAAa,EAAb,EAAiB,CAClBJ,eADkB,EAElB,QAFkB,EAGlB1P,IAHkB,CAGb,GAHa,CAAjB,CAAH;AAIA8P,MAAAA,GAAG,CAAC,8CAAD,EAAiD,EAAjD,EAAqDH,WAArD,CAAH;AACAG,MAAAA,GAAG,CAAC,QAAD,EAAW,EAAX,EAAe,mBAAf,CAAH;AACAA,MAAAA,GAAG,CAAC,QAAD,EAAW,EAAX,EAAe,CAChBH,WADgB,EAEhB,YAFgB,EAGhB3P,IAHgB,CAGX,GAHW,CAAf,CAAH;AAIA8P,MAAAA,GAAG,CAAC,MAAD,EAAS,UAAT,EAAqBJ,eAArB,CAAH;AACAI,MAAAA,GAAG,CAAC,QAAD,EAAW,MAAX,EAAmBH,WAAnB,CAAH;AACAG,MAAAA,GAAG,CAAC,SAAD,EAAY,qDAAZ,CAAH;AACAA,MAAAA,GAAG,CAAC,QAAD,EAAW,eAAX,EAA4BJ,eAA5B,CAAH;AACAI,MAAAA,GAAG,CAAC,UAAD,EAAa,WAAb,EAA0BJ,eAA1B,CAAH;AACAI,MAAAA,GAAG,CAAC,OAAD,EAAU,gCAAV,EAA4CJ,eAA5C,CAAH;AACAI,MAAAA,GAAG,CAAC,SAAD,EAAY,MAAZ,EAAoB,CACrBH,WADqB,EAErB,SAFqB,EAGrB3P,IAHqB,CAGhB,GAHgB,CAApB,CAAH;AAIA8P,MAAAA,GAAG,CAAC,QAAD,EAAW,gDAAX,CAAH;AACD;;AACD,QAAIr6B,IAAI,KAAK,cAAb,EAA6B;AAC3By6B,MAAAA,QAAQ,CAAC,QAAD,EAAW,oBAAX,CAAR;AACAA,MAAAA,QAAQ,CAAC,OAAD,EAAU,WAAV,CAAR;AACAA,MAAAA,QAAQ,CAAC,QAAD,EAAW,mFAAX,CAAR;AACAA,MAAAA,QAAQ,CAAC,OAAD,EAAU,0BAAV,CAAR;AACAA,MAAAA,QAAQ,CAAC,OAAD,EAAU,gBAAV,CAAR;AACAA,MAAAA,QAAQ,CAAC,GAAD,EAAM,+BAAN,CAAR;AACAA,MAAAA,QAAQ,CAAC,IAAD,EAAO,OAAP,CAAR;AACAA,MAAAA,QAAQ,CAAC,QAAD,EAAW,wEAAX,CAAR;AACAA,MAAAA,QAAQ,CAAC,KAAD,EAAQ,0CAAR,CAAR;AACAA,MAAAA,QAAQ,CAAC,QAAD,EAAW,+DAAX,CAAR;AACAA,MAAAA,QAAQ,CAAC,eAAD,EAAkB,iBAAlB,CAAR;AACAA,MAAAA,QAAQ,CAAC,OAAD,EAAU,cAAV,CAAR;AACAA,MAAAA,QAAQ,CAAC,QAAD,CAAR;AACAA,MAAAA,QAAQ,CAAC,UAAD,CAAR;AACAA,MAAAA,QAAQ,CAAC,wCAAD,EAA2C,OAA3C,CAAR;AACAA,MAAAA,QAAQ,CAAC,IAAD,EAAO,cAAP,CAAR;AACAA,MAAAA,QAAQ,CAAC,IAAD,EAAO,MAAP,CAAR;AACAA,MAAAA,QAAQ,CAAC,gBAAD,EAAmB,SAAnB,CAAR;AACAA,MAAAA,QAAQ,CAAC,KAAD,EAAQ,iBAAR,CAAR;AACAA,MAAAA,QAAQ,CAAC,IAAD,EAAO,0BAAP,CAAR;AACAA,MAAAA,QAAQ,CAAC,SAAD,EAAY,QAAZ,CAAR;AACAA,MAAAA,QAAQ,CAAC,OAAD,EAAU,iEAAV,CAAR;AACAA,MAAAA,QAAQ,CAAC,KAAD,EAAQ,iCAAR,CAAR;AACAA,MAAAA,QAAQ,CAAC,UAAD,EAAa,iCAAb,CAAR;AACAA,MAAAA,QAAQ,CAAC,OAAD,EAAU,2BAAV,CAAR;AACAA,MAAAA,QAAQ,CAAC,IAAD,EAAO,mCAAP,CAAR;AACAA,MAAAA,QAAQ,CAAC,IAAD,EAAO,4DAAP,CAAR;AACAA,MAAAA,QAAQ,CAAC,MAAD,EAAS,QAAT,CAAR;AACAA,MAAAA,QAAQ,CAAC,IAAD,EAAO,uEAAP,CAAR;AACAA,MAAAA,QAAQ,CAAC,OAAD,EAAU,2BAAV,CAAR;AACAA,MAAAA,QAAQ,CAAC,OAAD,EAAU,2BAAV,CAAR;AACAA,MAAAA,QAAQ,CAAC,MAAD,EAAS,QAAT,CAAR;AACAA,MAAAA,QAAQ,CAAC,MAAD,EAAS,0CAAT,CAAR;AACD;;AACD,QAAIz6B,IAAI,KAAK,OAAb,EAAsB;AACpBy6B,MAAAA,QAAQ,CAAC,8BAAD,EAAiC,WAAjC,CAAR;AACAA,MAAAA,QAAQ,CAAC,gBAAD,EAAmB,aAAnB,CAAR;AACAA,MAAAA,QAAQ,CAAC,GAAD,EAAM,UAAN,CAAR;AACAA,MAAAA,QAAQ,CAAC,iBAAD,EAAoB,aAApB,CAAR;AACAA,MAAAA,QAAQ,CAAC,KAAD,EAAQ,SAAR,CAAR;AACAA,MAAAA,QAAQ,CAAC,QAAD,EAAW,0CAAX,CAAR;AACD;;AACDf,IAAAA,MAAM,CAAC3qB,KAAK,CAAC,2BAAD,CAAN,EAAqC,UAAUjV,IAAV,EAAgB;AACzD,UAAIggC,MAAM,CAAChgC,IAAD,CAAV,EAAkB;AAChB,eAAOggC,MAAM,CAAChgC,IAAD,CAAN,CAAaic,QAAb,CAAsBjc,IAAtB,CAAP;AACD;AACF,KAJK,CAAN;AAKA,WAAOggC,MAAM,CAAC9Z,OAAP,CAAejK,QAAf,CAAwB4kB,KAA/B;AACA,WAAOb,MAAM,CAACc,MAAd;AACArB,IAAAA,QAAQ,CAACv5B,IAAD,CAAR,GAAiB85B,MAAjB;AACA,WAAOA,MAAP;AACD,GA3OD;;AA4OA,MAAIe,iBAAiB,GAAG,UAAUn+B,KAAV,EAAiBo+B,IAAjB,EAAuB;AAC7C,QAAI3b,MAAJ;;AACA,QAAIziB,KAAJ,EAAW;AACTyiB,MAAAA,MAAM,GAAG,EAAT;;AACA,UAAI,OAAOziB,KAAP,KAAiB,QAArB,EAA+B;AAC7BA,QAAAA,KAAK,GAAG;AAAE,eAAKA;AAAP,SAAR;AACD;;AACDg9B,MAAAA,MAAM,CAACh9B,KAAD,EAAQ,UAAUA,KAAV,EAAiBuH,GAAjB,EAAsB;AAClCkb,QAAAA,MAAM,CAAClb,GAAD,CAAN,GAAckb,MAAM,CAAClb,GAAG,CAAC82B,WAAJ,EAAD,CAAN,GAA4BD,IAAI,KAAK,KAAT,GAAiBrB,SAAS,CAAC/8B,KAAD,EAAQ,MAAR,CAA1B,GAA4Ck9B,SAAS,CAACl9B,KAAD,EAAQ,MAAR,CAA/F;AACD,OAFK,CAAN;AAGD;;AACD,WAAOyiB,MAAP;AACD,GAZD;;AAaA,MAAI6b,MAAM,GAAG,UAAU1N,QAAV,EAAoB;AAC/B,QAAIxX,QAAQ,GAAG,EAAf;AACA,QAAIC,QAAQ,GAAG,EAAf;AACA,QAAIklB,eAAe,GAAG,EAAtB;AACA,QAAIC,iBAAiB,GAAG,EAAxB;AAAA,QAA4BC,eAAe,GAAG,EAA9C;;AACA,QAAIC,iBAAiB,GAAG,UAAUC,MAAV,EAAkBC,YAAlB,EAAgCC,UAAhC,EAA4C;AAClE,UAAI7+B,KAAK,GAAG4wB,QAAQ,CAAC+N,MAAD,CAApB;;AACA,UAAI,CAAC3+B,KAAL,EAAY;AACVA,QAAAA,KAAK,GAAG68B,QAAQ,CAAC8B,MAAD,CAAhB;;AACA,YAAI,CAAC3+B,KAAL,EAAY;AACVA,UAAAA,KAAK,GAAG+8B,SAAS,CAAC6B,YAAD,EAAe,GAAf,EAAoB7B,SAAS,CAAC6B,YAAY,CAACP,WAAb,EAAD,EAA6B,GAA7B,CAA7B,CAAjB;AACAr+B,UAAAA,KAAK,GAAGi9B,QAAQ,CAACj9B,KAAD,EAAQ6+B,UAAR,CAAhB;AACAhC,UAAAA,QAAQ,CAAC8B,MAAD,CAAR,GAAmB3+B,KAAnB;AACD;AACF,OAPD,MAOO;AACLA,QAAAA,KAAK,GAAG+8B,SAAS,CAAC/8B,KAAD,EAAQ,MAAR,EAAgB+8B,SAAS,CAAC/8B,KAAK,CAACq+B,WAAN,EAAD,EAAsB,MAAtB,CAAzB,CAAjB;AACD;;AACD,aAAOr+B,KAAP;AACD,KAbD;;AAcA4wB,IAAAA,QAAQ,GAAGA,QAAQ,IAAI,EAAvB;AACA,QAAIkO,WAAW,GAAG3B,aAAa,CAACvM,QAAQ,CAACwM,MAAV,CAA/B;;AACA,QAAIxM,QAAQ,CAACmO,WAAT,KAAyB,KAA7B,EAAoC;AAClCnO,MAAAA,QAAQ,CAACoO,cAAT,GAA0B,MAA1B;AACD;;AACD,QAAIC,WAAW,GAAGd,iBAAiB,CAACvN,QAAQ,CAACsO,YAAV,CAAnC;AACA,QAAIC,aAAa,GAAGhB,iBAAiB,CAACvN,QAAQ,CAACwO,cAAV,EAA0B,KAA1B,CAArC;AACA,QAAIC,YAAY,GAAGlB,iBAAiB,CAACvN,QAAQ,CAAC0O,aAAV,EAAyB,KAAzB,CAApC;AACA,QAAIC,qBAAqB,GAAGb,iBAAiB,CAAC,qBAAD,EAAwB,mEAAxB,CAA7C;AACA,QAAIc,sBAAsB,GAAGd,iBAAiB,CAAC,uBAAD,EAA0B,iDAA1B,CAA9C;AACA,QAAIe,qBAAqB,GAAGf,iBAAiB,CAAC,sBAAD,EAAyB,+DAA+D,mCAAxF,CAA7C;AACA,QAAIgB,WAAW,GAAGhB,iBAAiB,CAAC,oBAAD,EAAuB,2EAA2E,yDAAlG,CAAnC;AACA,QAAIiB,gCAAgC,GAAG,6CAAvC;AACA,QAAIC,mBAAmB,GAAGlB,iBAAiB,CAAC,oBAAD,EAAuBiB,gCAAgC,GAAG,MAA1D,EAAkEF,qBAAlE,CAA3C;AACA,QAAII,iCAAiC,GAAGnB,iBAAiB,CAAC,qCAAD,EAAwCiB,gCAAgC,GAAG,QAA3E,EAAqFF,qBAArF,CAAzD;AACA,QAAIK,oBAAoB,GAAGpB,iBAAiB,CAAC,qBAAD,EAAwB,8CAA8C,2FAAtE,CAA5C;AACA,QAAIqB,gBAAgB,GAAGrB,iBAAiB,CAAC,gBAAD,EAAmB,gCAAgC,kEAAhC,GAAqG,qDAAxH,EAA+KoB,oBAA/K,CAAxC;AACA,QAAIE,qBAAqB,GAAGtB,iBAAiB,CAAC,sBAAD,EAAyB,+CAA+C,8BAAxE,CAA7C;AACA1B,IAAAA,MAAM,CAAC,CAACpM,QAAQ,CAACqP,OAAT,IAAoB,kEAArB,EAAyF5tB,KAAzF,CAA+F,GAA/F,CAAD,EAAsG,UAAUjV,IAAV,EAAgB;AAC1HqhC,MAAAA,eAAe,CAACrhC,IAAD,CAAf,GAAwB,IAAI8iC,MAAJ,CAAW,OAAO9iC,IAAP,GAAc,QAAzB,EAAmC,IAAnC,CAAxB;AACD,KAFK,CAAN;;AAGA,QAAI+iC,eAAe,GAAG,UAAUzzB,GAAV,EAAe;AACnC,aAAO,IAAIwzB,MAAJ,CAAW,MAAMxzB,GAAG,CAACpB,OAAJ,CAAY,UAAZ,EAAwB,KAAxB,CAAN,GAAuC,GAAlD,CAAP;AACD,KAFD;;AAGA,QAAI80B,gBAAgB,GAAG,UAAUC,aAAV,EAAyB;AAC9C,UAAIC,EAAJ,EAAQzlB,EAAR,EAAY0lB,EAAZ,EAAgBC,EAAhB,EAAoBnwB,OAApB,EAA6BmG,OAA7B,EAAsC0L,IAAtC,EAA4Cue,QAA5C,EAAsDC,WAAtD,EAAmEzgB,QAAnE,EAA6E0gB,QAA7E,EAAuF1e,UAAvF,EAAmG4b,eAAnG,EAAoH5wB,MAApH,EAA4H2zB,UAA5H,EAAwIvD,gBAAxI,EAA0JwD,qBAA1J,EAAiL7gC,KAAjL;AACA,UAAI8gC,iBAAiB,GAAG,4DAAxB;AAAA,UAAsFC,cAAc,GAAG,mDAAvG;AAAA,UAA4JC,iBAAiB,GAAG,OAAhL;;AACA,UAAIX,aAAJ,EAAmB;AACjB,YAAIY,gBAAgB,GAAG5uB,KAAK,CAACguB,aAAD,EAAgB,GAAhB,CAA5B;;AACA,YAAIjnB,QAAQ,CAAC,GAAD,CAAZ,EAAmB;AACjBikB,UAAAA,gBAAgB,GAAGjkB,QAAQ,CAAC,GAAD,CAAR,CAAc6I,UAAjC;AACA4e,UAAAA,qBAAqB,GAAGznB,QAAQ,CAAC,GAAD,CAAR,CAAcykB,eAAtC;AACD;;AACD,aAAKyC,EAAE,GAAG,CAAL,EAAQzlB,EAAE,GAAGomB,gBAAgB,CAAC3iC,MAAnC,EAA2CgiC,EAAE,GAAGzlB,EAAhD,EAAoDylB,EAAE,EAAtD,EAA0D;AACxDjwB,UAAAA,OAAO,GAAGywB,iBAAiB,CAAChuB,IAAlB,CAAuBmuB,gBAAgB,CAACX,EAAD,CAAvC,CAAV;;AACA,cAAIjwB,OAAJ,EAAa;AACXpD,YAAAA,MAAM,GAAGoD,OAAO,CAAC,CAAD,CAAhB;AACAqwB,YAAAA,WAAW,GAAGrwB,OAAO,CAAC,CAAD,CAArB;AACAuwB,YAAAA,UAAU,GAAGvwB,OAAO,CAAC,CAAD,CAApB;AACAowB,YAAAA,QAAQ,GAAGpwB,OAAO,CAAC,CAAD,CAAlB;AACA4R,YAAAA,UAAU,GAAG,EAAb;AACA4b,YAAAA,eAAe,GAAG,EAAlB;AACArnB,YAAAA,OAAO,GAAG;AACRyL,cAAAA,UAAU,EAAEA,UADJ;AAER4b,cAAAA,eAAe,EAAEA;AAFT,aAAV;;AAIA,gBAAI5wB,MAAM,KAAK,GAAf,EAAoB;AAClBuJ,cAAAA,OAAO,CAAC0qB,SAAR,GAAoB,IAApB;AACD;;AACD,gBAAIj0B,MAAM,KAAK,GAAf,EAAoB;AAClBuJ,cAAAA,OAAO,CAAC2qB,WAAR,GAAsB,IAAtB;AACD;;AACD,gBAAI9wB,OAAO,CAAC,CAAD,CAAP,KAAe,GAAnB,EAAwB;AACtBmG,cAAAA,OAAO,CAAC4qB,gBAAR,GAA2B,IAA3B;AACD;;AACD,gBAAI/D,gBAAJ,EAAsB;AACpB92B,cAAAA,MAAM,CAAC82B,gBAAD,EAAmB,UAAUr9B,KAAV,EAAiBuH,GAAjB,EAAsB;AAC7C0a,gBAAAA,UAAU,CAAC1a,GAAD,CAAV,GAAkBvH,KAAlB;AACD,eAFK,CAAN;AAGA69B,cAAAA,eAAe,CAACv5B,IAAhB,CAAqB5E,KAArB,CAA2Bm+B,eAA3B,EAA4CgD,qBAA5C;AACD;;AACD,gBAAIJ,QAAJ,EAAc;AACZA,cAAAA,QAAQ,GAAGpuB,KAAK,CAACouB,QAAD,EAAW,GAAX,CAAhB;;AACA,mBAAKF,EAAE,GAAG,CAAL,EAAQC,EAAE,GAAGC,QAAQ,CAACniC,MAA3B,EAAmCiiC,EAAE,GAAGC,EAAxC,EAA4CD,EAAE,EAA9C,EAAkD;AAChDlwB,gBAAAA,OAAO,GAAG0wB,cAAc,CAACjuB,IAAf,CAAoB2tB,QAAQ,CAACF,EAAD,CAA5B,CAAV;;AACA,oBAAIlwB,OAAJ,EAAa;AACX6R,kBAAAA,IAAI,GAAG,EAAP;AACAye,kBAAAA,QAAQ,GAAGtwB,OAAO,CAAC,CAAD,CAAlB;AACA4P,kBAAAA,QAAQ,GAAG5P,OAAO,CAAC,CAAD,CAAP,CAAW/E,OAAX,CAAmB,SAAnB,EAA8B,GAA9B,CAAX;AACA2B,kBAAAA,MAAM,GAAGoD,OAAO,CAAC,CAAD,CAAhB;AACArQ,kBAAAA,KAAK,GAAGqQ,OAAO,CAAC,CAAD,CAAf;;AACA,sBAAIswB,QAAQ,KAAK,GAAjB,EAAsB;AACpBnqB,oBAAAA,OAAO,CAAC6qB,kBAAR,GAA6B7qB,OAAO,CAAC6qB,kBAAR,IAA8B,EAA3D;AACA7qB,oBAAAA,OAAO,CAAC6qB,kBAAR,CAA2B/8B,IAA3B,CAAgC2b,QAAhC;AACAiC,oBAAAA,IAAI,CAACof,QAAL,GAAgB,IAAhB;AACD;;AACD,sBAAIX,QAAQ,KAAK,GAAjB,EAAsB;AACpB,2BAAO1e,UAAU,CAAChC,QAAD,CAAjB;AACA4d,oBAAAA,eAAe,CAAC0D,MAAhB,CAAuBrtB,OAAO,CAAC2pB,eAAD,EAAkB5d,QAAlB,CAA9B,EAA2D,CAA3D;AACA;AACD;;AACD,sBAAIhT,MAAJ,EAAY;AACV,wBAAIA,MAAM,KAAK,GAAf,EAAoB;AAClBuJ,sBAAAA,OAAO,CAACgrB,iBAAR,GAA4BhrB,OAAO,CAACgrB,iBAAR,IAA6B,EAAzD;AACAhrB,sBAAAA,OAAO,CAACgrB,iBAAR,CAA0Bl9B,IAA1B,CAA+B;AAC7BlH,wBAAAA,IAAI,EAAE6iB,QADuB;AAE7BjgB,wBAAAA,KAAK,EAAEA;AAFsB,uBAA/B;AAIAkiB,sBAAAA,IAAI,CAAC0c,YAAL,GAAoB5+B,KAApB;AACD;;AACD,wBAAIiN,MAAM,KAAK,GAAf,EAAoB;AAClBuJ,sBAAAA,OAAO,CAACirB,gBAAR,GAA2BjrB,OAAO,CAACirB,gBAAR,IAA4B,EAAvD;AACAjrB,sBAAAA,OAAO,CAACirB,gBAAR,CAAyBn9B,IAAzB,CAA8B;AAC5BlH,wBAAAA,IAAI,EAAE6iB,QADsB;AAE5BjgB,wBAAAA,KAAK,EAAEA;AAFqB,uBAA9B;AAIAkiB,sBAAAA,IAAI,CAACwf,WAAL,GAAmB1hC,KAAnB;AACD;;AACD,wBAAIiN,MAAM,KAAK,GAAf,EAAoB;AAClBiV,sBAAAA,IAAI,CAACyf,WAAL,GAAmB5E,SAAS,CAAC/8B,KAAD,EAAQ,GAAR,CAA5B;AACD;AACF;;AACD,sBAAIghC,iBAAiB,CAAC72B,IAAlB,CAAuB8V,QAAvB,CAAJ,EAAsC;AACpCzJ,oBAAAA,OAAO,CAACorB,iBAAR,GAA4BprB,OAAO,CAACorB,iBAAR,IAA6B,EAAzD;AACA1f,oBAAAA,IAAI,CAAC2f,OAAL,GAAe1B,eAAe,CAAClgB,QAAD,CAA9B;AACAzJ,oBAAAA,OAAO,CAACorB,iBAAR,CAA0Bt9B,IAA1B,CAA+B4d,IAA/B;AACD,mBAJD,MAIO;AACL,wBAAI,CAACD,UAAU,CAAChC,QAAD,CAAf,EAA2B;AACzB4d,sBAAAA,eAAe,CAACv5B,IAAhB,CAAqB2b,QAArB;AACD;;AACDgC,oBAAAA,UAAU,CAAChC,QAAD,CAAV,GAAuBiC,IAAvB;AACD;AACF;AACF;AACF;;AACD,gBAAI,CAACmb,gBAAD,IAAqBqD,WAAW,KAAK,GAAzC,EAA8C;AAC5CrD,cAAAA,gBAAgB,GAAGpb,UAAnB;AACA4e,cAAAA,qBAAqB,GAAGhD,eAAxB;AACD;;AACD,gBAAI+C,UAAJ,EAAgB;AACdpqB,cAAAA,OAAO,CAACoqB,UAAR,GAAqBF,WAArB;AACAtnB,cAAAA,QAAQ,CAACwnB,UAAD,CAAR,GAAuBpqB,OAAvB;AACD;;AACD,gBAAIwqB,iBAAiB,CAAC72B,IAAlB,CAAuBu2B,WAAvB,CAAJ,EAAyC;AACvClqB,cAAAA,OAAO,CAACqrB,OAAR,GAAkB1B,eAAe,CAACO,WAAD,CAAjC;AACAnC,cAAAA,eAAe,CAACj6B,IAAhB,CAAqBkS,OAArB;AACD,aAHD,MAGO;AACL4C,cAAAA,QAAQ,CAACsnB,WAAD,CAAR,GAAwBlqB,OAAxB;AACD;AACF;AACF;AACF;AACF,KA5GD;;AA6GA,QAAIsrB,gBAAgB,GAAG,UAAUzB,aAAV,EAAyB;AAC9CjnB,MAAAA,QAAQ,GAAG,EAAX;AACAmlB,MAAAA,eAAe,GAAG,EAAlB;AACA6B,MAAAA,gBAAgB,CAACC,aAAD,CAAhB;AACArD,MAAAA,MAAM,CAAC8B,WAAD,EAAc,UAAUtoB,OAAV,EAAmBpZ,IAAnB,EAAyB;AAC3Cic,QAAAA,QAAQ,CAACjc,IAAD,CAAR,GAAiBoZ,OAAO,CAAC6C,QAAzB;AACD,OAFK,CAAN;AAGD,KAPD;;AAQA,QAAI0oB,iBAAiB,GAAG,UAAUC,cAAV,EAA0B;AAChD,UAAIC,mBAAmB,GAAG,YAA1B;;AACA,UAAID,cAAJ,EAAoB;AAClBnF,QAAAA,QAAQ,CAACqF,mBAAT,GAA+BrF,QAAQ,CAACsF,cAAT,GAA0B,IAAzD;AACAnF,QAAAA,MAAM,CAAC3qB,KAAK,CAAC2vB,cAAD,EAAiB,GAAjB,CAAN,EAA6B,UAAUI,IAAV,EAAgB;AACjD,cAAI/xB,OAAO,GAAG4xB,mBAAmB,CAACnvB,IAApB,CAAyBsvB,IAAzB,CAAd;AAAA,cAA8CC,MAAM,GAAGhyB,OAAO,CAAC,CAAD,CAAP,KAAe,GAAtE;AAAA,cAA2EiyB,SAAS,GAAGD,MAAM,GAAG,MAAH,GAAY,KAAzG;AAAA,cAAgHjlC,IAAI,GAAGiT,OAAO,CAAC,CAAD,CAA9H;AACAgJ,UAAAA,QAAQ,CAACjc,IAAD,CAAR,GAAiBic,QAAQ,CAACipB,SAAD,CAAzB;AACA9D,UAAAA,iBAAiB,CAACphC,IAAD,CAAjB,GAA0BklC,SAA1B;;AACA,cAAI,CAACD,MAAL,EAAa;AACXtC,YAAAA,gBAAgB,CAAC3iC,IAAI,CAACihC,WAAL,EAAD,CAAhB,GAAuC,EAAvC;AACA0B,YAAAA,gBAAgB,CAAC3iC,IAAD,CAAhB,GAAyB,EAAzB;AACD;;AACD,cAAI,CAACgc,QAAQ,CAAChc,IAAD,CAAb,EAAqB;AACnB,gBAAImlC,UAAU,GAAGnpB,QAAQ,CAACkpB,SAAD,CAAzB;AACAC,YAAAA,UAAU,GAAGtF,QAAQ,CAAC,EAAD,EAAKsF,UAAL,CAArB;AACA,mBAAOA,UAAU,CAACnB,gBAAlB;AACA,mBAAOmB,UAAU,CAACpB,WAAlB;AACA/nB,YAAAA,QAAQ,CAAChc,IAAD,CAAR,GAAiBmlC,UAAjB;AACD;;AACDvF,UAAAA,MAAM,CAAC3jB,QAAD,EAAW,UAAU7C,OAAV,EAAmBgsB,OAAnB,EAA4B;AAC3C,gBAAIhsB,OAAO,CAAC8rB,SAAD,CAAX,EAAwB;AACtBjpB,cAAAA,QAAQ,CAACmpB,OAAD,CAAR,GAAoBhsB,OAAO,GAAGymB,QAAQ,CAAC,EAAD,EAAK5jB,QAAQ,CAACmpB,OAAD,CAAb,CAAtC;AACAhsB,cAAAA,OAAO,CAACpZ,IAAD,CAAP,GAAgBoZ,OAAO,CAAC8rB,SAAD,CAAvB;AACD;AACF,WALK,CAAN;AAMD,SArBK,CAAN;AAsBD;AACF,KA3BD;;AA4BA,QAAIG,gBAAgB,GAAG,UAAUC,aAAV,EAAyB;AAC9C,UAAIC,eAAe,GAAG,8LAAtB;AACA9F,MAAAA,QAAQ,CAACjM,QAAQ,CAACwM,MAAV,CAAR,GAA4B,IAA5B;;AACA,UAAIsF,aAAJ,EAAmB;AACjB1F,QAAAA,MAAM,CAAC3qB,KAAK,CAACqwB,aAAD,EAAgB,GAAhB,CAAN,EAA4B,UAAUN,IAAV,EAAgB;AAChD,cAAI/xB,OAAO,GAAGsyB,eAAe,CAAC7vB,IAAhB,CAAqBsvB,IAArB,CAAd;AACA,cAAI9uB,MAAJ,EAAYrG,MAAZ;;AACA,cAAIoD,OAAJ,EAAa;AACXpD,YAAAA,MAAM,GAAGoD,OAAO,CAAC,CAAD,CAAhB;;AACA,gBAAIpD,MAAJ,EAAY;AACVqG,cAAAA,MAAM,GAAG+F,QAAQ,CAAChJ,OAAO,CAAC,CAAD,CAAR,CAAjB;AACD,aAFD,MAEO;AACLiD,cAAAA,MAAM,GAAG+F,QAAQ,CAAChJ,OAAO,CAAC,CAAD,CAAR,CAAR,GAAuB;AAAE,4BAAY;AAAd,eAAhC;AACD;;AACDiD,YAAAA,MAAM,GAAG+F,QAAQ,CAAChJ,OAAO,CAAC,CAAD,CAAR,CAAjB;AACA2sB,YAAAA,MAAM,CAAC3qB,KAAK,CAAChC,OAAO,CAAC,CAAD,CAAR,EAAa,GAAb,CAAN,EAAyB,UAAUsJ,KAAV,EAAiB;AAC9C,kBAAI1M,MAAM,KAAK,GAAf,EAAoB;AAClB,uBAAOqG,MAAM,CAACqG,KAAD,CAAb;AACD,eAFD,MAEO;AACLrG,gBAAAA,MAAM,CAACqG,KAAD,CAAN,GAAgB,EAAhB;AACD;AACF,aANK,CAAN;AAOD;AACF,SAnBK,CAAN;AAoBD;AACF,KAzBD;;AA0BA,QAAIipB,cAAc,GAAG,UAAUxlC,IAAV,EAAgB;AACnC,UAAIoZ,OAAO,GAAG4C,QAAQ,CAAChc,IAAD,CAAtB;AAAA,UAA8BoB,CAA9B;;AACA,UAAIgY,OAAJ,EAAa;AACX,eAAOA,OAAP;AACD;;AACDhY,MAAAA,CAAC,GAAG+/B,eAAe,CAACjgC,MAApB;;AACA,aAAOE,CAAC,EAAR,EAAY;AACVgY,QAAAA,OAAO,GAAG+nB,eAAe,CAAC//B,CAAD,CAAzB;;AACA,YAAIgY,OAAO,CAACqrB,OAAR,CAAgB13B,IAAhB,CAAqB/M,IAArB,CAAJ,EAAgC;AAC9B,iBAAOoZ,OAAP;AACD;AACF;AACF,KAZD;;AAaA,QAAI,CAACoa,QAAQ,CAACoO,cAAd,EAA8B;AAC5BhC,MAAAA,MAAM,CAAC8B,WAAD,EAAc,UAAUtoB,OAAV,EAAmBpZ,IAAnB,EAAyB;AAC3Cgc,QAAAA,QAAQ,CAAChc,IAAD,CAAR,GAAiB;AACf6kB,UAAAA,UAAU,EAAEzL,OAAO,CAACyL,UADL;AAEf4b,UAAAA,eAAe,EAAErnB,OAAO,CAACqnB;AAFV,SAAjB;AAIAxkB,QAAAA,QAAQ,CAACjc,IAAD,CAAR,GAAiBoZ,OAAO,CAAC6C,QAAzB;AACD,OANK,CAAN;;AAOA,UAAIuX,QAAQ,CAACwM,MAAT,KAAoB,OAAxB,EAAiC;AAC/BJ,QAAAA,MAAM,CAAC3qB,KAAK,CAAC,eAAD,CAAN,EAAyB,UAAUlK,IAAV,EAAgB;AAC7C,cAAIgK,KAAK,GAAGE,KAAK,CAAClK,IAAD,EAAO,GAAP,CAAjB;AACAiR,UAAAA,QAAQ,CAACjH,KAAK,CAAC,CAAD,CAAN,CAAR,CAAmByuB,UAAnB,GAAgCzuB,KAAK,CAAC,CAAD,CAArC;AACD,SAHK,CAAN;AAID;;AACD6qB,MAAAA,MAAM,CAAC3qB,KAAK,CAAC,gEAAD,CAAN,EAA0E,UAAUjV,IAAV,EAAgB;AAC9F,YAAIgc,QAAQ,CAAChc,IAAD,CAAZ,EAAoB;AAClBgc,UAAAA,QAAQ,CAAChc,IAAD,CAAR,CAAe+jC,WAAf,GAA6B,IAA7B;AACD;AACF,OAJK,CAAN;AAKAnE,MAAAA,MAAM,CAAC3qB,KAAK,CAAC,sDAAD,CAAN,EAAgE,UAAUjV,IAAV,EAAgB;AACpFgc,QAAAA,QAAQ,CAAChc,IAAD,CAAR,CAAe8jC,SAAf,GAA2B,IAA3B;AACD,OAFK,CAAN;AAGAlE,MAAAA,MAAM,CAAC3qB,KAAK,CAAC,MAAD,CAAN,EAAgB,UAAUjV,IAAV,EAAgB;AACpCgc,QAAAA,QAAQ,CAAChc,IAAD,CAAR,CAAegkC,gBAAf,GAAkC,IAAlC;AACD,OAFK,CAAN;AAGD,KAzBD,MAyBO;AACLU,MAAAA,gBAAgB,CAAClR,QAAQ,CAACoO,cAAV,CAAhB;AACD;;AACD+C,IAAAA,iBAAiB,CAACnR,QAAQ,CAACiS,eAAV,CAAjB;AACAJ,IAAAA,gBAAgB,CAAC7R,QAAQ,CAACkS,cAAV,CAAhB;AACA1C,IAAAA,gBAAgB,CAACxP,QAAQ,CAACmS,uBAAV,CAAhB;AACAN,IAAAA,gBAAgB,CAAC,uBAAD,CAAhB;AACAzF,IAAAA,MAAM,CAAC;AACLgG,MAAAA,EAAE,EAAE,IADC;AAELC,MAAAA,EAAE,EAAE,IAFC;AAGLC,MAAAA,EAAE,EAAE,OAHC;AAILC,MAAAA,EAAE,EAAE,IAJC;AAKLC,MAAAA,EAAE,EAAE,IALC;AAMLC,MAAAA,EAAE,EAAE,mBANC;AAOLC,MAAAA,KAAK,EAAE,OAPF;AAQLC,MAAAA,KAAK,EAAE,OARF;AASLC,MAAAA,KAAK,EAAE,OATF;AAULC,MAAAA,MAAM,EAAE,UAVH;AAWLC,MAAAA,IAAI,EAAE,KAXD;AAYLC,MAAAA,KAAK,EAAE;AAZF,KAAD,EAaH,UAAU9qB,OAAV,EAAmB1Q,IAAnB,EAAyB;AAC1B,UAAIiR,QAAQ,CAACjR,IAAD,CAAZ,EAAoB;AAClBiR,QAAAA,QAAQ,CAACjR,IAAD,CAAR,CAAey7B,eAAf,GAAiCvxB,KAAK,CAACwG,OAAD,CAAtC;AACD;AACF,KAjBK,CAAN;;AAkBA,QAAI+X,QAAQ,CAACiT,gBAAb,EAA+B;AAC7B7G,MAAAA,MAAM,CAACE,SAAS,CAACtM,QAAQ,CAACiT,gBAAV,CAAV,EAAuC,UAAU17B,IAAV,EAAgB;AAC3D,YAAIiR,QAAQ,CAACjR,IAAD,CAAZ,EAAoB;AAClB,iBAAOiR,QAAQ,CAACjR,IAAD,CAAf;AACD;AACF,OAJK,CAAN;AAKD;;AACD,QAAI,CAACy6B,cAAc,CAAC,MAAD,CAAnB,EAA6B;AAC3BxC,MAAAA,gBAAgB,CAAC,wBAAD,CAAhB;AACD;;AACD,QAAI0D,cAAc,GAAG,YAAY;AAC/B,aAAO7E,WAAP;AACD,KAFD;;AAGA,QAAI8E,gBAAgB,GAAG,YAAY;AACjC,aAAO5E,aAAP;AACD,KAFD;;AAGA,QAAI6E,eAAe,GAAG,YAAY;AAChC,aAAO3E,YAAP;AACD,KAFD;;AAGA,QAAI4E,YAAY,GAAG,YAAY;AAC7B,aAAOvE,WAAP;AACD,KAFD;;AAGA,QAAIwE,gBAAgB,GAAG,YAAY;AACjC,aAAOnE,gBAAP;AACD,KAFD;;AAGA,QAAIoE,oBAAoB,GAAG,YAAY;AACrC,aAAOrE,oBAAP;AACD,KAFD;;AAGA,QAAIsE,qBAAqB,GAAG,YAAY;AACtC,aAAOpE,qBAAP;AACD,KAFD;;AAGA,QAAIqE,qBAAqB,GAAG,YAAY;AACtC,aAAO5E,qBAAP;AACD,KAFD;;AAGA,QAAI6E,sBAAsB,GAAG,YAAY;AACvC,aAAO9E,sBAAP;AACD,KAFD;;AAGA,QAAI+E,mBAAmB,GAAG,YAAY;AACpC,aAAO3E,mBAAP;AACD,KAFD;;AAGA,QAAI4E,iCAAiC,GAAG,YAAY;AAClD,aAAO3E,iCAAP;AACD,KAFD;;AAGA,QAAI4E,qBAAqB,GAAG,YAAY;AACtC,aAAOlF,qBAAP;AACD,KAFD;;AAGA,QAAImF,kBAAkB,GAAG,YAAY;AACnC,aAAOjG,eAAP;AACD,KAFD;;AAGA,QAAIkG,YAAY,GAAG,UAAUvnC,IAAV,EAAgBuc,KAAhB,EAAuB;AACxC,UAAIrG,MAAM,GAAG+F,QAAQ,CAACjc,IAAI,CAACuO,WAAL,EAAD,CAArB;AACA,aAAO,CAAC,EAAE2H,MAAM,IAAIA,MAAM,CAACqG,KAAK,CAAChO,WAAN,EAAD,CAAlB,CAAR;AACD,KAHD;;AAIA,QAAIi5B,OAAO,GAAG,UAAUxnC,IAAV,EAAgB8kB,IAAhB,EAAsB;AAClC,UAAI2iB,YAAJ,EAAkBrmC,CAAlB;AACA,UAAI4jC,IAAI,GAAGQ,cAAc,CAACxlC,IAAD,CAAzB;;AACA,UAAIglC,IAAJ,EAAU;AACR,YAAIlgB,IAAJ,EAAU;AACR,cAAIkgB,IAAI,CAACngB,UAAL,CAAgBC,IAAhB,CAAJ,EAA2B;AACzB,mBAAO,IAAP;AACD;;AACD2iB,UAAAA,YAAY,GAAGzC,IAAI,CAACR,iBAApB;;AACA,cAAIiD,YAAJ,EAAkB;AAChBrmC,YAAAA,CAAC,GAAGqmC,YAAY,CAACvmC,MAAjB;;AACA,mBAAOE,CAAC,EAAR,EAAY;AACV,kBAAIqmC,YAAY,CAACrmC,CAAD,CAAZ,CAAgBqjC,OAAhB,CAAwB13B,IAAxB,CAA6B/M,IAA7B,CAAJ,EAAwC;AACtC,uBAAO,IAAP;AACD;AACF;AACF;AACF,SAbD,MAaO;AACL,iBAAO,IAAP;AACD;AACF;;AACD,aAAO,KAAP;AACD,KAtBD;;AAuBA,QAAI0nC,iBAAiB,GAAG,YAAY;AAClC,aAAOtG,iBAAP;AACD,KAFD;;AAGA,WAAO;AACLnlB,MAAAA,QAAQ,EAAEA,QADL;AAELD,MAAAA,QAAQ,EAAEA,QAFL;AAGL0qB,MAAAA,cAAc,EAAEA,cAHX;AAILE,MAAAA,eAAe,EAAEA,eAJZ;AAKLE,MAAAA,gBAAgB,EAAEA,gBALb;AAMLH,MAAAA,gBAAgB,EAAEA,gBANb;AAOLM,MAAAA,qBAAqB,EAAEA,qBAPlB;AAQLF,MAAAA,oBAAoB,EAAEA,oBARjB;AASLC,MAAAA,qBAAqB,EAAEA,qBATlB;AAULH,MAAAA,YAAY,EAAEA,YAVT;AAWLrB,MAAAA,cAAc,EAAEA,cAXX;AAYL0B,MAAAA,sBAAsB,EAAEA,sBAZnB;AAaLC,MAAAA,mBAAmB,EAAEA,mBAbhB;AAcLC,MAAAA,iCAAiC,EAAEA,iCAd9B;AAeLC,MAAAA,qBAAqB,EAAEA,qBAflB;AAgBLC,MAAAA,kBAAkB,EAAEA,kBAhBf;AAiBLC,MAAAA,YAAY,EAAEA,YAjBT;AAkBLC,MAAAA,OAAO,EAAEA,OAlBJ;AAmBLE,MAAAA,iBAAiB,EAAEA,iBAnBd;AAoBL1E,MAAAA,gBAAgB,EAAEA,gBApBb;AAqBL0B,MAAAA,gBAAgB,EAAEA,gBArBb;AAsBLC,MAAAA,iBAAiB,EAAEA,iBAtBd;AAuBLU,MAAAA,gBAAgB,EAAEA;AAvBb,KAAP;AAyBD,GA7XD;;AA+XA,MAAIsC,KAAK,GAAG,UAAU/xB,KAAV,EAAiBvO,CAAjB,EAAoB8f,CAApB,EAAuBthB,CAAvB,EAA0B;AACpC,QAAI+hC,GAAG,GAAG,UAAUlc,GAAV,EAAe;AACvBA,MAAAA,GAAG,GAAG8S,QAAQ,CAAC9S,GAAD,EAAM,EAAN,CAAR,CAAkBpmB,QAAlB,CAA2B,EAA3B,CAAN;AACA,aAAOomB,GAAG,CAACxqB,MAAJ,GAAa,CAAb,GAAiBwqB,GAAjB,GAAuB,MAAMA,GAApC;AACD,KAHD;;AAIA,WAAO,MAAMkc,GAAG,CAACvgC,CAAD,CAAT,GAAeugC,GAAG,CAACzgB,CAAD,CAAlB,GAAwBygB,GAAG,CAAC/hC,CAAD,CAAlC;AACD,GAND;;AAOA,MAAIgiC,MAAM,GAAG,UAAUrU,QAAV,EAAoBwM,MAApB,EAA4B;AACvC,QAAI8H,KAAK,GAAG,IAAZ;;AACA,QAAIC,SAAS,GAAG,0DAAhB;AACA,QAAIC,cAAc,GAAG,8HAArB;AACA,QAAIC,WAAW,GAAG,0BAAlB;AACA,QAAIC,eAAe,GAAG,MAAtB;AACA,QAAI9mC,CAAJ;AACA,QAAI+mC,cAAc,GAAG,EAArB;AACA,QAAItG,WAAJ;AACA,QAAIE,aAAJ;AACA,QAAIqG,aAAa,GAAG3P,SAApB;AACAjF,IAAAA,QAAQ,GAAGA,QAAQ,IAAI,EAAvB;;AACA,QAAIwM,MAAJ,EAAY;AACV6B,MAAAA,WAAW,GAAG7B,MAAM,CAAC0G,cAAP,EAAd;AACA3E,MAAAA,aAAa,GAAG/B,MAAM,CAAC2G,gBAAP,EAAhB;AACD;;AACD,QAAI0B,aAAa,GAAG,CAAC,0BAA0BD,aAA3B,EAA0CnzB,KAA1C,CAAgD,GAAhD,CAApB;;AACA,SAAK7T,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGinC,aAAa,CAACnnC,MAA9B,EAAsCE,CAAC,EAAvC,EAA2C;AACzC+mC,MAAAA,cAAc,CAACE,aAAa,CAACjnC,CAAD,CAAd,CAAd,GAAmCgnC,aAAa,GAAGhnC,CAAnD;AACA+mC,MAAAA,cAAc,CAACC,aAAa,GAAGhnC,CAAjB,CAAd,GAAoCinC,aAAa,CAACjnC,CAAD,CAAjD;AACD;;AACD,WAAO;AACLumC,MAAAA,KAAK,EAAE,UAAUW,KAAV,EAAiB;AACtB,eAAOA,KAAK,CAACp6B,OAAN,CAAc65B,SAAd,EAAyBJ,KAAzB,CAAP;AACD,OAHI;AAILY,MAAAA,KAAK,EAAE,UAAUpjB,GAAV,EAAe;AACpB,YAAIE,MAAM,GAAG,EAAb;AACA,YAAIpS,OAAJ,EAAajT,IAAb,EAAmB4C,KAAnB,EAA0B4lC,SAA1B;AACA,YAAIC,YAAY,GAAGjV,QAAQ,CAACkV,aAA5B;AACA,YAAIC,iBAAiB,GAAGnV,QAAQ,CAACoV,mBAAT,IAAgCd,KAAxD;;AACA,YAAIe,QAAQ,GAAG,UAAUh5B,MAAV,EAAkBi5B,MAAlB,EAA0BC,MAA1B,EAAkC;AAC/C,cAAIzpB,GAAG,GAAG+F,MAAM,CAACxV,MAAM,GAAG,MAAT,GAAkBi5B,MAAnB,CAAhB;;AACA,cAAI,CAACxpB,GAAL,EAAU;AACR;AACD;;AACD,cAAI+B,KAAK,GAAGgE,MAAM,CAACxV,MAAM,GAAG,QAAT,GAAoBi5B,MAArB,CAAlB;;AACA,cAAI,CAACznB,KAAL,EAAY;AACV;AACD;;AACD,cAAIC,MAAM,GAAG+D,MAAM,CAACxV,MAAM,GAAG,SAAT,GAAqBi5B,MAAtB,CAAnB;;AACA,cAAI,CAACxnB,MAAL,EAAa;AACX;AACD;;AACD,cAAIjC,IAAI,GAAGgG,MAAM,CAACxV,MAAM,GAAG,OAAT,GAAmBi5B,MAApB,CAAjB;;AACA,cAAI,CAACzpB,IAAL,EAAW;AACT;AACD;;AACD,cAAIK,GAAG,GAAG,CACRJ,GADQ,EAER+B,KAFQ,EAGRC,MAHQ,EAIRjC,IAJQ,CAAV;AAMAje,UAAAA,CAAC,GAAGse,GAAG,CAACxe,MAAJ,GAAa,CAAjB;;AACA,iBAAOE,CAAC,EAAR,EAAY;AACV,gBAAIse,GAAG,CAACte,CAAD,CAAH,KAAWse,GAAG,CAACte,CAAC,GAAG,CAAL,CAAlB,EAA2B;AACzB;AACD;AACF;;AACD,cAAIA,CAAC,GAAG,CAAC,CAAL,IAAU2nC,MAAd,EAAsB;AACpB;AACD;;AACD1jB,UAAAA,MAAM,CAACxV,MAAM,GAAGi5B,MAAV,CAAN,GAA0B1nC,CAAC,KAAK,CAAC,CAAP,GAAWse,GAAG,CAAC,CAAD,CAAd,GAAoBA,GAAG,CAAC+Q,IAAJ,CAAS,GAAT,CAA9C;AACA,iBAAOpL,MAAM,CAACxV,MAAM,GAAG,MAAT,GAAkBi5B,MAAnB,CAAb;AACA,iBAAOzjB,MAAM,CAACxV,MAAM,GAAG,QAAT,GAAoBi5B,MAArB,CAAb;AACA,iBAAOzjB,MAAM,CAACxV,MAAM,GAAG,SAAT,GAAqBi5B,MAAtB,CAAb;AACA,iBAAOzjB,MAAM,CAACxV,MAAM,GAAG,OAAT,GAAmBi5B,MAApB,CAAb;AACD,SArCD;;AAsCA,YAAIE,WAAW,GAAG,UAAU7+B,GAAV,EAAe;AAC/B,cAAIvH,KAAK,GAAGyiB,MAAM,CAAClb,GAAD,CAAlB;AAAA,cAAyB/I,CAAzB;;AACA,cAAI,CAACwB,KAAL,EAAY;AACV;AACD;;AACDA,UAAAA,KAAK,GAAGA,KAAK,CAACqS,KAAN,CAAY,GAAZ,CAAR;AACA7T,UAAAA,CAAC,GAAGwB,KAAK,CAAC1B,MAAV;;AACA,iBAAOE,CAAC,EAAR,EAAY;AACV,gBAAIwB,KAAK,CAACxB,CAAD,CAAL,KAAawB,KAAK,CAAC,CAAD,CAAtB,EAA2B;AACzB,qBAAO,KAAP;AACD;AACF;;AACDyiB,UAAAA,MAAM,CAAClb,GAAD,CAAN,GAAcvH,KAAK,CAAC,CAAD,CAAnB;AACA,iBAAO,IAAP;AACD,SAdD;;AAeA,YAAIqmC,SAAS,GAAG,UAAU34B,MAAV,EAAkB5N,CAAlB,EAAqBmD,CAArB,EAAwB2P,CAAxB,EAA2B;AACzC,cAAI,CAACwzB,WAAW,CAACtmC,CAAD,CAAhB,EAAqB;AACnB;AACD;;AACD,cAAI,CAACsmC,WAAW,CAACnjC,CAAD,CAAhB,EAAqB;AACnB;AACD;;AACD,cAAI,CAACmjC,WAAW,CAACxzB,CAAD,CAAhB,EAAqB;AACnB;AACD;;AACD6P,UAAAA,MAAM,CAAC/U,MAAD,CAAN,GAAiB+U,MAAM,CAAC3iB,CAAD,CAAN,GAAY,GAAZ,GAAkB2iB,MAAM,CAACxf,CAAD,CAAxB,GAA8B,GAA9B,GAAoCwf,MAAM,CAAC7P,CAAD,CAA3D;AACA,iBAAO6P,MAAM,CAAC3iB,CAAD,CAAb;AACA,iBAAO2iB,MAAM,CAACxf,CAAD,CAAb;AACA,iBAAOwf,MAAM,CAAC7P,CAAD,CAAb;AACD,SAdD;;AAeA,YAAI0zB,MAAM,GAAG,UAAU55B,GAAV,EAAe;AAC1Bk5B,UAAAA,SAAS,GAAG,IAAZ;AACA,iBAAOL,cAAc,CAAC74B,GAAD,CAArB;AACD,SAHD;;AAIA,YAAIiwB,MAAM,GAAG,UAAUjwB,GAAV,EAAe65B,WAAf,EAA4B;AACvC,cAAIX,SAAJ,EAAe;AACbl5B,YAAAA,GAAG,GAAGA,GAAG,CAACpB,OAAJ,CAAY,cAAZ,EAA4B,UAAUoB,GAAV,EAAe;AAC/C,qBAAO64B,cAAc,CAAC74B,GAAD,CAArB;AACD,aAFK,CAAN;AAGD;;AACD,cAAI,CAAC65B,WAAL,EAAkB;AAChB75B,YAAAA,GAAG,GAAGA,GAAG,CAACpB,OAAJ,CAAY,eAAZ,EAA6B,IAA7B,CAAN;AACD;;AACD,iBAAOoB,GAAP;AACD,SAVD;;AAWA,YAAI85B,uBAAuB,GAAG,UAAUC,MAAV,EAAkB;AAC9C,iBAAOppC,MAAM,CAACs+B,YAAP,CAAoBC,QAAQ,CAAC6K,MAAM,CAAC7oC,KAAP,CAAa,CAAb,CAAD,EAAkB,EAAlB,CAA5B,CAAP;AACD,SAFD;;AAGA,YAAI8oC,kBAAkB,GAAG,UAAU1mC,KAAV,EAAiB;AACxC,iBAAOA,KAAK,CAACsL,OAAN,CAAc,eAAd,EAA+Bk7B,uBAA/B,CAAP;AACD,SAFD;;AAGA,YAAIG,UAAU,GAAG,UAAU3zB,KAAV,EAAiBe,GAAjB,EAAsB6yB,IAAtB,EAA4BC,IAA5B,EAAkCn6B,GAAlC,EAAuCo6B,IAAvC,EAA6C;AAC5Dp6B,UAAAA,GAAG,GAAGA,GAAG,IAAIo6B,IAAb;;AACA,cAAIp6B,GAAJ,EAAS;AACPA,YAAAA,GAAG,GAAGiwB,MAAM,CAACjwB,GAAD,CAAZ;AACA,mBAAO,OAAOA,GAAG,CAACpB,OAAJ,CAAY,KAAZ,EAAmB,MAAnB,CAAP,GAAoC,IAA3C;AACD;;AACDyI,UAAAA,GAAG,GAAG4oB,MAAM,CAAC5oB,GAAG,IAAI6yB,IAAP,IAAeC,IAAhB,CAAZ;;AACA,cAAI,CAACjW,QAAQ,CAACmW,iBAAd,EAAiC;AAC/B,gBAAIC,SAAS,GAAGjzB,GAAG,CAACzI,OAAJ,CAAY,YAAZ,EAA0B,EAA1B,CAAhB;;AACA,gBAAI,oBAAoBnB,IAApB,CAAyB68B,SAAzB,CAAJ,EAAyC;AACvC,qBAAO,EAAP;AACD;;AACD,gBAAI,CAACpW,QAAQ,CAACqW,mBAAV,IAAiC,oBAAoB98B,IAApB,CAAyB68B,SAAzB,CAArC,EAA0E;AACxE,qBAAO,EAAP;AACD;AACF;;AACD,cAAInB,YAAJ,EAAkB;AAChB9xB,YAAAA,GAAG,GAAG8xB,YAAY,CAAChoC,IAAb,CAAkBkoC,iBAAlB,EAAqChyB,GAArC,EAA0C,OAA1C,CAAN;AACD;;AACD,iBAAO,WAAWA,GAAG,CAACzI,OAAJ,CAAY,KAAZ,EAAmB,MAAnB,CAAX,GAAwC,KAA/C;AACD,SApBD;;AAqBA,YAAIiX,GAAJ,EAAS;AACPA,UAAAA,GAAG,GAAGA,GAAG,CAACjX,OAAJ,CAAY,kBAAZ,EAAgC,EAAhC,CAAN;AACAiX,UAAAA,GAAG,GAAGA,GAAG,CAACjX,OAAJ,CAAY,mBAAZ,EAAiCg7B,MAAjC,EAAyCh7B,OAAzC,CAAiD,wBAAjD,EAA2E,UAAUoB,GAAV,EAAe;AAC9F,mBAAOA,GAAG,CAACpB,OAAJ,CAAY,OAAZ,EAAqBg7B,MAArB,CAAP;AACD,WAFK,CAAN;;AAGA,iBAAOj2B,OAAO,GAAGg1B,WAAW,CAACvyB,IAAZ,CAAiByP,GAAjB,CAAjB,EAAwC;AACtC8iB,YAAAA,WAAW,CAAC6B,SAAZ,GAAwB72B,OAAO,CAACjI,KAAR,GAAgBiI,OAAO,CAAC,CAAD,CAAP,CAAW/R,MAAnD;AACAlB,YAAAA,IAAI,GAAGiT,OAAO,CAAC,CAAD,CAAP,CAAW/E,OAAX,CAAmBg6B,eAAnB,EAAoC,EAApC,EAAwC35B,WAAxC,EAAP;AACA3L,YAAAA,KAAK,GAAGqQ,OAAO,CAAC,CAAD,CAAP,CAAW/E,OAAX,CAAmBg6B,eAAnB,EAAoC,EAApC,CAAR;;AACA,gBAAIloC,IAAI,IAAI4C,KAAZ,EAAmB;AACjB5C,cAAAA,IAAI,GAAGspC,kBAAkB,CAACtpC,IAAD,CAAzB;AACA4C,cAAAA,KAAK,GAAG0mC,kBAAkB,CAAC1mC,KAAD,CAA1B;;AACA,kBAAI5C,IAAI,CAACG,OAAL,CAAaioC,aAAb,MAAgC,CAAC,CAAjC,IAAsCpoC,IAAI,CAACG,OAAL,CAAa,GAAb,MAAsB,CAAC,CAAjE,EAAoE;AAClE;AACD;;AACD,kBAAI,CAACqzB,QAAQ,CAACmW,iBAAV,KAAgC3pC,IAAI,KAAK,UAAT,IAAuB,4BAA4B+M,IAA5B,CAAiCnK,KAAjC,CAAvD,CAAJ,EAAqG;AACnG;AACD;;AACD,kBAAI5C,IAAI,KAAK,aAAT,IAA0B4C,KAAK,KAAK,KAAxC,EAA+C;AAC7CA,gBAAAA,KAAK,GAAG,MAAR;AACD,eAFD,MAEO,IAAI5C,IAAI,KAAK,OAAT,IAAoBA,IAAI,KAAK,kBAAjC,EAAqD;AAC1D4C,gBAAAA,KAAK,GAAGA,KAAK,CAAC2L,WAAN,EAAR;AACD;;AACD3L,cAAAA,KAAK,GAAGA,KAAK,CAACsL,OAAN,CAAc65B,SAAd,EAAyBJ,KAAzB,CAAR;AACA/kC,cAAAA,KAAK,GAAGA,KAAK,CAACsL,OAAN,CAAc85B,cAAd,EAA8BuB,UAA9B,CAAR;AACAlkB,cAAAA,MAAM,CAACrlB,IAAD,CAAN,GAAewoC,SAAS,GAAGjJ,MAAM,CAAC38B,KAAD,EAAQ,IAAR,CAAT,GAAyBA,KAAjD;AACD;AACF;;AACDimC,UAAAA,QAAQ,CAAC,QAAD,EAAW,EAAX,EAAe,IAAf,CAAR;AACAA,UAAAA,QAAQ,CAAC,QAAD,EAAW,QAAX,CAAR;AACAA,UAAAA,QAAQ,CAAC,QAAD,EAAW,QAAX,CAAR;AACAA,UAAAA,QAAQ,CAAC,QAAD,EAAW,QAAX,CAAR;AACAA,UAAAA,QAAQ,CAAC,SAAD,EAAY,EAAZ,CAAR;AACAA,UAAAA,QAAQ,CAAC,QAAD,EAAW,EAAX,CAAR;AACAI,UAAAA,SAAS,CAAC,QAAD,EAAW,cAAX,EAA2B,cAA3B,EAA2C,cAA3C,CAAT;;AACA,cAAI5jB,MAAM,CAAC0kB,MAAP,KAAkB,aAAtB,EAAqC;AACnC,mBAAO1kB,MAAM,CAAC0kB,MAAd;AACD;;AACD,cAAI1kB,MAAM,CAAC,cAAD,CAAN,KAA2B,MAA/B,EAAuC;AACrC,mBAAOA,MAAM,CAAC,cAAD,CAAb;AACD;AACF;;AACD,eAAOA,MAAP;AACD,OAlKI;AAmKL2kB,MAAAA,SAAS,EAAE,UAAU3kB,MAAV,EAAkBie,WAAlB,EAA+B;AACxC,YAAIne,GAAG,GAAG,EAAV;;AACA,YAAI8kB,eAAe,GAAG,UAAUjqC,IAAV,EAAgB;AACpC,cAAI4C,KAAJ;AACA,cAAIsnC,SAAS,GAAGrI,WAAW,CAAC7hC,IAAD,CAA3B;;AACA,cAAIkqC,SAAJ,EAAe;AACb,iBAAK,IAAIC,GAAG,GAAG,CAAV,EAAa1/B,CAAC,GAAGy/B,SAAS,CAAChpC,MAAhC,EAAwCipC,GAAG,GAAG1/B,CAA9C,EAAiD0/B,GAAG,EAApD,EAAwD;AACtDnqC,cAAAA,IAAI,GAAGkqC,SAAS,CAACC,GAAD,CAAhB;AACAvnC,cAAAA,KAAK,GAAGyiB,MAAM,CAACrlB,IAAD,CAAd;;AACA,kBAAI4C,KAAJ,EAAW;AACTuiB,gBAAAA,GAAG,IAAI,CAACA,GAAG,CAACjkB,MAAJ,GAAa,CAAb,GAAiB,GAAjB,GAAuB,EAAxB,IAA8BlB,IAA9B,GAAqC,IAArC,GAA4C4C,KAA5C,GAAoD,GAA3D;AACD;AACF;AACF;AACF,SAZD;;AAaA,YAAI4kC,OAAO,GAAG,UAAUxnC,IAAV,EAAgBsjC,WAAhB,EAA6B;AACzC,cAAI8G,QAAQ,GAAGrI,aAAa,CAAC,GAAD,CAA5B;;AACA,cAAIqI,QAAQ,IAAIA,QAAQ,CAACpqC,IAAD,CAAxB,EAAgC;AAC9B,mBAAO,KAAP;AACD;;AACDoqC,UAAAA,QAAQ,GAAGrI,aAAa,CAACuB,WAAD,CAAxB;AACA,iBAAO,EAAE8G,QAAQ,IAAIA,QAAQ,CAACpqC,IAAD,CAAtB,CAAP;AACD,SAPD;;AAQA,YAAIsjC,WAAW,IAAIzB,WAAnB,EAAgC;AAC9BoI,UAAAA,eAAe,CAAC,GAAD,CAAf;AACAA,UAAAA,eAAe,CAAC3G,WAAD,CAAf;AACD,SAHD,MAGO;AACLn6B,UAAAA,MAAM,CAACkc,MAAD,EAAS,UAAUziB,KAAV,EAAiB5C,IAAjB,EAAuB;AACpC,gBAAI4C,KAAK,KAAK,CAACm/B,aAAD,IAAkByF,OAAO,CAACxnC,IAAD,EAAOsjC,WAAP,CAA9B,CAAT,EAA6D;AAC3Dne,cAAAA,GAAG,IAAI,CAACA,GAAG,CAACjkB,MAAJ,GAAa,CAAb,GAAiB,GAAjB,GAAuB,EAAxB,IAA8BlB,IAA9B,GAAqC,IAArC,GAA4C4C,KAA5C,GAAoD,GAA3D;AACD;AACF,WAJK,CAAN;AAKD;;AACD,eAAOuiB,GAAP;AACD;AArMI,KAAP;AAuMD,GA5ND;;AA8NA,MAAIklB,kBAAkB,GAAG,WAAzB;AACA,MAAIC,YAAY,GAAG,8BAAnB;AACA,MAAIC,UAAU,GAAG;AACfC,IAAAA,WAAW,EAAE,CADE;AAEfC,IAAAA,MAAM,EAAE,CAFO;AAGfC,IAAAA,MAAM,EAAE,CAHO;AAIfC,IAAAA,WAAW,EAAE,CAJE;AAKfC,IAAAA,eAAe,EAAE,CALF;AAMfC,IAAAA,eAAe,EAAE,CANF;AAOfC,IAAAA,aAAa,EAAE,CAPA;AAQfC,IAAAA,WAAW,EAAE;AARE,GAAjB;;AAUA,MAAIC,qBAAqB,GAAG,UAAUxtB,KAAV,EAAiB;AAC3C,WAAOA,KAAK,CAACytB,kBAAN,KAA6BC,UAA7B,IAA2C1tB,KAAK,CAACytB,kBAAN,KAA6BE,WAA/E;AACD,GAFD;;AAGA,MAAIA,WAAW,GAAG3nC,KAAlB;AACA,MAAI0nC,UAAU,GAAGznC,MAAjB;;AACA,MAAI2nC,QAAQ,GAAG,UAAU96B,MAAV,EAAkBtQ,IAAlB,EAAwB6K,QAAxB,EAAkCwgC,OAAlC,EAA2C;AACxD,QAAI/6B,MAAM,CAACg7B,gBAAX,EAA6B;AAC3Bh7B,MAAAA,MAAM,CAACg7B,gBAAP,CAAwBtrC,IAAxB,EAA8B6K,QAA9B,EAAwCwgC,OAAO,IAAI,KAAnD;AACD,KAFD,MAEO,IAAI/6B,MAAM,CAACi7B,WAAX,EAAwB;AAC7Bj7B,MAAAA,MAAM,CAACi7B,WAAP,CAAmB,OAAOvrC,IAA1B,EAAgC6K,QAAhC;AACD;AACF,GAND;;AAOA,MAAI2gC,WAAW,GAAG,UAAUl7B,MAAV,EAAkBtQ,IAAlB,EAAwB6K,QAAxB,EAAkCwgC,OAAlC,EAA2C;AAC3D,QAAI/6B,MAAM,CAACm7B,mBAAX,EAAgC;AAC9Bn7B,MAAAA,MAAM,CAACm7B,mBAAP,CAA2BzrC,IAA3B,EAAiC6K,QAAjC,EAA2CwgC,OAAO,IAAI,KAAtD;AACD,KAFD,MAEO,IAAI/6B,MAAM,CAACo7B,WAAX,EAAwB;AAC7Bp7B,MAAAA,MAAM,CAACo7B,WAAP,CAAmB,OAAO1rC,IAA1B,EAAgC6K,QAAhC;AACD;AACF,GAND;;AAOA,MAAI8gC,YAAY,GAAG,UAAUnuB,KAAV,EAAiB;AAClC,WAAO8sB,YAAY,CAACv9B,IAAb,CAAkByQ,KAAK,CAACtX,IAAxB,CAAP;AACD,GAFD;;AAGA,MAAI0lC,GAAG,GAAG,UAAUC,aAAV,EAAyBne,IAAzB,EAA+B;AACvC,QAAI1tB,IAAJ;AACA,QAAIwd,KAAK,GAAGkQ,IAAI,IAAI,EAApB;;AACA,SAAK1tB,IAAL,IAAa6rC,aAAb,EAA4B;AAC1B,UAAI,CAACtB,UAAU,CAACvqC,IAAD,CAAf,EAAuB;AACrBwd,QAAAA,KAAK,CAACxd,IAAD,CAAL,GAAc6rC,aAAa,CAAC7rC,IAAD,CAA3B;AACD;AACF;;AACD,QAAI,CAACwd,KAAK,CAAClN,MAAX,EAAmB;AACjBkN,MAAAA,KAAK,CAAClN,MAAN,GAAekN,KAAK,CAACsuB,UAAN,IAAoBz3B,QAAnC;AACD;;AACD,QAAImJ,KAAK,CAACI,YAAV,EAAwB;AACtBJ,MAAAA,KAAK,CAACI,YAAN,GAAqB,YAAY;AAC/B,eAAOiuB,aAAa,CAACjuB,YAAd,EAAP;AACD,OAFD;AAGD;;AACD,QAAIiuB,aAAa,IAAIF,YAAY,CAACE,aAAD,CAA7B,IAAgDA,aAAa,CAACE,KAAd,KAAwBrsC,SAAxE,IAAqFmsC,aAAa,CAACG,OAAd,KAA0BtsC,SAAnH,EAA8H;AAC5H,UAAIusC,QAAQ,GAAGzuB,KAAK,CAAClN,MAAN,CAAa6K,aAAb,IAA8B9G,QAA7C;AACA,UAAI8C,GAAG,GAAG80B,QAAQ,CAAC3wB,eAAnB;AACA,UAAI8D,IAAI,GAAG6sB,QAAQ,CAAC7sB,IAApB;AACA5B,MAAAA,KAAK,CAACuuB,KAAN,GAAcF,aAAa,CAACG,OAAd,IAAyB70B,GAAG,IAAIA,GAAG,CAACgJ,UAAX,IAAyBf,IAAI,IAAIA,IAAI,CAACe,UAAtC,IAAoD,CAA7E,KAAmFhJ,GAAG,IAAIA,GAAG,CAACmJ,UAAX,IAAyBlB,IAAI,IAAIA,IAAI,CAACkB,UAAtC,IAAoD,CAAvI,CAAd;AACA9C,MAAAA,KAAK,CAAC0uB,KAAN,GAAcL,aAAa,CAACM,OAAd,IAAyBh1B,GAAG,IAAIA,GAAG,CAAC8I,SAAX,IAAwBb,IAAI,IAAIA,IAAI,CAACa,SAArC,IAAkD,CAA3E,KAAiF9I,GAAG,IAAIA,GAAG,CAACkJ,SAAX,IAAwBjB,IAAI,IAAIA,IAAI,CAACiB,SAArC,IAAkD,CAAnI,CAAd;AACD;;AACD7C,IAAAA,KAAK,CAAC4uB,cAAN,GAAuB,YAAY;AACjC5uB,MAAAA,KAAK,CAAC6uB,gBAAN,GAAyB,IAAzB;AACA7uB,MAAAA,KAAK,CAACytB,kBAAN,GAA2BC,UAA3B;;AACA,UAAIW,aAAJ,EAAmB;AACjB,YAAIA,aAAa,CAACO,cAAlB,EAAkC;AAChCP,UAAAA,aAAa,CAACO,cAAd;AACD,SAFD,MAEO;AACLP,UAAAA,aAAa,CAAClB,WAAd,GAA4B,KAA5B;AACD;AACF;AACF,KAVD;;AAWAntB,IAAAA,KAAK,CAAC8uB,eAAN,GAAwB,YAAY;AAClC9uB,MAAAA,KAAK,CAAC+uB,YAAN,GAAqB,IAArB;AACA/uB,MAAAA,KAAK,CAACgvB,oBAAN,GAA6BtB,UAA7B;;AACA,UAAIW,aAAJ,EAAmB;AACjB,YAAIA,aAAa,CAACS,eAAlB,EAAmC;AACjCT,UAAAA,aAAa,CAACS,eAAd;AACD,SAFD,MAEO;AACLT,UAAAA,aAAa,CAACU,YAAd,GAA6B,IAA7B;AACD;AACF;AACF,KAVD;;AAWA/uB,IAAAA,KAAK,CAACivB,wBAAN,GAAiC,YAAY;AAC3CjvB,MAAAA,KAAK,CAACkvB,6BAAN,GAAsCxB,UAAtC;AACA1tB,MAAAA,KAAK,CAAC8uB,eAAN;AACD,KAHD;;AAIA,QAAItB,qBAAqB,CAACxtB,KAAD,CAArB,KAAiC,KAArC,EAA4C;AAC1CA,MAAAA,KAAK,CAACytB,kBAAN,GAA2BztB,KAAK,CAAC6uB,gBAAN,KAA2B,IAA3B,GAAkCnB,UAAlC,GAA+CC,WAA1E;AACA3tB,MAAAA,KAAK,CAACgvB,oBAAN,GAA6BhvB,KAAK,CAAC+uB,YAAN,KAAuB,IAAvB,GAA8BrB,UAA9B,GAA2CC,WAAxE;AACA3tB,MAAAA,KAAK,CAACkvB,6BAAN,GAAsCvB,WAAtC;AACD;;AACD,QAAI,OAAO3tB,KAAK,CAACmvB,OAAb,KAAyB,WAA7B,EAA0C;AACxCnvB,MAAAA,KAAK,CAACmvB,OAAN,GAAgB,KAAhB;AACD;;AACD,WAAOnvB,KAAP;AACD,GA1DD;;AA2DA,MAAIovB,WAAW,GAAG,UAAU9sB,GAAV,EAAejV,QAAf,EAAyBgiC,UAAzB,EAAqC;AACrD,QAAI11B,GAAG,GAAG2I,GAAG,CAACzL,QAAd;AAAA,QAAwBmJ,KAAK,GAAG;AAAEtX,MAAAA,IAAI,EAAE;AAAR,KAAhC;;AACA,QAAI2mC,UAAU,CAACC,SAAf,EAA0B;AACxBjiC,MAAAA,QAAQ,CAAC2S,KAAD,CAAR;AACA;AACD;;AACD,QAAIuvB,UAAU,GAAG,YAAY;AAC3B,aAAO51B,GAAG,CAAC61B,UAAJ,KAAmB,UAAnB,IAAiC71B,GAAG,CAAC61B,UAAJ,KAAmB,aAAnB,IAAoC71B,GAAG,CAACiI,IAAhF;AACD,KAFD;;AAGA,QAAI6tB,YAAY,GAAG,YAAY;AAC7BzB,MAAAA,WAAW,CAAC1rB,GAAD,EAAM,kBAAN,EAA0BmtB,YAA1B,CAAX;AACAzB,MAAAA,WAAW,CAAC1rB,GAAD,EAAM,MAAN,EAAcmtB,YAAd,CAAX;;AACA,UAAI,CAACJ,UAAU,CAACC,SAAhB,EAA2B;AACzBD,QAAAA,UAAU,CAACC,SAAX,GAAuB,IAAvB;AACAjiC,QAAAA,QAAQ,CAAC2S,KAAD,CAAR;AACD;;AACDsC,MAAAA,GAAG,GAAG,IAAN;AACD,KARD;;AASA,QAAIitB,UAAU,EAAd,EAAkB;AAChBE,MAAAA,YAAY;AACb,KAFD,MAEO;AACL7B,MAAAA,QAAQ,CAACtrB,GAAD,EAAM,kBAAN,EAA0BmtB,YAA1B,CAAR;AACD;;AACD,QAAI,CAACJ,UAAU,CAACC,SAAhB,EAA2B;AACzB1B,MAAAA,QAAQ,CAACtrB,GAAD,EAAM,MAAN,EAAcmtB,YAAd,CAAR;AACD;AACF,GA1BD;;AA2BA,MAAIC,UAAU,GAAG,YAAY;AAC3B,aAASA,UAAT,GAAsB;AACpB,WAAKJ,SAAL,GAAiB,KAAjB;AACA,WAAKK,MAAL,GAAc,EAAd;AACA,WAAKpe,KAAL,GAAa,CAAb;AACA,WAAKqe,OAAL,GAAe/C,kBAAkB,GAAG,CAAC,CAAC,IAAIpV,IAAJ,EAAF,EAAc3vB,QAAd,CAAuB,EAAvB,CAApC;AACA,WAAK+nC,kBAAL,GAA0B,kBAAkBh5B,QAAQ,CAACiH,eAArD;AACA,WAAKgyB,UAAL,GAAkB,eAAej5B,QAAQ,CAACiH,eAA1C;AACA,WAAKyT,KAAL,GAAa,CAAb;AACD;;AACDme,IAAAA,UAAU,CAACrtC,SAAX,CAAqBkF,IAArB,GAA4B,UAAUuL,MAAV,EAAkB+R,KAAlB,EAAyBxX,QAAzB,EAAmCqM,KAAnC,EAA0C;AACpE,UAAIzR,IAAI,GAAG,IAAX;AACA,UAAI1B,EAAJ,EAAQwpC,YAAR,EAAsBnsC,CAAtB,EAAyBpB,IAAzB,EAA+BwtC,QAA/B,EAAyCC,aAAzC,EAAwDpC,OAAxD;AACA,UAAIvrB,GAAG,GAAG/M,MAAV;;AACA,UAAI26B,oBAAoB,GAAG,UAAUC,GAAV,EAAe;AACxCloC,QAAAA,IAAI,CAACmoC,eAAL,CAAqBhC,GAAG,CAAC+B,GAAG,IAAI7tB,GAAG,CAACtC,KAAZ,CAAxB,EAA4CzZ,EAA5C;AACD,OAFD;;AAGA,UAAI,CAACuM,MAAD,IAAWA,MAAM,CAACgJ,QAAP,KAAoB,CAA/B,IAAoChJ,MAAM,CAACgJ,QAAP,KAAoB,CAA5D,EAA+D;AAC7D;AACD;;AACD,UAAI,CAAChJ,MAAM,CAAC7K,IAAI,CAAC2nC,OAAN,CAAX,EAA2B;AACzBrpC,QAAAA,EAAE,GAAG0B,IAAI,CAACspB,KAAL,EAAL;AACAze,QAAAA,MAAM,CAAC7K,IAAI,CAAC2nC,OAAN,CAAN,GAAuBrpC,EAAvB;AACA0B,QAAAA,IAAI,CAAC0nC,MAAL,CAAYppC,EAAZ,IAAkB,EAAlB;AACD,OAJD,MAIO;AACLA,QAAAA,EAAE,GAAGuM,MAAM,CAAC7K,IAAI,CAAC2nC,OAAN,CAAX;AACD;;AACDl2B,MAAAA,KAAK,GAAGA,KAAK,IAAI5G,MAAjB;AACA,UAAIu9B,SAAS,GAAGxrB,KAAK,CAACpN,KAAN,CAAY,GAAZ,CAAhB;AACA7T,MAAAA,CAAC,GAAGysC,SAAS,CAAC3sC,MAAd;;AACA,aAAOE,CAAC,EAAR,EAAY;AACVpB,QAAAA,IAAI,GAAG6tC,SAAS,CAACzsC,CAAD,CAAhB;AACAqsC,QAAAA,aAAa,GAAGC,oBAAhB;AACAF,QAAAA,QAAQ,GAAGnC,OAAO,GAAG,KAArB;;AACA,YAAIrrC,IAAI,KAAK,kBAAb,EAAiC;AAC/BA,UAAAA,IAAI,GAAG,OAAP;AACD;;AACD,YAAIyF,IAAI,CAACqnC,SAAL,IAAkB9sC,IAAI,KAAK,OAA3B,IAAsCsQ,MAAM,CAAC08B,UAAP,KAAsB,UAAhE,EAA4E;AAC1EniC,UAAAA,QAAQ,CAACpK,IAAT,CAAcyW,KAAd,EAAqB00B,GAAG,CAAC;AAAE1lC,YAAAA,IAAI,EAAElG;AAAR,WAAD,CAAxB;AACA;AACD;;AACD,YAAI,CAACyF,IAAI,CAAC4nC,kBAAV,EAA8B;AAC5BG,UAAAA,QAAQ,GAAG/nC,IAAI,CAACqoC,eAAL,CAAqB9tC,IAArB,CAAX;;AACA,cAAIwtC,QAAJ,EAAc;AACZC,YAAAA,aAAa,GAAG,UAAUE,GAAV,EAAe;AAC7B,kBAAI1+B,OAAO,GAAG0+B,GAAG,CAACI,aAAlB;AACA,kBAAIC,OAAO,GAAGL,GAAG,CAACM,aAAlB;;AACA,kBAAID,OAAO,IAAI/+B,OAAO,CAAC3H,QAAvB,EAAiC;AAC/B0mC,gBAAAA,OAAO,GAAG/+B,OAAO,CAAC3H,QAAR,CAAiB0mC,OAAjB,CAAV;AACD,eAFD,MAEO;AACL,uBAAOA,OAAO,IAAIA,OAAO,KAAK/+B,OAA9B,EAAuC;AACrC++B,kBAAAA,OAAO,GAAGA,OAAO,CAACxyB,UAAlB;AACD;AACF;;AACD,kBAAI,CAACwyB,OAAL,EAAc;AACZL,gBAAAA,GAAG,GAAG/B,GAAG,CAAC+B,GAAG,IAAI7tB,GAAG,CAACtC,KAAZ,CAAT;AACAmwB,gBAAAA,GAAG,CAACznC,IAAJ,GAAWynC,GAAG,CAACznC,IAAJ,KAAa,UAAb,GAA0B,YAA1B,GAAyC,YAApD;AACAynC,gBAAAA,GAAG,CAACr9B,MAAJ,GAAarB,OAAb;AACAxJ,gBAAAA,IAAI,CAACmoC,eAAL,CAAqBD,GAArB,EAA0B5pC,EAA1B;AACD;AACF,aAhBD;AAiBD;AACF;;AACD,YAAI,CAAC0B,IAAI,CAAC6nC,UAAN,KAAqBttC,IAAI,KAAK,SAAT,IAAsBA,IAAI,KAAK,UAApD,CAAJ,EAAqE;AACnEqrC,UAAAA,OAAO,GAAG,IAAV;AACAmC,UAAAA,QAAQ,GAAGxtC,IAAI,KAAK,SAAT,GAAqB,OAArB,GAA+B,MAA1C;;AACAytC,UAAAA,aAAa,GAAG,UAAUE,GAAV,EAAe;AAC7BA,YAAAA,GAAG,GAAG/B,GAAG,CAAC+B,GAAG,IAAI7tB,GAAG,CAACtC,KAAZ,CAAT;AACAmwB,YAAAA,GAAG,CAACznC,IAAJ,GAAWynC,GAAG,CAACznC,IAAJ,KAAa,OAAb,GAAuB,SAAvB,GAAmC,UAA9C;AACAT,YAAAA,IAAI,CAACmoC,eAAL,CAAqBD,GAArB,EAA0B5pC,EAA1B;AACD,WAJD;AAKD;;AACDwpC,QAAAA,YAAY,GAAG9nC,IAAI,CAAC0nC,MAAL,CAAYppC,EAAZ,EAAgB/D,IAAhB,CAAf;;AACA,YAAI,CAACutC,YAAL,EAAmB;AACjB9nC,UAAAA,IAAI,CAAC0nC,MAAL,CAAYppC,EAAZ,EAAgB/D,IAAhB,IAAwButC,YAAY,GAAG,CAAC;AACpCxa,YAAAA,IAAI,EAAEloB,QAD8B;AAEpCqM,YAAAA,KAAK,EAAEA;AAF6B,WAAD,CAAvC;AAIAq2B,UAAAA,YAAY,CAACC,QAAb,GAAwBA,QAAxB;AACAD,UAAAA,YAAY,CAAClC,OAAb,GAAuBA,OAAvB;AACAkC,UAAAA,YAAY,CAACE,aAAb,GAA6BA,aAA7B;;AACA,cAAIztC,IAAI,KAAK,OAAb,EAAsB;AACpB4sC,YAAAA,WAAW,CAACt8B,MAAD,EAASm9B,aAAT,EAAwBhoC,IAAxB,CAAX;AACD,WAFD,MAEO;AACL2lC,YAAAA,QAAQ,CAAC96B,MAAD,EAASk9B,QAAQ,IAAIxtC,IAArB,EAA2BytC,aAA3B,EAA0CpC,OAA1C,CAAR;AACD;AACF,SAbD,MAaO;AACL,cAAIrrC,IAAI,KAAK,OAAT,IAAoByF,IAAI,CAACqnC,SAA7B,EAAwC;AACtCjiC,YAAAA,QAAQ,CAAC+gC,GAAG,CAAC;AAAE1lC,cAAAA,IAAI,EAAElG;AAAR,aAAD,CAAJ,CAAR;AACD,WAFD,MAEO;AACLutC,YAAAA,YAAY,CAACrmC,IAAb,CAAkB;AAChB6rB,cAAAA,IAAI,EAAEloB,QADU;AAEhBqM,cAAAA,KAAK,EAAEA;AAFS,aAAlB;AAID;AACF;AACF;;AACD5G,MAAAA,MAAM,GAAGi9B,YAAY,GAAG,IAAxB;AACA,aAAO1iC,QAAP;AACD,KAzFD;;AA0FAqiC,IAAAA,UAAU,CAACrtC,SAAX,CAAqBquC,MAArB,GAA8B,UAAU59B,MAAV,EAAkB+R,KAAlB,EAAyBxX,QAAzB,EAAmC;AAC/D,UAAI0iC,YAAJ,EAAkBnsC,CAAlB,EAAqB+sC,EAArB,EAAyBnuC,IAAzB,EAA+BouC,QAA/B;;AACA,UAAI,CAAC99B,MAAD,IAAWA,MAAM,CAACgJ,QAAP,KAAoB,CAA/B,IAAoChJ,MAAM,CAACgJ,QAAP,KAAoB,CAA5D,EAA+D;AAC7D,eAAO,IAAP;AACD;;AACD,UAAIvV,EAAE,GAAGuM,MAAM,CAAC,KAAK88B,OAAN,CAAf;;AACA,UAAIrpC,EAAJ,EAAQ;AACNqqC,QAAAA,QAAQ,GAAG,KAAKjB,MAAL,CAAYppC,EAAZ,CAAX;;AACA,YAAIse,KAAJ,EAAW;AACT,cAAIwrB,SAAS,GAAGxrB,KAAK,CAACpN,KAAN,CAAY,GAAZ,CAAhB;AACA7T,UAAAA,CAAC,GAAGysC,SAAS,CAAC3sC,MAAd;;AACA,iBAAOE,CAAC,EAAR,EAAY;AACVpB,YAAAA,IAAI,GAAG6tC,SAAS,CAACzsC,CAAD,CAAhB;AACAmsC,YAAAA,YAAY,GAAGa,QAAQ,CAACpuC,IAAD,CAAvB;;AACA,gBAAIutC,YAAJ,EAAkB;AAChB,kBAAI1iC,QAAJ,EAAc;AACZsjC,gBAAAA,EAAE,GAAGZ,YAAY,CAACrsC,MAAlB;;AACA,uBAAOitC,EAAE,EAAT,EAAa;AACX,sBAAIZ,YAAY,CAACY,EAAD,CAAZ,CAAiBpb,IAAjB,KAA0BloB,QAA9B,EAAwC;AACtC,wBAAI4iC,aAAa,GAAGF,YAAY,CAACE,aAAjC;AACA,wBAAID,QAAQ,GAAGD,YAAY,CAACC,QAA5B;AAAA,wBAAsCnC,OAAO,GAAGkC,YAAY,CAAClC,OAA7D;AACAkC,oBAAAA,YAAY,GAAGA,YAAY,CAAC/sC,KAAb,CAAmB,CAAnB,EAAsB2tC,EAAtB,EAA0BhrC,MAA1B,CAAiCoqC,YAAY,CAAC/sC,KAAb,CAAmB2tC,EAAE,GAAG,CAAxB,CAAjC,CAAf;AACAZ,oBAAAA,YAAY,CAACE,aAAb,GAA6BA,aAA7B;AACAF,oBAAAA,YAAY,CAACC,QAAb,GAAwBA,QAAxB;AACAD,oBAAAA,YAAY,CAAClC,OAAb,GAAuBA,OAAvB;AACA+C,oBAAAA,QAAQ,CAACpuC,IAAD,CAAR,GAAiButC,YAAjB;AACD;AACF;AACF;;AACD,kBAAI,CAAC1iC,QAAD,IAAa0iC,YAAY,CAACrsC,MAAb,KAAwB,CAAzC,EAA4C;AAC1C,uBAAOktC,QAAQ,CAACpuC,IAAD,CAAf;AACAwrC,gBAAAA,WAAW,CAACl7B,MAAD,EAASi9B,YAAY,CAACC,QAAb,IAAyBxtC,IAAlC,EAAwCutC,YAAY,CAACE,aAArD,EAAoEF,YAAY,CAAClC,OAAjF,CAAX;AACD;AACF;AACF;AACF,SA3BD,MA2BO;AACLliC,UAAAA,MAAM,CAACilC,QAAD,EAAW,UAAUb,YAAV,EAAwBvtC,IAAxB,EAA8B;AAC7CwrC,YAAAA,WAAW,CAACl7B,MAAD,EAASi9B,YAAY,CAACC,QAAb,IAAyBxtC,IAAlC,EAAwCutC,YAAY,CAACE,aAArD,EAAoEF,YAAY,CAAClC,OAAjF,CAAX;AACD,WAFK,CAAN;AAGA+C,UAAAA,QAAQ,GAAG,EAAX;AACD;;AACD,aAAKpuC,IAAL,IAAaouC,QAAb,EAAuB;AACrB,cAAIhkC,GAAG,CAACgkC,QAAD,EAAWpuC,IAAX,CAAP,EAAyB;AACvB,mBAAO,IAAP;AACD;AACF;;AACD,eAAO,KAAKmtC,MAAL,CAAYppC,EAAZ,CAAP;;AACA,YAAI;AACF,iBAAOuM,MAAM,CAAC,KAAK88B,OAAN,CAAb;AACD,SAFD,CAEE,OAAO9hB,EAAP,EAAW;AACXhb,UAAAA,MAAM,CAAC,KAAK88B,OAAN,CAAN,GAAuB,IAAvB;AACD;AACF;;AACD,aAAO,IAAP;AACD,KAtDD;;AAuDAF,IAAAA,UAAU,CAACrtC,SAAX,CAAqBwuC,IAArB,GAA4B,UAAU/9B,MAAV,EAAkBtQ,IAAlB,EAAwBmC,IAAxB,EAA8B;AACxD,UAAI4B,EAAJ;;AACA,UAAI,CAACuM,MAAD,IAAWA,MAAM,CAACgJ,QAAP,KAAoB,CAA/B,IAAoChJ,MAAM,CAACgJ,QAAP,KAAoB,CAA5D,EAA+D;AAC7D,eAAO,IAAP;AACD;;AACD,UAAIkE,KAAK,GAAGouB,GAAG,CAAC,IAAD,EAAOzpC,IAAP,CAAf;AACAqb,MAAAA,KAAK,CAACtX,IAAN,GAAalG,IAAb;AACAwd,MAAAA,KAAK,CAAClN,MAAN,GAAeA,MAAf;;AACA,SAAG;AACDvM,QAAAA,EAAE,GAAGuM,MAAM,CAAC,KAAK88B,OAAN,CAAX;;AACA,YAAIrpC,EAAJ,EAAQ;AACN,eAAK6pC,eAAL,CAAqBpwB,KAArB,EAA4BzZ,EAA5B;AACD;;AACDuM,QAAAA,MAAM,GAAGA,MAAM,CAACkL,UAAP,IAAqBlL,MAAM,CAAC6K,aAA5B,IAA6C7K,MAAM,CAACiL,WAApD,IAAmEjL,MAAM,CAACg+B,YAAnF;AACD,OAND,QAMSh+B,MAAM,IAAI,CAACkN,KAAK,CAACgvB,oBAAN,EANpB;;AAOA,aAAO,IAAP;AACD,KAhBD;;AAiBAU,IAAAA,UAAU,CAACrtC,SAAX,CAAqB0uC,KAArB,GAA6B,UAAUj+B,MAAV,EAAkB;AAC7C,UAAIlP,CAAJ,EAAO6a,QAAP;;AACA,UAAI,CAAC3L,MAAD,IAAWA,MAAM,CAACgJ,QAAP,KAAoB,CAA/B,IAAoChJ,MAAM,CAACgJ,QAAP,KAAoB,CAA5D,EAA+D;AAC7D,eAAO,IAAP;AACD;;AACD,UAAIhJ,MAAM,CAAC,KAAK88B,OAAN,CAAV,EAA0B;AACxB,aAAKc,MAAL,CAAY59B,MAAZ;AACD;;AACD,UAAI,CAACA,MAAM,CAACmqB,oBAAZ,EAAkC;AAChCnqB,QAAAA,MAAM,GAAGA,MAAM,CAAC+D,QAAhB;AACD;;AACD,UAAI/D,MAAM,IAAIA,MAAM,CAACmqB,oBAArB,EAA2C;AACzC,aAAKyT,MAAL,CAAY59B,MAAZ;AACA2L,QAAAA,QAAQ,GAAG3L,MAAM,CAACmqB,oBAAP,CAA4B,GAA5B,CAAX;AACAr5B,QAAAA,CAAC,GAAG6a,QAAQ,CAAC/a,MAAb;;AACA,eAAOE,CAAC,EAAR,EAAY;AACVkP,UAAAA,MAAM,GAAG2L,QAAQ,CAAC7a,CAAD,CAAjB;;AACA,cAAIkP,MAAM,CAAC,KAAK88B,OAAN,CAAV,EAA0B;AACxB,iBAAKc,MAAL,CAAY59B,MAAZ;AACD;AACF;AACF;;AACD,aAAO,IAAP;AACD,KAvBD;;AAwBA48B,IAAAA,UAAU,CAACrtC,SAAX,CAAqB2uC,OAArB,GAA+B,YAAY;AACzC,WAAKrB,MAAL,GAAc,EAAd;AACD,KAFD;;AAGAD,IAAAA,UAAU,CAACrtC,SAAX,CAAqB4uC,MAArB,GAA8B,UAAU1iC,CAAV,EAAa;AACzC,UAAIA,CAAJ,EAAO;AACLA,QAAAA,CAAC,CAACqgC,cAAF;AACArgC,QAAAA,CAAC,CAAC0gC,wBAAF;AACD;;AACD,aAAO,KAAP;AACD,KAND;;AAOAS,IAAAA,UAAU,CAACrtC,SAAX,CAAqB+tC,eAArB,GAAuC,UAAUD,GAAV,EAAe5pC,EAAf,EAAmB;AACxD,UAAIyQ,SAAS,GAAG,KAAK24B,MAAL,CAAYppC,EAAZ,CAAhB;AACA,UAAIwpC,YAAY,GAAG/4B,SAAS,IAAIA,SAAS,CAACm5B,GAAG,CAACznC,IAAL,CAAzC;;AACA,UAAIqnC,YAAJ,EAAkB;AAChB,aAAK,IAAInsC,CAAC,GAAG,CAAR,EAAWqJ,CAAC,GAAG8iC,YAAY,CAACrsC,MAAjC,EAAyCE,CAAC,GAAGqJ,CAA7C,EAAgDrJ,CAAC,EAAjD,EAAqD;AACnD,cAAIyJ,QAAQ,GAAG0iC,YAAY,CAACnsC,CAAD,CAA3B;;AACA,cAAIyJ,QAAQ,IAAIA,QAAQ,CAACkoB,IAAT,CAActyB,IAAd,CAAmBoK,QAAQ,CAACqM,KAA5B,EAAmCy2B,GAAnC,MAA4C,KAA5D,EAAmE;AACjEA,YAAAA,GAAG,CAACvB,cAAJ;AACD;;AACD,cAAIuB,GAAG,CAACjB,6BAAJ,EAAJ,EAAyC;AACvC;AACD;AACF;AACF;AACF,KAdD;;AAeAQ,IAAAA,UAAU,CAACwB,KAAX,GAAmB,IAAIxB,UAAJ,EAAnB;AACA,WAAOA,UAAP;AACD,GA/NgB,EAAjB;;AAiOA,MAAIyB,OAAJ;AAAA,MAAaC,IAAb;AAAA,MAAmBC,OAAnB;AAAA,MAA4BC,KAA5B;AAAA,MAAmCC,QAAnC;AAAA,MAA6CC,OAA7C;AAAA,MAAsDC,MAAtD;AAAA,MAA8DC,gBAA9D;AAAA,MAAgFC,SAAhF;AAAA,MAA2FC,YAA3F;AAAA,MAAyGC,WAAzG;AAAA,MAAsHC,UAAtH;AAAA,MAAkIC,OAAlI;AAAA,MAA2IC,cAA3I;AAAA,MAA2JC,SAA3J;AAAA,MAAsKC,aAAtK;AAAA,MAAqLz8B,OAArL;AAAA,MAA8L08B,UAA9L;AAAA,MAA0MvC,OAAO,GAAG,WAAW,CAAC,IAAInY,IAAJ,EAAhO;AAAA,MAA4O2a,YAAY,GAAG78B,MAAM,CAACsB,QAAlQ;AAAA,MAA4Qw7B,OAAO,GAAG,CAAtR;AAAA,MAAyRzkB,IAAI,GAAG,CAAhS;AAAA,MAAmS0kB,UAAU,GAAGC,WAAW,EAA3T;AAAA,MAA+TC,UAAU,GAAGD,WAAW,EAAvV;AAAA,MAA2VE,aAAa,GAAGF,WAAW,EAAtX;AAAA,MAA0XG,SAAS,GAAG,UAAUxtC,CAAV,EAAamD,CAAb,EAAgB;AAClZ,QAAInD,CAAC,KAAKmD,CAAV,EAAa;AACXupC,MAAAA,YAAY,GAAG,IAAf;AACD;;AACD,WAAO,CAAP;AACD,GALH;AAAA,MAKKe,YAAY,GAAG,OAAOzwC,SAL3B;AAAA,MAKsC0wC,YAAY,GAAG,KAAK,EAL1D;AAAA,MAK8Dr5B,MAAM,GAAG,GAAG7N,cAL1E;AAAA,MAK0FtB,GAAG,GAAG,EALhG;AAAA,MAKoGyoC,GAAG,GAAGzoC,GAAG,CAACyoC,GAL9G;AAAA,MAKmHC,WAAW,GAAG1oC,GAAG,CAACV,IALrI;AAAA,MAK2IA,IAAI,GAAGU,GAAG,CAACV,IALtJ;AAAA,MAK4J1G,KAAK,GAAGoH,GAAG,CAACpH,KALxK;AAAA,MAK+K+vC,SAAS,GAAG3oC,GAAG,CAACzH,OAAJ,IAAe,UAAUoZ,IAAV,EAAgB;AACtN,QAAInY,CAAC,GAAG,CAAR;AAAA,QAAWD,GAAG,GAAG,KAAKD,MAAtB;;AACA,WAAOE,CAAC,GAAGD,GAAX,EAAgBC,CAAC,EAAjB,EAAqB;AACnB,UAAI,KAAKA,CAAL,MAAYmY,IAAhB,EAAsB;AACpB,eAAOnY,CAAP;AACD;AACF;;AACD,WAAO,CAAC,CAAR;AACD,GAbH;AAAA,MAaKovC,QAAQ,GAAG,4HAbhB;AAAA,MAa8IC,UAAU,GAAG,qBAb3J;AAAA,MAakLC,UAAU,GAAG,kCAb/L;AAAA,MAamO7rB,UAAU,GAAG,QAAQ4rB,UAAR,GAAqB,IAArB,GAA4BC,UAA5B,GAAyC,MAAzC,GAAkDD,UAAlD,GAA+D,eAA/D,GAAiFA,UAAjF,GAA8F,0DAA9F,GAA2JC,UAA3J,GAAwK,MAAxK,GAAiLD,UAAjL,GAA8L,MAb9a;AAAA,MAasbE,OAAO,GAAG,OAAOD,UAAP,GAAoB,UAApB,GAAiC,uDAAjC,GAA2F,0BAA3F,GAAwH7rB,UAAxH,GAAqI,MAArI,GAA8I,IAA9I,GAAqJ,QAbrlB;AAAA,MAa+lB+rB,KAAK,GAAG,IAAI9N,MAAJ,CAAW,MAAM2N,UAAN,GAAmB,6BAAnB,GAAmDA,UAAnD,GAAgE,IAA3E,EAAiF,GAAjF,CAbvmB;AAAA,MAa8rBI,MAAM,GAAG,IAAI/N,MAAJ,CAAW,MAAM2N,UAAN,GAAmB,IAAnB,GAA0BA,UAA1B,GAAuC,GAAlD,CAbvsB;AAAA,MAa+vBK,YAAY,GAAG,IAAIhO,MAAJ,CAAW,MAAM2N,UAAN,GAAmB,UAAnB,GAAgCA,UAAhC,GAA6C,GAA7C,GAAmDA,UAAnD,GAAgE,GAA3E,CAb9wB;AAAA,MAa+1BM,gBAAgB,GAAG,IAAIjO,MAAJ,CAAW,MAAM2N,UAAN,GAAmB,gBAAnB,GAAsCA,UAAtC,GAAmD,MAA9D,EAAsE,GAAtE,CAbl3B;AAAA,MAa87BO,OAAO,GAAG,IAAIlO,MAAJ,CAAW6N,OAAX,CAbx8B;AAAA,MAa69BM,WAAW,GAAG,IAAInO,MAAJ,CAAW,MAAM4N,UAAN,GAAmB,GAA9B,CAb3+B;AAAA,MAa+gCQ,SAAS,GAAG;AACvhCC,IAAAA,EAAE,EAAE,IAAIrO,MAAJ,CAAW,QAAQ4N,UAAR,GAAqB,GAAhC,CADmhC;AAEvhCU,IAAAA,KAAK,EAAE,IAAItO,MAAJ,CAAW,UAAU4N,UAAV,GAAuB,GAAlC,CAFghC;AAGvhCW,IAAAA,GAAG,EAAE,IAAIvO,MAAJ,CAAW,OAAO4N,UAAP,GAAoB,OAA/B,CAHkhC;AAIvhCY,IAAAA,IAAI,EAAE,IAAIxO,MAAJ,CAAW,MAAMje,UAAjB,CAJihC;AAKvhC0sB,IAAAA,MAAM,EAAE,IAAIzO,MAAJ,CAAW,MAAM6N,OAAjB,CAL+gC;AAMvhCa,IAAAA,KAAK,EAAE,IAAI1O,MAAJ,CAAW,2DAA2D2N,UAA3D,GAAwE,8BAAxE,GAAyGA,UAAzG,GAAsH,aAAtH,GAAsIA,UAAtI,GAAmJ,YAAnJ,GAAkKA,UAAlK,GAA+K,QAA1L,EAAoM,GAApM,CANghC;AAOvhCgB,IAAAA,IAAI,EAAE,IAAI3O,MAAJ,CAAW,SAAS0N,QAAT,GAAoB,IAA/B,EAAqC,GAArC,CAPihC;AAQvhCkB,IAAAA,YAAY,EAAE,IAAI5O,MAAJ,CAAW,MAAM2N,UAAN,GAAmB,kDAAnB,GAAwEA,UAAxE,GAAqF,kBAArF,GAA0GA,UAA1G,GAAuH,kBAAlI,EAAsJ,GAAtJ;AARygC,GAb3hC;AAAA,MAsBKkB,OAAO,GAAG,qCAtBf;AAAA,MAsBsDC,OAAO,GAAG,QAtBhE;AAAA,MAsB0EC,OAAO,GAAG,wBAtBpF;AAAA,MAsB8GC,UAAU,GAAG,kCAtB3H;AAAA,MAsB+JC,QAAQ,GAAG,MAtB1K;AAAA,MAsBkLC,OAAO,GAAG,OAtB5L;AAAA,MAsBqMC,SAAS,GAAG,IAAInP,MAAJ,CAAW,uBAAuB2N,UAAvB,GAAoC,KAApC,GAA4CA,UAA5C,GAAyD,MAApE,EAA4E,IAA5E,CAtBjN;AAAA,MAsBoSyB,SAAS,GAAG,UAAU5iB,CAAV,EAAa6iB,OAAb,EAAsBC,iBAAtB,EAAyC;AACrV,QAAIC,IAAI,GAAG,OAAOF,OAAP,GAAiB,KAA5B;AACA,WAAOE,IAAI,KAAKA,IAAT,IAAiBD,iBAAjB,GAAqCD,OAArC,GAA+CE,IAAI,GAAG,CAAP,GAAWpyC,MAAM,CAACs+B,YAAP,CAAoB8T,IAAI,GAAG,KAA3B,CAAX,GAA+CpyC,MAAM,CAACs+B,YAAP,CAAoB8T,IAAI,IAAI,EAAR,GAAa,KAAjC,EAAwCA,IAAI,GAAG,IAAP,GAAc,KAAtD,CAArG;AACD,GAzBH;;AA0BA,MAAI;AACFnrC,IAAAA,IAAI,CAAC5E,KAAL,CAAWsF,GAAG,GAAGpH,KAAK,CAACC,IAAN,CAAWmvC,YAAY,CAACp4B,UAAxB,CAAjB,EAAsDo4B,YAAY,CAACp4B,UAAnE;AACA5P,IAAAA,GAAG,CAACgoC,YAAY,CAACp4B,UAAb,CAAwBtW,MAAzB,CAAH,CAAoCoY,QAApC;AACD,GAHD,CAGE,OAAOvN,CAAP,EAAU;AACV7E,IAAAA,IAAI,GAAG;AACL5E,MAAAA,KAAK,EAAEsF,GAAG,CAAC1G,MAAJ,GAAa,UAAUoP,MAAV,EAAkBgiC,GAAlB,EAAuB;AACzChC,QAAAA,WAAW,CAAChuC,KAAZ,CAAkBgO,MAAlB,EAA0B9P,KAAK,CAACC,IAAN,CAAW6xC,GAAX,CAA1B;AACD,OAFM,GAEH,UAAUhiC,MAAV,EAAkBgiC,GAAlB,EAAuB;AACzB,YAAIlmC,CAAC,GAAGkE,MAAM,CAACpP,MAAf;AAAA,YAAuBE,CAAC,GAAG,CAA3B;;AACA,eAAOkP,MAAM,CAAClE,CAAC,EAAF,CAAN,GAAckmC,GAAG,CAAClxC,CAAC,EAAF,CAAxB,EAA+B,CAC9B;;AACDkP,QAAAA,MAAM,CAACpP,MAAP,GAAgBkL,CAAC,GAAG,CAApB;AACD;AARI,KAAP;AAUD;;AACD,MAAImmC,MAAM,GAAG,UAAUl5B,QAAV,EAAoBm5B,OAApB,EAA6BC,OAA7B,EAAsCC,IAAtC,EAA4C;AACvD,QAAI98B,KAAJ,EAAW2D,IAAX,EAAiBo5B,CAAjB,EAAoBr5B,QAApB,EAA8BlY,CAA9B,EAAiCwxC,MAAjC,EAAyCC,GAAzC,EAA8CC,GAA9C,EAAmDC,UAAnD,EAA+DC,WAA/D;;AACA,QAAI,CAACR,OAAO,GAAGA,OAAO,CAACr3B,aAAR,IAAyBq3B,OAA5B,GAAsC5C,YAA9C,MAAgEN,UAApE,EAAgF;AAC9ED,MAAAA,WAAW,CAACmD,OAAD,CAAX;AACD;;AACDA,IAAAA,OAAO,GAAGA,OAAO,IAAIlD,UAArB;AACAmD,IAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB;;AACA,QAAI,CAACp5B,QAAD,IAAa,OAAOA,QAAP,KAAoB,QAArC,EAA+C;AAC7C,aAAOo5B,OAAP;AACD;;AACD,QAAI,CAACn5B,QAAQ,GAAGk5B,OAAO,CAACl5B,QAApB,MAAkC,CAAlC,IAAuCA,QAAQ,KAAK,CAAxD,EAA2D;AACzD,aAAO,EAAP;AACD;;AACD,QAAIk2B,cAAc,IAAI,CAACkD,IAAvB,EAA6B;AAC3B,UAAI98B,KAAK,GAAGk8B,UAAU,CAACp8B,IAAX,CAAgB2D,QAAhB,CAAZ,EAAuC;AACrC,YAAIs5B,CAAC,GAAG/8B,KAAK,CAAC,CAAD,CAAb,EAAkB;AAChB,cAAI0D,QAAQ,KAAK,CAAjB,EAAoB;AAClBC,YAAAA,IAAI,GAAGi5B,OAAO,CAACS,cAAR,CAAuBN,CAAvB,CAAP;;AACA,gBAAIp5B,IAAI,IAAIA,IAAI,CAACiC,UAAjB,EAA6B;AAC3B,kBAAIjC,IAAI,CAACxV,EAAL,KAAY4uC,CAAhB,EAAmB;AACjBF,gBAAAA,OAAO,CAACvrC,IAAR,CAAaqS,IAAb;AACA,uBAAOk5B,OAAP;AACD;AACF,aALD,MAKO;AACL,qBAAOA,OAAP;AACD;AACF,WAVD,MAUO;AACL,gBAAID,OAAO,CAACr3B,aAAR,KAA0B5B,IAAI,GAAGi5B,OAAO,CAACr3B,aAAR,CAAsB83B,cAAtB,CAAqCN,CAArC,CAAjC,KAA6EhD,UAAU,CAAC6C,OAAD,EAAUj5B,IAAV,CAAvF,IAA0GA,IAAI,CAACxV,EAAL,KAAY4uC,CAA1H,EAA6H;AAC3HF,cAAAA,OAAO,CAACvrC,IAAR,CAAaqS,IAAb;AACA,qBAAOk5B,OAAP;AACD;AACF;AACF,SAjBD,MAiBO,IAAI78B,KAAK,CAAC,CAAD,CAAT,EAAc;AACnB1O,UAAAA,IAAI,CAAC5E,KAAL,CAAWmwC,OAAX,EAAoBD,OAAO,CAAC/X,oBAAR,CAA6BphB,QAA7B,CAApB;AACA,iBAAOo5B,OAAP;AACD,SAHM,MAGA,IAAI,CAACE,CAAC,GAAG/8B,KAAK,CAAC,CAAD,CAAV,KAAkB+4B,OAAO,CAACuE,sBAA9B,EAAsD;AAC3DhsC,UAAAA,IAAI,CAAC5E,KAAL,CAAWmwC,OAAX,EAAoBD,OAAO,CAACU,sBAAR,CAA+BP,CAA/B,CAApB;AACA,iBAAOF,OAAP;AACD;AACF;;AACD,UAAI9D,OAAO,CAACwE,GAAR,KAAgB,CAAC1D,SAAD,IAAc,CAACA,SAAS,CAAC1iC,IAAV,CAAesM,QAAf,CAA/B,CAAJ,EAA8D;AAC5Dy5B,QAAAA,GAAG,GAAGD,GAAG,GAAGzF,OAAZ;AACA2F,QAAAA,UAAU,GAAGP,OAAb;AACAQ,QAAAA,WAAW,GAAG15B,QAAQ,KAAK,CAAb,IAAkBD,QAAhC;;AACA,YAAIC,QAAQ,KAAK,CAAb,IAAkBk5B,OAAO,CAAC73B,QAAR,CAAiBpM,WAAjB,OAAmC,QAAzD,EAAmE;AACjEqkC,UAAAA,MAAM,GAAG7D,QAAQ,CAAC11B,QAAD,CAAjB;;AACA,cAAIw5B,GAAG,GAAGL,OAAO,CAACxvB,YAAR,CAAqB,IAArB,CAAV,EAAsC;AACpC8vB,YAAAA,GAAG,GAAGD,GAAG,CAAC3kC,OAAJ,CAAY8jC,OAAZ,EAAqB,MAArB,CAAN;AACD,WAFD,MAEO;AACLQ,YAAAA,OAAO,CAACpuB,YAAR,CAAqB,IAArB,EAA2B0uB,GAA3B;AACD;;AACDA,UAAAA,GAAG,GAAG,WAAWA,GAAX,GAAiB,MAAvB;AACA1xC,UAAAA,CAAC,GAAGwxC,MAAM,CAAC1xC,MAAX;;AACA,iBAAOE,CAAC,EAAR,EAAY;AACVwxC,YAAAA,MAAM,CAACxxC,CAAD,CAAN,GAAY0xC,GAAG,GAAGM,UAAU,CAACR,MAAM,CAACxxC,CAAD,CAAP,CAA5B;AACD;;AACD2xC,UAAAA,UAAU,GAAGhB,QAAQ,CAAChlC,IAAT,CAAcsM,QAAd,KAA2Bg6B,WAAW,CAACb,OAAO,CAACh3B,UAAT,CAAtC,IAA8Dg3B,OAA3E;AACAQ,UAAAA,WAAW,GAAGJ,MAAM,CAACniB,IAAP,CAAY,GAAZ,CAAd;AACD;;AACD,YAAIuiB,WAAJ,EAAiB;AACf,cAAI;AACF9rC,YAAAA,IAAI,CAAC5E,KAAL,CAAWmwC,OAAX,EAAoBM,UAAU,CAACj5B,gBAAX,CAA4Bk5B,WAA5B,CAApB;AACA,mBAAOP,OAAP;AACD,WAHD,CAGE,OAAOa,QAAP,EAAiB,CAClB,CAJD,SAIU;AACR,gBAAI,CAACT,GAAL,EAAU;AACRL,cAAAA,OAAO,CAAC5tB,eAAR,CAAwB,IAAxB;AACD;AACF;AACF;AACF;AACF;;AACD,WAAOqqB,MAAM,CAAC51B,QAAQ,CAACnL,OAAT,CAAiB0iC,KAAjB,EAAwB,IAAxB,CAAD,EAAgC4B,OAAhC,EAAyCC,OAAzC,EAAkDC,IAAlD,CAAb;AACD,GAzED;;AA0EA,WAAS3C,WAAT,GAAuB;AACrB,QAAItuC,IAAI,GAAG,EAAX;;AACA,aAASgtB,KAAT,CAAetkB,GAAf,EAAoBvH,KAApB,EAA2B;AACzB,UAAInB,IAAI,CAACyF,IAAL,CAAUiD,GAAG,GAAG,GAAhB,IAAuBykC,IAAI,CAAC2E,WAAhC,EAA6C;AAC3C,eAAO9kB,KAAK,CAAChtB,IAAI,CAAC+xC,KAAL,EAAD,CAAZ;AACD;;AACD,aAAO/kB,KAAK,CAACtkB,GAAG,GAAG,GAAP,CAAL,GAAmBvH,KAA1B;AACD;;AACD,WAAO6rB,KAAP;AACD;;AACD,WAASglB,YAAT,CAAsB1wC,EAAtB,EAA0B;AACxBA,IAAAA,EAAE,CAACqqC,OAAD,CAAF,GAAc,IAAd;AACA,WAAOrqC,EAAP;AACD;;AACD,WAAS2wC,YAAT,CAAsBhxC,CAAtB,EAAyBmD,CAAzB,EAA4B;AAC1B,QAAI4S,GAAG,GAAG5S,CAAC,IAAInD,CAAf;AAAA,QAAkBixC,IAAI,GAAGl7B,GAAG,IAAI/V,CAAC,CAAC4W,QAAF,KAAe,CAAtB,IAA2BzT,CAAC,CAACyT,QAAF,KAAe,CAA1C,IAA+C,CAAC,CAACzT,CAAC,CAAC+tC,WAAH,IAAkBxD,YAAnB,KAAoC,CAAC1tC,CAAC,CAACkxC,WAAH,IAAkBxD,YAAtD,CAAxE;;AACA,QAAIuD,IAAJ,EAAU;AACR,aAAOA,IAAP;AACD;;AACD,QAAIl7B,GAAJ,EAAS;AACP,aAAOA,GAAG,GAAGA,GAAG,CAAC2D,WAAjB,EAA8B;AAC5B,YAAI3D,GAAG,KAAK5S,CAAZ,EAAe;AACb,iBAAO,CAAC,CAAR;AACD;AACF;AACF;;AACD,WAAOnD,CAAC,GAAG,CAAH,GAAO,CAAC,CAAhB;AACD;;AACD,WAASmxC,iBAAT,CAA2B3tC,IAA3B,EAAiC;AAC/B,WAAO,UAAUqT,IAAV,EAAgB;AACrB,UAAIvZ,IAAI,GAAGuZ,IAAI,CAACoB,QAAL,CAAcpM,WAAd,EAAX;AACA,aAAOvO,IAAI,KAAK,OAAT,IAAoBuZ,IAAI,CAACrT,IAAL,KAAcA,IAAzC;AACD,KAHD;AAID;;AACD,WAAS4tC,kBAAT,CAA4B5tC,IAA5B,EAAkC;AAChC,WAAO,UAAUqT,IAAV,EAAgB;AACrB,UAAIvZ,IAAI,GAAGuZ,IAAI,CAACoB,QAAL,CAAcpM,WAAd,EAAX;AACA,aAAO,CAACvO,IAAI,KAAK,OAAT,IAAoBA,IAAI,KAAK,QAA9B,KAA2CuZ,IAAI,CAACrT,IAAL,KAAcA,IAAhE;AACD,KAHD;AAID;;AACD,WAAS6tC,sBAAT,CAAgChxC,EAAhC,EAAoC;AAClC,WAAO0wC,YAAY,CAAC,UAAUO,QAAV,EAAoB;AACtCA,MAAAA,QAAQ,GAAG,CAACA,QAAZ;AACA,aAAOP,YAAY,CAAC,UAAUf,IAAV,EAAgBz/B,OAAhB,EAAyB;AAC3C,YAAI7G,CAAJ;AAAA,YAAO6nC,YAAY,GAAGlxC,EAAE,CAAC,EAAD,EAAK2vC,IAAI,CAACxxC,MAAV,EAAkB8yC,QAAlB,CAAxB;AAAA,YAAqD5yC,CAAC,GAAG6yC,YAAY,CAAC/yC,MAAtE;;AACA,eAAOE,CAAC,EAAR,EAAY;AACV,cAAIsxC,IAAI,CAACtmC,CAAC,GAAG6nC,YAAY,CAAC7yC,CAAD,CAAjB,CAAR,EAA+B;AAC7BsxC,YAAAA,IAAI,CAACtmC,CAAD,CAAJ,GAAU,EAAE6G,OAAO,CAAC7G,CAAD,CAAP,GAAasmC,IAAI,CAACtmC,CAAD,CAAnB,CAAV;AACD;AACF;AACF,OAPkB,CAAnB;AAQD,KAVkB,CAAnB;AAWD;;AACD,WAASinC,WAAT,CAAqBb,OAArB,EAA8B;AAC5B,WAAOA,OAAO,IAAI,OAAOA,OAAO,CAAC/X,oBAAf,KAAwC0V,YAAnD,IAAmEqC,OAA1E;AACD;;AACD7D,EAAAA,OAAO,GAAG4D,MAAM,CAAC5D,OAAP,GAAiB,EAA3B;;AACAG,EAAAA,KAAK,GAAGyD,MAAM,CAACzD,KAAP,GAAe,UAAUv1B,IAAV,EAAgB;AACrC,QAAI+B,eAAe,GAAG/B,IAAI,IAAI,CAACA,IAAI,CAAC4B,aAAL,IAAsB5B,IAAvB,EAA6B+B,eAA3D;AACA,WAAOA,eAAe,GAAGA,eAAe,CAACX,QAAhB,KAA6B,MAAhC,GAAyC,KAA/D;AACD,GAHD;;AAIA00B,EAAAA,WAAW,GAAGkD,MAAM,CAAClD,WAAP,GAAqB,UAAUv3B,IAAV,EAAgB;AACjD,QAAIo8B,UAAJ;AAAA,QAAgB/8B,GAAG,GAAGW,IAAI,GAAGA,IAAI,CAACqD,aAAL,IAAsBrD,IAAzB,GAAgC83B,YAA1D;AAAA,QAAwE15B,MAAM,GAAGiB,GAAG,CAACoE,WAArF;;AACA,aAAS44B,MAAT,CAAgBr0B,GAAhB,EAAqB;AACnB,UAAI;AACF,eAAOA,GAAG,CAACR,GAAX;AACD,OAFD,CAEE,OAAOgM,EAAP,EAAW,CACZ;;AACD,aAAO,IAAP;AACD;;AACD,QAAInU,GAAG,KAAKm4B,UAAR,IAAsBn4B,GAAG,CAACmC,QAAJ,KAAiB,CAAvC,IAA4C,CAACnC,GAAG,CAACmE,eAArD,EAAsE;AACpE,aAAOg0B,UAAP;AACD;;AACDA,IAAAA,UAAU,GAAGn4B,GAAb;AACAo4B,IAAAA,OAAO,GAAGp4B,GAAG,CAACmE,eAAd;AACAk0B,IAAAA,cAAc,GAAG,CAACV,KAAK,CAAC33B,GAAD,CAAvB;;AACA,QAAIjB,MAAM,IAAIA,MAAM,KAAKi+B,MAAM,CAACj+B,MAAD,CAA/B,EAAyC;AACvC,UAAIA,MAAM,CAACo1B,gBAAX,EAA6B;AAC3Bp1B,QAAAA,MAAM,CAACo1B,gBAAP,CAAwB,QAAxB,EAAkC,YAAY;AAC5C+D,UAAAA,WAAW;AACZ,SAFD,EAEG,KAFH;AAGD,OAJD,MAIO,IAAIn5B,MAAM,CAACq1B,WAAX,EAAwB;AAC7Br1B,QAAAA,MAAM,CAACq1B,WAAP,CAAmB,UAAnB,EAA+B,YAAY;AACzC8D,UAAAA,WAAW;AACZ,SAFD;AAGD;AACF;;AACDV,IAAAA,OAAO,CAAC9pB,UAAR,GAAqB,IAArB;AACA8pB,IAAAA,OAAO,CAAClU,oBAAR,GAA+B,IAA/B;AACAkU,IAAAA,OAAO,CAACuE,sBAAR,GAAiCrB,OAAO,CAAC9kC,IAAR,CAAaoK,GAAG,CAAC+7B,sBAAjB,CAAjC;AACAvE,IAAAA,OAAO,CAACyF,OAAR,GAAkB,IAAlB;;AACAxF,IAAAA,IAAI,CAAC1mC,IAAL,CAAUipC,EAAV,GAAe,UAAUptC,EAAV,EAAcyuC,OAAd,EAAuB;AACpC,UAAI,OAAOA,OAAO,CAACS,cAAf,KAAkC9C,YAAlC,IAAkDX,cAAtD,EAAsE;AACpE,YAAImD,CAAC,GAAGH,OAAO,CAACS,cAAR,CAAuBlvC,EAAvB,CAAR;AACA,eAAO4uC,CAAC,IAAIA,CAAC,CAACn3B,UAAP,GAAoB,CAACm3B,CAAD,CAApB,GAA0B,EAAjC;AACD;AACF,KALD;;AAMA/D,IAAAA,IAAI,CAAC1pC,MAAL,CAAYisC,EAAZ,GAAiB,UAAUptC,EAAV,EAAc;AAC7B,UAAIswC,MAAM,GAAGtwC,EAAE,CAACmK,OAAH,CAAW+jC,SAAX,EAAsBC,SAAtB,CAAb;AACA,aAAO,UAAU34B,IAAV,EAAgB;AACrB,eAAOA,IAAI,CAACyJ,YAAL,CAAkB,IAAlB,MAA4BqxB,MAAnC;AACD,OAFD;AAGD,KALD;;AAMAzF,IAAAA,IAAI,CAAC1mC,IAAL,CAAUmpC,GAAV,GAAgB1C,OAAO,CAAClU,oBAAR,GAA+B,UAAU5iB,GAAV,EAAe26B,OAAf,EAAwB;AACrE,UAAI,OAAOA,OAAO,CAAC/X,oBAAf,KAAwC0V,YAA5C,EAA0D;AACxD,eAAOqC,OAAO,CAAC/X,oBAAR,CAA6B5iB,GAA7B,CAAP;AACD;AACF,KAJe,GAIZ,UAAUA,GAAV,EAAe26B,OAAf,EAAwB;AAC1B,UAAIj5B,IAAJ;AAAA,UAAU+6B,GAAG,GAAG,EAAhB;AAAA,UAAoBlzC,CAAC,GAAG,CAAxB;AAAA,UAA2BqxC,OAAO,GAAGD,OAAO,CAAC/X,oBAAR,CAA6B5iB,GAA7B,CAArC;;AACA,UAAIA,GAAG,KAAK,GAAZ,EAAiB;AACf,eAAO0B,IAAI,GAAGk5B,OAAO,CAACrxC,CAAC,EAAF,CAArB,EAA4B;AAC1B,cAAImY,IAAI,CAACD,QAAL,KAAkB,CAAtB,EAAyB;AACvBg7B,YAAAA,GAAG,CAACptC,IAAJ,CAASqS,IAAT;AACD;AACF;;AACD,eAAO+6B,GAAP;AACD;;AACD,aAAO7B,OAAP;AACD,KAfD;;AAgBA7D,IAAAA,IAAI,CAAC1mC,IAAL,CAAUkpC,KAAV,GAAkBzC,OAAO,CAACuE,sBAAR,IAAkC,UAAUqB,SAAV,EAAqB/B,OAArB,EAA8B;AAChF,UAAIhD,cAAJ,EAAoB;AAClB,eAAOgD,OAAO,CAACU,sBAAR,CAA+BqB,SAA/B,CAAP;AACD;AACF,KAJD;;AAKA7E,IAAAA,aAAa,GAAG,EAAhB;AACAD,IAAAA,SAAS,GAAG,EAAZ;AACAd,IAAAA,OAAO,CAAC6F,iBAAR,GAA4B,IAA5B;AACA/E,IAAAA,SAAS,GAAGA,SAAS,CAACvuC,MAAV,IAAoB,IAAI4hC,MAAJ,CAAW2M,SAAS,CAAChf,IAAV,CAAe,GAAf,CAAX,CAAhC;AACAif,IAAAA,aAAa,GAAGA,aAAa,CAACxuC,MAAd,IAAwB,IAAI4hC,MAAJ,CAAW4M,aAAa,CAACjf,IAAd,CAAmB,GAAnB,CAAX,CAAxC;AACAyjB,IAAAA,UAAU,GAAGrC,OAAO,CAAC9kC,IAAR,CAAawiC,OAAO,CAAC72B,uBAArB,CAAb;AACAi3B,IAAAA,UAAU,GAAGuE,UAAU,IAAIrC,OAAO,CAAC9kC,IAAR,CAAawiC,OAAO,CAACjoC,QAArB,CAAd,GAA+C,UAAU5E,CAAV,EAAamD,CAAb,EAAgB;AAC1E,UAAI4uC,KAAK,GAAG/xC,CAAC,CAAC4W,QAAF,KAAe,CAAf,GAAmB5W,CAAC,CAAC4Y,eAArB,GAAuC5Y,CAAnD;AAAA,UAAsDgyC,GAAG,GAAG7uC,CAAC,IAAIA,CAAC,CAAC2V,UAAnE;AACA,aAAO9Y,CAAC,KAAKgyC,GAAN,IAAa,CAAC,EAAEA,GAAG,IAAIA,GAAG,CAACp7B,QAAJ,KAAiB,CAAxB,KAA8Bm7B,KAAK,CAACntC,QAAN,GAAiBmtC,KAAK,CAACntC,QAAN,CAAeotC,GAAf,CAAjB,GAAuChyC,CAAC,CAACgW,uBAAF,IAA6BhW,CAAC,CAACgW,uBAAF,CAA0Bg8B,GAA1B,IAAiC,EAAnI,CAAF,CAArB;AACD,KAHY,GAGT,UAAUhyC,CAAV,EAAamD,CAAb,EAAgB;AAClB,UAAIA,CAAJ,EAAO;AACL,eAAOA,CAAC,GAAGA,CAAC,CAAC2V,UAAb,EAAyB;AACvB,cAAI3V,CAAC,KAAKnD,CAAV,EAAa;AACX,mBAAO,IAAP;AACD;AACF;AACF;;AACD,aAAO,KAAP;AACD,KAZD;AAaAwtC,IAAAA,SAAS,GAAGgE,UAAU,GAAG,UAAUxxC,CAAV,EAAamD,CAAb,EAAgB;AACvC,UAAInD,CAAC,KAAKmD,CAAV,EAAa;AACXupC,QAAAA,YAAY,GAAG,IAAf;AACA,eAAO,CAAP;AACD;;AACD,UAAIuF,OAAO,GAAG,CAACjyC,CAAC,CAACgW,uBAAH,GAA6B,CAAC7S,CAAC,CAAC6S,uBAA9C;;AACA,UAAIi8B,OAAJ,EAAa;AACX,eAAOA,OAAP;AACD;;AACDA,MAAAA,OAAO,GAAG,CAACjyC,CAAC,CAACyY,aAAF,IAAmBzY,CAApB,OAA4BmD,CAAC,CAACsV,aAAF,IAAmBtV,CAA/C,IAAoDnD,CAAC,CAACgW,uBAAF,CAA0B7S,CAA1B,CAApD,GAAmF,CAA7F;;AACA,UAAI8uC,OAAO,GAAG,CAAV,IAAe,CAAChG,OAAO,CAACiG,YAAT,IAAyB/uC,CAAC,CAAC6S,uBAAF,CAA0BhW,CAA1B,MAAiCiyC,OAA7E,EAAsF;AACpF,YAAIjyC,CAAC,KAAKyU,GAAN,IAAazU,CAAC,CAACyY,aAAF,KAAoBy0B,YAApB,IAAoCD,UAAU,CAACC,YAAD,EAAeltC,CAAf,CAA/D,EAAkF;AAChF,iBAAO,CAAC,CAAR;AACD;;AACD,YAAImD,CAAC,KAAKsR,GAAN,IAAatR,CAAC,CAACsV,aAAF,KAAoBy0B,YAApB,IAAoCD,UAAU,CAACC,YAAD,EAAe/pC,CAAf,CAA/D,EAAkF;AAChF,iBAAO,CAAP;AACD;;AACD,eAAOspC,SAAS,GAAGoB,SAAS,CAAC9vC,IAAV,CAAe0uC,SAAf,EAA0BzsC,CAA1B,IAA+B6tC,SAAS,CAAC9vC,IAAV,CAAe0uC,SAAf,EAA0BtpC,CAA1B,CAAlC,GAAiE,CAAjF;AACD;;AACD,aAAO8uC,OAAO,GAAG,CAAV,GAAc,CAAC,CAAf,GAAmB,CAA1B;AACD,KApBqB,GAoBlB,UAAUjyC,CAAV,EAAamD,CAAb,EAAgB;AAClB,UAAInD,CAAC,KAAKmD,CAAV,EAAa;AACXupC,QAAAA,YAAY,GAAG,IAAf;AACA,eAAO,CAAP;AACD;;AACD,UAAI32B,GAAJ;AAAA,UAASrX,CAAC,GAAG,CAAb;AAAA,UAAgByzC,GAAG,GAAGnyC,CAAC,CAAC8Y,UAAxB;AAAA,UAAoCk5B,GAAG,GAAG7uC,CAAC,CAAC2V,UAA5C;AAAA,UAAwDs5B,EAAE,GAAG,CAACpyC,CAAD,CAA7D;AAAA,UAAkEqyC,EAAE,GAAG,CAAClvC,CAAD,CAAvE;;AACA,UAAI,CAACgvC,GAAD,IAAQ,CAACH,GAAb,EAAkB;AAChB,eAAOhyC,CAAC,KAAKyU,GAAN,GAAY,CAAC,CAAb,GAAiBtR,CAAC,KAAKsR,GAAN,GAAY,CAAZ,GAAgB09B,GAAG,GAAG,CAAC,CAAJ,GAAQH,GAAG,GAAG,CAAH,GAAOvF,SAAS,GAAGoB,SAAS,CAAC9vC,IAAV,CAAe0uC,SAAf,EAA0BzsC,CAA1B,IAA+B6tC,SAAS,CAAC9vC,IAAV,CAAe0uC,SAAf,EAA0BtpC,CAA1B,CAAlC,GAAiE,CAAvI;AACD,OAFD,MAEO,IAAIgvC,GAAG,KAAKH,GAAZ,EAAiB;AACtB,eAAOhB,YAAY,CAAChxC,CAAD,EAAImD,CAAJ,CAAnB;AACD;;AACD4S,MAAAA,GAAG,GAAG/V,CAAN;;AACA,aAAO+V,GAAG,GAAGA,GAAG,CAAC+C,UAAjB,EAA6B;AAC3Bs5B,QAAAA,EAAE,CAACE,OAAH,CAAWv8B,GAAX;AACD;;AACDA,MAAAA,GAAG,GAAG5S,CAAN;;AACA,aAAO4S,GAAG,GAAGA,GAAG,CAAC+C,UAAjB,EAA6B;AAC3Bu5B,QAAAA,EAAE,CAACC,OAAH,CAAWv8B,GAAX;AACD;;AACD,aAAOq8B,EAAE,CAAC1zC,CAAD,CAAF,KAAU2zC,EAAE,CAAC3zC,CAAD,CAAnB,EAAwB;AACtBA,QAAAA,CAAC;AACF;;AACD,aAAOA,CAAC,GAAGsyC,YAAY,CAACoB,EAAE,CAAC1zC,CAAD,CAAH,EAAQ2zC,EAAE,CAAC3zC,CAAD,CAAV,CAAf,GAAgC0zC,EAAE,CAAC1zC,CAAD,CAAF,KAAUwuC,YAAV,GAAyB,CAAC,CAA1B,GAA8BmF,EAAE,CAAC3zC,CAAD,CAAF,KAAUwuC,YAAV,GAAyB,CAAzB,GAA6B,CAAnG;AACD,KA3CD;AA4CA,WAAOz4B,GAAP;AACD,GA/HD;;AAgIAo7B,EAAAA,MAAM,CAACt/B,OAAP,GAAiB,UAAUgiC,IAAV,EAAgBj5B,QAAhB,EAA0B;AACzC,WAAOu2B,MAAM,CAAC0C,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmBj5B,QAAnB,CAAb;AACD,GAFD;;AAGAu2B,EAAAA,MAAM,CAAC2C,eAAP,GAAyB,UAAU37B,IAAV,EAAgB07B,IAAhB,EAAsB;AAC7C,QAAI,CAAC17B,IAAI,CAAC4B,aAAL,IAAsB5B,IAAvB,MAAiC+1B,UAArC,EAAiD;AAC/CD,MAAAA,WAAW,CAAC91B,IAAD,CAAX;AACD;;AACD07B,IAAAA,IAAI,GAAGA,IAAI,CAAC/mC,OAAL,CAAa6iC,gBAAb,EAA+B,UAA/B,CAAP;;AACA,QAAIpC,OAAO,CAACuG,eAAR,IAA2B1F,cAA3B,KAA8C,CAACE,aAAD,IAAkB,CAACA,aAAa,CAAC3iC,IAAd,CAAmBkoC,IAAnB,CAAjE,MAA+F,CAACxF,SAAD,IAAc,CAACA,SAAS,CAAC1iC,IAAV,CAAekoC,IAAf,CAA9G,CAAJ,EAAyI;AACvI,UAAI;AACF,YAAIr5B,GAAG,GAAG3I,OAAO,CAACxS,IAAR,CAAa8Y,IAAb,EAAmB07B,IAAnB,CAAV;;AACA,YAAIr5B,GAAG,IAAI+yB,OAAO,CAAC6F,iBAAf,IAAoCj7B,IAAI,CAAClF,QAAL,IAAiBkF,IAAI,CAAClF,QAAL,CAAciF,QAAd,KAA2B,EAApF,EAAwF;AACtF,iBAAOsC,GAAP;AACD;AACF,OALD,CAKE,OAAO7P,CAAP,EAAU,CACX;AACF;;AACD,WAAOwmC,MAAM,CAAC0C,IAAD,EAAO3F,UAAP,EAAmB,IAAnB,EAAyB,CAAC/1B,IAAD,CAAzB,CAAN,CAAuCrY,MAAvC,GAAgD,CAAvD;AACD,GAfD;;AAgBAqxC,EAAAA,MAAM,CAACjrC,QAAP,GAAkB,UAAUkrC,OAAV,EAAmBj5B,IAAnB,EAAyB;AACzC,QAAI,CAACi5B,OAAO,CAACr3B,aAAR,IAAyBq3B,OAA1B,MAAuClD,UAA3C,EAAuD;AACrDD,MAAAA,WAAW,CAACmD,OAAD,CAAX;AACD;;AACD,WAAO7C,UAAU,CAAC6C,OAAD,EAAUj5B,IAAV,CAAjB;AACD,GALD;;AAMAg5B,EAAAA,MAAM,CAACztB,IAAP,GAAc,UAAUvL,IAAV,EAAgBvZ,IAAhB,EAAsB;AAClC,QAAI,CAACuZ,IAAI,CAAC4B,aAAL,IAAsB5B,IAAvB,MAAiC+1B,UAArC,EAAiD;AAC/CD,MAAAA,WAAW,CAAC91B,IAAD,CAAX;AACD;;AACD,QAAIxW,EAAE,GAAG6rC,IAAI,CAACuG,UAAL,CAAgBn1C,IAAI,CAACuO,WAAL,EAAhB,CAAT;AAAA,QAA8Cmd,GAAG,GAAG3oB,EAAE,IAAIgU,MAAM,CAACtW,IAAP,CAAYmuC,IAAI,CAACuG,UAAjB,EAA6Bn1C,IAAI,CAACuO,WAAL,EAA7B,CAAN,GAAyDxL,EAAE,CAACwW,IAAD,EAAOvZ,IAAP,EAAa,CAACwvC,cAAd,CAA3D,GAA2F9vC,SAA/I;AACA,WAAOgsB,GAAG,KAAKhsB,SAAR,GAAoBgsB,GAApB,GAA0BijB,OAAO,CAAC9pB,UAAR,IAAsB,CAAC2qB,cAAvB,GAAwCj2B,IAAI,CAACyJ,YAAL,CAAkBhjB,IAAlB,CAAxC,GAAkE,CAAC0rB,GAAG,GAAGnS,IAAI,CAAC67B,gBAAL,CAAsBp1C,IAAtB,CAAP,KAAuC0rB,GAAG,CAAC2pB,SAA3C,GAAuD3pB,GAAG,CAAC9oB,KAA3D,GAAmE,IAAtK;AACD,GAND;;AAOA2vC,EAAAA,MAAM,CAAC76B,KAAP,GAAe,UAAUpU,GAAV,EAAe;AAC5B,UAAM,IAAIC,KAAJ,CAAU,4CAA4CD,GAAtD,CAAN;AACD,GAFD;;AAGAivC,EAAAA,MAAM,CAAC+C,UAAP,GAAoB,UAAU7C,OAAV,EAAmB;AACrC,QAAIl5B,IAAJ;AAAA,QAAUg8B,UAAU,GAAG,EAAvB;AAAA,QAA2BnpC,CAAC,GAAG,CAA/B;AAAA,QAAkChL,CAAC,GAAG,CAAtC;AACAguC,IAAAA,YAAY,GAAG,CAACT,OAAO,CAAC6G,gBAAxB;AACArG,IAAAA,SAAS,GAAG,CAACR,OAAO,CAAC8G,UAAT,IAAuBhD,OAAO,CAACjyC,KAAR,CAAc,CAAd,CAAnC;AACAiyC,IAAAA,OAAO,CAACryC,IAAR,CAAa8vC,SAAb;;AACA,QAAId,YAAJ,EAAkB;AAChB,aAAO71B,IAAI,GAAGk5B,OAAO,CAACrxC,CAAC,EAAF,CAArB,EAA4B;AAC1B,YAAImY,IAAI,KAAKk5B,OAAO,CAACrxC,CAAD,CAApB,EAAyB;AACvBgL,UAAAA,CAAC,GAAGmpC,UAAU,CAACruC,IAAX,CAAgB9F,CAAhB,CAAJ;AACD;AACF;;AACD,aAAOgL,CAAC,EAAR,EAAY;AACVqmC,QAAAA,OAAO,CAACtO,MAAR,CAAeoR,UAAU,CAACnpC,CAAD,CAAzB,EAA8B,CAA9B;AACD;AACF;;AACD+iC,IAAAA,SAAS,GAAG,IAAZ;AACA,WAAOsD,OAAP;AACD,GAjBD;;AAkBA5D,EAAAA,OAAO,GAAG0D,MAAM,CAAC1D,OAAP,GAAiB,UAAUt1B,IAAV,EAAgB;AACzC,QAAIzB,IAAJ;AAAA,QAAU8D,GAAG,GAAG,EAAhB;AAAA,QAAoBxa,CAAC,GAAG,CAAxB;AAAA,QAA2BkY,QAAQ,GAAGC,IAAI,CAACD,QAA3C;;AACA,QAAI,CAACA,QAAL,EAAe;AACb,aAAOxB,IAAI,GAAGyB,IAAI,CAACnY,CAAC,EAAF,CAAlB,EAAyB;AACvBwa,QAAAA,GAAG,IAAIizB,OAAO,CAAC/2B,IAAD,CAAd;AACD;AACF,KAJD,MAIO,IAAIwB,QAAQ,KAAK,CAAb,IAAkBA,QAAQ,KAAK,CAA/B,IAAoCA,QAAQ,KAAK,EAArD,EAAyD;AAC9D,UAAI,OAAOC,IAAI,CAACsF,WAAZ,KAA4B,QAAhC,EAA0C;AACxC,eAAOtF,IAAI,CAACsF,WAAZ;AACD,OAFD,MAEO;AACL,aAAKtF,IAAI,GAAGA,IAAI,CAACkD,UAAjB,EAA6BlD,IAA7B,EAAmCA,IAAI,GAAGA,IAAI,CAAC6C,WAA/C,EAA4D;AAC1DR,UAAAA,GAAG,IAAIizB,OAAO,CAACt1B,IAAD,CAAd;AACD;AACF;AACF,KARM,MAQA,IAAID,QAAQ,KAAK,CAAb,IAAkBA,QAAQ,KAAK,CAAnC,EAAsC;AAC3C,aAAOC,IAAI,CAACm8B,SAAZ;AACD;;AACD,WAAO95B,GAAP;AACD,GAlBD;;AAmBAgzB,EAAAA,IAAI,GAAG2D,MAAM,CAACoD,SAAP,GAAmB;AACxBpC,IAAAA,WAAW,EAAE,EADW;AAExBqC,IAAAA,YAAY,EAAEnC,YAFU;AAGxB79B,IAAAA,KAAK,EAAEs7B,SAHiB;AAIxBiE,IAAAA,UAAU,EAAE,EAJY;AAKxBjtC,IAAAA,IAAI,EAAE,EALkB;AAMxB2tC,IAAAA,QAAQ,EAAE;AACR,WAAK;AACHhsB,QAAAA,GAAG,EAAE,YADF;AAEHisB,QAAAA,KAAK,EAAE;AAFJ,OADG;AAKR,WAAK;AAAEjsB,QAAAA,GAAG,EAAE;AAAP,OALG;AAMR,WAAK;AACHA,QAAAA,GAAG,EAAE,iBADF;AAEHisB,QAAAA,KAAK,EAAE;AAFJ,OANG;AAUR,WAAK;AAAEjsB,QAAAA,GAAG,EAAE;AAAP;AAVG,KANc;AAkBxBksB,IAAAA,SAAS,EAAE;AACTzE,MAAAA,IAAI,EAAE,UAAU17B,KAAV,EAAiB;AACrBA,QAAAA,KAAK,CAAC,CAAD,CAAL,GAAWA,KAAK,CAAC,CAAD,CAAL,CAAS1H,OAAT,CAAiB+jC,SAAjB,EAA4BC,SAA5B,CAAX;AACAt8B,QAAAA,KAAK,CAAC,CAAD,CAAL,GAAW,CAACA,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAAjB,IAAwBA,KAAK,CAAC,CAAD,CAA7B,IAAoC,EAArC,EAAyC1H,OAAzC,CAAiD+jC,SAAjD,EAA4DC,SAA5D,CAAX;;AACA,YAAIt8B,KAAK,CAAC,CAAD,CAAL,KAAa,IAAjB,EAAuB;AACrBA,UAAAA,KAAK,CAAC,CAAD,CAAL,GAAW,MAAMA,KAAK,CAAC,CAAD,CAAX,GAAiB,GAA5B;AACD;;AACD,eAAOA,KAAK,CAACpV,KAAN,CAAY,CAAZ,EAAe,CAAf,CAAP;AACD,OARQ;AASTgxC,MAAAA,KAAK,EAAE,UAAU57B,KAAV,EAAiB;AACtBA,QAAAA,KAAK,CAAC,CAAD,CAAL,GAAWA,KAAK,CAAC,CAAD,CAAL,CAASrH,WAAT,EAAX;;AACA,YAAIqH,KAAK,CAAC,CAAD,CAAL,CAASpV,KAAT,CAAe,CAAf,EAAkB,CAAlB,MAAyB,KAA7B,EAAoC;AAClC,cAAI,CAACoV,KAAK,CAAC,CAAD,CAAV,EAAe;AACb28B,YAAAA,MAAM,CAAC76B,KAAP,CAAa9B,KAAK,CAAC,CAAD,CAAlB;AACD;;AACDA,UAAAA,KAAK,CAAC,CAAD,CAAL,GAAW,EAAEA,KAAK,CAAC,CAAD,CAAL,GAAWA,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAAL,IAAY,CAAxB,CAAX,GAAwC,KAAKA,KAAK,CAAC,CAAD,CAAL,KAAa,MAAb,IAAuBA,KAAK,CAAC,CAAD,CAAL,KAAa,KAAzC,CAA1C,CAAX;AACAA,UAAAA,KAAK,CAAC,CAAD,CAAL,GAAW,EAAEA,KAAK,CAAC,CAAD,CAAL,GAAWA,KAAK,CAAC,CAAD,CAAhB,IAAuBA,KAAK,CAAC,CAAD,CAAL,KAAa,KAAtC,CAAX;AACD,SAND,MAMO,IAAIA,KAAK,CAAC,CAAD,CAAT,EAAc;AACnB28B,UAAAA,MAAM,CAAC76B,KAAP,CAAa9B,KAAK,CAAC,CAAD,CAAlB;AACD;;AACD,eAAOA,KAAP;AACD,OArBQ;AAsBT27B,MAAAA,MAAM,EAAE,UAAU37B,KAAV,EAAiB;AACvB,YAAIogC,MAAJ;AAAA,YAAYC,QAAQ,GAAG,CAACrgC,KAAK,CAAC,CAAD,CAAN,IAAaA,KAAK,CAAC,CAAD,CAAzC;;AACA,YAAIs7B,SAAS,CAACM,KAAV,CAAgBzkC,IAAhB,CAAqB6I,KAAK,CAAC,CAAD,CAA1B,CAAJ,EAAoC;AAClC,iBAAO,IAAP;AACD;;AACD,YAAIA,KAAK,CAAC,CAAD,CAAT,EAAc;AACZA,UAAAA,KAAK,CAAC,CAAD,CAAL,GAAWA,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAAjB,IAAwB,EAAnC;AACD,SAFD,MAEO,IAAIqgC,QAAQ,IAAIjF,OAAO,CAACjkC,IAAR,CAAakpC,QAAb,CAAZ,KAAuCD,MAAM,GAAGjH,QAAQ,CAACkH,QAAD,EAAW,IAAX,CAAxD,MAA8ED,MAAM,GAAGC,QAAQ,CAAC91C,OAAT,CAAiB,GAAjB,EAAsB81C,QAAQ,CAAC/0C,MAAT,GAAkB80C,MAAxC,IAAkDC,QAAQ,CAAC/0C,MAAlJ,CAAJ,EAA+J;AACpK0U,UAAAA,KAAK,CAAC,CAAD,CAAL,GAAWA,KAAK,CAAC,CAAD,CAAL,CAASpV,KAAT,CAAe,CAAf,EAAkBw1C,MAAlB,CAAX;AACApgC,UAAAA,KAAK,CAAC,CAAD,CAAL,GAAWqgC,QAAQ,CAACz1C,KAAT,CAAe,CAAf,EAAkBw1C,MAAlB,CAAX;AACD;;AACD,eAAOpgC,KAAK,CAACpV,KAAN,CAAY,CAAZ,EAAe,CAAf,CAAP;AACD;AAlCQ,KAlBa;AAsDxB0E,IAAAA,MAAM,EAAE;AACNmsC,MAAAA,GAAG,EAAE,UAAU6E,gBAAV,EAA4B;AAC/B,YAAIv7B,QAAQ,GAAGu7B,gBAAgB,CAAChoC,OAAjB,CAAyB+jC,SAAzB,EAAoCC,SAApC,EAA+C3jC,WAA/C,EAAf;AACA,eAAO2nC,gBAAgB,KAAK,GAArB,GAA2B,YAAY;AAC5C,iBAAO,IAAP;AACD,SAFM,GAEH,UAAU38B,IAAV,EAAgB;AAClB,iBAAOA,IAAI,CAACoB,QAAL,IAAiBpB,IAAI,CAACoB,QAAL,CAAcpM,WAAd,OAAgCoM,QAAxD;AACD,SAJD;AAKD,OARK;AASNy2B,MAAAA,KAAK,EAAE,UAAUmD,SAAV,EAAqB;AAC1B,YAAI9P,OAAO,GAAGqL,UAAU,CAACyE,SAAS,GAAG,GAAb,CAAxB;AACA,eAAO9P,OAAO,IAAI,CAACA,OAAO,GAAG,IAAI3B,MAAJ,CAAW,QAAQ2N,UAAR,GAAqB,GAArB,GAA2B8D,SAA3B,GAAuC,GAAvC,GAA6C9D,UAA7C,GAA0D,KAArE,CAAX,KAA2FX,UAAU,CAACyE,SAAD,EAAY,UAAUh7B,IAAV,EAAgB;AACjJ,iBAAOkrB,OAAO,CAAC13B,IAAR,CAAa,OAAOwM,IAAI,CAACg7B,SAAZ,KAA0B,QAA1B,IAAsCh7B,IAAI,CAACg7B,SAA3C,IAAwD,OAAOh7B,IAAI,CAACyJ,YAAZ,KAA6BmtB,YAA7B,IAA6C52B,IAAI,CAACyJ,YAAL,CAAkB,OAAlB,CAArG,IAAmI,EAAhJ,CAAP;AACD,SAFsH,CAAvH;AAGD,OAdK;AAeNsuB,MAAAA,IAAI,EAAE,UAAUtxC,IAAV,EAAgBm2C,QAAhB,EAA0BC,KAA1B,EAAiC;AACrC,eAAO,UAAU78B,IAAV,EAAgB;AACrB,cAAIgY,MAAM,GAAGghB,MAAM,CAACztB,IAAP,CAAYvL,IAAZ,EAAkBvZ,IAAlB,CAAb;;AACA,cAAIuxB,MAAM,IAAI,IAAd,EAAoB;AAClB,mBAAO4kB,QAAQ,KAAK,IAApB;AACD;;AACD,cAAI,CAACA,QAAL,EAAe;AACb,mBAAO,IAAP;AACD;;AACD5kB,UAAAA,MAAM,IAAI,EAAV;AACA,iBAAO4kB,QAAQ,KAAK,GAAb,GAAmB5kB,MAAM,KAAK6kB,KAA9B,GAAsCD,QAAQ,KAAK,IAAb,GAAoB5kB,MAAM,KAAK6kB,KAA/B,GAAuCD,QAAQ,KAAK,IAAb,GAAoBC,KAAK,IAAI7kB,MAAM,CAACpxB,OAAP,CAAei2C,KAAf,MAA0B,CAAvD,GAA2DD,QAAQ,KAAK,IAAb,GAAoBC,KAAK,IAAI7kB,MAAM,CAACpxB,OAAP,CAAei2C,KAAf,IAAwB,CAAC,CAAtD,GAA0DD,QAAQ,KAAK,IAAb,GAAoBC,KAAK,IAAI7kB,MAAM,CAAC/wB,KAAP,CAAa,CAAC41C,KAAK,CAACl1C,MAApB,MAAgCk1C,KAA7D,GAAqED,QAAQ,KAAK,IAAb,GAAoB,CAAC,MAAM5kB,MAAN,GAAe,GAAhB,EAAqBpxB,OAArB,CAA6Bi2C,KAA7B,IAAsC,CAAC,CAA3D,GAA+DD,QAAQ,KAAK,IAAb,GAAoB5kB,MAAM,KAAK6kB,KAAX,IAAoB7kB,MAAM,CAAC/wB,KAAP,CAAa,CAAb,EAAgB41C,KAAK,CAACl1C,MAAN,GAAe,CAA/B,MAAsCk1C,KAAK,GAAG,GAAtF,GAA4F,KAAza;AACD,SAVD;AAWD,OA3BK;AA4BN5E,MAAAA,KAAK,EAAE,UAAUtrC,IAAV,EAAgBmwC,IAAhB,EAAsBrC,QAAtB,EAAgC8B,KAAhC,EAAuC/sC,IAAvC,EAA6C;AAClD,YAAIutC,MAAM,GAAGpwC,IAAI,CAAC1F,KAAL,CAAW,CAAX,EAAc,CAAd,MAAqB,KAAlC;AAAA,YAAyC+1C,OAAO,GAAGrwC,IAAI,CAAC1F,KAAL,CAAW,CAAC,CAAZ,MAAmB,MAAtE;AAAA,YAA8Eg2C,MAAM,GAAGH,IAAI,KAAK,SAAhG;AACA,eAAOP,KAAK,KAAK,CAAV,IAAe/sC,IAAI,KAAK,CAAxB,GAA4B,UAAUwQ,IAAV,EAAgB;AACjD,iBAAO,CAAC,CAACA,IAAI,CAACiC,UAAd;AACD,SAFM,GAEH,UAAUjC,IAAV,EAAgBi5B,OAAhB,EAAyBiE,GAAzB,EAA8B;AAChC,cAAIhoB,KAAJ;AAAA,cAAWioB,UAAX;AAAA,cAAuB5+B,IAAvB;AAAA,cAA6B67B,IAA7B;AAAA,cAAmCgD,SAAnC;AAAA,cAA8ChnC,KAA9C;AAAA,cAAqDka,GAAG,GAAGysB,MAAM,KAAKC,OAAX,GAAqB,aAArB,GAAqC,iBAAhG;AAAA,cAAmHrgC,MAAM,GAAGqD,IAAI,CAACiC,UAAjI;AAAA,cAA6Ixb,IAAI,GAAGw2C,MAAM,IAAIj9B,IAAI,CAACoB,QAAL,CAAcpM,WAAd,EAA9J;AAAA,cAA2LqoC,QAAQ,GAAG,CAACH,GAAD,IAAQ,CAACD,MAA/M;;AACA,cAAItgC,MAAJ,EAAY;AACV,gBAAIogC,MAAJ,EAAY;AACV,qBAAOzsB,GAAP,EAAY;AACV/R,gBAAAA,IAAI,GAAGyB,IAAP;;AACA,uBAAOzB,IAAI,GAAGA,IAAI,CAAC+R,GAAD,CAAlB,EAAyB;AACvB,sBAAI2sB,MAAM,GAAG1+B,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,OAAgCvO,IAAnC,GAA0C8X,IAAI,CAACwB,QAAL,KAAkB,CAAtE,EAAyE;AACvE,2BAAO,KAAP;AACD;AACF;;AACD3J,gBAAAA,KAAK,GAAGka,GAAG,GAAG3jB,IAAI,KAAK,MAAT,IAAmB,CAACyJ,KAApB,IAA6B,aAA3C;AACD;;AACD,qBAAO,IAAP;AACD;;AACDA,YAAAA,KAAK,GAAG,CAAC4mC,OAAO,GAAGrgC,MAAM,CAACuG,UAAV,GAAuBvG,MAAM,CAACwG,SAAtC,CAAR;;AACA,gBAAI65B,OAAO,IAAIK,QAAf,EAAyB;AACvBF,cAAAA,UAAU,GAAGxgC,MAAM,CAACk3B,OAAD,CAAN,KAAoBl3B,MAAM,CAACk3B,OAAD,CAAN,GAAkB,EAAtC,CAAb;AACA3e,cAAAA,KAAK,GAAGioB,UAAU,CAACxwC,IAAD,CAAV,IAAoB,EAA5B;AACAywC,cAAAA,SAAS,GAAGloB,KAAK,CAAC,CAAD,CAAL,KAAaohB,OAAb,IAAwBphB,KAAK,CAAC,CAAD,CAAzC;AACAklB,cAAAA,IAAI,GAAGllB,KAAK,CAAC,CAAD,CAAL,KAAaohB,OAAb,IAAwBphB,KAAK,CAAC,CAAD,CAApC;AACA3W,cAAAA,IAAI,GAAG6+B,SAAS,IAAIzgC,MAAM,CAACsB,UAAP,CAAkBm/B,SAAlB,CAApB;;AACA,qBAAO7+B,IAAI,GAAG,EAAE6+B,SAAF,IAAe7+B,IAAf,IAAuBA,IAAI,CAAC+R,GAAD,CAA3B,KAAqC8pB,IAAI,GAAGgD,SAAS,GAAG,CAAxD,KAA8DhnC,KAAK,CAAC0gC,GAAN,EAA5E,EAAyF;AACvF,oBAAIv4B,IAAI,CAACwB,QAAL,KAAkB,CAAlB,IAAuB,EAAEq6B,IAAzB,IAAiC77B,IAAI,KAAKyB,IAA9C,EAAoD;AAClDm9B,kBAAAA,UAAU,CAACxwC,IAAD,CAAV,GAAmB,CACjB2pC,OADiB,EAEjB8G,SAFiB,EAGjBhD,IAHiB,CAAnB;AAKA;AACD;AACF;AACF,aAhBD,MAgBO,IAAIiD,QAAQ,KAAKnoB,KAAK,GAAG,CAAClV,IAAI,CAAC6zB,OAAD,CAAJ,KAAkB7zB,IAAI,CAAC6zB,OAAD,CAAJ,GAAgB,EAAlC,CAAD,EAAwClnC,IAAxC,CAAb,CAAR,IAAuEuoB,KAAK,CAAC,CAAD,CAAL,KAAaohB,OAAxF,EAAiG;AACtG8D,cAAAA,IAAI,GAAGllB,KAAK,CAAC,CAAD,CAAZ;AACD,aAFM,MAEA;AACL,qBAAO3W,IAAI,GAAG,EAAE6+B,SAAF,IAAe7+B,IAAf,IAAuBA,IAAI,CAAC+R,GAAD,CAA3B,KAAqC8pB,IAAI,GAAGgD,SAAS,GAAG,CAAxD,KAA8DhnC,KAAK,CAAC0gC,GAAN,EAA5E,EAAyF;AACvF,oBAAI,CAACmG,MAAM,GAAG1+B,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,OAAgCvO,IAAnC,GAA0C8X,IAAI,CAACwB,QAAL,KAAkB,CAAnE,KAAyE,EAAEq6B,IAA/E,EAAqF;AACnF,sBAAIiD,QAAJ,EAAc;AACZ,qBAAC9+B,IAAI,CAACs1B,OAAD,CAAJ,KAAkBt1B,IAAI,CAACs1B,OAAD,CAAJ,GAAgB,EAAlC,CAAD,EAAwClnC,IAAxC,IAAgD,CAC9C2pC,OAD8C,EAE9C8D,IAF8C,CAAhD;AAID;;AACD,sBAAI77B,IAAI,KAAKyB,IAAb,EAAmB;AACjB;AACD;AACF;AACF;AACF;;AACDo6B,YAAAA,IAAI,IAAI5qC,IAAR;AACA,mBAAO4qC,IAAI,KAAKmC,KAAT,IAAkBnC,IAAI,GAAGmC,KAAP,KAAiB,CAAjB,IAAsBnC,IAAI,GAAGmC,KAAP,IAAgB,CAA/D;AACD;AACF,SAtDD;AAuDD,OArFK;AAsFNvE,MAAAA,MAAM,EAAE,UAAUsF,MAAV,EAAkB7C,QAAlB,EAA4B;AAClC,YAAI7xC,IAAJ;AAAA,YAAUY,EAAE,GAAG6rC,IAAI,CAAC+B,OAAL,CAAakG,MAAb,KAAwBjI,IAAI,CAACkI,UAAL,CAAgBD,MAAM,CAACtoC,WAAP,EAAhB,CAAxB,IAAiEgkC,MAAM,CAAC76B,KAAP,CAAa,yBAAyBm/B,MAAtC,CAAhF;;AACA,YAAI9zC,EAAE,CAACqqC,OAAD,CAAN,EAAiB;AACf,iBAAOrqC,EAAE,CAACixC,QAAD,CAAT;AACD;;AACD,YAAIjxC,EAAE,CAAC7B,MAAH,GAAY,CAAhB,EAAmB;AACjBiB,UAAAA,IAAI,GAAG,CACL00C,MADK,EAELA,MAFK,EAGL,EAHK,EAIL7C,QAJK,CAAP;AAMA,iBAAOpF,IAAI,CAACkI,UAAL,CAAgB5tC,cAAhB,CAA+B2tC,MAAM,CAACtoC,WAAP,EAA/B,IAAuDklC,YAAY,CAAC,UAAUf,IAAV,EAAgBz/B,OAAhB,EAAyB;AAClG,gBAAI8jC,GAAJ;AAAA,gBAASC,OAAO,GAAGj0C,EAAE,CAAC2vC,IAAD,EAAOsB,QAAP,CAArB;AAAA,gBAAuC5yC,CAAC,GAAG41C,OAAO,CAAC91C,MAAnD;;AACA,mBAAOE,CAAC,EAAR,EAAY;AACV21C,cAAAA,GAAG,GAAGxG,SAAS,CAAC9vC,IAAV,CAAeiyC,IAAf,EAAqBsE,OAAO,CAAC51C,CAAD,CAA5B,CAAN;AACAsxC,cAAAA,IAAI,CAACqE,GAAD,CAAJ,GAAY,EAAE9jC,OAAO,CAAC8jC,GAAD,CAAP,GAAeC,OAAO,CAAC51C,CAAD,CAAxB,CAAZ;AACD;AACF,WANyE,CAAnE,GAMF,UAAUmY,IAAV,EAAgB;AACnB,mBAAOxW,EAAE,CAACwW,IAAD,EAAO,CAAP,EAAUpX,IAAV,CAAT;AACD,WARD;AASD;;AACD,eAAOY,EAAP;AACD;AA7GK,KAtDgB;AAqKxB4tC,IAAAA,OAAO,EAAE;AACPvtC,MAAAA,GAAG,EAAEqwC,YAAY,CAAC,UAAUp6B,QAAV,EAAoB;AACpC,YAAI49B,KAAK,GAAG,EAAZ;AAAA,YAAgBxE,OAAO,GAAG,EAA1B;AAAA,YAA8ByE,OAAO,GAAGlI,OAAO,CAAC31B,QAAQ,CAACnL,OAAT,CAAiB0iC,KAAjB,EAAwB,IAAxB,CAAD,CAA/C;AACA,eAAOsG,OAAO,CAAC9J,OAAD,CAAP,GAAmBqG,YAAY,CAAC,UAAUf,IAAV,EAAgBz/B,OAAhB,EAAyBu/B,OAAzB,EAAkCiE,GAAlC,EAAuC;AAC5E,cAAIl9B,IAAJ;AAAA,cAAU49B,SAAS,GAAGD,OAAO,CAACxE,IAAD,EAAO,IAAP,EAAa+D,GAAb,EAAkB,EAAlB,CAA7B;AAAA,cAAoDr1C,CAAC,GAAGsxC,IAAI,CAACxxC,MAA7D;;AACA,iBAAOE,CAAC,EAAR,EAAY;AACV,gBAAImY,IAAI,GAAG49B,SAAS,CAAC/1C,CAAD,CAApB,EAAyB;AACvBsxC,cAAAA,IAAI,CAACtxC,CAAD,CAAJ,GAAU,EAAE6R,OAAO,CAAC7R,CAAD,CAAP,GAAamY,IAAf,CAAV;AACD;AACF;AACF,SAPqC,CAA/B,GAOF,UAAUA,IAAV,EAAgBi5B,OAAhB,EAAyBiE,GAAzB,EAA8B;AACjCQ,UAAAA,KAAK,CAAC,CAAD,CAAL,GAAW19B,IAAX;AACA29B,UAAAA,OAAO,CAACD,KAAD,EAAQ,IAAR,EAAcR,GAAd,EAAmBhE,OAAnB,CAAP;AACAwE,UAAAA,KAAK,CAAC,CAAD,CAAL,GAAW,IAAX;AACA,iBAAO,CAACxE,OAAO,CAACpC,GAAR,EAAR;AACD,SAZD;AAaD,OAfgB,CADV;AAiBPjmC,MAAAA,GAAG,EAAEqpC,YAAY,CAAC,UAAUp6B,QAAV,EAAoB;AACpC,eAAO,UAAUE,IAAV,EAAgB;AACrB,iBAAOg5B,MAAM,CAACl5B,QAAD,EAAWE,IAAX,CAAN,CAAuBrY,MAAvB,GAAgC,CAAvC;AACD,SAFD;AAGD,OAJgB,CAjBV;AAsBPoG,MAAAA,QAAQ,EAAEmsC,YAAY,CAAC,UAAUz7B,IAAV,EAAgB;AACrCA,QAAAA,IAAI,GAAGA,IAAI,CAAC9J,OAAL,CAAa+jC,SAAb,EAAwBC,SAAxB,CAAP;AACA,eAAO,UAAU34B,IAAV,EAAgB;AACrB,iBAAO,CAACA,IAAI,CAACsF,WAAL,IAAoBtF,IAAI,CAAC2kB,SAAzB,IAAsC2Q,OAAO,CAACt1B,IAAD,CAA9C,EAAsDpZ,OAAtD,CAA8D6X,IAA9D,IAAsE,CAAC,CAA9E;AACD,SAFD;AAGD,OALqB,CAtBf;AA4BPo/B,MAAAA,IAAI,EAAE3D,YAAY,CAAC,UAAU2D,IAAV,EAAgB;AACjC,YAAI,CAACnG,WAAW,CAAClkC,IAAZ,CAAiBqqC,IAAI,IAAI,EAAzB,CAAL,EAAmC;AACjC7E,UAAAA,MAAM,CAAC76B,KAAP,CAAa,uBAAuB0/B,IAApC;AACD;;AACDA,QAAAA,IAAI,GAAGA,IAAI,CAAClpC,OAAL,CAAa+jC,SAAb,EAAwBC,SAAxB,EAAmC3jC,WAAnC,EAAP;AACA,eAAO,UAAUgL,IAAV,EAAgB;AACrB,cAAI89B,QAAJ;;AACA,aAAG;AACD,gBAAIA,QAAQ,GAAG7H,cAAc,GAAGj2B,IAAI,CAAC69B,IAAR,GAAe79B,IAAI,CAACyJ,YAAL,CAAkB,UAAlB,KAAiCzJ,IAAI,CAACyJ,YAAL,CAAkB,MAAlB,CAA7E,EAAwG;AACtGq0B,cAAAA,QAAQ,GAAGA,QAAQ,CAAC9oC,WAAT,EAAX;AACA,qBAAO8oC,QAAQ,KAAKD,IAAb,IAAqBC,QAAQ,CAACl3C,OAAT,CAAiBi3C,IAAI,GAAG,GAAxB,MAAiC,CAA7D;AACD;AACF,WALD,QAKS,CAAC79B,IAAI,GAAGA,IAAI,CAACiC,UAAb,KAA4BjC,IAAI,CAACD,QAAL,KAAkB,CALvD;;AAMA,iBAAO,KAAP;AACD,SATD;AAUD,OAfiB,CA5BX;AA4CPhJ,MAAAA,MAAM,EAAE,UAAUiJ,IAAV,EAAgB;AACtB,YAAI+9B,IAAI,GAAGvkC,MAAM,CAACwkC,QAAP,IAAmBxkC,MAAM,CAACwkC,QAAP,CAAgBD,IAA9C;AACA,eAAOA,IAAI,IAAIA,IAAI,CAAC92C,KAAL,CAAW,CAAX,MAAkB+Y,IAAI,CAACxV,EAAtC;AACD,OA/CM;AAgDPsR,MAAAA,IAAI,EAAE,UAAUkE,IAAV,EAAgB;AACpB,eAAOA,IAAI,KAAKg2B,OAAhB;AACD,OAlDM;AAmDPiI,MAAAA,KAAK,EAAE,UAAUj+B,IAAV,EAAgB;AACrB,eAAOA,IAAI,KAAK+1B,UAAU,CAACmI,aAApB,KAAsC,CAACnI,UAAU,CAACoI,QAAZ,IAAwBpI,UAAU,CAACoI,QAAX,EAA9D,KAAwF,CAAC,EAAEn+B,IAAI,CAACrT,IAAL,IAAaqT,IAAI,CAACo+B,IAAlB,IAA0B,CAACp+B,IAAI,CAACq+B,QAAlC,CAAhG;AACD,OArDM;AAsDPC,MAAAA,OAAO,EAAE,UAAUt+B,IAAV,EAAgB;AACvB,eAAOA,IAAI,CAACu+B,QAAL,KAAkB,KAAzB;AACD,OAxDM;AAyDPA,MAAAA,QAAQ,EAAE,UAAUv+B,IAAV,EAAgB;AACxB,eAAOA,IAAI,CAACu+B,QAAL,KAAkB,IAAzB;AACD,OA3DM;AA4DPC,MAAAA,OAAO,EAAE,UAAUx+B,IAAV,EAAgB;AACvB,YAAIoB,QAAQ,GAAGpB,IAAI,CAACoB,QAAL,CAAcpM,WAAd,EAAf;AACA,eAAOoM,QAAQ,KAAK,OAAb,IAAwB,CAAC,CAACpB,IAAI,CAACw+B,OAA/B,IAA0Cp9B,QAAQ,KAAK,QAAb,IAAyB,CAAC,CAACpB,IAAI,CAACy+B,QAAjF;AACD,OA/DM;AAgEPA,MAAAA,QAAQ,EAAE,UAAUz+B,IAAV,EAAgB;AACxB,YAAIA,IAAI,CAACiC,UAAT,EAAqB;AACnBjC,UAAAA,IAAI,CAACiC,UAAL,CAAgBy8B,aAAhB;AACD;;AACD,eAAO1+B,IAAI,CAACy+B,QAAL,KAAkB,IAAzB;AACD,OArEM;AAsEPp5B,MAAAA,KAAK,EAAE,UAAUrF,IAAV,EAAgB;AACrB,aAAKA,IAAI,GAAGA,IAAI,CAACkD,UAAjB,EAA6BlD,IAA7B,EAAmCA,IAAI,GAAGA,IAAI,CAAC6C,WAA/C,EAA4D;AAC1D,cAAI7C,IAAI,CAACD,QAAL,GAAgB,CAApB,EAAuB;AACrB,mBAAO,KAAP;AACD;AACF;;AACD,eAAO,IAAP;AACD,OA7EM;AA8EPpD,MAAAA,MAAM,EAAE,UAAUqD,IAAV,EAAgB;AACtB,eAAO,CAACq1B,IAAI,CAAC+B,OAAL,CAAa/xB,KAAb,CAAmBrF,IAAnB,CAAR;AACD,OAhFM;AAiFP2+B,MAAAA,MAAM,EAAE,UAAU3+B,IAAV,EAAgB;AACtB,eAAOq4B,OAAO,CAAC7kC,IAAR,CAAawM,IAAI,CAACoB,QAAlB,CAAP;AACD,OAnFM;AAoFPs8B,MAAAA,KAAK,EAAE,UAAU19B,IAAV,EAAgB;AACrB,eAAOo4B,OAAO,CAAC5kC,IAAR,CAAawM,IAAI,CAACoB,QAAlB,CAAP;AACD,OAtFM;AAuFPw9B,MAAAA,MAAM,EAAE,UAAU5+B,IAAV,EAAgB;AACtB,YAAIvZ,IAAI,GAAGuZ,IAAI,CAACoB,QAAL,CAAcpM,WAAd,EAAX;AACA,eAAOvO,IAAI,KAAK,OAAT,IAAoBuZ,IAAI,CAACrT,IAAL,KAAc,QAAlC,IAA8ClG,IAAI,KAAK,QAA9D;AACD,OA1FM;AA2FPgY,MAAAA,IAAI,EAAE,UAAUuB,IAAV,EAAgB;AACpB,YAAIuL,IAAJ;AACA,eAAOvL,IAAI,CAACoB,QAAL,CAAcpM,WAAd,OAAgC,OAAhC,IAA2CgL,IAAI,CAACrT,IAAL,KAAc,MAAzD,KAAoE,CAAC4e,IAAI,GAAGvL,IAAI,CAACyJ,YAAL,CAAkB,MAAlB,CAAR,KAAsC,IAAtC,IAA8C8B,IAAI,CAACvW,WAAL,OAAuB,MAAzI,CAAP;AACD,OA9FM;AA+FPunC,MAAAA,KAAK,EAAE/B,sBAAsB,CAAC,YAAY;AACxC,eAAO,CAAC,CAAD,CAAP;AACD,OAF4B,CA/FtB;AAkGPhrC,MAAAA,IAAI,EAAEgrC,sBAAsB,CAAC,UAAUE,YAAV,EAAwB/yC,MAAxB,EAAgC;AAC3D,eAAO,CAACA,MAAM,GAAG,CAAV,CAAP;AACD,OAF2B,CAlGrB;AAqGPL,MAAAA,EAAE,EAAEkzC,sBAAsB,CAAC,UAAUE,YAAV,EAAwB/yC,MAAxB,EAAgC8yC,QAAhC,EAA0C;AACnE,eAAO,CAACA,QAAQ,GAAG,CAAX,GAAeA,QAAQ,GAAG9yC,MAA1B,GAAmC8yC,QAApC,CAAP;AACD,OAFyB,CArGnB;AAwGPoE,MAAAA,IAAI,EAAErE,sBAAsB,CAAC,UAAUE,YAAV,EAAwB/yC,MAAxB,EAAgC;AAC3D,YAAIE,CAAC,GAAG,CAAR;;AACA,eAAOA,CAAC,GAAGF,MAAX,EAAmBE,CAAC,IAAI,CAAxB,EAA2B;AACzB6yC,UAAAA,YAAY,CAAC/sC,IAAb,CAAkB9F,CAAlB;AACD;;AACD,eAAO6yC,YAAP;AACD,OAN2B,CAxGrB;AA+GPoE,MAAAA,GAAG,EAAEtE,sBAAsB,CAAC,UAAUE,YAAV,EAAwB/yC,MAAxB,EAAgC;AAC1D,YAAIE,CAAC,GAAG,CAAR;;AACA,eAAOA,CAAC,GAAGF,MAAX,EAAmBE,CAAC,IAAI,CAAxB,EAA2B;AACzB6yC,UAAAA,YAAY,CAAC/sC,IAAb,CAAkB9F,CAAlB;AACD;;AACD,eAAO6yC,YAAP;AACD,OAN0B,CA/GpB;AAsHPqE,MAAAA,EAAE,EAAEvE,sBAAsB,CAAC,UAAUE,YAAV,EAAwB/yC,MAAxB,EAAgC8yC,QAAhC,EAA0C;AACnE,YAAI5yC,CAAC,GAAG4yC,QAAQ,GAAG,CAAX,GAAeA,QAAQ,GAAG9yC,MAA1B,GAAmC8yC,QAA3C;;AACA,eAAO,EAAE5yC,CAAF,IAAO,CAAd,GAAkB;AAChB6yC,UAAAA,YAAY,CAAC/sC,IAAb,CAAkB9F,CAAlB;AACD;;AACD,eAAO6yC,YAAP;AACD,OANyB,CAtHnB;AA6HPsE,MAAAA,EAAE,EAAExE,sBAAsB,CAAC,UAAUE,YAAV,EAAwB/yC,MAAxB,EAAgC8yC,QAAhC,EAA0C;AACnE,YAAI5yC,CAAC,GAAG4yC,QAAQ,GAAG,CAAX,GAAeA,QAAQ,GAAG9yC,MAA1B,GAAmC8yC,QAA3C;;AACA,eAAO,EAAE5yC,CAAF,GAAMF,MAAb,GAAsB;AACpB+yC,UAAAA,YAAY,CAAC/sC,IAAb,CAAkB9F,CAAlB;AACD;;AACD,eAAO6yC,YAAP;AACD,OANyB;AA7HnB;AArKe,GAA1B;AA2SArF,EAAAA,IAAI,CAAC+B,OAAL,CAAa6H,GAAb,GAAmB5J,IAAI,CAAC+B,OAAL,CAAa9vC,EAAhC;AACAiE,EAAAA,IAAI,CAAC,CACH,OADG,EAEH,UAFG,EAGH,MAHG,EAIH,UAJG,EAKH,OALG,CAAD,EAMD,UAAU1D,CAAV,EAAa;AACdwtC,IAAAA,IAAI,CAAC+B,OAAL,CAAavvC,CAAb,IAAkByyC,iBAAiB,CAACzyC,CAAD,CAAnC;AACD,GARG,CAAJ;AASA0D,EAAAA,IAAI,CAAC,CACH,QADG,EAEH,OAFG,CAAD,EAGD,UAAU1D,CAAV,EAAa;AACdwtC,IAAAA,IAAI,CAAC+B,OAAL,CAAavvC,CAAb,IAAkB0yC,kBAAkB,CAAC1yC,CAAD,CAApC;AACD,GALG,CAAJ;;AAMA,WAAS01C,UAAT,GAAsB,CACrB;;AACDA,EAAAA,UAAU,CAACj3C,SAAX,GAAuB+uC,IAAI,CAAC6J,OAAL,GAAe7J,IAAI,CAAC+B,OAA3C;AACA/B,EAAAA,IAAI,CAACkI,UAAL,GAAkB,IAAIA,UAAJ,EAAlB;;AACA/H,EAAAA,QAAQ,GAAGwD,MAAM,CAACxD,QAAP,GAAkB,UAAU11B,QAAV,EAAoBq/B,SAApB,EAA+B;AAC1D,QAAI1B,OAAJ;AAAA,QAAaphC,KAAb;AAAA,QAAoB+iC,MAApB;AAAA,QAA4BzyC,IAA5B;AAAA,QAAkC0yC,KAAlC;AAAA,QAAyChG,MAAzC;AAAA,QAAiDiG,UAAjD;AAAA,QAA6DvsC,MAAM,GAAG0jC,UAAU,CAAC32B,QAAQ,GAAG,GAAZ,CAAhF;;AACA,QAAI/M,MAAJ,EAAY;AACV,aAAOosC,SAAS,GAAG,CAAH,GAAOpsC,MAAM,CAAC9L,KAAP,CAAa,CAAb,CAAvB;AACD;;AACDo4C,IAAAA,KAAK,GAAGv/B,QAAR;AACAu5B,IAAAA,MAAM,GAAG,EAAT;AACAiG,IAAAA,UAAU,GAAGjK,IAAI,CAACmH,SAAlB;;AACA,WAAO6C,KAAP,EAAc;AACZ,UAAI,CAAC5B,OAAD,KAAaphC,KAAK,GAAGi7B,MAAM,CAACn7B,IAAP,CAAYkjC,KAAZ,CAArB,CAAJ,EAA8C;AAC5C,YAAIhjC,KAAJ,EAAW;AACTgjC,UAAAA,KAAK,GAAGA,KAAK,CAACp4C,KAAN,CAAYoV,KAAK,CAAC,CAAD,CAAL,CAAS1U,MAArB,KAAgC03C,KAAxC;AACD;;AACDhG,QAAAA,MAAM,CAAC1rC,IAAP,CAAYyxC,MAAM,GAAG,EAArB;AACD;;AACD3B,MAAAA,OAAO,GAAG,KAAV;;AACA,UAAIphC,KAAK,GAAGk7B,YAAY,CAACp7B,IAAb,CAAkBkjC,KAAlB,CAAZ,EAAsC;AACpC5B,QAAAA,OAAO,GAAGphC,KAAK,CAAC49B,KAAN,EAAV;AACAmF,QAAAA,MAAM,CAACzxC,IAAP,CAAY;AACVtE,UAAAA,KAAK,EAAEo0C,OADG;AAEV9wC,UAAAA,IAAI,EAAE0P,KAAK,CAAC,CAAD,CAAL,CAAS1H,OAAT,CAAiB0iC,KAAjB,EAAwB,GAAxB;AAFI,SAAZ;AAIAgI,QAAAA,KAAK,GAAGA,KAAK,CAACp4C,KAAN,CAAYw2C,OAAO,CAAC91C,MAApB,CAAR;AACD;;AACD,WAAKgF,IAAL,IAAa0oC,IAAI,CAAC1pC,MAAlB,EAA0B;AACxB,YAAI,CAAC0pC,IAAI,CAAC1pC,MAAL,CAAYgE,cAAZ,CAA2BhD,IAA3B,CAAL,EAAuC;AACrC;AACD;;AACD,YAAI,CAAC0P,KAAK,GAAGs7B,SAAS,CAAChrC,IAAD,CAAT,CAAgBwP,IAAhB,CAAqBkjC,KAArB,CAAT,MAA0C,CAACC,UAAU,CAAC3yC,IAAD,CAAX,KAAsB0P,KAAK,GAAGijC,UAAU,CAAC3yC,IAAD,CAAV,CAAiB0P,KAAjB,CAA9B,CAA1C,CAAJ,EAAuG;AACrGohC,UAAAA,OAAO,GAAGphC,KAAK,CAAC49B,KAAN,EAAV;AACAmF,UAAAA,MAAM,CAACzxC,IAAP,CAAY;AACVtE,YAAAA,KAAK,EAAEo0C,OADG;AAEV9wC,YAAAA,IAAI,EAAEA,IAFI;AAGV+M,YAAAA,OAAO,EAAE2C;AAHC,WAAZ;AAKAgjC,UAAAA,KAAK,GAAGA,KAAK,CAACp4C,KAAN,CAAYw2C,OAAO,CAAC91C,MAApB,CAAR;AACD;AACF;;AACD,UAAI,CAAC81C,OAAL,EAAc;AACZ;AACD;AACF;;AACD,WAAO0B,SAAS,GAAGE,KAAK,CAAC13C,MAAT,GAAkB03C,KAAK,GAAGrG,MAAM,CAAC76B,KAAP,CAAa2B,QAAb,CAAH,GAA4B22B,UAAU,CAAC32B,QAAD,EAAWu5B,MAAX,CAAV,CAA6BpyC,KAA7B,CAAmC,CAAnC,CAAnE;AACD,GA3CD;;AA4CA,WAAS4yC,UAAT,CAAoBuF,MAApB,EAA4B;AAC1B,QAAIv3C,CAAC,GAAG,CAAR;AAAA,QAAWD,GAAG,GAAGw3C,MAAM,CAACz3C,MAAxB;AAAA,QAAgCmY,QAAQ,GAAG,EAA3C;;AACA,WAAOjY,CAAC,GAAGD,GAAX,EAAgBC,CAAC,EAAjB,EAAqB;AACnBiY,MAAAA,QAAQ,IAAIs/B,MAAM,CAACv3C,CAAD,CAAN,CAAUwB,KAAtB;AACD;;AACD,WAAOyW,QAAP;AACD;;AACD,WAASy/B,aAAT,CAAuB5B,OAAvB,EAAgC6B,UAAhC,EAA4Cl/B,IAA5C,EAAkD;AAChD,QAAIgQ,GAAG,GAAGkvB,UAAU,CAAClvB,GAArB;AAAA,QAA0BmvB,gBAAgB,GAAGn/B,IAAI,IAAIgQ,GAAG,KAAK,YAA7D;AAAA,QAA2EovB,QAAQ,GAAG7tB,IAAI,EAA1F;AACA,WAAO2tB,UAAU,CAACjD,KAAX,GAAmB,UAAUv8B,IAAV,EAAgBi5B,OAAhB,EAAyBiE,GAAzB,EAA8B;AACtD,aAAOl9B,IAAI,GAAGA,IAAI,CAACsQ,GAAD,CAAlB,EAAyB;AACvB,YAAItQ,IAAI,CAACD,QAAL,KAAkB,CAAlB,IAAuB0/B,gBAA3B,EAA6C;AAC3C,iBAAO9B,OAAO,CAAC39B,IAAD,EAAOi5B,OAAP,EAAgBiE,GAAhB,CAAd;AACD;AACF;AACF,KANM,GAMH,UAAUl9B,IAAV,EAAgBi5B,OAAhB,EAAyBiE,GAAzB,EAA8B;AAChC,UAAIyC,QAAJ;AAAA,UAAcxC,UAAd;AAAA,UAA0ByC,QAAQ,GAAG,CACjCtJ,OADiC,EAEjCoJ,QAFiC,CAArC;;AAIA,UAAIxC,GAAJ,EAAS;AACP,eAAOl9B,IAAI,GAAGA,IAAI,CAACsQ,GAAD,CAAlB,EAAyB;AACvB,cAAItQ,IAAI,CAACD,QAAL,KAAkB,CAAlB,IAAuB0/B,gBAA3B,EAA6C;AAC3C,gBAAI9B,OAAO,CAAC39B,IAAD,EAAOi5B,OAAP,EAAgBiE,GAAhB,CAAX,EAAiC;AAC/B,qBAAO,IAAP;AACD;AACF;AACF;AACF,OARD,MAQO;AACL,eAAOl9B,IAAI,GAAGA,IAAI,CAACsQ,GAAD,CAAlB,EAAyB;AACvB,cAAItQ,IAAI,CAACD,QAAL,KAAkB,CAAlB,IAAuB0/B,gBAA3B,EAA6C;AAC3CtC,YAAAA,UAAU,GAAGn9B,IAAI,CAAC6zB,OAAD,CAAJ,KAAkB7zB,IAAI,CAAC6zB,OAAD,CAAJ,GAAgB,EAAlC,CAAb;;AACA,gBAAI,CAAC8L,QAAQ,GAAGxC,UAAU,CAAC7sB,GAAD,CAAtB,KAAgCqvB,QAAQ,CAAC,CAAD,CAAR,KAAgBrJ,OAAhD,IAA2DqJ,QAAQ,CAAC,CAAD,CAAR,KAAgBD,QAA/E,EAAyF;AACvF,qBAAOE,QAAQ,CAAC,CAAD,CAAR,GAAcD,QAAQ,CAAC,CAAD,CAA7B;AACD,aAFD,MAEO;AACLxC,cAAAA,UAAU,CAAC7sB,GAAD,CAAV,GAAkBsvB,QAAlB;;AACA,kBAAIA,QAAQ,CAAC,CAAD,CAAR,GAAcjC,OAAO,CAAC39B,IAAD,EAAOi5B,OAAP,EAAgBiE,GAAhB,CAAzB,EAA+C;AAC7C,uBAAO,IAAP;AACD;AACF;AACF;AACF;AACF;AACF,KAlCD;AAmCD;;AACD,WAAS2C,cAAT,CAAwBC,QAAxB,EAAkC;AAChC,WAAOA,QAAQ,CAACn4C,MAAT,GAAkB,CAAlB,GAAsB,UAAUqY,IAAV,EAAgBi5B,OAAhB,EAAyBiE,GAAzB,EAA8B;AACzD,UAAIr1C,CAAC,GAAGi4C,QAAQ,CAACn4C,MAAjB;;AACA,aAAOE,CAAC,EAAR,EAAY;AACV,YAAI,CAACi4C,QAAQ,CAACj4C,CAAD,CAAR,CAAYmY,IAAZ,EAAkBi5B,OAAlB,EAA2BiE,GAA3B,CAAL,EAAsC;AACpC,iBAAO,KAAP;AACD;AACF;;AACD,aAAO,IAAP;AACD,KARM,GAQH4C,QAAQ,CAAC,CAAD,CARZ;AASD;;AACD,WAASC,gBAAT,CAA0BjgC,QAA1B,EAAoCkgC,QAApC,EAA8C9G,OAA9C,EAAuD;AACrD,QAAIrxC,CAAC,GAAG,CAAR;AAAA,QAAWD,GAAG,GAAGo4C,QAAQ,CAACr4C,MAA1B;;AACA,WAAOE,CAAC,GAAGD,GAAX,EAAgBC,CAAC,EAAjB,EAAqB;AACnBmxC,MAAAA,MAAM,CAACl5B,QAAD,EAAWkgC,QAAQ,CAACn4C,CAAD,CAAnB,EAAwBqxC,OAAxB,CAAN;AACD;;AACD,WAAOA,OAAP;AACD;;AACD,WAAS+G,QAAT,CAAkBrC,SAAlB,EAA6BtyC,GAA7B,EAAkCK,MAAlC,EAA0CstC,OAA1C,EAAmDiE,GAAnD,EAAwD;AACtD,QAAIl9B,IAAJ;AAAA,QAAUkgC,YAAY,GAAG,EAAzB;AAAA,QAA6Br4C,CAAC,GAAG,CAAjC;AAAA,QAAoCD,GAAG,GAAGg2C,SAAS,CAACj2C,MAApD;AAAA,QAA4Dw4C,MAAM,GAAG70C,GAAG,IAAI,IAA5E;;AACA,WAAOzD,CAAC,GAAGD,GAAX,EAAgBC,CAAC,EAAjB,EAAqB;AACnB,UAAImY,IAAI,GAAG49B,SAAS,CAAC/1C,CAAD,CAApB,EAAyB;AACvB,YAAI,CAAC8D,MAAD,IAAWA,MAAM,CAACqU,IAAD,EAAOi5B,OAAP,EAAgBiE,GAAhB,CAArB,EAA2C;AACzCgD,UAAAA,YAAY,CAACvyC,IAAb,CAAkBqS,IAAlB;;AACA,cAAImgC,MAAJ,EAAY;AACV70C,YAAAA,GAAG,CAACqC,IAAJ,CAAS9F,CAAT;AACD;AACF;AACF;AACF;;AACD,WAAOq4C,YAAP;AACD;;AACD,WAASE,UAAT,CAAoB5D,SAApB,EAA+B18B,QAA/B,EAAyC69B,OAAzC,EAAkD0C,UAAlD,EAA8DC,UAA9D,EAA0EC,YAA1E,EAAwF;AACtF,QAAIF,UAAU,IAAI,CAACA,UAAU,CAACxM,OAAD,CAA7B,EAAwC;AACtCwM,MAAAA,UAAU,GAAGD,UAAU,CAACC,UAAD,CAAvB;AACD;;AACD,QAAIC,UAAU,IAAI,CAACA,UAAU,CAACzM,OAAD,CAA7B,EAAwC;AACtCyM,MAAAA,UAAU,GAAGF,UAAU,CAACE,UAAD,EAAaC,YAAb,CAAvB;AACD;;AACD,WAAOrG,YAAY,CAAC,UAAUf,IAAV,EAAgBD,OAAhB,EAAyBD,OAAzB,EAAkCiE,GAAlC,EAAuC;AACzD,UAAIsD,IAAJ;AAAA,UAAU34C,CAAV;AAAA,UAAamY,IAAb;AAAA,UAAmBygC,MAAM,GAAG,EAA5B;AAAA,UAAgCC,OAAO,GAAG,EAA1C;AAAA,UAA8CC,WAAW,GAAGzH,OAAO,CAACvxC,MAApE;AAAA,UAA4Ei5C,KAAK,GAAGzH,IAAI,IAAI4G,gBAAgB,CAACjgC,QAAQ,IAAI,GAAb,EAAkBm5B,OAAO,CAACl5B,QAAR,GAAmB,CAACk5B,OAAD,CAAnB,GAA+BA,OAAjD,EAA0D,EAA1D,CAA5G;AAAA,UAA2K4H,SAAS,GAAGrE,SAAS,KAAKrD,IAAI,IAAI,CAACr5B,QAAd,CAAT,GAAmCmgC,QAAQ,CAACW,KAAD,EAAQH,MAAR,EAAgBjE,SAAhB,EAA2BvD,OAA3B,EAAoCiE,GAApC,CAA3C,GAAsF0D,KAA7Q;AAAA,UAAoRE,UAAU,GAAGnD,OAAO,GAAG2C,UAAU,KAAKnH,IAAI,GAAGqD,SAAH,GAAemE,WAAW,IAAIN,UAAvC,CAAV,GAA+D,EAA/D,GAAoEnH,OAAvE,GAAiF2H,SAAzX;;AACA,UAAIlD,OAAJ,EAAa;AACXA,QAAAA,OAAO,CAACkD,SAAD,EAAYC,UAAZ,EAAwB7H,OAAxB,EAAiCiE,GAAjC,CAAP;AACD;;AACD,UAAImD,UAAJ,EAAgB;AACdG,QAAAA,IAAI,GAAGP,QAAQ,CAACa,UAAD,EAAaJ,OAAb,CAAf;AACAL,QAAAA,UAAU,CAACG,IAAD,EAAO,EAAP,EAAWvH,OAAX,EAAoBiE,GAApB,CAAV;AACAr1C,QAAAA,CAAC,GAAG24C,IAAI,CAAC74C,MAAT;;AACA,eAAOE,CAAC,EAAR,EAAY;AACV,cAAImY,IAAI,GAAGwgC,IAAI,CAAC34C,CAAD,CAAf,EAAoB;AAClBi5C,YAAAA,UAAU,CAACJ,OAAO,CAAC74C,CAAD,CAAR,CAAV,GAAyB,EAAEg5C,SAAS,CAACH,OAAO,CAAC74C,CAAD,CAAR,CAAT,GAAwBmY,IAA1B,CAAzB;AACD;AACF;AACF;;AACD,UAAIm5B,IAAJ,EAAU;AACR,YAAImH,UAAU,IAAI9D,SAAlB,EAA6B;AAC3B,cAAI8D,UAAJ,EAAgB;AACdE,YAAAA,IAAI,GAAG,EAAP;AACA34C,YAAAA,CAAC,GAAGi5C,UAAU,CAACn5C,MAAf;;AACA,mBAAOE,CAAC,EAAR,EAAY;AACV,kBAAImY,IAAI,GAAG8gC,UAAU,CAACj5C,CAAD,CAArB,EAA0B;AACxB24C,gBAAAA,IAAI,CAAC7yC,IAAL,CAAUkzC,SAAS,CAACh5C,CAAD,CAAT,GAAemY,IAAzB;AACD;AACF;;AACDsgC,YAAAA,UAAU,CAAC,IAAD,EAAOQ,UAAU,GAAG,EAApB,EAAwBN,IAAxB,EAA8BtD,GAA9B,CAAV;AACD;;AACDr1C,UAAAA,CAAC,GAAGi5C,UAAU,CAACn5C,MAAf;;AACA,iBAAOE,CAAC,EAAR,EAAY;AACV,gBAAI,CAACmY,IAAI,GAAG8gC,UAAU,CAACj5C,CAAD,CAAlB,KAA0B,CAAC24C,IAAI,GAAGF,UAAU,GAAGtJ,SAAS,CAAC9vC,IAAV,CAAeiyC,IAAf,EAAqBn5B,IAArB,CAAH,GAAgCygC,MAAM,CAAC54C,CAAD,CAAxD,IAA+D,CAAC,CAA9F,EAAiG;AAC/FsxC,cAAAA,IAAI,CAACqH,IAAD,CAAJ,GAAa,EAAEtH,OAAO,CAACsH,IAAD,CAAP,GAAgBxgC,IAAlB,CAAb;AACD;AACF;AACF;AACF,OAnBD,MAmBO;AACL8gC,QAAAA,UAAU,GAAGb,QAAQ,CAACa,UAAU,KAAK5H,OAAf,GAAyB4H,UAAU,CAAClW,MAAX,CAAkB+V,WAAlB,EAA+BG,UAAU,CAACn5C,MAA1C,CAAzB,GAA6Em5C,UAA9E,CAArB;;AACA,YAAIR,UAAJ,EAAgB;AACdA,UAAAA,UAAU,CAAC,IAAD,EAAOpH,OAAP,EAAgB4H,UAAhB,EAA4B5D,GAA5B,CAAV;AACD,SAFD,MAEO;AACLvvC,UAAAA,IAAI,CAAC5E,KAAL,CAAWmwC,OAAX,EAAoB4H,UAApB;AACD;AACF;AACF,KA1CkB,CAAnB;AA2CD;;AACD,WAASC,iBAAT,CAA2B3B,MAA3B,EAAmC;AACjC,QAAI4B,YAAJ;AAAA,QAAkBrD,OAAlB;AAAA,QAA2B9qC,CAA3B;AAAA,QAA8BjL,GAAG,GAAGw3C,MAAM,CAACz3C,MAA3C;AAAA,QAAmDs5C,eAAe,GAAG5L,IAAI,CAACiH,QAAL,CAAc8C,MAAM,CAAC,CAAD,CAAN,CAAUzyC,IAAxB,CAArE;AAAA,QAAoGu0C,gBAAgB,GAAGD,eAAe,IAAI5L,IAAI,CAACiH,QAAL,CAAc,GAAd,CAA1I;AAAA,QAA8Jz0C,CAAC,GAAGo5C,eAAe,GAAG,CAAH,GAAO,CAAxL;AAAA,QAA2LE,YAAY,GAAG5B,aAAa,CAAC,UAAUv/B,IAAV,EAAgB;AACpO,aAAOA,IAAI,KAAKghC,YAAhB;AACD,KAFoN,EAElNE,gBAFkN,EAEhM,IAFgM,CAAvN;AAAA,QAE8BE,eAAe,GAAG7B,aAAa,CAAC,UAAUv/B,IAAV,EAAgB;AAC1E,aAAOg3B,SAAS,CAAC9vC,IAAV,CAAe85C,YAAf,EAA6BhhC,IAA7B,IAAqC,CAAC,CAA7C;AACD,KAF0D,EAExDkhC,gBAFwD,EAEtC,IAFsC,CAF7D;AAAA,QAI8BpB,QAAQ,GAAG,CAAC,UAAU9/B,IAAV,EAAgBi5B,OAAhB,EAAyBiE,GAAzB,EAA8B;AAClE,UAAI76B,GAAG,GAAG,CAAC4+B,eAAD,KAAqB/D,GAAG,IAAIjE,OAAO,KAAKtD,gBAAxC,MAA8D,CAACqL,YAAY,GAAG/H,OAAhB,EAAyBl5B,QAAzB,GAAoCohC,YAAY,CAACnhC,IAAD,EAAOi5B,OAAP,EAAgBiE,GAAhB,CAAhD,GAAuEkE,eAAe,CAACphC,IAAD,EAAOi5B,OAAP,EAAgBiE,GAAhB,CAApJ,CAAV;AACA8D,MAAAA,YAAY,GAAG,IAAf;AACA,aAAO3+B,GAAP;AACD,KAJoC,CAJzC;;AASA,WAAOxa,CAAC,GAAGD,GAAX,EAAgBC,CAAC,EAAjB,EAAqB;AACnB,UAAI81C,OAAO,GAAGtI,IAAI,CAACiH,QAAL,CAAc8C,MAAM,CAACv3C,CAAD,CAAN,CAAU8E,IAAxB,CAAd,EAA6C;AAC3CmzC,QAAAA,QAAQ,GAAG,CAACP,aAAa,CAACM,cAAc,CAACC,QAAD,CAAf,EAA2BnC,OAA3B,CAAd,CAAX;AACD,OAFD,MAEO;AACLA,QAAAA,OAAO,GAAGtI,IAAI,CAAC1pC,MAAL,CAAYyzC,MAAM,CAACv3C,CAAD,CAAN,CAAU8E,IAAtB,EAA4B5D,KAA5B,CAAkC,IAAlC,EAAwCq2C,MAAM,CAACv3C,CAAD,CAAN,CAAU6R,OAAlD,CAAV;;AACA,YAAIikC,OAAO,CAAC9J,OAAD,CAAX,EAAsB;AACpBhhC,UAAAA,CAAC,GAAG,EAAEhL,CAAN;;AACA,iBAAOgL,CAAC,GAAGjL,GAAX,EAAgBiL,CAAC,EAAjB,EAAqB;AACnB,gBAAIwiC,IAAI,CAACiH,QAAL,CAAc8C,MAAM,CAACvsC,CAAD,CAAN,CAAUlG,IAAxB,CAAJ,EAAmC;AACjC;AACD;AACF;;AACD,iBAAOyzC,UAAU,CAACv4C,CAAC,GAAG,CAAJ,IAASg4C,cAAc,CAACC,QAAD,CAAxB,EAAoCj4C,CAAC,GAAG,CAAJ,IAASgyC,UAAU,CAACuF,MAAM,CAACn4C,KAAP,CAAa,CAAb,EAAgBY,CAAC,GAAG,CAApB,EAAuB+B,MAAvB,CAA8B;AAAEP,YAAAA,KAAK,EAAE+1C,MAAM,CAACv3C,CAAC,GAAG,CAAL,CAAN,CAAc8E,IAAd,KAAuB,GAAvB,GAA6B,GAA7B,GAAmC;AAA5C,WAA9B,CAAD,CAAV,CAA4FgI,OAA5F,CAAoG0iC,KAApG,EAA2G,IAA3G,CAA7C,EAA+JsG,OAA/J,EAAwK91C,CAAC,GAAGgL,CAAJ,IAASkuC,iBAAiB,CAAC3B,MAAM,CAACn4C,KAAP,CAAaY,CAAb,EAAgBgL,CAAhB,CAAD,CAAlM,EAAwNA,CAAC,GAAGjL,GAAJ,IAAWm5C,iBAAiB,CAAC3B,MAAM,GAAGA,MAAM,CAACn4C,KAAP,CAAa4L,CAAb,CAAV,CAApP,EAAgRA,CAAC,GAAGjL,GAAJ,IAAWiyC,UAAU,CAACuF,MAAD,CAArS,CAAjB;AACD;;AACDU,QAAAA,QAAQ,CAACnyC,IAAT,CAAcgwC,OAAd;AACD;AACF;;AACD,WAAOkC,cAAc,CAACC,QAAD,CAArB;AACD;;AACD,WAASuB,wBAAT,CAAkCC,eAAlC,EAAmDC,WAAnD,EAAgE;AAC9D,QAAIC,KAAK,GAAGD,WAAW,CAAC55C,MAAZ,GAAqB,CAAjC;AAAA,QAAoC85C,SAAS,GAAGH,eAAe,CAAC35C,MAAhB,GAAyB,CAAzE;AAAA,QAA4E+5C,YAAY,GAAG,UAAUvI,IAAV,EAAgBF,OAAhB,EAAyBiE,GAAzB,EAA8BhE,OAA9B,EAAuCyI,SAAvC,EAAkD;AACzI,UAAI3hC,IAAJ;AAAA,UAAUnN,CAAV;AAAA,UAAa8qC,OAAb;AAAA,UAAsBiE,YAAY,GAAG,CAArC;AAAA,UAAwC/5C,CAAC,GAAG,GAA5C;AAAA,UAAiD+1C,SAAS,GAAGzE,IAAI,IAAI,EAArE;AAAA,UAAyE0I,UAAU,GAAG,EAAtF;AAAA,UAA0FC,aAAa,GAAGnM,gBAA1G;AAAA,UAA4HiL,KAAK,GAAGzH,IAAI,IAAIsI,SAAS,IAAIpM,IAAI,CAAC1mC,IAAL,CAAUmpC,GAAV,CAAc,GAAd,EAAmB6J,SAAnB,CAAzJ;AAAA,UAAwLI,aAAa,GAAGzL,OAAO,IAAIwL,aAAa,IAAI,IAAjB,GAAwB,CAAxB,GAA4Bz5B,IAAI,CAAC25B,MAAL,MAAiB,GAAhQ;AAAA,UAAqQp6C,GAAG,GAAGg5C,KAAK,CAACj5C,MAAjR;;AACA,UAAIg6C,SAAJ,EAAe;AACbhM,QAAAA,gBAAgB,GAAGsD,OAAO,KAAKlD,UAAZ,IAA0BkD,OAA7C;AACD;;AACD,aAAOpxC,CAAC,KAAKD,GAAN,IAAa,CAACoY,IAAI,GAAG4gC,KAAK,CAAC/4C,CAAD,CAAb,KAAqB,IAAzC,EAA+CA,CAAC,EAAhD,EAAoD;AAClD,YAAI45C,SAAS,IAAIzhC,IAAjB,EAAuB;AACrBnN,UAAAA,CAAC,GAAG,CAAJ;;AACA,iBAAO8qC,OAAO,GAAG2D,eAAe,CAACzuC,CAAC,EAAF,CAAhC,EAAuC;AACrC,gBAAI8qC,OAAO,CAAC39B,IAAD,EAAOi5B,OAAP,EAAgBiE,GAAhB,CAAX,EAAiC;AAC/BhE,cAAAA,OAAO,CAACvrC,IAAR,CAAaqS,IAAb;AACA;AACD;AACF;;AACD,cAAI2hC,SAAJ,EAAe;AACbrL,YAAAA,OAAO,GAAGyL,aAAV;AACD;AACF;;AACD,YAAIP,KAAJ,EAAW;AACT,cAAIxhC,IAAI,GAAG,CAAC29B,OAAD,IAAY39B,IAAvB,EAA6B;AAC3B4hC,YAAAA,YAAY;AACb;;AACD,cAAIzI,IAAJ,EAAU;AACRyE,YAAAA,SAAS,CAACjwC,IAAV,CAAeqS,IAAf;AACD;AACF;AACF;;AACD4hC,MAAAA,YAAY,IAAI/5C,CAAhB;;AACA,UAAI25C,KAAK,IAAI35C,CAAC,KAAK+5C,YAAnB,EAAiC;AAC/B/uC,QAAAA,CAAC,GAAG,CAAJ;;AACA,eAAO8qC,OAAO,GAAG4D,WAAW,CAAC1uC,CAAC,EAAF,CAA5B,EAAmC;AACjC8qC,UAAAA,OAAO,CAACC,SAAD,EAAYiE,UAAZ,EAAwB5I,OAAxB,EAAiCiE,GAAjC,CAAP;AACD;;AACD,YAAI/D,IAAJ,EAAU;AACR,cAAIyI,YAAY,GAAG,CAAnB,EAAsB;AACpB,mBAAO/5C,CAAC,EAAR,EAAY;AACV,kBAAI,EAAE+1C,SAAS,CAAC/1C,CAAD,CAAT,IAAgBg6C,UAAU,CAACh6C,CAAD,CAA5B,CAAJ,EAAsC;AACpCg6C,gBAAAA,UAAU,CAACh6C,CAAD,CAAV,GAAgBivC,GAAG,CAAC5vC,IAAJ,CAASgyC,OAAT,CAAhB;AACD;AACF;AACF;;AACD2I,UAAAA,UAAU,GAAG5B,QAAQ,CAAC4B,UAAD,CAArB;AACD;;AACDl0C,QAAAA,IAAI,CAAC5E,KAAL,CAAWmwC,OAAX,EAAoB2I,UAApB;;AACA,YAAIF,SAAS,IAAI,CAACxI,IAAd,IAAsB0I,UAAU,CAACl6C,MAAX,GAAoB,CAA1C,IAA+Ci6C,YAAY,GAAGL,WAAW,CAAC55C,MAA3B,GAAoC,CAAvF,EAA0F;AACxFqxC,UAAAA,MAAM,CAAC+C,UAAP,CAAkB7C,OAAlB;AACD;AACF;;AACD,UAAIyI,SAAJ,EAAe;AACbrL,QAAAA,OAAO,GAAGyL,aAAV;AACApM,QAAAA,gBAAgB,GAAGmM,aAAnB;AACD;;AACD,aAAOlE,SAAP;AACD,KArDH;;AAsDA,WAAO4D,KAAK,GAAGtH,YAAY,CAACwH,YAAD,CAAf,GAAgCA,YAA5C;AACD;;AACDjM,EAAAA,OAAO,GAAGuD,MAAM,CAACvD,OAAP,GAAiB,UAAU31B,QAAV,EAAoBzD,KAApB,EAA2B;AACpD,QAAIxU,CAAJ;AAAA,QAAO05C,WAAW,GAAG,EAArB;AAAA,QAAyBD,eAAe,GAAG,EAA3C;AAAA,QAA+CvuC,MAAM,GAAG2jC,aAAa,CAAC52B,QAAQ,GAAG,GAAZ,CAArE;;AACA,QAAI,CAAC/M,MAAL,EAAa;AACX,UAAI,CAACsJ,KAAL,EAAY;AACVA,QAAAA,KAAK,GAAGm5B,QAAQ,CAAC11B,QAAD,CAAhB;AACD;;AACDjY,MAAAA,CAAC,GAAGwU,KAAK,CAAC1U,MAAV;;AACA,aAAOE,CAAC,EAAR,EAAY;AACVkL,QAAAA,MAAM,GAAGguC,iBAAiB,CAAC1kC,KAAK,CAACxU,CAAD,CAAN,CAA1B;;AACA,YAAIkL,MAAM,CAAC8gC,OAAD,CAAV,EAAqB;AACnB0N,UAAAA,WAAW,CAAC5zC,IAAZ,CAAiBoF,MAAjB;AACD,SAFD,MAEO;AACLuuC,UAAAA,eAAe,CAAC3zC,IAAhB,CAAqBoF,MAArB;AACD;AACF;;AACDA,MAAAA,MAAM,GAAG2jC,aAAa,CAAC52B,QAAD,EAAWuhC,wBAAwB,CAACC,eAAD,EAAkBC,WAAlB,CAAnC,CAAtB;AACAxuC,MAAAA,MAAM,CAAC+M,QAAP,GAAkBA,QAAlB;AACD;;AACD,WAAO/M,MAAP;AACD,GAnBD;;AAoBA2iC,EAAAA,MAAM,GAAGsD,MAAM,CAACtD,MAAP,GAAgB,UAAU51B,QAAV,EAAoBm5B,OAApB,EAA6BC,OAA7B,EAAsCC,IAAtC,EAA4C;AACnE,QAAItxC,CAAJ;AAAA,QAAOu3C,MAAP;AAAA,QAAe6C,KAAf;AAAA,QAAsBt1C,IAAtB;AAAA,QAA4BgC,IAA5B;AAAA,QAAkCuzC,QAAQ,GAAG,OAAOpiC,QAAP,KAAoB,UAApB,IAAkCA,QAA/E;AAAA,QAAyFzD,KAAK,GAAG,CAAC88B,IAAD,IAAS3D,QAAQ,CAAC11B,QAAQ,GAAGoiC,QAAQ,CAACpiC,QAAT,IAAqBA,QAAjC,CAAlH;AACAo5B,IAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB;;AACA,QAAI78B,KAAK,CAAC1U,MAAN,KAAiB,CAArB,EAAwB;AACtBy3C,MAAAA,MAAM,GAAG/iC,KAAK,CAAC,CAAD,CAAL,GAAWA,KAAK,CAAC,CAAD,CAAL,CAASpV,KAAT,CAAe,CAAf,CAApB;;AACA,UAAIm4C,MAAM,CAACz3C,MAAP,GAAgB,CAAhB,IAAqB,CAACs6C,KAAK,GAAG7C,MAAM,CAAC,CAAD,CAAf,EAAoBzyC,IAApB,KAA6B,IAAlD,IAA0DyoC,OAAO,CAACyF,OAAlE,IAA6E5B,OAAO,CAACl5B,QAAR,KAAqB,CAAlG,IAAuGk2B,cAAvG,IAAyHZ,IAAI,CAACiH,QAAL,CAAc8C,MAAM,CAAC,CAAD,CAAN,CAAUzyC,IAAxB,CAA7H,EAA4J;AAC1JssC,QAAAA,OAAO,GAAG,CAAC5D,IAAI,CAAC1mC,IAAL,CAAUipC,EAAV,CAAaqK,KAAK,CAACvoC,OAAN,CAAc,CAAd,EAAiB/E,OAAjB,CAAyB+jC,SAAzB,EAAoCC,SAApC,CAAb,EAA6DM,OAA7D,KAAyE,EAA1E,EAA8E,CAA9E,CAAV;;AACA,YAAI,CAACA,OAAL,EAAc;AACZ,iBAAOC,OAAP;AACD,SAFD,MAEO,IAAIgJ,QAAJ,EAAc;AACnBjJ,UAAAA,OAAO,GAAGA,OAAO,CAACh3B,UAAlB;AACD;;AACDnC,QAAAA,QAAQ,GAAGA,QAAQ,CAAC7Y,KAAT,CAAem4C,MAAM,CAACnF,KAAP,GAAe5wC,KAAf,CAAqB1B,MAApC,CAAX;AACD;;AACDE,MAAAA,CAAC,GAAG8vC,SAAS,CAACQ,YAAV,CAAuB3kC,IAAvB,CAA4BsM,QAA5B,IAAwC,CAAxC,GAA4Cs/B,MAAM,CAACz3C,MAAvD;;AACA,aAAOE,CAAC,EAAR,EAAY;AACVo6C,QAAAA,KAAK,GAAG7C,MAAM,CAACv3C,CAAD,CAAd;;AACA,YAAIwtC,IAAI,CAACiH,QAAL,CAAc3vC,IAAI,GAAGs1C,KAAK,CAACt1C,IAA3B,CAAJ,EAAsC;AACpC;AACD;;AACD,YAAIgC,IAAI,GAAG0mC,IAAI,CAAC1mC,IAAL,CAAUhC,IAAV,CAAX,EAA4B;AAC1B,cAAIwsC,IAAI,GAAGxqC,IAAI,CAACszC,KAAK,CAACvoC,OAAN,CAAc,CAAd,EAAiB/E,OAAjB,CAAyB+jC,SAAzB,EAAoCC,SAApC,CAAD,EAAiDH,QAAQ,CAAChlC,IAAT,CAAc4rC,MAAM,CAAC,CAAD,CAAN,CAAUzyC,IAAxB,KAAiCmtC,WAAW,CAACb,OAAO,CAACh3B,UAAT,CAA5C,IAAoEg3B,OAArH,CAAf,EAA8I;AAC5ImG,YAAAA,MAAM,CAACxU,MAAP,CAAc/iC,CAAd,EAAiB,CAAjB;AACAiY,YAAAA,QAAQ,GAAGq5B,IAAI,CAACxxC,MAAL,IAAekyC,UAAU,CAACuF,MAAD,CAApC;;AACA,gBAAI,CAACt/B,QAAL,EAAe;AACbnS,cAAAA,IAAI,CAAC5E,KAAL,CAAWmwC,OAAX,EAAoBC,IAApB;AACA,qBAAOD,OAAP;AACD;;AACD;AACD;AACF;AACF;AACF;;AACD,KAACgJ,QAAQ,IAAIzM,OAAO,CAAC31B,QAAD,EAAWzD,KAAX,CAApB,EAAuC88B,IAAvC,EAA6CF,OAA7C,EAAsD,CAAChD,cAAvD,EAAuEiD,OAAvE,EAAgFV,QAAQ,CAAChlC,IAAT,CAAcsM,QAAd,KAA2Bg6B,WAAW,CAACb,OAAO,CAACh3B,UAAT,CAAtC,IAA8Dg3B,OAA9I;AACA,WAAOC,OAAP;AACD,GAnCD;;AAoCA9D,EAAAA,OAAO,CAAC8G,UAAR,GAAqBrI,OAAO,CAACn4B,KAAR,CAAc,EAAd,EAAkB7U,IAAlB,CAAuB8vC,SAAvB,EAAkCzf,IAAlC,CAAuC,EAAvC,MAA+C2c,OAApE;AACAuB,EAAAA,OAAO,CAAC6G,gBAAR,GAA2B,CAAC,CAACpG,YAA7B;AACAC,EAAAA,WAAW;AACXV,EAAAA,OAAO,CAACiG,YAAR,GAAuB,IAAvB;AAEA,MAAIz9B,GAAG,GAAG9C,QAAV;AACA,MAAIqnC,MAAM,GAAG97C,KAAK,CAACC,SAAN,CAAgBqH,IAA7B;AACA,MAAIy0C,OAAO,GAAG/7C,KAAK,CAACC,SAAN,CAAgBW,KAA9B;AACA,MAAIo7C,YAAY,GAAG,0CAAnB;AACA,MAAIlN,KAAK,GAAGxB,UAAU,CAACwB,KAAvB;AACA,MAAImN,WAAW,GAAGjlC,KAAK,CAAC9B,OAAN,CAAc,6BAAd,CAAlB;;AACA,MAAIgnC,SAAS,GAAG,UAAU1yC,GAAV,EAAe;AAC7B,WAAO,OAAOA,GAAP,KAAe,WAAtB;AACD,GAFD;;AAGA,MAAI2yC,UAAU,GAAG,UAAU3yC,GAAV,EAAe;AAC9B,WAAO,OAAOA,GAAP,KAAe,QAAtB;AACD,GAFD;;AAGA,MAAI4yC,QAAQ,GAAG,UAAU5yC,GAAV,EAAe;AAC5B,WAAOA,GAAG,IAAIA,GAAG,KAAKA,GAAG,CAAC2J,MAA1B;AACD,GAFD;;AAGA,MAAIkpC,cAAc,GAAG,UAAUhlC,IAAV,EAAgBilC,OAAhB,EAAyB;AAC5CA,IAAAA,OAAO,GAAGA,OAAO,IAAI/kC,GAArB;AACA,QAAI3C,SAAS,GAAG0nC,OAAO,CAAC7kC,aAAR,CAAsB,KAAtB,CAAhB;AACA,QAAI8kC,IAAI,GAAGD,OAAO,CAACE,sBAAR,EAAX;AACA5nC,IAAAA,SAAS,CAAC8C,SAAV,GAAsBL,IAAtB;AACA,QAAIa,IAAJ;;AACA,WAAOA,IAAI,GAAGtD,SAAS,CAACiI,UAAxB,EAAoC;AAClC0/B,MAAAA,IAAI,CAAC59B,WAAL,CAAiBzG,IAAjB;AACD;;AACD,WAAOqkC,IAAP;AACD,GAVD;;AAWA,MAAIE,aAAa,GAAG,UAAUC,WAAV,EAAuBC,UAAvB,EAAmC1xC,QAAnC,EAA6CxC,OAA7C,EAAsD;AACxE,QAAIjH,CAAJ;;AACA,QAAI26C,UAAU,CAACQ,UAAD,CAAd,EAA4B;AAC1BA,MAAAA,UAAU,GAAGN,cAAc,CAACM,UAAD,EAAaC,kBAAkB,CAACF,WAAW,CAAC,CAAD,CAAZ,CAA/B,CAA3B;AACD,KAFD,MAEO,IAAIC,UAAU,CAACr7C,MAAX,IAAqB,CAACq7C,UAAU,CAACjjC,QAArC,EAA+C;AACpDijC,MAAAA,UAAU,GAAGE,QAAQ,CAACC,SAAT,CAAmBH,UAAnB,CAAb;;AACA,UAAIl0C,OAAJ,EAAa;AACX,aAAKjH,CAAC,GAAGm7C,UAAU,CAACr7C,MAAX,GAAoB,CAA7B,EAAgCE,CAAC,IAAI,CAArC,EAAwCA,CAAC,EAAzC,EAA6C;AAC3Ci7C,UAAAA,aAAa,CAACC,WAAD,EAAcC,UAAU,CAACn7C,CAAD,CAAxB,EAA6ByJ,QAA7B,EAAuCxC,OAAvC,CAAb;AACD;AACF,OAJD,MAIO;AACL,aAAKjH,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGm7C,UAAU,CAACr7C,MAA3B,EAAmCE,CAAC,EAApC,EAAwC;AACtCi7C,UAAAA,aAAa,CAACC,WAAD,EAAcC,UAAU,CAACn7C,CAAD,CAAxB,EAA6ByJ,QAA7B,EAAuCxC,OAAvC,CAAb;AACD;AACF;;AACD,aAAOi0C,WAAP;AACD;;AACD,QAAIC,UAAU,CAACjjC,QAAf,EAAyB;AACvBlY,MAAAA,CAAC,GAAGk7C,WAAW,CAACp7C,MAAhB;;AACA,aAAOE,CAAC,EAAR,EAAY;AACVyJ,QAAAA,QAAQ,CAACpK,IAAT,CAAc67C,WAAW,CAACl7C,CAAD,CAAzB,EAA8Bm7C,UAA9B;AACD;AACF;;AACD,WAAOD,WAAP;AACD,GAxBD;;AAyBA,MAAIK,QAAQ,GAAG,UAAU7kC,IAAV,EAAgBy8B,SAAhB,EAA2B;AACxC,WAAOz8B,IAAI,IAAIy8B,SAAR,IAAqB,CAAC,MAAMz8B,IAAI,CAACy8B,SAAX,GAAuB,GAAxB,EAA6Bp0C,OAA7B,CAAqC,MAAMo0C,SAAN,GAAkB,GAAvD,MAAgE,CAAC,CAA7F;AACD,GAFD;;AAGA,MAAIqI,MAAM,GAAG,UAAU5gC,QAAV,EAAoByC,OAApB,EAA6Bvb,GAA7B,EAAkC;AAC7C,QAAI25C,UAAJ,EAAgBC,UAAhB;AACAr+B,IAAAA,OAAO,GAAGg+B,QAAQ,CAACh+B,OAAD,CAAR,CAAkB,CAAlB,CAAV;AACAzC,IAAAA,QAAQ,CAAClX,IAAT,CAAc,YAAY;AACxB,UAAIW,IAAI,GAAG,IAAX;;AACA,UAAI,CAACvC,GAAD,IAAQ25C,UAAU,KAAKp3C,IAAI,CAAC+V,UAAhC,EAA4C;AAC1CqhC,QAAAA,UAAU,GAAGp3C,IAAI,CAAC+V,UAAlB;AACAshC,QAAAA,UAAU,GAAGr+B,OAAO,CAACs+B,SAAR,CAAkB,KAAlB,CAAb;AACAt3C,QAAAA,IAAI,CAAC+V,UAAL,CAAgByC,YAAhB,CAA6B6+B,UAA7B,EAAyCr3C,IAAzC;AACAq3C,QAAAA,UAAU,CAACv+B,WAAX,CAAuB9Y,IAAvB;AACD,OALD,MAKO;AACLq3C,QAAAA,UAAU,CAACv+B,WAAX,CAAuB9Y,IAAvB;AACD;AACF,KAVD;AAWA,WAAOuW,QAAP;AACD,GAfD;;AAgBA,MAAIghC,aAAa,GAAGpmC,KAAK,CAAC9B,OAAN,CAAc,sEAAd,EAAsF,GAAtF,CAApB;AACA,MAAImoC,UAAU,GAAGrmC,KAAK,CAAC9B,OAAN,CAAc,+FAAd,EAA+G,GAA/G,CAAjB;AACA,MAAIooC,OAAO,GAAG;AACZC,IAAAA,GAAG,EAAE,SADO;AAEZC,IAAAA,KAAK,EAAE,WAFK;AAGZC,IAAAA,QAAQ,EAAE;AAHE,GAAd;AAKA,MAAIC,MAAM,GAAG;AAAEC,IAAAA,KAAK,EAAE;AAAT,GAAb;AACA,MAAIC,SAAS,GAAG,EAAhB;AAAA,MAAoBC,QAAQ,GAAG,EAA/B;;AACA,MAAIC,mBAAmB,GAAG,UAAUrkC,QAAV,EAAoBm5B,OAApB,EAA6B;AACrD,WAAO,IAAIiK,QAAQ,CAAC15C,EAAT,CAAY46C,IAAhB,CAAqBtkC,QAArB,EAA+Bm5B,OAA/B,CAAP;AACD,GAFD;;AAGA,MAAIoL,SAAS,GAAG,UAAU7yC,IAAV,EAAgBP,KAAhB,EAAuB;AACrC,QAAIpJ,CAAJ;;AACA,QAAIoJ,KAAK,CAACrK,OAAV,EAAmB;AACjB,aAAOqK,KAAK,CAACrK,OAAN,CAAc4K,IAAd,CAAP;AACD;;AACD3J,IAAAA,CAAC,GAAGoJ,KAAK,CAACtJ,MAAV;;AACA,WAAOE,CAAC,EAAR,EAAY;AACV,UAAIoJ,KAAK,CAACpJ,CAAD,CAAL,KAAa2J,IAAjB,EAAuB;AACrB,eAAO3J,CAAP;AACD;AACF;;AACD,WAAO,CAAC,CAAR;AACD,GAZD;;AAaA,MAAIy8C,kBAAkB,GAAG,YAAzB;;AACA,MAAIC,MAAM,GAAG,UAAUxuC,GAAV,EAAe;AAC1B,WAAOA,GAAG,KAAK,IAAR,IAAgBA,GAAG,KAAK5P,SAAxB,GAAoC,EAApC,GAAyC,CAAC,KAAK4P,GAAN,EAAWpB,OAAX,CAAmB2vC,kBAAnB,EAAuC,EAAvC,CAAhD;AACD,GAFD;;AAGA,MAAIE,MAAM,GAAG,UAAU30C,GAAV,EAAeyB,QAAf,EAAyB;AACpC,QAAI3J,MAAJ,EAAYiJ,GAAZ,EAAiB/I,CAAjB,EAAoBwB,KAApB;;AACA,QAAIwG,GAAJ,EAAS;AACPlI,MAAAA,MAAM,GAAGkI,GAAG,CAAClI,MAAb;;AACA,UAAIA,MAAM,KAAKxB,SAAf,EAA0B;AACxB,aAAKyK,GAAL,IAAYf,GAAZ,EAAiB;AACf,cAAIA,GAAG,CAACF,cAAJ,CAAmBiB,GAAnB,CAAJ,EAA6B;AAC3BvH,YAAAA,KAAK,GAAGwG,GAAG,CAACe,GAAD,CAAX;;AACA,gBAAIU,QAAQ,CAACpK,IAAT,CAAcmC,KAAd,EAAqBuH,GAArB,EAA0BvH,KAA1B,MAAqC,KAAzC,EAAgD;AAC9C;AACD;AACF;AACF;AACF,OATD,MASO;AACL,aAAKxB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGF,MAAhB,EAAwBE,CAAC,EAAzB,EAA6B;AAC3BwB,UAAAA,KAAK,GAAGwG,GAAG,CAAChI,CAAD,CAAX;;AACA,cAAIyJ,QAAQ,CAACpK,IAAT,CAAcmC,KAAd,EAAqBxB,CAArB,EAAwBwB,KAAxB,MAAmC,KAAvC,EAA8C;AAC5C;AACD;AACF;AACF;AACF;;AACD,WAAOwG,GAAP;AACD,GAvBD;;AAwBA,MAAIyN,IAAI,GAAG,UAAUrM,KAAV,EAAiBK,QAAjB,EAA2B;AACpC,QAAIC,GAAG,GAAG,EAAV;AACAizC,IAAAA,MAAM,CAACvzC,KAAD,EAAQ,UAAUpJ,CAAV,EAAa2J,IAAb,EAAmB;AAC/B,UAAIF,QAAQ,CAACE,IAAD,EAAO3J,CAAP,CAAZ,EAAuB;AACrB0J,QAAAA,GAAG,CAAC5D,IAAJ,CAAS6D,IAAT;AACD;AACF,KAJK,CAAN;AAKA,WAAOD,GAAP;AACD,GARD;;AASA,MAAI0xC,kBAAkB,GAAG,UAAUpjC,OAAV,EAAmB;AAC1C,QAAI,CAACA,OAAL,EAAc;AACZ,aAAOjC,GAAP;AACD;;AACD,QAAIiC,OAAO,CAACE,QAAR,KAAqB,CAAzB,EAA4B;AAC1B,aAAOF,OAAP;AACD;;AACD,WAAOA,OAAO,CAAC+B,aAAf;AACD,GARD;;AASAuiC,EAAAA,mBAAmB,CAAC36C,EAApB,GAAyB26C,mBAAmB,CAAC79C,SAApB,GAAgC;AACvDE,IAAAA,WAAW,EAAE29C,mBAD0C;AAEvDrkC,IAAAA,QAAQ,EAAE,EAF6C;AAGvDm5B,IAAAA,OAAO,EAAE,IAH8C;AAIvDtxC,IAAAA,MAAM,EAAE,CAJ+C;AAKvDy8C,IAAAA,IAAI,EAAE,UAAUtkC,QAAV,EAAoBm5B,OAApB,EAA6B;AACjC,UAAI/sC,IAAI,GAAG,IAAX;AACA,UAAImQ,KAAJ,EAAWkC,IAAX;;AACA,UAAI,CAACuB,QAAL,EAAe;AACb,eAAO5T,IAAP;AACD;;AACD,UAAI4T,QAAQ,CAACC,QAAb,EAAuB;AACrB7T,QAAAA,IAAI,CAAC+sC,OAAL,GAAe/sC,IAAI,CAAC,CAAD,CAAJ,GAAU4T,QAAzB;AACA5T,QAAAA,IAAI,CAACvE,MAAL,GAAc,CAAd;AACA,eAAOuE,IAAP;AACD;;AACD,UAAI+sC,OAAO,IAAIA,OAAO,CAACl5B,QAAvB,EAAiC;AAC/B7T,QAAAA,IAAI,CAAC+sC,OAAL,GAAeA,OAAf;AACD,OAFD,MAEO;AACL,YAAIA,OAAJ,EAAa;AACX,iBAAOiK,QAAQ,CAACpjC,QAAD,CAAR,CAAmByL,IAAnB,CAAwB0tB,OAAxB,CAAP;AACD;;AACD/sC,QAAAA,IAAI,CAAC+sC,OAAL,GAAeA,OAAO,GAAGn+B,QAAzB;AACD;;AACD,UAAI0nC,UAAU,CAAC1iC,QAAD,CAAd,EAA0B;AACxB5T,QAAAA,IAAI,CAAC4T,QAAL,GAAgBA,QAAhB;;AACA,YAAIA,QAAQ,CAACwgB,MAAT,CAAgB,CAAhB,MAAuB,GAAvB,IAA8BxgB,QAAQ,CAACwgB,MAAT,CAAgBxgB,QAAQ,CAACnY,MAAT,GAAkB,CAAlC,MAAyC,GAAvE,IAA8EmY,QAAQ,CAACnY,MAAT,IAAmB,CAArG,EAAwG;AACtG0U,UAAAA,KAAK,GAAG,CACN,IADM,EAENyD,QAFM,EAGN,IAHM,CAAR;AAKD,SAND,MAMO;AACLzD,UAAAA,KAAK,GAAGgmC,YAAY,CAAClmC,IAAb,CAAkB2D,QAAlB,CAAR;AACD;;AACD,YAAIzD,KAAJ,EAAW;AACT,cAAIA,KAAK,CAAC,CAAD,CAAT,EAAc;AACZkC,YAAAA,IAAI,GAAGmkC,cAAc,CAAC5iC,QAAD,EAAWmjC,kBAAkB,CAAChK,OAAD,CAA7B,CAAd,CAAsD/1B,UAA7D;;AACA,mBAAO3E,IAAP,EAAa;AACX4jC,cAAAA,MAAM,CAACj7C,IAAP,CAAYgF,IAAZ,EAAkBqS,IAAlB;AACAA,cAAAA,IAAI,GAAGA,IAAI,CAACsE,WAAZ;AACD;AACF,WAND,MAMO;AACLtE,YAAAA,IAAI,GAAG0kC,kBAAkB,CAAChK,OAAD,CAAlB,CAA4BS,cAA5B,CAA2Cr9B,KAAK,CAAC,CAAD,CAAhD,CAAP;;AACA,gBAAI,CAACkC,IAAL,EAAW;AACT,qBAAOrS,IAAP;AACD;;AACD,gBAAIqS,IAAI,CAAC/T,EAAL,KAAY6R,KAAK,CAAC,CAAD,CAArB,EAA0B;AACxB,qBAAOnQ,IAAI,CAACyC,IAAL,CAAUmR,QAAV,CAAP;AACD;;AACD5T,YAAAA,IAAI,CAACvE,MAAL,GAAc,CAAd;AACAuE,YAAAA,IAAI,CAAC,CAAD,CAAJ,GAAUqS,IAAV;AACD;AACF,SAlBD,MAkBO;AACL,iBAAO2kC,QAAQ,CAACjK,OAAD,CAAR,CAAkBtqC,IAAlB,CAAuBmR,QAAvB,CAAP;AACD;AACF,OAhCD,MAgCO;AACL,aAAKknB,GAAL,CAASlnB,QAAT,EAAmB,KAAnB;AACD;;AACD,aAAO5T,IAAP;AACD,KA5DsD;AA6DvDJ,IAAAA,OAAO,EAAE,YAAY;AACnB,aAAOuR,KAAK,CAACvR,OAAN,CAAc,IAAd,CAAP;AACD,KA/DsD;AAgEvDk7B,IAAAA,GAAG,EAAE,UAAUxrB,KAAV,EAAiB3U,IAAjB,EAAuB;AAC1B,UAAIqF,IAAI,GAAG,IAAX;AACA,UAAIsgB,KAAJ,EAAW3kB,CAAX;;AACA,UAAI26C,UAAU,CAAChnC,KAAD,CAAd,EAAuB;AACrB,eAAOtP,IAAI,CAAC86B,GAAL,CAASkc,QAAQ,CAAC1nC,KAAD,CAAjB,CAAP;AACD;;AACD,UAAI3U,IAAI,KAAK,KAAb,EAAoB;AAClB2lB,QAAAA,KAAK,GAAG02B,QAAQ,CAACuB,MAAT,CAAgBv4C,IAAI,CAACJ,OAAL,GAAelC,MAAf,CAAsBs5C,QAAQ,CAACC,SAAT,CAAmB3nC,KAAnB,CAAtB,CAAhB,CAAR;AACAtP,QAAAA,IAAI,CAACvE,MAAL,GAAc6kB,KAAK,CAAC7kB,MAApB;;AACA,aAAKE,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAtB,EAA8BE,CAAC,EAA/B,EAAmC;AACjCqE,UAAAA,IAAI,CAACrE,CAAD,CAAJ,GAAU2kB,KAAK,CAAC3kB,CAAD,CAAf;AACD;AACF,OAND,MAMO;AACLs6C,QAAAA,MAAM,CAACp5C,KAAP,CAAamD,IAAb,EAAmBg3C,QAAQ,CAACC,SAAT,CAAmB3nC,KAAnB,CAAnB;AACD;;AACD,aAAOtP,IAAP;AACD,KAhFsD;AAiFvDqf,IAAAA,IAAI,EAAE,UAAU9kB,IAAV,EAAgB4C,KAAhB,EAAuB;AAC3B,UAAI6C,IAAI,GAAG,IAAX;AACA,UAAIw4C,IAAJ;;AACA,UAAI,OAAOj+C,IAAP,KAAgB,QAApB,EAA8B;AAC5B+9C,QAAAA,MAAM,CAAC/9C,IAAD,EAAO,UAAUA,IAAV,EAAgB4C,KAAhB,EAAuB;AAClC6C,UAAAA,IAAI,CAACqf,IAAL,CAAU9kB,IAAV,EAAgB4C,KAAhB;AACD,SAFK,CAAN;AAGD,OAJD,MAIO,IAAIk5C,SAAS,CAACl5C,KAAD,CAAb,EAAsB;AAC3B,aAAKkC,IAAL,CAAU,YAAY;AACpB,cAAIm5C,IAAJ;;AACA,cAAI,KAAK3kC,QAAL,KAAkB,CAAtB,EAAyB;AACvB2kC,YAAAA,IAAI,GAAGT,SAAS,CAACx9C,IAAD,CAAhB;;AACA,gBAAIi+C,IAAI,IAAIA,IAAI,CAAC55B,GAAjB,EAAsB;AACpB45B,cAAAA,IAAI,CAAC55B,GAAL,CAAS,IAAT,EAAezhB,KAAf;AACA;AACD;;AACD,gBAAIA,KAAK,KAAK,IAAd,EAAoB;AAClB,mBAAKgiB,eAAL,CAAqB5kB,IAArB,EAA2B,CAA3B;AACD,aAFD,MAEO;AACL,mBAAKokB,YAAL,CAAkBpkB,IAAlB,EAAwB4C,KAAxB,EAA+B,CAA/B;AACD;AACF;AACF,SAdD;AAeD,OAhBM,MAgBA;AACL,YAAI6C,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAJ,CAAQ6T,QAAR,KAAqB,CAApC,EAAuC;AACrC2kC,UAAAA,IAAI,GAAGT,SAAS,CAACx9C,IAAD,CAAhB;;AACA,cAAIi+C,IAAI,IAAIA,IAAI,CAACp1C,GAAjB,EAAsB;AACpB,mBAAOo1C,IAAI,CAACp1C,GAAL,CAASpD,IAAI,CAAC,CAAD,CAAb,EAAkBzF,IAAlB,CAAP;AACD;;AACD,cAAIi9C,UAAU,CAACj9C,IAAD,CAAd,EAAsB;AACpB,mBAAOyF,IAAI,CAAC0P,IAAL,CAAUnV,IAAV,IAAkBA,IAAlB,GAAyBN,SAAhC;AACD;;AACDkD,UAAAA,KAAK,GAAG6C,IAAI,CAAC,CAAD,CAAJ,CAAQud,YAAR,CAAqBhjB,IAArB,EAA2B,CAA3B,CAAR;;AACA,cAAI4C,KAAK,KAAK,IAAd,EAAoB;AAClBA,YAAAA,KAAK,GAAGlD,SAAR;AACD;AACF;;AACD,eAAOkD,KAAP;AACD;;AACD,aAAO6C,IAAP;AACD,KAzHsD;AA0HvDy4C,IAAAA,UAAU,EAAE,UAAUl+C,IAAV,EAAgB;AAC1B,aAAO,KAAK8kB,IAAL,CAAU9kB,IAAV,EAAgB,IAAhB,CAAP;AACD,KA5HsD;AA6HvDmV,IAAAA,IAAI,EAAE,UAAUnV,IAAV,EAAgB4C,KAAhB,EAAuB;AAC3B,UAAI6C,IAAI,GAAG,IAAX;AACAzF,MAAAA,IAAI,GAAGk9C,OAAO,CAACl9C,IAAD,CAAP,IAAiBA,IAAxB;;AACA,UAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC5B+9C,QAAAA,MAAM,CAAC/9C,IAAD,EAAO,UAAUA,IAAV,EAAgB4C,KAAhB,EAAuB;AAClC6C,UAAAA,IAAI,CAAC0P,IAAL,CAAUnV,IAAV,EAAgB4C,KAAhB;AACD,SAFK,CAAN;AAGD,OAJD,MAIO,IAAIk5C,SAAS,CAACl5C,KAAD,CAAb,EAAsB;AAC3B,aAAKkC,IAAL,CAAU,YAAY;AACpB,cAAI,KAAKwU,QAAL,KAAkB,CAAtB,EAAyB;AACvB,iBAAKtZ,IAAL,IAAa4C,KAAb;AACD;AACF,SAJD;AAKD,OANM,MAMA;AACL,YAAI6C,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAJ,CAAQ6T,QAAnB,IAA+BtZ,IAAI,IAAIyF,IAAI,CAAC,CAAD,CAA/C,EAAoD;AAClD,iBAAOA,IAAI,CAAC,CAAD,CAAJ,CAAQzF,IAAR,CAAP;AACD;;AACD,eAAO4C,KAAP;AACD;;AACD,aAAO6C,IAAP;AACD,KAjJsD;AAkJvD0f,IAAAA,GAAG,EAAE,UAAUnlB,IAAV,EAAgB4C,KAAhB,EAAuB;AAC1B,UAAI6C,IAAI,GAAG,IAAX;AACA,UAAIwgB,GAAJ,EAASg4B,IAAT;;AACA,UAAIE,KAAK,GAAG,UAAUn+C,IAAV,EAAgB;AAC1B,eAAOA,IAAI,CAACkO,OAAL,CAAa,QAAb,EAAuB,UAAUxL,CAAV,EAAamD,CAAb,EAAgB;AAC5C,iBAAOA,CAAC,CAACo7B,WAAF,EAAP;AACD,SAFM,CAAP;AAGD,OAJD;;AAKA,UAAImd,MAAM,GAAG,UAAUp+C,IAAV,EAAgB;AAC3B,eAAOA,IAAI,CAACkO,OAAL,CAAa,QAAb,EAAuB,UAAUxL,CAAV,EAAa;AACzC,iBAAO,MAAMA,CAAb;AACD,SAFM,CAAP;AAGD,OAJD;;AAKA,UAAI,OAAO1C,IAAP,KAAgB,QAApB,EAA8B;AAC5B+9C,QAAAA,MAAM,CAAC/9C,IAAD,EAAO,UAAUA,IAAV,EAAgB4C,KAAhB,EAAuB;AAClC6C,UAAAA,IAAI,CAAC0f,GAAL,CAASnlB,IAAT,EAAe4C,KAAf;AACD,SAFK,CAAN;AAGD,OAJD,MAIO;AACL,YAAIk5C,SAAS,CAACl5C,KAAD,CAAb,EAAsB;AACpB5C,UAAAA,IAAI,GAAGm+C,KAAK,CAACn+C,IAAD,CAAZ;;AACA,cAAI,OAAO4C,KAAP,KAAiB,QAAjB,IAA6B,CAACo6C,aAAa,CAACh9C,IAAD,CAA/C,EAAuD;AACrD4C,YAAAA,KAAK,GAAGA,KAAK,CAAC0C,QAAN,KAAmB,IAA3B;AACD;;AACDG,UAAAA,IAAI,CAACX,IAAL,CAAU,YAAY;AACpB,gBAAIof,KAAK,GAAG,KAAKA,KAAjB;AACA+5B,YAAAA,IAAI,GAAGR,QAAQ,CAACz9C,IAAD,CAAf;;AACA,gBAAIi+C,IAAI,IAAIA,IAAI,CAAC55B,GAAjB,EAAsB;AACpB45B,cAAAA,IAAI,CAAC55B,GAAL,CAAS,IAAT,EAAezhB,KAAf;AACA;AACD;;AACD,gBAAI;AACF,mBAAKshB,KAAL,CAAWo5B,MAAM,CAACt9C,IAAD,CAAN,IAAgBA,IAA3B,IAAmC4C,KAAnC;AACD,aAFD,CAEE,OAAO0oB,EAAP,EAAW,CACZ;;AACD,gBAAI1oB,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,EAAhC,EAAoC;AAClC,kBAAIshB,KAAK,CAACm6B,cAAV,EAA0B;AACxBn6B,gBAAAA,KAAK,CAACm6B,cAAN,CAAqBD,MAAM,CAACp+C,IAAD,CAA3B;AACD,eAFD,MAEO;AACLkkB,gBAAAA,KAAK,CAACU,eAAN,CAAsB5kB,IAAtB;AACD;AACF;AACF,WAlBD;AAmBD,SAxBD,MAwBO;AACLimB,UAAAA,GAAG,GAAGxgB,IAAI,CAAC,CAAD,CAAV;AACAw4C,UAAAA,IAAI,GAAGR,QAAQ,CAACz9C,IAAD,CAAf;;AACA,cAAIi+C,IAAI,IAAIA,IAAI,CAACp1C,GAAjB,EAAsB;AACpB,mBAAOo1C,IAAI,CAACp1C,GAAL,CAASod,GAAT,CAAP;AACD;;AACD,cAAIA,GAAG,CAAC9K,aAAJ,CAAkBI,WAAtB,EAAmC;AACjC,gBAAI;AACF,qBAAO0K,GAAG,CAAC9K,aAAJ,CAAkBI,WAAlB,CAA8BmH,gBAA9B,CAA+CuD,GAA/C,EAAoD,IAApD,EAA0DtD,gBAA1D,CAA2Ey7B,MAAM,CAACp+C,IAAD,CAAjF,CAAP;AACD,aAFD,CAEE,OAAOsrB,EAAP,EAAW;AACX,qBAAO5rB,SAAP;AACD;AACF,WAND,MAMO,IAAIumB,GAAG,CAACq4B,YAAR,EAAsB;AAC3B,mBAAOr4B,GAAG,CAACq4B,YAAJ,CAAiBH,KAAK,CAACn+C,IAAD,CAAtB,CAAP;AACD,WAFM,MAEA;AACL,mBAAO,EAAP;AACD;AACF;AACF;;AACD,aAAOyF,IAAP;AACD,KAhNsD;AAiNvDsZ,IAAAA,MAAM,EAAE,YAAY;AAClB,UAAItZ,IAAI,GAAG,IAAX;AACA,UAAIqS,IAAJ;AAAA,UAAU1W,CAAC,GAAG,KAAKF,MAAnB;;AACA,aAAOE,CAAC,EAAR,EAAY;AACV0W,QAAAA,IAAI,GAAGrS,IAAI,CAACrE,CAAD,CAAX;AACAstC,QAAAA,KAAK,CAACH,KAAN,CAAYz2B,IAAZ;;AACA,YAAIA,IAAI,CAAC0D,UAAT,EAAqB;AACnB1D,UAAAA,IAAI,CAAC0D,UAAL,CAAgBwD,WAAhB,CAA4BlH,IAA5B;AACD;AACF;;AACD,aAAO,IAAP;AACD,KA5NsD;AA6NvD8G,IAAAA,KAAK,EAAE,YAAY;AACjB,UAAInZ,IAAI,GAAG,IAAX;AACA,UAAIqS,IAAJ;AAAA,UAAU1W,CAAC,GAAG,KAAKF,MAAnB;;AACA,aAAOE,CAAC,EAAR,EAAY;AACV0W,QAAAA,IAAI,GAAGrS,IAAI,CAACrE,CAAD,CAAX;;AACA,eAAO0W,IAAI,CAAC2E,UAAZ,EAAwB;AACtB3E,UAAAA,IAAI,CAACkH,WAAL,CAAiBlH,IAAI,CAAC2E,UAAtB;AACD;AACF;;AACD,aAAO,IAAP;AACD,KAvOsD;AAwOvDxF,IAAAA,IAAI,EAAE,UAAUrU,KAAV,EAAiB;AACrB,UAAI6C,IAAI,GAAG,IAAX;AACA,UAAIrE,CAAJ;;AACA,UAAI06C,SAAS,CAACl5C,KAAD,CAAb,EAAsB;AACpBxB,QAAAA,CAAC,GAAGqE,IAAI,CAACvE,MAAT;;AACA,YAAI;AACF,iBAAOE,CAAC,EAAR,EAAY;AACVqE,YAAAA,IAAI,CAACrE,CAAD,CAAJ,CAAQkW,SAAR,GAAoB1U,KAApB;AACD;AACF,SAJD,CAIE,OAAO0oB,EAAP,EAAW;AACXmxB,UAAAA,QAAQ,CAACh3C,IAAI,CAACrE,CAAD,CAAL,CAAR,CAAkBwd,KAAlB,GAA0BR,MAA1B,CAAiCxb,KAAjC;AACD;;AACD,eAAO6C,IAAP;AACD;;AACD,aAAOA,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAJ,CAAQ6R,SAAlB,GAA8B,EAArC;AACD,KAvPsD;AAwPvDU,IAAAA,IAAI,EAAE,UAAUpV,KAAV,EAAiB;AACrB,UAAI6C,IAAI,GAAG,IAAX;AACA,UAAIrE,CAAJ;;AACA,UAAI06C,SAAS,CAACl5C,KAAD,CAAb,EAAsB;AACpBxB,QAAAA,CAAC,GAAGqE,IAAI,CAACvE,MAAT;;AACA,eAAOE,CAAC,EAAR,EAAY;AACV,cAAI,eAAeqE,IAAI,CAACrE,CAAD,CAAvB,EAA4B;AAC1BqE,YAAAA,IAAI,CAACrE,CAAD,CAAJ,CAAQ88B,SAAR,GAAoBt7B,KAApB;AACD,WAFD,MAEO;AACL6C,YAAAA,IAAI,CAAC,CAAD,CAAJ,CAAQoZ,WAAR,GAAsBjc,KAAtB;AACD;AACF;;AACD,eAAO6C,IAAP;AACD;;AACD,aAAOA,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAJ,CAAQy4B,SAAR,IAAqBz4B,IAAI,CAAC,CAAD,CAAJ,CAAQoZ,WAAvC,GAAqD,EAA5D;AACD,KAvQsD;AAwQvDT,IAAAA,MAAM,EAAE,YAAY;AAClB,aAAOi+B,aAAa,CAAC,IAAD,EAAOh6C,SAAP,EAAkB,UAAUyV,IAAV,EAAgB;AACpD,YAAI,KAAKwB,QAAL,KAAkB,CAAlB,IAAuB,KAAKwD,IAAL,IAAa,KAAKA,IAAL,CAAUxD,QAAV,KAAuB,CAA/D,EAAkE;AAChE,eAAKiF,WAAL,CAAiBzG,IAAjB;AACD;AACF,OAJmB,CAApB;AAKD,KA9QsD;AA+QvDuG,IAAAA,OAAO,EAAE,YAAY;AACnB,aAAOg+B,aAAa,CAAC,IAAD,EAAOh6C,SAAP,EAAkB,UAAUyV,IAAV,EAAgB;AACpD,YAAI,KAAKwB,QAAL,KAAkB,CAAlB,IAAuB,KAAKwD,IAAL,IAAa,KAAKA,IAAL,CAAUxD,QAAV,KAAuB,CAA/D,EAAkE;AAChE,eAAK2E,YAAL,CAAkBnG,IAAlB,EAAwB,KAAK2E,UAA7B;AACD;AACF,OAJmB,EAIjB,IAJiB,CAApB;AAKD,KArRsD;AAsRvDqB,IAAAA,MAAM,EAAE,YAAY;AAClB,UAAIrY,IAAI,GAAG,IAAX;;AACA,UAAIA,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAJ,CAAQ+V,UAAvB,EAAmC;AACjC,eAAO6gC,aAAa,CAAC52C,IAAD,EAAOpD,SAAP,EAAkB,UAAUyV,IAAV,EAAgB;AACpD,eAAK0D,UAAL,CAAgByC,YAAhB,CAA6BnG,IAA7B,EAAmC,IAAnC;AACD,SAFmB,CAApB;AAGD;;AACD,aAAOrS,IAAP;AACD,KA9RsD;AA+RvDyY,IAAAA,KAAK,EAAE,YAAY;AACjB,UAAIzY,IAAI,GAAG,IAAX;;AACA,UAAIA,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAJ,CAAQ+V,UAAvB,EAAmC;AACjC,eAAO6gC,aAAa,CAAC52C,IAAD,EAAOpD,SAAP,EAAkB,UAAUyV,IAAV,EAAgB;AACpD,eAAK0D,UAAL,CAAgByC,YAAhB,CAA6BnG,IAA7B,EAAmC,KAAKsE,WAAxC;AACD,SAFmB,EAEjB,IAFiB,CAApB;AAGD;;AACD,aAAO3W,IAAP;AACD,KAvSsD;AAwSvD84C,IAAAA,QAAQ,EAAE,UAAU7yB,GAAV,EAAe;AACvB+wB,MAAAA,QAAQ,CAAC/wB,GAAD,CAAR,CAActN,MAAd,CAAqB,IAArB;AACA,aAAO,IAAP;AACD,KA3SsD;AA4SvDogC,IAAAA,SAAS,EAAE,UAAU9yB,GAAV,EAAe;AACxB+wB,MAAAA,QAAQ,CAAC/wB,GAAD,CAAR,CAAcrN,OAAd,CAAsB,IAAtB;AACA,aAAO,IAAP;AACD,KA/SsD;AAgTvDogC,IAAAA,WAAW,EAAE,UAAUC,OAAV,EAAmB;AAC9B,aAAO,KAAK5gC,MAAL,CAAY4gC,OAAZ,EAAqB3/B,MAArB,EAAP;AACD,KAlTsD;AAmTvDP,IAAAA,IAAI,EAAE,UAAUkgC,OAAV,EAAmB;AACvB,aAAO9B,MAAM,CAAC,IAAD,EAAO8B,OAAP,CAAb;AACD,KArTsD;AAsTvDC,IAAAA,OAAO,EAAE,UAAUD,OAAV,EAAmB;AAC1B,aAAO9B,MAAM,CAAC,IAAD,EAAO8B,OAAP,EAAgB,IAAhB,CAAb;AACD,KAxTsD;AAyTvDE,IAAAA,SAAS,EAAE,UAAUF,OAAV,EAAmB;AAC5B,WAAK55C,IAAL,CAAU,YAAY;AACpB23C,QAAAA,QAAQ,CAAC,IAAD,CAAR,CAAeoC,QAAf,GAA0BF,OAA1B,CAAkCD,OAAlC;AACD,OAFD;AAGA,aAAO,IAAP;AACD,KA9TsD;AA+TvDz/B,IAAAA,MAAM,EAAE,YAAY;AAClB,aAAO,KAAK/I,MAAL,GAAcpR,IAAd,CAAmB,YAAY;AACpC23C,QAAAA,QAAQ,CAAC,IAAD,CAAR,CAAegC,WAAf,CAA2B,KAAKjnC,UAAhC;AACD,OAFM,CAAP;AAGD,KAnUsD;AAoUvDjX,IAAAA,KAAK,EAAE,YAAY;AACjB,UAAIgxB,MAAM,GAAG,EAAb;AACA,WAAKzsB,IAAL,CAAU,YAAY;AACpBysB,QAAAA,MAAM,CAACrqB,IAAP,CAAY,KAAK61C,SAAL,CAAe,IAAf,CAAZ;AACD,OAFD;AAGA,aAAON,QAAQ,CAAClrB,MAAD,CAAf;AACD,KA1UsD;AA2UvDutB,IAAAA,QAAQ,EAAE,UAAUvK,SAAV,EAAqB;AAC7B,aAAO,KAAKwK,WAAL,CAAiBxK,SAAjB,EAA4B,IAA5B,CAAP;AACD,KA7UsD;AA8UvDyK,IAAAA,WAAW,EAAE,UAAUzK,SAAV,EAAqB;AAChC,aAAO,KAAKwK,WAAL,CAAiBxK,SAAjB,EAA4B,KAA5B,CAAP;AACD,KAhVsD;AAiVvDwK,IAAAA,WAAW,EAAE,UAAUxK,SAAV,EAAqB7f,KAArB,EAA4B;AACvC,UAAIjvB,IAAI,GAAG,IAAX;;AACA,UAAI,OAAO8uC,SAAP,KAAqB,QAAzB,EAAmC;AACjC,eAAO9uC,IAAP;AACD;;AACD,UAAI8uC,SAAS,CAACp0C,OAAV,CAAkB,GAAlB,MAA2B,CAAC,CAAhC,EAAmC;AACjC49C,QAAAA,MAAM,CAACxJ,SAAS,CAACt/B,KAAV,CAAgB,GAAhB,CAAD,EAAuB,YAAY;AACvCxP,UAAAA,IAAI,CAACs5C,WAAL,CAAiB,IAAjB,EAAuBrqB,KAAvB;AACD,SAFK,CAAN;AAGD,OAJD,MAIO;AACLjvB,QAAAA,IAAI,CAACX,IAAL,CAAU,UAAUkG,KAAV,EAAiB8M,IAAjB,EAAuB;AAC/B,cAAImnC,UAAU,GAAGtC,QAAQ,CAAC7kC,IAAD,EAAOy8B,SAAP,CAAzB;;AACA,cAAI0K,UAAU,KAAKvqB,KAAnB,EAA0B;AACxB,gBAAIwqB,iBAAiB,GAAGpnC,IAAI,CAACy8B,SAA7B;;AACA,gBAAI0K,UAAJ,EAAgB;AACdnnC,cAAAA,IAAI,CAACy8B,SAAL,GAAiBuJ,MAAM,CAAC,CAAC,MAAMoB,iBAAN,GAA0B,GAA3B,EAAgChxC,OAAhC,CAAwC,MAAMqmC,SAAN,GAAkB,GAA1D,EAA+D,GAA/D,CAAD,CAAvB;AACD,aAFD,MAEO;AACLz8B,cAAAA,IAAI,CAACy8B,SAAL,IAAkB2K,iBAAiB,GAAG,MAAM3K,SAAT,GAAqBA,SAAxD;AACD;AACF;AACF,SAVD;AAWD;;AACD,aAAO9uC,IAAP;AACD,KAxWsD;AAyWvDk3C,IAAAA,QAAQ,EAAE,UAAUpI,SAAV,EAAqB;AAC7B,aAAOoI,QAAQ,CAAC,KAAK,CAAL,CAAD,EAAUpI,SAAV,CAAf;AACD,KA3WsD;AA4WvDzvC,IAAAA,IAAI,EAAE,UAAU+F,QAAV,EAAoB;AACxB,aAAOkzC,MAAM,CAAC,IAAD,EAAOlzC,QAAP,CAAb;AACD,KA9WsD;AA+WvDme,IAAAA,EAAE,EAAE,UAAUhpB,IAAV,EAAgB6K,QAAhB,EAA0B;AAC5B,aAAO,KAAK/F,IAAL,CAAU,YAAY;AAC3B4pC,QAAAA,KAAK,CAAC3pC,IAAN,CAAW,IAAX,EAAiB/E,IAAjB,EAAuB6K,QAAvB;AACD,OAFM,CAAP;AAGD,KAnXsD;AAoXvDse,IAAAA,GAAG,EAAE,UAAUnpB,IAAV,EAAgB6K,QAAhB,EAA0B;AAC7B,aAAO,KAAK/F,IAAL,CAAU,YAAY;AAC3B4pC,QAAAA,KAAK,CAACR,MAAN,CAAa,IAAb,EAAmBluC,IAAnB,EAAyB6K,QAAzB;AACD,OAFM,CAAP;AAGD,KAxXsD;AAyXvDs0C,IAAAA,OAAO,EAAE,UAAUn/C,IAAV,EAAgB;AACvB,aAAO,KAAK8E,IAAL,CAAU,YAAY;AAC3B,YAAI,OAAO9E,IAAP,KAAgB,QAApB,EAA8B;AAC5B0uC,UAAAA,KAAK,CAACL,IAAN,CAAW,IAAX,EAAiBruC,IAAI,CAACkG,IAAtB,EAA4BlG,IAA5B;AACD,SAFD,MAEO;AACL0uC,UAAAA,KAAK,CAACL,IAAN,CAAW,IAAX,EAAiBruC,IAAjB;AACD;AACF,OANM,CAAP;AAOD,KAjYsD;AAkYvDo/C,IAAAA,IAAI,EAAE,YAAY;AAChB,aAAO,KAAKj6B,GAAL,CAAS,SAAT,EAAoB,EAApB,CAAP;AACD,KApYsD;AAqYvDk6B,IAAAA,IAAI,EAAE,YAAY;AAChB,aAAO,KAAKl6B,GAAL,CAAS,SAAT,EAAoB,MAApB,CAAP;AACD,KAvYsD;AAwYvD3kB,IAAAA,KAAK,EAAE,YAAY;AACjB,aAAOi8C,QAAQ,CAACd,OAAO,CAACr5C,KAAR,CAAc,IAAd,EAAoBD,SAApB,CAAD,CAAf;AACD,KA1YsD;AA2YvDxB,IAAAA,EAAE,EAAE,UAAUmK,KAAV,EAAiB;AACnB,aAAOA,KAAK,KAAK,CAAC,CAAX,GAAe,KAAKxK,KAAL,CAAWwK,KAAX,CAAf,GAAmC,KAAKxK,KAAL,CAAWwK,KAAX,EAAkB,CAACA,KAAD,GAAS,CAA3B,CAA1C;AACD,KA7YsD;AA8YvD8qC,IAAAA,KAAK,EAAE,YAAY;AACjB,aAAO,KAAKj1C,EAAL,CAAQ,CAAR,CAAP;AACD,KAhZsD;AAiZvDkI,IAAAA,IAAI,EAAE,YAAY;AAChB,aAAO,KAAKlI,EAAL,CAAQ,CAAC,CAAT,CAAP;AACD,KAnZsD;AAoZvDqH,IAAAA,IAAI,EAAE,UAAUmR,QAAV,EAAoB;AACxB,UAAIjY,CAAJ,EAAOqJ,CAAP;AACA,UAAImR,GAAG,GAAG,EAAV;;AACA,WAAKxa,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAG,KAAKvJ,MAArB,EAA6BE,CAAC,GAAGqJ,CAAjC,EAAoCrJ,CAAC,EAArC,EAAyC;AACvCq7C,QAAAA,QAAQ,CAACv0C,IAAT,CAAcmR,QAAd,EAAwB,KAAKjY,CAAL,CAAxB,EAAiCwa,GAAjC;AACD;;AACD,aAAO6gC,QAAQ,CAAC7gC,GAAD,CAAf;AACD,KA3ZsD;AA4ZvD1W,IAAAA,MAAM,EAAE,UAAUmU,QAAV,EAAoB;AAC1B,UAAI,OAAOA,QAAP,KAAoB,UAAxB,EAAoC;AAClC,eAAOojC,QAAQ,CAAC5lC,IAAI,CAAC,KAAKxR,OAAL,EAAD,EAAiB,UAAU0F,IAAV,EAAgB3J,CAAhB,EAAmB;AACtD,iBAAOiY,QAAQ,CAACjY,CAAD,EAAI2J,IAAJ,CAAf;AACD,SAFmB,CAAL,CAAf;AAGD;;AACD,aAAO0xC,QAAQ,CAACA,QAAQ,CAACv3C,MAAT,CAAgBmU,QAAhB,EAA0B,KAAKhU,OAAL,EAA1B,CAAD,CAAf;AACD,KAnasD;AAoavDqsB,IAAAA,OAAO,EAAE,UAAUrY,QAAV,EAAoB;AAC3B,UAAIkY,MAAM,GAAG,EAAb;;AACA,UAAIlY,QAAQ,YAAYojC,QAAxB,EAAkC;AAChCpjC,QAAAA,QAAQ,GAAGA,QAAQ,CAAC,CAAD,CAAnB;AACD;;AACD,WAAKvU,IAAL,CAAU,UAAU1D,CAAV,EAAa0W,IAAb,EAAmB;AAC3B,eAAOA,IAAP,EAAa;AACX,cAAI,OAAOuB,QAAP,KAAoB,QAApB,IAAgCojC,QAAQ,CAAC3kC,IAAD,CAAR,CAAe1T,EAAf,CAAkBiV,QAAlB,CAApC,EAAiE;AAC/DkY,YAAAA,MAAM,CAACrqB,IAAP,CAAY4Q,IAAZ;AACA;AACD,WAHD,MAGO,IAAIA,IAAI,KAAKuB,QAAb,EAAuB;AAC5BkY,YAAAA,MAAM,CAACrqB,IAAP,CAAY4Q,IAAZ;AACA;AACD;;AACDA,UAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;AACF,OAXD;AAYA,aAAOihC,QAAQ,CAAClrB,MAAD,CAAf;AACD,KAtbsD;AAubvDuI,IAAAA,MAAM,EAAE,UAAUA,MAAV,EAAkB;AACxB,UAAI7T,GAAJ,EAAS9O,GAAT,EAAciB,MAAd;AACA,UAAI3Y,CAAC,GAAG,CAAR;AAAA,UAAWqB,CAAC,GAAG,CAAf;AAAA,UAAkB6lB,GAAlB;;AACA,UAAI,CAACmT,MAAL,EAAa;AACX7T,QAAAA,GAAG,GAAG,KAAK,CAAL,CAAN;;AACA,YAAIA,GAAJ,EAAS;AACP9O,UAAAA,GAAG,GAAG8O,GAAG,CAAC9K,aAAV;AACA/C,UAAAA,MAAM,GAAGjB,GAAG,CAACmE,eAAb;;AACA,cAAI2K,GAAG,CAACtG,qBAAR,EAA+B;AAC7BgH,YAAAA,GAAG,GAAGV,GAAG,CAACtG,qBAAJ,EAAN;AACAlgB,YAAAA,CAAC,GAAGknB,GAAG,CAACtH,IAAJ,IAAYjH,MAAM,CAAC+H,UAAP,IAAqBhJ,GAAG,CAACiI,IAAJ,CAASe,UAA1C,IAAwD/H,MAAM,CAACkI,UAAnE;AACAxf,YAAAA,CAAC,GAAG6lB,GAAG,CAACrH,GAAJ,IAAWlH,MAAM,CAAC6H,SAAP,IAAoB9I,GAAG,CAACiI,IAAJ,CAASa,SAAxC,IAAqD7H,MAAM,CAACiI,SAAhE;AACD;AACF;;AACD,eAAO;AACLhB,UAAAA,IAAI,EAAE5f,CADD;AAEL6f,UAAAA,GAAG,EAAExe;AAFA,SAAP;AAID;;AACD,aAAO,KAAKqkB,GAAL,CAAS2U,MAAT,CAAP;AACD,KA3csD;AA4cvD5yB,IAAAA,IAAI,EAAEw0C,MA5ciD;AA6cvDt7C,IAAAA,IAAI,EAAER,KAAK,CAACC,SAAN,CAAgBO,IA7ciC;AA8cvD+jC,IAAAA,MAAM,EAAEvkC,KAAK,CAACC,SAAN,CAAgBskC;AA9c+B,GAAzD;AAgdAvtB,EAAAA,KAAK,CAACZ,MAAN,CAAa0nC,mBAAb,EAAkC;AAChC1nC,IAAAA,MAAM,EAAEY,KAAK,CAACZ,MADkB;AAEhC0mC,IAAAA,SAAS,EAAE,UAAU4C,MAAV,EAAkB;AAC3B,UAAItD,QAAQ,CAACsD,MAAD,CAAR,IAAoBA,MAAM,CAAChmC,QAA/B,EAAyC;AACvC,eAAO,CAACgmC,MAAD,CAAP;AACD;;AACD,aAAO1oC,KAAK,CAACvR,OAAN,CAAci6C,MAAd,CAAP;AACD,KAP+B;AAQhCxoC,IAAAA,OAAO,EAAE8mC,SARuB;AAShCr3C,IAAAA,OAAO,EAAEqQ,KAAK,CAACrQ,OATiB;AAUhCzB,IAAAA,IAAI,EAAEi5C,MAV0B;AAWhC9tC,IAAAA,IAAI,EAAE6tC,MAX0B;AAYhCjnC,IAAAA,IAAI,EAAEA,IAZ0B;AAahC3O,IAAAA,IAAI,EAAEqqC,MAb0B;AAchC0C,IAAAA,IAAI,EAAE1C,MAAM,CAACoD,SAdmB;AAehCqI,IAAAA,MAAM,EAAEzL,MAAM,CAAC+C,UAfiB;AAgBhCt9B,IAAAA,IAAI,EAAEu6B,MAAM,CAAC1D,OAhBmB;AAiBhCvnC,IAAAA,QAAQ,EAAEirC,MAAM,CAACjrC,QAjBe;AAkBhCpC,IAAAA,MAAM,EAAE,UAAU+vC,IAAV,EAAgBkF,KAAhB,EAAuB/2C,GAAvB,EAA4B;AAClC,UAAIhC,CAAC,GAAG+4C,KAAK,CAACj5C,MAAd;;AACA,UAAIkC,GAAJ,EAAS;AACP6xC,QAAAA,IAAI,GAAG,UAAUA,IAAV,GAAiB,GAAxB;AACD;;AACD,aAAO7zC,CAAC,EAAR,EAAY;AACV,YAAI+4C,KAAK,CAAC/4C,CAAD,CAAL,CAASkY,QAAT,KAAsB,CAA1B,EAA6B;AAC3B6gC,UAAAA,KAAK,CAAChW,MAAN,CAAa/iC,CAAb,EAAgB,CAAhB;AACD;AACF;;AACD,UAAI+4C,KAAK,CAACj5C,MAAN,KAAiB,CAArB,EAAwB;AACtBi5C,QAAAA,KAAK,GAAGsC,QAAQ,CAACv0C,IAAT,CAAcgtC,eAAd,CAA8BiF,KAAK,CAAC,CAAD,CAAnC,EAAwClF,IAAxC,IAAgD,CAACkF,KAAK,CAAC,CAAD,CAAN,CAAhD,GAA6D,EAArE;AACD,OAFD,MAEO;AACLA,QAAAA,KAAK,GAAGsC,QAAQ,CAACv0C,IAAT,CAAc+K,OAAd,CAAsBgiC,IAAtB,EAA4BkF,KAA5B,CAAR;AACD;;AACD,aAAOA,KAAP;AACD;AAlC+B,GAAlC;;AAoCA,MAAItwB,GAAG,GAAG,UAAUpM,EAAV,EAActI,IAAd,EAAoBlN,KAApB,EAA2B;AACnC,QAAI+uC,OAAO,GAAG,EAAd;AACA,QAAIv+B,GAAG,GAAGgF,EAAE,CAACtI,IAAD,CAAZ;;AACA,QAAI,OAAOlN,KAAP,KAAiB,QAAjB,IAA6BA,KAAK,YAAYw0C,QAAlD,EAA4D;AAC1Dx0C,MAAAA,KAAK,GAAGA,KAAK,CAAC,CAAD,CAAb;AACD;;AACD,WAAOwQ,GAAG,IAAIA,GAAG,CAACa,QAAJ,KAAiB,CAA/B,EAAkC;AAChC,UAAIrR,KAAK,KAAKvI,SAAd,EAAyB;AACvB,YAAI+Y,GAAG,KAAKxQ,KAAZ,EAAmB;AACjB;AACD;;AACD,YAAI,OAAOA,KAAP,KAAiB,QAAjB,IAA6Bw0C,QAAQ,CAAChkC,GAAD,CAAR,CAAcrU,EAAd,CAAiB6D,KAAjB,CAAjC,EAA0D;AACxD;AACD;AACF;;AACD,UAAIwQ,GAAG,CAACa,QAAJ,KAAiB,CAArB,EAAwB;AACtB09B,QAAAA,OAAO,CAAC9vC,IAAR,CAAauR,GAAb;AACD;;AACDA,MAAAA,GAAG,GAAGA,GAAG,CAACtD,IAAD,CAAT;AACD;;AACD,WAAO6hC,OAAP;AACD,GArBD;;AAsBA,MAAIuI,SAAS,GAAG,UAAUznC,IAAV,EAAgBof,WAAhB,EAA6B5d,QAA7B,EAAuCrR,KAAvC,EAA8C;AAC5D,QAAIspB,MAAM,GAAG,EAAb;;AACA,QAAItpB,KAAK,YAAYw0C,QAArB,EAA+B;AAC7Bx0C,MAAAA,KAAK,GAAGA,KAAK,CAAC,CAAD,CAAb;AACD;;AACD,WAAO6P,IAAP,EAAaA,IAAI,GAAGA,IAAI,CAACof,WAAD,CAAxB,EAAuC;AACrC,UAAI5d,QAAQ,IAAIxB,IAAI,CAACwB,QAAL,KAAkBA,QAAlC,EAA4C;AAC1C;AACD;;AACD,UAAIrR,KAAK,KAAKvI,SAAd,EAAyB;AACvB,YAAIoY,IAAI,KAAK7P,KAAb,EAAoB;AAClB;AACD;;AACD,YAAI,OAAOA,KAAP,KAAiB,QAAjB,IAA6Bw0C,QAAQ,CAAC3kC,IAAD,CAAR,CAAe1T,EAAf,CAAkB6D,KAAlB,CAAjC,EAA2D;AACzD;AACD;AACF;;AACDspB,MAAAA,MAAM,CAACrqB,IAAP,CAAY4Q,IAAZ;AACD;;AACD,WAAOyZ,MAAP;AACD,GApBD;;AAqBA,MAAIiuB,YAAY,GAAG,UAAU1nC,IAAV,EAAgBof,WAAhB,EAA6B5d,QAA7B,EAAuC;AACxD,SAAKxB,IAAI,GAAGA,IAAI,CAACof,WAAD,CAAhB,EAA+Bpf,IAA/B,EAAqCA,IAAI,GAAGA,IAAI,CAACof,WAAD,CAAhD,EAA+D;AAC7D,UAAIpf,IAAI,CAACwB,QAAL,KAAkBA,QAAtB,EAAgC;AAC9B,eAAOxB,IAAP;AACD;AACF;;AACD,WAAO,IAAP;AACD,GAPD;;AAQAimC,EAAAA,MAAM,CAAC;AACL7nC,IAAAA,MAAM,EAAE,UAAU4B,IAAV,EAAgB;AACtB,UAAI5B,MAAM,GAAG4B,IAAI,CAAC0D,UAAlB;AACA,aAAOtF,MAAM,IAAIA,MAAM,CAACoD,QAAP,KAAoB,EAA9B,GAAmCpD,MAAnC,GAA4C,IAAnD;AACD,KAJI;AAKLuF,IAAAA,OAAO,EAAE,UAAU3D,IAAV,EAAgB;AACvB,aAAO+R,GAAG,CAAC/R,IAAD,EAAO,YAAP,CAAV;AACD,KAPI;AAQL6e,IAAAA,IAAI,EAAE,UAAU7e,IAAV,EAAgB;AACpB,aAAO0nC,YAAY,CAAC1nC,IAAD,EAAO,aAAP,EAAsB,CAAtB,CAAnB;AACD,KAVI;AAWL8e,IAAAA,IAAI,EAAE,UAAU9e,IAAV,EAAgB;AACpB,aAAO0nC,YAAY,CAAC1nC,IAAD,EAAO,iBAAP,EAA0B,CAA1B,CAAnB;AACD,KAbI;AAcLmE,IAAAA,QAAQ,EAAE,UAAUnE,IAAV,EAAgB;AACxB,aAAOynC,SAAS,CAACznC,IAAI,CAAC2E,UAAN,EAAkB,aAAlB,EAAiC,CAAjC,CAAhB;AACD,KAhBI;AAiBLoiC,IAAAA,QAAQ,EAAE,UAAU/mC,IAAV,EAAgB;AACxB,aAAOlB,KAAK,CAACvR,OAAN,CAAc,CAACyS,IAAI,CAAC6C,QAAL,KAAkB,QAAlB,GAA6B7C,IAAI,CAAC2nC,eAAL,IAAwB3nC,IAAI,CAAC4nC,aAAL,CAAmBrrC,QAAxE,GAAmFyD,IAApF,EAA0FN,UAAxG,CAAP;AACD;AAnBI,GAAD,EAoBH,UAAUxX,IAAV,EAAgB+C,EAAhB,EAAoB;AACrB26C,IAAAA,mBAAmB,CAAC36C,EAApB,CAAuB/C,IAAvB,IAA+B,UAAUqZ,QAAV,EAAoB;AACjD,UAAI5T,IAAI,GAAG,IAAX;AACA,UAAI8rB,MAAM,GAAG,EAAb;AACA9rB,MAAAA,IAAI,CAACX,IAAL,CAAU,YAAY;AACpB,YAAIihB,KAAK,GAAGhjB,EAAE,CAACtC,IAAH,CAAQ8wB,MAAR,EAAgB,IAAhB,EAAsBlY,QAAtB,EAAgCkY,MAAhC,CAAZ;;AACA,YAAIxL,KAAJ,EAAW;AACT,cAAI02B,QAAQ,CAACl2C,OAAT,CAAiBwf,KAAjB,CAAJ,EAA6B;AAC3BwL,YAAAA,MAAM,CAACrqB,IAAP,CAAY5E,KAAZ,CAAkBivB,MAAlB,EAA0BxL,KAA1B;AACD,WAFD,MAEO;AACLwL,YAAAA,MAAM,CAACrqB,IAAP,CAAY6e,KAAZ;AACD;AACF;AACF,OATD;;AAUA,UAAI,KAAK7kB,MAAL,GAAc,CAAlB,EAAqB;AACnB,YAAI,CAAC26C,WAAW,CAAC77C,IAAD,CAAhB,EAAwB;AACtBuxB,UAAAA,MAAM,GAAGkrB,QAAQ,CAACuB,MAAT,CAAgBzsB,MAAhB,CAAT;AACD;;AACD,YAAIvxB,IAAI,CAACG,OAAL,CAAa,SAAb,MAA4B,CAAhC,EAAmC;AACjCoxB,UAAAA,MAAM,GAAGA,MAAM,CAAClpB,OAAP,EAAT;AACD;AACF;;AACD,UAAIs3C,aAAa,GAAGlD,QAAQ,CAAClrB,MAAD,CAA5B;;AACA,UAAIlY,QAAJ,EAAc;AACZ,eAAOsmC,aAAa,CAACz6C,MAAd,CAAqBmU,QAArB,CAAP;AACD;;AACD,aAAOsmC,aAAP;AACD,KA1BD;AA2BD,GAhDK,CAAN;AAiDA5B,EAAAA,MAAM,CAAC;AACL6B,IAAAA,YAAY,EAAE,UAAU9nC,IAAV,EAAgB7P,KAAhB,EAAuB;AACnC,aAAO4hB,GAAG,CAAC/R,IAAD,EAAO,YAAP,EAAqB7P,KAArB,CAAV;AACD,KAHI;AAIL43C,IAAAA,SAAS,EAAE,UAAU/nC,IAAV,EAAgB7P,KAAhB,EAAuB;AAChC,aAAOs3C,SAAS,CAACznC,IAAD,EAAO,aAAP,EAAsB,CAAtB,EAAyB7P,KAAzB,CAAT,CAAyCzH,KAAzC,CAA+C,CAA/C,CAAP;AACD,KANI;AAOLs/C,IAAAA,SAAS,EAAE,UAAUhoC,IAAV,EAAgB7P,KAAhB,EAAuB;AAChC,aAAOs3C,SAAS,CAACznC,IAAD,EAAO,iBAAP,EAA0B,CAA1B,EAA6B7P,KAA7B,CAAT,CAA6CzH,KAA7C,CAAmD,CAAnD,CAAP;AACD;AATI,GAAD,EAUH,UAAUR,IAAV,EAAgB+C,EAAhB,EAAoB;AACrB26C,IAAAA,mBAAmB,CAAC36C,EAApB,CAAuB/C,IAAvB,IAA+B,UAAUqZ,QAAV,EAAoBnU,MAApB,EAA4B;AACzD,UAAIO,IAAI,GAAG,IAAX;AACA,UAAI8rB,MAAM,GAAG,EAAb;AACA9rB,MAAAA,IAAI,CAACX,IAAL,CAAU,YAAY;AACpB,YAAIihB,KAAK,GAAGhjB,EAAE,CAACtC,IAAH,CAAQ8wB,MAAR,EAAgB,IAAhB,EAAsBlY,QAAtB,EAAgCkY,MAAhC,CAAZ;;AACA,YAAIxL,KAAJ,EAAW;AACT,cAAI02B,QAAQ,CAACl2C,OAAT,CAAiBwf,KAAjB,CAAJ,EAA6B;AAC3BwL,YAAAA,MAAM,CAACrqB,IAAP,CAAY5E,KAAZ,CAAkBivB,MAAlB,EAA0BxL,KAA1B;AACD,WAFD,MAEO;AACLwL,YAAAA,MAAM,CAACrqB,IAAP,CAAY6e,KAAZ;AACD;AACF;AACF,OATD;;AAUA,UAAI,KAAK7kB,MAAL,GAAc,CAAlB,EAAqB;AACnBqwB,QAAAA,MAAM,GAAGkrB,QAAQ,CAACuB,MAAT,CAAgBzsB,MAAhB,CAAT;;AACA,YAAIvxB,IAAI,CAACG,OAAL,CAAa,SAAb,MAA4B,CAA5B,IAAiCH,IAAI,KAAK,WAA9C,EAA2D;AACzDuxB,UAAAA,MAAM,GAAGA,MAAM,CAAClpB,OAAP,EAAT;AACD;AACF;;AACD,UAAIs3C,aAAa,GAAGlD,QAAQ,CAAClrB,MAAD,CAA5B;;AACA,UAAIrsB,MAAJ,EAAY;AACV,eAAOy6C,aAAa,CAACz6C,MAAd,CAAqBA,MAArB,CAAP;AACD;;AACD,aAAOy6C,aAAP;AACD,KAxBD;AAyBD,GApCK,CAAN;;AAqCAjC,EAAAA,mBAAmB,CAAC36C,EAApB,CAAuBqB,EAAvB,GAA4B,UAAUiV,QAAV,EAAoB;AAC9C,WAAO,CAAC,CAACA,QAAF,IAAc,KAAKnU,MAAL,CAAYmU,QAAZ,EAAsBnY,MAAtB,GAA+B,CAApD;AACD,GAFD;;AAGAw8C,EAAAA,mBAAmB,CAAC36C,EAApB,CAAuB46C,IAAvB,CAA4B99C,SAA5B,GAAwC69C,mBAAmB,CAAC36C,EAA5D;;AACA26C,EAAAA,mBAAmB,CAACqC,gBAApB,GAAuC,UAAUl1C,QAAV,EAAoB;AACzD,QAAIm1C,QAAJ;;AACA,QAAIC,GAAG,GAAG,UAAU5mC,QAAV,EAAoBm5B,OAApB,EAA6B;AACrCwN,MAAAA,QAAQ,GAAGA,QAAQ,IAAIn1C,QAAQ,EAA/B;;AACA,UAAIxI,SAAS,CAACnB,MAAV,KAAqB,CAAzB,EAA4B;AAC1BmY,QAAAA,QAAQ,GAAG2mC,QAAQ,CAAC5mC,OAApB;AACD;;AACD,UAAI,CAACo5B,OAAL,EAAc;AACZA,QAAAA,OAAO,GAAGwN,QAAQ,CAACxN,OAAnB;AACD;;AACD,aAAO,IAAIyN,GAAG,CAACl9C,EAAJ,CAAO46C,IAAX,CAAgBtkC,QAAhB,EAA0Bm5B,OAA1B,CAAP;AACD,KATD;;AAUAiK,IAAAA,QAAQ,CAACzmC,MAAT,CAAgBiqC,GAAhB,EAAqB,IAArB;AACA,WAAOA,GAAP;AACD,GAdD;;AAeAvC,EAAAA,mBAAmB,CAACF,SAApB,GAAgCA,SAAhC;AACAE,EAAAA,mBAAmB,CAACD,QAApB,GAA+BA,QAA/B;AACA,MAAIhB,QAAQ,GAAGiB,mBAAf;AAEA,MAAIwC,MAAM,GAAGtpC,KAAK,CAAC9R,IAAnB;AACA,MAAIq7C,MAAM,GAAGvpC,KAAK,CAACC,IAAnB;AACA,MAAIxF,IAAI,GAAGsC,GAAG,CAAChD,EAAf;AACA,MAAIyvC,gBAAgB,GAAG,kBAAvB;;AACA,MAAIC,cAAc,GAAG,UAAUh7B,MAAV,EAAkBmO,QAAlB,EAA4B8sB,UAA5B,EAAwC;AAC3D,QAAIC,UAAU,GAAG/sB,QAAQ,CAACgtB,WAA1B;AACA,QAAIC,WAAW,GAAG;AAChBp8B,MAAAA,GAAG,EAAE,UAAUq8B,IAAV,EAAgB99C,KAAhB,EAAuB5C,IAAvB,EAA6B;AAChC,YAAIwzB,QAAQ,CAACkV,aAAb,EAA4B;AAC1B9lC,UAAAA,KAAK,GAAG4wB,QAAQ,CAACkV,aAAT,CAAuBjoC,IAAvB,CAA4B+yB,QAAQ,CAACoV,mBAAT,IAAgC0X,UAAU,EAAtE,EAA0E19C,KAA1E,EAAiF5C,IAAjF,EAAuF0gD,IAAI,CAAC,CAAD,CAA3F,CAAR;AACD;;AACDA,QAAAA,IAAI,CAAC57B,IAAL,CAAU,cAAc9kB,IAAxB,EAA8B4C,KAA9B,EAAqCkiB,IAArC,CAA0C9kB,IAA1C,EAAgD4C,KAAhD;AACD,OANe;AAOhBiG,MAAAA,GAAG,EAAE,UAAU63C,IAAV,EAAgB1gD,IAAhB,EAAsB;AACzB,eAAO0gD,IAAI,CAAC57B,IAAL,CAAU,cAAc9kB,IAAxB,KAAiC0gD,IAAI,CAAC57B,IAAL,CAAU9kB,IAAV,CAAxC;AACD;AATe,KAAlB;AAWA,QAAIw9C,SAAS,GAAG;AACdt5B,MAAAA,KAAK,EAAE;AACLG,QAAAA,GAAG,EAAE,UAAUq8B,IAAV,EAAgB99C,KAAhB,EAAuB;AAC1B,cAAIA,KAAK,KAAK,IAAV,IAAkB,OAAOA,KAAP,KAAiB,QAAvC,EAAiD;AAC/C89C,YAAAA,IAAI,CAACv7B,GAAL,CAASviB,KAAT;AACA;AACD;;AACD,cAAI29C,UAAJ,EAAgB;AACdG,YAAAA,IAAI,CAAC57B,IAAL,CAAU,gBAAV,EAA4BliB,KAA5B;AACD;;AACD,cAAIA,KAAK,KAAK,IAAV,IAAkB,OAAOA,KAAP,KAAiB,QAAvC,EAAiD;AAC/C89C,YAAAA,IAAI,CAACxC,UAAL,CAAgB,OAAhB;AACAwC,YAAAA,IAAI,CAACv7B,GAAL,CAASE,MAAM,CAACkjB,KAAP,CAAa3lC,KAAb,CAAT;AACD,WAHD,MAGO;AACL89C,YAAAA,IAAI,CAAC57B,IAAL,CAAU,OAAV,EAAmBliB,KAAnB;AACD;AACF,SAfI;AAgBLiG,QAAAA,GAAG,EAAE,UAAU63C,IAAV,EAAgB;AACnB,cAAI99C,KAAK,GAAG89C,IAAI,CAAC57B,IAAL,CAAU,gBAAV,KAA+B47B,IAAI,CAAC57B,IAAL,CAAU,OAAV,CAA3C;AACAliB,UAAAA,KAAK,GAAGyiB,MAAM,CAAC2kB,SAAP,CAAiB3kB,MAAM,CAACkjB,KAAP,CAAa3lC,KAAb,CAAjB,EAAsC89C,IAAI,CAAC,CAAD,CAAJ,CAAQ/lC,QAA9C,CAAR;AACA,iBAAO/X,KAAP;AACD;AApBI;AADO,KAAhB;;AAwBA,QAAI29C,UAAJ,EAAgB;AACd/C,MAAAA,SAAS,CAAC7F,IAAV,GAAiB6F,SAAS,CAACmD,GAAV,GAAgBF,WAAjC;AACD;;AACD,WAAOjD,SAAP;AACD,GAzCD;;AA0CA,MAAIoD,uBAAuB,GAAG,UAAUv7B,MAAV,EAAkBq7B,IAAlB,EAAwB;AACpD,QAAIG,QAAQ,GAAGH,IAAI,CAAC57B,IAAL,CAAU,OAAV,CAAf;AACA,QAAIliB,KAAK,GAAGyiB,MAAM,CAAC2kB,SAAP,CAAiB3kB,MAAM,CAACkjB,KAAP,CAAasY,QAAb,CAAjB,EAAyCH,IAAI,CAAC,CAAD,CAAJ,CAAQ/lC,QAAjD,CAAZ;;AACA,QAAI,CAAC/X,KAAL,EAAY;AACVA,MAAAA,KAAK,GAAG,IAAR;AACD;;AACD89C,IAAAA,IAAI,CAAC57B,IAAL,CAAU,gBAAV,EAA4BliB,KAA5B;AACD,GAPD;;AAQA,MAAIk+C,aAAa,GAAG,UAAUhpC,IAAV,EAAgBipC,UAAhB,EAA4B;AAC9C,QAAIhK,GAAG,GAAG,CAAV;AAAA,QAAaiK,YAAb;AAAA,QAA2B1nC,QAA3B;;AACA,QAAIxB,IAAJ,EAAU;AACR,WAAKkpC,YAAY,GAAGlpC,IAAI,CAACwB,QAApB,EAA8BxB,IAAI,GAAGA,IAAI,CAACqE,eAA/C,EAAgErE,IAAhE,EAAsEA,IAAI,GAAGA,IAAI,CAACqE,eAAlF,EAAmG;AACjG7C,QAAAA,QAAQ,GAAGxB,IAAI,CAACwB,QAAhB;;AACA,YAAIynC,UAAU,IAAIznC,QAAQ,KAAK,CAA/B,EAAkC;AAChC,cAAIA,QAAQ,KAAK0nC,YAAb,IAA6B,CAAClpC,IAAI,CAAC49B,SAAL,CAAex0C,MAAjD,EAAyD;AACvD;AACD;AACF;;AACD61C,QAAAA,GAAG;AACHiK,QAAAA,YAAY,GAAG1nC,QAAf;AACD;AACF;;AACD,WAAOy9B,GAAP;AACD,GAfD;;AAgBA,MAAIkK,QAAQ,GAAG,UAAU9pC,GAAV,EAAeqc,QAAf,EAAyB;AACtC,QAAIA,QAAQ,KAAK,KAAK,CAAtB,EAAyB;AACvBA,MAAAA,QAAQ,GAAG,EAAX;AACD;;AACD,QAAI0tB,WAAW,GAAG,EAAlB;AACA,QAAIphC,GAAG,GAAG/M,MAAV;AACA,QAAIouC,KAAK,GAAG,EAAZ;AACA,QAAIC,OAAO,GAAG,CAAd;AACA,QAAIC,OAAO,GAAG,IAAd;AACA,QAAIC,QAAQ,GAAG,IAAf;AACA,QAAIC,gBAAgB,GAAGhrB,QAAQ,CAACJ,UAAT,CAAoB7d,YAAY,CAACX,OAAb,CAAqBR,GAArB,CAApB,EAA+C;AACpEue,MAAAA,cAAc,EAAElC,QAAQ,CAACkC,cAD2C;AAEpE5B,MAAAA,cAAc,EAAEN,QAAQ,CAACM;AAF2C,KAA/C,CAAvB;AAIA,QAAI0tB,WAAW,GAAG,EAAlB;AACA,QAAIxhB,MAAM,GAAGxM,QAAQ,CAACwM,MAAT,GAAkBxM,QAAQ,CAACwM,MAA3B,GAAoCkB,MAAM,CAAC,EAAD,CAAvD;AACA,QAAI7b,MAAM,GAAGwiB,MAAM,CAAC;AAClBa,MAAAA,aAAa,EAAElV,QAAQ,CAACkV,aADN;AAElBE,MAAAA,mBAAmB,EAAEpV,QAAQ,CAACoV;AAFZ,KAAD,EAGhBpV,QAAQ,CAACwM,MAHO,CAAnB;AAIA,QAAImN,MAAM,GAAG3Z,QAAQ,CAACiuB,SAAT,GAAqB,IAAIvU,UAAJ,EAArB,GAAwCA,UAAU,CAACwB,KAAhE;AACA,QAAI/L,gBAAgB,GAAG3C,MAAM,CAAC8G,gBAAP,EAAvB;AACA,QAAI4a,CAAC,GAAGjF,QAAQ,CAACsD,gBAAT,CAA0B,YAAY;AAC5C,aAAO;AACLvN,QAAAA,OAAO,EAAEr7B,GADJ;AAELiC,QAAAA,OAAO,EAAE3T,IAAI,CAACk8C,OAAL;AAFJ,OAAP;AAID,KALO,CAAR;;AAMA,QAAI7pB,OAAO,GAAG,UAAUhgB,IAAV,EAAgB;AAC5B,UAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC5B,eAAO,CAAC,CAAC6qB,gBAAgB,CAAC7qB,IAAD,CAAzB;AACD,OAFD,MAEO,IAAIA,IAAJ,EAAU;AACf,YAAI5R,IAAI,GAAG4R,IAAI,CAACwB,QAAhB;;AACA,YAAIpT,IAAJ,EAAU;AACR,iBAAO,CAAC,EAAEA,IAAI,KAAK,CAAT,IAAcy8B,gBAAgB,CAAC7qB,IAAI,CAAC6C,QAAN,CAAhC,CAAR;AACD;AACF;;AACD,aAAO,KAAP;AACD,KAVD;;AAWA,QAAI9R,GAAG,GAAG,UAAUod,GAAV,EAAe;AACvB,aAAOA,GAAG,IAAI9O,GAAP,IAAc9Q,QAAQ,CAAC4f,GAAD,CAAtB,GAA8B9O,GAAG,CAAC87B,cAAJ,CAAmBhtB,GAAnB,CAA9B,GAAwDA,GAA/D;AACD,KAFD;;AAGA,QAAI27B,EAAE,GAAG,UAAU37B,GAAV,EAAe;AACtB,aAAOy7B,CAAC,CAAC,OAAOz7B,GAAP,KAAe,QAAf,GAA0Bpd,GAAG,CAACod,GAAD,CAA7B,GAAqCA,GAAtC,CAAR;AACD,KAFD;;AAGA,QAAI47B,SAAS,GAAG,UAAU57B,GAAV,EAAejmB,IAAf,EAAqB8hD,UAArB,EAAiC;AAC/C,UAAI7D,IAAJ,EAAUr7C,KAAV;AACA,UAAI89C,IAAI,GAAGkB,EAAE,CAAC37B,GAAD,CAAb;;AACA,UAAIy6B,IAAI,CAACx/C,MAAT,EAAiB;AACf+8C,QAAAA,IAAI,GAAGT,SAAS,CAACx9C,IAAD,CAAhB;;AACA,YAAIi+C,IAAI,IAAIA,IAAI,CAACp1C,GAAjB,EAAsB;AACpBjG,UAAAA,KAAK,GAAGq7C,IAAI,CAACp1C,GAAL,CAAS63C,IAAT,EAAe1gD,IAAf,CAAR;AACD,SAFD,MAEO;AACL4C,UAAAA,KAAK,GAAG89C,IAAI,CAAC57B,IAAL,CAAU9kB,IAAV,CAAR;AACD;AACF;;AACD,UAAI,OAAO4C,KAAP,KAAiB,WAArB,EAAkC;AAChCA,QAAAA,KAAK,GAAGk/C,UAAU,IAAI,EAAtB;AACD;;AACD,aAAOl/C,KAAP;AACD,KAfD;;AAgBA,QAAIm/C,UAAU,GAAG,UAAU97B,GAAV,EAAe;AAC9B,UAAInO,IAAI,GAAGjP,GAAG,CAACod,GAAD,CAAd;;AACA,UAAI,CAACnO,IAAL,EAAW;AACT,eAAO,EAAP;AACD;;AACD,aAAOA,IAAI,CAAC+M,UAAZ;AACD,KAND;;AAOA,QAAIm9B,SAAS,GAAG,UAAU/7B,GAAV,EAAejmB,IAAf,EAAqB4C,KAArB,EAA4B;AAC1C,UAAIA,KAAK,KAAK,EAAd,EAAkB;AAChBA,QAAAA,KAAK,GAAG,IAAR;AACD;;AACD,UAAI89C,IAAI,GAAGkB,EAAE,CAAC37B,GAAD,CAAb;AACA,UAAIg8B,aAAa,GAAGvB,IAAI,CAAC57B,IAAL,CAAU9kB,IAAV,CAApB;;AACA,UAAI,CAAC0gD,IAAI,CAACx/C,MAAV,EAAkB;AAChB;AACD;;AACD,UAAI+8C,IAAI,GAAGT,SAAS,CAACx9C,IAAD,CAApB;;AACA,UAAIi+C,IAAI,IAAIA,IAAI,CAAC55B,GAAjB,EAAsB;AACpB45B,QAAAA,IAAI,CAAC55B,GAAL,CAASq8B,IAAT,EAAe99C,KAAf,EAAsB5C,IAAtB;AACD,OAFD,MAEO;AACL0gD,QAAAA,IAAI,CAAC57B,IAAL,CAAU9kB,IAAV,EAAgB4C,KAAhB;AACD;;AACD,UAAIq/C,aAAa,KAAKr/C,KAAlB,IAA2B4wB,QAAQ,CAAC0uB,WAAxC,EAAqD;AACnD1uB,QAAAA,QAAQ,CAAC0uB,WAAT,CAAqB;AACnBC,UAAAA,OAAO,EAAEzB,IADU;AAEnB79B,UAAAA,QAAQ,EAAE7iB,IAFS;AAGnB+iB,UAAAA,SAAS,EAAEngB;AAHQ,SAArB;AAKD;AACF,KAtBD;;AAuBA,QAAIrC,KAAK,GAAG,UAAUuX,IAAV,EAAgBsqC,IAAhB,EAAsB;AAChC,UAAI,CAAC/wC,IAAD,IAASyG,IAAI,CAACwB,QAAL,KAAkB,CAA3B,IAAgC8oC,IAApC,EAA0C;AACxC,eAAOtqC,IAAI,CAACilC,SAAL,CAAeqF,IAAf,CAAP;AACD,OAFD,MAEO;AACL,YAAIC,OAAO,GAAGlrC,GAAG,CAACE,aAAJ,CAAkBS,IAAI,CAAC6C,QAAvB,CAAd;AACAulC,QAAAA,MAAM,CAAC6B,UAAU,CAACjqC,IAAD,CAAX,EAAmB,UAAUgN,IAAV,EAAgB;AACvCk9B,UAAAA,SAAS,CAACK,OAAD,EAAUv9B,IAAI,CAACnK,QAAf,EAAyBknC,SAAS,CAAC/pC,IAAD,EAAOgN,IAAI,CAACnK,QAAZ,CAAlC,CAAT;AACD,SAFK,CAAN;AAGA,eAAO0nC,OAAP;AACD;AACF,KAVD;;AAWA,QAAIV,OAAO,GAAG,YAAY;AACxB,aAAOnuB,QAAQ,CAAC8uB,YAAT,IAAyBnrC,GAAG,CAACiI,IAApC;AACD,KAFD;;AAGA,QAAImjC,WAAW,GAAG,UAAUC,MAAV,EAAkB;AAClC,UAAIC,EAAE,GAAGlhC,SAAS,CAACihC,MAAD,CAAlB;AACA,aAAO;AACL/iD,QAAAA,CAAC,EAAEgjD,EAAE,CAAChjD,CADD;AAELqB,QAAAA,CAAC,EAAE2hD,EAAE,CAAC3hD,CAFD;AAGL4hD,QAAAA,CAAC,EAAED,EAAE,CAACthC,KAHD;AAILwhC,QAAAA,CAAC,EAAEF,EAAE,CAACrhC;AAJD,OAAP;AAMD,KARD;;AASA,QAAIwhC,QAAQ,GAAG,UAAU38B,GAAV,EAAeQ,OAAf,EAAwB;AACrC,aAAOD,MAAM,CAACrP,GAAG,CAACiI,IAAL,EAAWvW,GAAG,CAACod,GAAD,CAAd,EAAqBQ,OAArB,CAAb;AACD,KAFD;;AAGA,QAAIo8B,QAAQ,GAAG,UAAU58B,GAAV,EAAejmB,IAAf,EAAqB4C,KAArB,EAA4B;AACzC,UAAI89C,IAAI,GAAGr6C,QAAQ,CAACrG,IAAD,CAAR,GAAiB4hD,EAAE,CAAC37B,GAAD,CAAF,CAAQd,GAAR,CAAYnlB,IAAZ,EAAkB4C,KAAlB,CAAjB,GAA4Cg/C,EAAE,CAAC37B,GAAD,CAAF,CAAQd,GAAR,CAAYnlB,IAAZ,CAAvD;;AACA,UAAIwzB,QAAQ,CAACsvB,aAAb,EAA4B;AAC1BlC,QAAAA,uBAAuB,CAACv7B,MAAD,EAASq7B,IAAT,CAAvB;AACD;AACF,KALD;;AAMA,QAAIqC,SAAS,GAAG,UAAU98B,GAAV,EAAe+8B,SAAf,EAA0B;AACxC,UAAItC,IAAI,GAAGkB,EAAE,CAAC37B,GAAD,CAAF,CAAQd,GAAR,CAAY69B,SAAZ,CAAX;;AACA,UAAIxvB,QAAQ,CAACsvB,aAAb,EAA4B;AAC1BlC,QAAAA,uBAAuB,CAACv7B,MAAD,EAASq7B,IAAT,CAAvB;AACD;AACF,KALD;;AAMA,QAAIuC,QAAQ,GAAG,UAAUh9B,GAAV,EAAejmB,IAAf,EAAqByiB,QAArB,EAA+B;AAC5C,UAAIi+B,IAAI,GAAGkB,EAAE,CAAC37B,GAAD,CAAb;;AACA,UAAIxD,QAAJ,EAAc;AACZ,eAAOi+B,IAAI,CAACv7B,GAAL,CAASnlB,IAAT,CAAP;AACD;;AACDA,MAAAA,IAAI,GAAGA,IAAI,CAACkO,OAAL,CAAa,QAAb,EAAuB,UAAUxL,CAAV,EAAamD,CAAb,EAAgB;AAC5C,eAAOA,CAAC,CAACo7B,WAAF,EAAP;AACD,OAFM,CAAP;;AAGA,UAAIjhC,IAAI,KAAK,OAAb,EAAsB;AACpBA,QAAAA,IAAI,GAAG2T,GAAG,CAACjH,OAAJ,CAAY2E,IAAZ,KAAqB,YAArB,GAAoC,UAA3C;AACD;;AACD,aAAOqvC,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAJ,CAAQx8B,KAAnB,GAA2Bw8B,IAAI,CAAC,CAAD,CAAJ,CAAQx8B,KAAR,CAAclkB,IAAd,CAA3B,GAAiDN,SAAxD;AACD,KAZD;;AAaA,QAAIwjD,OAAO,GAAG,UAAUj9B,GAAV,EAAe;AAC3B,UAAIy8B,CAAJ,EAAOC,CAAP;AACA18B,MAAAA,GAAG,GAAGpd,GAAG,CAACod,GAAD,CAAT;AACAy8B,MAAAA,CAAC,GAAGO,QAAQ,CAACh9B,GAAD,EAAM,OAAN,CAAZ;AACA08B,MAAAA,CAAC,GAAGM,QAAQ,CAACh9B,GAAD,EAAM,QAAN,CAAZ;;AACA,UAAIy8B,CAAC,CAACviD,OAAF,CAAU,IAAV,MAAoB,CAAC,CAAzB,EAA4B;AAC1BuiD,QAAAA,CAAC,GAAG,CAAJ;AACD;;AACD,UAAIC,CAAC,CAACxiD,OAAF,CAAU,IAAV,MAAoB,CAAC,CAAzB,EAA4B;AAC1BwiD,QAAAA,CAAC,GAAG,CAAJ;AACD;;AACD,aAAO;AACLD,QAAAA,CAAC,EAAElkB,QAAQ,CAACkkB,CAAD,EAAI,EAAJ,CAAR,IAAmBz8B,GAAG,CAACL,WAAvB,IAAsCK,GAAG,CAACxE,WADxC;AAELkhC,QAAAA,CAAC,EAAEnkB,QAAQ,CAACmkB,CAAD,EAAI,EAAJ,CAAR,IAAmB18B,GAAG,CAACK,YAAvB,IAAuCL,GAAG,CAACvE;AAFzC,OAAP;AAID,KAfD;;AAgBA,QAAIyhC,OAAO,GAAG,UAAUl9B,GAAV,EAAe;AAC3BA,MAAAA,GAAG,GAAGpd,GAAG,CAACod,GAAD,CAAT;AACA,UAAIU,GAAG,GAAGi8B,QAAQ,CAAC38B,GAAD,CAAlB;AACA,UAAIm9B,IAAI,GAAGF,OAAO,CAACj9B,GAAD,CAAlB;AACA,aAAO;AACLxmB,QAAAA,CAAC,EAAEknB,GAAG,CAAClnB,CADF;AAELqB,QAAAA,CAAC,EAAE6lB,GAAG,CAAC7lB,CAFF;AAGL4hD,QAAAA,CAAC,EAAEU,IAAI,CAACV,CAHH;AAILC,QAAAA,CAAC,EAAES,IAAI,CAACT;AAJH,OAAP;AAMD,KAVD;;AAWA,QAAIv+C,EAAE,GAAG,UAAU6hB,GAAV,EAAe5M,QAAf,EAAyB;AAChC,UAAIjY,CAAJ;;AACA,UAAI,CAAC6kB,GAAL,EAAU;AACR,eAAO,KAAP;AACD;;AACD,UAAI,CAACrmB,KAAK,CAAC2G,OAAN,CAAc0f,GAAd,CAAL,EAAyB;AACvB,YAAI5M,QAAQ,KAAK,GAAjB,EAAsB;AACpB,iBAAO4M,GAAG,CAAC3M,QAAJ,KAAiB,CAAxB;AACD;;AACD,YAAI8mC,gBAAgB,CAACrzC,IAAjB,CAAsBsM,QAAtB,CAAJ,EAAqC;AACnC,cAAIs8B,SAAS,GAAGt8B,QAAQ,CAAC9K,WAAT,GAAuB0G,KAAvB,CAA6B,GAA7B,CAAhB;AACA,cAAImwB,OAAO,GAAGnf,GAAG,CAACtL,QAAJ,CAAapM,WAAb,EAAd;;AACA,eAAKnN,CAAC,GAAGu0C,SAAS,CAACz0C,MAAV,GAAmB,CAA5B,EAA+BE,CAAC,IAAI,CAApC,EAAuCA,CAAC,EAAxC,EAA4C;AAC1C,gBAAIu0C,SAAS,CAACv0C,CAAD,CAAT,KAAiBgkC,OAArB,EAA8B;AAC5B,qBAAO,IAAP;AACD;AACF;;AACD,iBAAO,KAAP;AACD;;AACD,YAAInf,GAAG,CAAC3M,QAAJ,IAAgB2M,GAAG,CAAC3M,QAAJ,KAAiB,CAArC,EAAwC;AACtC,iBAAO,KAAP;AACD;AACF;;AACD,UAAI+pC,IAAI,GAAG,CAACzjD,KAAK,CAAC2G,OAAN,CAAc0f,GAAd,CAAD,GAAsB,CAACA,GAAD,CAAtB,GAA8BA,GAAzC;AACA,aAAOssB,MAAM,CAACl5B,QAAD,EAAWgqC,IAAI,CAAC,CAAD,CAAJ,CAAQloC,aAAR,IAAyBkoC,IAAI,CAAC,CAAD,CAAxC,EAA6C,IAA7C,EAAmDA,IAAnD,CAAN,CAA+DniD,MAA/D,GAAwE,CAA/E;AACD,KAzBD;;AA0BA,QAAIoiD,UAAU,GAAG,UAAUr9B,GAAV,EAAe5M,QAAf,EAAyBhE,IAAzB,EAA+BkuC,OAA/B,EAAwC;AACvD,UAAIhyB,MAAM,GAAG,EAAb;AACA,UAAIiyB,WAAJ;AACA,UAAI1rC,IAAI,GAAGjP,GAAG,CAACod,GAAD,CAAd;AACAs9B,MAAAA,OAAO,GAAGA,OAAO,KAAK7jD,SAAtB;AACA2V,MAAAA,IAAI,GAAGA,IAAI,KAAKssC,OAAO,GAAGhnC,QAAV,KAAuB,MAAvB,GAAgCgnC,OAAO,GAAGnmC,UAA1C,GAAuD,IAA5D,CAAX;;AACA,UAAI5E,KAAK,CAACxS,EAAN,CAASiV,QAAT,EAAmB,QAAnB,CAAJ,EAAkC;AAChCmqC,QAAAA,WAAW,GAAGnqC,QAAd;;AACA,YAAIA,QAAQ,KAAK,GAAjB,EAAsB;AACpBA,UAAAA,QAAQ,GAAG,UAAUvB,IAAV,EAAgB;AACzB,mBAAOA,IAAI,CAACwB,QAAL,KAAkB,CAAzB;AACD,WAFD;AAGD,SAJD,MAIO;AACLD,UAAAA,QAAQ,GAAG,UAAUvB,IAAV,EAAgB;AACzB,mBAAO1T,EAAE,CAAC0T,IAAD,EAAO0rC,WAAP,CAAT;AACD,WAFD;AAGD;AACF;;AACD,aAAO1rC,IAAP,EAAa;AACX,YAAIA,IAAI,KAAKzC,IAAT,IAAiB1O,UAAU,CAACmR,IAAI,CAACwB,QAAN,CAA3B,IAA8CmK,YAAY,CAAC3L,IAAD,CAA1D,IAAoE4L,oBAAoB,CAAC5L,IAAD,CAA5F,EAAoG;AAClG;AACD;;AACD,YAAI,CAACuB,QAAD,IAAa,OAAOA,QAAP,KAAoB,UAApB,IAAkCA,QAAQ,CAACvB,IAAD,CAA3D,EAAmE;AACjE,cAAIyrC,OAAJ,EAAa;AACXhyB,YAAAA,MAAM,CAACrqB,IAAP,CAAY4Q,IAAZ;AACD,WAFD,MAEO;AACL,mBAAO,CAACA,IAAD,CAAP;AACD;AACF;;AACDA,QAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,aAAO+nC,OAAO,GAAGhyB,MAAH,GAAY,IAA1B;AACD,KAhCD;;AAiCA,QAAIkyB,SAAS,GAAG,UAAU3rC,IAAV,EAAgBuB,QAAhB,EAA0BhE,IAA1B,EAAgC;AAC9C,UAAIoG,OAAO,GAAG6nC,UAAU,CAACxrC,IAAD,EAAOuB,QAAP,EAAiBhE,IAAjB,EAAuB,KAAvB,CAAxB;AACA,aAAOoG,OAAO,IAAIA,OAAO,CAACva,MAAR,GAAiB,CAA5B,GAAgCua,OAAO,CAAC,CAAD,CAAvC,GAA6C,IAApD;AACD,KAHD;;AAIA,QAAIioC,QAAQ,GAAG,UAAU5rC,IAAV,EAAgBuB,QAAhB,EAA0BrZ,IAA1B,EAAgC;AAC7C,UAAI+yB,IAAI,GAAG1Z,QAAX;;AACA,UAAIvB,IAAJ,EAAU;AACR,YAAI,OAAOuB,QAAP,KAAoB,QAAxB,EAAkC;AAChC0Z,UAAAA,IAAI,GAAG,UAAUjb,IAAV,EAAgB;AACrB,mBAAO1T,EAAE,CAAC0T,IAAD,EAAOuB,QAAP,CAAT;AACD,WAFD;AAGD;;AACD,aAAKvB,IAAI,GAAGA,IAAI,CAAC9X,IAAD,CAAhB,EAAwB8X,IAAxB,EAA8BA,IAAI,GAAGA,IAAI,CAAC9X,IAAD,CAAzC,EAAiD;AAC/C,cAAI,OAAO+yB,IAAP,KAAgB,UAAhB,IAA8BA,IAAI,CAACjb,IAAD,CAAtC,EAA8C;AAC5C,mBAAOA,IAAP;AACD;AACF;AACF;;AACD,aAAO,IAAP;AACD,KAfD;;AAgBA,QAAI6rC,OAAO,GAAG,UAAU7rC,IAAV,EAAgBuB,QAAhB,EAA0B;AACtC,aAAOqqC,QAAQ,CAAC5rC,IAAD,EAAOuB,QAAP,EAAiB,aAAjB,CAAf;AACD,KAFD;;AAGA,QAAIuqC,OAAO,GAAG,UAAU9rC,IAAV,EAAgBuB,QAAhB,EAA0B;AACtC,aAAOqqC,QAAQ,CAAC5rC,IAAD,EAAOuB,QAAP,EAAiB,iBAAjB,CAAf;AACD,KAFD;;AAGA,QAAI41B,MAAM,GAAG,UAAU51B,QAAV,EAAoBnC,KAApB,EAA2B;AACtC,aAAOq7B,MAAM,CAACl5B,QAAD,EAAWxQ,GAAG,CAACqO,KAAD,CAAH,IAAcsc,QAAQ,CAAC8uB,YAAvB,IAAuCnrC,GAAlD,EAAuD,EAAvD,CAAb;AACD,KAFD;;AAGA,QAAIsR,GAAG,GAAG,UAAUxC,GAAV,EAAe8M,IAAf,EAAqB7b,KAArB,EAA4B;AACpC,UAAIqa,MAAJ;AACA,UAAIzZ,IAAI,GAAG,OAAOmO,GAAP,KAAe,QAAf,GAA0Bpd,GAAG,CAACod,GAAD,CAA7B,GAAqCA,GAAhD;;AACA,UAAI,CAACnO,IAAL,EAAW;AACT,eAAO,KAAP;AACD;;AACD,UAAIlB,KAAK,CAACrQ,OAAN,CAAcuR,IAAd,MAAwBA,IAAI,CAAC5W,MAAL,IAAe4W,IAAI,CAAC5W,MAAL,KAAgB,CAAvD,CAAJ,EAA+D;AAC7DqwB,QAAAA,MAAM,GAAG,EAAT;AACA2uB,QAAAA,MAAM,CAACpoC,IAAD,EAAO,UAAUmO,GAAV,EAAe7kB,CAAf,EAAkB;AAC7B,cAAI6kB,GAAJ,EAAS;AACPsL,YAAAA,MAAM,CAACrqB,IAAP,CAAY6rB,IAAI,CAACtyB,IAAL,CAAUyW,KAAV,EAAiB,OAAO+O,GAAP,KAAe,QAAf,GAA0Bpd,GAAG,CAACod,GAAD,CAA7B,GAAqCA,GAAtD,EAA2D7kB,CAA3D,CAAZ;AACD;AACF,SAJK,CAAN;AAKA,eAAOmwB,MAAP;AACD;;AACD,UAAIihB,OAAO,GAAGt7B,KAAK,GAAGA,KAAH,GAAW,IAA9B;AACA,aAAO6b,IAAI,CAACtyB,IAAL,CAAU+xC,OAAV,EAAmB16B,IAAnB,CAAP;AACD,KAjBD;;AAkBA,QAAI+rC,UAAU,GAAG,UAAU59B,GAAV,EAAe1B,KAAf,EAAsB;AACrCq9B,MAAAA,EAAE,CAAC37B,GAAD,CAAF,CAAQnhB,IAAR,CAAa,UAAU1D,CAAV,EAAa0W,IAAb,EAAmB;AAC9BooC,QAAAA,MAAM,CAAC37B,KAAD,EAAQ,UAAU3hB,KAAV,EAAiB5C,IAAjB,EAAuB;AACnCgiD,UAAAA,SAAS,CAAClqC,IAAD,EAAO9X,IAAP,EAAa4C,KAAb,CAAT;AACD,SAFK,CAAN;AAGD,OAJD;AAKD,KAND;;AAOA,QAAIkhD,OAAO,GAAG,UAAU79B,GAAV,EAAehP,IAAf,EAAqB;AACjC,UAAIypC,IAAI,GAAGkB,EAAE,CAAC37B,GAAD,CAAb;;AACA,UAAI5U,IAAJ,EAAU;AACRqvC,QAAAA,IAAI,CAAC57C,IAAL,CAAU,UAAU1D,CAAV,EAAakP,MAAb,EAAqB;AAC7B,cAAIA,MAAM,CAACyzC,WAAP,KAAuB,KAA3B,EAAkC;AAChC;AACD;;AACD,iBAAOzzC,MAAM,CAACmM,UAAd,EAA0B;AACxBnM,YAAAA,MAAM,CAAC0O,WAAP,CAAmB1O,MAAM,CAACmM,UAA1B;AACD;;AACD,cAAI;AACFnM,YAAAA,MAAM,CAACgH,SAAP,GAAmB,SAASL,IAA5B;AACA3G,YAAAA,MAAM,CAAC0O,WAAP,CAAmB1O,MAAM,CAACmM,UAA1B;AACD,WAHD,CAGE,OAAO6O,EAAP,EAAW;AACXmxB,YAAAA,QAAQ,CAAC,aAAD,CAAR,CAAwBxlC,IAAxB,CAA6B,SAASA,IAAtC,EAA4C4nC,QAA5C,GAAuDr+C,KAAvD,CAA6D,CAA7D,EAAgE+9C,QAAhE,CAAyEjuC,MAAzE;AACD;;AACD,iBAAO2G,IAAP;AACD,SAdD;AAeD,OAhBD,MAgBO;AACLypC,QAAAA,IAAI,CAACzpC,IAAL,CAAUA,IAAV;AACD;AACF,KArBD;;AAsBA,QAAIspB,GAAG,GAAG,UAAUyjB,SAAV,EAAqBhkD,IAArB,EAA2BukB,KAA3B,EAAkCtN,IAAlC,EAAwC7B,MAAxC,EAAgD;AACxD,aAAOqT,GAAG,CAACu7B,SAAD,EAAY,UAAUA,SAAV,EAAqB;AACzC,YAAIC,MAAM,GAAG,OAAOjkD,IAAP,KAAgB,QAAhB,GAA2BmX,GAAG,CAACE,aAAJ,CAAkBrX,IAAlB,CAA3B,GAAqDA,IAAlE;AACA6jD,QAAAA,UAAU,CAACI,MAAD,EAAS1/B,KAAT,CAAV;;AACA,YAAItN,IAAJ,EAAU;AACR,cAAI,OAAOA,IAAP,KAAgB,QAAhB,IAA4BA,IAAI,CAACqC,QAArC,EAA+C;AAC7C2qC,YAAAA,MAAM,CAAC1lC,WAAP,CAAmBtH,IAAnB;AACD,WAFD,MAEO,IAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AACnC6sC,YAAAA,OAAO,CAACG,MAAD,EAAShtC,IAAT,CAAP;AACD;AACF;;AACD,eAAO,CAAC7B,MAAD,GAAU4uC,SAAS,CAACzlC,WAAV,CAAsB0lC,MAAtB,CAAV,GAA0CA,MAAjD;AACD,OAXS,CAAV;AAYD,KAbD;;AAcA,QAAI7uC,MAAM,GAAG,UAAUpV,IAAV,EAAgBukB,KAAhB,EAAuBtN,IAAvB,EAA6B;AACxC,aAAOspB,GAAG,CAACppB,GAAG,CAACE,aAAJ,CAAkBrX,IAAlB,CAAD,EAA0BA,IAA1B,EAAgCukB,KAAhC,EAAuCtN,IAAvC,EAA6C,IAA7C,CAAV;AACD,KAFD;;AAGA,QAAIsoB,MAAM,GAAGC,QAAQ,CAACD,MAAtB;AACA,QAAI2J,MAAM,GAAG1J,QAAQ,CAACb,YAAtB;;AACA,QAAIulB,UAAU,GAAG,UAAUlkD,IAAV,EAAgBukB,KAAhB,EAAuBtN,IAAvB,EAA6B;AAC5C,UAAIktC,OAAO,GAAG,EAAd;AAAA,UAAkBh6C,GAAlB;AACAg6C,MAAAA,OAAO,IAAI,MAAMnkD,IAAjB;;AACA,WAAKmK,GAAL,IAAYoa,KAAZ,EAAmB;AACjB,YAAIA,KAAK,CAACrb,cAAN,CAAqBiB,GAArB,KAA6Boa,KAAK,CAACpa,GAAD,CAAL,KAAe,IAA5C,IAAoD,OAAOoa,KAAK,CAACpa,GAAD,CAAZ,KAAsB,WAA9E,EAA2F;AACzFg6C,UAAAA,OAAO,IAAI,MAAMh6C,GAAN,GAAY,IAAZ,GAAmB++B,MAAM,CAAC3kB,KAAK,CAACpa,GAAD,CAAN,CAAzB,GAAwC,GAAnD;AACD;AACF;;AACD,UAAI,OAAO8M,IAAP,KAAgB,WAApB,EAAiC;AAC/B,eAAOktC,OAAO,GAAG,GAAV,GAAgBltC,IAAhB,GAAuB,IAAvB,GAA8BjX,IAA9B,GAAqC,GAA5C;AACD;;AACD,aAAOmkD,OAAO,GAAG,KAAjB;AACD,KAZD;;AAaA,QAAIlI,cAAc,GAAG,UAAUhlC,IAAV,EAAgB;AACnC,UAAIa,IAAJ;AACA,UAAItD,SAAS,GAAG2C,GAAG,CAACE,aAAJ,CAAkB,KAAlB,CAAhB;AACA,UAAI8kC,IAAI,GAAGhlC,GAAG,CAACilC,sBAAJ,EAAX;AACAD,MAAAA,IAAI,CAAC59B,WAAL,CAAiB/J,SAAjB;;AACA,UAAIyC,IAAJ,EAAU;AACRzC,QAAAA,SAAS,CAAC8C,SAAV,GAAsBL,IAAtB;AACD;;AACD,aAAOa,IAAI,GAAGtD,SAAS,CAACiI,UAAxB,EAAoC;AAClC0/B,QAAAA,IAAI,CAAC59B,WAAL,CAAiBzG,IAAjB;AACD;;AACDqkC,MAAAA,IAAI,CAACn9B,WAAL,CAAiBxK,SAAjB;AACA,aAAO2nC,IAAP;AACD,KAbD;;AAcA,QAAIp9B,MAAM,GAAG,UAAUjH,IAAV,EAAgBssC,YAAhB,EAA8B;AACzC,UAAIC,KAAK,GAAGzC,EAAE,CAAC9pC,IAAD,CAAd;;AACA,UAAIssC,YAAJ,EAAkB;AAChBC,QAAAA,KAAK,CAACv/C,IAAN,CAAW,YAAY;AACrB,cAAIyX,KAAJ;;AACA,iBAAOA,KAAK,GAAG,KAAKE,UAApB,EAAgC;AAC9B,gBAAIF,KAAK,CAACjD,QAAN,KAAmB,CAAnB,IAAwBiD,KAAK,CAACmR,IAAN,CAAWxsB,MAAX,KAAsB,CAAlD,EAAqD;AACnD,mBAAK8d,WAAL,CAAiBzC,KAAjB;AACD,aAFD,MAEO;AACL,mBAAKf,UAAL,CAAgByC,YAAhB,CAA6B1B,KAA7B,EAAoC,IAApC;AACD;AACF;AACF,SATD,EASGwC,MATH;AAUD,OAXD,MAWO;AACLslC,QAAAA,KAAK,CAACtlC,MAAN;AACD;;AACD,aAAOslC,KAAK,CAACnjD,MAAN,GAAe,CAAf,GAAmBmjD,KAAK,CAACh/C,OAAN,EAAnB,GAAqCg/C,KAAK,CAAC,CAAD,CAAjD;AACD,KAjBD;;AAkBA,QAAIC,gBAAgB,GAAG,UAAUv4C,CAAV,EAAa;AAClC,aAAO0c,GAAG,CAAC1c,CAAD,EAAI,UAAUA,CAAV,EAAa;AACzB,YAAI3K,CAAJ;AACA,YAAImjB,KAAK,GAAGxY,CAAC,CAAC8Y,UAAd;;AACA,aAAKzjB,CAAC,GAAGmjB,KAAK,CAACrjB,MAAN,GAAe,CAAxB,EAA2BE,CAAC,IAAI,CAAhC,EAAmCA,CAAC,EAApC,EAAwC;AACtC2K,UAAAA,CAAC,CAACw4C,mBAAF,CAAsBhgC,KAAK,CAACxZ,IAAN,CAAW3J,CAAX,CAAtB;AACD;AACF,OANS,CAAV;AAOD,KARD;;AASA,QAAIojD,UAAU,GAAG,UAAUC,OAAV,EAAmB;AAClC,aAAOp/B,MAAM,CAACkjB,KAAP,CAAakc,OAAb,CAAP;AACD,KAFD;;AAGA,QAAIC,cAAc,GAAG,UAAU1B,SAAV,EAAqBhjD,IAArB,EAA2B;AAC9C,aAAOqlB,MAAM,CAAC2kB,SAAP,CAAiBgZ,SAAjB,EAA4BhjD,IAA5B,CAAP;AACD,KAFD;;AAGA,QAAI+zB,QAAQ,GAAG,UAAU0wB,OAAV,EAAmB;AAChC,UAAI37C,IAAJ,EAAU67C,QAAV;;AACA,UAAIl/C,IAAI,KAAKw7C,QAAQ,CAAC2D,GAAlB,IAAyBztC,GAAG,KAAK9C,QAArC,EAA+C;AAC7C,YAAI6sC,WAAW,CAACuD,OAAD,CAAf,EAA0B;AACxB;AACD;;AACDvD,QAAAA,WAAW,CAACuD,OAAD,CAAX,GAAuB,IAAvB;AACD;;AACDE,MAAAA,QAAQ,GAAGxtC,GAAG,CAAC87B,cAAJ,CAAmB,kBAAnB,CAAX;;AACA,UAAI,CAAC0R,QAAL,EAAe;AACbA,QAAAA,QAAQ,GAAGxtC,GAAG,CAACE,aAAJ,CAAkB,OAAlB,CAAX;AACAstC,QAAAA,QAAQ,CAAC5gD,EAAT,GAAc,kBAAd;AACA4gD,QAAAA,QAAQ,CAACz+C,IAAT,GAAgB,UAAhB;AACA4C,QAAAA,IAAI,GAAGqO,GAAG,CAACsjB,oBAAJ,CAAyB,MAAzB,EAAiC,CAAjC,CAAP;;AACA,YAAI3xB,IAAI,CAAC2T,UAAT,EAAqB;AACnB3T,UAAAA,IAAI,CAACmV,YAAL,CAAkB0mC,QAAlB,EAA4B77C,IAAI,CAAC2T,UAAjC;AACD,SAFD,MAEO;AACL3T,UAAAA,IAAI,CAACyV,WAAL,CAAiBomC,QAAjB;AACD;AACF;;AACD,UAAIA,QAAQ,CAACrvB,UAAb,EAAyB;AACvBqvB,QAAAA,QAAQ,CAACrvB,UAAT,CAAoBmvB,OAApB,IAA+BA,OAA/B;AACD,OAFD,MAEO;AACLE,QAAAA,QAAQ,CAACpmC,WAAT,CAAqBpH,GAAG,CAACc,cAAJ,CAAmBwsC,OAAnB,CAArB;AACD;AACF,KAzBD;;AA0BA,QAAII,OAAO,GAAG,UAAUhvB,IAAV,EAAgB;AAC5B,UAAI,CAACA,IAAL,EAAW;AACTA,QAAAA,IAAI,GAAG,EAAP;AACD;;AACD/wB,MAAAA,IAAI,CAAC+wB,IAAI,CAAC5gB,KAAL,CAAW,GAAX,CAAD,EAAkB,UAAU0B,GAAV,EAAe;AACnCwqC,QAAAA,KAAK,CAACxqC,GAAD,CAAL,GAAa,IAAb;AACA4qC,QAAAA,gBAAgB,CAACltB,IAAjB,CAAsB1d,GAAtB,EAA2B5U,IAA3B;AACD,OAHG,CAAJ;AAID,KARD;;AASA,QAAIg9C,WAAW,GAAG,UAAU94B,GAAV,EAAe6+B,GAAf,EAAoBpwB,KAApB,EAA2B;AAC3CktB,MAAAA,EAAE,CAAC37B,GAAD,CAAF,CAAQ84B,WAAR,CAAoB+F,GAApB,EAAyBpwB,KAAzB,EAAgC5vB,IAAhC,CAAqC,YAAY;AAC/C,YAAI,KAAKyvC,SAAL,KAAmB,EAAvB,EAA2B;AACzBkI,UAAAA,QAAQ,CAAC,IAAD,CAAR,CAAe33B,IAAf,CAAoB,OAApB,EAA6B,IAA7B;AACD;AACF,OAJD;AAKD,KAND;;AAOA,QAAIg6B,QAAQ,GAAG,UAAU74B,GAAV,EAAe6+B,GAAf,EAAoB;AACjClD,MAAAA,EAAE,CAAC37B,GAAD,CAAF,CAAQ64B,QAAR,CAAiBgG,GAAjB;AACD,KAFD;;AAGA,QAAI9F,WAAW,GAAG,UAAU/4B,GAAV,EAAe6+B,GAAf,EAAoB;AACpC/F,MAAAA,WAAW,CAAC94B,GAAD,EAAM6+B,GAAN,EAAW,KAAX,CAAX;AACD,KAFD;;AAGA,QAAInI,QAAQ,GAAG,UAAU12B,GAAV,EAAe6+B,GAAf,EAAoB;AACjC,aAAOlD,EAAE,CAAC37B,GAAD,CAAF,CAAQ02B,QAAR,CAAiBmI,GAAjB,CAAP;AACD,KAFD;;AAGA,QAAI1F,IAAI,GAAG,UAAUn5B,GAAV,EAAe;AACxB27B,MAAAA,EAAE,CAAC37B,GAAD,CAAF,CAAQm5B,IAAR;AACD,KAFD;;AAGA,QAAIC,IAAI,GAAG,UAAUp5B,GAAV,EAAe;AACxB27B,MAAAA,EAAE,CAAC37B,GAAD,CAAF,CAAQo5B,IAAR;AACD,KAFD;;AAGA,QAAI0F,QAAQ,GAAG,UAAU9+B,GAAV,EAAe;AAC5B,aAAO27B,EAAE,CAAC37B,GAAD,CAAF,CAAQd,GAAR,CAAY,SAAZ,MAA2B,MAAlC;AACD,KAFD;;AAGA,QAAI6/B,QAAQ,GAAG,UAAUn1C,MAAV,EAAkB;AAC/B,aAAO,CAAC,CAACA,MAAD,GAAU,MAAV,GAAmBA,MAApB,IAA8BuxC,OAAO,EAA5C;AACD,KAFD;;AAGA,QAAI6D,YAAY,GAAG,UAAUh/B,GAAV,EAAe;AAChC,UAAInO,IAAI,GAAG,OAAOmO,GAAP,KAAe,QAAf,GAA0Bpd,GAAG,CAACod,GAAD,CAA7B,GAAqCA,GAAhD;AACA,aAAO9D,WAAW,CAACrK,IAAD,CAAX,GAAoBA,IAAI,CAACotC,SAAzB,GAAqCzI,QAAQ,CAAC,aAAD,CAAR,CAAwBr+B,MAAxB,CAA+Bq+B,QAAQ,CAAC3kC,IAAD,CAAR,CAAevX,KAAf,EAA/B,EAAuD0W,IAAvD,EAA5C;AACD,KAHD;;AAIA,QAAIkuC,YAAY,GAAG,UAAUl/B,GAAV,EAAehP,IAAf,EAAqB;AACtC2qC,MAAAA,EAAE,CAAC37B,GAAD,CAAF,CAAQnhB,IAAR,CAAa,YAAY;AACvB,YAAI;AACF,cAAI,eAAe,IAAnB,EAAyB;AACvB,iBAAKogD,SAAL,GAAiBjuC,IAAjB;AACA;AACD;AACF,SALD,CAKE,OAAOqU,EAAP,EAAW,CACZ;;AACDvM,QAAAA,MAAM,CAAC09B,QAAQ,CAAC,IAAD,CAAR,CAAexlC,IAAf,CAAoBA,IAApB,CAAD,EAA4B,IAA5B,CAAN;AACD,OATD;AAUD,KAXD;;AAYA,QAAImuC,WAAW,GAAG,UAAUttC,IAAV,EAAgButC,SAAhB,EAA2B;AAC3C,UAAIC,aAAa,GAAGz8C,GAAG,CAACw8C,SAAD,CAAvB;AACA,aAAO58B,GAAG,CAAC3Q,IAAD,EAAO,UAAUA,IAAV,EAAgB;AAC/B,YAAI5B,MAAM,GAAGovC,aAAa,CAAC9pC,UAA3B;AACA,YAAIY,WAAW,GAAGkpC,aAAa,CAAClpC,WAAhC;;AACA,YAAIA,WAAJ,EAAiB;AACflG,UAAAA,MAAM,CAAC+H,YAAP,CAAoBnG,IAApB,EAA0BsE,WAA1B;AACD,SAFD,MAEO;AACLlG,UAAAA,MAAM,CAACqI,WAAP,CAAmBzG,IAAnB;AACD;;AACD,eAAOA,IAAP;AACD,OATS,CAAV;AAUD,KAZD;;AAaA,QAAI5J,OAAO,GAAG,UAAU+1C,MAAV,EAAkBsB,MAAlB,EAA0BnB,YAA1B,EAAwC;AACpD,aAAO37B,GAAG,CAAC88B,MAAD,EAAS,UAAUA,MAAV,EAAkB;AACnC,YAAI3uC,KAAK,CAACxS,EAAN,CAASmhD,MAAT,EAAiB,OAAjB,CAAJ,EAA+B;AAC7BtB,UAAAA,MAAM,GAAGA,MAAM,CAAClH,SAAP,CAAiB,IAAjB,CAAT;AACD;;AACD,YAAIqH,YAAJ,EAAkB;AAChBlE,UAAAA,MAAM,CAACC,MAAM,CAACoF,MAAM,CAAC/tC,UAAR,CAAP,EAA4B,UAAUM,IAAV,EAAgB;AAChDmsC,YAAAA,MAAM,CAAC1lC,WAAP,CAAmBzG,IAAnB;AACD,WAFK,CAAN;AAGD;;AACD,eAAOytC,MAAM,CAAC/pC,UAAP,CAAkBgqC,YAAlB,CAA+BvB,MAA/B,EAAuCsB,MAAvC,CAAP;AACD,OAVS,CAAV;AAWD,KAZD;;AAaA,QAAIE,MAAM,GAAG,UAAUx/B,GAAV,EAAejmB,IAAf,EAAqB;AAChC,UAAIikD,MAAJ;;AACA,UAAIh+B,GAAG,CAACtL,QAAJ,KAAiB3a,IAAI,CAACihC,WAAL,EAArB,EAAyC;AACvCgjB,QAAAA,MAAM,GAAG7uC,MAAM,CAACpV,IAAD,CAAf;AACAkgD,QAAAA,MAAM,CAAC6B,UAAU,CAAC97B,GAAD,CAAX,EAAkB,UAAUy/B,QAAV,EAAoB;AAC1C1D,UAAAA,SAAS,CAACiC,MAAD,EAASyB,QAAQ,CAAC/qC,QAAlB,EAA4BknC,SAAS,CAAC57B,GAAD,EAAMy/B,QAAQ,CAAC/qC,QAAf,CAArC,CAAT;AACD,SAFK,CAAN;AAGAzM,QAAAA,OAAO,CAAC+1C,MAAD,EAASh+B,GAAT,EAAc,IAAd,CAAP;AACD;;AACD,aAAOg+B,MAAM,IAAIh+B,GAAjB;AACD,KAVD;;AAWA,QAAI0/B,kBAAkB,GAAG,UAAUjjD,CAAV,EAAamD,CAAb,EAAgB;AACvC,UAAI+/C,EAAE,GAAGljD,CAAT;AAAA,UAAYmjD,EAAZ;;AACA,aAAOD,EAAP,EAAW;AACTC,QAAAA,EAAE,GAAGhgD,CAAL;;AACA,eAAOggD,EAAE,IAAID,EAAE,KAAKC,EAApB,EAAwB;AACtBA,UAAAA,EAAE,GAAGA,EAAE,CAACrqC,UAAR;AACD;;AACD,YAAIoqC,EAAE,KAAKC,EAAX,EAAe;AACb;AACD;;AACDD,QAAAA,EAAE,GAAGA,EAAE,CAACpqC,UAAR;AACD;;AACD,UAAI,CAACoqC,EAAD,IAAOljD,CAAC,CAACyY,aAAb,EAA4B;AAC1B,eAAOzY,CAAC,CAACyY,aAAF,CAAgBG,eAAvB;AACD;;AACD,aAAOsqC,EAAP;AACD,KAhBD;;AAiBA,QAAIje,KAAK,GAAG,UAAUme,MAAV,EAAkB;AAC5B,aAAOzgC,MAAM,CAACsiB,KAAP,CAAa/wB,KAAK,CAAC3G,IAAN,CAAW61C,MAAX,CAAb,CAAP;AACD,KAFD;;AAGA,QAAIC,iBAAiB,GAAG,UAAUjuC,IAAV,EAAgB;AACtC,UAAIqK,WAAW,CAACrK,IAAD,CAAf,EAAuB;AACrB,YAAIqkB,aAAa,GAAGrkB,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,OAAgC,GAAhC,IAAuC,CAACszC,SAAS,CAAC/pC,IAAD,EAAO,MAAP,CAAjD,IAAmE+pC,SAAS,CAAC/pC,IAAD,EAAO,IAAP,CAAhG;;AACA,YAAI+pC,SAAS,CAAC/pC,IAAD,EAAO,MAAP,CAAT,IAA2B+pC,SAAS,CAAC/pC,IAAD,EAAO,mBAAP,CAApC,IAAmEqkB,aAAvE,EAAsF;AACpF,iBAAO,IAAP;AACD;AACF;;AACD,aAAO,KAAP;AACD,KARD;;AASA,QAAIU,OAAO,GAAG,UAAU/kB,IAAV,EAAgBkE,QAAhB,EAA0B;AACtC,UAAI9V,IAAJ;AAAA,UAAUlG,IAAV;AAAA,UAAgB28B,OAAO,GAAG,CAA1B;;AACA,UAAIopB,iBAAiB,CAACjuC,IAAD,CAArB,EAA6B;AAC3B,eAAO,KAAP;AACD;;AACDA,MAAAA,IAAI,GAAGA,IAAI,CAAC2E,UAAZ;;AACA,UAAI3E,IAAJ,EAAU;AACR,YAAI8kB,MAAM,GAAG,IAAIpG,aAAJ,CAAkB1e,IAAlB,EAAwBA,IAAI,CAAC0D,UAA7B,CAAb;AACA,YAAIi1B,UAAU,GAAGzQ,MAAM,GAAGA,MAAM,CAACqH,qBAAP,EAAH,GAAoC,EAA3D;AACArrB,QAAAA,QAAQ,GAAGA,QAAQ,KAAKgkB,MAAM,GAAGA,MAAM,CAACmH,mBAAP,EAAH,GAAkC,IAA7C,CAAnB;;AACA,WAAG;AACDjhC,UAAAA,IAAI,GAAG4R,IAAI,CAACwB,QAAZ;;AACA,cAAI6I,WAAW,CAACrK,IAAD,CAAf,EAAuB;AACrB,gBAAIkuC,QAAQ,GAAGluC,IAAI,CAACkL,YAAL,CAAkB,gBAAlB,CAAf;;AACA,gBAAIgjC,QAAJ,EAAc;AACZluC,cAAAA,IAAI,GAAG8kB,MAAM,CAACjG,IAAP,CAAYqvB,QAAQ,KAAK,KAAzB,CAAP;AACA;AACD;;AACDhmD,YAAAA,IAAI,GAAG8X,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,EAAP;;AACA,gBAAIyN,QAAQ,IAAIA,QAAQ,CAAChc,IAAD,CAAxB,EAAgC;AAC9B,kBAAIA,IAAI,KAAK,IAAb,EAAmB;AACjB28B,gBAAAA,OAAO;AACP7kB,gBAAAA,IAAI,GAAG8kB,MAAM,CAACjG,IAAP,EAAP;AACA;AACD;;AACD,qBAAO,KAAP;AACD;;AACD,gBAAIovB,iBAAiB,CAACjuC,IAAD,CAArB,EAA6B;AAC3B,qBAAO,KAAP;AACD;AACF;;AACD,cAAI5R,IAAI,KAAK,CAAb,EAAgB;AACd,mBAAO,KAAP;AACD;;AACD,cAAIA,IAAI,KAAK,CAAT,IAAc,CAAC61B,gBAAgB,CAACjkB,IAAI,CAAC49B,SAAN,CAAnC,EAAqD;AACnD,mBAAO,KAAP;AACD;;AACD,cAAIxvC,IAAI,KAAK,CAAT,IAAc4R,IAAI,CAAC0D,UAAnB,IAAiCi1B,UAAU,CAAC34B,IAAI,CAAC0D,UAAL,CAAgBb,QAAjB,CAA3C,IAAyEohB,gBAAgB,CAACjkB,IAAI,CAAC49B,SAAN,CAA7F,EAA+G;AAC7G,mBAAO,KAAP;AACD;;AACD59B,UAAAA,IAAI,GAAG8kB,MAAM,CAACjG,IAAP,EAAP;AACD,SA/BD,QA+BS7e,IA/BT;AAgCD;;AACD,aAAO6kB,OAAO,IAAI,CAAlB;AACD,KA5CD;;AA6CA,QAAIspB,SAAS,GAAG,YAAY;AAC1B,aAAO9uC,GAAG,CAAC+uC,WAAJ,EAAP;AACD,KAFD;;AAGA,QAAIjxC,KAAK,GAAG,UAAU+uC,SAAV,EAAqBmC,QAArB,EAA+BC,cAA/B,EAA+C;AACzD,UAAIlyC,KAAK,GAAG+xC,SAAS,EAArB;AACA,UAAII,cAAJ;AACA,UAAIC,aAAJ;AACA,UAAI9qC,UAAJ;;AACA,UAAIwoC,SAAS,IAAImC,QAAjB,EAA2B;AACzBjyC,QAAAA,KAAK,CAACqyC,QAAN,CAAevC,SAAS,CAACxoC,UAAzB,EAAqCslC,aAAa,CAACkD,SAAD,CAAlD;AACA9vC,QAAAA,KAAK,CAACsyC,MAAN,CAAaL,QAAQ,CAAC3qC,UAAtB,EAAkCslC,aAAa,CAACqF,QAAD,CAA/C;AACAE,QAAAA,cAAc,GAAGnyC,KAAK,CAACuyC,eAAN,EAAjB;AACAvyC,QAAAA,KAAK,GAAG+xC,SAAS,EAAjB;AACA/xC,QAAAA,KAAK,CAACqyC,QAAN,CAAeJ,QAAQ,CAAC3qC,UAAxB,EAAoCslC,aAAa,CAACqF,QAAD,CAAb,GAA0B,CAA9D;AACAjyC,QAAAA,KAAK,CAACsyC,MAAN,CAAaxC,SAAS,CAACxoC,UAAvB,EAAmCslC,aAAa,CAACkD,SAAD,CAAb,GAA2B,CAA9D;AACAsC,QAAAA,aAAa,GAAGpyC,KAAK,CAACuyC,eAAN,EAAhB;AACAjrC,QAAAA,UAAU,GAAGwoC,SAAS,CAACxoC,UAAvB;AACAA,QAAAA,UAAU,CAACyC,YAAX,CAAwBsf,QAAQ,CAAC93B,IAAD,EAAO4gD,cAAP,CAAhC,EAAwDrC,SAAxD;;AACA,YAAIoC,cAAJ,EAAoB;AAClB5qC,UAAAA,UAAU,CAACyC,YAAX,CAAwBmoC,cAAxB,EAAwCpC,SAAxC;AACD,SAFD,MAEO;AACLxoC,UAAAA,UAAU,CAACyC,YAAX,CAAwBkoC,QAAxB,EAAkCnC,SAAlC;AACD;;AACDxoC,QAAAA,UAAU,CAACyC,YAAX,CAAwBsf,QAAQ,CAAC93B,IAAD,EAAO6gD,aAAP,CAAhC,EAAuDtC,SAAvD;AACAjlC,QAAAA,MAAM,CAACilC,SAAD,CAAN;AACA,eAAOoC,cAAc,IAAID,QAAzB;AACD;AACF,KAxBD;;AAyBA,QAAIphD,IAAI,GAAG,UAAUuL,MAAV,EAAkBtQ,IAAlB,EAAwB+yB,IAAxB,EAA8B7b,KAA9B,EAAqC;AAC9C,UAAIN,KAAK,CAACrQ,OAAN,CAAc+J,MAAd,CAAJ,EAA2B;AACzB,YAAIlP,CAAC,GAAGkP,MAAM,CAACpP,MAAf;AACA,YAAIwlD,EAAE,GAAG,EAAT;;AACA,eAAOtlD,CAAC,EAAR,EAAY;AACVslD,UAAAA,EAAE,CAACtlD,CAAD,CAAF,GAAQ2D,IAAI,CAACuL,MAAM,CAAClP,CAAD,CAAP,EAAYpB,IAAZ,EAAkB+yB,IAAlB,EAAwB7b,KAAxB,CAAZ;AACD;;AACD,eAAOwvC,EAAP;AACD;;AACD,UAAIlzB,QAAQ,CAAC+vB,OAAT,KAAqBjzC,MAAM,KAAK6G,GAAX,IAAkB7G,MAAM,KAAKwP,GAAlD,CAAJ,EAA4D;AAC1D0hC,QAAAA,WAAW,CAACt6C,IAAZ,CAAiB,CACfoJ,MADe,EAEftQ,IAFe,EAGf+yB,IAHe,EAIf7b,KAJe,CAAjB;AAMD;;AACD,UAAIyvC,MAAM,GAAGxZ,MAAM,CAACpoC,IAAP,CAAYuL,MAAZ,EAAoBtQ,IAApB,EAA0B+yB,IAA1B,EAAgC7b,KAAK,IAAIzR,IAAzC,CAAb;AACA,aAAOkhD,MAAP;AACD,KAnBD;;AAoBA,QAAIzY,MAAM,GAAG,UAAU59B,MAAV,EAAkBtQ,IAAlB,EAAwB+yB,IAAxB,EAA8B;AACzC,UAAInc,KAAK,CAACrQ,OAAN,CAAc+J,MAAd,CAAJ,EAA2B;AACzB,YAAIlP,CAAC,GAAGkP,MAAM,CAACpP,MAAf;AACA,YAAIwlD,EAAE,GAAG,EAAT;;AACA,eAAOtlD,CAAC,EAAR,EAAY;AACVslD,UAAAA,EAAE,CAACtlD,CAAD,CAAF,GAAQ8sC,MAAM,CAAC59B,MAAM,CAAClP,CAAD,CAAP,EAAYpB,IAAZ,EAAkB+yB,IAAlB,CAAd;AACD;;AACD,eAAO2zB,EAAP;AACD,OAPD,MAOO;AACL,YAAIlF,WAAW,CAACtgD,MAAZ,GAAqB,CAArB,KAA2BoP,MAAM,KAAK6G,GAAX,IAAkB7G,MAAM,KAAKwP,GAAxD,CAAJ,EAAkE;AAChE,cAAI1e,CAAC,GAAGogD,WAAW,CAACtgD,MAApB;;AACA,iBAAOE,CAAC,EAAR,EAAY;AACV,gBAAI2J,IAAI,GAAGy2C,WAAW,CAACpgD,CAAD,CAAtB;;AACA,gBAAIkP,MAAM,KAAKvF,IAAI,CAAC,CAAD,CAAf,KAAuB,CAAC/K,IAAD,IAASA,IAAI,KAAK+K,IAAI,CAAC,CAAD,CAA7C,MAAsD,CAACgoB,IAAD,IAASA,IAAI,KAAKhoB,IAAI,CAAC,CAAD,CAA5E,CAAJ,EAAsF;AACpFoiC,cAAAA,MAAM,CAACe,MAAP,CAAcnjC,IAAI,CAAC,CAAD,CAAlB,EAAuBA,IAAI,CAAC,CAAD,CAA3B,EAAgCA,IAAI,CAAC,CAAD,CAApC;AACD;AACF;AACF;;AACD,eAAOoiC,MAAM,CAACe,MAAP,CAAc59B,MAAd,EAAsBtQ,IAAtB,EAA4B+yB,IAA5B,CAAP;AACD;AACF,KApBD;;AAqBA,QAAIsb,IAAI,GAAG,UAAU/9B,MAAV,EAAkBtQ,IAAlB,EAAwB2tC,GAAxB,EAA6B;AACtC,aAAOR,MAAM,CAACkB,IAAP,CAAY/9B,MAAZ,EAAoBtQ,IAApB,EAA0B2tC,GAA1B,CAAP;AACD,KAFD;;AAGA,QAAIiZ,kBAAkB,GAAG,UAAU9uC,IAAV,EAAgB;AACvC,UAAIA,IAAI,IAAIqK,WAAW,CAACrK,IAAD,CAAvB,EAA+B;AAC7B,YAAI/D,eAAe,GAAG+D,IAAI,CAACkL,YAAL,CAAkB,0BAAlB,CAAtB;;AACA,YAAIjP,eAAe,IAAIA,eAAe,KAAK,SAA3C,EAAsD;AACpD,iBAAOA,eAAP;AACD;;AACD,eAAO+D,IAAI,CAAC/D,eAAL,KAAyB,SAAzB,GAAqC+D,IAAI,CAAC/D,eAA1C,GAA4D,IAAnE;AACD,OAND,MAMO;AACL,eAAO,IAAP;AACD;AACF,KAVD;;AAWA,QAAI8yC,wBAAwB,GAAG,UAAU/uC,IAAV,EAAgB;AAC7C,UAAIzC,IAAI,GAAGssC,OAAO,EAAlB;AACA,UAAIjtB,KAAK,GAAG,IAAZ;;AACA,aAAO5c,IAAI,IAAIA,IAAI,KAAKzC,IAAxB,EAA8ByC,IAAI,GAAGA,IAAI,CAAC0D,UAA1C,EAAsD;AACpDkZ,QAAAA,KAAK,GAAGkyB,kBAAkB,CAAC9uC,IAAD,CAA1B;;AACA,YAAI4c,KAAK,KAAK,IAAd,EAAoB;AAClB;AACD;AACF;;AACD,aAAOA,KAAP;AACD,KAVD;;AAWA,QAAI8Z,OAAO,GAAG,YAAY;AACxB,UAAIgT,WAAW,CAACtgD,MAAZ,GAAqB,CAAzB,EAA4B;AAC1B,YAAIE,CAAC,GAAGogD,WAAW,CAACtgD,MAApB;;AACA,eAAOE,CAAC,EAAR,EAAY;AACV,cAAI2J,IAAI,GAAGy2C,WAAW,CAACpgD,CAAD,CAAtB;AACA+rC,UAAAA,MAAM,CAACe,MAAP,CAAcnjC,IAAI,CAAC,CAAD,CAAlB,EAAuBA,IAAI,CAAC,CAAD,CAA3B,EAAgCA,IAAI,CAAC,CAAD,CAApC;AACD;AACF;;AACD5B,MAAAA,MAAM,CAACg4C,KAAD,EAAQ,UAAU7xB,CAAV,EAAa3Y,GAAb,EAAkB;AAC9B4qC,QAAAA,gBAAgB,CAACxrB,MAAjB,CAAwBpf,GAAxB;AACA,eAAOwqC,KAAK,CAACxqC,GAAD,CAAZ;AACD,OAHK,CAAN;;AAIA,UAAI47B,MAAM,CAAClD,WAAX,EAAwB;AACtBkD,QAAAA,MAAM,CAAClD,WAAP;AACD;AACF,KAfD;;AAgBA,QAAIyX,SAAS,GAAG,UAAUhvC,IAAV,EAAgB5B,MAAhB,EAAwB;AACtC,aAAO4B,IAAP,EAAa;AACX,YAAI5B,MAAM,KAAK4B,IAAf,EAAqB;AACnB,iBAAO,IAAP;AACD;;AACDA,QAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,aAAO,KAAP;AACD,KARD;;AASA,QAAIurC,OAAO,GAAG,UAAU1/C,CAAV,EAAa;AACzB,aAAO,qBAAqBA,CAAC,CAACyzB,cAAF,CAAiBngB,QAAtC,GAAiD,iBAAjD,GAAqEtT,CAAC,CAAC2/C,WAAvE,GAAqF,kBAArF,GAA0G3/C,CAAC,CAAC4/C,YAAF,CAAetsC,QAAzH,GAAoI,eAApI,GAAsJtT,CAAC,CAAC6/C,SAA/J;AACD,KAFD;;AAGA,QAAIzhD,IAAI,GAAG;AACT0R,MAAAA,GAAG,EAAEA,GADI;AAETqc,MAAAA,QAAQ,EAAEA,QAFD;AAGT1T,MAAAA,GAAG,EAAEA,GAHI;AAITqhC,MAAAA,KAAK,EAAEA,KAJE;AAKTE,MAAAA,OAAO,EAAEA,OALA;AAMTC,MAAAA,QAAQ,EAAEA,QAND;AAOTC,MAAAA,gBAAgB,EAAEA,gBAPT;AAQTC,MAAAA,WAAW,EAAEA,WARJ;AASTn8B,MAAAA,MAAM,EAAEA,MATC;AAUT2a,MAAAA,MAAM,EAAEA,MAVC;AAWTmN,MAAAA,MAAM,EAAEA,MAXC;AAYTrV,MAAAA,OAAO,EAAEA,OAZA;AAaT4pB,MAAAA,CAAC,EAAEA,CAbM;AAcTE,MAAAA,EAAE,EAAEA,EAdK;AAeTvsC,MAAAA,IAAI,EAAE,IAfG;AAgBT9U,MAAAA,KAAK,EAAEA,KAhBE;AAiBTohD,MAAAA,OAAO,EAAEA,OAjBA;AAkBTY,MAAAA,WAAW,EAAEA,WAlBJ;AAmBTY,MAAAA,OAAO,EAAEA,OAnBA;AAoBTD,MAAAA,OAAO,EAAEA,OApBA;AAqBTO,MAAAA,SAAS,EAAEA,SArBF;AAsBTH,MAAAA,UAAU,EAAEA,UAtBH;AAuBTz6C,MAAAA,GAAG,EAAEA,GAvBI;AAwBT86C,MAAAA,OAAO,EAAEA,OAxBA;AAyBTC,MAAAA,OAAO,EAAEA,OAzBA;AA0BT3U,MAAAA,MAAM,EAAEA,MA1BC;AA2BT7qC,MAAAA,EAAE,EAAEA,EA3BK;AA4BTm8B,MAAAA,GAAG,EAAEA,GA5BI;AA6BTnrB,MAAAA,MAAM,EAAEA,MA7BC;AA8BT8uC,MAAAA,UAAU,EAAEA,UA9BH;AA+BTjI,MAAAA,cAAc,EAAEA,cA/BP;AAgCTl9B,MAAAA,MAAM,EAAEA,MAhCC;AAiCT8jC,MAAAA,QAAQ,EAAEA,QAjCD;AAkCTI,MAAAA,QAAQ,EAAEA,QAlCD;AAmCTF,MAAAA,SAAS,EAAEA,SAnCF;AAoCTuB,MAAAA,gBAAgB,EAAEA,gBApCT;AAqCTtC,MAAAA,SAAS,EAAEA,SArCF;AAsCT6B,MAAAA,UAAU,EAAEA,UAtCH;AAuCThC,MAAAA,SAAS,EAAEA,SAvCF;AAwCTr7B,MAAAA,MAAM,EAAEo8B,QAxCC;AAyCT4B,MAAAA,UAAU,EAAEA,UAzCH;AA0CTE,MAAAA,cAAc,EAAEA,cA1CP;AA2CT3wB,MAAAA,QAAQ,EAAEA,QA3CD;AA4CT8wB,MAAAA,OAAO,EAAEA,OA5CA;AA6CT/F,MAAAA,QAAQ,EAAEA,QA7CD;AA8CTE,MAAAA,WAAW,EAAEA,WA9CJ;AA+CTrC,MAAAA,QAAQ,EAAEA,QA/CD;AAgDToC,MAAAA,WAAW,EAAEA,WAhDJ;AAiDTK,MAAAA,IAAI,EAAEA,IAjDG;AAkDTC,MAAAA,IAAI,EAAEA,IAlDG;AAmDT0F,MAAAA,QAAQ,EAAEA,QAnDD;AAoDTC,MAAAA,QAAQ,EAAEA,QApDD;AAqDTlB,MAAAA,OAAO,EAAEA,OArDA;AAsDTmB,MAAAA,YAAY,EAAEA,YAtDL;AAuDTE,MAAAA,YAAY,EAAEA,YAvDL;AAwDT5lB,MAAAA,MAAM,EAAEA,MAxDC;AAyDT2J,MAAAA,MAAM,EAAEA,MAzDC;AA0DTkc,MAAAA,WAAW,EAAEA,WA1DJ;AA2DTl3C,MAAAA,OAAO,EAAEA,OA3DA;AA4DTu3C,MAAAA,MAAM,EAAEA,MA5DC;AA6DTE,MAAAA,kBAAkB,EAAEA,kBA7DX;AA8DThe,MAAAA,KAAK,EAAEA,KA9DE;AA+DTlf,MAAAA,GAAG,EAAEA,GA/DI;AAgETs5B,MAAAA,UAAU,EAAEA,UAhEH;AAiETllB,MAAAA,OAAO,EAAEA,OAjEA;AAkETopB,MAAAA,SAAS,EAAEA,SAlEF;AAmETtP,MAAAA,SAAS,EAAEmK,aAnEF;AAoET7rC,MAAAA,KAAK,EAAEA,KApEE;AAqETlQ,MAAAA,IAAI,EAAEA,IArEG;AAsETmpC,MAAAA,MAAM,EAAEA,MAtEC;AAuETG,MAAAA,IAAI,EAAEA,IAvEG;AAwETuY,MAAAA,kBAAkB,EAAEA,kBAxEX;AAyETC,MAAAA,wBAAwB,EAAEA,wBAzEjB;AA0ETrY,MAAAA,OAAO,EAAEA,OA1EA;AA2ETsY,MAAAA,SAAS,EAAEA,SA3EF;AA4ETC,MAAAA,OAAO,EAAEA;AA5EA,KAAX;AA8EA,QAAIvJ,SAAS,GAAG6C,cAAc,CAACh7B,MAAD,EAASmO,QAAT,EAAmB,YAAY;AAC3D,aAAO/tB,IAAP;AACD,KAF6B,CAA9B;AAGA,WAAOA,IAAP;AACD,GAzwBD;;AA0wBAw7C,EAAAA,QAAQ,CAAC2D,GAAT,GAAe3D,QAAQ,CAAC5sC,QAAD,CAAvB;AACA4sC,EAAAA,QAAQ,CAACtK,SAAT,GAAqBmK,aAArB;AAEA,MAAI8D,GAAG,GAAG3D,QAAQ,CAAC2D,GAAnB;AACA,MAAIuC,MAAM,GAAGvwC,KAAK,CAAC9R,IAAnB;AAAA,MAAyBsiD,MAAM,GAAGxwC,KAAK,CAACC,IAAxC;AACA,MAAIwwC,MAAM,GAAG,CAAb;AACA,MAAIC,OAAO,GAAG,CAAd;AACA,MAAIC,MAAM,GAAG,CAAb;AACA,MAAIC,MAAM,GAAG,CAAb;;AACA,MAAIC,YAAY,GAAG,YAAY;AAC7B,aAASA,YAAT,CAAsBj0B,QAAtB,EAAgC;AAC9B,UAAIA,QAAQ,KAAK,KAAK,CAAtB,EAAyB;AACvBA,QAAAA,QAAQ,GAAG,EAAX;AACD;;AACD,WAAKk0B,MAAL,GAAc,EAAd;AACA,WAAKx/B,KAAL,GAAa,EAAb;AACA,WAAKy/B,qBAAL,GAA6B,EAA7B;AACA,WAAKC,oBAAL,GAA4B,EAA5B;AACA,WAAKC,OAAL,GAAe,CAAf;AACA,WAAKr0B,QAAL,GAAgBA,QAAhB;AACD;;AACDi0B,IAAAA,YAAY,CAAC5nD,SAAb,CAAuBg0B,kBAAvB,GAA4C,UAAUC,cAAV,EAA0B;AACpE,WAAKN,QAAL,CAAcM,cAAd,GAA+BA,cAA/B;AACD,KAFD;;AAGA2zB,IAAAA,YAAY,CAAC5nD,SAAb,CAAuBioD,UAAvB,GAAoC,UAAUnxC,GAAV,EAAe2d,OAAf,EAAwBC,OAAxB,EAAiC;AACnE,UAAIrc,GAAG,GAAG0sC,GAAV;AACA,UAAI3+B,GAAJ;;AACA,UAAI8hC,OAAO,GAAG,YAAY;AACxB7vC,QAAAA,GAAG,CAAC6G,MAAJ,CAAWhb,EAAX;;AACA,YAAIkiB,GAAJ,EAAS;AACPA,UAAAA,GAAG,CAAC4O,OAAJ,GAAc5O,GAAG,CAAC2O,MAAJ,GAAa3O,GAAG,GAAG,IAAjC;AACD;AACF,OALD;;AAMA,UAAImF,IAAI,GAAG,YAAY;AACrB28B,QAAAA,OAAO;AACPzzB,QAAAA,OAAO;AACR,OAHD;;AAIA,UAAI5c,KAAK,GAAG,YAAY;AACtBqwC,QAAAA,OAAO;;AACP,YAAIlhD,UAAU,CAAC0tB,OAAD,CAAd,EAAyB;AACvBA,UAAAA,OAAO;AACR,SAFD,MAEO;AACL,cAAI,OAAO9c,OAAP,KAAmB,WAAnB,IAAkCA,OAAO,CAACoZ,GAA9C,EAAmD;AACjDpZ,YAAAA,OAAO,CAACoZ,GAAR,CAAY,4BAA4Bla,GAAxC;AACD;AACF;AACF,OATD;;AAUA,UAAI5S,EAAE,GAAGmU,GAAG,CAAC8sC,QAAJ,EAAT;AACA/+B,MAAAA,GAAG,GAAG5R,QAAQ,CAACgD,aAAT,CAAuB,QAAvB,CAAN;AACA4O,MAAAA,GAAG,CAACliB,EAAJ,GAASA,EAAT;AACAkiB,MAAAA,GAAG,CAAC/f,IAAJ,GAAW,iBAAX;AACA+f,MAAAA,GAAG,CAAC06B,GAAJ,GAAU/pC,KAAK,CAACF,eAAN,CAAsBC,GAAtB,CAAV;;AACA,UAAI,KAAK6c,QAAL,CAAcM,cAAlB,EAAkC;AAChC5b,QAAAA,GAAG,CAAC8pC,SAAJ,CAAc/7B,GAAd,EAAmB,gBAAnB,EAAqC,KAAKuN,QAAL,CAAcM,cAAnD;AACD;;AACD7N,MAAAA,GAAG,CAAC2O,MAAJ,GAAaxJ,IAAb;AACAnF,MAAAA,GAAG,CAAC4O,OAAJ,GAAcnd,KAAd;AACA,OAACrD,QAAQ,CAAComB,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,KAA4CpmB,QAAQ,CAAC+K,IAAtD,EAA4Db,WAA5D,CAAwE0H,GAAxE;AACD,KAlCD;;AAmCAwhC,IAAAA,YAAY,CAAC5nD,SAAb,CAAuBmoD,MAAvB,GAAgC,UAAUrxC,GAAV,EAAe;AAC7C,aAAO,KAAK+wC,MAAL,CAAY/wC,GAAZ,MAAqB4wC,MAA5B;AACD,KAFD;;AAGAE,IAAAA,YAAY,CAAC5nD,SAAb,CAAuBooD,QAAvB,GAAkC,UAAUtxC,GAAV,EAAe;AAC/C,WAAK+wC,MAAL,CAAY/wC,GAAZ,IAAmB4wC,MAAnB;AACD,KAFD;;AAGAE,IAAAA,YAAY,CAAC5nD,SAAb,CAAuB0gC,GAAvB,GAA6B,UAAU5pB,GAAV,EAAe2d,OAAf,EAAwBpd,KAAxB,EAA+Bqd,OAA/B,EAAwC;AACnE,UAAIG,KAAK,GAAG,KAAKgzB,MAAL,CAAY/wC,GAAZ,CAAZ;AACA,WAAKuR,KAAL,CAAWhhB,IAAX,CAAgByP,GAAhB;;AACA,UAAI+d,KAAK,KAAKh1B,SAAd,EAAyB;AACvB,aAAKgoD,MAAL,CAAY/wC,GAAZ,IAAmB0wC,MAAnB;AACD;;AACD,UAAI/yB,OAAJ,EAAa;AACX,YAAI,CAAC,KAAKqzB,qBAAL,CAA2BhxC,GAA3B,CAAL,EAAsC;AACpC,eAAKgxC,qBAAL,CAA2BhxC,GAA3B,IAAkC,EAAlC;AACD;;AACD,aAAKgxC,qBAAL,CAA2BhxC,GAA3B,EAAgCzP,IAAhC,CAAqC;AACnCotB,UAAAA,OAAO,EAAEA,OAD0B;AAEnCC,UAAAA,OAAO,EAAEA,OAF0B;AAGnCrd,UAAAA,KAAK,EAAEA,KAAK,IAAI;AAHmB,SAArC;AAKD;AACF,KAhBD;;AAiBAuwC,IAAAA,YAAY,CAAC5nD,SAAb,CAAuBw0B,IAAvB,GAA8B,UAAU1d,GAAV,EAAe2d,OAAf,EAAwBpd,KAAxB,EAA+Bqd,OAA/B,EAAwC;AACpE,aAAO,KAAKgM,GAAL,CAAS5pB,GAAT,EAAc2d,OAAd,EAAuBpd,KAAvB,EAA8Bqd,OAA9B,CAAP;AACD,KAFD;;AAGAkzB,IAAAA,YAAY,CAAC5nD,SAAb,CAAuBkf,MAAvB,GAAgC,UAAUpI,GAAV,EAAe;AAC7C,aAAO,KAAK+wC,MAAL,CAAY/wC,GAAZ,CAAP;AACA,aAAO,KAAKgxC,qBAAL,CAA2BhxC,GAA3B,CAAP;AACD,KAHD;;AAIA8wC,IAAAA,YAAY,CAAC5nD,SAAb,CAAuBqoD,SAAvB,GAAmC,UAAU5zB,OAAV,EAAmBpd,KAAnB,EAA0Bqd,OAA1B,EAAmC;AACpE,WAAK4zB,WAAL,CAAiB,KAAKjgC,KAAtB,EAA6BoM,OAA7B,EAAsCpd,KAAtC,EAA6Cqd,OAA7C;AACD,KAFD;;AAGAkzB,IAAAA,YAAY,CAAC5nD,SAAb,CAAuBsoD,WAAvB,GAAqC,UAAUC,OAAV,EAAmB9zB,OAAnB,EAA4Bpd,KAA5B,EAAmCqd,OAAnC,EAA4C;AAC/E,UAAI9uB,IAAI,GAAG,IAAX;AACA,UAAI4iD,QAAQ,GAAG,EAAf;;AACA,UAAIC,aAAa,GAAG,UAAUtoD,IAAV,EAAgB2W,GAAhB,EAAqB;AACvCwwC,QAAAA,MAAM,CAAC1hD,IAAI,CAACkiD,qBAAL,CAA2BhxC,GAA3B,CAAD,EAAkC,UAAU9L,QAAV,EAAoB;AAC1D,cAAIhE,UAAU,CAACgE,QAAQ,CAAC7K,IAAD,CAAT,CAAd,EAAgC;AAC9B6K,YAAAA,QAAQ,CAAC7K,IAAD,CAAR,CAAeS,IAAf,CAAoBoK,QAAQ,CAACqM,KAA7B;AACD;AACF,SAJK,CAAN;AAKAzR,QAAAA,IAAI,CAACkiD,qBAAL,CAA2BhxC,GAA3B,IAAkCjX,SAAlC;AACD,OAPD;;AAQA+F,MAAAA,IAAI,CAACmiD,oBAAL,CAA0B1gD,IAA1B,CAA+B;AAC7BotB,QAAAA,OAAO,EAAEA,OADoB;AAE7BC,QAAAA,OAAO,EAAEA,OAFoB;AAG7Brd,QAAAA,KAAK,EAAEA,KAAK,IAAI;AAHa,OAA/B;;AAKA,UAAIixC,WAAW,GAAG,YAAY;AAC5B,YAAII,cAAc,GAAGnB,MAAM,CAACgB,OAAD,CAA3B;AACAA,QAAAA,OAAO,CAAClnD,MAAR,GAAiB,CAAjB;AACAimD,QAAAA,MAAM,CAACoB,cAAD,EAAiB,UAAU5xC,GAAV,EAAe;AACpC,cAAIlR,IAAI,CAACiiD,MAAL,CAAY/wC,GAAZ,MAAqB4wC,MAAzB,EAAiC;AAC/Be,YAAAA,aAAa,CAAC,SAAD,EAAY3xC,GAAZ,CAAb;AACA;AACD;;AACD,cAAIlR,IAAI,CAACiiD,MAAL,CAAY/wC,GAAZ,MAAqB6wC,MAAzB,EAAiC;AAC/Bc,YAAAA,aAAa,CAAC,SAAD,EAAY3xC,GAAZ,CAAb;AACA;AACD;;AACD,cAAIlR,IAAI,CAACiiD,MAAL,CAAY/wC,GAAZ,MAAqB2wC,OAAzB,EAAkC;AAChC7hD,YAAAA,IAAI,CAACiiD,MAAL,CAAY/wC,GAAZ,IAAmB2wC,OAAnB;AACA7hD,YAAAA,IAAI,CAACoiD,OAAL;AACApiD,YAAAA,IAAI,CAACqiD,UAAL,CAAgBnxC,GAAhB,EAAqB,YAAY;AAC/BlR,cAAAA,IAAI,CAACiiD,MAAL,CAAY/wC,GAAZ,IAAmB4wC,MAAnB;AACA9hD,cAAAA,IAAI,CAACoiD,OAAL;AACAS,cAAAA,aAAa,CAAC,SAAD,EAAY3xC,GAAZ,CAAb;AACAwxC,cAAAA,WAAW;AACZ,aALD,EAKG,YAAY;AACb1iD,cAAAA,IAAI,CAACiiD,MAAL,CAAY/wC,GAAZ,IAAmB6wC,MAAnB;AACA/hD,cAAAA,IAAI,CAACoiD,OAAL;AACAQ,cAAAA,QAAQ,CAACnhD,IAAT,CAAcyP,GAAd;AACA2xC,cAAAA,aAAa,CAAC,SAAD,EAAY3xC,GAAZ,CAAb;AACAwxC,cAAAA,WAAW;AACZ,aAXD;AAYD;AACF,SAzBK,CAAN;;AA0BA,YAAI,CAAC1iD,IAAI,CAACoiD,OAAV,EAAmB;AACjB,cAAIW,eAAe,GAAG/iD,IAAI,CAACmiD,oBAAL,CAA0BpnD,KAA1B,CAAgC,CAAhC,CAAtB;AACAiF,UAAAA,IAAI,CAACmiD,oBAAL,CAA0B1mD,MAA1B,GAAmC,CAAnC;AACAimD,UAAAA,MAAM,CAACqB,eAAD,EAAkB,UAAU39C,QAAV,EAAoB;AAC1C,gBAAIw9C,QAAQ,CAACnnD,MAAT,KAAoB,CAAxB,EAA2B;AACzB,kBAAI2F,UAAU,CAACgE,QAAQ,CAACypB,OAAV,CAAd,EAAkC;AAChCzpB,gBAAAA,QAAQ,CAACypB,OAAT,CAAiB7zB,IAAjB,CAAsBoK,QAAQ,CAACqM,KAA/B;AACD;AACF,aAJD,MAIO;AACL,kBAAIrQ,UAAU,CAACgE,QAAQ,CAAC0pB,OAAV,CAAd,EAAkC;AAChC1pB,gBAAAA,QAAQ,CAAC0pB,OAAT,CAAiB9zB,IAAjB,CAAsBoK,QAAQ,CAACqM,KAA/B,EAAsCmxC,QAAtC;AACD;AACF;AACF,WAVK,CAAN;AAWD;AACF,OA5CD;;AA6CAF,MAAAA,WAAW;AACZ,KA9DD;;AA+DAV,IAAAA,YAAY,CAACA,YAAb,GAA4B,IAAIA,YAAJ,EAA5B;AACA,WAAOA,YAAP;AACD,GApJkB,EAAnB;;AAsJA,MAAIgB,IAAI,GAAG,UAAUC,OAAV,EAAmB;AAC5B,QAAI9lD,KAAK,GAAG8lD,OAAZ;;AACA,QAAI7/C,GAAG,GAAG,YAAY;AACpB,aAAOjG,KAAP;AACD,KAFD;;AAGA,QAAIyhB,GAAG,GAAG,UAAU1e,CAAV,EAAa;AACrB/C,MAAAA,KAAK,GAAG+C,CAAR;AACD,KAFD;;AAGA,WAAO;AACLkD,MAAAA,GAAG,EAAEA,GADA;AAELwb,MAAAA,GAAG,EAAEA;AAFA,KAAP;AAID,GAZD;;AAcA,MAAIskC,KAAK,GAAG,UAAUr5C,GAAV,EAAe;AACzB,WAAOhJ,QAAQ,CAACgJ,GAAD,CAAR,IAAiBlF,GAAG,CAACkF,GAAD,EAAM,KAAN,CAA3B;AACD,GAFD;;AAGA,MAAIs5C,WAAW,GAAG,UAAUt5C,GAAV,EAAe;AAC/B,WAAO/I,OAAO,CAAC+I,GAAD,CAAP,IAAgBA,GAAG,CAACpO,MAAJ,GAAa,CAApC;AACD,GAFD;;AAGA,MAAIwsB,IAAI,GAAG,EAAX;AACA,MAAIm7B,WAAW,GAAGJ,IAAI,CAAC,IAAD,CAAtB;;AACA,MAAIK,eAAe,GAAG,YAAY;AAChC,WAAO5+C,KAAK,CAACwjB,IAAD,EAAOm7B,WAAW,CAAChgD,GAAZ,EAAP,CAAZ;AACD,GAFD;;AAGA,MAAIkgD,OAAO,GAAG,YAAY;AACxB,WAAOx/C,KAAK,CAACmkB,IAAD,EAAO,UAAU9qB,KAAV,EAAiB;AAClC,aAAO+I,QAAQ,CAAC,EAAD,EAAK/I,KAAL,CAAf;AACD,KAFW,CAAZ;AAGD,GAJD;;AAKA,MAAIomD,OAAO,GAAG,UAAUC,OAAV,EAAmB;AAC/B,QAAIA,OAAJ,EAAa;AACXJ,MAAAA,WAAW,CAACxkC,GAAZ,CAAgB4kC,OAAhB;AACD;AACF,GAJD;;AAKA,MAAIC,OAAO,GAAG,YAAY;AACxB,WAAOL,WAAW,CAAChgD,GAAZ,EAAP;AACD,GAFD;;AAGA,MAAI03B,GAAG,GAAG,UAAUhZ,IAAV,EAAgBxS,KAAhB,EAAuB;AAC/B,QAAIo0C,QAAQ,GAAGz7B,IAAI,CAACnG,IAAD,CAAnB;;AACA,QAAI,CAAC4hC,QAAL,EAAe;AACbz7B,MAAAA,IAAI,CAACnG,IAAD,CAAJ,GAAa4hC,QAAQ,GAAG,EAAxB;AACD;;AACDhgD,IAAAA,MAAM,CAAC4L,KAAD,EAAQ,UAAUq0C,WAAV,EAAuBppD,IAAvB,EAA6B;AACzCmpD,MAAAA,QAAQ,CAACnpD,IAAI,CAACuO,WAAL,EAAD,CAAR,GAA+B66C,WAA/B;AACD,KAFK,CAAN;AAGD,GARD;;AASA,MAAI7pC,SAAS,GAAG,UAAUvH,IAAV,EAAgB;AAC9B,QAAImxC,QAAQ,GAAGL,eAAe,GAAGxkD,KAAlB,CAAwB,EAAxB,CAAf;;AACA,QAAIgB,QAAQ,GAAG,UAAU8D,GAAV,EAAe;AAC5B,UAAIvC,UAAU,CAACuC,GAAD,CAAd,EAAqB;AACnB,eAAO5H,MAAM,CAAC3B,SAAP,CAAiByF,QAAjB,CAA0B7E,IAA1B,CAA+B2I,GAA/B,CAAP;AACD;;AACD,aAAO,CAACyzB,OAAO,CAACzzB,GAAD,CAAR,GAAgB,KAAKA,GAArB,GAA2B,EAAlC;AACD,KALD;;AAMA,QAAIyzB,OAAO,GAAG,UAAU7kB,IAAV,EAAgB;AAC5B,aAAOA,IAAI,KAAK,EAAT,IAAeA,IAAI,KAAK,IAAxB,IAAgCA,IAAI,KAAKtY,SAAhD;AACD,KAFD;;AAGA,QAAI2pD,WAAW,GAAG,UAAUrxC,IAAV,EAAgB;AAChC,UAAIsxC,OAAO,GAAGhkD,QAAQ,CAAC0S,IAAD,CAAtB;AACA,aAAO9N,KAAK,CAACi/C,QAAD,EAAWG,OAAO,CAAC/6C,WAAR,EAAX,CAAL,CAAuC1J,GAAvC,CAA2CS,QAA3C,EAAqDhB,KAArD,CAA2DglD,OAA3D,CAAP;AACD,KAHD;;AAIA,QAAIC,aAAa,GAAG,UAAUj6C,GAAV,EAAe;AACjC,aAAOA,GAAG,CAACpB,OAAJ,CAAY,gBAAZ,EAA8B,EAA9B,CAAP;AACD,KAFD;;AAGA,QAAI2uB,OAAO,CAAC7kB,IAAD,CAAX,EAAmB;AACjB,aAAO,EAAP;AACD;;AACD,QAAI2wC,KAAK,CAAC3wC,IAAD,CAAT,EAAiB;AACf,aAAO1S,QAAQ,CAAC0S,IAAI,CAACwN,GAAN,CAAf;AACD;;AACD,QAAIojC,WAAW,CAAC5wC,IAAD,CAAf,EAAuB;AACrB,UAAIwxC,QAAQ,GAAGxxC,IAAI,CAACxX,KAAL,CAAW,CAAX,CAAf;AACA,UAAIipD,UAAU,GAAGJ,WAAW,CAACrxC,IAAI,CAAC,CAAD,CAAL,CAAX,CAAqB9J,OAArB,CAA6B,eAA7B,EAA8C,UAAUw7C,EAAV,EAAcC,EAAd,EAAkB;AAC/E,eAAOv/C,GAAG,CAACo/C,QAAD,EAAWG,EAAX,CAAH,GAAoBrkD,QAAQ,CAACkkD,QAAQ,CAACG,EAAD,CAAT,CAA5B,GAA6CD,EAApD;AACD,OAFgB,CAAjB;AAGA,aAAOH,aAAa,CAACE,UAAD,CAApB;AACD;;AACD,WAAOF,aAAa,CAACF,WAAW,CAACrxC,IAAD,CAAZ,CAApB;AACD,GAhCD;;AAiCA,MAAI4xC,KAAK,GAAG,YAAY;AACtB,WAAOd,eAAe,GAAG/jD,IAAlB,CAAuB,UAAUgQ,KAAV,EAAiB;AAC7C,aAAO7K,KAAK,CAAC6K,KAAD,EAAQ,MAAR,CAAZ;AACD,KAFM,EAEJ/P,MAFI,CAEG,UAAU6kB,GAAV,EAAe;AACvB,aAAOA,GAAG,KAAK,KAAf;AACD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAIggC,OAAO,GAAG,UAAUtiC,IAAV,EAAgB;AAC5B,WAAOnd,GAAG,CAACsjB,IAAD,EAAOnG,IAAP,CAAV;AACD,GAFD;;AAGA,MAAIuiC,IAAI,GAAG;AACTf,IAAAA,OAAO,EAAEA,OADA;AAETC,IAAAA,OAAO,EAAEA,OAFA;AAGTE,IAAAA,OAAO,EAAEA,OAHA;AAIT3oB,IAAAA,GAAG,EAAEA,GAJI;AAKThhB,IAAAA,SAAS,EAAEA,SALF;AAMTqqC,IAAAA,KAAK,EAAEA,KANE;AAOTC,IAAAA,OAAO,EAAEA;AAPA,GAAX;;AAUA,MAAIE,YAAY,GAAG,YAAY;AAC7B,QAAIh1C,KAAK,GAAG,EAAZ;AACA,QAAI8gB,IAAI,GAAG,EAAX;AACA,QAAI+B,MAAM,GAAG,EAAb;AACA,QAAIoyB,UAAU,GAAG,EAAjB;;AACA,QAAIC,YAAY,GAAG,UAAUjqD,IAAV,EAAgB00B,KAAhB,EAAuB;AACxC,UAAIw1B,gBAAgB,GAAGhlD,MAAM,CAAC8kD,UAAD,EAAa,UAAUG,QAAV,EAAoB;AAC5D,eAAOA,QAAQ,CAACnqD,IAAT,KAAkBA,IAAlB,IAA0BmqD,QAAQ,CAACz1B,KAAT,KAAmBA,KAApD;AACD,OAF4B,CAA7B;AAGA5vB,MAAAA,IAAI,CAAColD,gBAAD,EAAmB,UAAUC,QAAV,EAAoB;AACzC,eAAOA,QAAQ,CAACt/C,QAAT,EAAP;AACD,OAFG,CAAJ;AAGD,KAPD;;AAQA,QAAIhC,GAAG,GAAG,UAAU7I,IAAV,EAAgB;AACxB,UAAI43B,MAAM,CAAC53B,IAAD,CAAV,EAAkB;AAChB,eAAO43B,MAAM,CAAC53B,IAAD,CAAN,CAAau2B,QAApB;AACD;;AACD,aAAO72B,SAAP;AACD,KALD;;AAMA,QAAI0qD,YAAY,GAAG,UAAUpqD,IAAV,EAAgB;AACjC,UAAIuxB,MAAJ;;AACA,UAAIqG,MAAM,CAAC53B,IAAD,CAAV,EAAkB;AAChBuxB,QAAAA,MAAM,GAAGqG,MAAM,CAAC53B,IAAD,CAAN,CAAaoqD,YAAtB;AACD;;AACD,aAAO74B,MAAM,IAAI,EAAjB;AACD,KAND;;AAOA,QAAI84B,eAAe,GAAG,UAAUrqD,IAAV,EAAgBsqD,SAAhB,EAA2B;AAC/C,UAAIP,YAAY,CAACQ,YAAb,KAA8B,KAAlC,EAAyC;AACvCC,QAAAA,OAAO,CAACxqD,IAAD,EAAO,YAAY;AACxB,cAAIyqD,QAAQ,GAAGX,IAAI,CAACZ,OAAL,EAAf;AACA,cAAIwB,gBAAgB,GAAG,OAAOJ,SAAS,IAAI,EAApB,IAA0B,GAAjD;;AACA,cAAI,CAACG,QAAD,IAAaH,SAAS,IAAII,gBAAgB,CAACvqD,OAAjB,CAAyB,MAAMsqD,QAAN,GAAiB,GAA1C,MAAmD,CAAC,CAAlF,EAAqF;AACnF;AACD;;AACDhD,UAAAA,YAAY,CAACA,YAAb,CAA0BlnB,GAA1B,CAA8B1K,IAAI,CAAC71B,IAAD,CAAJ,GAAa,SAAb,GAAyByqD,QAAzB,GAAoC,KAAlE;AACD,SAPM,EAOJ,QAPI,CAAP;AAQD;AACF,KAXD;;AAYA,QAAIlqB,GAAG,GAAG,UAAUx8B,EAAV,EAAc4mD,KAAd,EAAqBP,YAArB,EAAmC;AAC3C,UAAIQ,gBAAgB,GAAGD,KAAvB;AACA51C,MAAAA,KAAK,CAAC7N,IAAN,CAAW0jD,gBAAX;AACAhzB,MAAAA,MAAM,CAAC7zB,EAAD,CAAN,GAAa;AACXwyB,QAAAA,QAAQ,EAAEq0B,gBADC;AAEXR,QAAAA,YAAY,EAAEA;AAFH,OAAb;AAIAH,MAAAA,YAAY,CAAClmD,EAAD,EAAK,OAAL,CAAZ;AACA,aAAO6mD,gBAAP;AACD,KATD;;AAUA,QAAI7rC,MAAM,GAAG,UAAU/e,IAAV,EAAgB;AAC3B,aAAO61B,IAAI,CAAC71B,IAAD,CAAX;AACA,aAAO43B,MAAM,CAAC53B,IAAD,CAAb;AACD,KAHD;;AAIA,QAAI6qD,SAAS,GAAG,UAAUC,OAAV,EAAmBC,GAAnB,EAAwB;AACtC,UAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;AAC3B,eAAOA,GAAP;AACD;;AACD,aAAO,OAAOD,OAAP,KAAmB,QAAnB,GAA8B;AACnCj7C,QAAAA,MAAM,EAAE,EAD2B;AAEnCm7C,QAAAA,QAAQ,EAAED,GAFyB;AAGnCjiB,QAAAA,MAAM,EAAE;AAH2B,OAA9B,GAIH;AACFj5B,QAAAA,MAAM,EAAEi7C,OAAO,CAACj7C,MADd;AAEFm7C,QAAAA,QAAQ,EAAED,GAFR;AAGFjiB,QAAAA,MAAM,EAAEgiB,OAAO,CAAChiB;AAHd,OAJJ;AASD,KAbD;;AAcA,QAAImiB,aAAa,GAAG,UAAUC,UAAV,EAAsB9C,OAAtB,EAA+B;AACjD,UAAI+C,SAAS,GAAGt1B,IAAI,CAACq1B,UAAD,CAApB;AACApmD,MAAAA,IAAI,CAACsjD,OAAD,EAAU,UAAUtnB,MAAV,EAAkB;AAC9B2mB,QAAAA,YAAY,CAACA,YAAb,CAA0BlnB,GAA1B,CAA8B4qB,SAAS,GAAG,GAAZ,GAAkBrqB,MAAhD;AACD,OAFG,CAAJ;AAGD,KALD;;AAMA,QAAIsqB,gBAAgB,GAAG,UAAUprD,IAAV,EAAgBqrD,QAAhB,EAA0B/2B,OAA1B,EAAmCpd,KAAnC,EAA0C;AAC/D,UAAIo0C,IAAI,GAAGlB,YAAY,CAACpqD,IAAD,CAAvB;AACA8E,MAAAA,IAAI,CAACwmD,IAAD,EAAO,UAAUP,GAAV,EAAe;AACxB,YAAIQ,MAAM,GAAGV,SAAS,CAACQ,QAAD,EAAWN,GAAX,CAAtB;AACA12B,QAAAA,IAAI,CAACk3B,MAAM,CAACP,QAAR,EAAkBO,MAAlB,EAA0B7rD,SAA1B,EAAqCA,SAArC,CAAJ;AACD,OAHG,CAAJ;;AAIA,UAAI40B,OAAJ,EAAa;AACX,YAAIpd,KAAJ,EAAW;AACTod,UAAAA,OAAO,CAAC7zB,IAAR,CAAayW,KAAb;AACD,SAFD,MAEO;AACLod,UAAAA,OAAO,CAAC7zB,IAAR,CAAagnD,YAAb;AACD;AACF;AACF,KAbD;;AAcA,QAAIpzB,IAAI,GAAG,UAAUr0B,IAAV,EAAgBqrD,QAAhB,EAA0B/2B,OAA1B,EAAmCpd,KAAnC,EAA0Cqd,OAA1C,EAAmD;AAC5D,UAAIsB,IAAI,CAAC71B,IAAD,CAAR,EAAgB;AACd;AACD;;AACD,UAAIwrD,SAAS,GAAG,OAAOH,QAAP,KAAoB,QAApB,GAA+BA,QAA/B,GAA0CA,QAAQ,CAACx7C,MAAT,GAAkBw7C,QAAQ,CAACL,QAA3B,GAAsCK,QAAQ,CAACviB,MAAzG;;AACA,UAAI0iB,SAAS,CAACrrD,OAAV,CAAkB,GAAlB,MAA2B,CAA3B,IAAgCqrD,SAAS,CAACrrD,OAAV,CAAkB,KAAlB,MAA6B,CAAC,CAAlE,EAAqE;AACnEqrD,QAAAA,SAAS,GAAGzB,YAAY,CAAC0B,OAAb,GAAuB,GAAvB,GAA6BD,SAAzC;AACD;;AACD31B,MAAAA,IAAI,CAAC71B,IAAD,CAAJ,GAAawrD,SAAS,CAACh8C,SAAV,CAAoB,CAApB,EAAuBg8C,SAAS,CAACE,WAAV,CAAsB,GAAtB,CAAvB,CAAb;;AACA,UAAItgC,IAAI,GAAG,YAAY;AACrB6+B,QAAAA,YAAY,CAACjqD,IAAD,EAAO,QAAP,CAAZ;AACAorD,QAAAA,gBAAgB,CAACprD,IAAD,EAAOqrD,QAAP,EAAiB/2B,OAAjB,EAA0Bpd,KAA1B,CAAhB;AACD,OAHD;;AAIA,UAAI0gB,MAAM,CAAC53B,IAAD,CAAV,EAAkB;AAChBorB,QAAAA,IAAI;AACL,OAFD,MAEO;AACLq8B,QAAAA,YAAY,CAACA,YAAb,CAA0BlnB,GAA1B,CAA8BirB,SAA9B,EAAyCpgC,IAAzC,EAA+ClU,KAA/C,EAAsDqd,OAAtD;AACD;AACF,KAlBD;;AAmBA,QAAIi2B,OAAO,GAAG,UAAUxqD,IAAV,EAAgB6K,QAAhB,EAA0B6pB,KAA1B,EAAiC;AAC7C,UAAIA,KAAK,KAAK,KAAK,CAAnB,EAAsB;AACpBA,QAAAA,KAAK,GAAG,OAAR;AACD;;AACD,UAAItqB,GAAG,CAACwtB,MAAD,EAAS53B,IAAT,CAAH,IAAqB00B,KAAK,KAAK,OAAnC,EAA4C;AAC1C7pB,QAAAA,QAAQ;AACT,OAFD,MAEO,IAAIT,GAAG,CAACyrB,IAAD,EAAO71B,IAAP,CAAH,IAAmB00B,KAAK,KAAK,QAAjC,EAA2C;AAChD7pB,QAAAA,QAAQ;AACT,OAFM,MAEA;AACLm/C,QAAAA,UAAU,CAAC9iD,IAAX,CAAgB;AACdlH,UAAAA,IAAI,EAAEA,IADQ;AAEd00B,UAAAA,KAAK,EAAEA,KAFO;AAGd7pB,UAAAA,QAAQ,EAAEA;AAHI,SAAhB;AAKD;AACF,KAfD;;AAgBA,WAAO;AACLkK,MAAAA,KAAK,EAAEA,KADF;AAEL8gB,MAAAA,IAAI,EAAEA,IAFD;AAGL+B,MAAAA,MAAM,EAAEA,MAHH;AAILoyB,MAAAA,UAAU,EAAEA,UAJP;AAKLnhD,MAAAA,GAAG,EAAEA,GALA;AAMLuhD,MAAAA,YAAY,EAAEA,YANT;AAOLC,MAAAA,eAAe,EAAEA,eAPZ;AAQL9pB,MAAAA,GAAG,EAAEA,GARA;AASLxhB,MAAAA,MAAM,EAAEA,MATH;AAUL8rC,MAAAA,SAAS,EAAEA,SAVN;AAWLI,MAAAA,aAAa,EAAEA,aAXV;AAYL52B,MAAAA,IAAI,EAAEA,IAZD;AAaLm2B,MAAAA,OAAO,EAAEA;AAbJ,KAAP;AAeD,GAxID;;AAyIAT,EAAAA,YAAY,CAACQ,YAAb,GAA4B,IAA5B;AACAR,EAAAA,YAAY,CAAC0B,OAAb,GAAuB,EAAvB;AACA1B,EAAAA,YAAY,CAAC4B,aAAb,GAA6B5B,YAAY,EAAzC;AACAA,EAAAA,YAAY,CAAC6B,YAAb,GAA4B7B,YAAY,EAAxC;;AAEA,MAAIjU,KAAK,GAAG,UAAU/yC,EAAV,EAAc8oD,IAAd,EAAoB;AAC9B,QAAI/4B,KAAK,GAAG,IAAZ;;AACA,QAAI2b,MAAM,GAAG,YAAY;AACvB,UAAI3b,KAAK,KAAK,IAAd,EAAoB;AAClBhL,QAAAA,YAAY,CAACgL,KAAD,CAAZ;AACAA,QAAAA,KAAK,GAAG,IAAR;AACD;AACF,KALD;;AAMA,QAAIO,QAAQ,GAAG,YAAY;AACzB,UAAIlxB,IAAI,GAAG,EAAX;;AACA,WAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CD,QAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWC,SAAS,CAACD,EAAD,CAApB;AACD;;AACD,UAAI0wB,KAAK,KAAK,IAAd,EAAoB;AAClBA,QAAAA,KAAK,GAAGjL,UAAU,CAAC,YAAY;AAC7B9kB,UAAAA,EAAE,CAACT,KAAH,CAAS,IAAT,EAAeH,IAAf;AACA2wB,UAAAA,KAAK,GAAG,IAAR;AACD,SAHiB,EAGf+4B,IAHe,CAAlB;AAID;AACF,KAXD;;AAYA,WAAO;AACLpd,MAAAA,MAAM,EAAEA,MADH;AAELpb,MAAAA,QAAQ,EAAEA;AAFL,KAAP;AAID,GAxBD;;AAyBA,MAAIy4B,MAAM,GAAG,UAAU/oD,EAAV,EAAc8oD,IAAd,EAAoB;AAC/B,QAAI/4B,KAAK,GAAG,IAAZ;;AACA,QAAI2b,MAAM,GAAG,YAAY;AACvB,UAAI3b,KAAK,KAAK,IAAd,EAAoB;AAClBhL,QAAAA,YAAY,CAACgL,KAAD,CAAZ;AACAA,QAAAA,KAAK,GAAG,IAAR;AACD;AACF,KALD;;AAMA,QAAIO,QAAQ,GAAG,YAAY;AACzB,UAAIlxB,IAAI,GAAG,EAAX;;AACA,WAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CD,QAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWC,SAAS,CAACD,EAAD,CAApB;AACD;;AACD,UAAI0wB,KAAK,KAAK,IAAd,EAAoB;AAClBhL,QAAAA,YAAY,CAACgL,KAAD,CAAZ;AACD;;AACDA,MAAAA,KAAK,GAAGjL,UAAU,CAAC,YAAY;AAC7B9kB,QAAAA,EAAE,CAACT,KAAH,CAAS,IAAT,EAAeH,IAAf;AACA2wB,QAAAA,KAAK,GAAG,IAAR;AACD,OAHiB,EAGf+4B,IAHe,CAAlB;AAID,KAZD;;AAaA,WAAO;AACLpd,MAAAA,MAAM,EAAEA,MADH;AAELpb,MAAAA,QAAQ,EAAEA;AAFL,KAAP;AAID,GAzBD;;AA2BA,MAAI04B,IAAI,GAAG,UAAU3yC,OAAV,EAAmB0L,IAAnB,EAAyB;AAClC,QAAIliB,KAAK,GAAG4hB,KAAK,CAACpL,OAAD,EAAU0L,IAAV,CAAjB;AACA,WAAOliB,KAAK,KAAKlD,SAAV,IAAuBkD,KAAK,KAAK,EAAjC,GAAsC,EAAtC,GAA2CA,KAAK,CAACqS,KAAN,CAAY,GAAZ,CAAlD;AACD,GAHD;;AAIA,MAAI+2C,KAAK,GAAG,UAAU5yC,OAAV,EAAmB0L,IAAnB,EAAyB/gB,EAAzB,EAA6B;AACvC,QAAI8uC,GAAG,GAAGkZ,IAAI,CAAC3yC,OAAD,EAAU0L,IAAV,CAAd;AACA,QAAI3W,EAAE,GAAG0kC,GAAG,CAAC1vC,MAAJ,CAAW,CAACY,EAAD,CAAX,CAAT;AACAsgB,IAAAA,GAAG,CAACjL,OAAD,EAAU0L,IAAV,EAAgB3W,EAAE,CAACsiB,IAAH,CAAQ,GAAR,CAAhB,CAAH;AACA,WAAO,IAAP;AACD,GALD;;AAMA,MAAIw7B,QAAQ,GAAG,UAAU7yC,OAAV,EAAmB0L,IAAnB,EAAyB/gB,EAAzB,EAA6B;AAC1C,QAAIoK,EAAE,GAAGjJ,MAAM,CAAC6mD,IAAI,CAAC3yC,OAAD,EAAU0L,IAAV,CAAL,EAAsB,UAAUnf,CAAV,EAAa;AAChD,aAAOA,CAAC,KAAK5B,EAAb;AACD,KAFc,CAAf;;AAGA,QAAIoK,EAAE,CAACjN,MAAH,GAAY,CAAhB,EAAmB;AACjBmjB,MAAAA,GAAG,CAACjL,OAAD,EAAU0L,IAAV,EAAgB3W,EAAE,CAACsiB,IAAH,CAAQ,GAAR,CAAhB,CAAH;AACD,KAFD,MAEO;AACL9L,MAAAA,QAAQ,CAACvL,OAAD,EAAU0L,IAAV,CAAR;AACD;;AACD,WAAO,KAAP;AACD,GAVD;;AAYA,MAAIonC,QAAQ,GAAG,UAAU9yC,OAAV,EAAmB;AAChC,WAAOA,OAAO,CAAClB,GAAR,CAAYi0C,SAAZ,KAA0BzsD,SAAjC;AACD,GAFD;;AAGA,MAAI0sD,KAAK,GAAG,UAAUhzC,OAAV,EAAmB;AAC7B,WAAO2yC,IAAI,CAAC3yC,OAAD,EAAU,OAAV,CAAX;AACD,GAFD;;AAGA,MAAIizC,KAAK,GAAG,UAAUjzC,OAAV,EAAmBkzC,KAAnB,EAA0B;AACpC,WAAON,KAAK,CAAC5yC,OAAD,EAAU,OAAV,EAAmBkzC,KAAnB,CAAZ;AACD,GAFD;;AAGA,MAAIC,QAAQ,GAAG,UAAUnzC,OAAV,EAAmBkzC,KAAnB,EAA0B;AACvC,WAAOL,QAAQ,CAAC7yC,OAAD,EAAU,OAAV,EAAmBkzC,KAAnB,CAAf;AACD,GAFD;;AAIA,MAAIE,KAAK,GAAG,UAAUpzC,OAAV,EAAmBkzC,KAAnB,EAA0B;AACpC,QAAIJ,QAAQ,CAAC9yC,OAAD,CAAZ,EAAuB;AACrBA,MAAAA,OAAO,CAAClB,GAAR,CAAYi0C,SAAZ,CAAsB5rB,GAAtB,CAA0B+rB,KAA1B;AACD,KAFD,MAEO;AACLD,MAAAA,KAAK,CAACjzC,OAAD,EAAUkzC,KAAV,CAAL;AACD;AACF,GAND;;AAOA,MAAIG,UAAU,GAAG,UAAUrzC,OAAV,EAAmB;AAClC,QAAI+yC,SAAS,GAAGD,QAAQ,CAAC9yC,OAAD,CAAR,GAAoBA,OAAO,CAAClB,GAAR,CAAYi0C,SAAhC,GAA4CC,KAAK,CAAChzC,OAAD,CAAjE;;AACA,QAAI+yC,SAAS,CAACjrD,MAAV,KAAqB,CAAzB,EAA4B;AAC1ByjB,MAAAA,QAAQ,CAACvL,OAAD,EAAU,OAAV,CAAR;AACD;AACF,GALD;;AAMA,MAAIszC,QAAQ,GAAG,UAAUtzC,OAAV,EAAmBkzC,KAAnB,EAA0B;AACvC,QAAIJ,QAAQ,CAAC9yC,OAAD,CAAZ,EAAuB;AACrB,UAAI+yC,SAAS,GAAG/yC,OAAO,CAAClB,GAAR,CAAYi0C,SAA5B;AACAA,MAAAA,SAAS,CAACptC,MAAV,CAAiButC,KAAjB;AACD,KAHD,MAGO;AACLC,MAAAA,QAAQ,CAACnzC,OAAD,EAAUkzC,KAAV,CAAR;AACD;;AACDG,IAAAA,UAAU,CAACrzC,OAAD,CAAV;AACD,GARD;;AASA,MAAIuzC,KAAK,GAAG,UAAUvzC,OAAV,EAAmBkzC,KAAnB,EAA0B;AACpC,WAAOJ,QAAQ,CAAC9yC,OAAD,CAAR,IAAqBA,OAAO,CAAClB,GAAR,CAAYi0C,SAAZ,CAAsB7kD,QAAtB,CAA+BglD,KAA/B,CAA5B;AACD,GAFD;;AAIA,MAAIM,WAAW,GAAG,UAAU11C,KAAV,EAAiBzL,SAAjB,EAA4B;AAC5C,QAAI8lB,MAAM,GAAG,EAAb;AACAzsB,IAAAA,IAAI,CAACmX,QAAQ,CAAC/E,KAAD,CAAT,EAAkB,UAAUzX,CAAV,EAAa;AACjC,UAAIgM,SAAS,CAAChM,CAAD,CAAb,EAAkB;AAChB8xB,QAAAA,MAAM,GAAGA,MAAM,CAACpuB,MAAP,CAAc,CAAC1D,CAAD,CAAd,CAAT;AACD;;AACD8xB,MAAAA,MAAM,GAAGA,MAAM,CAACpuB,MAAP,CAAcypD,WAAW,CAACntD,CAAD,EAAIgM,SAAJ,CAAzB,CAAT;AACD,KALG,CAAJ;AAMA,WAAO8lB,MAAP;AACD,GATD;;AAWA,MAAIs7B,aAAa,GAAG,UAAU31C,KAAV,EAAiBmC,QAAjB,EAA2B;AAC7C,WAAOnW,GAAG,CAACmW,QAAD,EAAWnC,KAAX,CAAV;AACD,GAFD;;AAIA,MAAI41C,UAAU,GAAGnqD,QAAQ,CAAC,gBAAD,CAAzB;AACA,MAAIoqD,cAAc,GAAGpqD,QAAQ,CAAC,qBAAD,CAA7B;AACA,MAAIqqD,gBAAgB,GAAGrqD,QAAQ,CAAC,yBAAD,CAA/B;;AAEA,MAAIsqD,QAAQ,GAAG,UAAU/5B,MAAV,EAAkBg6B,cAAlB,EAAkC;AAC/C,QAAIC,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AACA,QAAI19C,KAAK,GAAG2I,YAAY,CAACX,OAAb,CAAqBw1C,GAAG,CAACryB,cAAzB,CAAZ;AACA,QAAIzlB,IAAI,GAAGiD,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAX;AACA,QAAIj0C,QAAQ,GAAG6zC,cAAc,CAAChpD,IAAf,CAAoB,YAAY;AAC7C,aAAO,MAAM4oD,UAAU,EAAvB;AACD,KAFc,EAEZ,UAAUS,EAAV,EAAc;AACf,aAAO,MAAMR,cAAc,EAApB,GAAyB,IAAzB,GAAgCQ,EAAhC,GAAqC,IAA5C;AACD,KAJc,CAAf;AAKA,QAAIC,QAAQ,GAAGjxC,KAAK,CAAC5M,KAAD,EAAQw9C,GAAG,CAACnG,WAAZ,CAAL,CAA8B1iD,KAA9B,CAAoCqL,KAApC,CAAf;AACA,QAAI+hB,OAAO,GAAGI,SAAS,CAAC07B,QAAD,EAAWn0C,QAAX,EAAqB,UAAUrV,CAAV,EAAa;AACvD,aAAOiW,IAAI,CAACjW,CAAD,EAAIqR,IAAJ,CAAX;AACD,KAFsB,CAAvB;;AAGA,QAAIo4C,OAAO,GAAG,UAAUj4C,CAAV,EAAawP,QAAb,EAAuB;AACnC,UAAIN,KAAK,CAAClP,CAAD,EAAIwP,QAAJ,CAAT,EAAwB;AACtB,eAAOjf,QAAQ,CAACR,IAAT,CAAcif,KAAK,CAAChP,CAAD,EAAIwP,QAAJ,CAAnB,CAAP;AACD,OAFD,MAEO;AACL,eAAOjf,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF,KAND;;AAOA,WAAOguB,OAAO,CAAC3sB,IAAR,CAAa,UAAUyQ,CAAV,EAAa;AAC/B,aAAOi4C,OAAO,CAACj4C,CAAD,EAAI,KAAKw3C,gBAAgB,EAAzB,CAAP,CAAoCjoD,IAApC,CAAyC,UAAU2oD,GAAV,EAAe;AAC7D,eAAOD,OAAO,CAACj4C,CAAD,EAAI,KAAKu3C,cAAc,EAAvB,CAAP,CAAkCloD,GAAlC,CAAsC,UAAU7E,IAAV,EAAgB;AAC3D,cAAIgc,QAAQ,GAAG2xC,WAAW,CAACz6B,MAAD,EAASw6B,GAAT,CAA1B;AACA,iBAAO;AACLA,YAAAA,GAAG,EAAEA,GADA;AAEL1tD,YAAAA,IAAI,EAAEA,IAFD;AAGLgc,YAAAA,QAAQ,EAAEA;AAHL,WAAP;AAKD,SAPM,CAAP;AAQD,OATM,CAAP;AAUD,KAXM,CAAP;AAYD,GAhCD;;AAiCA,MAAI4xC,YAAY,GAAG,UAAUr0C,IAAV,EAAgB;AACjC,WAAOuB,SAAS,CAACvB,IAAD,CAAT,IAAmBozC,KAAK,CAACpzC,IAAD,EAAOuzC,UAAU,EAAjB,CAA/B;AACD,GAFD;;AAGA,MAAIa,WAAW,GAAG,UAAUz6B,MAAV,EAAkBw6B,GAAlB,EAAuB;AACvC,QAAItuC,IAAI,GAAG9G,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAX;AACA,WAAOT,aAAa,CAACztC,IAAD,EAAO,MAAM4tC,gBAAgB,EAAtB,GAA2B,IAA3B,GAAkCU,GAAlC,GAAwC,IAA/C,CAApB;AACD,GAHD;;AAIA,MAAIG,OAAO,GAAG,UAAU36B,MAAV,EAAkBlzB,IAAlB,EAAwB;AACpC,QAAIof,IAAI,GAAG9G,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAX;AACA,QAAIQ,OAAO,GAAGjB,aAAa,CAACztC,IAAD,EAAO,MAAM2tC,cAAc,EAApB,GAAyB,IAAzB,GAAgC/sD,IAAhC,GAAuC,IAA9C,CAA3B;AACA,QAAI+tD,SAAS,GAAG,EAAhB;AACAjpD,IAAAA,IAAI,CAACgpD,OAAD,EAAU,UAAUnb,CAAV,EAAa;AACzB,UAAI+a,GAAG,GAAGlpC,KAAK,CAACmuB,CAAD,EAAIqa,gBAAgB,EAApB,CAAf;AACA,UAAIgB,YAAY,GAAGD,SAAS,CAAC7kD,cAAV,CAAyBwkD,GAAzB,IAAgCK,SAAS,CAACL,GAAD,CAAzC,GAAiD,EAApE;AACAK,MAAAA,SAAS,CAACL,GAAD,CAAT,GAAiBM,YAAY,CAAC7qD,MAAb,CAAoB,CAACwvC,CAAD,CAApB,CAAjB;AACD,KAJG,CAAJ;AAKA,WAAOob,SAAP;AACD,GAVD;;AAYA,MAAIE,KAAK,GAAG,UAAU/6B,MAAV,EAAkBg7B,SAAlB,EAA6B;AACvC,QAAIC,eAAe,GAAG1F,IAAI,CAAC,EAAD,CAA1B;;AACA,QAAI2F,QAAQ,GAAG,YAAY;AACzB,aAAO;AACL3kC,QAAAA,SAAS,EAAE,EADN;AAEL4kC,QAAAA,QAAQ,EAAE5F,IAAI,CAAC1iD,QAAQ,CAACrC,IAAT,EAAD;AAFT,OAAP;AAID,KALD;;AAMA,QAAI4qD,aAAa,GAAG,UAAUtuD,IAAV,EAAgBY,CAAhB,EAAmB;AACrC2tD,MAAAA,eAAe,CAACvuD,IAAD,EAAO,UAAU0tB,IAAV,EAAgB;AACpC9sB,QAAAA,CAAC,CAAC8sB,IAAD,CAAD;AACA,eAAOA,IAAP;AACD,OAHc,CAAf;AAID,KALD;;AAMA,QAAI6gC,eAAe,GAAG,UAAUvuD,IAAV,EAAgBY,CAAhB,EAAmB;AACvC,UAAI4tD,WAAW,GAAGL,eAAe,CAACtlD,GAAhB,EAAlB;AACA,UAAI6kB,IAAI,GAAG8gC,WAAW,CAACtlD,cAAZ,CAA2BlJ,IAA3B,IAAmCwuD,WAAW,CAACxuD,IAAD,CAA9C,GAAuDouD,QAAQ,EAA1E;AACA,UAAIK,UAAU,GAAG7tD,CAAC,CAAC8sB,IAAD,CAAlB;AACA8gC,MAAAA,WAAW,CAACxuD,IAAD,CAAX,GAAoByuD,UAApB;AACAN,MAAAA,eAAe,CAAC9pC,GAAhB,CAAoBmqC,WAApB;AACD,KAND;;AAOA,QAAIE,aAAa,GAAG,UAAU1uD,IAAV,EAAgB0tD,GAAhB,EAAqB1xC,QAArB,EAA+B;AACjDsyC,MAAAA,aAAa,CAACtuD,IAAD,EAAO,UAAU0tB,IAAV,EAAgB;AAClC5oB,QAAAA,IAAI,CAAC4oB,IAAI,CAACjE,SAAN,EAAiB,UAAU7oB,CAAV,EAAa;AAChC,iBAAOA,CAAC,CAAC,IAAD,EAAOZ,IAAP,EAAa;AACnB0tD,YAAAA,GAAG,EAAEA,GADc;AAEnB3nC,YAAAA,KAAK,EAAElhB,GAAG,CAACmX,QAAD,EAAW,UAAUzC,IAAV,EAAgB;AACnC,qBAAOA,IAAI,CAACrB,GAAZ;AACD,aAFS;AAFS,WAAb,CAAR;AAMD,SAPG,CAAJ;AAQD,OATY,CAAb;AAUD,KAXD;;AAYA,QAAIy2C,gBAAgB,GAAG,UAAU3uD,IAAV,EAAgB;AACrCsuD,MAAAA,aAAa,CAACtuD,IAAD,EAAO,UAAU0tB,IAAV,EAAgB;AAClC5oB,QAAAA,IAAI,CAAC4oB,IAAI,CAACjE,SAAN,EAAiB,UAAU7oB,CAAV,EAAa;AAChC,iBAAOA,CAAC,CAAC,KAAD,EAAQZ,IAAR,CAAR;AACD,SAFG,CAAJ;AAGD,OAJY,CAAb;AAKD,KAND;;AAOA,QAAI4uD,YAAY,GAAG9C,MAAM,CAAC,YAAY;AACpC,UAAI0C,WAAW,GAAGL,eAAe,CAACtlD,GAAhB,EAAlB;AACA,UAAIgmD,WAAW,GAAGnmD,MAAM,CAACjH,IAAI,CAAC+sD,WAAD,CAAL,CAAxB;AACA1pD,MAAAA,IAAI,CAAC+pD,WAAD,EAAc,UAAU7uD,IAAV,EAAgB;AAChCuuD,QAAAA,eAAe,CAACvuD,IAAD,EAAO,UAAU0tB,IAAV,EAAgB;AACpC,cAAIkJ,IAAI,GAAGlJ,IAAI,CAAC2gC,QAAL,CAAcxlD,GAAd,EAAX;AACAokD,UAAAA,QAAQ,CAAC/5B,MAAD,EAASntB,QAAQ,CAACR,IAAT,CAAcvF,IAAd,CAAT,CAAR,CAAsCkE,IAAtC,CAA2C,YAAY;AACrD,gBAAI0yB,IAAI,CAACvyB,MAAL,EAAJ,EAAmB;AACjBsqD,cAAAA,gBAAgB,CAAC3uD,IAAD,CAAhB;AACA0tB,cAAAA,IAAI,CAAC2gC,QAAL,CAAchqC,GAAd,CAAkBte,QAAQ,CAACrC,IAAT,EAAlB;AACD;AACF,WALD,EAKG,UAAUorD,EAAV,EAAc;AACf,gBAAIpB,GAAG,GAAGoB,EAAE,CAACpB,GAAb;AAAA,gBAAkB1tD,IAAI,GAAG8uD,EAAE,CAAC9uD,IAA5B;AAAA,gBAAkCgc,QAAQ,GAAG8yC,EAAE,CAAC9yC,QAAhD;;AACA,gBAAI,CAAC4a,IAAI,CAACxyB,EAAL,CAAQspD,GAAR,CAAL,EAAmB;AACjBgB,cAAAA,aAAa,CAAC1uD,IAAD,EAAO0tD,GAAP,EAAY1xC,QAAZ,CAAb;AACA0R,cAAAA,IAAI,CAAC2gC,QAAL,CAAchqC,GAAd,CAAkBte,QAAQ,CAACR,IAAT,CAAcmoD,GAAd,CAAlB;AACD;AACF,WAXD;AAYA,iBAAO;AACLW,YAAAA,QAAQ,EAAE3gC,IAAI,CAAC2gC,QADV;AAEL5kC,YAAAA,SAAS,EAAEiE,IAAI,CAACjE;AAFX,WAAP;AAID,SAlBc,CAAf;AAmBD,OApBG,CAAJ;AAqBD,KAxBwB,EAwBtB,EAxBsB,CAAzB;AAyBAyJ,IAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB,YAAY;AAC9B4lC,MAAAA,YAAY,CAACngB,MAAb;AACD,KAFD;AAGAvb,IAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwB,YAAY;AAClC4lC,MAAAA,YAAY,CAACv7B,QAAb;AACD,KAFD;;AAGA,QAAIpK,WAAW,GAAG,UAAUjpB,IAAV,EAAgBY,CAAhB,EAAmB;AACnC2tD,MAAAA,eAAe,CAACvuD,IAAD,EAAO,UAAU0tB,IAAV,EAAgB;AACpC,eAAO;AACL2gC,UAAAA,QAAQ,EAAE3gC,IAAI,CAAC2gC,QADV;AAEL5kC,UAAAA,SAAS,EAAEiE,IAAI,CAACjE,SAAL,CAAetmB,MAAf,CAAsB,CAACvC,CAAD,CAAtB;AAFN,SAAP;AAID,OALc,CAAf;AAMD,KAPD;;AAQA,WAAO;AAAEqoB,MAAAA,WAAW,EAAEA;AAAf,KAAP;AACD,GAhFD;;AAkFA,MAAI8lC,OAAO,GAAG,UAAU77B,MAAV,EAAkB87B,QAAlB,EAA4B;AACxC,QAAIC,kBAAkB,GAAG,UAAUC,IAAV,EAAgB;AACvC,aAAOnpD,QAAQ,CAACD,IAAT,CAAcopD,IAAI,CAACpqC,IAAL,CAAUioC,cAAc,EAAxB,CAAd,EAA2ChoD,IAA3C,CAAgDiqD,QAAQ,CAACp3B,MAAzD,CAAP;AACD,KAFD;;AAGA1E,IAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,YAAY;AAC5BkK,MAAAA,MAAM,CAACi8B,UAAP,CAAkBC,aAAlB,CAAgC,MAAhC,EAAwC,UAAUC,KAAV,EAAiB;AACvDvqD,QAAAA,IAAI,CAACuqD,KAAD,EAAQ,UAAUH,IAAV,EAAgB;AAC1BD,UAAAA,kBAAkB,CAACC,IAAD,CAAlB,CAAyBpqD,IAAzB,CAA8B,UAAU0uB,QAAV,EAAoB;AAChD,gBAAIA,QAAQ,CAAC87B,UAAT,KAAwB,KAA5B,EAAmC;AACjCJ,cAAAA,IAAI,CAACjwC,MAAL;AACD;AACF,WAJD;AAKD,SANG,CAAJ;AAOD,OARD;AASD,KAVD;AAWD,GAfD;;AAiBA,MAAIswC,QAAQ,GAAG,YAAY;AACzB,QAAIV,WAAW,GAAG,EAAlB;;AACA,QAAIW,QAAQ,GAAG,UAAUxvD,IAAV,EAAgBwzB,QAAhB,EAA0B;AACvCq7B,MAAAA,WAAW,CAAC7uD,IAAD,CAAX,GAAoB;AAClBA,QAAAA,IAAI,EAAEA,IADY;AAElBwzB,QAAAA,QAAQ,EAAEA;AAFQ,OAApB;AAID,KALD;;AAMA,QAAIoE,MAAM,GAAG,UAAU53B,IAAV,EAAgB;AAC3B,aAAO6uD,WAAW,CAAC3lD,cAAZ,CAA2BlJ,IAA3B,IAAmC+F,QAAQ,CAACD,IAAT,CAAc+oD,WAAW,CAAC7uD,IAAD,CAAzB,EAAiC6E,GAAjC,CAAqC,UAAUnC,CAAV,EAAa;AAC1F,eAAOA,CAAC,CAAC8wB,QAAT;AACD,OAFyC,CAAnC,GAEFztB,QAAQ,CAACrC,IAAT,EAFL;AAGD,KAJD;;AAKA,WAAO;AACL8rD,MAAAA,QAAQ,EAAEA,QADL;AAEL53B,MAAAA,MAAM,EAAEA;AAFH,KAAP;AAID,GAjBD;;AAmBA,MAAIomB,MAAM,GAAG,CAAb;;AACA,MAAIyR,UAAU,GAAG,UAAU5/C,MAAV,EAAkB;AACjC,QAAI6/C,IAAI,GAAG,IAAIz6B,IAAJ,EAAX;AACA,QAAIxC,IAAI,GAAGi9B,IAAI,CAACC,OAAL,EAAX;AACA,QAAIpU,MAAM,GAAG35B,IAAI,CAACguC,KAAL,CAAWhuC,IAAI,CAAC25B,MAAL,KAAgB,UAA3B,CAAb;AACAyC,IAAAA,MAAM;AACN,WAAOnuC,MAAM,GAAG,GAAT,GAAe0rC,MAAf,GAAwByC,MAAxB,GAAiC/9C,MAAM,CAACwyB,IAAD,CAA9C;AACD,GAND;;AAQA,MAAIo9B,KAAK,GAAG,UAAUz2C,OAAV,EAAmB02C,OAAnB,EAA4B;AACtChrD,IAAAA,IAAI,CAACgrD,OAAD,EAAU,UAAUrwD,CAAV,EAAa;AACzB+sD,MAAAA,KAAK,CAACpzC,OAAD,EAAU3Z,CAAV,CAAL;AACD,KAFG,CAAJ;AAGD,GAJD;;AAMA,MAAIswD,UAAU,GAAG,UAAU94C,IAAV,EAAgBC,KAAhB,EAAuB;AACtC,QAAIC,GAAG,GAAGD,KAAK,IAAI7C,QAAnB;AACA,QAAI+C,GAAG,GAAGD,GAAG,CAACE,aAAJ,CAAkB,KAAlB,CAAV;AACAD,IAAAA,GAAG,CAACE,SAAJ,GAAgBL,IAAhB;AACA,WAAOgF,QAAQ,CAAC3D,YAAY,CAACX,OAAb,CAAqBP,GAArB,CAAD,CAAf;AACD,GALD;;AAOA,MAAI44C,KAAK,GAAG,UAAU52C,OAAV,EAAmB;AAC7B,WAAOA,OAAO,CAAClB,GAAR,CAAYZ,SAAnB;AACD,GAFD;;AAGA,MAAI24C,KAAK,GAAG,UAAU72C,OAAV,EAAmBslC,OAAnB,EAA4B;AACtC,QAAIwR,OAAO,GAAGh1C,KAAK,CAAC9B,OAAD,CAAnB;AACA,QAAI+2C,MAAM,GAAGD,OAAO,CAACh4C,GAArB;AACA,QAAIk4C,QAAQ,GAAG93C,YAAY,CAACX,OAAb,CAAqBw4C,MAAM,CAAC/T,sBAAP,EAArB,CAAf;AACA,QAAIiU,eAAe,GAAGN,UAAU,CAACrR,OAAD,EAAUyR,MAAV,CAAhC;AACAxxC,IAAAA,QAAQ,CAACyxC,QAAD,EAAWC,eAAX,CAAR;AACAzxC,IAAAA,KAAK,CAACxF,OAAD,CAAL;AACAgF,IAAAA,MAAM,CAAChF,OAAD,EAAUg3C,QAAV,CAAN;AACD,GARD;;AAUA,MAAIE,OAAO,GAAG,UAAUC,QAAV,EAAoBC,MAApB,EAA4B;AACxC,WAAOl4C,YAAY,CAACX,OAAb,CAAqB44C,QAAQ,CAACr4C,GAAT,CAAa6kC,SAAb,CAAuByT,MAAvB,CAArB,CAAP;AACD,GAFD;;AAGA,MAAI15B,OAAO,GAAG,UAAUy5B,QAAV,EAAoB;AAChC,WAAOD,OAAO,CAACC,QAAD,EAAW,KAAX,CAAd;AACD,GAFD;;AAGA,MAAInO,IAAI,GAAG,UAAUmO,QAAV,EAAoB;AAC7B,WAAOD,OAAO,CAACC,QAAD,EAAW,IAAX,CAAd;AACD,GAFD;;AAIA,MAAIE,UAAU,GAAG,UAAUh6B,SAAV,EAAqBC,QAArB,EAA+Bg6B,UAA/B,EAA2C;AAC1D,QAAIA,UAAU,KAAK,KAAK,CAAxB,EAA2B;AACzBA,MAAAA,UAAU,GAAGltD,KAAb;AACD;;AACD,QAAIo5B,MAAM,GAAG,IAAIpG,aAAJ,CAAkBC,SAAlB,EAA6BC,QAA7B,CAAb;;AACA,QAAIngB,IAAI,GAAG,UAAUo6C,SAAV,EAAqB;AAC9B,UAAIh6B,IAAJ;;AACA,SAAG;AACDA,QAAAA,IAAI,GAAGiG,MAAM,CAAC+zB,SAAD,CAAN,EAAP;AACD,OAFD,QAESh6B,IAAI,IAAI,CAACpT,QAAQ,CAACoT,IAAD,CAAjB,IAA2B,CAAC+5B,UAAU,CAAC/5B,IAAD,CAF/C;;AAGA,aAAO5wB,QAAQ,CAACD,IAAT,CAAc6wB,IAAd,EAAoBzxB,MAApB,CAA2Bqe,QAA3B,CAAP;AACD,KAND;;AAOA,WAAO;AACLtU,MAAAA,OAAO,EAAE,YAAY;AACnB,eAAOlJ,QAAQ,CAACD,IAAT,CAAc82B,MAAM,CAAC3tB,OAAP,EAAd,EAAgC/J,MAAhC,CAAuCqe,QAAvC,CAAP;AACD,OAHI;AAILoT,MAAAA,IAAI,EAAE,YAAY;AAChB,eAAOpgB,IAAI,CAAC,MAAD,CAAX;AACD,OANI;AAOLqgB,MAAAA,IAAI,EAAE,YAAY;AAChB,eAAOrgB,IAAI,CAAC,MAAD,CAAX;AACD,OATI;AAULsgB,MAAAA,KAAK,EAAE,YAAY;AACjB,eAAOtgB,IAAI,CAAC,OAAD,CAAX;AACD;AAZI,KAAP;AAcD,GA1BD;;AA4BA,MAAIq6C,UAAU,GAAG,UAAU14C,GAAV,EAAew4C,UAAf,EAA2B;AAC1C,QAAIG,eAAe,GAAGH,UAAU,GAAGA,UAAH,GAAgB,UAAU54C,IAAV,EAAgB;AAC9D,aAAOI,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAZ,KAAqB6L,IAAI,CAAC7L,IAAD,CAAzB,IAAmCgM,sBAAsB,CAAChM,IAAD,CAAhE;AACD,KAFD;;AAGA,QAAIvB,IAAI,GAAG,UAAUuB,IAAV,EAAgBgiB,MAAhB,EAAwB8C,MAAxB,EAAgCpV,OAAhC,EAAyC;AAClD,UAAIjE,QAAQ,CAACzL,IAAD,CAAZ,EAAoB;AAClB,YAAIg5C,SAAS,GAAGtpC,OAAO,CAAC1P,IAAD,EAAOgiB,MAAP,EAAehiB,IAAI,CAAC4V,IAApB,CAAvB;;AACA,YAAIojC,SAAS,KAAK,CAAC,CAAnB,EAAsB;AACpB,iBAAO/qD,QAAQ,CAACR,IAAT,CAAc;AACnBiP,YAAAA,SAAS,EAAEsD,IADQ;AAEnBgiB,YAAAA,MAAM,EAAEg3B;AAFW,WAAd,CAAP;AAID;AACF;;AACD,aAAOl0B,MAAM,GAAG73B,IAAT,CAAc,UAAU4xB,IAAV,EAAgB;AACnC,eAAOpgB,IAAI,CAACogB,IAAI,CAACniB,SAAN,EAAiBmiB,IAAI,CAACmD,MAAtB,EAA8B8C,MAA9B,EAAsCpV,OAAtC,CAAX;AACD,OAFM,CAAP;AAGD,KAbD;;AAcA,QAAIupC,SAAS,GAAG,UAAUj5C,IAAV,EAAgBgiB,MAAhB,EAAwBtS,OAAxB,EAAiCnS,IAAjC,EAAuC;AACrD,UAAIunB,MAAM,GAAG6zB,UAAU,CAAC34C,IAAD,EAAOzC,IAAP,EAAaw7C,eAAb,CAAvB;AACA,aAAOt6C,IAAI,CAACuB,IAAD,EAAOgiB,MAAP,EAAe,YAAY;AACpC,eAAO8C,MAAM,CAAChG,IAAP,GAAc/xB,GAAd,CAAkB,UAAU+xB,IAAV,EAAgB;AACvC,iBAAO;AACLpiB,YAAAA,SAAS,EAAEoiB,IADN;AAELkD,YAAAA,MAAM,EAAElD,IAAI,CAAC11B;AAFR,WAAP;AAID,SALM,CAAP;AAMD,OAPU,EAORsmB,OAPQ,CAAJ,CAOK/iB,SAPL,EAAP;AAQD,KAVD;;AAWA,QAAIusD,QAAQ,GAAG,UAAUl5C,IAAV,EAAgBgiB,MAAhB,EAAwBtS,OAAxB,EAAiCnS,IAAjC,EAAuC;AACpD,UAAIunB,MAAM,GAAG6zB,UAAU,CAAC34C,IAAD,EAAOzC,IAAP,EAAaw7C,eAAb,CAAvB;AACA,aAAOt6C,IAAI,CAACuB,IAAD,EAAOgiB,MAAP,EAAe,YAAY;AACpC,eAAO8C,MAAM,CAACjG,IAAP,GAAc9xB,GAAd,CAAkB,UAAU8xB,IAAV,EAAgB;AACvC,iBAAO;AACLniB,YAAAA,SAAS,EAAEmiB,IADN;AAELmD,YAAAA,MAAM,EAAE;AAFH,WAAP;AAID,SALM,CAAP;AAMD,OAPU,EAORtS,OAPQ,CAAJ,CAOK/iB,SAPL,EAAP;AAQD,KAVD;;AAWA,WAAO;AACLssD,MAAAA,SAAS,EAAEA,SADN;AAELC,MAAAA,QAAQ,EAAEA;AAFL,KAAP;AAID,GA5CD;;AA8CA,MAAIC,GAAG,GAAG,UAAUrpD,GAAV,EAAe;AACvB,QAAIP,CAAC,GAAG,EAAR;;AACA,QAAIH,IAAI,GAAG,UAAUzH,CAAV,EAAa;AACtB4H,MAAAA,CAAC,CAACH,IAAF,CAAOzH,CAAP;AACD,KAFD;;AAGA,SAAK,IAAI2B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwG,GAAG,CAAC1G,MAAxB,EAAgCE,CAAC,EAAjC,EAAqC;AACnCwG,MAAAA,GAAG,CAACxG,CAAD,CAAH,CAAO0D,IAAP,CAAYoC,IAAZ;AACD;;AACD,WAAOG,CAAP;AACD,GATD;;AAUA,MAAI6pD,KAAK,GAAG,UAAUC,EAAV,EAAcC,EAAd,EAAkBxwD,CAAlB,EAAqB;AAC/B,WAAOuwD,EAAE,CAAC9sD,MAAH,MAAe+sD,EAAE,CAAC/sD,MAAH,EAAf,GAA6B0B,QAAQ,CAACR,IAAT,CAAc3E,CAAC,CAACuwD,EAAE,CAAC3sD,QAAH,EAAD,EAAgB4sD,EAAE,CAAC5sD,QAAH,EAAhB,CAAf,CAA7B,GAA8EuB,QAAQ,CAACrC,IAAT,EAArF;AACD,GAFD;;AAGA,MAAI2tD,KAAK,GAAG,UAAUF,EAAV,EAAcC,EAAd,EAAkBE,EAAlB,EAAsB1wD,CAAtB,EAAyB;AACnC,WAAOuwD,EAAE,CAAC9sD,MAAH,MAAe+sD,EAAE,CAAC/sD,MAAH,EAAf,IAA8BitD,EAAE,CAACjtD,MAAH,EAA9B,GAA4C0B,QAAQ,CAACR,IAAT,CAAc3E,CAAC,CAACuwD,EAAE,CAAC3sD,QAAH,EAAD,EAAgB4sD,EAAE,CAAC5sD,QAAH,EAAhB,EAA+B8sD,EAAE,CAAC9sD,QAAH,EAA/B,CAAf,CAA5C,GAA4GuB,QAAQ,CAACrC,IAAT,EAAnH;AACD,GAFD;;AAGA,MAAI6tD,MAAM,GAAG,UAAU1rD,CAAV,EAAanD,CAAb,EAAgB;AAC3B,WAAOmD,CAAC,GAAGE,QAAQ,CAACR,IAAT,CAAc7C,CAAd,CAAH,GAAsBqD,QAAQ,CAACrC,IAAT,EAA9B;AACD,GAFD;;AAIA,MAAI8tD,KAAK,GAAG5vC,IAAI,CAAC4vC,KAAjB;;AACA,MAAIC,OAAO,GAAG,UAAUC,IAAV,EAAgB;AAC5B,QAAI,CAACA,IAAL,EAAW;AACT,aAAO;AACLryC,QAAAA,IAAI,EAAE,CADD;AAELC,QAAAA,GAAG,EAAE,CAFA;AAGLgC,QAAAA,MAAM,EAAE,CAHH;AAILD,QAAAA,KAAK,EAAE,CAJF;AAKLF,QAAAA,KAAK,EAAE,CALF;AAMLC,QAAAA,MAAM,EAAE;AANH,OAAP;AAQD;;AACD,WAAO;AACL/B,MAAAA,IAAI,EAAEmyC,KAAK,CAACE,IAAI,CAACryC,IAAN,CADN;AAELC,MAAAA,GAAG,EAAEkyC,KAAK,CAACE,IAAI,CAACpyC,GAAN,CAFL;AAGLgC,MAAAA,MAAM,EAAEkwC,KAAK,CAACE,IAAI,CAACpwC,MAAN,CAHR;AAILD,MAAAA,KAAK,EAAEmwC,KAAK,CAACE,IAAI,CAACrwC,KAAN,CAJP;AAKLF,MAAAA,KAAK,EAAEqwC,KAAK,CAACE,IAAI,CAACvwC,KAAN,CALP;AAMLC,MAAAA,MAAM,EAAEowC,KAAK,CAACE,IAAI,CAACtwC,MAAN;AANR,KAAP;AAQD,GAnBD;;AAoBA,MAAIuwC,QAAQ,GAAG,UAAUD,IAAV,EAAgBE,OAAhB,EAAyB;AACtCF,IAAAA,IAAI,GAAGD,OAAO,CAACC,IAAD,CAAd;;AACA,QAAIE,OAAJ,EAAa;AACXF,MAAAA,IAAI,CAACrwC,KAAL,GAAaqwC,IAAI,CAACryC,IAAlB;AACD,KAFD,MAEO;AACLqyC,MAAAA,IAAI,CAACryC,IAAL,GAAYqyC,IAAI,CAACryC,IAAL,GAAYqyC,IAAI,CAACvwC,KAA7B;AACAuwC,MAAAA,IAAI,CAACrwC,KAAL,GAAaqwC,IAAI,CAACryC,IAAlB;AACD;;AACDqyC,IAAAA,IAAI,CAACvwC,KAAL,GAAa,CAAb;AACA,WAAOuwC,IAAP;AACD,GAVD;;AAWA,MAAIG,OAAO,GAAG,UAAUC,KAAV,EAAiBC,KAAjB,EAAwB;AACpC,WAAOD,KAAK,CAACzyC,IAAN,KAAe0yC,KAAK,CAAC1yC,IAArB,IAA6ByyC,KAAK,CAACxyC,GAAN,KAAcyyC,KAAK,CAACzyC,GAAjD,IAAwDwyC,KAAK,CAACxwC,MAAN,KAAiBywC,KAAK,CAACzwC,MAA/E,IAAyFwwC,KAAK,CAACzwC,KAAN,KAAgB0wC,KAAK,CAAC1wC,KAAtH;AACD,GAFD;;AAGA,MAAI2wC,eAAe,GAAG,UAAUC,SAAV,EAAqBH,KAArB,EAA4BC,KAA5B,EAAmC;AACvD,WAAOE,SAAS,IAAI,CAAb,IAAkBA,SAAS,IAAIrwC,IAAI,CAACswC,GAAL,CAASJ,KAAK,CAAC1wC,MAAf,EAAuB2wC,KAAK,CAAC3wC,MAA7B,IAAuC,CAA7E;AACD,GAFD;;AAGA,MAAI+wC,OAAO,GAAG,UAAUL,KAAV,EAAiBC,KAAjB,EAAwB;AACpC,QAAIK,UAAU,GAAGxwC,IAAI,CAACswC,GAAL,CAASH,KAAK,CAAC3wC,MAAN,GAAe,CAAxB,EAA2B0wC,KAAK,CAAC1wC,MAAN,GAAe,CAA1C,CAAjB;;AACA,QAAI0wC,KAAK,CAACxwC,MAAN,GAAe8wC,UAAf,GAA4BL,KAAK,CAACzyC,GAAtC,EAA2C;AACzC,aAAO,IAAP;AACD;;AACD,QAAIwyC,KAAK,CAACxyC,GAAN,GAAYyyC,KAAK,CAACzwC,MAAtB,EAA8B;AAC5B,aAAO,KAAP;AACD;;AACD,WAAO0wC,eAAe,CAACD,KAAK,CAACzyC,GAAN,GAAYwyC,KAAK,CAACxwC,MAAnB,EAA2BwwC,KAA3B,EAAkCC,KAAlC,CAAtB;AACD,GATD;;AAUA,MAAIM,OAAO,GAAG,UAAUP,KAAV,EAAiBC,KAAjB,EAAwB;AACpC,QAAID,KAAK,CAACxyC,GAAN,GAAYyyC,KAAK,CAACzwC,MAAtB,EAA8B;AAC5B,aAAO,IAAP;AACD;;AACD,QAAIwwC,KAAK,CAACxwC,MAAN,GAAeywC,KAAK,CAACzyC,GAAzB,EAA8B;AAC5B,aAAO,KAAP;AACD;;AACD,WAAO0yC,eAAe,CAACD,KAAK,CAACzwC,MAAN,GAAewwC,KAAK,CAACxyC,GAAtB,EAA2BwyC,KAA3B,EAAkCC,KAAlC,CAAtB;AACD,GARD;;AASA,MAAIO,UAAU,GAAG,UAAUZ,IAAV,EAAgB1lB,OAAhB,EAAyBG,OAAzB,EAAkC;AACjD,WAAOH,OAAO,IAAI0lB,IAAI,CAACryC,IAAhB,IAAwB2sB,OAAO,IAAI0lB,IAAI,CAACrwC,KAAxC,IAAiD8qB,OAAO,IAAIulB,IAAI,CAACpyC,GAAjE,IAAwE6sB,OAAO,IAAIulB,IAAI,CAACpwC,MAA/F;AACD,GAFD;;AAIA,MAAIixC,eAAe,GAAG,UAAUr+C,KAAV,EAAiB;AACrC,QAAI4mB,cAAc,GAAG5mB,KAAK,CAAC4mB,cAA3B;AAAA,QAA2CksB,WAAW,GAAG9yC,KAAK,CAAC8yC,WAA/D;;AACA,QAAIlsB,cAAc,CAACvjB,aAAf,MAAkCrD,KAAK,CAACgzC,SAAN,KAAoBF,WAAW,GAAG,CAAxE,EAA2E;AACzE,aAAOlsB,cAAc,CAACtjB,UAAf,CAA0BwvC,WAA1B,CAAP;AACD;;AACD,WAAO,IAAP;AACD,GAND;;AAOA,MAAIwL,OAAO,GAAG,UAAUh+C,SAAV,EAAqBslB,MAArB,EAA6B;AACzC,QAAItlB,SAAS,CAAC8E,QAAV,KAAuB,CAAvB,IAA4B9E,SAAS,CAAC+C,aAAV,EAAhC,EAA2D;AACzD,UAAIuiB,MAAM,IAAItlB,SAAS,CAACgD,UAAV,CAAqBtW,MAAnC,EAA2C;AACzC44B,QAAAA,MAAM,GAAGtlB,SAAS,CAACgD,UAAV,CAAqBtW,MAArB,GAA8B,CAAvC;AACD;;AACDsT,MAAAA,SAAS,GAAGA,SAAS,CAACgD,UAAV,CAAqBsiB,MAArB,CAAZ;AACD;;AACD,WAAOtlB,SAAP;AACD,GARD;;AAUA,MAAIi+C,cAAc,GAAG,IAAI3vB,MAAJ,CAAW,6GAA6G,yGAA7G,GAAyN,yGAAzN,GAAqU,uGAArU,GAA+a,wGAA/a,GAA0hB,sGAA1hB,GAAmoB,uGAAnoB,GAA6uB,6GAA7uB,GAA61B,mHAA71B,GAAm9B,+GAAn9B,GAAqkC,gHAArkC,GAAwrC,+GAAxrC,GAA0yC,qHAA1yC,GAAk6C,6GAAl6C,GAAkhD,+GAAlhD,GAAooD,+GAApoD,GAAsvD,gHAAtvD,GAAy2D,sHAAz2D,GAAk+D,oHAAl+D,GAAylE,oHAAzlE,GAAgtE,qFAA3tE,CAArB;;AACA,MAAI4vB,eAAe,GAAG,UAAUC,EAAV,EAAc;AAClC,WAAO,OAAOA,EAAP,KAAc,QAAd,IAA0BA,EAAE,CAAC9zB,UAAH,CAAc,CAAd,KAAoB,GAA9C,IAAqD4zB,cAAc,CAAC1lD,IAAf,CAAoB4lD,EAApB,CAA5D;AACD,GAFD;;AAIA,MAAIhuD,EAAE,GAAG,YAAY;AACnB,QAAIxC,IAAI,GAAG,EAAX;;AACA,SAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CD,MAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWC,SAAS,CAACD,EAAD,CAApB;AACD;;AACD,WAAO,UAAU3C,CAAV,EAAa;AAClB,WAAK,IAAI2B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGe,IAAI,CAACjB,MAAzB,EAAiCE,CAAC,EAAlC,EAAsC;AACpC,YAAIe,IAAI,CAACf,CAAD,CAAJ,CAAQ3B,CAAR,CAAJ,EAAgB;AACd,iBAAO,IAAP;AACD;AACF;;AACD,aAAO,KAAP;AACD,KAPD;AAQD,GAbD;;AAcA,MAAImzD,GAAG,GAAG,YAAY;AACpB,QAAIzwD,IAAI,GAAG,EAAX;;AACA,SAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CD,MAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWC,SAAS,CAACD,EAAD,CAApB;AACD;;AACD,WAAO,UAAU3C,CAAV,EAAa;AAClB,WAAK,IAAI2B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGe,IAAI,CAACjB,MAAzB,EAAiCE,CAAC,EAAlC,EAAsC;AACpC,YAAI,CAACe,IAAI,CAACf,CAAD,CAAJ,CAAQ3B,CAAR,CAAL,EAAiB;AACf,iBAAO,KAAP;AACD;AACF;;AACD,aAAO,IAAP;AACD,KAPD;AAQD,GAbD;;AAeA,MAAIozD,WAAW,GAAG1wC,WAAlB;AACA,MAAI2wC,kBAAkB,GAAGv3B,gBAAzB;AACA,MAAIw3B,SAAS,GAAGxwC,gBAAgB,CAAC,SAAD,EAAY,aAAZ,CAAhC;AACA,MAAIywC,SAAS,GAAGzwC,gBAAgB,CAAC,OAAD,EAAU,YAAV,CAAhC;AACA,MAAI0wC,4BAA4B,GAAGL,GAAG,CAACC,WAAD,EAAcC,kBAAd,EAAkC1vD,GAAG,CAAC4vD,SAAD,CAArC,CAAtC;AACA,MAAIE,QAAQ,GAAG9vD,GAAG,CAACmf,gBAAgB,CAAC,aAAD,EAAgB,uBAAhB,CAAjB,CAAlB;AACA,MAAI4wC,QAAQ,GAAG5vC,QAAf;AACA,MAAI6vC,MAAM,GAAGzvC,IAAb;AACA,MAAIgzB,SAAS,GAAGsK,QAAQ,CAACtK,SAAzB;AACA,MAAI0c,YAAY,GAAGb,OAAnB;;AACA,MAAItM,WAAW,GAAG,UAAU/uC,GAAV,EAAe;AAC/B,WAAO,iBAAiBA,GAAjB,GAAuBA,GAAG,CAAC+uC,WAAJ,EAAvB,GAA2CjF,QAAQ,CAAC2D,GAAT,CAAaqB,SAAb,EAAlD;AACD,GAFD;;AAGA,MAAIqN,YAAY,GAAG,UAAUj1B,GAAV,EAAe;AAChC,WAAOA,GAAG,IAAI,YAAYtxB,IAAZ,CAAiBsxB,GAAjB,CAAd;AACD,GAFD;;AAGA,MAAIk1B,OAAO,GAAG,UAAUpG,GAAV,EAAe;AAC3B,WAAO,CAAC,CAACA,GAAG,CAAC5G,QAAN,IAAkB,CAAC,CAAC4G,GAAG,CAAC3G,MAA/B;AACD,GAFD;;AAGA,MAAIgN,uBAAuB,GAAG,UAAUt/C,KAAV,EAAiB;AAC7C,QAAIM,SAAS,GAAGN,KAAK,CAAC4mB,cAAtB;AACA,QAAIhB,MAAM,GAAG5lB,KAAK,CAAC8yC,WAAnB;AACA,QAAIhvC,IAAJ;;AACA,QAAIs7C,YAAY,CAACp/C,KAAK,CAAC5O,QAAN,EAAD,CAAZ,IAAkC4tD,QAAQ,CAAC1+C,SAAS,CAACgH,UAAX,CAA1C,IAAoE+H,QAAQ,CAAC/O,SAAD,CAAhF,EAA6F;AAC3FwD,MAAAA,IAAI,GAAGxD,SAAS,CAACkZ,IAAjB;;AACA,UAAI4lC,YAAY,CAACt7C,IAAI,CAAC8hB,MAAM,GAAG,CAAV,CAAL,CAAZ,IAAkCw5B,YAAY,CAACt7C,IAAI,CAAC8hB,MAAM,GAAG,CAAV,CAAL,CAAlD,EAAsE;AACpE,eAAO,IAAP;AACD;AACF;;AACD,WAAO,KAAP;AACD,GAXD;;AAYA,MAAI25B,eAAe,GAAG,UAAUC,MAAV,EAAkB;AACtC,QAAIv8C,GAAG,GAAGu8C,MAAM,CAACv4C,aAAjB;AACA,QAAIgyC,GAAG,GAAGjH,WAAW,CAAC/uC,GAAD,CAArB;AACA,QAAIw8C,MAAM,GAAGx8C,GAAG,CAACc,cAAJ,CAAmBygB,IAAnB,CAAb;AACA,QAAIld,UAAU,GAAGk4C,MAAM,CAACl4C,UAAxB;AACAA,IAAAA,UAAU,CAACyC,YAAX,CAAwB01C,MAAxB,EAAgCD,MAAhC;AACAvG,IAAAA,GAAG,CAAC5G,QAAJ,CAAaoN,MAAb,EAAqB,CAArB;AACAxG,IAAAA,GAAG,CAAC3G,MAAJ,CAAWmN,MAAX,EAAmB,CAAnB;AACA,QAAIC,UAAU,GAAGnC,OAAO,CAACtE,GAAG,CAACxtC,qBAAJ,EAAD,CAAxB;AACAnE,IAAAA,UAAU,CAACwD,WAAX,CAAuB20C,MAAvB;AACA,WAAOC,UAAP;AACD,GAXD;;AAYA,MAAIC,+BAA+B,GAAG,UAAU1G,GAAV,EAAe;AACnD,QAAI2G,EAAE,GAAG3G,GAAG,CAACryB,cAAb;AACA,QAAIi5B,EAAE,GAAG5G,GAAG,CAAClG,YAAb;AACA,QAAI+M,EAAE,GAAG7G,GAAG,CAACnG,WAAb;AACA,QAAIiN,EAAE,GAAG9G,GAAG,CAACjG,SAAb;;AACA,QAAI4M,EAAE,KAAKC,EAAP,IAAaxwC,QAAQ,CAACwwC,EAAD,CAArB,IAA6BC,EAAE,KAAK,CAApC,IAAyCC,EAAE,KAAK,CAApD,EAAuD;AACrD,UAAIC,MAAM,GAAG/G,GAAG,CAACgH,UAAJ,EAAb;AACAD,MAAAA,MAAM,CAACE,WAAP,CAAmBL,EAAnB;AACA,aAAOp0C,qBAAqB,CAACu0C,MAAD,CAA5B;AACD,KAJD,MAIO;AACL,aAAO,IAAP;AACD;AACF,GAZD;;AAaA,MAAIG,UAAU,GAAG,UAAUhtD,CAAV,EAAa;AAC5B,WAAOA,CAAC,CAACgY,IAAF,KAAW,CAAX,IAAgBhY,CAAC,CAACga,KAAF,KAAY,CAA5B,IAAiCha,CAAC,CAACiY,GAAF,KAAU,CAA3C,IAAgDjY,CAAC,CAACia,MAAF,KAAa,CAApE;AACD,GAFD;;AAGA,MAAI3B,qBAAqB,GAAG,UAAU5U,IAAV,EAAgB;AAC1C,QAAI6oD,UAAJ;AACA,QAAIU,WAAW,GAAGvpD,IAAI,CAACwpD,cAAL,EAAlB;;AACA,QAAID,WAAW,CAACpzD,MAAZ,GAAqB,CAAzB,EAA4B;AAC1B0yD,MAAAA,UAAU,GAAGnC,OAAO,CAAC6C,WAAW,CAAC,CAAD,CAAZ,CAApB;AACD,KAFD,MAEO;AACLV,MAAAA,UAAU,GAAGnC,OAAO,CAAC1mD,IAAI,CAAC4U,qBAAL,EAAD,CAApB;AACD;;AACD,QAAI,CAAC4zC,OAAO,CAACxoD,IAAD,CAAR,IAAkBqoD,MAAM,CAACroD,IAAD,CAAxB,IAAkCspD,UAAU,CAACT,UAAD,CAAhD,EAA8D;AAC5D,aAAOH,eAAe,CAAC1oD,IAAD,CAAtB;AACD;;AACD,QAAIspD,UAAU,CAACT,UAAD,CAAV,IAA0BL,OAAO,CAACxoD,IAAD,CAArC,EAA6C;AAC3C,aAAO8oD,+BAA+B,CAAC9oD,IAAD,CAAtC;AACD;;AACD,WAAO6oD,UAAP;AACD,GAfD;;AAgBA,MAAIY,uBAAuB,GAAG,UAAUZ,UAAV,EAAsBhC,OAAtB,EAA+B;AAC3D,QAAI6C,aAAa,GAAG9C,QAAQ,CAACiC,UAAD,EAAahC,OAAb,CAA5B;AACA6C,IAAAA,aAAa,CAACtzC,KAAd,GAAsB,CAAtB;AACAszC,IAAAA,aAAa,CAACpzC,KAAd,GAAsBozC,aAAa,CAACp1C,IAAd,GAAqB,CAA3C;AACA,WAAOo1C,aAAP;AACD,GALD;;AAMA,MAAIC,2BAA2B,GAAG,UAAUC,aAAV,EAAyB;AACzD,QAAIL,WAAW,GAAG,EAAlB;AACA,QAAIM,UAAJ,EAAgB98C,IAAhB;;AACA,QAAI+8C,qBAAqB,GAAG,UAAUjB,UAAV,EAAsB;AAChD,UAAIA,UAAU,CAACxyC,MAAX,KAAsB,CAA1B,EAA6B;AAC3B;AACD;;AACD,UAAIkzC,WAAW,CAACpzD,MAAZ,GAAqB,CAAzB,EAA4B;AAC1B,YAAI2wD,OAAO,CAAC+B,UAAD,EAAaU,WAAW,CAACA,WAAW,CAACpzD,MAAZ,GAAqB,CAAtB,CAAxB,CAAX,EAA8D;AAC5D;AACD;AACF;;AACDozD,MAAAA,WAAW,CAACptD,IAAZ,CAAiB0sD,UAAjB;AACD,KAVD;;AAWA,QAAIkB,kBAAkB,GAAG,UAAUtgD,SAAV,EAAqBslB,MAArB,EAA6B;AACpD,UAAI5lB,KAAK,GAAGgyC,WAAW,CAAC1xC,SAAS,CAAC2G,aAAX,CAAvB;;AACA,UAAI2e,MAAM,GAAGtlB,SAAS,CAACkZ,IAAV,CAAexsB,MAA5B,EAAoC;AAClC,YAAIwxD,eAAe,CAACl+C,SAAS,CAACkZ,IAAV,CAAeoM,MAAf,CAAD,CAAnB,EAA6C;AAC3C,iBAAOw6B,WAAP;AACD;;AACD,YAAI5B,eAAe,CAACl+C,SAAS,CAACkZ,IAAV,CAAeoM,MAAM,GAAG,CAAxB,CAAD,CAAnB,EAAiD;AAC/C5lB,UAAAA,KAAK,CAACqyC,QAAN,CAAe/xC,SAAf,EAA0BslB,MAA1B;AACA5lB,UAAAA,KAAK,CAACsyC,MAAN,CAAahyC,SAAb,EAAwBslB,MAAM,GAAG,CAAjC;;AACA,cAAI,CAAC05B,uBAAuB,CAACt/C,KAAD,CAA5B,EAAqC;AACnC2gD,YAAAA,qBAAqB,CAACL,uBAAuB,CAAC70C,qBAAqB,CAACzL,KAAD,CAAtB,EAA+B,KAA/B,CAAxB,CAArB;AACA,mBAAOogD,WAAP;AACD;AACF;AACF;;AACD,UAAIx6B,MAAM,GAAG,CAAb,EAAgB;AACd5lB,QAAAA,KAAK,CAACqyC,QAAN,CAAe/xC,SAAf,EAA0BslB,MAAM,GAAG,CAAnC;AACA5lB,QAAAA,KAAK,CAACsyC,MAAN,CAAahyC,SAAb,EAAwBslB,MAAxB;;AACA,YAAI,CAAC05B,uBAAuB,CAACt/C,KAAD,CAA5B,EAAqC;AACnC2gD,UAAAA,qBAAqB,CAACL,uBAAuB,CAAC70C,qBAAqB,CAACzL,KAAD,CAAtB,EAA+B,KAA/B,CAAxB,CAArB;AACD;AACF;;AACD,UAAI4lB,MAAM,GAAGtlB,SAAS,CAACkZ,IAAV,CAAexsB,MAA5B,EAAoC;AAClCgT,QAAAA,KAAK,CAACqyC,QAAN,CAAe/xC,SAAf,EAA0BslB,MAA1B;AACA5lB,QAAAA,KAAK,CAACsyC,MAAN,CAAahyC,SAAb,EAAwBslB,MAAM,GAAG,CAAjC;;AACA,YAAI,CAAC05B,uBAAuB,CAACt/C,KAAD,CAA5B,EAAqC;AACnC2gD,UAAAA,qBAAqB,CAACL,uBAAuB,CAAC70C,qBAAqB,CAACzL,KAAD,CAAtB,EAA+B,IAA/B,CAAxB,CAArB;AACD;AACF;AACF,KA7BD;;AA8BA,QAAIi/C,QAAQ,CAACwB,aAAa,CAACngD,SAAd,EAAD,CAAZ,EAAyC;AACvCsgD,MAAAA,kBAAkB,CAACH,aAAa,CAACngD,SAAd,EAAD,EAA4BmgD,aAAa,CAAC76B,MAAd,EAA5B,CAAlB;AACA,aAAOw6B,WAAP;AACD;;AACD,QAAIzB,WAAW,CAAC8B,aAAa,CAACngD,SAAd,EAAD,CAAf,EAA4C;AAC1C,UAAImgD,aAAa,CAAC16B,OAAd,EAAJ,EAA6B;AAC3BniB,QAAAA,IAAI,GAAGu7C,YAAY,CAACsB,aAAa,CAACngD,SAAd,EAAD,EAA4BmgD,aAAa,CAAC76B,MAAd,EAA5B,CAAnB;;AACA,YAAIq5B,QAAQ,CAACr7C,IAAD,CAAZ,EAAoB;AAClBg9C,UAAAA,kBAAkB,CAACh9C,IAAD,EAAOA,IAAI,CAAC4V,IAAL,CAAUxsB,MAAjB,CAAlB;AACD;;AACD,YAAI+xD,4BAA4B,CAACn7C,IAAD,CAA5B,IAAsC,CAACs7C,MAAM,CAACt7C,IAAD,CAAjD,EAAyD;AACvD+8C,UAAAA,qBAAqB,CAACL,uBAAuB,CAAC70C,qBAAqB,CAAC7H,IAAD,CAAtB,EAA8B,KAA9B,CAAxB,CAArB;AACD;AACF,OARD,MAQO;AACLA,QAAAA,IAAI,GAAGu7C,YAAY,CAACsB,aAAa,CAACngD,SAAd,EAAD,EAA4BmgD,aAAa,CAAC76B,MAAd,EAA5B,CAAnB;;AACA,YAAIq5B,QAAQ,CAACr7C,IAAD,CAAZ,EAAoB;AAClBg9C,UAAAA,kBAAkB,CAACh9C,IAAD,EAAO,CAAP,CAAlB;AACD;;AACD,YAAIm7C,4BAA4B,CAACn7C,IAAD,CAA5B,IAAsC68C,aAAa,CAAC16B,OAAd,EAA1C,EAAmE;AACjE46B,UAAAA,qBAAqB,CAACL,uBAAuB,CAAC70C,qBAAqB,CAAC7H,IAAD,CAAtB,EAA8B,KAA9B,CAAxB,CAArB;AACA,iBAAOw8C,WAAP;AACD;;AACDM,QAAAA,UAAU,GAAGvB,YAAY,CAACsB,aAAa,CAACngD,SAAd,EAAD,EAA4BmgD,aAAa,CAAC76B,MAAd,KAAyB,CAArD,CAAzB;;AACA,YAAIm5B,4BAA4B,CAAC2B,UAAD,CAA5B,IAA4C,CAACxB,MAAM,CAACwB,UAAD,CAAvD,EAAqE;AACnE,cAAI7B,SAAS,CAAC6B,UAAD,CAAT,IAAyB7B,SAAS,CAACj7C,IAAD,CAAlC,IAA4C,CAACm7C,4BAA4B,CAACn7C,IAAD,CAA7E,EAAqF;AACnF+8C,YAAAA,qBAAqB,CAACL,uBAAuB,CAAC70C,qBAAqB,CAACi1C,UAAD,CAAtB,EAAoC,KAApC,CAAxB,CAArB;AACD;AACF;;AACD,YAAI3B,4BAA4B,CAACn7C,IAAD,CAAhC,EAAwC;AACtC+8C,UAAAA,qBAAqB,CAACL,uBAAuB,CAAC70C,qBAAqB,CAAC7H,IAAD,CAAtB,EAA8B,IAA9B,CAAxB,CAArB;AACD;AACF;AACF;;AACD,WAAOw8C,WAAP;AACD,GA9ED;;AA+EA,MAAIS,aAAa,GAAG,UAAUvgD,SAAV,EAAqBslB,MAArB,EAA6Bw6B,WAA7B,EAA0C;AAC5D,QAAIv6B,SAAS,GAAG,YAAY;AAC1B,UAAIo5B,QAAQ,CAAC3+C,SAAD,CAAZ,EAAyB;AACvB,eAAOslB,MAAM,KAAK,CAAlB;AACD;;AACD,aAAOA,MAAM,KAAK,CAAlB;AACD,KALD;;AAMA,QAAIG,OAAO,GAAG,YAAY;AACxB,UAAIk5B,QAAQ,CAAC3+C,SAAD,CAAZ,EAAyB;AACvB,eAAOslB,MAAM,IAAItlB,SAAS,CAACkZ,IAAV,CAAexsB,MAAhC;AACD;;AACD,aAAO44B,MAAM,IAAItlB,SAAS,CAACgD,UAAV,CAAqBtW,MAAtC;AACD,KALD;;AAMA,QAAI8zD,OAAO,GAAG,YAAY;AACxB,UAAI9gD,KAAK,GAAGgyC,WAAW,CAAC1xC,SAAS,CAAC2G,aAAX,CAAvB;AACAjH,MAAAA,KAAK,CAACqyC,QAAN,CAAe/xC,SAAf,EAA0BslB,MAA1B;AACA5lB,MAAAA,KAAK,CAACsyC,MAAN,CAAahyC,SAAb,EAAwBslB,MAAxB;AACA,aAAO5lB,KAAP;AACD,KALD;;AAMA,QAAIqgD,cAAc,GAAG,YAAY;AAC/B,UAAI,CAACD,WAAL,EAAkB;AAChBA,QAAAA,WAAW,GAAGI,2BAA2B,CAACK,aAAa,CAACvgD,SAAD,EAAYslB,MAAZ,CAAd,CAAzC;AACD;;AACD,aAAOw6B,WAAP;AACD,KALD;;AAMA,QAAIW,SAAS,GAAG,YAAY;AAC1B,aAAOV,cAAc,GAAGrzD,MAAjB,GAA0B,CAAjC;AACD,KAFD;;AAGA,QAAI2wD,OAAO,GAAG,UAAU8C,aAAV,EAAyB;AACrC,aAAOA,aAAa,IAAIngD,SAAS,KAAKmgD,aAAa,CAACngD,SAAd,EAA/B,IAA4DslB,MAAM,KAAK66B,aAAa,CAAC76B,MAAd,EAA9E;AACD,KAFD;;AAGA,QAAI04B,OAAO,GAAG,UAAU10C,MAAV,EAAkB;AAC9B,aAAOu1C,YAAY,CAAC7+C,SAAD,EAAYsJ,MAAM,GAAGgc,MAAM,GAAG,CAAZ,GAAgBA,MAAlC,CAAnB;AACD,KAFD;;AAGA,WAAO;AACLtlB,MAAAA,SAAS,EAAE7R,QAAQ,CAAC6R,SAAD,CADd;AAELslB,MAAAA,MAAM,EAAEn3B,QAAQ,CAACm3B,MAAD,CAFX;AAGLk7B,MAAAA,OAAO,EAAEA,OAHJ;AAILT,MAAAA,cAAc,EAAEA,cAJX;AAKLU,MAAAA,SAAS,EAAEA,SALN;AAMLl7B,MAAAA,SAAS,EAAEA,SANN;AAOLE,MAAAA,OAAO,EAAEA,OAPJ;AAQL43B,MAAAA,OAAO,EAAEA,OARJ;AASLW,MAAAA,OAAO,EAAEA;AATJ,KAAP;AAWD,GA7CD;;AA8CAuC,EAAAA,aAAa,CAACG,cAAd,GAA+B,UAAUhhD,KAAV,EAAiB;AAC9C,WAAO6gD,aAAa,CAAC7gD,KAAK,CAAC4mB,cAAP,EAAuB5mB,KAAK,CAAC8yC,WAA7B,CAApB;AACD,GAFD;;AAGA+N,EAAAA,aAAa,CAACI,YAAd,GAA6B,UAAUjhD,KAAV,EAAiB;AAC5C,WAAO6gD,aAAa,CAAC7gD,KAAK,CAAC+yC,YAAP,EAAqB/yC,KAAK,CAACgzC,SAA3B,CAApB;AACD,GAFD;;AAGA6N,EAAAA,aAAa,CAAC72C,KAAd,GAAsB,UAAUpG,IAAV,EAAgB;AACpC,WAAOi9C,aAAa,CAACj9C,IAAI,CAAC0D,UAAN,EAAkBm7B,SAAS,CAAC7+B,IAAD,CAAT,GAAkB,CAApC,CAApB;AACD,GAFD;;AAGAi9C,EAAAA,aAAa,CAACj3C,MAAd,GAAuB,UAAUhG,IAAV,EAAgB;AACrC,WAAOi9C,aAAa,CAACj9C,IAAI,CAAC0D,UAAN,EAAkBm7B,SAAS,CAAC7+B,IAAD,CAA3B,CAApB;AACD,GAFD;;AAGAi9C,EAAAA,aAAa,CAAC5C,OAAd,GAAwB,UAAUiD,IAAV,EAAgBC,IAAhB,EAAsB;AAC5C,WAAOnE,KAAK,CAACpoD,IAAI,CAACusD,IAAI,CAACd,cAAL,EAAD,CAAL,EAA8BxrD,IAAI,CAACqsD,IAAI,CAACb,cAAL,EAAD,CAAlC,EAA2DpC,OAA3D,CAAL,CAAyE7tD,KAAzE,CAA+E,KAA/E,CAAP;AACD,GAFD;;AAGAywD,EAAAA,aAAa,CAAC1C,OAAd,GAAwB,UAAU+C,IAAV,EAAgBC,IAAhB,EAAsB;AAC5C,WAAOnE,KAAK,CAACnoD,IAAI,CAACssD,IAAI,CAACd,cAAL,EAAD,CAAL,EAA8BzrD,IAAI,CAACssD,IAAI,CAACb,cAAL,EAAD,CAAlC,EAA2DlC,OAA3D,CAAL,CAAyE/tD,KAAzE,CAA+E,KAA/E,CAAP;AACD,GAFD;;AAGAywD,EAAAA,aAAa,CAACh7B,SAAd,GAA0B,UAAUpT,GAAV,EAAe;AACvC,WAAOA,GAAG,GAAGA,GAAG,CAACoT,SAAJ,EAAH,GAAqB,KAA/B;AACD,GAFD;;AAGAg7B,EAAAA,aAAa,CAAC96B,OAAd,GAAwB,UAAUtT,GAAV,EAAe;AACrC,WAAOA,GAAG,GAAGA,GAAG,CAACsT,OAAJ,EAAH,GAAmB,KAA7B;AACD,GAFD;;AAGA86B,EAAAA,aAAa,CAACO,cAAd,GAA+B,UAAU3uC,GAAV,EAAe;AAC5C,WAAOA,GAAG,GAAGpD,QAAQ,CAACoD,GAAG,CAACnS,SAAJ,EAAD,CAAX,GAA+B,KAAzC;AACD,GAFD;;AAGAugD,EAAAA,aAAa,CAACQ,iBAAd,GAAkC,UAAU5uC,GAAV,EAAe;AAC/C,WAAOouC,aAAa,CAACO,cAAd,CAA6B3uC,GAA7B,MAAsC,KAA7C;AACD,GAFD;;AAIA,MAAI6uC,iBAAiB,GAAG,UAAUt9C,GAAV,EAAeJ,IAAf,EAAqB;AAC3C,QAAIyL,QAAQ,CAACzL,IAAD,CAAR,IAAkBA,IAAI,CAAC4V,IAAL,CAAUxsB,MAAV,KAAqB,CAA3C,EAA8C;AAC5CgX,MAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX;AACD;AACF,GAJD;;AAKA,MAAI29C,UAAU,GAAG,UAAUv9C,GAAV,EAAei1C,GAAf,EAAoBr1C,IAApB,EAA0B;AACzCq1C,IAAAA,GAAG,CAACsI,UAAJ,CAAe39C,IAAf;AACA09C,IAAAA,iBAAiB,CAACt9C,GAAD,EAAMJ,IAAI,CAACqE,eAAX,CAAjB;AACAq5C,IAAAA,iBAAiB,CAACt9C,GAAD,EAAMJ,IAAI,CAACsE,WAAX,CAAjB;AACD,GAJD;;AAKA,MAAIs5C,cAAc,GAAG,UAAUx9C,GAAV,EAAei1C,GAAf,EAAoBhR,IAApB,EAA0B;AAC7C,QAAI1/B,UAAU,GAAG1W,QAAQ,CAACD,IAAT,CAAcq2C,IAAI,CAAC1/B,UAAnB,CAAjB;AACA,QAAIC,SAAS,GAAG3W,QAAQ,CAACD,IAAT,CAAcq2C,IAAI,CAACz/B,SAAnB,CAAhB;AACAywC,IAAAA,GAAG,CAACsI,UAAJ,CAAetZ,IAAf;AACA1/B,IAAAA,UAAU,CAAC3X,IAAX,CAAgB,UAAUyX,KAAV,EAAiB;AAC/B,aAAOi5C,iBAAiB,CAACt9C,GAAD,EAAMqE,KAAK,CAACJ,eAAZ,CAAxB;AACD,KAFD;AAGAO,IAAAA,SAAS,CAAC5X,IAAV,CAAe,UAAUyX,KAAV,EAAiB;AAC9B,aAAOi5C,iBAAiB,CAACt9C,GAAD,EAAMqE,KAAK,CAACH,WAAZ,CAAxB;AACD,KAFD;AAGD,GAVD;;AAWA,MAAIu5C,eAAe,GAAG,UAAUz9C,GAAV,EAAei1C,GAAf,EAAoBr1C,IAApB,EAA0B;AAC9C,QAAI4L,oBAAoB,CAAC5L,IAAD,CAAxB,EAAgC;AAC9B49C,MAAAA,cAAc,CAACx9C,GAAD,EAAMi1C,GAAN,EAAWr1C,IAAX,CAAd;AACD,KAFD,MAEO;AACL29C,MAAAA,UAAU,CAACv9C,GAAD,EAAMi1C,GAAN,EAAWr1C,IAAX,CAAV;AACD;AACF,GAND;;AAQA,MAAI89C,QAAQ,GAAGryC,QAAf;AACA,MAAIsyC,SAAS,GAAG5yC,OAAhB;AACA,MAAI6yC,WAAW,GAAG7U,QAAQ,CAACtK,SAA3B;;AACA,MAAIof,gBAAgB,GAAG,UAAUj+C,IAAV,EAAgB;AACrC,QAAI0D,UAAU,GAAG1D,IAAI,CAAC0D,UAAtB;;AACA,QAAIq6C,SAAS,CAACr6C,UAAD,CAAb,EAA2B;AACzB,aAAOu6C,gBAAgB,CAACv6C,UAAD,CAAvB;AACD;;AACD,WAAOA,UAAP;AACD,GAND;;AAOA,MAAIw6C,aAAa,GAAG,UAAUl+C,IAAV,EAAgB;AAClC,QAAI,CAACA,IAAL,EAAW;AACT,aAAO,EAAP;AACD;;AACD,WAAO3M,MAAM,CAAC2M,IAAI,CAACN,UAAN,EAAkB,UAAU+Z,MAAV,EAAkBzZ,IAAlB,EAAwB;AACrD,UAAI+9C,SAAS,CAAC/9C,IAAD,CAAT,IAAmBA,IAAI,CAAC6C,QAAL,KAAkB,IAAzC,EAA+C;AAC7C4W,QAAAA,MAAM,GAAGA,MAAM,CAACpuB,MAAP,CAAc6yD,aAAa,CAACl+C,IAAD,CAA3B,CAAT;AACD,OAFD,MAEO;AACLyZ,QAAAA,MAAM,CAACrqB,IAAP,CAAY4Q,IAAZ;AACD;;AACD,aAAOyZ,MAAP;AACD,KAPY,EAOV,EAPU,CAAb;AAQD,GAZD;;AAaA,MAAI0kC,oBAAoB,GAAG,UAAUn+C,IAAV,EAAgBgiB,MAAhB,EAAwB;AACjD,WAAOhiB,IAAI,GAAGA,IAAI,CAACqE,eAAnB,EAAoC;AAClC,UAAI,CAACy5C,QAAQ,CAAC99C,IAAD,CAAb,EAAqB;AACnB;AACD;;AACDgiB,MAAAA,MAAM,IAAIhiB,IAAI,CAAC4V,IAAL,CAAUxsB,MAApB;AACD;;AACD,WAAO44B,MAAP;AACD,GARD;;AASA,MAAIo8B,OAAO,GAAG,UAAUxzD,CAAV,EAAa;AACzB,WAAO,UAAUmD,CAAV,EAAa;AAClB,aAAOnD,CAAC,KAAKmD,CAAb;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIswD,mBAAmB,GAAG,UAAUr+C,IAAV,EAAgB;AACxC,QAAIiO,KAAJ,EAAW/a,KAAX;AACA+a,IAAAA,KAAK,GAAGiwC,aAAa,CAACD,gBAAgB,CAACj+C,IAAD,CAAjB,CAArB;AACA9M,IAAAA,KAAK,GAAGQ,WAAW,CAACua,KAAD,EAAQmwC,OAAO,CAACp+C,IAAD,CAAf,EAAuBA,IAAvB,CAAnB;AACAiO,IAAAA,KAAK,GAAGA,KAAK,CAACvlB,KAAN,CAAY,CAAZ,EAAewK,KAAK,GAAG,CAAvB,CAAR;AACA,QAAIorD,gBAAgB,GAAGjrD,MAAM,CAAC4a,KAAD,EAAQ,UAAUwL,MAAV,EAAkBzZ,IAAlB,EAAwB1W,CAAxB,EAA2B;AAC9D,UAAIw0D,QAAQ,CAAC99C,IAAD,CAAR,IAAkB89C,QAAQ,CAAC7vC,KAAK,CAAC3kB,CAAC,GAAG,CAAL,CAAN,CAA9B,EAA8C;AAC5CmwB,QAAAA,MAAM;AACP;;AACD,aAAOA,MAAP;AACD,KAL4B,EAK1B,CAL0B,CAA7B;AAMAxL,IAAAA,KAAK,GAAG9a,QAAQ,CAAC8a,KAAD,EAAQ3D,cAAc,CAAC,CAACtK,IAAI,CAAC6C,QAAN,CAAD,CAAtB,CAAhB;AACA3P,IAAAA,KAAK,GAAGQ,WAAW,CAACua,KAAD,EAAQmwC,OAAO,CAACp+C,IAAD,CAAf,EAAuBA,IAAvB,CAAnB;AACA,WAAO9M,KAAK,GAAGorD,gBAAf;AACD,GAdD;;AAeA,MAAIC,cAAc,GAAG,UAAUv+C,IAAV,EAAgB;AACnC,QAAI9X,IAAJ;;AACA,QAAI41D,QAAQ,CAAC99C,IAAD,CAAZ,EAAoB;AAClB9X,MAAAA,IAAI,GAAG,QAAP;AACD,KAFD,MAEO;AACLA,MAAAA,IAAI,GAAG8X,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,EAAP;AACD;;AACD,WAAOvO,IAAI,GAAG,GAAP,GAAam2D,mBAAmB,CAACr+C,IAAD,CAAhC,GAAyC,GAAhD;AACD,GARD;;AASA,MAAI8nC,YAAY,GAAG,UAAUvqC,IAAV,EAAgByC,IAAhB,EAAsBrM,SAAtB,EAAiC;AAClD,QAAIgQ,OAAO,GAAG,EAAd;;AACA,SAAK3D,IAAI,GAAGA,IAAI,CAAC0D,UAAjB,EAA6B1D,IAAI,KAAKzC,IAAtC,EAA4CyC,IAAI,GAAGA,IAAI,CAAC0D,UAAxD,EAAoE;AAClE,UAAI/P,SAAS,IAAIA,SAAS,CAACqM,IAAD,CAA1B,EAAkC;AAChC;AACD;;AACD2D,MAAAA,OAAO,CAACvU,IAAR,CAAa4Q,IAAb;AACD;;AACD,WAAO2D,OAAP;AACD,GATD;;AAUA,MAAI66C,QAAQ,GAAG,UAAUjhD,IAAV,EAAgBs/C,aAAhB,EAA+B;AAC5C,QAAIngD,SAAJ;AAAA,QAAeslB,MAAf;AAAA,QAAuBy8B,IAAI,GAAG,EAA9B;AAAA,QAAkCC,YAAlC;AAAA,QAAgDh/C,UAAhD;AAAA,QAA4DiE,OAA5D;AACAjH,IAAAA,SAAS,GAAGmgD,aAAa,CAACngD,SAAd,EAAZ;AACAslB,IAAAA,MAAM,GAAG66B,aAAa,CAAC76B,MAAd,EAAT;;AACA,QAAI87B,QAAQ,CAACphD,SAAD,CAAZ,EAAyB;AACvBgiD,MAAAA,YAAY,GAAGP,oBAAoB,CAACzhD,SAAD,EAAYslB,MAAZ,CAAnC;AACD,KAFD,MAEO;AACLtiB,MAAAA,UAAU,GAAGhD,SAAS,CAACgD,UAAvB;;AACA,UAAIsiB,MAAM,IAAItiB,UAAU,CAACtW,MAAzB,EAAiC;AAC/Bs1D,QAAAA,YAAY,GAAG,OAAf;AACA18B,QAAAA,MAAM,GAAGtiB,UAAU,CAACtW,MAAX,GAAoB,CAA7B;AACD,OAHD,MAGO;AACLs1D,QAAAA,YAAY,GAAG,QAAf;AACD;;AACDhiD,MAAAA,SAAS,GAAGgD,UAAU,CAACsiB,MAAD,CAAtB;AACD;;AACDy8B,IAAAA,IAAI,CAACrvD,IAAL,CAAUmvD,cAAc,CAAC7hD,SAAD,CAAxB;AACAiH,IAAAA,OAAO,GAAGmkC,YAAY,CAACvqC,IAAD,EAAOb,SAAP,CAAtB;AACAiH,IAAAA,OAAO,GAAGxQ,QAAQ,CAACwQ,OAAD,EAAUrY,GAAG,CAAC6f,OAAD,CAAb,CAAlB;AACAszC,IAAAA,IAAI,GAAGA,IAAI,CAACpzD,MAAL,CAAYyH,KAAK,CAAC6Q,OAAD,EAAU,UAAU3D,IAAV,EAAgB;AAChD,aAAOu+C,cAAc,CAACv+C,IAAD,CAArB;AACD,KAFuB,CAAjB,CAAP;AAGA,WAAOy+C,IAAI,CAACluD,OAAL,GAAeooB,IAAf,CAAoB,GAApB,IAA2B,GAA3B,GAAiC+lC,YAAxC;AACD,GAvBD;;AAwBA,MAAIC,eAAe,GAAG,UAAU3+C,IAAV,EAAgB9X,IAAhB,EAAsBgL,KAAtB,EAA6B;AACjD,QAAI+a,KAAK,GAAGiwC,aAAa,CAACl+C,IAAD,CAAzB;AACAiO,IAAAA,KAAK,GAAG9a,QAAQ,CAAC8a,KAAD,EAAQ,UAAUjO,IAAV,EAAgB9M,KAAhB,EAAuB;AAC7C,aAAO,CAAC4qD,QAAQ,CAAC99C,IAAD,CAAT,IAAmB,CAAC89C,QAAQ,CAAC7vC,KAAK,CAAC/a,KAAK,GAAG,CAAT,CAAN,CAAnC;AACD,KAFe,CAAhB;AAGA+a,IAAAA,KAAK,GAAG9a,QAAQ,CAAC8a,KAAD,EAAQ3D,cAAc,CAAC,CAACpiB,IAAD,CAAD,CAAtB,CAAhB;AACA,WAAO+lB,KAAK,CAAC/a,KAAD,CAAZ;AACD,GAPD;;AAQA,MAAI0rD,gBAAgB,GAAG,UAAUliD,SAAV,EAAqBslB,MAArB,EAA6B;AAClD,QAAIhiB,IAAI,GAAGtD,SAAX;AAAA,QAAsBmiD,YAAY,GAAG,CAArC;AAAA,QAAwCC,OAAxC;;AACA,WAAOhB,QAAQ,CAAC99C,IAAD,CAAf,EAAuB;AACrB8+C,MAAAA,OAAO,GAAG9+C,IAAI,CAAC4V,IAAL,CAAUxsB,MAApB;;AACA,UAAI44B,MAAM,IAAI68B,YAAV,IAA0B78B,MAAM,IAAI68B,YAAY,GAAGC,OAAvD,EAAgE;AAC9DpiD,QAAAA,SAAS,GAAGsD,IAAZ;AACAgiB,QAAAA,MAAM,GAAGA,MAAM,GAAG68B,YAAlB;AACA;AACD;;AACD,UAAI,CAACf,QAAQ,CAAC99C,IAAI,CAACsE,WAAN,CAAb,EAAiC;AAC/B5H,QAAAA,SAAS,GAAGsD,IAAZ;AACAgiB,QAAAA,MAAM,GAAG88B,OAAT;AACA;AACD;;AACDD,MAAAA,YAAY,IAAIC,OAAhB;AACA9+C,MAAAA,IAAI,GAAGA,IAAI,CAACsE,WAAZ;AACD;;AACD,QAAIw5C,QAAQ,CAACphD,SAAD,CAAR,IAAuBslB,MAAM,GAAGtlB,SAAS,CAACkZ,IAAV,CAAexsB,MAAnD,EAA2D;AACzD44B,MAAAA,MAAM,GAAGtlB,SAAS,CAACkZ,IAAV,CAAexsB,MAAxB;AACD;;AACD,WAAO6zD,aAAa,CAACvgD,SAAD,EAAYslB,MAAZ,CAApB;AACD,GArBD;;AAsBA,MAAI+8B,SAAS,GAAG,UAAUxhD,IAAV,EAAgBkhD,IAAhB,EAAsB;AACpC,QAAIz8B,MAAJ;;AACA,QAAI,CAACy8B,IAAL,EAAW;AACT,aAAO,IAAP;AACD;;AACD,QAAIzgC,KAAK,GAAGygC,IAAI,CAACthD,KAAL,CAAW,GAAX,CAAZ;AACA,QAAI6hD,KAAK,GAAGhhC,KAAK,CAAC,CAAD,CAAL,CAAS7gB,KAAT,CAAe,GAAf,CAAZ;AACA6kB,IAAAA,MAAM,GAAGhE,KAAK,CAAC50B,MAAN,GAAe,CAAf,GAAmB40B,KAAK,CAAC,CAAD,CAAxB,GAA8B,QAAvC;AACA,QAAIthB,SAAS,GAAGrJ,MAAM,CAAC2rD,KAAD,EAAQ,UAAUvlC,MAAV,EAAkB3uB,KAAlB,EAAyB;AACrD,UAAIgT,KAAK,GAAG,4BAA4BF,IAA5B,CAAiC9S,KAAjC,CAAZ;;AACA,UAAI,CAACgT,KAAL,EAAY;AACV,eAAO,IAAP;AACD;;AACD,UAAIA,KAAK,CAAC,CAAD,CAAL,KAAa,QAAjB,EAA2B;AACzBA,QAAAA,KAAK,CAAC,CAAD,CAAL,GAAW,OAAX;AACD;;AACD,aAAO6gD,eAAe,CAACllC,MAAD,EAAS3b,KAAK,CAAC,CAAD,CAAd,EAAmB4oB,QAAQ,CAAC5oB,KAAK,CAAC,CAAD,CAAN,EAAW,EAAX,CAA3B,CAAtB;AACD,KATqB,EASnBP,IATmB,CAAtB;;AAUA,QAAI,CAACb,SAAL,EAAgB;AACd,aAAO,IAAP;AACD;;AACD,QAAI,CAACohD,QAAQ,CAACphD,SAAD,CAAb,EAA0B;AACxB,UAAIslB,MAAM,KAAK,OAAf,EAAwB;AACtBA,QAAAA,MAAM,GAAGg8B,WAAW,CAACthD,SAAD,CAAX,GAAyB,CAAlC;AACD,OAFD,MAEO;AACLslB,QAAAA,MAAM,GAAGg8B,WAAW,CAACthD,SAAD,CAApB;AACD;;AACD,aAAOugD,aAAa,CAACvgD,SAAS,CAACgH,UAAX,EAAuBse,MAAvB,CAApB;AACD;;AACD,WAAO48B,gBAAgB,CAACliD,SAAD,EAAYgqB,QAAQ,CAAC1E,MAAD,EAAS,EAAT,CAApB,CAAvB;AACD,GA9BD;;AAgCA,MAAIi9B,wBAAwB,GAAGjzC,sBAA/B;;AACA,MAAIkzC,uBAAuB,GAAG,UAAU/mD,IAAV,EAAgBuE,SAAhB,EAA2BslB,MAA3B,EAAmC;AAC/D,QAAIhiB,IAAJ,EAAUm/C,aAAV;AACAA,IAAAA,aAAa,GAAGhnD,IAAI,CAACuE,SAAS,CAACkZ,IAAV,CAAeltB,KAAf,CAAqB,CAArB,EAAwBs5B,MAAxB,CAAD,CAAJ,CAAsC54B,MAAtD;;AACA,SAAK4W,IAAI,GAAGtD,SAAS,CAAC2H,eAAtB,EAAuCrE,IAAI,IAAIyL,QAAQ,CAACzL,IAAD,CAAvD,EAA+DA,IAAI,GAAGA,IAAI,CAACqE,eAA3E,EAA4F;AAC1F86C,MAAAA,aAAa,IAAIhnD,IAAI,CAAC6H,IAAI,CAAC4V,IAAN,CAAJ,CAAgBxsB,MAAjC;AACD;;AACD,WAAO+1D,aAAP;AACD,GAPD;;AAQA,MAAIC,QAAQ,GAAG,UAAUh/C,GAAV,EAAejI,IAAf,EAAqB8wC,UAArB,EAAiCoM,GAAjC,EAAsCx9C,KAAtC,EAA6C;AAC1D,QAAI6E,SAAS,GAAG24C,GAAG,CAACx9C,KAAK,GAAG,gBAAH,GAAsB,cAA5B,CAAnB;AACA,QAAImqB,MAAM,GAAGqzB,GAAG,CAACx9C,KAAK,GAAG,aAAH,GAAmB,WAAzB,CAAhB;AACA,QAAIwnD,KAAK,GAAG,EAAZ;AACA,QAAI3/C,UAAJ;AAAA,QAAgB0G,KAAK,GAAG,CAAxB;AACA,QAAI7I,IAAI,GAAG6C,GAAG,CAACypC,OAAJ,EAAX;;AACA,QAAIp+B,QAAQ,CAAC/O,SAAD,CAAZ,EAAyB;AACvB2iD,MAAAA,KAAK,CAACjwD,IAAN,CAAW65C,UAAU,GAAGiW,uBAAuB,CAAC/mD,IAAD,EAAOuE,SAAP,EAAkBslB,MAAlB,CAA1B,GAAsDA,MAA3E;AACD,KAFD,MAEO;AACLtiB,MAAAA,UAAU,GAAGhD,SAAS,CAACgD,UAAvB;;AACA,UAAIsiB,MAAM,IAAItiB,UAAU,CAACtW,MAArB,IAA+BsW,UAAU,CAACtW,MAA9C,EAAsD;AACpDgd,QAAAA,KAAK,GAAG,CAAR;AACA4b,QAAAA,MAAM,GAAGlY,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYrK,UAAU,CAACtW,MAAX,GAAoB,CAAhC,CAAT;AACD;;AACDi2D,MAAAA,KAAK,CAACjwD,IAAN,CAAWgR,GAAG,CAACy+B,SAAJ,CAAcn/B,UAAU,CAACsiB,MAAD,CAAxB,EAAkCinB,UAAlC,IAAgD7iC,KAA3D;AACD;;AACD,WAAO1J,SAAS,IAAIA,SAAS,KAAKa,IAAlC,EAAwCb,SAAS,GAAGA,SAAS,CAACgH,UAA9D,EAA0E;AACxE27C,MAAAA,KAAK,CAACjwD,IAAN,CAAWgR,GAAG,CAACy+B,SAAJ,CAAcniC,SAAd,EAAyBusC,UAAzB,CAAX;AACD;;AACD,WAAOoW,KAAP;AACD,GApBD;;AAqBA,MAAIC,WAAW,GAAG,UAAUnnD,IAAV,EAAgBm9C,SAAhB,EAA2BrM,UAA3B,EAAuCoM,GAAvC,EAA4C;AAC5D,QAAIj1C,GAAG,GAAGk1C,SAAS,CAACl1C,GAApB;AAAA,QAAyBm/C,QAAQ,GAAG,EAApC;AACAA,IAAAA,QAAQ,CAAC1nD,KAAT,GAAiBunD,QAAQ,CAACh/C,GAAD,EAAMjI,IAAN,EAAY8wC,UAAZ,EAAwBoM,GAAxB,EAA6B,IAA7B,CAAzB;;AACA,QAAI,CAACC,SAAS,CAACkK,WAAV,EAAL,EAA8B;AAC5BD,MAAAA,QAAQ,CAACE,GAAT,GAAeL,QAAQ,CAACh/C,GAAD,EAAMjI,IAAN,EAAY8wC,UAAZ,EAAwBoM,GAAxB,EAA6B,KAA7B,CAAvB;AACD;;AACD,WAAOkK,QAAP;AACD,GAPD;;AAQA,MAAIG,WAAW,GAAG,UAAUt/C,GAAV,EAAelY,IAAf,EAAqBoZ,OAArB,EAA8B;AAC9C,QAAI2V,KAAK,GAAG,CAAZ;AACAnY,IAAAA,KAAK,CAAC9R,IAAN,CAAWoT,GAAG,CAAC+2B,MAAJ,CAAWjvC,IAAX,CAAX,EAA6B,UAAU8X,IAAV,EAAgB;AAC3C,UAAIA,IAAI,CAACkL,YAAL,CAAkB,gBAAlB,MAAwC,KAA5C,EAAmD;AACjD;AACD;;AACD,UAAIlL,IAAI,KAAKsB,OAAb,EAAsB;AACpB,eAAO,KAAP;AACD;;AACD2V,MAAAA,KAAK;AACN,KARD;AASA,WAAOA,KAAP;AACD,GAZD;;AAaA,MAAI0oC,YAAY,GAAG,UAAUtK,GAAV,EAAex9C,KAAf,EAAsB;AACvC,QAAI6E,SAAJ,EAAeslB,MAAf,EAAuBtiB,UAAvB;AACA,QAAI3H,MAAM,GAAGF,KAAK,GAAG,OAAH,GAAa,KAA/B;AACA6E,IAAAA,SAAS,GAAG24C,GAAG,CAACt9C,MAAM,GAAG,WAAV,CAAf;AACAiqB,IAAAA,MAAM,GAAGqzB,GAAG,CAACt9C,MAAM,GAAG,QAAV,CAAZ;;AACA,QAAIsS,WAAW,CAAC3N,SAAD,CAAX,IAA0BA,SAAS,CAACmG,QAAV,KAAuB,IAArD,EAA2D;AACzDnD,MAAAA,UAAU,GAAGhD,SAAS,CAACgD,UAAvB;AACAhD,MAAAA,SAAS,GAAGgD,UAAU,CAACoK,IAAI,CAACswC,GAAL,CAASviD,KAAK,GAAGmqB,MAAH,GAAYA,MAAM,GAAG,CAAnC,EAAsCtiB,UAAU,CAACtW,MAAX,GAAoB,CAA1D,CAAD,CAAtB;;AACA,UAAIsT,SAAJ,EAAe;AACbslB,QAAAA,MAAM,GAAGnqB,KAAK,GAAG,CAAH,GAAO6E,SAAS,CAACgD,UAAV,CAAqBtW,MAA1C;AACAisD,QAAAA,GAAG,CAAC,SAASx9C,KAAK,GAAG,OAAH,GAAa,KAA3B,CAAD,CAAH,CAAuC6E,SAAvC,EAAkDslB,MAAlD;AACD;AACF;AACF,GAbD;;AAcA,MAAI49B,2BAA2B,GAAG,UAAUvK,GAAV,EAAe;AAC/CsK,IAAAA,YAAY,CAACtK,GAAD,EAAM,IAAN,CAAZ;AACAsK,IAAAA,YAAY,CAACtK,GAAD,EAAM,KAAN,CAAZ;AACA,WAAOA,GAAP;AACD,GAJD;;AAKA,MAAIp2B,WAAW,GAAG,UAAUjf,IAAV,EAAgBgiB,MAAhB,EAAwB;AACxC,QAAI3b,OAAJ;;AACA,QAAIgE,WAAW,CAACrK,IAAD,CAAf,EAAuB;AACrBA,MAAAA,IAAI,GAAG06C,OAAO,CAAC16C,IAAD,EAAOgiB,MAAP,CAAd;;AACA,UAAIi9B,wBAAwB,CAACj/C,IAAD,CAA5B,EAAoC;AAClC,eAAOA,IAAP;AACD;AACF;;AACD,QAAIuhB,gBAAgB,CAACvhB,IAAD,CAApB,EAA4B;AAC1B,UAAIyL,QAAQ,CAACzL,IAAD,CAAR,IAAkBqhB,qBAAqB,CAACrhB,IAAD,CAA3C,EAAmD;AACjDA,QAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD2C,MAAAA,OAAO,GAAGrG,IAAI,CAACqE,eAAf;;AACA,UAAI46C,wBAAwB,CAAC54C,OAAD,CAA5B,EAAuC;AACrC,eAAOA,OAAP;AACD;;AACDA,MAAAA,OAAO,GAAGrG,IAAI,CAACsE,WAAf;;AACA,UAAI26C,wBAAwB,CAAC54C,OAAD,CAA5B,EAAuC;AACrC,eAAOA,OAAP;AACD;AACF;AACF,GArBD;;AAsBA,MAAIw5C,mCAAmC,GAAG,UAAUxK,GAAV,EAAe;AACvD,WAAOp2B,WAAW,CAACo2B,GAAG,CAACryB,cAAL,EAAqBqyB,GAAG,CAACnG,WAAzB,CAAX,IAAoDjwB,WAAW,CAACo2B,GAAG,CAAClG,YAAL,EAAmBkG,GAAG,CAACjG,SAAvB,CAAtE;AACD,GAFD;;AAGA,MAAI0Q,iBAAiB,GAAG,UAAU3nD,IAAV,EAAgB8wC,UAAhB,EAA4BqM,SAA5B,EAAuC;AAC7D,QAAIh0C,OAAO,GAAGg0C,SAAS,CAACoF,OAAV,EAAd;AACA,QAAIxyD,IAAI,GAAGoZ,OAAO,GAAGA,OAAO,CAACuB,QAAX,GAAsB,IAAxC;AACA,QAAIwyC,GAAG,GAAGC,SAAS,CAACC,MAAV,EAAV;;AACA,QAAI0J,wBAAwB,CAAC39C,OAAD,CAAxB,IAAqCpZ,IAAI,KAAK,KAAlD,EAAyD;AACvD,aAAO;AACLA,QAAAA,IAAI,EAAEA,IADD;AAELgL,QAAAA,KAAK,EAAEwsD,WAAW,CAACpK,SAAS,CAACl1C,GAAX,EAAgBlY,IAAhB,EAAsBoZ,OAAtB;AAFb,OAAP;AAID;;AACD,QAAI+E,OAAO,GAAGw5C,mCAAmC,CAACxK,GAAD,CAAjD;;AACA,QAAIhvC,OAAJ,EAAa;AACXne,MAAAA,IAAI,GAAGme,OAAO,CAACiF,OAAf;AACA,aAAO;AACLpjB,QAAAA,IAAI,EAAEA,IADD;AAELgL,QAAAA,KAAK,EAAEwsD,WAAW,CAACpK,SAAS,CAACl1C,GAAX,EAAgBlY,IAAhB,EAAsBme,OAAtB;AAFb,OAAP;AAID;;AACD,WAAOi5C,WAAW,CAACnnD,IAAD,EAAOm9C,SAAP,EAAkBrM,UAAlB,EAA8BoM,GAA9B,CAAlB;AACD,GAnBD;;AAoBA,MAAI0K,gBAAgB,GAAG,UAAUzK,SAAV,EAAqB;AAC1C,QAAID,GAAG,GAAGC,SAAS,CAACC,MAAV,EAAV;AACA,WAAO;AACL19C,MAAAA,KAAK,EAAE2mD,QAAQ,CAAClJ,SAAS,CAACl1C,GAAV,CAAcypC,OAAd,EAAD,EAA0BoT,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAA1B,CADV;AAELoK,MAAAA,GAAG,EAAEjB,QAAQ,CAAClJ,SAAS,CAACl1C,GAAV,CAAcypC,OAAd,EAAD,EAA0BoT,aAAa,CAACI,YAAd,CAA2BhI,GAA3B,CAA1B;AAFR,KAAP;AAID,GAND;;AAOA,MAAI2K,gBAAgB,GAAG,UAAU1K,SAAV,EAAqB;AAC1C,WAAO;AAAED,MAAAA,GAAG,EAAEC,SAAS,CAACC,MAAV;AAAP,KAAP;AACD,GAFD;;AAGA,MAAI0K,kBAAkB,GAAG,UAAU7/C,GAAV,EAAenU,EAAf,EAAmBi0D,MAAnB,EAA2B;AAClD,QAAI71D,IAAI,GAAG;AACT,uBAAiB,UADR;AAET4B,MAAAA,EAAE,EAAEA,EAFK;AAGT,eAAS;AAHA,KAAX;AAKA,WAAOi0D,MAAM,GAAG9/C,GAAG,CAAC9C,MAAJ,CAAW,MAAX,EAAmBjT,IAAnB,EAAyB,UAAzB,CAAH,GAA0C+V,GAAG,CAAC9C,MAAJ,CAAW,MAAX,EAAmBjT,IAAnB,CAAvD;AACD,GAPD;;AAQA,MAAI81D,qBAAqB,GAAG,UAAU7K,SAAV,EAAqB4K,MAArB,EAA6B;AACvD,QAAI9/C,GAAG,GAAGk1C,SAAS,CAACl1C,GAApB;AACA,QAAIi1C,GAAG,GAAGC,SAAS,CAACC,MAAV,EAAV;AACA,QAAItpD,EAAE,GAAGmU,GAAG,CAAC8sC,QAAJ,EAAT;AACA,QAAIkT,SAAS,GAAG9K,SAAS,CAACkK,WAAV,EAAhB;AACA,QAAIl+C,OAAO,GAAGg0C,SAAS,CAACoF,OAAV,EAAd;AACA,QAAIxyD,IAAI,GAAGoZ,OAAO,CAACuB,QAAnB;;AACA,QAAI3a,IAAI,KAAK,KAAb,EAAoB;AAClB,aAAO;AACLA,QAAAA,IAAI,EAAEA,IADD;AAELgL,QAAAA,KAAK,EAAEwsD,WAAW,CAACt/C,GAAD,EAAMlY,IAAN,EAAYoZ,OAAZ;AAFb,OAAP;AAID;;AACD,QAAI++C,IAAI,GAAGT,2BAA2B,CAACvK,GAAG,CAACgH,UAAJ,EAAD,CAAtC;;AACA,QAAI,CAAC+D,SAAL,EAAgB;AACdC,MAAAA,IAAI,CAACxG,QAAL,CAAc,KAAd;AACA,UAAIyG,eAAe,GAAGL,kBAAkB,CAAC7/C,GAAD,EAAMnU,EAAE,GAAG,MAAX,EAAmBi0D,MAAnB,CAAxC;AACArC,MAAAA,eAAe,CAACz9C,GAAD,EAAMigD,IAAN,EAAYC,eAAZ,CAAf;AACD;;AACDjL,IAAAA,GAAG,GAAGuK,2BAA2B,CAACvK,GAAD,CAAjC;AACAA,IAAAA,GAAG,CAACwE,QAAJ,CAAa,IAAb;AACA,QAAI0G,iBAAiB,GAAGN,kBAAkB,CAAC7/C,GAAD,EAAMnU,EAAE,GAAG,QAAX,EAAqBi0D,MAArB,CAA1C;AACArC,IAAAA,eAAe,CAACz9C,GAAD,EAAMi1C,GAAN,EAAWkL,iBAAX,CAAf;AACAjL,IAAAA,SAAS,CAACkL,cAAV,CAAyB;AACvBv0D,MAAAA,EAAE,EAAEA,EADmB;AAEvBw0D,MAAAA,IAAI,EAAE;AAFiB,KAAzB;AAIA,WAAO;AAAEx0D,MAAAA,EAAE,EAAEA;AAAN,KAAP;AACD,GA5BD;;AA6BA,MAAIy0D,WAAW,GAAG,UAAUpL,SAAV,EAAqBlnD,IAArB,EAA2B66C,UAA3B,EAAuC;AACvD,QAAI76C,IAAI,KAAK,CAAb,EAAgB;AACd,aAAO0xD,iBAAiB,CAAC5+B,MAAD,EAAS+nB,UAAT,EAAqBqM,SAArB,CAAxB;AACD,KAFD,MAEO,IAAIlnD,IAAI,KAAK,CAAb,EAAgB;AACrB,aAAO2xD,gBAAgB,CAACzK,SAAD,CAAvB;AACD,KAFM,MAEA,IAAIlnD,IAAJ,EAAU;AACf,aAAO4xD,gBAAgB,CAAC1K,SAAD,CAAvB;AACD,KAFM,MAEA;AACL,aAAO6K,qBAAqB,CAAC7K,SAAD,EAAY,KAAZ,CAA5B;AACD;AACF,GAVD;;AAWA,MAAIqL,eAAe,GAAG31D,KAAK,CAAC80D,iBAAD,EAAoB/0D,QAApB,EAA8B,IAA9B,CAA3B;AAEA,MAAI61D,KAAK,GAAGzX,QAAQ,CAAC2D,GAArB;AACA,MAAI+T,oBAAoB,GAAG,6IAA3B;;AACA,MAAIC,cAAc,GAAG,UAAU1lC,MAAV,EAAkBlzB,IAAlB,EAAwBwhC,YAAxB,EAAsC;AACzD,QAAI5+B,KAAK,GAAGswB,MAAM,CAAC2lC,QAAP,CAAgB74D,IAAhB,EAAsBwhC,YAAtB,CAAZ;;AACA,QAAI5+B,KAAK,CAACzC,OAAN,CAAc,GAAd,MAAuB,CAAC,CAA5B,EAA+B;AAC7B,UAAI24D,OAAO,GAAG5lC,MAAM,CAAC2lC,QAAP,CAAgB74D,IAAhB,EAAsB,EAAtB,EAA0B,MAA1B,CAAd;AACA,aAAO84D,OAAO,CAAC5vD,cAAR,CAAuBgqB,MAAM,CAACnvB,EAA9B,IAAoC+0D,OAAO,CAAC5lC,MAAM,CAACnvB,EAAR,CAA3C,GAAyDy9B,YAAhE;AACD,KAHD,MAGO;AACL,aAAO5+B,KAAP;AACD;AACF,GARD;;AASA,MAAIm2D,cAAc,GAAG,UAAU7lC,MAAV,EAAkB;AACrC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,cAAhB,EAAgC,EAAhC,CAAP;AACD,GAFD;;AAGA,MAAIG,UAAU,GAAG,UAAU9lC,MAAV,EAAkB;AACjC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,SAAhB,EAA2B,iBAA3B,CAAP;AACD,GAFD;;AAGA,MAAII,kBAAkB,GAAG,UAAU/lC,MAAV,EAAkB;AACzC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,mBAAhB,EAAqC,EAArC,CAAP;AACD,GAFD;;AAGA,MAAIK,SAAS,GAAG,UAAUhmC,MAAV,EAAkB;AAChC,WAAO0lC,cAAc,CAAC1lC,MAAD,EAAS,SAAT,EAAoB,SAApB,CAArB;AACD,GAFD;;AAGA,MAAIimC,YAAY,GAAG,UAAUjmC,MAAV,EAAkB;AACnC,WAAO0lC,cAAc,CAAC1lC,MAAD,EAAS,YAAT,EAAuB,EAAvB,CAArB;AACD,GAFD;;AAGA,MAAIkmC,wBAAwB,GAAG,UAAUlmC,MAAV,EAAkB;AAC/C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,yBAAhB,EAA2C,EAA3C,CAAP;AACD,GAFD;;AAGA,MAAIQ,gBAAgB,GAAG,UAAUnmC,MAAV,EAAkB;AACvC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,WAAhB,EAA6B,IAA7B,CAAP;AACD,GAFD;;AAGA,MAAIS,kBAAkB,GAAG,UAAUpmC,MAAV,EAAkB;AACzC,QAAIA,MAAM,CAAC2lC,QAAP,CAAgB,kBAAhB,EAAoC,KAApC,CAAJ,EAAgD;AAC9C,aAAO,GAAP;AACD;;AACD,QAAIU,KAAK,GAAGrmC,MAAM,CAAC2lC,QAAP,CAAgB,mBAAhB,EAAqC,GAArC,CAAZ;;AACA,QAAIU,KAAK,KAAK,KAAd,EAAqB;AACnB,aAAO,EAAP;AACD,KAFD,MAEO,IAAIA,KAAK,KAAK,IAAd,EAAoB;AACzB,aAAO,GAAP;AACD,KAFM,MAEA;AACL,aAAOA,KAAP;AACD;AACF,GAZD;;AAaA,MAAIC,uBAAuB,GAAG,UAAUtmC,MAAV,EAAkB;AAC9C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,yBAAhB,EAA2C,EAA3C,CAAP;AACD,GAFD;;AAGA,MAAIY,oBAAoB,GAAG,UAAUvmC,MAAV,EAAkB;AAC3C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,qBAAhB,EAAuC,gCAAvC,CAAP;AACD,GAFD;;AAGA,MAAIa,oBAAoB,GAAG,UAAUxmC,MAAV,EAAkB;AAC3C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,qBAAhB,EAAuC,EAAvC,CAAP;AACD,GAFD;;AAGA,MAAIc,gBAAgB,GAAG,UAAUzmC,MAAV,EAAkB;AACvC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,aAAhB,EAA+B,IAA/B,CAAP;AACD,GAFD;;AAGA,MAAIe,8BAA8B,GAAG,UAAU1mC,MAAV,EAAkB;AACrD,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,8BAAhB,EAAgD,KAAhD,CAAP;AACD,GAFD;;AAGA,MAAIgB,kBAAkB,GAAG,UAAU3mC,MAAV,EAAkB;AACzC,WAAOtc,KAAK,CAACJ,OAAN,CAAc0c,MAAM,CAAC2lC,QAAP,CAAgB,wBAAhB,EAA0C,sDAA1C,CAAd,CAAP;AACD,GAFD;;AAGA,MAAIiB,kBAAkB,GAAG,UAAU5mC,MAAV,EAAkB;AACzC,WAAOtc,KAAK,CAACJ,OAAN,CAAc0c,MAAM,CAAC2lC,QAAP,CAAgB,mBAAhB,EAAqC,EAArC,CAAd,CAAP;AACD,GAFD;;AAGA,MAAIkB,sBAAsB,GAAG,UAAU7mC,MAAV,EAAkB;AAC7C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,uBAAhB,EAAyCp1D,MAAzC,EAAiD,UAAjD,CAAP;AACD,GAFD;;AAGA,MAAIu2D,yBAAyB,GAAG,UAAU9mC,MAAV,EAAkB;AAChD,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,mBAAhB,EAAqC,IAArC,EAA2C,SAA3C,CAAP;AACD,GAFD;;AAGA,MAAIoB,mBAAmB,GAAG,UAAU/mC,MAAV,EAAkB;AAC1C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,uBAAhB,EAAyC,KAAzC,EAAgD,SAAhD,CAAP;AACD,GAFD;;AAGA,MAAIqB,qBAAqB,GAAG,UAAUhnC,MAAV,EAAkB;AAC5C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,0BAAhB,EAA4C,IAA5C,EAAkD,SAAlD,CAAP;AACD,GAFD;;AAGA,MAAIsB,eAAe,GAAG,UAAUjnC,MAAV,EAAkB;AACtC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,OAAhB,EAAyB,EAAzB,EAA6B,QAA7B,CAAP;AACD,GAFD;;AAGA,MAAIuB,WAAW,GAAG,UAAUlnC,MAAV,EAAkB;AAClC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,WAAhB,EAA6B,EAA7B,EAAiC,QAAjC,CAAP;AACD,GAFD;;AAGA,MAAIwB,iBAAiB,GAAG,UAAUnnC,MAAV,EAAkB;AACxC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,mBAAhB,EAAqC,EAArC,EAAyC,QAAzC,CAAP;AACD,GAFD;;AAGA,MAAIyB,sBAAsB,GAAG,UAAUpnC,MAAV,EAAkB;AAC7C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,yBAAhB,EAA2C,EAA3C,EAA+C,QAA/C,CAAP;AACD,GAFD;;AAGA,MAAI0B,0BAA0B,GAAG,UAAUrnC,MAAV,EAAkB;AACjD,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,2BAAhB,EAA6C,KAA7C,EAAoD,SAApD,CAAP;AACD,GAFD;;AAGA,MAAI2B,sBAAsB,GAAG,UAAUtnC,MAAV,EAAkB;AAC7C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,uBAAhB,EAAyC,IAAzC,EAA+C,UAA/C,CAAP;AACD,GAFD;;AAGA,MAAI4B,uBAAuB,GAAG,UAAUvnC,MAAV,EAAkB;AAC9C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,kBAAhB,EAAoC,KAApC,EAA2C,SAA3C,CAAP;AACD,GAFD;;AAGA,MAAI6B,iBAAiB,GAAG,UAAUxnC,MAAV,EAAkB;AACxC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,iBAAhB,EAAmC,EAAnC,EAAuC,QAAvC,CAAP;AACD,GAFD;;AAGA,MAAI8B,eAAe,GAAG,UAAUznC,MAAV,EAAkB;AACtC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,UAAhB,EAA4B,IAA5B,EAAkC,QAAlC,CAAP;AACD,GAFD;;AAGA,MAAI+B,cAAc,GAAG,UAAU1nC,MAAV,EAAkB;AACrC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,cAAhB,EAAgC,EAAhC,EAAoC,QAApC,CAAP;AACD,GAFD;;AAGA,MAAIgC,qBAAqB,GAAG,UAAU3nC,MAAV,EAAkB;AAC5C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,mBAAhB,EAAqC,KAArC,CAAP;AACD,GAFD;;AAGA,MAAIiC,cAAc,GAAG,UAAU5nC,MAAV,EAAkB;AACrC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,aAAhB,EAA+B,MAA/B,EAAuC,QAAvC,CAAP;AACD,GAFD;;AAGA,MAAIkC,aAAa,GAAG,UAAU7nC,MAAV,EAAkB;AACpC,QAAI8nC,UAAU,GAAG9nC,MAAM,CAAC2lC,QAAP,CAAgB,aAAhB,CAAjB;;AACA,QAAIxyD,QAAQ,CAAC20D,UAAD,CAAZ,EAA0B;AACxB,aAAOn2D,GAAG,CAACm2D,UAAU,CAAC/lD,KAAX,CAAiB,GAAjB,CAAD,EAAwBhF,IAAxB,CAAV;AACD,KAFD,MAEO,IAAI1J,OAAO,CAACy0D,UAAD,CAAX,EAAyB;AAC9B,aAAOA,UAAP;AACD,KAFM,MAEA,IAAIA,UAAU,KAAK,KAAf,IAAwB9nC,MAAM,CAAC+R,MAAnC,EAA2C;AAChD,aAAO,EAAP;AACD,KAFM,MAEA;AACL,aAAO,CAAC,SAAD,CAAP;AACD;AACF,GAXD;;AAYA,MAAIg2B,UAAU,GAAG,UAAU/nC,MAAV,EAAkB;AACjC,QAAIgoC,OAAO,GAAGhoC,MAAM,CAAC2lC,QAAP,CAAgB,UAAhB,EAA4B,EAA5B,CAAd;AACA,WAAOtyD,OAAO,CAAC20D,OAAD,CAAP,GAAmBA,OAAnB,GAA6Br2D,GAAG,CAACq2D,OAAO,CAACjmD,KAAR,CAAc,GAAd,CAAD,EAAqBhF,IAArB,CAAvC;AACD,GAHD;;AAIA,MAAIkrD,iBAAiB,GAAG,UAAUjoC,MAAV,EAAkB;AACxC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,gBAAhB,EAAkC/O,IAAI,CAACF,KAAL,KAAe,KAAf,GAAuBlqD,SAAzD,CAAP;AACD,GAFD;;AAGA,MAAI07D,yBAAyB,GAAG,UAAUloC,MAAV,EAAkB;AAChD,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,4BAAhB,EAA8C,8BAA9C,EAA8E,QAA9E,CAAP;AACD,GAFD;;AAGA,MAAIwC,iBAAiB,GAAG,UAAUnoC,MAAV,EAAkB;AACxC,QAAI7Z,QAAQ,GAAG6Z,MAAM,CAAC2lC,QAAP,CAAgB,iBAAhB,CAAf;;AACA,QAAIx/C,QAAQ,KAAK,KAAb,IAAsB1F,GAAG,CAACG,GAA9B,EAAmC;AACjC,aAAO,KAAP;AACD,KAFD,MAEO;AACL,aAAOzN,QAAQ,CAACgT,QAAD,CAAR,GAAqBA,QAArB,GAAgC,yCAAvC;AACD;AACF,GAPD;;AAQA,MAAIiiD,wBAAwB,GAAG,UAAUpoC,MAAV,EAAkB;AAC/C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,yBAAhB,EAA2C,IAA3C,EAAiD,SAAjD,CAAP;AACD,GAFD;;AAGA,MAAI0C,cAAc,GAAG,UAAUroC,MAAV,EAAkB;AACrC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,aAAhB,EAA+BH,KAAK,CAAC7W,SAAN,CAAgB3uB,MAAM,CAACsoC,UAAP,EAAhB,EAAqC,aAArC,CAA/B,EAAoF,QAApF,CAAP;AACD,GAFD;;AAGA,MAAIC,YAAY,GAAG,UAAUvoC,MAAV,EAAkB;AACnC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,YAAhB,CAAP;AACD,GAFD;;AAGA,MAAI6C,iBAAiB,GAAG,UAAUxoC,MAAV,EAAkB;AACxC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,iBAAhB,CAAP;AACD,GAFD;;AAGA,MAAI8C,QAAQ,GAAG,UAAUzoC,MAAV,EAAkB;AAC/B,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,OAAhB,CAAP;AACD,GAFD;;AAGA,MAAI+C,cAAc,GAAG,UAAU1oC,MAAV,EAAkB;AACrC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,UAAhB,CAAP;AACD,GAFD;;AAGA,MAAIgD,yBAAyB,GAAG,UAAU3oC,MAAV,EAAkB;AAChD,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,mBAAhB,MAAyC,KAAhD;AACD,GAFD;;AAGA,MAAIiD,UAAU,GAAG,UAAU5oC,MAAV,EAAkB;AACjC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,SAAhB,CAAP;AACD,GAFD;;AAGA,MAAIkD,gBAAgB,GAAG,UAAU7oC,MAAV,EAAkB;AACvC,QAAIhP,KAAK,GAAGgP,MAAM,CAAC2lC,QAAP,CAAgB,gBAAhB,EAAkCF,oBAAlC,CAAZ;;AACA,QAAItyD,QAAQ,CAAC6d,KAAD,CAAZ,EAAqB;AACnB,aAAOA,KAAP;AACD,KAFD,MAEO;AACL,aAAO,EAAP;AACD;AACF,GAPD;;AAQA,MAAI83C,mBAAmB,GAAG,UAAU9oC,MAAV,EAAkB;AAC1C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,oBAAhB,EAAsC,KAAtC,EAA6C,SAA7C,CAAP;AACD,GAFD;;AAGA,MAAIoD,mBAAmB,GAAG,UAAU/oC,MAAV,EAAkB;AAC1C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,oBAAhB,EAAsC,EAAtC,EAA0C,QAA1C,CAAP;AACD,GAFD;;AAGA,MAAIqD,WAAW,GAAG,UAAUhpC,MAAV,EAAkB;AAClC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,WAAhB,CAAP;AACD,GAFD;;AAGA,MAAIsD,UAAU,GAAG,UAAUjpC,MAAV,EAAkB;AACjC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,QAAhB,CAAP;AACD,GAFD;;AAGA,MAAIuD,cAAc,GAAG,UAAUlpC,MAAV,EAAkB;AACrC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,cAAhB,CAAP;AACD,GAFD;;AAGA,MAAIwD,iBAAiB,GAAG,UAAUnpC,MAAV,EAAkB;AACxC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,cAAhB,CAAP;AACD,GAFD;;AAGA,MAAIyD,aAAa,GAAG,UAAUppC,MAAV,EAAkB;AACpC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,UAAhB,MAAgC,KAAvC;AACD,GAFD;;AAGA,MAAI0D,0BAA0B,GAAG,UAAUrpC,MAAV,EAAkB;AACjD,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,yBAAhB,CAAP;AACD,GAFD;;AAGA,MAAI2D,sBAAsB,GAAG,UAAUtpC,MAAV,EAAkB;AAC7C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,oBAAhB,CAAP;AACD,GAFD;;AAGA,MAAI4D,kBAAkB,GAAG,UAAUvpC,MAAV,EAAkB;AACzC,WAAOomC,kBAAkB,CAACpmC,MAAD,CAAlB,KAA+B,EAAtC;AACD,GAFD;;AAGA,MAAIwpC,uBAAuB,GAAG,UAAUxpC,MAAV,EAAkB;AAC9C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,yBAAhB,EAA2C,CAA3C,EAA8C,QAA9C,CAAP;AACD,GAFD;;AAGA,MAAI8D,uBAAuB,GAAG,UAAUzpC,MAAV,EAAkB;AAC9C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,oBAAhB,CAAP;AACD,GAFD;;AAGA,MAAI+D,UAAU,GAAG,UAAU1pC,MAAV,EAAkB;AACjC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,UAAhB,CAAP;AACD,GAFD;;AAGA,MAAIgE,iBAAiB,GAAG,UAAU3pC,MAAV,EAAkB;AACxC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,kBAAhB,CAAP;AACD,GAFD;;AAGA,MAAIiE,UAAU,GAAG,UAAU5pC,MAAV,EAAkB;AACjC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,SAAhB,EAA2B,EAA3B,EAA+B,QAA/B,CAAP;AACD,GAFD;;AAGA,MAAIkE,kBAAkB,GAAG,UAAU7pC,MAAV,EAAkB;AACzC,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,kBAAhB,CAAP;AACD,GAFD;;AAGA,MAAImE,0BAA0B,GAAG,UAAU9pC,MAAV,EAAkB;AACjD,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,wBAAhB,EAA0C,IAA1C,EAAgD,SAAhD,CAAP;AACD,GAFD;;AAGA,MAAIoE,mBAAmB,GAAG,UAAU/pC,MAAV,EAAkB;AAC1C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,QAAhB,EAA0B,IAA1B,EAAgC,SAAhC,CAAP;AACD,GAFD;;AAGA,MAAIqE,uBAAuB,GAAG,UAAUhqC,MAAV,EAAkB;AAC9C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,oBAAhB,EAAsC,gBAAtC,EAAwD,QAAxD,CAAP;AACD,GAFD;;AAGA,MAAIsE,wBAAwB,GAAG,UAAUjqC,MAAV,EAAkB;AAC/C,WAAOA,MAAM,CAAC2lC,QAAP,CAAgB,qBAAhB,EAAuC,iBAAvC,EAA0D,QAA1D,CAAP;AACD,GAFD;;AAIA,MAAIuE,WAAW,GAAGj7C,WAAlB;AACA,MAAIk7C,QAAQ,GAAG95C,QAAf;;AACA,MAAI+5C,UAAU,GAAG,UAAUxlD,IAAV,EAAgB;AAC/B,QAAI0D,UAAU,GAAG1D,IAAI,CAAC0D,UAAtB;;AACA,QAAIA,UAAJ,EAAgB;AACdA,MAAAA,UAAU,CAACwD,WAAX,CAAuBlH,IAAvB;AACD;AACF,GALD;;AAMA,MAAIylD,SAAS,GAAG,UAAUvlD,IAAV,EAAgB;AAC9B,QAAIwlD,WAAW,GAAGxkC,MAAM,CAAChhB,IAAD,CAAxB;AACA,WAAO;AACL+W,MAAAA,KAAK,EAAE/W,IAAI,CAAC9W,MAAL,GAAcs8D,WAAW,CAACt8D,MAD5B;AAEL8W,MAAAA,IAAI,EAAEwlD;AAFD,KAAP;AAID,GAND;;AAOA,MAAIC,eAAe,GAAG,UAAU7iC,cAAV,EAA0B;AAC9C,QAAImc,GAAJ;;AACA,WAAO,CAACA,GAAG,GAAGnc,cAAc,CAAClN,IAAf,CAAoBg+B,WAApB,CAAgC5yB,IAAhC,CAAP,MAAkD,CAAC,CAA1D,EAA6D;AAC3D8B,MAAAA,cAAc,CAAC8iC,UAAf,CAA0B3mB,GAA1B,EAA+B,CAA/B;AACD;AACF,GALD;;AAMA,MAAI4mB,eAAe,GAAG,UAAU/iC,cAAV,EAA0BjU,GAA1B,EAA+B;AACnDi3C,IAAAA,QAAQ,CAAChjC,cAAD,CAAR;AACA,WAAOjU,GAAP;AACD,GAHD;;AAIA,MAAIk3C,uBAAuB,GAAG,UAAUjjC,cAAV,EAA0BjU,GAA1B,EAA+B;AAC3D,QAAI7I,MAAM,GAAGy/C,SAAS,CAAC3iC,cAAc,CAAClN,IAAf,CAAoBhe,MAApB,CAA2B,CAA3B,EAA8BiX,GAAG,CAACmT,MAAJ,EAA9B,CAAD,CAAtB;AACA,QAAI5b,KAAK,GAAGq/C,SAAS,CAAC3iC,cAAc,CAAClN,IAAf,CAAoBhe,MAApB,CAA2BiX,GAAG,CAACmT,MAAJ,EAA3B,CAAD,CAArB;AACA,QAAI9hB,IAAI,GAAG8F,MAAM,CAAC9F,IAAP,GAAckG,KAAK,CAAClG,IAA/B;;AACA,QAAIA,IAAI,CAAC9W,MAAL,GAAc,CAAlB,EAAqB;AACnBu8D,MAAAA,eAAe,CAAC7iC,cAAD,CAAf;AACA,aAAOm6B,aAAa,CAACn6B,cAAD,EAAiBjU,GAAG,CAACmT,MAAJ,KAAehc,MAAM,CAACiR,KAAvC,CAApB;AACD,KAHD,MAGO;AACL,aAAOpI,GAAP;AACD;AACF,GAVD;;AAWA,MAAIm3C,0BAA0B,GAAG,UAAUljC,cAAV,EAA0BjU,GAA1B,EAA+B;AAC9D,QAAInL,UAAU,GAAGmL,GAAG,CAACnS,SAAJ,EAAjB;AACA,QAAIupD,WAAW,GAAG59D,OAAO,CAAC6I,MAAM,CAACwS,UAAU,CAAChE,UAAZ,CAAP,EAAgCojB,cAAhC,CAAP,CAAuD/1B,GAAvD,CAA2D,UAAUmG,KAAV,EAAiB;AAC5F,aAAOA,KAAK,GAAG2b,GAAG,CAACmT,MAAJ,EAAR,GAAuBi7B,aAAa,CAACv5C,UAAD,EAAamL,GAAG,CAACmT,MAAJ,KAAe,CAA5B,CAApC,GAAqEnT,GAA5E;AACD,KAFiB,EAEfriB,KAFe,CAETqiB,GAFS,CAAlB;AAGAi3C,IAAAA,QAAQ,CAAChjC,cAAD,CAAR;AACA,WAAOmjC,WAAP;AACD,GAPD;;AAQA,MAAIC,wBAAwB,GAAG,UAAUpjC,cAAV,EAA0BjU,GAA1B,EAA+B;AAC5D,WAAO02C,QAAQ,CAACziC,cAAD,CAAR,IAA4BjU,GAAG,CAACnS,SAAJ,OAAoBomB,cAAhD,GAAiEijC,uBAAuB,CAACjjC,cAAD,EAAiBjU,GAAjB,CAAxF,GAAgHg3C,eAAe,CAAC/iC,cAAD,EAAiBjU,GAAjB,CAAtI;AACD,GAFD;;AAGA,MAAIs3C,2BAA2B,GAAG,UAAUrjC,cAAV,EAA0BjU,GAA1B,EAA+B;AAC/D,WAAOA,GAAG,CAACnS,SAAJ,OAAoBomB,cAAc,CAACpf,UAAnC,GAAgDsiD,0BAA0B,CAACljC,cAAD,EAAiBjU,GAAjB,CAA1E,GAAkGg3C,eAAe,CAAC/iC,cAAD,EAAiBjU,GAAjB,CAAxH;AACD,GAFD;;AAGA,MAAIu3C,mBAAmB,GAAG,UAAU1pD,SAAV,EAAqBmS,GAArB,EAA0B;AAClD,WAAOouC,aAAa,CAACO,cAAd,CAA6B3uC,GAA7B,IAAoCq3C,wBAAwB,CAACxpD,SAAD,EAAYmS,GAAZ,CAA5D,GAA+Es3C,2BAA2B,CAACzpD,SAAD,EAAYmS,GAAZ,CAAjH;AACD,GAFD;;AAGA,MAAIi3C,QAAQ,GAAG,UAAUO,kBAAV,EAA8B;AAC3C,QAAIf,WAAW,CAACe,kBAAD,CAAX,IAAmC9kC,gBAAgB,CAAC8kC,kBAAD,CAAvD,EAA6E;AAC3E,UAAI7kC,UAAU,CAAC6kC,kBAAD,CAAd,EAAoC;AAClCA,QAAAA,kBAAkB,CAACv5C,eAAnB,CAAmC,gBAAnC;AACD,OAFD,MAEO;AACL04C,QAAAA,UAAU,CAACa,kBAAD,CAAV;AACD;AACF;;AACD,QAAId,QAAQ,CAACc,kBAAD,CAAZ,EAAkC;AAChCV,MAAAA,eAAe,CAACU,kBAAD,CAAf;;AACA,UAAIA,kBAAkB,CAACzwC,IAAnB,CAAwBxsB,MAAxB,KAAmC,CAAvC,EAA0C;AACxCo8D,QAAAA,UAAU,CAACa,kBAAD,CAAV;AACD;AACF;AACF,GAdD;;AAgBA,MAAIC,SAAS,GAAGhrD,QAAQ,GAAG1G,OAA3B;AACA,MAAI2xD,wBAAwB,GAAGv6C,sBAA/B;AACA,MAAIw6C,SAAS,GAAGt6C,OAAhB;AACA,MAAIu6C,aAAa,GAAGx6C,WAApB;AACA,MAAIy6C,uBAAuB,GAAG,mDAA9B;;AACA,MAAIC,qBAAqB,GAAG,UAAUppD,IAAV,EAAgB+D,OAAhB,EAAyB0E,MAAzB,EAAiC;AAC3D,QAAI81C,UAAU,GAAGjC,QAAQ,CAACv4C,OAAO,CAACuG,qBAAR,EAAD,EAAkC7B,MAAlC,CAAzB;AACA,QAAI1F,MAAJ,EAAYsmD,OAAZ,EAAqBC,OAArB,EAA8BC,MAA9B,EAAsCC,QAAtC;;AACA,QAAIxpD,IAAI,CAAC+N,OAAL,KAAiB,MAArB,EAA6B;AAC3BhL,MAAAA,MAAM,GAAG/C,IAAI,CAAC8F,aAAL,CAAmBG,eAA5B;AACAojD,MAAAA,OAAO,GAAGrpD,IAAI,CAAC8K,UAAL,IAAmB/H,MAAM,CAAC+H,UAApC;AACAw+C,MAAAA,OAAO,GAAGtpD,IAAI,CAAC4K,SAAL,IAAkB7H,MAAM,CAAC6H,SAAnC;AACD,KAJD,MAIO;AACL4+C,MAAAA,QAAQ,GAAGxpD,IAAI,CAACsK,qBAAL,EAAX;AACA++C,MAAAA,OAAO,GAAGrpD,IAAI,CAAC8K,UAAL,GAAkB0+C,QAAQ,CAACx/C,IAArC;AACAs/C,MAAAA,OAAO,GAAGtpD,IAAI,CAAC4K,SAAL,GAAiB4+C,QAAQ,CAACv/C,GAApC;AACD;;AACDs0C,IAAAA,UAAU,CAACv0C,IAAX,IAAmBq/C,OAAnB;AACA9K,IAAAA,UAAU,CAACvyC,KAAX,IAAoBq9C,OAApB;AACA9K,IAAAA,UAAU,CAACt0C,GAAX,IAAkBq/C,OAAlB;AACA/K,IAAAA,UAAU,CAACtyC,MAAX,IAAqBq9C,OAArB;AACA/K,IAAAA,UAAU,CAACzyC,KAAX,GAAmB,CAAnB;AACAy9C,IAAAA,MAAM,GAAGxlD,OAAO,CAACwM,WAAR,GAAsBxM,OAAO,CAACqI,WAAvC;;AACA,QAAIm9C,MAAM,GAAG,CAAb,EAAgB;AACd,UAAI9gD,MAAJ,EAAY;AACV8gD,QAAAA,MAAM,IAAI,CAAC,CAAX;AACD;;AACDhL,MAAAA,UAAU,CAACv0C,IAAX,IAAmBu/C,MAAnB;AACAhL,MAAAA,UAAU,CAACvyC,KAAX,IAAoBu9C,MAApB;AACD;;AACD,WAAOhL,UAAP;AACD,GA1BD;;AA2BA,MAAIkL,yBAAyB,GAAG,UAAUzpD,IAAV,EAAgB;AAC9C,QAAI0pD,oBAAoB,GAAGlS,aAAa,CAACv0C,YAAY,CAACX,OAAb,CAAqBtC,IAArB,CAAD,EAA6BmpD,uBAA7B,CAAxC;;AACA,SAAK,IAAIp9D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG29D,oBAAoB,CAAC79D,MAAzC,EAAiDE,CAAC,EAAlD,EAAsD;AACpD,UAAI0W,IAAI,GAAGinD,oBAAoB,CAAC39D,CAAD,CAApB,CAAwB8W,GAAnC;AACA,UAAIiG,OAAO,GAAGrG,IAAI,CAACqE,eAAnB;;AACA,UAAIwd,sBAAsB,CAACxb,OAAD,CAA1B,EAAqC;AACnC,YAAIuP,IAAI,GAAGvP,OAAO,CAACuP,IAAnB;;AACA,YAAIA,IAAI,CAACxsB,MAAL,KAAgB,CAApB,EAAuB;AACrBid,UAAAA,OAAO,CAAC3C,UAAR,CAAmBwD,WAAnB,CAA+Bb,OAA/B;AACD,SAFD,MAEO;AACLA,UAAAA,OAAO,CAACu/C,UAAR,CAAmBhwC,IAAI,CAACxsB,MAAL,GAAc,CAAjC,EAAoC,CAApC;AACD;AACF;;AACDid,MAAAA,OAAO,GAAGrG,IAAI,CAACsE,WAAf;;AACA,UAAIqd,wBAAwB,CAACtb,OAAD,CAA5B,EAAuC;AACrC,YAAIuP,IAAI,GAAGvP,OAAO,CAACuP,IAAnB;;AACA,YAAIA,IAAI,CAACxsB,MAAL,KAAgB,CAApB,EAAuB;AACrBid,UAAAA,OAAO,CAAC3C,UAAR,CAAmBwD,WAAnB,CAA+Bb,OAA/B;AACD,SAFD,MAEO;AACLA,UAAAA,OAAO,CAACu/C,UAAR,CAAmB,CAAnB,EAAsB,CAAtB;AACD;AACF;AACF;AACF,GAvBD;;AAwBA,MAAIsB,SAAS,GAAG,UAAU9rC,MAAV,EAAkB7d,IAAlB,EAAwByiB,OAAxB,EAAiC4f,QAAjC,EAA2C;AACzD,QAAIunB,eAAe,GAAGxW,IAAI,CAAC1iD,QAAQ,CAACrC,IAAT,EAAD,CAA1B;AACA,QAAIw7D,cAAJ,EAAoBf,kBAApB;AACA,QAAIgB,SAAS,GAAG7F,kBAAkB,CAACpmC,MAAD,CAAlC;AACA,QAAIksC,UAAU,GAAGD,SAAS,CAACj+D,MAAV,GAAmB,CAAnB,GAAuBi+D,SAAvB,GAAmC,GAApD;;AACA,QAAI/f,IAAI,GAAG,UAAUthC,MAAV,EAAkB1E,OAAlB,EAA2B;AACpC,UAAIw6C,UAAJ,EAAgBzG,GAAhB;AACA9N,MAAAA,IAAI;;AACJ,UAAIkf,aAAa,CAACnlD,OAAD,CAAjB,EAA4B;AAC1B,eAAO,IAAP;AACD;;AACD,UAAI0e,OAAO,CAAC1e,OAAD,CAAX,EAAsB;AACpB+kD,QAAAA,kBAAkB,GAAG/jC,WAAW,CAACglC,UAAD,EAAahmD,OAAb,EAAsB0E,MAAtB,CAAhC;AACA81C,QAAAA,UAAU,GAAG6K,qBAAqB,CAACppD,IAAD,EAAO+D,OAAP,EAAgB0E,MAAhB,CAAlC;AACA2+B,QAAAA,QAAQ,CAAC0hB,kBAAD,CAAR,CAA6Bh5C,GAA7B,CAAiC,KAAjC,EAAwCyuC,UAAU,CAACt0C,GAAnD;AACA,YAAI+/C,KAAK,GAAG5iB,QAAQ,CAAC,2DAAD,CAAR,CAAsEt3B,GAAtE,CAA0EyuC,UAA1E,EAAsFrV,QAAtF,CAA+FlpC,IAA/F,EAAqG,CAArG,CAAZ;AACA4pD,QAAAA,eAAe,CAAC56C,GAAhB,CAAoBte,QAAQ,CAACR,IAAT,CAAc;AAChC85D,UAAAA,KAAK,EAAEA,KADyB;AAEhCjmD,UAAAA,OAAO,EAAEA,OAFuB;AAGhC0E,UAAAA,MAAM,EAAEA;AAHwB,SAAd,CAApB;AAKAmhD,QAAAA,eAAe,CAACp2D,GAAhB,GAAsB/D,IAAtB,CAA2B,UAAUw6D,UAAV,EAAsB;AAC/C,cAAIxhD,MAAJ,EAAY;AACV2+B,YAAAA,QAAQ,CAAC6iB,UAAU,CAACD,KAAZ,CAAR,CAA2BvgB,QAA3B,CAAoC,yBAApC;AACD;AACF,SAJD;AAKAygB,QAAAA,UAAU;AACVpS,QAAAA,GAAG,GAAG/zC,OAAO,CAAC+B,aAAR,CAAsB+qC,WAAtB,EAAN;AACAiH,QAAAA,GAAG,CAAC5G,QAAJ,CAAa4X,kBAAb,EAAiC,CAAjC;AACAhR,QAAAA,GAAG,CAAC3G,MAAJ,CAAW2X,kBAAX,EAA+B,CAA/B;AACD,OAnBD,MAmBO;AACLA,QAAAA,kBAAkB,GAAG5kC,YAAY,CAACngB,OAAD,EAAU0E,MAAV,CAAjC;AACAqvC,QAAAA,GAAG,GAAG/zC,OAAO,CAAC+B,aAAR,CAAsB+qC,WAAtB,EAAN;;AACA,YAAIsZ,uBAAuB,CAACrB,kBAAkB,CAAC/hD,WAApB,CAA3B,EAA6D;AAC3D+wC,UAAAA,GAAG,CAAC5G,QAAJ,CAAa4X,kBAAb,EAAiC,CAAjC;AACAhR,UAAAA,GAAG,CAAC3G,MAAJ,CAAW2X,kBAAX,EAA+B,CAA/B;AACD,SAHD,MAGO;AACLhR,UAAAA,GAAG,CAAC5G,QAAJ,CAAa4X,kBAAb,EAAiC,CAAjC;AACAhR,UAAAA,GAAG,CAAC3G,MAAJ,CAAW2X,kBAAX,EAA+B,CAA/B;AACD;;AACD,eAAOhR,GAAP;AACD;;AACD,aAAOA,GAAP;AACD,KAtCD;;AAuCA,QAAI9N,IAAI,GAAG,YAAY;AACrByf,MAAAA,yBAAyB,CAACzpD,IAAD,CAAzB;;AACA,UAAI8oD,kBAAJ,EAAwB;AACtBP,QAAAA,QAAQ,CAACO,kBAAD,CAAR;AACAA,QAAAA,kBAAkB,GAAG,IAArB;AACD;;AACDc,MAAAA,eAAe,CAACp2D,GAAhB,GAAsB/D,IAAtB,CAA2B,UAAUw6D,UAAV,EAAsB;AAC/C7iB,QAAAA,QAAQ,CAAC6iB,UAAU,CAACD,KAAZ,CAAR,CAA2BtgD,MAA3B;AACAkgD,QAAAA,eAAe,CAAC56C,GAAhB,CAAoBte,QAAQ,CAACrC,IAAT,EAApB;AACD,OAHD;;AAIA,UAAIw7D,cAAJ,EAAoB;AAClBlsC,QAAAA,KAAK,CAAC3G,aAAN,CAAoB6yC,cAApB;AACAA,QAAAA,cAAc,GAAG,IAAjB;AACD;AACF,KAdD;;AAeA,QAAIK,UAAU,GAAG,YAAY;AAC3BL,MAAAA,cAAc,GAAGlsC,KAAK,CAAC5G,WAAN,CAAkB,YAAY;AAC7C,YAAIsrB,QAAQ,EAAZ,EAAgB;AACd+E,UAAAA,QAAQ,CAAC,sBAAD,EAAyBpnC,IAAzB,CAAR,CAAuC0pC,WAAvC,CAAmD,yBAAnD;AACD,SAFD,MAEO;AACLtC,UAAAA,QAAQ,CAAC,sBAAD,EAAyBpnC,IAAzB,CAAR,CAAuCypC,QAAvC,CAAgD,yBAAhD;AACD;AACF,OANgB,EAMd,GANc,CAAjB;AAOD,KARD;;AASA,QAAI2gB,UAAU,GAAG,YAAY;AAC3BR,MAAAA,eAAe,CAACp2D,GAAhB,GAAsB/D,IAAtB,CAA2B,UAAUw6D,UAAV,EAAsB;AAC/C,YAAI1L,UAAU,GAAG6K,qBAAqB,CAACppD,IAAD,EAAOiqD,UAAU,CAAClmD,OAAlB,EAA2BkmD,UAAU,CAACxhD,MAAtC,CAAtC;AACA2+B,QAAAA,QAAQ,CAAC6iB,UAAU,CAACD,KAAZ,CAAR,CAA2Bl6C,GAA3B,CAA+BxZ,QAAQ,CAAC,EAAD,EAAKioD,UAAL,CAAvC;AACD,OAHD;AAID,KALD;;AAMA,QAAIplB,OAAO,GAAG,YAAY;AACxB,aAAOxb,KAAK,CAAC3G,aAAN,CAAoB6yC,cAApB,CAAP;AACD,KAFD;;AAGA,QAAIQ,MAAM,GAAG,YAAY;AACvB,aAAO,wBAAwB,qBAAxB,GAAgD,0BAAhD,GAA6E,iCAA7E,GAAiH,GAAjH,GAAuH,4BAAvH,GAAsJ,gBAAtJ,GAAyK,GAAzK,GAA+K,qBAA/K,GAAuM,qBAAvM,GAA+N,gBAA/N,GAAkP,cAAlP,GAAmQ,SAAnQ,GAA+Q,YAA/Q,GAA8R,aAA9R,GAA8S,GAArT;AACD,KAFD;;AAGA,WAAO;AACLtgB,MAAAA,IAAI,EAAEA,IADD;AAELC,MAAAA,IAAI,EAAEA,IAFD;AAGLqgB,MAAAA,MAAM,EAAEA,MAHH;AAILD,MAAAA,UAAU,EAAEA,UAJP;AAKLjxB,MAAAA,OAAO,EAAEA;AALJ,KAAP;AAOD,GAvFD;;AAwFA,MAAImxB,uBAAuB,GAAG,YAAY;AACxC,WAAOvB,SAAS,CAAC/sD,IAAV,MAAoB+sD,SAAS,CAACjtD,MAAV,EAApB,IAA0CitD,SAAS,CAAC7sD,SAAV,EAAjD;AACD,GAFD;;AAGA,MAAIiuD,uBAAuB,GAAG,UAAU1nD,IAAV,EAAgB;AAC5C,WAAOumD,wBAAwB,CAACvmD,IAAD,CAAxB,IAAkCwmD,SAAS,CAACxmD,IAAD,CAAlD;AACD,GAFD;;AAGA,MAAI8nD,iBAAiB,GAAG,UAAU9nD,IAAV,EAAgB;AACtC,WAAO0nD,uBAAuB,CAAC1nD,IAAD,CAAvB,IAAiCqL,OAAO,CAACrL,IAAD,CAAP,IAAiB6nD,uBAAuB,EAAhF;AACD,GAFD;;AAIA,MAAIE,wBAAwB,GAAG/7C,sBAA/B;AACA,MAAIg8C,SAAS,GAAG97C,OAAhB;AACA,MAAI+7C,WAAW,GAAGx9C,gBAAgB,CAAC,SAAD,EAAY,gDAAZ,CAAlC;AACA,MAAIy9C,kBAAkB,GAAG3mC,gBAAzB;AACA,MAAI4mC,uBAAuB,GAAG9mC,qBAA9B;AACA,MAAI+mC,WAAW,GAAG/9C,WAAlB;AACA,MAAIg+C,kBAAkB,GAAG5kC,gBAAzB;;AACA,MAAI6kC,UAAU,GAAG,UAAUzP,SAAV,EAAqB;AACpC,WAAOA,SAAS,GAAG,CAAnB;AACD,GAFD;;AAGA,MAAI0P,WAAW,GAAG,UAAU1P,SAAV,EAAqB;AACrC,WAAOA,SAAS,GAAG,CAAnB;AACD,GAFD;;AAGA,MAAI2P,mBAAmB,GAAG,UAAU/pD,IAAV,EAAgBugB,OAAhB,EAAyB;AACjD,QAAIhf,IAAJ;;AACA,WAAOA,IAAI,GAAGvB,IAAI,CAACugB,OAAD,CAAlB,EAA6B;AAC3B,UAAI,CAACmpC,uBAAuB,CAACnoD,IAAD,CAA5B,EAAoC;AAClC,eAAOA,IAAP;AACD;AACF;;AACD,WAAO,IAAP;AACD,GARD;;AASA,MAAIyoD,QAAQ,GAAG,UAAUzoD,IAAV,EAAgB64C,SAAhB,EAA2B6P,WAA3B,EAAwC9pC,QAAxC,EAAkDI,OAAlD,EAA2D;AACxE,QAAI8F,MAAM,GAAG,IAAIpG,aAAJ,CAAkB1e,IAAlB,EAAwB4e,QAAxB,CAAb;AACA,QAAI+pC,qBAAqB,GAAGZ,wBAAwB,CAAC/nD,IAAD,CAAxB,IAAkCmoD,uBAAuB,CAACnoD,IAAD,CAArF;;AACA,QAAIuoD,WAAW,CAAC1P,SAAD,CAAf,EAA4B;AAC1B,UAAI8P,qBAAJ,EAA2B;AACzB3oD,QAAAA,IAAI,GAAGwoD,mBAAmB,CAAC1jC,MAAM,CAAChG,IAAP,CAAY7xB,IAAZ,CAAiB63B,MAAjB,CAAD,EAA2B,IAA3B,CAA1B;;AACA,YAAI4jC,WAAW,CAAC1oD,IAAD,CAAf,EAAuB;AACrB,iBAAOA,IAAP;AACD;AACF;;AACD,aAAOA,IAAI,GAAGwoD,mBAAmB,CAAC1jC,MAAM,CAAChG,IAAP,CAAY7xB,IAAZ,CAAiB63B,MAAjB,CAAD,EAA2B9F,OAA3B,CAAjC,EAAsE;AACpE,YAAI0pC,WAAW,CAAC1oD,IAAD,CAAf,EAAuB;AACrB,iBAAOA,IAAP;AACD;AACF;AACF;;AACD,QAAIsoD,UAAU,CAACzP,SAAD,CAAd,EAA2B;AACzB,UAAI8P,qBAAJ,EAA2B;AACzB3oD,QAAAA,IAAI,GAAGwoD,mBAAmB,CAAC1jC,MAAM,CAACjG,IAAP,CAAY5xB,IAAZ,CAAiB63B,MAAjB,CAAD,EAA2B,IAA3B,CAA1B;;AACA,YAAI4jC,WAAW,CAAC1oD,IAAD,CAAf,EAAuB;AACrB,iBAAOA,IAAP;AACD;AACF;;AACD,aAAOA,IAAI,GAAGwoD,mBAAmB,CAAC1jC,MAAM,CAACjG,IAAP,CAAY5xB,IAAZ,CAAiB63B,MAAjB,CAAD,EAA2B9F,OAA3B,CAAjC,EAAsE;AACpE,YAAI0pC,WAAW,CAAC1oD,IAAD,CAAf,EAAuB;AACrB,iBAAOA,IAAP;AACD;AACF;AACF;;AACD,WAAO,IAAP;AACD,GA9BD;;AA+BA,MAAI4oD,cAAc,GAAG,UAAU5oD,IAAV,EAAgB4e,QAAhB,EAA0B;AAC7C,WAAO5e,IAAI,IAAIA,IAAI,KAAK4e,QAAxB,EAAkC;AAChC,UAAIqpC,WAAW,CAACjoD,IAAD,CAAf,EAAuB;AACrB,eAAOA,IAAP;AACD;;AACDA,MAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,WAAO,IAAP;AACD,GARD;;AASA,MAAImlD,aAAa,GAAG,UAAUC,cAAV,EAA0BC,cAA1B,EAA0CnqC,QAA1C,EAAoD;AACtE,WAAOgqC,cAAc,CAACE,cAAc,CAACpsD,SAAf,EAAD,EAA6BkiB,QAA7B,CAAd,KAAyDgqC,cAAc,CAACG,cAAc,CAACrsD,SAAf,EAAD,EAA6BkiB,QAA7B,CAA9E;AACD,GAFD;;AAGA,MAAIoqC,4BAA4B,GAAG,UAAUC,cAAV,EAA0BpM,aAA1B,EAAyC;AAC1E,QAAI,CAACA,aAAL,EAAoB;AAClB,aAAO,IAAP;AACD;;AACD,QAAIngD,SAAS,GAAGmgD,aAAa,CAACngD,SAAd,EAAhB;AACA,QAAIslB,MAAM,GAAG66B,aAAa,CAAC76B,MAAd,EAAb;;AACA,QAAI,CAAComC,WAAW,CAAC1rD,SAAD,CAAhB,EAA6B;AAC3B,aAAO,IAAP;AACD;;AACD,WAAOA,SAAS,CAACgD,UAAV,CAAqBsiB,MAAM,GAAGinC,cAA9B,CAAP;AACD,GAVD;;AAWA,MAAIC,WAAW,GAAG,UAAUljD,MAAV,EAAkBhG,IAAlB,EAAwB;AACxC,QAAI5D,KAAK,GAAG4D,IAAI,CAACqD,aAAL,CAAmB+qC,WAAnB,EAAZ;;AACA,QAAIpoC,MAAJ,EAAY;AACV5J,MAAAA,KAAK,CAAC+sD,cAAN,CAAqBnpD,IAArB;AACA5D,MAAAA,KAAK,CAACgtD,YAAN,CAAmBppD,IAAnB;AACD,KAHD,MAGO;AACL5D,MAAAA,KAAK,CAACitD,aAAN,CAAoBrpD,IAApB;AACA5D,MAAAA,KAAK,CAACkgD,WAAN,CAAkBt8C,IAAlB;AACD;;AACD,WAAO5D,KAAP;AACD,GAVD;;AAWA,MAAIktD,kBAAkB,GAAG,UAAU/rD,IAAV,EAAgBgsD,KAAhB,EAAuBC,KAAvB,EAA8B;AACrD,WAAOZ,cAAc,CAACW,KAAD,EAAQhsD,IAAR,CAAd,KAAgCqrD,cAAc,CAACY,KAAD,EAAQjsD,IAAR,CAArD;AACD,GAFD;;AAGA,MAAIksD,IAAI,GAAG,UAAUliD,IAAV,EAAgBhK,IAAhB,EAAsByC,IAAtB,EAA4B;AACrC,QAAIqG,OAAJ,EAAa+Y,WAAb;;AACA,QAAI7X,IAAJ,EAAU;AACR6X,MAAAA,WAAW,GAAG,iBAAd;AACD,KAFD,MAEO;AACLA,MAAAA,WAAW,GAAG,aAAd;AACD;;AACD,WAAOpf,IAAI,IAAIA,IAAI,KAAKzC,IAAxB,EAA8B;AAC5B8I,MAAAA,OAAO,GAAGrG,IAAI,CAACof,WAAD,CAAd;;AACA,UAAI8oC,kBAAkB,CAAC7hD,OAAD,CAAtB,EAAiC;AAC/BA,QAAAA,OAAO,GAAGA,OAAO,CAAC+Y,WAAD,CAAjB;AACD;;AACD,UAAI2oC,wBAAwB,CAAC1hD,OAAD,CAAxB,IAAqC2hD,SAAS,CAAC3hD,OAAD,CAAlD,EAA6D;AAC3D,YAAIijD,kBAAkB,CAAC/rD,IAAD,EAAO8I,OAAP,EAAgBrG,IAAhB,CAAtB,EAA6C;AAC3C,iBAAOqG,OAAP;AACD;;AACD;AACD;;AACD,UAAIgiD,kBAAkB,CAAChiD,OAAD,CAAtB,EAAiC;AAC/B;AACD;;AACDrG,MAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,WAAO,IAAP;AACD,GAxBD;;AAyBA,MAAIgmD,QAAQ,GAAG1+D,KAAK,CAACk+D,WAAD,EAAc,IAAd,CAApB;AACA,MAAIS,OAAO,GAAG3+D,KAAK,CAACk+D,WAAD,EAAc,KAAd,CAAnB;;AACA,MAAIU,cAAc,GAAG,UAAU/Q,SAAV,EAAqBt7C,IAArB,EAA2BnB,KAA3B,EAAkC;AACrD,QAAI4D,IAAJ,EAAUtD,SAAV,EAAqB+iC,QAArB;AACA,QAAIoqB,QAAQ,GAAG7+D,KAAK,CAACy+D,IAAD,EAAO,IAAP,EAAalsD,IAAb,CAApB;AACA,QAAIusD,SAAS,GAAG9+D,KAAK,CAACy+D,IAAD,EAAO,KAAP,EAAclsD,IAAd,CAArB;AACAb,IAAAA,SAAS,GAAGN,KAAK,CAAC4mB,cAAlB;AACA,QAAIhB,MAAM,GAAG5lB,KAAK,CAAC8yC,WAAnB;;AACA,QAAI7tB,qBAAqB,CAAC3kB,SAAD,CAAzB,EAAsC;AACpC,UAAI,CAAC0rD,WAAW,CAAC1rD,SAAD,CAAhB,EAA6B;AAC3BA,QAAAA,SAAS,GAAGA,SAAS,CAACgH,UAAtB;AACD;;AACD+7B,MAAAA,QAAQ,GAAG/iC,SAAS,CAACwO,YAAV,CAAuB,gBAAvB,CAAX;;AACA,UAAIu0B,QAAQ,KAAK,QAAjB,EAA2B;AACzBz/B,QAAAA,IAAI,GAAGtD,SAAS,CAAC4H,WAAjB;;AACA,YAAIwjD,iBAAiB,CAAC9nD,IAAD,CAArB,EAA6B;AAC3B,iBAAO0pD,QAAQ,CAAC1pD,IAAD,CAAf;AACD;AACF;;AACD,UAAIy/B,QAAQ,KAAK,OAAjB,EAA0B;AACxBz/B,QAAAA,IAAI,GAAGtD,SAAS,CAAC2H,eAAjB;;AACA,YAAIyjD,iBAAiB,CAAC9nD,IAAD,CAArB,EAA6B;AAC3B,iBAAO2pD,OAAO,CAAC3pD,IAAD,CAAd;AACD;AACF;AACF;;AACD,QAAI,CAAC5D,KAAK,CAACgkD,SAAX,EAAsB;AACpB,aAAOhkD,KAAP;AACD;;AACD,QAAIqP,QAAQ,CAAC/O,SAAD,CAAZ,EAAyB;AACvB,UAAIwrD,kBAAkB,CAACxrD,SAAD,CAAtB,EAAmC;AACjC,YAAIm8C,SAAS,KAAK,CAAlB,EAAqB;AACnB74C,UAAAA,IAAI,GAAG8pD,SAAS,CAACptD,SAAD,CAAhB;;AACA,cAAIsD,IAAJ,EAAU;AACR,mBAAO0pD,QAAQ,CAAC1pD,IAAD,CAAf;AACD;;AACDA,UAAAA,IAAI,GAAG6pD,QAAQ,CAACntD,SAAD,CAAf;;AACA,cAAIsD,IAAJ,EAAU;AACR,mBAAO2pD,OAAO,CAAC3pD,IAAD,CAAd;AACD;AACF;;AACD,YAAI64C,SAAS,KAAK,CAAC,CAAnB,EAAsB;AACpB74C,UAAAA,IAAI,GAAG6pD,QAAQ,CAACntD,SAAD,CAAf;;AACA,cAAIsD,IAAJ,EAAU;AACR,mBAAO2pD,OAAO,CAAC3pD,IAAD,CAAd;AACD;;AACDA,UAAAA,IAAI,GAAG8pD,SAAS,CAACptD,SAAD,CAAhB;;AACA,cAAIsD,IAAJ,EAAU;AACR,mBAAO0pD,QAAQ,CAAC1pD,IAAD,CAAf;AACD;AACF;;AACD,eAAO5D,KAAP;AACD;;AACD,UAAIylB,sBAAsB,CAACnlB,SAAD,CAAtB,IAAqCslB,MAAM,IAAItlB,SAAS,CAACkZ,IAAV,CAAexsB,MAAf,GAAwB,CAA3E,EAA8E;AAC5E,YAAIyvD,SAAS,KAAK,CAAlB,EAAqB;AACnB74C,UAAAA,IAAI,GAAG8pD,SAAS,CAACptD,SAAD,CAAhB;;AACA,cAAIsD,IAAJ,EAAU;AACR,mBAAO0pD,QAAQ,CAAC1pD,IAAD,CAAf;AACD;AACF;;AACD,eAAO5D,KAAP;AACD;;AACD,UAAIulB,wBAAwB,CAACjlB,SAAD,CAAxB,IAAuCslB,MAAM,IAAI,CAArD,EAAwD;AACtD,YAAI62B,SAAS,KAAK,CAAC,CAAnB,EAAsB;AACpB74C,UAAAA,IAAI,GAAG6pD,QAAQ,CAACntD,SAAD,CAAf;;AACA,cAAIsD,IAAJ,EAAU;AACR,mBAAO2pD,OAAO,CAAC3pD,IAAD,CAAd;AACD;AACF;;AACD,eAAO5D,KAAP;AACD;;AACD,UAAI4lB,MAAM,KAAKtlB,SAAS,CAACkZ,IAAV,CAAexsB,MAA9B,EAAsC;AACpC4W,QAAAA,IAAI,GAAG8pD,SAAS,CAACptD,SAAD,CAAhB;;AACA,YAAIsD,IAAJ,EAAU;AACR,iBAAO0pD,QAAQ,CAAC1pD,IAAD,CAAf;AACD;;AACD,eAAO5D,KAAP;AACD;;AACD,UAAI4lB,MAAM,KAAK,CAAf,EAAkB;AAChBhiB,QAAAA,IAAI,GAAG6pD,QAAQ,CAACntD,SAAD,CAAf;;AACA,YAAIsD,IAAJ,EAAU;AACR,iBAAO2pD,OAAO,CAAC3pD,IAAD,CAAd;AACD;;AACD,eAAO5D,KAAP;AACD;AACF;;AACD,WAAOA,KAAP;AACD,GArFD;;AAsFA,MAAI2tD,iBAAiB,GAAG,UAAUtrB,OAAV,EAAmBoe,aAAnB,EAAkC;AACxD,WAAO5uD,QAAQ,CAACD,IAAT,CAAcg7D,4BAA4B,CAACvqB,OAAO,GAAG,CAAH,GAAO,CAAC,CAAhB,EAAmBoe,aAAnB,CAA1C,EAA6EzvD,MAA7E,CAAoF26D,wBAApF,CAAP;AACD,GAFD;;AAGA,MAAIiC,0BAA0B,GAAG,UAAUnR,SAAV,EAAqBt7C,IAArB,EAA2BnB,KAA3B,EAAkC;AACjE,QAAI6tD,eAAe,GAAGL,cAAc,CAAC/Q,SAAD,EAAYt7C,IAAZ,EAAkBnB,KAAlB,CAApC;;AACA,QAAIy8C,SAAS,KAAK,CAAC,CAAnB,EAAsB;AACpB,aAAOoE,aAAa,CAACG,cAAd,CAA6B6M,eAA7B,CAAP;AACD;;AACD,WAAOhN,aAAa,CAACI,YAAd,CAA2B4M,eAA3B,CAAP;AACD,GAND;;AAOA,MAAIC,sBAAsB,GAAG,UAAUr7C,GAAV,EAAe;AAC1C,WAAO5gB,QAAQ,CAACD,IAAT,CAAc6gB,GAAG,CAAC6rC,OAAJ,EAAd,EAA6B3tD,GAA7B,CAAiCyT,YAAY,CAACX,OAA9C,CAAP;AACD,GAFD;;AAGA,MAAIsqD,0BAA0B,GAAG,UAAUt7C,GAAV,EAAe;AAC9C,WAAO5gB,QAAQ,CAACD,IAAT,CAAc6gB,GAAG,CAAC6rC,OAAJ,CAAY,IAAZ,CAAd,EAAiC3tD,GAAjC,CAAqCyT,YAAY,CAACX,OAAlD,CAAP;AACD,GAFD;;AAGA,MAAIuqD,sBAAsB,GAAG,UAAUC,MAAV,EAAkBxN,aAAlB,EAAiC;AAC5D,WAAOA,aAAa,GAAGwN,MAAM,CAACxN,aAAD,CAA7B,EAA8C;AAC5C,UAAIA,aAAa,CAACM,SAAd,EAAJ,EAA+B;AAC7B,eAAON,aAAP;AACD;AACF;;AACD,WAAOA,aAAP;AACD,GAPD;;AAQA,MAAIyN,qBAAqB,GAAG,UAAUt8D,IAAV,EAAgB4a,EAAhB,EAAoB;AAC9C,QAAI2hD,WAAW,GAAG1B,aAAa,CAAC76D,IAAD,EAAO4a,EAAP,CAA/B;;AACA,QAAI,CAAC2hD,WAAD,IAAgB1+C,IAAI,CAAC7d,IAAI,CAAC0sD,OAAL,EAAD,CAAxB,EAA0C;AACxC,aAAO,IAAP;AACD;;AACD,WAAO6P,WAAP;AACD,GAND;;AAQA,MAAIC,UAAJ;;AACC,aAAUA,UAAV,EAAsB;AACrBA,IAAAA,UAAU,CAACA,UAAU,CAAC,WAAD,CAAV,GAA0B,CAAC,CAA5B,CAAV,GAA2C,WAA3C;AACAA,IAAAA,UAAU,CAACA,UAAU,CAAC,UAAD,CAAV,GAAyB,CAA1B,CAAV,GAAyC,UAAzC;AACD,GAHA,EAGCA,UAAU,KAAKA,UAAU,GAAG,EAAlB,CAHX,CAAD;;AAIA,MAAIC,wBAAwB,GAAGz+C,sBAA/B;AACA,MAAI0+C,QAAQ,GAAGj/C,QAAf;AACA,MAAIk/C,WAAW,GAAGtgD,WAAlB;AACA,MAAIugD,MAAM,GAAG/+C,IAAb;AACA,MAAIg/C,kBAAkB,GAAGpnC,gBAAzB;AACA,MAAIqnC,UAAU,GAAGhnC,QAAjB;AACA,MAAIinC,0BAA0B,GAAGhnC,wBAAjC;;AACA,MAAIynB,UAAU,GAAG,UAAUxrC,IAAV,EAAgBzC,IAAhB,EAAsB;AACrC,QAAIoG,OAAO,GAAG,EAAd;;AACA,WAAO3D,IAAI,IAAIA,IAAI,KAAKzC,IAAxB,EAA8B;AAC5BoG,MAAAA,OAAO,CAACvU,IAAR,CAAa4Q,IAAb;AACAA,MAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,WAAOC,OAAP;AACD,GAPD;;AAQA,MAAIqnD,WAAW,GAAG,UAAUtuD,SAAV,EAAqBslB,MAArB,EAA6B;AAC7C,QAAItlB,SAAS,CAAC+C,aAAV,MAA6BuiB,MAAM,GAAGtlB,SAAS,CAACgD,UAAV,CAAqBtW,MAA/D,EAAuE;AACrE,aAAOsT,SAAS,CAACgD,UAAV,CAAqBsiB,MAArB,CAAP;AACD;;AACD,WAAO,IAAP;AACD,GALD;;AAMA,MAAIipC,yBAAyB,GAAG,UAAUpS,SAAV,EAAqB74C,IAArB,EAA2B;AACzD,QAAIsoD,UAAU,CAACzP,SAAD,CAAd,EAA2B;AACzB,UAAIgS,kBAAkB,CAAC7qD,IAAI,CAACqE,eAAN,CAAlB,IAA4C,CAACqmD,QAAQ,CAAC1qD,IAAI,CAACqE,eAAN,CAAzD,EAAiF;AAC/E,eAAO44C,aAAa,CAACj3C,MAAd,CAAqBhG,IAArB,CAAP;AACD;;AACD,UAAI0qD,QAAQ,CAAC1qD,IAAD,CAAZ,EAAoB;AAClB,eAAOi9C,aAAa,CAACj9C,IAAD,EAAO,CAAP,CAApB;AACD;AACF;;AACD,QAAIuoD,WAAW,CAAC1P,SAAD,CAAf,EAA4B;AAC1B,UAAIgS,kBAAkB,CAAC7qD,IAAI,CAACsE,WAAN,CAAlB,IAAwC,CAAComD,QAAQ,CAAC1qD,IAAI,CAACsE,WAAN,CAArD,EAAyE;AACvE,eAAO24C,aAAa,CAAC72C,KAAd,CAAoBpG,IAApB,CAAP;AACD;;AACD,UAAI0qD,QAAQ,CAAC1qD,IAAD,CAAZ,EAAoB;AAClB,eAAOi9C,aAAa,CAACj9C,IAAD,EAAOA,IAAI,CAAC4V,IAAL,CAAUxsB,MAAjB,CAApB;AACD;AACF;;AACD,QAAIm/D,WAAW,CAAC1P,SAAD,CAAf,EAA4B;AAC1B,UAAI+R,MAAM,CAAC5qD,IAAD,CAAV,EAAkB;AAChB,eAAOi9C,aAAa,CAACj3C,MAAd,CAAqBhG,IAArB,CAAP;AACD;;AACD,aAAOi9C,aAAa,CAAC72C,KAAd,CAAoBpG,IAApB,CAAP;AACD;;AACD,WAAOi9C,aAAa,CAACj3C,MAAd,CAAqBhG,IAArB,CAAP;AACD,GAxBD;;AAyBA,MAAIkrD,iBAAiB,GAAG,UAAU3tD,IAAV,EAAgB4tD,QAAhB,EAA0B;AAChD,QAAI7mD,WAAW,GAAG6mD,QAAQ,CAAC7mD,WAA3B;;AACA,QAAIA,WAAW,IAAIumD,kBAAkB,CAACvmD,WAAD,CAArC,EAAoD;AAClD,UAAIomD,QAAQ,CAACpmD,WAAD,CAAZ,EAA2B;AACzB,eAAO24C,aAAa,CAAC34C,WAAD,EAAc,CAAd,CAApB;AACD,OAFD,MAEO;AACL,eAAO24C,aAAa,CAACj3C,MAAd,CAAqB1B,WAArB,CAAP;AACD;AACF,KAND,MAMO;AACL,aAAO8mD,iBAAiB,CAACZ,UAAU,CAACa,QAAZ,EAAsBpO,aAAa,CAAC72C,KAAd,CAAoB+kD,QAApB,CAAtB,EAAqD5tD,IAArD,CAAxB;AACD;AACF,GAXD;;AAYA,MAAI6tD,iBAAiB,GAAG,UAAUvS,SAAV,EAAqByS,QAArB,EAA+B/tD,IAA/B,EAAqC;AAC3D,QAAIyC,IAAJ,EAAUmrD,QAAV,EAAoBI,SAApB;AACA,QAAI1O,aAAJ;;AACA,QAAI,CAAC8N,WAAW,CAACptD,IAAD,CAAZ,IAAsB,CAAC+tD,QAA3B,EAAqC;AACnC,aAAO,IAAP;AACD;;AACD,QAAIA,QAAQ,CAACvR,OAAT,CAAiBkD,aAAa,CAAC72C,KAAd,CAAoB7I,IAApB,CAAjB,KAA+CA,IAAI,CAACqH,SAAxD,EAAmE;AACjEi4C,MAAAA,aAAa,GAAGI,aAAa,CAAC72C,KAAd,CAAoB7I,IAAI,CAACqH,SAAzB,CAAhB;;AACA,UAAI2jD,WAAW,CAAC1P,SAAD,CAAX,IAA0BgS,kBAAkB,CAACttD,IAAI,CAACqH,SAAN,CAA5C,IAAgE+lD,WAAW,CAACptD,IAAI,CAACqH,SAAN,CAA/E,EAAiG;AAC/F,eAAOgmD,MAAM,CAACrtD,IAAI,CAACqH,SAAN,CAAN,GAAyBq4C,aAAa,CAACj3C,MAAd,CAAqBzI,IAAI,CAACqH,SAA1B,CAAzB,GAAgEi4C,aAAvE;AACD;AACF,KALD,MAKO;AACLA,MAAAA,aAAa,GAAGyO,QAAhB;AACD;;AACD,QAAI5uD,SAAS,GAAGmgD,aAAa,CAACngD,SAAd,EAAhB;AACA,QAAIslB,MAAM,GAAG66B,aAAa,CAAC76B,MAAd,EAAb;;AACA,QAAI0oC,QAAQ,CAAChuD,SAAD,CAAZ,EAAyB;AACvB,UAAI6rD,WAAW,CAAC1P,SAAD,CAAX,IAA0B72B,MAAM,GAAG,CAAvC,EAA0C;AACxC,eAAOi7B,aAAa,CAACvgD,SAAD,EAAY,EAAEslB,MAAd,CAApB;AACD;;AACD,UAAIsmC,UAAU,CAACzP,SAAD,CAAV,IAAyB72B,MAAM,GAAGtlB,SAAS,CAACtT,MAAhD,EAAwD;AACtD,eAAO6zD,aAAa,CAACvgD,SAAD,EAAY,EAAEslB,MAAd,CAApB;AACD;;AACDhiB,MAAAA,IAAI,GAAGtD,SAAP;AACD,KARD,MAQO;AACL,UAAI6rD,WAAW,CAAC1P,SAAD,CAAX,IAA0B72B,MAAM,GAAG,CAAvC,EAA0C;AACxCmpC,QAAAA,QAAQ,GAAGH,WAAW,CAACtuD,SAAD,EAAYslB,MAAM,GAAG,CAArB,CAAtB;;AACA,YAAI6oC,kBAAkB,CAACM,QAAD,CAAtB,EAAkC;AAChC,cAAI,CAACL,UAAU,CAACK,QAAD,CAAf,EAA2B;AACzBI,YAAAA,SAAS,GAAG9C,QAAQ,CAAC0C,QAAD,EAAWtS,SAAX,EAAsBkS,0BAAtB,EAAkDI,QAAlD,CAApB;;AACA,gBAAII,SAAJ,EAAe;AACb,kBAAIb,QAAQ,CAACa,SAAD,CAAZ,EAAyB;AACvB,uBAAOtO,aAAa,CAACsO,SAAD,EAAYA,SAAS,CAAC31C,IAAV,CAAexsB,MAA3B,CAApB;AACD;;AACD,qBAAO6zD,aAAa,CAAC72C,KAAd,CAAoBmlD,SAApB,CAAP;AACD;AACF;;AACD,cAAIb,QAAQ,CAACS,QAAD,CAAZ,EAAwB;AACtB,mBAAOlO,aAAa,CAACkO,QAAD,EAAWA,QAAQ,CAACv1C,IAAT,CAAcxsB,MAAzB,CAApB;AACD;;AACD,iBAAO6zD,aAAa,CAACj3C,MAAd,CAAqBmlD,QAArB,CAAP;AACD;AACF;;AACD,UAAI7C,UAAU,CAACzP,SAAD,CAAV,IAAyB72B,MAAM,GAAGtlB,SAAS,CAACgD,UAAV,CAAqBtW,MAA3D,EAAmE;AACjE+hE,QAAAA,QAAQ,GAAGH,WAAW,CAACtuD,SAAD,EAAYslB,MAAZ,CAAtB;;AACA,YAAI6oC,kBAAkB,CAACM,QAAD,CAAtB,EAAkC;AAChC,cAAIP,MAAM,CAACO,QAAD,CAAV,EAAsB;AACpB,mBAAOD,iBAAiB,CAAC3tD,IAAD,EAAO4tD,QAAP,CAAxB;AACD;;AACD,cAAI,CAACL,UAAU,CAACK,QAAD,CAAf,EAA2B;AACzBI,YAAAA,SAAS,GAAG9C,QAAQ,CAAC0C,QAAD,EAAWtS,SAAX,EAAsBkS,0BAAtB,EAAkDI,QAAlD,CAApB;;AACA,gBAAII,SAAJ,EAAe;AACb,kBAAIb,QAAQ,CAACa,SAAD,CAAZ,EAAyB;AACvB,uBAAOtO,aAAa,CAACsO,SAAD,EAAY,CAAZ,CAApB;AACD;;AACD,qBAAOtO,aAAa,CAACj3C,MAAd,CAAqBulD,SAArB,CAAP;AACD;AACF;;AACD,cAAIb,QAAQ,CAACS,QAAD,CAAZ,EAAwB;AACtB,mBAAOlO,aAAa,CAACkO,QAAD,EAAW,CAAX,CAApB;AACD;;AACD,iBAAOlO,aAAa,CAAC72C,KAAd,CAAoB+kD,QAApB,CAAP;AACD;AACF;;AACDnrD,MAAAA,IAAI,GAAGmrD,QAAQ,GAAGA,QAAH,GAActO,aAAa,CAACnC,OAAd,EAA7B;AACD;;AACD,QAAI4N,UAAU,CAACzP,SAAD,CAAV,IAAyBgE,aAAa,CAAC16B,OAAd,EAAzB,IAAoDomC,WAAW,CAAC1P,SAAD,CAAX,IAA0BgE,aAAa,CAAC56B,SAAd,EAAlF,EAA6G;AAC3GjiB,MAAAA,IAAI,GAAGyoD,QAAQ,CAACzoD,IAAD,EAAO64C,SAAP,EAAkBltD,MAAlB,EAA0B4R,IAA1B,EAAgC,IAAhC,CAAf;;AACA,UAAIwtD,0BAA0B,CAAC/qD,IAAD,EAAOzC,IAAP,CAA9B,EAA4C;AAC1C,eAAO0tD,yBAAyB,CAACpS,SAAD,EAAY74C,IAAZ,CAAhC;AACD;AACF;;AACDmrD,IAAAA,QAAQ,GAAG1C,QAAQ,CAACzoD,IAAD,EAAO64C,SAAP,EAAkBkS,0BAAlB,EAA8CxtD,IAA9C,CAAnB;AACA,QAAIiuD,2BAA2B,GAAG53D,MAAM,CAACxG,MAAM,CAACo+C,UAAU,CAAC9uC,SAAD,EAAYa,IAAZ,CAAX,EAA8BktD,wBAA9B,CAAP,CAAxC;;AACA,QAAIe,2BAA2B,KAAK,CAACL,QAAD,IAAa,CAACK,2BAA2B,CAACh8D,QAA5B,CAAqC27D,QAArC,CAAnB,CAA/B,EAAmG;AACjG,UAAI7C,UAAU,CAACzP,SAAD,CAAd,EAA2B;AACzBgE,QAAAA,aAAa,GAAGI,aAAa,CAAC72C,KAAd,CAAoBolD,2BAApB,CAAhB;AACD,OAFD,MAEO;AACL3O,QAAAA,aAAa,GAAGI,aAAa,CAACj3C,MAAd,CAAqBwlD,2BAArB,CAAhB;AACD;;AACD,aAAO3O,aAAP;AACD;;AACD,QAAIsO,QAAJ,EAAc;AACZ,aAAOF,yBAAyB,CAACpS,SAAD,EAAYsS,QAAZ,CAAhC;AACD;;AACD,WAAO,IAAP;AACD,GAtFD;;AAuFA,MAAIM,WAAW,GAAG,UAAUluD,IAAV,EAAgB;AAChC,WAAO;AACLshB,MAAAA,IAAI,EAAE,UAAUg+B,aAAV,EAAyB;AAC7B,eAAOuO,iBAAiB,CAACZ,UAAU,CAACa,QAAZ,EAAsBxO,aAAtB,EAAqCt/C,IAArC,CAAxB;AACD,OAHI;AAILuhB,MAAAA,IAAI,EAAE,UAAU+9B,aAAV,EAAyB;AAC7B,eAAOuO,iBAAiB,CAACZ,UAAU,CAACkB,SAAZ,EAAuB7O,aAAvB,EAAsCt/C,IAAtC,CAAxB;AACD;AANI,KAAP;AAQD,GATD;;AAWA,MAAIouD,gBAAgB,GAAG,UAAUltB,OAAV,EAAmBlhC,IAAnB,EAAyB1F,KAAzB,EAAgC;AACrD,QAAI+zD,QAAQ,GAAGntB,OAAO,GAAGwe,aAAa,CAACj3C,MAAd,CAAqBnO,KAArB,CAAH,GAAiColD,aAAa,CAAC72C,KAAd,CAAoBvO,KAApB,CAAvD;AACA,WAAOg0D,YAAY,CAACptB,OAAD,EAAUlhC,IAAV,EAAgBquD,QAAhB,CAAnB;AACD,GAHD;;AAIA,MAAIE,YAAY,GAAG,UAAU9rD,IAAV,EAAgB;AACjC,WAAO6L,IAAI,CAAC7L,IAAD,CAAJ,GAAai9C,aAAa,CAACj3C,MAAd,CAAqBhG,IAArB,CAAb,GAA0Ci9C,aAAa,CAAC72C,KAAd,CAAoBpG,IAApB,CAAjD;AACD,GAFD;;AAGA,MAAI+rD,eAAe,GAAG,UAAUH,QAAV,EAAoB;AACxC,QAAI3O,aAAa,CAACO,cAAd,CAA6BoO,QAA7B,CAAJ,EAA4C;AAC1C,aAAOA,QAAQ,CAAC5pC,MAAT,OAAsB,CAA7B;AACD,KAFD,MAEO;AACL,aAAOyB,gBAAgB,CAACmoC,QAAQ,CAAClR,OAAT,EAAD,CAAvB;AACD;AACF,GAND;;AAOA,MAAIsR,YAAY,GAAG,UAAUJ,QAAV,EAAoB;AACrC,QAAI3O,aAAa,CAACO,cAAd,CAA6BoO,QAA7B,CAAJ,EAA4C;AAC1C,UAAIlvD,SAAS,GAAGkvD,QAAQ,CAAClvD,SAAT,EAAhB;AACA,aAAOkvD,QAAQ,CAAC5pC,MAAT,OAAsBtlB,SAAS,CAACkZ,IAAV,CAAexsB,MAA5C;AACD,KAHD,MAGO;AACL,aAAOq6B,gBAAgB,CAACmoC,QAAQ,CAAClR,OAAT,CAAiB,IAAjB,CAAD,CAAvB;AACD;AACF,GAPD;;AAQA,MAAIuR,wBAAwB,GAAG,UAAUj+D,IAAV,EAAgB4a,EAAhB,EAAoB;AACjD,WAAO,CAACq0C,aAAa,CAACO,cAAd,CAA6BxvD,IAA7B,CAAD,IAAuC,CAACivD,aAAa,CAACO,cAAd,CAA6B50C,EAA7B,CAAxC,IAA4E5a,IAAI,CAAC0sD,OAAL,OAAmB9xC,EAAE,CAAC8xC,OAAH,CAAW,IAAX,CAAtG;AACD,GAFD;;AAGA,MAAIwR,MAAM,GAAG,UAAUN,QAAV,EAAoB;AAC/B,WAAO,CAAC3O,aAAa,CAACO,cAAd,CAA6BoO,QAA7B,CAAD,IAA2C//C,IAAI,CAAC+/C,QAAQ,CAAClR,OAAT,EAAD,CAAtD;AACD,GAFD;;AAGA,MAAIyR,kBAAkB,GAAG,UAAU1tB,OAAV,EAAmBzwC,IAAnB,EAAyB4a,EAAzB,EAA6B;AACpD,QAAI61B,OAAJ,EAAa;AACX,aAAO,CAACwtB,wBAAwB,CAACj+D,IAAD,EAAO4a,EAAP,CAAzB,IAAuC,CAACsjD,MAAM,CAACl+D,IAAD,CAA9C,IAAwDg+D,YAAY,CAACh+D,IAAD,CAApE,IAA8E+9D,eAAe,CAACnjD,EAAD,CAApG;AACD,KAFD,MAEO;AACL,aAAO,CAACqjD,wBAAwB,CAACrjD,EAAD,EAAK5a,IAAL,CAAzB,IAAuC+9D,eAAe,CAAC/9D,IAAD,CAAtD,IAAgEg+D,YAAY,CAACpjD,EAAD,CAAnF;AACD;AACF,GAND;;AAOA,MAAIijD,YAAY,GAAG,UAAUptB,OAAV,EAAmBlhC,IAAnB,EAAyBsR,GAAzB,EAA8B;AAC/C,QAAIiW,MAAM,GAAG2mC,WAAW,CAACluD,IAAD,CAAxB;AACA,WAAOtP,QAAQ,CAACD,IAAT,CAAcywC,OAAO,GAAG3Z,MAAM,CAACjG,IAAP,CAAYhQ,GAAZ,CAAH,GAAsBiW,MAAM,CAAChG,IAAP,CAAYjQ,GAAZ,CAA3C,CAAP;AACD,GAHD;;AAIA,MAAIu9C,QAAQ,GAAG,UAAU3tB,OAAV,EAAmBlhC,IAAnB,EAAyBvP,IAAzB,EAA+B;AAC5C,WAAO69D,YAAY,CAACptB,OAAD,EAAUlhC,IAAV,EAAgBvP,IAAhB,CAAZ,CAAkCf,IAAlC,CAAuC,UAAU2b,EAAV,EAAc;AAC1D,UAAIigD,aAAa,CAAC76D,IAAD,EAAO4a,EAAP,EAAWrL,IAAX,CAAb,IAAiC4uD,kBAAkB,CAAC1tB,OAAD,EAAUzwC,IAAV,EAAgB4a,EAAhB,CAAvD,EAA4E;AAC1E,eAAOijD,YAAY,CAACptB,OAAD,EAAUlhC,IAAV,EAAgBqL,EAAhB,CAAnB;AACD,OAFD,MAEO;AACL,eAAO3a,QAAQ,CAACR,IAAT,CAAcmb,EAAd,CAAP;AACD;AACF,KANM,CAAP;AAOD,GARD;;AASA,MAAIyjD,cAAc,GAAG,UAAU5tB,OAAV,EAAmBlhC,IAAnB,EAAyBvP,IAAzB,EAA+Bs+D,YAA/B,EAA6C;AAChE,WAAOF,QAAQ,CAAC3tB,OAAD,EAAUlhC,IAAV,EAAgBvP,IAAhB,CAAR,CAA8Bf,IAA9B,CAAmC,UAAU4hB,GAAV,EAAe;AACvD,aAAOy9C,YAAY,CAACz9C,GAAD,CAAZ,GAAoBw9C,cAAc,CAAC5tB,OAAD,EAAUlhC,IAAV,EAAgBsR,GAAhB,EAAqBy9C,YAArB,CAAlC,GAAuEr+D,QAAQ,CAACR,IAAT,CAAcohB,GAAd,CAA9E;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAI09C,UAAU,GAAG,UAAU9tB,OAAV,EAAmBn9B,OAAnB,EAA4B;AAC3C,QAAIqd,SAAS,GAAG8f,OAAO,GAAGn9B,OAAO,CAACqD,UAAX,GAAwBrD,OAAO,CAACsD,SAAvD;;AACA,QAAI6G,QAAQ,CAACkT,SAAD,CAAZ,EAAyB;AACvB,aAAO1wB,QAAQ,CAACR,IAAT,CAAcwvD,aAAa,CAACt+B,SAAD,EAAY8f,OAAO,GAAG,CAAH,GAAO9f,SAAS,CAAC/I,IAAV,CAAexsB,MAAzC,CAA3B,CAAP;AACD,KAFD,MAEO,IAAIu1B,SAAJ,EAAe;AACpB,UAAI8E,gBAAgB,CAAC9E,SAAD,CAApB,EAAiC;AAC/B,eAAO1wB,QAAQ,CAACR,IAAT,CAAcgxC,OAAO,GAAGwe,aAAa,CAACj3C,MAAd,CAAqB2Y,SAArB,CAAH,GAAqCmtC,YAAY,CAACntC,SAAD,CAAtE,CAAP;AACD,OAFD,MAEO;AACL,eAAOgtC,gBAAgB,CAACltB,OAAD,EAAUn9B,OAAV,EAAmBqd,SAAnB,CAAvB;AACD;AACF,KANM,MAMA;AACL,aAAO1wB,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF,GAbD;;AAcA,MAAI4gE,YAAY,GAAGxhE,KAAK,CAAC6gE,YAAD,EAAe,IAAf,CAAxB;AACA,MAAIY,YAAY,GAAGzhE,KAAK,CAAC6gE,YAAD,EAAe,KAAf,CAAxB;AACA,MAAIa,eAAe,GAAG1hE,KAAK,CAACuhE,UAAD,EAAa,IAAb,CAA3B;AACA,MAAII,cAAc,GAAG3hE,KAAK,CAACuhE,UAAD,EAAa,KAAb,CAA1B;AAEA,MAAIK,QAAQ,GAAG,YAAf;;AACA,MAAIC,WAAW,GAAG,UAAU7sD,IAAV,EAAgB;AAChC,WAAOqK,WAAW,CAACrK,IAAD,CAAX,IAAqBA,IAAI,CAAC/T,EAAL,KAAY2gE,QAAxC;AACD,GAFD;;AAGA,MAAIE,uBAAuB,GAAG,UAAUxlD,IAAV,EAAgBtH,IAAhB,EAAsB;AAClD,WAAOA,IAAI,IAAIA,IAAI,KAAKsH,IAAxB,EAA8B;AAC5B,UAAItH,IAAI,CAAC/T,EAAL,KAAY2gE,QAAhB,EAA0B;AACxB,eAAO5sD,IAAP;AACD;;AACDA,MAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,WAAO,IAAP;AACD,GARD;;AAUA,MAAIqpD,oBAAoB,GAAG,UAAUxN,QAAV,EAAoB;AAC7C,WAAOhxD,QAAQ,CAACgxD,QAAQ,CAAC1nD,KAAV,CAAf;AACD,GAFD;;AAGA,MAAIm1D,eAAe,GAAG,UAAUzN,QAAV,EAAoB;AACxC,WAAOA,QAAQ,CAACnuD,cAAT,CAAwB,KAAxB,CAAP;AACD,GAFD;;AAGA,MAAI67D,YAAY,GAAG,UAAU1N,QAAV,EAAoB;AACrC,WAAOA,QAAQ,CAACnuD,cAAT,CAAwB,IAAxB,CAAP;AACD,GAFD;;AAGA,MAAI87D,eAAe,GAAG,UAAU3N,QAAV,EAAoB;AACxC,WAAOA,QAAQ,CAACnuD,cAAT,CAAwB,MAAxB,CAAP;AACD,GAFD;;AAGA,MAAI+7D,cAAc,GAAG,UAAU5N,QAAV,EAAoB;AACvC,WAAOzgD,KAAK,CAACrQ,OAAN,CAAc8wD,QAAQ,CAAC1nD,KAAvB,CAAP;AACD,GAFD;;AAIA,MAAIu1D,QAAQ,GAAG,UAAUhtD,GAAV,EAAeJ,IAAf,EAAqB;AAClC,QAAIqK,WAAW,CAACrK,IAAD,CAAX,IAAqBI,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAZ,CAArB,IAA0C,CAACA,IAAI,CAACR,SAAhD,IAA6D,CAAC3D,GAAG,CAAChD,EAAtE,EAA0E;AACxEmH,MAAAA,IAAI,CAACR,SAAL,GAAiB,2BAAjB;AACD;;AACD,WAAOQ,IAAP;AACD,GALD;;AAMA,MAAIqtD,4BAA4B,GAAG,UAAUjtD,GAAV,EAAem/C,QAAf,EAAyB;AAC1D,QAAI1wC,GAAJ;AACA,QAAIwmC,GAAG,GAAGj1C,GAAG,CAAC+tC,SAAJ,EAAV;AACAt/B,IAAAA,GAAG,GAAGkwC,SAAS,CAAC3+C,GAAG,CAACypC,OAAJ,EAAD,EAAgB0V,QAAQ,CAAC1nD,KAAzB,CAAf;AACAw9C,IAAAA,GAAG,CAAC5G,QAAJ,CAAa5/B,GAAG,CAACnS,SAAJ,EAAb,EAA8BmS,GAAG,CAACmT,MAAJ,EAA9B;AACAnT,IAAAA,GAAG,GAAGkwC,SAAS,CAAC3+C,GAAG,CAACypC,OAAJ,EAAD,EAAgB0V,QAAQ,CAACE,GAAzB,CAAf;AACApK,IAAAA,GAAG,CAAC3G,MAAJ,CAAW7/B,GAAG,CAACnS,SAAJ,EAAX,EAA4BmS,GAAG,CAACmT,MAAJ,EAA5B;AACA,WAAOqzB,GAAP;AACD,GARD;;AASA,MAAIiY,UAAU,GAAG,UAAUttD,IAAV,EAAgBq1C,GAAhB,EAAqB;AACpC,QAAI3zB,QAAQ,GAAG1hB,IAAI,CAACqD,aAAL,CAAmBlD,cAAnB,CAAkC6gB,IAAlC,CAAf;AACAhhB,IAAAA,IAAI,CAACyG,WAAL,CAAiBib,QAAjB;AACA2zB,IAAAA,GAAG,CAAC5G,QAAJ,CAAa/sB,QAAb,EAAuB,CAAvB;AACA2zB,IAAAA,GAAG,CAAC3G,MAAJ,CAAWhtB,QAAX,EAAqB,CAArB;AACD,GALD;;AAMA,MAAI6rC,SAAS,GAAG,UAAUvtD,IAAV,EAAgB;AAC9B,WAAOA,IAAI,CAACP,aAAL,OAAyB,KAAhC;AACD,GAFD;;AAGA,MAAI+tD,oBAAoB,GAAG,UAAUxtD,IAAV,EAAgBq1C,GAAhB,EAAqB;AAC9C,WAAOsX,cAAc,CAAC3sD,IAAD,CAAd,CAAqB5T,IAArB,CAA0BV,KAA1B,EAAiC,UAAUmjB,GAAV,EAAe;AACrDwmC,MAAAA,GAAG,CAAC5G,QAAJ,CAAa5/B,GAAG,CAACnS,SAAJ,EAAb,EAA8BmS,GAAG,CAACmT,MAAJ,EAA9B;AACAqzB,MAAAA,GAAG,CAAC3G,MAAJ,CAAW7/B,GAAG,CAACnS,SAAJ,EAAX,EAA4BmS,GAAG,CAACmT,MAAJ,EAA5B;AACA,aAAO,IAAP;AACD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAIyrC,sBAAsB,GAAG,UAAUlwD,IAAV,EAAgByC,IAAhB,EAAsBq1C,GAAtB,EAA2B;AACtD,QAAIkY,SAAS,CAACvtD,IAAD,CAAT,IAAmB8sD,uBAAuB,CAACvvD,IAAD,EAAOyC,IAAP,CAA9C,EAA4D;AAC1DstD,MAAAA,UAAU,CAACttD,IAAD,EAAOq1C,GAAP,CAAV;AACA,aAAO,IAAP;AACD,KAHD,MAGO;AACL,aAAO,KAAP;AACD;AACF,GAPD;;AAQA,MAAIqY,WAAW,GAAG,UAAUttD,GAAV,EAAevI,KAAf,EAAsB0nD,QAAtB,EAAgClK,GAAhC,EAAqC;AACrD,QAAIgK,KAAK,GAAGE,QAAQ,CAAC1nD,KAAK,GAAG,OAAH,GAAa,KAAnB,CAApB;AACA,QAAIvO,CAAJ,EAAO0W,IAAP,EAAagiB,MAAb,EAAqB7d,QAArB;AACA,QAAI5G,IAAI,GAAG6C,GAAG,CAACypC,OAAJ,EAAX;;AACA,QAAIwV,KAAJ,EAAW;AACTr9B,MAAAA,MAAM,GAAGq9B,KAAK,CAAC,CAAD,CAAd;;AACA,WAAKr/C,IAAI,GAAGzC,IAAP,EAAajU,CAAC,GAAG+1D,KAAK,CAACj2D,MAAN,GAAe,CAArC,EAAwCE,CAAC,IAAI,CAA7C,EAAgDA,CAAC,EAAjD,EAAqD;AACnD6a,QAAAA,QAAQ,GAAGnE,IAAI,CAACN,UAAhB;;AACA,YAAI+tD,sBAAsB,CAAClwD,IAAD,EAAOyC,IAAP,EAAaq1C,GAAb,CAA1B,EAA6C;AAC3C,iBAAO,IAAP;AACD;;AACD,YAAIgK,KAAK,CAAC/1D,CAAD,CAAL,GAAW6a,QAAQ,CAAC/a,MAAT,GAAkB,CAAjC,EAAoC;AAClC,cAAIqkE,sBAAsB,CAAClwD,IAAD,EAAOyC,IAAP,EAAaq1C,GAAb,CAA1B,EAA6C;AAC3C,mBAAO,IAAP;AACD;;AACD,iBAAOmY,oBAAoB,CAACxtD,IAAD,EAAOq1C,GAAP,CAA3B;AACD;;AACDr1C,QAAAA,IAAI,GAAGmE,QAAQ,CAACk7C,KAAK,CAAC/1D,CAAD,CAAN,CAAf;AACD;;AACD,UAAI0W,IAAI,CAACwB,QAAL,KAAkB,CAAtB,EAAyB;AACvBwgB,QAAAA,MAAM,GAAGlY,IAAI,CAACswC,GAAL,CAASiF,KAAK,CAAC,CAAD,CAAd,EAAmBr/C,IAAI,CAAC49B,SAAL,CAAex0C,MAAlC,CAAT;AACD;;AACD,UAAI4W,IAAI,CAACwB,QAAL,KAAkB,CAAtB,EAAyB;AACvBwgB,QAAAA,MAAM,GAAGlY,IAAI,CAACswC,GAAL,CAASiF,KAAK,CAAC,CAAD,CAAd,EAAmBr/C,IAAI,CAACN,UAAL,CAAgBtW,MAAnC,CAAT;AACD;;AACD,UAAIyO,KAAJ,EAAW;AACTw9C,QAAAA,GAAG,CAAC5G,QAAJ,CAAazuC,IAAb,EAAmBgiB,MAAnB;AACD,OAFD,MAEO;AACLqzB,QAAAA,GAAG,CAAC3G,MAAJ,CAAW1uC,IAAX,EAAiBgiB,MAAjB;AACD;AACF;;AACD,WAAO,IAAP;AACD,GAhCD;;AAiCA,MAAI2rC,eAAe,GAAG,UAAU3tD,IAAV,EAAgB;AACpC,WAAOyL,QAAQ,CAACzL,IAAD,CAAR,IAAkBA,IAAI,CAAC4V,IAAL,CAAUxsB,MAAV,GAAmB,CAA5C;AACD,GAFD;;AAGA,MAAIwkE,eAAe,GAAG,UAAUxtD,GAAV,EAAe4wB,MAAf,EAAuBuuB,QAAvB,EAAiC;AACrD,QAAIt5C,MAAM,GAAG7F,GAAG,CAACrP,GAAJ,CAAQwuD,QAAQ,CAACtzD,EAAT,GAAc,GAAd,GAAoB+kC,MAA5B,CAAb;AAAA,QAAkDhxB,IAAlD;AAAA,QAAwDi/B,GAAxD;AAAA,QAA6DpgB,IAA7D;AAAA,QAAmEC,IAAnE;AACA,QAAI2hC,IAAI,GAAGlB,QAAQ,CAACkB,IAApB;AACA,QAAI/jD,SAAJ,EAAeslB,MAAf;;AACA,QAAI/b,MAAJ,EAAY;AACVjG,MAAAA,IAAI,GAAGiG,MAAM,CAACvC,UAAd;;AACA,UAAIstB,MAAM,KAAK,OAAf,EAAwB;AACtB,YAAI,CAACyvB,IAAL,EAAW;AACTxhB,UAAAA,GAAG,GAAG7+B,GAAG,CAACy+B,SAAJ,CAAc54B,MAAd,CAAN;AACD,SAFD,MAEO;AACL,cAAIA,MAAM,CAACxG,aAAP,EAAJ,EAA4B;AAC1BO,YAAAA,IAAI,GAAGiG,MAAM,CAACtB,UAAd;AACAs6B,YAAAA,GAAG,GAAG,CAAN;AACD,WAHD,MAGO,IAAI0uB,eAAe,CAAC1nD,MAAM,CAAC3B,WAAR,CAAnB,EAAyC;AAC9CtE,YAAAA,IAAI,GAAGiG,MAAM,CAAC3B,WAAd;AACA26B,YAAAA,GAAG,GAAG,CAAN;AACD,WAHM,MAGA,IAAI0uB,eAAe,CAAC1nD,MAAM,CAAC5B,eAAR,CAAnB,EAA6C;AAClDrE,YAAAA,IAAI,GAAGiG,MAAM,CAAC5B,eAAd;AACA46B,YAAAA,GAAG,GAAGh5B,MAAM,CAAC5B,eAAP,CAAuBuR,IAAvB,CAA4BxsB,MAAlC;AACD,WAHM,MAGA;AACL4W,YAAAA,IAAI,GAAGiG,MAAM,CAACvC,UAAd;AACAu7B,YAAAA,GAAG,GAAG7+B,GAAG,CAACy+B,SAAJ,CAAc54B,MAAd,IAAwB,CAA9B;AACD;AACF;;AACDvJ,QAAAA,SAAS,GAAGsD,IAAZ;AACAgiB,QAAAA,MAAM,GAAGid,GAAT;AACD,OApBD,MAoBO;AACL,YAAI,CAACwhB,IAAL,EAAW;AACTxhB,UAAAA,GAAG,GAAG7+B,GAAG,CAACy+B,SAAJ,CAAc54B,MAAd,CAAN;AACD,SAFD,MAEO;AACL,cAAIA,MAAM,CAACxG,aAAP,EAAJ,EAA4B;AAC1BO,YAAAA,IAAI,GAAGiG,MAAM,CAACtB,UAAd;AACAs6B,YAAAA,GAAG,GAAG,CAAN;AACD,WAHD,MAGO,IAAI0uB,eAAe,CAAC1nD,MAAM,CAAC5B,eAAR,CAAnB,EAA6C;AAClDrE,YAAAA,IAAI,GAAGiG,MAAM,CAAC5B,eAAd;AACA46B,YAAAA,GAAG,GAAGh5B,MAAM,CAAC5B,eAAP,CAAuBuR,IAAvB,CAA4BxsB,MAAlC;AACD,WAHM,MAGA;AACL4W,YAAAA,IAAI,GAAGiG,MAAM,CAACvC,UAAd;AACAu7B,YAAAA,GAAG,GAAG7+B,GAAG,CAACy+B,SAAJ,CAAc54B,MAAd,CAAN;AACD;AACF;;AACDvJ,QAAAA,SAAS,GAAGsD,IAAZ;AACAgiB,QAAAA,MAAM,GAAGid,GAAT;AACD;;AACD,UAAI,CAACwhB,IAAL,EAAW;AACT3hC,QAAAA,IAAI,GAAG7Y,MAAM,CAAC5B,eAAd;AACAwa,QAAAA,IAAI,GAAG5Y,MAAM,CAAC3B,WAAd;AACAxF,QAAAA,KAAK,CAAC9R,IAAN,CAAW8R,KAAK,CAACC,IAAN,CAAWkH,MAAM,CAACvG,UAAlB,CAAX,EAA0C,UAAUM,IAAV,EAAgB;AACxD,cAAIyL,QAAQ,CAACzL,IAAD,CAAZ,EAAoB;AAClBA,YAAAA,IAAI,CAAC49B,SAAL,GAAiB59B,IAAI,CAAC49B,SAAL,CAAexnC,OAAf,CAAuB,SAAvB,EAAkC,EAAlC,CAAjB;AACD;AACF,SAJD;;AAKA,eAAO6P,MAAM,GAAG7F,GAAG,CAACrP,GAAJ,CAAQwuD,QAAQ,CAACtzD,EAAT,GAAc,GAAd,GAAoB+kC,MAA5B,CAAhB,EAAqD;AACnD5wB,UAAAA,GAAG,CAAC6G,MAAJ,CAAWhB,MAAX,EAAmB,IAAnB;AACD;;AACD,YAAI6Y,IAAI,IAAID,IAAR,IAAgBC,IAAI,CAACtd,QAAL,KAAkBqd,IAAI,CAACrd,QAAvC,IAAmDiK,QAAQ,CAACqT,IAAD,CAA3D,IAAqE,CAACjjB,GAAG,CAAC/C,KAA9E,EAAqF;AACnFmmC,UAAAA,GAAG,GAAGngB,IAAI,CAAC8e,SAAL,CAAex0C,MAArB;AACA01B,UAAAA,IAAI,CAAC+uC,UAAL,CAAgBhvC,IAAI,CAAC+e,SAArB;AACAx9B,UAAAA,GAAG,CAAC6G,MAAJ,CAAW4X,IAAX;AACAniB,UAAAA,SAAS,GAAGoiB,IAAZ;AACAkD,UAAAA,MAAM,GAAGid,GAAT;AACD;AACF;;AACD,aAAOhxC,QAAQ,CAACR,IAAT,CAAcwvD,aAAa,CAACvgD,SAAD,EAAYslB,MAAZ,CAA3B,CAAP;AACD,KA5DD,MA4DO;AACL,aAAO/zB,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF,GAnED;;AAoEA,MAAIkiE,YAAY,GAAG,UAAU1tD,GAAV,EAAem/C,QAAf,EAAyB;AAC1C,QAAIlK,GAAG,GAAGj1C,GAAG,CAAC+tC,SAAJ,EAAV;;AACA,QAAIuf,WAAW,CAACttD,GAAD,EAAM,IAAN,EAAYm/C,QAAZ,EAAsBlK,GAAtB,CAAX,IAAyCqY,WAAW,CAACttD,GAAD,EAAM,KAAN,EAAam/C,QAAb,EAAuBlK,GAAvB,CAAxD,EAAqF;AACnF,aAAOpnD,QAAQ,CAACR,IAAT,CAAc4nD,GAAd,CAAP;AACD,KAFD,MAEO;AACL,aAAOpnD,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF,GAPD;;AAQA,MAAImiE,SAAS,GAAG,UAAU3tD,GAAV,EAAem/C,QAAf,EAAyB;AACvC,QAAI+L,QAAQ,GAAGsC,eAAe,CAACxtD,GAAD,EAAM,OAAN,EAAem/C,QAAf,CAA9B;AACA,QAAIyO,MAAM,GAAGJ,eAAe,CAACxtD,GAAD,EAAM,KAAN,EAAam/C,QAAb,CAA5B;AACA,WAAOnG,KAAK,CAACkS,QAAD,EAAW0C,MAAM,CAACnhE,EAAP,CAAUy+D,QAAV,CAAX,EAAgC,UAAU2C,IAAV,EAAgBC,IAAhB,EAAsB;AAChE,UAAI7Y,GAAG,GAAGj1C,GAAG,CAAC+tC,SAAJ,EAAV;AACAkH,MAAAA,GAAG,CAAC5G,QAAJ,CAAa2e,QAAQ,CAAChtD,GAAD,EAAM6tD,IAAI,CAACvxD,SAAL,EAAN,CAArB,EAA8CuxD,IAAI,CAACjsC,MAAL,EAA9C;AACAqzB,MAAAA,GAAG,CAAC3G,MAAJ,CAAW0e,QAAQ,CAAChtD,GAAD,EAAM8tD,IAAI,CAACxxD,SAAL,EAAN,CAAnB,EAA4CwxD,IAAI,CAAClsC,MAAL,EAA5C;AACA,aAAOqzB,GAAP;AACD,KALW,CAAZ;AAMD,GATD;;AAUA,MAAI8Y,cAAc,GAAG,UAAU/tD,GAAV,EAAem/C,QAAf,EAAyB;AAC5C,WAAOtxD,QAAQ,CAACD,IAAT,CAAcoS,GAAG,CAAC+2B,MAAJ,CAAWooB,QAAQ,CAACr3D,IAApB,EAA0Bq3D,QAAQ,CAACrsD,KAAnC,CAAd,EAAyDnG,GAAzD,CAA6D,UAAUohB,GAAV,EAAe;AACjF,UAAIknC,GAAG,GAAGj1C,GAAG,CAAC+tC,SAAJ,EAAV;AACAkH,MAAAA,GAAG,CAAC+Y,UAAJ,CAAejgD,GAAf;AACA,aAAOknC,GAAP;AACD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAIgZ,SAAS,GAAG,UAAU/Y,SAAV,EAAqBiK,QAArB,EAA+B;AAC7C,QAAIn/C,GAAG,GAAGk1C,SAAS,CAACl1C,GAApB;;AACA,QAAIm/C,QAAJ,EAAc;AACZ,UAAI4N,cAAc,CAAC5N,QAAD,CAAlB,EAA8B;AAC5B,eAAOuO,YAAY,CAAC1tD,GAAD,EAAMm/C,QAAN,CAAnB;AACD,OAFD,MAEO,IAAIwN,oBAAoB,CAACxN,QAAD,CAAxB,EAAoC;AACzC,eAAOtxD,QAAQ,CAACR,IAAT,CAAc4/D,4BAA4B,CAACjtD,GAAD,EAAMm/C,QAAN,CAA1C,CAAP;AACD,OAFM,MAEA,IAAI0N,YAAY,CAAC1N,QAAD,CAAhB,EAA4B;AACjC,eAAOwO,SAAS,CAAC3tD,GAAD,EAAMm/C,QAAN,CAAhB;AACD,OAFM,MAEA,IAAI2N,eAAe,CAAC3N,QAAD,CAAnB,EAA+B;AACpC,eAAO4O,cAAc,CAAC/tD,GAAD,EAAMm/C,QAAN,CAArB;AACD,OAFM,MAEA,IAAIyN,eAAe,CAACzN,QAAD,CAAnB,EAA+B;AACpC,eAAOtxD,QAAQ,CAACR,IAAT,CAAc8xD,QAAQ,CAAClK,GAAvB,CAAP;AACD;AACF;;AACD,WAAOpnD,QAAQ,CAACrC,IAAT,EAAP;AACD,GAhBD;;AAkBA,MAAI0iE,aAAa,GAAG,UAAUhZ,SAAV,EAAqBlnD,IAArB,EAA2B66C,UAA3B,EAAuC;AACzD,WAAOyX,WAAW,CAACpL,SAAD,EAAYlnD,IAAZ,EAAkB66C,UAAlB,CAAlB;AACD,GAFD;;AAGA,MAAIuX,cAAc,GAAG,UAAUlL,SAAV,EAAqBiK,QAArB,EAA+B;AAClD8O,IAAAA,SAAS,CAAC/Y,SAAD,EAAYiK,QAAZ,CAAT,CAA+BvyD,IAA/B,CAAoC,UAAUqoD,GAAV,EAAe;AACjDC,MAAAA,SAAS,CAACiZ,MAAV,CAAiBlZ,GAAjB;AACD,KAFD;AAGD,GAJD;;AAKA,MAAImZ,gBAAgB,GAAG,UAAUxuD,IAAV,EAAgB;AACrC,WAAOqK,WAAW,CAACrK,IAAD,CAAX,IAAqBA,IAAI,CAACsL,OAAL,KAAiB,MAAtC,IAAgDtL,IAAI,CAACkL,YAAL,CAAkB,eAAlB,MAAuC,UAA9F;AACD,GAFD;;AAIA,MAAIujD,IAAI,GAAG,UAAUC,QAAV,EAAoB;AAC7B,WAAO,UAAUC,MAAV,EAAkB;AACvB,aAAOD,QAAQ,KAAKC,MAApB;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIC,MAAM,GAAGH,IAAI,CAAC7tC,IAAD,CAAjB;;AACA,MAAIiuC,cAAc,GAAG,UAAUtoC,GAAV,EAAe;AAClC,WAAOA,GAAG,KAAK,EAAR,IAAc,gBAAgBl+B,OAAhB,CAAwBk+B,GAAxB,MAAiC,CAAC,CAAvD;AACD,GAFD;;AAGA,MAAIuoC,WAAW,GAAG,UAAUvoC,GAAV,EAAe;AAC/B,WAAO,CAACsoC,cAAc,CAACtoC,GAAD,CAAf,IAAwB,CAACqoC,MAAM,CAACroC,GAAD,CAAtC;AACD,GAFD;;AAIA,MAAIwoC,MAAM,GAAG,UAAU/uD,IAAV,EAAgB;AAC3B,WAAO,CAAC,CAACA,IAAI,CAACwB,QAAd;AACD,GAFD;;AAGA,MAAIwtD,aAAa,GAAG,UAAUhvD,IAAV,EAAgB;AAClC,WAAOA,IAAI,IAAI,UAAU/K,IAAV,CAAe+K,IAAI,CAAC6C,QAApB,CAAf;AACD,GAFD;;AAGA,MAAIosD,SAAS,GAAG,UAAU7uD,GAAV,EAAek1C,SAAf,EAA0BD,GAA1B,EAA+B;AAC7C,QAAIrzB,MAAM,GAAGqzB,GAAG,CAACnG,WAAjB;AACA,QAAIxyC,SAAS,GAAG24C,GAAG,CAACryB,cAApB;AAAA,QAAoC8B,MAApC;AAAA,QAA4C9kB,IAA5C;AAAA,QAAkDiO,KAAlD;;AACA,QAAIonC,GAAG,CAACryB,cAAJ,KAAuBqyB,GAAG,CAAClG,YAA/B,EAA6C;AAC3C,UAAI6f,aAAa,CAAC3Z,GAAG,CAACryB,cAAJ,CAAmBtjB,UAAnB,CAA8B21C,GAAG,CAACnG,WAAlC,CAAD,CAAjB,EAAmE;AACjE;AACD;AACF;;AACD,QAAIxyC,SAAS,CAAC8E,QAAV,KAAuB,CAA3B,EAA8B;AAC5ByM,MAAAA,KAAK,GAAGvR,SAAS,CAACgD,UAAlB;;AACA,UAAIsiB,MAAM,GAAG/T,KAAK,CAAC7kB,MAAnB,EAA2B;AACzBsT,QAAAA,SAAS,GAAGuR,KAAK,CAAC+T,MAAD,CAAjB;AACA8C,QAAAA,MAAM,GAAG,IAAIpG,aAAJ,CAAkBhiB,SAAlB,EAA6B0D,GAAG,CAACurC,SAAJ,CAAcjvC,SAAd,EAAyB0D,GAAG,CAAC4f,OAA7B,CAA7B,CAAT;AACD,OAHD,MAGO;AACLtjB,QAAAA,SAAS,GAAGuR,KAAK,CAACA,KAAK,CAAC7kB,MAAN,GAAe,CAAhB,CAAjB;AACA07B,QAAAA,MAAM,GAAG,IAAIpG,aAAJ,CAAkBhiB,SAAlB,EAA6B0D,GAAG,CAACurC,SAAJ,CAAcjvC,SAAd,EAAyB0D,GAAG,CAAC4f,OAA7B,CAA7B,CAAT;AACA8E,QAAAA,MAAM,CAACjG,IAAP,CAAY,IAAZ;AACD;;AACD,WAAK7e,IAAI,GAAG8kB,MAAM,CAAC3tB,OAAP,EAAZ,EAA8B6I,IAA9B,EAAoCA,IAAI,GAAG8kB,MAAM,CAACjG,IAAP,EAA3C,EAA0D;AACxD,YAAI7e,IAAI,CAACwB,QAAL,KAAkB,CAAlB,IAAuB,CAAC0tD,gBAAgB,CAAClvD,IAAD,CAA5C,EAAoD;AAClDq1C,UAAAA,GAAG,CAAC5G,QAAJ,CAAazuC,IAAb,EAAmB,CAAnB;AACAs1C,UAAAA,SAAS,CAACiZ,MAAV,CAAiBlZ,GAAjB;AACA;AACD;AACF;AACF;AACF,GA1BD;;AA2BA,MAAI8Z,uBAAuB,GAAG,UAAUnvD,IAAV,EAAgB6e,IAAhB,EAAsBuwC,GAAtB,EAA2B;AACvD,QAAIpvD,IAAJ,EAAU;AACR,UAAIqvD,QAAQ,GAAGxwC,IAAI,GAAG,aAAH,GAAmB,iBAAtC;;AACA,WAAK7e,IAAI,GAAGovD,GAAG,GAAGpvD,IAAH,GAAUA,IAAI,CAACqvD,QAAD,CAA7B,EAAyCrvD,IAAzC,EAA+CA,IAAI,GAAGA,IAAI,CAACqvD,QAAD,CAA1D,EAAsE;AACpE,YAAIrvD,IAAI,CAACwB,QAAL,KAAkB,CAAlB,IAAuB,CAAC0tD,gBAAgB,CAAClvD,IAAD,CAA5C,EAAoD;AAClD,iBAAOA,IAAP;AACD;AACF;AACF;AACF,GATD;;AAUA,MAAIsvD,aAAa,GAAG,UAAUl0C,MAAV,EAAkBlzB,IAAlB,EAAwB;AAC1C,QAAI6mE,MAAM,CAAC7mE,IAAD,CAAV,EAAkB;AAChBA,MAAAA,IAAI,GAAGA,IAAI,CAAC2a,QAAZ;AACD;;AACD,WAAO,CAAC,CAACuY,MAAM,CAAC8M,MAAP,CAAc+G,oBAAd,GAAqC/mC,IAAI,CAACuO,WAAL,EAArC,CAAT;AACD,GALD;;AAMA,MAAIi5B,OAAO,GAAG,UAAU6/B,EAAV,EAAcnxD,MAAd,EAAsBqG,KAAtB,EAA6B;AACzC,WAAO8qD,EAAE,CAACrnC,MAAH,CAAUuH,YAAV,CAAuBrxB,MAAvB,EAA+BqG,KAA/B,CAAP;AACD,GAFD;;AAGA,MAAIyqD,gBAAgB,GAAG,UAAUlvD,IAAV,EAAgBwvD,WAAhB,EAA6B;AAClD,QAAIA,WAAW,KAAK,KAAK,CAAzB,EAA4B;AAC1BA,MAAAA,WAAW,GAAG,KAAd;AACD;;AACD,QAAI1gE,aAAa,CAACkR,IAAD,CAAb,IAAuByL,QAAQ,CAACzL,IAAD,CAAnC,EAA2C;AACzC,UAAI4V,IAAI,GAAG45C,WAAW,GAAGxvD,IAAI,CAAC4V,IAAL,CAAUxf,OAAV,CAAkB,IAAlB,EAAwB,MAAxB,CAAH,GAAqC4J,IAAI,CAAC4V,IAAhE;AACA,aAAOqO,gBAAgB,CAACrO,IAAD,CAAvB;AACD,KAHD,MAGO;AACL,aAAO,KAAP;AACD;AACF,GAVD;;AAWA,MAAI65C,eAAe,GAAG,UAAUzvD,IAAV,EAAgB;AACpC,WAAOlR,aAAa,CAACkR,IAAD,CAAb,IAAuByL,QAAQ,CAACzL,IAAD,CAA/B,IAAyCA,IAAI,CAAC5W,MAAL,KAAgB,CAAhE;AACD,GAFD;;AAGA,MAAIsmE,WAAW,GAAG,UAAU5kE,KAAV,EAAiB6kE,IAAjB,EAAuB;AACvC,QAAI,OAAO7kE,KAAP,KAAiB,QAArB,EAA+B;AAC7BA,MAAAA,KAAK,GAAGA,KAAK,CAAC6kE,IAAD,CAAb;AACD,KAFD,MAEO,IAAIA,IAAJ,EAAU;AACf7kE,MAAAA,KAAK,GAAGA,KAAK,CAACsL,OAAN,CAAc,SAAd,EAAyB,UAAUoB,GAAV,EAAetP,IAAf,EAAqB;AACpD,eAAOynE,IAAI,CAACznE,IAAD,CAAJ,IAAcsP,GAArB;AACD,OAFO,CAAR;AAGD;;AACD,WAAO1M,KAAP;AACD,GATD;;AAUA,MAAI8kE,IAAI,GAAG,UAAUC,IAAV,EAAgBj+B,IAAhB,EAAsB;AAC/Bi+B,IAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;AACAj+B,IAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;AACAi+B,IAAAA,IAAI,GAAG,MAAMA,IAAI,CAAChtD,QAAL,IAAiBgtD,IAAvB,CAAP;AACAj+B,IAAAA,IAAI,GAAG,MAAMA,IAAI,CAAC/uB,QAAL,IAAiB+uB,IAAvB,CAAP;AACA,WAAOi+B,IAAI,CAACp5D,WAAL,OAAuBm7B,IAAI,CAACn7B,WAAL,EAA9B;AACD,GAND;;AAOA,MAAIq5D,mBAAmB,GAAG,UAAU1vD,GAAV,EAAetV,KAAf,EAAsB5C,IAAtB,EAA4B;AACpD,QAAIA,IAAI,KAAK,OAAT,IAAoBA,IAAI,KAAK,iBAAjC,EAAoD;AAClD4C,MAAAA,KAAK,GAAGsV,GAAG,CAACyvB,KAAJ,CAAU/kC,KAAV,CAAR;AACD;;AACD,QAAI5C,IAAI,KAAK,YAAT,IAAyB4C,KAAK,KAAK,GAAvC,EAA4C;AAC1CA,MAAAA,KAAK,GAAG,MAAR;AACD;;AACD,QAAI5C,IAAI,KAAK,YAAb,EAA2B;AACzB4C,MAAAA,KAAK,GAAGA,KAAK,CAACsL,OAAN,CAAc,SAAd,EAAyB,EAAzB,EAA6BA,OAA7B,CAAqC,OAArC,EAA8C,GAA9C,CAAR;AACD;;AACD,WAAO,KAAKtL,KAAZ;AACD,GAXD;;AAYA,MAAIqgD,QAAQ,GAAG,UAAU/qC,GAAV,EAAeJ,IAAf,EAAqB9X,IAArB,EAA2B;AACxC,WAAO4nE,mBAAmB,CAAC1vD,GAAD,EAAMA,GAAG,CAAC+qC,QAAJ,CAAanrC,IAAb,EAAmB9X,IAAnB,CAAN,EAAgCA,IAAhC,CAA1B;AACD,GAFD;;AAGA,MAAI6nE,iBAAiB,GAAG,UAAU3vD,GAAV,EAAeJ,IAAf,EAAqB;AAC3C,QAAIgwD,UAAJ;AACA5vD,IAAAA,GAAG,CAACurC,SAAJ,CAAc3rC,IAAd,EAAoB,UAAU9T,CAAV,EAAa;AAC/B8jE,MAAAA,UAAU,GAAG5vD,GAAG,CAAC+qC,QAAJ,CAAaj/C,CAAb,EAAgB,iBAAhB,CAAb;AACA,aAAO8jE,UAAU,IAAIA,UAAU,KAAK,MAApC;AACD,KAHD;AAIA,WAAOA,UAAP;AACD,GAPD;;AAQA,MAAIC,YAAY,GAAG,UAAU7vD,GAAV,EAAeJ,IAAf,EAAqBuB,QAArB,EAA+B;AAChD,WAAOnB,GAAG,CAACorC,UAAJ,CAAexrC,IAAf,EAAqBuB,QAArB,EAA+BnB,GAAG,CAACypC,OAAJ,EAA/B,CAAP;AACD,GAFD;;AAGA,MAAIqmB,oBAAoB,GAAG,UAAU90C,MAAV,EAAkB+0C,UAAlB,EAA8B;AACvD,QAAIC,iBAAiB,GAAG,UAAUC,MAAV,EAAkB;AACxC,UAAIC,eAAe,GAAG,UAAU18C,GAAV,EAAe;AACnC,eAAOA,GAAG,CAACxqB,MAAJ,GAAa,CAAb,IAAkBwqB,GAAG,CAACmO,MAAJ,CAAW,CAAX,MAAkB,GAA3C;AACD,OAFD;;AAGA,aAAO70B,MAAM,CAAC,CACZ,QADY,EAEZ,YAFY,CAAD,EAGV,UAAUmF,GAAV,EAAe;AAChB,eAAOD,KAAK,CAACi+D,MAAD,EAASh+D,GAAT,CAAL,CAAmBnF,MAAnB,CAA0B,UAAUqjE,KAAV,EAAiB;AAChD,cAAIC,WAAW,GAAG/hE,OAAO,CAAC8hE,KAAD,CAAP,GAAiBA,KAAjB,GAAyBp+D,MAAM,CAACo+D,KAAD,CAAjD;AACA,iBAAOrjE,MAAM,CAACsjE,WAAD,EAAcF,eAAd,CAAb;AACD,SAHM,CAAP;AAID,OARY,CAAb;AASD,KAbD;;AAcA,WAAOpjE,MAAM,CAACkuB,MAAM,CAACq1C,SAAP,CAAiB1/D,GAAjB,CAAqBo/D,UAArB,CAAD,EAAmCC,iBAAnC,CAAb;AACD,GAhBD;;AAiBA,MAAIM,iBAAiB,GAAG,UAAUt1C,MAAV,EAAkB+0C,UAAlB,EAA8BQ,eAA9B,EAA+C;AACrE,QAAIC,SAAS,GAAG,CACd,QADc,EAEd,OAFc,EAGd,UAHc,EAId,YAJc,EAKd,QALc,EAMd,SANc,CAAhB;;AAQA,QAAIC,SAAS,GAAG,UAAUR,MAAV,EAAkB;AAChC,aAAOp+D,QAAQ,CAACo+D,MAAD,EAAS,UAAU74C,CAAV,EAAanlB,GAAb,EAAkB;AACxC,eAAOnF,MAAM,CAAC0jE,SAAD,EAAY,UAAUE,QAAV,EAAoB;AAC3C,iBAAOA,QAAQ,KAAKz+D,GAApB;AACD,SAFY,CAAb;AAGD,OAJc,CAAf;AAKD,KAND;;AAOA,WAAOnF,MAAM,CAACkuB,MAAM,CAACq1C,SAAP,CAAiB1/D,GAAjB,CAAqBo/D,UAArB,CAAD,EAAmC,UAAUY,IAAV,EAAgB;AAC9D,UAAIC,YAAY,GAAGH,SAAS,CAACE,IAAD,CAA5B;AACA,aAAO7jE,MAAM,CAACkuB,MAAM,CAACq1C,SAAP,CAAiB1/D,GAAjB,CAAqB4/D,eAArB,CAAD,EAAwC,UAAUM,IAAV,EAAgB;AACnE,YAAIC,YAAY,GAAGL,SAAS,CAACI,IAAD,CAA5B;AACA,eAAOz+D,KAAK,CAACw+D,YAAD,EAAeE,YAAf,CAAZ;AACD,OAHY,CAAb;AAID,KANY,CAAb;AAOD,GAvBD;;AAwBA,MAAIC,aAAa,GAAG,UAAUd,MAAV,EAAkB;AACpC,WAAO99D,iBAAiB,CAAC89D,MAAD,EAAS,OAAT,CAAxB;AACD,GAFD;;AAGA,MAAIe,gBAAgB,GAAG,UAAUf,MAAV,EAAkB;AACvC,WAAO99D,iBAAiB,CAAC89D,MAAD,EAAS,UAAT,CAAxB;AACD,GAFD;;AAGA,MAAIgB,cAAc,GAAG,UAAUhB,MAAV,EAAkB;AACrC,WAAO99D,iBAAiB,CAAC89D,MAAD,EAAS,QAAT,CAAxB;AACD,GAFD;;AAIA,MAAIiB,gBAAgB,GAAG9C,gBAAvB;AACA,MAAI+C,YAAY,GAAGtB,YAAnB;AACA,MAAIuB,kBAAkB,GAAGtC,gBAAzB;AACA,MAAIuC,aAAa,GAAGnC,aAApB;;AACA,MAAIoC,SAAS,GAAG,UAAU1xD,IAAV,EAAgB;AAC9B,WAAO6L,IAAI,CAAC7L,IAAD,CAAJ,IAAcA,IAAI,CAACkL,YAAL,CAAkB,gBAAlB,CAAd,IAAqD,CAAClL,IAAI,CAACsE,WAAlE;AACD,GAFD;;AAGA,MAAIqtD,yBAAyB,GAAG,UAAUvxD,GAAV,EAAeJ,IAAf,EAAqB;AACnD,QAAI5B,MAAM,GAAG4B,IAAb;;AACA,WAAO5B,MAAP,EAAe;AACb,UAAIiM,WAAW,CAACjM,MAAD,CAAX,IAAuBgC,GAAG,CAAC0uC,kBAAJ,CAAuB1wC,MAAvB,CAA3B,EAA2D;AACzD,eAAOgC,GAAG,CAAC0uC,kBAAJ,CAAuB1wC,MAAvB,MAAmC,OAAnC,GAA6CA,MAA7C,GAAsD4B,IAA7D;AACD;;AACD5B,MAAAA,MAAM,GAAGA,MAAM,CAACsF,UAAhB;AACD;;AACD,WAAO1D,IAAP;AACD,GATD;;AAUA,MAAI4xD,QAAQ,GAAG,UAAU/5D,KAAV,EAAiBmI,IAAjB,EAAuBgiB,MAAvB,EAA+BruB,SAA/B,EAA0C;AACvD,QAAI6D,GAAG,GAAGwI,IAAI,CAAC4V,IAAf;;AACA,SAAK,IAAItsB,CAAC,GAAG04B,MAAb,EAAqBnqB,KAAK,GAAGvO,CAAC,IAAI,CAAR,GAAYA,CAAC,GAAGkO,GAAG,CAACpO,MAA9C,EAAsDyO,KAAK,GAAGvO,CAAC,EAAJ,GAASA,CAAC,EAArE,EAAyE;AACvE,UAAIqK,SAAS,CAAC6D,GAAG,CAACuqB,MAAJ,CAAWz4B,CAAX,CAAD,CAAb,EAA8B;AAC5B,eAAOuO,KAAK,GAAGvO,CAAC,GAAG,CAAP,GAAWA,CAAvB;AACD;AACF;;AACD,WAAO,CAAC,CAAR;AACD,GARD;;AASA,MAAIuoE,SAAS,GAAG,UAAUh6D,KAAV,EAAiBmI,IAAjB,EAAuBgiB,MAAvB,EAA+B;AAC7C,WAAO4vC,QAAQ,CAAC/5D,KAAD,EAAQmI,IAAR,EAAcgiB,MAAd,EAAsB,UAAUtkB,CAAV,EAAa;AAChD,aAAOkxD,MAAM,CAAClxD,CAAD,CAAN,IAAamxD,cAAc,CAACnxD,CAAD,CAAlC;AACD,KAFc,CAAf;AAGD,GAJD;;AAKA,MAAIo0D,WAAW,GAAG,UAAUj6D,KAAV,EAAiBmI,IAAjB,EAAuBgiB,MAAvB,EAA+B;AAC/C,WAAO4vC,QAAQ,CAAC/5D,KAAD,EAAQmI,IAAR,EAAcgiB,MAAd,EAAsB8sC,WAAtB,CAAf;AACD,GAFD;;AAGA,MAAIiD,gBAAgB,GAAG,UAAU3xD,GAAV,EAAekH,IAAf,EAAqB5K,SAArB,EAAgCslB,MAAhC,EAAwCnqB,KAAxC,EAA+Cm6D,qBAA/C,EAAsE;AAC3F,QAAIC,YAAJ;AACA,QAAIrzC,QAAQ,GAAGxe,GAAG,CAACurC,SAAJ,CAAcjvC,SAAd,EAAyB0D,GAAG,CAAC4f,OAA7B,KAAyC1Y,IAAxD;;AACA,QAAI7I,IAAI,GAAG,UAAU/B,SAAV,EAAqBslB,MAArB,EAA6BvyB,IAA7B,EAAmC;AAC5C,UAAIyiE,UAAU,GAAGpZ,UAAU,CAAC14C,GAAD,CAA3B;AACA,UAAI0kB,MAAM,GAAGjtB,KAAK,GAAGq6D,UAAU,CAACjZ,SAAd,GAA0BiZ,UAAU,CAAChZ,QAAvD;AACA,aAAOjrD,QAAQ,CAACD,IAAT,CAAc82B,MAAM,CAACpoB,SAAD,EAAYslB,MAAZ,EAAoB,UAAU9hB,IAAV,EAAgBiyD,UAAhB,EAA4B;AACzE,YAAIb,gBAAgB,CAACpxD,IAAI,CAACwD,UAAN,CAApB,EAAuC;AACrC,iBAAO,CAAC,CAAR;AACD,SAFD,MAEO;AACLuuD,UAAAA,YAAY,GAAG/xD,IAAf;AACA,iBAAOzQ,IAAI,CAACoI,KAAD,EAAQqI,IAAR,EAAciyD,UAAd,CAAX;AACD;AACF,OAP0B,EAOxBvzC,QAPwB,CAApB,CAAP;AAQD,KAXD;;AAYA,QAAIwzC,WAAW,GAAG3zD,IAAI,CAAC/B,SAAD,EAAYslB,MAAZ,EAAoB6vC,SAApB,CAAtB;AACA,WAAOO,WAAW,CAACnlE,IAAZ,CAAiB,UAAUwsB,MAAV,EAAkB;AACxC,aAAOu4C,qBAAqB,GAAGvzD,IAAI,CAACgb,MAAM,CAAC/c,SAAR,EAAmB+c,MAAM,CAACuI,MAAP,IAAiBnqB,KAAK,GAAG,CAAC,CAAJ,GAAQ,CAA9B,CAAnB,EAAqDi6D,WAArD,CAAP,GAA2E7jE,QAAQ,CAACR,IAAT,CAAcgsB,MAAd,CAAvG;AACD,KAFM,EAEJ3sB,OAFI,CAEI,YAAY;AACrB,aAAOmlE,YAAY,GAAGhkE,QAAQ,CAACR,IAAT,CAAc;AAClCiP,QAAAA,SAAS,EAAEu1D,YADuB;AAElCjwC,QAAAA,MAAM,EAAEnqB,KAAK,GAAG,CAAH,GAAOo6D,YAAY,CAAC7oE;AAFC,OAAd,CAAH,GAGd6E,QAAQ,CAACrC,IAAT,EAHL;AAID,KAPM,CAAP;AAQD,GAxBD;;AAyBA,MAAIymE,oBAAoB,GAAG,UAAUjyD,GAAV,EAAeiwD,MAAf,EAAuBhb,GAAvB,EAA4B34C,SAA5B,EAAuC0iB,WAAvC,EAAoD;AAC7E,QAAI3T,QAAQ,CAAC/O,SAAD,CAAR,IAAuBA,SAAS,CAACkhC,SAAV,CAAoBx0C,MAApB,KAA+B,CAAtD,IAA2DsT,SAAS,CAAC0iB,WAAD,CAAxE,EAAuF;AACrF1iB,MAAAA,SAAS,GAAGA,SAAS,CAAC0iB,WAAD,CAArB;AACD;;AACD,QAAIzb,OAAO,GAAG4tD,YAAY,CAACnxD,GAAD,EAAM1D,SAAN,CAA1B;;AACA,SAAK,IAAIpT,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqa,OAAO,CAACva,MAA5B,EAAoCE,CAAC,EAArC,EAAyC;AACvC,WAAK,IAAIN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqnE,MAAM,CAACjnE,MAA3B,EAAmCJ,CAAC,EAApC,EAAwC;AACtC,YAAIspE,SAAS,GAAGjC,MAAM,CAACrnE,CAAD,CAAtB;;AACA,YAAI,eAAespE,SAAf,IAA4BA,SAAS,CAAClS,SAAV,KAAwB/K,GAAG,CAAC+K,SAA5D,EAAuE;AACrE;AACD;;AACD,YAAIhgD,GAAG,CAAC9T,EAAJ,CAAOqX,OAAO,CAACra,CAAD,CAAd,EAAmBgpE,SAAS,CAAC/wD,QAA7B,CAAJ,EAA4C;AAC1C,iBAAOoC,OAAO,CAACra,CAAD,CAAd;AACD;AACF;AACF;;AACD,WAAOoT,SAAP;AACD,GAjBD;;AAkBA,MAAI61D,iBAAiB,GAAG,UAAUn3C,MAAV,EAAkBi1C,MAAlB,EAA0B3zD,SAA1B,EAAqC0iB,WAArC,EAAkD;AACxE,QAAIpf,IAAJ;AACA,QAAII,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,QAAI7C,IAAI,GAAG6C,GAAG,CAACypC,OAAJ,EAAX;;AACA,QAAI,CAACwmB,MAAM,CAAC,CAAD,CAAN,CAAU1pD,OAAf,EAAwB;AACtB3G,MAAAA,IAAI,GAAGI,GAAG,CAACurC,SAAJ,CAAcjvC,SAAd,EAAyB2zD,MAAM,CAAC,CAAD,CAAN,CAAU5O,KAAnC,EAA0ClkD,IAA1C,CAAP;AACD;;AACD,QAAI,CAACyC,IAAL,EAAW;AACT,UAAIwyD,SAAS,GAAGpyD,GAAG,CAACurC,SAAJ,CAAcjvC,SAAd,EAAyB,UAAzB,CAAhB;AACAsD,MAAAA,IAAI,GAAGI,GAAG,CAACurC,SAAJ,CAAclgC,QAAQ,CAAC/O,SAAD,CAAR,GAAsBA,SAAS,CAACgH,UAAhC,GAA6ChH,SAA3D,EAAsE,UAAUsD,IAAV,EAAgB;AAC3F,eAAOA,IAAI,KAAKzC,IAAT,IAAiBk0D,aAAa,CAACr2C,MAAD,EAASpb,IAAT,CAArC;AACD,OAFM,EAEJwyD,SAFI,CAAP;AAGD;;AACD,QAAIxyD,IAAI,IAAIqwD,MAAM,CAAC,CAAD,CAAN,CAAU1pD,OAAtB,EAA+B;AAC7B3G,MAAAA,IAAI,GAAGuxD,YAAY,CAACnxD,GAAD,EAAMJ,IAAN,EAAY,OAAZ,CAAZ,CAAiCzP,OAAjC,GAA2C,CAA3C,KAAiDyP,IAAxD;AACD;;AACD,QAAI,CAACA,IAAL,EAAW;AACTA,MAAAA,IAAI,GAAGtD,SAAP;;AACA,aAAOsD,IAAI,CAACof,WAAD,CAAJ,IAAqB,CAAChf,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAI,CAACof,WAAD,CAAhB,CAA7B,EAA6D;AAC3Dpf,QAAAA,IAAI,GAAGA,IAAI,CAACof,WAAD,CAAX;;AACA,YAAIwwC,IAAI,CAAC5vD,IAAD,EAAO,IAAP,CAAR,EAAsB;AACpB;AACD;AACF;AACF;;AACD,WAAOA,IAAI,IAAItD,SAAf;AACD,GA1BD;;AA2BA,MAAI+1D,iBAAiB,GAAG,UAAUryD,GAAV,EAAe7C,IAAf,EAAqBb,SAArB,EAAgC0iB,WAAhC,EAA6C;AACnE,QAAIhhB,MAAM,GAAG1B,SAAS,CAACgH,UAAvB;;AACA,QAAI5U,aAAa,CAAC4N,SAAS,CAAC0iB,WAAD,CAAV,CAAjB,EAA2C;AACzC,aAAO,KAAP;AACD,KAFD,MAEO,IAAIhhB,MAAM,KAAKb,IAAX,IAAmB1O,UAAU,CAACuP,MAAD,CAA7B,IAAyCgC,GAAG,CAAC4f,OAAJ,CAAY5hB,MAAZ,CAA7C,EAAkE;AACvE,aAAO,IAAP;AACD,KAFM,MAEA;AACL,aAAOq0D,iBAAiB,CAACryD,GAAD,EAAM7C,IAAN,EAAYa,MAAZ,EAAoBghB,WAApB,CAAxB;AACD;AACF,GATD;;AAUA,MAAIszC,mBAAmB,GAAG,UAAUtyD,GAAV,EAAeiwD,MAAf,EAAuB3zD,SAAvB,EAAkCslB,MAAlC,EAA0CnqB,KAA1C,EAAiD;AACzE,QAAIuG,MAAM,GAAG1B,SAAb;AACA,QAAI2J,OAAJ;AACA,QAAI+Y,WAAW,GAAGvnB,KAAK,GAAG,iBAAH,GAAuB,aAA9C;AACA,QAAI0F,IAAI,GAAG6C,GAAG,CAACypC,OAAJ,EAAX;;AACA,QAAIp+B,QAAQ,CAAC/O,SAAD,CAAR,IAAuB,CAAC80D,kBAAkB,CAAC90D,SAAD,CAA9C,EAA2D;AACzD,UAAI7E,KAAK,GAAGmqB,MAAM,GAAG,CAAZ,GAAgBA,MAAM,GAAGtlB,SAAS,CAACkZ,IAAV,CAAexsB,MAAjD,EAAyD;AACvD,eAAOsT,SAAP;AACD;AACF;;AACD,WAAO,IAAP,EAAa;AACX,UAAI,CAAC2zD,MAAM,CAAC,CAAD,CAAN,CAAUsC,YAAX,IAA2BvyD,GAAG,CAAC4f,OAAJ,CAAY5hB,MAAZ,CAA/B,EAAoD;AAClD,eAAOA,MAAP;AACD;;AACD,WAAKiI,OAAO,GAAGjI,MAAM,CAACghB,WAAD,CAArB,EAAoC/Y,OAApC,EAA6CA,OAAO,GAAGA,OAAO,CAAC+Y,WAAD,CAA9D,EAA6E;AAC3E,YAAIowC,WAAW,GAAG/jD,QAAQ,CAACpF,OAAD,CAAR,IAAqB,CAACosD,iBAAiB,CAACryD,GAAD,EAAM7C,IAAN,EAAY8I,OAAZ,EAAqB+Y,WAArB,CAAzD;;AACA,YAAI,CAACkyC,gBAAgB,CAACjrD,OAAD,CAAjB,IAA8B,CAACqrD,SAAS,CAACrrD,OAAD,CAAxC,IAAqD,CAACmrD,kBAAkB,CAACnrD,OAAD,EAAUmpD,WAAV,CAA5E,EAAoG;AAClG,iBAAOpxD,MAAP;AACD;AACF;;AACD,UAAIA,MAAM,KAAKb,IAAX,IAAmBa,MAAM,CAACsF,UAAP,KAAsBnG,IAA7C,EAAmD;AACjDb,QAAAA,SAAS,GAAG0B,MAAZ;AACA;AACD;;AACDA,MAAAA,MAAM,GAAGA,MAAM,CAACsF,UAAhB;AACD;;AACD,WAAOhH,SAAP;AACD,GA3BD;;AA4BA,MAAIk2D,sBAAsB,GAAG,UAAUl2D,SAAV,EAAqB;AAChD,WAAO40D,gBAAgB,CAAC50D,SAAS,CAACgH,UAAX,CAAhB,IAA0C4tD,gBAAgB,CAAC50D,SAAD,CAAjE;AACD,GAFD;;AAGA,MAAIm2D,SAAS,GAAG,UAAUz3C,MAAV,EAAkBi6B,GAAlB,EAAuBgb,MAAvB,EAA+ByC,oBAA/B,EAAqD;AACnE,QAAIA,oBAAoB,KAAK,KAAK,CAAlC,EAAqC;AACnCA,MAAAA,oBAAoB,GAAG,KAAvB;AACD;;AACD,QAAI9vC,cAAc,GAAGqyB,GAAG,CAACryB,cAAzB;AAAA,QAAyCksB,WAAW,GAAGmG,GAAG,CAACnG,WAA3D;AAAA,QAAwEC,YAAY,GAAGkG,GAAG,CAAClG,YAA3F;AAAA,QAAyGC,SAAS,GAAGiG,GAAG,CAACjG,SAAzH;AACA,QAAIhvC,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;;AACA,QAAIiK,WAAW,CAAC2Y,cAAD,CAAX,IAA+BA,cAAc,CAACvjB,aAAf,EAAnC,EAAmE;AACjEujB,MAAAA,cAAc,GAAG03B,OAAO,CAAC13B,cAAD,EAAiBksB,WAAjB,CAAxB;;AACA,UAAIzjC,QAAQ,CAACuX,cAAD,CAAZ,EAA8B;AAC5BksB,QAAAA,WAAW,GAAG,CAAd;AACD;AACF;;AACD,QAAI7kC,WAAW,CAAC8kC,YAAD,CAAX,IAA6BA,YAAY,CAAC1vC,aAAb,EAAjC,EAA+D;AAC7D0vC,MAAAA,YAAY,GAAGuL,OAAO,CAACvL,YAAD,EAAekG,GAAG,CAAC+K,SAAJ,GAAgBhR,SAAhB,GAA4BA,SAAS,GAAG,CAAvD,CAAtB;;AACA,UAAI3jC,QAAQ,CAAC0jC,YAAD,CAAZ,EAA4B;AAC1BC,QAAAA,SAAS,GAAGD,YAAY,CAACvR,SAAb,CAAuBx0C,MAAnC;AACD;AACF;;AACD45B,IAAAA,cAAc,GAAG2uC,yBAAyB,CAACvxD,GAAD,EAAM4iB,cAAN,CAA1C;AACAmsB,IAAAA,YAAY,GAAGwiB,yBAAyB,CAACvxD,GAAD,EAAM+uC,YAAN,CAAxC;;AACA,QAAIyjB,sBAAsB,CAAC5vC,cAAD,CAA1B,EAA4C;AAC1CA,MAAAA,cAAc,GAAGsuC,gBAAgB,CAACtuC,cAAD,CAAhB,GAAmCA,cAAnC,GAAoDA,cAAc,CAACtf,UAApF;;AACA,UAAI2xC,GAAG,CAAC+K,SAAR,EAAmB;AACjBp9B,QAAAA,cAAc,GAAGA,cAAc,CAAC3e,eAAf,IAAkC2e,cAAnD;AACD,OAFD,MAEO;AACLA,QAAAA,cAAc,GAAGA,cAAc,CAAC1e,WAAf,IAA8B0e,cAA/C;AACD;;AACD,UAAIvX,QAAQ,CAACuX,cAAD,CAAZ,EAA8B;AAC5BksB,QAAAA,WAAW,GAAGmG,GAAG,CAAC+K,SAAJ,GAAgBp9B,cAAc,CAAC55B,MAA/B,GAAwC,CAAtD;AACD;AACF;;AACD,QAAIwpE,sBAAsB,CAACzjB,YAAD,CAA1B,EAA0C;AACxCA,MAAAA,YAAY,GAAGmiB,gBAAgB,CAACniB,YAAD,CAAhB,GAAiCA,YAAjC,GAAgDA,YAAY,CAACzrC,UAA5E;;AACA,UAAI2xC,GAAG,CAAC+K,SAAR,EAAmB;AACjBjR,QAAAA,YAAY,GAAGA,YAAY,CAAC7qC,WAAb,IAA4B6qC,YAA3C;AACD,OAFD,MAEO;AACLA,QAAAA,YAAY,GAAGA,YAAY,CAAC9qC,eAAb,IAAgC8qC,YAA/C;AACD;;AACD,UAAI1jC,QAAQ,CAAC0jC,YAAD,CAAZ,EAA4B;AAC1BC,QAAAA,SAAS,GAAGiG,GAAG,CAAC+K,SAAJ,GAAgB,CAAhB,GAAoBjR,YAAY,CAAC/lD,MAA7C;AACD;AACF;;AACD,QAAIisD,GAAG,CAAC+K,SAAR,EAAmB;AACjB,UAAI2S,UAAU,GAAGhB,gBAAgB,CAAC3xD,GAAD,EAAMgb,MAAM,CAACo6B,OAAP,EAAN,EAAwBxyB,cAAxB,EAAwCksB,WAAxC,EAAqD,IAArD,EAA2D4jB,oBAA3D,CAAjC;AACAC,MAAAA,UAAU,CAAC/lE,IAAX,CAAgB,UAAUgqD,EAAV,EAAc;AAC5B,YAAIt6C,SAAS,GAAGs6C,EAAE,CAACt6C,SAAnB;AAAA,YAA8BslB,MAAM,GAAGg1B,EAAE,CAACh1B,MAA1C;AACAgB,QAAAA,cAAc,GAAGtmB,SAAjB;AACAwyC,QAAAA,WAAW,GAAGltB,MAAd;AACD,OAJD;AAKA,UAAIgxC,QAAQ,GAAGjB,gBAAgB,CAAC3xD,GAAD,EAAMgb,MAAM,CAACo6B,OAAP,EAAN,EAAwBrG,YAAxB,EAAsCC,SAAtC,EAAiD,KAAjD,EAAwD0jB,oBAAxD,CAA/B;AACAE,MAAAA,QAAQ,CAAChmE,IAAT,CAAc,UAAUgqD,EAAV,EAAc;AAC1B,YAAIt6C,SAAS,GAAGs6C,EAAE,CAACt6C,SAAnB;AAAA,YAA8BslB,MAAM,GAAGg1B,EAAE,CAACh1B,MAA1C;AACAmtB,QAAAA,YAAY,GAAGzyC,SAAf;AACA0yC,QAAAA,SAAS,GAAGptB,MAAZ;AACD,OAJD;AAKD;;AACD,QAAIquC,MAAM,CAAC,CAAD,CAAN,CAAUljC,MAAV,IAAoBkjC,MAAM,CAAC,CAAD,CAAN,CAAUsC,YAAlC,EAAgD;AAC9C,UAAI,CAACtC,MAAM,CAAC,CAAD,CAAN,CAAUljC,MAAX,IAAsB,CAAC1hB,QAAQ,CAACuX,cAAD,CAAT,IAA6BksB,WAAW,KAAK,CAAvE,EAA2E;AACzElsB,QAAAA,cAAc,GAAG0vC,mBAAmB,CAACtyD,GAAD,EAAMiwD,MAAN,EAAcrtC,cAAd,EAA8BksB,WAA9B,EAA2C,IAA3C,CAApC;AACD;;AACD,UAAI,CAACmhB,MAAM,CAAC,CAAD,CAAN,CAAUljC,MAAX,IAAsB,CAAC1hB,QAAQ,CAAC0jC,YAAD,CAAT,IAA2BC,SAAS,KAAKD,YAAY,CAACvR,SAAb,CAAuBx0C,MAA1F,EAAmG;AACjG+lD,QAAAA,YAAY,GAAGujB,mBAAmB,CAACtyD,GAAD,EAAMiwD,MAAN,EAAclhB,YAAd,EAA4BC,SAA5B,EAAuC,KAAvC,CAAlC;AACD;AACF;;AACD,QAAIihB,MAAM,CAAC,CAAD,CAAN,CAAU9uD,QAAV,IAAsB8uD,MAAM,CAAC,CAAD,CAAN,CAAU4C,MAAV,KAAqB,KAA3C,IAAoD,CAAC5C,MAAM,CAAC,CAAD,CAAN,CAAUljC,MAAnE,EAA2E;AACzEnK,MAAAA,cAAc,GAAGqvC,oBAAoB,CAACjyD,GAAD,EAAMiwD,MAAN,EAAchb,GAAd,EAAmBryB,cAAnB,EAAmC,iBAAnC,CAArC;AACAmsB,MAAAA,YAAY,GAAGkjB,oBAAoB,CAACjyD,GAAD,EAAMiwD,MAAN,EAAchb,GAAd,EAAmBlG,YAAnB,EAAiC,aAAjC,CAAnC;AACD;;AACD,QAAIkhB,MAAM,CAAC,CAAD,CAAN,CAAU5O,KAAV,IAAmB4O,MAAM,CAAC,CAAD,CAAN,CAAU9uD,QAAjC,EAA2C;AACzCyhB,MAAAA,cAAc,GAAGuvC,iBAAiB,CAACn3C,MAAD,EAASi1C,MAAT,EAAiBrtC,cAAjB,EAAiC,iBAAjC,CAAlC;AACAmsB,MAAAA,YAAY,GAAGojB,iBAAiB,CAACn3C,MAAD,EAASi1C,MAAT,EAAiBlhB,YAAjB,EAA+B,aAA/B,CAAhC;;AACA,UAAIkhB,MAAM,CAAC,CAAD,CAAN,CAAU5O,KAAd,EAAqB;AACnB,YAAI,CAACrhD,GAAG,CAAC4f,OAAJ,CAAYgD,cAAZ,CAAL,EAAkC;AAChCA,UAAAA,cAAc,GAAG0vC,mBAAmB,CAACtyD,GAAD,EAAMiwD,MAAN,EAAcrtC,cAAd,EAA8BksB,WAA9B,EAA2C,IAA3C,CAApC;AACD;;AACD,YAAI,CAAC9uC,GAAG,CAAC4f,OAAJ,CAAYmvB,YAAZ,CAAL,EAAgC;AAC9BA,UAAAA,YAAY,GAAGujB,mBAAmB,CAACtyD,GAAD,EAAMiwD,MAAN,EAAclhB,YAAd,EAA4BC,SAA5B,EAAuC,KAAvC,CAAlC;AACD;AACF;AACF;;AACD,QAAI/kC,WAAW,CAAC2Y,cAAD,CAAf,EAAiC;AAC/BksB,MAAAA,WAAW,GAAG9uC,GAAG,CAACy+B,SAAJ,CAAc7b,cAAd,CAAd;AACAA,MAAAA,cAAc,GAAGA,cAAc,CAACtf,UAAhC;AACD;;AACD,QAAI2G,WAAW,CAAC8kC,YAAD,CAAf,EAA+B;AAC7BC,MAAAA,SAAS,GAAGhvC,GAAG,CAACy+B,SAAJ,CAAcsQ,YAAd,IAA8B,CAA1C;AACAA,MAAAA,YAAY,GAAGA,YAAY,CAACzrC,UAA5B;AACD;;AACD,WAAO;AACLsf,MAAAA,cAAc,EAAEA,cADX;AAELksB,MAAAA,WAAW,EAAEA,WAFR;AAGLC,MAAAA,YAAY,EAAEA,YAHT;AAILC,MAAAA,SAAS,EAAEA;AAJN,KAAP;AAMD,GA9FD;;AAgGA,MAAI8jB,uBAAuB,GAAG,UAAUx2D,SAAV,EAAqBxJ,KAArB,EAA4B;AACxD,QAAIwM,UAAU,GAAGhD,SAAS,CAACgD,UAA3B;;AACA,QAAIxM,KAAK,IAAIwM,UAAU,CAACtW,MAAxB,EAAgC;AAC9B8J,MAAAA,KAAK,GAAGwM,UAAU,CAACtW,MAAX,GAAoB,CAA5B;AACD,KAFD,MAEO,IAAI8J,KAAK,GAAG,CAAZ,EAAe;AACpBA,MAAAA,KAAK,GAAG,CAAR;AACD;;AACD,WAAOwM,UAAU,CAACxM,KAAD,CAAV,IAAqBwJ,SAA5B;AACD,GARD;;AASA,MAAIy2D,WAAW,GAAG,UAAUz2D,SAAV,EAAqBxJ,KAArB,EAA4B;AAC5C,WAAOggE,uBAAuB,CAACx2D,SAAD,EAAYxJ,KAAK,GAAG,CAApB,CAA9B;AACD,GAFD;;AAGA,MAAIkgE,MAAM,GAAG,UAAUhzD,GAAV,EAAei1C,GAAf,EAAoBtiD,QAApB,EAA8B;AACzC,QAAIiwB,cAAc,GAAGqyB,GAAG,CAACryB,cAAzB;AACA,QAAIksB,WAAW,GAAGmG,GAAG,CAACnG,WAAtB;AACA,QAAIC,YAAY,GAAGkG,GAAG,CAAClG,YAAvB;AACA,QAAIC,SAAS,GAAGiG,GAAG,CAACjG,SAApB;;AACA,QAAIikB,OAAO,GAAG,UAAUplD,KAAV,EAAiB;AAC7B,UAAIjO,IAAJ;AACAA,MAAAA,IAAI,GAAGiO,KAAK,CAAC,CAAD,CAAZ;;AACA,UAAIjO,IAAI,CAACwB,QAAL,KAAkB,CAAlB,IAAuBxB,IAAI,KAAKgjB,cAAhC,IAAkDksB,WAAW,IAAIlvC,IAAI,CAAC49B,SAAL,CAAex0C,MAApF,EAA4F;AAC1F6kB,QAAAA,KAAK,CAACoe,MAAN,CAAa,CAAb,EAAgB,CAAhB;AACD;;AACDrsB,MAAAA,IAAI,GAAGiO,KAAK,CAACA,KAAK,CAAC7kB,MAAN,GAAe,CAAhB,CAAZ;;AACA,UAAIgmD,SAAS,KAAK,CAAd,IAAmBnhC,KAAK,CAAC7kB,MAAN,GAAe,CAAlC,IAAuC4W,IAAI,KAAKmvC,YAAhD,IAAgEnvC,IAAI,CAACwB,QAAL,KAAkB,CAAtF,EAAyF;AACvFyM,QAAAA,KAAK,CAACoe,MAAN,CAAape,KAAK,CAAC7kB,MAAN,GAAe,CAA5B,EAA+B,CAA/B;AACD;;AACD,aAAO6kB,KAAP;AACD,KAXD;;AAYA,QAAIqlD,eAAe,GAAG,UAAUtzD,IAAV,EAAgB9X,IAAhB,EAAsBqrE,OAAtB,EAA+B;AACnD,UAAIvvD,QAAQ,GAAG,EAAf;;AACA,aAAOhE,IAAI,IAAIA,IAAI,KAAKuzD,OAAxB,EAAiCvzD,IAAI,GAAGA,IAAI,CAAC9X,IAAD,CAA5C,EAAoD;AAClD8b,QAAAA,QAAQ,CAAC5U,IAAT,CAAc4Q,IAAd;AACD;;AACD,aAAOgE,QAAP;AACD,KAND;;AAOA,QAAIwvD,YAAY,GAAG,UAAUxzD,IAAV,EAAgBzC,IAAhB,EAAsB;AACvC,SAAG;AACD,YAAIyC,IAAI,CAAC0D,UAAL,KAAoBnG,IAAxB,EAA8B;AAC5B,iBAAOyC,IAAP;AACD;;AACDA,QAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD,OALD,QAKS1D,IALT;AAMD,KAPD;;AAQA,QAAIyzD,YAAY,GAAG,UAAU90C,SAAV,EAAqB40C,OAArB,EAA8B10C,IAA9B,EAAoC;AACrD,UAAIO,WAAW,GAAGP,IAAI,GAAG,aAAH,GAAmB,iBAAzC;;AACA,WAAK,IAAI7e,IAAI,GAAG2e,SAAX,EAAsB+0C,QAAQ,GAAG1zD,IAAI,CAAC0D,UAA3C,EAAuD1D,IAAI,IAAIA,IAAI,KAAKuzD,OAAxE,EAAiFvzD,IAAI,GAAG0zD,QAAxF,EAAkG;AAChGA,QAAAA,QAAQ,GAAG1zD,IAAI,CAAC0D,UAAhB;AACA,YAAIiwD,UAAU,GAAGL,eAAe,CAACtzD,IAAI,KAAK2e,SAAT,GAAqB3e,IAArB,GAA4BA,IAAI,CAACof,WAAD,CAAjC,EAAgDA,WAAhD,CAAhC;;AACA,YAAIu0C,UAAU,CAACvqE,MAAf,EAAuB;AACrB,cAAI,CAACy1B,IAAL,EAAW;AACT80C,YAAAA,UAAU,CAACpjE,OAAX;AACD;;AACDwC,UAAAA,QAAQ,CAACsgE,OAAO,CAACM,UAAD,CAAR,CAAR;AACD;AACF;AACF,KAZD;;AAaA,QAAI3wC,cAAc,CAACxhB,QAAf,KAA4B,CAA5B,IAAiCwhB,cAAc,CAACvjB,aAAf,EAArC,EAAqE;AACnEujB,MAAAA,cAAc,GAAGkwC,uBAAuB,CAAClwC,cAAD,EAAiBksB,WAAjB,CAAxC;AACD;;AACD,QAAIC,YAAY,CAAC3tC,QAAb,KAA0B,CAA1B,IAA+B2tC,YAAY,CAAC1vC,aAAb,EAAnC,EAAiE;AAC/D0vC,MAAAA,YAAY,GAAGgkB,WAAW,CAAChkB,YAAD,EAAeC,SAAf,CAA1B;AACD;;AACD,QAAIpsB,cAAc,KAAKmsB,YAAvB,EAAqC;AACnC,aAAOp8C,QAAQ,CAACsgE,OAAO,CAAC,CAACrwC,cAAD,CAAD,CAAR,CAAf;AACD;;AACD,QAAIrJ,QAAQ,GAAGvZ,GAAG,CAACytC,kBAAJ,CAAuB7qB,cAAvB,EAAuCmsB,YAAvC,CAAf;;AACA,SAAK,IAAInvC,IAAI,GAAGgjB,cAAhB,EAAgChjB,IAAhC,EAAsCA,IAAI,GAAGA,IAAI,CAAC0D,UAAlD,EAA8D;AAC5D,UAAI1D,IAAI,KAAKmvC,YAAb,EAA2B;AACzB,eAAOskB,YAAY,CAACzwC,cAAD,EAAiBrJ,QAAjB,EAA2B,IAA3B,CAAnB;AACD;;AACD,UAAI3Z,IAAI,KAAK2Z,QAAb,EAAuB;AACrB;AACD;AACF;;AACD,SAAK,IAAI3Z,IAAI,GAAGmvC,YAAhB,EAA8BnvC,IAA9B,EAAoCA,IAAI,GAAGA,IAAI,CAAC0D,UAAhD,EAA4D;AAC1D,UAAI1D,IAAI,KAAKgjB,cAAb,EAA6B;AAC3B,eAAOywC,YAAY,CAACtkB,YAAD,EAAex1B,QAAf,CAAnB;AACD;;AACD,UAAI3Z,IAAI,KAAK2Z,QAAb,EAAuB;AACrB;AACD;AACF;;AACD,QAAIo5C,UAAU,GAAGS,YAAY,CAACxwC,cAAD,EAAiBrJ,QAAjB,CAAZ,IAA0CqJ,cAA3D;AACA,QAAIgwC,QAAQ,GAAGQ,YAAY,CAACrkB,YAAD,EAAex1B,QAAf,CAAZ,IAAwCw1B,YAAvD;AACAskB,IAAAA,YAAY,CAACzwC,cAAD,EAAiB+vC,UAAjB,EAA6B,IAA7B,CAAZ;AACA,QAAI/uD,QAAQ,GAAGsvD,eAAe,CAACP,UAAU,KAAK/vC,cAAf,GAAgC+vC,UAAhC,GAA6CA,UAAU,CAACzuD,WAAzD,EAAsE,aAAtE,EAAqF0uD,QAAQ,KAAK7jB,YAAb,GAA4B6jB,QAAQ,CAAC1uD,WAArC,GAAmD0uD,QAAxI,CAA9B;;AACA,QAAIhvD,QAAQ,CAAC5a,MAAb,EAAqB;AACnB2J,MAAAA,QAAQ,CAACsgE,OAAO,CAACrvD,QAAD,CAAR,CAAR;AACD;;AACDyvD,IAAAA,YAAY,CAACtkB,YAAD,EAAe6jB,QAAf,CAAZ;AACD,GA/ED;;AAiFA,MAAIY,SAAS,GAAG,UAAUte,SAAV,EAAqB;AACnC,QAAIue,MAAM,GAAG,EAAb;;AACA,QAAIve,SAAJ,EAAe;AACb,WAAK,IAAIhsD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgsD,SAAS,CAACwe,UAA9B,EAA0CxqE,CAAC,EAA3C,EAA+C;AAC7CuqE,QAAAA,MAAM,CAACzkE,IAAP,CAAYkmD,SAAS,CAACye,UAAV,CAAqBzqE,CAArB,CAAZ;AACD;AACF;;AACD,WAAOuqE,MAAP;AACD,GARD;;AASA,MAAIG,gBAAgB,GAAG,UAAUH,MAAV,EAAkB;AACvC,WAAO5mE,IAAI,CAAC4mE,MAAD,EAAS,UAAUz3D,KAAV,EAAiB;AACnC,UAAI4D,IAAI,GAAGy6C,eAAe,CAACr+C,KAAD,CAA1B;AACA,aAAO4D,IAAI,GAAG,CAACQ,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAD,CAAH,GAAkC,EAA7C;AACD,KAHU,CAAX;AAID,GALD;;AAMA,MAAIi0D,iBAAiB,GAAG,UAAU3e,SAAV,EAAqB;AAC3C,WAAOse,SAAS,CAACte,SAAD,CAAT,CAAqBlsD,MAArB,GAA8B,CAArC;AACD,GAFD;;AAIA,MAAI8qE,kBAAkB,GAAG,UAAUL,MAAV,EAAkB;AACzC,WAAOzmE,MAAM,CAAC4mE,gBAAgB,CAACH,MAAD,CAAjB,EAA2BrzC,aAA3B,CAAb;AACD,GAFD;;AAGA,MAAI2zC,mBAAmB,GAAG,UAAUhmD,GAAV,EAAe;AACvC,WAAO4mC,aAAa,CAAC5mC,GAAD,EAAM,6CAAN,CAApB;AACD,GAFD;;AAGA,MAAIimD,2BAA2B,GAAG,UAAUP,MAAV,EAAkBvyD,OAAlB,EAA2B;AAC3D,QAAI+yD,aAAa,GAAGF,mBAAmB,CAAC7yD,OAAD,CAAvC;AACA,WAAO+yD,aAAa,CAACjrE,MAAd,GAAuB,CAAvB,GAA2BirE,aAA3B,GAA2CH,kBAAkB,CAACL,MAAD,CAApE;AACD,GAHD;;AAIA,MAAIS,kBAAkB,GAAG,UAAUl5C,MAAV,EAAkB;AACzC,WAAOg5C,2BAA2B,CAACR,SAAS,CAACx4C,MAAM,CAACk6B,SAAP,CAAiBif,MAAjB,EAAD,CAAV,EAAuC/zD,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAvC,CAAlC;AACD,GAFD;;AAIA,MAAIgf,YAAY,GAAG,UAAUnf,GAAV,EAAe;AAChC,QAAI2G,EAAE,GAAG3G,GAAG,CAACryB,cAAb;AAAA,QAA6Bk5B,EAAE,GAAG7G,GAAG,CAACnG,WAAtC;;AACA,QAAIzjC,QAAQ,CAACuwC,EAAD,CAAZ,EAAkB;AAChB,aAAOE,EAAE,KAAK,CAAP,GAAWjuD,QAAQ,CAACR,IAAT,CAAc+S,YAAY,CAACX,OAAb,CAAqBm8C,EAArB,CAAd,CAAX,GAAqD/tD,QAAQ,CAACrC,IAAT,EAA5D;AACD,KAFD,MAEO;AACL,aAAOqC,QAAQ,CAACD,IAAT,CAAcguD,EAAE,CAACt8C,UAAH,CAAcw8C,EAAd,CAAd,EAAiCnvD,GAAjC,CAAqCyT,YAAY,CAACX,OAAlD,CAAP;AACD;AACF,GAPD;;AAQA,MAAI40D,UAAU,GAAG,UAAUpf,GAAV,EAAe;AAC9B,QAAI4G,EAAE,GAAG5G,GAAG,CAAClG,YAAb;AAAA,QAA2BgN,EAAE,GAAG9G,GAAG,CAACjG,SAApC;;AACA,QAAI3jC,QAAQ,CAACwwC,EAAD,CAAZ,EAAkB;AAChB,aAAOE,EAAE,KAAKF,EAAE,CAACrmC,IAAH,CAAQxsB,MAAf,GAAwB6E,QAAQ,CAACR,IAAT,CAAc+S,YAAY,CAACX,OAAb,CAAqBo8C,EAArB,CAAd,CAAxB,GAAkEhuD,QAAQ,CAACrC,IAAT,EAAzE;AACD,KAFD,MAEO;AACL,aAAOqC,QAAQ,CAACD,IAAT,CAAciuD,EAAE,CAACv8C,UAAH,CAAcy8C,EAAE,GAAG,CAAnB,CAAd,EAAqCpvD,GAArC,CAAyCyT,YAAY,CAACX,OAAtD,CAAP;AACD;AACF,GAPD;;AAQA,MAAI60D,gBAAgB,GAAG,UAAU10D,IAAV,EAAgB;AACrC,WAAO2E,UAAU,CAAC3E,IAAD,CAAV,CAAiB5T,IAAjB,CAAsBvB,QAAQ,CAAC,CAACmV,IAAD,CAAD,CAA9B,EAAwC,UAAUyE,KAAV,EAAiB;AAC9D,aAAO,CAACzE,IAAD,EAAO3U,MAAP,CAAcqpE,gBAAgB,CAACjwD,KAAD,CAA9B,CAAP;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAIkwD,eAAe,GAAG,UAAU30D,IAAV,EAAgB;AACpC,WAAO4E,SAAS,CAAC5E,IAAD,CAAT,CAAgB5T,IAAhB,CAAqBvB,QAAQ,CAAC,CAACmV,IAAD,CAAD,CAA7B,EAAuC,UAAUyE,KAAV,EAAiB;AAC7D,UAAIvc,IAAI,CAACuc,KAAD,CAAJ,KAAgB,IAApB,EAA0B;AACxB,eAAOL,WAAW,CAACK,KAAD,CAAX,CAAmB1X,GAAnB,CAAuB,UAAUsZ,OAAV,EAAmB;AAC/C,iBAAO,CAACrG,IAAD,EAAO3U,MAAP,CAAcspE,eAAe,CAACtuD,OAAD,CAA7B,CAAP;AACD,SAFM,EAEJ7Z,KAFI,CAEE,EAFF,CAAP;AAGD,OAJD,MAIO;AACL,eAAO,CAACwT,IAAD,EAAO3U,MAAP,CAAcspE,eAAe,CAAClwD,KAAD,CAA7B,CAAP;AACD;AACF,KARM,CAAP;AASD,GAVD;;AAWA,MAAImwD,sBAAsB,GAAG,UAAUzmD,GAAV,EAAeknC,GAAf,EAAoB;AAC/C,WAAO+D,KAAK,CAACob,YAAY,CAACnf,GAAD,CAAb,EAAoBof,UAAU,CAACpf,GAAD,CAA9B,EAAqC,UAAU12B,SAAV,EAAqB40C,OAArB,EAA8B;AAC7E,UAAI17D,KAAK,GAAGzH,IAAI,CAACskE,gBAAgB,CAACvmD,GAAD,CAAjB,EAAwBnjB,KAAK,CAACmX,IAAD,EAAOwc,SAAP,CAA7B,CAAhB;AACA,UAAI8gC,GAAG,GAAGrvD,IAAI,CAACukE,eAAe,CAACxmD,GAAD,CAAhB,EAAuBnjB,KAAK,CAACmX,IAAD,EAAOoxD,OAAP,CAA5B,CAAd;AACA,aAAO17D,KAAK,CAACtL,MAAN,MAAkBkzD,GAAG,CAAClzD,MAAJ,EAAzB;AACD,KAJW,CAAL,CAIJC,KAJI,CAIE,KAJF,CAAP;AAKD,GAND;;AAOA,MAAIqoE,cAAc,GAAG,UAAUz0D,GAAV,EAAei1C,GAAf,EAAoBr1C,IAApB,EAA0BnI,KAA1B,EAAiC;AACpD,QAAI0F,IAAI,GAAGyC,IAAX;AAAA,QAAiB8kB,MAAM,GAAG,IAAIpG,aAAJ,CAAkB1e,IAAlB,EAAwBzC,IAAxB,CAA1B;AACA,QAAIotB,iCAAiC,GAAG14B,QAAQ,CAACmO,GAAG,CAAC8nB,MAAJ,CAAWoH,iCAAX,EAAD,EAAiD,UAAU9X,CAAV,EAAatvB,IAAb,EAAmB;AAClH,aAAO,CAACsH,QAAQ,CAAC,CACf,IADe,EAEf,IAFe,EAGf,OAHe,CAAD,EAIbtH,IAAI,CAACuO,WAAL,EAJa,CAAhB;AAKD,KAN+C,CAAhD;;AAOA,OAAG;AACD,UAAIgV,QAAQ,CAACzL,IAAD,CAAR,IAAkBlB,KAAK,CAAC3G,IAAN,CAAW6H,IAAI,CAAC49B,SAAhB,EAA2Bx0C,MAA3B,KAAsC,CAA5D,EAA+D;AAC7D,YAAIyO,KAAJ,EAAW;AACTw9C,UAAAA,GAAG,CAAC5G,QAAJ,CAAazuC,IAAb,EAAmB,CAAnB;AACD,SAFD,MAEO;AACLq1C,UAAAA,GAAG,CAAC3G,MAAJ,CAAW1uC,IAAX,EAAiBA,IAAI,CAAC49B,SAAL,CAAex0C,MAAhC;AACD;;AACD;AACD;;AACD,UAAIuhC,iCAAiC,CAAC3qB,IAAI,CAAC6C,QAAN,CAArC,EAAsD;AACpD,YAAIhL,KAAJ,EAAW;AACTw9C,UAAAA,GAAG,CAAC8T,cAAJ,CAAmBnpD,IAAnB;AACD,SAFD,MAEO;AACL,cAAIA,IAAI,CAAC6C,QAAL,KAAkB,IAAtB,EAA4B;AAC1BwyC,YAAAA,GAAG,CAAC+T,YAAJ,CAAiBppD,IAAjB;AACD,WAFD,MAEO;AACLq1C,YAAAA,GAAG,CAACiH,WAAJ,CAAgBt8C,IAAhB;AACD;AACF;;AACD;AACD;AACF,KArBD,QAqBSA,IAAI,GAAGnI,KAAK,GAAGitB,MAAM,CAACjG,IAAP,EAAH,GAAmBiG,MAAM,CAAChG,IAAP,EArBxC;;AAsBA,QAAIvhB,IAAI,CAACsF,QAAL,KAAkB,MAAtB,EAA8B;AAC5B,UAAIhL,KAAJ,EAAW;AACTw9C,QAAAA,GAAG,CAAC5G,QAAJ,CAAalxC,IAAb,EAAmB,CAAnB;AACD,OAFD,MAEO;AACL83C,QAAAA,GAAG,CAAC3G,MAAJ,CAAWnxC,IAAX,EAAiBA,IAAI,CAACmC,UAAL,CAAgBtW,MAAjC;AACD;AACF;AACF,GAtCD;;AAuCA,MAAI0rE,YAAY,GAAG,UAAU15C,MAAV,EAAkB;AACnC,QAAI25C,GAAG,GAAG35C,MAAM,CAACk6B,SAAP,CAAiBif,MAAjB,EAAV;AACA,WAAOQ,GAAG,IAAIA,GAAG,CAACjB,UAAJ,GAAiB,CAA/B;AACD,GAHD;;AAIA,MAAIkB,WAAW,GAAG,UAAU55C,MAAV,EAAkB65C,QAAlB,EAA4B;AAC5C,QAAIC,kBAAkB,GAAGZ,kBAAkB,CAACl5C,MAAD,CAA3C;;AACA,QAAI85C,kBAAkB,CAAC9rE,MAAnB,GAA4B,CAAhC,EAAmC;AACjC4D,MAAAA,IAAI,CAACkoE,kBAAD,EAAqB,UAAUzzD,IAAV,EAAgB;AACvC,YAAIzB,IAAI,GAAGyB,IAAI,CAACrB,GAAhB;AACA,YAAI+0D,WAAW,GAAG/5C,MAAM,CAAChb,GAAP,CAAW+tC,SAAX,EAAlB;AACAgnB,QAAAA,WAAW,CAAChM,cAAZ,CAA2BnpD,IAA3B;AACAm1D,QAAAA,WAAW,CAAC7Y,WAAZ,CAAwBt8C,IAAxB;AACAi1D,QAAAA,QAAQ,CAACE,WAAD,EAAc,IAAd,CAAR;AACD,OANG,CAAJ;AAOD,KARD,MAQO;AACLF,MAAAA,QAAQ,CAAC75C,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAD,EAA4B,KAA5B,CAAR;AACD;AACF,GAbD;;AAcA,MAAI6f,QAAQ,GAAG,UAAU9f,SAAV,EAAqB+f,YAArB,EAAmCJ,QAAnC,EAA6C;AAC1D,QAAI1V,QAAQ,GAAGY,qBAAqB,CAAC7K,SAAD,EAAY+f,YAAZ,CAApC;AACAJ,IAAAA,QAAQ,CAAC1V,QAAD,CAAR;AACAjK,IAAAA,SAAS,CAACkL,cAAV,CAAyBjB,QAAzB;AACD,GAJD;;AAMA,MAAI+V,SAAS,GAAG,UAAUhpE,EAAV,EAAcpE,IAAd,EAAoB;AAClC,QAAI6I,GAAG,GAAG,UAAUuQ,OAAV,EAAmB;AAC3B,UAAI,CAAChV,EAAE,CAACgV,OAAD,CAAP,EAAkB;AAChB,cAAM,IAAI7V,KAAJ,CAAU,kBAAkBvD,IAAlB,GAAyB,cAAzB,GAA0CA,IAA1C,GAAiD,OAA3D,CAAN;AACD;;AACD,aAAOqtE,SAAS,CAACj0D,OAAD,CAAT,CAAmB9U,KAAnB,CAAyB,EAAzB,CAAP;AACD,KALD;;AAMA,QAAI+oE,SAAS,GAAG,UAAUj0D,OAAV,EAAmB;AACjC,aAAOhV,EAAE,CAACgV,OAAD,CAAF,GAAcrT,QAAQ,CAACD,IAAT,CAAcsT,OAAO,CAAClB,GAAR,CAAYw9B,SAA1B,CAAd,GAAqD3vC,QAAQ,CAACrC,IAAT,EAA5D;AACD,KAFD;;AAGA,QAAI2gB,GAAG,GAAG,UAAUjL,OAAV,EAAmBxW,KAAnB,EAA0B;AAClC,UAAI,CAACwB,EAAE,CAACgV,OAAD,CAAP,EAAkB;AAChB,cAAM,IAAI7V,KAAJ,CAAU,sBAAsBvD,IAAtB,GAA6B,cAA7B,GAA8CA,IAA9C,GAAqD,OAA/D,CAAN;AACD;;AACDoZ,MAAAA,OAAO,CAAClB,GAAR,CAAYw9B,SAAZ,GAAwB9yC,KAAxB;AACD,KALD;;AAMA,WAAO;AACLiG,MAAAA,GAAG,EAAEA,GADA;AAELwkE,MAAAA,SAAS,EAAEA,SAFN;AAGLhpD,MAAAA,GAAG,EAAEA;AAHA,KAAP;AAKD,GArBD;;AAuBA,MAAIipD,GAAG,GAAGF,SAAS,CAACryD,MAAD,EAAS,MAAT,CAAnB;;AACA,MAAIwyD,KAAK,GAAG,UAAUn0D,OAAV,EAAmB;AAC7B,WAAOk0D,GAAG,CAACzkE,GAAJ,CAAQuQ,OAAR,CAAP;AACD,GAFD;;AAIA,MAAIo0D,WAAW,GAAG,UAAUj0D,IAAV,EAAgB;AAChC,WAAOwB,MAAM,CAACxB,IAAD,CAAN,IAAgBg0D,KAAK,CAACh0D,IAAD,CAAL,KAAgBuf,IAAvC;AACD,GAFD;;AAGA,MAAI0Z,OAAO,GAAG,UAAUtf,MAAV,EAAkB3Z,IAAlB,EAAwBk0D,QAAxB,EAAkC9yD,QAAlC,EAA4C;AACxD,WAAOzE,MAAM,CAACqD,IAAD,CAAN,CAAarV,IAAb,CAAkB,YAAY;AACnC,aAAO,UAAP;AACD,KAFM,EAEJ,UAAUgS,MAAV,EAAkB;AACnB,UAAIyE,QAAQ,KAAK,IAAb,IAAqB6yD,WAAW,CAACj0D,IAAD,CAApC,EAA4C;AAC1C,eAAO,OAAP;AACD,OAFD,MAEO,IAAIq0C,YAAY,CAACr0C,IAAD,CAAhB,EAAwB;AAC7B,eAAO,UAAP;AACD,OAFM,MAEA,IAAIorD,WAAW,CAACprD,IAAI,CAACrB,GAAN,CAAf,EAA2B;AAChC,eAAO,OAAP;AACD,OAFM,MAEA,IAAI,CAACsvB,OAAO,CAACtU,MAAD,EAASu6C,QAAT,EAAmB9yD,QAAnB,CAAR,IAAwC,CAAC6sB,OAAO,CAACtU,MAAD,EAASlzB,IAAI,CAACkW,MAAD,CAAb,EAAuBu3D,QAAvB,CAApD,EAAsF;AAC3F,eAAO,eAAP;AACD,OAFM,MAEA;AACL,eAAO,OAAP;AACD;AACF,KAdM,CAAP;AAeD,GAhBD;;AAkBA,MAAIC,aAAa,GAAG,UAAUx6C,MAAV,EAAkBi6B,GAAlB,EAAuB;AACzC,QAAI9lD,CAAC,GAAGsjE,SAAS,CAACz3C,MAAD,EAASi6B,GAAT,EAAc,CAAC;AAAEloB,MAAAA,MAAM,EAAE;AAAV,KAAD,CAAd,CAAjB;AACAkoB,IAAAA,GAAG,CAAC5G,QAAJ,CAAal/C,CAAC,CAACyzB,cAAf,EAA+BzzB,CAAC,CAAC2/C,WAAjC;AACAmG,IAAAA,GAAG,CAAC3G,MAAJ,CAAWn/C,CAAC,CAAC4/C,YAAb,EAA2B5/C,CAAC,CAAC6/C,SAA7B;AACAh0B,IAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB;AACD,GALD;;AAMA,MAAIwgB,cAAc,GAAG,UAAUC,IAAV,EAAgB9e,EAAhB,EAAoB5B,cAApB,EAAoC2gB,QAApC,EAA8C;AACjE,QAAIC,EAAE,GAAGhf,EAAE,CAACpB,GAAZ;AAAA,QAAiBA,GAAG,GAAGogB,EAAE,KAAK,KAAK,CAAZ,GAAgBre,UAAU,CAAC,gBAAD,CAA1B,GAA+Cqe,EAAtE;AAAA,QAA0EpgD,IAAI,GAAG5hB,MAAM,CAACgjD,EAAD,EAAK,CAAC,KAAD,CAAL,CAAvF;;AACA,QAAIif,MAAM,GAAGz1D,YAAY,CAACV,OAAb,CAAqB,MAArB,EAA6Bg2D,IAA7B,CAAb;AACAphB,IAAAA,KAAK,CAACuhB,MAAD,EAASjhB,UAAU,EAAnB,CAAL;AACAzoC,IAAAA,GAAG,CAAC0pD,MAAD,EAAS,KAAK/gB,gBAAgB,EAA9B,EAAkCU,GAAlC,CAAH;AACArpC,IAAAA,GAAG,CAAC0pD,MAAD,EAAS,KAAKhhB,cAAc,EAA5B,EAAgCG,cAAhC,CAAH;;AACA,QAAI8gB,EAAE,GAAGH,QAAQ,CAACngB,GAAD,EAAMhgC,IAAN,CAAjB;AAAA,QAA8BugD,EAAE,GAAGD,EAAE,CAACnpD,UAAtC;AAAA,QAAkDA,UAAU,GAAGopD,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EAApF;AAAA,QAAwFC,EAAE,GAAGF,EAAE,CAACle,OAAhG;AAAA,QAAyGA,OAAO,GAAGoe,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EAAxI;;AACA5pD,IAAAA,MAAM,CAACypD,MAAD,EAASlpD,UAAT,CAAN;AACAgrC,IAAAA,KAAK,CAACke,MAAD,EAASje,OAAT,CAAL;AACA,WAAOie,MAAP;AACD,GAVD;;AAWA,MAAII,QAAQ,GAAG,UAAUj7C,MAAV,EAAkBi6B,GAAlB,EAAuBD,cAAvB,EAAuC2gB,QAAvC,EAAiDngD,IAAjD,EAAuD;AACpE,QAAI0gD,WAAW,GAAG,EAAlB;AACA,QAAIL,MAAM,GAAGJ,cAAc,CAACz6C,MAAM,CAACm7C,MAAP,EAAD,EAAkB3gD,IAAlB,EAAwBw/B,cAAxB,EAAwC2gB,QAAxC,CAA3B;AACA,QAAIpvD,OAAO,GAAGgqC,IAAI,CAAC1iD,QAAQ,CAACrC,IAAT,EAAD,CAAlB;;AACA,QAAI4qE,aAAa,GAAG,YAAY;AAC9B7vD,MAAAA,OAAO,CAAC4F,GAAR,CAAYte,QAAQ,CAACrC,IAAT,EAAZ;AACD,KAFD;;AAGA,QAAI6qE,gBAAgB,GAAG,YAAY;AACjC,aAAO9vD,OAAO,CAAC5V,GAAR,GAActE,UAAd,CAAyB,YAAY;AAC1C,YAAI4J,EAAE,GAAG2oB,OAAO,CAACi3C,MAAD,CAAhB;AACAK,QAAAA,WAAW,CAAClnE,IAAZ,CAAiBiH,EAAjB;AACAsQ,QAAAA,OAAO,CAAC4F,GAAR,CAAYte,QAAQ,CAACR,IAAT,CAAc4I,EAAd,CAAZ;AACA,eAAOA,EAAP;AACD,OALM,CAAP;AAMD,KAPD;;AAQA,QAAIqgE,eAAe,GAAG,UAAUr0B,KAAV,EAAiB;AACrCr1C,MAAAA,IAAI,CAACq1C,KAAD,EAAQs0B,cAAR,CAAJ;AACD,KAFD;;AAGA,QAAIA,cAAc,GAAG,UAAUl1D,IAAV,EAAgB;AACnC,UAAIm1D,GAAG,GAAGl8B,OAAO,CAACtf,MAAD,EAAS3Z,IAAT,EAAe,MAAf,EAAuBvZ,IAAI,CAACuZ,IAAD,CAA3B,CAAjB;;AACA,cAAQm1D,GAAR;AACA,aAAK,eAAL;AAAsB;AAClBJ,YAAAA,aAAa;AACb,gBAAIpvD,UAAU,GAAGjD,QAAQ,CAAC1C,IAAD,CAAzB;AACAi1D,YAAAA,eAAe,CAACtvD,UAAD,CAAf;AACAovD,YAAAA,aAAa;AACb;AACD;;AACH,aAAK,OAAL;AAAc;AACV,gBAAI5rB,CAAC,GAAG6rB,gBAAgB,EAAxB;AACA/vD,YAAAA,IAAI,CAACjF,IAAD,EAAOmpC,CAAP,CAAJ;AACA;AACD;AAZH;AAcD,KAhBD;;AAiBA,QAAIisB,YAAY,GAAG,UAAU5oD,KAAV,EAAiB;AAClC,UAAIo0B,KAAK,GAAGt1C,GAAG,CAACkhB,KAAD,EAAQzN,YAAY,CAACX,OAArB,CAAf;AACA62D,MAAAA,eAAe,CAACr0B,KAAD,CAAf;AACD,KAHD;;AAIA+wB,IAAAA,MAAM,CAACh4C,MAAM,CAAChb,GAAR,EAAai1C,GAAb,EAAkB,UAAUpnC,KAAV,EAAiB;AACvCuoD,MAAAA,aAAa;AACbK,MAAAA,YAAY,CAAC5oD,KAAD,CAAZ;AACD,KAHK,CAAN;AAIA,WAAOqoD,WAAP;AACD,GA5CD;;AA6CA,MAAIQ,oBAAoB,GAAG,UAAU17C,MAAV,EAAkBlzB,IAAlB,EAAwBwzB,QAAxB,EAAkC9F,IAAlC,EAAwC;AACjEwF,IAAAA,MAAM,CAAC27C,WAAP,CAAmBC,QAAnB,CAA4B,YAAY;AACtC,UAAI1hB,SAAS,GAAGl6B,MAAM,CAACk6B,SAAvB;AACA,UAAI2hB,UAAU,GAAG3hB,SAAS,CAACC,MAAV,EAAjB;AACA,UAAI2hB,gBAAgB,GAAG5C,kBAAkB,CAACl5C,MAAD,CAAlB,CAA2BhyB,MAA3B,GAAoC,CAA3D;;AACA,UAAI6tE,UAAU,CAAC7W,SAAX,IAAwB,CAAC8W,gBAA7B,EAA+C;AAC7CtB,QAAAA,aAAa,CAACx6C,MAAD,EAAS67C,UAAT,CAAb;AACD;;AACD,UAAI3hB,SAAS,CAACC,MAAV,GAAmB6K,SAAnB,IAAgC,CAAC8W,gBAArC,EAAuD;AACrD,YAAIvwD,OAAO,GAAGkvD,cAAc,CAACz6C,MAAM,CAACm7C,MAAP,EAAD,EAAkB3gD,IAAlB,EAAwB1tB,IAAxB,EAA8BwzB,QAAQ,CAACq6C,QAAvC,CAA5B;AACA5d,QAAAA,KAAK,CAACxxC,OAAD,EAAUia,IAAV,CAAL;AACA00B,QAAAA,SAAS,CAACC,MAAV,GAAmBoI,UAAnB,CAA8Bh3C,OAAO,CAACvG,GAAtC;AACAk1C,QAAAA,SAAS,CAACne,MAAV,CAAiBxwB,OAAO,CAACvG,GAAzB;AACD,OALD,MAKO;AACLg1D,QAAAA,QAAQ,CAAC9f,SAAD,EAAY,KAAZ,EAAmB,YAAY;AACrC0f,UAAAA,WAAW,CAAC55C,MAAD,EAAS,UAAU+7C,YAAV,EAAwB;AAC1Cd,YAAAA,QAAQ,CAACj7C,MAAD,EAAS+7C,YAAT,EAAuBjvE,IAAvB,EAA6BwzB,QAAQ,CAACq6C,QAAtC,EAAgDngD,IAAhD,CAAR;AACD,WAFU,CAAX;AAGD,SAJO,CAAR;AAKD;AACF,KAnBD;AAoBD,GArBD;;AAuBA,MAAIwhD,SAAS,GAAG,UAAUh8C,MAAV,EAAkB;AAChC,QAAI87B,QAAQ,GAAGO,QAAQ,EAAvB;AACAR,IAAAA,OAAO,CAAC77B,MAAD,EAAS87B,QAAT,CAAP;AACA,QAAImgB,OAAO,GAAGlhB,KAAK,CAAC/6B,MAAD,CAAnB;AACA,WAAO;AACLs8B,MAAAA,QAAQ,EAAE,UAAUxvD,IAAV,EAAgBwzB,QAAhB,EAA0B;AAClCw7B,QAAAA,QAAQ,CAACQ,QAAT,CAAkBxvD,IAAlB,EAAwBwzB,QAAxB;AACD,OAHI;AAIL26C,MAAAA,QAAQ,EAAE,UAAUnuE,IAAV,EAAgB0tB,IAAhB,EAAsB;AAC9BshC,QAAAA,QAAQ,CAACp3B,MAAT,CAAgB53B,IAAhB,EAAsB8E,IAAtB,CAA2B,UAAU0uB,QAAV,EAAoB;AAC7Co7C,UAAAA,oBAAoB,CAAC17C,MAAD,EAASlzB,IAAT,EAAewzB,QAAf,EAAyB9F,IAAzB,CAApB;AACD,SAFD;AAGD,OARI;AASL0hD,MAAAA,iBAAiB,EAAE,UAAUpvE,IAAV,EAAgB6K,QAAhB,EAA0B;AAC3CskE,QAAAA,OAAO,CAAClmD,WAAR,CAAoBjpB,IAApB,EAA0B6K,QAA1B;AACD,OAXI;AAYLkU,MAAAA,MAAM,EAAE,UAAU/e,IAAV,EAAgB;AACtBitD,QAAAA,QAAQ,CAAC/5B,MAAD,EAASntB,QAAQ,CAACR,IAAT,CAAcvF,IAAd,CAAT,CAAR,CAAsC8E,IAAtC,CAA2C,UAAUgqD,EAAV,EAAc;AACvD,cAAI9yC,QAAQ,GAAG8yC,EAAE,CAAC9yC,QAAlB;AACAlX,UAAAA,IAAI,CAACkX,QAAD,EAAWiD,MAAX,CAAJ;AACD,SAHD;AAID,OAjBI;AAkBLowD,MAAAA,MAAM,EAAE,UAAUrvE,IAAV,EAAgB;AACtB,YAAI+tD,SAAS,GAAGF,OAAO,CAAC36B,MAAD,EAASlzB,IAAT,CAAvB;AACA,eAAOuJ,KAAK,CAACwkD,SAAD,EAAY,UAAU5T,KAAV,EAAiB;AACvC,iBAAOt1C,GAAG,CAACs1C,KAAD,EAAQ,UAAU5gC,IAAV,EAAgB;AAChC,mBAAOA,IAAI,CAACrB,GAAZ;AACD,WAFS,CAAV;AAGD,SAJW,CAAZ;AAKD;AAzBI,KAAP;AA2BD,GA/BD;;AAiCA,MAAIo3D,eAAe,GAAG,UAAUliB,SAAV,EAAqB;AACzC,WAAO;AACLoL,MAAAA,WAAW,EAAE11D,KAAK,CAACsjE,aAAD,EAAgBhZ,SAAhB,CADb;AAELkL,MAAAA,cAAc,EAAEx1D,KAAK,CAACw1D,cAAD,EAAiBlL,SAAjB;AAFhB,KAAP;AAID,GALD;;AAMAkiB,EAAAA,eAAe,CAACnyC,cAAhB,GAAiCmpC,gBAAjC;;AAEA,MAAIiJ,sBAAsB,GAAG,UAAUl6D,IAAV,EAAgByC,IAAhB,EAAsB;AACjD,WAAOA,IAAI,IAAIA,IAAI,KAAKzC,IAAxB,EAA8B;AAC5B,UAAIwO,qBAAqB,CAAC/L,IAAD,CAArB,IAA+BgM,sBAAsB,CAAChM,IAAD,CAAzD,EAAiE;AAC/D,eAAOA,IAAP;AACD;;AACDA,MAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,WAAO,IAAP;AACD,GARD;;AAUA,MAAIg0D,eAAe,GAAG,UAAUxjC,OAAV,EAAmBG,OAAnB,EAA4Bj4B,KAA5B,EAAmC;AACvD,QAAIA,KAAK,CAACgkD,SAAV,EAAqB;AACnB,aAAO,KAAP;AACD;;AACD,QAAIvkD,GAAG,CAACjH,OAAJ,CAAY2E,IAAZ,MAAsB6C,KAAK,CAAC8yC,WAAN,KAAsB9yC,KAAK,CAACgzC,SAAN,GAAkB,CAA9D,IAAmEhzC,KAAK,CAAC4mB,cAAN,KAAyB5mB,KAAK,CAAC+yC,YAAtG,EAAoH;AAClH,UAAIhhC,GAAG,GAAG/R,KAAK,CAAC4mB,cAAN,CAAqBtjB,UAArB,CAAgCtD,KAAK,CAAC8yC,WAAtC,CAAV;;AACA,UAAI7kC,WAAW,CAAC8D,GAAD,CAAf,EAAsB;AACpB,eAAOjhB,MAAM,CAACihB,GAAG,CAACsuC,cAAJ,EAAD,EAAuB,UAAU7C,IAAV,EAAgB;AAClD,iBAAOY,UAAU,CAACZ,IAAD,EAAO1lB,OAAP,EAAgBG,OAAhB,CAAjB;AACD,SAFY,CAAb;AAGD;AACF;;AACD,WAAOnnC,MAAM,CAACkP,KAAK,CAACqgD,cAAN,EAAD,EAAyB,UAAU7C,IAAV,EAAgB;AACpD,aAAOY,UAAU,CAACZ,IAAD,EAAO1lB,OAAP,EAAgBG,OAAhB,CAAjB;AACD,KAFY,CAAb;AAGD,GAfD;;AAiBA,MAAIsjC,cAAc,GAAG,UAAUv8C,MAAV,EAAkB/wB,IAAlB,EAAwB;AAC3C,WAAO+wB,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0BlsC,IAA1B,CAAP;AACD,GAFD;;AAGA,MAAIutE,eAAe,GAAG,UAAUx8C,MAAV,EAAkB/wB,IAAlB,EAAwB;AAC5C,WAAO+wB,MAAM,CAACmb,IAAP,CAAY,aAAZ,EAA2BlsC,IAA3B,CAAP;AACD,GAFD;;AAGA,MAAIwtE,UAAU,GAAG,UAAUz8C,MAAV,EAAkB;AACjC,WAAOA,MAAM,CAACmb,IAAP,CAAY,QAAZ,CAAP;AACD,GAFD;;AAGA,MAAIuhC,UAAU,GAAG,UAAU18C,MAAV,EAAkB;AACjC,WAAOA,MAAM,CAACmb,IAAP,CAAY,QAAZ,CAAP;AACD,GAFD;;AAGA,MAAIwhC,cAAc,GAAG,UAAU38C,MAAV,EAAkB8N,IAAlB,EAAwB;AAC3C,WAAO9N,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0B;AAAErN,MAAAA,IAAI,EAAEA;AAAR,KAA1B,CAAP;AACD,GAFD;;AAGA,MAAI8uC,qBAAqB,GAAG,UAAU58C,MAAV,EAAkB5iB,MAAlB,EAA0B6Q,KAA1B,EAAiCC,MAAjC,EAAyC2uD,MAAzC,EAAiD;AAC3E78C,IAAAA,MAAM,CAACmb,IAAP,CAAY,mBAAZ,EAAiC;AAC/B/9B,MAAAA,MAAM,EAAEA,MADuB;AAE/B6Q,MAAAA,KAAK,EAAEA,KAFwB;AAG/BC,MAAAA,MAAM,EAAEA,MAHuB;AAI/B2uD,MAAAA,MAAM,EAAEA;AAJuB,KAAjC;AAMD,GAPD;;AAQA,MAAIC,iBAAiB,GAAG,UAAU98C,MAAV,EAAkB5iB,MAAlB,EAA0B6Q,KAA1B,EAAiCC,MAAjC,EAAyC2uD,MAAzC,EAAiD;AACvE78C,IAAAA,MAAM,CAACmb,IAAP,CAAY,eAAZ,EAA6B;AAC3B/9B,MAAAA,MAAM,EAAEA,MADmB;AAE3B6Q,MAAAA,KAAK,EAAEA,KAFoB;AAG3BC,MAAAA,MAAM,EAAEA,MAHmB;AAI3B2uD,MAAAA,MAAM,EAAEA;AAJmB,KAA7B;AAMD,GAPD;;AAQA,MAAIE,WAAW,GAAG,UAAU/8C,MAAV,EAAkB;AAClC,WAAOA,MAAM,CAACmb,IAAP,CAAY,SAAZ,CAAP;AACD,GAFD;;AAGA,MAAI6hC,cAAc,GAAG,UAAUh9C,MAAV,EAAkB;AACrC,WAAOA,MAAM,CAACmb,IAAP,CAAY,YAAZ,CAAP;AACD,GAFD;;AAGA,MAAI8hC,QAAQ,GAAG,UAAUj9C,MAAV,EAAkB;AAC/B,WAAOA,MAAM,CAACmb,IAAP,CAAY,MAAZ,CAAP;AACD,GAFD;;AAGA,MAAI+hC,qBAAqB,GAAG,UAAUl9C,MAAV,EAAkBwB,KAAlB,EAAyB;AACnD,WAAOxB,MAAM,CAACmb,IAAP,CAAY,mBAAZ,EAAiC;AAAE3Z,MAAAA,KAAK,EAAEA;AAAT,KAAjC,CAAP;AACD,GAFD;;AAGA,MAAI27C,SAAS,GAAG,UAAUn9C,MAAV,EAAkBo9C,SAAlB,EAA6B54D,KAA7B,EAAoC;AAClD,WAAOwb,MAAM,CAACmb,IAAP,CAAYiiC,SAAZ,EAAuB54D,KAAvB,CAAP;AACD,GAFD;;AAIA,MAAI64D,EAAE,GAAG;AACPC,IAAAA,SAAS,EAAE,CADJ;AAEPC,IAAAA,MAAM,EAAE,EAFD;AAGPC,IAAAA,IAAI,EAAE,EAHC;AAIPC,IAAAA,KAAK,EAAE,EAJA;AAKPC,IAAAA,IAAI,EAAE,EALC;AAMPC,IAAAA,KAAK,EAAE,EANA;AAOPC,IAAAA,QAAQ,EAAE,EAPH;AAQPC,IAAAA,GAAG,EAAE,CARE;AASPC,IAAAA,EAAE,EAAE,EATG;AAUPC,IAAAA,GAAG,EAAE,EAVE;AAWPC,IAAAA,IAAI,EAAE,EAXC;AAYPC,IAAAA,eAAe,EAAE,UAAUplE,CAAV,EAAa;AAC5B,aAAOA,CAAC,CAACqlE,QAAF,IAAcrlE,CAAC,CAACslE,OAAhB,IAA2BtlE,CAAC,CAACulE,MAA7B,IAAuCf,EAAE,CAACgB,cAAH,CAAkBxlE,CAAlB,CAA9C;AACD,KAdM;AAePwlE,IAAAA,cAAc,EAAE,UAAUxlE,CAAV,EAAa;AAC3B,aAAO4H,GAAG,CAACE,GAAJ,GAAU9H,CAAC,CAAC4gC,OAAZ,GAAsB5gC,CAAC,CAACslE,OAAF,IAAa,CAACtlE,CAAC,CAACulE,MAA7C;AACD;AAjBM,GAAT;AAoBA,MAAIE,wBAAwB,GAAG1tD,sBAA/B;;AACA,MAAI2tD,gBAAgB,GAAG,UAAUrkB,SAAV,EAAqBl6B,MAArB,EAA6B;AAClD,QAAIw+C,oBAAoB,GAAG,mBAA3B;AACA,QAAIx5D,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AAAA,QAAsBxN,MAAM,GAAGkM,KAAK,CAAC9R,IAArC;AACA,QAAI6sE,WAAJ,EAAiBC,gBAAjB,EAAmCC,YAAnC,EAAiDC,cAAjD,EAAiEC,cAAjE;AACA,QAAIC,MAAJ,EAAYC,MAAZ,EAAoBC,YAApB,EAAkCC,YAAlC,EAAgDC,MAAhD,EAAwDC,MAAxD,EAAgEC,KAAhE,EAAuEC,aAAvE;AACA,QAAIpxD,KAAJ,EAAWC,MAAX;AACA,QAAIoxD,WAAW,GAAGt/C,MAAM,CAACm7C,MAAP,EAAlB;AAAA,QAAmCoE,YAAY,GAAGp+D,QAAlD;AACA,QAAIq+D,GAAG,GAAG9wD,IAAI,CAAC8wD,GAAf;AAAA,QAAoBlhB,KAAK,GAAG5vC,IAAI,CAAC4vC,KAAjC;AAAA,QAAwCv1B,WAAW,GAAG/I,MAAM,CAACo6B,OAAP,EAAtD;AACA,QAAIqlB,gBAAJ,EAAsBC,iBAAtB;AACA,QAAIC,aAAa,GAAG;AAClBC,MAAAA,EAAE,EAAE,CACF,CADE,EAEF,CAFE,EAGF,CAAC,CAHC,EAIF,CAAC,CAJC,CADc;AAOlBC,MAAAA,EAAE,EAAE,CACF,CADE,EAEF,CAFE,EAGF,CAHE,EAIF,CAAC,CAJC,CAPc;AAalBC,MAAAA,EAAE,EAAE,CACF,CADE,EAEF,CAFE,EAGF,CAHE,EAIF,CAJE,CAbc;AAmBlBC,MAAAA,EAAE,EAAE,CACF,CADE,EAEF,CAFE,EAGF,CAAC,CAHC,EAIF,CAJE;AAnBc,KAApB;;AA0BA,QAAIC,OAAO,GAAG,UAAUjtD,GAAV,EAAe;AAC3B,aAAOA,GAAG,KAAKA,GAAG,CAACtL,QAAJ,KAAiB,KAAjB,IAA0BuY,MAAM,CAAChb,GAAP,CAAW9T,EAAX,CAAc6hB,GAAd,EAAmB,cAAnB,CAA/B,CAAV;AACD,KAFD;;AAGA,QAAIq4C,SAAS,GAAG,UAAUr4C,GAAV,EAAe;AAC7B,aAAOjC,OAAO,CAACiC,GAAD,CAAP,IAAgB/N,GAAG,CAACykC,QAAJ,CAAa12B,GAAb,EAAkB,oBAAlB,CAAvB;AACD,KAFD;;AAGA,QAAIktD,0BAA0B,GAAG,UAAUxlC,GAAV,EAAez5B,KAAf,EAAsB;AACrD,UAAIy5B,GAAG,CAACznC,IAAJ,KAAa,WAAb,IAA4BynC,GAAG,CAACznC,IAAJ,CAAS/F,OAAT,CAAiB,OAAjB,MAA8B,CAA9D,EAAiE;AAC/D,YAAIizE,KAAK,GAAGzlC,GAAG,CAAC0lC,OAAJ,CAAY,CAAZ,CAAZ;AACA,eAAOH,OAAO,CAACvlC,GAAG,CAACr9B,MAAL,CAAP,IAAuB,CAACk/D,eAAe,CAAC4D,KAAK,CAACpnC,OAAP,EAAgBonC,KAAK,CAACjnC,OAAtB,EAA+Bj4B,KAA/B,CAA9C;AACD,OAHD,MAGO;AACL,eAAOg/D,OAAO,CAACvlC,GAAG,CAACr9B,MAAL,CAAP,IAAuB,CAACk/D,eAAe,CAAC7hC,GAAG,CAAC3B,OAAL,EAAc2B,GAAG,CAACxB,OAAlB,EAA2Bj4B,KAA3B,CAA9C;AACD;AACF,KAPD;;AAQA,QAAIo/D,sBAAsB,GAAG,UAAU3lC,GAAV,EAAe;AAC1C,UAAIr9B,MAAM,GAAGq9B,GAAG,CAACr9B,MAAjB;;AACA,UAAI6iE,0BAA0B,CAACxlC,GAAD,EAAMza,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAN,CAA1B,IAA8D,CAAC1f,GAAG,CAAC1C,kBAAJ,EAAnE,EAA6F;AAC3F/X,QAAAA,MAAM,CAACk6B,SAAP,CAAiBne,MAAjB,CAAwB3+B,MAAxB;AACD;AACF,KALD;;AAMA,QAAIijE,gBAAgB,GAAG,UAAUttD,GAAV,EAAe;AACpC,UAAI/N,GAAG,CAAC9T,EAAJ,CAAO6hB,GAAP,EAAY,cAAZ,CAAJ,EAAiC;AAC/B,eAAO,CAACA,GAAG,CAACjM,aAAJ,CAAkB,KAAlB,CAAD,CAAP;AACD,OAFD,MAEO,IAAI9B,GAAG,CAACykC,QAAJ,CAAa12B,GAAb,EAAkB,oBAAlB,KAA2Crf,aAAa,CAACqf,GAAG,CAACutD,iBAAL,CAA5D,EAAqF;AAC1F,eAAO,CACLvtD,GADK,EAELA,GAAG,CAACutD,iBAFC,CAAP;AAID,OALM,MAKA;AACL,eAAO,CAACvtD,GAAD,CAAP;AACD;AACF,KAXD;;AAYA,QAAIwtD,WAAW,GAAG,UAAUxtD,GAAV,EAAe;AAC/B,UAAI5M,QAAQ,GAAGgiD,iBAAiB,CAACnoC,MAAD,CAAhC;;AACA,UAAI,CAAC7Z,QAAL,EAAe;AACb,eAAO,KAAP;AACD;;AACD,UAAI4M,GAAG,CAACjD,YAAJ,CAAiB,iBAAjB,MAAwC,OAA5C,EAAqD;AACnD,eAAO,KAAP;AACD;;AACD,UAAIiD,GAAG,KAAKiN,MAAM,CAACo6B,OAAP,EAAZ,EAA8B;AAC5B,eAAO,KAAP;AACD;;AACD,UAAIp1C,GAAG,CAACykC,QAAJ,CAAa12B,GAAb,EAAkB,oBAAlB,CAAJ,EAA6C;AAC3C,eAAO9M,IAAI,CAACb,YAAY,CAACX,OAAb,CAAqBsO,GAAG,CAACutD,iBAAzB,CAAD,EAA8Cn6D,QAA9C,CAAX;AACD,OAFD,MAEO;AACL,eAAOF,IAAI,CAACb,YAAY,CAACX,OAAb,CAAqBsO,GAArB,CAAD,EAA4B5M,QAA5B,CAAX;AACD;AACF,KAhBD;;AAiBA,QAAIq6D,kBAAkB,GAAG,UAAUztD,GAAV,EAAe;AACtC,UAAIq4C,SAAS,CAACr4C,GAAD,CAAb,EAAoB;AAClB,eAAO/N,GAAG,CAAC9C,MAAJ,CAAW,KAAX,EAAkB;AAAEurC,UAAAA,GAAG,EAAEhtC,GAAG,CAACK;AAAX,SAAlB,CAAP;AACD,OAFD,MAEO;AACL,eAAOiS,GAAG,CAAC82B,SAAJ,CAAc,IAAd,CAAP;AACD;AACF,KAND;;AAOA,QAAI42B,WAAW,GAAG,UAAUv6D,OAAV,EAAmBpZ,IAAnB,EAAyB4C,KAAzB,EAAgC;AAChD,UAAIgE,aAAa,CAAChE,KAAD,CAAjB,EAA0B;AACxB,YAAIgxE,OAAO,GAAGL,gBAAgB,CAACn6D,OAAD,CAA9B;AACAtU,QAAAA,IAAI,CAAC8uE,OAAD,EAAU,UAAUtjE,MAAV,EAAkB;AAC9B,cAAIA,MAAM,CAAC4T,KAAP,CAAalkB,IAAb,KAAsB,CAACkzB,MAAM,CAAC8M,MAAP,CAAcwH,OAAd,CAAsBl3B,MAAM,CAACqK,QAAP,CAAgBpM,WAAhB,EAAtB,EAAqDvO,IAArD,CAA3B,EAAuF;AACrFkY,YAAAA,GAAG,CAAC2qC,QAAJ,CAAavyC,MAAb,EAAqBtQ,IAArB,EAA2B4C,KAA3B;AACD,WAFD,MAEO;AACLsV,YAAAA,GAAG,CAAC8pC,SAAJ,CAAc1xC,MAAd,EAAsBtQ,IAAtB,EAA4B,KAAK4C,KAAjC;AACD;AACF,SANG,CAAJ;AAOD;AACF,KAXD;;AAYA,QAAIixE,eAAe,GAAG,UAAUC,QAAV,EAAoB3yD,KAApB,EAA2BC,MAA3B,EAAmC;AACvDuyD,MAAAA,WAAW,CAACG,QAAD,EAAW,OAAX,EAAoB3yD,KAApB,CAAX;AACAwyD,MAAAA,WAAW,CAACG,QAAD,EAAW,QAAX,EAAqB1yD,MAArB,CAAX;AACD,KAHD;;AAIA,QAAI2yD,kBAAkB,GAAG,UAAUhoE,CAAV,EAAa;AACpC,UAAIioE,MAAJ,EAAYC,MAAZ,EAAoBC,YAApB;AACA,UAAIC,aAAJ,EAAmBC,aAAnB;AACAJ,MAAAA,MAAM,GAAGjoE,CAAC,CAACsoE,OAAF,GAAYrC,MAArB;AACAiC,MAAAA,MAAM,GAAGloE,CAAC,CAACuoE,OAAF,GAAYrC,MAArB;AACA9wD,MAAAA,KAAK,GAAG6yD,MAAM,GAAGlC,cAAc,CAAC,CAAD,CAAvB,GAA6BM,MAArC;AACAhxD,MAAAA,MAAM,GAAG6yD,MAAM,GAAGnC,cAAc,CAAC,CAAD,CAAvB,GAA6BO,MAAtC;AACAlxD,MAAAA,KAAK,GAAGA,KAAK,GAAG,CAAR,GAAY,CAAZ,GAAgBA,KAAxB;AACAC,MAAAA,MAAM,GAAGA,MAAM,GAAG,CAAT,GAAa,CAAb,GAAiBA,MAA1B;;AACA,UAAI,CAAC8xD,OAAO,CAACvB,WAAD,CAAP,IAAwBrT,SAAS,CAACqT,WAAD,CAAlC,KAAoDrW,wBAAwB,CAACpoC,MAAD,CAAxB,KAAqC,KAA7F,EAAoG;AAClGghD,QAAAA,YAAY,GAAG,CAAC3D,EAAE,CAACY,eAAH,CAAmBplE,CAAnB,CAAhB;AACD,OAFD,MAEO;AACLmoE,QAAAA,YAAY,GAAG3D,EAAE,CAACY,eAAH,CAAmBplE,CAAnB,CAAf;AACD;;AACD,UAAImoE,YAAJ,EAAkB;AAChB,YAAIxB,GAAG,CAACsB,MAAD,CAAH,GAActB,GAAG,CAACuB,MAAD,CAArB,EAA+B;AAC7B7yD,UAAAA,MAAM,GAAGowC,KAAK,CAACrwC,KAAK,GAAGmxD,KAAT,CAAd;AACAnxD,UAAAA,KAAK,GAAGqwC,KAAK,CAACpwC,MAAM,GAAGkxD,KAAV,CAAb;AACD,SAHD,MAGO;AACLnxD,UAAAA,KAAK,GAAGqwC,KAAK,CAACpwC,MAAM,GAAGkxD,KAAV,CAAb;AACAlxD,UAAAA,MAAM,GAAGowC,KAAK,CAACrwC,KAAK,GAAGmxD,KAAT,CAAd;AACD;AACF;;AACDuB,MAAAA,eAAe,CAACjC,gBAAD,EAAmBzwD,KAAnB,EAA0BC,MAA1B,CAAf;AACA+yD,MAAAA,aAAa,GAAGrC,cAAc,CAAC1O,QAAf,CAAwB3jE,CAAxB,GAA4Bu0E,MAA5C;AACAI,MAAAA,aAAa,GAAGtC,cAAc,CAAC1O,QAAf,CAAwBtiE,CAAxB,GAA4BmzE,MAA5C;AACAE,MAAAA,aAAa,GAAGA,aAAa,GAAG,CAAhB,GAAoBA,aAApB,GAAoC,CAApD;AACAC,MAAAA,aAAa,GAAGA,aAAa,GAAG,CAAhB,GAAoBA,aAApB,GAAoC,CAApD;AACAl8D,MAAAA,GAAG,CAAC6qC,SAAJ,CAAc8uB,YAAd,EAA4B;AAC1BxyD,QAAAA,IAAI,EAAE80D,aADoB;AAE1B70D,QAAAA,GAAG,EAAE80D,aAFqB;AAG1BG,QAAAA,OAAO,EAAE;AAHiB,OAA5B;AAKA1C,MAAAA,YAAY,CAACv6D,SAAb,GAAyB6J,KAAK,GAAG,WAAR,GAAsBC,MAA/C;;AACA,UAAI0wD,cAAc,CAAC,CAAD,CAAd,GAAoB,CAApB,IAAyBF,gBAAgB,CAACnwD,WAAjB,IAAgCN,KAA7D,EAAoE;AAClEjJ,QAAAA,GAAG,CAAC2qC,QAAJ,CAAa+uB,gBAAb,EAA+B,MAA/B,EAAuCM,YAAY,IAAIE,MAAM,GAAGjxD,KAAb,CAAnD;AACD;;AACD,UAAI2wD,cAAc,CAAC,CAAD,CAAd,GAAoB,CAApB,IAAyBF,gBAAgB,CAAClwD,YAAjB,IAAiCN,MAA9D,EAAsE;AACpElJ,QAAAA,GAAG,CAAC2qC,QAAJ,CAAa+uB,gBAAb,EAA+B,KAA/B,EAAsCO,YAAY,IAAIE,MAAM,GAAGjxD,MAAb,CAAlD;AACD;;AACD4yD,MAAAA,MAAM,GAAG/3C,WAAW,CAACu4C,WAAZ,GAA0B7B,gBAAnC;AACAsB,MAAAA,MAAM,GAAGh4C,WAAW,CAACw4C,YAAZ,GAA2B7B,iBAApC;;AACA,UAAIoB,MAAM,GAAGC,MAAT,KAAoB,CAAxB,EAA2B;AACzB/7D,QAAAA,GAAG,CAAC6qC,SAAJ,CAAc8uB,YAAd,EAA4B;AAC1BxyD,UAAAA,IAAI,EAAE80D,aAAa,GAAGH,MADI;AAE1B10D,UAAAA,GAAG,EAAE80D,aAAa,GAAGH;AAFK,SAA5B;AAID;;AACD,UAAI,CAAC1B,aAAL,EAAoB;AAClBzC,QAAAA,qBAAqB,CAAC58C,MAAD,EAASy+C,WAAT,EAAsBS,MAAtB,EAA8BC,MAA9B,EAAsC,YAAYP,cAAc,CAAC9xE,IAAjE,CAArB;AACAuyE,QAAAA,aAAa,GAAG,IAAhB;AACD;AACF,KApDD;;AAqDA,QAAImC,cAAc,GAAG,YAAY;AAC/B,UAAIC,gBAAgB,GAAGpC,aAAvB;AACAA,MAAAA,aAAa,GAAG,KAAhB;;AACA,UAAIoC,gBAAJ,EAAsB;AACpBhB,QAAAA,WAAW,CAAChC,WAAD,EAAc,OAAd,EAAuBxwD,KAAvB,CAAX;AACAwyD,QAAAA,WAAW,CAAChC,WAAD,EAAc,QAAd,EAAwBvwD,MAAxB,CAAX;AACD;;AACDlJ,MAAAA,GAAG,CAACg2B,MAAJ,CAAWskC,WAAX,EAAwB,WAAxB,EAAqCuB,kBAArC;AACA77D,MAAAA,GAAG,CAACg2B,MAAJ,CAAWskC,WAAX,EAAwB,SAAxB,EAAmCkC,cAAnC;;AACA,UAAIjC,YAAY,KAAKD,WAArB,EAAkC;AAChCt6D,QAAAA,GAAG,CAACg2B,MAAJ,CAAWukC,YAAX,EAAyB,WAAzB,EAAsCsB,kBAAtC;AACA77D,QAAAA,GAAG,CAACg2B,MAAJ,CAAWukC,YAAX,EAAyB,SAAzB,EAAoCiC,cAApC;AACD;;AACDx8D,MAAAA,GAAG,CAAC6G,MAAJ,CAAW6yD,gBAAX;AACA15D,MAAAA,GAAG,CAAC6G,MAAJ,CAAW8yD,YAAX;AACA35D,MAAAA,GAAG,CAAC6G,MAAJ,CAAWgzD,cAAX;AACA6C,MAAAA,cAAc,CAACjD,WAAD,CAAd;;AACA,UAAIgD,gBAAJ,EAAsB;AACpB3E,QAAAA,iBAAiB,CAAC98C,MAAD,EAASy+C,WAAT,EAAsBxwD,KAAtB,EAA6BC,MAA7B,EAAqC,YAAY0wD,cAAc,CAAC9xE,IAAhE,CAAjB;AACAkY,QAAAA,GAAG,CAAC8pC,SAAJ,CAAc2vB,WAAd,EAA2B,OAA3B,EAAoCz5D,GAAG,CAAC2pC,SAAJ,CAAc8vB,WAAd,EAA2B,OAA3B,CAApC;AACD;;AACDz+C,MAAAA,MAAM,CAAC2hD,WAAP;AACD,KAtBD;;AAuBA,QAAID,cAAc,GAAG,UAAUE,SAAV,EAAqB;AACxCC,MAAAA,wBAAwB;AACxB,UAAIrR,QAAQ,GAAGxrD,GAAG,CAACsO,MAAJ,CAAWsuD,SAAX,EAAsB74C,WAAtB,CAAf;AACA,UAAIi2C,YAAY,GAAGxO,QAAQ,CAACjkE,CAA5B;AACA,UAAI0yE,YAAY,GAAGzO,QAAQ,CAAC5iE,CAA5B;AACA,UAAI4wD,IAAI,GAAGojB,SAAS,CAACn1D,qBAAV,EAAX;AACA,UAAIq1D,WAAW,GAAGtjB,IAAI,CAACvwC,KAAL,IAAcuwC,IAAI,CAACrwC,KAAL,GAAaqwC,IAAI,CAACryC,IAAlD;AACA,UAAI41D,YAAY,GAAGvjB,IAAI,CAACtwC,MAAL,IAAeswC,IAAI,CAACpwC,MAAL,GAAcowC,IAAI,CAACpyC,GAArD;;AACA,UAAIqyD,WAAW,KAAKmD,SAApB,EAA+B;AAC7BI,QAAAA,cAAc;AACdvD,QAAAA,WAAW,GAAGmD,SAAd;AACA3zD,QAAAA,KAAK,GAAGC,MAAM,GAAG,CAAjB;AACD;;AACD,UAAIrV,CAAC,GAAGmnB,MAAM,CAACmb,IAAP,CAAY,gBAAZ,EAA8B;AAAE/9B,QAAAA,MAAM,EAAEwkE;AAAV,OAA9B,CAAR;AACA,UAAIK,aAAa,GAAGj9D,GAAG,CAAC2pC,SAAJ,CAAc8vB,WAAd,EAA2BD,oBAA3B,EAAiD,GAAjD,CAApB;;AACA,UAAI+B,WAAW,CAACqB,SAAD,CAAX,IAA0B,CAAC/oE,CAAC,CAACk/B,kBAAF,EAA/B,EAAuD;AACrDvgC,QAAAA,MAAM,CAACmoE,aAAD,EAAgB,UAAUroD,MAAV,EAAkBxqB,IAAlB,EAAwB;AAC5C,cAAIo1E,SAAJ;;AACA,cAAIC,SAAS,GAAG,UAAUtpE,CAAV,EAAa;AAC3B,gBAAIuE,MAAM,GAAGijE,gBAAgB,CAAC5B,WAAD,CAAhB,CAA8B,CAA9B,CAAb;AACAK,YAAAA,MAAM,GAAGjmE,CAAC,CAACsoE,OAAX;AACApC,YAAAA,MAAM,GAAGlmE,CAAC,CAACuoE,OAAX;AACAlC,YAAAA,MAAM,GAAG9hE,MAAM,CAACmR,WAAhB;AACA4wD,YAAAA,MAAM,GAAG/hE,MAAM,CAACoR,YAAhB;AACA4wD,YAAAA,KAAK,GAAGD,MAAM,GAAGD,MAAjB;AACAN,YAAAA,cAAc,GAAGtnD,MAAjB;AACAsnD,YAAAA,cAAc,CAAC9xE,IAAf,GAAsBA,IAAtB;AACA8xE,YAAAA,cAAc,CAAC1O,QAAf,GAA0B;AACxB3jE,cAAAA,CAAC,EAAEu1E,WAAW,GAAGxqD,MAAM,CAAC,CAAD,CAApB,GAA0B0nD,YADL;AAExBpxE,cAAAA,CAAC,EAAEm0E,YAAY,GAAGzqD,MAAM,CAAC,CAAD,CAArB,GAA2B2nD;AAFN,aAA1B;AAIAQ,YAAAA,gBAAgB,GAAG12C,WAAW,CAACu4C,WAA/B;AACA5B,YAAAA,iBAAiB,GAAG32C,WAAW,CAACw4C,YAAhC;AACA1C,YAAAA,cAAc,GAAG75D,GAAG,CAACqoB,GAAJ,CAAQtE,WAAR,EAAqB,KAArB,EAA4B;AAAEmhB,cAAAA,KAAK,EAAE;AAAT,aAA5B,CAAjB;AACAllC,YAAAA,GAAG,CAAC6qC,SAAJ,CAAcgvB,cAAd,EAA8B;AAC5BrO,cAAAA,QAAQ,EAAE,OADkB;AAE5BrkD,cAAAA,IAAI,EAAE,GAFsB;AAG5BC,cAAAA,GAAG,EAAE,GAHuB;AAI5B6B,cAAAA,KAAK,EAAE,MAJqB;AAK5BC,cAAAA,MAAM,EAAE;AALoB,aAA9B;AAOAwwD,YAAAA,gBAAgB,GAAG8B,kBAAkB,CAAC/B,WAAD,CAArC;AACAz5D,YAAAA,GAAG,CAAC4mC,QAAJ,CAAa8yB,gBAAb,EAA+B,qBAA/B;AACA15D,YAAAA,GAAG,CAAC8pC,SAAJ,CAAc4vB,gBAAd,EAAgC,gBAAhC,EAAkD,KAAlD;AACAA,YAAAA,gBAAgB,CAAC79D,eAAjB,GAAmC,OAAnC;AACAmE,YAAAA,GAAG,CAAC6qC,SAAJ,CAAc6uB,gBAAd,EAAgC;AAC9BvyD,cAAAA,IAAI,EAAE6yD,YADwB;AAE9B5yD,cAAAA,GAAG,EAAE6yD,YAFyB;AAG9BvT,cAAAA,MAAM,EAAE;AAHsB,aAAhC;AAKAiV,YAAAA,eAAe,CAACjC,gBAAD,EAAmBoD,WAAnB,EAAgCC,YAAhC,CAAf;AACArD,YAAAA,gBAAgB,CAAChtD,eAAjB,CAAiC8sD,oBAAjC;AACAz1C,YAAAA,WAAW,CAAC1d,WAAZ,CAAwBqzD,gBAAxB;AACA15D,YAAAA,GAAG,CAACnT,IAAJ,CAASytE,WAAT,EAAsB,WAAtB,EAAmCuB,kBAAnC;AACA77D,YAAAA,GAAG,CAACnT,IAAJ,CAASytE,WAAT,EAAsB,SAAtB,EAAiCkC,cAAjC;;AACA,gBAAIjC,YAAY,KAAKD,WAArB,EAAkC;AAChCt6D,cAAAA,GAAG,CAACnT,IAAJ,CAAS0tE,YAAT,EAAuB,WAAvB,EAAoCsB,kBAApC;AACA77D,cAAAA,GAAG,CAACnT,IAAJ,CAAS0tE,YAAT,EAAuB,SAAvB,EAAkCiC,cAAlC;AACD;;AACD7C,YAAAA,YAAY,GAAG35D,GAAG,CAACqoB,GAAJ,CAAQtE,WAAR,EAAqB,KAArB,EAA4B;AACzC,uBAAS,mBADgC;AAEzC,gCAAkB;AAFuB,aAA5B,EAGZm2C,MAAM,GAAG,WAAT,GAAuBC,MAHX,CAAf;AAID,WA7CD;;AA8CA+C,UAAAA,SAAS,GAAGl9D,GAAG,CAACrP,GAAJ,CAAQ,oBAAoB7I,IAA5B,CAAZ;;AACA,cAAIo1E,SAAJ,EAAe;AACbl9D,YAAAA,GAAG,CAAC6G,MAAJ,CAAWq2D,SAAX;AACD;;AACDA,UAAAA,SAAS,GAAGl9D,GAAG,CAACqoB,GAAJ,CAAQtE,WAAR,EAAqB,KAArB,EAA4B;AACtC,kBAAM,oBAAoBj8B,IADY;AAEtC,8BAAkB,KAFoB;AAGtC,qBAAS,kBAH6B;AAItC,4BAAgB,IAJsB;AAKtC,qBAAS,YAAYA,IAAZ,GAAmB;AALU,WAA5B,CAAZ;;AAOA,cAAI2T,GAAG,CAAChD,EAAJ,KAAW,EAAf,EAAmB;AACjBykE,YAAAA,SAAS,CAACrhE,eAAV,GAA4B,KAA5B;AACD;;AACDmE,UAAAA,GAAG,CAACnT,IAAJ,CAASqwE,SAAT,EAAoB,WAApB,EAAiC,UAAUrpE,CAAV,EAAa;AAC5CA,YAAAA,CAAC,CAAC0gC,wBAAF;AACA1gC,YAAAA,CAAC,CAACqgC,cAAF;AACAipC,YAAAA,SAAS,CAACtpE,CAAD,CAAT;AACD,WAJD;AAKAye,UAAAA,MAAM,CAACvE,GAAP,GAAamvD,SAAb;AACAl9D,UAAAA,GAAG,CAAC6qC,SAAJ,CAAcqyB,SAAd,EAAyB;AACvB/1D,YAAAA,IAAI,EAAE21D,WAAW,GAAGxqD,MAAM,CAAC,CAAD,CAApB,GAA0B0nD,YAA1B,GAAyCkD,SAAS,CAACxvD,WAAV,GAAwB,CADhD;AAEvBtG,YAAAA,GAAG,EAAE21D,YAAY,GAAGzqD,MAAM,CAAC,CAAD,CAArB,GAA2B2nD,YAA3B,GAA0CiD,SAAS,CAAC9uD,YAAV,GAAyB;AAFjD,WAAzB;AAID,SAxEK,CAAN;AAyED,OA1ED,MA0EO;AACL4uD,QAAAA,cAAc;AACf;;AACD,UAAI,CAACh9D,GAAG,CAAC2pC,SAAJ,CAAc8vB,WAAd,EAA2BD,oBAA3B,CAAL,EAAuD;AACrDC,QAAAA,WAAW,CAACvtD,YAAZ,CAAyBstD,oBAAzB,EAA+CyD,aAA/C;AACD;AACF,KA/FD;;AAgGA,QAAID,cAAc,GAAG,YAAY;AAC/BH,MAAAA,wBAAwB;;AACxB,UAAIpD,WAAJ,EAAiB;AACfA,QAAAA,WAAW,CAAC/sD,eAAZ,CAA4B8sD,oBAA5B;AACD;;AACDvoE,MAAAA,MAAM,CAAC0pE,aAAD,EAAgB,UAAUjwE,KAAV,EAAiB5C,IAAjB,EAAuB;AAC3C,YAAIo1E,SAAS,GAAGl9D,GAAG,CAACrP,GAAJ,CAAQ,oBAAoB7I,IAA5B,CAAhB;;AACA,YAAIo1E,SAAJ,EAAe;AACbl9D,UAAAA,GAAG,CAACg2B,MAAJ,CAAWknC,SAAX;AACAl9D,UAAAA,GAAG,CAAC6G,MAAJ,CAAWq2D,SAAX;AACD;AACF,OANK,CAAN;AAOD,KAZD;;AAaA,QAAIE,gBAAgB,GAAG,UAAUvpE,CAAV,EAAa;AAClC,UAAIwpE,QAAJ,EAAcC,UAAd;;AACA,UAAIC,cAAc,GAAG,UAAU39D,IAAV,EAAgB5B,MAAhB,EAAwB;AAC3C,YAAI4B,IAAJ,EAAU;AACR,aAAG;AACD,gBAAIA,IAAI,KAAK5B,MAAb,EAAqB;AACnB,qBAAO,IAAP;AACD;AACF,WAJD,QAIS4B,IAAI,GAAGA,IAAI,CAAC0D,UAJrB;AAKD;AACF,OARD;;AASA,UAAI+2D,aAAa,IAAIr/C,MAAM,CAACC,OAA5B,EAAqC;AACnC;AACD;;AACDzoB,MAAAA,MAAM,CAACwN,GAAG,CAAC+2B,MAAJ,CAAW,8CAAX,CAAD,EAA6D,UAAUymC,GAAV,EAAe;AAChFA,QAAAA,GAAG,CAAC9wD,eAAJ,CAAoB8sD,oBAApB;AACD,OAFK,CAAN;AAGA8D,MAAAA,UAAU,GAAGzpE,CAAC,CAAC7F,IAAF,KAAW,WAAX,GAAyB6F,CAAC,CAACuE,MAA3B,GAAoC88C,SAAS,CAACoF,OAAV,EAAjD;AACAgjB,MAAAA,UAAU,GAAGt9D,GAAG,CAACwpC,CAAJ,CAAM8zB,UAAN,EAAkB9jD,OAAlB,CAA0B,yDAA1B,EAAqF,CAArF,CAAb;;AACA,UAAI+jD,cAAc,CAACD,UAAD,EAAav5C,WAAb,CAAlB,EAA6C;AAC3C05C,QAAAA,kBAAkB;AAClBJ,QAAAA,QAAQ,GAAGnoB,SAAS,CAACwoB,QAAV,CAAmB,IAAnB,CAAX;;AACA,YAAIH,cAAc,CAACF,QAAD,EAAWC,UAAX,CAAd,IAAwCC,cAAc,CAACroB,SAAS,CAACyoB,MAAV,CAAiB,IAAjB,CAAD,EAAyBL,UAAzB,CAA1D,EAAgG;AAC9FZ,UAAAA,cAAc,CAACY,UAAD,CAAd;AACA;AACD;AACF;;AACDN,MAAAA,cAAc;AACf,KA5BD;;AA6BA,QAAIY,4BAA4B,GAAG,UAAU7vD,GAAV,EAAe;AAChD,aAAOurD,wBAAwB,CAACjC,sBAAsB,CAACr8C,MAAM,CAACo6B,OAAP,EAAD,EAAmBrnC,GAAnB,CAAvB,CAA/B;AACD,KAFD;;AAGA,QAAI8uD,wBAAwB,GAAG,YAAY;AACzC5rE,MAAAA,MAAM,CAAC0pE,aAAD,EAAgB,UAAUroD,MAAV,EAAkB;AACtC,YAAIA,MAAM,CAACvE,GAAX,EAAgB;AACd/N,UAAAA,GAAG,CAACg2B,MAAJ,CAAW1jB,MAAM,CAACvE,GAAlB;AACA,iBAAOuE,MAAM,CAACvE,GAAd;AACD;AACF,OALK,CAAN;AAMD,KAPD;;AAQA,QAAI0vD,kBAAkB,GAAG,YAAY;AACnC,UAAI;AACFziD,QAAAA,MAAM,CAACm7C,MAAP,GAAgB0H,WAAhB,CAA4B,sBAA5B,EAAoD,KAApD,EAA2D,OAA3D;AACD,OAFD,CAEE,OAAOzqD,EAAP,EAAW,CACZ;AACF,KALD;;AAMA4H,IAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,YAAY;AAC5B2sD,MAAAA,kBAAkB;;AAClB,UAAIhiE,GAAG,CAACjH,OAAJ,CAAY2E,IAAZ,MAAsBsC,GAAG,CAACjH,OAAJ,CAAYyE,MAAZ,EAA1B,EAAgD;AAC9C+hB,QAAAA,MAAM,CAAClK,EAAP,CAAU,iBAAV,EAA6B,UAAUjd,CAAV,EAAa;AACxC,cAAIuE,MAAM,GAAGvE,CAAC,CAACuE,MAAf;AAAA,cAAuBqK,QAAQ,GAAGrK,MAAM,CAACqK,QAAzC;;AACA,cAAI,CAAC43D,aAAD,IAAkB,mBAAmBxlE,IAAnB,CAAwB4N,QAAxB,CAAlB,IAAuD,CAACm7D,4BAA4B,CAACxlE,MAAD,CAAxF,EAAkG;AAChG,gBAAIvE,CAAC,CAACosC,MAAF,KAAa,CAAjB,EAAoB;AAClBjlB,cAAAA,MAAM,CAACk6B,SAAP,CAAiBne,MAAjB,CAAwB3+B,MAAxB,EAAgCqK,QAAQ,KAAK,OAA7C;AACD;;AACD,gBAAI5O,CAAC,CAAC7F,IAAF,KAAW,WAAf,EAA4B;AAC1BgtB,cAAAA,MAAM,CAAC2hD,WAAP;AACD;AACF;AACF,SAVD;;AAWA,YAAImB,uBAAuB,GAAG,UAAUjqE,CAAV,EAAa;AACzC,cAAIkqE,aAAa,GAAG,UAAUn+D,IAAV,EAAgB;AAClCkb,YAAAA,KAAK,CAACC,gBAAN,CAAuBC,MAAvB,EAA+B,YAAY;AACzC,qBAAOA,MAAM,CAACk6B,SAAP,CAAiBne,MAAjB,CAAwBn3B,IAAxB,CAAP;AACD,aAFD;AAGD,WAJD;;AAKA,cAAIg+D,4BAA4B,CAAC/pE,CAAC,CAACuE,MAAH,CAA5B,IAA0C0T,OAAO,CAACjY,CAAC,CAACuE,MAAH,CAArD,EAAiE;AAC/DvE,YAAAA,CAAC,CAACqgC,cAAF;AACA6pC,YAAAA,aAAa,CAAClqE,CAAC,CAACuE,MAAH,CAAb;AACA;AACD;;AACD,cAAI,mBAAmBvD,IAAnB,CAAwBhB,CAAC,CAACuE,MAAF,CAASqK,QAAjC,CAAJ,EAAgD;AAC9C5O,YAAAA,CAAC,CAACqgC,cAAF;;AACA,gBAAIrgC,CAAC,CAACuE,MAAF,CAAS8S,OAAT,KAAqB,KAAzB,EAAgC;AAC9B6yD,cAAAA,aAAa,CAAClqE,CAAC,CAACuE,MAAH,CAAb;AACD;AACF;AACF,SAjBD;;AAkBA4H,QAAAA,GAAG,CAACnT,IAAJ,CAASk3B,WAAT,EAAsB,iBAAtB,EAAyC+5C,uBAAzC;AACA9iD,QAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB,YAAY;AAC9B,iBAAO9Q,GAAG,CAACg2B,MAAJ,CAAWjS,WAAX,EAAwB,iBAAxB,EAA2C+5C,uBAA3C,CAAP;AACD,SAFD;AAGD;;AACD,UAAIE,yBAAyB,GAAGljD,KAAK,CAACK,QAAN,CAAe,UAAUtnB,CAAV,EAAa;AAC1D,YAAI,CAACmnB,MAAM,CAACijD,SAAZ,EAAuB;AACrBb,UAAAA,gBAAgB,CAACvpE,CAAD,CAAhB;AACD;AACF,OAJ+B,CAAhC;AAKAmnB,MAAAA,MAAM,CAAClK,EAAP,CAAU,gFAAV,EAA4FktD,yBAA5F;AACAhjD,MAAAA,MAAM,CAAClK,EAAP,CAAU,sBAAV,EAAkC,UAAUjd,CAAV,EAAa;AAC7C,YAAI4lE,WAAW,IAAIA,WAAW,CAACh3D,QAAZ,KAAyB,OAA5C,EAAqD;AACnDu7D,UAAAA,yBAAyB,CAACnqE,CAAD,CAAzB;AACD;AACF,OAJD;AAKAmnB,MAAAA,MAAM,CAAClK,EAAP,CAAU,WAAV,EAAuBksD,cAAvB;AACAhiD,MAAAA,MAAM,CAAClK,EAAP,CAAU,uBAAV,EAAmCsqD,sBAAnC,EAA2D,IAA3D;AACD,KAlDD;AAmDApgD,IAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB+rD,wBAApB;;AACA,QAAIvmC,OAAO,GAAG,YAAY;AACxBmjC,MAAAA,WAAW,GAAGC,gBAAgB,GAAGG,cAAc,GAAG,IAAlD;AACD,KAFD;;AAGA,WAAO;AACL0B,MAAAA,WAAW,EAAEA,WADR;AAELmB,MAAAA,cAAc,EAAEA,cAFX;AAGLM,MAAAA,cAAc,EAAEA,cAHX;AAILI,MAAAA,gBAAgB,EAAEA,gBAJb;AAKL9mC,MAAAA,OAAO,EAAEA;AALJ,KAAP;AAOD,GAhZD;;AAkZA,MAAI4nC,aAAa,GAAG,UAAUt+D,IAAV,EAAgB;AAClC,WAAO+L,qBAAqB,CAAC/L,IAAD,CAArB,IAA+BgM,sBAAsB,CAAChM,IAAD,CAA5D;AACD,GAFD;;AAGA,MAAIu+D,UAAU,GAAG,UAAUv+D,IAAV,EAAgB4e,QAAhB,EAA0BjrB,SAA1B,EAAqC;AACpD,WAAOqM,IAAI,IAAIA,IAAI,KAAK4e,QAAxB,EAAkC;AAChC,UAAIjrB,SAAS,CAACqM,IAAD,CAAb,EAAqB;AACnB,eAAOA,IAAP;AACD;;AACDA,MAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,WAAO,IAAP;AACD,GARD;;AASA,MAAI86D,kBAAkB,GAAG,UAAUtqC,OAAV,EAAmBG,OAAnB,EAA4Bh1B,GAA5B,EAAiC;AACxD,QAAIo/D,KAAJ;AACA,QAAIn9D,OAAO,GAAGjC,GAAG,CAACkB,gBAAJ,CAAqB2zB,OAArB,EAA8BG,OAA9B,CAAd;AACA,QAAIghB,GAAG,GAAGh2C,GAAG,CAACiI,IAAJ,CAASo3D,eAAT,EAAV;;AACA,QAAI,CAACp9D,OAAD,IAAYA,OAAO,CAACgK,OAAR,KAAoB,MAApC,EAA4C;AAC1ChK,MAAAA,OAAO,GAAGjC,GAAG,CAACiI,IAAd;AACD;;AACD+tC,IAAAA,GAAG,CAACspB,iBAAJ,CAAsBr9D,OAAtB;AACAm9D,IAAAA,KAAK,GAAG3/D,KAAK,CAACvR,OAAN,CAAc8nD,GAAG,CAACoH,cAAJ,EAAd,CAAR;AACAgiB,IAAAA,KAAK,GAAGA,KAAK,CAACn2E,IAAN,CAAW,UAAUsC,CAAV,EAAamD,CAAb,EAAgB;AACjCnD,MAAAA,CAAC,GAAGkf,IAAI,CAAC8wD,GAAL,CAAS9wD,IAAI,CAACC,GAAL,CAASnf,CAAC,CAAC4c,GAAF,GAAQ6sB,OAAjB,EAA0BzpC,CAAC,CAAC4e,MAAF,GAAW6qB,OAArC,CAAT,CAAJ;AACAtmC,MAAAA,CAAC,GAAG+b,IAAI,CAAC8wD,GAAL,CAAS9wD,IAAI,CAACC,GAAL,CAAShc,CAAC,CAACyZ,GAAF,GAAQ6sB,OAAjB,EAA0BtmC,CAAC,CAACyb,MAAF,GAAW6qB,OAArC,CAAT,CAAJ;AACA,aAAOzpC,CAAC,GAAGmD,CAAX;AACD,KAJO,CAAR;;AAKA,QAAI0wE,KAAK,CAACr1E,MAAN,GAAe,CAAnB,EAAsB;AACpBirC,MAAAA,OAAO,GAAG,CAACoqC,KAAK,CAAC,CAAD,CAAL,CAASj1D,MAAT,GAAkBi1D,KAAK,CAAC,CAAD,CAAL,CAASj3D,GAA5B,IAAmC,CAA7C;;AACA,UAAI;AACF6tC,QAAAA,GAAG,CAACupB,WAAJ,CAAgB1qC,OAAhB,EAAyBG,OAAzB;AACAghB,QAAAA,GAAG,CAACwE,QAAJ,CAAa,IAAb;AACA,eAAOxE,GAAP;AACD,OAJD,CAIE,OAAO7hC,EAAP,EAAW,CACZ;AACF;;AACD,WAAO,IAAP;AACD,GAxBD;;AAyBA,MAAIqrD,6BAA6B,GAAG,UAAUxpB,GAAV,EAAez2B,QAAf,EAAyB;AAC3D,QAAIkgD,aAAa,GAAGzpB,GAAG,IAAIA,GAAG,CAACypB,aAAX,GAA2BzpB,GAAG,CAACypB,aAAJ,EAA3B,GAAiD,IAArE;AACA,WAAO9yD,sBAAsB,CAACuyD,UAAU,CAACO,aAAD,EAAgBlgD,QAAhB,EAA0B0/C,aAA1B,CAAX,CAAtB,GAA6E,IAA7E,GAAoFjpB,GAA3F;AACD,GAHD;;AAIA,MAAI0pB,WAAW,GAAG,UAAU7qC,OAAV,EAAmBG,OAAnB,EAA4Bh1B,GAA5B,EAAiC;AACjD,QAAIg2C,GAAJ,EAASgK,KAAT;AACA,QAAI2f,QAAQ,GAAG3/D,GAAf;;AACA,QAAI2/D,QAAQ,CAACC,sBAAb,EAAqC;AACnC5f,MAAAA,KAAK,GAAG2f,QAAQ,CAACC,sBAAT,CAAgC/qC,OAAhC,EAAyCG,OAAzC,CAAR;;AACA,UAAIgrB,KAAJ,EAAW;AACThK,QAAAA,GAAG,GAAGh2C,GAAG,CAAC+uC,WAAJ,EAAN;AACAiH,QAAAA,GAAG,CAAC5G,QAAJ,CAAa4Q,KAAK,CAAC6f,UAAnB,EAA+B7f,KAAK,CAACr9B,MAArC;AACAqzB,QAAAA,GAAG,CAACwE,QAAJ,CAAa,IAAb;AACD;AACF,KAPD,MAOO,IAAIx6C,GAAG,CAAC8/D,mBAAR,EAA6B;AAClC9pB,MAAAA,GAAG,GAAGh2C,GAAG,CAAC8/D,mBAAJ,CAAwBjrC,OAAxB,EAAiCG,OAAjC,CAAN;AACD,KAFM,MAEA,IAAI2qC,QAAQ,CAAC13D,IAAT,CAAco3D,eAAlB,EAAmC;AACxCrpB,MAAAA,GAAG,GAAG2pB,QAAQ,CAAC13D,IAAT,CAAco3D,eAAd,EAAN;;AACA,UAAI;AACFrpB,QAAAA,GAAG,CAACupB,WAAJ,CAAgB1qC,OAAhB,EAAyBG,OAAzB;AACAghB,QAAAA,GAAG,CAACwE,QAAJ,CAAa,IAAb;AACD,OAHD,CAGE,OAAOrmC,EAAP,EAAW;AACX6hC,QAAAA,GAAG,GAAGmpB,kBAAkB,CAACtqC,OAAD,EAAUG,OAAV,EAAmBh1B,GAAnB,CAAxB;AACD;;AACD,aAAOw/D,6BAA6B,CAACxpB,GAAD,EAAMh2C,GAAG,CAACiI,IAAV,CAApC;AACD;;AACD,WAAO+tC,GAAP;AACD,GAvBD;;AAyBA,MAAI+pB,MAAM,GAAG,UAAUC,IAAV,EAAgBhf,IAAhB,EAAsB;AACjC,WAAOgf,IAAI,IAAIhf,IAAR,IAAiBgf,IAAI,CAACr8C,cAAL,KAAwBq9B,IAAI,CAACr9B,cAA7B,IAA+Cq8C,IAAI,CAACnwB,WAAL,KAAqBmR,IAAI,CAACnR,WAA1F,IAA2GmwB,IAAI,CAAClwB,YAAL,KAAsBkR,IAAI,CAAClR,YAA3B,IAA2CkwB,IAAI,CAACjwB,SAAL,KAAmBiR,IAAI,CAACjR,SAArL;AACD,GAFD;;AAIA,MAAIkwB,YAAY,GAAG,UAAUt/D,IAAV,EAAgB4e,QAAhB,EAA0BjrB,SAA1B,EAAqC;AACtD,WAAOqM,IAAI,IAAIA,IAAI,KAAK4e,QAAxB,EAAkC;AAChC,UAAIjrB,SAAS,CAACqM,IAAD,CAAb,EAAqB;AACnB,eAAOA,IAAP;AACD;;AACDA,MAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,WAAO,IAAP;AACD,GARD;;AASA,MAAI67D,SAAS,GAAG,UAAUv/D,IAAV,EAAgB4e,QAAhB,EAA0BjrB,SAA1B,EAAqC;AACnD,WAAO2rE,YAAY,CAACt/D,IAAD,EAAO4e,QAAP,EAAiBjrB,SAAjB,CAAZ,KAA4C,IAAnD;AACD,GAFD;;AAGA,MAAI6rE,iBAAiB,GAAG,UAAUx/D,IAAV,EAAgB4e,QAAhB,EAA0B12B,IAA1B,EAAgC;AACtD,WAAOq3E,SAAS,CAACv/D,IAAD,EAAO4e,QAAP,EAAiB,UAAU5e,IAAV,EAAgB;AAC/C,aAAOA,IAAI,CAAC6C,QAAL,KAAkB3a,IAAzB;AACD,KAFe,CAAhB;AAGD,GAJD;;AAKA,MAAIu3E,SAAS,GAAG,UAAUz/D,IAAV,EAAgB;AAC9B,WAAOA,IAAI,IAAIA,IAAI,CAAC6C,QAAL,KAAkB,OAAjC;AACD,GAFD;;AAGA,MAAI68D,aAAa,GAAG,UAAU1/D,IAAV,EAAgB;AAClC,WAAOA,IAAI,IAAI,oBAAoB/K,IAApB,CAAyB+K,IAAI,CAAC6C,QAA9B,CAAf;AACD,GAFD;;AAGA,MAAI88D,uBAAuB,GAAG,UAAU3/D,IAAV,EAAgB4e,QAAhB,EAA0B;AACtD,WAAO2C,gBAAgB,CAACvhB,IAAD,CAAhB,IAA0Bu/D,SAAS,CAACv/D,IAAD,EAAO4e,QAAP,EAAiBiuC,WAAjB,CAAT,KAA2C,KAA5E;AACD,GAFD;;AAGA,MAAI+S,gBAAgB,GAAG,UAAUx/D,GAAV,EAAeJ,IAAf,EAAqBuH,IAArB,EAA2B;AAChD,QAAIud,MAAM,GAAG,IAAIpG,aAAJ,CAAkB1e,IAAlB,EAAwBI,GAAG,CAACurC,SAAJ,CAAc3rC,IAAI,CAAC0D,UAAnB,EAA+BtD,GAAG,CAAC4f,OAAnC,KAA+C5f,GAAG,CAACypC,OAAJ,EAAvE,CAAb;;AACA,WAAO7pC,IAAI,GAAG8kB,MAAM,CAACvd,IAAI,GAAG,MAAH,GAAY,MAAjB,CAAN,EAAd,EAAgD;AAC9C,UAAIsE,IAAI,CAAC7L,IAAD,CAAR,EAAgB;AACd,eAAO,IAAP;AACD;AACF;AACF,GAPD;;AAQA,MAAI6/D,UAAU,GAAG,UAAU7/D,IAAV,EAAgB9X,IAAhB,EAAsB;AACrC,WAAO8X,IAAI,CAACqE,eAAL,IAAwBrE,IAAI,CAACqE,eAAL,CAAqBxB,QAArB,KAAkC3a,IAAjE;AACD,GAFD;;AAGA,MAAI43E,6BAA6B,GAAG,UAAUx4D,IAAV,EAAgBtH,IAAhB,EAAsB;AACxD,WAAOA,IAAI,IAAIA,IAAI,KAAKsH,IAAxB,EAA8B;AAC5B,UAAI0E,sBAAsB,CAAChM,IAAD,CAA1B,EAAkC;AAChC,eAAO,IAAP;AACD;;AACDA,MAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,WAAO,KAAP;AACD,GARD;;AASA,MAAIq8D,oBAAoB,GAAG,UAAU3/D,GAAV,EAAe4/D,WAAf,EAA4B5f,SAA5B,EAAuC74C,IAAvC,EAA6CoX,SAA7C,EAAwD;AACjF,QAAIshD,iBAAJ;AACA,QAAI34D,IAAI,GAAGlH,GAAG,CAACypC,OAAJ,EAAX;AACA,QAAI7pC,IAAJ;AACA,QAAI0qB,mBAAmB,GAAGtqB,GAAG,CAAC8nB,MAAJ,CAAWmH,mBAAX,EAA1B;AACA,QAAI6wC,oBAAoB,GAAG9/D,GAAG,CAACurC,SAAJ,CAAchtB,SAAS,CAACjb,UAAxB,EAAoCtD,GAAG,CAAC4f,OAAxC,KAAoD1Y,IAA/E;;AACA,QAAIC,IAAI,IAAIsE,IAAI,CAAC8S,SAAD,CAAZ,IAA2BqhD,WAA3B,IAA0C5/D,GAAG,CAAC2kB,OAAJ,CAAYm7C,oBAAZ,CAA9C,EAAiF;AAC/E,aAAOjyE,QAAQ,CAACR,IAAT,CAAcwvD,aAAa,CAACt+B,SAAS,CAACjb,UAAX,EAAuBtD,GAAG,CAACy+B,SAAJ,CAAclgB,SAAd,CAAvB,CAA3B,CAAP;AACD;;AACD,QAAImG,MAAM,GAAG,IAAIpG,aAAJ,CAAkBC,SAAlB,EAA6BuhD,oBAA7B,CAAb;;AACA,WAAOlgE,IAAI,GAAG8kB,MAAM,CAACvd,IAAI,GAAG,MAAH,GAAY,MAAjB,CAAN,EAAd,EAAgD;AAC9C,UAAInH,GAAG,CAAC2uC,wBAAJ,CAA6B/uC,IAA7B,MAAuC,OAAvC,IAAkD2/D,uBAAuB,CAAC3/D,IAAD,EAAOsH,IAAP,CAA7E,EAA2F;AACzF,eAAOrZ,QAAQ,CAACrC,IAAT,EAAP;AACD;;AACD,UAAI6f,QAAQ,CAACzL,IAAD,CAAR,IAAkBA,IAAI,CAAC49B,SAAL,CAAex0C,MAAf,GAAwB,CAA9C,EAAiD;AAC/C,YAAIo2E,iBAAiB,CAACx/D,IAAD,EAAOsH,IAAP,EAAa,GAAb,CAAjB,KAAuC,KAA3C,EAAkD;AAChD,iBAAOrZ,QAAQ,CAACR,IAAT,CAAcwvD,aAAa,CAACj9C,IAAD,EAAOuH,IAAI,GAAGvH,IAAI,CAAC49B,SAAL,CAAex0C,MAAlB,GAA2B,CAAtC,CAA3B,CAAP;AACD;;AACD,eAAO6E,QAAQ,CAACrC,IAAT,EAAP;AACD;;AACD,UAAIwU,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAZ,KAAqB0qB,mBAAmB,CAAC1qB,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,EAAD,CAA5C,EAA2E;AACzE,eAAOxI,QAAQ,CAACrC,IAAT,EAAP;AACD;;AACDq0E,MAAAA,iBAAiB,GAAGjgE,IAApB;AACD;;AACD,QAAIogD,SAAS,IAAI6f,iBAAjB,EAAoC;AAClC,aAAOhyE,QAAQ,CAACR,IAAT,CAAcwvD,aAAa,CAACgjB,iBAAD,EAAoB,CAApB,CAA3B,CAAP;AACD;;AACD,WAAOhyE,QAAQ,CAACrC,IAAT,EAAP;AACD,GA7BD;;AA8BA,MAAIu0E,iBAAiB,GAAG,UAAU//D,GAAV,EAAeggD,SAAf,EAA0BvoD,KAA1B,EAAiCw9C,GAAjC,EAAsC;AAC5D,QAAI34C,SAAJ,EAAeslB,MAAf;AACA,QAAI1a,IAAI,GAAGlH,GAAG,CAACypC,OAAJ,EAAX;AACA,QAAI7pC,IAAJ;AACA,QAAIogE,aAAJ;AAAA,QAAmBn3B,UAAU,GAAG,KAAhC;AACAvsC,IAAAA,SAAS,GAAG24C,GAAG,CAAC,CAACx9C,KAAK,GAAG,OAAH,GAAa,KAAnB,IAA4B,WAA7B,CAAf;AACAmqB,IAAAA,MAAM,GAAGqzB,GAAG,CAAC,CAACx9C,KAAK,GAAG,OAAH,GAAa,KAAnB,IAA4B,QAA7B,CAAZ;AACA,QAAImoE,WAAW,GAAG31D,WAAW,CAAC3N,SAAD,CAAX,IAA0BslB,MAAM,KAAKtlB,SAAS,CAACgD,UAAV,CAAqBtW,MAA5E;AACA,QAAIshC,mBAAmB,GAAGtqB,GAAG,CAAC8nB,MAAJ,CAAWmH,mBAAX,EAA1B;AACA+wC,IAAAA,aAAa,GAAGvoE,KAAhB;;AACA,QAAI0pB,gBAAgB,CAAC7kB,SAAD,CAApB,EAAiC;AAC/B,aAAOzO,QAAQ,CAACrC,IAAT,EAAP;AACD;;AACD,QAAIye,WAAW,CAAC3N,SAAD,CAAX,IAA0BslB,MAAM,GAAGtlB,SAAS,CAACgD,UAAV,CAAqBtW,MAArB,GAA8B,CAArE,EAAwE;AACtEg3E,MAAAA,aAAa,GAAG,KAAhB;AACD;;AACD,QAAIz0D,YAAY,CAACjP,SAAD,CAAhB,EAA6B;AAC3BA,MAAAA,SAAS,GAAG4K,IAAZ;AACA0a,MAAAA,MAAM,GAAG,CAAT;AACD;;AACD,QAAItlB,SAAS,KAAK4K,IAAlB,EAAwB;AACtB,UAAI84D,aAAJ,EAAmB;AACjBpgE,QAAAA,IAAI,GAAGtD,SAAS,CAACgD,UAAV,CAAqBsiB,MAAM,GAAG,CAAT,GAAaA,MAAM,GAAG,CAAtB,GAA0B,CAA/C,CAAP;;AACA,YAAIhiB,IAAJ,EAAU;AACR,cAAIuhB,gBAAgB,CAACvhB,IAAD,CAApB,EAA4B;AAC1B,mBAAO/R,QAAQ,CAACrC,IAAT,EAAP;AACD;;AACD,cAAI8+B,mBAAmB,CAAC1qB,IAAI,CAAC6C,QAAN,CAAnB,IAAsC48D,SAAS,CAACz/D,IAAD,CAAnD,EAA2D;AACzD,mBAAO/R,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF;AACF;;AACD,UAAI8Q,SAAS,CAAC+C,aAAV,EAAJ,EAA+B;AAC7BuiB,QAAAA,MAAM,GAAGlY,IAAI,CAACswC,GAAL,CAAS,CAACgmB,aAAD,IAAkBp+C,MAAM,GAAG,CAA3B,GAA+BA,MAAM,GAAG,CAAxC,GAA4CA,MAArD,EAA6DtlB,SAAS,CAACgD,UAAV,CAAqBtW,MAArB,GAA8B,CAA3F,CAAT;AACAsT,QAAAA,SAAS,GAAGA,SAAS,CAACgD,UAAV,CAAqBsiB,MAArB,CAAZ;AACAA,QAAAA,MAAM,GAAGvW,QAAQ,CAAC/O,SAAD,CAAR,IAAuBsjE,WAAvB,GAAqCtjE,SAAS,CAACkZ,IAAV,CAAexsB,MAApD,GAA6D,CAAtE;;AACA,YAAI,CAACg3D,SAAD,IAAc1jD,SAAS,KAAK4K,IAAI,CAAC1C,SAAjC,IAA8C66D,SAAS,CAAC/iE,SAAD,CAA3D,EAAwE;AACtE,iBAAOzO,QAAQ,CAACrC,IAAT,EAAP;AACD;;AACD,YAAIk0E,6BAA6B,CAACx4D,IAAD,EAAO5K,SAAP,CAA7B,IAAkD6kB,gBAAgB,CAAC7kB,SAAD,CAAtE,EAAmF;AACjF,iBAAOzO,QAAQ,CAACrC,IAAT,EAAP;AACD;;AACD,YAAI8Q,SAAS,CAAC+C,aAAV,MAA6BggE,SAAS,CAAC/iE,SAAD,CAAT,KAAyB,KAA1D,EAAiE;AAC/DsD,UAAAA,IAAI,GAAGtD,SAAP;AACA,cAAIooB,MAAM,GAAG,IAAIpG,aAAJ,CAAkBhiB,SAAlB,EAA6B4K,IAA7B,CAAb;;AACA,aAAG;AACD,gBAAI0E,sBAAsB,CAAChM,IAAD,CAAtB,IAAgCuhB,gBAAgB,CAACvhB,IAAD,CAApD,EAA4D;AAC1DipC,cAAAA,UAAU,GAAG,KAAb;AACA;AACD;;AACD,gBAAIx9B,QAAQ,CAACzL,IAAD,CAAR,IAAkBA,IAAI,CAAC49B,SAAL,CAAex0C,MAAf,GAAwB,CAA9C,EAAiD;AAC/C44B,cAAAA,MAAM,GAAGo+C,aAAa,GAAG,CAAH,GAAOpgE,IAAI,CAAC49B,SAAL,CAAex0C,MAA5C;AACAsT,cAAAA,SAAS,GAAGsD,IAAZ;AACAipC,cAAAA,UAAU,GAAG,IAAb;AACA;AACD;;AACD,gBAAIve,mBAAmB,CAAC1qB,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,EAAD,CAAnB,IAAoD,CAACipE,aAAa,CAAC1/D,IAAD,CAAtE,EAA8E;AAC5EgiB,cAAAA,MAAM,GAAG5hB,GAAG,CAACy+B,SAAJ,CAAc7+B,IAAd,CAAT;AACAtD,cAAAA,SAAS,GAAGsD,IAAI,CAAC0D,UAAjB;;AACA,kBAAI,CAAC08D,aAAL,EAAoB;AAClBp+C,gBAAAA,MAAM;AACP;;AACDinB,cAAAA,UAAU,GAAG,IAAb;AACA;AACD;AACF,WApBD,QAoBSjpC,IAAI,GAAGogE,aAAa,GAAGt7C,MAAM,CAACjG,IAAP,EAAH,GAAmBiG,MAAM,CAAChG,IAAP,EApBhD;AAqBD;AACF;AACF;;AACD,QAAIshC,SAAJ,EAAe;AACb,UAAI30C,QAAQ,CAAC/O,SAAD,CAAR,IAAuBslB,MAAM,KAAK,CAAtC,EAAyC;AACvC+9C,QAAAA,oBAAoB,CAAC3/D,GAAD,EAAM4/D,WAAN,EAAmB5f,SAAnB,EAA8B,IAA9B,EAAoC1jD,SAApC,CAApB,CAAmE1P,IAAnE,CAAwE,UAAU6hB,GAAV,EAAe;AACrFnS,UAAAA,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,EAAZ;AACAslB,UAAAA,MAAM,GAAGnT,GAAG,CAACmT,MAAJ,EAAT;AACAinB,UAAAA,UAAU,GAAG,IAAb;AACD,SAJD;AAKD;;AACD,UAAI5+B,WAAW,CAAC3N,SAAD,CAAf,EAA4B;AAC1BsD,QAAAA,IAAI,GAAGtD,SAAS,CAACgD,UAAV,CAAqBsiB,MAArB,CAAP;;AACA,YAAI,CAAChiB,IAAL,EAAW;AACTA,UAAAA,IAAI,GAAGtD,SAAS,CAACgD,UAAV,CAAqBsiB,MAAM,GAAG,CAA9B,CAAP;AACD;;AACD,YAAIhiB,IAAI,IAAI6L,IAAI,CAAC7L,IAAD,CAAZ,IAAsB,CAAC6/D,UAAU,CAAC7/D,IAAD,EAAO,GAAP,CAAjC,IAAgD,CAAC4/D,gBAAgB,CAACx/D,GAAD,EAAMJ,IAAN,EAAY,KAAZ,CAAjE,IAAuF,CAAC4/D,gBAAgB,CAACx/D,GAAD,EAAMJ,IAAN,EAAY,IAAZ,CAA5G,EAA+H;AAC7H+/D,UAAAA,oBAAoB,CAAC3/D,GAAD,EAAM4/D,WAAN,EAAmB5f,SAAnB,EAA8B,IAA9B,EAAoCpgD,IAApC,CAApB,CAA8DhT,IAA9D,CAAmE,UAAU6hB,GAAV,EAAe;AAChFnS,YAAAA,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,EAAZ;AACAslB,YAAAA,MAAM,GAAGnT,GAAG,CAACmT,MAAJ,EAAT;AACAinB,YAAAA,UAAU,GAAG,IAAb;AACD,WAJD;AAKD;AACF;AACF;;AACD,QAAIm3B,aAAa,IAAI,CAAChgB,SAAlB,IAA+B30C,QAAQ,CAAC/O,SAAD,CAAvC,IAAsDslB,MAAM,KAAKtlB,SAAS,CAACkhC,SAAV,CAAoBx0C,MAAzF,EAAiG;AAC/F22E,MAAAA,oBAAoB,CAAC3/D,GAAD,EAAM4/D,WAAN,EAAmB5f,SAAnB,EAA8B,KAA9B,EAAqC1jD,SAArC,CAApB,CAAoE1P,IAApE,CAAyE,UAAU6hB,GAAV,EAAe;AACtFnS,QAAAA,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,EAAZ;AACAslB,QAAAA,MAAM,GAAGnT,GAAG,CAACmT,MAAJ,EAAT;AACAinB,QAAAA,UAAU,GAAG,IAAb;AACD,OAJD;AAKD;;AACD,WAAOA,UAAU,GAAGh7C,QAAQ,CAACR,IAAT,CAAcwvD,aAAa,CAACvgD,SAAD,EAAYslB,MAAZ,CAA3B,CAAH,GAAqD/zB,QAAQ,CAACrC,IAAT,EAAtE;AACD,GAnGD;;AAoGA,MAAIy0E,SAAS,GAAG,UAAUjgE,GAAV,EAAei1C,GAAf,EAAoB;AAClC,QAAI+K,SAAS,GAAG/K,GAAG,CAAC+K,SAApB;AAAA,QAA+BkgB,OAAO,GAAGjrB,GAAG,CAACgH,UAAJ,EAAzC;AACA,QAAIiP,QAAQ,GAAGrO,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAf;AACA8qB,IAAAA,iBAAiB,CAAC//D,GAAD,EAAMggD,SAAN,EAAiB,IAAjB,EAAuBkgB,OAAvB,CAAjB,CAAiDtzE,IAAjD,CAAsD,UAAU6hB,GAAV,EAAe;AACnE,UAAI,CAACuxC,SAAD,IAAc,CAACnD,aAAa,CAAC5C,OAAd,CAAsBiR,QAAtB,EAAgCz8C,GAAhC,CAAnB,EAAyD;AACvDyxD,QAAAA,OAAO,CAAC7xB,QAAR,CAAiB5/B,GAAG,CAACnS,SAAJ,EAAjB,EAAkCmS,GAAG,CAACmT,MAAJ,EAAlC;AACD;AACF,KAJD;;AAKA,QAAI,CAACo+B,SAAL,EAAgB;AACd+f,MAAAA,iBAAiB,CAAC//D,GAAD,EAAMggD,SAAN,EAAiB,KAAjB,EAAwBkgB,OAAxB,CAAjB,CAAkDtzE,IAAlD,CAAuD,UAAU6hB,GAAV,EAAe;AACpEyxD,QAAAA,OAAO,CAAC5xB,MAAR,CAAe7/B,GAAG,CAACnS,SAAJ,EAAf,EAAgCmS,GAAG,CAACmT,MAAJ,EAAhC;AACD,OAFD;AAGD;;AACD,QAAIo+B,SAAJ,EAAe;AACbkgB,MAAAA,OAAO,CAACzmB,QAAR,CAAiB,IAAjB;AACD;;AACD,WAAOulB,MAAM,CAAC/pB,GAAD,EAAMirB,OAAN,CAAN,GAAuBryE,QAAQ,CAACrC,IAAT,EAAvB,GAAyCqC,QAAQ,CAACR,IAAT,CAAc6yE,OAAd,CAAhD;AACD,GAjBD;;AAmBA,MAAI1+C,SAAS,GAAG,UAAU5hB,IAAV,EAAgBgiB,MAAhB,EAAwB;AACtC,WAAOhiB,IAAI,CAAC4hB,SAAL,CAAeI,MAAf,CAAP;AACD,GAFD;;AAGA,MAAIu+C,OAAO,GAAG,UAAUlrB,GAAV,EAAe;AAC3B,QAAIryB,cAAc,GAAGqyB,GAAG,CAACryB,cAAzB;AAAA,QAAyCksB,WAAW,GAAGmG,GAAG,CAACnG,WAA3D;AAAA,QAAwEC,YAAY,GAAGkG,GAAG,CAAClG,YAA3F;AAAA,QAAyGC,SAAS,GAAGiG,GAAG,CAACjG,SAAzH;;AACA,QAAIpsB,cAAc,KAAKmsB,YAAnB,IAAmC1jC,QAAQ,CAACuX,cAAD,CAA/C,EAAiE;AAC/D,UAAIksB,WAAW,GAAG,CAAd,IAAmBA,WAAW,GAAGlsB,cAAc,CAAC4a,SAAf,CAAyBx0C,MAA9D,EAAsE;AACpE+lD,QAAAA,YAAY,GAAGvtB,SAAS,CAACoB,cAAD,EAAiBksB,WAAjB,CAAxB;AACAlsB,QAAAA,cAAc,GAAGmsB,YAAY,CAAC9qC,eAA9B;;AACA,YAAI+qC,SAAS,GAAGF,WAAhB,EAA6B;AAC3BE,UAAAA,SAAS,GAAGA,SAAS,GAAGF,WAAxB;AACAlsB,UAAAA,cAAc,GAAGmsB,YAAY,GAAGvtB,SAAS,CAACutB,YAAD,EAAeC,SAAf,CAAT,CAAmC/qC,eAAnE;AACA+qC,UAAAA,SAAS,GAAGD,YAAY,CAACvR,SAAb,CAAuBx0C,MAAnC;AACA8lD,UAAAA,WAAW,GAAG,CAAd;AACD,SALD,MAKO;AACLE,UAAAA,SAAS,GAAG,CAAZ;AACD;AACF;AACF,KAbD,MAaO;AACL,UAAI3jC,QAAQ,CAACuX,cAAD,CAAR,IAA4BksB,WAAW,GAAG,CAA1C,IAA+CA,WAAW,GAAGlsB,cAAc,CAAC4a,SAAf,CAAyBx0C,MAA1F,EAAkG;AAChG45B,QAAAA,cAAc,GAAGpB,SAAS,CAACoB,cAAD,EAAiBksB,WAAjB,CAA1B;AACAA,QAAAA,WAAW,GAAG,CAAd;AACD;;AACD,UAAIzjC,QAAQ,CAAC0jC,YAAD,CAAR,IAA0BC,SAAS,GAAG,CAAtC,IAA2CA,SAAS,GAAGD,YAAY,CAACvR,SAAb,CAAuBx0C,MAAlF,EAA0F;AACxF+lD,QAAAA,YAAY,GAAGvtB,SAAS,CAACutB,YAAD,EAAeC,SAAf,CAAT,CAAmC/qC,eAAlD;AACA+qC,QAAAA,SAAS,GAAGD,YAAY,CAACvR,SAAb,CAAuBx0C,MAAnC;AACD;AACF;;AACD,WAAO;AACL45B,MAAAA,cAAc,EAAEA,cADX;AAELksB,MAAAA,WAAW,EAAEA,WAFR;AAGLC,MAAAA,YAAY,EAAEA,YAHT;AAILC,MAAAA,SAAS,EAAEA;AAJN,KAAP;AAMD,GA/BD;;AAiCA,MAAIoxB,UAAU,GAAG,UAAUpgE,GAAV,EAAe;AAC9B,QAAI3B,IAAI,GAAG,UAAU42C,GAAV,EAAetiD,QAAf,EAAyB;AAClC,aAAOqgE,MAAM,CAAChzD,GAAD,EAAMi1C,GAAN,EAAWtiD,QAAX,CAAb;AACD,KAFD;;AAGA,QAAIoK,KAAK,GAAGojE,OAAZ;;AACA,QAAIE,WAAW,GAAG,UAAUprB,GAAV,EAAe;AAC/B,aAAOgrB,SAAS,CAACjgE,GAAD,EAAMi1C,GAAN,CAAT,CAAoBjpD,IAApB,CAAyBV,KAAzB,EAAgC,UAAUg1E,aAAV,EAAyB;AAC9DrrB,QAAAA,GAAG,CAAC5G,QAAJ,CAAaiyB,aAAa,CAAC19C,cAA3B,EAA2C09C,aAAa,CAACxxB,WAAzD;AACAmG,QAAAA,GAAG,CAAC3G,MAAJ,CAAWgyB,aAAa,CAACvxB,YAAzB,EAAuCuxB,aAAa,CAACtxB,SAArD;AACA,eAAO,IAAP;AACD,OAJM,CAAP;AAKD,KAND;;AAOA,WAAO;AACL3wC,MAAAA,IAAI,EAAEA,IADD;AAELtB,MAAAA,KAAK,EAAEA,KAFF;AAGLkjE,MAAAA,SAAS,EAAEI;AAHN,KAAP;AAKD,GAjBD;;AAkBAD,EAAAA,UAAU,CAACG,aAAX,GAA2BvB,MAA3B;AACAoB,EAAAA,UAAU,CAACI,sBAAX,GAAoC7B,WAApC;AACAyB,EAAAA,UAAU,CAAC/lB,eAAX,GAA6BA,eAA7B;AACA+lB,EAAAA,UAAU,CAAC9lB,OAAX,GAAqBA,OAArB;;AAEA,MAAImmB,SAAS,GAAG,UAAU34E,IAAV,EAAgB44E,SAAhB,EAA2B;AACzC,QAAIv0D,GAAG,GAAG,UAAUjL,OAAV,EAAmBupC,CAAnB,EAAsB;AAC9B,UAAI,CAAC77C,QAAQ,CAAC67C,CAAD,CAAT,IAAgB,CAACA,CAAC,CAAC/sC,KAAF,CAAQ,UAAR,CAArB,EAA0C;AACxC,cAAM,IAAIrS,KAAJ,CAAUvD,IAAI,GAAG,uDAAP,GAAiE2iD,CAA3E,CAAN;AACD;;AACD,UAAIzqC,GAAG,GAAGkB,OAAO,CAAClB,GAAlB;;AACA,UAAI+L,aAAa,CAAC/L,GAAD,CAAjB,EAAwB;AACtBA,QAAAA,GAAG,CAACgM,KAAJ,CAAUlkB,IAAV,IAAkB2iD,CAAC,GAAG,IAAtB;AACD;AACF,KARD;;AASA,QAAI95C,GAAG,GAAG,UAAUuQ,OAAV,EAAmB;AAC3B,UAAI/R,CAAC,GAAGuxE,SAAS,CAACx/D,OAAD,CAAjB;;AACA,UAAI/R,CAAC,IAAI,CAAL,IAAUA,CAAC,KAAK,IAApB,EAA0B;AACxB,YAAI8d,GAAG,GAAGC,KAAK,CAAChM,OAAD,EAAUpZ,IAAV,CAAf;AACA,eAAO64E,UAAU,CAAC1zD,GAAD,CAAV,IAAmB,CAA1B;AACD;;AACD,aAAO9d,CAAP;AACD,KAPD;;AAQA,QAAIyxE,QAAQ,GAAGjwE,GAAf;;AACA,QAAIkwE,SAAS,GAAG,UAAU3/D,OAAV,EAAmB4/D,UAAnB,EAA+B;AAC7C,aAAOjxE,KAAK,CAACixE,UAAD,EAAa,UAAUlxE,GAAV,EAAekd,QAAf,EAAyB;AAChD,YAAI0G,GAAG,GAAGtG,KAAK,CAAChM,OAAD,EAAU4L,QAAV,CAAf;AACA,YAAIpiB,KAAK,GAAG8oB,GAAG,KAAKhsB,SAAR,GAAoB,CAApB,GAAwB8+B,QAAQ,CAAC9S,GAAD,EAAM,EAAN,CAA5C;AACA,eAAOutD,KAAK,CAACr2E,KAAD,CAAL,GAAekF,GAAf,GAAqBA,GAAG,GAAGlF,KAAlC;AACD,OAJW,EAIT,CAJS,CAAZ;AAKD,KAND;;AAOA,QAAIif,GAAG,GAAG,UAAUzI,OAAV,EAAmBxW,KAAnB,EAA0Bo2E,UAA1B,EAAsC;AAC9C,UAAIE,oBAAoB,GAAGH,SAAS,CAAC3/D,OAAD,EAAU4/D,UAAV,CAApC;AACA,UAAIG,WAAW,GAAGv2E,KAAK,GAAGs2E,oBAAR,GAA+Bt2E,KAAK,GAAGs2E,oBAAvC,GAA8D,CAAhF;AACA,aAAOC,WAAP;AACD,KAJD;;AAKA,WAAO;AACL90D,MAAAA,GAAG,EAAEA,GADA;AAELxb,MAAAA,GAAG,EAAEA,GAFA;AAGLiwE,MAAAA,QAAQ,EAAEA,QAHL;AAILC,MAAAA,SAAS,EAAEA,SAJN;AAKLl3D,MAAAA,GAAG,EAAEA;AALA,KAAP;AAOD,GAtCD;;AAwCA,MAAIu3D,KAAK,GAAGT,SAAS,CAAC,QAAD,EAAW,UAAUv/D,OAAV,EAAmB;AACjD,QAAIlB,GAAG,GAAGkB,OAAO,CAAClB,GAAlB;AACA,WAAOiH,MAAM,CAAC/F,OAAD,CAAN,GAAkBlB,GAAG,CAACyH,qBAAJ,GAA4ByB,MAA9C,GAAuDlJ,GAAG,CAACoO,YAAlE;AACD,GAHoB,CAArB;;AAIA,MAAI+yD,KAAK,GAAG,UAAUjgE,OAAV,EAAmB;AAC7B,WAAOggE,KAAK,CAACvwE,GAAN,CAAUuQ,OAAV,CAAP;AACD,GAFD;;AAIA,MAAIkgE,MAAM,GAAG,UAAUC,UAAV,EAAsBpiE,GAAtB,EAA2B;AACtC,QAAIqiE,KAAK,GAAGD,UAAU,CAACE,IAAX,CAAgBtiE,GAAhB,CAAZ;AACA,WAAOqiE,KAAK,CAACt1E,IAAN,CAAWvB,QAAQ,CAAC,EAAD,CAAnB,EAAyB,UAAU/B,CAAV,EAAa;AAC3C,UAAIsV,MAAM,GAAGqjE,UAAU,CAACr+D,KAAX,CAAiBta,CAAjB,CAAb;AACA,UAAI84E,IAAI,GAAGJ,MAAM,CAACC,UAAD,EAAarjE,MAAb,CAAjB;AACA,aAAO,CAACtV,CAAD,EAAIuC,MAAJ,CAAWu2E,IAAX,CAAP;AACD,KAJM,CAAP;AAKD,GAPD;;AAQA,MAAIC,MAAM,GAAG,UAAUvgE,OAAV,EAAmBmgE,UAAnB,EAA+B;AAC1C,QAAI9iE,CAAC,GAAG8iE,UAAU,CAACr+D,KAAX,CAAiB9B,OAAjB,CAAR;AACA,WAAOkgE,MAAM,CAACC,UAAD,EAAa9iE,CAAb,CAAb;AACD,GAHD;;AAKA,MAAIgjE,IAAI,GAAG,UAAUtiE,GAAV,EAAe;AACxB,QAAI23C,EAAJ;;AACA,QAAI11C,OAAO,GAAGjC,GAAG,CAACe,GAAJ,KAAY7D,QAAZ,GAAuBtO,QAAQ,CAACrC,IAAT,EAAvB,GAAyCqC,QAAQ,CAACD,IAAT,CAAc,CAACgpD,EAAE,GAAG33C,GAAG,CAACe,GAAJ,CAAQqD,WAAd,MAA+B,IAA/B,IAAuCuzC,EAAE,KAAK,KAAK,CAAnD,GAAuD,KAAK,CAA5D,GAAgEA,EAAE,CAAC8qB,YAAjF,CAAvD;AACA,WAAOxgE,OAAO,CAACvU,GAAR,CAAYyT,YAAY,CAACX,OAAzB,CAAP;AACD,GAJD;;AAKA,MAAIu4C,OAAO,GAAG,UAAU92C,OAAV,EAAmB;AAC/B,WAAOgC,eAAe,CAAChC,OAAD,CAAtB;AACD,GAFD;;AAIA,MAAIygE,UAAU,GAAG,aAAar4E,MAAM,CAACs4E,MAAP,CAAc;AACxCC,IAAAA,SAAS,EAAE,IAD6B;AAExCN,IAAAA,IAAI,EAAEA,IAFkC;AAGxCv+D,IAAAA,KAAK,EAAEg1C;AAHiC,GAAd,CAA9B;;AAMA,MAAI8pB,MAAM,GAAG,UAAU5gE,OAAV,EAAmB;AAC9B,QAAIjC,GAAG,GAAGmB,YAAY,CAACX,OAAb,CAAqBtD,QAArB,CAAV;AACA,QAAImN,MAAM,GAAGhB,KAAK,CAACrJ,GAAD,CAAlB;AACA,QAAI8iE,MAAM,GAAGN,MAAM,CAACvgE,OAAD,EAAUygE,UAAV,CAAnB;AACA,QAAI//C,MAAM,GAAGvZ,QAAQ,CAACnH,OAAD,CAArB;AACA,QAAI/R,CAAC,GAAGQ,KAAK,CAACoyE,MAAD,EAAS,UAAUp0E,CAAV,EAAanD,CAAb,EAAgB;AACpC,UAAIw3E,GAAG,GAAG35D,QAAQ,CAAC7d,CAAD,CAAlB;AACA,aAAO;AACL2c,QAAAA,IAAI,EAAExZ,CAAC,CAACwZ,IAAF,GAAS66D,GAAG,CAAC76D,IADd;AAELC,QAAAA,GAAG,EAAEzZ,CAAC,CAACyZ,GAAF,GAAQ46D,GAAG,CAAC56D;AAFZ,OAAP;AAID,KANY,EAMV;AACDD,MAAAA,IAAI,EAAE,CADL;AAEDC,MAAAA,GAAG,EAAE;AAFJ,KANU,CAAb;AAUA,WAAOE,aAAa,CAACnY,CAAC,CAACgY,IAAF,GAASya,MAAM,CAACza,IAAhB,GAAuBmC,MAAM,CAACnC,IAA/B,EAAqChY,CAAC,CAACiY,GAAF,GAAQwa,MAAM,CAACxa,GAAf,GAAqBkC,MAAM,CAAClC,GAAjE,CAApB;AACD,GAhBD;;AAkBA,MAAI66D,kBAAkB,GAAG,UAAU/gE,OAAV,EAAmB;AAC1C,WAAOpZ,IAAI,CAACoZ,OAAD,CAAJ,KAAkB,UAAzB;AACD,GAFD;;AAGA,MAAIghE,uBAAuB,GAAG,UAAUlnD,MAAV,EAAkBxF,IAAlB,EAAwB;AACpD,QAAI2sD,WAAW,GAAGnnD,MAAM,CAACmb,IAAP,CAAY,gBAAZ,EAA8B3gB,IAA9B,CAAlB;AACA,WAAO2sD,WAAW,CAACpvC,kBAAZ,EAAP;AACD,GAHD;;AAIA,MAAIqvC,4BAA4B,GAAG,UAAUpnD,MAAV,EAAkBxF,IAAlB,EAAwB;AACzDwF,IAAAA,MAAM,CAACmb,IAAP,CAAY,qBAAZ,EAAmC3gB,IAAnC;AACD,GAFD;;AAGA,MAAI6sD,OAAO,GAAG,UAAUnhE,OAAV,EAAmB0gB,MAAnB,EAA2B;AACvC,QAAI5a,UAAU,GAAGjD,QAAQ,CAAC7C,OAAD,CAAzB;;AACA,QAAI8F,UAAU,CAAChe,MAAX,KAAsB,CAAtB,IAA2Bi5E,kBAAkB,CAAC/gE,OAAD,CAAjD,EAA4D;AAC1D,aAAO;AACLA,QAAAA,OAAO,EAAEA,OADJ;AAEL0gB,QAAAA,MAAM,EAAEA;AAFH,OAAP;AAID,KALD,MAKO,IAAIA,MAAM,GAAG5a,UAAU,CAAChe,MAApB,IAA8B,CAACi5E,kBAAkB,CAACj7D,UAAU,CAAC4a,MAAD,CAAX,CAArD,EAA2E;AAChF,aAAO;AACL1gB,QAAAA,OAAO,EAAE8F,UAAU,CAAC4a,MAAD,CADd;AAELA,QAAAA,MAAM,EAAE;AAFH,OAAP;AAID,KALM,MAKA;AACL,UAAI/wB,IAAI,GAAGmW,UAAU,CAACA,UAAU,CAAChe,MAAX,GAAoB,CAArB,CAArB;;AACA,UAAIi5E,kBAAkB,CAACpxE,IAAD,CAAtB,EAA8B;AAC5B,eAAO;AACLqQ,UAAAA,OAAO,EAAEA,OADJ;AAEL0gB,UAAAA,MAAM,EAAEA;AAFH,SAAP;AAID,OALD,MAKO;AACL,YAAI95B,IAAI,CAAC+I,IAAD,CAAJ,KAAe,KAAnB,EAA0B;AACxB,iBAAO;AACLqQ,YAAAA,OAAO,EAAErQ,IADJ;AAEL+wB,YAAAA,MAAM,EAAE;AAFH,WAAP;AAID,SALD,MAKO,IAAI/e,MAAM,CAAChS,IAAD,CAAV,EAAkB;AACvB,iBAAO;AACLqQ,YAAAA,OAAO,EAAErQ,IADJ;AAEL+wB,YAAAA,MAAM,EAAEyzC,KAAK,CAACxkE,IAAD,CAAL,CAAY7H;AAFf,WAAP;AAID,SALM,MAKA;AACL,iBAAO;AACLkY,YAAAA,OAAO,EAAErQ,IADJ;AAEL+wB,YAAAA,MAAM,EAAE7d,QAAQ,CAAClT,IAAD,CAAR,CAAe7H;AAFlB,WAAP;AAID;AACF;AACF;AACF,GAtCD;;AAuCA,MAAIs5E,UAAU,GAAG,UAAUphE,OAAV,EAAmBqhE,UAAnB,EAA+B;AAC9C,QAAI9zD,GAAG,GAAG9G,QAAQ,CAACzG,OAAD,CAAlB;AACA,QAAIgI,MAAM,GAAGi4D,KAAK,CAACjgE,OAAD,CAAlB;AACA,WAAO;AACLA,MAAAA,OAAO,EAAEA,OADJ;AAELkI,MAAAA,MAAM,EAAEqF,GAAG,CAACrH,GAAJ,GAAU8B,MAFb;AAGLA,MAAAA,MAAM,EAAEA,MAHH;AAILuF,MAAAA,GAAG,EAAEA,GAJA;AAKLohC,MAAAA,OAAO,EAAE0yB;AALJ,KAAP;AAOD,GAVD;;AAWA,MAAIC,YAAY,GAAG,UAAUthE,OAAV,EAAmB0gB,MAAnB,EAA2B;AAC5C,QAAI+wC,UAAU,GAAG0P,OAAO,CAACnhE,OAAD,EAAU0gB,MAAV,CAAxB;AACA,QAAIo1B,IAAI,GAAG52C,YAAY,CAACtB,QAAb,CAAsB,gCAAgC8hB,IAAhC,GAAuC,SAA7D,CAAX;AACAhb,IAAAA,MAAM,CAAC+sD,UAAU,CAACzxD,OAAZ,EAAqB81C,IAArB,CAAN;AACA,WAAOsrB,UAAU,CAACtrB,IAAD,EAAO,YAAY;AAClC,aAAOnwC,MAAM,CAACmwC,IAAD,CAAb;AACD,KAFgB,CAAjB;AAGD,GAPD;;AAQA,MAAIyrB,aAAa,GAAG,UAAUvhE,OAAV,EAAmB;AACrC,WAAOohE,UAAU,CAACliE,YAAY,CAACX,OAAb,CAAqByB,OAArB,CAAD,EAAgCrX,IAAhC,CAAjB;AACD,GAFD;;AAGA,MAAI64E,UAAU,GAAG,UAAU1nD,MAAV,EAAkBtyB,CAAlB,EAAqBusD,GAArB,EAA0BtsC,UAA1B,EAAsC;AACrDg6D,IAAAA,YAAY,CAAC3nD,MAAD,EAAS,UAAU/uB,EAAV,EAAc+pE,EAAd,EAAkB;AACrC,aAAO4M,eAAe,CAAC5nD,MAAD,EAAStyB,CAAT,EAAYusD,GAAZ,EAAiBtsC,UAAjB,CAAtB;AACD,KAFW,EAETssC,GAFS,CAAZ;AAGD,GAJD;;AAKA,MAAI4tB,gBAAgB,GAAG,UAAU7nD,MAAV,EAAkB/b,GAAlB,EAAuBvW,CAAvB,EAA0Bmd,MAA1B,EAAkC8C,UAAlC,EAA8C;AACnE,QAAI6M,IAAI,GAAG;AACTzH,MAAAA,GAAG,EAAElI,MAAM,CAAC3E,OAAP,CAAelB,GADX;AAET2I,MAAAA,UAAU,EAAEA;AAFH,KAAX;;AAIA,QAAIu5D,uBAAuB,CAAClnD,MAAD,EAASxF,IAAT,CAA3B,EAA2C;AACzC;AACD;;AACD,QAAIzN,SAAS,GAAGO,KAAK,CAACrJ,GAAD,CAAL,CAAWmI,GAA3B;AACA1e,IAAAA,CAAC,CAACuW,GAAD,EAAM8I,SAAN,EAAiBlC,MAAjB,EAAyB8C,UAAzB,CAAD;AACAy5D,IAAAA,4BAA4B,CAACpnD,MAAD,EAASxF,IAAT,CAA5B;AACD,GAXD;;AAYA,MAAIotD,eAAe,GAAG,UAAU5nD,MAAV,EAAkBtyB,CAAlB,EAAqBusD,GAArB,EAA0BtsC,UAA1B,EAAsC;AAC1D,QAAIzB,IAAI,GAAG9G,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAX;AACA,QAAIn2C,GAAG,GAAGmB,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACm7C,MAAP,EAArB,CAAV;AACA1oD,IAAAA,MAAM,CAACvG,IAAD,CAAN;AACA,QAAIrB,MAAM,GAAG28D,YAAY,CAACpiE,YAAY,CAACX,OAAb,CAAqBw1C,GAAG,CAACryB,cAAzB,CAAD,EAA2CqyB,GAAG,CAACnG,WAA/C,CAAzB;AACA+zB,IAAAA,gBAAgB,CAAC7nD,MAAD,EAAS/b,GAAT,EAAcvW,CAAd,EAAiBmd,MAAjB,EAAyB8C,UAAzB,CAAhB;AACA9C,IAAAA,MAAM,CAACgqC,OAAP;AACD,GAPD;;AAQA,MAAIizB,WAAW,GAAG,UAAU9nD,MAAV,EAAkB9Z,OAAlB,EAA2BxY,CAA3B,EAA8BigB,UAA9B,EAA0C;AAC1D,QAAI1J,GAAG,GAAGmB,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACm7C,MAAP,EAArB,CAAV;AACA0M,IAAAA,gBAAgB,CAAC7nD,MAAD,EAAS/b,GAAT,EAAcvW,CAAd,EAAiB+5E,aAAa,CAACvhE,OAAD,CAA9B,EAAyCyH,UAAzC,CAAhB;AACD,GAHD;;AAIA,MAAIg6D,YAAY,GAAG,UAAU3nD,MAAV,EAAkBtyB,CAAlB,EAAqBusD,GAArB,EAA0B;AAC3C,QAAI8tB,YAAY,GAAG9tB,GAAG,CAACryB,cAAvB;AACA,QAAIksB,WAAW,GAAGmG,GAAG,CAACnG,WAAtB;AACA,QAAIk0B,UAAU,GAAG/tB,GAAG,CAAClG,YAArB;AACA,QAAIC,SAAS,GAAGiG,GAAG,CAACjG,SAApB;AACAtmD,IAAAA,CAAC,CAAC0X,YAAY,CAACX,OAAb,CAAqBsjE,YAArB,CAAD,EAAqC3iE,YAAY,CAACX,OAAb,CAAqBujE,UAArB,CAArC,CAAD;AACA,QAAIhnB,MAAM,GAAGhhC,MAAM,CAAChb,GAAP,CAAW+tC,SAAX,EAAb;AACAiO,IAAAA,MAAM,CAAC3N,QAAP,CAAgB00B,YAAhB,EAA8Bj0B,WAA9B;AACAkN,IAAAA,MAAM,CAAC1N,MAAP,CAAc00B,UAAd,EAA0Bh0B,SAA1B;AACAh0B,IAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB;AACD,GAVD;;AAWA,MAAIguB,cAAc,GAAG,UAAUp9D,MAAV,EAAkBq9D,UAAlB,EAA8Bv6D,UAA9B,EAA0C1J,GAA1C,EAA+C;AAClE,QAAIwP,GAAG,GAAG5I,MAAM,CAAC4I,GAAjB;;AACA,QAAI9F,UAAJ,EAAgB;AACdH,MAAAA,EAAE,CAACiG,GAAG,CAACtH,IAAL,EAAWsH,GAAG,CAACrH,GAAf,EAAoBnI,GAApB,CAAF;AACD,KAFD,MAEO;AACL,UAAIrW,CAAC,GAAG6lB,GAAG,CAACrH,GAAJ,GAAU87D,UAAV,GAAuBr9D,MAAM,CAACqD,MAAtC;AACAV,MAAAA,EAAE,CAACiG,GAAG,CAACtH,IAAL,EAAWve,CAAX,EAAcqW,GAAd,CAAF;AACD;AACF,GARD;;AASA,MAAIkkE,kBAAkB,GAAG,UAAUlkE,GAAV,EAAe8I,SAAf,EAA0Bm7D,UAA1B,EAAsCr9D,MAAtC,EAA8C8C,UAA9C,EAA0D;AACjF,QAAIy6D,cAAc,GAAGF,UAAU,GAAGn7D,SAAlC;AACA,QAAIs7D,SAAS,GAAGx9D,MAAM,CAAC4I,GAAP,CAAWrH,GAA3B;AACA,QAAIk8D,YAAY,GAAGz9D,MAAM,CAACuD,MAA1B;AACA,QAAIm6D,kBAAkB,GAAGD,YAAY,GAAGD,SAAf,IAA4BH,UAArD;;AACA,QAAIG,SAAS,GAAGt7D,SAAhB,EAA2B;AACzBk7D,MAAAA,cAAc,CAACp9D,MAAD,EAASq9D,UAAT,EAAqBv6D,UAAU,KAAK,KAApC,EAA2C1J,GAA3C,CAAd;AACD,KAFD,MAEO,IAAIokE,SAAS,GAAGD,cAAhB,EAAgC;AACrC,UAAII,KAAK,GAAGD,kBAAkB,GAAG56D,UAAU,KAAK,KAAlB,GAA0BA,UAAU,KAAK,IAAvE;AACAs6D,MAAAA,cAAc,CAACp9D,MAAD,EAASq9D,UAAT,EAAqBM,KAArB,EAA4BvkE,GAA5B,CAAd;AACD,KAHM,MAGA,IAAIqkE,YAAY,GAAGF,cAAf,IAAiC,CAACG,kBAAtC,EAA0D;AAC/DN,MAAAA,cAAc,CAACp9D,MAAD,EAASq9D,UAAT,EAAqBv6D,UAAU,KAAK,IAApC,EAA0C1J,GAA1C,CAAd;AACD;AACF,GAbD;;AAcA,MAAIwkE,UAAU,GAAG,UAAUxkE,GAAV,EAAe8I,SAAf,EAA0BlC,MAA1B,EAAkC8C,UAAlC,EAA8C;AAC7D,QAAIu6D,UAAU,GAAGjkE,GAAG,CAACe,GAAJ,CAAQqD,WAAR,CAAoBqgE,WAArC;AACAP,IAAAA,kBAAkB,CAAClkE,GAAD,EAAM8I,SAAN,EAAiBm7D,UAAjB,EAA6Br9D,MAA7B,EAAqC8C,UAArC,CAAlB;AACD,GAHD;;AAIA,MAAIg7D,SAAS,GAAG,UAAU1kE,GAAV,EAAe8I,SAAf,EAA0BlC,MAA1B,EAAkC8C,UAAlC,EAA8C;AAC5D,QAAIi7D,eAAe,GAAG3kE,GAAG,CAACe,GAAJ,CAAQqD,WAAR,CAAoBqgE,WAA1C;AACAP,IAAAA,kBAAkB,CAAClkE,GAAD,EAAM8I,SAAN,EAAiB67D,eAAjB,EAAkC/9D,MAAlC,EAA0C8C,UAA1C,CAAlB;AACA,QAAIk7D,EAAE,GAAG/B,MAAM,CAACj8D,MAAM,CAAC3E,OAAR,CAAf;AACA,QAAI4iE,cAAc,GAAGz6D,SAAS,CAACxO,MAAD,CAA9B;;AACA,QAAIgpE,EAAE,CAACz8D,GAAH,GAAS08D,cAAc,CAACl7E,CAA5B,EAA+B;AAC7B8f,MAAAA,QAAQ,CAAC7C,MAAM,CAAC3E,OAAR,EAAiByH,UAAU,KAAK,KAAhC,CAAR;AACD,KAFD,MAEO,IAAIk7D,EAAE,CAACz8D,GAAH,GAAS08D,cAAc,CAAC16D,MAA5B,EAAoC;AACzCV,MAAAA,QAAQ,CAAC7C,MAAM,CAAC3E,OAAR,EAAiByH,UAAU,KAAK,IAAhC,CAAR;AACD;AACF,GAVD;;AAWA,MAAIo7D,eAAe,GAAG,UAAU/oD,MAAV,EAAkBi6B,GAAlB,EAAuBtsC,UAAvB,EAAmC;AACvD,WAAO+5D,UAAU,CAAC1nD,MAAD,EAASyoD,UAAT,EAAqBxuB,GAArB,EAA0BtsC,UAA1B,CAAjB;AACD,GAFD;;AAGA,MAAIq7D,iBAAiB,GAAG,UAAUhpD,MAAV,EAAkB9Z,OAAlB,EAA2ByH,UAA3B,EAAuC;AAC7D,WAAOm6D,WAAW,CAAC9nD,MAAD,EAAS9Z,OAAT,EAAkBuiE,UAAlB,EAA8B96D,UAA9B,CAAlB;AACD,GAFD;;AAGA,MAAIs7D,cAAc,GAAG,UAAUjpD,MAAV,EAAkBi6B,GAAlB,EAAuBtsC,UAAvB,EAAmC;AACtD,WAAO+5D,UAAU,CAAC1nD,MAAD,EAAS2oD,SAAT,EAAoB1uB,GAApB,EAAyBtsC,UAAzB,CAAjB;AACD,GAFD;;AAGA,MAAIu7D,gBAAgB,GAAG,UAAUlpD,MAAV,EAAkB9Z,OAAlB,EAA2ByH,UAA3B,EAAuC;AAC5D,WAAOm6D,WAAW,CAAC9nD,MAAD,EAAS9Z,OAAT,EAAkByiE,SAAlB,EAA6Bh7D,UAA7B,CAAlB;AACD,GAFD;;AAGA,MAAIw7D,qBAAqB,GAAG,UAAUnpD,MAAV,EAAkB9Z,OAAlB,EAA2ByH,UAA3B,EAAuC;AACjE,QAAIy7D,QAAQ,GAAGppD,MAAM,CAAC+R,MAAP,GAAgBi3C,iBAAhB,GAAoCE,gBAAnD;AACAE,IAAAA,QAAQ,CAACppD,MAAD,EAAS9Z,OAAT,EAAkByH,UAAlB,CAAR;AACD,GAHD;;AAIA,MAAI07D,mBAAmB,GAAG,UAAUrpD,MAAV,EAAkBi6B,GAAlB,EAAuBtsC,UAAvB,EAAmC;AAC3D,QAAIy7D,QAAQ,GAAGppD,MAAM,CAAC+R,MAAP,GAAgBg3C,eAAhB,GAAkCE,cAAjD;AACAG,IAAAA,QAAQ,CAACppD,MAAD,EAASi6B,GAAT,EAActsC,UAAd,CAAR;AACD,GAHD;;AAKA,MAAI27D,WAAW,GAAG,YAAY;AAC5B,WAAOlkE,YAAY,CAACX,OAAb,CAAqBtD,QAArB,CAAP;AACD,GAFD;;AAIA,MAAImjC,KAAK,GAAG,UAAUp+B,OAAV,EAAmB;AAC7B,WAAOA,OAAO,CAAClB,GAAR,CAAYs/B,KAAZ,EAAP;AACD,GAFD;;AAGA,MAAIE,QAAQ,GAAG,UAAUt+B,OAAV,EAAmB;AAChC,QAAI/D,IAAI,GAAG6H,WAAW,CAAC9D,OAAD,CAAX,CAAqBlB,GAAhC;AACA,WAAOkB,OAAO,CAAClB,GAAR,KAAgB7C,IAAI,CAACoiC,aAA5B;AACD,GAHD;;AAIA,MAAIvqB,MAAM,GAAG,UAAU7X,IAAV,EAAgB;AAC3B,QAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AACnBA,MAAAA,IAAI,GAAGmnE,WAAW,EAAlB;AACD;;AACD,WAAOz2E,QAAQ,CAACD,IAAT,CAAcuP,IAAI,CAAC6C,GAAL,CAASu/B,aAAvB,EAAsC5yC,GAAtC,CAA0CyT,YAAY,CAACX,OAAvD,CAAP;AACD,GALD;;AAMA,MAAI9I,MAAM,GAAG,UAAUuK,OAAV,EAAmB;AAC9B,WAAO8T,MAAM,CAAChQ,WAAW,CAAC9D,OAAD,CAAZ,CAAN,CAA6BlU,MAA7B,CAAoC,UAAU6G,CAAV,EAAa;AACtD,aAAOqN,OAAO,CAAClB,GAAR,CAAY5Q,QAAZ,CAAqByE,CAAC,CAACmM,GAAvB,CAAP;AACD,KAFM,CAAP;AAGD,GAJD;;AAMA,MAAIukE,QAAQ,GAAG,UAAU9sE,KAAV,EAAiB+sE,OAAjB,EAA0BC,MAA1B,EAAkCC,OAAlC,EAA2C;AACxD,WAAO;AACLjtE,MAAAA,KAAK,EAAEA,KADF;AAEL+sE,MAAAA,OAAO,EAAEA,OAFJ;AAGLC,MAAAA,MAAM,EAAEA,MAHH;AAILC,MAAAA,OAAO,EAAEA;AAJJ,KAAP;AAMD,GAPD;;AAQA,MAAIC,QAAQ,GAAG;AAAEznE,IAAAA,MAAM,EAAEqnE;AAAV,GAAf;AAEA,MAAItsD,GAAG,GAAGa,GAAG,CAAChB,QAAJ,CAAa,CACrB;AAAElS,IAAAA,MAAM,EAAE,CAAC,SAAD;AAAV,GADqB,EAErB;AACEkL,IAAAA,EAAE,EAAE,CACF,SADE,EAEF,QAFE;AADN,GAFqB,EAQrB;AAAE9K,IAAAA,KAAK,EAAE,CAAC,SAAD;AAAT,GARqB,CAAb,CAAV;;AAUA,MAAI4+D,IAAI,GAAG,UAAUC,OAAV,EAAmBC,QAAnB,EAA6BC,IAA7B,EAAmCC,OAAnC,EAA4C;AACrD,WAAOH,OAAO,CAAC74E,IAAR,CAAa84E,QAAb,EAAuBC,IAAvB,EAA6BC,OAA7B,CAAP;AACD,GAFD;;AAGA,MAAItH,QAAQ,GAAG,UAAUuH,IAAV,EAAgB;AAC7B,WAAOA,IAAI,CAACj5E,IAAL,CAAUrB,QAAV,EAAoBA,QAApB,EAA8BA,QAA9B,CAAP;AACD,GAFD;;AAGA,MAAIu6E,QAAQ,GAAGjtD,GAAG,CAACrS,MAAnB;AACA,MAAIkL,EAAE,GAAGmH,GAAG,CAACnH,EAAb;AACA,MAAIq0D,OAAO,GAAGltD,GAAG,CAACjS,KAAlB;AACA,MAAIo/D,IAAI,GAAG;AACTx/D,IAAAA,MAAM,EAAEs/D,QADC;AAETp0D,IAAAA,EAAE,EAAEA,EAFK;AAGT9K,IAAAA,KAAK,EAAEm/D,OAHE;AAITP,IAAAA,IAAI,EAAEA,IAJG;AAKTlH,IAAAA,QAAQ,EAAEA;AALD,GAAX;AAQA,MAAI2H,KAAK,GAAGvsD,GAAG,CAAChB,QAAJ,CAAa,CACvB;AAAEwtD,IAAAA,QAAQ,EAAE,CAAC,KAAD;AAAZ,GADuB,EAEvB;AACE3nC,IAAAA,QAAQ,EAAE,CACR,WADQ,EAER,YAFQ;AADZ,GAFuB,EAQvB;AACE4nC,IAAAA,KAAK,EAAE,CACL,OADK,EAEL,SAFK,EAGL,QAHK,EAIL,SAJK;AADT,GARuB,CAAb,CAAZ;;AAiBA,MAAIC,cAAc,GAAG,UAAUC,QAAV,EAAoB;AACvC,WAAOJ,KAAK,CAACE,KAAN,CAAYE,QAAQ,CAAChuE,KAArB,EAA4BguE,QAAQ,CAACjB,OAArC,EAA8CiB,QAAQ,CAAChB,MAAvD,EAA+DgB,QAAQ,CAACf,OAAxE,CAAP;AACD,GAFD;;AAGA,MAAIgB,UAAU,GAAG,UAAUxwB,SAAV,EAAqB;AACpC,WAAOA,SAAS,CAACx3C,KAAV,CAAgB;AACrB4nE,MAAAA,QAAQ,EAAE,UAAUrwB,GAAV,EAAe;AACvB,eAAO70C,YAAY,CAACX,OAAb,CAAqBw1C,GAAG,CAACryB,cAAzB,CAAP;AACD,OAHoB;AAIrB+a,MAAAA,QAAQ,EAAE,UAAUgoC,SAAV,EAAqBC,WAArB,EAAkC;AAC1C,eAAOR,IAAI,CAAC1H,QAAL,CAAciI,SAAd,CAAP;AACD,OANoB;AAOrBJ,MAAAA,KAAK,EAAE,UAAU9tE,KAAV,EAAiBouE,QAAjB,EAA2BC,OAA3B,EAAoCC,QAApC,EAA8C;AACnD,eAAOtuE,KAAP;AACD;AAToB,KAAhB,CAAP;AAWD,GAZD;;AAaA,MAAI6tE,QAAQ,GAAGD,KAAK,CAACC,QAArB;AACA,MAAI3nC,QAAQ,GAAG0nC,KAAK,CAAC1nC,QAArB;AACA,MAAI4nC,KAAK,GAAGF,KAAK,CAACE,KAAlB;;AACA,MAAIS,MAAM,GAAG,UAAU9wB,SAAV,EAAqB;AAChC,QAAIz9C,KAAK,GAAGiuE,UAAU,CAACxwB,SAAD,CAAtB;AACA,WAAO7xC,WAAW,CAAC5L,KAAD,CAAlB;AACD,GAHD;;AAIA,MAAIuE,KAAK,GAAG2oE,QAAQ,CAACznE,MAArB;AACA,MAAI+oE,YAAY,GAAG;AACjBX,IAAAA,QAAQ,EAAEA,QADO;AAEjB3nC,IAAAA,QAAQ,EAAEA,QAFO;AAGjB4nC,IAAAA,KAAK,EAAEA,KAHU;AAIjBC,IAAAA,cAAc,EAAEA,cAJC;AAKjBQ,IAAAA,MAAM,EAAEA,MALS;AAMjBhqE,IAAAA,KAAK,EAAEA;AANU,GAAnB;AASA,MAAIkqE,SAAS,GAAGhrE,QAAQ,GAAG1G,OAA3B;;AACA,MAAI2xE,KAAK,GAAG,UAAUvkD,MAAV,EAAkB1gB,OAAlB,EAA2B;AACrC,QAAIyI,GAAG,GAAG9G,MAAM,CAAC3B,OAAD,CAAN,GAAkBm0D,KAAK,CAACn0D,OAAD,CAAL,CAAelY,MAAjC,GAA0C+a,QAAQ,CAAC7C,OAAD,CAAR,CAAkBlY,MAAlB,GAA2B,CAA/E;;AACA,QAAI44B,MAAM,GAAGjY,GAAb,EAAkB;AAChB,aAAOA,GAAP;AACD,KAFD,MAEO,IAAIiY,MAAM,GAAG,CAAb,EAAgB;AACrB,aAAO,CAAP;AACD;;AACD,WAAOA,MAAP;AACD,GARD;;AASA,MAAIwkD,YAAY,GAAG,UAAUnxB,GAAV,EAAe;AAChC,WAAOgxB,YAAY,CAACjqE,KAAb,CAAmBi5C,GAAG,CAACx9C,KAAvB,EAA8B0uE,KAAK,CAAClxB,GAAG,CAACuvB,OAAL,EAAcvvB,GAAG,CAACx9C,KAAlB,CAAnC,EAA6Dw9C,GAAG,CAACwvB,MAAjE,EAAyE0B,KAAK,CAAClxB,GAAG,CAACyvB,OAAL,EAAczvB,GAAG,CAACwvB,MAAlB,CAA9E,CAAP;AACD,GAFD;;AAGA,MAAI4B,YAAY,GAAG,UAAUlpE,IAAV,EAAgB4Q,GAAhB,EAAqB;AACtC,WAAO,CAAChE,gBAAgB,CAACgE,GAAG,CAAC/N,GAAL,CAAjB,KAA+BsC,UAAU,CAACnF,IAAD,EAAO4Q,GAAP,CAAV,IAAyBhM,IAAI,CAAC5E,IAAD,EAAO4Q,GAAP,CAA5D,CAAP;AACD,GAFD;;AAGA,MAAIu4D,WAAW,GAAG,UAAUnpE,IAAV,EAAgB;AAChC,WAAO,UAAU83C,GAAV,EAAe;AACpB,aAAOoxB,YAAY,CAAClpE,IAAD,EAAO83C,GAAG,CAACx9C,KAAX,CAAZ,IAAiC4uE,YAAY,CAAClpE,IAAD,EAAO83C,GAAG,CAACwvB,MAAX,CAApD;AACD,KAFD;AAGD,GAJD;;AAKA,MAAI8B,WAAW,GAAG,UAAUvrD,MAAV,EAAkB;AAClC,WAAOA,MAAM,CAAC+R,MAAP,KAAkB,IAAlB,IAA0Bm5C,SAAS,CAAC/sE,IAAV,EAAjC;AACD,GAFD;;AAGA,MAAIqtE,2BAA2B,GAAG,UAAUr3E,CAAV,EAAa;AAC7C,WAAO82E,YAAY,CAACjqE,KAAb,CAAmBoE,YAAY,CAACX,OAAb,CAAqBtQ,CAAC,CAACyzB,cAAvB,CAAnB,EAA2DzzB,CAAC,CAAC2/C,WAA7D,EAA0E1uC,YAAY,CAACX,OAAb,CAAqBtQ,CAAC,CAAC4/C,YAAvB,CAA1E,EAAgH5/C,CAAC,CAAC6/C,SAAlH,CAAP;AACD,GAFD;;AAGA,MAAIy3B,SAAS,GAAG,UAAU7+D,GAAV,EAAe;AAC7B,QAAIstC,SAAS,GAAGttC,GAAG,CAAC3L,YAAJ,EAAhB;AACA,QAAIg5C,GAAG,GAAG,CAACC,SAAD,IAAcA,SAAS,CAACwe,UAAV,KAAyB,CAAvC,GAA2C7lE,QAAQ,CAACrC,IAAT,EAA3C,GAA6DqC,QAAQ,CAACD,IAAT,CAAcsnD,SAAS,CAACye,UAAV,CAAqB,CAArB,CAAd,CAAvE;AACA,WAAO1e,GAAG,CAACtoD,GAAJ,CAAQ65E,2BAAR,CAAP;AACD,GAJD;;AAKA,MAAIE,aAAa,GAAG,UAAUvpE,IAAV,EAAgB;AAClC,QAAIyK,GAAG,GAAGvE,WAAW,CAAClG,IAAD,CAArB;AACA,WAAOspE,SAAS,CAAC7+D,GAAG,CAAC5H,GAAL,CAAT,CAAmBhT,MAAnB,CAA0Bs5E,WAAW,CAACnpE,IAAD,CAArC,CAAP;AACD,GAHD;;AAIA,MAAIwpE,QAAQ,GAAG,UAAUxpE,IAAV,EAAgBgiD,QAAhB,EAA0B;AACvC,WAAOtxD,QAAQ,CAACD,IAAT,CAAcuxD,QAAd,EAAwBnyD,MAAxB,CAA+Bs5E,WAAW,CAACnpE,IAAD,CAA1C,EAAkDxQ,GAAlD,CAAsDy5E,YAAtD,CAAP;AACD,GAFD;;AAGA,MAAIQ,mBAAmB,GAAG,UAAUznB,QAAV,EAAoB;AAC5C,QAAIlK,GAAG,GAAG94C,QAAQ,CAAC6xC,WAAT,EAAV;;AACA,QAAI;AACFiH,MAAAA,GAAG,CAAC5G,QAAJ,CAAa8Q,QAAQ,CAAC1nD,KAAT,CAAeuI,GAA5B,EAAiCm/C,QAAQ,CAACqlB,OAA1C;AACAvvB,MAAAA,GAAG,CAAC3G,MAAJ,CAAW6Q,QAAQ,CAACslB,MAAT,CAAgBzkE,GAA3B,EAAgCm/C,QAAQ,CAACulB,OAAzC;AACA,aAAO72E,QAAQ,CAACR,IAAT,CAAc4nD,GAAd,CAAP;AACD,KAJD,CAIE,OAAO79B,CAAP,EAAU;AACV,aAAOvpB,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF,GATD;;AAUA,MAAIq7E,KAAK,GAAG,UAAU7rD,MAAV,EAAkB;AAC5B,QAAI8rD,WAAW,GAAGP,WAAW,CAACvrD,MAAD,CAAX,GAAsB0rD,aAAa,CAACtmE,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAD,CAAnC,GAA8EvnD,QAAQ,CAACrC,IAAT,EAAhG;AACAwvB,IAAAA,MAAM,CAACmkC,QAAP,GAAkB2nB,WAAW,CAAC36E,MAAZ,KAAuB26E,WAAvB,GAAqC9rD,MAAM,CAACmkC,QAA9D;AACD,GAHD;;AAIA,MAAI4nB,WAAW,GAAG,UAAU/rD,MAAV,EAAkBi6B,GAAlB,EAAuB;AACvC,QAAI93C,IAAI,GAAGiD,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAX;AACA,QAAIp5C,KAAK,GAAGuqE,WAAW,CAACvrD,MAAD,CAAX,GAAsBntB,QAAQ,CAACD,IAAT,CAAcqnD,GAAd,CAAtB,GAA2CpnD,QAAQ,CAACrC,IAAT,EAAvD;AACA,QAAIs7E,WAAW,GAAG9qE,KAAK,CAACrP,GAAN,CAAU65E,2BAAV,EAAuCx5E,MAAvC,CAA8Cs5E,WAAW,CAACnpE,IAAD,CAAzD,CAAlB;AACA6d,IAAAA,MAAM,CAACmkC,QAAP,GAAkB2nB,WAAW,CAAC36E,MAAZ,KAAuB26E,WAAvB,GAAqC9rD,MAAM,CAACmkC,QAA9D;AACD,GALD;;AAMA,MAAIhK,MAAM,GAAG,UAAUn6B,MAAV,EAAkB;AAC7B,QAAImkC,QAAQ,GAAGnkC,MAAM,CAACmkC,QAAP,GAAkBnkC,MAAM,CAACmkC,QAAzB,GAAoCtxD,QAAQ,CAACrC,IAAT,EAAnD;AACA,WAAO2zD,QAAQ,CAACtyD,IAAT,CAAc,UAAUtF,CAAV,EAAa;AAChC,aAAOo/E,QAAQ,CAACvmE,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAD,EAAyC7tD,CAAzC,CAAf;AACD,KAFM,EAEJsF,IAFI,CAEC+5E,mBAFD,CAAP;AAGD,GALD;;AAMA,MAAII,OAAO,GAAG,UAAUhsD,MAAV,EAAkB;AAC9Bm6B,IAAAA,MAAM,CAACn6B,MAAD,CAAN,CAAepuB,IAAf,CAAoB,UAAUqoD,GAAV,EAAe;AACjC,aAAOj6B,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB,CAAP;AACD,KAFD;AAGD,GAJD;;AAMA,MAAIgyB,iBAAiB,GAAG,UAAUl5D,GAAV,EAAe;AACrC,QAAIsuB,SAAS,GAAGtuB,GAAG,CAACsuB,SAAJ,CAAcjvC,QAAd,EAAhB;AACA,WAAOivC,SAAS,CAACp0C,OAAV,CAAkB,MAAlB,MAA8B,CAAC,CAA/B,IAAoCo0C,SAAS,CAACp0C,OAAV,CAAkB,MAAlB,MAA8B,CAAC,CAA1E;AACD,GAHD;;AAIA,MAAIi/E,YAAY,GAAG;AAAED,IAAAA,iBAAiB,EAAEA;AAArB,GAAnB;;AAEA,MAAIE,kBAAkB,GAAG,UAAUtzE,CAAV,EAAa;AACpC,WAAOA,CAAC,CAAC7F,IAAF,KAAW,YAAX,IAA2B6F,CAAC,CAACuzE,eAApC;AACD,GAFD;;AAGA,MAAIC,mBAAmB,GAAG,UAAUrsD,MAAV,EAAkBssD,cAAlB,EAAkC;AAC1D,QAAIC,WAAW,GAAG,YAAY;AAC5BD,MAAAA,cAAc,CAACnsD,QAAf;AACD,KAFD;;AAGA4tB,IAAAA,QAAQ,CAAC2D,GAAT,CAAa7/C,IAAb,CAAkBsP,QAAlB,EAA4B,SAA5B,EAAuCorE,WAAvC;AACAvsD,IAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB,YAAY;AAC9Bi4B,MAAAA,QAAQ,CAAC2D,GAAT,CAAa1W,MAAb,CAAoB75B,QAApB,EAA8B,SAA9B,EAAyCorE,WAAzC;AACD,KAFD;AAGD,GARD;;AASA,MAAIC,gBAAgB,GAAG,UAAUxsD,MAAV,EAAkB;AACvCA,IAAAA,MAAM,CAAClK,EAAP,CAAU,UAAV,EAAsB,YAAY;AAChC+1D,MAAAA,KAAK,CAAC7rD,MAAD,CAAL;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIysD,eAAe,GAAG,UAAUzsD,MAAV,EAAkBssD,cAAlB,EAAkC;AACtDtsD,IAAAA,MAAM,CAAClK,EAAP,CAAU,kBAAV,EAA8B,UAAUklD,EAAV,EAAc;AAC1CsR,MAAAA,cAAc,CAACnsD,QAAf;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIusD,oBAAoB,GAAG,UAAU1sD,MAAV,EAAkBssD,cAAlB,EAAkC;AAC3D,QAAI9yE,OAAO,GAAG0G,QAAQ,GAAG1G,OAAzB;;AACA,QAAIA,OAAO,CAAC2E,IAAR,EAAJ,EAAoB;AAClBquE,MAAAA,gBAAgB,CAACxsD,MAAD,CAAhB;AACD,KAFD,MAEO;AACLysD,MAAAA,eAAe,CAACzsD,MAAD,EAASssD,cAAT,CAAf;AACD;;AACDtsD,IAAAA,MAAM,CAAClK,EAAP,CAAU,kBAAV,EAA8B,UAAUjd,CAAV,EAAa;AACzC,UAAI,CAACszE,kBAAkB,CAACtzE,CAAD,CAAvB,EAA4B;AAC1BgzE,QAAAA,KAAK,CAAC7rD,MAAD,CAAL;AACD;AACF,KAJD;AAKD,GAZD;;AAaA,MAAIs8B,QAAQ,GAAG,UAAUt8B,MAAV,EAAkB;AAC/B,QAAIssD,cAAc,GAAG1pC,KAAK,CAAC,YAAY;AACrCipC,MAAAA,KAAK,CAAC7rD,MAAD,CAAL;AACD,KAFyB,EAEvB,CAFuB,CAA1B;AAGAA,IAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,YAAY;AAC5B,UAAIkK,MAAM,CAAC+R,MAAX,EAAmB;AACjBs6C,QAAAA,mBAAmB,CAACrsD,MAAD,EAASssD,cAAT,CAAnB;AACD;;AACDI,MAAAA,oBAAoB,CAAC1sD,MAAD,EAASssD,cAAT,CAApB;AACD,KALD;AAMAtsD,IAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB,YAAY;AAC9Bw2D,MAAAA,cAAc,CAAC/wC,MAAf;AACD,KAFD;AAGD,GAbD;;AAeA,MAAIoxC,sBAAJ;AACA,MAAIC,KAAK,GAAG7+B,QAAQ,CAAC2D,GAArB;;AACA,MAAIm7B,mBAAmB,GAAG,UAAU95D,GAAV,EAAe;AACvC,WAAOm5D,YAAY,CAACD,iBAAb,CAA+Bl5D,GAA/B,CAAP;AACD,GAFD;;AAGA,MAAI+5D,0BAA0B,GAAG,UAAU/5D,GAAV,EAAe;AAC9C,QAAIkmC,SAAS,GAAGlmC,GAAG,CAACkmC,SAApB;;AACA,QAAIA,SAAS,KAAKzsD,SAAlB,EAA6B;AAC3B,aAAOysD,SAAS,CAAC7kD,QAAV,CAAmB,eAAnB,KAAuC6kD,SAAS,CAAC7kD,QAAV,CAAmB,uBAAnB,CAAvC,IAAsF6kD,SAAS,CAAC7kD,QAAV,CAAmB,kBAAnB,CAA7F;AACD,KAFD,MAEO;AACL,aAAO,KAAP;AACD;AACF,GAPD;;AAQA,MAAI24E,WAAW,GAAG,UAAU/sD,MAAV,EAAkBjN,GAAlB,EAAuB;AACvC,QAAIi6D,cAAc,GAAGjkB,mBAAmB,CAAC/oC,MAAD,CAAxC;AACA,QAAIhd,MAAM,GAAG4pE,KAAK,CAACr8B,SAAN,CAAgBx9B,GAAhB,EAAqB,UAAUA,GAAV,EAAe;AAC/C,aAAO85D,mBAAmB,CAAC95D,GAAD,CAAnB,KAA6Bi6D,cAAc,GAAGhtD,MAAM,CAAChb,GAAP,CAAW9T,EAAX,CAAc6hB,GAAd,EAAmBi6D,cAAnB,CAAH,GAAwC,KAAnF,CAAP;AACD,KAFY,CAAb;AAGA,WAAOhqE,MAAM,KAAK,IAAlB;AACD,GAND;;AAOA,MAAIiqE,gBAAgB,GAAG,UAAUjtD,MAAV,EAAkB;AACvC,QAAI;AACF,UAAI7d,IAAI,GAAG6H,WAAW,CAAC5E,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACsoC,UAAP,EAArB,CAAD,CAAtB;AACA,aAAOtuC,MAAM,CAAC7X,IAAD,CAAN,CAAanR,IAAb,CAAkB,YAAY;AACnC,eAAOmQ,QAAQ,CAAC+K,IAAhB;AACD,OAFM,EAEJ,UAAU3f,CAAV,EAAa;AACd,eAAOA,CAAC,CAACyY,GAAT;AACD,OAJM,CAAP;AAKD,KAPD,CAOE,OAAOoT,EAAP,EAAW;AACX,aAAOjX,QAAQ,CAAC+K,IAAhB;AACD;AACF,GAXD;;AAYA,MAAIghE,cAAc,GAAG,UAAUC,aAAV,EAAyBt0E,CAAzB,EAA4B;AAC/C,QAAImnB,MAAM,GAAGnnB,CAAC,CAACmnB,MAAf;AACAs8B,IAAAA,QAAQ,CAACt8B,MAAD,CAAR;AACAA,IAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,YAAY;AAC/B,UAAIs3D,aAAa,GAAGD,aAAa,CAACC,aAAlC;;AACA,UAAIA,aAAa,KAAKptD,MAAtB,EAA8B;AAC5B,YAAIotD,aAAJ,EAAmB;AACjBA,UAAAA,aAAa,CAACjyC,IAAd,CAAmB,MAAnB,EAA2B;AAAEiyC,YAAAA,aAAa,EAAEptD;AAAjB,WAA3B;AACD;;AACDmtD,QAAAA,aAAa,CAACE,SAAd,CAAwBrtD,MAAxB;AACAmtD,QAAAA,aAAa,CAACC,aAAd,GAA8BptD,MAA9B;AACAA,QAAAA,MAAM,CAACmb,IAAP,CAAY,OAAZ,EAAqB;AAAEmyC,UAAAA,aAAa,EAAEF;AAAjB,SAArB;AACAptD,QAAAA,MAAM,CAACskB,KAAP,CAAa,IAAb;AACD;AACF,KAXD;AAYAtkB,IAAAA,MAAM,CAAClK,EAAP,CAAU,UAAV,EAAsB,YAAY;AAChCgK,MAAAA,KAAK,CAACC,gBAAN,CAAuBC,MAAvB,EAA+B,YAAY;AACzC,YAAIotD,aAAa,GAAGD,aAAa,CAACC,aAAlC;;AACA,YAAI,CAACL,WAAW,CAAC/sD,MAAD,EAASitD,gBAAgB,CAACjtD,MAAD,CAAzB,CAAZ,IAAkDotD,aAAa,KAAKptD,MAAxE,EAAgF;AAC9EA,UAAAA,MAAM,CAACmb,IAAP,CAAY,MAAZ,EAAoB;AAAEiyC,YAAAA,aAAa,EAAE;AAAjB,WAApB;AACAD,UAAAA,aAAa,CAACC,aAAd,GAA8B,IAA9B;AACD;AACF,OAND;AAOD,KARD;;AASA,QAAI,CAACT,sBAAL,EAA6B;AAC3BA,MAAAA,sBAAsB,GAAG,UAAU9zE,CAAV,EAAa;AACpC,YAAI00E,YAAY,GAAGJ,aAAa,CAACI,YAAjC;;AACA,YAAIA,YAAJ,EAAkB;AAChBljE,UAAAA,sBAAsB,CAACxR,CAAD,CAAtB,CAA0BjH,IAA1B,CAA+B,UAAUwL,MAAV,EAAkB;AAC/C,gBAAIA,MAAM,CAAC6K,aAAP,KAAyB9G,QAA7B,EAAuC;AACrC,kBAAI/D,MAAM,KAAK+D,QAAQ,CAAC+K,IAApB,IAA4B,CAAC6gE,WAAW,CAACQ,YAAD,EAAenwE,MAAf,CAAxC,IAAkE+vE,aAAa,CAACC,aAAd,KAAgCG,YAAtG,EAAoH;AAClHA,gBAAAA,YAAY,CAACpyC,IAAb,CAAkB,MAAlB,EAA0B;AAAEiyC,kBAAAA,aAAa,EAAE;AAAjB,iBAA1B;AACAD,gBAAAA,aAAa,CAACC,aAAd,GAA8B,IAA9B;AACD;AACF;AACF,WAPD;AAQD;AACF,OAZD;;AAaAR,MAAAA,KAAK,CAAC/6E,IAAN,CAAWsP,QAAX,EAAqB,SAArB,EAAgCwrE,sBAAhC;AACD;AACF,GAxCD;;AAyCA,MAAIa,wBAAwB,GAAG,UAAUL,aAAV,EAAyBt0E,CAAzB,EAA4B;AACzD,QAAIs0E,aAAa,CAACC,aAAd,KAAgCv0E,CAAC,CAACmnB,MAAtC,EAA8C;AAC5CmtD,MAAAA,aAAa,CAACC,aAAd,GAA8B,IAA9B;AACD;;AACD,QAAI,CAACD,aAAa,CAACI,YAAnB,EAAiC;AAC/BX,MAAAA,KAAK,CAAC5xC,MAAN,CAAa75B,QAAb,EAAuB,SAAvB,EAAkCwrE,sBAAlC;AACAA,MAAAA,sBAAsB,GAAG,IAAzB;AACD;AACF,GARD;;AASA,MAAIc,OAAO,GAAG,UAAUN,aAAV,EAAyB;AACrCA,IAAAA,aAAa,CAACr3D,EAAd,CAAiB,WAAjB,EAA8BlmB,KAAK,CAACs9E,cAAD,EAAiBC,aAAjB,CAAnC;AACAA,IAAAA,aAAa,CAACr3D,EAAd,CAAiB,cAAjB,EAAiClmB,KAAK,CAAC49E,wBAAD,EAA2BL,aAA3B,CAAtC;AACD,GAHD;;AAKA,MAAIO,sBAAsB,GAAG,UAAU1tD,MAAV,EAAkBpb,IAAlB,EAAwB;AACnD,WAAOob,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqB3rC,IAArB,EAA2B,UAAUA,IAAV,EAAgB;AAChD,aAAOob,MAAM,CAAChb,GAAP,CAAW0uC,kBAAX,CAA8B9uC,IAA9B,MAAwC,MAA/C;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAI+oE,gBAAgB,GAAG,UAAU1zB,GAAV,EAAe;AACpC,WAAOA,GAAG,CAAC+K,SAAJ,GAAgBnyD,QAAQ,CAACD,IAAT,CAAc0sD,OAAO,CAACrF,GAAG,CAACryB,cAAL,EAAqBqyB,GAAG,CAACnG,WAAzB,CAArB,EAA4DniD,GAA5D,CAAgEyT,YAAY,CAACX,OAA7E,CAAhB,GAAwG5R,QAAQ,CAACrC,IAAT,EAA/G;AACD,GAFD;;AAGA,MAAIo9E,iBAAiB,GAAG,UAAUzrE,IAAV,EAAgB83C,GAAhB,EAAqB;AAC3C,WAAO0zB,gBAAgB,CAAC1zB,GAAD,CAAhB,CAAsBpoD,IAAtB,CAA2B,UAAU+S,IAAV,EAAgB;AAChD,UAAIugB,cAAc,CAACvgB,IAAD,CAAlB,EAA0B;AACxB,eAAO/R,QAAQ,CAACR,IAAT,CAAcuS,IAAd,CAAP;AACD,OAFD,MAEO,IAAI0C,UAAU,CAACnF,IAAD,EAAOyC,IAAP,CAAV,KAA2B,KAA/B,EAAsC;AAC3C,eAAO/R,QAAQ,CAACR,IAAT,CAAc8P,IAAd,CAAP;AACD,OAFM,MAEA;AACL,eAAOtP,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF,KARM,CAAP;AASD,GAVD;;AAWA,MAAIq9E,kBAAkB,GAAG,UAAU7tD,MAAV,EAAkBi6B,GAAlB,EAAuB;AAC9C2zB,IAAAA,iBAAiB,CAACxoE,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAD,EAAyCH,GAAzC,CAAjB,CAA+DpoD,IAA/D,CAAoE,UAAUkhB,GAAV,EAAe;AACjF,aAAOu+C,eAAe,CAACv+C,GAAG,CAAC/N,GAAL,CAAtB;AACD,KAFD,EAEGhU,IAFH,CAEQ,YAAY;AAClBgvB,MAAAA,MAAM,CAACk6B,SAAP,CAAiB+qB,SAAjB;AACA;AACD,KALD,EAKG,UAAU6I,QAAV,EAAoB;AACrB,aAAO9tD,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwB2a,QAAQ,CAAChsB,OAAT,EAAxB,CAAP;AACD,KAPD;AAQD,GATD;;AAUA,MAAIisB,SAAS,GAAG,UAAU7hE,IAAV,EAAgB;AAC9B,QAAIA,IAAI,CAACmhE,SAAT,EAAoB;AAClB,UAAI;AACFnhE,QAAAA,IAAI,CAACmhE,SAAL;AACD,OAFD,CAEE,OAAOj1D,EAAP,EAAW;AACXlM,QAAAA,IAAI,CAACo4B,KAAL;AACD;AACF,KAND,MAMO;AACLp4B,MAAAA,IAAI,CAACo4B,KAAL;AACD;AACF,GAVD;;AAWA,MAAI0pC,eAAe,GAAG,UAAUj7D,GAAV,EAAe;AACnC,WAAOyxB,QAAQ,CAACzxB,GAAD,CAAR,IAAiBpX,MAAM,CAACoX,GAAD,CAAN,CAAY5hB,MAAZ,EAAxB;AACD,GAFD;;AAGA,MAAI88E,cAAc,GAAG,UAAUjuD,MAAV,EAAkB;AACrC,WAAOA,MAAM,CAACkuD,aAAP,IAAwB1pC,QAAQ,CAACp/B,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACkuD,aAA5B,CAAD,CAAvC;AACD,GAFD;;AAGA,MAAIC,cAAc,GAAG,UAAUnuD,MAAV,EAAkB;AACrC,QAAIouD,OAAO,GAAGpuD,MAAM,CAACo6B,OAAP,EAAd;AACA,WAAOg0B,OAAO,IAAIJ,eAAe,CAAC5oE,YAAY,CAACX,OAAb,CAAqB2pE,OAArB,CAAD,CAAjC;AACD,GAHD;;AAIA,MAAIC,UAAU,GAAG,UAAUruD,MAAV,EAAkB;AACjC,QAAI7X,GAAG,GAAG6B,WAAW,CAAC5E,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACsoC,UAAP,EAArB,CAAD,CAArB;AACA,WAAOtuC,MAAM,CAAC7R,GAAD,CAAN,CAAYnW,MAAZ,CAAmB,UAAUqU,IAAV,EAAgB;AACxC,aAAO,CAACymE,0BAA0B,CAACzmE,IAAI,CAACrB,GAAN,CAA3B,IAAyC+nE,WAAW,CAAC/sD,MAAD,EAAS3Z,IAAI,CAACrB,GAAd,CAA3D;AACD,KAFM,EAEJ7T,MAFI,EAAP;AAGD,GALD;;AAMA,MAAIm9E,UAAU,GAAG,UAAUtuD,MAAV,EAAkB;AACjC,WAAOA,MAAM,CAAC+R,MAAP,GAAgBo8C,cAAc,CAACnuD,MAAD,CAA9B,GAAyCiuD,cAAc,CAACjuD,MAAD,CAA9D;AACD,GAFD;;AAGA,MAAIuuD,kBAAkB,GAAG,UAAUvuD,MAAV,EAAkB;AACzC,WAAOsuD,UAAU,CAACtuD,MAAD,CAAV,IAAsBquD,UAAU,CAACruD,MAAD,CAAvC;AACD,GAFD;;AAGA,MAAIwuD,WAAW,GAAG,UAAUxuD,MAAV,EAAkB;AAClC,QAAIk6B,SAAS,GAAGl6B,MAAM,CAACk6B,SAAvB;AACA,QAAIhuC,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAAX;AACA,QAAIH,GAAG,GAAGC,SAAS,CAACC,MAAV,EAAV;AACAn6B,IAAAA,MAAM,CAACyuD,MAAP,CAAcC,sBAAd;;AACA,QAAI1uD,MAAM,CAACmkC,QAAP,KAAoB33D,SAApB,IAAiC8hF,UAAU,CAACtuD,MAAD,CAAV,KAAuB,KAA5D,EAAmE;AACjEm6B,MAAAA,MAAM,CAACn6B,MAAD,CAAN,CAAepuB,IAAf,CAAoB,UAAU+8E,WAAV,EAAuB;AACzC3uD,QAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBwb,WAAxB;AACA10B,QAAAA,GAAG,GAAG00B,WAAN;AACD,OAHD;AAID;;AACD,QAAIC,mBAAmB,GAAGlB,sBAAsB,CAAC1tD,MAAD,EAASk6B,SAAS,CAACoF,OAAV,EAAT,CAAhD;;AACA,QAAIt/B,MAAM,CAACwuB,CAAP,CAASp6C,QAAT,CAAkB8X,IAAlB,EAAwB0iE,mBAAxB,CAAJ,EAAkD;AAChDb,MAAAA,SAAS,CAACa,mBAAD,CAAT;AACAf,MAAAA,kBAAkB,CAAC7tD,MAAD,EAASi6B,GAAT,CAAlB;AACA40B,MAAAA,cAAc,CAAC7uD,MAAD,CAAd;AACA;AACD;;AACD,QAAI,CAACA,MAAM,CAAC+R,MAAZ,EAAoB;AAClB,UAAI,CAACtxB,GAAG,CAAC/C,KAAT,EAAgB;AACdqwE,QAAAA,SAAS,CAAC7hE,IAAD,CAAT;AACD;;AACD8T,MAAAA,MAAM,CAACgrD,MAAP,GAAgB1mC,KAAhB;AACD;;AACD,QAAI7jC,GAAG,CAACC,KAAJ,IAAasf,MAAM,CAAC+R,MAAxB,EAAgC;AAC9Bg8C,MAAAA,SAAS,CAAC7hE,IAAD,CAAT;AACA2hE,MAAAA,kBAAkB,CAAC7tD,MAAD,EAASi6B,GAAT,CAAlB;AACD;;AACD40B,IAAAA,cAAc,CAAC7uD,MAAD,CAAd;AACD,GA7BD;;AA8BA,MAAI6uD,cAAc,GAAG,UAAU7uD,MAAV,EAAkB;AACrC,WAAOA,MAAM,CAACmtD,aAAP,CAAqBE,SAArB,CAA+BrtD,MAA/B,CAAP;AACD,GAFD;;AAGA,MAAI8uD,OAAO,GAAG,UAAU9uD,MAAV,EAAkB+uD,SAAlB,EAA6B;AACzC,QAAI/uD,MAAM,CAACC,OAAX,EAAoB;AAClB;AACD;;AACD8uD,IAAAA,SAAS,GAAGF,cAAc,CAAC7uD,MAAD,CAAjB,GAA4BwuD,WAAW,CAACxuD,MAAD,CAAhD;AACD,GALD;;AAOA,MAAIgvD,kBAAkB,GAAG,UAAU7sE,IAAV,EAAgB83C,GAAhB,EAAqBx9C,KAArB,EAA4BwyE,IAA5B,EAAkClsE,OAAlC,EAA2C;AAClE,QAAIzB,SAAS,GAAG7E,KAAK,GAAGw9C,GAAG,CAACryB,cAAP,GAAwBqyB,GAAG,CAAClG,YAAjD;AACA,QAAIntB,MAAM,GAAGnqB,KAAK,GAAGw9C,GAAG,CAACnG,WAAP,GAAqBmG,GAAG,CAACjG,SAA3C;AACA,WAAOnhD,QAAQ,CAACD,IAAT,CAAc0O,SAAd,EAAyB3P,GAAzB,CAA6ByT,YAAY,CAACX,OAA1C,EAAmD9S,GAAnD,CAAuD,UAAUohB,GAAV,EAAe;AAC3E,aAAO,CAACk8D,IAAD,IAAS,CAACh1B,GAAG,CAAC+K,SAAd,GAA0B37C,KAAK,CAAC0J,GAAD,EAAMhQ,OAAO,CAACgQ,GAAD,EAAM6T,MAAN,CAAb,CAAL,CAAiCx1B,KAAjC,CAAuC2hB,GAAvC,CAA1B,GAAwEA,GAA/E;AACD,KAFM,EAEJlhB,IAFI,CAEC,UAAUkhB,GAAV,EAAe;AACrB,aAAOnL,SAAS,CAACmL,GAAD,CAAT,GAAiBlgB,QAAQ,CAACR,IAAT,CAAc0gB,GAAd,CAAjB,GAAsC/P,MAAM,CAAC+P,GAAD,CAAN,CAAY/gB,MAAZ,CAAmB4V,SAAnB,CAA7C;AACD,KAJM,EAIJjW,GAJI,CAIA,UAAUohB,GAAV,EAAe;AACpB,aAAOA,GAAG,CAAC/N,GAAX;AACD,KANM,EAMJ5T,KANI,CAME+Q,IANF,CAAP;AAOD,GAVD;;AAWA,MAAI+sE,UAAU,GAAG,UAAU/sE,IAAV,EAAgB83C,GAAhB,EAAqBg1B,IAArB,EAA2B;AAC1C,WAAOD,kBAAkB,CAAC7sE,IAAD,EAAO83C,GAAP,EAAY,IAAZ,EAAkBg1B,IAAlB,EAAwB,UAAUl8D,GAAV,EAAe6T,MAAf,EAAuB;AACtE,aAAOlY,IAAI,CAACswC,GAAL,CAASv1C,eAAe,CAACsJ,GAAD,CAAxB,EAA+B6T,MAA/B,CAAP;AACD,KAFwB,CAAzB;AAGD,GAJD;;AAKA,MAAI+7C,MAAM,GAAG,UAAUxgE,IAAV,EAAgB83C,GAAhB,EAAqBg1B,IAArB,EAA2B;AACtC,WAAOD,kBAAkB,CAAC7sE,IAAD,EAAO83C,GAAP,EAAY,KAAZ,EAAmBg1B,IAAnB,EAAyB,UAAUl8D,GAAV,EAAe6T,MAAf,EAAuB;AACvE,aAAOA,MAAM,GAAG,CAAT,GAAaA,MAAM,GAAG,CAAtB,GAA0BA,MAAjC;AACD,KAFwB,CAAzB;AAGD,GAJD;;AAKA,MAAIuoD,kBAAkB,GAAG,UAAUvqE,IAAV,EAAgBk5C,QAAhB,EAA0B;AACjD,QAAIsxB,IAAI,GAAGxqE,IAAX;;AACA,WAAOA,IAAI,IAAIyL,QAAQ,CAACzL,IAAD,CAAhB,IAA0BA,IAAI,CAAC5W,MAAL,KAAgB,CAAjD,EAAoD;AAClD4W,MAAAA,IAAI,GAAGk5C,QAAQ,GAAGl5C,IAAI,CAACsE,WAAR,GAAsBtE,IAAI,CAACqE,eAA1C;AACD;;AACD,WAAOrE,IAAI,IAAIwqE,IAAf;AACD,GAND;;AAOA,MAAIC,SAAS,GAAG,UAAUltE,IAAV,EAAgB83C,GAAhB,EAAqB;AACnC,QAAIlnC,GAAJ,EAAS6U,cAAT,EAAyBmsB,YAAzB;;AACA,QAAI,CAACkG,GAAL,EAAU;AACR,aAAO93C,IAAP;AACD;;AACDylB,IAAAA,cAAc,GAAGqyB,GAAG,CAACryB,cAArB;AACAmsB,IAAAA,YAAY,GAAGkG,GAAG,CAAClG,YAAnB;AACA,QAAID,WAAW,GAAGmG,GAAG,CAACnG,WAAtB;AACA,QAAIE,SAAS,GAAGiG,GAAG,CAACjG,SAApB;AACAjhC,IAAAA,GAAG,GAAGknC,GAAG,CAACq1B,uBAAV;;AACA,QAAI,CAACr1B,GAAG,CAAC+K,SAAT,EAAoB;AAClB,UAAIp9B,cAAc,KAAKmsB,YAAvB,EAAqC;AACnC,YAAIC,SAAS,GAAGF,WAAZ,GAA0B,CAA9B,EAAiC;AAC/B,cAAIlsB,cAAc,CAACvjB,aAAf,EAAJ,EAAoC;AAClC0O,YAAAA,GAAG,GAAG6U,cAAc,CAACtjB,UAAf,CAA0BwvC,WAA1B,CAAN;AACD;AACF;AACF;;AACD,UAAIlsB,cAAc,CAACxhB,QAAf,KAA4B,CAA5B,IAAiC2tC,YAAY,CAAC3tC,QAAb,KAA0B,CAA/D,EAAkE;AAChE,YAAIwhB,cAAc,CAAC55B,MAAf,KAA0B8lD,WAA9B,EAA2C;AACzClsB,UAAAA,cAAc,GAAGunD,kBAAkB,CAACvnD,cAAc,CAAC1e,WAAhB,EAA6B,IAA7B,CAAnC;AACD,SAFD,MAEO;AACL0e,UAAAA,cAAc,GAAGA,cAAc,CAACtf,UAAhC;AACD;;AACD,YAAI0rC,SAAS,KAAK,CAAlB,EAAqB;AACnBD,UAAAA,YAAY,GAAGo7B,kBAAkB,CAACp7B,YAAY,CAAC9qC,eAAd,EAA+B,KAA/B,CAAjC;AACD,SAFD,MAEO;AACL8qC,UAAAA,YAAY,GAAGA,YAAY,CAACzrC,UAA5B;AACD;;AACD,YAAIsf,cAAc,IAAIA,cAAc,KAAKmsB,YAAzC,EAAuD;AACrD,iBAAOnsB,cAAP;AACD;AACF;AACF;;AACD,QAAI7U,GAAG,IAAIA,GAAG,CAAC3M,QAAJ,KAAiB,CAA5B,EAA+B;AAC7B,aAAO2M,GAAG,CAACzK,UAAX;AACD;;AACD,WAAOyK,GAAP;AACD,GAtCD;;AAuCA,MAAIw8D,iBAAiB,GAAG,UAAUvqE,GAAV,EAAei1C,GAAf,EAAoBooB,QAApB,EAA8BmN,MAA9B,EAAsC;AAC5D,QAAI5qE,IAAJ;AACA,QAAI6qE,cAAc,GAAG,EAArB;AACA,QAAIttE,IAAI,GAAG6C,GAAG,CAACypC,OAAJ,EAAX;AACA4zB,IAAAA,QAAQ,GAAGr9D,GAAG,CAACurC,SAAJ,CAAc8xB,QAAQ,IAAI6M,UAAU,CAAC/sE,IAAD,EAAO83C,GAAP,EAAYA,GAAG,CAAC+K,SAAhB,CAApC,EAAgEhgD,GAAG,CAAC4f,OAApE,CAAX;AACA4qD,IAAAA,MAAM,GAAGxqE,GAAG,CAACurC,SAAJ,CAAci/B,MAAM,IAAI7M,MAAM,CAACxgE,IAAD,EAAO83C,GAAP,EAAYA,GAAG,CAAC+K,SAAhB,CAA9B,EAA0DhgD,GAAG,CAAC4f,OAA9D,CAAT;;AACA,QAAIy9C,QAAQ,IAAIA,QAAQ,KAAKlgE,IAA7B,EAAmC;AACjCstE,MAAAA,cAAc,CAACz7E,IAAf,CAAoBquE,QAApB;AACD;;AACD,QAAIA,QAAQ,IAAImN,MAAZ,IAAsBnN,QAAQ,KAAKmN,MAAvC,EAA+C;AAC7C5qE,MAAAA,IAAI,GAAGy9D,QAAP;AACA,UAAI34C,MAAM,GAAG,IAAIpG,aAAJ,CAAkB++C,QAAlB,EAA4BlgE,IAA5B,CAAb;;AACA,aAAO,CAACyC,IAAI,GAAG8kB,MAAM,CAACjG,IAAP,EAAR,KAA0B7e,IAAI,KAAK4qE,MAA1C,EAAkD;AAChD,YAAIxqE,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAZ,CAAJ,EAAuB;AACrB6qE,UAAAA,cAAc,CAACz7E,IAAf,CAAoB4Q,IAApB;AACD;AACF;AACF;;AACD,QAAI4qE,MAAM,IAAInN,QAAQ,KAAKmN,MAAvB,IAAiCA,MAAM,KAAKrtE,IAAhD,EAAsD;AACpDstE,MAAAA,cAAc,CAACz7E,IAAf,CAAoBw7E,MAApB;AACD;;AACD,WAAOC,cAAP;AACD,GAtBD;;AAuBA,MAAIC,QAAQ,GAAG,UAAU1qE,GAAV,EAAeJ,IAAf,EAAqB4mC,OAArB,EAA8B;AAC3C,WAAO34C,QAAQ,CAACD,IAAT,CAAcgS,IAAd,EAAoBjT,GAApB,CAAwB,UAAUiT,IAAV,EAAgB;AAC7C,UAAIi/B,GAAG,GAAG7+B,GAAG,CAACy+B,SAAJ,CAAc7+B,IAAd,CAAV;AACA,UAAIq1C,GAAG,GAAGj1C,GAAG,CAAC+tC,SAAJ,EAAV;AACAkH,MAAAA,GAAG,CAAC5G,QAAJ,CAAazuC,IAAI,CAAC0D,UAAlB,EAA8Bu7B,GAA9B;AACAoW,MAAAA,GAAG,CAAC3G,MAAJ,CAAW1uC,IAAI,CAAC0D,UAAhB,EAA4Bu7B,GAAG,GAAG,CAAlC;;AACA,UAAI2H,OAAJ,EAAa;AACXiuB,QAAAA,cAAc,CAACz0D,GAAD,EAAMi1C,GAAN,EAAWr1C,IAAX,EAAiB,IAAjB,CAAd;AACA60D,QAAAA,cAAc,CAACz0D,GAAD,EAAMi1C,GAAN,EAAWr1C,IAAX,EAAiB,KAAjB,CAAd;AACD;;AACD,aAAOq1C,GAAP;AACD,KAVM,CAAP;AAWD,GAZD;;AAcA,MAAI01B,aAAa,GAAG,UAAU3vD,MAAV,EAAkBy4C,MAAlB,EAA0B;AAC5C,WAAO9mE,GAAG,CAAC8mE,MAAD,EAAS,UAAUz3D,KAAV,EAAiB;AAClC,UAAIy5B,GAAG,GAAGza,MAAM,CAACmb,IAAP,CAAY,mBAAZ,EAAiC;AAAEn6B,QAAAA,KAAK,EAAEA;AAAT,OAAjC,CAAV;AACA,aAAOy5B,GAAG,CAACz5B,KAAJ,KAAcA,KAAd,GAAsBy5B,GAAG,CAACz5B,KAA1B,GAAkCA,KAAzC;AACD,KAHS,CAAV;AAID,GALD;;AAOA,MAAI4uE,UAAU,GAAG;AACf,aAAS,CADM;AAEf,gBAAY,CAFG;AAGf,cAAU,CAHK;AAIf,WAAO,CAJQ;AAKf,gBAAY,EALG;AAMf,0BAAsB;AANP,GAAjB;;AAQA,MAAIC,MAAM,GAAG,UAAUjrE,IAAV,EAAgBzC,IAAhB,EAAsBuhB,IAAtB,EAA4B;AACvC,QAAIK,SAAS,GAAGL,IAAI,GAAG,WAAH,GAAiB,YAArC;AACA,QAAIM,WAAW,GAAGN,IAAI,GAAG,MAAH,GAAY,MAAlC;;AACA,QAAI9e,IAAI,CAACmf,SAAD,CAAR,EAAqB;AACnB,aAAOnf,IAAI,CAACmf,SAAD,CAAX;AACD;;AACD,QAAInf,IAAI,KAAKzC,IAAb,EAAmB;AACjB,UAAI8I,OAAO,GAAGrG,IAAI,CAACof,WAAD,CAAlB;;AACA,UAAI/Y,OAAJ,EAAa;AACX,eAAOA,OAAP;AACD;;AACD,WAAK,IAAIqtD,QAAQ,GAAG1zD,IAAI,CAAC5B,MAAzB,EAAiCs1D,QAAQ,IAAIA,QAAQ,KAAKn2D,IAA1D,EAAgEm2D,QAAQ,GAAGA,QAAQ,CAACt1D,MAApF,EAA4F;AAC1FiI,QAAAA,OAAO,GAAGqtD,QAAQ,CAACt0C,WAAD,CAAlB;;AACA,YAAI/Y,OAAJ,EAAa;AACX,iBAAOA,OAAP;AACD;AACF;AACF;AACF,GAlBD;;AAmBA,MAAI6kE,iBAAiB,GAAG,UAAUlrE,IAAV,EAAgB;AACtC,QAAI,CAACikB,gBAAgB,CAACjkB,IAAI,CAAClV,KAAN,CAArB,EAAmC;AACjC,aAAO,KAAP;AACD;;AACD,QAAI4Y,UAAU,GAAG1D,IAAI,CAAC5B,MAAtB;;AACA,QAAIsF,UAAU,KAAKA,UAAU,CAACxb,IAAX,KAAoB,MAApB,IAA8Bwb,UAAU,CAACsJ,IAAX,CAAgB,OAAhB,CAAnC,CAAV,IAA0E,SAAS/X,IAAT,CAAc+K,IAAI,CAAClV,KAAnB,CAA9E,EAAyG;AACvG,aAAO,KAAP;AACD;;AACD,WAAO,IAAP;AACD,GATD;;AAUA,MAAImjD,iBAAiB,GAAG,UAAUjuC,IAAV,EAAgB;AACtC,QAAIqkB,aAAa,GAAGrkB,IAAI,CAAC9X,IAAL,KAAc,GAAd,IAAqB,CAAC8X,IAAI,CAACgN,IAAL,CAAU,MAAV,CAAtB,IAA2ChN,IAAI,CAACgN,IAAL,CAAU,IAAV,CAA/D;AACA,WAAOhN,IAAI,CAACgN,IAAL,CAAU,MAAV,KAAqBhN,IAAI,CAACgN,IAAL,CAAU,IAAV,KAAmB,CAAChN,IAAI,CAAC2E,UAA9C,IAA4D3E,IAAI,CAACgN,IAAL,CAAU,mBAAV,CAA5D,IAA8FqX,aAArG;AACD,GAHD;;AAIA,MAAI8mD,OAAO,GAAG,YAAY;AACxB,aAASA,OAAT,CAAiBjjF,IAAjB,EAAuBkG,IAAvB,EAA6B;AAC3B,WAAKlG,IAAL,GAAYA,IAAZ;AACA,WAAKkG,IAAL,GAAYA,IAAZ;;AACA,UAAIA,IAAI,KAAK,CAAb,EAAgB;AACd,aAAK2e,UAAL,GAAkB,EAAlB;AACA,aAAKA,UAAL,CAAgBhgB,GAAhB,GAAsB,EAAtB;AACD;AACF;;AACDo+E,IAAAA,OAAO,CAAC7tE,MAAR,GAAiB,UAAUpV,IAAV,EAAgBukB,KAAhB,EAAuB;AACtC,UAAIzM,IAAI,GAAG,IAAImrE,OAAJ,CAAYjjF,IAAZ,EAAkB8iF,UAAU,CAAC9iF,IAAD,CAAV,IAAoB,CAAtC,CAAX;;AACA,UAAIukB,KAAJ,EAAW;AACTpb,QAAAA,MAAM,CAACob,KAAD,EAAQ,UAAU3hB,KAAV,EAAiBigB,QAAjB,EAA2B;AACvC/K,UAAAA,IAAI,CAACgN,IAAL,CAAUjC,QAAV,EAAoBjgB,KAApB;AACD,SAFK,CAAN;AAGD;;AACD,aAAOkV,IAAP;AACD,KARD;;AASAmrE,IAAAA,OAAO,CAACpjF,SAAR,CAAkBqO,OAAlB,GAA4B,UAAU4J,IAAV,EAAgB;AAC1C,UAAIrS,IAAI,GAAG,IAAX;;AACA,UAAIqS,IAAI,CAAC5B,MAAT,EAAiB;AACf4B,QAAAA,IAAI,CAACiH,MAAL;AACD;;AACDtZ,MAAAA,IAAI,CAACy9E,MAAL,CAAYprE,IAAZ,EAAkBrS,IAAlB;AACAA,MAAAA,IAAI,CAACsZ,MAAL;AACA,aAAOtZ,IAAP;AACD,KARD;;AASAw9E,IAAAA,OAAO,CAACpjF,SAAR,CAAkBilB,IAAlB,GAAyB,UAAU9kB,IAAV,EAAgB4C,KAAhB,EAAuB;AAC9C,UAAI6C,IAAI,GAAG,IAAX;AACA,UAAI8e,KAAJ;;AACA,UAAI,OAAOvkB,IAAP,KAAgB,QAApB,EAA8B;AAC5B,YAAIA,IAAI,KAAKN,SAAT,IAAsBM,IAAI,KAAK,IAAnC,EAAyC;AACvCmJ,UAAAA,MAAM,CAACnJ,IAAD,EAAO,UAAU4C,KAAV,EAAiBuH,GAAjB,EAAsB;AACjC1E,YAAAA,IAAI,CAACqf,IAAL,CAAU3a,GAAV,EAAevH,KAAf;AACD,WAFK,CAAN;AAGD;;AACD,eAAO6C,IAAP;AACD;;AACD,UAAI8e,KAAK,GAAG9e,IAAI,CAACof,UAAjB,EAA6B;AAC3B,YAAIjiB,KAAK,KAAKlD,SAAd,EAAyB;AACvB,cAAIkD,KAAK,KAAK,IAAd,EAAoB;AAClB,gBAAI5C,IAAI,IAAIukB,KAAK,CAAC1f,GAAlB,EAAuB;AACrB,qBAAO0f,KAAK,CAAC1f,GAAN,CAAU7E,IAAV,CAAP;AACA,kBAAIoB,CAAC,GAAGmjB,KAAK,CAACrjB,MAAd;;AACA,qBAAOE,CAAC,EAAR,EAAY;AACV,oBAAImjB,KAAK,CAACnjB,CAAD,CAAL,CAASpB,IAAT,KAAkBA,IAAtB,EAA4B;AAC1BukB,kBAAAA,KAAK,CAAC4f,MAAN,CAAa/iC,CAAb,EAAgB,CAAhB;AACA,yBAAOqE,IAAP;AACD;AACF;AACF;;AACD,mBAAOA,IAAP;AACD;;AACD,cAAIzF,IAAI,IAAIukB,KAAK,CAAC1f,GAAlB,EAAuB;AACrB,gBAAIzD,CAAC,GAAGmjB,KAAK,CAACrjB,MAAd;;AACA,mBAAOE,CAAC,EAAR,EAAY;AACV,kBAAImjB,KAAK,CAACnjB,CAAD,CAAL,CAASpB,IAAT,KAAkBA,IAAtB,EAA4B;AAC1BukB,gBAAAA,KAAK,CAACnjB,CAAD,CAAL,CAASwB,KAAT,GAAiBA,KAAjB;AACA;AACD;AACF;AACF,WARD,MAQO;AACL2hB,YAAAA,KAAK,CAACrd,IAAN,CAAW;AACTlH,cAAAA,IAAI,EAAEA,IADG;AAET4C,cAAAA,KAAK,EAAEA;AAFE,aAAX;AAID;;AACD2hB,UAAAA,KAAK,CAAC1f,GAAN,CAAU7E,IAAV,IAAkB4C,KAAlB;AACA,iBAAO6C,IAAP;AACD;;AACD,eAAO8e,KAAK,CAAC1f,GAAN,CAAU7E,IAAV,CAAP;AACD;AACF,KA7CD;;AA8CAijF,IAAAA,OAAO,CAACpjF,SAAR,CAAkBU,KAAlB,GAA0B,YAAY;AACpC,UAAIkF,IAAI,GAAG,IAAX;AACA,UAAIlF,KAAK,GAAG,IAAI0iF,OAAJ,CAAYx9E,IAAI,CAACzF,IAAjB,EAAuByF,IAAI,CAACS,IAA5B,CAAZ;AACA,UAAIi9E,SAAJ;;AACA,UAAIA,SAAS,GAAG19E,IAAI,CAACof,UAArB,EAAiC;AAC/B,YAAIu+D,UAAU,GAAG,EAAjB;AACAA,QAAAA,UAAU,CAACv+E,GAAX,GAAiB,EAAjB;;AACA,aAAK,IAAIzD,CAAC,GAAG,CAAR,EAAWqJ,CAAC,GAAG04E,SAAS,CAACjiF,MAA9B,EAAsCE,CAAC,GAAGqJ,CAA1C,EAA6CrJ,CAAC,EAA9C,EAAkD;AAChD,cAAIiiF,QAAQ,GAAGF,SAAS,CAAC/hF,CAAD,CAAxB;;AACA,cAAIiiF,QAAQ,CAACrjF,IAAT,KAAkB,IAAtB,EAA4B;AAC1BojF,YAAAA,UAAU,CAACA,UAAU,CAACliF,MAAZ,CAAV,GAAgC;AAC9BlB,cAAAA,IAAI,EAAEqjF,QAAQ,CAACrjF,IADe;AAE9B4C,cAAAA,KAAK,EAAEygF,QAAQ,CAACzgF;AAFc,aAAhC;AAIAwgF,YAAAA,UAAU,CAACv+E,GAAX,CAAew+E,QAAQ,CAACrjF,IAAxB,IAAgCqjF,QAAQ,CAACzgF,KAAzC;AACD;AACF;;AACDrC,QAAAA,KAAK,CAACskB,UAAN,GAAmBu+D,UAAnB;AACD;;AACD7iF,MAAAA,KAAK,CAACqC,KAAN,GAAc6C,IAAI,CAAC7C,KAAnB;AACArC,MAAAA,KAAK,CAAC+iF,UAAN,GAAmB79E,IAAI,CAAC69E,UAAxB;AACA,aAAO/iF,KAAP;AACD,KAtBD;;AAuBA0iF,IAAAA,OAAO,CAACpjF,SAAR,CAAkB2e,IAAlB,GAAyB,UAAUC,OAAV,EAAmB;AAC1C,UAAIhZ,IAAI,GAAG,IAAX;AACAA,MAAAA,IAAI,CAACyQ,MAAL,CAAYgtE,MAAZ,CAAmBzkE,OAAnB,EAA4BhZ,IAA5B;AACAgZ,MAAAA,OAAO,CAACL,MAAR,CAAe3Y,IAAf;AACA,aAAOA,IAAP;AACD,KALD;;AAMAw9E,IAAAA,OAAO,CAACpjF,SAAR,CAAkBof,MAAlB,GAA2B,YAAY;AACrC,UAAIxZ,IAAI,GAAG,IAAX;;AACA,WAAK,IAAIqS,IAAI,GAAGrS,IAAI,CAACgX,UAArB,EAAiC3E,IAAjC,GAAwC;AACtC,YAAI6e,IAAI,GAAG7e,IAAI,CAAC6e,IAAhB;AACAlxB,QAAAA,IAAI,CAACy9E,MAAL,CAAYprE,IAAZ,EAAkBrS,IAAlB,EAAwB,IAAxB;AACAqS,QAAAA,IAAI,GAAG6e,IAAP;AACD;;AACDlxB,MAAAA,IAAI,CAACsZ,MAAL;AACD,KARD;;AASAkkE,IAAAA,OAAO,CAACpjF,SAAR,CAAkBkf,MAAlB,GAA2B,YAAY;AACrC,UAAItZ,IAAI,GAAG,IAAX;AAAA,UAAiByQ,MAAM,GAAGzQ,IAAI,CAACyQ,MAA/B;AAAA,UAAuCygB,IAAI,GAAGlxB,IAAI,CAACkxB,IAAnD;AAAA,UAAyDC,IAAI,GAAGnxB,IAAI,CAACmxB,IAArE;;AACA,UAAI1gB,MAAJ,EAAY;AACV,YAAIA,MAAM,CAACuG,UAAP,KAAsBhX,IAA1B,EAAgC;AAC9ByQ,UAAAA,MAAM,CAACuG,UAAP,GAAoBka,IAApB;;AACA,cAAIA,IAAJ,EAAU;AACRA,YAAAA,IAAI,CAACC,IAAL,GAAY,IAAZ;AACD;AACF,SALD,MAKO;AACLA,UAAAA,IAAI,CAACD,IAAL,GAAYA,IAAZ;AACD;;AACD,YAAIzgB,MAAM,CAACwG,SAAP,KAAqBjX,IAAzB,EAA+B;AAC7ByQ,UAAAA,MAAM,CAACwG,SAAP,GAAmBka,IAAnB;;AACA,cAAIA,IAAJ,EAAU;AACRA,YAAAA,IAAI,CAACD,IAAL,GAAY,IAAZ;AACD;AACF,SALD,MAKO;AACLA,UAAAA,IAAI,CAACC,IAAL,GAAYA,IAAZ;AACD;;AACDnxB,QAAAA,IAAI,CAACyQ,MAAL,GAAczQ,IAAI,CAACkxB,IAAL,GAAYlxB,IAAI,CAACmxB,IAAL,GAAY,IAAtC;AACD;;AACD,aAAOnxB,IAAP;AACD,KAtBD;;AAuBAw9E,IAAAA,OAAO,CAACpjF,SAAR,CAAkBue,MAAlB,GAA2B,UAAUtG,IAAV,EAAgB;AACzC,UAAIrS,IAAI,GAAG,IAAX;;AACA,UAAIqS,IAAI,CAAC5B,MAAT,EAAiB;AACf4B,QAAAA,IAAI,CAACiH,MAAL;AACD;;AACD,UAAIhW,IAAI,GAAGtD,IAAI,CAACiX,SAAhB;;AACA,UAAI3T,IAAJ,EAAU;AACRA,QAAAA,IAAI,CAAC4tB,IAAL,GAAY7e,IAAZ;AACAA,QAAAA,IAAI,CAAC8e,IAAL,GAAY7tB,IAAZ;AACAtD,QAAAA,IAAI,CAACiX,SAAL,GAAiB5E,IAAjB;AACD,OAJD,MAIO;AACLrS,QAAAA,IAAI,CAACiX,SAAL,GAAiBjX,IAAI,CAACgX,UAAL,GAAkB3E,IAAnC;AACD;;AACDA,MAAAA,IAAI,CAAC5B,MAAL,GAAczQ,IAAd;AACA,aAAOqS,IAAP;AACD,KAfD;;AAgBAmrE,IAAAA,OAAO,CAACpjF,SAAR,CAAkBqjF,MAAlB,GAA2B,UAAUprE,IAAV,EAAgByrE,OAAhB,EAAyBzlE,MAAzB,EAAiC;AAC1D,UAAIhG,IAAI,CAAC5B,MAAT,EAAiB;AACf4B,QAAAA,IAAI,CAACiH,MAAL;AACD;;AACD,UAAI7I,MAAM,GAAGqtE,OAAO,CAACrtE,MAAR,IAAkB,IAA/B;;AACA,UAAI4H,MAAJ,EAAY;AACV,YAAIylE,OAAO,KAAKrtE,MAAM,CAACuG,UAAvB,EAAmC;AACjCvG,UAAAA,MAAM,CAACuG,UAAP,GAAoB3E,IAApB;AACD,SAFD,MAEO;AACLyrE,UAAAA,OAAO,CAAC3sD,IAAR,CAAaD,IAAb,GAAoB7e,IAApB;AACD;;AACDA,QAAAA,IAAI,CAAC8e,IAAL,GAAY2sD,OAAO,CAAC3sD,IAApB;AACA9e,QAAAA,IAAI,CAAC6e,IAAL,GAAY4sD,OAAZ;AACAA,QAAAA,OAAO,CAAC3sD,IAAR,GAAe9e,IAAf;AACD,OATD,MASO;AACL,YAAIyrE,OAAO,KAAKrtE,MAAM,CAACwG,SAAvB,EAAkC;AAChCxG,UAAAA,MAAM,CAACwG,SAAP,GAAmB5E,IAAnB;AACD,SAFD,MAEO;AACLyrE,UAAAA,OAAO,CAAC5sD,IAAR,CAAaC,IAAb,GAAoB9e,IAApB;AACD;;AACDA,QAAAA,IAAI,CAAC6e,IAAL,GAAY4sD,OAAO,CAAC5sD,IAApB;AACA7e,QAAAA,IAAI,CAAC8e,IAAL,GAAY2sD,OAAZ;AACAA,QAAAA,OAAO,CAAC5sD,IAAR,GAAe7e,IAAf;AACD;;AACDA,MAAAA,IAAI,CAAC5B,MAAL,GAAcA,MAAd;AACA,aAAO4B,IAAP;AACD,KA1BD;;AA2BAmrE,IAAAA,OAAO,CAACpjF,SAAR,CAAkBwvE,MAAlB,GAA2B,UAAUrvE,IAAV,EAAgB;AACzC,UAAIyF,IAAI,GAAG,IAAX;AACA,UAAI2F,UAAU,GAAG,EAAjB;;AACA,WAAK,IAAI0M,IAAI,GAAGrS,IAAI,CAACgX,UAArB,EAAiC3E,IAAjC,EAAuCA,IAAI,GAAGirE,MAAM,CAACjrE,IAAD,EAAOrS,IAAP,CAApD,EAAkE;AAChE,YAAIqS,IAAI,CAAC9X,IAAL,KAAcA,IAAlB,EAAwB;AACtBoL,UAAAA,UAAU,CAAClE,IAAX,CAAgB4Q,IAAhB;AACD;AACF;;AACD,aAAO1M,UAAP;AACD,KATD;;AAUA63E,IAAAA,OAAO,CAACpjF,SAAR,CAAkB+e,KAAlB,GAA0B,YAAY;AACpC,UAAInZ,IAAI,GAAG,IAAX;;AACA,UAAIA,IAAI,CAACgX,UAAT,EAAqB;AACnB,YAAIsJ,KAAK,GAAG,EAAZ;;AACA,aAAK,IAAIjO,IAAI,GAAGrS,IAAI,CAACgX,UAArB,EAAiC3E,IAAjC,EAAuCA,IAAI,GAAGirE,MAAM,CAACjrE,IAAD,EAAOrS,IAAP,CAApD,EAAkE;AAChEsgB,UAAAA,KAAK,CAAC7e,IAAN,CAAW4Q,IAAX;AACD;;AACD,YAAI1W,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;;AACA,eAAOE,CAAC,EAAR,EAAY;AACV,cAAI0W,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAhB;AACA0W,UAAAA,IAAI,CAAC5B,MAAL,GAAc4B,IAAI,CAAC2E,UAAL,GAAkB3E,IAAI,CAAC4E,SAAL,GAAiB5E,IAAI,CAAC6e,IAAL,GAAY7e,IAAI,CAAC8e,IAAL,GAAY,IAAzE;AACD;AACF;;AACDnxB,MAAAA,IAAI,CAACgX,UAAL,GAAkBhX,IAAI,CAACiX,SAAL,GAAiB,IAAnC;AACA,aAAOjX,IAAP;AACD,KAfD;;AAgBAw9E,IAAAA,OAAO,CAACpjF,SAAR,CAAkBg9B,OAAlB,GAA4B,UAAU7gB,QAAV,EAAoBy0B,UAApB,EAAgChlC,SAAhC,EAA2C;AACrE,UAAIglC,UAAU,KAAK,KAAK,CAAxB,EAA2B;AACzBA,QAAAA,UAAU,GAAG,EAAb;AACD;;AACD,UAAIhrC,IAAI,GAAG,IAAX;AACA,UAAIqS,IAAI,GAAGrS,IAAI,CAACgX,UAAhB;;AACA,UAAIspC,iBAAiB,CAACtgD,IAAD,CAArB,EAA6B;AAC3B,eAAO,KAAP;AACD;;AACD,UAAIqS,IAAJ,EAAU;AACR,WAAG;AACD,cAAIA,IAAI,CAAC5R,IAAL,KAAc,CAAlB,EAAqB;AACnB,gBAAI4R,IAAI,CAACgN,IAAL,CAAU,gBAAV,CAAJ,EAAiC;AAC/B;AACD;;AACD,gBAAI9I,QAAQ,CAAClE,IAAI,CAAC9X,IAAN,CAAZ,EAAyB;AACvB,qBAAO,KAAP;AACD;;AACD,gBAAI+lD,iBAAiB,CAACjuC,IAAD,CAArB,EAA6B;AAC3B,qBAAO,KAAP;AACD;AACF;;AACD,cAAIA,IAAI,CAAC5R,IAAL,KAAc,CAAlB,EAAqB;AACnB,mBAAO,KAAP;AACD;;AACD,cAAI4R,IAAI,CAAC5R,IAAL,KAAc,CAAd,IAAmB,CAAC88E,iBAAiB,CAAClrE,IAAD,CAAzC,EAAiD;AAC/C,mBAAO,KAAP;AACD;;AACD,cAAIA,IAAI,CAAC5R,IAAL,KAAc,CAAd,IAAmB4R,IAAI,CAAC5B,MAAxB,IAAkCu6B,UAAU,CAAC34B,IAAI,CAAC5B,MAAL,CAAYlW,IAAb,CAA5C,IAAkE+7B,gBAAgB,CAACjkB,IAAI,CAAClV,KAAN,CAAtF,EAAoG;AAClG,mBAAO,KAAP;AACD;;AACD,cAAI6I,SAAS,IAAIA,SAAS,CAACqM,IAAD,CAA1B,EAAkC;AAChC,mBAAO,KAAP;AACD;AACF,SAxBD,QAwBSA,IAAI,GAAGirE,MAAM,CAACjrE,IAAD,EAAOrS,IAAP,CAxBtB;AAyBD;;AACD,aAAO,IAAP;AACD,KArCD;;AAsCAw9E,IAAAA,OAAO,CAACpjF,SAAR,CAAkB0W,IAAlB,GAAyB,UAAUqgB,IAAV,EAAgB;AACvC,aAAOmsD,MAAM,CAAC,IAAD,EAAO,IAAP,EAAansD,IAAb,CAAb;AACD,KAFD;;AAGA,WAAOqsD,OAAP;AACD,GArPa,EAAd;;AAuPA,MAAIO,qBAAqB,GAAG,UAAUvsE,IAAV,EAAgB;AAC1C,QAAIwsE,YAAY,GAAG,sCAAnB;AACA,QAAIC,MAAM,GAAG,EAAb;AACA,QAAIC,IAAI,GAAG,EAAX;AACA,QAAI9zE,MAAM,GAAG4/C,UAAU,CAAC,KAAD,CAAvB;AACA,QAAIx8C,OAAJ;AACA,QAAIjI,KAAK,GAAG,CAAZ;AACA,QAAI+jB,KAAK,GAAG,CAAZ;;AACA,WAAO9b,OAAO,GAAGwwE,YAAY,CAAC/tE,IAAb,CAAkBuB,IAAlB,CAAjB,EAA0C;AACxC,UAAI2sE,GAAG,GAAG3wE,OAAO,CAAC,CAAD,CAAjB;AACA,UAAI4wE,OAAO,GAAGh0E,MAAM,GAAG,GAAT,GAAekf,KAAK,EAAlC;AACA40D,MAAAA,IAAI,CAACE,OAAD,CAAJ,GAAgBD,GAAhB;;AACA,UAAI54E,KAAK,GAAGiI,OAAO,CAACjI,KAApB,EAA2B;AACzB04E,QAAAA,MAAM,CAACx8E,IAAP,CAAY+P,IAAI,CAACvH,MAAL,CAAY1E,KAAZ,EAAmBiI,OAAO,CAACjI,KAAR,GAAgBA,KAAnC,CAAZ;AACD;;AACD04E,MAAAA,MAAM,CAACx8E,IAAP,CAAY28E,OAAZ;AACA74E,MAAAA,KAAK,GAAGiI,OAAO,CAACjI,KAAR,GAAgB44E,GAAG,CAAC1iF,MAA5B;AACD;;AACD,QAAI4iF,EAAE,GAAG,IAAIhhD,MAAJ,CAAWjzB,MAAM,GAAG,SAApB,EAA+B,GAA/B,CAAT;;AACA,QAAI7E,KAAK,KAAK,CAAd,EAAiB;AACf,aAAO;AACL6E,QAAAA,MAAM,EAAEA,MADH;AAEL8zE,QAAAA,IAAI,EAAEA,IAFD;AAGL1sE,QAAAA,IAAI,EAAEA,IAHD;AAIL6sE,QAAAA,EAAE,EAAEA;AAJC,OAAP;AAMD,KAPD,MAOO;AACL,UAAI94E,KAAK,GAAGiM,IAAI,CAAC/V,MAAjB,EAAyB;AACvBwiF,QAAAA,MAAM,CAACx8E,IAAP,CAAY+P,IAAI,CAACvH,MAAL,CAAY1E,KAAZ,CAAZ;AACD;;AACD,aAAO;AACL6E,QAAAA,MAAM,EAAEA,MADH;AAEL8zE,QAAAA,IAAI,EAAEA,IAFD;AAGL1sE,QAAAA,IAAI,EAAEysE,MAAM,CAACjzD,IAAP,CAAY,EAAZ,CAHD;AAILqzD,QAAAA,EAAE,EAAEA;AAJC,OAAP;AAMD;AACF,GArCD;;AAsCA,MAAIC,eAAe,GAAG,UAAU9sE,IAAV,EAAgBsa,MAAhB,EAAwB;AAC5C,WAAOta,IAAI,CAAC/I,OAAL,CAAaqjB,MAAM,CAACuyD,EAApB,EAAwB,UAAUD,OAAV,EAAmB;AAChD,aAAO35E,KAAK,CAACqnB,MAAM,CAACoyD,IAAR,EAAcE,OAAd,CAAL,CAA4Bv/E,KAA5B,CAAkCu/E,OAAlC,CAAP;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAIG,YAAY,GAAG,UAAUJ,GAAV,EAAe;AAChC,QAAI3wE,OAAO,GAAG,wCAAwCyC,IAAxC,CAA6CkuE,GAA7C,CAAd;;AACA,QAAI3wE,OAAJ,EAAa;AACX,aAAOlN,QAAQ,CAACR,IAAT,CAAc;AACnBW,QAAAA,IAAI,EAAE+M,OAAO,CAAC,CAAD,CADM;AAEnBya,QAAAA,IAAI,EAAEu2D,kBAAkB,CAAChxE,OAAO,CAAC,CAAD,CAAR;AAFL,OAAd,CAAP;AAID,KALD,MAKO;AACL,aAAOlN,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF,GAVD;;AAYA,MAAIwgF,sBAAsB,GAAG,CAC3B,KAD2B,EAE3B,OAF2B,CAA7B;;AAIA,MAAIC,qBAAqB,GAAG,UAAUnkF,IAAV,EAAgB;AAC1C,WAAOA,IAAI,CAACG,OAAL,CAAa,OAAb,MAA0B,CAA1B,IAA+BH,IAAI,CAACG,OAAL,CAAa,OAAb,MAA0B,CAAhE;AACD,GAFD;;AAGA,MAAIikF,gBAAgB,GAAG,UAAUC,gBAAV,EAA4BjhE,OAA5B,EAAqC;AAC1D,QAAIkhE,OAAO,GAAG39E,UAAU,CAAC09E,gBAAD,CAAV,GAA+B/8E,QAAQ,CAAC48E,sBAAD,EAAyB9gE,OAAzB,CAAvC,GAA2EihE,gBAAzF;AACA,WAAO,CAACC,OAAR;AACD,GAHD;;AAIA,MAAIC,YAAY,GAAG,UAAU/wD,QAAV,EAAoBowD,GAApB,EAAyBxgE,OAAzB,EAAkC;AACnD,QAAIoQ,QAAQ,CAACgxD,oBAAb,EAAmC;AACjC,aAAO,KAAP;AACD,KAFD,MAEO,IAAI,iBAAiBz3E,IAAjB,CAAsB62E,GAAtB,CAAJ,EAAgC;AACrC,aAAOQ,gBAAgB,CAAC5wD,QAAQ,CAACqW,mBAAV,EAA+BzmB,OAA/B,CAAhB,IAA2D,yBAAyBrW,IAAzB,CAA8B62E,GAA9B,CAAlE;AACD,KAFM,MAEA;AACL,aAAO,UAAU72E,IAAV,CAAe62E,GAAf,CAAP;AACD;AACF,GARD;;AASA,MAAIa,eAAe,GAAG,UAAUzkD,MAAV,EAAkB/oB,IAAlB,EAAwBytE,UAAxB,EAAoC;AACxD,QAAI31D,KAAK,GAAG,CAAZ;AAAA,QAAe/jB,KAAf;AAAA,QAAsBiI,OAAtB;AACA,QAAI0xE,kBAAkB,GAAG3kD,MAAM,CAACiH,qBAAP,EAAzB;AACA,QAAI29C,WAAW,GAAG,sGAAlB;AACAA,IAAAA,WAAW,CAAC96C,SAAZ,GAAwB9+B,KAAK,GAAG05E,UAAhC;;AACA,WAAOzxE,OAAO,GAAG2xE,WAAW,CAAClvE,IAAZ,CAAiBuB,IAAjB,CAAjB,EAAyC;AACvCjM,MAAAA,KAAK,GAAG45E,WAAW,CAAC96C,SAApB;;AACA,UAAI72B,OAAO,CAAC,CAAD,CAAP,KAAe,GAAnB,EAAwB;AACtB8b,QAAAA,KAAK;AACN,OAFD,MAEO,IAAI,CAAC9b,OAAO,CAAC,CAAD,CAAZ,EAAiB;AACtB,YAAIA,OAAO,CAAC,CAAD,CAAP,IAAc0xE,kBAAlB,EAAsC;AACpC;AACD;;AACD51D,QAAAA,KAAK;AACN;;AACD,UAAIA,KAAK,KAAK,CAAd,EAAiB;AACf;AACD;AACF;;AACD,WAAO/jB,KAAP;AACD,GApBD;;AAqBA,MAAI65E,oBAAoB,GAAG,UAAU5tE,IAAV,EAAgBytE,UAAhB,EAA4B;AACrD,WAAO,2CAA2C33E,IAA3C,CAAgDkK,IAAI,CAACvH,MAAL,CAAYg1E,UAAZ,CAAhD,CAAP;AACD,GAFD;;AAGA,MAAII,mBAAmB,GAAG,UAAU7tE,IAAV,EAAgBgM,OAAhB,EAAyByhE,UAAzB,EAAqC;AAC7D,QAAIA,UAAU,KAAK,KAAK,CAAxB,EAA2B;AACzBA,MAAAA,UAAU,GAAG,CAAb;AACD;;AACD,QAAIK,MAAM,GAAG9tE,IAAI,CAAC1I,WAAL,EAAb;;AACA,QAAIw2E,MAAM,CAAC5kF,OAAP,CAAe,MAAf,EAAuBukF,UAAvB,MAAuC,CAAC,CAAxC,IAA6CG,oBAAoB,CAACE,MAAD,EAASL,UAAT,CAArE,EAA2F;AACzF,UAAIM,UAAU,GAAGD,MAAM,CAAC5kF,OAAP,CAAe,SAAf,EAA0BukF,UAA1B,CAAjB;AACA,aAAOK,MAAM,CAAC5kF,OAAP,CAAe,GAAf,EAAoB6kF,UAApB,CAAP;AACD,KAHD,MAGO;AACL,UAAI/hE,OAAJ,EAAa;AACX,YAAIgiE,QAAQ,GAAGF,MAAM,CAAC5kF,OAAP,CAAe,GAAf,EAAoBukF,UAApB,CAAf;AACA,eAAOO,QAAQ,KAAK,CAAC,CAAd,GAAkBA,QAAlB,GAA6BF,MAAM,CAAC7jF,MAA3C;AACD,OAHD,MAGO;AACL,YAAIgkF,gBAAgB,GAAG,QAAvB;AACAA,QAAAA,gBAAgB,CAACp7C,SAAjB,GAA6B46C,UAA7B;AACA,YAAI9uE,KAAK,GAAGsvE,gBAAgB,CAACxvE,IAAjB,CAAsBuB,IAAtB,CAAZ;AACA,eAAOrB,KAAK,GAAGA,KAAK,CAAC5K,KAAN,GAAc4K,KAAK,CAAC,CAAD,CAAL,CAAS1U,MAA1B,GAAmC6jF,MAAM,CAAC7jF,MAAtD;AACD;AACF;AACF,GAnBD;;AAoBA,MAAIikF,mBAAmB,GAAG,UAAUC,MAAV,EAAkBC,UAAlB,EAA8B;AACtD,QAAIpyE,OAAO,GAAGmyE,MAAM,CAAC1vE,IAAP,CAAY2vE,UAAZ,CAAd;;AACA,QAAIpyE,OAAJ,EAAa;AACX,UAAIqD,MAAM,GAAGrD,OAAO,CAAC,CAAD,CAApB;AACA,UAAIrQ,KAAK,GAAGqQ,OAAO,CAAC,CAAD,CAAnB;AACA,aAAO,OAAOqD,MAAP,KAAkB,QAAlB,IAA8BA,MAAM,CAAC/H,WAAP,OAAyB,gBAAvD,GAA0E3L,KAA1E,GAAkF,IAAzF;AACD,KAJD,MAIO;AACL,aAAO,IAAP;AACD;AACF,GATD;;AAUA,MAAI0iF,SAAS,GAAG,UAAU9xD,QAAV,EAAoBwM,MAApB,EAA4B;AAC1C,QAAIA,MAAM,KAAK,KAAK,CAApB,EAAuB;AACrBA,MAAAA,MAAM,GAAGkB,MAAM,EAAf;AACD;;AACD1N,IAAAA,QAAQ,GAAGA,QAAQ,IAAI,EAAvB;;AACA,QAAIA,QAAQ,CAAC+xD,gBAAT,KAA8B,KAAlC,EAAyC;AACvC/xD,MAAAA,QAAQ,CAAC+xD,gBAAT,GAA4B,IAA5B;AACD;;AACD,QAAIC,OAAO,GAAGhyD,QAAQ,CAACgyD,OAAT,GAAmBhyD,QAAQ,CAACgyD,OAA5B,GAAsCzjF,IAApD;AACA,QAAI0jF,KAAK,GAAGjyD,QAAQ,CAACiyD,KAAT,GAAiBjyD,QAAQ,CAACiyD,KAA1B,GAAkC1jF,IAA9C;AACA,QAAIiW,IAAI,GAAGwb,QAAQ,CAACxb,IAAT,GAAgBwb,QAAQ,CAACxb,IAAzB,GAAgCjW,IAA3C;AACA,QAAI4N,KAAK,GAAG6jB,QAAQ,CAAC7jB,KAAT,GAAiB6jB,QAAQ,CAAC7jB,KAA1B,GAAkC5N,IAA9C;AACA,QAAIw1D,GAAG,GAAG/jC,QAAQ,CAAC+jC,GAAT,GAAe/jC,QAAQ,CAAC+jC,GAAxB,GAA8Bx1D,IAAxC;AACA,QAAI2jF,EAAE,GAAGlyD,QAAQ,CAACkyD,EAAT,GAAclyD,QAAQ,CAACkyD,EAAvB,GAA4B3jF,IAArC;AACA,QAAI4jF,OAAO,GAAGnyD,QAAQ,CAACmyD,OAAT,GAAmBnyD,QAAQ,CAACmyD,OAA5B,GAAsC5jF,IAApD;;AACA,QAAI6jF,aAAa,GAAG,UAAUC,aAAV,EAAyB1d,MAAzB,EAAiC;AACnD,UAAIA,MAAM,KAAK,KAAK,CAApB,EAAuB;AACrBA,QAAAA,MAAM,GAAG,MAAT;AACD;;AACD,UAAIlxD,IAAI,GAAG4uE,aAAa,CAAC5uE,IAAzB;AACA,UAAIhE,OAAJ;AAAA,UAAajI,KAAK,GAAG,CAArB;AAAA,UAAwBpI,KAAxB;AAAA,UAA+BkjF,SAA/B;AACA,UAAIC,KAAK,GAAG,EAAZ;AACA,UAAIC,QAAJ,EAAc5kF,CAAd,EAAiB6kF,QAAjB,EAA2BjmF,IAA3B;AACA,UAAIkmF,iBAAJ,EAAuBC,YAAvB;AACA,UAAIC,WAAJ,EAAiBC,cAAjB,EAAiCvhE,IAAjC,EAAuCwhE,YAAvC,EAAqDC,kBAArD,EAAyEC,sBAAzE;AACA,UAAIviD,kBAAJ,EAAwBG,iBAAxB,EAA2CC,gBAA3C;AACA,UAAIoiD,qBAAJ;AAAA,UAA2B1jE,SAA3B;AAAA,UAAsC0Q,OAAO,GAAG,CAAhD;AACA,UAAI8L,MAAM,GAAGC,QAAQ,CAACD,MAAtB;AACA,UAAImnD,gBAAgB,GAAG9vE,KAAK,CAAC9B,OAAN,CAAc,8DAAd,CAAvB;AACA,UAAI6xE,eAAe,GAAG,2BAAtB;AACA,UAAIC,WAAW,GAAGze,MAAM,KAAK,MAAX,GAAoB,CAApB,GAAwB,CAA1C;;AACA,UAAI0e,aAAa,GAAG,UAAU7mF,IAAV,EAAgB;AAClC,YAAI2mB,GAAJ,EAASvlB,CAAT;AACAulB,QAAAA,GAAG,GAAGo/D,KAAK,CAAC7kF,MAAZ;;AACA,eAAOylB,GAAG,EAAV,EAAc;AACZ,cAAIo/D,KAAK,CAACp/D,GAAD,CAAL,CAAW3mB,IAAX,KAAoBA,IAAxB,EAA8B;AAC5B;AACD;AACF;;AACD,YAAI2mB,GAAG,IAAI,CAAX,EAAc;AACZ,eAAKvlB,CAAC,GAAG2kF,KAAK,CAAC7kF,MAAN,GAAe,CAAxB,EAA2BE,CAAC,IAAIulB,GAAhC,EAAqCvlB,CAAC,EAAtC,EAA0C;AACxCpB,YAAAA,IAAI,GAAG+lF,KAAK,CAAC3kF,CAAD,CAAZ;;AACA,gBAAIpB,IAAI,CAAC8mF,KAAT,EAAgB;AACdvvB,cAAAA,GAAG,CAACv3D,IAAI,CAACA,IAAN,CAAH;AACD;AACF;;AACD+lF,UAAAA,KAAK,CAAC7kF,MAAN,GAAeylB,GAAf;AACD;AACF,OAjBD;;AAkBA,UAAIogE,WAAW,GAAG,UAAUnkF,KAAV,EAAiB4iB,GAAjB,EAAsB;AACtC,eAAOxN,IAAI,CAAC+rE,eAAe,CAACnhF,KAAD,EAAQijF,aAAR,CAAhB,EAAwCrgE,GAAxC,CAAX;AACD,OAFD;;AAGA,UAAIwhE,cAAc,GAAG,UAAUpkF,KAAV,EAAiB;AACpC,YAAIA,KAAK,KAAK,EAAd,EAAkB;AAChB;AACD;;AACD,YAAIA,KAAK,CAACi3B,MAAN,CAAa,CAAb,MAAoB,GAAxB,EAA6B;AAC3Bj3B,UAAAA,KAAK,GAAG,MAAMA,KAAd;AACD;;AACD,YAAI,CAAC4wB,QAAQ,CAACyzD,0BAAV,IAAwCrkF,KAAK,CAAC8M,MAAN,CAAa,CAAb,EAAgB,CAAhB,EAAmBnB,WAAnB,OAAqC,KAAjF,EAAwF;AACtF3L,UAAAA,KAAK,GAAG,MAAMA,KAAd;AACD;;AACD4iF,QAAAA,OAAO,CAACzB,eAAe,CAACnhF,KAAD,EAAQijF,aAAR,CAAhB,CAAP;AACD,OAXD;;AAYA,UAAIqB,WAAW,GAAG,UAAUtkF,KAAV,EAAiB;AACjC,eAAOmhF,eAAe,CAACnhF,KAAD,EAAQijF,aAAR,CAAtB;AACD,OAFD;;AAGA,UAAIsB,uBAAuB,GAAG,UAAUvkF,KAAV,EAAiB8hF,UAAjB,EAA6B;AACzD,YAAI0C,QAAQ,GAAGxkF,KAAK,IAAI,EAAxB;AACA,YAAIqgB,OAAO,GAAG,CAACnT,UAAU,CAACs3E,QAAD,EAAW,IAAX,CAAzB;AACA,YAAInC,QAAQ,GAAGH,mBAAmB,CAAC7tE,IAAD,EAAOgM,OAAP,EAAgByhE,UAAhB,CAAlC;AACA9hF,QAAAA,KAAK,GAAGqU,IAAI,CAACvH,MAAL,CAAYg1E,UAAZ,EAAwBO,QAAQ,GAAGP,UAAnC,CAAR;AACAsC,QAAAA,cAAc,CAAC/jE,OAAO,GAAGmkE,QAAQ,GAAGxkF,KAAd,GAAsBA,KAA9B,CAAd;AACA,eAAOqiF,QAAQ,GAAG,CAAlB;AACD,OAPD;;AAQA,UAAIoC,cAAc,GAAG,UAAUjkE,OAAV,EAAmBpjB,IAAnB,EAAyB4C,KAAzB,EAAgC0kF,IAAhC,EAAsCC,IAAtC,EAA4C;AAC/D,YAAIC,QAAJ,EAAcpmF,CAAd;AACA,YAAIqmF,UAAU,GAAG,qBAAjB;AACAznF,QAAAA,IAAI,GAAGA,IAAI,CAACuO,WAAL,EAAP;AACA3L,QAAAA,KAAK,GAAGskF,WAAW,CAAClnF,IAAI,IAAI0nF,YAAR,GAAuB1nF,IAAvB,GAA8Bu/B,MAAM,CAAC38B,KAAK,IAAI0kF,IAAT,IAAiBC,IAAjB,IAAyB,EAA1B,CAArC,CAAnB;;AACA,YAAI1I,QAAQ,IAAI,CAACqH,iBAAb,IAAkC/B,qBAAqB,CAACnkF,IAAD,CAArB,KAAgC,KAAtE,EAA6E;AAC3EwnF,UAAAA,QAAQ,GAAGjB,kBAAkB,CAACvmF,IAAD,CAA7B;;AACA,cAAI,CAACwnF,QAAD,IAAahB,sBAAjB,EAAyC;AACvCplF,YAAAA,CAAC,GAAGolF,sBAAsB,CAACtlF,MAA3B;;AACA,mBAAOE,CAAC,EAAR,EAAY;AACVomF,cAAAA,QAAQ,GAAGhB,sBAAsB,CAACplF,CAAD,CAAjC;;AACA,kBAAIomF,QAAQ,CAAC/iD,OAAT,CAAiB13B,IAAjB,CAAsB/M,IAAtB,CAAJ,EAAiC;AAC/B;AACD;AACF;;AACD,gBAAIoB,CAAC,KAAK,CAAC,CAAX,EAAc;AACZomF,cAAAA,QAAQ,GAAG,IAAX;AACD;AACF;;AACD,cAAI,CAACA,QAAL,EAAe;AACb;AACD;;AACD,cAAIA,QAAQ,CAACjjD,WAAT,IAAwB,EAAE3hC,KAAK,IAAI4kF,QAAQ,CAACjjD,WAApB,CAA5B,EAA8D;AAC5D;AACD;AACF;;AACD,YAAImiD,gBAAgB,CAAC1mF,IAAD,CAAhB,IAA0B,CAACwzB,QAAQ,CAACmW,iBAAxC,EAA2D;AACzD,cAAIi6C,GAAG,GAAGhhF,KAAK,CAACsL,OAAN,CAAcu5E,UAAd,EAA0B,EAA1B,CAAV;;AACA,cAAI;AACF7D,YAAAA,GAAG,GAAGK,kBAAkB,CAACL,GAAD,CAAxB;AACD,WAFD,CAEE,OAAOt4D,EAAP,EAAW;AACXs4D,YAAAA,GAAG,GAAG+D,QAAQ,CAAC/D,GAAD,CAAd;AACD;;AACD,cAAI+C,eAAe,CAAC55E,IAAhB,CAAqB62E,GAArB,CAAJ,EAA+B;AAC7B;AACD;;AACD,cAAIW,YAAY,CAAC/wD,QAAD,EAAWowD,GAAX,EAAgBxgE,OAAhB,CAAhB,EAA0C;AACxC;AACD;AACF;;AACD,YAAI8iE,iBAAiB,KAAKlmF,IAAI,IAAI0mF,gBAAR,IAA4B1mF,IAAI,CAACG,OAAL,CAAa,IAAb,MAAuB,CAAxD,CAArB,EAAiF;AAC/E;AACD;;AACD6lF,QAAAA,QAAQ,CAACnhF,GAAT,CAAa7E,IAAb,IAAqB4C,KAArB;AACAojF,QAAAA,QAAQ,CAAC9+E,IAAT,CAAc;AACZlH,UAAAA,IAAI,EAAEA,IADM;AAEZ4C,UAAAA,KAAK,EAAEA;AAFK,SAAd;AAID,OAhDD;;AAiDA,UAAIgiF,WAAW,GAAG,IAAI9hD,MAAJ,CAAW,SAAS,2BAAT,GAAuC,sCAAvC,GAAgF,iDAAhF,GAAoI,aAApI,GAAoJ,2CAApJ,GAAkM,2CAAlM,GAAgP,kHAAhP,GAAqW,GAAhX,EAAqX,GAArX,CAAlB;AACA,UAAI8kD,UAAU,GAAG,gFAAjB;AACA,UAAIjD,kBAAkB,GAAG3kD,MAAM,CAACiH,qBAAP,EAAzB;AACA,UAAI4gD,WAAW,GAAGr0D,QAAQ,CAACs0D,qBAAT,IAAkC9nD,MAAM,CAACkH,sBAAP,EAApD;AACA,UAAIwgD,YAAY,GAAG1nD,MAAM,CAAC6G,YAAP,EAAnB;AACA,UAAIg4C,QAAQ,GAAGrrD,QAAQ,CAACqrD,QAAxB;AACA,UAAIkJ,sBAAsB,GAAGv0D,QAAQ,CAACw0D,gBAAtC;AACA,UAAIC,cAAc,GAAGz0D,QAAQ,CAAC+xD,gBAA9B;AACA,UAAIlkD,eAAe,GAAGrB,MAAM,CAACsH,kBAAP,EAAtB;AACA,UAAI4gD,WAAW,GAAGjxE,IAAI,GAAG,GAAzB;;AACA,aAAOhE,OAAO,GAAG2xE,WAAW,CAAClvE,IAAZ,CAAiBwyE,WAAjB,CAAjB,EAAgD;AAC9C,YAAIC,SAAS,GAAGl1E,OAAO,CAAC,CAAD,CAAvB;;AACA,YAAIjI,KAAK,GAAGiI,OAAO,CAACjI,KAApB,EAA2B;AACzB+7E,UAAAA,WAAW,CAACxnD,MAAM,CAACtoB,IAAI,CAACvH,MAAL,CAAY1E,KAAZ,EAAmBiI,OAAO,CAACjI,KAAR,GAAgBA,KAAnC,CAAD,CAAP,CAAX;AACD;;AACD,YAAIpI,KAAK,GAAGqQ,OAAO,CAAC,CAAD,CAAnB,EAAwB;AACtBrQ,UAAAA,KAAK,GAAGA,KAAK,CAAC2L,WAAN,EAAR;;AACA,cAAI3L,KAAK,CAACi3B,MAAN,CAAa,CAAb,MAAoB,GAAxB,EAA6B;AAC3Bj3B,YAAAA,KAAK,GAAGA,KAAK,CAAC8M,MAAN,CAAa,CAAb,CAAR;AACD;;AACDm3E,UAAAA,aAAa,CAACjkF,KAAD,CAAb;AACD,SAND,MAMO,IAAIA,KAAK,GAAGqQ,OAAO,CAAC,CAAD,CAAnB,EAAwB;AAC7B,cAAIA,OAAO,CAACjI,KAAR,GAAgBm9E,SAAS,CAACjnF,MAA1B,GAAmC+V,IAAI,CAAC/V,MAA5C,EAAoD;AAClD6lF,YAAAA,WAAW,CAACxnD,MAAM,CAACtoB,IAAI,CAACvH,MAAL,CAAYuD,OAAO,CAACjI,KAApB,CAAD,CAAP,CAAX;AACAA,YAAAA,KAAK,GAAGiI,OAAO,CAACjI,KAAR,GAAgBm9E,SAAS,CAACjnF,MAAlC;AACA;AACD;;AACD0B,UAAAA,KAAK,GAAGA,KAAK,CAAC2L,WAAN,EAAR;;AACA,cAAI3L,KAAK,CAACi3B,MAAN,CAAa,CAAb,MAAoB,GAAxB,EAA6B;AAC3Bj3B,YAAAA,KAAK,GAAGA,KAAK,CAAC8M,MAAN,CAAa,CAAb,CAAR;AACD;;AACDy2E,UAAAA,YAAY,GAAGvjF,KAAK,IAAI+hF,kBAAxB;;AACA,cAAIsD,cAAc,IAAIJ,WAAW,CAACjlF,KAAD,CAA7B,IAAwCmjF,KAAK,CAAC7kF,MAAN,GAAe,CAAvD,IAA4D6kF,KAAK,CAACA,KAAK,CAAC7kF,MAAN,GAAe,CAAhB,CAAL,CAAwBlB,IAAxB,KAAiC4C,KAAjG,EAAwG;AACtGikF,YAAAA,aAAa,CAACjkF,KAAD,CAAb;AACD;;AACD,cAAIwlF,UAAU,GAAGjD,mBAAmB,CAACyC,UAAD,EAAa30E,OAAO,CAAC,CAAD,CAApB,CAApC;;AACA,cAAIm1E,UAAU,KAAK,IAAnB,EAAyB;AACvB,gBAAIA,UAAU,KAAK,KAAnB,EAA0B;AACxBp9E,cAAAA,KAAK,GAAGy5E,eAAe,CAACzkD,MAAD,EAAS/oB,IAAT,EAAe2tE,WAAW,CAAC96C,SAA3B,CAAvB;AACA86C,cAAAA,WAAW,CAAC96C,SAAZ,GAAwB9+B,KAAxB;AACA;AACD;;AACDq7E,YAAAA,cAAc,GAAG,KAAjB;AACD;;AACD,cAAI,CAACxH,QAAD,KAAcuH,WAAW,GAAGpmD,MAAM,CAACwF,cAAP,CAAsB5iC,KAAtB,CAA5B,CAAJ,EAA+D;AAC7DyjF,YAAAA,cAAc,GAAG,IAAjB;;AACA,gBAAIxH,QAAJ,EAAc;AACZ0H,cAAAA,kBAAkB,GAAGH,WAAW,CAACvhE,UAAjC;AACA2hE,cAAAA,sBAAsB,GAAGJ,WAAW,CAAC5hD,iBAArC;AACD;;AACD,gBAAI8hD,YAAY,GAAGrzE,OAAO,CAAC,CAAD,CAA1B,EAA+B;AAC7BizE,cAAAA,iBAAiB,GAAGI,YAAY,CAACnmF,OAAb,CAAqB,eAArB,MAA0C,CAAC,CAA/D;;AACA,kBAAI+lF,iBAAiB,IAAI6B,sBAAzB,EAAiD;AAC/C1B,gBAAAA,cAAc,GAAG,KAAjB;AACD;;AACDL,cAAAA,QAAQ,GAAG,EAAX;AACAA,cAAAA,QAAQ,CAACnhF,GAAT,GAAe,EAAf;AACAyhF,cAAAA,YAAY,CAACp4E,OAAb,CAAqB05E,UAArB,EAAiC,UAAUhyE,KAAV,EAAiB5V,IAAjB,EAAuB0rB,GAAvB,EAA4B47D,IAA5B,EAAkCC,IAAlC,EAAwC;AACvEF,gBAAAA,cAAc,CAACzkF,KAAD,EAAQ5C,IAAR,EAAc0rB,GAAd,EAAmB47D,IAAnB,EAAyBC,IAAzB,CAAd;AACA,uBAAO,EAAP;AACD,eAHD;AAID,aAXD,MAWO;AACLvB,cAAAA,QAAQ,GAAG,EAAX;AACAA,cAAAA,QAAQ,CAACnhF,GAAT,GAAe,EAAf;AACD;;AACD,gBAAIg6E,QAAQ,IAAI,CAACqH,iBAAjB,EAAoC;AAClCjiD,cAAAA,kBAAkB,GAAGmiD,WAAW,CAACniD,kBAAjC;AACAG,cAAAA,iBAAiB,GAAGgiD,WAAW,CAAChiD,iBAAhC;AACAC,cAAAA,gBAAgB,GAAG+hD,WAAW,CAAC/hD,gBAA/B;AACAoiD,cAAAA,qBAAqB,GAAGL,WAAW,CAACpiD,gBAApC;;AACA,kBAAIyiD,qBAAqB,IAAI,CAACT,QAAQ,CAAC9kF,MAAvC,EAA+C;AAC7CmlF,gBAAAA,cAAc,GAAG,KAAjB;AACD;;AACD,kBAAIhiD,gBAAJ,EAAsB;AACpBjjC,gBAAAA,CAAC,GAAGijC,gBAAgB,CAACnjC,MAArB;;AACA,uBAAOE,CAAC,EAAR,EAAY;AACV0jB,kBAAAA,IAAI,GAAGuf,gBAAgB,CAACjjC,CAAD,CAAvB;AACApB,kBAAAA,IAAI,GAAG8kB,IAAI,CAAC9kB,IAAZ;AACA+iB,kBAAAA,SAAS,GAAG+B,IAAI,CAACliB,KAAjB;;AACA,sBAAImgB,SAAS,KAAK,QAAlB,EAA4B;AAC1BA,oBAAAA,SAAS,GAAG,SAAS0Q,OAAO,EAA5B;AACD;;AACDuyD,kBAAAA,QAAQ,CAACnhF,GAAT,CAAa7E,IAAb,IAAqB+iB,SAArB;AACAijE,kBAAAA,QAAQ,CAAC9+E,IAAT,CAAc;AACZlH,oBAAAA,IAAI,EAAEA,IADM;AAEZ4C,oBAAAA,KAAK,EAAEmgB;AAFK,mBAAd;AAID;AACF;;AACD,kBAAIqhB,iBAAJ,EAAuB;AACrBhjC,gBAAAA,CAAC,GAAGgjC,iBAAiB,CAACljC,MAAtB;;AACA,uBAAOE,CAAC,EAAR,EAAY;AACV0jB,kBAAAA,IAAI,GAAGsf,iBAAiB,CAAChjC,CAAD,CAAxB;AACApB,kBAAAA,IAAI,GAAG8kB,IAAI,CAAC9kB,IAAZ;;AACA,sBAAI,EAAEA,IAAI,IAAIgmF,QAAQ,CAACnhF,GAAnB,CAAJ,EAA6B;AAC3Bke,oBAAAA,SAAS,GAAG+B,IAAI,CAACliB,KAAjB;;AACA,wBAAImgB,SAAS,KAAK,QAAlB,EAA4B;AAC1BA,sBAAAA,SAAS,GAAG,SAAS0Q,OAAO,EAA5B;AACD;;AACDuyD,oBAAAA,QAAQ,CAACnhF,GAAT,CAAa7E,IAAb,IAAqB+iB,SAArB;AACAijE,oBAAAA,QAAQ,CAAC9+E,IAAT,CAAc;AACZlH,sBAAAA,IAAI,EAAEA,IADM;AAEZ4C,sBAAAA,KAAK,EAAEmgB;AAFK,qBAAd;AAID;AACF;AACF;;AACD,kBAAIkhB,kBAAJ,EAAwB;AACtB7iC,gBAAAA,CAAC,GAAG6iC,kBAAkB,CAAC/iC,MAAvB;;AACA,uBAAOE,CAAC,EAAR,EAAY;AACV,sBAAI6iC,kBAAkB,CAAC7iC,CAAD,CAAlB,IAAyB4kF,QAAQ,CAACnhF,GAAtC,EAA2C;AACzC;AACD;AACF;;AACD,oBAAIzD,CAAC,KAAK,CAAC,CAAX,EAAc;AACZilF,kBAAAA,cAAc,GAAG,KAAjB;AACD;AACF;;AACD,kBAAIvhE,IAAI,GAAGkhE,QAAQ,CAACnhF,GAAT,CAAa,gBAAb,CAAX,EAA2C;AACzC,oBAAIigB,IAAI,KAAK,KAAb,EAAoB;AAClB9Z,kBAAAA,KAAK,GAAGy5E,eAAe,CAACzkD,MAAD,EAAS/oB,IAAT,EAAe2tE,WAAW,CAAC96C,SAA3B,CAAvB;AACA86C,kBAAAA,WAAW,CAAC96C,SAAZ,GAAwB9+B,KAAxB;AACA;AACD;;AACDq7E,gBAAAA,cAAc,GAAG,KAAjB;AACD;AACF;;AACD,gBAAIA,cAAJ,EAAoB;AAClB12E,cAAAA,KAAK,CAAC/M,KAAD,EAAQojF,QAAR,EAAkBG,YAAlB,CAAL;AACD;AACF,WAtFD,MAsFO;AACLE,YAAAA,cAAc,GAAG,KAAjB;AACD;;AACD,cAAIP,SAAS,GAAGzkD,eAAe,CAACz+B,KAAD,CAA/B,EAAwC;AACtCkjF,YAAAA,SAAS,CAACh8C,SAAV,GAAsB9+B,KAAK,GAAGiI,OAAO,CAACjI,KAAR,GAAgBm9E,SAAS,CAACjnF,MAAxD;;AACA,gBAAI+R,OAAO,GAAG6yE,SAAS,CAACpwE,IAAV,CAAeuB,IAAf,CAAd,EAAoC;AAClC,kBAAIovE,cAAJ,EAAoB;AAClBJ,gBAAAA,QAAQ,GAAGhvE,IAAI,CAACvH,MAAL,CAAY1E,KAAZ,EAAmBiI,OAAO,CAACjI,KAAR,GAAgBA,KAAnC,CAAX;AACD;;AACDA,cAAAA,KAAK,GAAGiI,OAAO,CAACjI,KAAR,GAAgBiI,OAAO,CAAC,CAAD,CAAP,CAAW/R,MAAnC;AACD,aALD,MAKO;AACL+kF,cAAAA,QAAQ,GAAGhvE,IAAI,CAACvH,MAAL,CAAY1E,KAAZ,CAAX;AACAA,cAAAA,KAAK,GAAGiM,IAAI,CAAC/V,MAAb;AACD;;AACD,gBAAImlF,cAAJ,EAAoB;AAClB,kBAAIJ,QAAQ,CAAC/kF,MAAT,GAAkB,CAAtB,EAAyB;AACvB6lF,gBAAAA,WAAW,CAACd,QAAD,EAAW,IAAX,CAAX;AACD;;AACD1uB,cAAAA,GAAG,CAAC30D,KAAD,CAAH;AACD;;AACDgiF,YAAAA,WAAW,CAAC96C,SAAZ,GAAwB9+B,KAAxB;AACA;AACD;;AACD,cAAI,CAACm7E,YAAL,EAAmB;AACjB,gBAAI,CAACG,YAAD,IAAiBA,YAAY,CAACnmF,OAAb,CAAqB,GAArB,MAA8BmmF,YAAY,CAACplF,MAAb,GAAsB,CAAzE,EAA4E;AAC1E6kF,cAAAA,KAAK,CAAC7+E,IAAN,CAAW;AACTlH,gBAAAA,IAAI,EAAE4C,KADG;AAETkkF,gBAAAA,KAAK,EAAET;AAFE,eAAX;AAID,aALD,MAKO,IAAIA,cAAJ,EAAoB;AACzB9uB,cAAAA,GAAG,CAAC30D,KAAD,CAAH;AACD;AACF;AACF,SA9IM,MA8IA,IAAIA,KAAK,GAAGqQ,OAAO,CAAC,CAAD,CAAnB,EAAwB;AAC7B+zE,UAAAA,cAAc,CAACpkF,KAAD,CAAd;AACD,SAFM,MAEA,IAAIA,KAAK,GAAGqQ,OAAO,CAAC,CAAD,CAAnB,EAAwB;AAC7B,cAAIo1E,mBAAmB,GAAGzB,WAAW,KAAK,CAAhB,IAAqBpzD,QAAQ,CAAC80D,cAA9B,IAAgDvC,KAAK,CAAC7kF,MAAN,GAAe,CAAf,IAAoB8+B,MAAM,CAACuH,YAAP,CAAoBw+C,KAAK,CAACA,KAAK,CAAC7kF,MAAN,GAAe,CAAhB,CAAL,CAAwBlB,IAA5C,EAAkD,QAAlD,CAA9F;;AACA,cAAIqoF,mBAAJ,EAAyB;AACvB5C,YAAAA,KAAK,CAAC7iF,KAAD,CAAL;AACD,WAFD,MAEO;AACLoI,YAAAA,KAAK,GAAGm8E,uBAAuB,CAAC,EAAD,EAAKl0E,OAAO,CAACjI,KAAR,GAAgB,CAArB,CAA/B;AACA45E,YAAAA,WAAW,CAAC96C,SAAZ,GAAwB9+B,KAAxB;AACA;AACD;AACF,SATM,MASA,IAAIpI,KAAK,GAAGqQ,OAAO,CAAC,CAAD,CAAnB,EAAwB;AAC7B0yE,UAAAA,OAAO,CAAC/iF,KAAD,CAAP;AACD,SAFM,MAEA,IAAI,CAACA,KAAK,GAAGqQ,OAAO,CAAC,CAAD,CAAhB,KAAwBk1E,SAAS,KAAK,IAA1C,EAAgD;AACrDn9E,UAAAA,KAAK,GAAGm8E,uBAAuB,CAACvkF,KAAD,EAAQqQ,OAAO,CAACjI,KAAR,GAAgBm9E,SAAS,CAACjnF,MAAlC,CAA/B;AACA0jF,UAAAA,WAAW,CAAC96C,SAAZ,GAAwB9+B,KAAxB;AACA;AACD,SAJM,MAIA,IAAIpI,KAAK,GAAGqQ,OAAO,CAAC,CAAD,CAAnB,EAAwB;AAC7B,cAAI2zE,WAAW,KAAK,CAApB,EAAuB;AACrBlB,YAAAA,EAAE,CAAC9iF,KAAD,EAAQqQ,OAAO,CAAC,CAAD,CAAf,CAAF;AACD,WAFD,MAEO;AACLjI,YAAAA,KAAK,GAAGm8E,uBAAuB,CAAC,GAAD,EAAMl0E,OAAO,CAACjI,KAAR,GAAgB,CAAtB,CAA/B;AACA45E,YAAAA,WAAW,CAAC96C,SAAZ,GAAwB9+B,KAAxB;AACA;AACD;AACF;;AACDA,QAAAA,KAAK,GAAGiI,OAAO,CAACjI,KAAR,GAAgBm9E,SAAS,CAACjnF,MAAlC;AACD;;AACD,UAAI8J,KAAK,GAAGiM,IAAI,CAAC/V,MAAjB,EAAyB;AACvB6lF,QAAAA,WAAW,CAACxnD,MAAM,CAACtoB,IAAI,CAACvH,MAAL,CAAY1E,KAAZ,CAAD,CAAP,CAAX;AACD;;AACD,WAAK5J,CAAC,GAAG2kF,KAAK,CAAC7kF,MAAN,GAAe,CAAxB,EAA2BE,CAAC,IAAI,CAAhC,EAAmCA,CAAC,EAApC,EAAwC;AACtCwB,QAAAA,KAAK,GAAGmjF,KAAK,CAAC3kF,CAAD,CAAb;;AACA,YAAIwB,KAAK,CAACkkF,KAAV,EAAiB;AACfvvB,UAAAA,GAAG,CAAC30D,KAAK,CAAC5C,IAAP,CAAH;AACD;AACF;AACF,KArTD;;AAsTA,QAAIuoC,KAAK,GAAG,UAAUtxB,IAAV,EAAgBkxD,MAAhB,EAAwB;AAClC,UAAIA,MAAM,KAAK,KAAK,CAApB,EAAuB;AACrBA,QAAAA,MAAM,GAAG,MAAT;AACD;;AACDyd,MAAAA,aAAa,CAACpC,qBAAqB,CAACvsE,IAAD,CAAtB,EAA8BkxD,MAA9B,CAAb;AACD,KALD;;AAMA,WAAO;AAAE5/B,MAAAA,KAAK,EAAEA;AAAT,KAAP;AACD,GA5UD;;AA6UA+8C,EAAAA,SAAS,CAACiD,UAAV,GAAuB9D,eAAvB;;AAEA,MAAI+D,QAAQ,GAAG,UAAUC,SAAV,EAAqBxxE,IAArB,EAA2B;AACxC,QAAIyxE,iBAAiB,GAAG,IAAI5lD,MAAJ,CAAW,CAAC,UAAU2lD,SAAS,CAACh4D,IAAV,CAAe,GAAf,CAAV,GAAgC,WAAjC,EAA8CA,IAA9C,CAAmD,GAAnD,CAAX,EAAoE,IAApE,CAAxB;AACA,WAAOxZ,IAAI,CAAC/I,OAAL,CAAaw6E,iBAAb,EAAgC,EAAhC,CAAP;AACD,GAHD;;AAIA,MAAIC,YAAY,GAAG,UAAUx5B,UAAV,EAAsBl4C,IAAtB,EAA4B;AAC7C,QAAIynC,OAAO,GAAGznC,IAAd;AACA,QAAI2xE,cAAc,GAAG,yCAArB;AACA,QAAIC,WAAJ,EAAiB79E,KAAjB,EAAwB89E,WAAxB,EAAqC71E,OAArC;AACA,QAAI+sB,MAAM,GAAGmvB,UAAU,CAACnvB,MAAxB;AACA0e,IAAAA,OAAO,GAAG8pC,QAAQ,CAACr5B,UAAU,CAAC45B,YAAX,EAAD,EAA4BrqC,OAA5B,CAAlB;AACA,QAAIimC,kBAAkB,GAAG3kD,MAAM,CAACiH,qBAAP,EAAzB;;AACA,WAAOh0B,OAAO,GAAG21E,cAAc,CAAClzE,IAAf,CAAoBgpC,OAApB,CAAjB,EAA+C;AAC7C1zC,MAAAA,KAAK,GAAG49E,cAAc,CAAC9+C,SAAvB;AACAg/C,MAAAA,WAAW,GAAG71E,OAAO,CAAC,CAAD,CAAP,CAAW/R,MAAzB;;AACA,UAAIyjF,kBAAkB,CAAC1xE,OAAO,CAAC,CAAD,CAAR,CAAtB,EAAoC;AAClC41E,QAAAA,WAAW,GAAG79E,KAAd;AACD,OAFD,MAEO;AACL69E,QAAAA,WAAW,GAAGvD,SAAS,CAACiD,UAAV,CAAqBvoD,MAArB,EAA6B0e,OAA7B,EAAsC1zC,KAAtC,CAAd;AACD;;AACD0zC,MAAAA,OAAO,GAAGA,OAAO,CAAClvC,SAAR,CAAkB,CAAlB,EAAqBxE,KAAK,GAAG89E,WAA7B,IAA4CpqC,OAAO,CAAClvC,SAAR,CAAkBq5E,WAAlB,CAAtD;AACAD,MAAAA,cAAc,CAAC9+C,SAAf,GAA2B9+B,KAAK,GAAG89E,WAAnC;AACD;;AACD,WAAO9vD,MAAM,CAAC0lB,OAAD,CAAb;AACD,GAnBD;;AAoBA,MAAIsqC,YAAY,GAAGL,YAAnB;;AAEA,MAAIM,iBAAiB,GAAG,UAAU/1D,MAAV,EAAkBjc,IAAlB,EAAwB;AAC9C,QAAIojB,SAAS,GAAGi/B,kBAAkB,CAACpmC,MAAD,CAAlC;AACA,QAAIg2D,WAAW,GAAG,IAAIpmD,MAAJ,CAAW,QAAQzI,SAAR,GAAoB,8CAApB,GAAqEA,SAArE,GAAiF,4BAA5F,CAAlB;AACA,WAAOpjB,IAAI,CAAC/I,OAAL,CAAag7E,WAAb,EAA0B,EAA1B,CAAP;AACD,GAJD;;AAKA,MAAIC,kBAAkB,GAAG,UAAUj2D,MAAV,EAAkB/wB,IAAlB,EAAwBgmE,MAAxB,EAAgC/oD,IAAhC,EAAsC;AAC7D,QAAIs/B,OAAJ;AACAv8C,IAAAA,IAAI,CAACgmE,MAAL,GAAcA,MAAd;AACAhmE,IAAAA,IAAI,CAAC0G,GAAL,GAAW,IAAX;AACA1G,IAAAA,IAAI,CAACinF,QAAL,GAAgB,IAAhB;;AACA,QAAI,CAACjnF,IAAI,CAACknF,SAAV,EAAqB;AACnBn2D,MAAAA,MAAM,CAACmb,IAAP,CAAY,kBAAZ,EAAgClsC,IAAhC;AACD;;AACD,QAAIA,IAAI,CAACgmE,MAAL,KAAgB,KAApB,EAA2B;AACzBzpB,MAAAA,OAAO,GAAG9nC,KAAK,CAAC3G,IAAN,CAAW+4E,YAAY,CAAC91D,MAAM,CAACi8B,UAAR,EAAoB/vC,IAAI,CAAC9H,SAAzB,CAAvB,CAAV;AACD,KAFD,MAEO,IAAInV,IAAI,CAACgmE,MAAL,KAAgB,MAApB,EAA4B;AACjCzpB,MAAAA,OAAO,GAAGxrB,MAAM,CAAChb,GAAP,CAAW2kB,OAAX,CAAmBzd,IAAnB,IAA2B,EAA3B,GAAgC4Z,MAAM,CAAC5Z,IAAI,CAAC8e,SAAL,IAAkB9e,IAAI,CAACP,WAAxB,CAAhD;AACD,KAFM,MAEA,IAAI1c,IAAI,CAACgmE,MAAL,KAAgB,MAApB,EAA4B;AACjCzpB,MAAAA,OAAO,GAAGxrB,MAAM,CAACi8B,UAAP,CAAkBnlB,SAAlB,CAA4B5qB,IAA5B,EAAkCjd,IAAlC,CAAV;AACD,KAFM,MAEA;AACLu8C,MAAAA,OAAO,GAAGuqC,iBAAiB,CAAC/1D,MAAD,EAASA,MAAM,CAACi8B,UAAP,CAAkBnlB,SAAlB,CAA4B5qB,IAA5B,EAAkCjd,IAAlC,CAAT,CAA3B;AACD;;AACD,QAAI,CAACmF,QAAQ,CAAC,CACV,MADU,EAEV,MAFU,CAAD,EAGRnF,IAAI,CAACgmE,MAHG,CAAT,IAGiB,CAAC5vC,mBAAmB,CAACjgB,YAAY,CAACX,OAAb,CAAqByH,IAArB,CAAD,CAHzC,EAGuE;AACrEjd,MAAAA,IAAI,CAACu8C,OAAL,GAAe9nC,KAAK,CAAC3G,IAAN,CAAWyuC,OAAX,CAAf;AACD,KALD,MAKO;AACLv8C,MAAAA,IAAI,CAACu8C,OAAL,GAAeA,OAAf;AACD;;AACD,QAAI,CAACv8C,IAAI,CAACknF,SAAV,EAAqB;AACnBn2D,MAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0BlsC,IAA1B;AACD;;AACD,WAAOA,IAAI,CAACu8C,OAAZ;AACD,GA7BD;;AA8BA,MAAI4qC,kBAAkB,GAAG,UAAUp2D,MAAV,EAAkB/wB,IAAlB,EAAwBgmE,MAAxB,EAAgC;AACvD,WAAOpiE,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAACo6B,OAAP,EAAd,EAAgCppD,IAAhC,CAAqCvB,QAAQ,CAACR,IAAI,CAACgmE,MAAL,KAAgB,MAAhB,GAAyB,IAAI8a,OAAJ,CAAY,MAAZ,EAAoB,EAApB,CAAzB,GAAmD,EAApD,CAA7C,EAAsG,UAAU7jE,IAAV,EAAgB;AAC3H,aAAO+pE,kBAAkB,CAACj2D,MAAD,EAAS/wB,IAAT,EAAegmE,MAAf,EAAuB/oD,IAAvB,CAAzB;AACD,KAFM,CAAP;AAGD,GAJD;;AAMA,MAAImqE,MAAM,GAAG3yE,KAAK,CAAC9R,IAAnB;;AACA,MAAI0kF,YAAY,GAAG,UAAUtxE,GAAV,EAAe;AAChC,QAAIy8B,OAAO,GAAG,UAAU0sB,KAAV,EAAiBC,KAAjB,EAAwB;AACpC,UAAID,KAAK,CAAC1mD,QAAN,KAAmB2mD,KAAK,CAAC3mD,QAA7B,EAAuC;AACrC,eAAO,KAAP;AACD;;AACD,UAAIonC,UAAU,GAAG,UAAUjqC,IAAV,EAAgB;AAC/B,YAAI2xE,OAAO,GAAG,EAAd;AACAF,QAAAA,MAAM,CAACrxE,GAAG,CAAC6pC,UAAJ,CAAejqC,IAAf,CAAD,EAAuB,UAAUgN,IAAV,EAAgB;AAC3C,cAAI9kB,IAAI,GAAG8kB,IAAI,CAACnK,QAAL,CAAcpM,WAAd,EAAX;;AACA,cAAIvO,IAAI,CAACG,OAAL,CAAa,GAAb,MAAsB,CAAtB,IAA2BH,IAAI,KAAK,OAApC,IAA+CA,IAAI,CAACG,OAAL,CAAa,OAAb,MAA0B,CAA7E,EAAgF;AAC9EspF,YAAAA,OAAO,CAACzpF,IAAD,CAAP,GAAgBkY,GAAG,CAAC2pC,SAAJ,CAAc/pC,IAAd,EAAoB9X,IAApB,CAAhB;AACD;AACF,SALK,CAAN;AAMA,eAAOypF,OAAP;AACD,OATD;;AAUA,UAAIC,cAAc,GAAG,UAAUC,IAAV,EAAgBC,IAAhB,EAAsB;AACzC,YAAIhnF,KAAJ,EAAW5C,IAAX;;AACA,aAAKA,IAAL,IAAa2pF,IAAb,EAAmB;AACjB,cAAIA,IAAI,CAACzgF,cAAL,CAAoBlJ,IAApB,CAAJ,EAA+B;AAC7B4C,YAAAA,KAAK,GAAGgnF,IAAI,CAAC5pF,IAAD,CAAZ;;AACA,gBAAI,OAAO4C,KAAP,KAAiB,WAArB,EAAkC;AAChC,qBAAO,KAAP;AACD;;AACD,gBAAI+mF,IAAI,CAAC3pF,IAAD,CAAJ,KAAe4C,KAAnB,EAA0B;AACxB,qBAAO,KAAP;AACD;;AACD,mBAAOgnF,IAAI,CAAC5pF,IAAD,CAAX;AACD;AACF;;AACD,aAAKA,IAAL,IAAa4pF,IAAb,EAAmB;AACjB,cAAIA,IAAI,CAAC1gF,cAAL,CAAoBlJ,IAApB,CAAJ,EAA+B;AAC7B,mBAAO,KAAP;AACD;AACF;;AACD,eAAO,IAAP;AACD,OApBD;;AAqBA,UAAI,CAAC0pF,cAAc,CAAC3nC,UAAU,CAACsf,KAAD,CAAX,EAAoBtf,UAAU,CAACuf,KAAD,CAA9B,CAAnB,EAA2D;AACzD,eAAO,KAAP;AACD;;AACD,UAAI,CAACooB,cAAc,CAACxxE,GAAG,CAACssC,UAAJ,CAAetsC,GAAG,CAAC2pC,SAAJ,CAAcwf,KAAd,EAAqB,OAArB,CAAf,CAAD,EAAgDnpD,GAAG,CAACssC,UAAJ,CAAetsC,GAAG,CAAC2pC,SAAJ,CAAcyf,KAAd,EAAqB,OAArB,CAAf,CAAhD,CAAnB,EAAmH;AACjH,eAAO,KAAP;AACD;;AACD,aAAO,CAACgF,gBAAgB,CAACjF,KAAD,CAAjB,IAA4B,CAACiF,gBAAgB,CAAChF,KAAD,CAApD;AACD,KA1CD;;AA2CA,WAAO;AAAE3sB,MAAAA,OAAO,EAAEA;AAAX,KAAP;AACD,GA7CD;;AA+CA,MAAIk1C,SAAS,GAAGjzE,KAAK,CAAC9B,OAAtB;;AACA,MAAIg1E,MAAM,GAAG,UAAUt2D,QAAV,EAAoB;AAC/B,QAAIvc,IAAI,GAAG,EAAX;AACAuc,IAAAA,QAAQ,GAAGA,QAAQ,IAAI,EAAvB;AACA,QAAIu2D,MAAM,GAAGv2D,QAAQ,CAACu2D,MAAtB;AACA,QAAIC,YAAY,GAAGH,SAAS,CAACr2D,QAAQ,CAACy2D,aAAT,IAA0B,EAA3B,CAA5B;AACA,QAAIC,WAAW,GAAGL,SAAS,CAACr2D,QAAQ,CAAC22D,YAAT,IAAyB,EAA1B,CAA3B;AACA,QAAIjhD,MAAM,GAAG1J,QAAQ,CAACR,aAAT,CAAuBxL,QAAQ,CAAC42D,eAAT,IAA4B,KAAnD,EAA0D52D,QAAQ,CAACuL,QAAnE,CAAb;AACA,QAAIsrD,UAAU,GAAG72D,QAAQ,CAAC82D,cAAT,KAA4B,MAA7C;AACA,WAAO;AACL36E,MAAAA,KAAK,EAAE,UAAU3P,IAAV,EAAgBukB,KAAhB,EAAuB3F,KAAvB,EAA8B;AACnC,YAAIxd,CAAJ,EAAOqJ,CAAP,EAAUqa,IAAV,EAAgBliB,KAAhB;;AACA,YAAImnF,MAAM,IAAIC,YAAY,CAAChqF,IAAD,CAAtB,IAAgCiX,IAAI,CAAC/V,MAAL,GAAc,CAAlD,EAAqD;AACnD0B,UAAAA,KAAK,GAAGqU,IAAI,CAACA,IAAI,CAAC/V,MAAL,GAAc,CAAf,CAAZ;;AACA,cAAI0B,KAAK,CAAC1B,MAAN,GAAe,CAAf,IAAoB0B,KAAK,KAAK,IAAlC,EAAwC;AACtCqU,YAAAA,IAAI,CAAC/P,IAAL,CAAU,IAAV;AACD;AACF;;AACD+P,QAAAA,IAAI,CAAC/P,IAAL,CAAU,GAAV,EAAelH,IAAf;;AACA,YAAIukB,KAAJ,EAAW;AACT,eAAKnjB,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAG8Z,KAAK,CAACrjB,MAAtB,EAA8BE,CAAC,GAAGqJ,CAAlC,EAAqCrJ,CAAC,EAAtC,EAA0C;AACxC0jB,YAAAA,IAAI,GAAGP,KAAK,CAACnjB,CAAD,CAAZ;AACA6V,YAAAA,IAAI,CAAC/P,IAAL,CAAU,GAAV,EAAe4d,IAAI,CAAC9kB,IAApB,EAA0B,IAA1B,EAAgCkpC,MAAM,CAACpkB,IAAI,CAACliB,KAAN,EAAa,IAAb,CAAtC,EAA0D,GAA1D;AACD;AACF;;AACD,YAAI,CAACgc,KAAD,IAAUyrE,UAAd,EAA0B;AACxBpzE,UAAAA,IAAI,CAACA,IAAI,CAAC/V,MAAN,CAAJ,GAAoB,GAApB;AACD,SAFD,MAEO;AACL+V,UAAAA,IAAI,CAACA,IAAI,CAAC/V,MAAN,CAAJ,GAAoB,KAApB;AACD;;AACD,YAAI0d,KAAK,IAAImrE,MAAT,IAAmBG,WAAW,CAAClqF,IAAD,CAA9B,IAAwCiX,IAAI,CAAC/V,MAAL,GAAc,CAA1D,EAA6D;AAC3D0B,UAAAA,KAAK,GAAGqU,IAAI,CAACA,IAAI,CAAC/V,MAAL,GAAc,CAAf,CAAZ;;AACA,cAAI0B,KAAK,CAAC1B,MAAN,GAAe,CAAf,IAAoB0B,KAAK,KAAK,IAAlC,EAAwC;AACtCqU,YAAAA,IAAI,CAAC/P,IAAL,CAAU,IAAV;AACD;AACF;AACF,OA3BI;AA4BLqwD,MAAAA,GAAG,EAAE,UAAUv3D,IAAV,EAAgB;AACnB,YAAI4C,KAAJ;AACAqU,QAAAA,IAAI,CAAC/P,IAAL,CAAU,IAAV,EAAgBlH,IAAhB,EAAsB,GAAtB;;AACA,YAAI+pF,MAAM,IAAIG,WAAW,CAAClqF,IAAD,CAArB,IAA+BiX,IAAI,CAAC/V,MAAL,GAAc,CAAjD,EAAoD;AAClD0B,UAAAA,KAAK,GAAGqU,IAAI,CAACA,IAAI,CAAC/V,MAAL,GAAc,CAAf,CAAZ;;AACA,cAAI0B,KAAK,CAAC1B,MAAN,GAAe,CAAf,IAAoB0B,KAAK,KAAK,IAAlC,EAAwC;AACtCqU,YAAAA,IAAI,CAAC/P,IAAL,CAAU,IAAV;AACD;AACF;AACF,OArCI;AAsCL8Q,MAAAA,IAAI,EAAE,UAAUA,IAAV,EAAgBwN,GAAhB,EAAqB;AACzB,YAAIxN,IAAI,CAAC9W,MAAL,GAAc,CAAlB,EAAqB;AACnB+V,UAAAA,IAAI,CAACA,IAAI,CAAC/V,MAAN,CAAJ,GAAoBskB,GAAG,GAAGxN,IAAH,GAAUkxB,MAAM,CAAClxB,IAAD,CAAvC;AACD;AACF,OA1CI;AA2CLytE,MAAAA,KAAK,EAAE,UAAUztE,IAAV,EAAgB;AACrBf,QAAAA,IAAI,CAAC/P,IAAL,CAAU,WAAV,EAAuB8Q,IAAvB,EAA6B,KAA7B;AACD,OA7CI;AA8CLwtE,MAAAA,OAAO,EAAE,UAAUxtE,IAAV,EAAgB;AACvBf,QAAAA,IAAI,CAAC/P,IAAL,CAAU,MAAV,EAAkB8Q,IAAlB,EAAwB,KAAxB;AACD,OAhDI;AAiDL0tE,MAAAA,EAAE,EAAE,UAAU1lF,IAAV,EAAgBgY,IAAhB,EAAsB;AACxB,YAAIA,IAAJ,EAAU;AACRf,UAAAA,IAAI,CAAC/P,IAAL,CAAU,IAAV,EAAgBlH,IAAhB,EAAsB,GAAtB,EAA2BkpC,MAAM,CAAClxB,IAAD,CAAjC,EAAyC,IAAzC;AACD,SAFD,MAEO;AACLf,UAAAA,IAAI,CAAC/P,IAAL,CAAU,IAAV,EAAgBlH,IAAhB,EAAsB,IAAtB;AACD;;AACD,YAAI+pF,MAAJ,EAAY;AACV9yE,UAAAA,IAAI,CAAC/P,IAAL,CAAU,IAAV;AACD;AACF,OA1DI;AA2DLy+E,MAAAA,OAAO,EAAE,UAAU3tE,IAAV,EAAgB;AACvBf,QAAAA,IAAI,CAAC/P,IAAL,CAAU,WAAV,EAAuB8Q,IAAvB,EAA6B,GAA7B,EAAkC+xE,MAAM,GAAG,IAAH,GAAU,EAAlD;AACD,OA7DI;AA8DLQ,MAAAA,KAAK,EAAE,YAAY;AACjBtzE,QAAAA,IAAI,CAAC/V,MAAL,GAAc,CAAd;AACD,OAhEI;AAiELspF,MAAAA,UAAU,EAAE,YAAY;AACtB,eAAOvzE,IAAI,CAACwZ,IAAL,CAAU,EAAV,EAAcviB,OAAd,CAAsB,KAAtB,EAA6B,EAA7B,CAAP;AACD;AAnEI,KAAP;AAqED,GA7ED;;AA+EA,MAAIu8E,cAAc,GAAG,UAAUj3D,QAAV,EAAoBwM,MAApB,EAA4B;AAC/C,QAAIA,MAAM,KAAK,KAAK,CAApB,EAAuB;AACrBA,MAAAA,MAAM,GAAGkB,MAAM,EAAf;AACD;;AACD,QAAIwpD,MAAM,GAAGZ,MAAM,CAACt2D,QAAD,CAAnB;AACAA,IAAAA,QAAQ,GAAGA,QAAQ,IAAI,EAAvB;AACAA,IAAAA,QAAQ,CAACqrD,QAAT,GAAoB,cAAcrrD,QAAd,GAAyBA,QAAQ,CAACqrD,QAAlC,GAA6C,IAAjE;;AACA,QAAI70C,SAAS,GAAG,UAAUlyB,IAAV,EAAgB;AAC9B,UAAI+mE,QAAQ,GAAGrrD,QAAQ,CAACqrD,QAAxB;AACA,UAAI8L,QAAQ,GAAG;AACb,WAAG,UAAU7yE,IAAV,EAAgB;AACjB4yE,UAAAA,MAAM,CAAC1yE,IAAP,CAAYF,IAAI,CAAClV,KAAjB,EAAwBkV,IAAI,CAAC0N,GAA7B;AACD,SAHY;AAIb,WAAG,UAAU1N,IAAV,EAAgB;AACjB4yE,UAAAA,MAAM,CAAClF,OAAP,CAAe1tE,IAAI,CAAClV,KAApB;AACD,SANY;AAOb,WAAG,UAAUkV,IAAV,EAAgB;AACjB4yE,UAAAA,MAAM,CAAChF,EAAP,CAAU5tE,IAAI,CAAC9X,IAAf,EAAqB8X,IAAI,CAAClV,KAA1B;AACD,SATY;AAUb,YAAI,UAAUkV,IAAV,EAAgB;AAClB4yE,UAAAA,MAAM,CAAC/E,OAAP,CAAe7tE,IAAI,CAAClV,KAApB;AACD,SAZY;AAab,WAAG,UAAUkV,IAAV,EAAgB;AACjB4yE,UAAAA,MAAM,CAACjF,KAAP,CAAa3tE,IAAI,CAAClV,KAAlB;AACD,SAfY;AAgBb,YAAI,UAAUkV,IAAV,EAAgB;AAClB,cAAIA,IAAI,GAAGA,IAAI,CAAC2E,UAAhB,EAA4B;AAC1B,eAAG;AACDlG,cAAAA,IAAI,CAACuB,IAAD,CAAJ;AACD,aAFD,QAESA,IAAI,GAAGA,IAAI,CAAC6e,IAFrB;AAGD;AACF;AAtBY,OAAf;AAwBA+zD,MAAAA,MAAM,CAACH,KAAP;;AACA,UAAIh0E,IAAI,GAAG,UAAUuB,IAAV,EAAgB;AACzB,YAAI8yE,OAAO,GAAGD,QAAQ,CAAC7yE,IAAI,CAAC5R,IAAN,CAAtB;AACA,YAAIlG,IAAJ,EAAU68B,OAAV,EAAmBtY,KAAnB,EAA0B1B,QAA1B,EAAoCE,SAApC,EAA+C8nE,WAA/C,EAA4DzpF,CAA5D,EAA+DqJ,CAA/D,EAAkE27E,WAAlE;;AACA,YAAI,CAACwE,OAAL,EAAc;AACZ5qF,UAAAA,IAAI,GAAG8X,IAAI,CAAC9X,IAAZ;AACA68B,UAAAA,OAAO,GAAG/kB,IAAI,CAACwrE,UAAf;AACA/+D,UAAAA,KAAK,GAAGzM,IAAI,CAAC+M,UAAb;;AACA,cAAIg6D,QAAQ,IAAIt6D,KAAZ,IAAqBA,KAAK,CAACrjB,MAAN,GAAe,CAAxC,EAA2C;AACzC2pF,YAAAA,WAAW,GAAG,EAAd;AACAA,YAAAA,WAAW,CAAChmF,GAAZ,GAAkB,EAAlB;AACAuhF,YAAAA,WAAW,GAAGpmD,MAAM,CAACwF,cAAP,CAAsB1tB,IAAI,CAAC9X,IAA3B,CAAd;;AACA,gBAAIomF,WAAJ,EAAiB;AACf,mBAAKhlF,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAG27E,WAAW,CAAC3lD,eAAZ,CAA4Bv/B,MAA5C,EAAoDE,CAAC,GAAGqJ,CAAxD,EAA2DrJ,CAAC,EAA5D,EAAgE;AAC9DyhB,gBAAAA,QAAQ,GAAGujE,WAAW,CAAC3lD,eAAZ,CAA4Br/B,CAA5B,CAAX;;AACA,oBAAIyhB,QAAQ,IAAI0B,KAAK,CAAC1f,GAAtB,EAA2B;AACzBke,kBAAAA,SAAS,GAAGwB,KAAK,CAAC1f,GAAN,CAAUge,QAAV,CAAZ;AACAgoE,kBAAAA,WAAW,CAAChmF,GAAZ,CAAgBge,QAAhB,IAA4BE,SAA5B;AACA8nE,kBAAAA,WAAW,CAAC3jF,IAAZ,CAAiB;AACflH,oBAAAA,IAAI,EAAE6iB,QADS;AAEfjgB,oBAAAA,KAAK,EAAEmgB;AAFQ,mBAAjB;AAID;AACF;;AACD,mBAAK3hB,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAG8Z,KAAK,CAACrjB,MAAtB,EAA8BE,CAAC,GAAGqJ,CAAlC,EAAqCrJ,CAAC,EAAtC,EAA0C;AACxCyhB,gBAAAA,QAAQ,GAAG0B,KAAK,CAACnjB,CAAD,CAAL,CAASpB,IAApB;;AACA,oBAAI,EAAE6iB,QAAQ,IAAIgoE,WAAW,CAAChmF,GAA1B,CAAJ,EAAoC;AAClCke,kBAAAA,SAAS,GAAGwB,KAAK,CAAC1f,GAAN,CAAUge,QAAV,CAAZ;AACAgoE,kBAAAA,WAAW,CAAChmF,GAAZ,CAAgBge,QAAhB,IAA4BE,SAA5B;AACA8nE,kBAAAA,WAAW,CAAC3jF,IAAZ,CAAiB;AACflH,oBAAAA,IAAI,EAAE6iB,QADS;AAEfjgB,oBAAAA,KAAK,EAAEmgB;AAFQ,mBAAjB;AAID;AACF;;AACDwB,cAAAA,KAAK,GAAGsmE,WAAR;AACD;AACF;;AACDH,UAAAA,MAAM,CAAC/6E,KAAP,CAAamI,IAAI,CAAC9X,IAAlB,EAAwBukB,KAAxB,EAA+BsY,OAA/B;;AACA,cAAI,CAACA,OAAL,EAAc;AACZ,gBAAI/kB,IAAI,GAAGA,IAAI,CAAC2E,UAAhB,EAA4B;AAC1B,iBAAG;AACDlG,gBAAAA,IAAI,CAACuB,IAAD,CAAJ;AACD,eAFD,QAESA,IAAI,GAAGA,IAAI,CAAC6e,IAFrB;AAGD;;AACD+zD,YAAAA,MAAM,CAACnzB,GAAP,CAAWv3D,IAAX;AACD;AACF,SA3CD,MA2CO;AACL4qF,UAAAA,OAAO,CAAC9yE,IAAD,CAAP;AACD;AACF,OAjDD;;AAkDA,UAAIA,IAAI,CAAC5R,IAAL,KAAc,CAAd,IAAmB,CAACstB,QAAQ,CAACs3D,KAAjC,EAAwC;AACtCv0E,QAAAA,IAAI,CAACuB,IAAD,CAAJ;AACD,OAFD,MAEO;AACL6yE,QAAAA,QAAQ,CAAC,EAAD,CAAR,CAAa7yE,IAAb;AACD;;AACD,aAAO4yE,MAAM,CAACF,UAAP,EAAP;AACD,KAnFD;;AAoFA,WAAO;AAAExgD,MAAAA,SAAS,EAAEA;AAAb,KAAP;AACD,GA5FD;;AA8FA,MAAI+gD,MAAM,GAAG,UAAUx0C,OAAV,EAAmB9qC,SAAnB,EAA8Bkb,GAA9B,EAAmC;AAC9C,WAAO5gB,QAAQ,CAACD,IAAT,CAAc6gB,GAAG,CAACnS,SAAJ,EAAd,EAA+BtP,MAA/B,CAAsCqe,QAAtC,EAAgDve,MAAhD,CAAuD,UAAUgT,IAAV,EAAgB;AAC5E,UAAIgzE,KAAK,GAAGz0C,OAAO,GAAG,CAAH,GAAO,CAAC,CAA3B;AACA,aAAO9qC,SAAS,CAACuM,IAAI,CAAC0V,IAAL,CAAUmM,MAAV,CAAiBlT,GAAG,CAACmT,MAAJ,KAAekxD,KAAhC,CAAD,CAAhB;AACD,KAHM,CAAP;AAID,GALD;;AAMA,MAAIC,aAAa,GAAGnoF,KAAK,CAACioF,MAAD,EAAS,IAAT,EAAepkB,cAAf,CAAzB;AACA,MAAIukB,YAAY,GAAGpoF,KAAK,CAACioF,MAAD,EAAS,KAAT,EAAgBpkB,cAAhB,CAAxB;;AACA,MAAIwkB,WAAW,GAAG,UAAUxkE,GAAV,EAAe;AAC/B,QAAInS,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,EAAhB;AACA,WAAO+O,QAAQ,CAAC/O,SAAD,CAAR,KAAwBA,SAAS,CAACkZ,IAAV,CAAexsB,MAAf,KAA0B,CAA1B,IAA+B63B,QAAQ,CAACvkB,SAAS,CAACkZ,IAAX,CAAR,IAA4B4hD,eAAe,CAACnyC,cAAhB,CAA+B3oB,SAAS,CAACgH,UAAzC,CAAnF,CAAP;AACD,GAHD;;AAIA,MAAI4vE,sBAAsB,GAAG,UAAUttE,MAAV,EAAkBrS,SAAlB,EAA6B;AACxD,WAAO,UAAUkb,GAAV,EAAe;AACpB,aAAO5gB,QAAQ,CAACD,IAAT,CAAcg7D,4BAA4B,CAAChjD,MAAM,GAAG,CAAH,GAAO,CAAC,CAAf,EAAkB6I,GAAlB,CAA1C,EAAkEzhB,MAAlE,CAAyEuG,SAAzE,EAAoFpH,MAApF,EAAP;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIgnF,YAAY,GAAG,UAAUvzE,IAAV,EAAgB;AACjC,WAAO8L,KAAK,CAAC9L,IAAD,CAAL,IAAesN,KAAK,CAAC9M,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAD,EAA6B,SAA7B,CAAL,KAAiD,OAAvE;AACD,GAFD;;AAGA,MAAIwzE,SAAS,GAAG,UAAUxzE,IAAV,EAAgB;AAC9B,WAAOgM,sBAAsB,CAAChM,IAAD,CAAtB,IAAgC,CAACoL,UAAU,CAACpL,IAAD,CAAlD;AACD,GAFD;;AAGA,MAAIyzE,kBAAkB,GAAGH,sBAAsB,CAAC,IAAD,EAAOC,YAAP,CAA/C;AACA,MAAIG,iBAAiB,GAAGJ,sBAAsB,CAAC,KAAD,EAAQC,YAAR,CAA9C;AACA,MAAII,aAAa,GAAGL,sBAAsB,CAAC,IAAD,EAAOpnE,OAAP,CAA1C;AACA,MAAI0nE,YAAY,GAAGN,sBAAsB,CAAC,KAAD,EAAQpnE,OAAR,CAAzC;AACA,MAAI2nE,aAAa,GAAGP,sBAAsB,CAAC,IAAD,EAAOjoE,OAAP,CAA1C;AACA,MAAIyoE,YAAY,GAAGR,sBAAsB,CAAC,KAAD,EAAQjoE,OAAR,CAAzC;AACA,MAAI0oE,4BAA4B,GAAGT,sBAAsB,CAAC,IAAD,EAAOE,SAAP,CAAzD;AACA,MAAIQ,2BAA2B,GAAGV,sBAAsB,CAAC,KAAD,EAAQE,SAAR,CAAxD;;AAEA,MAAIS,iBAAiB,GAAG,UAAU9lE,GAAV,EAAe;AACrC,QAAIhK,QAAQ,GAAG,EAAf;AACA,QAAI+vE,OAAO,GAAG/lE,GAAG,CAAC/N,GAAlB;;AACA,WAAO8zE,OAAP,EAAgB;AACd/vE,MAAAA,QAAQ,CAAC/U,IAAT,CAAcoR,YAAY,CAACX,OAAb,CAAqBq0E,OAArB,CAAd;AACAA,MAAAA,OAAO,GAAGA,OAAO,CAACtvE,SAAlB;AACD;;AACD,WAAOT,QAAP;AACD,GARD;;AASA,MAAIgwE,gBAAgB,GAAG,UAAUhmE,GAAV,EAAe;AACpC,QAAIimE,MAAM,GAAGr/B,aAAa,CAAC5mC,GAAD,EAAM,IAAN,CAA1B;AACA,QAAIuU,GAAG,GAAGt1B,MAAM,CAAC6mF,iBAAiB,CAAC9lE,GAAD,CAAjB,CAAuBzlB,KAAvB,CAA6B,CAAC,CAA9B,CAAD,EAAmCy3B,MAAnC,CAAhB;;AACA,QAAIi0D,MAAM,CAAChrF,MAAP,KAAkBs5B,GAAG,CAACt5B,MAA1B,EAAkC;AAChC4D,MAAAA,IAAI,CAAC01B,GAAD,EAAMzb,MAAN,CAAJ;AACD;AACF,GAND;;AAOA,MAAIotE,iBAAiB,GAAG,UAAUlmE,GAAV,EAAe;AACrCrH,IAAAA,KAAK,CAACqH,GAAD,CAAL;AACA7H,IAAAA,MAAM,CAAC6H,GAAD,EAAM3N,YAAY,CAACtB,QAAb,CAAsB,yBAAtB,CAAN,CAAN;AACD,GAHD;;AAIA,MAAIo1E,mBAAmB,GAAG,UAAUnmE,GAAV,EAAe;AACvCvJ,IAAAA,SAAS,CAACuJ,GAAD,CAAT,CAAenhB,IAAf,CAAoB,UAAU4X,SAAV,EAAqB;AACvCR,MAAAA,WAAW,CAACQ,SAAD,CAAX,CAAuB5X,IAAvB,CAA4B,UAAUunF,oBAAV,EAAgC;AAC1D,YAAIv0D,OAAO,CAAC7R,GAAD,CAAP,IAAgBgS,MAAM,CAACvb,SAAD,CAAtB,IAAqCob,OAAO,CAACu0D,oBAAD,CAAhD,EAAwE;AACtEttE,UAAAA,MAAM,CAACrC,SAAD,CAAN;AACD;AACF,OAJD;AAKD,KAND;AAOD,GARD;;AAUA,MAAI4vE,QAAQ,GAAG,UAAUjsF,EAAV,EAAc;AAC3B,WAAOA,EAAE,CAACG,KAAH,CAAS,CAAT,EAAY,CAAC,CAAb,CAAP;AACD,GAFD;;AAGA,MAAI+rF,cAAc,GAAG,UAAU58E,KAAV,EAAiB0F,IAAjB,EAAuB5J,SAAvB,EAAkC;AACrD,QAAI+O,UAAU,CAACnF,IAAD,EAAO1F,KAAP,CAAd,EAA6B;AAC3B,aAAO28E,QAAQ,CAAC7wE,OAAO,CAAC9L,KAAD,EAAQ,UAAUsW,GAAV,EAAe;AAC5C,eAAOxa,SAAS,CAACwa,GAAD,CAAT,IAAkBhM,IAAI,CAACgM,GAAD,EAAM5Q,IAAN,CAA7B;AACD,OAFsB,CAAR,CAAf;AAGD,KAJD,MAIO;AACL,aAAO,EAAP;AACD;AACF,GARD;;AASA,MAAIm3E,SAAS,GAAG,UAAU78E,KAAV,EAAiB0F,IAAjB,EAAuB;AACrC,WAAOk3E,cAAc,CAAC58E,KAAD,EAAQ0F,IAAR,EAAc7R,KAAd,CAArB;AACD,GAFD;;AAGA,MAAIipF,cAAc,GAAG,UAAU98E,KAAV,EAAiB0F,IAAjB,EAAuB;AAC1C,WAAO,CAAC1F,KAAD,EAAQxM,MAAR,CAAeqpF,SAAS,CAAC78E,KAAD,EAAQ0F,IAAR,CAAxB,CAAP;AACD,GAFD;;AAIA,MAAIq3E,4BAA4B,GAAG,UAAUn2C,OAAV,EAAmBlhC,IAAnB,EAAyBvP,IAAzB,EAA+B;AAChE,WAAOq+D,cAAc,CAAC5tB,OAAD,EAAUlhC,IAAV,EAAgBvP,IAAhB,EAAsBqlF,WAAtB,CAArB;AACD,GAFD;;AAGA,MAAIwB,eAAe,GAAG,UAAUt3E,IAAV,EAAgBsR,GAAhB,EAAqB;AACzC,WAAOze,IAAI,CAACukF,cAAc,CAACn0E,YAAY,CAACX,OAAb,CAAqBgP,GAAG,CAACnS,SAAJ,EAArB,CAAD,EAAwCa,IAAxC,CAAf,EAA8DyiB,OAA9D,CAAX;AACD,GAFD;;AAGA,MAAI80D,4BAA4B,GAAG,UAAUr2C,OAAV,EAAmBlhC,IAAnB,EAAyBsR,GAAzB,EAA8B;AAC/D,WAAO+lE,4BAA4B,CAACn2C,OAAD,EAAUlhC,IAAI,CAAC6C,GAAf,EAAoByO,GAApB,CAA5B,CAAqD1hB,MAArD,CAA4D,UAAU4nF,MAAV,EAAkB;AACnF,aAAOF,eAAe,CAACt3E,IAAD,EAAOsR,GAAP,CAAf,CAA2BziB,IAA3B,CAAgC,YAAY;AACjD,eAAOy8D,aAAa,CAACksB,MAAD,EAASlmE,GAAT,EAActR,IAAI,CAAC6C,GAAnB,CAAb,KAAyC,KAAhD;AACD,OAFM,EAEJ,UAAU40E,SAAV,EAAqB;AACtB,eAAOnsB,aAAa,CAACksB,MAAD,EAASlmE,GAAT,EAActR,IAAI,CAAC6C,GAAnB,CAAb,KAAyC,KAAzC,IAAkDsC,UAAU,CAACsyE,SAAD,EAAYx0E,YAAY,CAACX,OAAb,CAAqBk1E,MAAM,CAACr4E,SAAP,EAArB,CAAZ,CAAnE;AACD,OAJM,CAAP;AAKD,KANM,CAAP;AAOD,GARD;;AASA,MAAIu4E,mBAAmB,GAAG,UAAUx2C,OAAV,EAAmBlhC,IAAnB,EAAyBsR,GAAzB,EAA8B;AACtD,WAAOgmE,eAAe,CAACt3E,IAAD,EAAOsR,GAAP,CAAf,CAA2BziB,IAA3B,CAAgC,YAAY;AACjD,aAAOwoF,4BAA4B,CAACn2C,OAAD,EAAUlhC,IAAI,CAAC6C,GAAf,EAAoByO,GAApB,CAA5B,CAAqD1hB,MAArD,CAA4D,UAAU4nF,MAAV,EAAkB;AACnF,eAAOlsB,aAAa,CAACksB,MAAD,EAASlmE,GAAT,EAActR,IAAI,CAAC6C,GAAnB,CAAb,KAAyC,KAAhD;AACD,OAFM,CAAP;AAGD,KAJM,EAIJ,UAAUhC,MAAV,EAAkB;AACnB,aAAOw2E,4BAA4B,CAACn2C,OAAD,EAAUrgC,MAAM,CAACgC,GAAjB,EAAsByO,GAAtB,CAA5B,CAAuD9iB,MAAvD,EAAP;AACD,KANM,CAAP;AAOD,GARD;;AASA,MAAImpF,gBAAgB,GAAGlqF,KAAK,CAACiqF,mBAAD,EAAsB,KAAtB,CAA5B;AACA,MAAIE,cAAc,GAAGnqF,KAAK,CAACiqF,mBAAD,EAAsB,IAAtB,CAA1B;AACA,MAAIG,aAAa,GAAGpqF,KAAK,CAAC8pF,4BAAD,EAA+B,KAA/B,CAAzB;AACA,MAAIO,YAAY,GAAGrqF,KAAK,CAAC8pF,4BAAD,EAA+B,IAA/B,CAAxB;;AAEA,MAAIQ,MAAM,GAAG,UAAUzmE,GAAV,EAAe;AAC1B,WAAOq7C,sBAAsB,CAACr7C,GAAD,CAAtB,CAA4B3hB,MAA5B,CAAmCizB,MAAnC,CAAP;AACD,GAFD;;AAGA,MAAIo1D,MAAM,GAAG,UAAU92C,OAAV,EAAmBlhC,IAAnB,EAAyBsR,GAAzB,EAA8B;AACzC,QAAI2mE,YAAY,GAAGpoF,MAAM,CAACunF,cAAc,CAACn0E,YAAY,CAACX,OAAb,CAAqBgP,GAAG,CAACnS,SAAJ,EAArB,CAAD,EAAwCa,IAAxC,CAAf,EAA8DyiB,OAA9D,CAAzB;AACA,QAAI5gB,KAAK,GAAGpO,IAAI,CAACwkF,YAAD,CAAJ,CAAmBhpF,KAAnB,CAAyB+Q,IAAzB,CAAZ;AACA,WAAOsuD,YAAY,CAACptB,OAAD,EAAUr/B,KAAK,CAACgB,GAAhB,EAAqByO,GAArB,CAAZ,CAAsCzhB,MAAtC,CAA6CkoF,MAA7C,CAAP;AACD,GAJD;;AAKA,MAAIG,UAAU,GAAG,UAAUl4E,IAAV,EAAgBsR,GAAhB,EAAqB;AACpC,WAAOq7C,sBAAsB,CAACr7C,GAAD,CAAtB,CAA4B3hB,MAA5B,CAAmCizB,MAAnC,KAA8Co1D,MAAM,CAAC,IAAD,EAAOh4E,IAAP,EAAasR,GAAb,CAAN,CAAwBtiB,MAAxB,EAArD;AACD,GAFD;;AAGA,MAAImpF,SAAS,GAAG,UAAUn4E,IAAV,EAAgBsR,GAAhB,EAAqB;AACnC,WAAOs7C,0BAA0B,CAACt7C,GAAD,CAA1B,CAAgC3hB,MAAhC,CAAuCizB,MAAvC,KAAkDo1D,MAAM,CAAC,KAAD,EAAQh4E,IAAR,EAAcsR,GAAd,CAAN,CAAyBtiB,MAAzB,EAAzD;AACD,GAFD;;AAGA,MAAIopF,cAAc,GAAG3qF,KAAK,CAACuqF,MAAD,EAAS,KAAT,CAA1B;AACA,MAAIK,UAAU,GAAG5qF,KAAK,CAACuqF,MAAD,EAAS,IAAT,CAAtB;;AAEA,MAAIM,gBAAgB,GAAG,UAAUhnE,GAAV,EAAe;AACpC,WAAOouC,aAAa,CAACO,cAAd,CAA6B3uC,GAA7B,KAAqC,CAACA,GAAG,CAACoT,SAAJ,EAAtC,IAAyD,CAACpT,GAAG,CAACsT,OAAJ,EAAjE;AACD,GAFD;;AAGA,MAAI2zD,iBAAiB,GAAG,UAAUv4E,IAAV,EAAgBsR,GAAhB,EAAqB;AAC3C,QAAI2mE,YAAY,GAAGpoF,MAAM,CAACunF,cAAc,CAACn0E,YAAY,CAACX,OAAb,CAAqBgP,GAAG,CAACnS,SAAJ,EAArB,CAAD,EAAwCa,IAAxC,CAAf,EAA8DyiB,OAA9D,CAAzB;AACA,WAAOhvB,IAAI,CAACwkF,YAAD,CAAJ,CAAmBhpF,KAAnB,CAAyB+Q,IAAzB,CAAP;AACD,GAHD;;AAIA,MAAIw4E,cAAc,GAAG,UAAUx4E,IAAV,EAAgBsR,GAAhB,EAAqB;AACxC,QAAIgnE,gBAAgB,CAAChnE,GAAD,CAApB,EAA2B;AACzB,aAAOukE,YAAY,CAACvkE,GAAD,CAAnB;AACD,KAFD,MAEO;AACL,aAAOukE,YAAY,CAACvkE,GAAD,CAAZ,IAAqB49C,YAAY,CAACqpB,iBAAiB,CAACv4E,IAAD,EAAOsR,GAAP,CAAjB,CAA6BzO,GAA9B,EAAmCyO,GAAnC,CAAZ,CAAoD3hB,MAApD,CAA2DkmF,YAA3D,CAA5B;AACD;AACF,GAND;;AAOA,MAAI4C,aAAa,GAAG,UAAUz4E,IAAV,EAAgBsR,GAAhB,EAAqB;AACvC,QAAIgnE,gBAAgB,CAAChnE,GAAD,CAApB,EAA2B;AACzB,aAAOskE,aAAa,CAACtkE,GAAD,CAApB;AACD,KAFD,MAEO;AACL,aAAOskE,aAAa,CAACtkE,GAAD,CAAb,IAAsB29C,YAAY,CAACspB,iBAAiB,CAACv4E,IAAD,EAAOsR,GAAP,CAAjB,CAA6BzO,GAA9B,EAAmCyO,GAAnC,CAAZ,CAAoD3hB,MAApD,CAA2DimF,aAA3D,CAA7B;AACD;AACF,GAND;;AAOA,MAAI8C,UAAU,GAAG,UAAUnrF,KAAV,EAAiB;AAChC,WAAO0E,QAAQ,CAAC,CACd,KADc,EAEd,UAFc,CAAD,EAGZ1E,KAHY,CAAf;AAID,GALD;;AAMA,MAAIorF,OAAO,GAAG,UAAUrnE,GAAV,EAAe;AAC3B,WAAOq7C,sBAAsB,CAACr7C,GAAD,CAAtB,CAA4B5hB,IAA5B,CAAiC,UAAUkhB,GAAV,EAAe;AACrD,aAAOyL,OAAO,CAACzL,GAAD,EAAMnL,SAAN,CAAd;AACD,KAFM,EAEJ9V,MAFI,CAEG,UAAUihB,GAAV,EAAe;AACvB,aAAO8nE,UAAU,CAAC3oE,KAAK,CAACa,GAAD,EAAM,aAAN,CAAN,CAAjB;AACD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAIgoE,mBAAmB,GAAG,UAAU54E,IAAV,EAAgBsR,GAAhB,EAAqB;AAC7C,WAAO49C,YAAY,CAAClvD,IAAI,CAAC6C,GAAN,EAAWyO,GAAX,CAAZ,CAA4B9iB,MAA5B,EAAP;AACD,GAFD;;AAGA,MAAIqqF,aAAa,GAAG,UAAU74E,IAAV,EAAgBsR,GAAhB,EAAqB;AACvC,WAAO29C,YAAY,CAACjvD,IAAI,CAAC6C,GAAN,EAAWyO,GAAX,CAAZ,CAA4B9iB,MAA5B,EAAP;AACD,GAFD;;AAGA,MAAIsqF,gBAAgB,GAAG,UAAU94E,IAAV,EAAgBsR,GAAhB,EAAqB;AAC1C,WAAOsnE,mBAAmB,CAAC54E,IAAD,EAAOsR,GAAP,CAAnB,IAAkCunE,aAAa,CAAC74E,IAAD,EAAOsR,GAAP,CAA/C,IAA8DqmE,gBAAgB,CAAC33E,IAAD,EAAOsR,GAAP,CAA9E,IAA6FsmE,cAAc,CAAC53E,IAAD,EAAOsR,GAAP,CAA3G,IAA0H6mE,SAAS,CAACn4E,IAAD,EAAOsR,GAAP,CAAnI,IAAkJ4mE,UAAU,CAACl4E,IAAD,EAAOsR,GAAP,CAAnK;AACD,GAFD;;AAGA,MAAIynE,eAAe,GAAG,UAAU/4E,IAAV,EAAgBsR,GAAhB,EAAqB;AACzC,QAAIqnE,OAAO,CAACrnE,GAAD,CAAX,EAAkB;AAChB,aAAO,KAAP;AACD,KAFD,MAEO;AACL,aAAOwnE,gBAAgB,CAAC94E,IAAD,EAAOsR,GAAP,CAAhB,IAA+BknE,cAAc,CAACx4E,IAAD,EAAOsR,GAAP,CAA7C,IAA4DmnE,aAAa,CAACz4E,IAAD,EAAOsR,GAAP,CAAhF;AACD;AACF,GAND;;AAOA,MAAI0nE,iBAAiB,GAAG,UAAUh5E,IAAV,EAAgBsR,GAAhB,EAAqB;AAC3C,QAAIqnE,OAAO,CAACrnE,GAAD,CAAX,EAAkB;AAChB,aAAO,KAAP;AACD,KAFD,MAEO;AACL,aAAOqmE,gBAAgB,CAAC33E,IAAD,EAAOsR,GAAP,CAAhB,IAA+BumE,aAAa,CAAC73E,IAAD,EAAOsR,GAAP,CAA5C,IAA2D6mE,SAAS,CAACn4E,IAAD,EAAOsR,GAAP,CAApE,IAAmFknE,cAAc,CAACx4E,IAAD,EAAOsR,GAAP,CAAxG;AACD;AACF,GAND;;AAOA,MAAIi7C,SAAS,GAAG,UAAUj7C,GAAV,EAAe;AAC7B,QAAInS,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,EAAhB;AACA,QAAIslB,MAAM,GAAGnT,GAAG,CAACmT,MAAJ,EAAb;;AACA,QAAIvW,QAAQ,CAAC/O,SAAD,CAAR,IAAuBslB,MAAM,GAAGtlB,SAAS,CAACkZ,IAAV,CAAexsB,MAAnD,EAA2D;AACzD,aAAO6zD,aAAa,CAACvgD,SAAD,EAAYslB,MAAM,GAAG,CAArB,CAApB;AACD,KAFD,MAEO;AACL,aAAOnT,GAAP;AACD;AACF,GARD;;AASA,MAAI2nE,kBAAkB,GAAG,UAAUj5E,IAAV,EAAgBsR,GAAhB,EAAqB;AAC5C,QAAIqnE,OAAO,CAACrnE,GAAD,CAAX,EAAkB;AAChB,aAAO,KAAP;AACD,KAFD,MAEO;AACL,aAAOsmE,cAAc,CAAC53E,IAAD,EAAOsR,GAAP,CAAd,IAA6BwmE,YAAY,CAAC93E,IAAD,EAAOsR,GAAP,CAAzC,IAAwD4mE,UAAU,CAACl4E,IAAD,EAAOsR,GAAP,CAAlE,IAAiFmnE,aAAa,CAACz4E,IAAD,EAAOsR,GAAP,CAArG;AACD;AACF,GAND;;AAOA,MAAI4nE,aAAa,GAAG,UAAUl5E,IAAV,EAAgBsR,GAAhB,EAAqB;AACvC,WAAO0nE,iBAAiB,CAACh5E,IAAD,EAAOsR,GAAP,CAAjB,IAAgC2nE,kBAAkB,CAACj5E,IAAD,EAAOusD,SAAS,CAACj7C,GAAD,CAAhB,CAAzD;AACD,GAFD;;AAGA,MAAI6nE,QAAQ,GAAG,UAAUx2E,IAAV,EAAgB8hB,MAAhB,EAAwB;AACrC,WAAO4sC,MAAM,CAAC1uD,IAAI,CAAC6hB,MAAL,CAAYC,MAAZ,CAAD,CAAb;AACD,GAFD;;AAGA,MAAI20D,OAAO,GAAG,UAAU9nE,GAAV,EAAe;AAC3B,QAAInS,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,EAAhB;AACA,WAAO+O,QAAQ,CAAC/O,SAAD,CAAR,IAAuBzE,UAAU,CAACyE,SAAS,CAACkZ,IAAX,EAAiBgL,IAAjB,CAAxC;AACD,GAHD;;AAIA,MAAIg2D,mBAAmB,GAAG,UAAU12E,IAAV,EAAgB;AACxC,QAAI22E,KAAK,GAAG32E,IAAI,CAAC/C,KAAL,CAAW,EAAX,CAAZ;AACA,WAAOpQ,GAAG,CAAC8pF,KAAD,EAAQ,UAAUtwD,GAAV,EAAej9B,CAAf,EAAkB;AAClC,UAAIslE,MAAM,CAACroC,GAAD,CAAN,IAAej9B,CAAC,GAAG,CAAnB,IAAwBA,CAAC,GAAGutF,KAAK,CAACztF,MAAN,GAAe,CAA3C,IAAgD0lE,WAAW,CAAC+nB,KAAK,CAACvtF,CAAC,GAAG,CAAL,CAAN,CAA3D,IAA6EwlE,WAAW,CAAC+nB,KAAK,CAACvtF,CAAC,GAAG,CAAL,CAAN,CAA5F,EAA4G;AAC1G,eAAO,GAAP;AACD,OAFD,MAEO;AACL,eAAOi9B,GAAP;AACD;AACF,KANS,CAAH,CAMJ5N,IANI,CAMC,EAND,CAAP;AAOD,GATD;;AAUA,MAAIm+D,oBAAoB,GAAG,UAAUv5E,IAAV,EAAgByC,IAAhB,EAAsB;AAC/C,QAAIE,IAAI,GAAGF,IAAI,CAAC4V,IAAhB;AACA,QAAImhE,QAAQ,GAAG95B,aAAa,CAACj9C,IAAD,EAAO,CAAP,CAA5B;;AACA,QAAI02E,QAAQ,CAACx2E,IAAD,EAAO,CAAP,CAAR,IAAqB,CAACu2E,aAAa,CAACl5E,IAAD,EAAOw5E,QAAP,CAAvC,EAAyD;AACvD/2E,MAAAA,IAAI,CAAC4V,IAAL,GAAY,MAAM1V,IAAI,CAACxX,KAAL,CAAW,CAAX,CAAlB;AACA,aAAO,IAAP;AACD,KAHD,MAGO;AACL,aAAO,KAAP;AACD;AACF,GATD;;AAUA,MAAIsuF,+BAA+B,GAAG,UAAUh3E,IAAV,EAAgB;AACpD,QAAIE,IAAI,GAAGF,IAAI,CAAC4V,IAAhB;AACA,QAAIqhE,OAAO,GAAGL,mBAAmB,CAAC12E,IAAD,CAAjC;;AACA,QAAI+2E,OAAO,KAAK/2E,IAAhB,EAAsB;AACpBF,MAAAA,IAAI,CAAC4V,IAAL,GAAYqhE,OAAZ;AACA,aAAO,IAAP;AACD,KAHD,MAGO;AACL,aAAO,KAAP;AACD;AACF,GATD;;AAUA,MAAIC,kBAAkB,GAAG,UAAU35E,IAAV,EAAgByC,IAAhB,EAAsB;AAC7C,QAAIE,IAAI,GAAGF,IAAI,CAAC4V,IAAhB;AACA,QAAIuhE,OAAO,GAAGl6B,aAAa,CAACj9C,IAAD,EAAOE,IAAI,CAAC9W,MAAL,GAAc,CAArB,CAA3B;;AACA,QAAIstF,QAAQ,CAACx2E,IAAD,EAAOA,IAAI,CAAC9W,MAAL,GAAc,CAArB,CAAR,IAAmC,CAACqtF,aAAa,CAACl5E,IAAD,EAAO45E,OAAP,CAArD,EAAsE;AACpEn3E,MAAAA,IAAI,CAAC4V,IAAL,GAAY1V,IAAI,CAACxX,KAAL,CAAW,CAAX,EAAc,CAAC,CAAf,IAAoB,GAAhC;AACA,aAAO,IAAP;AACD,KAHD,MAGO;AACL,aAAO,KAAP;AACD;AACF,GATD;;AAUA,MAAI0uF,cAAc,GAAG,UAAU75E,IAAV,EAAgBsR,GAAhB,EAAqB;AACxC,WAAO5gB,QAAQ,CAACR,IAAT,CAAcohB,GAAd,EAAmBzhB,MAAnB,CAA0BupF,OAA1B,EAAmC1pF,IAAnC,CAAwC,UAAU4hB,GAAV,EAAe;AAC5D,UAAInS,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,EAAhB;AACA,UAAIusC,UAAU,GAAG6tC,oBAAoB,CAACv5E,IAAD,EAAOb,SAAP,CAApB,IAAyCs6E,+BAA+B,CAACt6E,SAAD,CAAxE,IAAuFw6E,kBAAkB,CAAC35E,IAAD,EAAOb,SAAP,CAA1H;AACA,aAAOusC,UAAU,GAAGh7C,QAAQ,CAACR,IAAT,CAAcohB,GAAd,CAAH,GAAwB5gB,QAAQ,CAACrC,IAAT,EAAzC;AACD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAIyrF,sBAAsB,GAAG,UAAUj8D,MAAV,EAAkB;AAC7C,QAAI7d,IAAI,GAAGiD,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAX;;AACA,QAAIp6B,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,EAAJ,EAAoC;AAClC43B,MAAAA,cAAc,CAAC75E,IAAD,EAAO0/C,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAP,CAAd,CAA8EvoD,IAA9E,CAAmF,UAAU6hB,GAAV,EAAe;AAChGuM,QAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwB1/C,GAAG,CAACquC,OAAJ,EAAxB;AACD,OAFD;AAGD;AACF,GAPD;;AASA,MAAIo6B,gBAAgB,GAAG,UAAU1wC,OAAV,EAAmB2wC,gBAAnB,EAAqCC,cAArC,EAAqD;AAC1E,QAAI/9D,MAAM,GAAGxpB,KAAK,CAAC22C,OAAD,EAAU,UAAU52C,GAAV,EAAe0N,CAAf,EAAkB;AAC5C,UAAImxD,cAAc,CAACnxD,CAAD,CAAd,IAAqBkxD,MAAM,CAAClxD,CAAD,CAA/B,EAAoC;AAClC,YAAI1N,GAAG,CAACynF,mBAAJ,IAA2BznF,GAAG,CAACwH,GAAJ,KAAY,EAAZ,IAAkB+/E,gBAA7C,IAAiEvnF,GAAG,CAACwH,GAAJ,CAAQpO,MAAR,KAAmBw9C,OAAO,CAACx9C,MAAR,GAAiB,CAApC,IAAyCouF,cAA9G,EAA8H;AAC5H,iBAAO;AACLC,YAAAA,mBAAmB,EAAE,KADhB;AAELjgF,YAAAA,GAAG,EAAExH,GAAG,CAACwH,GAAJ,GAAUopB;AAFV,WAAP;AAID,SALD,MAKO;AACL,iBAAO;AACL62D,YAAAA,mBAAmB,EAAE,IADhB;AAELjgF,YAAAA,GAAG,EAAExH,GAAG,CAACwH,GAAJ,GAAU;AAFV,WAAP;AAID;AACF,OAZD,MAYO;AACL,eAAO;AACLigF,UAAAA,mBAAmB,EAAE,KADhB;AAELjgF,UAAAA,GAAG,EAAExH,GAAG,CAACwH,GAAJ,GAAUkG;AAFV,SAAP;AAID;AACF,KAnBiB,EAmBf;AACD+5E,MAAAA,mBAAmB,EAAE,KADpB;AAEDjgF,MAAAA,GAAG,EAAE;AAFJ,KAnBe,CAAlB;AAuBA,WAAOiiB,MAAM,CAACjiB,GAAd;AACD,GAzBD;;AA0BA,MAAIipE,WAAW,GAAG,UAAUzgE,IAAV,EAAgBgiB,MAAhB,EAAwB/K,KAAxB,EAA+B;AAC/C,QAAIA,KAAK,KAAK,CAAd,EAAiB;AACf;AACD;;AACD,QAAI9I,GAAG,GAAG3N,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAV;AACA,QAAIzC,IAAI,GAAGoc,QAAQ,CAACxL,GAAD,EAAM6R,OAAN,CAAR,CAAuBxzB,KAAvB,CAA6B2hB,GAA7B,CAAX;AACA,QAAIwqB,UAAU,GAAG34B,IAAI,CAAC4V,IAAL,CAAUltB,KAAV,CAAgBs5B,MAAhB,EAAwBA,MAAM,GAAG/K,KAAjC,CAAjB;AACA,QAAIugE,cAAc,GAAGx1D,MAAM,GAAG/K,KAAT,IAAkBjX,IAAI,CAAC4V,IAAL,CAAUxsB,MAA5B,IAAsCotF,kBAAkB,CAACj5E,IAAD,EAAO0/C,aAAa,CAACj9C,IAAD,EAAOA,IAAI,CAAC4V,IAAL,CAAUxsB,MAAjB,CAApB,CAA7E;AACA,QAAImuF,gBAAgB,GAAGv1D,MAAM,KAAK,CAAX,IAAgBu0D,iBAAiB,CAACh5E,IAAD,EAAO0/C,aAAa,CAACj9C,IAAD,EAAO,CAAP,CAApB,CAAxD;AACAA,IAAAA,IAAI,CAAC03E,WAAL,CAAiB11D,MAAjB,EAAyB/K,KAAzB,EAAgCqgE,gBAAgB,CAAC3+C,UAAD,EAAa4+C,gBAAb,EAA+BC,cAA/B,CAAhD;AACD,GAVD;;AAWA,MAAIG,wBAAwB,GAAG,UAAU33E,IAAV,EAAgBgiB,MAAhB,EAAwB;AACrD,QAAI4kB,OAAO,GAAG5mC,IAAI,CAAC4V,IAAL,CAAUltB,KAAV,CAAgBs5B,MAAhB,CAAd;AACA,QAAI41D,eAAe,GAAGhxC,OAAO,CAACx9C,MAAR,GAAiBgP,KAAK,CAACwuC,OAAD,CAAL,CAAex9C,MAAtD;AACA,WAAOq3E,WAAW,CAACzgE,IAAD,EAAOgiB,MAAP,EAAe41D,eAAf,CAAlB;AACD,GAJD;;AAKA,MAAIC,yBAAyB,GAAG,UAAU73E,IAAV,EAAgBgiB,MAAhB,EAAwB;AACtD,QAAI4kB,OAAO,GAAG5mC,IAAI,CAAC4V,IAAL,CAAUltB,KAAV,CAAgB,CAAhB,EAAmBs5B,MAAnB,CAAd;AACA,QAAI41D,eAAe,GAAGhxC,OAAO,CAACx9C,MAAR,GAAiBiP,KAAK,CAACuuC,OAAD,CAAL,CAAex9C,MAAtD;AACA,WAAOq3E,WAAW,CAACzgE,IAAD,EAAOgiB,MAAM,GAAG41D,eAAhB,EAAiCA,eAAjC,CAAlB;AACD,GAJD;;AAKA,MAAIE,cAAc,GAAG,UAAUC,QAAV,EAAoB5sB,QAApB,EAA8B6sB,mBAA9B,EAAmDC,WAAnD,EAAgE;AACnF,QAAIA,WAAW,KAAK,KAAK,CAAzB,EAA4B;AAC1BA,MAAAA,WAAW,GAAG,IAAd;AACD;;AACD,QAAIC,gBAAgB,GAAG7/E,KAAK,CAAC0/E,QAAQ,CAACniE,IAAV,CAAL,CAAqBxsB,MAA5C;AACA,QAAI+uF,OAAO,GAAGF,WAAW,GAAGF,QAAH,GAAc5sB,QAAvC;AACA,QAAI3F,UAAU,GAAGyyB,WAAW,GAAG9sB,QAAH,GAAc4sB,QAA1C;;AACA,QAAIE,WAAJ,EAAiB;AACfE,MAAAA,OAAO,CAACtqB,UAAR,CAAmBrI,UAAU,CAAC5vC,IAA9B;AACD,KAFD,MAEO;AACLuiE,MAAAA,OAAO,CAACC,UAAR,CAAmB,CAAnB,EAAsB5yB,UAAU,CAAC5vC,IAAjC;AACD;;AACD3O,IAAAA,MAAM,CAACzG,YAAY,CAACX,OAAb,CAAqB2lD,UAArB,CAAD,CAAN;;AACA,QAAIwyB,mBAAJ,EAAyB;AACvBL,MAAAA,wBAAwB,CAACQ,OAAD,EAAUD,gBAAV,CAAxB;AACD;;AACD,WAAOC,OAAP;AACD,GAjBD;;AAmBA,MAAIE,eAAe,GAAG,UAAUxpE,GAAV,EAAeV,GAAf,EAAoB;AACxC,QAAIzR,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,EAAhB;AACA,QAAIslB,MAAM,GAAGnT,GAAG,CAACmT,MAAJ,EAAb;AACA,WAAOi7B,aAAa,CAACO,cAAd,CAA6B3uC,GAA7B,MAAsC,KAAtC,IAA+CnS,SAAS,KAAKyR,GAAG,CAACzK,UAAjE,IAA+Ese,MAAM,GAAGi7B,aAAa,CAACj3C,MAAd,CAAqBmI,GAArB,EAA0B6T,MAA1B,EAA/F;AACD,GAJD;;AAKA,MAAI2lC,UAAU,GAAG,UAAUx5C,GAAV,EAAeU,GAAf,EAAoB;AACnC,WAAOwpE,eAAe,CAACxpE,GAAD,EAAMV,GAAN,CAAf,GAA4B8uC,aAAa,CAACpuC,GAAG,CAACnS,SAAJ,EAAD,EAAkBmS,GAAG,CAACmT,MAAJ,KAAe,CAAjC,CAAzC,GAA+EnT,GAAtF;AACD,GAFD;;AAGA,MAAIypE,eAAe,GAAG,UAAUt4E,IAAV,EAAgB;AACpC,WAAOyL,QAAQ,CAACzL,IAAD,CAAR,GAAiBi9C,aAAa,CAACj9C,IAAD,EAAO,CAAP,CAA9B,GAA0Ci9C,aAAa,CAACj3C,MAAd,CAAqBhG,IAArB,CAAjD;AACD,GAFD;;AAGA,MAAIu4E,YAAY,GAAG,UAAUv4E,IAAV,EAAgB;AACjC,WAAOyL,QAAQ,CAACzL,IAAD,CAAR,GAAiBi9C,aAAa,CAACj9C,IAAD,EAAOA,IAAI,CAAC4V,IAAL,CAAUxsB,MAAjB,CAA9B,GAAyD6zD,aAAa,CAAC72C,KAAd,CAAoBpG,IAApB,CAAhE;AACD,GAFD;;AAGA,MAAIw4E,+BAA+B,GAAG,UAAUrqE,GAAV,EAAe;AACnD,QAAIsV,gBAAgB,CAACtV,GAAG,CAAC9J,eAAL,CAApB,EAA2C;AACzC,aAAOpW,QAAQ,CAACR,IAAT,CAAc8qF,YAAY,CAACpqE,GAAG,CAAC9J,eAAL,CAA1B,CAAP;AACD,KAFD,MAEO;AACL,aAAO8J,GAAG,CAAC9J,eAAJ,GAAsBsoD,cAAc,CAACx+C,GAAG,CAAC9J,eAAL,CAApC,GAA4DpW,QAAQ,CAACrC,IAAT,EAAnE;AACD;AACF,GAND;;AAOA,MAAI6sF,2BAA2B,GAAG,UAAUtqE,GAAV,EAAe;AAC/C,QAAIsV,gBAAgB,CAACtV,GAAG,CAAC7J,WAAL,CAApB,EAAuC;AACrC,aAAOrW,QAAQ,CAACR,IAAT,CAAc6qF,eAAe,CAACnqE,GAAG,CAAC7J,WAAL,CAA7B,CAAP;AACD,KAFD,MAEO;AACL,aAAO6J,GAAG,CAAC7J,WAAJ,GAAkBooD,eAAe,CAACv+C,GAAG,CAAC7J,WAAL,CAAjC,GAAqDrW,QAAQ,CAACrC,IAAT,EAA5D;AACD;AACF,GAND;;AAOA,MAAI8sF,iCAAiC,GAAG,UAAUv0D,WAAV,EAAuBhW,GAAvB,EAA4B;AAClE,QAAIwqE,aAAa,GAAG17B,aAAa,CAACj3C,MAAd,CAAqBmI,GAAG,CAAC9J,eAAJ,GAAsB8J,GAAG,CAAC9J,eAA1B,GAA4C8J,GAAG,CAACzK,UAArE,CAApB;AACA,WAAO+oD,YAAY,CAACtoC,WAAD,EAAcw0D,aAAd,CAAZ,CAAyCvsF,IAAzC,CAA8C,YAAY;AAC/D,aAAOogE,YAAY,CAACroC,WAAD,EAAc84B,aAAa,CAAC72C,KAAd,CAAoB+H,GAApB,CAAd,CAAnB;AACD,KAFM,EAEJlgB,QAAQ,CAACR,IAFL,CAAP;AAGD,GALD;;AAMA,MAAImrF,gCAAgC,GAAG,UAAUz0D,WAAV,EAAuBhW,GAAvB,EAA4B;AACjE,WAAOq+C,YAAY,CAACroC,WAAD,EAAc84B,aAAa,CAAC72C,KAAd,CAAoB+H,GAApB,CAAd,CAAZ,CAAoD/hB,IAApD,CAAyD,YAAY;AAC1E,aAAOqgE,YAAY,CAACtoC,WAAD,EAAc84B,aAAa,CAACj3C,MAAd,CAAqBmI,GAArB,CAAd,CAAnB;AACD,KAFM,EAEJlgB,QAAQ,CAACR,IAFL,CAAP;AAGD,GAJD;;AAKA,MAAIorF,0BAA0B,GAAG,UAAU10D,WAAV,EAAuBhW,GAAvB,EAA4B;AAC3D,WAAOqqE,+BAA+B,CAACrqE,GAAD,CAA/B,CAAqCrhB,OAArC,CAA6C,YAAY;AAC9D,aAAO2rF,2BAA2B,CAACtqE,GAAD,CAAlC;AACD,KAFM,EAEJrhB,OAFI,CAEI,YAAY;AACrB,aAAO4rF,iCAAiC,CAACv0D,WAAD,EAAchW,GAAd,CAAxC;AACD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAI2qE,wBAAwB,GAAG,UAAU30D,WAAV,EAAuBhW,GAAvB,EAA4B;AACzD,WAAOsqE,2BAA2B,CAACtqE,GAAD,CAA3B,CAAiCrhB,OAAjC,CAAyC,YAAY;AAC1D,aAAO0rF,+BAA+B,CAACrqE,GAAD,CAAtC;AACD,KAFM,EAEJrhB,OAFI,CAEI,YAAY;AACrB,aAAO8rF,gCAAgC,CAACz0D,WAAD,EAAchW,GAAd,CAAvC;AACD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAI4qE,mBAAmB,GAAG,UAAUt6C,OAAV,EAAmBta,WAAnB,EAAgChW,GAAhC,EAAqC;AAC7D,WAAOswB,OAAO,GAAGq6C,wBAAwB,CAAC30D,WAAD,EAAchW,GAAd,CAA3B,GAAgD0qE,0BAA0B,CAAC10D,WAAD,EAAchW,GAAd,CAAxF;AACD,GAFD;;AAGA,MAAI6qE,iCAAiC,GAAG,UAAUv6C,OAAV,EAAmBta,WAAnB,EAAgChW,GAAhC,EAAqC;AAC3E,WAAO4qE,mBAAmB,CAACt6C,OAAD,EAAUta,WAAV,EAAuBhW,GAAvB,CAAnB,CAA+CphB,GAA/C,CAAmD/B,KAAK,CAAC28D,UAAD,EAAax5C,GAAb,CAAxD,CAAP;AACD,GAFD;;AAGA,MAAI8qE,YAAY,GAAG,UAAU79D,MAAV,EAAkBqjB,OAAlB,EAA2B5vB,GAA3B,EAAgC;AACjDA,IAAAA,GAAG,CAACziB,IAAJ,CAAS,YAAY;AACnBgvB,MAAAA,MAAM,CAACskB,KAAP;AACD,KAFD,EAEG,UAAU7wB,GAAV,EAAe;AAChBuM,MAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwB1/C,GAAG,CAACquC,OAAJ,EAAxB,EAAuCze,OAAvC;AACD,KAJD;AAKD,GAND;;AAOA,MAAIy6C,SAAS,GAAG,UAAUhF,OAAV,EAAmB;AACjC,WAAO,UAAU/lE,GAAV,EAAe;AACpB,aAAOA,GAAG,CAAC/N,GAAJ,KAAY8zE,OAAnB;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIiF,SAAS,GAAG,UAAU/9D,MAAV,EAAkBjN,GAAlB,EAAuB;AACrC,WAAOA,GAAG,IAAI7b,GAAG,CAAC8oB,MAAM,CAAC8M,MAAP,CAAc8G,gBAAd,EAAD,EAAmC9mC,IAAI,CAACimB,GAAD,CAAvC,CAAjB;AACD,GAFD;;AAGA,MAAIirE,cAAc,GAAG,UAAUjrE,GAAV,EAAe;AAClC,QAAI4W,OAAO,CAAC5W,GAAD,CAAX,EAAkB;AAChB,UAAIkU,EAAE,GAAG7hB,YAAY,CAACtB,QAAb,CAAsB,yBAAtB,CAAT;AACA4H,MAAAA,KAAK,CAACqH,GAAD,CAAL;AACA7H,MAAAA,MAAM,CAAC6H,GAAD,EAAMkU,EAAN,CAAN;AACA,aAAOp0B,QAAQ,CAACR,IAAT,CAAcwvD,aAAa,CAACj3C,MAAd,CAAqBqc,EAAE,CAACjiB,GAAxB,CAAd,CAAP;AACD,KALD,MAKO;AACL,aAAOnS,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF,GATD;;AAUA,MAAIytF,gBAAgB,GAAG,UAAUlrE,GAAV,EAAemrE,iBAAf,EAAkCtB,mBAAlC,EAAuD;AAC5E,QAAIuB,WAAW,GAAGn1E,WAAW,CAAC+J,GAAD,CAAX,CAAiB/gB,MAAjB,CAAwB6V,MAAxB,CAAlB;AACA,QAAIu2E,WAAW,GAAGl1E,WAAW,CAAC6J,GAAD,CAAX,CAAiB/gB,MAAjB,CAAwB6V,MAAxB,CAAlB;AACAgE,IAAAA,MAAM,CAACkH,GAAD,CAAN;AACA,WAAOorC,KAAK,CAACggC,WAAD,EAAcC,WAAd,EAA2BF,iBAA3B,EAA8C,UAAUx6D,IAAV,EAAgBD,IAAhB,EAAsBhQ,GAAtB,EAA2B;AACnF,UAAIkpE,QAAQ,GAAGj5D,IAAI,CAAC1e,GAApB;AAAA,UAAyB+qD,QAAQ,GAAGtsC,IAAI,CAACze,GAAzC;AACA,UAAI4hB,MAAM,GAAG+1D,QAAQ,CAACniE,IAAT,CAAcxsB,MAA3B;AACA0uF,MAAAA,cAAc,CAACC,QAAD,EAAW5sB,QAAX,EAAqB6sB,mBAArB,CAAd;AACA,aAAOnpE,GAAG,CAACnS,SAAJ,OAAoByuD,QAApB,GAA+BlO,aAAa,CAAC86B,QAAD,EAAW/1D,MAAX,CAA5C,GAAiEnT,GAAxE;AACD,KALW,CAAL,CAKJ/hB,OALI,CAKI,YAAY;AACrB,UAAIkrF,mBAAJ,EAAyB;AACvBuB,QAAAA,WAAW,CAACvsF,IAAZ,CAAiB,UAAUmhB,GAAV,EAAe;AAC9B,iBAAO0pE,yBAAyB,CAAC1pE,GAAG,CAAC/N,GAAL,EAAU+N,GAAG,CAAC/N,GAAJ,CAAQhX,MAAlB,CAAhC;AACD,SAFD;AAGAowF,QAAAA,WAAW,CAACxsF,IAAZ,CAAiB,UAAUmhB,GAAV,EAAe;AAC9B,iBAAOwpE,wBAAwB,CAACxpE,GAAG,CAAC/N,GAAL,EAAU,CAAV,CAA/B;AACD,SAFD;AAGD;;AACD,aAAOk5E,iBAAP;AACD,KAfM,CAAP;AAgBD,GApBD;;AAqBA,MAAIG,eAAe,GAAG,UAAUr+D,MAAV,EAAkB9Z,OAAlB,EAA2B;AAC/C,WAAOhP,GAAG,CAAC8oB,MAAM,CAAC8M,MAAP,CAAcgH,qBAAd,EAAD,EAAwChnC,IAAI,CAACoZ,OAAD,CAA5C,CAAV;AACD,GAFD;;AAGA,MAAIo4E,aAAa,GAAG,UAAUt+D,MAAV,EAAkBqjB,OAAlB,EAA2BtwB,GAA3B,EAAgCwrE,SAAhC,EAA2C;AAC7D,QAAIA,SAAS,KAAK,KAAK,CAAvB,EAA0B;AACxBA,MAAAA,SAAS,GAAG,IAAZ;AACD;;AACD,QAAIC,cAAc,GAAGZ,iCAAiC,CAACv6C,OAAD,EAAUrjB,MAAM,CAACo6B,OAAP,EAAV,EAA4BrnC,GAAG,CAAC/N,GAAhC,CAAtD;AACA,QAAIy5E,WAAW,GAAGlgE,QAAQ,CAACxL,GAAD,EAAMnjB,KAAK,CAACmuF,SAAD,EAAY/9D,MAAZ,CAAX,EAAgC89D,SAAS,CAAC99D,MAAM,CAACo6B,OAAP,EAAD,CAAzC,CAA1B;AACA,QAAIskC,wBAAwB,GAAGT,gBAAgB,CAAClrE,GAAD,EAAMyrE,cAAN,EAAsBH,eAAe,CAACr+D,MAAD,EAASjN,GAAT,CAArC,CAA/C;;AACA,QAAIiN,MAAM,CAAChb,GAAP,CAAW2kB,OAAX,CAAmB3J,MAAM,CAACo6B,OAAP,EAAnB,CAAJ,EAA0C;AACxCp6B,MAAAA,MAAM,CAAC2+D,UAAP,CAAkB,EAAlB;AACA3+D,MAAAA,MAAM,CAACk6B,SAAP,CAAiB0kC,iBAAjB;AACD,KAHD,MAGO;AACLH,MAAAA,WAAW,CAAC5sF,IAAZ,CAAiBmsF,cAAjB,EAAiChtF,IAAjC,CAAsC,YAAY;AAChD,YAAIutF,SAAJ,EAAe;AACbV,UAAAA,YAAY,CAAC79D,MAAD,EAASqjB,OAAT,EAAkBq7C,wBAAlB,CAAZ;AACD;AACF,OAJD,EAIG,UAAUG,OAAV,EAAmB;AACpB,YAAIN,SAAJ,EAAe;AACbV,UAAAA,YAAY,CAAC79D,MAAD,EAASqjB,OAAT,EAAkBxwC,QAAQ,CAACR,IAAT,CAAcwsF,OAAd,CAAlB,CAAZ;AACD;AACF,OARD;AASD;AACF,GArBD;;AAuBA,MAAIC,YAAY,GAAG,UAAUriF,KAAV,EAAiB4nD,GAAjB,EAAsB;AACvC,WAAO;AACL5nD,MAAAA,KAAK,EAAEA,KADF;AAEL4nD,MAAAA,GAAG,EAAEA;AAFA,KAAP;AAID,GALD;;AAMA,MAAI06B,cAAc,GAAG,UAAU9kC,GAAV,EAAetsB,KAAf,EAAsBqxD,KAAtB,EAA6B;AAChD,WAAO;AACL/kC,MAAAA,GAAG,EAAEA,GADA;AAELtsB,MAAAA,KAAK,EAAEA,KAFF;AAGLqxD,MAAAA,KAAK,EAAEA;AAHF,KAAP;AAKD,GAND;;AAOA,MAAIC,YAAY,GAAGnhE,GAAG,CAAChB,QAAJ,CAAa,CAC9B;AAAEoiE,IAAAA,WAAW,EAAE,CAAC,SAAD;AAAf,GAD8B,EAE9B;AAAEC,IAAAA,UAAU,EAAE,CAAC,OAAD;AAAd,GAF8B,EAG9B;AACEC,IAAAA,mBAAmB,EAAE,CACnB,KADmB,EAEnB,MAFmB;AADvB,GAH8B,CAAb,CAAnB;;AAUA,MAAIC,iBAAiB,GAAG,UAAUl9E,IAAV,EAAgB;AACtC,WAAO,UAAUoD,GAAV,EAAe;AACpB,aAAOwB,IAAI,CAAC5E,IAAD,EAAOoD,GAAP,CAAX;AACD,KAFD;AAGD,GAJD;;AAKA,MAAI+5E,cAAc,GAAG,UAAUh+E,SAAV,EAAqBkH,MAArB,EAA6B;AAChD,WAAOoW,SAAS,CAACxZ,YAAY,CAACX,OAAb,CAAqBnD,SAArB,CAAD,EAAkC,OAAlC,EAA2CkH,MAA3C,CAAhB;AACD,GAFD;;AAGA,MAAI+2E,eAAe,GAAG,UAAUC,IAAV,EAAgBh3E,MAAhB,EAAwB;AAC5C,WAAOkW,UAAU,CAAC8gE,IAAD,EAAO,OAAP,EAAgBh3E,MAAhB,CAAjB;AACD,GAFD;;AAGA,MAAIi3E,iBAAiB,GAAG,UAAUC,OAAV,EAAmB;AACzC,WAAO,CAAC34E,IAAI,CAAC24E,OAAO,CAACjjF,KAAT,EAAgBijF,OAAO,CAACr7B,GAAxB,CAAZ;AACD,GAFD;;AAGA,MAAIs7B,mBAAmB,GAAG,UAAUD,OAAV,EAAmBl3E,MAAnB,EAA2B;AACnD,WAAO+2E,eAAe,CAACG,OAAO,CAACjjF,KAAT,EAAgB+L,MAAhB,CAAf,CAAuC3W,IAAvC,CAA4C,UAAU+tF,gBAAV,EAA4B;AAC7E,aAAOL,eAAe,CAACG,OAAO,CAACr7B,GAAT,EAAc77C,MAAd,CAAf,CAAqC3W,IAArC,CAA0C,UAAUguF,cAAV,EAA0B;AACzE,eAAOxhC,MAAM,CAACt3C,IAAI,CAAC64E,gBAAD,EAAmBC,cAAnB,CAAL,EAAyCD,gBAAzC,CAAb;AACD,OAFM,CAAP;AAGD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAIE,iBAAiB,GAAG,UAAUJ,OAAV,EAAmBl3E,MAAnB,EAA2B;AACjD,WAAO,CAACi3E,iBAAiB,CAACC,OAAD,CAAlB,IAA+BC,mBAAmB,CAACD,OAAD,EAAUl3E,MAAV,CAAnB,CAAqC1W,MAArC,CAA4C,UAAU67B,KAAV,EAAiB;AACjG,UAAIoyD,IAAI,GAAGpyD,KAAK,CAAC3oB,GAAN,CAAU+6E,IAArB;AACA,aAAOA,IAAI,CAAC/xF,MAAL,KAAgB,CAAhB,IAAqB+xF,IAAI,CAAC,CAAD,CAAJ,CAAQf,KAAR,CAAchxF,MAAd,KAAyB,CAArD;AACD,KAHqC,CAAtC;AAID,GALD;;AAMA,MAAIgyF,aAAa,GAAG,UAAUryD,KAAV,EAAiB;AACnC,WAAOgsB,aAAa,CAAChsB,KAAD,EAAQ,OAAR,CAApB;AACD,GAFD;;AAGA,MAAIsyD,UAAU,GAAG,UAAUhmC,GAAV,EAAezxC,MAAf,EAAuB;AACtC,QAAI03E,SAAS,GAAGZ,cAAc,CAACrlC,GAAG,CAACryB,cAAL,EAAqBpf,MAArB,CAA9B;AACA,QAAI23E,OAAO,GAAGb,cAAc,CAACrlC,GAAG,CAAClG,YAAL,EAAmBvrC,MAAnB,CAA5B;AACA,WAAOw1C,KAAK,CAACkiC,SAAD,EAAYC,OAAZ,EAAqBrB,YAArB,CAAZ;AACD,GAJD;;AAKA,MAAIsB,0BAA0B,GAAG,UAAUV,OAAV,EAAmBl3E,MAAnB,EAA2B;AAC1D,WAAO+2E,eAAe,CAACG,OAAO,CAACjjF,KAAT,EAAgB+L,MAAhB,CAAf,CAAuC3W,IAAvC,CAA4C,UAAU87B,KAAV,EAAiB;AAClE,aAAO93B,IAAI,CAACmqF,aAAa,CAACryD,KAAD,CAAd,CAAJ,CAA2Bh8B,GAA3B,CAA+B,UAAUwuF,OAAV,EAAmB;AACvD,eAAOrB,YAAY,CAACY,OAAO,CAACjjF,KAAT,EAAgB0jF,OAAhB,CAAnB;AACD,OAFM,CAAP;AAGD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAIE,gBAAgB,GAAG,UAAU73E,MAAV,EAAkByxC,GAAlB,EAAuB;AAC5C,QAAIimC,SAAS,GAAGZ,cAAc,CAACrlC,GAAG,CAACryB,cAAL,EAAqBpf,MAArB,CAA9B;AACA,QAAI23E,OAAO,GAAGb,cAAc,CAACrlC,GAAG,CAAClG,YAAL,EAAmBvrC,MAAnB,CAA5B;AACA,WAAOyxC,GAAG,CAAC+K,SAAJ,GAAgBnyD,QAAQ,CAACrC,IAAT,EAAhB,GAAkCwtD,KAAK,CAACkiC,SAAD,EAAYC,OAAZ,EAAqBrB,YAArB,CAAL,CAAwC9tF,IAAxC,CAA6C,YAAY;AAChG,aAAOkvF,SAAS,CAAClvF,IAAV,CAAe,YAAY;AAChC,eAAOmvF,OAAO,CAACtuF,IAAR,CAAa,UAAUsuF,OAAV,EAAmB;AACrC,iBAAOZ,eAAe,CAACY,OAAD,EAAU33E,MAAV,CAAf,CAAiC3W,IAAjC,CAAsC,UAAU87B,KAAV,EAAiB;AAC5D,mBAAO/3B,IAAI,CAACoqF,aAAa,CAACryD,KAAD,CAAd,CAAJ,CAA2Bh8B,GAA3B,CAA+B,UAAUuuF,SAAV,EAAqB;AACzD,qBAAOpB,YAAY,CAACoB,SAAD,EAAYC,OAAZ,CAAnB;AACD,aAFM,CAAP;AAGD,WAJM,CAAP;AAKD,SANM,CAAP;AAOD,OARM,EAQJ,UAAUD,SAAV,EAAqB;AACtB,eAAOX,eAAe,CAACW,SAAD,EAAY13E,MAAZ,CAAf,CAAmC3W,IAAnC,CAAwC,UAAU87B,KAAV,EAAiB;AAC9D,iBAAO93B,IAAI,CAACmqF,aAAa,CAACryD,KAAD,CAAd,CAAJ,CAA2Bh8B,GAA3B,CAA+B,UAAUwuF,OAAV,EAAmB;AACvD,mBAAOrB,YAAY,CAACoB,SAAD,EAAYC,OAAZ,CAAnB;AACD,WAFM,CAAP;AAGD,SAJM,CAAP;AAKD,OAdM,CAAP;AAeD,KAhBwC,EAgBtC,UAAUT,OAAV,EAAmB;AACpB,aAAOY,iBAAiB,CAAC93E,MAAD,EAASk3E,OAAT,CAAjB,GAAqC7sF,QAAQ,CAACrC,IAAT,EAArC,GAAuD4vF,0BAA0B,CAACV,OAAD,EAAUl3E,MAAV,CAAxF;AACD,KAlBwC,CAAzC;AAmBD,GAtBD;;AAuBA,MAAI83E,iBAAiB,GAAG,UAAU93E,MAAV,EAAkBk3E,OAAlB,EAA2B;AACjD,WAAOC,mBAAmB,CAACD,OAAD,EAAUl3E,MAAV,CAAnB,CAAqCrX,MAArC,EAAP;AACD,GAFD;;AAGA,MAAIovF,4BAA4B,GAAG,UAAUb,OAAV,EAAmBl3E,MAAnB,EAA2B;AAC5D,WAAOm3E,mBAAmB,CAACD,OAAD,EAAUl3E,MAAV,CAAnB,CAAqC7W,GAArC,CAAyC,UAAUg8B,KAAV,EAAiB;AAC/D,aAAOoxD,cAAc,CAACW,OAAD,EAAU/xD,KAAV,EAAiBqyD,aAAa,CAACryD,KAAD,CAA9B,CAArB;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAI6yD,iBAAiB,GAAG,UAAUC,UAAV,EAAsBxmC,GAAtB,EAA2BzxC,MAA3B,EAAmC;AACzD,WAAOi4E,UAAU,CAACzuF,MAAX,CAAkB,UAAU0tF,OAAV,EAAmB;AAC1C,aAAOD,iBAAiB,CAACC,OAAD,CAAjB,IAA8BY,iBAAiB,CAAC93E,MAAD,EAASk3E,OAAT,CAAtD;AACD,KAFM,EAEJhuF,OAFI,CAEI,YAAY;AACrB,aAAO2uF,gBAAgB,CAAC73E,MAAD,EAASyxC,GAAT,CAAvB;AACD,KAJM,EAIJpoD,IAJI,CAIC,UAAU6uF,IAAV,EAAgB;AACtB,aAAOH,4BAA4B,CAACG,IAAD,EAAOl4E,MAAP,CAAnC;AACD,KANM,CAAP;AAOD,GARD;;AASA,MAAIm4E,YAAY,GAAG,UAAU3B,KAAV,EAAiBQ,IAAjB,EAAuB;AACxC,WAAOvqF,SAAS,CAAC+pF,KAAD,EAAQ,UAAUzyF,CAAV,EAAa;AACnC,aAAOwa,IAAI,CAACxa,CAAD,EAAIizF,IAAJ,CAAX;AACD,KAFe,CAAhB;AAGD,GAJD;;AAKA,MAAIoB,gBAAgB,GAAG,UAAU7B,cAAV,EAA0B;AAC/C,WAAO/gC,KAAK,CAAC2iC,YAAY,CAAC5B,cAAc,CAACC,KAAhB,EAAuBD,cAAc,CAAC9kC,GAAf,CAAmBx9C,KAA1C,CAAb,EAA+DkkF,YAAY,CAAC5B,cAAc,CAACC,KAAhB,EAAuBD,cAAc,CAAC9kC,GAAf,CAAmBoK,GAA1C,CAA3E,EAA2H,UAAUmtB,UAAV,EAAsBO,QAAtB,EAAgC;AACrK,aAAOgN,cAAc,CAACC,KAAf,CAAqB1xF,KAArB,CAA2BkkF,UAA3B,EAAuCO,QAAQ,GAAG,CAAlD,CAAP;AACD,KAFW,CAAZ;AAGD,GAJD;;AAKA,MAAI8O,gCAAgC,GAAG,UAAUJ,UAAV,EAAsBxmC,GAAtB,EAA2BzxC,MAA3B,EAAmC;AACxE,WAAOi4E,UAAU,CAACzuF,MAAX,CAAkB,UAAU0tF,OAAV,EAAmB;AAC1C,aAAOI,iBAAiB,CAACJ,OAAD,EAAUl3E,MAAV,CAAjB,IAAsCgxD,sBAAsB,CAACkmB,OAAO,CAACjjF,KAAT,EAAgBw9C,GAAhB,CAAnE;AACD,KAFM,EAEJtoD,GAFI,CAEA,UAAU+tF,OAAV,EAAmB;AACxB,aAAOA,OAAO,CAACjjF,KAAf;AACD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAIqkF,SAAS,GAAG,UAAU/B,cAAV,EAA0B;AACxC,WAAO6B,gBAAgB,CAAC7B,cAAD,CAAhB,CAAiCptF,GAAjC,CAAqC,UAAUmzC,QAAV,EAAoB;AAC9D,UAAIk6C,KAAK,GAAGD,cAAc,CAACC,KAA3B;AACA,aAAOl6C,QAAQ,CAAC92C,MAAT,KAAoBgxF,KAAK,CAAChxF,MAA1B,GAAmCixF,YAAY,CAACC,WAAb,CAAyBH,cAAc,CAACpxD,KAAxC,CAAnC,GAAoFsxD,YAAY,CAACE,UAAb,CAAwBr6C,QAAxB,CAA3F;AACD,KAHM,CAAP;AAID,GALD;;AAMA,MAAIi8C,kBAAkB,GAAG,UAAU5+E,IAAV,EAAgB83C,GAAhB,EAAqB;AAC5C,QAAIzxC,MAAM,GAAG62E,iBAAiB,CAACl9E,IAAD,CAA9B;AACA,QAAIs+E,UAAU,GAAGR,UAAU,CAAChmC,GAAD,EAAMzxC,MAAN,CAA3B;AACA,WAAOq4E,gCAAgC,CAACJ,UAAD,EAAaxmC,GAAb,EAAkBzxC,MAAlB,CAAhC,CAA0D7W,GAA1D,CAA8D,UAAU6tF,IAAV,EAAgB;AACnF,aAAOP,YAAY,CAACG,mBAAb,CAAiCnlC,GAAjC,EAAsCulC,IAAtC,CAAP;AACD,KAFM,EAEJ9tF,OAFI,CAEI,YAAY;AACrB,aAAO8uF,iBAAiB,CAACC,UAAD,EAAaxmC,GAAb,EAAkBzxC,MAAlB,CAAjB,CAA2C3W,IAA3C,CAAgDivF,SAAhD,CAAP;AACD,KAJM,CAAP;AAKD,GARD;;AAUA,MAAIE,WAAW,GAAG,UAAU7+E,IAAV,EAAgB;AAChC,QAAIkH,KAAK,GAAG1B,SAAS,CAACxF,IAAD,CAAT,GAAkB6G,WAAW,CAAC7G,IAAD,CAA7B,GAAsCqH,SAAS,CAACrH,IAAD,CAA3D;AACA,WAAOkH,KAAK,CAACxX,IAAN,CAAWmvF,WAAX,EAAwBtvF,OAAxB,CAAgC,YAAY;AACjD,aAAOmB,QAAQ,CAACR,IAAT,CAAc8P,IAAd,CAAP;AACD,KAFM,CAAP;AAGD,GALD;;AAMA,MAAIg9E,UAAU,GAAG,UAAUn/D,MAAV,EAAkBg/D,KAAlB,EAAyB;AACxCptF,IAAAA,IAAI,CAACotF,KAAD,EAAQ/F,iBAAR,CAAJ;AACAj5D,IAAAA,MAAM,CAACk6B,SAAP,CAAiB0kC,iBAAjB,CAAmCI,KAAK,CAAC,CAAD,CAAL,CAASh6E,GAA5C,EAAiD,CAAjD;AACA,WAAO,IAAP;AACD,GAJD;;AAKA,MAAIi8E,kBAAkB,GAAG,UAAUjhE,MAAV,EAAkBi6B,GAAlB,EAAuBulC,IAAvB,EAA6B;AACpDvlC,IAAAA,GAAG,CAACinC,cAAJ;AACA,QAAIC,QAAQ,GAAGH,WAAW,CAACxB,IAAD,CAAX,CAAkBpuF,KAAlB,CAAwBouF,IAAxB,CAAf;AACA,QAAI4B,SAAS,GAAGh8E,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqB4wC,QAAQ,CAACn8E,GAA9B,EAAmCgb,MAAM,CAAChb,GAAP,CAAW4f,OAA9C,CAArB,CAAhB;;AACA,QAAI+E,OAAO,CAACy3D,SAAD,CAAX,EAAwB;AACtBnI,MAAAA,iBAAiB,CAACmI,SAAD,CAAjB;AACAphE,MAAAA,MAAM,CAACk6B,SAAP,CAAiB0kC,iBAAjB,CAAmCwC,SAAS,CAACp8E,GAA7C,EAAkD,CAAlD;AACD;;AACD,QAAI,CAAC+B,IAAI,CAACy4E,IAAD,EAAO4B,SAAP,CAAT,EAA4B;AAC1B,UAAIC,sBAAsB,GAAGr+E,MAAM,CAACo+E,SAAD,CAAN,CAAkBlwF,EAAlB,CAAqBsuF,IAArB,IAA6B,EAA7B,GAAkC52E,QAAQ,CAACw4E,SAAD,CAAvE;AACAxvF,MAAAA,IAAI,CAACyvF,sBAAsB,CAACpxF,MAAvB,CAA8B8Y,QAAQ,CAACy2E,IAAD,CAAtC,CAAD,EAAgD,UAAU56E,IAAV,EAAgB;AAClE,YAAI,CAACmC,IAAI,CAACnC,IAAD,EAAOw8E,SAAP,CAAL,IAA0B,CAAC95E,UAAU,CAAC1C,IAAD,EAAOw8E,SAAP,CAAzC,EAA4D;AAC1Dv1E,UAAAA,MAAM,CAACjH,IAAD,CAAN;AACD;AACF,OAJG,CAAJ;AAKD;;AACD,WAAO,IAAP;AACD,GAjBD;;AAkBA,MAAI08E,kBAAkB,GAAG,UAAUthE,MAAV,EAAkB2N,KAAlB,EAAyB;AAChD2wD,IAAAA,aAAa,CAACt+D,MAAD,EAAS,KAAT,EAAgB2N,KAAhB,CAAb;AACA,WAAO,IAAP;AACD,GAHD;;AAIA,MAAI4zD,eAAe,GAAG,UAAUvhE,MAAV,EAAkBzM,OAAlB,EAA2B0mC,GAA3B,EAAgC;AACpD,WAAO8mC,kBAAkB,CAACxtE,OAAD,EAAU0mC,GAAV,CAAlB,CAAiCtoD,GAAjC,CAAqC,UAAU6vF,MAAV,EAAkB;AAC5D,aAAOA,MAAM,CAACxwF,IAAP,CAAYpB,KAAK,CAAC0xF,kBAAD,EAAqBthE,MAArB,CAAjB,EAA+CpwB,KAAK,CAACuvF,UAAD,EAAan/D,MAAb,CAApD,EAA0EpwB,KAAK,CAACqxF,kBAAD,EAAqBjhE,MAArB,CAA/E,CAAP;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAIyhE,kBAAkB,GAAG,UAAUzhE,MAAV,EAAkBhN,OAAlB,EAA2B;AAClD,WAAO0uE,YAAY,CAAC1hE,MAAD,EAAShN,OAAT,CAAnB;AACD,GAFD;;AAGA,MAAI2uE,gBAAgB,GAAG,UAAU3hE,MAAV,EAAkBzM,OAAlB,EAA2B0mC,GAA3B,EAAgCooB,QAAhC,EAA0C;AAC/D,WAAOuf,gBAAgB,CAACruE,OAAD,EAAU8uD,QAAV,CAAhB,CAAoCrxE,IAApC,CAAyC,YAAY;AAC1D,aAAOuwF,eAAe,CAACvhE,MAAD,EAASzM,OAAT,EAAkB0mC,GAAlB,CAAtB;AACD,KAFM,EAEJ,UAAUjnC,OAAV,EAAmB;AACpB,aAAOyuE,kBAAkB,CAACzhE,MAAD,EAAShN,OAAT,CAAzB;AACD,KAJM,EAIJ5hB,KAJI,CAIE,KAJF,CAAP;AAKD,GAND;;AAOA,MAAIywF,WAAW,GAAG,UAAU7hE,MAAV,EAAkBqiD,QAAlB,EAA4B;AAC5C,QAAI7+C,QAAQ,GAAGpe,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAf;AACA,QAAIH,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AACA,QAAI8e,aAAa,GAAGC,kBAAkB,CAACl5C,MAAD,CAAtC;AACA,WAAOi5C,aAAa,CAACjrE,MAAd,KAAyB,CAAzB,GAA6BmxF,UAAU,CAACn/D,MAAD,EAASi5C,aAAT,CAAvC,GAAiE0oB,gBAAgB,CAAC3hE,MAAD,EAASwD,QAAT,EAAmBy2B,GAAnB,EAAwBooB,QAAxB,CAAxF;AACD,GALD;;AAMA,MAAIyf,aAAa,GAAG,UAAUvuE,OAAV,EAAmBR,GAAnB,EAAwB;AAC1C,WAAO/d,IAAI,CAACukF,cAAc,CAACxmE,GAAD,EAAMQ,OAAN,CAAf,EAA+B6R,aAA/B,CAAX;AACD,GAFD;;AAGA,MAAIw8D,gBAAgB,GAAG,UAAUruE,OAAV,EAAmBR,GAAnB,EAAwB;AAC7C,WAAO/d,IAAI,CAACukF,cAAc,CAACxmE,GAAD,EAAMQ,OAAN,CAAf,EAA+B,UAAUR,GAAV,EAAe;AACvD,aAAOjmB,IAAI,CAACimB,GAAD,CAAJ,KAAc,SAArB;AACD,KAFU,CAAX;AAGD,GAJD;;AAKA,MAAIgvE,kBAAkB,GAAG,UAAU/hE,MAAV,EAAkBzM,OAAlB,EAA2B8vB,OAA3B,EAAoC2+C,QAApC,EAA8CpvF,IAA9C,EAAoD;AAC3E,WAAOo+D,QAAQ,CAAC3tB,OAAD,EAAUrjB,MAAM,CAACo6B,OAAP,EAAV,EAA4BxnD,IAA5B,CAAR,CAA0Cf,IAA1C,CAA+C,UAAU2b,EAAV,EAAc;AAClE,aAAOs0E,aAAa,CAACvuE,OAAD,EAAUnO,YAAY,CAACX,OAAb,CAAqB+I,EAAE,CAAC8xC,OAAH,EAArB,CAAV,CAAb,CAA2D3tD,GAA3D,CAA+D,UAAUswF,MAAV,EAAkB;AACtF,eAAOl7E,IAAI,CAACk7E,MAAD,EAASD,QAAT,CAAJ,KAA2B,KAAlC;AACD,OAFM,CAAP;AAGD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAIN,YAAY,GAAG,UAAU1hE,MAAV,EAAkBjN,GAAlB,EAAuB;AACxCkmE,IAAAA,iBAAiB,CAAClmE,GAAD,CAAjB;AACAiN,IAAAA,MAAM,CAACk6B,SAAP,CAAiB0kC,iBAAjB,CAAmC7rE,GAAG,CAAC/N,GAAvC,EAA4C,CAA5C;AACA,WAAOnS,QAAQ,CAACR,IAAT,CAAc,IAAd,CAAP;AACD,GAJD;;AAKA,MAAI6vF,qBAAqB,GAAG,UAAUC,WAAV,EAAuB9+C,OAAvB,EAAgCzwC,IAAhC,EAAsC4a,EAAtC,EAA0C;AACpE,WAAO8jD,eAAe,CAAC6wB,WAAW,CAACn9E,GAAb,CAAf,CAAiCnT,IAAjC,CAAsC,UAAU+wC,KAAV,EAAiB;AAC5D,aAAO2uB,cAAc,CAAC4wB,WAAW,CAACn9E,GAAb,CAAd,CAAgCrT,GAAhC,CAAoC,UAAUkE,IAAV,EAAgB;AACzD,eAAOwtC,OAAO,GAAGzwC,IAAI,CAAC+rD,OAAL,CAAa/b,KAAb,KAAuBp1B,EAAE,CAACmxC,OAAH,CAAW9oD,IAAX,CAA1B,GAA6CjD,IAAI,CAAC+rD,OAAL,CAAa9oD,IAAb,KAAsB2X,EAAE,CAACmxC,OAAH,CAAW/b,KAAX,CAAjF;AACD,OAFM,CAAP;AAGD,KAJM,EAIJxxC,KAJI,CAIE,IAJF,CAAP;AAKD,GAND;;AAOA,MAAIgxF,iBAAiB,GAAG,UAAUpiE,MAAV,EAAkBjN,GAAlB,EAAuB;AAC7C,WAAO2uE,YAAY,CAAC1hE,MAAD,EAASjN,GAAT,CAAnB;AACD,GAFD;;AAGA,MAAIsvE,oBAAoB,GAAG,UAAU9uE,OAAV,EAAmB4uE,WAAnB,EAAgC30E,EAAhC,EAAoC;AAC7D,WAAOo0E,gBAAgB,CAACruE,OAAD,EAAUnO,YAAY,CAACX,OAAb,CAAqB+I,EAAE,CAAC8xC,OAAH,EAArB,CAAV,CAAhB,CAA8D3tD,GAA9D,CAAkE,UAAU2wF,SAAV,EAAqB;AAC5F,aAAOv7E,IAAI,CAACu7E,SAAD,EAAYH,WAAZ,CAAJ,KAAiC,KAAxC;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAII,wBAAwB,GAAG,UAAUviE,MAAV,EAAkBzM,OAAlB,EAA2B8vB,OAA3B,EAAoC8+C,WAApC,EAAiDvvF,IAAjD,EAAuD;AACpF,WAAOo+D,QAAQ,CAAC3tB,OAAD,EAAUrjB,MAAM,CAACo6B,OAAP,EAAV,EAA4BxnD,IAA5B,CAAR,CAA0Cf,IAA1C,CAA+C,UAAU2b,EAAV,EAAc;AAClE,aAAO00E,qBAAqB,CAACC,WAAD,EAAc9+C,OAAd,EAAuBzwC,IAAvB,EAA6B4a,EAA7B,CAArB,GAAwD40E,iBAAiB,CAACpiE,MAAD,EAASmiE,WAAT,CAAzE,GAAiGE,oBAAoB,CAAC9uE,OAAD,EAAU4uE,WAAV,EAAuB30E,EAAvB,CAA5H;AACD,KAFM,EAEJ/b,EAFI,CAEDoB,QAAQ,CAACR,IAAT,CAAc,IAAd,CAFC,CAAP;AAGD,GAJD;;AAKA,MAAImwF,gBAAgB,GAAG,UAAUxiE,MAAV,EAAkBqjB,OAAlB,EAA2B9vB,OAA3B,EAAoC8uD,QAApC,EAA8C;AACnE,QAAIzvE,IAAI,GAAGivD,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAX;AACA,WAAO2nC,aAAa,CAACvuE,OAAD,EAAU8uD,QAAV,CAAb,CAAiCxwE,IAAjC,CAAsC,UAAUmwF,QAAV,EAAoB;AAC/D,aAAOr4D,OAAO,CAACq4D,QAAD,CAAP,GAAoBN,YAAY,CAAC1hE,MAAD,EAASgiE,QAAT,CAAhC,GAAqDD,kBAAkB,CAAC/hE,MAAD,EAASzM,OAAT,EAAkB8vB,OAAlB,EAA2B2+C,QAA3B,EAAqCpvF,IAArC,CAA9E;AACD,KAFM,EAEJxB,KAFI,CAEE,KAFF,CAAP;AAGD,GALD;;AAMA,MAAIqxF,kBAAkB,GAAG,UAAUziE,MAAV,EAAkBqjB,OAAlB,EAA2B9vB,OAA3B,EAAoC4uE,WAApC,EAAiD;AACxE,QAAIvvF,IAAI,GAAGivD,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAX;AACA,WAAOxwB,OAAO,CAACw4D,WAAD,CAAP,GAAuBT,YAAY,CAAC1hE,MAAD,EAASmiE,WAAT,CAAnC,GAA2DI,wBAAwB,CAACviE,MAAD,EAASzM,OAAT,EAAkB8vB,OAAlB,EAA2B8+C,WAA3B,EAAwCvvF,IAAxC,CAA1F;AACD,GAHD;;AAIA,MAAI8vF,WAAW,GAAG,UAAUr/C,OAAV,EAAmB5vB,GAAnB,EAAwB;AACxC,WAAO4vB,OAAO,GAAGo1C,aAAa,CAAChlE,GAAD,CAAhB,GAAwBilE,YAAY,CAACjlE,GAAD,CAAlD;AACD,GAFD;;AAGA,MAAIkvE,oBAAoB,GAAG,UAAU3iE,MAAV,EAAkBqjB,OAAlB,EAA2B;AACpD,QAAIu/C,OAAO,GAAG/gC,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAd;AACA,WAAOuoC,WAAW,CAACr/C,OAAD,EAAUu/C,OAAV,CAAX,IAAiCnyB,YAAY,CAACptB,OAAD,EAAUrjB,MAAM,CAACo6B,OAAP,EAAV,EAA4BwoC,OAA5B,CAAZ,CAAiD9wF,MAAjD,CAAwD,UAAU2hB,GAAV,EAAe;AAC7G,aAAOivE,WAAW,CAACr/C,OAAD,EAAU5vB,GAAV,CAAlB;AACD,KAFuC,CAAxC;AAGD,GALD;;AAMA,MAAIovE,WAAW,GAAG,UAAU7iE,MAAV,EAAkBqjB,OAAlB,EAA2Bg/B,QAA3B,EAAqC;AACrD,QAAI9uD,OAAO,GAAGnO,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAd;AACA,WAAOwnC,gBAAgB,CAACruE,OAAD,EAAU8uD,QAAV,CAAhB,CAAoCrxE,IAApC,CAAyC,YAAY;AAC1D,aAAOwxF,gBAAgB,CAACxiE,MAAD,EAASqjB,OAAT,EAAkB9vB,OAAlB,EAA2B8uD,QAA3B,CAAhB,IAAwDsgB,oBAAoB,CAAC3iE,MAAD,EAASqjB,OAAT,CAAnF;AACD,KAFM,EAEJ,UAAU8+C,WAAV,EAAuB;AACxB,aAAOM,kBAAkB,CAACziE,MAAD,EAASqjB,OAAT,EAAkB9vB,OAAlB,EAA2B4uE,WAA3B,CAAlB,CAA0D/wF,KAA1D,CAAgE,KAAhE,CAAP;AACD,KAJM,CAAP;AAKD,GAPD;;AAQA,MAAI0xF,eAAe,GAAG,UAAU9iE,MAAV,EAAkBqjB,OAAlB,EAA2B;AAC/C,QAAIg/B,QAAQ,GAAGj9D,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,CAA0B,IAA1B,CAArB,CAAf;AACA,QAAIsc,KAAK,GAAG9lB,kBAAkB,CAACl5C,MAAD,CAA9B;AACA,WAAOA,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,MAAkC46B,KAAK,CAAChxF,MAAN,KAAiB,CAAnD,GAAuD60F,WAAW,CAAC7iE,MAAD,EAASqjB,OAAT,EAAkBg/B,QAAlB,CAAlE,GAAgGwf,WAAW,CAAC7hE,MAAD,EAASqiD,QAAT,CAAlH;AACD,GAJD;;AAMA,MAAI0gB,aAAa,GAAG,UAAUniC,EAAV,EAAcE,EAAd,EAAkBD,EAAlB,EAAsBE,EAAtB,EAA0B;AAC5C,QAAI9G,GAAG,GAAG94C,QAAQ,CAAC6xC,WAAT,EAAV;AACAiH,IAAAA,GAAG,CAAC5G,QAAJ,CAAauN,EAAb,EAAiBE,EAAjB;AACA7G,IAAAA,GAAG,CAAC3G,MAAJ,CAAWuN,EAAX,EAAeE,EAAf;AACA,WAAO9G,GAAP;AACD,GALD;;AAMA,MAAI+oC,4BAA4B,GAAG,UAAU/oC,GAAV,EAAe;AAChD,QAAIiW,QAAQ,GAAGrO,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAf;AACA,QAAI2Y,MAAM,GAAG/Q,aAAa,CAACI,YAAd,CAA2BhI,GAA3B,CAAb;AACA,QAAIz2B,QAAQ,GAAGy2B,GAAG,CAACq1B,uBAAnB;AACA,WAAO7e,YAAY,CAAC,KAAD,EAAQjtC,QAAR,EAAkBovC,MAAlB,CAAZ,CAAsCjhE,GAAtC,CAA0C,UAAUsxF,SAAV,EAAqB;AACpE,UAAI,CAACx1B,aAAa,CAACyC,QAAD,EAAW0C,MAAX,EAAmBpvC,QAAnB,CAAd,IAA8CiqC,aAAa,CAACyC,QAAD,EAAW+yB,SAAX,EAAsBz/D,QAAtB,CAA/D,EAAgG;AAC9F,eAAOu/D,aAAa,CAAC7yB,QAAQ,CAAC5uD,SAAT,EAAD,EAAuB4uD,QAAQ,CAACtpC,MAAT,EAAvB,EAA0Cq8D,SAAS,CAAC3hF,SAAV,EAA1C,EAAiE2hF,SAAS,CAACr8D,MAAV,EAAjE,CAApB;AACD,OAFD,MAEO;AACL,eAAOqzB,GAAP;AACD;AACF,KANM,EAMJ7oD,KANI,CAME6oD,GANF,CAAP;AAOD,GAXD;;AAYA,MAAIipC,WAAW,GAAG,UAAUjpC,GAAV,EAAe;AAC/B,WAAOA,GAAG,CAAC+K,SAAJ,GAAgB/K,GAAhB,GAAsB+oC,4BAA4B,CAAC/oC,GAAD,CAAzD;AACD,GAFD;;AAIA,MAAIkpC,eAAe,GAAG,UAAUv+E,IAAV,EAAgB;AACpC,WAAOA,IAAI,CAAC2E,UAAL,IAAmB3E,IAAI,CAAC2E,UAAL,KAAoB3E,IAAI,CAAC4E,SAAnD;AACD,GAFD;;AAGA,MAAI45E,aAAa,GAAG,UAAUx+E,IAAV,EAAgB;AAClC,WAAOA,IAAI,CAAC9X,IAAL,KAAc,IAAd,IAAsB8X,IAAI,CAAClV,KAAL,KAAe81B,IAA5C;AACD,GAFD;;AAGA,MAAI69D,kBAAkB,GAAG,UAAUv2D,MAAV,EAAkBloB,IAAlB,EAAwB;AAC/C,QAAI0+E,aAAa,GAAGx2D,MAAM,CAAC8G,gBAAP,EAApB;AACA,WAAO0vD,aAAa,CAAC1+E,IAAI,CAAC9X,IAAN,CAAb,IAA4Bq2F,eAAe,CAACv+E,IAAD,CAA3C,IAAqDw+E,aAAa,CAACx+E,IAAI,CAAC2E,UAAN,CAAzE;AACD,GAHD;;AAIA,MAAIg6E,sBAAsB,GAAG,UAAUz2D,MAAV,EAAkBloB,IAAlB,EAAwB;AACnD,QAAI4+E,gBAAgB,GAAG12D,MAAM,CAACmH,mBAAP,EAAvB;AACA,WAAOrvB,IAAI,KAAKA,IAAI,CAAC+kB,OAAL,CAAa65D,gBAAb,KAAkCH,kBAAkB,CAACv2D,MAAD,EAASloB,IAAT,CAAzD,CAAX;AACD,GAHD;;AAIA,MAAI6+E,cAAc,GAAG,UAAU32D,MAAV,EAAkBowB,QAAlB,EAA4B;AAC/C,QAAI3zC,UAAU,GAAG2zC,QAAQ,CAAC3zC,UAA1B;AACA,QAAIC,SAAS,GAAG0zC,QAAQ,CAAC1zC,SAAzB;;AACA,QAAID,UAAU,IAAIA,UAAU,CAACzc,IAAX,KAAoB,MAAtC,EAA8C;AAC5Cyc,MAAAA,UAAU,GAAGA,UAAU,CAACka,IAAxB;AACD;;AACD,QAAIja,SAAS,IAAIA,SAAS,CAACoI,IAAV,CAAe,IAAf,MAAyB,YAA1C,EAAwD;AACtDpI,MAAAA,SAAS,GAAGA,SAAS,CAACka,IAAtB;AACD;;AACD,QAAI6/D,sBAAsB,CAACz2D,MAAD,EAAStjB,SAAT,CAA1B,EAA+C;AAC7CA,MAAAA,SAAS,GAAGA,SAAS,CAACka,IAAtB;AACD;;AACD,QAAI,CAACna,UAAD,IAAeA,UAAU,KAAKC,SAAlC,EAA6C;AAC3C,aAAO,KAAP;AACD;;AACD,WAAOD,UAAU,CAACzc,IAAX,KAAoB,IAApB,IAA4Byc,UAAU,CAACzc,IAAX,KAAoB,IAAvD;AACD,GAhBD;;AAiBA,MAAI42F,kBAAkB,GAAG,UAAUC,WAAV,EAAuB;AAC9C,QAAIp6E,UAAU,GAAGo6E,WAAW,CAACp6E,UAA7B;AACA,QAAIC,SAAS,GAAGm6E,WAAW,CAACn6E,SAA5B;;AACA,QAAID,UAAU,IAAIA,UAAU,CAAC9B,QAAX,KAAwB,MAA1C,EAAkD;AAChD8B,MAAAA,UAAU,CAACjB,UAAX,CAAsBwD,WAAtB,CAAkCvC,UAAlC;AACD;;AACD,QAAIC,SAAS,IAAIA,SAAS,CAAC3Y,EAAV,KAAiB,YAAlC,EAAgD;AAC9C2Y,MAAAA,SAAS,CAAClB,UAAV,CAAqBwD,WAArB,CAAiCtC,SAAjC;AACD;;AACD,WAAOm6E,WAAP;AACD,GAVD;;AAWA,MAAIC,aAAa,GAAG,UAAU5+E,GAAV,EAAei3C,UAAf,EAA2BiB,QAA3B,EAAqC;AACvD,QAAIn5C,IAAI,GAAGk4C,UAAU,CAACnlB,SAAX,CAAqBomB,QAArB,CAAX;AACA,QAAIymC,WAAW,GAAG3+E,GAAG,CAAC+jC,cAAJ,CAAmBhlC,IAAnB,CAAlB;AACA,WAAO2/E,kBAAkB,CAACC,WAAD,CAAzB;AACD,GAJD;;AAKA,MAAIE,WAAW,GAAG,UAAU9wE,GAAV,EAAe;AAC/B,WAAOrP,KAAK,CAACC,IAAN,CAAWoP,GAAG,CAACzO,UAAf,EAA2B,UAAU+E,KAAV,EAAiB;AACjD,aAAOA,KAAK,CAAC5B,QAAN,KAAmB,IAA1B;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAIq8E,SAAS,GAAG,UAAUl/E,IAAV,EAAgB;AAC9B,WAAOA,IAAI,CAAC4V,IAAL,KAAcgL,IAAd,IAAsB/U,IAAI,CAAC7L,IAAD,CAAjC;AACD,GAFD;;AAGA,MAAIm/E,gBAAgB,GAAG,UAAUn/E,IAAV,EAAgB;AACrC,WAAOA,IAAI,IAAIA,IAAI,CAAC2E,UAAb,IAA2B3E,IAAI,CAAC2E,UAAL,KAAoB3E,IAAI,CAAC4E,SAApD,IAAiEs6E,SAAS,CAACl/E,IAAI,CAAC2E,UAAN,CAAjF;AACD,GAFD;;AAGA,MAAIy6E,eAAe,GAAG,UAAUjxE,GAAV,EAAe;AACnC,WAAO,CAACA,GAAG,CAACxJ,UAAL,IAAmBw6E,gBAAgB,CAAChxE,GAAD,CAA1C;AACD,GAFD;;AAGA,MAAIkxE,aAAa,GAAG,UAAU9zC,IAAV,EAAgB;AAClC,WAAOA,IAAI,CAACniD,MAAL,GAAc,CAAd,IAAmBg2F,eAAe,CAAC7zC,IAAI,CAACA,IAAI,CAACniD,MAAL,GAAc,CAAf,CAAL,CAAlC,GAA4DmiD,IAAI,CAAC7iD,KAAL,CAAW,CAAX,EAAc,CAAC,CAAf,CAA5D,GAAgF6iD,IAAvF;AACD,GAFD;;AAGA,MAAI+zC,WAAW,GAAG,UAAUl/E,GAAV,EAAeJ,IAAf,EAAqB;AACrC,QAAI65E,WAAW,GAAGz5E,GAAG,CAACurC,SAAJ,CAAc3rC,IAAd,EAAoBI,GAAG,CAAC4f,OAAxB,CAAlB;AACA,WAAO65D,WAAW,IAAIA,WAAW,CAACh3E,QAAZ,KAAyB,IAAxC,GAA+Cg3E,WAA/C,GAA6D,IAApE;AACD,GAHD;;AAIA,MAAI0F,eAAe,GAAG,UAAUn/E,GAAV,EAAeJ,IAAf,EAAqB;AACzC,WAAO,CAAC,CAACs/E,WAAW,CAACl/E,GAAD,EAAMJ,IAAN,CAApB;AACD,GAFD;;AAGA,MAAIw/E,QAAQ,GAAG,UAAU97E,UAAV,EAAsB2xC,GAAtB,EAA2B;AACxC,QAAIoqC,SAAS,GAAGpqC,GAAG,CAACgH,UAAJ,EAAhB;AACA,QAAIqjC,QAAQ,GAAGrqC,GAAG,CAACgH,UAAJ,EAAf;AACAojC,IAAAA,SAAS,CAACt2B,cAAV,CAAyBzlD,UAAzB;AACAg8E,IAAAA,QAAQ,CAACpjC,WAAT,CAAqB54C,UAArB;AACA,WAAO,CACL+7E,SAAS,CAACE,aAAV,EADK,EAELD,QAAQ,CAACC,aAAT,EAFK,CAAP;AAID,GATD;;AAUA,MAAIC,WAAW,GAAG,UAAU5/E,IAAV,EAAgB4e,QAAhB,EAA0B;AAC1C,QAAIsqD,QAAQ,GAAGjsB,aAAa,CAACj3C,MAAd,CAAqBhG,IAArB,CAAf;AACA,QAAI6/E,WAAW,GAAGp0B,WAAW,CAAC7sC,QAAD,CAA7B;AACA,QAAIkhE,WAAW,GAAGD,WAAW,CAAChhE,IAAZ,CAAiBqqD,QAAjB,CAAlB;AACA,WAAO4W,WAAW,GAAGA,WAAW,CAAC5iC,OAAZ,EAAH,GAA2B,IAA7C;AACD,GALD;;AAMA,MAAI6iC,UAAU,GAAG,UAAU//E,IAAV,EAAgB4e,QAAhB,EAA0B;AACzC,QAAIsqD,QAAQ,GAAGjsB,aAAa,CAAC72C,KAAd,CAAoBpG,IAApB,CAAf;AACA,QAAI6/E,WAAW,GAAGp0B,WAAW,CAAC7sC,QAAD,CAA7B;AACA,QAAIkhE,WAAW,GAAGD,WAAW,CAAC/gE,IAAZ,CAAiBoqD,QAAjB,CAAlB;AACA,WAAO4W,WAAW,GAAGA,WAAW,CAAC5iC,OAAZ,EAAH,GAA2B,IAA7C;AACD,GALD;;AAMA,MAAI8iC,YAAY,GAAG,UAAUxnF,MAAV,EAAkB+yC,IAAlB,EAAwB3sB,QAAxB,EAAkCy2B,GAAlC,EAAuC;AACxD,QAAIr3B,KAAK,GAAGwhE,QAAQ,CAAChnF,MAAD,EAAS68C,GAAT,CAApB;AACA,QAAInJ,SAAS,GAAG1zC,MAAM,CAACkL,UAAvB;AACAwoC,IAAAA,SAAS,CAAC/lC,YAAV,CAAuB6X,KAAK,CAAC,CAAD,CAA5B,EAAiCxlB,MAAjC;AACAsG,IAAAA,KAAK,CAAC9R,IAAN,CAAWu+C,IAAX,EAAiB,UAAUvd,EAAV,EAAc;AAC7Bke,MAAAA,SAAS,CAAC/lC,YAAV,CAAuB6nB,EAAvB,EAA2Bx1B,MAA3B;AACD,KAFD;AAGA0zC,IAAAA,SAAS,CAAC/lC,YAAV,CAAuB6X,KAAK,CAAC,CAAD,CAA5B,EAAiCxlB,MAAjC;AACA0zC,IAAAA,SAAS,CAAChlC,WAAV,CAAsB1O,MAAtB;AACA,WAAOunF,UAAU,CAACx0C,IAAI,CAACA,IAAI,CAACniD,MAAL,GAAc,CAAf,CAAL,EAAwBw1B,QAAxB,CAAjB;AACD,GAVD;;AAWA,MAAIzY,YAAY,GAAG,UAAU3N,MAAV,EAAkB+yC,IAAlB,EAAwB3sB,QAAxB,EAAkC;AACnD,QAAIstB,SAAS,GAAG1zC,MAAM,CAACkL,UAAvB;AACA5E,IAAAA,KAAK,CAAC9R,IAAN,CAAWu+C,IAAX,EAAiB,UAAUp9B,GAAV,EAAe;AAC9B+9B,MAAAA,SAAS,CAAC/lC,YAAV,CAAuBgI,GAAvB,EAA4B3V,MAA5B;AACD,KAFD;AAGA,WAAOonF,WAAW,CAACpnF,MAAD,EAASomB,QAAT,CAAlB;AACD,GAND;;AAOA,MAAI0uB,WAAW,GAAG,UAAU90C,MAAV,EAAkB+yC,IAAlB,EAAwB3sB,QAAxB,EAAkCxe,GAAlC,EAAuC;AACvDA,IAAAA,GAAG,CAACktC,WAAJ,CAAgB/B,IAAI,CAACh7C,OAAL,EAAhB,EAAgCiI,MAAhC;AACA,WAAOunF,UAAU,CAACx0C,IAAI,CAAC,CAAD,CAAL,EAAU3sB,QAAV,CAAjB;AACD,GAHD;;AAIA,MAAIqhE,aAAa,GAAG,UAAU5oC,UAAV,EAAsBj3C,GAAtB,EAA2Bi1C,GAA3B,EAAgCiD,QAAhC,EAA0C;AAC5D,QAAIymC,WAAW,GAAGC,aAAa,CAAC5+E,GAAD,EAAMi3C,UAAN,EAAkBiB,QAAlB,CAA/B;AACA,QAAI4nC,QAAQ,GAAGZ,WAAW,CAACl/E,GAAD,EAAMi1C,GAAG,CAACryB,cAAV,CAA1B;AACA,QAAIm9D,MAAM,GAAGd,aAAa,CAACJ,WAAW,CAACF,WAAW,CAACp6E,UAAb,CAAZ,CAA1B;AACA,QAAIy7E,SAAS,GAAG,CAAhB;AAAA,QAAmBjnB,GAAG,GAAG,CAAzB;AACA,QAAIv6C,QAAQ,GAAGxe,GAAG,CAACypC,OAAJ,EAAf;;AACA,QAAIw2C,IAAI,GAAG,UAAU5gD,QAAV,EAAoB;AAC7B,UAAIypC,QAAQ,GAAGjsB,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAf;AACA,UAAIwqC,WAAW,GAAGp0B,WAAW,CAACrrD,GAAG,CAACypC,OAAJ,EAAD,CAA7B;AACA,UAAIkrC,MAAM,GAAGt1C,QAAQ,KAAK2gD,SAAb,GAAyBP,WAAW,CAAC/gE,IAAZ,CAAiBoqD,QAAjB,CAAzB,GAAsD2W,WAAW,CAAChhE,IAAZ,CAAiBqqD,QAAjB,CAAnE;AACA,aAAO6L,MAAM,GAAGuK,WAAW,CAACl/E,GAAD,EAAM20E,MAAM,CAACr6B,OAAP,EAAN,CAAX,KAAuCwlC,QAA1C,GAAqD,IAAlE;AACD,KALD;;AAMA,QAAIG,IAAI,CAACD,SAAD,CAAR,EAAqB;AACnB,aAAOj6E,YAAY,CAAC+5E,QAAD,EAAWC,MAAX,EAAmBvhE,QAAnB,CAAnB;AACD,KAFD,MAEO,IAAIyhE,IAAI,CAAClnB,GAAD,CAAR,EAAe;AACpB,aAAO7rB,WAAW,CAAC4yC,QAAD,EAAWC,MAAX,EAAmBvhE,QAAnB,EAA6Bxe,GAA7B,CAAlB;AACD;;AACD,WAAO4/E,YAAY,CAACE,QAAD,EAAWC,MAAX,EAAmBvhE,QAAnB,EAA6By2B,GAA7B,CAAnB;AACD,GAlBD;;AAoBA,MAAIirC,kBAAkB,GAAG,UAAUlgF,GAAV,EAAei1C,GAAf,EAAoBl2C,IAApB,EAA0B;AACjD,QAAI5B,IAAI,GAAGiD,YAAY,CAACX,OAAb,CAAqBO,GAAG,CAACypC,OAAJ,EAArB,CAAX;;AACA,QAAI0sC,iBAAiB,CAACh5E,IAAD,EAAO0/C,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAP,CAArB,EAAgE;AAC9Dl2C,MAAAA,IAAI,GAAGA,IAAI,CAAC/I,OAAL,CAAa,IAAb,EAAmB,QAAnB,CAAP;AACD,KAFD,MAEO;AACL+I,MAAAA,IAAI,GAAGA,IAAI,CAAC/I,OAAL,CAAa,SAAb,EAAwB,GAAxB,CAAP;AACD;;AACD,QAAIogF,kBAAkB,CAACj5E,IAAD,EAAO0/C,aAAa,CAACI,YAAd,CAA2BhI,GAA3B,CAAP,CAAtB,EAA+D;AAC7Dl2C,MAAAA,IAAI,GAAGA,IAAI,CAAC/I,OAAL,CAAa,yBAAb,EAAwC,QAAxC,CAAP;AACD,KAFD,MAEO;AACL+I,MAAAA,IAAI,GAAGA,IAAI,CAAC/I,OAAL,CAAa,sBAAb,EAAqC,GAArC,CAAP;AACD;;AACD,WAAO+I,IAAP;AACD,GAbD;;AAeA,MAAIohF,aAAa,GAAGt0E,WAApB;;AACA,MAAIu0E,0BAA0B,GAAG,UAAUpgF,GAAV,EAAei1C,GAAf,EAAoBulC,IAApB,EAA0B;AACzD,QAAIA,IAAI,KAAK,IAAb,EAAmB;AACjB,UAAIW,OAAO,GAAGn7E,GAAG,CAACurC,SAAJ,CAAc0J,GAAG,CAAClG,YAAlB,EAAgCoxC,aAAhC,CAAd;AACA,aAAO3F,IAAI,KAAKW,OAAT,IAAoB3mB,sBAAsB,CAACp0D,YAAY,CAACX,OAAb,CAAqB+6E,IAArB,CAAD,EAA6BvlC,GAA7B,CAAjD;AACD,KAHD,MAGO;AACL,aAAO,KAAP;AACD;AACF,GAPD;;AAQA,MAAIorC,cAAc,GAAG,UAAUrlE,MAAV,EAAkBtwB,KAAlB,EAAyB4Y,UAAzB,EAAqC;AACxD,QAAIA,UAAU,CAACwH,YAAX,CAAwB,gBAAxB,MAA8C,KAAlD,EAAyD;AACvDxH,MAAAA,UAAU,CAACA,UAAX,CAAsByC,YAAtB,CAAmCiV,MAAM,CAAChb,GAAP,CAAW+jC,cAAX,CAA0Br5C,KAA1B,CAAnC,EAAqE4Y,UAArE;AACD,KAFD,MAEO;AACL,UAAI1D,IAAI,GAAG0D,UAAU,CAACiB,UAAtB;AACA,UAAI6kD,KAAK,GAAG9lD,UAAU,CAACkB,SAAvB;;AACA,UAAI,CAAC5E,IAAD,IAASA,IAAI,KAAKwpD,KAAT,IAAkBxpD,IAAI,CAAC6C,QAAL,KAAkB,IAAjD,EAAuD;AACrDuY,QAAAA,MAAM,CAAChb,GAAP,CAAW4rC,OAAX,CAAmBtoC,UAAnB,EAA+B5Y,KAA/B;AACD,OAFD,MAEO;AACLswB,QAAAA,MAAM,CAACk6B,SAAP,CAAiBykC,UAAjB,CAA4BjvF,KAA5B;AACD;AACF;AACF,GAZD;;AAaA,MAAI41F,oBAAoB,GAAG,UAAUtgF,GAAV,EAAe+N,GAAf,EAAoB;AAC7ClgB,IAAAA,QAAQ,CAACD,IAAT,CAAcoS,GAAG,CAACurC,SAAJ,CAAcx9B,GAAd,EAAmB,OAAnB,CAAd,EAA2CphB,GAA3C,CAA+CyT,YAAY,CAACX,OAA5D,EAAqE7S,IAArE,CAA0EsnF,mBAA1E;AACD,GAFD;;AAGA,MAAIqM,wBAAwB,GAAG,UAAUvlE,MAAV,EAAkBwlE,KAAlB,EAAyB;AACtD,QAAIC,kBAAkB,GAAGzlE,MAAM,CAAC8M,MAAP,CAAcgH,qBAAd,EAAzB;AACA,QAAI9uB,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;;AACA,QAAIwgF,KAAJ,EAAW;AACT,UAAIE,MAAM,GAAG1lE,MAAM,CAACo6B,OAAP,EAAb;AAAA,UAA+BurC,cAAc,GAAGrP,YAAY,CAACtxE,GAAD,CAA5D;AACAtB,MAAAA,KAAK,CAAC9R,IAAN,CAAWoT,GAAG,CAAC+2B,MAAJ,CAAW,sBAAX,CAAX,EAA+C,UAAUn3B,IAAV,EAAgB;AAC7D,aAAK,IAAIghF,QAAQ,GAAGhhF,IAAI,CAAC0D,UAAzB,EAAqCs9E,QAAQ,IAAIA,QAAQ,KAAKF,MAA9D,EAAsEE,QAAQ,GAAGA,QAAQ,CAACt9E,UAA1F,EAAsG;AACpG,cAAIm9E,kBAAkB,CAAC7gF,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,EAAD,CAAlB,IAAmDsqF,cAAc,CAAClkD,OAAf,CAAuBmkD,QAAvB,EAAiChhF,IAAjC,CAAvD,EAA+F;AAC7FI,YAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX,EAAiB,IAAjB;AACD;AACF;AACF,OAND;AAOD;AACF,GAbD;;AAcA,MAAIihF,oBAAoB,GAAG,UAAU3oC,QAAV,EAAoB;AAC7C,QAAIt4C,IAAI,GAAGs4C,QAAX;;AACA,WAAOt4C,IAAI,GAAGA,IAAI,CAACvB,IAAL,EAAd,EAA2B;AACzB,UAAIuB,IAAI,CAAC5R,IAAL,KAAc,CAAlB,EAAqB;AACnB4R,QAAAA,IAAI,CAACgN,IAAL,CAAU,mBAAV,EAA+B,GAA/B;AACD;AACF;AACF,GAPD;;AAQA,MAAIk0E,sBAAsB,GAAG,UAAU/yE,GAAV,EAAe;AAC1CrP,IAAAA,KAAK,CAAC9R,IAAN,CAAWmhB,GAAG,CAACwU,oBAAJ,CAAyB,GAAzB,CAAX,EAA0C,UAAUxU,GAAV,EAAe;AACvDA,MAAAA,GAAG,CAACrB,eAAJ,CAAoB,mBAApB;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIq0E,gBAAgB,GAAG,UAAUnhF,IAAV,EAAgB;AACrC,WAAO,CAAC,CAACA,IAAI,CAACkL,YAAL,CAAkB,mBAAlB,CAAT;AACD,GAFD;;AAGA,MAAIk2E,eAAe,GAAG,UAAUhmE,MAAV,EAAkBpb,IAAlB,EAAwB;AAC5C,WAAOA,IAAI,IAAI,CAACob,MAAM,CAAC8M,MAAP,CAAciH,qBAAd,GAAsCnvB,IAAI,CAAC6C,QAA3C,CAAhB;AACD,GAFD;;AAGA,MAAIw+E,qBAAqB,GAAG,UAAUjmE,MAAV,EAAkBnV,MAAlB,EAA0B;AACpD,QAAIq7E,OAAJ;AACA,QAAIlhF,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AAAA,QAAsBk1C,SAAS,GAAGl6B,MAAM,CAACk6B,SAAzC;AACA,QAAIkU,KAAJ;;AACA,QAAI+3B,6BAA6B,GAAG,UAAUvhF,IAAV,EAAgB;AAClD,UAAIzC,IAAI,GAAG6d,MAAM,CAACo6B,OAAP,EAAX;;AACA,aAAOx1C,IAAI,IAAIA,IAAI,KAAKzC,IAAxB,EAA8ByC,IAAI,GAAGA,IAAI,CAAC0D,UAA1C,EAAsD;AACpD,YAAItD,GAAG,CAAC0uC,kBAAJ,CAAuB9uC,IAAvB,MAAiC,OAArC,EAA8C;AAC5C,iBAAOA,IAAP;AACD;AACF;;AACD,aAAO,IAAP;AACD,KARD;;AASA,QAAI,CAACiG,MAAL,EAAa;AACX;AACD;;AACDqvC,IAAAA,SAAS,CAACrsC,cAAV,CAAyBhD,MAAzB;AACA,QAAIu7E,sBAAsB,GAAGD,6BAA6B,CAACt7E,MAAD,CAA1D;;AACA,QAAIu7E,sBAAJ,EAA4B;AAC1BphF,MAAAA,GAAG,CAAC6G,MAAJ,CAAWhB,MAAX;AACAqvC,MAAAA,SAAS,CAACne,MAAV,CAAiBqqD,sBAAjB;AACA;AACD;;AACD,QAAInsC,GAAG,GAAGj1C,GAAG,CAAC+tC,SAAJ,EAAV;AACA,QAAInuC,IAAI,GAAGiG,MAAM,CAAC5B,eAAlB;;AACA,QAAIrE,IAAI,IAAIA,IAAI,CAACwB,QAAL,KAAkB,CAA9B,EAAiC;AAC/B6zC,MAAAA,GAAG,CAAC5G,QAAJ,CAAazuC,IAAb,EAAmBA,IAAI,CAAC49B,SAAL,CAAex0C,MAAlC;;AACA,UAAI,CAACyS,GAAG,CAAChD,EAAT,EAAa;AACX2wD,QAAAA,KAAK,GAAGvjD,MAAM,CAAC3B,WAAf;;AACA,YAAIklD,KAAK,IAAIA,KAAK,CAAChoD,QAAN,KAAmB,CAAhC,EAAmC;AACjCxB,UAAAA,IAAI,CAAC6tD,UAAL,CAAgBrE,KAAK,CAAC5zC,IAAtB;AACA4zC,UAAAA,KAAK,CAAC9lD,UAAN,CAAiBwD,WAAjB,CAA6BsiD,KAA7B;AACD;AACF;AACF,KATD,MASO;AACLnU,MAAAA,GAAG,CAAC8T,cAAJ,CAAmBljD,MAAnB;AACAovC,MAAAA,GAAG,CAAC+T,YAAJ,CAAiBnjD,MAAjB;AACD;;AACD,QAAIw7E,gBAAgB,GAAG,UAAUpsC,GAAV,EAAe;AACpC,UAAI6zB,QAAQ,GAAGjsB,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAf;AACA,UAAIwqC,WAAW,GAAGp0B,WAAW,CAACrwC,MAAM,CAACo6B,OAAP,EAAD,CAA7B;AACA0zB,MAAAA,QAAQ,GAAG2W,WAAW,CAAChhE,IAAZ,CAAiBqqD,QAAjB,CAAX;;AACA,UAAIA,QAAJ,EAAc;AACZ,eAAOA,QAAQ,CAAChsB,OAAT,EAAP;AACD;AACF,KAPD;;AAQA,QAAI28B,WAAW,GAAGz5E,GAAG,CAACurC,SAAJ,CAAc1lC,MAAd,EAAsB7F,GAAG,CAAC4f,OAA1B,CAAlB;AACA5f,IAAAA,GAAG,CAAC6G,MAAJ,CAAWhB,MAAX;;AACA,QAAI4zE,WAAW,IAAIz5E,GAAG,CAAC2kB,OAAJ,CAAY80D,WAAZ,CAAnB,EAA6C;AAC3Cz+D,MAAAA,MAAM,CAACwuB,CAAP,CAASiwC,WAAT,EAAsB/yE,KAAtB;AACAuuC,MAAAA,GAAG,CAAC5G,QAAJ,CAAaorC,WAAb,EAA0B,CAA1B;AACAxkC,MAAAA,GAAG,CAAC3G,MAAJ,CAAWmrC,WAAX,EAAwB,CAAxB;;AACA,UAAI,CAAC0G,aAAa,CAAC1G,WAAD,CAAd,IAA+B,CAACsH,gBAAgB,CAACtH,WAAD,CAAhD,KAAkEyH,OAAO,GAAGG,gBAAgB,CAACpsC,GAAD,CAA5F,CAAJ,EAAwG;AACtGA,QAAAA,GAAG,GAAGisC,OAAN;AACAlhF,QAAAA,GAAG,CAAC6G,MAAJ,CAAW4yE,WAAX;AACD,OAHD,MAGO;AACLz5E,QAAAA,GAAG,CAACqoB,GAAJ,CAAQoxD,WAAR,EAAqBz5E,GAAG,CAAC9C,MAAJ,CAAW,IAAX,EAAiB;AAAE,4BAAkB;AAApB,SAAjB,CAArB;AACD;AACF;;AACDg4C,IAAAA,SAAS,CAACiZ,MAAV,CAAiBlZ,GAAjB;AACD,GA5DD;;AA6DA,MAAIqsC,qBAAqB,GAAG,UAAUtmE,MAAV,EAAkB;AAC5C,QAAIhb,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,QAAIi1C,GAAG,GAAGipC,WAAW,CAACljE,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAD,CAArB;AACAn6B,IAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB;AACA,QAAIimC,SAAS,GAAGl7E,GAAG,CAACurC,SAAJ,CAAc0J,GAAG,CAACryB,cAAlB,EAAkCu9D,aAAlC,CAAhB;;AACA,QAAIC,0BAA0B,CAACpgF,GAAD,EAAMi1C,GAAN,EAAWimC,SAAX,CAA9B,EAAqD;AACnDe,MAAAA,kBAAkB,CAACjhE,MAAD,EAASi6B,GAAT,EAAc70C,YAAY,CAACX,OAAb,CAAqBy7E,SAArB,CAAd,CAAlB;AACD,KAFD,MAEO;AACLlgE,MAAAA,MAAM,CAACm7C,MAAP,GAAgB0H,WAAhB,CAA4B,QAA5B,EAAsC,KAAtC,EAA6C,IAA7C;AACD;AACF,GAVD;;AAWA,MAAI0jB,iBAAiB,GAAG,UAAUvmE,MAAV,EAAkBtwB,KAAlB,EAAyB82F,OAAzB,EAAkC;AACxD,QAAIl+E,UAAJ,EAAgBkb,QAAhB,EAA0Bv0B,IAA1B;AACA,QAAI4b,MAAJ,EAAYovC,GAAZ,EAAiBr1C,IAAjB;AACA,QAAIs1C,SAAS,GAAGl6B,MAAM,CAACk6B,SAAvB;AAAA,QAAkCl1C,GAAG,GAAGgb,MAAM,CAAChb,GAA/C;;AACA,QAAI,QAAQnL,IAAR,CAAanK,KAAb,CAAJ,EAAyB;AACvBA,MAAAA,KAAK,GAAGw1F,kBAAkB,CAAClgF,GAAD,EAAMk1C,SAAS,CAACC,MAAV,EAAN,EAA0BzqD,KAA1B,CAA1B;AACD;;AACD,QAAI+2F,MAAM,GAAGzmE,MAAM,CAACymE,MAApB;AACA,QAAIjB,KAAK,GAAGgB,OAAO,CAAChB,KAApB;AACA,QAAIvpC,UAAU,GAAGs7B,cAAc,CAAC;AAAE5L,MAAAA,QAAQ,EAAEjjB,cAAc,CAAC1oC,MAAD;AAA1B,KAAD,EAAuCA,MAAM,CAAC8M,MAA9C,CAA/B;AACA,QAAI45D,YAAY,GAAG,gEAAnB;AACAz3F,IAAAA,IAAI,GAAG;AACLu8C,MAAAA,OAAO,EAAE97C,KADJ;AAELulE,MAAAA,MAAM,EAAE,MAFH;AAGL/a,MAAAA,SAAS,EAAE,IAHN;AAILysC,MAAAA,KAAK,EAAEH,OAAO,CAACG;AAJV,KAAP;AAMA13F,IAAAA,IAAI,GAAG+wB,MAAM,CAACmb,IAAP,CAAY,kBAAZ,EAAgClsC,IAAhC,CAAP;;AACA,QAAIA,IAAI,CAAC8oC,kBAAL,EAAJ,EAA+B;AAC7B/X,MAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0B;AACxBqQ,QAAAA,OAAO,EAAEv8C,IAAI,CAACu8C,OADU;AAExBypB,QAAAA,MAAM,EAAE,MAFgB;AAGxB/a,QAAAA,SAAS,EAAE,IAHa;AAIxBysC,QAAAA,KAAK,EAAEH,OAAO,CAACG;AAJS,OAA1B;AAMA;AACD;;AACDj3F,IAAAA,KAAK,GAAGT,IAAI,CAACu8C,OAAb;;AACA,QAAI97C,KAAK,CAACzC,OAAN,CAAc,UAAd,MAA8B,CAAC,CAAnC,EAAsC;AACpCyC,MAAAA,KAAK,IAAI,UAAT;AACD;;AACDA,IAAAA,KAAK,GAAGA,KAAK,CAACsL,OAAN,CAAc,aAAd,EAA6B0rF,YAA7B,CAAR;AACAzsC,IAAAA,GAAG,GAAGC,SAAS,CAACC,MAAV,EAAN;AACA,QAAIysC,YAAY,GAAG3sC,GAAG,CAACryB,cAAJ,KAAuBqyB,GAAG,CAACypB,aAAJ,GAAoBzpB,GAAG,CAACypB,aAAJ,EAApB,GAA0C,IAAjE,CAAnB;AACA,QAAIx3D,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAAX;;AACA,QAAIwsC,YAAY,KAAK16E,IAAjB,IAAyBguC,SAAS,CAACkK,WAAV,EAA7B,EAAsD;AACpD,UAAIp/C,GAAG,CAAC4f,OAAJ,CAAY1Y,IAAI,CAAC3C,UAAjB,KAAgCy8E,eAAe,CAAChmE,MAAD,EAAS9T,IAAI,CAAC3C,UAAd,CAA/C,IAA4EvE,GAAG,CAAC2kB,OAAJ,CAAYzd,IAAI,CAAC3C,UAAjB,CAAhF,EAA8G;AAC5G0wC,QAAAA,GAAG,GAAGj1C,GAAG,CAAC+tC,SAAJ,EAAN;AACAkH,QAAAA,GAAG,CAAC5G,QAAJ,CAAannC,IAAI,CAAC3C,UAAlB,EAA8B,CAA9B;AACA0wC,QAAAA,GAAG,CAAC3G,MAAJ,CAAWpnC,IAAI,CAAC3C,UAAhB,EAA4B,CAA5B;AACA2wC,QAAAA,SAAS,CAACiZ,MAAV,CAAiBlZ,GAAjB;AACD;AACF;;AACD,QAAI,CAACC,SAAS,CAACkK,WAAV,EAAL,EAA8B;AAC5BkiC,MAAAA,qBAAqB,CAACtmE,MAAD,CAArB;AACD;;AACD1X,IAAAA,UAAU,GAAG4xC,SAAS,CAACoF,OAAV,EAAb;AACA,QAAIunC,UAAU,GAAG;AACfvnD,MAAAA,OAAO,EAAEh3B,UAAU,CAACb,QAAX,CAAoBpM,WAApB,EADM;AAEfmf,MAAAA,IAAI,EAAEgsE,OAAO,CAAChsE,IAFC;AAGfw1D,MAAAA,MAAM,EAAE;AAHO,KAAjB;AAKA,QAAI9yB,QAAQ,GAAGupC,MAAM,CAACpxD,KAAP,CAAa3lC,KAAb,EAAoBm3F,UAApB,CAAf;;AACA,QAAIL,OAAO,CAACG,KAAR,KAAkB,IAAlB,IAA0BlD,cAAc,CAACzjE,MAAM,CAAC8M,MAAR,EAAgBowB,QAAhB,CAAxC,IAAqEinC,eAAe,CAACn/E,GAAD,EAAMsD,UAAN,CAAxF,EAA2G;AACzG2xC,MAAAA,GAAG,GAAG4qC,aAAa,CAAC5oC,UAAD,EAAaj3C,GAAb,EAAkBk1C,SAAS,CAACC,MAAV,EAAlB,EAAsC+C,QAAtC,CAAnB;AACAhD,MAAAA,SAAS,CAACiZ,MAAV,CAAiBlZ,GAAjB;AACAj6B,MAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0BlsC,IAA1B;AACA;AACD;;AACD42F,IAAAA,oBAAoB,CAAC3oC,QAAD,CAApB;AACAt4C,IAAAA,IAAI,GAAGs4C,QAAQ,CAAC1zC,SAAhB;;AACA,QAAI5E,IAAI,CAACgN,IAAL,CAAU,IAAV,MAAoB,YAAxB,EAAsC;AACpC/G,MAAAA,MAAM,GAAGjG,IAAT;;AACA,WAAKA,IAAI,GAAGA,IAAI,CAAC8e,IAAjB,EAAuB9e,IAAvB,EAA6BA,IAAI,GAAGA,IAAI,CAACvB,IAAL,CAAU,IAAV,CAApC,EAAqD;AACnD,YAAIuB,IAAI,CAAC5R,IAAL,KAAc,CAAd,IAAmB,CAACgS,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAI,CAAC9X,IAAjB,CAAxB,EAAgD;AAC9C,cAAIkzB,MAAM,CAAC8M,MAAP,CAAcuH,YAAd,CAA2BzvB,IAAI,CAAC5B,MAAL,CAAYlW,IAAvC,EAA6C,MAA7C,CAAJ,EAA0D;AACxD8X,YAAAA,IAAI,CAAC5B,MAAL,CAAYgtE,MAAZ,CAAmBnlE,MAAnB,EAA2BjG,IAA3B,EAAiCA,IAAI,CAAC9X,IAAL,KAAc,IAA/C;AACD;;AACD;AACD;AACF;AACF;;AACDkzB,IAAAA,MAAM,CAAC8mE,mBAAP,CAA2BC,uBAA3B,CAAmDz+E,UAAnD;;AACA,QAAI,CAACu+E,UAAU,CAACG,OAAhB,EAAyB;AACvBt3F,MAAAA,KAAK,GAAGusD,UAAU,CAACnlB,SAAX,CAAqBomB,QAArB,CAAR;AACAmoC,MAAAA,cAAc,CAACrlE,MAAD,EAAStwB,KAAT,EAAgB4Y,UAAhB,CAAd;AACD,KAHD,MAGO;AACL0X,MAAAA,MAAM,CAACk6B,SAAP,CAAiBykC,UAAjB,CAA4B+H,YAA5B;AACAp+E,MAAAA,UAAU,GAAG4xC,SAAS,CAACoF,OAAV,EAAb;AACA97B,MAAAA,QAAQ,GAAGxD,MAAM,CAACo6B,OAAP,EAAX;;AACA,UAAI9xC,UAAU,CAAClC,QAAX,KAAwB,CAA5B,EAA+B;AAC7BkC,QAAAA,UAAU,GAAG1D,IAAI,GAAG4e,QAApB;AACD,OAFD,MAEO;AACL5e,QAAAA,IAAI,GAAG0D,UAAP;AACD;;AACD,aAAO1D,IAAI,KAAK4e,QAAhB,EAA0B;AACxBlb,QAAAA,UAAU,GAAG1D,IAAb;AACAA,QAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD5Y,MAAAA,KAAK,GAAG4Y,UAAU,KAAKkb,QAAf,GAA0BA,QAAQ,CAACpf,SAAnC,GAA+CY,GAAG,CAAC+sC,YAAJ,CAAiBzpC,UAAjB,CAAvD;AACA5Y,MAAAA,KAAK,GAAGusD,UAAU,CAACnlB,SAAX,CAAqB2vD,MAAM,CAACpxD,KAAP,CAAa3lC,KAAK,CAACsL,OAAN,CAAc,mDAAd,EAAmE,YAAY;AACvH,eAAOihD,UAAU,CAACnlB,SAAX,CAAqBomB,QAArB,CAAP;AACD,OAFyC,CAAb,CAArB,CAAR;;AAGA,UAAI50C,UAAU,KAAKkb,QAAnB,EAA6B;AAC3Bxe,QAAAA,GAAG,CAAC4rC,OAAJ,CAAYptB,QAAZ,EAAsB9zB,KAAtB;AACD,OAFD,MAEO;AACLsV,QAAAA,GAAG,CAACitC,YAAJ,CAAiB3pC,UAAjB,EAA6B5Y,KAA7B;AACD;AACF;;AACD61F,IAAAA,wBAAwB,CAACvlE,MAAD,EAASwlE,KAAT,CAAxB;AACAS,IAAAA,qBAAqB,CAACjmE,MAAD,EAAShb,GAAG,CAACrP,GAAJ,CAAQ,YAAR,CAAT,CAArB;AACAmwF,IAAAA,sBAAsB,CAAC9lE,MAAM,CAACo6B,OAAP,EAAD,CAAtB;AACAkrC,IAAAA,oBAAoB,CAACtgF,GAAD,EAAMk1C,SAAS,CAACwoB,QAAV,EAAN,CAApB;AACA1iD,IAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0BlsC,IAA1B;AACA+wB,IAAAA,MAAM,CAACinE,SAAP;AACD,GAzGD;;AA2GA,MAAIC,QAAQ,GAAG,UAAUtiF,IAAV,EAAgB/U,EAAhB,EAAoB;AACjCA,IAAAA,EAAE,CAAC+U,IAAD,CAAF;;AACA,QAAIA,IAAI,CAAC2E,UAAT,EAAqB;AACnB29E,MAAAA,QAAQ,CAACtiF,IAAI,CAAC2E,UAAN,EAAkB1Z,EAAlB,CAAR;AACD;;AACD,QAAI+U,IAAI,CAAC6e,IAAT,EAAe;AACbyjE,MAAAA,QAAQ,CAACtiF,IAAI,CAAC6e,IAAN,EAAY5zB,EAAZ,CAAR;AACD;AACF,GARD;;AASA,MAAIs3F,iBAAiB,GAAG,UAAUC,WAAV,EAAuBC,gBAAvB,EAAyCziF,IAAzC,EAA+C;AACrE,QAAI0iF,WAAW,GAAG,EAAlB;AACA,QAAIC,WAAW,GAAG,EAAlB;AACA,QAAIxnF,OAAO,GAAG,EAAd;;AACA,QAAI6E,IAAI,CAAC2E,UAAT,EAAqB;AACnB29E,MAAAA,QAAQ,CAACtiF,IAAI,CAAC2E,UAAN,EAAkB,UAAU3E,IAAV,EAAgB;AACxChT,QAAAA,IAAI,CAACw1F,WAAD,EAAc,UAAUp1F,MAAV,EAAkB;AAClC,cAAIA,MAAM,CAAClF,IAAP,KAAgB8X,IAAI,CAAC9X,IAAzB,EAA+B;AAC7B,gBAAIw6F,WAAW,CAACt1F,MAAM,CAAClF,IAAR,CAAf,EAA8B;AAC5Bw6F,cAAAA,WAAW,CAACt1F,MAAM,CAAClF,IAAR,CAAX,CAAyB+lB,KAAzB,CAA+B7e,IAA/B,CAAoC4Q,IAApC;AACD,aAFD,MAEO;AACL0iF,cAAAA,WAAW,CAACt1F,MAAM,CAAClF,IAAR,CAAX,GAA2B;AACzBkF,gBAAAA,MAAM,EAAEA,MADiB;AAEzB6gB,gBAAAA,KAAK,EAAE,CAACjO,IAAD;AAFkB,eAA3B;AAID;AACF;AACF,SAXG,CAAJ;AAYAhT,QAAAA,IAAI,CAACy1F,gBAAD,EAAmB,UAAUr1F,MAAV,EAAkB;AACvC,cAAI,OAAO4S,IAAI,CAACgN,IAAL,CAAU5f,MAAM,CAAClF,IAAjB,CAAP,KAAkC,QAAtC,EAAgD;AAC9C,gBAAIy6F,WAAW,CAACv1F,MAAM,CAAClF,IAAR,CAAf,EAA8B;AAC5By6F,cAAAA,WAAW,CAACv1F,MAAM,CAAClF,IAAR,CAAX,CAAyB+lB,KAAzB,CAA+B7e,IAA/B,CAAoC4Q,IAApC;AACD,aAFD,MAEO;AACL2iF,cAAAA,WAAW,CAACv1F,MAAM,CAAClF,IAAR,CAAX,GAA2B;AACzBkF,gBAAAA,MAAM,EAAEA,MADiB;AAEzB6gB,gBAAAA,KAAK,EAAE,CAACjO,IAAD;AAFkB,eAA3B;AAID;AACF;AACF,SAXG,CAAJ;AAYD,OAzBO,CAAR;AA0BD;;AACD,SAAK,IAAIxB,MAAT,IAAmBkkF,WAAnB,EAAgC;AAC9B,UAAIA,WAAW,CAACtxF,cAAZ,CAA2BoN,MAA3B,CAAJ,EAAwC;AACtCrD,QAAAA,OAAO,CAAC/L,IAAR,CAAaszF,WAAW,CAAClkF,MAAD,CAAxB;AACD;AACF;;AACD,SAAK,IAAIokF,MAAT,IAAmBD,WAAnB,EAAgC;AAC9B,UAAIA,WAAW,CAACvxF,cAAZ,CAA2BwxF,MAA3B,CAAJ,EAAwC;AACtCznF,QAAAA,OAAO,CAAC/L,IAAR,CAAauzF,WAAW,CAACC,MAAD,CAAxB;AACD;AACF;;AACD,WAAOznF,OAAP;AACD,GA3CD;;AA4CA,MAAI0nF,QAAQ,GAAG,UAAUL,WAAV,EAAuBC,gBAAvB,EAAyCziF,IAAzC,EAA+C;AAC5D,QAAI7E,OAAO,GAAGonF,iBAAiB,CAACC,WAAD,EAAcC,gBAAd,EAAgCziF,IAAhC,CAA/B;AACAhT,IAAAA,IAAI,CAACmO,OAAD,EAAU,UAAU2C,KAAV,EAAiB;AAC7B9Q,MAAAA,IAAI,CAAC8Q,KAAK,CAAC1Q,MAAN,CAAayoB,SAAd,EAAyB,UAAU9iB,QAAV,EAAoB;AAC/CA,QAAAA,QAAQ,CAAC+K,KAAK,CAACmQ,KAAP,EAAcnQ,KAAK,CAAC1Q,MAAN,CAAalF,IAA3B,EAAiC,EAAjC,CAAR;AACD,OAFG,CAAJ;AAGD,KAJG,CAAJ;AAKD,GAPD;;AASA,MAAI46F,aAAa,GAAG,MAApB;;AACA,MAAIC,UAAU,GAAG,UAAUn8C,OAAV,EAAmB;AAClC,WAAOA,OAAO,YAAYukC,OAA1B;AACD,GAFD;;AAGA,MAAI6X,aAAa,GAAG,UAAU5nE,MAAV,EAAkB;AACpC,QAAIsuD,UAAU,CAACtuD,MAAD,CAAd,EAAwB;AACtBsxC,MAAAA,eAAe,CAACtxC,MAAM,CAACo6B,OAAP,EAAD,CAAf,CAAkCxoD,IAAlC,CAAuC,UAAU6hB,GAAV,EAAe;AACpD,YAAI7O,IAAI,GAAG6O,GAAG,CAAC6rC,OAAJ,EAAX;AACA,YAAIwuB,QAAQ,GAAG79D,OAAO,CAACrL,IAAD,CAAP,GAAgB0sD,eAAe,CAAC1sD,IAAD,CAAf,CAAsBxT,KAAtB,CAA4BqiB,GAA5B,CAAhB,GAAmDA,GAAlE;AACAuM,QAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwB2a,QAAQ,CAAChsB,OAAT,EAAxB;AACD,OAJD;AAKD;AACF,GARD;;AASA,MAAI+lC,aAAa,GAAG,UAAU7nE,MAAV,EAAkBjc,IAAlB,EAAwB;AAC1Cic,IAAAA,MAAM,CAAChb,GAAP,CAAW4rC,OAAX,CAAmB5wB,MAAM,CAACo6B,OAAP,EAAnB,EAAqCr2C,IAArC;AACA6jF,IAAAA,aAAa,CAAC5nE,MAAD,CAAb;AACD,GAHD;;AAIA,MAAI8nE,gBAAgB,GAAG,UAAU9nE,MAAV,EAAkB9T,IAAlB,EAAwBs/B,OAAxB,EAAiCv8C,IAAjC,EAAuC;AAC5D,QAAI84F,mBAAJ,EAAyBC,IAAzB;;AACA,QAAIx8C,OAAO,CAACx9C,MAAR,KAAmB,CAAnB,IAAwB,QAAQ6L,IAAR,CAAa2xC,OAAb,CAA5B,EAAmD;AACjDw8C,MAAAA,IAAI,GAAG,yBAAP;;AACA,UAAI97E,IAAI,CAACzE,QAAL,KAAkB,OAAtB,EAA+B;AAC7B+jC,QAAAA,OAAO,GAAG,aAAaw8C,IAAb,GAAoB,YAA9B;AACD,OAFD,MAEO,IAAI,YAAYnuF,IAAZ,CAAiBqS,IAAI,CAACzE,QAAtB,CAAJ,EAAqC;AAC1C+jC,QAAAA,OAAO,GAAG,SAASw8C,IAAT,GAAgB,OAA1B;AACD;;AACDD,MAAAA,mBAAmB,GAAG3hC,kBAAkB,CAACpmC,MAAD,CAAxC;;AACA,UAAI+nE,mBAAmB,IAAI/nE,MAAM,CAAC8M,MAAP,CAAcuH,YAAd,CAA2BnoB,IAAI,CAACzE,QAAL,CAAcpM,WAAd,EAA3B,EAAwD0sF,mBAAmB,CAAC1sF,WAApB,EAAxD,CAA3B,EAAuH;AACrHmwC,QAAAA,OAAO,GAAGw8C,IAAV;AACAx8C,QAAAA,OAAO,GAAGxrB,MAAM,CAAChb,GAAP,CAAWgsC,UAAX,CAAsB+2C,mBAAtB,EAA2CzhC,uBAAuB,CAACtmC,MAAD,CAAlE,EAA4EwrB,OAA5E,CAAV;AACD,OAHD,MAGO,IAAI,CAACA,OAAL,EAAc;AACnBA,QAAAA,OAAO,GAAG,yBAAV;AACD;;AACDq8C,MAAAA,aAAa,CAAC7nE,MAAD,EAASwrB,OAAT,CAAb;AACAxrB,MAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0BlsC,IAA1B;AACD,KAhBD,MAgBO;AACL,UAAIA,IAAI,CAACgmE,MAAL,KAAgB,KAApB,EAA2B;AACzBzpB,QAAAA,OAAO,GAAG+rC,cAAc,CAAC;AAAE5L,UAAAA,QAAQ,EAAE3rD,MAAM,CAAC2rD;AAAnB,SAAD,EAAgC3rD,MAAM,CAAC8M,MAAvC,CAAd,CAA6DgK,SAA7D,CAAuE9W,MAAM,CAACymE,MAAP,CAAcpxD,KAAd,CAAoBmW,OAApB,EAA6B;AAC5Gy8C,UAAAA,aAAa,EAAE,IAD6F;AAE5GjY,UAAAA,MAAM,EAAE;AAFoG,SAA7B,CAAvE,CAAV;AAID;;AACD/gF,MAAAA,IAAI,CAACu8C,OAAL,GAAenmB,mBAAmB,CAACjgB,YAAY,CAACX,OAAb,CAAqByH,IAArB,CAAD,CAAnB,GAAkDs/B,OAAlD,GAA4D9nC,KAAK,CAAC3G,IAAN,CAAWyuC,OAAX,CAA3E;AACAq8C,MAAAA,aAAa,CAAC7nE,MAAD,EAAS/wB,IAAI,CAACu8C,OAAd,CAAb;;AACA,UAAI,CAACv8C,IAAI,CAACknF,SAAV,EAAqB;AACnBn2D,QAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0BlsC,IAA1B;AACD;AACF;;AACD,WAAOA,IAAI,CAACu8C,OAAZ;AACD,GAhCD;;AAiCA,MAAI08C,cAAc,GAAG,UAAUloE,MAAV,EAAkB9T,IAAlB,EAAwBs/B,OAAxB,EAAiCv8C,IAAjC,EAAuC;AAC1Dw4F,IAAAA,QAAQ,CAACznE,MAAM,CAACymE,MAAP,CAAc0B,cAAd,EAAD,EAAiCnoE,MAAM,CAACymE,MAAP,CAAc2B,mBAAd,EAAjC,EAAsE58C,OAAtE,CAAR;AACA,QAAIznC,IAAI,GAAGwzE,cAAc,CAAC;AAAE5L,MAAAA,QAAQ,EAAE3rD,MAAM,CAAC2rD;AAAnB,KAAD,EAAgC3rD,MAAM,CAAC8M,MAAvC,CAAd,CAA6DgK,SAA7D,CAAuE0U,OAAvE,CAAX;AACAv8C,IAAAA,IAAI,CAACu8C,OAAL,GAAenmB,mBAAmB,CAACjgB,YAAY,CAACX,OAAb,CAAqByH,IAArB,CAAD,CAAnB,GAAkDnI,IAAlD,GAAyDL,KAAK,CAAC3G,IAAN,CAAWgH,IAAX,CAAxE;AACA8jF,IAAAA,aAAa,CAAC7nE,MAAD,EAAS/wB,IAAI,CAACu8C,OAAd,CAAb;;AACA,QAAI,CAACv8C,IAAI,CAACknF,SAAV,EAAqB;AACnBn2D,MAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0BlsC,IAA1B;AACD;;AACD,WAAOu8C,OAAP;AACD,GATD;;AAUA,MAAI68C,kBAAkB,GAAG,UAAUroE,MAAV,EAAkBwrB,OAAlB,EAA2Bv8C,IAA3B,EAAiC;AACxDA,IAAAA,IAAI,CAACgmE,MAAL,GAAchmE,IAAI,CAACgmE,MAAL,GAAchmE,IAAI,CAACgmE,MAAnB,GAA4ByyB,aAA1C;AACAz4F,IAAAA,IAAI,CAACkiB,GAAL,GAAW,IAAX;AACAliB,IAAAA,IAAI,CAACu8C,OAAL,GAAem8C,UAAU,CAACn8C,OAAD,CAAV,GAAsB,EAAtB,GAA2BA,OAA1C;;AACA,QAAI,CAACv8C,IAAI,CAACknF,SAAV,EAAqB;AACnBn2D,MAAAA,MAAM,CAACmb,IAAP,CAAY,kBAAZ,EAAgClsC,IAAhC;AACD;;AACD,QAAI,CAAC04F,UAAU,CAACn8C,OAAD,CAAf,EAA0B;AACxBA,MAAAA,OAAO,GAAGv8C,IAAI,CAACu8C,OAAf;AACD;;AACD,WAAO34C,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAACo6B,OAAP,EAAd,EAAgCppD,IAAhC,CAAqCvB,QAAQ,CAAC+7C,OAAD,CAA7C,EAAwD,UAAUt/B,IAAV,EAAgB;AAC7E,aAAOy7E,UAAU,CAACn8C,OAAD,CAAV,GAAsB08C,cAAc,CAACloE,MAAD,EAAS9T,IAAT,EAAes/B,OAAf,EAAwBv8C,IAAxB,CAApC,GAAoE64F,gBAAgB,CAAC9nE,MAAD,EAAS9T,IAAT,EAAes/B,OAAf,EAAwBv8C,IAAxB,CAA3F;AACD,KAFM,CAAP;AAGD,GAbD;;AAeA,MAAIq5F,SAAS,GAAG,UAAUtkF,KAAV,EAAiBzL,SAAjB,EAA4B;AAC1C,WAAO0S,OAAO,CAACjH,KAAD,EAAQzL,SAAR,CAAP,CAA0BpH,MAA1B,EAAP;AACD,GAFD;;AAIA,MAAIo3F,YAAY,GAAG,UAAU//E,MAAV,EAAkB;AACnC,WAAO7U,UAAU,CAAC6U,MAAD,CAAV,GAAqBA,MAArB,GAA8BlY,KAArC;AACD,GAFD;;AAGA,MAAIk4F,UAAU,GAAG,UAAUxkF,KAAV,EAAiBykF,SAAjB,EAA4BjgF,MAA5B,EAAoC;AACnD,QAAItC,OAAO,GAAGlC,KAAK,CAACgB,GAApB;AACA,QAAIyD,IAAI,GAAG8/E,YAAY,CAAC//E,MAAD,CAAvB;;AACA,WAAOtC,OAAO,CAACoC,UAAf,EAA2B;AACzBpC,MAAAA,OAAO,GAAGA,OAAO,CAACoC,UAAlB;AACA,UAAIiC,EAAE,GAAGnF,YAAY,CAACX,OAAb,CAAqByB,OAArB,CAAT;AACA,UAAIwiF,WAAW,GAAGD,SAAS,CAACl+E,EAAD,CAA3B;;AACA,UAAIm+E,WAAW,CAACv3F,MAAZ,EAAJ,EAA0B;AACxB,eAAOu3F,WAAP;AACD,OAFD,MAEO,IAAIjgF,IAAI,CAAC8B,EAAD,CAAR,EAAc;AACnB;AACD;AACF;;AACD,WAAO1X,QAAQ,CAACrC,IAAT,EAAP;AACD,GAdD;;AAeA,MAAIm4F,SAAS,GAAG,UAAU3kF,KAAV,EAAiBykF,SAAjB,EAA4BjgF,MAA5B,EAAoC;AAClD,QAAIzM,OAAO,GAAG0sF,SAAS,CAACzkF,KAAD,CAAvB;AACA,QAAIyE,IAAI,GAAG8/E,YAAY,CAAC//E,MAAD,CAAvB;AACA,WAAOzM,OAAO,CAACrK,OAAR,CAAgB,YAAY;AACjC,aAAO+W,IAAI,CAACzE,KAAD,CAAJ,GAAcnR,QAAQ,CAACrC,IAAT,EAAd,GAAgCg4F,UAAU,CAACxkF,KAAD,EAAQykF,SAAR,EAAmBhgF,IAAnB,CAAjD;AACD,KAFM,CAAP;AAGD,GAND;;AAQA,MAAImgF,MAAM,GAAGp0B,IAAb;;AACA,MAAIq0B,gCAAgC,GAAG,UAAU10B,EAAV,EAAcvvD,IAAd,EAAoB9X,IAApB,EAA0B;AAC/D,QAAIg8F,UAAU,GAAG30B,EAAE,CAACkB,SAAH,CAAa1/D,GAAb,CAAiB7I,IAAjB,CAAjB;;AACA,QAAIg8F,UAAJ,EAAgB;AACd,WAAK,IAAI56F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG46F,UAAU,CAAC96F,MAA/B,EAAuCE,CAAC,EAAxC,EAA4C;AAC1C,YAAI46F,UAAU,CAAC56F,CAAD,CAAV,CAAc66F,OAAd,KAA0B,KAA1B,IAAmC50B,EAAE,CAACnvD,GAAH,CAAO9T,EAAP,CAAU0T,IAAV,EAAgBkkF,UAAU,CAAC56F,CAAD,CAAV,CAAciY,QAA9B,CAAvC,EAAgF;AAC9E,iBAAO,IAAP;AACD;AACF;AACF;;AACD,WAAO,KAAP;AACD,GAVD;;AAWA,MAAI6iF,YAAY,GAAG,UAAUhpE,MAAV,EAAkBpb,IAAlB,EAAwB9X,IAAxB,EAA8BynE,IAA9B,EAAoC;AACrD,QAAIpyD,IAAI,GAAG6d,MAAM,CAAChb,GAAP,CAAWypC,OAAX,EAAX;;AACA,QAAI7pC,IAAI,KAAKzC,IAAb,EAAmB;AACjB,aAAO,KAAP;AACD;;AACDyC,IAAAA,IAAI,GAAGob,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqB3rC,IAArB,EAA2B,UAAUA,IAAV,EAAgB;AAChD,UAAIikF,gCAAgC,CAAC7oE,MAAD,EAASpb,IAAT,EAAe9X,IAAf,CAApC,EAA0D;AACxD,eAAO,IAAP;AACD;;AACD,aAAO8X,IAAI,CAAC0D,UAAL,KAAoBnG,IAApB,IAA4B,CAAC,CAAC8mF,SAAS,CAACjpE,MAAD,EAASpb,IAAT,EAAe9X,IAAf,EAAqBynE,IAArB,EAA2B,IAA3B,CAA9C;AACD,KALM,CAAP;AAMA,WAAO00B,SAAS,CAACjpE,MAAD,EAASpb,IAAT,EAAe9X,IAAf,EAAqBynE,IAArB,CAAhB;AACD,GAZD;;AAaA,MAAI20B,SAAS,GAAG,UAAUlkF,GAAV,EAAeJ,IAAf,EAAqBqwD,MAArB,EAA6B;AAC3C,QAAI2zB,MAAM,CAAChkF,IAAD,EAAOqwD,MAAM,CAACljC,MAAd,CAAV,EAAiC;AAC/B,aAAO,IAAP;AACD;;AACD,QAAI62D,MAAM,CAAChkF,IAAD,EAAOqwD,MAAM,CAAC5O,KAAd,CAAV,EAAgC;AAC9B,aAAO,IAAP;AACD;;AACD,QAAI4O,MAAM,CAAC9uD,QAAX,EAAqB;AACnB,aAAOvB,IAAI,CAACwB,QAAL,KAAkB,CAAlB,IAAuBpB,GAAG,CAAC9T,EAAJ,CAAO0T,IAAP,EAAaqwD,MAAM,CAAC9uD,QAApB,CAA9B;AACD;AACF,GAVD;;AAWA,MAAIgjF,UAAU,GAAG,UAAUnkF,GAAV,EAAeJ,IAAf,EAAqBqwD,MAArB,EAA6Bm0B,QAA7B,EAAuCC,OAAvC,EAAgD90B,IAAhD,EAAsD;AACrE,QAAIt9D,GAAJ,EAASvH,KAAT;AACA,QAAImS,KAAK,GAAGozD,MAAM,CAACm0B,QAAD,CAAlB;AACA,QAAIl7F,CAAJ;;AACA,QAAI+mE,MAAM,CAACq0B,OAAX,EAAoB;AAClB,aAAOr0B,MAAM,CAACq0B,OAAP,CAAe1kF,IAAf,EAAqBqwD,MAArB,EAA6Bm0B,QAA7B,CAAP;AACD;;AACD,QAAIvnF,KAAJ,EAAW;AACT,UAAI,OAAOA,KAAK,CAAC7T,MAAb,KAAwB,WAA5B,EAAyC;AACvC,aAAKiJ,GAAL,IAAY4K,KAAZ,EAAmB;AACjB,cAAIA,KAAK,CAAC7L,cAAN,CAAqBiB,GAArB,CAAJ,EAA+B;AAC7B,gBAAImyF,QAAQ,KAAK,YAAjB,EAA+B;AAC7B15F,cAAAA,KAAK,GAAGsV,GAAG,CAAC2pC,SAAJ,CAAc/pC,IAAd,EAAoB3N,GAApB,CAAR;AACD,aAFD,MAEO;AACLvH,cAAAA,KAAK,GAAGqgD,QAAQ,CAAC/qC,GAAD,EAAMJ,IAAN,EAAY3N,GAAZ,CAAhB;AACD;;AACD,gBAAIoyF,OAAO,IAAI,CAAC35F,KAAZ,IAAqB,CAACulE,MAAM,CAACsV,KAAjC,EAAwC;AACtC;AACD;;AACD,gBAAI,CAAC,CAAC8e,OAAD,IAAYp0B,MAAM,CAACsV,KAApB,KAA8B,CAACqe,MAAM,CAACl5F,KAAD,EAAQglE,mBAAmB,CAAC1vD,GAAD,EAAMsvD,WAAW,CAACzyD,KAAK,CAAC5K,GAAD,CAAN,EAAas9D,IAAb,CAAjB,EAAqCt9D,GAArC,CAA3B,CAAzC,EAAgH;AAC9G;AACD;AACF;AACF;AACF,OAhBD,MAgBO;AACL,aAAK/I,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG2T,KAAK,CAAC7T,MAAtB,EAA8BE,CAAC,EAA/B,EAAmC;AACjC,cAAIk7F,QAAQ,KAAK,YAAb,GAA4BpkF,GAAG,CAAC2pC,SAAJ,CAAc/pC,IAAd,EAAoB/C,KAAK,CAAC3T,CAAD,CAAzB,CAA5B,GAA4D6hD,QAAQ,CAAC/qC,GAAD,EAAMJ,IAAN,EAAY/C,KAAK,CAAC3T,CAAD,CAAjB,CAAxE,EAA+F;AAC7F,mBAAO+mE,MAAP;AACD;AACF;AACF;AACF;;AACD,WAAOA,MAAP;AACD,GAjCD;;AAkCA,MAAIg0B,SAAS,GAAG,UAAU90B,EAAV,EAAcvvD,IAAd,EAAoB9X,IAApB,EAA0BynE,IAA1B,EAAgC80B,OAAhC,EAAyC;AACvD,QAAIP,UAAU,GAAG30B,EAAE,CAACkB,SAAH,CAAa1/D,GAAb,CAAiB7I,IAAjB,CAAjB;AACA,QAAImoE,MAAJ,EAAY/mE,CAAZ,EAAe3B,CAAf,EAAkBqwD,OAAlB;AACA,QAAI53C,GAAG,GAAGmvD,EAAE,CAACnvD,GAAb;;AACA,QAAI8jF,UAAU,IAAIlkF,IAAlB,EAAwB;AACtB,WAAK1W,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG46F,UAAU,CAAC96F,MAA3B,EAAmCE,CAAC,EAApC,EAAwC;AACtC+mE,QAAAA,MAAM,GAAG6zB,UAAU,CAAC56F,CAAD,CAAnB;;AACA,YAAIg7F,SAAS,CAAC/0B,EAAE,CAACnvD,GAAJ,EAASJ,IAAT,EAAeqwD,MAAf,CAAT,IAAmCk0B,UAAU,CAACnkF,GAAD,EAAMJ,IAAN,EAAYqwD,MAAZ,EAAoB,YAApB,EAAkCo0B,OAAlC,EAA2C90B,IAA3C,CAA7C,IAAiG40B,UAAU,CAACnkF,GAAD,EAAMJ,IAAN,EAAYqwD,MAAZ,EAAoB,QAApB,EAA8Bo0B,OAA9B,EAAuC90B,IAAvC,CAA/G,EAA6J;AAC3J,cAAI3X,OAAO,GAAGqY,MAAM,CAACrY,OAArB,EAA8B;AAC5B,iBAAKrwD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGqwD,OAAO,CAAC5uD,MAAxB,EAAgCzB,CAAC,EAAjC,EAAqC;AACnC,kBAAI,CAAC4nE,EAAE,CAACnvD,GAAH,CAAOykC,QAAP,CAAgB7kC,IAAhB,EAAsBg4C,OAAO,CAACrwD,CAAD,CAA7B,CAAL,EAAwC;AACtC;AACD;AACF;AACF;;AACD,iBAAO0oE,MAAP;AACD;AACF;AACF;AACF,GAnBD;;AAoBA,MAAIvyD,KAAK,GAAG,UAAUsd,MAAV,EAAkBlzB,IAAlB,EAAwBynE,IAAxB,EAA8B3vD,IAA9B,EAAoC;AAC9C,QAAIA,IAAJ,EAAU;AACR,aAAOokF,YAAY,CAAChpE,MAAD,EAASpb,IAAT,EAAe9X,IAAf,EAAqBynE,IAArB,CAAnB;AACD;;AACD3vD,IAAAA,IAAI,GAAGob,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,EAAP;;AACA,QAAI0pC,YAAY,CAAChpE,MAAD,EAASpb,IAAT,EAAe9X,IAAf,EAAqBynE,IAArB,CAAhB,EAA4C;AAC1C,aAAO,IAAP;AACD;;AACD,QAAIhxC,SAAS,GAAGvD,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,EAAhB;;AACA,QAAIn/C,SAAS,KAAK3e,IAAlB,EAAwB;AACtB,UAAIokF,YAAY,CAAChpE,MAAD,EAASuD,SAAT,EAAoBz2B,IAApB,EAA0BynE,IAA1B,CAAhB,EAAiD;AAC/C,eAAO,IAAP;AACD;AACF;;AACD,WAAO,KAAP;AACD,GAfD;;AAgBA,MAAIg1B,QAAQ,GAAG,UAAUvpE,MAAV,EAAkB7Q,KAAlB,EAAyBolD,IAAzB,EAA+B;AAC5C,QAAIi1B,kBAAkB,GAAG,EAAzB;AACA,QAAIC,UAAU,GAAG,EAAjB;AACA,QAAI1hB,YAAY,GAAG/nD,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,EAAnB;AACA1iD,IAAAA,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqBw3B,YAArB,EAAmC,UAAUnjE,IAAV,EAAgB;AACjD,WAAK,IAAI1W,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGihB,KAAK,CAACnhB,MAA1B,EAAkCE,CAAC,EAAnC,EAAuC;AACrC,YAAIkV,MAAM,GAAG+L,KAAK,CAACjhB,CAAD,CAAlB;;AACA,YAAI,CAACu7F,UAAU,CAACrmF,MAAD,CAAX,IAAuB6lF,SAAS,CAACjpE,MAAD,EAASpb,IAAT,EAAexB,MAAf,EAAuBmxD,IAAvB,CAApC,EAAkE;AAChEk1B,UAAAA,UAAU,CAACrmF,MAAD,CAAV,GAAqB,IAArB;AACAomF,UAAAA,kBAAkB,CAACx1F,IAAnB,CAAwBoP,MAAxB;AACD;AACF;AACF,KARD,EAQG4c,MAAM,CAAChb,GAAP,CAAWypC,OAAX,EARH;AASA,WAAO+6C,kBAAP;AACD,GAdD;;AAeA,MAAIE,SAAS,GAAG,UAAU1pE,MAAV,EAAkB7Q,KAAlB,EAAyB;AACvC,QAAI3G,MAAM,GAAG,UAAUuK,GAAV,EAAe;AAC1B,aAAOhM,IAAI,CAACgM,GAAD,EAAM3N,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAN,CAAX;AACD,KAFD;;AAGA,QAAI13C,KAAK,GAAG,UAAUqQ,GAAV,EAAejmB,IAAf,EAAqB;AAC/B,aAAOm8F,SAAS,CAACjpE,MAAD,EAASjN,GAAG,CAAC/N,GAAb,EAAkBlY,IAAlB,CAAT,GAAmC+F,QAAQ,CAACR,IAAT,CAAcvF,IAAd,CAAnC,GAAyD+F,QAAQ,CAACrC,IAAT,EAAhE;AACD,KAFD;;AAGA,WAAOqC,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,CAA0B,IAA1B,CAAd,EAA+C7wE,IAA/C,CAAoD,UAAU83F,MAAV,EAAkB;AAC3E,aAAOhB,SAAS,CAACvjF,YAAY,CAACX,OAAb,CAAqBklF,MAArB,CAAD,EAA+B,UAAU52E,GAAV,EAAe;AAC5D,eAAOhd,OAAO,CAACoZ,KAAD,EAAQ,UAAUriB,IAAV,EAAgB;AACpC,iBAAO4V,KAAK,CAACqQ,GAAD,EAAMjmB,IAAN,CAAZ;AACD,SAFa,CAAd;AAGD,OAJe,EAIb0b,MAJa,CAAhB;AAKD,KANM,EAMJjX,SANI,EAAP;AAOD,GAdD;;AAeA,MAAIq4F,QAAQ,GAAG,UAAU5pE,MAAV,EAAkBlzB,IAAlB,EAAwB;AACrC,QAAIg8F,UAAU,GAAG9oE,MAAM,CAACq1C,SAAP,CAAiB1/D,GAAjB,CAAqB7I,IAArB,CAAjB;AACA,QAAIy2B,SAAJ,EAAehb,OAAf,EAAwBra,CAAxB,EAA2B3B,CAA3B,EAA8B4Z,QAA9B;AACA,QAAInB,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;;AACA,QAAI8jF,UAAJ,EAAgB;AACdvlE,MAAAA,SAAS,GAAGvD,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,EAAZ;AACAn6D,MAAAA,OAAO,GAAGssD,YAAY,CAAC7vD,GAAD,EAAMue,SAAN,CAAtB;;AACA,WAAKh3B,CAAC,GAAGu8F,UAAU,CAAC96F,MAAX,GAAoB,CAA7B,EAAgCzB,CAAC,IAAI,CAArC,EAAwCA,CAAC,EAAzC,EAA6C;AAC3C4Z,QAAAA,QAAQ,GAAG2iF,UAAU,CAACv8F,CAAD,CAAV,CAAc4Z,QAAzB;;AACA,YAAI,CAACA,QAAD,IAAa2iF,UAAU,CAACv8F,CAAD,CAAV,CAAcs9F,YAA/B,EAA6C;AAC3C,iBAAO,IAAP;AACD;;AACD,aAAK37F,CAAC,GAAGqa,OAAO,CAACva,MAAR,GAAiB,CAA1B,EAA6BE,CAAC,IAAI,CAAlC,EAAqCA,CAAC,EAAtC,EAA0C;AACxC,cAAI8W,GAAG,CAAC9T,EAAJ,CAAOqX,OAAO,CAACra,CAAD,CAAd,EAAmBiY,QAAnB,CAAJ,EAAkC;AAChC,mBAAO,IAAP;AACD;AACF;AACF;AACF;;AACD,WAAO,KAAP;AACD,GApBD;;AAqBA,MAAI2jF,cAAc,GAAG,UAAU9pE,MAAV,EAAkBpb,IAAlB,EAAwBmlF,WAAxB,EAAqC;AACxD,WAAOl1F,KAAK,CAACk1F,WAAD,EAAc,UAAUn1F,GAAV,EAAe9H,IAAf,EAAqB;AAC7C,UAAIk9F,YAAY,GAAGl1B,oBAAoB,CAAC90C,MAAD,EAASlzB,IAAT,CAAvC;;AACA,UAAIkzB,MAAM,CAACq1C,SAAP,CAAiB4zB,SAAjB,CAA2BrkF,IAA3B,EAAiC9X,IAAjC,EAAuC,EAAvC,EAA2Ck9F,YAA3C,CAAJ,EAA8D;AAC5D,eAAOp1F,GAAG,CAAC3E,MAAJ,CAAW,CAACnD,IAAD,CAAX,CAAP;AACD,OAFD,MAEO;AACL,eAAO8H,GAAP;AACD;AACF,KAPW,EAOT,EAPS,CAAZ;AAQD,GATD;;AAWA,MAAIq1F,MAAM,GAAGrkE,IAAb;AAAA,MAAmBskE,UAAU,GAAG,YAAhC;;AACA,MAAIC,UAAU,GAAG,UAAUliF,aAAV,EAAyBrD,IAAzB,EAA+B;AAC9C,WAAOqD,aAAa,CAACkiF,UAAd,CAAyBvlF,IAAzB,EAA+B,IAA/B,CAAP;AACD,GAFD;;AAGA,MAAIwlF,uBAAuB,GAAG,UAAUxlF,IAAV,EAAgB;AAC5C,QAAIiO,KAAK,GAAG,EAAZ;;AACA,WAAOjO,IAAP,EAAa;AACX,UAAIA,IAAI,CAACwB,QAAL,KAAkB,CAAlB,IAAuBxB,IAAI,CAAC49B,SAAL,KAAmBynD,MAA1C,IAAoDrlF,IAAI,CAACN,UAAL,CAAgBtW,MAAhB,GAAyB,CAAjF,EAAoF;AAClF,eAAO,EAAP;AACD;;AACD,UAAI4W,IAAI,CAACwB,QAAL,KAAkB,CAAtB,EAAyB;AACvByM,QAAAA,KAAK,CAAC7e,IAAN,CAAW4Q,IAAX;AACD;;AACDA,MAAAA,IAAI,GAAGA,IAAI,CAAC2E,UAAZ;AACD;;AACD,WAAOsJ,KAAP;AACD,GAZD;;AAaA,MAAIw3E,qBAAqB,GAAG,UAAUzlF,IAAV,EAAgB;AAC1C,WAAOwlF,uBAAuB,CAACxlF,IAAD,CAAvB,CAA8B5W,MAA9B,GAAuC,CAA9C;AACD,GAFD;;AAGA,MAAIs8F,iBAAiB,GAAG,UAAU1lF,IAAV,EAAgB;AACtC,QAAIA,IAAJ,EAAU;AACR,UAAI8kB,MAAM,GAAG,IAAIpG,aAAJ,CAAkB1e,IAAlB,EAAwBA,IAAxB,CAAb;;AACA,WAAKA,IAAI,GAAG8kB,MAAM,CAAC3tB,OAAP,EAAZ,EAA8B6I,IAA9B,EAAoCA,IAAI,GAAG8kB,MAAM,CAACjG,IAAP,EAA3C,EAA0D;AACxD,YAAIpT,QAAQ,CAACzL,IAAD,CAAZ,EAAoB;AAClB,iBAAOA,IAAP;AACD;AACF;AACF;;AACD,WAAO,IAAP;AACD,GAVD;;AAWA,MAAI2lF,oBAAoB,GAAG,UAAUC,IAAV,EAAgB;AACzC,QAAI9iE,cAAc,GAAGtiB,YAAY,CAACV,OAAb,CAAqB,MAArB,CAArB;AACA0M,IAAAA,MAAM,CAACsW,cAAD,EAAiB;AACrB,YAAMwiE,UADe;AAErB,wBAAkB,GAFG;AAGrB,uBAAiB;AAHI,KAAjB,CAAN;;AAKA,QAAIM,IAAJ,EAAU;AACRt/E,MAAAA,MAAM,CAACwc,cAAD,EAAiBtiB,YAAY,CAACP,QAAb,CAAsBolF,MAAtB,CAAjB,CAAN;AACD;;AACD,WAAOviE,cAAP;AACD,GAXD;;AAYA,MAAI+iE,0BAA0B,GAAG,UAAUx/B,kBAAV,EAA8B;AAC7D,QAAI3kC,QAAQ,GAAGgkE,iBAAiB,CAACr/B,kBAAD,CAAhC;;AACA,QAAI3kC,QAAQ,IAAIA,QAAQ,CAACkc,SAAT,CAAmB7b,MAAnB,CAA0B,CAA1B,MAAiCsjE,MAAjD,EAAyD;AACvD3jE,MAAAA,QAAQ,CAACkkC,UAAT,CAAoB,CAApB,EAAuB,CAAvB;AACD;;AACD,WAAOlkC,QAAP;AACD,GAND;;AAOA,MAAIokE,wBAAwB,GAAG,UAAU1qE,MAAV,EAAkBpb,IAAlB,EAAwB25E,SAAxB,EAAmC;AAChE,QAAIA,SAAS,KAAK,KAAK,CAAvB,EAA0B;AACxBA,MAAAA,SAAS,GAAG,IAAZ;AACD;;AACD,QAAIv5E,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AAAA,QAAsBk1C,SAAS,GAAGl6B,MAAM,CAACk6B,SAAzC;;AACA,QAAImwC,qBAAqB,CAACzlF,IAAD,CAAzB,EAAiC;AAC/B05E,MAAAA,aAAa,CAACt+D,MAAD,EAAS,KAAT,EAAgB5a,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAhB,EAA4C25E,SAA5C,CAAb;AACD,KAFD,MAEO;AACL,UAAItkC,GAAG,GAAGC,SAAS,CAACC,MAAV,EAAV;AACA,UAAIkM,KAAK,GAAGrhD,GAAG,CAACurC,SAAJ,CAAc3rC,IAAd,EAAoBI,GAAG,CAAC4f,OAAxB,CAAZ;AACA,UAAIgD,cAAc,GAAGqyB,GAAG,CAACryB,cAAzB;AACA,UAAIksB,WAAW,GAAGmG,GAAG,CAACnG,WAAtB;AACA,UAAIC,YAAY,GAAGkG,GAAG,CAAClG,YAAvB;AACA,UAAIC,SAAS,GAAGiG,GAAG,CAACjG,SAApB;AACA,UAAI1tB,QAAQ,GAAGmkE,0BAA0B,CAAC7lF,IAAD,CAAzC;AACAI,MAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX,EAAiB,IAAjB;;AACA,UAAIgjB,cAAc,KAAKtB,QAAnB,IAA+BwtB,WAAW,GAAG,CAAjD,EAAoD;AAClDmG,QAAAA,GAAG,CAAC5G,QAAJ,CAAa/sB,QAAb,EAAuBwtB,WAAW,GAAG,CAArC;AACD;;AACD,UAAIC,YAAY,KAAKztB,QAAjB,IAA6B0tB,SAAS,GAAG,CAA7C,EAAgD;AAC9CiG,QAAAA,GAAG,CAAC3G,MAAJ,CAAWhtB,QAAX,EAAqB0tB,SAAS,GAAG,CAAjC;AACD;;AACD,UAAIqS,KAAK,IAAIrhD,GAAG,CAAC2kB,OAAJ,CAAY08B,KAAZ,CAAb,EAAiC;AAC/B4yB,QAAAA,iBAAiB,CAAC7zE,YAAY,CAACX,OAAb,CAAqB4hD,KAArB,CAAD,CAAjB;AACD;;AACDnM,MAAAA,SAAS,CAACiZ,MAAV,CAAiBlZ,GAAjB;AACD;AACF,GA3BD;;AA4BA,MAAI0wC,oBAAoB,GAAG,UAAU3qE,MAAV,EAAkBpb,IAAlB,EAAwB25E,SAAxB,EAAmC;AAC5D,QAAIA,SAAS,KAAK,KAAK,CAAvB,EAA0B;AACxBA,MAAAA,SAAS,GAAG,IAAZ;AACD;;AACD,QAAIv5E,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AAAA,QAAsBk1C,SAAS,GAAGl6B,MAAM,CAACk6B,SAAzC;;AACA,QAAI,CAACt1C,IAAL,EAAW;AACTA,MAAAA,IAAI,GAAG8sD,uBAAuB,CAAC1xC,MAAM,CAACo6B,OAAP,EAAD,EAAmBF,SAAS,CAACwoB,QAAV,EAAnB,CAA9B;;AACA,UAAI,CAAC99D,IAAL,EAAW;AACT,eAAOA,IAAI,GAAGI,GAAG,CAACrP,GAAJ,CAAQu0F,UAAR,CAAd,EAAmC;AACjCQ,UAAAA,wBAAwB,CAAC1qE,MAAD,EAASpb,IAAT,EAAe,KAAf,CAAxB;AACD;AACF;AACF,KAPD,MAOO;AACL8lF,MAAAA,wBAAwB,CAAC1qE,MAAD,EAASpb,IAAT,EAAe25E,SAAf,CAAxB;AACD;AACF,GAfD;;AAgBA,MAAIqM,wBAAwB,GAAG,UAAU5qE,MAAV,EAAkB0H,cAAlB,EAAkCmjE,UAAlC,EAA8C;AAC3E,QAAI7lF,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AAAA,QAAsBqhD,KAAK,GAAGrhD,GAAG,CAACurC,SAAJ,CAAcs6C,UAAd,EAA0Bj7F,KAAK,CAACskE,aAAD,EAAgBl0C,MAAhB,CAA/B,CAA9B;;AACA,QAAIqmC,KAAK,IAAIrhD,GAAG,CAAC2kB,OAAJ,CAAY08B,KAAZ,CAAb,EAAiC;AAC/BwkC,MAAAA,UAAU,CAACviF,UAAX,CAAsBgqC,YAAtB,CAAmC5qB,cAAnC,EAAmDmjE,UAAnD;AACD,KAFD,MAEO;AACL9R,MAAAA,gBAAgB,CAAC3zE,YAAY,CAACX,OAAb,CAAqBomF,UAArB,CAAD,CAAhB;;AACA,UAAI7lF,GAAG,CAAC2kB,OAAJ,CAAYkhE,UAAZ,CAAJ,EAA6B;AAC3BA,QAAAA,UAAU,CAACviF,UAAX,CAAsBgqC,YAAtB,CAAmC5qB,cAAnC,EAAmDmjE,UAAnD;AACD,OAFD,MAEO;AACL7lF,QAAAA,GAAG,CAACktC,WAAJ,CAAgBxqB,cAAhB,EAAgCmjE,UAAhC;AACD;AACF;AACF,GAZD;;AAaA,MAAIC,UAAU,GAAG,UAAUxiF,UAAV,EAAsB1D,IAAtB,EAA4B;AAC3C0D,IAAAA,UAAU,CAAC+C,WAAX,CAAuBzG,IAAvB;AACA,WAAOA,IAAP;AACD,GAHD;;AAIA,MAAImmF,mCAAmC,GAAG,UAAUC,WAAV,EAAuBtjE,cAAvB,EAAuC;AAC/E,QAAIujE,mBAAmB,GAAGt2F,KAAK,CAACq2F,WAAD,EAAc,UAAU1iF,UAAV,EAAsBuiF,UAAtB,EAAkC;AAC7E,aAAOC,UAAU,CAACxiF,UAAD,EAAauiF,UAAU,CAAChhD,SAAX,CAAqB,KAArB,CAAb,CAAjB;AACD,KAF8B,EAE5BniB,cAF4B,CAA/B;AAGA,WAAOojE,UAAU,CAACG,mBAAD,EAAsBA,mBAAmB,CAAChjF,aAApB,CAAkClD,cAAlC,CAAiDklF,MAAjD,CAAtB,CAAjB;AACD,GALD;;AAMA,MAAIiB,eAAe,GAAG,UAAUlrE,MAAV,EAAkB0H,cAAlB,EAAkCmjE,UAAlC,EAA8C/9F,IAA9C,EAAoDynE,IAApD,EAA0D80B,OAA1D,EAAmE;AACvF,QAAIh0B,SAAS,GAAGr1C,MAAM,CAACq1C,SAAvB;AACA,QAAIrwD,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,QAAImmF,YAAY,GAAGn5F,MAAM,CAACzD,IAAI,CAAC8mE,SAAS,CAAC1/D,GAAV,EAAD,CAAL,EAAwB,UAAUo/D,UAAV,EAAsB;AACrE,aAAOA,UAAU,KAAKjoE,IAAf,IAAuB,CAAC+P,UAAU,CAACk4D,UAAD,EAAa,cAAb,CAAzC;AACD,KAFwB,CAAzB;AAGA,QAAIq2B,cAAc,GAAGtB,cAAc,CAAC9pE,MAAD,EAAS6qE,UAAT,EAAqBM,YAArB,CAAnC;AACA,QAAIE,aAAa,GAAGr5F,MAAM,CAACo5F,cAAD,EAAiB,UAAUE,OAAV,EAAmB;AAC5D,aAAO,CAACh2B,iBAAiB,CAACt1C,MAAD,EAASsrE,OAAT,EAAkBx+F,IAAlB,CAAzB;AACD,KAFyB,CAA1B;;AAGA,QAAIu+F,aAAa,CAACr9F,MAAd,GAAuB,CAA3B,EAA8B;AAC5B,UAAIu9F,gBAAgB,GAAGV,UAAU,CAAChhD,SAAX,CAAqB,KAArB,CAAvB;AACA7kC,MAAAA,GAAG,CAACqoB,GAAJ,CAAQ3F,cAAR,EAAwB6jE,gBAAxB;AACAl2B,MAAAA,SAAS,CAACxpD,MAAV,CAAiB/e,IAAjB,EAAuBynE,IAAvB,EAA6Bg3B,gBAA7B,EAA+ClC,OAA/C;AACArkF,MAAAA,GAAG,CAAC6G,MAAJ,CAAW0/E,gBAAX;AACA,aAAO14F,QAAQ,CAACR,IAAT,CAAck5F,gBAAd,CAAP;AACD,KAND,MAMO;AACL,aAAO14F,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF,GAnBD;;AAoBA,MAAIg7F,gBAAgB,GAAG,UAAUxrE,MAAV,EAAkBlzB,IAAlB,EAAwBynE,IAAxB,EAA8B;AACnD,QAAI7sC,cAAJ,EAAoBpB,QAApB;AACA,QAAI4zB,SAAS,GAAGl6B,MAAM,CAACk6B,SAAvB;AACA,QAAI6hB,YAAY,GAAG7hB,SAAS,CAACC,MAAV,EAAnB;AACA,QAAIvzB,MAAM,GAAGm1C,YAAY,CAACjoB,WAA1B;AACA,QAAIxyC,SAAS,GAAGy6D,YAAY,CAACn0C,cAA7B;AACA,QAAI9iB,IAAI,GAAGxD,SAAS,CAACkhC,SAArB;AACA9a,IAAAA,cAAc,GAAGgqC,uBAAuB,CAAC1xC,MAAM,CAACo6B,OAAP,EAAD,EAAmBF,SAAS,CAACwoB,QAAV,EAAnB,CAAxC;;AACA,QAAIh7C,cAAJ,EAAoB;AAClBpB,MAAAA,QAAQ,GAAGgkE,iBAAiB,CAAC5iE,cAAD,CAA5B;AACD;;AACD,QAAI+jE,aAAa,GAAG,+BAApB;;AACA,QAAI3mF,IAAI,IAAI8hB,MAAM,GAAG,CAAjB,IAAsBA,MAAM,GAAG9hB,IAAI,CAAC9W,MAApC,IAA8Cy9F,aAAa,CAAC5xF,IAAd,CAAmBiL,IAAI,CAAC6hB,MAAL,CAAYC,MAAZ,CAAnB,CAA9C,IAAyF6kE,aAAa,CAAC5xF,IAAd,CAAmBiL,IAAI,CAAC6hB,MAAL,CAAYC,MAAM,GAAG,CAArB,CAAnB,CAA7F,EAA0I;AACxI,UAAIu9B,QAAQ,GAAGjK,SAAS,CAACoL,WAAV,EAAf;AACAyW,MAAAA,YAAY,CAACtd,QAAb,CAAsB,IAAtB;AACA,UAAIxE,GAAG,GAAGwd,SAAS,CAACz3C,MAAD,EAAS+7C,YAAT,EAAuB/7C,MAAM,CAACq1C,SAAP,CAAiB1/D,GAAjB,CAAqB7I,IAArB,CAAvB,CAAnB;AACAmtD,MAAAA,GAAG,GAAGkrB,OAAO,CAAClrB,GAAD,CAAb;AACAj6B,MAAAA,MAAM,CAACq1C,SAAP,CAAiBjmE,KAAjB,CAAuBtC,IAAvB,EAA6BynE,IAA7B,EAAmCta,GAAnC;AACAC,MAAAA,SAAS,CAACkL,cAAV,CAAyBjB,QAAzB;AACD,KAPD,MAOO;AACL,UAAI,CAACz8B,cAAD,IAAmBpB,QAAQ,CAACkc,SAAT,KAAuBynD,MAA9C,EAAsD;AACpDviE,QAAAA,cAAc,GAAGyiE,UAAU,CAACnqE,MAAM,CAACm7C,MAAP,EAAD,EAAkBovB,oBAAoB,CAAC,IAAD,CAApB,CAA2BvlF,GAA7C,CAA3B;AACAshB,QAAAA,QAAQ,GAAGoB,cAAc,CAACne,UAA1B;AACAwyD,QAAAA,YAAY,CAACxZ,UAAb,CAAwB76B,cAAxB;AACAd,QAAAA,MAAM,GAAG,CAAT;AACA5G,QAAAA,MAAM,CAACq1C,SAAP,CAAiBjmE,KAAjB,CAAuBtC,IAAvB,EAA6BynE,IAA7B,EAAmC7sC,cAAnC;AACD,OAND,MAMO;AACL1H,QAAAA,MAAM,CAACq1C,SAAP,CAAiBjmE,KAAjB,CAAuBtC,IAAvB,EAA6BynE,IAA7B,EAAmC7sC,cAAnC;AACD;;AACDwyB,MAAAA,SAAS,CAAC0kC,iBAAV,CAA4Bt4D,QAA5B,EAAsCM,MAAtC;AACD;AACF,GA/BD;;AAgCA,MAAI8kE,iBAAiB,GAAG,UAAU1rE,MAAV,EAAkBlzB,IAAlB,EAAwBynE,IAAxB,EAA8B80B,OAA9B,EAAuC;AAC7D,QAAIrkF,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,QAAIk1C,SAAS,GAAGl6B,MAAM,CAACk6B,SAAvB;AACA,QAAIyxC,eAAJ,EAAqB/mF,IAArB,EAA2BimF,UAA3B;AACA,QAAItiF,OAAO,GAAG,EAAd;AACA,QAAI0xC,GAAG,GAAGC,SAAS,CAACC,MAAV,EAAV;AACA,QAAI74C,SAAS,GAAG24C,GAAG,CAACryB,cAApB;AACA,QAAIhB,MAAM,GAAGqzB,GAAG,CAACnG,WAAjB;AACAlvC,IAAAA,IAAI,GAAGtD,SAAP;;AACA,QAAIA,SAAS,CAAC8E,QAAV,KAAuB,CAA3B,EAA8B;AAC5B,UAAIwgB,MAAM,KAAKtlB,SAAS,CAACkhC,SAAV,CAAoBx0C,MAAnC,EAA2C;AACzC29F,QAAAA,eAAe,GAAG,IAAlB;AACD;;AACD/mF,MAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,WAAO1D,IAAP,EAAa;AACX,UAAIqkF,SAAS,CAACjpE,MAAD,EAASpb,IAAT,EAAe9X,IAAf,EAAqBynE,IAArB,EAA2B80B,OAA3B,CAAb,EAAkD;AAChDwB,QAAAA,UAAU,GAAGjmF,IAAb;AACA;AACD;;AACD,UAAIA,IAAI,CAACsE,WAAT,EAAsB;AACpByiF,QAAAA,eAAe,GAAG,IAAlB;AACD;;AACDpjF,MAAAA,OAAO,CAACvU,IAAR,CAAa4Q,IAAb;AACAA,MAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,QAAI,CAACuiF,UAAL,EAAiB;AACf;AACD;;AACD,QAAIc,eAAJ,EAAqB;AACnB,UAAIxnC,QAAQ,GAAGjK,SAAS,CAACoL,WAAV,EAAf;AACArL,MAAAA,GAAG,CAACwE,QAAJ,CAAa,IAAb;AACA,UAAImtC,WAAW,GAAGn0B,SAAS,CAACz3C,MAAD,EAASi6B,GAAT,EAAcj6B,MAAM,CAACq1C,SAAP,CAAiB1/D,GAAjB,CAAqB7I,IAArB,CAAd,EAA0C,IAA1C,CAA3B;AACA8+F,MAAAA,WAAW,GAAGzmB,OAAO,CAACymB,WAAD,CAArB;AACA5rE,MAAAA,MAAM,CAACq1C,SAAP,CAAiBxpD,MAAjB,CAAwB/e,IAAxB,EAA8BynE,IAA9B,EAAoCq3B,WAApC,EAAiDvC,OAAjD;AACAnvC,MAAAA,SAAS,CAACkL,cAAV,CAAyBjB,QAAzB;AACD,KAPD,MAOO;AACL,UAAIz8B,cAAc,GAAGgqC,uBAAuB,CAAC1xC,MAAM,CAACo6B,OAAP,EAAD,EAAmBywC,UAAnB,CAA5C;AACA,UAAIgB,iBAAiB,GAAGtB,oBAAoB,CAAC,KAAD,CAApB,CAA4BvlF,GAApD;AACA4lF,MAAAA,wBAAwB,CAAC5qE,MAAD,EAAS6rE,iBAAT,EAA4BnkE,cAAc,KAAK,IAAnB,GAA0BA,cAA1B,GAA2CmjE,UAAvE,CAAxB;AACA,UAAIiB,iBAAiB,GAAGZ,eAAe,CAAClrE,MAAD,EAAS6rE,iBAAT,EAA4BhB,UAA5B,EAAwC/9F,IAAxC,EAA8CynE,IAA9C,EAAoD80B,OAApD,CAAvC;AACA,UAAI0C,aAAa,GAAGhB,mCAAmC,CAACxiF,OAAO,CAACtY,MAAR,CAAe67F,iBAAiB,CAAC35F,OAAlB,EAAf,CAAD,EAA8C05F,iBAA9C,CAAvD;AACAnB,MAAAA,wBAAwB,CAAC1qE,MAAD,EAAS0H,cAAT,EAAyB,KAAzB,CAAxB;AACAwyB,MAAAA,SAAS,CAAC0kC,iBAAV,CAA4BmN,aAA5B,EAA2C,CAA3C;;AACA,UAAI/mF,GAAG,CAAC2kB,OAAJ,CAAYkhE,UAAZ,CAAJ,EAA6B;AAC3B7lF,QAAAA,GAAG,CAAC6G,MAAJ,CAAWg/E,UAAX;AACD;AACF;AACF,GAhDD;;AAiDA,MAAImB,qBAAqB,GAAG,UAAUhsE,MAAV,EAAkBisE,OAAlB,EAA2B;AACrD,QAAI/xC,SAAS,GAAGl6B,MAAM,CAACk6B,SAAvB;AAAA,QAAkChuC,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAAzC;AACAuwC,IAAAA,oBAAoB,CAAC3qE,MAAD,EAAS,IAAT,EAAe,KAAf,CAApB;;AACA,QAAI,CAACisE,OAAO,KAAK,CAAZ,IAAiBA,OAAO,KAAK,EAA9B,KAAqC/xC,SAAS,CAACkK,WAAV,EAArC,IAAgElK,SAAS,CAACwoB,QAAV,GAAqBt+D,SAArB,KAAmC6lF,MAAvG,EAA+G;AAC7GU,MAAAA,oBAAoB,CAAC3qE,MAAD,EAAS0xC,uBAAuB,CAACxlD,IAAD,EAAOguC,SAAS,CAACwoB,QAAV,EAAP,CAAhC,CAApB;AACD;;AACD,QAAIupB,OAAO,KAAK,EAAZ,IAAkBA,OAAO,KAAK,EAAlC,EAAsC;AACpCtB,MAAAA,oBAAoB,CAAC3qE,MAAD,EAAS0xC,uBAAuB,CAACxlD,IAAD,EAAOguC,SAAS,CAACwoB,QAAV,EAAP,CAAhC,CAApB;AACD;AACF,GATD;;AAUA,MAAIwpB,OAAO,GAAG,UAAUlsE,MAAV,EAAkB;AAC9BA,IAAAA,MAAM,CAAClK,EAAP,CAAU,iBAAV,EAA6B,UAAUjd,CAAV,EAAa;AACxCmzF,MAAAA,qBAAqB,CAAChsE,MAAD,EAASnnB,CAAC,CAACozF,OAAX,CAArB;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIE,sBAAsB,GAAG,UAAU5iE,UAAV,EAAsByhE,WAAtB,EAAmC;AAC9D,QAAItjE,cAAc,GAAG6iE,oBAAoB,CAAC,KAAD,CAAzC;AACA,QAAI6B,SAAS,GAAGrB,mCAAmC,CAACC,WAAD,EAActjE,cAAc,CAAC1iB,GAA7B,CAAnD;AACA4F,IAAAA,MAAM,CAACxF,YAAY,CAACX,OAAb,CAAqB8kB,UAArB,CAAD,EAAmC7B,cAAnC,CAAN;AACA7b,IAAAA,MAAM,CAACzG,YAAY,CAACX,OAAb,CAAqB8kB,UAArB,CAAD,CAAN;AACA,WAAOs4B,aAAa,CAACuqC,SAAD,EAAY,CAAZ,CAApB;AACD,GAND;;AAOA,MAAIC,eAAe,GAAG,UAAUrsE,MAAV,EAAkB9Z,OAAlB,EAA2B;AAC/C,QAAIomF,cAAc,GAAGtsE,MAAM,CAAC8M,MAAP,CAAcgH,qBAAd,EAArB;AACA,WAAOw4D,cAAc,CAACt2F,cAAf,CAA8BlJ,IAAI,CAACoZ,OAAD,CAAlC,KAAgD,CAACurD,WAAW,CAACvrD,OAAO,CAAClB,GAAT,CAA5D,IAA6E,CAAC+K,OAAO,CAAC7J,OAAO,CAAClB,GAAT,CAA5F;AACD,GAHD;;AAIA,MAAIunF,yBAAyB,GAAG,UAAUrmF,OAAV,EAAmB;AACjD,WAAOurD,WAAW,CAACvrD,OAAO,CAAClB,GAAT,CAAX,IAA4BqlF,qBAAqB,CAACnkF,OAAO,CAAClB,GAAT,CAAxD;AACD,GAFD;;AAIA,MAAIwnF,gBAAgB,GAAG,EAAvB;AACA,MAAIC,QAAQ,GAAG10F,QAAf;AACA,MAAI20F,MAAM,GAAGl1F,MAAb;;AACA,MAAIm1F,kBAAkB,GAAG,UAAU7/F,IAAV,EAAgBi+C,IAAhB,EAAsB;AAC7C,QAAI6hD,KAAK,GAAGJ,gBAAgB,CAAC1/F,IAAD,CAA5B;;AACA,QAAI,CAAC8/F,KAAL,EAAY;AACVJ,MAAAA,gBAAgB,CAAC1/F,IAAD,CAAhB,GAAyB,EAAzB;AACD;;AACD0/F,IAAAA,gBAAgB,CAAC1/F,IAAD,CAAhB,CAAuBkH,IAAvB,CAA4B+2C,IAA5B;AACD,GAND;;AAOA,MAAI8hD,WAAW,GAAG,UAAU//F,IAAV,EAAgBkzB,MAAhB,EAAwB;AACxC0sE,IAAAA,MAAM,CAACF,gBAAgB,CAAC1/F,IAAD,CAAjB,EAAyB,UAAUi+C,IAAV,EAAgB;AAC7CA,MAAAA,IAAI,CAAC/qB,MAAD,CAAJ;AACD,KAFK,CAAN;AAGD,GAJD;;AAKA2sE,EAAAA,kBAAkB,CAAC,KAAD,EAAQ,UAAU3sE,MAAV,EAAkB;AAC1C,QAAIi6B,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AACA,QAAIl2B,MAAJ;;AACA,QAAI6oE,aAAa,GAAG,UAAUC,GAAV,EAAe;AACjC,aAAOC,KAAK,CAACD,GAAG,CAAC9jF,eAAL,CAAL,IAA8BjR,SAAS,CAACisB,MAAD,EAAS8oE,GAAG,CAAC9jF,eAAb,CAAT,KAA2C,CAAC,CAAjF;AACD,KAFD;;AAGA,QAAIgkF,OAAO,GAAG,UAAUC,IAAV,EAAgBC,IAAhB,EAAsB;AAClC5jD,MAAAA,QAAQ,CAAC4jD,IAAD,CAAR,CAAethF,MAAf;AACA09B,MAAAA,QAAQ,CAAC2jD,IAAD,CAAR,CAAehiF,MAAf,CAAsB,UAAtB,EAAkCA,MAAlC,CAAyCiiF,IAAI,CAAC7oF,UAA9C;AACD,KAHD;;AAIA,QAAI0oF,KAAK,GAAG99E,cAAc,CAAC,CAAC,KAAD,CAAD,CAA1B;;AACA,QAAI,CAAC+qC,GAAG,CAAC+K,SAAT,EAAoB;AAClB/gC,MAAAA,MAAM,GAAGjE,MAAM,CAACk6B,SAAP,CAAiBq1B,iBAAjB,EAAT;AACAmd,MAAAA,MAAM,CAACD,QAAQ,CAACA,QAAQ,CAACxoE,MAAD,EAAS+oE,KAAT,CAAT,EAA0BF,aAA1B,CAAT,EAAmD,UAAUC,GAAV,EAAe;AACtEE,QAAAA,OAAO,CAACF,GAAG,CAAC9jF,eAAL,EAAsB8jF,GAAtB,CAAP;AACD,OAFK,CAAN;AAGD;AACF,GAjBiB,CAAlB;AAmBA,MAAIK,MAAM,GAAG1pF,KAAK,CAAC9R,IAAnB;;AACA,MAAIy7F,aAAa,GAAG,UAAUzoF,IAAV,EAAgB;AAClC,WAAOqK,WAAW,CAACrK,IAAD,CAAX,IAAqB,CAACwuD,gBAAgB,CAACxuD,IAAD,CAAtC,IAAgD,CAAC6sD,WAAW,CAAC7sD,IAAD,CAA5D,IAAsE,CAACmL,OAAO,CAACnL,IAAD,CAArF;AACD,GAFD;;AAGA,MAAI0oF,kBAAkB,GAAG,UAAU1oF,IAAV,EAAgBof,WAAhB,EAA6B;AACpD,QAAI/Y,OAAJ;;AACA,SAAKA,OAAO,GAAGrG,IAAf,EAAqBqG,OAArB,EAA8BA,OAAO,GAAGA,OAAO,CAAC+Y,WAAD,CAA/C,EAA8D;AAC5D,UAAI3T,QAAQ,CAACpF,OAAD,CAAR,IAAqBA,OAAO,CAACu3B,SAAR,CAAkBx0C,MAAlB,KAA6B,CAAtD,EAAyD;AACvD,eAAO4W,IAAP;AACD;;AACD,UAAIqK,WAAW,CAAChE,OAAD,CAAX,IAAwB,CAACmoD,gBAAgB,CAACnoD,OAAD,CAA7C,EAAwD;AACtD,eAAOA,OAAP;AACD;AACF;;AACD,WAAOrG,IAAP;AACD,GAXD;;AAYA,MAAI2oF,kBAAkB,GAAG,UAAUvoF,GAAV,EAAe0e,IAAf,EAAqBD,IAArB,EAA2B;AAClD,QAAIxY,OAAJ,EAAauiF,UAAb;AACA,QAAIC,YAAY,GAAGnX,YAAY,CAACtxE,GAAD,CAA/B;;AACA,QAAI0e,IAAI,IAAID,IAAZ,EAAkB;AAChBC,MAAAA,IAAI,GAAG4pE,kBAAkB,CAAC5pE,IAAD,EAAO,iBAAP,CAAzB;AACAD,MAAAA,IAAI,GAAG6pE,kBAAkB,CAAC7pE,IAAD,EAAO,aAAP,CAAzB;;AACA,UAAIgqE,YAAY,CAAChsD,OAAb,CAAqB/d,IAArB,EAA2BD,IAA3B,CAAJ,EAAsC;AACpC,aAAKxY,OAAO,GAAGyY,IAAI,CAACxa,WAApB,EAAiC+B,OAAO,IAAIA,OAAO,KAAKwY,IAAxD,GAA+D;AAC7D+pE,UAAAA,UAAU,GAAGviF,OAAb;AACAA,UAAAA,OAAO,GAAGA,OAAO,CAAC/B,WAAlB;AACAwa,UAAAA,IAAI,CAACrY,WAAL,CAAiBmiF,UAAjB;AACD;;AACDxoF,QAAAA,GAAG,CAAC6G,MAAJ,CAAW4X,IAAX;AACA/f,QAAAA,KAAK,CAAC9R,IAAN,CAAW8R,KAAK,CAACC,IAAN,CAAW8f,IAAI,CAACnf,UAAhB,CAAX,EAAwC,UAAUM,IAAV,EAAgB;AACtD8e,UAAAA,IAAI,CAACrY,WAAL,CAAiBzG,IAAjB;AACD,SAFD;AAGA,eAAO8e,IAAP;AACD;AACF;;AACD,WAAOD,IAAP;AACD,GApBD;;AAqBA,MAAIiqE,aAAa,GAAG,UAAU1oF,GAAV,EAAeiwD,MAAf,EAAuBV,IAAvB,EAA6B3vD,IAA7B,EAAmC;AACrD,QAAIA,IAAI,IAAIqwD,MAAM,CAAC04B,cAAP,KAA0B,KAAtC,EAA6C;AAC3C,UAAI5Q,OAAO,GAAGwQ,kBAAkB,CAACvoF,GAAD,EAAM+uD,uBAAuB,CAACnvD,IAAD,CAA7B,EAAqCA,IAArC,CAAhC;AACA2oF,MAAAA,kBAAkB,CAACvoF,GAAD,EAAM+3E,OAAN,EAAehpB,uBAAuB,CAACgpB,OAAD,EAAU,IAAV,CAAtC,CAAlB;AACD;AACF,GALD;;AAMA,MAAI6Q,gBAAgB,GAAG,UAAU5oF,GAAV,EAAeiwD,MAAf,EAAuBrwD,IAAvB,EAA6B;AAClD,QAAIqwD,MAAM,CAAC44B,kBAAX,EAA+B;AAC7B,UAAI1nF,QAAQ,GAAG8uD,MAAM,CAAC64B,KAAP,GAAe,UAAf,GAA4B,GAA3C;AACAV,MAAAA,MAAM,CAACpoF,GAAG,CAAC+2B,MAAJ,CAAW51B,QAAX,EAAqBvB,IAArB,CAAD,EAA6B,UAAUA,IAAV,EAAgB;AACjD,YAAIyoF,aAAa,CAACzoF,IAAD,CAAjB,EAAyB;AACvBwoF,UAAAA,MAAM,CAACn4B,MAAM,CAAC9iD,MAAR,EAAgB,UAAUziB,KAAV,EAAiB5C,IAAjB,EAAuB;AAC3CkY,YAAAA,GAAG,CAAC2qC,QAAJ,CAAa/qC,IAAb,EAAmB9X,IAAnB,EAAyB,EAAzB;AACD,WAFK,CAAN;AAGD;AACF,OANK,CAAN;AAOD;AACF,GAXD;;AAYA,MAAIihG,oBAAoB,GAAG,UAAUnpF,IAAV,EAAgB5S,MAAhB,EAAwBsiB,OAAxB,EAAiC;AAC1D84E,IAAAA,MAAM,CAACxoF,IAAI,CAACN,UAAN,EAAkB,UAAUM,IAAV,EAAgB;AACtC,UAAIyoF,aAAa,CAACzoF,IAAD,CAAjB,EAAyB;AACvB,YAAI5S,MAAM,CAAC4S,IAAD,CAAV,EAAkB;AAChB0P,UAAAA,OAAO,CAAC1P,IAAD,CAAP;AACD;;AACD,YAAIA,IAAI,CAACP,aAAL,EAAJ,EAA0B;AACxB0pF,UAAAA,oBAAoB,CAACnpF,IAAD,EAAO5S,MAAP,EAAesiB,OAAf,CAApB;AACD;AACF;AACF,KATK,CAAN;AAUD,GAXD;;AAYA,MAAI05E,eAAe,GAAG,UAAUhpF,GAAV,EAAeJ,IAAf,EAAqB;AACzC,QAAIA,IAAI,CAAC6C,QAAL,KAAkB,MAAlB,IAA4BzC,GAAG,CAAC6pC,UAAJ,CAAejqC,IAAf,EAAqB5W,MAArB,KAAgC,CAAhE,EAAmE;AACjEgX,MAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX,EAAiB,IAAjB;AACD;AACF,GAJD;;AAKA,MAAIqpF,QAAQ,GAAG,UAAUjpF,GAAV,EAAelY,IAAf,EAAqB;AAClC,WAAO,UAAU8X,IAAV,EAAgB;AACrB,aAAO,CAAC,EAAEA,IAAI,IAAImrC,QAAQ,CAAC/qC,GAAD,EAAMJ,IAAN,EAAY9X,IAAZ,CAAlB,CAAR;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIohG,UAAU,GAAG,UAAUlpF,GAAV,EAAelY,IAAf,EAAqB4C,KAArB,EAA4B;AAC3C,WAAO,UAAUkV,IAAV,EAAgB;AACrBI,MAAAA,GAAG,CAAC2qC,QAAJ,CAAa/qC,IAAb,EAAmB9X,IAAnB,EAAyB4C,KAAzB;;AACA,UAAIkV,IAAI,CAACkL,YAAL,CAAkB,OAAlB,MAA+B,EAAnC,EAAuC;AACrClL,QAAAA,IAAI,CAAC8M,eAAL,CAAqB,OAArB;AACD;;AACDs8E,MAAAA,eAAe,CAAChpF,GAAD,EAAMJ,IAAN,CAAf;AACD,KAND;AAOD,GARD;;AAUA,MAAIupF,YAAY,GAAGrwE,GAAG,CAAChB,QAAJ,CAAa,CAC9B;AAAEuoC,IAAAA,IAAI,EAAE;AAAR,GAD8B,EAE9B;AAAE9S,IAAAA,MAAM,EAAE,CAAC,MAAD;AAAV,GAF8B,EAG9B;AAAEtyB,IAAAA,OAAO,EAAE;AAAX,GAH8B,CAAb,CAAnB;AAKA,MAAImuE,WAAW,GAAG,oBAAlB;AACA,MAAIC,MAAM,GAAG3qF,KAAK,CAAC9R,IAAnB;AACA,MAAI08F,MAAM,GAAG95B,IAAb;;AACA,MAAI+5B,gBAAgB,GAAG,UAAU3pF,IAAV,EAAgB;AACrC,WAAO,eAAe/K,IAAf,CAAoB+K,IAAI,CAAC6C,QAAzB,CAAP;AACD,GAFD;;AAGA,MAAI+mF,qBAAqB,GAAG,UAAUxpF,GAAV,EAAeJ,IAAf,EAAqB5B,MAArB,EAA6B;AACvD,WAAOgC,GAAG,CAAC4uC,SAAJ,CAAchvC,IAAd,EAAoB5B,MAApB,KAA+B4B,IAAI,KAAK5B,MAAxC,IAAkD,CAACgC,GAAG,CAAC4f,OAAJ,CAAY5hB,MAAZ,CAA1D;AACD,GAFD;;AAGA,MAAIyrF,YAAY,GAAG,UAAUt6B,EAAV,EAAcla,GAAd,EAAmBx9C,KAAnB,EAA0B;AAC3C,QAAI6E,SAAJ,EAAeslB,MAAf;AACAtlB,IAAAA,SAAS,GAAG24C,GAAG,CAACx9C,KAAK,GAAG,gBAAH,GAAsB,cAA5B,CAAf;AACAmqB,IAAAA,MAAM,GAAGqzB,GAAG,CAACx9C,KAAK,GAAG,aAAH,GAAmB,WAAzB,CAAZ;;AACA,QAAIwS,WAAW,CAAC3N,SAAD,CAAf,EAA4B;AAC1B,UAAIotF,OAAO,GAAGptF,SAAS,CAACgD,UAAV,CAAqBtW,MAArB,GAA8B,CAA5C;;AACA,UAAI,CAACyO,KAAD,IAAUmqB,MAAd,EAAsB;AACpBA,QAAAA,MAAM;AACP;;AACDtlB,MAAAA,SAAS,GAAGA,SAAS,CAACgD,UAAV,CAAqBsiB,MAAM,GAAG8nE,OAAT,GAAmBA,OAAnB,GAA6B9nE,MAAlD,CAAZ;AACD;;AACD,QAAIvW,QAAQ,CAAC/O,SAAD,CAAR,IAAuB7E,KAAvB,IAAgCmqB,MAAM,IAAItlB,SAAS,CAACkhC,SAAV,CAAoBx0C,MAAlE,EAA0E;AACxEsT,MAAAA,SAAS,GAAG,IAAIgiB,aAAJ,CAAkBhiB,SAAlB,EAA6B6yD,EAAE,CAAC/Z,OAAH,EAA7B,EAA2C32B,IAA3C,MAAqDniB,SAAjE;AACD;;AACD,QAAI+O,QAAQ,CAAC/O,SAAD,CAAR,IAAuB,CAAC7E,KAAxB,IAAiCmqB,MAAM,KAAK,CAAhD,EAAmD;AACjDtlB,MAAAA,SAAS,GAAG,IAAIgiB,aAAJ,CAAkBhiB,SAAlB,EAA6B6yD,EAAE,CAAC/Z,OAAH,EAA7B,EAA2C12B,IAA3C,MAAqDpiB,SAAjE;AACD;;AACD,WAAOA,SAAP;AACD,GAlBD;;AAmBA,MAAIqtF,uBAAuB,GAAG,UAAU/pF,IAAV,EAAgBnI,KAAhB,EAAuB;AACnD,QAAIwF,IAAI,GAAGxF,KAAK,GAAG,YAAH,GAAkB,WAAlC;;AACA,QAAI8xF,gBAAgB,CAAC3pF,IAAD,CAAhB,IAA0BA,IAAI,CAAC3C,IAAD,CAAlC,EAA0C;AACxC,UAAI2sF,SAAS,GAAGhqF,IAAI,CAAC3C,IAAD,CAApB;;AACA,UAAI2C,IAAI,CAAC6C,QAAL,KAAkB,IAAtB,EAA4B;AAC1B,eAAOmnF,SAAS,CAAC3sF,IAAD,CAAT,IAAmB2sF,SAA1B;AACD,OAFD,MAEO;AACL,eAAOA,SAAP;AACD;AACF;;AACD,WAAOhqF,IAAP;AACD,GAXD;;AAYA,MAAIiqF,MAAM,GAAG,UAAU7pF,GAAV,EAAeJ,IAAf,EAAqB9X,IAArB,EAA2BukB,KAA3B,EAAkC;AAC7C,QAAI9F,OAAO,GAAGvG,GAAG,CAAC9C,MAAJ,CAAWpV,IAAX,EAAiBukB,KAAjB,CAAd;AACAzM,IAAAA,IAAI,CAAC0D,UAAL,CAAgByC,YAAhB,CAA6BQ,OAA7B,EAAsC3G,IAAtC;AACA2G,IAAAA,OAAO,CAACF,WAAR,CAAoBzG,IAApB;AACA,WAAO2G,OAAP;AACD,GALD;;AAMA,MAAIujF,gBAAgB,GAAG,UAAU9pF,GAAV,EAAeJ,IAAf,EAAqB6e,IAArB,EAA2B32B,IAA3B,EAAiCukB,KAAjC,EAAwC;AAC7D,QAAI5U,KAAK,GAAG2I,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAZ;AACA,QAAI2G,OAAO,GAAGnG,YAAY,CAACX,OAAb,CAAqBO,GAAG,CAAC9C,MAAJ,CAAWpV,IAAX,EAAiBukB,KAAjB,CAArB,CAAd;AACA,QAAIzI,QAAQ,GAAG6a,IAAI,GAAGra,YAAY,CAAC3M,KAAD,CAAf,GAAyB0M,YAAY,CAAC1M,KAAD,CAAxD;AACAgP,IAAAA,QAAQ,CAACF,OAAD,EAAU3C,QAAV,CAAR;;AACA,QAAI6a,IAAJ,EAAU;AACR7Y,MAAAA,MAAM,CAACnO,KAAD,EAAQ8O,OAAR,CAAN;AACAJ,MAAAA,OAAO,CAACI,OAAD,EAAU9O,KAAV,CAAP;AACD,KAHD,MAGO;AACLuO,MAAAA,KAAK,CAACvO,KAAD,EAAQ8O,OAAR,CAAL;AACAL,MAAAA,MAAM,CAACK,OAAD,EAAU9O,KAAV,CAAN;AACD;;AACD,WAAO8O,OAAO,CAACvG,GAAf;AACD,GAbD;;AAcA,MAAI+pF,WAAW,GAAG,UAAU/pF,GAAV,EAAeJ,IAAf,EAAqBqwD,MAArB,EAA6B;AAC7C,QAAIq5B,MAAM,CAAC1pF,IAAD,EAAOqwD,MAAM,CAACljC,MAAd,CAAV,EAAiC;AAC/B,aAAO,IAAP;AACD;;AACD,QAAIu8D,MAAM,CAAC1pF,IAAD,EAAOqwD,MAAM,CAAC5O,KAAd,CAAV,EAAgC;AAC9B,aAAO,IAAP;AACD;;AACD,QAAI4O,MAAM,CAAC9uD,QAAX,EAAqB;AACnB,aAAO8I,WAAW,CAACrK,IAAD,CAAX,IAAqBI,GAAG,CAAC9T,EAAJ,CAAO0T,IAAP,EAAaqwD,MAAM,CAAC9uD,QAApB,CAA5B;AACD;AACF,GAVD;;AAWA,MAAI6oF,sBAAsB,GAAG,UAAUpqF,IAAV,EAAgBqwD,MAAhB,EAAwB;AACnD,WAAOA,MAAM,CAAC64B,KAAP,IAAgBlpF,IAAI,CAAC6C,QAAL,KAAkB,GAAzC;AACD,GAFD;;AAGA,MAAIwnF,MAAM,GAAG,UAAUjqF,GAAV,EAAeJ,IAAf,EAAqB6e,IAArB,EAA2BuwC,GAA3B,EAAgC;AAC3CpvD,IAAAA,IAAI,GAAGmvD,uBAAuB,CAACnvD,IAAD,EAAO6e,IAAP,EAAauwC,GAAb,CAA9B;AACA,WAAO,CAACpvD,IAAD,IAAUA,IAAI,CAAC6C,QAAL,KAAkB,IAAlB,IAA0BzC,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAZ,CAA3C;AACD,GAHD;;AAIA,MAAIsqF,YAAY,GAAG,UAAU/6B,EAAV,EAAcvvD,IAAd,EAAoBqwD,MAApB,EAA4B;AAC7C,QAAI3sD,UAAU,GAAG1D,IAAI,CAAC0D,UAAtB;AACA,QAAI6mF,YAAJ;AACA,QAAInqF,GAAG,GAAGmvD,EAAE,CAACnvD,GAAb;AAAA,QAAkBoqF,eAAe,GAAGhpC,kBAAkB,CAAC+N,EAAD,CAAtD;;AACA,QAAIc,MAAM,CAAC5O,KAAX,EAAkB;AAChB,UAAI,CAAC+oC,eAAL,EAAsB;AACpB,YAAIpqF,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAZ,KAAqB,CAACI,GAAG,CAAC4f,OAAJ,CAAYtc,UAAZ,CAA1B,EAAmD;AACjD,cAAI,CAAC2mF,MAAM,CAACjqF,GAAD,EAAMJ,IAAN,EAAY,KAAZ,CAAP,IAA6B,CAACqqF,MAAM,CAACjqF,GAAD,EAAMJ,IAAI,CAAC2E,UAAX,EAAuB,IAAvB,EAA6B,IAA7B,CAAxC,EAA4E;AAC1E3E,YAAAA,IAAI,CAACmG,YAAL,CAAkB/F,GAAG,CAAC9C,MAAJ,CAAW,IAAX,CAAlB,EAAoC0C,IAAI,CAAC2E,UAAzC;AACD;;AACD,cAAI,CAAC0lF,MAAM,CAACjqF,GAAD,EAAMJ,IAAN,EAAY,IAAZ,CAAP,IAA4B,CAACqqF,MAAM,CAACjqF,GAAD,EAAMJ,IAAI,CAAC4E,SAAX,EAAsB,KAAtB,EAA6B,IAA7B,CAAvC,EAA2E;AACzE5E,YAAAA,IAAI,CAACyG,WAAL,CAAiBrG,GAAG,CAAC9C,MAAJ,CAAW,IAAX,CAAjB;AACD;AACF;AACF,OATD,MASO;AACL,YAAIoG,UAAU,KAAKtD,GAAG,CAACypC,OAAJ,EAAnB,EAAkC;AAChC,cAAI,CAACwmB,MAAM,CAACo6B,UAAR,IAAsB,CAACf,MAAM,CAAC1pF,IAAD,EAAOqwD,MAAM,CAACo6B,UAAd,CAAjC,EAA4D;AAC1Dz9F,YAAAA,IAAI,CAACkE,MAAM,CAAC8O,IAAI,CAACN,UAAN,CAAP,EAA0B,UAAUM,IAAV,EAAgB;AAC5C,kBAAI0vB,OAAO,CAAC6/B,EAAD,EAAKi7B,eAAL,EAAsBxqF,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,EAAtB,CAAX,EAA+D;AAC7D,oBAAI,CAAC8zF,YAAL,EAAmB;AACjBA,kBAAAA,YAAY,GAAGN,MAAM,CAAC7pF,GAAD,EAAMJ,IAAN,EAAYwqF,eAAZ,CAArB;AACApqF,kBAAAA,GAAG,CAAC2rC,UAAJ,CAAew+C,YAAf,EAA6Bh7B,EAAE,CAAC7zC,QAAH,CAAYgvE,uBAAzC;AACD,iBAHD,MAGO;AACLH,kBAAAA,YAAY,CAAC9jF,WAAb,CAAyBzG,IAAzB;AACD;AACF,eAPD,MAOO;AACLuqF,gBAAAA,YAAY,GAAG,CAAf;AACD;AACF,aAXG,CAAJ;AAYD;AACF;AACF;AACF;;AACD,QAAIl6B,MAAM,CAAC9uD,QAAP,IAAmB8uD,MAAM,CAACljC,MAA1B,IAAoC,CAACu8D,MAAM,CAACr5B,MAAM,CAACljC,MAAR,EAAgBntB,IAAhB,CAA/C,EAAsE;AACpE;AACD;;AACDI,IAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX,EAAiB,IAAjB;AACD,GArCD;;AAsCA,MAAI2qF,oBAAoB,GAAG,UAAUp7B,EAAV,EAAcc,MAAd,EAAsBV,IAAtB,EAA4B3vD,IAA5B,EAAkC4qF,WAAlC,EAA+C;AACxE,QAAIC,cAAJ;AACA,QAAIzqF,GAAG,GAAGmvD,EAAE,CAACnvD,GAAb;;AACA,QAAI,CAAC+pF,WAAW,CAAC/pF,GAAD,EAAMJ,IAAN,EAAYqwD,MAAZ,CAAZ,IAAmC,CAAC+5B,sBAAsB,CAACpqF,IAAD,EAAOqwD,MAAP,CAA9D,EAA8E;AAC5E,aAAOk5B,YAAY,CAAC9oC,IAAb,EAAP;AACD;;AACD,QAAItyC,GAAG,GAAGnO,IAAV;;AACA,QAAIqwD,MAAM,CAACljC,MAAP,IAAiBkjC,MAAM,CAACppD,MAAP,KAAkB,KAAnC,IAA4CxY,OAAO,CAAC4hE,MAAM,CAACy6B,mBAAR,CAAvD,EAAqF;AACnF,UAAIC,eAAe,GAAG39F,MAAM,CAACgT,GAAG,CAAC6pC,UAAJ,CAAe97B,GAAf,CAAD,EAAsB,UAAUnB,IAAV,EAAgB;AAChE,eAAOxd,QAAQ,CAAC6gE,MAAM,CAACy6B,mBAAR,EAA6B99E,IAAI,CAAC9kB,IAAL,CAAUuO,WAAV,EAA7B,CAAf;AACD,OAF2B,CAA5B;AAGA2J,MAAAA,GAAG,CAACosC,gBAAJ,CAAqBr+B,GAArB;AACAnhB,MAAAA,IAAI,CAAC+9F,eAAD,EAAkB,UAAU/9E,IAAV,EAAgB;AACpC,eAAO5M,GAAG,CAAC8pC,SAAJ,CAAc/7B,GAAd,EAAmBnB,IAAI,CAAC9kB,IAAxB,EAA8B8kB,IAAI,CAACliB,KAAnC,CAAP;AACD,OAFG,CAAJ;;AAGA,UAAIigG,eAAe,CAAC3hG,MAAhB,GAAyB,CAA7B,EAAgC;AAC9B,eAAOmgG,YAAY,CAAC57C,MAAb,CAAoB,MAApB,CAAP;AACD;AACF;;AACD,QAAI0iB,MAAM,CAACppD,MAAP,KAAkB,KAAtB,EAA6B;AAC3BwiF,MAAAA,MAAM,CAACp5B,MAAM,CAAC9iD,MAAR,EAAgB,UAAUziB,KAAV,EAAiB5C,IAAjB,EAAuB;AAC3C4C,QAAAA,KAAK,GAAGglE,mBAAmB,CAAC1vD,GAAD,EAAMsvD,WAAW,CAAC5kE,KAAD,EAAQ6kE,IAAR,CAAjB,EAAgCznE,IAAI,GAAG,EAAvC,CAA3B;;AACA,YAAI8G,QAAQ,CAAC9G,IAAD,CAAZ,EAAoB;AAClBA,UAAAA,IAAI,GAAG4C,KAAP;AACA8/F,UAAAA,WAAW,GAAG,IAAd;AACD;;AACD,YAAIv6B,MAAM,CAAC26B,cAAP,IAA0B,CAACJ,WAAD,IAAgBlB,MAAM,CAACv+C,QAAQ,CAAC/qC,GAAD,EAAMwqF,WAAN,EAAmB1iG,IAAnB,CAAT,EAAmC4C,KAAnC,CAApD,EAAgG;AAC9FsV,UAAAA,GAAG,CAAC2qC,QAAJ,CAAa58B,GAAb,EAAkBjmB,IAAlB,EAAwB,EAAxB;AACD;;AACD2iG,QAAAA,cAAc,GAAG,IAAjB;AACD,OAVK,CAAN;;AAWA,UAAIA,cAAc,IAAIzqF,GAAG,CAAC2pC,SAAJ,CAAc57B,GAAd,EAAmB,OAAnB,MAAgC,EAAtD,EAA0D;AACxDA,QAAAA,GAAG,CAACrB,eAAJ,CAAoB,OAApB;AACAqB,QAAAA,GAAG,CAACrB,eAAJ,CAAoB,gBAApB;AACD;;AACD28E,MAAAA,MAAM,CAACp5B,MAAM,CAACtjD,UAAR,EAAoB,UAAUjiB,KAAV,EAAiB5C,IAAjB,EAAuB;AAC/C,YAAI+iG,QAAJ;AACAngG,QAAAA,KAAK,GAAG4kE,WAAW,CAAC5kE,KAAD,EAAQ6kE,IAAR,CAAnB;;AACA,YAAI3gE,QAAQ,CAAC9G,IAAD,CAAZ,EAAoB;AAClBA,UAAAA,IAAI,GAAG4C,KAAP;AACA8/F,UAAAA,WAAW,GAAG,IAAd;AACD;;AACD,YAAIv6B,MAAM,CAAC26B,cAAP,IAA0B,CAACJ,WAAD,IAAgBlB,MAAM,CAACtpF,GAAG,CAAC2pC,SAAJ,CAAc6gD,WAAd,EAA2B1iG,IAA3B,CAAD,EAAmC4C,KAAnC,CAApD,EAAgG;AAC9F,cAAI5C,IAAI,KAAK,OAAb,EAAsB;AACpB4C,YAAAA,KAAK,GAAGsV,GAAG,CAAC2pC,SAAJ,CAAc57B,GAAd,EAAmBjmB,IAAnB,CAAR;;AACA,gBAAI4C,KAAJ,EAAW;AACTmgG,cAAAA,QAAQ,GAAG,EAAX;AACAj+F,cAAAA,IAAI,CAAClC,KAAK,CAACqS,KAAN,CAAY,KAAZ,CAAD,EAAqB,UAAU6vC,GAAV,EAAe;AACtC,oBAAI,WAAW/3C,IAAX,CAAgB+3C,GAAhB,CAAJ,EAA0B;AACxBi+C,kBAAAA,QAAQ,IAAI,CAACA,QAAQ,GAAG,GAAH,GAAS,EAAlB,IAAwBj+C,GAApC;AACD;AACF,eAJG,CAAJ;;AAKA,kBAAIi+C,QAAJ,EAAc;AACZ7qF,gBAAAA,GAAG,CAAC8pC,SAAJ,CAAc/7B,GAAd,EAAmBjmB,IAAnB,EAAyB+iG,QAAzB;AACA;AACD;AACF;AACF;;AACD,cAAI/iG,IAAI,KAAK,OAAb,EAAsB;AACpBimB,YAAAA,GAAG,CAACrB,eAAJ,CAAoB,WAApB;AACD;;AACD,cAAI08E,WAAW,CAACv0F,IAAZ,CAAiB/M,IAAjB,CAAJ,EAA4B;AAC1BimB,YAAAA,GAAG,CAACrB,eAAJ,CAAoB,cAAc5kB,IAAlC;AACD;;AACDimB,UAAAA,GAAG,CAACrB,eAAJ,CAAoB5kB,IAApB;AACD;AACF,OA/BK,CAAN;AAgCAuhG,MAAAA,MAAM,CAACp5B,MAAM,CAACrY,OAAR,EAAiB,UAAUltD,KAAV,EAAiB;AACtCA,QAAAA,KAAK,GAAG4kE,WAAW,CAAC5kE,KAAD,EAAQ6kE,IAAR,CAAnB;;AACA,YAAI,CAACi7B,WAAD,IAAgBxqF,GAAG,CAACykC,QAAJ,CAAa+lD,WAAb,EAA0B9/F,KAA1B,CAApB,EAAsD;AACpDsV,UAAAA,GAAG,CAAC8mC,WAAJ,CAAgB/4B,GAAhB,EAAqBrjB,KAArB;AACD;AACF,OALK,CAAN;AAMA,UAAI2hB,KAAK,GAAGrM,GAAG,CAAC6pC,UAAJ,CAAe97B,GAAf,CAAZ;;AACA,WAAK,IAAI7kB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmjB,KAAK,CAACrjB,MAA1B,EAAkCE,CAAC,EAAnC,EAAuC;AACrC,YAAIyhB,QAAQ,GAAG0B,KAAK,CAACnjB,CAAD,CAAL,CAASuZ,QAAxB;;AACA,YAAIkI,QAAQ,CAAC1iB,OAAT,CAAiB,GAAjB,MAA0B,CAA1B,IAA+B0iB,QAAQ,CAAC1iB,OAAT,CAAiB,OAAjB,MAA8B,CAAjE,EAAoE;AAClE,iBAAOkhG,YAAY,CAAC9oC,IAAb,EAAP;AACD;AACF;AACF;;AACD,QAAI4P,MAAM,CAACppD,MAAP,KAAkB,MAAtB,EAA8B;AAC5BqjF,MAAAA,YAAY,CAAC/6B,EAAD,EAAKphD,GAAL,EAAUkiD,MAAV,CAAZ;AACA,aAAOk5B,YAAY,CAACluE,OAAb,EAAP;AACD;;AACD,WAAOkuE,YAAY,CAAC9oC,IAAb,EAAP;AACD,GAtFD;;AAuFA,MAAIyqC,YAAY,GAAG,UAAU37B,EAAV,EAAcc,MAAd,EAAsBV,IAAtB,EAA4B3vD,IAA5B,EAAkC4qF,WAAlC,EAA+C;AAChE,WAAOD,oBAAoB,CAACp7B,EAAD,EAAKc,MAAL,EAAaV,IAAb,EAAmB3vD,IAAnB,EAAyB4qF,WAAzB,CAApB,CAA0Dx+F,IAA1D,CAA+DV,KAA/D,EAAsE,UAAUy/F,OAAV,EAAmB;AAC9F57B,MAAAA,EAAE,CAACnvD,GAAH,CAAOutC,MAAP,CAAc3tC,IAAd,EAAoBmrF,OAApB;AACA,aAAO,IAAP;AACD,KAHM,EAGJx/F,MAHI,CAAP;AAID,GALD;;AAMA,MAAIy/F,cAAc,GAAG,UAAUhwE,MAAV,EAAkB1e,SAAlB,EAA6BxU,IAA7B,EAAmCynE,IAAnC,EAAyC80B,OAAzC,EAAkD;AACrE,QAAI4G,UAAJ;AACAr+F,IAAAA,IAAI,CAACijE,YAAY,CAAC70C,MAAM,CAAChb,GAAR,EAAa1D,SAAS,CAACgH,UAAvB,CAAZ,CAA+CnT,OAA/C,EAAD,EAA2D,UAAU6N,MAAV,EAAkB;AAC/E,UAAI,CAACitF,UAAD,IAAejtF,MAAM,CAACnS,EAAP,KAAc,QAA7B,IAAyCmS,MAAM,CAACnS,EAAP,KAAc,MAA3D,EAAmE;AACjE,YAAIokE,MAAM,GAAGg0B,SAAS,CAACjpE,MAAD,EAAShd,MAAT,EAAiBlW,IAAjB,EAAuBynE,IAAvB,EAA6B80B,OAA7B,CAAtB;;AACA,YAAIp0B,MAAM,IAAIA,MAAM,CAAClzD,KAAP,KAAiB,KAA/B,EAAsC;AACpCkuF,UAAAA,UAAU,GAAGjtF,MAAb;AACD;AACF;AACF,KAPG,CAAJ;AAQA,WAAOitF,UAAP;AACD,GAXD;;AAYA,MAAIC,qBAAqB,GAAG,UAAUlwE,MAAV,EAAkBi1C,MAAlB,EAA0BV,IAA1B,EAAgClnE,KAAhC,EAAuC;AACjE,WAAOkiG,oBAAoB,CAACvvE,MAAD,EAASi1C,MAAT,EAAiBV,IAAjB,EAAuBlnE,KAAvB,EAA8BA,KAA9B,CAApB,CAAyD2D,IAAzD,CAA8DvB,QAAQ,CAACpC,KAAD,CAAtE,EAA+E,UAAU0iG,OAAV,EAAmB;AACvG,UAAI7yC,QAAQ,GAAGl9B,MAAM,CAAChb,GAAP,CAAW+jC,cAAX,EAAf;AACAmU,MAAAA,QAAQ,CAAC7xC,WAAT,CAAqBhe,KAArB;AACA,aAAO2yB,MAAM,CAAChb,GAAP,CAAWutC,MAAX,CAAkBllD,KAAlB,EAAyB0iG,OAAzB,CAAP;AACD,KAJM,EAIJtgG,QAAQ,CAAC,IAAD,CAJJ,CAAP;AAKD,GAND;;AAOA,MAAI0gG,YAAY,GAAG,UAAUnwE,MAAV,EAAkB8oE,UAAlB,EAA8BmH,UAA9B,EAA0C3uF,SAA1C,EAAqDlE,MAArD,EAA6D2E,KAA7D,EAAoEkzD,MAApE,EAA4EV,IAA5E,EAAkF;AACnG,QAAIlnE,KAAJ,EAAW+iG,SAAX,EAAsBC,UAAtB;AACA,QAAIrrF,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;;AACA,QAAIirF,UAAJ,EAAgB;AACd,UAAIK,gBAAgB,GAAGL,UAAU,CAAC3nF,UAAlC;;AACA,WAAK,IAAIgwD,QAAQ,GAAGh3D,SAAS,CAACgH,UAA9B,EAA0CgwD,QAAQ,IAAIA,QAAQ,KAAKg4B,gBAAnE,EAAqFh4B,QAAQ,GAAGA,QAAQ,CAAChwD,UAAzG,EAAqH;AACnHjb,QAAAA,KAAK,GAAG2X,GAAG,CAAC3X,KAAJ,CAAUirE,QAAV,EAAoB,KAApB,CAAR;;AACA,aAAK,IAAIpqE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG46F,UAAU,CAAC96F,MAA/B,EAAuCE,CAAC,EAAxC,EAA4C;AAC1Cb,UAAAA,KAAK,GAAG6iG,qBAAqB,CAAClwE,MAAD,EAAS8oE,UAAU,CAAC56F,CAAD,CAAnB,EAAwBqmE,IAAxB,EAA8BlnE,KAA9B,CAA7B;;AACA,cAAIA,KAAK,KAAK,IAAd,EAAoB;AAClB;AACD;AACF;;AACD,YAAIA,KAAJ,EAAW;AACT,cAAI+iG,SAAJ,EAAe;AACb/iG,YAAAA,KAAK,CAACge,WAAN,CAAkB+kF,SAAlB;AACD;;AACD,cAAI,CAACC,UAAL,EAAiB;AACfA,YAAAA,UAAU,GAAGhjG,KAAb;AACD;;AACD+iG,UAAAA,SAAS,GAAG/iG,KAAZ;AACD;AACF;;AACD,UAAI0U,KAAK,KAAK,CAACkzD,MAAM,CAACs7B,KAAR,IAAiB,CAACvrF,GAAG,CAAC4f,OAAJ,CAAYqrE,UAAZ,CAAvB,CAAT,EAA0D;AACxD3uF,QAAAA,SAAS,GAAG0D,GAAG,CAACjD,KAAJ,CAAUkuF,UAAV,EAAsB3uF,SAAtB,CAAZ;AACD;;AACD,UAAI8uF,SAAJ,EAAe;AACbhzF,QAAAA,MAAM,CAACkL,UAAP,CAAkByC,YAAlB,CAA+BqlF,SAA/B,EAA0ChzF,MAA1C;AACAizF,QAAAA,UAAU,CAAChlF,WAAX,CAAuBjO,MAAvB;;AACA,YAAI63D,MAAM,CAACljC,MAAX,EAAmB;AACjB27D,UAAAA,aAAa,CAAC1oF,GAAD,EAAMiwD,MAAN,EAAcV,IAAd,EAAoB67B,SAApB,CAAb;AACD;AACF;AACF;;AACD,WAAO9uF,SAAP;AACD,GAnCD;;AAoCA,MAAIkvF,QAAQ,GAAG,UAAUr8B,EAAV,EAAcrnE,IAAd,EAAoBynE,IAApB,EAA0B3vD,IAA1B,EAAgCykF,OAAhC,EAAyC;AACtD,QAAIP,UAAU,GAAG30B,EAAE,CAACkB,SAAH,CAAa1/D,GAAb,CAAiB7I,IAAjB,CAAjB;AACA,QAAImoE,MAAM,GAAG6zB,UAAU,CAAC,CAAD,CAAvB;AACA,QAAIjoF,eAAe,GAAG,IAAtB;AACA,QAAImE,GAAG,GAAGmvD,EAAE,CAACnvD,GAAb;AACA,QAAIk1C,SAAS,GAAGia,EAAE,CAACja,SAAnB;;AACA,QAAIu2C,iBAAiB,GAAG,UAAUnvF,SAAV,EAAqB;AAC3C,UAAI2uF,UAAU,GAAGD,cAAc,CAAC77B,EAAD,EAAK7yD,SAAL,EAAgBxU,IAAhB,EAAsBynE,IAAtB,EAA4B80B,OAA5B,CAA/B;AACA,aAAO8G,YAAY,CAACh8B,EAAD,EAAK20B,UAAL,EAAiBmH,UAAjB,EAA6B3uF,SAA7B,EAAwCA,SAAxC,EAAmD,IAAnD,EAAyD2zD,MAAzD,EAAiEV,IAAjE,CAAnB;AACD,KAHD;;AAIA,QAAIm8B,oBAAoB,GAAG,UAAU9rF,IAAV,EAAgB;AACzC,aAAOwuD,gBAAgB,CAACxuD,IAAD,CAAhB,IAA0BqK,WAAW,CAACrK,IAAD,CAArC,KAAgDA,IAAI,CAAC/T,EAAL,KAAY,QAAZ,IAAwB+T,IAAI,CAAC/T,EAAL,KAAY,MAApF,CAAP;AACD,KAFD;;AAGA,QAAIyjB,OAAO,GAAG,UAAU1P,IAAV,EAAgB;AAC5B,UAAI+rF,mBAAJ,EAAyBxgF,uBAAzB;;AACA,UAAIlB,WAAW,CAACrK,IAAD,CAAX,IAAqBI,GAAG,CAAC0uC,kBAAJ,CAAuB9uC,IAAvB,CAAzB,EAAuD;AACrD+rF,QAAAA,mBAAmB,GAAG9vF,eAAtB;AACAA,QAAAA,eAAe,GAAGmE,GAAG,CAAC0uC,kBAAJ,CAAuB9uC,IAAvB,MAAiC,MAAnD;AACAuL,QAAAA,uBAAuB,GAAG,IAA1B;AACD;;AACD,UAAIpH,QAAQ,GAAGjT,MAAM,CAAC8O,IAAI,CAACN,UAAN,CAArB;;AACA,UAAIzD,eAAe,IAAI,CAACsP,uBAAxB,EAAiD;AAC/C,aAAK,IAAIjiB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG46F,UAAU,CAAC96F,MAA/B,EAAuCE,CAAC,EAAxC,EAA4C;AAC1C,cAAI4hG,YAAY,CAAC37B,EAAD,EAAK20B,UAAU,CAAC56F,CAAD,CAAf,EAAoBqmE,IAApB,EAA0B3vD,IAA1B,EAAgCA,IAAhC,CAAhB,EAAuD;AACrD;AACD;AACF;AACF;;AACD,UAAIqwD,MAAM,CAAC/lB,IAAX,EAAiB;AACf,YAAInmC,QAAQ,CAAC/a,MAAb,EAAqB;AACnB,eAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6a,QAAQ,CAAC/a,MAA7B,EAAqCE,CAAC,EAAtC,EAA0C;AACxComB,YAAAA,OAAO,CAACvL,QAAQ,CAAC7a,CAAD,CAAT,CAAP;AACD;;AACD,cAAIiiB,uBAAJ,EAA6B;AAC3BtP,YAAAA,eAAe,GAAG8vF,mBAAlB;AACD;AACF;AACF;AACF,KAzBD;;AA0BA,QAAI5kF,MAAM,GAAG,UAAUtP,KAAV,EAAiB;AAC5B,UAAImI,IAAI,GAAGI,GAAG,CAACrP,GAAJ,CAAQ8G,KAAK,GAAG,QAAH,GAAc,MAA3B,CAAX;AACA,UAAI7E,GAAG,GAAGgN,IAAI,CAACnI,KAAK,GAAG,YAAH,GAAkB,WAAxB,CAAd;;AACA,UAAIi0F,oBAAoB,CAAC94F,GAAD,CAAxB,EAA+B;AAC7BA,QAAAA,GAAG,GAAGA,GAAG,CAAC6E,KAAK,GAAG,YAAH,GAAkB,WAAxB,CAAT;AACD;;AACD,UAAI4T,QAAQ,CAACzY,GAAD,CAAR,IAAiBA,GAAG,CAAC4iB,IAAJ,CAASxsB,MAAT,KAAoB,CAAzC,EAA4C;AAC1C4J,QAAAA,GAAG,GAAG6E,KAAK,GAAGmI,IAAI,CAACqE,eAAL,IAAwBrE,IAAI,CAACsE,WAAhC,GAA8CtE,IAAI,CAACsE,WAAL,IAAoBtE,IAAI,CAACqE,eAAlF;AACD;;AACDjE,MAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX,EAAiB,IAAjB;AACA,aAAOhN,GAAP;AACD,KAXD;;AAYA,QAAIg5F,cAAc,GAAG,UAAU32C,GAAV,EAAe;AAClC,UAAIryB,cAAJ,EAAoBmsB,YAApB;AACA,UAAI63C,WAAW,GAAGn0B,SAAS,CAACtD,EAAD,EAAKla,GAAL,EAAU6uC,UAAV,EAAsB7uC,GAAG,CAAC+K,SAA1B,CAA3B;;AACA,UAAIiQ,MAAM,CAAClzD,KAAX,EAAkB;AAChB6pF,QAAAA,WAAW,GAAGzmB,OAAO,CAACymB,WAAD,CAArB;AACAhkE,QAAAA,cAAc,GAAG6mE,YAAY,CAACt6B,EAAD,EAAKy3B,WAAL,EAAkB,IAAlB,CAA7B;AACA73C,QAAAA,YAAY,GAAG06C,YAAY,CAACt6B,EAAD,EAAKy3B,WAAL,CAA3B;;AACA,YAAIhkE,cAAc,KAAKmsB,YAAvB,EAAqC;AACnCnsB,UAAAA,cAAc,GAAG+mE,uBAAuB,CAAC/mE,cAAD,EAAiB,IAAjB,CAAxC;AACAmsB,UAAAA,YAAY,GAAG46C,uBAAuB,CAAC56C,YAAD,EAAe,KAAf,CAAtC;;AACA,cAAIy6C,qBAAqB,CAACxpF,GAAD,EAAM4iB,cAAN,EAAsBmsB,YAAtB,CAAzB,EAA8D;AAC5D,gBAAIlpC,MAAM,GAAGhY,QAAQ,CAACD,IAAT,CAAcg1B,cAAc,CAACre,UAA7B,EAAyCnY,KAAzC,CAA+Cw2B,cAA/C,CAAb;AACA6oE,YAAAA,iBAAiB,CAAC3B,gBAAgB,CAAC9pF,GAAD,EAAM6F,MAAN,EAAc,IAAd,EAAoB,MAApB,EAA4B;AAC5D,oBAAM,QADsD;AAE5D,+BAAiB;AAF2C,aAA5B,CAAjB,CAAjB;AAIAkB,YAAAA,MAAM,CAAC,IAAD,CAAN;AACA;AACD;;AACD,cAAIyiF,qBAAqB,CAACxpF,GAAD,EAAM+uC,YAAN,EAAoBnsB,cAApB,CAAzB,EAA8D;AAC5D,gBAAI/c,MAAM,GAAGhY,QAAQ,CAACD,IAAT,CAAcmhD,YAAY,CAACvqC,SAA3B,EAAsCpY,KAAtC,CAA4C2iD,YAA5C,CAAb;AACA08C,YAAAA,iBAAiB,CAAC3B,gBAAgB,CAAC9pF,GAAD,EAAM6F,MAAN,EAAc,KAAd,EAAqB,MAArB,EAA6B;AAC7D,oBAAM,MADuD;AAE7D,+BAAiB;AAF4C,aAA7B,CAAjB,CAAjB;AAIAkB,YAAAA,MAAM,CAAC,KAAD,CAAN;AACA;AACD;;AACD6b,UAAAA,cAAc,GAAGinE,MAAM,CAAC7pF,GAAD,EAAM4iB,cAAN,EAAsB,MAAtB,EAA8B;AACnD,kBAAM,QAD6C;AAEnD,6BAAiB;AAFkC,WAA9B,CAAvB;AAIAmsB,UAAAA,YAAY,GAAG86C,MAAM,CAAC7pF,GAAD,EAAM+uC,YAAN,EAAoB,MAApB,EAA4B;AAC/C,kBAAM,MADyC;AAE/C,6BAAiB;AAF8B,WAA5B,CAArB;AAIA,cAAIiN,MAAM,GAAGh8C,GAAG,CAAC+tC,SAAJ,EAAb;AACAiO,UAAAA,MAAM,CAACiN,aAAP,CAAqBrmC,cAArB;AACAo5B,UAAAA,MAAM,CAACgN,YAAP,CAAoBja,YAApB;AACAikB,UAAAA,MAAM,CAAChzD,GAAD,EAAMg8C,MAAN,EAAc,UAAUnuC,KAAV,EAAiB;AACnCjhB,YAAAA,IAAI,CAACihB,KAAD,EAAQ,UAAU/hB,CAAV,EAAa;AACvB,kBAAI,CAACsiE,gBAAgB,CAACtiE,CAAD,CAAjB,IAAwB,CAACsiE,gBAAgB,CAACtiE,CAAC,CAACwX,UAAH,CAA7C,EAA6D;AAC3DmoF,gBAAAA,iBAAiB,CAAC3/F,CAAD,CAAjB;AACD;AACF,aAJG,CAAJ;AAKD,WANK,CAAN;AAOA2/F,UAAAA,iBAAiB,CAAC7oE,cAAD,CAAjB;AACA6oE,UAAAA,iBAAiB,CAAC18C,YAAD,CAAjB;AACAnsB,UAAAA,cAAc,GAAG7b,MAAM,CAAC,IAAD,CAAvB;AACAgoC,UAAAA,YAAY,GAAGhoC,MAAM,EAArB;AACD,SA3CD,MA2CO;AACL6b,UAAAA,cAAc,GAAGmsB,YAAY,GAAG08C,iBAAiB,CAAC7oE,cAAD,CAAjD;AACD;;AACDgkE,QAAAA,WAAW,CAAChkE,cAAZ,GAA6BA,cAAc,CAACtf,UAAf,GAA4Bsf,cAAc,CAACtf,UAA3C,GAAwDsf,cAArF;AACAgkE,QAAAA,WAAW,CAAC93C,WAAZ,GAA0B9uC,GAAG,CAACy+B,SAAJ,CAAc7b,cAAd,CAA1B;AACAgkE,QAAAA,WAAW,CAAC73C,YAAZ,GAA2BA,YAAY,CAACzrC,UAAb,GAA0ByrC,YAAY,CAACzrC,UAAvC,GAAoDyrC,YAA/E;AACA63C,QAAAA,WAAW,CAAC53C,SAAZ,GAAwBhvC,GAAG,CAACy+B,SAAJ,CAAcsQ,YAAd,IAA8B,CAAtD;AACD;;AACDikB,MAAAA,MAAM,CAAChzD,GAAD,EAAM4mF,WAAN,EAAmB,UAAU/4E,KAAV,EAAiB;AACxCjhB,QAAAA,IAAI,CAACihB,KAAD,EAAQ,UAAUjO,IAAV,EAAgB;AAC1B0P,UAAAA,OAAO,CAAC1P,IAAD,CAAP;AACA,cAAIisF,eAAe,GAAG,CACpB,WADoB,EAEpB,cAFoB,EAGpB,UAHoB,CAAtB;AAKAj/F,UAAAA,IAAI,CAACi/F,eAAD,EAAkB,UAAUj8B,UAAV,EAAsB;AAC1C,gBAAI3lD,WAAW,CAACrK,IAAD,CAAX,IAAqBuvD,EAAE,CAACnvD,GAAH,CAAO+qC,QAAP,CAAgBnrC,IAAhB,EAAsB,iBAAtB,MAA6CgwD,UAAlE,IAAgFhwD,IAAI,CAAC0D,UAArF,IAAmGqsD,iBAAiB,CAAC3vD,GAAD,EAAMJ,IAAI,CAAC0D,UAAX,CAAjB,KAA4CssD,UAAnJ,EAA+J;AAC7Jk7B,cAAAA,YAAY,CAAC37B,EAAD,EAAK;AACfjlB,gBAAAA,IAAI,EAAE,KADS;AAEfq7B,gBAAAA,KAAK,EAAE,IAFQ;AAGfx4C,gBAAAA,MAAM,EAAE,MAHO;AAIf5f,gBAAAA,MAAM,EAAE;AAAE2+E,kBAAAA,cAAc,EAAEl8B;AAAlB;AAJO,eAAL,EAKT,IALS,EAKHhwD,IALG,CAAZ;AAMD;AACF,WATG,CAAJ;AAUD,SAjBG,CAAJ;AAkBD,OAnBK,CAAN;AAoBD,KA9ED;;AA+EA,QAAIA,IAAJ,EAAU;AACR,UAAI+uD,MAAM,CAAC/uD,IAAD,CAAV,EAAkB;AAChB,YAAIq1C,GAAG,GAAGj1C,GAAG,CAAC+tC,SAAJ,EAAV;AACAkH,QAAAA,GAAG,CAAC8T,cAAJ,CAAmBnpD,IAAnB;AACAq1C,QAAAA,GAAG,CAACiH,WAAJ,CAAgBt8C,IAAhB;AACAgsF,QAAAA,cAAc,CAAC32C,GAAD,CAAd;AACD,OALD,MAKO;AACL22C,QAAAA,cAAc,CAAChsF,IAAD,CAAd;AACD;;AACD;AACD;;AACD,QAAII,GAAG,CAAC0uC,kBAAJ,CAAuBwG,SAAS,CAACoF,OAAV,EAAvB,MAAgD,OAApD,EAA6D;AAC3D16C,MAAAA,IAAI,GAAGs1C,SAAS,CAACoF,OAAV,EAAP;;AACA,WAAK,IAAIpxD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG46F,UAAU,CAAC96F,MAA/B,EAAuCE,CAAC,EAAxC,EAA4C;AAC1C,YAAI46F,UAAU,CAAC56F,CAAD,CAAV,CAAc6iG,eAAlB,EAAmC;AACjC,cAAIjB,YAAY,CAAC37B,EAAD,EAAK20B,UAAU,CAAC56F,CAAD,CAAf,EAAoBqmE,IAApB,EAA0B3vD,IAA1B,EAAgCA,IAAhC,CAAhB,EAAuD;AACrD;AACD;AACF;AACF;;AACD;AACD;;AACD,QAAI,CAACs1C,SAAS,CAACkK,WAAV,EAAD,IAA4B,CAAC6Q,MAAM,CAACljC,MAApC,IAA8CmnC,kBAAkB,CAAC/E,EAAD,CAAlB,CAAuBnmE,MAAzE,EAAiF;AAC/EgsE,MAAAA,QAAQ,CAAC9f,SAAD,EAAY,IAAZ,EAAkB,YAAY;AACpC0f,QAAAA,WAAW,CAACzF,EAAD,EAAKy8B,cAAL,CAAX;AACD,OAFO,CAAR;;AAGA,UAAI37B,MAAM,CAACljC,MAAP,IAAiBrvB,KAAK,CAACyxD,EAAD,EAAKrnE,IAAL,EAAWynE,IAAX,EAAiBra,SAAS,CAACwoB,QAAV,EAAjB,CAA1B,EAAkE;AAChE7O,QAAAA,SAAS,CAAC7uD,GAAD,EAAMk1C,SAAN,EAAiBA,SAAS,CAACC,MAAV,EAAjB,CAAT;AACD;;AACDga,MAAAA,EAAE,CAACwN,WAAH;AACD,KARD,MAQO;AACL+pB,MAAAA,iBAAiB,CAACv3B,EAAD,EAAKrnE,IAAL,EAAWynE,IAAX,EAAiB80B,OAAjB,CAAjB;AACD;AACF,GAnKD;;AAqKA,MAAI2H,MAAM,GAAGttF,KAAK,CAAC9R,IAAnB;;AACA,MAAIq/F,4BAA4B,GAAG,UAAUjsF,GAAV,EAAeiwD,MAAf,EAAuBV,IAAvB,EAA6B3vD,IAA7B,EAAmC;AACpE,QAAIssF,8BAA8B,GAAG,UAAUpgG,CAAV,EAAa;AAChD,UAAIA,CAAC,CAACsV,QAAF,KAAe,CAAf,IAAoBtV,CAAC,CAACwX,UAAtB,IAAoCxX,CAAC,CAACwX,UAAF,CAAalC,QAAb,KAA0B,CAAlE,EAAqE;AACnE,YAAI0qF,cAAc,GAAGn8B,iBAAiB,CAAC3vD,GAAD,EAAMlU,CAAC,CAACwX,UAAR,CAAtC;;AACA,YAAItD,GAAG,CAAC+qC,QAAJ,CAAaj/C,CAAb,EAAgB,OAAhB,KAA4BggG,cAAhC,EAAgD;AAC9C9rF,UAAAA,GAAG,CAAC2qC,QAAJ,CAAa7+C,CAAb,EAAgB,iBAAhB,EAAmCggG,cAAnC;AACD,SAFD,MAEO,IAAI9rF,GAAG,CAAC+qC,QAAJ,CAAaj/C,CAAb,EAAgB,iBAAhB,MAAuCggG,cAA3C,EAA2D;AAChE9rF,UAAAA,GAAG,CAAC2qC,QAAJ,CAAa7+C,CAAb,EAAgB,iBAAhB,EAAmC,IAAnC;AACD;AACF;AACF,KATD;;AAUA,QAAImkE,MAAM,CAAC9iD,MAAP,KAAkB8iD,MAAM,CAAC9iD,MAAP,CAAcijB,KAAd,IAAuB6/B,MAAM,CAAC9iD,MAAP,CAAc2+E,cAAvD,CAAJ,EAA4E;AAC1EptF,MAAAA,KAAK,CAACL,IAAN,CAAWuB,IAAX,EAAiBssF,8BAAjB,EAAiD,YAAjD;AACAA,MAAAA,8BAA8B,CAACtsF,IAAD,CAA9B;AACD;AACF,GAfD;;AAgBA,MAAIusF,+BAA+B,GAAG,UAAUnsF,GAAV,EAAeiwD,MAAf,EAAuBV,IAAvB,EAA6B3vD,IAA7B,EAAmC;AACvE,QAAIqwD,MAAM,CAAC9iD,MAAP,IAAiB8iD,MAAM,CAAC9iD,MAAP,CAAci/E,eAAnC,EAAoD;AAClDrD,MAAAA,oBAAoB,CAACnpF,IAAD,EAAOqpF,QAAQ,CAACjpF,GAAD,EAAM,UAAN,CAAf,EAAkCkpF,UAAU,CAAClpF,GAAD,EAAM,iBAAN,EAAyBsvD,WAAW,CAACW,MAAM,CAAC9iD,MAAP,CAAci/E,eAAf,EAAgC78B,IAAhC,CAApC,CAA5C,CAApB;AACD;AACF,GAJD;;AAKA,MAAI88B,WAAW,GAAG,UAAUrsF,GAAV,EAAeiwD,MAAf,EAAuBV,IAAvB,EAA6B3vD,IAA7B,EAAmC;AACnD,QAAIqwD,MAAM,CAACljC,MAAP,KAAkB,KAAlB,IAA2BkjC,MAAM,CAACljC,MAAP,KAAkB,KAAjD,EAAwD;AACtDg8D,MAAAA,oBAAoB,CAACnpF,IAAD,EAAOqpF,QAAQ,CAACjpF,GAAD,EAAM,UAAN,CAAf,EAAkCkpF,UAAU,CAAClpF,GAAD,EAAM,UAAN,EAAkB,EAAlB,CAA5C,CAApB;AACAA,MAAAA,GAAG,CAAC6G,MAAJ,CAAW7G,GAAG,CAAC+2B,MAAJ,CAAWk5B,MAAM,CAACljC,MAAP,KAAkB,KAAlB,GAA0B,KAA1B,GAAkC,KAA7C,EAAoDntB,IAApD,CAAX,EAAsE,IAAtE;AACD;AACF,GALD;;AAMA,MAAI0sF,iBAAiB,GAAG,UAAUtxE,MAAV,EAAkB8oE,UAAlB,EAA8Bv0B,IAA9B,EAAoC3vD,IAApC,EAA0C;AAChEosF,IAAAA,MAAM,CAAClI,UAAD,EAAa,UAAU7zB,MAAV,EAAkB;AACnC+7B,MAAAA,MAAM,CAAChxE,MAAM,CAAChb,GAAP,CAAW+2B,MAAX,CAAkBk5B,MAAM,CAACljC,MAAzB,EAAiCntB,IAAjC,CAAD,EAAyC,UAAUyE,KAAV,EAAiB;AAC9D,YAAI,CAACgkF,aAAa,CAAChkF,KAAD,CAAlB,EAA2B;AACzB;AACD;;AACDymF,QAAAA,YAAY,CAAC9vE,MAAD,EAASi1C,MAAT,EAAiBV,IAAjB,EAAuBlrD,KAAvB,EAA8B4rD,MAAM,CAACsV,KAAP,GAAelhE,KAAf,GAAuB,IAArD,CAAZ;AACD,OALK,CAAN;AAMAukF,MAAAA,gBAAgB,CAAC5tE,MAAM,CAAChb,GAAR,EAAaiwD,MAAb,EAAqBrwD,IAArB,CAAhB;AACD,KARK,CAAN;AASD,GAVD;;AAWA,MAAI2sF,gBAAgB,GAAG,UAAUvxE,MAAV,EAAkBi1C,MAAlB,EAA0BnoE,IAA1B,EAAgCynE,IAAhC,EAAsC3vD,IAAtC,EAA4C;AACjE,QAAIqkF,SAAS,CAACjpE,MAAD,EAASpb,IAAI,CAAC0D,UAAd,EAA0Bxb,IAA1B,EAAgCynE,IAAhC,CAAb,EAAoD;AAClD,UAAIu7B,YAAY,CAAC9vE,MAAD,EAASi1C,MAAT,EAAiBV,IAAjB,EAAuB3vD,IAAvB,CAAhB,EAA8C;AAC5C;AACD;AACF;;AACD,QAAIqwD,MAAM,CAACu8B,kBAAX,EAA+B;AAC7BxxE,MAAAA,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqB3rC,IAAI,CAAC0D,UAA1B,EAAsC,UAAUtF,MAAV,EAAkB;AACtD,YAAIimF,SAAS,CAACjpE,MAAD,EAAShd,MAAT,EAAiBlW,IAAjB,EAAuBynE,IAAvB,CAAb,EAA2C;AACzCu7B,UAAAA,YAAY,CAAC9vE,MAAD,EAASi1C,MAAT,EAAiBV,IAAjB,EAAuB3vD,IAAvB,CAAZ;AACA,iBAAO,IAAP;AACD;AACF,OALD;AAMD;AACF,GAdD;;AAgBA,MAAI6sF,MAAM,GAAG/tF,KAAK,CAAC9R,IAAnB;;AACA,MAAI8/F,iBAAiB,GAAG,UAAUz8B,MAAV,EAAkBhzD,IAAlB,EAAwB;AAC9C,WAAO9K,iBAAiB,CAAC89D,MAAD,EAAShzD,IAAT,CAAxB;AACD,GAFD;;AAGA,MAAI0vF,eAAe,GAAG,UAAU/sF,IAAV,EAAgB;AACpC,WAAOA,IAAI,IAAIA,IAAI,CAACwB,QAAL,KAAkB,CAA1B,IAA+B,CAACgtD,gBAAgB,CAACxuD,IAAD,CAAhD,IAA0D,CAAC6sD,WAAW,CAAC7sD,IAAD,CAAtE,IAAgF,CAACmL,OAAO,CAACnL,IAAD,CAA/F;AACD,GAFD;;AAGA,MAAIgtF,WAAW,GAAG,UAAU5xE,MAAV,EAAkBi1C,MAAlB,EAA0BrwD,IAA1B,EAAgCitF,UAAhC,EAA4C;AAC5D,QAAI/oC,mBAAmB,CAAC9oC,MAAD,CAAnB,IAA+Bi2C,cAAc,CAAChB,MAAD,CAAjD,EAA2D;AACzD,UAAI68B,qBAAqB,GAAGr5F,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKunB,MAAM,CAAC8M,MAAP,CAAc+G,oBAAd,EAAL,CAAT,EAAqD;AACvFhB,QAAAA,EAAE,EAAE,EADmF;AAEvFC,QAAAA,EAAE,EAAE,EAFmF;AAGvFF,QAAAA,EAAE,EAAE,EAHmF;AAIvFD,QAAAA,EAAE,EAAE,EAJmF;AAKvFD,QAAAA,EAAE,EAAE,EALmF;AAMvFq/D,QAAAA,UAAU,EAAE,EAN2E;AAOvF/+E,QAAAA,OAAO,EAAE,EAP8E;AAQvFwzE,QAAAA,OAAO,EAAE,EAR8E;AASvFwL,QAAAA,OAAO,EAAE;AAT8E,OAArD,CAApC;;AAWA,UAAIC,mBAAmB,GAAG3J,SAAS,CAACljF,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAD,EAA6B,UAAUqG,OAAV,EAAmB;AACjF,eAAOwmD,WAAW,CAACxmD,OAAO,CAACjG,GAAT,CAAlB;AACD,OAFkC,CAAnC;AAGA,aAAO7N,iBAAiB,CAAC26F,qBAAD,EAAwBD,UAAxB,CAAjB,IAAwDloE,OAAO,CAACvkB,YAAY,CAACX,OAAb,CAAqBG,IAAI,CAAC0D,UAA1B,CAAD,EAAwC,KAAxC,CAA/D,IAAiH,CAAC2pF,mBAAzH;AACD,KAhBD,MAgBO;AACL,aAAO,KAAP;AACD;AACF,GApBD;;AAqBA,MAAIC,WAAW,GAAG,UAAU/9B,EAAV,EAAcrnE,IAAd,EAAoBynE,IAApB,EAA0B3vD,IAA1B,EAAgC;AAChD,QAAIkkF,UAAU,GAAG30B,EAAE,CAACkB,SAAH,CAAa1/D,GAAb,CAAiB7I,IAAjB,CAAjB;AACA,QAAImoE,MAAM,GAAG6zB,UAAU,CAAC,CAAD,CAAvB;AACA,QAAI1kC,WAAW,GAAG,CAACx/C,IAAD,IAASuvD,EAAE,CAACja,SAAH,CAAakK,WAAb,EAA3B;AACA,QAAIp/C,GAAG,GAAGmvD,EAAE,CAACnvD,GAAb;AACA,QAAIk1C,SAAS,GAAGia,EAAE,CAACja,SAAnB;;AACA,QAAIi4C,gBAAgB,GAAG,UAAUp/E,GAAV,EAAeq/E,GAAf,EAAoB;AACzCA,MAAAA,GAAG,GAAGA,GAAG,IAAIn9B,MAAb;;AACA,UAAIliD,GAAJ,EAAS;AACP,YAAIq/E,GAAG,CAACC,QAAR,EAAkB;AAChBD,UAAAA,GAAG,CAACC,QAAJ,CAAat/E,GAAb,EAAkBq/E,GAAlB,EAAuB79B,IAAvB,EAA6B3vD,IAA7B;AACD;;AACD6sF,QAAAA,MAAM,CAACW,GAAG,CAACjgF,MAAL,EAAa,UAAUziB,KAAV,EAAiB5C,IAAjB,EAAuB;AACxCkY,UAAAA,GAAG,CAAC2qC,QAAJ,CAAa58B,GAAb,EAAkBjmB,IAAlB,EAAwBwnE,WAAW,CAAC5kE,KAAD,EAAQ6kE,IAAR,CAAnC;AACD,SAFK,CAAN;;AAGA,YAAI69B,GAAG,CAACjgF,MAAR,EAAgB;AACd,cAAImgF,QAAQ,GAAGttF,GAAG,CAAC2pC,SAAJ,CAAc57B,GAAd,EAAmB,OAAnB,CAAf;;AACA,cAAIu/E,QAAJ,EAAc;AACZttF,YAAAA,GAAG,CAAC8pC,SAAJ,CAAc/7B,GAAd,EAAmB,gBAAnB,EAAqCu/E,QAArC;AACD;AACF;;AACDb,QAAAA,MAAM,CAACW,GAAG,CAACzgF,UAAL,EAAiB,UAAUjiB,KAAV,EAAiB5C,IAAjB,EAAuB;AAC5CkY,UAAAA,GAAG,CAAC8pC,SAAJ,CAAc/7B,GAAd,EAAmBjmB,IAAnB,EAAyBwnE,WAAW,CAAC5kE,KAAD,EAAQ6kE,IAAR,CAApC;AACD,SAFK,CAAN;AAGAk9B,QAAAA,MAAM,CAACW,GAAG,CAACx1C,OAAL,EAAc,UAAUltD,KAAV,EAAiB;AACnCA,UAAAA,KAAK,GAAG4kE,WAAW,CAAC5kE,KAAD,EAAQ6kE,IAAR,CAAnB;;AACA,cAAI,CAACvvD,GAAG,CAACykC,QAAJ,CAAa12B,GAAb,EAAkBrjB,KAAlB,CAAL,EAA+B;AAC7BsV,YAAAA,GAAG,CAAC4mC,QAAJ,CAAa74B,GAAb,EAAkBrjB,KAAlB;AACD;AACF,SALK,CAAN;AAMD;AACF,KAzBD;;AA0BA,QAAI6iG,cAAc,GAAG,UAAUzJ,UAAV,EAAsBlkF,IAAtB,EAA4B;AAC/C,UAAI4tF,KAAK,GAAG,KAAZ;;AACA,UAAI,CAACx8B,gBAAgB,CAACf,MAAD,CAArB,EAA+B;AAC7B,eAAO,KAAP;AACD;;AACDw8B,MAAAA,MAAM,CAAC3I,UAAD,EAAa,UAAU7zB,MAAV,EAAkB;AACnC,YAAI,eAAeA,MAAf,IAAyBA,MAAM,CAACjQ,SAAP,KAAqBZ,WAAlD,EAA+D;AAC7D;AACD;;AACD,YAAIp/C,GAAG,CAAC9T,EAAJ,CAAO0T,IAAP,EAAaqwD,MAAM,CAAC9uD,QAApB,KAAiC,CAACsrD,WAAW,CAAC7sD,IAAD,CAAjD,EAAyD;AACvDutF,UAAAA,gBAAgB,CAACvtF,IAAD,EAAOqwD,MAAP,CAAhB;AACAu9B,UAAAA,KAAK,GAAG,IAAR;AACA,iBAAO,KAAP;AACD;AACF,OATK,CAAN;AAUA,aAAOA,KAAP;AACD,KAhBD;;AAiBA,QAAIC,aAAa,GAAG,UAAUztF,GAAV,EAAei1C,GAAf,EAAoBkK,QAApB,EAA8BuuC,YAA9B,EAA4C;AAC9D,UAAIx3B,WAAW,GAAG,EAAlB;AACA,UAAIr6D,eAAe,GAAG,IAAtB;AACA,UAAI05D,QAAQ,GAAGtF,MAAM,CAACljC,MAAP,IAAiBkjC,MAAM,CAAC5O,KAAvC;AACA,UAAIssC,OAAO,GAAG3tF,GAAG,CAAC9C,MAAJ,CAAWq4D,QAAX,CAAd;AACA43B,MAAAA,gBAAgB,CAACQ,OAAD,CAAhB;AACA36B,MAAAA,MAAM,CAAChzD,GAAD,EAAMi1C,GAAN,EAAW,UAAUpnC,KAAV,EAAiB;AAChC,YAAI+/E,cAAJ;;AACA,YAAIt+E,OAAO,GAAG,UAAU1P,IAAV,EAAgB;AAC5B,cAAIuL,uBAAuB,GAAG,KAA9B;AACA,cAAIwgF,mBAAmB,GAAG9vF,eAA1B;AACA,cAAI4G,QAAQ,GAAG7C,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,EAAf;AACA,cAAIw2F,UAAU,GAAGjtF,IAAI,CAAC0D,UAAL,CAAgBb,QAAhB,CAAyBpM,WAAzB,EAAjB;;AACA,cAAI4T,WAAW,CAACrK,IAAD,CAAX,IAAqBI,GAAG,CAAC0uC,kBAAJ,CAAuB9uC,IAAvB,CAAzB,EAAuD;AACrD+rF,YAAAA,mBAAmB,GAAG9vF,eAAtB;AACAA,YAAAA,eAAe,GAAGmE,GAAG,CAAC0uC,kBAAJ,CAAuB9uC,IAAvB,MAAiC,MAAnD;AACAuL,YAAAA,uBAAuB,GAAG,IAA1B;AACD;;AACD,cAAIM,IAAI,CAAC7L,IAAD,CAAJ,IAAc,CAACgtF,WAAW,CAACz9B,EAAD,EAAKc,MAAL,EAAarwD,IAAb,EAAmBitF,UAAnB,CAA9B,EAA8D;AAC5De,YAAAA,cAAc,GAAG,IAAjB;;AACA,gBAAI78B,aAAa,CAACd,MAAD,CAAjB,EAA2B;AACzBjwD,cAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX;AACD;;AACD;AACD;;AACD,cAAIqwD,MAAM,CAAC1pD,OAAP,IAAkB09E,SAAS,CAAC90B,EAAD,EAAKvvD,IAAL,EAAW9X,IAAX,EAAiBynE,IAAjB,CAA/B,EAAuD;AACrDq+B,YAAAA,cAAc,GAAG,IAAjB;AACA;AACD;;AACD,cAAI/xF,eAAe,IAAI,CAACsP,uBAApB,IAA+C4lD,aAAa,CAACd,MAAD,CAA5D,IAAwE,CAACA,MAAM,CAAC1pD,OAAhF,IAA2F2oD,aAAa,CAACC,EAAD,EAAK1sD,QAAL,CAAxG,IAA0H6sB,OAAO,CAAC6/B,EAAD,EAAK09B,UAAL,EAAiBt3B,QAAjB,CAArI,EAAiK;AAC/J,gBAAIxnD,GAAG,GAAG/N,GAAG,CAACutC,MAAJ,CAAW3tC,IAAX,EAAiB21D,QAAjB,CAAV;AACA43B,YAAAA,gBAAgB,CAACp/E,GAAD,CAAhB;AACAmoD,YAAAA,WAAW,CAAClnE,IAAZ,CAAiB+e,GAAjB;AACA6/E,YAAAA,cAAc,GAAG,IAAjB;AACA;AACD;;AACD,cAAI58B,gBAAgB,CAACf,MAAD,CAApB,EAA8B;AAC5B,gBAAIu9B,KAAK,GAAGD,cAAc,CAACzJ,UAAD,EAAalkF,IAAb,CAA1B;;AACA,gBAAI,CAAC8sF,iBAAiB,CAACz8B,MAAD,EAAS,QAAT,CAAlB,IAAwCu9B,KAA5C,EAAmD;AACjDI,cAAAA,cAAc,GAAG,IAAjB;AACA;AACD;AACF;;AACD,cAAI/xF,eAAe,IAAI,CAACsP,uBAApB,IAA+CmkB,OAAO,CAAC6/B,EAAD,EAAKoG,QAAL,EAAe9yD,QAAf,CAAtD,IAAkF6sB,OAAO,CAAC6/B,EAAD,EAAK09B,UAAL,EAAiBt3B,QAAjB,CAAzF,IAAuH,EAAE,CAACm4B,YAAD,IAAiB9tF,IAAI,CAACwB,QAAL,KAAkB,CAAnC,IAAwCxB,IAAI,CAAC49B,SAAL,CAAex0C,MAAf,KAA0B,CAAlE,IAAuE4W,IAAI,CAAC49B,SAAL,CAAe7W,UAAf,CAA0B,CAA1B,MAAiC,KAA1G,CAAvH,IAA2O,CAAC8lC,WAAW,CAAC7sD,IAAD,CAAvP,KAAkQ,CAAC8sF,iBAAiB,CAACz8B,MAAD,EAAS,QAAT,CAAlB,IAAwC,CAACjwD,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAZ,CAA3S,CAAJ,EAAmU;AACjU,gBAAI,CAACguF,cAAL,EAAqB;AACnBA,cAAAA,cAAc,GAAG5tF,GAAG,CAAC3X,KAAJ,CAAUslG,OAAV,EAAmB,KAAnB,CAAjB;AACA/tF,cAAAA,IAAI,CAAC0D,UAAL,CAAgByC,YAAhB,CAA6B6nF,cAA7B,EAA6ChuF,IAA7C;AACAs2D,cAAAA,WAAW,CAAClnE,IAAZ,CAAiB4+F,cAAjB;AACD;;AACDA,YAAAA,cAAc,CAACvnF,WAAf,CAA2BzG,IAA3B;AACD,WAPD,MAOO;AACLguF,YAAAA,cAAc,GAAG,IAAjB;AACAnB,YAAAA,MAAM,CAAC/tF,KAAK,CAACC,IAAN,CAAWiB,IAAI,CAACN,UAAhB,CAAD,EAA8BgQ,OAA9B,CAAN;;AACA,gBAAInE,uBAAJ,EAA6B;AAC3BtP,cAAAA,eAAe,GAAG8vF,mBAAlB;AACD;;AACDiC,YAAAA,cAAc,GAAG,IAAjB;AACD;AACF,SAlDD;;AAmDAnB,QAAAA,MAAM,CAAC5+E,KAAD,EAAQyB,OAAR,CAAN;AACD,OAtDK,CAAN;;AAuDA,UAAI2gD,MAAM,CAAC64B,KAAP,KAAiB,IAArB,EAA2B;AACzB2D,QAAAA,MAAM,CAACv2B,WAAD,EAAc,UAAUt2D,IAAV,EAAgB;AAClC,cAAI0P,OAAO,GAAG,UAAU1P,IAAV,EAAgB;AAC5B,gBAAIA,IAAI,CAAC6C,QAAL,KAAkB,GAAtB,EAA2B;AACzB0qF,cAAAA,gBAAgB,CAACvtF,IAAD,EAAOqwD,MAAP,CAAhB;AACD;;AACDw8B,YAAAA,MAAM,CAAC/tF,KAAK,CAACC,IAAN,CAAWiB,IAAI,CAACN,UAAhB,CAAD,EAA8BgQ,OAA9B,CAAN;AACD,WALD;;AAMAA,UAAAA,OAAO,CAAC1P,IAAD,CAAP;AACD,SARK,CAAN;AASD;;AACD6sF,MAAAA,MAAM,CAACv2B,WAAD,EAAc,UAAUt2D,IAAV,EAAgB;AAClC,YAAIiuF,aAAa,GAAG,UAAUjuF,IAAV,EAAgB;AAClC,cAAIiX,KAAK,GAAG,CAAZ;AACA41E,UAAAA,MAAM,CAAC7sF,IAAI,CAACN,UAAN,EAAkB,UAAUM,IAAV,EAAgB;AACtC,gBAAI,CAACyvD,eAAe,CAACzvD,IAAD,CAAhB,IAA0B,CAACwuD,gBAAgB,CAACxuD,IAAD,CAA/C,EAAuD;AACrDiX,cAAAA,KAAK;AACN;AACF,WAJK,CAAN;AAKA,iBAAOA,KAAP;AACD,SARD;;AASA,YAAIi3E,mBAAmB,GAAG,UAAU3wF,IAAV,EAAgB;AACxC,cAAIkH,KAAK,GAAG,KAAZ;AACAooF,UAAAA,MAAM,CAACtvF,IAAI,CAACmC,UAAN,EAAkB,UAAUM,IAAV,EAAgB;AACtC,gBAAI+sF,eAAe,CAAC/sF,IAAD,CAAnB,EAA2B;AACzByE,cAAAA,KAAK,GAAGzE,IAAR;AACA,qBAAO,KAAP;AACD;AACF,WALK,CAAN;AAMA,iBAAOyE,KAAP;AACD,SATD;;AAUA,YAAI0pF,WAAW,GAAG,UAAUnuF,IAAV,EAAgB;AAChC,cAAIvX,KAAJ;AACA,cAAIgc,KAAK,GAAGypF,mBAAmB,CAACluF,IAAD,CAA/B;;AACA,cAAIyE,KAAK,IAAI,CAAC+pD,gBAAgB,CAAC/pD,KAAD,CAA1B,IAAqC6/E,SAAS,CAAClkF,GAAD,EAAMqE,KAAN,EAAa4rD,MAAb,CAAlD,EAAwE;AACtE5nE,YAAAA,KAAK,GAAG2X,GAAG,CAAC3X,KAAJ,CAAUgc,KAAV,EAAiB,KAAjB,CAAR;AACA8oF,YAAAA,gBAAgB,CAAC9kG,KAAD,CAAhB;AACA2X,YAAAA,GAAG,CAAChK,OAAJ,CAAY3N,KAAZ,EAAmBuX,IAAnB,EAAyB,IAAzB;AACAI,YAAAA,GAAG,CAAC6G,MAAJ,CAAWxC,KAAX,EAAkB,IAAlB;AACD;;AACD,iBAAOhc,KAAK,IAAIuX,IAAhB;AACD,SAVD;;AAWA,YAAIouF,UAAU,GAAGH,aAAa,CAACjuF,IAAD,CAA9B;;AACA,YAAI,CAACs2D,WAAW,CAACltE,MAAZ,GAAqB,CAArB,IAA0B,CAACgX,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAZ,CAA5B,KAAkDouF,UAAU,KAAK,CAArE,EAAwE;AACtEhuF,UAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX,EAAiB,IAAjB;AACA;AACD;;AACD,YAAIqxD,cAAc,CAAChB,MAAD,CAAd,IAA0BA,MAAM,CAAC1pD,OAArC,EAA8C;AAC5C,cAAI,CAAC0pD,MAAM,CAACsV,KAAR,IAAiByoB,UAAU,KAAK,CAApC,EAAuC;AACrCpuF,YAAAA,IAAI,GAAGmuF,WAAW,CAACnuF,IAAD,CAAlB;AACD;;AACD0sF,UAAAA,iBAAiB,CAACn9B,EAAD,EAAK20B,UAAL,EAAiBv0B,IAAjB,EAAuB3vD,IAAvB,CAAjB;AACA2sF,UAAAA,gBAAgB,CAACp9B,EAAD,EAAKc,MAAL,EAAanoE,IAAb,EAAmBynE,IAAnB,EAAyB3vD,IAAzB,CAAhB;AACAusF,UAAAA,+BAA+B,CAACnsF,GAAD,EAAMiwD,MAAN,EAAcV,IAAd,EAAoB3vD,IAApB,CAA/B;AACAqsF,UAAAA,4BAA4B,CAACjsF,GAAD,EAAMiwD,MAAN,EAAcV,IAAd,EAAoB3vD,IAApB,CAA5B;AACAysF,UAAAA,WAAW,CAACrsF,GAAD,EAAMiwD,MAAN,EAAcV,IAAd,EAAoB3vD,IAApB,CAAX;AACA8oF,UAAAA,aAAa,CAAC1oF,GAAD,EAAMiwD,MAAN,EAAcV,IAAd,EAAoB3vD,IAApB,CAAb;AACD;AACF,OA/CK,CAAN;AAgDD,KAxHD;;AAyHA,QAAII,GAAG,CAAC0uC,kBAAJ,CAAuBwG,SAAS,CAACoF,OAAV,EAAvB,MAAgD,OAApD,EAA6D;AAC3D16C,MAAAA,IAAI,GAAGs1C,SAAS,CAACoF,OAAV,EAAP;;AACA,WAAK,IAAIpxD,CAAC,GAAG,CAAR,EAAWqJ,CAAC,GAAGuxF,UAAU,CAAC96F,MAA/B,EAAuCE,CAAC,GAAGqJ,CAA3C,EAA8CrJ,CAAC,EAA/C,EAAmD;AACjD,YAAI+kG,UAAU,GAAGnK,UAAU,CAAC56F,CAAD,CAA3B;;AACA,YAAI+kG,UAAU,CAAClC,eAAX,IAA8B/6B,gBAAgB,CAACi9B,UAAD,CAA9C,IAA8DjuF,GAAG,CAAC9T,EAAJ,CAAO0T,IAAP,EAAaquF,UAAU,CAAC9sF,QAAxB,CAAlE,EAAqG;AACnGgsF,UAAAA,gBAAgB,CAACvtF,IAAD,EAAOquF,UAAP,CAAhB;AACA;AACD;AACF;;AACD;AACD;;AACD,QAAIh+B,MAAJ,EAAY;AACV,UAAIrwD,IAAJ,EAAU;AACR,YAAI+uD,MAAM,CAAC/uD,IAAD,CAAV,EAAkB;AAChB,cAAI,CAAC2tF,cAAc,CAACzJ,UAAD,EAAalkF,IAAb,CAAnB,EAAuC;AACrC,gBAAIq1C,GAAG,GAAGj1C,GAAG,CAAC+tC,SAAJ,EAAV;AACAkH,YAAAA,GAAG,CAAC8T,cAAJ,CAAmBnpD,IAAnB;AACAq1C,YAAAA,GAAG,CAACiH,WAAJ,CAAgBt8C,IAAhB;AACA6tF,YAAAA,aAAa,CAACztF,GAAD,EAAMyyD,SAAS,CAACtD,EAAD,EAAKla,GAAL,EAAU6uC,UAAV,CAAf,EAAsC,IAAtC,EAA4C,IAA5C,CAAb;AACD;AACF,SAPD,MAOO;AACL2J,UAAAA,aAAa,CAACztF,GAAD,EAAMJ,IAAN,EAAY,IAAZ,EAAkB,IAAlB,CAAb;AACD;AACF,OAXD,MAWO;AACL,YAAI,CAACw/C,WAAD,IAAgB,CAAC6R,cAAc,CAAChB,MAAD,CAA/B,IAA2CiE,kBAAkB,CAAC/E,EAAD,CAAlB,CAAuBnmE,MAAtE,EAA8E;AAC5E,cAAIklG,UAAU,GAAGh5C,SAAS,CAACoF,OAAV,EAAjB;AACA,cAAI6zC,WAAW,GAAGrK,UAAU,CAAC,CAAD,CAA5B;;AACA,cAAI,CAAC30B,EAAE,CAAC7zC,QAAH,CAAY8yE,iBAAb,IAAkCD,WAAW,CAACtJ,YAA9C,IAA8D,CAAC7kF,GAAG,CAACurC,SAAJ,CAAc2iD,UAAd,EAA0BluF,GAAG,CAAC4f,OAA9B,CAAnE,EAA2G;AACzGstE,YAAAA,WAAW,CAAC/9B,EAAD,EAAKg/B,WAAW,CAACtJ,YAAjB,CAAX;AACD;;AACD3vC,UAAAA,SAAS,CAACiZ,MAAV,CAAiB+vB,WAAW,CAAChpC,SAAS,CAACC,MAAV,EAAD,CAA5B;AACA6f,UAAAA,QAAQ,CAAC9f,SAAD,EAAY,IAAZ,EAAkB,UAAUiK,QAAV,EAAoB;AAC5CyV,YAAAA,WAAW,CAACzF,EAAD,EAAK,UAAU4H,YAAV,EAAwBs3B,IAAxB,EAA8B;AAC5C,kBAAIzH,WAAW,GAAGyH,IAAI,GAAGt3B,YAAH,GAAkBtE,SAAS,CAACtD,EAAD,EAAK4H,YAAL,EAAmB+sB,UAAnB,CAAjD;AACA2J,cAAAA,aAAa,CAACztF,GAAD,EAAM4mF,WAAN,CAAb;AACD,aAHU,CAAX;AAID,WALO,CAAR;AAMA/3B,UAAAA,SAAS,CAAC7uD,GAAD,EAAMk1C,SAAN,EAAiBA,SAAS,CAACC,MAAV,EAAjB,CAAT;AACAga,UAAAA,EAAE,CAACwN,WAAH;AACD,SAfD,MAeO;AACL6pB,UAAAA,gBAAgB,CAACr3B,EAAD,EAAKrnE,IAAL,EAAWynE,IAAX,CAAhB;AACD;AACF;;AACDs4B,MAAAA,WAAW,CAAC//F,IAAD,EAAOqnE,EAAP,CAAX;AACD;AACF,GAvND;;AAyNA,MAAIm/B,OAAO,GAAG,UAAUC,yBAAV,EAAqCvzE,MAArC,EAA6C;AACzD,QAAIwzE,cAAc,GAAGj+C,IAAI,CAAC,EAAD,CAAzB;AACAg+C,IAAAA,yBAAyB,CAACpiF,GAA1B,CAA8B,EAA9B;AACA6O,IAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwB,UAAUjd,CAAV,EAAa;AACnC46F,MAAAA,4BAA4B,CAACzzE,MAAD,EAASnnB,CAAC,CAACqN,OAAX,EAAoBstF,cAApB,EAAoCD,yBAAyB,CAAC59F,GAA1B,EAApC,CAA5B;AACD,KAFD;AAGD,GAND;;AAOA,MAAI89F,4BAA4B,GAAG,UAAUzzE,MAAV,EAAkBjN,GAAlB,EAAuBygF,cAAvB,EAAuCE,gBAAvC,EAAyD;AAC1F,QAAIC,WAAW,GAAGplG,IAAI,CAACilG,cAAc,CAAC79F,GAAf,EAAD,CAAtB;AACA,QAAIi+F,UAAU,GAAG,EAAjB;AACA,QAAIxI,cAAc,GAAG,EAArB;AACA,QAAI7iF,OAAO,GAAGvW,MAAM,CAAC6iE,YAAY,CAAC70C,MAAM,CAAChb,GAAR,EAAa+N,GAAb,CAAb,EAAgC,UAAUnO,IAAV,EAAgB;AAClE,aAAOA,IAAI,CAACwB,QAAL,KAAkB,CAAlB,IAAuB,CAACxB,IAAI,CAACkL,YAAL,CAAkB,gBAAlB,CAA/B;AACD,KAFmB,CAApB;AAGA7Z,IAAAA,MAAM,CAACy9F,gBAAD,EAAmB,UAAUl5E,IAAV,EAAgBy6C,MAAhB,EAAwB;AAC/CvxD,MAAAA,KAAK,CAAC9R,IAAN,CAAW2W,OAAX,EAAoB,UAAU3D,IAAV,EAAgB;AAClC,YAAIob,MAAM,CAACq1C,SAAP,CAAiB4zB,SAAjB,CAA2BrkF,IAA3B,EAAiCqwD,MAAjC,EAAyC,EAAzC,EAA6Cz6C,IAAI,CAAC6uE,OAAlD,CAAJ,EAAgE;AAC9D,cAAIsK,WAAW,CAAC1mG,OAAZ,CAAoBgoE,MAApB,MAAgC,CAAC,CAArC,EAAwC;AACtCrjE,YAAAA,IAAI,CAAC4oB,IAAI,CAACC,SAAN,EAAiB,UAAU9iB,QAAV,EAAoB;AACvCA,cAAAA,QAAQ,CAAC,IAAD,EAAO;AACbiN,gBAAAA,IAAI,EAAEA,IADO;AAEbqwD,gBAAAA,MAAM,EAAEA,MAFK;AAGb1sD,gBAAAA,OAAO,EAAEA;AAHI,eAAP,CAAR;AAKD,aANG,CAAJ;AAOAqrF,YAAAA,UAAU,CAAC3+B,MAAD,CAAV,GAAqBz6C,IAAI,CAACC,SAA1B;AACD;;AACD2wE,UAAAA,cAAc,CAACn2B,MAAD,CAAd,GAAyBz6C,IAAI,CAACC,SAA9B;AACA,iBAAO,KAAP;AACD;;AACD,YAAIouE,gCAAgC,CAAC7oE,MAAD,EAASpb,IAAT,EAAeqwD,MAAf,CAApC,EAA4D;AAC1D,iBAAO,KAAP;AACD;AACF,OAlBD;AAmBD,KApBK,CAAN;AAqBA,QAAI4+B,gBAAgB,GAAGC,sBAAsB,CAACN,cAAc,CAAC79F,GAAf,EAAD,EAAuBy1F,cAAvB,EAAuCr4E,GAAvC,EAA4CxK,OAA5C,CAA7C;AACAirF,IAAAA,cAAc,CAACriF,GAAf,CAAmB1Y,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKm7F,UAAL,CAAT,EAA2BC,gBAA3B,CAA3B;AACD,GA9BD;;AA+BA,MAAIC,sBAAsB,GAAG,UAAUN,cAAV,EAA0BpI,cAA1B,EAA0Cr4E,GAA1C,EAA+CxK,OAA/C,EAAwD;AACnF,WAAO3R,QAAQ,CAAC48F,cAAD,EAAiB,UAAU/4E,SAAV,EAAqBw6C,MAArB,EAA6B;AAC3D,UAAI,CAAC/9D,GAAG,CAACk0F,cAAD,EAAiBn2B,MAAjB,CAAR,EAAkC;AAChCrjE,QAAAA,IAAI,CAAC6oB,SAAD,EAAY,UAAU9iB,QAAV,EAAoB;AAClCA,UAAAA,QAAQ,CAAC,KAAD,EAAQ;AACdiN,YAAAA,IAAI,EAAEmO,GADQ;AAEdkiD,YAAAA,MAAM,EAAEA,MAFM;AAGd1sD,YAAAA,OAAO,EAAEA;AAHK,WAAR,CAAR;AAKD,SANG,CAAJ;AAOA,eAAO,KAAP;AACD,OATD,MASO;AACL,eAAO,IAAP;AACD;AACF,KAbc,CAAR,CAaJ9b,CAbH;AAcD,GAfD;;AAgBA,MAAIsnG,YAAY,GAAG,UAAUR,yBAAV,EAAqCS,OAArC,EAA8Cr8F,QAA9C,EAAwD0xF,OAAxD,EAAiE;AAClF,QAAI4K,iBAAiB,GAAGV,yBAAyB,CAAC59F,GAA1B,EAAxB;AACA/D,IAAAA,IAAI,CAACoiG,OAAO,CAACjyF,KAAR,CAAc,GAAd,CAAD,EAAqB,UAAUkzD,MAAV,EAAkB;AACzC,UAAI,CAACg/B,iBAAiB,CAACh/B,MAAD,CAAtB,EAAgC;AAC9Bg/B,QAAAA,iBAAiB,CAACh/B,MAAD,CAAjB,GAA4B;AAC1Bo0B,UAAAA,OAAO,EAAEA,OADiB;AAE1B5uE,UAAAA,SAAS,EAAE;AAFe,SAA5B;AAID;;AACDw5E,MAAAA,iBAAiB,CAACh/B,MAAD,CAAjB,CAA0Bx6C,SAA1B,CAAoCzmB,IAApC,CAAyC2D,QAAzC;AACD,KARG,CAAJ;AASA47F,IAAAA,yBAAyB,CAACpiF,GAA1B,CAA8B8iF,iBAA9B;AACD,GAZD;;AAaA,MAAIC,eAAe,GAAG,UAAUX,yBAAV,EAAqCS,OAArC,EAA8Cr8F,QAA9C,EAAwD;AAC5E,QAAIs8F,iBAAiB,GAAGV,yBAAyB,CAAC59F,GAA1B,EAAxB;AACA/D,IAAAA,IAAI,CAACoiG,OAAO,CAACjyF,KAAR,CAAc,GAAd,CAAD,EAAqB,UAAUkzD,MAAV,EAAkB;AACzCg/B,MAAAA,iBAAiB,CAACh/B,MAAD,CAAjB,CAA0Bx6C,SAA1B,GAAsCzoB,MAAM,CAACiiG,iBAAiB,CAACh/B,MAAD,CAAjB,CAA0Bx6C,SAA3B,EAAsC,UAAUnY,CAAV,EAAa;AAC7F,eAAOA,CAAC,KAAK3K,QAAb;AACD,OAF2C,CAA5C;;AAGA,UAAIs8F,iBAAiB,CAACh/B,MAAD,CAAjB,CAA0Bx6C,SAA1B,CAAoCzsB,MAApC,KAA+C,CAAnD,EAAsD;AACpD,eAAOimG,iBAAiB,CAACh/B,MAAD,CAAxB;AACD;AACF,KAPG,CAAJ;AAQAs+B,IAAAA,yBAAyB,CAACpiF,GAA1B,CAA8B8iF,iBAA9B;AACD,GAXD;;AAYA,MAAIE,qBAAqB,GAAG,UAAUn0E,MAAV,EAAkBuzE,yBAAlB,EAA6CS,OAA7C,EAAsDr8F,QAAtD,EAAgE0xF,OAAhE,EAAyE;AACnG,QAAIkK,yBAAyB,CAAC59F,GAA1B,OAAoC,IAAxC,EAA8C;AAC5C29F,MAAAA,OAAO,CAACC,yBAAD,EAA4BvzE,MAA5B,CAAP;AACD;;AACD+zE,IAAAA,YAAY,CAACR,yBAAD,EAA4BS,OAA5B,EAAqCr8F,QAArC,EAA+C0xF,OAA/C,CAAZ;AACA,WAAO;AACLruD,MAAAA,MAAM,EAAE,YAAY;AAClB,eAAOk5D,eAAe,CAACX,yBAAD,EAA4BS,OAA5B,EAAqCr8F,QAArC,CAAtB;AACD;AAHI,KAAP;AAKD,GAVD;;AAYA,MAAIy8F,MAAM,GAAG,UAAUp0E,MAAV,EAAkBlzB,IAAlB,EAAwBynE,IAAxB,EAA8B3vD,IAA9B,EAAoC;AAC/C,QAAIwtF,GAAG,GAAGpyE,MAAM,CAACq1C,SAAP,CAAiB1/D,GAAjB,CAAqB7I,IAArB,CAAV;;AACA,QAAI4V,KAAK,CAACsd,MAAD,EAASlzB,IAAT,EAAeynE,IAAf,EAAqB3vD,IAArB,CAAL,KAAoC,EAAE,YAAYwtF,GAAG,CAAC,CAAD,CAAjB,KAAyBA,GAAG,CAAC,CAAD,CAAH,CAAOgC,MAApE,CAAJ,EAAiF;AAC/E5D,MAAAA,QAAQ,CAACxwE,MAAD,EAASlzB,IAAT,EAAeynE,IAAf,EAAqB3vD,IAArB,CAAR;AACD,KAFD,MAEO;AACLstF,MAAAA,WAAW,CAAClyE,MAAD,EAASlzB,IAAT,EAAeynE,IAAf,EAAqB3vD,IAArB,CAAX;AACD;AACF,GAPD;;AASA,MAAIyvF,YAAY,GAAG,UAAUvrF,QAAV,EAAoB9E,KAApB,EAA2B;AAC5C,QAAIC,GAAG,GAAGD,KAAK,IAAI7C,QAAnB;AACA,QAAI+7C,QAAQ,GAAGj5C,GAAG,CAACilC,sBAAJ,EAAf;AACAt3C,IAAAA,IAAI,CAACkX,QAAD,EAAW,UAAU5C,OAAV,EAAmB;AAChCg3C,MAAAA,QAAQ,CAAC7xC,WAAT,CAAqBnF,OAAO,CAAClB,GAA7B;AACD,KAFG,CAAJ;AAGA,WAAOI,YAAY,CAACX,OAAb,CAAqBy4C,QAArB,CAAP;AACD,GAPD;;AASA,MAAIo3C,UAAU,GAAG,UAAUpuF,OAAV,EAAmB+H,KAAnB,EAA0B8xE,IAA1B,EAAgC;AAC/C,WAAO;AACL75E,MAAAA,OAAO,EAAEA,OADJ;AAEL+H,MAAAA,KAAK,EAAEA,KAFF;AAGL8xE,MAAAA,IAAI,EAAEA;AAHD,KAAP;AAKD,GAND;;AAOA,MAAIwU,QAAQ,GAAG,UAAUruF,OAAV,EAAmB84E,KAAnB,EAA0B;AACvC,WAAO;AACL94E,MAAAA,OAAO,EAAEA,OADJ;AAEL84E,MAAAA,KAAK,EAAEA;AAFF,KAAP;AAID,GALD;;AAMA,MAAIwV,YAAY,GAAG,UAAUjoG,CAAV,EAAaqB,CAAb,EAAgB;AACjC,WAAO;AACLrB,MAAAA,CAAC,EAAEA,CADE;AAELqB,MAAAA,CAAC,EAAEA;AAFE,KAAP;AAID,GALD;;AAMA,MAAI6mG,OAAO,GAAG,UAAU5hE,EAAV,EAAc57B,GAAd,EAAmB;AAC/B,QAAIvH,KAAK,GAAG47B,QAAQ,CAACha,KAAK,CAACuhB,EAAD,EAAK57B,GAAL,CAAN,EAAiB,EAAjB,CAApB;AACA,WAAO8uE,KAAK,CAACr2E,KAAD,CAAL,GAAe,CAAf,GAAmBA,KAA1B;AACD,GAHD;;AAIA,MAAIglG,OAAO,GAAG,UAAU/mE,KAAV,EAAiBphC,CAAjB,EAAoBqB,CAApB,EAAuBmlC,EAAvB,EAA2BF,EAA3B,EAA+B;AAC3C,QAAI8hE,OAAO,GAAGF,OAAO,CAAC5hE,EAAD,EAAK,SAAL,CAArB;AACA,QAAI+hE,OAAO,GAAGH,OAAO,CAAC5hE,EAAD,EAAK,SAAL,CAArB;AACA,QAAIktD,IAAI,GAAGpyD,KAAK,CAACoyD,IAAjB;;AACA,SAAK,IAAI8U,EAAE,GAAGjnG,CAAd,EAAiBinG,EAAE,GAAGjnG,CAAC,GAAG+mG,OAA1B,EAAmCE,EAAE,EAArC,EAAyC;AACvC,UAAI,CAAC9U,IAAI,CAAC8U,EAAD,CAAT,EAAe;AACb9U,QAAAA,IAAI,CAAC8U,EAAD,CAAJ,GAAWN,QAAQ,CAACrlD,IAAI,CAACnc,EAAD,CAAL,EAAW,EAAX,CAAnB;AACD;;AACD,WAAK,IAAI+hE,EAAE,GAAGvoG,CAAd,EAAiBuoG,EAAE,GAAGvoG,CAAC,GAAGqoG,OAA1B,EAAmCE,EAAE,EAArC,EAAyC;AACvC,YAAI9V,KAAK,GAAGe,IAAI,CAAC8U,EAAD,CAAJ,CAAS7V,KAArB;AACAA,QAAAA,KAAK,CAAC8V,EAAD,CAAL,GAAYD,EAAE,KAAKjnG,CAAP,IAAYknG,EAAE,KAAKvoG,CAAnB,GAAuBsmC,EAAvB,GAA4BjP,OAAO,CAACiP,EAAD,CAA/C;AACD;AACF;AACF,GAbD;;AAcA,MAAIkiE,UAAU,GAAG,UAAUpnE,KAAV,EAAiBphC,CAAjB,EAAoBqB,CAApB,EAAuB;AACtC,QAAImyF,IAAI,GAAGpyD,KAAK,CAACoyD,IAAjB;AACA,QAAIf,KAAK,GAAGe,IAAI,CAACnyF,CAAD,CAAJ,GAAUmyF,IAAI,CAACnyF,CAAD,CAAJ,CAAQoxF,KAAlB,GAA0B,EAAtC;AACA,WAAO,CAAC,CAACA,KAAK,CAACzyF,CAAD,CAAd;AACD,GAJD;;AAKA,MAAIyoG,UAAU,GAAG,UAAUrnE,KAAV,EAAiBphC,CAAjB,EAAoBqB,CAApB,EAAuB;AACtC,WAAOmnG,UAAU,CAACpnE,KAAD,EAAQphC,CAAR,EAAWqB,CAAX,CAAjB,EAAgC;AAC9BrB,MAAAA,CAAC;AACF;;AACD,WAAOA,CAAP;AACD,GALD;;AAMA,MAAI0oG,QAAQ,GAAG,UAAUlV,IAAV,EAAgB;AAC7B,WAAOlrF,KAAK,CAACkrF,IAAD,EAAO,UAAUnrF,GAAV,EAAesgG,GAAf,EAAoB;AACrC,aAAOA,GAAG,CAAClW,KAAJ,CAAUhxF,MAAV,GAAmB4G,GAAnB,GAAyBsgG,GAAG,CAAClW,KAAJ,CAAUhxF,MAAnC,GAA4C4G,GAAnD;AACD,KAFW,EAET,CAFS,CAAZ;AAGD,GAJD;;AAKA,MAAIugG,cAAc,GAAG,UAAUxnE,KAAV,EAAiBznB,OAAjB,EAA0B;AAC7C,QAAI65E,IAAI,GAAGpyD,KAAK,CAACoyD,IAAjB;;AACA,SAAK,IAAInyF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmyF,IAAI,CAAC/xF,MAAzB,EAAiCJ,CAAC,EAAlC,EAAsC;AACpC,UAAIoxF,KAAK,GAAGe,IAAI,CAACnyF,CAAD,CAAJ,CAAQoxF,KAApB;;AACA,WAAK,IAAIzyF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyyF,KAAK,CAAChxF,MAA1B,EAAkCzB,CAAC,EAAnC,EAAuC;AACrC,YAAIwa,IAAI,CAACi4E,KAAK,CAACzyF,CAAD,CAAN,EAAW2Z,OAAX,CAAR,EAA6B;AAC3B,iBAAOrT,QAAQ,CAACR,IAAT,CAAcmiG,YAAY,CAACjoG,CAAD,EAAIqB,CAAJ,CAA1B,CAAP;AACD;AACF;AACF;;AACD,WAAOiF,QAAQ,CAACrC,IAAT,EAAP;AACD,GAXD;;AAYA,MAAI4kG,WAAW,GAAG,UAAUznE,KAAV,EAAiB0nE,EAAjB,EAAqBC,EAArB,EAAyBl9E,EAAzB,EAA6Bm9E,EAA7B,EAAiC;AACjD,QAAIC,OAAO,GAAG,EAAd;AACA,QAAIzV,IAAI,GAAGpyD,KAAK,CAACoyD,IAAjB;;AACA,SAAK,IAAInyF,CAAC,GAAG0nG,EAAb,EAAiB1nG,CAAC,IAAI2nG,EAAtB,EAA0B3nG,CAAC,EAA3B,EAA+B;AAC7B,UAAIoxF,KAAK,GAAGe,IAAI,CAACnyF,CAAD,CAAJ,CAAQoxF,KAApB;AACA,UAAI1xF,KAAK,GAAG+nG,EAAE,GAAGj9E,EAAL,GAAU4mE,KAAK,CAAC1xF,KAAN,CAAY+nG,EAAZ,EAAgBj9E,EAAE,GAAG,CAArB,CAAV,GAAoC4mE,KAAK,CAAC1xF,KAAN,CAAY8qB,EAAZ,EAAgBi9E,EAAE,GAAG,CAArB,CAAhD;AACAG,MAAAA,OAAO,CAACxhG,IAAR,CAAaugG,QAAQ,CAACxU,IAAI,CAACnyF,CAAD,CAAJ,CAAQsY,OAAT,EAAkB5Y,KAAlB,CAArB;AACD;;AACD,WAAOkoG,OAAP;AACD,GATD;;AAUA,MAAIC,QAAQ,GAAG,UAAU9nE,KAAV,EAAiBuiC,QAAjB,EAA2B0C,MAA3B,EAAmC;AAChD,QAAIyiC,EAAE,GAAGnlC,QAAQ,CAAC3jE,CAAlB;AAAA,QAAqB+oG,EAAE,GAAGplC,QAAQ,CAACtiE,CAAnC;AACA,QAAIwqB,EAAE,GAAGw6C,MAAM,CAACrmE,CAAhB;AAAA,QAAmBgpG,EAAE,GAAG3iC,MAAM,CAAChlE,CAA/B;AACA,QAAI4nG,OAAO,GAAGF,EAAE,GAAGC,EAAL,GAAUH,WAAW,CAACznE,KAAD,EAAQ0nE,EAAR,EAAYC,EAAZ,EAAgBl9E,EAAhB,EAAoBm9E,EAApB,CAArB,GAA+CH,WAAW,CAACznE,KAAD,EAAQ0nE,EAAR,EAAYE,EAAZ,EAAgBn9E,EAAhB,EAAoBk9E,EAApB,CAAxE;AACA,WAAOhB,UAAU,CAAC3mE,KAAK,CAACznB,OAAP,EAAgB+uF,QAAQ,CAACO,OAAD,CAAxB,EAAmCA,OAAnC,CAAjB;AACD,GALD;;AAMA,MAAIE,cAAc,GAAG,UAAU/nE,KAAV,EAAiBoyD,IAAjB,EAAuB;AAC1C,QAAI4V,YAAY,GAAG/xE,OAAO,CAAC+J,KAAK,CAACznB,OAAP,CAA1B;AACA,QAAI0vF,SAAS,GAAGxwF,YAAY,CAACV,OAAb,CAAqB,OAArB,CAAhB;AACA+G,IAAAA,QAAQ,CAACmqF,SAAD,EAAY7V,IAAZ,CAAR;AACA70E,IAAAA,MAAM,CAACyqF,YAAD,EAAeC,SAAf,CAAN;AACA,WAAOD,YAAP;AACD,GAND;;AAOA,MAAIE,kBAAkB,GAAG,UAAUloE,KAAV,EAAiB;AACxC,WAAOh8B,GAAG,CAACg8B,KAAK,CAACoyD,IAAP,EAAa,UAAUmV,GAAV,EAAe;AACpC,UAAIlW,KAAK,GAAGrtF,GAAG,CAACujG,GAAG,CAAClW,KAAL,EAAY,UAAUQ,IAAV,EAAgB;AACzC,YAAI3sD,EAAE,GAAGqc,IAAI,CAACswC,IAAD,CAAb;AACA/tE,QAAAA,QAAQ,CAACohB,EAAD,EAAK,SAAL,CAAR;AACAphB,QAAAA,QAAQ,CAACohB,EAAD,EAAK,SAAL,CAAR;AACA,eAAOA,EAAP;AACD,OALc,CAAf;AAMA,UAAIE,EAAE,GAAGnP,OAAO,CAACsxE,GAAG,CAAChvF,OAAL,CAAhB;AACAuF,MAAAA,QAAQ,CAACsnB,EAAD,EAAKisD,KAAL,CAAR;AACA,aAAOjsD,EAAP;AACD,KAVS,CAAV;AAWD,GAZD;;AAaA,MAAI+iE,SAAS,GAAG,UAAUC,QAAV,EAAoB;AAClC,QAAIpoE,KAAK,GAAG2mE,UAAU,CAAC1wE,OAAO,CAACmyE,QAAD,CAAR,EAAoB,CAApB,EAAuB,EAAvB,CAAtB;AACAnkG,IAAAA,IAAI,CAAC+nD,aAAa,CAACo8C,QAAD,EAAW,IAAX,CAAd,EAAgC,UAAUhjE,EAAV,EAAcnlC,CAAd,EAAiB;AACnDgE,MAAAA,IAAI,CAAC+nD,aAAa,CAAC5mB,EAAD,EAAK,OAAL,CAAd,EAA6B,UAAUF,EAAV,EAActmC,CAAd,EAAiB;AAChDmoG,QAAAA,OAAO,CAAC/mE,KAAD,EAAQqnE,UAAU,CAACrnE,KAAD,EAAQphC,CAAR,EAAWqB,CAAX,CAAlB,EAAiCA,CAAjC,EAAoCmlC,EAApC,EAAwCF,EAAxC,CAAP;AACD,OAFG,CAAJ;AAGD,KAJG,CAAJ;AAKA,WAAOyhE,UAAU,CAAC3mE,KAAK,CAACznB,OAAP,EAAgB+uF,QAAQ,CAACtnE,KAAK,CAACoyD,IAAP,CAAxB,EAAsCpyD,KAAK,CAACoyD,IAA5C,CAAjB;AACD,GARD;;AASA,MAAIiW,KAAK,GAAG,UAAUroE,KAAV,EAAiB;AAC3B,WAAO+nE,cAAc,CAAC/nE,KAAD,EAAQkoE,kBAAkB,CAACloE,KAAD,CAA1B,CAArB;AACD,GAFD;;AAGA,MAAIsoE,UAAU,GAAG,UAAUtoE,KAAV,EAAiBo6C,YAAjB,EAA+BC,UAA/B,EAA2C;AAC1D,WAAOmtB,cAAc,CAACxnE,KAAD,EAAQo6C,YAAR,CAAd,CAAoCl2E,IAApC,CAAyC,UAAUq+D,QAAV,EAAoB;AAClE,aAAOilC,cAAc,CAACxnE,KAAD,EAAQq6C,UAAR,CAAd,CAAkCr2E,GAAlC,CAAsC,UAAUihE,MAAV,EAAkB;AAC7D,eAAO6iC,QAAQ,CAAC9nE,KAAD,EAAQuiC,QAAR,EAAkB0C,MAAlB,CAAf;AACD,OAFM,CAAP;AAGD,KAJM,CAAP;AAKD,GAND;;AAQA,MAAIsjC,uBAAuB,GAAG,UAAU3tF,OAAV,EAAmB;AAC/C,WAAOvT,IAAI,CAACuT,OAAD,EAAU,UAAUwK,GAAV,EAAe;AAClC,aAAOjmB,IAAI,CAACimB,GAAD,CAAJ,KAAc,IAAd,IAAsBjmB,IAAI,CAACimB,GAAD,CAAJ,KAAc,IAA3C;AACD,KAFU,CAAX;AAGD,GAJD;;AAKA,MAAIojF,4BAA4B,GAAG,UAAU5tF,OAAV,EAAmB0xC,GAAnB,EAAwB;AACzD,WAAOjlD,IAAI,CAACuT,OAAD,EAAU,UAAUwK,GAAV,EAAe;AAClC,aAAOjmB,IAAI,CAACimB,GAAD,CAAJ,KAAc,IAAd,IAAsBymD,sBAAsB,CAACzmD,GAAD,EAAMknC,GAAN,CAAnD;AACD,KAFU,CAAJ,CAEJjpD,IAFI,CAECvB,QAAQ,CAAC,EAAD,CAFT,EAEe,UAAU2mG,GAAV,EAAe;AACnC,aAAOF,uBAAuB,CAAC3tF,OAAD,CAAvB,CAAiC5W,GAAjC,CAAqC,UAAU0kG,QAAV,EAAoB;AAC9D,YAAIC,OAAO,GAAGlxF,YAAY,CAACV,OAAb,CAAqB5X,IAAI,CAACupG,QAAD,CAAzB,CAAd;AACA,YAAIE,UAAU,GAAG1/F,QAAQ,CAAC0b,SAAS,CAAC8jF,QAAD,CAAV,EAAsB,UAAUG,MAAV,EAAkB1pG,IAAlB,EAAwB;AACrE,iBAAO8P,UAAU,CAAC9P,IAAD,EAAO,YAAP,CAAjB;AACD,SAFwB,CAAzB;AAGAklB,QAAAA,QAAQ,CAACskF,OAAD,EAAUC,UAAV,CAAR;AACA,eAAO,CACLnxF,YAAY,CAACV,OAAb,CAAqB,IAArB,CADK,EAEL4xF,OAFK,CAAP;AAID,OAVM,EAUJllG,KAVI,CAUE,EAVF,CAAP;AAWD,KAdM,CAAP;AAeD,GAhBD;;AAiBA,MAAIqlG,MAAM,GAAG,UAAUC,QAAV,EAAoBvmD,IAApB,EAA0B;AACrC,QAAIwmD,OAAO,GAAG9hG,KAAK,CAACs7C,IAAD,EAAO,UAAUv7C,GAAV,EAAeme,GAAf,EAAoB;AAC5C7H,MAAAA,MAAM,CAAC6H,GAAD,EAAMne,GAAN,CAAN;AACA,aAAOme,GAAP;AACD,KAHkB,EAGhB2jF,QAHgB,CAAnB;AAIA,WAAOvmD,IAAI,CAACniD,MAAL,GAAc,CAAd,GAAkBqmG,YAAY,CAAC,CAACsC,OAAD,CAAD,CAA9B,GAA4CA,OAAnD;AACD,GAND;;AAOA,MAAIC,kBAAkB,GAAG,UAAUC,qBAAV,EAAiC;AACxD,QAAI3xE,UAAU,CAAC2xE,qBAAD,CAAd,EAAuC;AACrC,aAAO7zF,MAAM,CAAC6zF,qBAAD,CAAN,CAA8B7kG,MAA9B,CAAqCizB,MAArC,EAA6Cj0B,IAA7C,CAAkDvB,QAAQ,CAAC,EAAD,CAA1D,EAAgE,UAAU6mG,OAAV,EAAmB;AACxF,eAAO,CACLO,qBADK,EAELP,OAFK,CAAP;AAID,OALM,CAAP;AAMD,KAPD,MAOO;AACL,aAAOrxE,MAAM,CAAC4xE,qBAAD,CAAN,GAAgC,CAACA,qBAAD,CAAhC,GAA0D,EAAjE;AACD;AACF,GAXD;;AAYA,MAAIC,eAAe,GAAG,UAAUtzE,QAAV,EAAoBy2B,GAApB,EAAyB;AAC7C,QAAI48C,qBAAqB,GAAGzxF,YAAY,CAACX,OAAb,CAAqBw1C,GAAG,CAACq1B,uBAAzB,CAA5B;AACA,QAAI/mE,OAAO,GAAGgxE,cAAc,CAACsd,qBAAD,EAAwBrzE,QAAxB,CAA5B;AACA,QAAIuzE,YAAY,GAAG/kG,MAAM,CAACuW,OAAD,EAAU,UAAUwK,GAAV,EAAe;AAChD,aAAO+R,QAAQ,CAAC/R,GAAD,CAAR,IAAiB4R,SAAS,CAAC5R,GAAD,CAAjC;AACD,KAFwB,CAAzB;AAGA,QAAIikF,YAAY,GAAGb,4BAA4B,CAAC5tF,OAAD,EAAU0xC,GAAV,CAA/C;AACA,QAAIg9C,WAAW,GAAGF,YAAY,CAAC9mG,MAAb,CAAoB+mG,YAAY,CAAChpG,MAAb,GAAsBgpG,YAAtB,GAAqCJ,kBAAkB,CAACC,qBAAD,CAA3E,CAAlB;AACA,WAAOllG,GAAG,CAACslG,WAAD,EAAcrzE,OAAd,CAAV;AACD,GATD;;AAUA,MAAIszE,aAAa,GAAG,YAAY;AAC9B,WAAO7C,YAAY,CAAC,EAAD,CAAnB;AACD,GAFD;;AAGA,MAAI8C,oBAAoB,GAAG,UAAU3zE,QAAV,EAAoBy2B,GAApB,EAAyB;AAClD,WAAOw8C,MAAM,CAACrxF,YAAY,CAACX,OAAb,CAAqBw1C,GAAG,CAACsqC,aAAJ,EAArB,CAAD,EAA4CuS,eAAe,CAACtzE,QAAD,EAAWy2B,GAAX,CAA3D,CAAb;AACD,GAFD;;AAGA,MAAIm9C,cAAc,GAAG,UAAU7jF,OAAV,EAAmBisE,IAAnB,EAAyB;AAC5C,WAAO9gE,UAAU,CAAC8gE,IAAD,EAAO,OAAP,EAAgB5vF,KAAK,CAACmX,IAAD,EAAOwM,OAAP,CAArB,CAAjB;AACD,GAFD;;AAGA,MAAI8jF,gBAAgB,GAAG,UAAU7zE,QAAV,EAAoB8zE,kBAApB,EAAwC;AAC7D,WAAOF,cAAc,CAAC5zE,QAAD,EAAW8zE,kBAAkB,CAAC,CAAD,CAA7B,CAAd,CAAgDzlG,IAAhD,CAAqD,UAAUkkG,QAAV,EAAoB;AAC9E,UAAIwB,SAAS,GAAGD,kBAAkB,CAAC,CAAD,CAAlC;AACA,UAAIE,QAAQ,GAAGF,kBAAkB,CAACA,kBAAkB,CAACtpG,MAAnB,GAA4B,CAA7B,CAAjC;AACA,UAAIypG,cAAc,GAAG3B,SAAS,CAACC,QAAD,CAA9B;AACA,aAAOE,UAAU,CAACwB,cAAD,EAAiBF,SAAjB,EAA4BC,QAA5B,CAAV,CAAgD7lG,GAAhD,CAAoD,UAAU+lG,mBAAV,EAA+B;AACxF,eAAOrD,YAAY,CAAC,CAAC2B,KAAK,CAAC0B,mBAAD,CAAN,CAAD,CAAnB;AACD,OAFM,CAAP;AAGD,KAPM,EAOJrmG,UAPI,CAOO6lG,aAPP,CAAP;AAQD,GATD;;AAUA,MAAIS,oBAAoB,GAAG,UAAUn0E,QAAV,EAAoBi1C,MAApB,EAA4B;AACrD,WAAOA,MAAM,CAACzqE,MAAP,GAAgB,CAAhB,IAAqByqE,MAAM,CAAC,CAAD,CAAN,CAAUzT,SAA/B,GAA2CkyC,aAAa,EAAxD,GAA6DC,oBAAoB,CAAC3zE,QAAD,EAAWi1C,MAAM,CAAC,CAAD,CAAjB,CAAxF;AACD,GAFD;;AAGA,MAAIm/B,MAAM,GAAG,UAAUp0E,QAAV,EAAoBi1C,MAApB,EAA4B;AACvC,QAAIQ,aAAa,GAAGD,2BAA2B,CAACP,MAAD,EAASj1C,QAAT,CAA/C;AACA,WAAOy1C,aAAa,CAACjrE,MAAd,GAAuB,CAAvB,GAA2BqpG,gBAAgB,CAAC7zE,QAAD,EAAWy1C,aAAX,CAA3C,GAAuE0+B,oBAAoB,CAACn0E,QAAD,EAAWi1C,MAAX,CAAlG;AACD,GAHD;;AAKA,MAAIo/B,0BAA0B,GAAG,UAAU/yF,IAAV,EAAgB;AAC/C,WAAOA,IAAI,CAAC9J,OAAL,CAAa,iBAAb,EAAgC,EAAhC,CAAP;AACD,GAFD;;AAGA,MAAI88F,uBAAuB,GAAG,UAAUhzF,IAAV,EAAgBhN,KAAhB,EAAuB;AACnD,WAAOA,KAAK,IAAI,CAAT,IAAcA,KAAK,GAAGgN,IAAI,CAAC9W,MAA3B,IAAqCylE,cAAc,CAAC3uD,IAAI,CAAC6hB,MAAL,CAAY7uB,KAAZ,CAAD,CAA1D;AACD,GAFD;;AAGA,MAAIigG,YAAY,GAAG,UAAUC,GAAV,EAAeC,UAAf,EAA2B;AAC5C,QAAInzF,IAAI,GAAGghB,MAAM,CAACkyE,GAAG,CAAChtE,SAAL,CAAjB;AACA,WAAOitE,UAAU,GAAGJ,0BAA0B,CAAC/yF,IAAD,CAA7B,GAAsCA,IAAvD;AACD,GAHD;;AAIA,MAAIozF,kBAAkB,GAAG,UAAUC,cAAV,EAA0B;AACjD,WAAOA,cAAc,CAACxmG,GAAf,CAAmB,UAAU00D,KAAV,EAAiB;AACzC,aAAOA,KAAK,CAAC5+C,QAAb;AACD,KAFM,EAEJrW,KAFI,CAEE,KAFF,EAESiK,WAFT,EAAP;AAGD,GAJD;;AAKA,MAAI+8F,cAAc,GAAG,UAAUp4E,MAAV,EAAkB;AACrC,WAAOntB,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAd,EAAyCxoD,GAAzC,CAA6C,UAAUsoD,GAAV,EAAe;AACjE,UAAIk+C,cAAc,GAAGtlG,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqB0J,GAAG,CAACq1B,uBAAzB,EAAkDtvD,MAAM,CAAChb,GAAP,CAAW4f,OAA7D,CAAd,CAArB;AACA,UAAI1Y,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAAX;AACA,UAAIi+C,eAAe,GAAGH,kBAAkB,CAACC,cAAD,CAAxC;AACA,UAAIG,gBAAgB,GAAG73F,GAAG,CAACjH,OAAJ,CAAY2E,IAAZ,MAAsBk6F,eAAe,KAAK,KAAjE;AACA,UAAIL,GAAG,GAAGh4E,MAAM,CAAChb,GAAP,CAAWqoB,GAAX,CAAenhB,IAAf,EAAqBmsF,eAArB,EAAsC;AAC9C,0BAAkB,KAD4B;AAE9C,iBAAS;AAFqC,OAAtC,EAGPp+C,GAAG,CAACsqC,aAAJ,EAHO,CAAV;AAIA,UAAIz/E,IAAI,GAAGizF,YAAY,CAACC,GAAD,EAAMM,gBAAN,CAAvB;AACA,UAAIC,eAAe,GAAGzyE,MAAM,CAACkyE,GAAG,CAACrsF,WAAL,CAA5B;AACAqU,MAAAA,MAAM,CAAChb,GAAP,CAAW6G,MAAX,CAAkBmsF,GAAlB;;AACA,UAAIF,uBAAuB,CAACS,eAAD,EAAkB,CAAlB,CAAvB,IAA+CT,uBAAuB,CAACS,eAAD,EAAkBA,eAAe,CAACvqG,MAAhB,GAAyB,CAA3C,CAA1E,EAAyH;AACvH,YAAIywF,WAAW,GAAG0Z,cAAc,CAAC/mG,KAAf,CAAqB8a,IAArB,CAAlB;AACA,YAAIssF,eAAe,GAAGT,YAAY,CAACtZ,WAAD,EAAc6Z,gBAAd,CAAlC;AACA,YAAIG,SAAS,GAAGD,eAAe,CAACvrG,OAAhB,CAAwB6X,IAAxB,CAAhB;;AACA,YAAI2zF,SAAS,KAAK,CAAC,CAAnB,EAAsB;AACpB,iBAAO3zF,IAAP;AACD,SAFD,MAEO;AACL,cAAI4zF,kBAAkB,GAAGZ,uBAAuB,CAACU,eAAD,EAAkBC,SAAS,GAAG,CAA9B,CAAhD;AACA,cAAIE,gBAAgB,GAAGb,uBAAuB,CAACU,eAAD,EAAkBC,SAAS,GAAG3zF,IAAI,CAAC9W,MAAnC,CAA9C;AACA,iBAAO,CAAC0qG,kBAAkB,GAAG,GAAH,GAAS,EAA5B,IAAkC5zF,IAAlC,IAA0C6zF,gBAAgB,GAAG,GAAH,GAAS,EAAnE,CAAP;AACD;AACF,OAXD,MAWO;AACL,eAAO7zF,IAAP;AACD;AACF,KA1BM,EA0BJ1T,KA1BI,CA0BE,EA1BF,CAAP;AA2BD,GA5BD;;AA6BA,MAAIwnG,oBAAoB,GAAG,UAAU54E,MAAV,EAAkB/wB,IAAlB,EAAwB;AACjD,QAAIgrD,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AAAA,QAAqC0+C,MAAM,GAAG74E,MAAM,CAAChb,GAAP,CAAW9C,MAAX,CAAkB,MAAlB,CAA9C;AACA,QAAIy3D,GAAG,GAAG35C,MAAM,CAACk6B,SAAP,CAAiBif,MAAjB,EAAV;AACA,QAAIV,MAAM,GAAGkX,aAAa,CAAC3vD,MAAD,EAASw4C,SAAS,CAACmB,GAAD,CAAlB,CAA1B;AACA,QAAIzc,QAAQ,GAAGjuD,IAAI,CAAC6pG,UAAL,GAAkBlB,MAAM,CAACxyF,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAD,EAAyCqe,MAAzC,CAAN,CAAuDzzD,GAAzE,GAA+Ei1C,GAAG,CAACsqC,aAAJ,EAA9F;;AACA,QAAIrnC,QAAJ,EAAc;AACZ27C,MAAAA,MAAM,CAACxtF,WAAP,CAAmB6xC,QAAnB;AACD;;AACD,WAAOl9B,MAAM,CAACk6B,SAAP,CAAiB+B,UAAjB,CAA4BnlB,SAA5B,CAAsC+hE,MAAtC,EAA8C5pG,IAA9C,CAAP;AACD,GATD;;AAUA,MAAI8pG,0BAA0B,GAAG,UAAU/4E,MAAV,EAAkBi1C,MAAlB,EAA0BhmE,IAA1B,EAAgC;AAC/D,QAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AACnBA,MAAAA,IAAI,GAAG,EAAP;AACD;;AACDA,IAAAA,IAAI,CAAC0G,GAAL,GAAW,IAAX;AACA1G,IAAAA,IAAI,CAACgmE,MAAL,GAAcA,MAAd;AACAhmE,IAAAA,IAAI,CAACirD,SAAL,GAAiB,IAAjB;AACAjrD,IAAAA,IAAI,GAAG+wB,MAAM,CAACmb,IAAP,CAAY,kBAAZ,EAAgClsC,IAAhC,CAAP;;AACA,QAAIA,IAAI,CAAC8oC,kBAAL,EAAJ,EAA+B;AAC7B/X,MAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0BlsC,IAA1B;AACA,aAAOA,IAAI,CAACu8C,OAAZ;AACD;;AACD,QAAIv8C,IAAI,CAACgmE,MAAL,KAAgB,MAApB,EAA4B;AAC1B,aAAOmjC,cAAc,CAACp4E,MAAD,CAArB;AACD,KAFD,MAEO;AACL/wB,MAAAA,IAAI,CAACinF,QAAL,GAAgB,IAAhB;AACA,UAAI1qC,OAAO,GAAGotD,oBAAoB,CAAC54E,MAAD,EAAS/wB,IAAT,CAAlC;;AACA,UAAIA,IAAI,CAACgmE,MAAL,KAAgB,MAApB,EAA4B;AAC1B,eAAOzpB,OAAP;AACD,OAFD,MAEO;AACLv8C,QAAAA,IAAI,CAACu8C,OAAL,GAAexrB,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,KAAiC,EAAjC,GAAsC5Y,OAArD;AACAxrB,QAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0BlsC,IAA1B;AACA,eAAOA,IAAI,CAACu8C,OAAZ;AACD;AACF;AACF,GAzBD;;AA2BA,MAAIwtD,IAAI,GAAG,CAAX;AAAA,MAAcC,MAAM,GAAG,CAAvB;AAAA,MAA0B17B,MAAM,GAAG,CAAnC;;AACA,MAAI98B,IAAI,GAAG,UAAUt0B,IAAV,EAAgBgC,KAAhB,EAAuB;AAChC,QAAI+hC,IAAI,GAAG/jC,IAAI,CAACne,MAAL,GAAcmgB,KAAK,CAACngB,MAApB,GAA6B,CAAxC;AACA,QAAIkrG,KAAK,GAAG,IAAIxsG,KAAJ,CAAUwjD,IAAV,CAAZ;AACA,QAAIipD,GAAG,GAAG,IAAIzsG,KAAJ,CAAUwjD,IAAV,CAAV;;AACA,QAAIkpD,KAAK,GAAG,UAAU38F,KAAV,EAAiB4nD,GAAjB,EAAsBg1C,IAAtB,EAA4B;AACtC,aAAO;AACL58F,QAAAA,KAAK,EAAEA,KADF;AAEL4nD,QAAAA,GAAG,EAAEA,GAFA;AAGLg1C,QAAAA,IAAI,EAAEA;AAHD,OAAP;AAKD,KAND;;AAOA,QAAIC,WAAW,GAAG,UAAUC,MAAV,EAAkBC,IAAlB,EAAwBC,MAAxB,EAAgCC,IAAhC,EAAsC9rE,MAAtC,EAA8C;AAC9D,UAAI+rE,MAAM,GAAGC,cAAc,CAACL,MAAD,EAASC,IAAT,EAAeC,MAAf,EAAuBC,IAAvB,CAA3B;;AACA,UAAIC,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACl9F,KAAP,KAAiB+8F,IAAjB,IAAyBG,MAAM,CAACN,IAAP,KAAgBG,IAAI,GAAGE,IAAnE,IAA2EC,MAAM,CAACt1C,GAAP,KAAek1C,MAAf,IAAyBI,MAAM,CAACN,IAAP,KAAgBE,MAAM,GAAGE,MAAjI,EAAyI;AACvI,YAAIvrG,CAAC,GAAGqrG,MAAR;AACA,YAAIrgG,CAAC,GAAGugG,MAAR;;AACA,eAAOvrG,CAAC,GAAGsrG,IAAJ,IAAYtgG,CAAC,GAAGwgG,IAAvB,EAA6B;AAC3B,cAAIxrG,CAAC,GAAGsrG,IAAJ,IAAYtgG,CAAC,GAAGwgG,IAAhB,IAAwBvtF,IAAI,CAACje,CAAD,CAAJ,KAAYigB,KAAK,CAACjV,CAAD,CAA7C,EAAkD;AAChD00B,YAAAA,MAAM,CAAC55B,IAAP,CAAY,CACVglG,IADU,EAEV7sF,IAAI,CAACje,CAAD,CAFM,CAAZ;AAIA,cAAEA,CAAF;AACA,cAAEgL,CAAF;AACD,WAPD,MAOO;AACL,gBAAIsgG,IAAI,GAAGD,MAAP,GAAgBG,IAAI,GAAGD,MAA3B,EAAmC;AACjC7rE,cAAAA,MAAM,CAAC55B,IAAP,CAAY,CACVupE,MADU,EAEVpxD,IAAI,CAACje,CAAD,CAFM,CAAZ;AAIA,gBAAEA,CAAF;AACD,aAND,MAMO;AACL0/B,cAAAA,MAAM,CAAC55B,IAAP,CAAY,CACVilG,MADU,EAEV9qF,KAAK,CAACjV,CAAD,CAFK,CAAZ;AAIA,gBAAEA,CAAF;AACD;AACF;AACF;AACF,OA3BD,MA2BO;AACLogG,QAAAA,WAAW,CAACC,MAAD,EAASI,MAAM,CAACl9F,KAAhB,EAAuBg9F,MAAvB,EAA+BE,MAAM,CAACl9F,KAAP,GAAek9F,MAAM,CAACN,IAArD,EAA2DzrE,MAA3D,CAAX;;AACA,aAAK,IAAIisE,EAAE,GAAGF,MAAM,CAACl9F,KAArB,EAA4Bo9F,EAAE,GAAGF,MAAM,CAACt1C,GAAxC,EAA6C,EAAEw1C,EAA/C,EAAmD;AACjDjsE,UAAAA,MAAM,CAAC55B,IAAP,CAAY,CACVglG,IADU,EAEV7sF,IAAI,CAAC0tF,EAAD,CAFM,CAAZ;AAID;;AACDP,QAAAA,WAAW,CAACK,MAAM,CAACt1C,GAAR,EAAam1C,IAAb,EAAmBG,MAAM,CAACt1C,GAAP,GAAas1C,MAAM,CAACN,IAAvC,EAA6CK,IAA7C,EAAmD9rE,MAAnD,CAAX;AACD;AACF,KAvCD;;AAwCA,QAAIksE,UAAU,GAAG,UAAUr9F,KAAV,EAAiB48F,IAAjB,EAAuBG,IAAvB,EAA6BE,IAA7B,EAAmC;AAClD,UAAIr1C,GAAG,GAAG5nD,KAAV;;AACA,aAAO4nD,GAAG,GAAGg1C,IAAN,GAAaK,IAAb,IAAqBr1C,GAAG,GAAGm1C,IAA3B,IAAmCrtF,IAAI,CAACk4C,GAAD,CAAJ,KAAcl2C,KAAK,CAACk2C,GAAG,GAAGg1C,IAAP,CAA7D,EAA2E;AACzE,UAAEh1C,GAAF;AACD;;AACD,aAAO+0C,KAAK,CAAC38F,KAAD,EAAQ4nD,GAAR,EAAag1C,IAAb,CAAZ;AACD,KAND;;AAOA,QAAIO,cAAc,GAAG,UAAUL,MAAV,EAAkBC,IAAlB,EAAwBC,MAAxB,EAAgCC,IAAhC,EAAsC;AACzD,UAAIj6D,CAAC,GAAG+5D,IAAI,GAAGD,MAAf;AACA,UAAIzoG,CAAC,GAAG4oG,IAAI,GAAGD,MAAf;;AACA,UAAIh6D,CAAC,KAAK,CAAN,IAAW3uC,CAAC,KAAK,CAArB,EAAwB;AACtB,eAAO,IAAP;AACD;;AACD,UAAIgnF,KAAK,GAAGr4C,CAAC,GAAG3uC,CAAhB;AACA,UAAIipG,GAAG,GAAGjpG,CAAC,GAAG2uC,CAAd;AACA,UAAI7Y,MAAM,GAAG,CAACmzE,GAAG,GAAG,CAAN,KAAY,CAAZ,GAAgBA,GAAhB,GAAsBA,GAAG,GAAG,CAA7B,IAAkC,CAA/C;AACAb,MAAAA,KAAK,CAAC,IAAItyE,MAAL,CAAL,GAAoB2yE,MAApB;AACAJ,MAAAA,GAAG,CAAC,IAAIvyE,MAAL,CAAH,GAAkB4yE,IAAI,GAAG,CAAzB;AACA,UAAIj2F,CAAJ,EAAOnN,CAAP,EAAUlI,CAAV,EAAa3B,CAAb,EAAgBqB,CAAhB;;AACA,WAAK2V,CAAC,GAAG,CAAT,EAAYA,CAAC,IAAIqjB,MAAjB,EAAyB,EAAErjB,CAA3B,EAA8B;AAC5B,aAAKnN,CAAC,GAAG,CAACmN,CAAV,EAAanN,CAAC,IAAImN,CAAlB,EAAqBnN,CAAC,IAAI,CAA1B,EAA6B;AAC3BlI,UAAAA,CAAC,GAAGkI,CAAC,GAAGwwB,MAAR;;AACA,cAAIxwB,CAAC,KAAK,CAACmN,CAAP,IAAYnN,CAAC,KAAKmN,CAAN,IAAW21F,KAAK,CAAChrG,CAAC,GAAG,CAAL,CAAL,GAAegrG,KAAK,CAAChrG,CAAC,GAAG,CAAL,CAA/C,EAAwD;AACtDgrG,YAAAA,KAAK,CAAChrG,CAAD,CAAL,GAAWgrG,KAAK,CAAChrG,CAAC,GAAG,CAAL,CAAhB;AACD,WAFD,MAEO;AACLgrG,YAAAA,KAAK,CAAChrG,CAAD,CAAL,GAAWgrG,KAAK,CAAChrG,CAAC,GAAG,CAAL,CAAL,GAAe,CAA1B;AACD;;AACD3B,UAAAA,CAAC,GAAG2sG,KAAK,CAAChrG,CAAD,CAAT;AACAN,UAAAA,CAAC,GAAGrB,CAAC,GAAGgtG,MAAJ,GAAaE,MAAb,GAAsBrjG,CAA1B;;AACA,iBAAO7J,CAAC,GAAGitG,IAAJ,IAAY5rG,CAAC,GAAG8rG,IAAhB,IAAwBvtF,IAAI,CAAC5f,CAAD,CAAJ,KAAY4hB,KAAK,CAACvgB,CAAD,CAAhD,EAAqD;AACnDsrG,YAAAA,KAAK,CAAChrG,CAAD,CAAL,GAAW,EAAE3B,CAAb;AACA,cAAEqB,CAAF;AACD;;AACD,cAAIkqF,KAAK,GAAG,CAAR,KAAc,CAAd,IAAmBA,KAAK,GAAGv0E,CAAR,IAAanN,CAAhC,IAAqCA,CAAC,IAAI0hF,KAAK,GAAGv0E,CAAtD,EAAyD;AACvD,gBAAI41F,GAAG,CAACjrG,CAAC,GAAG4pF,KAAL,CAAH,IAAkBohB,KAAK,CAAChrG,CAAD,CAA3B,EAAgC;AAC9B,qBAAO4rG,UAAU,CAACX,GAAG,CAACjrG,CAAC,GAAG4pF,KAAL,CAAJ,EAAiB1hF,CAAC,GAAGmjG,MAAJ,GAAaE,MAA9B,EAAsCD,IAAtC,EAA4CE,IAA5C,CAAjB;AACD;AACF;AACF;;AACD,aAAKtjG,CAAC,GAAG0hF,KAAK,GAAGv0E,CAAjB,EAAoBnN,CAAC,IAAI0hF,KAAK,GAAGv0E,CAAjC,EAAoCnN,CAAC,IAAI,CAAzC,EAA4C;AAC1ClI,UAAAA,CAAC,GAAGkI,CAAC,GAAGwwB,MAAJ,GAAakxD,KAAjB;;AACA,cAAI1hF,CAAC,KAAK0hF,KAAK,GAAGv0E,CAAd,IAAmBnN,CAAC,KAAK0hF,KAAK,GAAGv0E,CAAd,IAAmB41F,GAAG,CAACjrG,CAAC,GAAG,CAAL,CAAH,IAAcirG,GAAG,CAACjrG,CAAC,GAAG,CAAL,CAA3D,EAAoE;AAClEirG,YAAAA,GAAG,CAACjrG,CAAD,CAAH,GAASirG,GAAG,CAACjrG,CAAC,GAAG,CAAL,CAAH,GAAa,CAAtB;AACD,WAFD,MAEO;AACLirG,YAAAA,GAAG,CAACjrG,CAAD,CAAH,GAASirG,GAAG,CAACjrG,CAAC,GAAG,CAAL,CAAZ;AACD;;AACD3B,UAAAA,CAAC,GAAG4sG,GAAG,CAACjrG,CAAD,CAAH,GAAS,CAAb;AACAN,UAAAA,CAAC,GAAGrB,CAAC,GAAGgtG,MAAJ,GAAaE,MAAb,GAAsBrjG,CAA1B;;AACA,iBAAO7J,CAAC,IAAIgtG,MAAL,IAAe3rG,CAAC,IAAI6rG,MAApB,IAA8BttF,IAAI,CAAC5f,CAAD,CAAJ,KAAY4hB,KAAK,CAACvgB,CAAD,CAAtD,EAA2D;AACzDurG,YAAAA,GAAG,CAACjrG,CAAD,CAAH,GAAS3B,CAAC,EAAV;AACAqB,YAAAA,CAAC;AACF;;AACD,cAAIkqF,KAAK,GAAG,CAAR,KAAc,CAAd,IAAmB,CAACv0E,CAAD,IAAMnN,CAAzB,IAA8BA,CAAC,IAAImN,CAAvC,EAA0C;AACxC,gBAAI41F,GAAG,CAACjrG,CAAD,CAAH,IAAUgrG,KAAK,CAAChrG,CAAC,GAAG4pF,KAAL,CAAnB,EAAgC;AAC9B,qBAAOgiB,UAAU,CAACX,GAAG,CAACjrG,CAAD,CAAJ,EAASkI,CAAC,GAAGmjG,MAAJ,GAAaE,MAAtB,EAA8BD,IAA9B,EAAoCE,IAApC,CAAjB;AACD;AACF;AACF;AACF;AACF,KApDD;;AAqDA,QAAI9rE,MAAM,GAAG,EAAb;AACA0rE,IAAAA,WAAW,CAAC,CAAD,EAAIntF,IAAI,CAACne,MAAT,EAAiB,CAAjB,EAAoBmgB,KAAK,CAACngB,MAA1B,EAAkC4/B,MAAlC,CAAX;AACA,WAAOA,MAAP;AACD,GAlHD;;AAoHA,MAAIosE,YAAY,GAAG,UAAUjnF,GAAV,EAAe;AAChC,QAAI9D,WAAW,CAAC8D,GAAD,CAAf,EAAsB;AACpB,aAAOA,GAAG,CAACi/B,SAAX;AACD,KAFD,MAEO,IAAI3hC,QAAQ,CAAC0C,GAAD,CAAZ,EAAmB;AACxB,aAAOuZ,QAAQ,CAACd,SAAT,CAAmBzY,GAAG,CAACyH,IAAvB,EAA6B,KAA7B,CAAP;AACD,KAFM,MAEA,IAAIlK,WAAW,CAACyC,GAAD,CAAf,EAAsB;AAC3B,aAAO,SAASA,GAAG,CAACyH,IAAb,GAAoB,KAA3B;AACD;;AACD,WAAO,EAAP;AACD,GATD;;AAUA,MAAIy/E,gBAAgB,GAAG,UAAUl2F,IAAV,EAAgB;AACrC,QAAIa,IAAJ;AACA,QAAItD,SAAS,GAAGH,QAAQ,CAACgD,aAAT,CAAuB,KAAvB,CAAhB;AACA,QAAI8kC,IAAI,GAAG9nC,QAAQ,CAAC+nC,sBAAT,EAAX;;AACA,QAAInlC,IAAJ,EAAU;AACRzC,MAAAA,SAAS,CAAC8C,SAAV,GAAsBL,IAAtB;AACD;;AACD,WAAOa,IAAI,GAAGtD,SAAS,CAACiI,UAAxB,EAAoC;AAClC0/B,MAAAA,IAAI,CAAC59B,WAAL,CAAiBzG,IAAjB;AACD;;AACD,WAAOqkC,IAAP;AACD,GAXD;;AAYA,MAAIixD,QAAQ,GAAG,UAAUnnF,GAAV,EAAehP,IAAf,EAAqBjM,KAArB,EAA4B;AACzC,QAAIolD,QAAQ,GAAG+8C,gBAAgB,CAACl2F,IAAD,CAA/B;;AACA,QAAIgP,GAAG,CAAC1O,aAAJ,MAAuBvM,KAAK,GAAGib,GAAG,CAACzO,UAAJ,CAAetW,MAAlD,EAA0D;AACxD,UAAIoP,MAAM,GAAG2V,GAAG,CAACzO,UAAJ,CAAexM,KAAf,CAAb;AACAsF,MAAAA,MAAM,CAACkL,UAAP,CAAkByC,YAAlB,CAA+BmyC,QAA/B,EAAyC9/C,MAAzC;AACD,KAHD,MAGO;AACL2V,MAAAA,GAAG,CAAC1H,WAAJ,CAAgB6xC,QAAhB;AACD;AACF,GARD;;AASA,MAAIi9C,QAAQ,GAAG,UAAUpnF,GAAV,EAAejb,KAAf,EAAsB;AACnC,QAAIib,GAAG,CAAC1O,aAAJ,MAAuBvM,KAAK,GAAGib,GAAG,CAACzO,UAAJ,CAAetW,MAAlD,EAA0D;AACxD,UAAIoP,MAAM,GAAG2V,GAAG,CAACzO,UAAJ,CAAexM,KAAf,CAAb;AACAsF,MAAAA,MAAM,CAACkL,UAAP,CAAkBwD,WAAlB,CAA8B1O,MAA9B;AACD;AACF,GALD;;AAMA,MAAIg9F,SAAS,GAAG,UAAU35D,IAAV,EAAgB1tB,GAAhB,EAAqB;AACnC,QAAIjb,KAAK,GAAG,CAAZ;AACAlG,IAAAA,IAAI,CAAC6uC,IAAD,EAAO,UAAU+gD,MAAV,EAAkB;AAC3B,UAAIA,MAAM,CAAC,CAAD,CAAN,KAAcwX,IAAlB,EAAwB;AACtBlhG,QAAAA,KAAK;AACN,OAFD,MAEO,IAAI0pF,MAAM,CAAC,CAAD,CAAN,KAAcyX,MAAlB,EAA0B;AAC/BiB,QAAAA,QAAQ,CAACnnF,GAAD,EAAMyuE,MAAM,CAAC,CAAD,CAAZ,EAAiB1pF,KAAjB,CAAR;AACAA,QAAAA,KAAK;AACN,OAHM,MAGA,IAAI0pF,MAAM,CAAC,CAAD,CAAN,KAAcjkB,MAAlB,EAA0B;AAC/B48B,QAAAA,QAAQ,CAACpnF,GAAD,EAAMjb,KAAN,CAAR;AACD;AACF,KATG,CAAJ;AAUD,GAZD;;AAaA,MAAIuiG,MAAM,GAAG,UAAUtnF,GAAV,EAAe;AAC1B,WAAO/gB,MAAM,CAACL,GAAG,CAACmE,MAAM,CAACid,GAAG,CAACzO,UAAL,CAAP,EAAyB01F,YAAzB,CAAJ,EAA4C,UAAUniG,IAAV,EAAgB;AACvE,aAAOA,IAAI,CAAC7J,MAAL,GAAc,CAArB;AACD,KAFY,CAAb;AAGD,GAJD;;AAKA,MAAIssG,KAAK,GAAG,UAAUC,SAAV,EAAqBxnF,GAArB,EAA0B;AACpC,QAAIynF,gBAAgB,GAAG7oG,GAAG,CAACmE,MAAM,CAACid,GAAG,CAACzO,UAAL,CAAP,EAAyB01F,YAAzB,CAA1B;AACAI,IAAAA,SAAS,CAAC35D,IAAI,CAAC+5D,gBAAD,EAAmBD,SAAnB,CAAL,EAAoCxnF,GAApC,CAAT;AACA,WAAOA,GAAP;AACD,GAJD;;AAMA,MAAI0nF,iBAAiB,GAAGllD,IAAI,CAAC1iD,QAAQ,CAACrC,IAAT,EAAD,CAA5B;;AACA,MAAIkqG,gBAAgB,GAAG,YAAY;AACjC,WAAOD,iBAAiB,CAAC9kG,GAAlB,GAAwBtE,UAAxB,CAAmC,YAAY;AACpD,UAAI4S,GAAG,GAAG9C,QAAQ,CAACw5F,cAAT,CAAwBC,kBAAxB,CAA2C,MAA3C,CAAV;AACAH,MAAAA,iBAAiB,CAACtpF,GAAlB,CAAsBte,QAAQ,CAACR,IAAT,CAAc4R,GAAd,CAAtB;AACA,aAAOA,GAAP;AACD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAI42F,UAAU,GAAG,UAAU92F,IAAV,EAAgB;AAC/B,WAAOA,IAAI,CAAC9W,OAAL,CAAa,WAAb,MAA8B,CAAC,CAAtC;AACD,GAFD;;AAGA,MAAI6tG,qBAAqB,GAAG,UAAUP,SAAV,EAAqB;AAC/C,WAAO;AACLvnG,MAAAA,IAAI,EAAE,YADD;AAELunG,MAAAA,SAAS,EAAEA,SAFN;AAGL/uD,MAAAA,OAAO,EAAE,EAHJ;AAIL2Y,MAAAA,QAAQ,EAAE,IAJL;AAKL42C,MAAAA,cAAc,EAAE;AALX,KAAP;AAOD,GARD;;AASA,MAAIC,mBAAmB,GAAG,UAAUxvD,OAAV,EAAmB;AAC3C,WAAO;AACLx4C,MAAAA,IAAI,EAAE,UADD;AAELunG,MAAAA,SAAS,EAAE,IAFN;AAGL/uD,MAAAA,OAAO,EAAEA,OAHJ;AAIL2Y,MAAAA,QAAQ,EAAE,IAJL;AAKL42C,MAAAA,cAAc,EAAE;AALX,KAAP;AAOD,GARD;;AASA,MAAIE,gBAAgB,GAAG,UAAUj7E,MAAV,EAAkB;AACvC,QAAIu6E,SAAS,GAAGF,MAAM,CAACr6E,MAAM,CAACo6B,OAAP,EAAD,CAAtB;AACA,QAAI8gD,gBAAgB,GAAGrpG,IAAI,CAAC0oG,SAAD,EAAY,UAAUx2F,IAAV,EAAgB;AACrD,UAAIo3F,OAAO,GAAG1lB,YAAY,CAACz1D,MAAM,CAACi8B,UAAR,EAAoBl4C,IAApB,CAA1B;AACA,aAAOo3F,OAAO,CAACntG,MAAR,GAAiB,CAAjB,GAAqB,CAACmtG,OAAD,CAArB,GAAiC,EAAxC;AACD,KAH0B,CAA3B;AAIA,QAAI3vD,OAAO,GAAG0vD,gBAAgB,CAAC39E,IAAjB,CAAsB,EAAtB,CAAd;AACA,WAAOs9E,UAAU,CAACrvD,OAAD,CAAV,GAAsBsvD,qBAAqB,CAACI,gBAAD,CAA3C,GAAgEF,mBAAmB,CAACxvD,OAAD,CAA1F;AACD,GARD;;AASA,MAAI4vD,aAAa,GAAG,UAAUp7E,MAAV,EAAkBq7E,KAAlB,EAAyBzwF,MAAzB,EAAiC;AACnD,QAAIywF,KAAK,CAACroG,IAAN,KAAe,YAAnB,EAAiC;AAC/BsnG,MAAAA,KAAK,CAACe,KAAK,CAACd,SAAP,EAAkBv6E,MAAM,CAACo6B,OAAP,EAAlB,CAAL;AACD,KAFD,MAEO;AACLp6B,MAAAA,MAAM,CAAC2+D,UAAP,CAAkB0c,KAAK,CAAC7vD,OAAxB,EAAiC;AAAEypB,QAAAA,MAAM,EAAE;AAAV,OAAjC;AACD;;AACDj1C,IAAAA,MAAM,CAACk6B,SAAP,CAAiBkL,cAAjB,CAAgCx6C,MAAM,GAAGywF,KAAK,CAACN,cAAT,GAA0BM,KAAK,CAACl3C,QAAtE;AACD,GAPD;;AAQA,MAAIm3C,eAAe,GAAG,UAAUD,KAAV,EAAiB;AACrC,WAAOA,KAAK,CAACroG,IAAN,KAAe,YAAf,GAA8BqoG,KAAK,CAACd,SAAN,CAAgBh9E,IAAhB,CAAqB,EAArB,CAA9B,GAAyD89E,KAAK,CAAC7vD,OAAtE;AACD,GAFD;;AAGA,MAAI+vD,oBAAoB,GAAG,UAAUF,KAAV,EAAiB;AAC1C,QAAItoF,GAAG,GAAG3N,YAAY,CAACV,OAAb,CAAqB,MAArB,EAA6Bg2F,gBAAgB,EAA7C,CAAV;AACA39C,IAAAA,KAAK,CAAChqC,GAAD,EAAMuoF,eAAe,CAACD,KAAD,CAArB,CAAL;AACAzpG,IAAAA,IAAI,CAAC+nD,aAAa,CAAC5mC,GAAD,EAAM,mBAAN,CAAd,EAA0ChH,MAA1C,CAAJ;AACA,WAAO+wC,KAAK,CAAC/pC,GAAD,CAAZ;AACD,GALD;;AAMA,MAAIyoF,eAAe,GAAG,UAAUC,MAAV,EAAkBC,MAAlB,EAA0B;AAC9C,WAAOJ,eAAe,CAACG,MAAD,CAAf,KAA4BH,eAAe,CAACI,MAAD,CAAlD;AACD,GAFD;;AAGA,MAAIC,sBAAsB,GAAG,UAAUF,MAAV,EAAkBC,MAAlB,EAA0B;AACrD,WAAOH,oBAAoB,CAACE,MAAD,CAApB,KAAiCF,oBAAoB,CAACG,MAAD,CAA5D;AACD,GAFD;;AAGA,MAAIE,MAAM,GAAG,UAAUH,MAAV,EAAkBC,MAAlB,EAA0B;AACrC,QAAI,CAACD,MAAD,IAAW,CAACC,MAAhB,EAAwB;AACtB,aAAO,KAAP;AACD,KAFD,MAEO,IAAIF,eAAe,CAACC,MAAD,EAASC,MAAT,CAAnB,EAAqC;AAC1C,aAAO,IAAP;AACD,KAFM,MAEA;AACL,aAAOC,sBAAsB,CAACF,MAAD,EAASC,MAAT,CAA7B;AACD;AACF,GARD;;AAUA,MAAIG,UAAU,GAAG,UAAUC,KAAV,EAAiB;AAChC,WAAOA,KAAK,CAACnmG,GAAN,OAAgB,CAAvB;AACD,GAFD;;AAIA,MAAIomG,SAAS,GAAG,UAAUpgC,WAAV,EAAuBqgC,MAAvB,EAA+BF,KAA/B,EAAsC;AACpD,QAAID,UAAU,CAACC,KAAD,CAAd,EAAuB;AACrBngC,MAAAA,WAAW,CAACqgC,MAAZ,GAAqBA,MAArB;AACD;AACF,GAJD;;AAKA,MAAIC,SAAS,GAAG,UAAUtgC,WAAV,EAAuBmgC,KAAvB,EAA8B;AAC5C,QAAIngC,WAAW,CAACqgC,MAAhB,EAAwB;AACtBD,MAAAA,SAAS,CAACpgC,WAAD,EAAc,KAAd,EAAqBmgC,KAArB,CAAT;AACAngC,MAAAA,WAAW,CAACtuC,GAAZ;AACD;AACF,GALD;;AAMA,MAAI6uE,yBAAyB,GAAG,UAAUvgC,WAAV,EAAuB;AACrD,QAAIA,WAAW,CAACqgC,MAAhB,EAAwB;AACtBrgC,MAAAA,WAAW,CAACqgC,MAAZ,GAAqB,KAArB;AACArgC,MAAAA,WAAW,CAACtuC,GAAZ;AACD;AACF,GALD;;AAOA,MAAI8uE,YAAY,GAAG,UAAUn8E,MAAV,EAAkB87E,KAAlB,EAAyBf,cAAzB,EAAyC;AAC1D,QAAIc,UAAU,CAACC,KAAD,CAAd,EAAuB;AACrBf,MAAAA,cAAc,CAAC5pF,GAAf,CAAmBte,QAAQ,CAACR,IAAT,CAAckzD,eAAe,CAACvlC,MAAM,CAACk6B,SAAR,CAA7B,CAAnB;AACD;AACF,GAJD;;AAKA,MAAIkiD,YAAY,GAAG,UAAUp8E,MAAV,EAAkB27C,WAAlB,EAA+B7jE,KAA/B,EAAsCgkG,KAAtC,EAA6Cf,cAA7C,EAA6DM,KAA7D,EAAoE/wF,KAApE,EAA2E;AAC5F,QAAI+xF,YAAY,GAAGpB,gBAAgB,CAACj7E,MAAD,CAAnC;AACAq7E,IAAAA,KAAK,GAAGA,KAAK,IAAI,EAAjB;AACAA,IAAAA,KAAK,GAAG33F,KAAK,CAACZ,MAAN,CAAau4F,KAAb,EAAoBgB,YAApB,CAAR;;AACA,QAAIR,UAAU,CAACC,KAAD,CAAV,KAAsB,KAAtB,IAA+B97E,MAAM,CAACC,OAA1C,EAAmD;AACjD,aAAO,IAAP;AACD;;AACD,QAAIq8E,SAAS,GAAG3gC,WAAW,CAACnhD,IAAZ,CAAiB1iB,KAAK,CAACnC,GAAN,EAAjB,CAAhB;;AACA,QAAIqqB,MAAM,CAACmb,IAAP,CAAY,eAAZ,EAA6B;AAC7BkgE,MAAAA,KAAK,EAAEA,KADsB;AAE7BiB,MAAAA,SAAS,EAAEA,SAFkB;AAG7B3jE,MAAAA,aAAa,EAAEruB;AAHc,KAA7B,EAICytB,kBAJD,EAAJ,EAI2B;AACzB,aAAO,IAAP;AACD;;AACD,QAAIukE,SAAS,IAAIV,MAAM,CAACU,SAAD,EAAYjB,KAAZ,CAAvB,EAA2C;AACzC,aAAO,IAAP;AACD;;AACD,QAAI1/B,WAAW,CAACnhD,IAAZ,CAAiB1iB,KAAK,CAACnC,GAAN,EAAjB,CAAJ,EAAmC;AACjColG,MAAAA,cAAc,CAACplG,GAAf,GAAqB/D,IAArB,CAA0B,UAAU2qG,EAAV,EAAc;AACtC5gC,QAAAA,WAAW,CAACnhD,IAAZ,CAAiB1iB,KAAK,CAACnC,GAAN,EAAjB,EAA8BolG,cAA9B,GAA+CwB,EAA/C;AACD,OAFD;AAGD;;AACD,QAAIC,oBAAoB,GAAGhzC,uBAAuB,CAACxpC,MAAD,CAAlD;;AACA,QAAIw8E,oBAAJ,EAA0B;AACxB,UAAI7gC,WAAW,CAACnhD,IAAZ,CAAiBxsB,MAAjB,GAA0BwuG,oBAA9B,EAAoD;AAClD,aAAK,IAAItuG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGytE,WAAW,CAACnhD,IAAZ,CAAiBxsB,MAAjB,GAA0B,CAA9C,EAAiDE,CAAC,EAAlD,EAAsD;AACpDytE,UAAAA,WAAW,CAACnhD,IAAZ,CAAiBtsB,CAAjB,IAAsBytE,WAAW,CAACnhD,IAAZ,CAAiBtsB,CAAC,GAAG,CAArB,CAAtB;AACD;;AACDytE,QAAAA,WAAW,CAACnhD,IAAZ,CAAiBxsB,MAAjB;AACA8J,QAAAA,KAAK,CAACqZ,GAAN,CAAUwqD,WAAW,CAACnhD,IAAZ,CAAiBxsB,MAA3B;AACD;AACF;;AACDqtG,IAAAA,KAAK,CAACl3C,QAAN,GAAiBoB,eAAe,CAACvlC,MAAM,CAACk6B,SAAR,CAAhC;;AACA,QAAIpiD,KAAK,CAACnC,GAAN,KAAcgmE,WAAW,CAACnhD,IAAZ,CAAiBxsB,MAAjB,GAA0B,CAA5C,EAA+C;AAC7C2tE,MAAAA,WAAW,CAACnhD,IAAZ,CAAiBxsB,MAAjB,GAA0B8J,KAAK,CAACnC,GAAN,KAAc,CAAxC;AACD;;AACDgmE,IAAAA,WAAW,CAACnhD,IAAZ,CAAiBxmB,IAAjB,CAAsBqnG,KAAtB;AACAvjG,IAAAA,KAAK,CAACqZ,GAAN,CAAUwqD,WAAW,CAACnhD,IAAZ,CAAiBxsB,MAAjB,GAA0B,CAApC;AACA,QAAIiB,IAAI,GAAG;AACTosG,MAAAA,KAAK,EAAEA,KADE;AAETiB,MAAAA,SAAS,EAAEA,SAFF;AAGT3jE,MAAAA,aAAa,EAAEruB;AAHN,KAAX;;AAKA,QAAIxS,KAAK,CAACnC,GAAN,KAAc,CAAlB,EAAqB;AACnBqqB,MAAAA,MAAM,CAACy8E,QAAP,CAAgB,IAAhB;AACAz8E,MAAAA,MAAM,CAACmb,IAAP,CAAY,SAAZ,EAAuBlsC,IAAvB;AACA+wB,MAAAA,MAAM,CAACmb,IAAP,CAAY,QAAZ,EAAsBlsC,IAAtB;AACD,KAJD,MAIO;AACL+wB,MAAAA,MAAM,CAACmb,IAAP,CAAY,SAAZ,EAAuBlsC,IAAvB;AACD;;AACD,WAAOosG,KAAP;AACD,GApDD;;AAqDA,MAAIqB,KAAK,GAAG,UAAU18E,MAAV,EAAkB27C,WAAlB,EAA+B7jE,KAA/B,EAAsC;AAChD6jE,IAAAA,WAAW,CAACnhD,IAAZ,GAAmB,EAAnB;AACA1iB,IAAAA,KAAK,CAACqZ,GAAN,CAAU,CAAV;AACAwqD,IAAAA,WAAW,CAACqgC,MAAZ,GAAqB,KAArB;AACAh8E,IAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ;AACD,GALD;;AAMA,MAAIwhE,KAAK,GAAG,UAAU38E,MAAV,EAAkB27C,WAAlB,EAA+B7jE,KAA/B,EAAsC8kG,SAAtC,EAAiDC,SAAjD,EAA4D;AACtE,QAAIlhC,WAAW,CAACC,QAAZ,CAAqBghC,SAArB,CAAJ,EAAqC;AACnC,UAAIz4C,QAAQ,GAAGwX,WAAW,CAACnhD,IAAZ,CAAiB1iB,KAAK,CAACnC,GAAN,EAAjB,EAA8BwuD,QAA7C;AACA,UAAIm4C,SAAS,GAAG3gC,WAAW,CAACnhD,IAAZ,CAAiB1iB,KAAK,CAACnC,GAAN,KAAc,CAA/B,CAAhB;AACAylG,MAAAA,aAAa,CAACp7E,MAAD,EAASs8E,SAAT,EAAoB,IAApB,CAAb;;AACA,UAAI3gC,WAAW,CAACC,QAAZ,CAAqBihC,SAArB,CAAJ,EAAqC;AACnClhC,QAAAA,WAAW,CAACnhD,IAAZ,CAAiB1iB,KAAK,CAACnC,GAAN,KAAc,CAA/B,EAAkColG,cAAlC,GAAmD52C,QAAnD;AACD;AACF;AACF,GATD;;AAUA,MAAI24C,IAAI,GAAG,UAAU98E,MAAV,EAAkBloB,KAAlB,EAAyB0iB,IAAzB,EAA+B;AACxC,QAAI6gF,KAAJ;;AACA,QAAIvjG,KAAK,CAACnC,GAAN,KAAc6kB,IAAI,CAACxsB,MAAL,GAAc,CAAhC,EAAmC;AACjC8J,MAAAA,KAAK,CAACqZ,GAAN,CAAUrZ,KAAK,CAACnC,GAAN,KAAc,CAAxB;AACA0lG,MAAAA,KAAK,GAAG7gF,IAAI,CAAC1iB,KAAK,CAACnC,GAAN,EAAD,CAAZ;AACAylG,MAAAA,aAAa,CAACp7E,MAAD,EAASq7E,KAAT,EAAgB,KAAhB,CAAb;AACAr7E,MAAAA,MAAM,CAACy8E,QAAP,CAAgB,IAAhB;AACAz8E,MAAAA,MAAM,CAACmb,IAAP,CAAY,MAAZ,EAAoB;AAAEkgE,QAAAA,KAAK,EAAEA;AAAT,OAApB;AACD;;AACD,WAAOA,KAAP;AACD,GAVD;;AAWA,MAAI0B,IAAI,GAAG,UAAU/8E,MAAV,EAAkB27C,WAAlB,EAA+BmgC,KAA/B,EAAsChkG,KAAtC,EAA6C;AACtD,QAAIujG,KAAJ;;AACA,QAAI1/B,WAAW,CAACqgC,MAAhB,EAAwB;AACtBrgC,MAAAA,WAAW,CAACtuC,GAAZ;AACAsuC,MAAAA,WAAW,CAACqgC,MAAZ,GAAqB,KAArB;AACAD,MAAAA,SAAS,CAACpgC,WAAD,EAAc,KAAd,EAAqBmgC,KAArB,CAAT;AACD;;AACD,QAAIhkG,KAAK,CAACnC,GAAN,KAAc,CAAlB,EAAqB;AACnBmC,MAAAA,KAAK,CAACqZ,GAAN,CAAUrZ,KAAK,CAACnC,GAAN,KAAc,CAAxB;AACA0lG,MAAAA,KAAK,GAAG1/B,WAAW,CAACnhD,IAAZ,CAAiB1iB,KAAK,CAACnC,GAAN,EAAjB,CAAR;AACAylG,MAAAA,aAAa,CAACp7E,MAAD,EAASq7E,KAAT,EAAgB,IAAhB,CAAb;AACAr7E,MAAAA,MAAM,CAACy8E,QAAP,CAAgB,IAAhB;AACAz8E,MAAAA,MAAM,CAACmb,IAAP,CAAY,MAAZ,EAAoB;AAAEkgE,QAAAA,KAAK,EAAEA;AAAT,OAApB;AACD;;AACD,WAAOA,KAAP;AACD,GAfD;;AAgBA,MAAIhkB,KAAK,GAAG,UAAU1b,WAAV,EAAuB;AACjCA,IAAAA,WAAW,CAAC+gC,KAAZ;AACA/gC,IAAAA,WAAW,CAACtuC,GAAZ;AACD,GAHD;;AAIA,MAAI2vE,OAAO,GAAG,UAAUh9E,MAAV,EAAkB27C,WAAlB,EAA+B7jE,KAA/B,EAAsC;AAClD,WAAOA,KAAK,CAACnC,GAAN,KAAc,CAAd,IAAmBgmE,WAAW,CAACqgC,MAAZ,IAAsBrgC,WAAW,CAACnhD,IAAZ,CAAiB,CAAjB,CAAtB,IAA6C,CAACohF,MAAM,CAACX,gBAAgB,CAACj7E,MAAD,CAAjB,EAA2B27C,WAAW,CAACnhD,IAAZ,CAAiB,CAAjB,CAA3B,CAA9E;AACD,GAFD;;AAGA,MAAIyiF,OAAO,GAAG,UAAUthC,WAAV,EAAuB7jE,KAAvB,EAA8B;AAC1C,WAAOA,KAAK,CAACnC,GAAN,KAAcgmE,WAAW,CAACnhD,IAAZ,CAAiBxsB,MAAjB,GAA0B,CAAxC,IAA6C,CAAC2tE,WAAW,CAACqgC,MAAjE;AACD,GAFD;;AAGA,MAAIpgC,QAAQ,GAAG,UAAUD,WAAV,EAAuBmgC,KAAvB,EAA8BnkG,QAA9B,EAAwC;AACrDskG,IAAAA,SAAS,CAACtgC,WAAD,EAAcmgC,KAAd,CAAT;AACAngC,IAAAA,WAAW,CAACwgC,YAAZ;AACAxgC,IAAAA,WAAW,CAACuhC,MAAZ,CAAmBvlG,QAAnB;AACA,WAAOgkE,WAAW,CAACtuC,GAAZ,EAAP;AACD,GALD;;AAMA,MAAI6vE,MAAM,GAAG,UAAUpB,KAAV,EAAiBnkG,QAAjB,EAA2B;AACtC,QAAI;AACFmkG,MAAAA,KAAK,CAAC3qF,GAAN,CAAU2qF,KAAK,CAACnmG,GAAN,KAAc,CAAxB;AACAgC,MAAAA,QAAQ;AACT,KAHD,SAGU;AACRmkG,MAAAA,KAAK,CAAC3qF,GAAN,CAAU2qF,KAAK,CAACnmG,GAAN,KAAc,CAAxB;AACD;AACF,GAPD;;AASA,MAAIwnG,iBAAiB,GAAG,UAAUn9E,MAAV,EAAkBjN,GAAlB,EAAuB;AAC7C,QAAI/N,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,QAAIhB,KAAK,GAAGtQ,aAAa,CAACqf,GAAD,CAAb,GAAqBA,GAArB,GAA2BiN,MAAM,CAACo6B,OAAP,EAAvC;;AACA,QAAI5mD,WAAW,CAACwsB,MAAM,CAACo9E,SAAR,CAAf,EAAmC;AACjCp9E,MAAAA,MAAM,CAACo9E,SAAP,GAAmBrzC,mBAAmB,CAAC/pC,MAAD,CAAtC;AACD;;AACDpuB,IAAAA,IAAI,CAACoT,GAAG,CAAC+2B,MAAJ,CAAW,SAAX,EAAsB/3B,KAAtB,CAAD,EAA+B,UAAUq5F,UAAV,EAAsB;AACvD,cAAQA,UAAU,CAAC51F,QAAnB;AACA,aAAK,OAAL;AACE,cAAImqC,GAAG,GAAGoY,uBAAuB,CAAChqC,MAAD,CAAjC;AACA,cAAItwB,KAAK,GAAGsV,GAAG,CAAC2pC,SAAJ,CAAc0uD,UAAd,EAA0B,QAA1B,CAAZ;;AACA,cAAI,CAAC,CAAC3tG,KAAD,IAAUA,KAAK,KAAK,GAArB,KAA6BswB,MAAM,CAACo9E,SAAxC,EAAmD;AACjDp4F,YAAAA,GAAG,CAAC4mC,QAAJ,CAAayxD,UAAb,EAAyBzrD,GAAzB;AACD,WAFD,MAEO;AACL5sC,YAAAA,GAAG,CAAC8mC,WAAJ,CAAgBuxD,UAAhB,EAA4BzrD,GAA5B;AACD;;AACD;;AACF,aAAK,GAAL;AACE,cAAI,CAAC5sC,GAAG,CAAC2pC,SAAJ,CAAc0uD,UAAd,EAA0B,MAA1B,CAAL,EAAwC;AACtC,gBAAIC,OAAO,GAAGt4F,GAAG,CAAC2pC,SAAJ,CAAc0uD,UAAd,EAA0B,MAA1B,KAAqCA,UAAU,CAACxsG,EAA9D;AACA,gBAAI0sG,KAAK,GAAGtzC,wBAAwB,CAACjqC,MAAD,CAApC;;AACA,gBAAIs9E,OAAO,IAAIt9E,MAAM,CAACo9E,SAAtB,EAAiC;AAC/Bp4F,cAAAA,GAAG,CAAC4mC,QAAJ,CAAayxD,UAAb,EAAyBE,KAAzB;AACD,aAFD,MAEO;AACLv4F,cAAAA,GAAG,CAAC8mC,WAAJ,CAAgBuxD,UAAhB,EAA4BE,KAA5B;AACD;AACF;;AACD;AApBF;AAsBD,KAvBG,CAAJ;AAwBAv9E,IAAAA,MAAM,CAACmb,IAAP,CAAY,WAAZ,EAAyB;AACvBj1B,MAAAA,OAAO,EAAE6M,GADc;AAEvBqqF,MAAAA,SAAS,EAAEp9E,MAAM,CAACo9E;AAFK,KAAzB;AAID,GAlCD;;AAoCA,MAAII,gBAAgB,GAAG,UAAUx9E,MAAV,EAAkB;AACvC,WAAO;AACL27C,MAAAA,WAAW,EAAE;AACXwgC,QAAAA,YAAY,EAAE,UAAUL,KAAV,EAAiBf,cAAjB,EAAiC;AAC7C,iBAAOoB,YAAY,CAACn8E,MAAD,EAAS87E,KAAT,EAAgBf,cAAhB,CAAnB;AACD,SAHU;AAIXqB,QAAAA,YAAY,EAAE,UAAUzgC,WAAV,EAAuB7jE,KAAvB,EAA8BgkG,KAA9B,EAAqCf,cAArC,EAAqDM,KAArD,EAA4D/wF,KAA5D,EAAmE;AAC/E,iBAAO8xF,YAAY,CAACp8E,MAAD,EAAS27C,WAAT,EAAsB7jE,KAAtB,EAA6BgkG,KAA7B,EAAoCf,cAApC,EAAoDM,KAApD,EAA2D/wF,KAA3D,CAAnB;AACD,SANU;AAOXyyF,QAAAA,IAAI,EAAE,UAAUphC,WAAV,EAAuBmgC,KAAvB,EAA8BhkG,KAA9B,EAAqC;AACzC,iBAAOilG,IAAI,CAAC/8E,MAAD,EAAS27C,WAAT,EAAsBmgC,KAAtB,EAA6BhkG,KAA7B,CAAX;AACD,SATU;AAUXglG,QAAAA,IAAI,EAAE,UAAUhlG,KAAV,EAAiB0iB,IAAjB,EAAuB;AAC3B,iBAAOsiF,IAAI,CAAC98E,MAAD,EAASloB,KAAT,EAAgB0iB,IAAhB,CAAX;AACD,SAZU;AAaXkiF,QAAAA,KAAK,EAAE,UAAU/gC,WAAV,EAAuB7jE,KAAvB,EAA8B;AACnC,iBAAO4kG,KAAK,CAAC18E,MAAD,EAAS27C,WAAT,EAAsB7jE,KAAtB,CAAZ;AACD,SAfU;AAgBXu/E,QAAAA,KAAK,EAAE,UAAU1b,WAAV,EAAuB;AAC5B,iBAAO0b,KAAK,CAAC1b,WAAD,CAAZ;AACD,SAlBU;AAmBXqhC,QAAAA,OAAO,EAAE,UAAUrhC,WAAV,EAAuB7jE,KAAvB,EAA8B;AACrC,iBAAOklG,OAAO,CAACh9E,MAAD,EAAS27C,WAAT,EAAsB7jE,KAAtB,CAAd;AACD,SArBU;AAsBXmlG,QAAAA,OAAO,EAAE,UAAUthC,WAAV,EAAuB7jE,KAAvB,EAA8B;AACrC,iBAAOmlG,OAAO,CAACthC,WAAD,EAAc7jE,KAAd,CAAd;AACD,SAxBU;AAyBX8jE,QAAAA,QAAQ,EAAE,UAAUD,WAAV,EAAuBmgC,KAAvB,EAA8BnkG,QAA9B,EAAwC;AAChD,iBAAOikE,QAAQ,CAACD,WAAD,EAAcmgC,KAAd,EAAqBnkG,QAArB,CAAf;AACD,SA3BU;AA4BXulG,QAAAA,MAAM,EAAE,UAAUpB,KAAV,EAAiBnkG,QAAjB,EAA2B;AACjC,iBAAOulG,MAAM,CAACpB,KAAD,EAAQnkG,QAAR,CAAb;AACD,SA9BU;AA+BXglG,QAAAA,KAAK,EAAE,UAAUhhC,WAAV,EAAuB7jE,KAAvB,EAA8B8kG,SAA9B,EAAyCC,SAAzC,EAAoD;AACzD,iBAAOF,KAAK,CAAC38E,MAAD,EAAS27C,WAAT,EAAsB7jE,KAAtB,EAA6B8kG,SAA7B,EAAwCC,SAAxC,CAAZ;AACD;AAjCU,OADR;AAoCLxnC,MAAAA,SAAS,EAAE;AACT3yD,QAAAA,KAAK,EAAE,UAAU5V,IAAV,EAAgBynE,IAAhB,EAAsB3vD,IAAtB,EAA4B;AACjC,iBAAOlC,KAAK,CAACsd,MAAD,EAASlzB,IAAT,EAAeynE,IAAf,EAAqB3vD,IAArB,CAAZ;AACD,SAHQ;AAIT2kF,QAAAA,QAAQ,EAAE,UAAUp6E,KAAV,EAAiBolD,IAAjB,EAAuB;AAC/B,iBAAOg1B,QAAQ,CAACvpE,MAAD,EAAS7Q,KAAT,EAAgBolD,IAAhB,CAAf;AACD,SANQ;AAOT00B,QAAAA,SAAS,EAAE,UAAUrkF,IAAV,EAAgB9X,IAAhB,EAAsBynE,IAAtB,EAA4B80B,OAA5B,EAAqC;AAC9C,iBAAOJ,SAAS,CAACjpE,MAAD,EAASpb,IAAT,EAAe9X,IAAf,EAAqBynE,IAArB,EAA2B80B,OAA3B,CAAhB;AACD,SATQ;AAUTO,QAAAA,QAAQ,EAAE,UAAU98F,IAAV,EAAgB;AACxB,iBAAO88F,QAAQ,CAAC5pE,MAAD,EAASlzB,IAAT,CAAf;AACD,SAZQ;AAaT0xB,QAAAA,OAAO,EAAE,UAAUrP,KAAV,EAAiB;AACxB,iBAAOu6E,SAAS,CAAC1pE,MAAD,EAAS7Q,KAAT,CAAhB;AACD,SAfQ;AAgBT/f,QAAAA,KAAK,EAAE,UAAUtC,IAAV,EAAgBynE,IAAhB,EAAsB3vD,IAAtB,EAA4B;AACjC,iBAAOstF,WAAW,CAAClyE,MAAD,EAASlzB,IAAT,EAAeynE,IAAf,EAAqB3vD,IAArB,CAAlB;AACD,SAlBQ;AAmBTiH,QAAAA,MAAM,EAAE,UAAU/e,IAAV,EAAgBynE,IAAhB,EAAsB3vD,IAAtB,EAA4BykF,OAA5B,EAAqC;AAC3C,iBAAOmH,QAAQ,CAACxwE,MAAD,EAASlzB,IAAT,EAAeynE,IAAf,EAAqB3vD,IAArB,EAA2BykF,OAA3B,CAAf;AACD,SArBQ;AAsBT+K,QAAAA,MAAM,EAAE,UAAUtnG,IAAV,EAAgBynE,IAAhB,EAAsB3vD,IAAtB,EAA4B;AAClC,iBAAOwvF,MAAM,CAACp0E,MAAD,EAASlzB,IAAT,EAAeynE,IAAf,EAAqB3vD,IAArB,CAAb;AACD,SAxBQ;AAyBT64F,QAAAA,aAAa,EAAE,UAAUlK,yBAAV,EAAqCS,OAArC,EAA8Cr8F,QAA9C,EAAwD0xF,OAAxD,EAAiE;AAC9E,iBAAO8K,qBAAqB,CAACn0E,MAAD,EAASuzE,yBAAT,EAAoCS,OAApC,EAA6Cr8F,QAA7C,EAAuD0xF,OAAvD,CAA5B;AACD;AA3BQ,OApCN;AAiELrpE,MAAAA,MAAM,EAAE;AACNs3D,QAAAA,UAAU,EAAE,UAAUroF,IAAV,EAAgBgmE,MAAhB,EAAwB;AAClC,iBAAOmhB,kBAAkB,CAACp2D,MAAD,EAAS/wB,IAAT,EAAegmE,MAAf,CAAzB;AACD,SAHK;AAIN0pB,QAAAA,UAAU,EAAE,UAAUnzC,OAAV,EAAmBv8C,IAAnB,EAAyB;AACnC,iBAAOo5F,kBAAkB,CAACroE,MAAD,EAASwrB,OAAT,EAAkBv8C,IAAlB,CAAzB;AACD,SANK;AAONyuG,QAAAA,aAAa,EAAE,UAAUhuG,KAAV,EAAiB82F,OAAjB,EAA0B;AACvC,iBAAOD,iBAAiB,CAACvmE,MAAD,EAAStwB,KAAT,EAAgB82F,OAAhB,CAAxB;AACD,SATK;AAUNS,QAAAA,SAAS,EAAE,UAAUl0E,GAAV,EAAe;AACxB,iBAAOoqF,iBAAiB,CAACn9E,MAAD,EAASjN,GAAT,CAAxB;AACD;AAZK,OAjEH;AA+ELmnC,MAAAA,SAAS,EAAE;AACTo9B,QAAAA,UAAU,EAAE,UAAUriB,MAAV,EAAkBhmE,IAAlB,EAAwB;AAClC,iBAAO8pG,0BAA0B,CAAC/4E,MAAD,EAASi1C,MAAT,EAAiBhmE,IAAjB,CAAjC;AACD;AAHQ,OA/EN;AAoFLqjB,MAAAA,GAAG,EAAE;AACHqrF,QAAAA,QAAQ,EAAE,YAAY;AACpB,iBAAO9qG,QAAQ,CAACrC,IAAT,EAAP;AACD;AAHE;AApFA,KAAP;AA0FD,GA3FD;;AA4FA,MAAIotG,cAAc,GAAG,UAAUC,SAAV,EAAqB;AACxC,QAAIC,WAAW,GAAG,UAAUvpC,IAAV,EAAgB;AAChC,aAAOnhE,QAAQ,CAACmhE,IAAD,CAAR,GAAiBA,IAAjB,GAAwB,EAA/B;AACD,KAFD;;AAGA,QAAIwpC,WAAW,GAAG5tG,GAAG,CAAC,+BAAD,CAArB;AACA,QAAIwrE,WAAW,GAAGkiC,SAAS,CAACliC,WAA5B;AAAA,QAAyCtG,SAAS,GAAGwoC,SAAS,CAACxoC,SAA/D;AAAA,QAA0Er1C,MAAM,GAAG69E,SAAS,CAAC79E,MAA7F;AAAA,QAAqGk6B,SAAS,GAAG2jD,SAAS,CAAC3jD,SAA3H;AAAA,QAAsI5nC,GAAG,GAAGurF,SAAS,CAACvrF,GAAtJ;AACA,QAAI4qF,MAAM,GAAGruG,IAAb;AACA,WAAO;AACL8sE,MAAAA,WAAW,EAAE;AACXwgC,QAAAA,YAAY,EAAEe,MADH;AAEXd,QAAAA,YAAY,EAAE2B,WAFH;AAGXhB,QAAAA,IAAI,EAAE,YAAY;AAChB,iBAAOphC,WAAW,CAACohC,IAAZ,EAAP;AACD,SALU;AAMXD,QAAAA,IAAI,EAAE,YAAY;AAChB,iBAAOnhC,WAAW,CAACmhC,IAAZ,EAAP;AACD,SARU;AASXJ,QAAAA,KAAK,EAAE,YAAY;AACjB,iBAAO/gC,WAAW,CAAC+gC,KAAZ,EAAP;AACD,SAXU;AAYXrlB,QAAAA,KAAK,EAAE,YAAY;AACjB,iBAAO1b,WAAW,CAAC0b,KAAZ,EAAP;AACD,SAdU;AAeX2lB,QAAAA,OAAO,EAAE,YAAY;AACnB,iBAAOrhC,WAAW,CAACqhC,OAAZ,EAAP;AACD,SAjBU;AAkBXC,QAAAA,OAAO,EAAE,YAAY;AACnB,iBAAOthC,WAAW,CAACshC,OAAZ,EAAP;AACD,SApBU;AAqBXrhC,QAAAA,QAAQ,EAAE,UAAUoiC,YAAV,EAAwBC,MAAxB,EAAgCpuG,EAAhC,EAAoC;AAC5C,iBAAO8rE,WAAW,CAACC,QAAZ,CAAqB/rE,EAArB,CAAP;AACD,SAvBU;AAwBXqtG,QAAAA,MAAM,EAAE,UAAUe,MAAV,EAAkBtmG,QAAlB,EAA4B;AAClC,iBAAOgkE,WAAW,CAACuhC,MAAZ,CAAmBvlG,QAAnB,CAAP;AACD,SA1BU;AA2BXglG,QAAAA,KAAK,EAAE,UAAUqB,YAAV,EAAwBE,MAAxB,EAAgCtB,SAAhC,EAA2CC,SAA3C,EAAsD;AAC3D,iBAAOlhC,WAAW,CAACghC,KAAZ,CAAkBC,SAAlB,EAA6BC,SAA7B,CAAP;AACD;AA7BU,OADR;AAgCLxnC,MAAAA,SAAS,EAAE;AACT3yD,QAAAA,KAAK,EAAE,UAAU5V,IAAV,EAAgBynE,IAAhB,EAAsB4pC,KAAtB,EAA6B;AAClC,iBAAO9oC,SAAS,CAAC3yD,KAAV,CAAgB5V,IAAhB,EAAsBgxG,WAAW,CAACvpC,IAAD,CAAjC,CAAP;AACD,SAHQ;AAITg1B,QAAAA,QAAQ,EAAEwU,WAJD;AAKT9U,QAAAA,SAAS,EAAE8U,WALF;AAMTnU,QAAAA,QAAQ,EAAE,UAAU98F,IAAV,EAAgB;AACxB,iBAAOuoE,SAAS,CAACu0B,QAAV,CAAmB98F,IAAnB,CAAP;AACD,SARQ;AAST0xB,QAAAA,OAAO,EAAE,UAAUrP,KAAV,EAAiB;AACxB,iBAAOkmD,SAAS,CAAC72C,OAAV,CAAkBrP,KAAlB,CAAP;AACD,SAXQ;AAYT/f,QAAAA,KAAK,EAAE,UAAUtC,IAAV,EAAgBynE,IAAhB,EAAsB4pC,KAAtB,EAA6B;AAClC,iBAAO9oC,SAAS,CAACjmE,KAAV,CAAgBtC,IAAhB,EAAsBgxG,WAAW,CAACvpC,IAAD,CAAjC,CAAP;AACD,SAdQ;AAeT1oD,QAAAA,MAAM,EAAE,UAAU/e,IAAV,EAAgBynE,IAAhB,EAAsB4pC,KAAtB,EAA6BC,QAA7B,EAAuC;AAC7C,iBAAO/oC,SAAS,CAACxpD,MAAV,CAAiB/e,IAAjB,EAAuBgxG,WAAW,CAACvpC,IAAD,CAAlC,CAAP;AACD,SAjBQ;AAkBT6/B,QAAAA,MAAM,EAAE,UAAUtnG,IAAV,EAAgBynE,IAAhB,EAAsB4pC,KAAtB,EAA6B;AACnC,iBAAO9oC,SAAS,CAAC++B,MAAV,CAAiBtnG,IAAjB,EAAuBgxG,WAAW,CAACvpC,IAAD,CAAlC,CAAP;AACD,SApBQ;AAqBTkpC,QAAAA,aAAa,EAAE,UAAUY,IAAV,EAAgBrK,OAAhB,EAAyBr8F,QAAzB,EAAmC0xF,OAAnC,EAA4C;AACzD,iBAAOh0B,SAAS,CAACooC,aAAV,CAAwBzJ,OAAxB,EAAiCr8F,QAAjC,EAA2C0xF,OAA3C,CAAP;AACD;AAvBQ,OAhCN;AAyDLrpE,MAAAA,MAAM,EAAE;AACNs3D,QAAAA,UAAU,EAAE,UAAUroF,IAAV,EAAgBqvG,OAAhB,EAAyB;AACnC,iBAAOt+E,MAAM,CAACs3D,UAAP,CAAkBroF,IAAlB,CAAP;AACD,SAHK;AAIN0vF,QAAAA,UAAU,EAAE,UAAUnzC,OAAV,EAAmBv8C,IAAnB,EAAyB;AACnC,iBAAO+wB,MAAM,CAAC2+D,UAAP,CAAkBnzC,OAAlB,EAA2Bv8C,IAA3B,CAAP;AACD,SANK;AAONyuG,QAAAA,aAAa,EAAE,UAAUlyD,OAAV,EAAmB+yD,QAAnB,EAA6B;AAC1C,iBAAOv+E,MAAM,CAAC09E,aAAP,CAAqBlyD,OAArB,CAAP;AACD,SATK;AAUNy7C,QAAAA,SAAS,EAAEiW;AAVL,OAzDH;AAqELhjD,MAAAA,SAAS,EAAE;AACTo9B,QAAAA,UAAU,EAAE,UAAUgnB,OAAV,EAAmBrvG,IAAnB,EAAyB;AACnC,iBAAOirD,SAAS,CAACo9B,UAAV,CAAqBroF,IAArB,CAAP;AACD;AAHQ,OArEN;AA0ELqjB,MAAAA,GAAG,EAAE;AACHqrF,QAAAA,QAAQ,EAAE,YAAY;AACpB,iBAAO9qG,QAAQ,CAACR,IAAT,CAAcigB,GAAG,CAACksF,WAAJ,EAAd,CAAP;AACD;AAHE;AA1EA,KAAP;AAgFD,GAvFD;;AAwFA,MAAIC,eAAe,GAAG,YAAY;AAChC,QAAIC,GAAG,GAAGjvG,QAAQ,CAAC,IAAD,CAAlB;AACA,QAAIic,KAAK,GAAGjc,QAAQ,CAAC,EAAD,CAApB;AACA,WAAO;AACLksE,MAAAA,WAAW,EAAE;AACXwgC,QAAAA,YAAY,EAAEttG,IADH;AAEXutG,QAAAA,YAAY,EAAEsC,GAFH;AAGX3B,QAAAA,IAAI,EAAE2B,GAHK;AAIX5B,QAAAA,IAAI,EAAE4B,GAJK;AAKXhC,QAAAA,KAAK,EAAE7tG,IALI;AAMXwoF,QAAAA,KAAK,EAAExoF,IANI;AAOXmuG,QAAAA,OAAO,EAAE1sG,KAPE;AAQX2sG,QAAAA,OAAO,EAAE3sG,KARE;AASXsrE,QAAAA,QAAQ,EAAE8iC,GATC;AAUXxB,QAAAA,MAAM,EAAEruG,IAVG;AAWX8tG,QAAAA,KAAK,EAAE9tG;AAXI,OADR;AAcLwmE,MAAAA,SAAS,EAAE;AACT3yD,QAAAA,KAAK,EAAEpS,KADE;AAETi5F,QAAAA,QAAQ,EAAE95F,QAAQ,CAAC,EAAD,CAFT;AAGTw5F,QAAAA,SAAS,EAAE34F,KAHF;AAITs5F,QAAAA,QAAQ,EAAEt5F,KAJD;AAKTkuB,QAAAA,OAAO,EAAE9S,KALA;AAMTtc,QAAAA,KAAK,EAAEP,IANE;AAOTgd,QAAAA,MAAM,EAAEhd,IAPC;AAQTulG,QAAAA,MAAM,EAAEvlG,IARC;AAST4uG,QAAAA,aAAa,EAAEhuG,QAAQ,CAAC;AAAEurC,UAAAA,MAAM,EAAEnsC;AAAV,SAAD;AATd,OAdN;AAyBLmxB,MAAAA,MAAM,EAAE;AACNs3D,QAAAA,UAAU,EAAE5rE,KADN;AAENizE,QAAAA,UAAU,EAAEjzE,KAFN;AAGNgyF,QAAAA,aAAa,EAAE7uG,IAHT;AAINo4F,QAAAA,SAAS,EAAEp4F;AAJL,OAzBH;AA+BLqrD,MAAAA,SAAS,EAAE;AAAEo9B,QAAAA,UAAU,EAAE5rE;AAAd,OA/BN;AAgCL4G,MAAAA,GAAG,EAAE;AAAEqrF,QAAAA,QAAQ,EAAEluG,QAAQ,CAACoD,QAAQ,CAACrC,IAAT,EAAD;AAApB;AAhCA,KAAP;AAkCD,GArCD;;AAsCA,MAAImuG,KAAK,GAAG,UAAU3+E,MAAV,EAAkB;AAC5B,WAAO9oB,GAAG,CAAC8oB,MAAM,CAAC4+E,OAAR,EAAiB,KAAjB,CAAV;AACD,GAFD;;AAGA,MAAIC,OAAO,GAAG,UAAU7+E,MAAV,EAAkB;AAC9B,QAAI8+E,UAAU,GAAG9+E,MAAjB;AACA,WAAOhpB,KAAK,CAACgpB,MAAM,CAAC4+E,OAAR,EAAiB,KAAjB,CAAL,CAA6B5tG,IAA7B,CAAkC,YAAY;AACnD8tG,MAAAA,UAAU,CAACC,WAAX,GAAyBvB,gBAAgB,CAACx9E,MAAD,CAAzC;AACA,aAAOntB,QAAQ,CAACrC,IAAT,EAAP;AACD,KAHM,EAGJ,UAAUwuG,GAAV,EAAe;AAChB,aAAOnsG,QAAQ,CAACR,IAAT,CAAc2sG,GAAG,CAACjkD,KAAJ,GAAYjjC,IAAZ,CAAiB,UAAU+lF,SAAV,EAAqB;AACzDiB,QAAAA,UAAU,CAACC,WAAX,GAAyBnB,cAAc,CAACC,SAAD,CAAvC;AACA,eAAOA,SAAS,CAACmB,GAAV,CAAcC,QAArB;AACD,OAHoB,EAGlB,UAAUvmF,GAAV,EAAe;AAChBomF,QAAAA,UAAU,CAACC,WAAX,GAAyBN,eAAe,EAAxC;AACA,eAAOz/E,UAAU,CAACrH,MAAX,CAAkBe,GAAlB,CAAP;AACD,OANoB,CAAd,CAAP;AAOD,KAXM,CAAP;AAYD,GAdD;;AAeA,MAAIwmF,0BAA0B,GAAG,UAAUl/E,MAAV,EAAkB;AACjD,WAAOA,MAAM,CAAC++E,WAAP,GAAqB/+E,MAAM,CAAC++E,WAA5B,GAA0CvB,gBAAgB,CAACx9E,MAAD,CAAjE;AACD,GAFD;;AAGA,MAAIm/E,uBAAuB,GAAG,UAAUn/E,MAAV,EAAkB;AAC9C,QAAI++E,WAAW,GAAG/+E,MAAM,CAAC++E,WAAzB;;AACA,QAAI,CAACA,WAAL,EAAkB;AAChB,YAAM,IAAI1uG,KAAJ,CAAU,iDAAV,CAAN;AACD,KAFD,MAEO;AACL,aAAO0uG,WAAP;AACD;AACF,GAPD;;AAQA,MAAIK,cAAc,GAAG,UAAUp/E,MAAV,EAAkB87E,KAAlB,EAAyBf,cAAzB,EAAyC;AAC5DoE,IAAAA,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgC27C,WAAhC,CAA4CwgC,YAA5C,CAAyDL,KAAzD,EAAgEf,cAAhE;AACD,GAFD;;AAGA,MAAIsE,cAAc,GAAG,UAAUr/E,MAAV,EAAkB27C,WAAlB,EAA+B7jE,KAA/B,EAAsCgkG,KAAtC,EAA6Cf,cAA7C,EAA6DM,KAA7D,EAAoE/wF,KAApE,EAA2E;AAC9F,WAAO60F,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgC27C,WAAhC,CAA4CygC,YAA5C,CAAyDzgC,WAAzD,EAAsE7jE,KAAtE,EAA6EgkG,KAA7E,EAAoFf,cAApF,EAAoGM,KAApG,EAA2G/wF,KAA3G,CAAP;AACD,GAFD;;AAGA,MAAIg1F,MAAM,GAAG,UAAUt/E,MAAV,EAAkB27C,WAAlB,EAA+BmgC,KAA/B,EAAsChkG,KAAtC,EAA6C;AACxD,WAAOqnG,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgC27C,WAAhC,CAA4CohC,IAA5C,CAAiDphC,WAAjD,EAA8DmgC,KAA9D,EAAqEhkG,KAArE,CAAP;AACD,GAFD;;AAGA,MAAIynG,MAAM,GAAG,UAAUv/E,MAAV,EAAkBloB,KAAlB,EAAyB0iB,IAAzB,EAA+B;AAC1C,WAAO2kF,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgC27C,WAAhC,CAA4CmhC,IAA5C,CAAiDhlG,KAAjD,EAAwD0iB,IAAxD,CAAP;AACD,GAFD;;AAGA,MAAIglF,OAAO,GAAG,UAAUx/E,MAAV,EAAkB27C,WAAlB,EAA+B7jE,KAA/B,EAAsC;AAClDqnG,IAAAA,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgC27C,WAAhC,CAA4C+gC,KAA5C,CAAkD/gC,WAAlD,EAA+D7jE,KAA/D;AACD,GAFD;;AAGA,MAAI2nG,OAAO,GAAG,UAAUz/E,MAAV,EAAkB27C,WAAlB,EAA+B;AAC3CwjC,IAAAA,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgC27C,WAAhC,CAA4C0b,KAA5C,CAAkD1b,WAAlD;AACD,GAFD;;AAGA,MAAI+jC,SAAS,GAAG,UAAU1/E,MAAV,EAAkB27C,WAAlB,EAA+B7jE,KAA/B,EAAsC;AACpD,WAAOqnG,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgC27C,WAAhC,CAA4CqhC,OAA5C,CAAoDrhC,WAApD,EAAiE7jE,KAAjE,CAAP;AACD,GAFD;;AAGA,MAAI6nG,SAAS,GAAG,UAAU3/E,MAAV,EAAkB27C,WAAlB,EAA+B7jE,KAA/B,EAAsC;AACpD,WAAOqnG,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgC27C,WAAhC,CAA4CshC,OAA5C,CAAoDthC,WAApD,EAAiE7jE,KAAjE,CAAP;AACD,GAFD;;AAGA,MAAI8nG,UAAU,GAAG,UAAU5/E,MAAV,EAAkB27C,WAAlB,EAA+BmgC,KAA/B,EAAsCnkG,QAAtC,EAAgD;AAC/D,WAAOwnG,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgC27C,WAAhC,CAA4CC,QAA5C,CAAqDD,WAArD,EAAkEmgC,KAAlE,EAAyEnkG,QAAzE,CAAP;AACD,GAFD;;AAGA,MAAIkoG,QAAQ,GAAG,UAAU7/E,MAAV,EAAkB87E,KAAlB,EAAyBnkG,QAAzB,EAAmC;AAChDwnG,IAAAA,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgC27C,WAAhC,CAA4CuhC,MAA5C,CAAmDpB,KAAnD,EAA0DnkG,QAA1D;AACD,GAFD;;AAGA,MAAImoG,OAAO,GAAG,UAAU9/E,MAAV,EAAkB27C,WAAlB,EAA+B7jE,KAA/B,EAAsC8kG,SAAtC,EAAiDC,SAAjD,EAA4D;AACxEsC,IAAAA,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgC27C,WAAhC,CAA4CghC,KAA5C,CAAkDhhC,WAAlD,EAA+D7jE,KAA/D,EAAsE8kG,SAAtE,EAAiFC,SAAjF;AACD,GAFD;;AAGA,MAAIkD,WAAW,GAAG,UAAU//E,MAAV,EAAkBlzB,IAAlB,EAAwBynE,IAAxB,EAA8B3vD,IAA9B,EAAoC;AACpD,WAAOu6F,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgCq1C,SAAhC,CAA0C3yD,KAA1C,CAAgD5V,IAAhD,EAAsDynE,IAAtD,EAA4D3vD,IAA5D,CAAP;AACD,GAFD;;AAGA,MAAIo7F,eAAe,GAAG,UAAUhgF,MAAV,EAAkB7Q,KAAlB,EAAyBolD,IAAzB,EAA+B;AACnD,WAAO4qC,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgCq1C,SAAhC,CAA0Ck0B,QAA1C,CAAmDp6E,KAAnD,EAA0DolD,IAA1D,CAAP;AACD,GAFD;;AAGA,MAAI0rC,eAAe,GAAG,UAAUjgF,MAAV,EAAkBpb,IAAlB,EAAwB9X,IAAxB,EAA8BynE,IAA9B,EAAoC80B,OAApC,EAA6C;AACjE,WAAO8V,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgCq1C,SAAhC,CAA0C4zB,SAA1C,CAAoDrkF,IAApD,EAA0D9X,IAA1D,EAAgEynE,IAAhE,EAAsE80B,OAAtE,CAAP;AACD,GAFD;;AAGA,MAAI6W,cAAc,GAAG,UAAUlgF,MAAV,EAAkBlzB,IAAlB,EAAwB;AAC3C,WAAOqyG,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgCq1C,SAAhC,CAA0Cu0B,QAA1C,CAAmD98F,IAAnD,CAAP;AACD,GAFD;;AAGA,MAAIqzG,aAAa,GAAG,UAAUngF,MAAV,EAAkB7Q,KAAlB,EAAyB;AAC3C,WAAOgwF,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgCq1C,SAAhC,CAA0C72C,OAA1C,CAAkDrP,KAAlD,CAAP;AACD,GAFD;;AAGA,MAAIixF,aAAa,GAAG,UAAUpgF,MAAV,EAAkBlzB,IAAlB,EAAwBynE,IAAxB,EAA8B3vD,IAA9B,EAAoC;AACtDu6F,IAAAA,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgCq1C,SAAhC,CAA0CjmE,KAA1C,CAAgDtC,IAAhD,EAAsDynE,IAAtD,EAA4D3vD,IAA5D;AACD,GAFD;;AAGA,MAAIy7F,cAAc,GAAG,UAAUrgF,MAAV,EAAkBlzB,IAAlB,EAAwBynE,IAAxB,EAA8B3vD,IAA9B,EAAoCykF,OAApC,EAA6C;AAChE8V,IAAAA,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgCq1C,SAAhC,CAA0CxpD,MAA1C,CAAiD/e,IAAjD,EAAuDynE,IAAvD,EAA6D3vD,IAA7D,EAAmEykF,OAAnE;AACD,GAFD;;AAGA,MAAIiX,YAAY,GAAG,UAAUtgF,MAAV,EAAkBlzB,IAAlB,EAAwBynE,IAAxB,EAA8B3vD,IAA9B,EAAoC;AACrDu6F,IAAAA,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgCq1C,SAAhC,CAA0C++B,MAA1C,CAAiDtnG,IAAjD,EAAuDynE,IAAvD,EAA6D3vD,IAA7D;AACD,GAFD;;AAGA,MAAI64F,aAAa,GAAG,UAAUz9E,MAAV,EAAkBuzE,yBAAlB,EAA6CS,OAA7C,EAAsDr8F,QAAtD,EAAgE0xF,OAAhE,EAAyE;AAC3F,QAAIA,OAAO,KAAK,KAAK,CAArB,EAAwB;AACtBA,MAAAA,OAAO,GAAG,KAAV;AACD;;AACD,WAAO8V,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgCq1C,SAAhC,CAA0CooC,aAA1C,CAAwDlK,yBAAxD,EAAmFS,OAAnF,EAA4Fr8F,QAA5F,EAAsG0xF,OAAtG,CAAP;AACD,GALD;;AAMA,MAAI/R,UAAU,GAAG,UAAUt3D,MAAV,EAAkB/wB,IAAlB,EAAwBgmE,MAAxB,EAAgC;AAC/C,WAAOiqC,0BAA0B,CAACl/E,MAAD,CAA1B,CAAmCA,MAAnC,CAA0Cs3D,UAA1C,CAAqDroF,IAArD,EAA2DgmE,MAA3D,CAAP;AACD,GAFD;;AAGA,MAAI0pB,UAAU,GAAG,UAAU3+D,MAAV,EAAkBwrB,OAAlB,EAA2Bv8C,IAA3B,EAAiC;AAChD,WAAOiwG,0BAA0B,CAACl/E,MAAD,CAA1B,CAAmCA,MAAnC,CAA0C2+D,UAA1C,CAAqDnzC,OAArD,EAA8Dv8C,IAA9D,CAAP;AACD,GAFD;;AAGA,MAAIyuG,aAAa,GAAG,UAAU19E,MAAV,EAAkBtwB,KAAlB,EAAyB82F,OAAzB,EAAkC;AACpD,WAAO0Y,0BAA0B,CAACl/E,MAAD,CAA1B,CAAmCA,MAAnC,CAA0C09E,aAA1C,CAAwDhuG,KAAxD,EAA+D82F,OAA/D,CAAP;AACD,GAFD;;AAGA,MAAI+Z,kBAAkB,GAAG,UAAUvgF,MAAV,EAAkBi1C,MAAlB,EAA0BhmE,IAA1B,EAAgC;AACvD,WAAOkwG,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgCk6B,SAAhC,CAA0Co9B,UAA1C,CAAqDriB,MAArD,EAA6DhmE,IAA7D,CAAP;AACD,GAFD;;AAGA,MAAIg4F,SAAS,GAAG,UAAUjnE,MAAV,EAAkBjN,GAAlB,EAAuB;AACrC,WAAOosF,uBAAuB,CAACn/E,MAAD,CAAvB,CAAgCA,MAAhC,CAAuCinE,SAAvC,CAAiDl0E,GAAjD,CAAP;AACD,GAFD;;AAIA,MAAIytF,YAAY,GAAG,UAAUxgF,MAAV,EAAkB/wB,IAAlB,EAAwB;AACzC,QAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AACnBA,MAAAA,IAAI,GAAG,EAAP;AACD;;AACD,QAAIgmE,MAAM,GAAGhmE,IAAI,CAACgmE,MAAL,GAAchmE,IAAI,CAACgmE,MAAnB,GAA4B,MAAzC;AACA,WAAOsrC,kBAAkB,CAACvgF,MAAD,EAASi1C,MAAT,EAAiBhmE,IAAjB,CAAzB;AACD,GAND;;AAQA,MAAI4hC,WAAW,GAAG,UAAU/rB,IAAV,EAAgB;AAChC,QAAIA,IAAI,CAACE,GAAL,CAAShX,MAAT,KAAoB,CAAxB,EAA2B;AACzB6d,MAAAA,MAAM,CAAC/G,IAAD,CAAN;AACA,aAAOjS,QAAQ,CAACrC,IAAT,EAAP;AACD,KAHD,MAGO;AACL,aAAOqC,QAAQ,CAACR,IAAT,CAAcyS,IAAd,CAAP;AACD;AACF,GAPD;;AAQA,MAAI27F,gBAAgB,GAAG,UAAU77F,IAAV,EAAgBnI,KAAhB,EAAuB;AAC5C,WAAOmI,IAAI,CAAC5S,MAAL,CAAY,UAAU+gB,GAAV,EAAe;AAChC,aAAOqpD,eAAe,CAACnyC,cAAhB,CAA+BlX,GAAG,CAAC/N,GAAnC,CAAP;AACD,KAFM,EAEJnT,IAFI,CAEC4K,KAAK,GAAGyM,WAAH,GAAiBF,WAFvB,CAAP;AAGD,GAJD;;AAKA,MAAIw8E,KAAK,GAAG,UAAUkb,KAAV,EAAiB9oB,KAAjB,EAAwB39B,GAAxB,EAA6Bx9C,KAA7B,EAAoC;AAC9C,QAAIkkG,QAAQ,GAAGD,KAAK,CAAC17F,GAArB;AACA,QAAI0xF,QAAQ,GAAG9e,KAAK,CAAC5yE,GAArB;AACA,QAAI47F,SAAS,GAAGnkG,KAAK,GAAGkkG,QAAQ,CAAC3yG,MAAZ,GAAqB0oG,QAAQ,CAAC1oG,MAAnD;;AACA,QAAIyO,KAAJ,EAAW;AACTigF,MAAAA,cAAc,CAACikB,QAAD,EAAWjK,QAAX,EAAqB,KAArB,EAA4B,CAACj6F,KAA7B,CAAd;AACAw9C,MAAAA,GAAG,CAAC5G,QAAJ,CAAaqjD,QAAb,EAAuBkK,SAAvB;AACD,KAHD,MAGO;AACLlkB,MAAAA,cAAc,CAACga,QAAD,EAAWiK,QAAX,EAAqB,KAArB,EAA4B,CAAClkG,KAA7B,CAAd;AACAw9C,MAAAA,GAAG,CAAC3G,MAAJ,CAAWojD,QAAX,EAAqBkK,SAArB;AACD;AACF,GAXD;;AAYA,MAAIC,uBAAuB,GAAG,UAAUjpB,KAAV,EAAiBn7E,KAAjB,EAAwB;AACpDuG,IAAAA,MAAM,CAAC40E,KAAD,CAAN,CAAchmF,IAAd,CAAmB,UAAUuQ,IAAV,EAAgB;AACjC,UAAI2C,IAAI,GAAG8yE,KAAK,CAAC5yE,GAAjB;;AACA,UAAIvI,KAAK,IAAI0+E,iBAAiB,CAACh5E,IAAD,EAAO0/C,aAAa,CAAC/8C,IAAD,EAAO,CAAP,CAApB,CAA9B,EAA8D;AAC5Dy3E,QAAAA,wBAAwB,CAACz3E,IAAD,EAAO,CAAP,CAAxB;AACD,OAFD,MAEO,IAAI,CAACrI,KAAD,IAAU2+E,kBAAkB,CAACj5E,IAAD,EAAO0/C,aAAa,CAAC/8C,IAAD,EAAOA,IAAI,CAAC9W,MAAZ,CAApB,CAAhC,EAA0E;AAC/EyuF,QAAAA,yBAAyB,CAAC33E,IAAD,EAAOA,IAAI,CAAC9W,MAAZ,CAAzB;AACD;AACF,KAPD;AAQD,GATD;;AAUA,MAAI8yG,qBAAqB,GAAG,UAAUC,SAAV,EAAqB5wC,SAArB,EAAgClW,GAAhC,EAAqCx9C,KAArC,EAA4C;AACtEskG,IAAAA,SAAS,CAAClvG,IAAV,CAAe,UAAU6uG,KAAV,EAAiB;AAC9B,UAAIM,UAAU,GAAGvkG,KAAK,GAAGggF,yBAAH,GAA+BF,wBAArD;AACAykB,MAAAA,UAAU,CAACN,KAAK,CAAC17F,GAAP,EAAYvI,KAAK,GAAGikG,KAAK,CAAC17F,GAAN,CAAUhX,MAAb,GAAsB,CAAvC,CAAV;AACA,aAAOmiE,SAAS,CAACn+D,MAAV,CAAiB6V,MAAjB,EAAyBlW,GAAzB,CAA6B,UAAUimF,KAAV,EAAiB;AACnD,eAAO4N,KAAK,CAACkb,KAAD,EAAQ9oB,KAAR,EAAe39B,GAAf,EAAoBx9C,KAApB,CAAZ;AACD,OAFM,CAAP;AAGD,KAND,EAMG/K,OANH,CAMW,YAAY;AACrB,UAAIuvG,aAAa,GAAGR,gBAAgB,CAACtwC,SAAD,EAAY1zD,KAAZ,CAAhB,CAAmChL,EAAnC,CAAsC0+D,SAAtC,EAAiDn+D,MAAjD,CAAwD6V,MAAxD,CAApB;AACA,aAAOo5F,aAAa,CAACtvG,GAAd,CAAkB,UAAUimF,KAAV,EAAiB;AACxC,eAAOipB,uBAAuB,CAACjpB,KAAD,EAAQn7E,KAAR,CAA9B;AACD,OAFM,CAAP;AAGD,KAXD;AAYD,GAbD;;AAcA,MAAIykG,aAAa,GAAG,UAAUjnD,GAAV,EAAeiD,QAAf,EAAyB;AAC3C,QAAI3zC,UAAU,GAAG1W,QAAQ,CAACD,IAAT,CAAcsqD,QAAQ,CAAC3zC,UAAvB,EAAmC5X,GAAnC,CAAuCyT,YAAY,CAACX,OAApD,CAAjB;AACA,QAAI+E,SAAS,GAAG3W,QAAQ,CAACD,IAAT,CAAcsqD,QAAQ,CAAC1zC,SAAvB,EAAkC7X,GAAlC,CAAsCyT,YAAY,CAACX,OAAnD,CAAhB;AACAw1C,IAAAA,GAAG,CAACinC,cAAJ;AACAjnC,IAAAA,GAAG,CAACsI,UAAJ,CAAerF,QAAf;AACA,QAAIikD,QAAQ,GAAG53F,UAAU,CAAC1X,IAAX,CAAgBmX,WAAhB,EAA6BhX,MAA7B,CAAoC6V,MAApC,EAA4ChW,IAA5C,CAAiDg/B,WAAjD,CAAf;AACA,QAAIuwE,QAAQ,GAAG53F,SAAS,CAAC3X,IAAV,CAAeqX,WAAf,EAA4BlX,MAA5B,CAAmC6V,MAAnC,EAA2ChW,IAA3C,CAAgDg/B,WAAhD,CAAf;AACAiwE,IAAAA,qBAAqB,CAACK,QAAD,EAAW53F,UAAX,EAAuB0wC,GAAvB,EAA4B,IAA5B,CAArB;AACA6mD,IAAAA,qBAAqB,CAACM,QAAD,EAAW53F,SAAX,EAAsBywC,GAAtB,EAA2B,KAA3B,CAArB;AACAA,IAAAA,GAAG,CAACwE,QAAJ,CAAa,KAAb;AACD,GAVD;;AAWA,MAAI4iD,SAAS,GAAG,UAAUpyG,IAAV,EAAgBu8C,OAAhB,EAAyB;AACvC,WAAO/yC,QAAQ,CAACA,QAAQ,CAAC;AAAEw8D,MAAAA,MAAM,EAAE;AAAV,KAAD,EAAqBhmE,IAArB,CAAT,EAAqC;AAClDkiB,MAAAA,GAAG,EAAE,IAD6C;AAElD+oC,MAAAA,SAAS,EAAE,IAFuC;AAGlD1O,MAAAA,OAAO,EAAEA;AAHyC,KAArC,CAAf;AAKD,GAND;;AAOA,MAAI81D,YAAY,GAAG,UAAUthF,MAAV,EAAkB/wB,IAAlB,EAAwB;AACzC,QAAIA,IAAI,CAACgmE,MAAL,KAAgB,KAApB,EAA2B;AACzB,UAAIhb,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AACA,UAAIonD,YAAY,GAAGvhF,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqB0J,GAAG,CAACq1B,uBAAzB,EAAkDtvD,MAAM,CAAChb,GAAP,CAAW4f,OAA7D,CAAnB;AACA,UAAI48E,WAAW,GAAGD,YAAY,GAAG;AAAEjiE,QAAAA,OAAO,EAAEiiE,YAAY,CAAC95F,QAAb,CAAsBpM,WAAtB;AAAX,OAAH,GAAsD,EAApF;AACA,UAAIuJ,IAAI,GAAGob,MAAM,CAACymE,MAAP,CAAcpxD,KAAd,CAAoBpmC,IAAI,CAACu8C,OAAzB,EAAkC/yC,QAAQ,CAACA,QAAQ,CAAC;AAC7DwvF,QAAAA,aAAa,EAAE,IAD8C;AAE7DmL,QAAAA,iBAAiB,EAAE;AAF0C,OAAD,EAG3DoO,WAH2D,CAAT,EAGpCvyG,IAHoC,CAA1C,CAAX;AAIA,aAAOsoF,cAAc,CAAC;AAAE5L,QAAAA,QAAQ,EAAE3rD,MAAM,CAAC2rD;AAAnB,OAAD,EAAgC3rD,MAAM,CAAC8M,MAAvC,CAAd,CAA6DgK,SAA7D,CAAuElyB,IAAvE,CAAP;AACD,KATD,MASO;AACL,aAAO3V,IAAI,CAACu8C,OAAZ;AACD;AACF,GAbD;;AAcA,MAAIi2D,YAAY,GAAG,UAAUzhF,MAAV,EAAkBwrB,OAAlB,EAA2Bv8C,IAA3B,EAAiC;AAClD,QAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AACnBA,MAAAA,IAAI,GAAG,EAAP;AACD;;AACD,QAAIyyG,WAAW,GAAGL,SAAS,CAACpyG,IAAD,EAAOu8C,OAAP,CAA3B;;AACA,QAAI,CAACk2D,WAAW,CAACvrB,SAAjB,EAA4B;AAC1BurB,MAAAA,WAAW,GAAG1hF,MAAM,CAACmb,IAAP,CAAY,kBAAZ,EAAgCumE,WAAhC,CAAd;;AACA,UAAIA,WAAW,CAAC3pE,kBAAZ,EAAJ,EAAsC;AACpC/X,QAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0BumE,WAA1B;AACA;AACD;AACF;;AACDzyG,IAAAA,IAAI,CAACu8C,OAAL,GAAe81D,YAAY,CAACthF,MAAD,EAAS0hF,WAAT,CAA3B;AACA,QAAIznD,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AACA+mD,IAAAA,aAAa,CAACjnD,GAAD,EAAMA,GAAG,CAAC0nD,wBAAJ,CAA6B1yG,IAAI,CAACu8C,OAAlC,CAAN,CAAb;AACAxrB,IAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB;AACAovB,IAAAA,mBAAmB,CAACrpD,MAAD,EAASi6B,GAAT,CAAnB;;AACA,QAAI,CAACynD,WAAW,CAACvrB,SAAjB,EAA4B;AAC1Bn2D,MAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0BumE,WAA1B;AACD;AACF,GApBD;;AAsBA,MAAIE,qBAAqB,GAAG,UAAUtmD,WAAV,EAAuBn1C,QAAvB,EAAiCxO,QAAjC,EAA2C;AACrE,QAAI2jD,WAAW,IAAIA,WAAW,CAACtlD,cAAZ,CAA2BmQ,QAA3B,CAAnB,EAAyD;AACvD,UAAI07F,YAAY,GAAG7vG,MAAM,CAACspD,WAAW,CAACn1C,QAAD,CAAZ,EAAwB,UAAU1O,EAAV,EAAc;AAC7D,eAAOA,EAAE,KAAKE,QAAd;AACD,OAFwB,CAAzB;;AAGA,UAAIkqG,YAAY,CAAC7zG,MAAb,KAAwB,CAA5B,EAA+B;AAC7B,eAAOstD,WAAW,CAACn1C,QAAD,CAAlB;AACD,OAFD,MAEO;AACLm1C,QAAAA,WAAW,CAACn1C,QAAD,CAAX,GAAwB07F,YAAxB;AACD;AACF;AACF,GAXD;;AAYA,WAASC,eAAT,CAA0B98F,GAA1B,EAA+Bgb,MAA/B,EAAuC;AACrC,QAAI+hF,mBAAJ;AACA,QAAIC,gBAAJ;AACA,WAAO;AACLC,MAAAA,yBAAyB,EAAE,UAAU97F,QAAV,EAAoBxO,QAApB,EAA8B;AACvD,YAAI,CAACoqG,mBAAL,EAA0B;AACxBA,UAAAA,mBAAmB,GAAG,EAAtB;AACAC,UAAAA,gBAAgB,GAAG,EAAnB;AACAhiF,UAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwB,UAAUjd,CAAV,EAAa;AACnC,gBAAI+L,IAAI,GAAG/L,CAAC,CAACqN,OAAb;AAAA,gBAAsBqC,OAAO,GAAGvD,GAAG,CAACorC,UAAJ,CAAexrC,IAAf,EAAqB,IAArB,EAA2BI,GAAG,CAACypC,OAAJ,EAA3B,CAAhC;AAAA,gBAA2EyzD,gBAAgB,GAAG,EAA9F;AACAx+F,YAAAA,KAAK,CAAC9R,IAAN,CAAWmwG,mBAAX,EAAgC,UAAUtnF,SAAV,EAAqBtU,QAArB,EAA+B;AAC7DzC,cAAAA,KAAK,CAAC9R,IAAN,CAAW2W,OAAX,EAAoB,UAAU3D,IAAV,EAAgB;AAClC,oBAAII,GAAG,CAAC9T,EAAJ,CAAO0T,IAAP,EAAauB,QAAb,CAAJ,EAA4B;AAC1B,sBAAI,CAAC67F,gBAAgB,CAAC77F,QAAD,CAArB,EAAiC;AAC/BzC,oBAAAA,KAAK,CAAC9R,IAAN,CAAW6oB,SAAX,EAAsB,UAAU9iB,QAAV,EAAoB;AACxCA,sBAAAA,QAAQ,CAAC,IAAD,EAAO;AACbiN,wBAAAA,IAAI,EAAEA,IADO;AAEbuB,wBAAAA,QAAQ,EAAEA,QAFG;AAGboC,wBAAAA,OAAO,EAAEA;AAHI,uBAAP,CAAR;AAKD,qBAND;AAOAy5F,oBAAAA,gBAAgB,CAAC77F,QAAD,CAAhB,GAA6BsU,SAA7B;AACD;;AACDynF,kBAAAA,gBAAgB,CAAC/7F,QAAD,CAAhB,GAA6BsU,SAA7B;AACA,yBAAO,KAAP;AACD;AACF,eAfD;AAgBD,aAjBD;AAkBA/W,YAAAA,KAAK,CAAC9R,IAAN,CAAWowG,gBAAX,EAA6B,UAAUvnF,SAAV,EAAqBtU,QAArB,EAA+B;AAC1D,kBAAI,CAAC+7F,gBAAgB,CAAC/7F,QAAD,CAArB,EAAiC;AAC/B,uBAAO67F,gBAAgB,CAAC77F,QAAD,CAAvB;AACAzC,gBAAAA,KAAK,CAAC9R,IAAN,CAAW6oB,SAAX,EAAsB,UAAU9iB,QAAV,EAAoB;AACxCA,kBAAAA,QAAQ,CAAC,KAAD,EAAQ;AACdiN,oBAAAA,IAAI,EAAEA,IADQ;AAEduB,oBAAAA,QAAQ,EAAEA,QAFI;AAGdoC,oBAAAA,OAAO,EAAEA;AAHK,mBAAR,CAAR;AAKD,iBAND;AAOD;AACF,aAXD;AAYD,WAhCD;AAiCD;;AACD,YAAI,CAACw5F,mBAAmB,CAAC57F,QAAD,CAAxB,EAAoC;AAClC47F,UAAAA,mBAAmB,CAAC57F,QAAD,CAAnB,GAAgC,EAAhC;AACD;;AACD47F,QAAAA,mBAAmB,CAAC57F,QAAD,CAAnB,CAA8BnS,IAA9B,CAAmC2D,QAAnC;AACA,eAAO;AACLqjC,UAAAA,MAAM,EAAE,YAAY;AAClB4mE,YAAAA,qBAAqB,CAACG,mBAAD,EAAsB57F,QAAtB,EAAgCxO,QAAhC,CAArB;AACAiqG,YAAAA,qBAAqB,CAACI,gBAAD,EAAmB77F,QAAnB,EAA6BxO,QAA7B,CAArB;AACD;AAJI,SAAP;AAMD;AAjDI,KAAP;AAmDD;;AAED,MAAIwqG,mBAAmB,GAAG,UAAUloD,GAAV,EAAe;AACvC,WAAO,CAAC,CAACA,GAAG,CAACle,MAAb;AACD,GAFD;;AAGA,MAAIqmE,eAAe,GAAG,UAAUx9F,IAAV,EAAgB;AACpC,WAAO,CAAC,EAAEA,IAAI,IAAIA,IAAI,CAACqD,aAAf,CAAD,IAAkCX,UAAU,CAAClC,YAAY,CAACX,OAAb,CAAqBG,IAAI,CAACqD,aAA1B,CAAD,EAA2C7C,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAA3C,CAAnD;AACD,GAFD;;AAGA,MAAIy9F,YAAY,GAAG,UAAUpoD,GAAV,EAAe;AAChC,QAAI,CAACA,GAAL,EAAU;AACR,aAAO,KAAP;AACD,KAFD,MAEO,IAAIkoD,mBAAmB,CAACloD,GAAD,CAAvB,EAA8B;AACnC,aAAO,IAAP;AACD,KAFM,MAEA;AACL,aAAOmoD,eAAe,CAACnoD,GAAG,CAACryB,cAAL,CAAf,IAAuCw6E,eAAe,CAACnoD,GAAG,CAAClG,YAAL,CAA7D;AACD;AACF,GARD;;AASA,MAAIuuD,eAAe,GAAG,UAAUt9F,GAAV,EAAe4H,GAAf,EAAoBqvC,UAApB,EAAgCj8B,MAAhC,EAAwC;AAC5D,QAAIuiF,aAAJ;AACA,QAAIC,aAAJ;AACA,QAAIP,yBAAyB,GAAGH,eAAe,CAAC98F,GAAD,EAAMgb,MAAN,CAAf,CAA6BiiF,yBAA7D;;AACA,QAAIrjB,iBAAiB,GAAG,UAAUh6E,IAAV,EAAgBgiB,MAAhB,EAAwB;AAC9C,UAAIqzB,GAAG,GAAGj1C,GAAG,CAAC+tC,SAAJ,EAAV;;AACA,UAAIr/C,aAAa,CAACkR,IAAD,CAAb,IAAuBlR,aAAa,CAACkzB,MAAD,CAAxC,EAAkD;AAChDqzB,QAAAA,GAAG,CAAC5G,QAAJ,CAAazuC,IAAb,EAAmBgiB,MAAnB;AACAqzB,QAAAA,GAAG,CAAC3G,MAAJ,CAAW1uC,IAAX,EAAiBgiB,MAAjB;AACAusC,QAAAA,MAAM,CAAClZ,GAAD,CAAN;AACAwE,QAAAA,QAAQ,CAAC,KAAD,CAAR;AACD,OALD,MAKO;AACLgb,QAAAA,cAAc,CAACz0D,GAAD,EAAMi1C,GAAN,EAAWj6B,MAAM,CAACo6B,OAAP,EAAX,EAA6B,IAA7B,CAAd;AACA+Y,QAAAA,MAAM,CAAClZ,GAAD,CAAN;AACD;AACF,KAXD;;AAYA,QAAIq9B,UAAU,GAAG,UAAUroF,IAAV,EAAgB;AAC/B,aAAOuxG,YAAY,CAACxgF,MAAD,EAAS/wB,IAAT,CAAnB;AACD,KAFD;;AAGA,QAAI0vF,UAAU,GAAG,UAAUnzC,OAAV,EAAmBv8C,IAAnB,EAAyB;AACxC,aAAOwyG,YAAY,CAACzhF,MAAD,EAASwrB,OAAT,EAAkBv8C,IAAlB,CAAnB;AACD,KAFD;;AAGA,QAAIyzE,QAAQ,GAAG,UAAUuM,IAAV,EAAgB;AAC7B,aAAOC,UAAU,CAAClvD,MAAM,CAACo6B,OAAP,EAAD,EAAmBqoD,QAAQ,EAA3B,EAA+BxzB,IAA/B,CAAjB;AACD,KAFD;;AAGA,QAAIyzB,QAAQ,GAAG,UAAUzzB,IAAV,EAAgB;AAC7B,aAAOtM,MAAM,CAAC3iD,MAAM,CAACo6B,OAAP,EAAD,EAAmBqoD,QAAQ,EAA3B,EAA+BxzB,IAA/B,CAAb;AACD,KAFD;;AAGA,QAAI3pB,WAAW,GAAG,UAAUtyD,IAAV,EAAgB66C,UAAhB,EAA4B;AAC5C,aAAO80D,eAAe,CAACr9C,WAAhB,CAA4BtyD,IAA5B,EAAkC66C,UAAlC,CAAP;AACD,KAFD;;AAGA,QAAIuX,cAAc,GAAG,UAAUjB,QAAV,EAAoB;AACvC,aAAOw+C,eAAe,CAACv9C,cAAhB,CAA+BjB,QAA/B,CAAP;AACD,KAFD;;AAGA,QAAIpoB,MAAM,GAAG,UAAUn3B,IAAV,EAAgB4mC,OAAhB,EAAyB;AACpCkkC,MAAAA,QAAQ,CAAC1qE,GAAD,EAAMJ,IAAN,EAAY4mC,OAAZ,CAAR,CAA6B55C,IAA7B,CAAkCuhE,MAAlC;AACA,aAAOvuD,IAAP;AACD,KAHD;;AAIA,QAAIw/C,WAAW,GAAG,YAAY;AAC5B,UAAInK,GAAG,GAAGwoD,QAAQ,EAAlB;AAAA,UAAsB9oC,GAAG,GAAGR,MAAM,EAAlC;;AACA,UAAI,CAAClf,GAAD,IAAQA,GAAG,CAACpiD,IAAhB,EAAsB;AACpB,eAAO,KAAP;AACD;;AACD,UAAIoiD,GAAG,CAAC2oD,gBAAR,EAA0B;AACxB,eAAO3oD,GAAG,CAAC2oD,gBAAJ,CAAqB,YAArB,EAAmC3oD,GAAnC,MAA4C,CAAnD;AACD;;AACD,aAAO,CAAC0f,GAAD,IAAQ1f,GAAG,CAAC+K,SAAnB;AACD,KATD;;AAUA,QAAIvG,QAAQ,GAAG,UAAUC,OAAV,EAAmB;AAChC,UAAIzE,GAAG,GAAGwoD,QAAQ,EAAlB;AACAxoD,MAAAA,GAAG,CAACwE,QAAJ,CAAa,CAAC,CAACC,OAAf;AACAyU,MAAAA,MAAM,CAAClZ,GAAD,CAAN;AACD,KAJD;;AAKA,QAAIkf,MAAM,GAAG,YAAY;AACvB,aAAOvsD,GAAG,CAAC3L,YAAJ,GAAmB2L,GAAG,CAAC3L,YAAJ,EAAnB,GAAwC2L,GAAG,CAACzL,QAAJ,CAAa+4C,SAA5D;AACD,KAFD;;AAGA,QAAIuoD,QAAQ,GAAG,YAAY;AACzB,UAAIvoD,SAAJ,EAAeD,GAAf,EAAoBlnC,GAApB;;AACA,UAAI8vF,wBAAwB,GAAG,UAAUC,GAAV,EAAeC,WAAf,EAA4BC,gBAA5B,EAA8C;AAC3E,YAAI;AACF,iBAAOD,WAAW,CAACE,qBAAZ,CAAkCH,GAAlC,EAAuCE,gBAAvC,CAAP;AACD,SAFD,CAEE,OAAO5qF,EAAP,EAAW;AACX,iBAAO,CAAC,CAAR;AACD;AACF,OAND;;AAOA,UAAInU,GAAG,GAAG2I,GAAG,CAACzL,QAAd;;AACA,UAAI6e,MAAM,CAACmkC,QAAP,KAAoB33D,SAApB,IAAiC8hF,UAAU,CAACtuD,MAAD,CAAV,KAAuB,KAA5D,EAAmE;AACjE,YAAImkC,QAAQ,GAAGhK,MAAM,CAACn6B,MAAD,CAArB;;AACA,YAAImkC,QAAQ,CAAChzD,MAAT,EAAJ,EAAuB;AACrB,iBAAOgzD,QAAQ,CAACxyD,GAAT,CAAa,UAAUwC,CAAV,EAAa;AAC/B,mBAAOw7E,aAAa,CAAC3vD,MAAD,EAAS,CAAC7rB,CAAD,CAAT,CAAb,CAA2B,CAA3B,CAAP;AACD,WAFM,EAEJ/C,KAFI,CAEE6S,GAAG,CAAC+uC,WAAJ,EAFF,CAAP;AAGD;AACF;;AACD,UAAI;AACF,YAAI,CAACkH,SAAS,GAAGif,MAAM,EAAnB,KAA0B,CAACpqD,gBAAgB,CAACmrC,SAAS,CAACgpD,UAAX,CAA/C,EAAuE;AACrE,cAAIhpD,SAAS,CAACwe,UAAV,GAAuB,CAA3B,EAA8B;AAC5Bze,YAAAA,GAAG,GAAGC,SAAS,CAACye,UAAV,CAAqB,CAArB,CAAN;AACD,WAFD,MAEO;AACL1e,YAAAA,GAAG,GAAGC,SAAS,CAAClH,WAAV,GAAwBkH,SAAS,CAAClH,WAAV,EAAxB,GAAkD/uC,GAAG,CAAC+uC,WAAJ,EAAxD;AACD;;AACDiH,UAAAA,GAAG,GAAG01B,aAAa,CAAC3vD,MAAD,EAAS,CAACi6B,GAAD,CAAT,CAAb,CAA6B,CAA7B,CAAN;AACD;AACF,OATD,CASE,OAAO7hC,EAAP,EAAW,CACZ;;AACD,UAAI,CAAC6hC,GAAL,EAAU;AACRA,QAAAA,GAAG,GAAGh2C,GAAG,CAAC+uC,WAAJ,GAAkB/uC,GAAG,CAAC+uC,WAAJ,EAAlB,GAAsC/uC,GAAG,CAACiI,IAAJ,CAASo3D,eAAT,EAA5C;AACD;;AACD,UAAIrpB,GAAG,CAAC5G,QAAJ,IAAgB4G,GAAG,CAACryB,cAAJ,CAAmBxhB,QAAnB,KAAgC,CAAhD,IAAqD6zC,GAAG,CAAC+K,SAA7D,EAAwE;AACtEjyC,QAAAA,GAAG,GAAG/N,GAAG,CAACypC,OAAJ,EAAN;AACAwL,QAAAA,GAAG,CAAC5G,QAAJ,CAAatgC,GAAb,EAAkB,CAAlB;AACAknC,QAAAA,GAAG,CAAC3G,MAAJ,CAAWvgC,GAAX,EAAgB,CAAhB;AACD;;AACD,UAAIwvF,aAAa,IAAIC,aAArB,EAAoC;AAClC,YAAIK,wBAAwB,CAAC5oD,GAAG,CAACkpD,cAAL,EAAqBlpD,GAArB,EAA0BsoD,aAA1B,CAAxB,KAAqE,CAArE,IAA0EM,wBAAwB,CAAC5oD,GAAG,CAACmpD,UAAL,EAAiBnpD,GAAjB,EAAsBsoD,aAAtB,CAAxB,KAAiE,CAA/I,EAAkJ;AAChJtoD,UAAAA,GAAG,GAAGuoD,aAAN;AACD,SAFD,MAEO;AACLD,UAAAA,aAAa,GAAG,IAAhB;AACAC,UAAAA,aAAa,GAAG,IAAhB;AACD;AACF;;AACD,aAAOvoD,GAAP;AACD,KA9CD;;AA+CA,QAAIkZ,MAAM,GAAG,UAAUlZ,GAAV,EAAe5W,OAAf,EAAwB;AACnC,UAAIz+B,IAAJ;;AACA,UAAI,CAACy9F,YAAY,CAACpoD,GAAD,CAAjB,EAAwB;AACtB;AACD;;AACD,UAAIopD,OAAO,GAAGlB,mBAAmB,CAACloD,GAAD,CAAnB,GAA2BA,GAA3B,GAAiC,IAA/C;;AACA,UAAIopD,OAAJ,EAAa;AACXb,QAAAA,aAAa,GAAG,IAAhB;;AACA,YAAI;AACFa,UAAAA,OAAO,CAACtnE,MAAR;AACD,SAFD,CAEE,OAAO3jB,EAAP,EAAW,CACZ;;AACD;AACD;;AACD,UAAIuhD,GAAG,GAAGR,MAAM,EAAhB;AACA,UAAI1+B,GAAG,GAAGza,MAAM,CAACmb,IAAP,CAAY,mBAAZ,EAAiC;AACzCn6B,QAAAA,KAAK,EAAEi5C,GADkC;AAEzC5W,QAAAA,OAAO,EAAEA;AAFgC,OAAjC,CAAV;AAIA4W,MAAAA,GAAG,GAAGxf,GAAG,CAACz5B,KAAV;;AACA,UAAI24D,GAAJ,EAAS;AACP6oC,QAAAA,aAAa,GAAGvoD,GAAhB;;AACA,YAAI;AACF0f,UAAAA,GAAG,CAAC2pC,eAAJ;AACA3pC,UAAAA,GAAG,CAAC4pC,QAAJ,CAAatpD,GAAb;AACD,SAHD,CAGE,OAAO7hC,EAAP,EAAW,CACZ;;AACD,YAAIirB,OAAO,KAAK,KAAZ,IAAqBs2B,GAAG,CAAC72D,MAA7B,EAAqC;AACnC62D,UAAAA,GAAG,CAAClb,QAAJ,CAAaxE,GAAG,CAAClG,YAAjB,EAA+BkG,GAAG,CAACjG,SAAnC;AACA2lB,UAAAA,GAAG,CAAC72D,MAAJ,CAAWm3C,GAAG,CAACryB,cAAf,EAA+BqyB,GAAG,CAACnG,WAAnC;AACD;;AACDyuD,QAAAA,aAAa,GAAG5oC,GAAG,CAACjB,UAAJ,GAAiB,CAAjB,GAAqBiB,GAAG,CAAChB,UAAJ,CAAe,CAAf,CAArB,GAAyC,IAAzD;AACD;;AACD,UAAI,CAAC1e,GAAG,CAAC+K,SAAL,IAAkB/K,GAAG,CAACryB,cAAJ,KAAuBqyB,GAAG,CAAClG,YAA7C,IAA6D4lB,GAAG,CAAC6pC,gBAAjE,IAAqF,CAAC/iG,GAAG,CAAChD,EAA9F,EAAkG;AAChG,YAAIw8C,GAAG,CAACjG,SAAJ,GAAgBiG,GAAG,CAACnG,WAApB,GAAkC,CAAtC,EAAyC;AACvC,cAAImG,GAAG,CAACryB,cAAJ,CAAmBvjB,aAAnB,EAAJ,EAAwC;AACtCO,YAAAA,IAAI,GAAGq1C,GAAG,CAACryB,cAAJ,CAAmBtjB,UAAnB,CAA8B21C,GAAG,CAACnG,WAAlC,CAAP;;AACA,gBAAIlvC,IAAI,IAAIA,IAAI,CAACsL,OAAL,KAAiB,KAA7B,EAAoC;AAClCypD,cAAAA,GAAG,CAAC6pC,gBAAJ,CAAqBvpD,GAAG,CAACryB,cAAzB,EAAyCqyB,GAAG,CAACnG,WAA7C,EAA0DmG,GAAG,CAAClG,YAA9D,EAA4EkG,GAAG,CAACjG,SAAhF;;AACA,kBAAI2lB,GAAG,CAACupC,UAAJ,KAAmBjpD,GAAG,CAACryB,cAAvB,IAAyC+xC,GAAG,CAAC8pC,SAAJ,KAAkBxpD,GAAG,CAAClG,YAAnE,EAAiF;AAC/E4lB,gBAAAA,GAAG,CAAC6pC,gBAAJ,CAAqB5+F,IAArB,EAA2B,CAA3B,EAA8BA,IAA9B,EAAoC,CAApC;AACD;AACF;AACF;AACF;AACF;;AACDob,MAAAA,MAAM,CAACmb,IAAP,CAAY,wBAAZ,EAAsC;AACpCn6B,QAAAA,KAAK,EAAEi5C,GAD6B;AAEpC5W,QAAAA,OAAO,EAAEA;AAF2B,OAAtC;AAID,KAlDD;;AAmDA,QAAIqgE,OAAO,GAAG,UAAU3wF,GAAV,EAAe;AAC3B4rE,MAAAA,UAAU,CAAC35E,GAAG,CAAC+sC,YAAJ,CAAiBh/B,GAAjB,CAAD,CAAV;AACA,aAAOA,GAAP;AACD,KAHD;;AAIA,QAAIusC,OAAO,GAAG,YAAY;AACxB,aAAO+vB,SAAS,CAACrvD,MAAM,CAACo6B,OAAP,EAAD,EAAmBqoD,QAAQ,EAA3B,CAAhB;AACD,KAFD;;AAGA,QAAIkB,mBAAmB,GAAG,UAAUthC,QAAV,EAAoBmN,MAApB,EAA4B;AACpD,aAAOD,iBAAiB,CAACvqE,GAAD,EAAMy9F,QAAQ,EAAd,EAAkBpgC,QAAlB,EAA4BmN,MAA5B,CAAxB;AACD,KAFD;;AAGA,QAAIo0B,SAAS,GAAG,YAAY;AAC1B,UAAIjqC,GAAG,GAAGR,MAAM,EAAhB;AACA,UAAI+pC,UAAU,GAAGvpC,GAAG,KAAK,IAAR,IAAgBA,GAAG,KAAK,KAAK,CAA7B,GAAiC,KAAK,CAAtC,GAA0CA,GAAG,CAACupC,UAA/D;AACA,UAAIO,SAAS,GAAG9pC,GAAG,KAAK,IAAR,IAAgBA,GAAG,KAAK,KAAK,CAA7B,GAAiC,KAAK,CAAtC,GAA0CA,GAAG,CAAC8pC,SAA9D;;AACA,UAAI,CAAC9pC,GAAD,IAAQ,CAACupC,UAAT,IAAuB,CAACO,SAAxB,IAAqC10F,gBAAgB,CAACm0F,UAAD,CAArD,IAAqEn0F,gBAAgB,CAAC00F,SAAD,CAAzF,EAAsG;AACpG,eAAO,IAAP;AACD;;AACD,UAAII,WAAW,GAAG7+F,GAAG,CAAC+tC,SAAJ,EAAlB;AACA8wD,MAAAA,WAAW,CAACxwD,QAAZ,CAAqB6vD,UAArB,EAAiCvpC,GAAG,CAACmqC,YAArC;AACAD,MAAAA,WAAW,CAACplD,QAAZ,CAAqB,IAArB;AACA,UAAIslD,UAAU,GAAG/+F,GAAG,CAAC+tC,SAAJ,EAAjB;AACAgxD,MAAAA,UAAU,CAAC1wD,QAAX,CAAoBowD,SAApB,EAA+B9pC,GAAG,CAACqqC,WAAnC;AACAD,MAAAA,UAAU,CAACtlD,QAAX,CAAoB,IAApB;AACA,aAAOolD,WAAW,CAACZ,qBAAZ,CAAkCY,WAAW,CAACV,cAA9C,EAA8DY,UAA9D,KAA6E,CAApF;AACD,KAdD;;AAeA,QAAI1+B,WAAW,GAAG,YAAY;AAC5B,UAAIprB,GAAG,GAAGwoD,QAAQ,EAAlB;AACA,UAAI9oC,GAAG,GAAGR,MAAM,EAAhB;;AACA,UAAI,CAACN,iBAAiB,CAACc,GAAD,CAAlB,IAA2BD,YAAY,CAAC15C,MAAD,CAA3C,EAAqD;AACnD,YAAIklD,OAAO,GAAGD,SAAS,CAACjgE,GAAD,EAAMi1C,GAAN,CAAvB;AACAirB,QAAAA,OAAO,CAACtzE,IAAR,CAAa,UAAUszE,OAAV,EAAmB;AAC9B/R,UAAAA,MAAM,CAAC+R,OAAD,EAAU0+B,SAAS,EAAnB,CAAN;AACD,SAFD;AAGA,eAAO1+B,OAAO,CAAC9zE,KAAR,CAAc6oD,GAAd,CAAP;AACD;;AACD,aAAOA,GAAP;AACD,KAXD;;AAYA,QAAIgqD,eAAe,GAAG,UAAU99F,QAAV,EAAoBxO,QAApB,EAA8B;AAClDsqG,MAAAA,yBAAyB,CAAC97F,QAAD,EAAWxO,QAAX,CAAzB;AACA,aAAOic,OAAP;AACD,KAHD;;AAIA,QAAIswF,kBAAkB,GAAG,YAAY;AACnC,UAAIC,eAAJ;AACA,UAAIv/F,IAAI,GAAGI,GAAG,CAACypC,OAAJ,EAAX;;AACA,aAAO7pC,IAAI,IAAIA,IAAI,CAAC6C,QAAL,KAAkB,MAAjC,EAAyC;AACvC,YAAI7C,IAAI,CAAC28D,YAAL,GAAoB38D,IAAI,CAAC4J,YAA7B,EAA2C;AACzC21F,UAAAA,eAAe,GAAGv/F,IAAlB;AACA;AACD;;AACDA,QAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,aAAO67F,eAAP;AACD,KAXD;;AAYA,QAAIt2F,cAAc,GAAG,UAAUkF,GAAV,EAAepF,UAAf,EAA2B;AAC9C,aAAOw7D,qBAAqB,CAACnpD,MAAD,EAASjN,GAAT,EAAcpF,UAAd,CAA5B;AACD,KAFD;;AAGA,QAAIy2F,YAAY,GAAG,UAAUtrE,OAAV,EAAmBG,OAAnB,EAA4B;AAC7C,aAAOk6B,MAAM,CAACwQ,WAAW,CAAC7qC,OAAD,EAAUG,OAAV,EAAmBjZ,MAAM,CAACm7C,MAAP,EAAnB,CAAZ,CAAb;AACD,KAFD;;AAGA,QAAI1uD,qBAAqB,GAAG,YAAY;AACtC,UAAIwtC,GAAG,GAAGwoD,QAAQ,EAAlB;AACA,aAAOxoD,GAAG,CAAC+K,SAAJ,GAAgBnD,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,EAAkCoH,cAAlC,GAAmD,CAAnD,CAAhB,GAAwEpH,GAAG,CAACxtC,qBAAJ,EAA/E;AACD,KAHD;;AAIA,QAAI6uB,OAAO,GAAG,YAAY;AACxB1uB,MAAAA,GAAG,GAAG21F,aAAa,GAAGC,aAAa,GAAG,IAAtC;AACA6B,MAAAA,gBAAgB,CAAC/oE,OAAjB;AACD,KAHD;;AAIA,QAAI1nB,OAAO,GAAG;AACZ+uF,MAAAA,eAAe,EAAE,IADL;AAEZ0B,MAAAA,gBAAgB,EAAE,IAFN;AAGZr/F,MAAAA,GAAG,EAAEA,GAHO;AAIZ4H,MAAAA,GAAG,EAAEA,GAJO;AAKZqvC,MAAAA,UAAU,EAAEA,UALA;AAMZj8B,MAAAA,MAAM,EAAEA,MANI;AAOZy+B,MAAAA,QAAQ,EAAEA,QAPE;AAQZmgC,MAAAA,iBAAiB,EAAEA,iBARP;AASZtH,MAAAA,UAAU,EAAEA,UATA;AAUZqH,MAAAA,UAAU,EAAEA,UAVA;AAWZr5B,MAAAA,WAAW,EAAEA,WAXD;AAYZF,MAAAA,cAAc,EAAEA,cAZJ;AAaZrpB,MAAAA,MAAM,EAAEA,MAbI;AAcZqoB,MAAAA,WAAW,EAAEA,WAdD;AAeZw/C,MAAAA,SAAS,EAAEA,SAfC;AAgBZF,MAAAA,OAAO,EAAEA,OAhBG;AAiBZpkD,MAAAA,OAAO,EAAEA,OAjBG;AAkBZ6Z,MAAAA,MAAM,EAAEA,MAlBI;AAmBZhG,MAAAA,MAAM,EAAEA,MAnBI;AAoBZhZ,MAAAA,MAAM,EAAEsoD,QApBI;AAqBZ//B,MAAAA,QAAQ,EAAEA,QArBE;AAsBZC,MAAAA,MAAM,EAAE+/B,QAtBI;AAuBZnzB,MAAAA,iBAAiB,EAAEo0B,mBAvBP;AAwBZ1+B,MAAAA,SAAS,EAAEI,WAxBC;AAyBZ4+B,MAAAA,eAAe,EAAEA,eAzBL;AA0BZhC,MAAAA,yBAAyB,EAAEA,yBA1Bf;AA2BZiC,MAAAA,kBAAkB,EAAEA,kBA3BR;AA4BZr2F,MAAAA,cAAc,EAAEA,cA5BJ;AA6BZu2F,MAAAA,YAAY,EAAEA,YA7BF;AA8BZ33F,MAAAA,qBAAqB,EAAEA,qBA9BX;AA+BZ6uB,MAAAA,OAAO,EAAEA;AA/BG,KAAd;AAiCA,QAAIqnE,eAAe,GAAGvmC,eAAe,CAACxoD,OAAD,CAArC;AACA,QAAIywF,gBAAgB,GAAG9lC,gBAAgB,CAAC3qD,OAAD,EAAUoM,MAAV,CAAvC;AACApM,IAAAA,OAAO,CAAC+uF,eAAR,GAA0BA,eAA1B;AACA/uF,IAAAA,OAAO,CAACywF,gBAAR,GAA2BA,gBAA3B;AACA,WAAOzwF,OAAP;AACD,GAnQD;;AAqQA,MAAI0wF,WAAW,GAAG,UAAU1/F,IAAV,EAAgBuK,KAAhB,EAAuB;AACvCvd,IAAAA,IAAI,CAACud,KAAD,EAAQ,UAAUriB,IAAV,EAAgB;AAC1B8X,MAAAA,IAAI,CAACgN,IAAL,CAAU9kB,IAAV,EAAgB,IAAhB;AACD,KAFG,CAAJ;AAGD,GAJD;;AAKA,MAAIy3G,oBAAoB,GAAG,UAAUC,SAAV,EAAqBryF,MAArB,EAA6BsyF,SAA7B,EAAwC;AACjED,IAAAA,SAAS,CAACtoD,aAAV,CAAwB,MAAxB,EAAgC,UAAUrpC,KAAV,EAAiB;AAC/CjhB,MAAAA,IAAI,CAACihB,KAAD,EAAQ,UAAUjO,IAAV,EAAgB;AAC1B,YAAIzO,KAAK,GAAGgc,MAAM,CAACkjB,KAAP,CAAazwB,IAAI,CAACgN,IAAL,CAAU,OAAV,CAAb,CAAZ;AACA,YAAIwjB,KAAK,GAAGxwB,IAAI,CAACgN,IAAL,CAAU,OAAV,CAAZ;AACA,YAAI8yF,IAAI,GAAG9/F,IAAI,CAACgN,IAAL,CAAU,MAAV,CAAX;AACA,YAAIs+B,IAAI,GAAGtrC,IAAI,CAACgN,IAAL,CAAU,MAAV,CAAX;;AACA,YAAIwjB,KAAJ,EAAW;AACTj/B,UAAAA,KAAK,CAACi/B,KAAN,GAAcA,KAAd;AACD;;AACD,YAAIsvE,IAAJ,EAAU;AACRvuG,UAAAA,KAAK,CAAC,aAAD,CAAL,GAAuBuuG,IAAvB;AACD;;AACD,YAAIx0D,IAAJ,EAAU;AACR/5C,UAAAA,KAAK,CAAC,WAAD,CAAL,GAAqBsuG,SAAS,CAACn5E,QAAQ,CAAC1mB,IAAI,CAACgN,IAAL,CAAU,MAAV,CAAD,EAAoB,EAApB,CAAR,GAAkC,CAAnC,CAA9B;AACD;;AACDhN,QAAAA,IAAI,CAAC9X,IAAL,GAAY,MAAZ;AACA8X,QAAAA,IAAI,CAACgN,IAAL,CAAU,OAAV,EAAmBO,MAAM,CAAC2kB,SAAP,CAAiB3gC,KAAjB,CAAnB;AACAmuG,QAAAA,WAAW,CAAC1/F,IAAD,EAAO,CAChB,OADgB,EAEhB,MAFgB,EAGhB,MAHgB,CAAP,CAAX;AAKD,OArBG,CAAJ;AAsBD,KAvBD;AAwBD,GAzBD;;AA0BA,MAAI+/F,qBAAqB,GAAG,UAAUH,SAAV,EAAqBryF,MAArB,EAA6B;AACvDqyF,IAAAA,SAAS,CAACtoD,aAAV,CAAwB,QAAxB,EAAkC,UAAUrpC,KAAV,EAAiB;AACjDjhB,MAAAA,IAAI,CAACihB,KAAD,EAAQ,UAAUjO,IAAV,EAAgB;AAC1B,YAAIzO,KAAK,GAAGgc,MAAM,CAACkjB,KAAP,CAAazwB,IAAI,CAACgN,IAAL,CAAU,OAAV,CAAb,CAAZ;AACAzb,QAAAA,KAAK,CAAC,iBAAD,CAAL,GAA2B,cAA3B;AACAyO,QAAAA,IAAI,CAAC9X,IAAL,GAAY,MAAZ;AACA8X,QAAAA,IAAI,CAACgN,IAAL,CAAU,OAAV,EAAmBO,MAAM,CAAC2kB,SAAP,CAAiB3gC,KAAjB,CAAnB;AACD,OALG,CAAJ;AAMD,KAPD;AAQD,GATD;;AAUA,MAAIyuG,UAAU,GAAG,UAAUJ,SAAV,EAAqBlkF,QAArB,EAA+B;AAC9C,QAAInO,MAAM,GAAGwiB,MAAM,EAAnB;;AACA,QAAIrU,QAAQ,CAACukF,sBAAb,EAAqC;AACnCN,MAAAA,oBAAoB,CAACC,SAAD,EAAYryF,MAAZ,EAAoBzO,KAAK,CAACJ,OAAN,CAAcgd,QAAQ,CAACwkF,uBAAvB,CAApB,CAApB;AACD;;AACDH,IAAAA,qBAAqB,CAACH,SAAD,EAAYryF,MAAZ,CAArB;AACD,GAND;;AAOA,MAAI4yF,UAAU,GAAG,UAAUP,SAAV,EAAqBlkF,QAArB,EAA+B;AAC9C,QAAIA,QAAQ,CAAC0kF,aAAb,EAA4B;AAC1BJ,MAAAA,UAAU,CAACJ,SAAD,EAAYlkF,QAAZ,CAAV;AACD;AACF,GAJD;;AAMA,MAAI2kF,aAAa,GAAG,UAAUxhG,GAAV,EAAe;AACjC,WAAO,IAAIub,UAAJ,CAAe,UAAUjc,OAAV,EAAmB4U,MAAnB,EAA2B;AAC/C,UAAIutF,eAAe,GAAG,YAAY;AAChCvtF,QAAAA,MAAM,CAAC,oBAAoBlU,GAApB,GAA0B,wDAA3B,CAAN;AACD,OAFD;;AAGA,UAAI;AACF,YAAI0hG,KAAK,GAAG,IAAIC,cAAJ,EAAZ;AACAD,QAAAA,KAAK,CAACE,IAAN,CAAW,KAAX,EAAkB5hG,GAAlB,EAAuB,IAAvB;AACA0hG,QAAAA,KAAK,CAACG,YAAN,GAAqB,MAArB;;AACAH,QAAAA,KAAK,CAACzjF,MAAN,GAAe,YAAY;AACzB,cAAIyjF,KAAK,CAAC1jF,MAAN,KAAiB,GAArB,EAA0B;AACxB1e,YAAAA,OAAO,CAACoiG,KAAK,CAACI,QAAP,CAAP;AACD,WAFD,MAEO;AACLL,YAAAA,eAAe;AAChB;AACF,SAND;;AAOAC,QAAAA,KAAK,CAACxjF,OAAN,GAAgBujF,eAAhB;AACAC,QAAAA,KAAK,CAACK,IAAN;AACD,OAbD,CAaE,OAAOptF,EAAP,EAAW;AACX8sF,QAAAA,eAAe;AAChB;AACF,KApBM,CAAP;AAqBD,GAtBD;;AAuBA,MAAIO,cAAc,GAAG,UAAU/0B,GAAV,EAAe;AAClC,QAAI19E,IAAJ;AACA,QAAI0yG,QAAQ,GAAG30B,kBAAkB,CAACL,GAAD,CAAlB,CAAwB3uE,KAAxB,CAA8B,GAA9B,CAAf;AACA,QAAIhC,OAAO,GAAG,eAAeyC,IAAf,CAAoBkjG,QAAQ,CAAC,CAAD,CAA5B,CAAd;;AACA,QAAI3lG,OAAJ,EAAa;AACX/M,MAAAA,IAAI,GAAG+M,OAAO,CAAC,CAAD,CAAd;AACD;;AACD,WAAO;AACL/M,MAAAA,IAAI,EAAEA,IADD;AAELwnB,MAAAA,IAAI,EAAEkrF,QAAQ,CAAC,CAAD;AAFT,KAAP;AAID,GAXD;;AAYA,MAAIC,SAAS,GAAG,UAAU3yG,IAAV,EAAgBwnB,IAAhB,EAAsB;AACpC,QAAIpe,GAAJ;;AACA,QAAI;AACFA,MAAAA,GAAG,GAAGwpG,IAAI,CAACprF,IAAD,CAAV;AACD,KAFD,CAEE,OAAO3hB,CAAP,EAAU;AACV,aAAOhG,QAAQ,CAACrC,IAAT,EAAP;AACD;;AACD,QAAIkE,GAAG,GAAG,IAAImxG,UAAJ,CAAezpG,GAAG,CAACpO,MAAnB,CAAV;;AACA,SAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwG,GAAG,CAAC1G,MAAxB,EAAgCE,CAAC,EAAjC,EAAqC;AACnCwG,MAAAA,GAAG,CAACxG,CAAD,CAAH,GAASkO,GAAG,CAACuvB,UAAJ,CAAez9B,CAAf,CAAT;AACD;;AACD,WAAO2E,QAAQ,CAACR,IAAT,CAAc,IAAIyzG,IAAJ,CAAS,CAACpxG,GAAD,CAAT,EAAgB;AAAE1B,MAAAA,IAAI,EAAEA;AAAR,KAAhB,CAAd,CAAP;AACD,GAZD;;AAaA,MAAI+yG,aAAa,GAAG,UAAUr1B,GAAV,EAAe;AACjC,WAAO,IAAI1xD,UAAJ,CAAe,UAAUjc,OAAV,EAAmB;AACvC,UAAI64C,EAAE,GAAG6pD,cAAc,CAAC/0B,GAAD,CAAvB;AAAA,UAA8B19E,IAAI,GAAG4oD,EAAE,CAAC5oD,IAAxC;AAAA,UAA8CwnB,IAAI,GAAGohC,EAAE,CAACphC,IAAxD;;AACAmrF,MAAAA,SAAS,CAAC3yG,IAAD,EAAOwnB,IAAP,CAAT,CAAsBxpB,IAAtB,CAA2B,YAAY;AACrC,eAAO+R,OAAO,CAAC,IAAI+iG,IAAJ,CAAS,EAAT,CAAD,CAAd;AACD,OAFD,EAEG/iG,OAFH;AAGD,KALM,CAAP;AAMD,GAPD;;AAQA,MAAIijG,SAAS,GAAG,UAAUviG,GAAV,EAAe;AAC7B,QAAIA,GAAG,CAACxW,OAAJ,CAAY,OAAZ,MAAyB,CAA7B,EAAgC;AAC9B,aAAOg4G,aAAa,CAACxhG,GAAD,CAApB;AACD;;AACD,QAAIA,GAAG,CAACxW,OAAJ,CAAY,OAAZ,MAAyB,CAA7B,EAAgC;AAC9B,aAAO84G,aAAa,CAACtiG,GAAD,CAApB;AACD;;AACD,WAAO,IAAP;AACD,GARD;;AASA,MAAIwiG,aAAa,GAAG,UAAUC,IAAV,EAAgB;AAClC,WAAO,IAAIlnF,UAAJ,CAAe,UAAUjc,OAAV,EAAmB;AACvC,UAAIojG,MAAM,GAAG,IAAIC,UAAJ,EAAb;;AACAD,MAAAA,MAAM,CAACE,SAAP,GAAmB,YAAY;AAC7BtjG,QAAAA,OAAO,CAACojG,MAAM,CAAC9nF,MAAR,CAAP;AACD,OAFD;;AAGA8nF,MAAAA,MAAM,CAACG,aAAP,CAAqBJ,IAArB;AACD,KANM,CAAP;AAOD,GARD;;AAUA,MAAIrqF,KAAK,GAAG,CAAZ;;AACA,MAAIi2B,QAAQ,GAAG,UAAUn1C,MAAV,EAAkB;AAC/B,WAAO,CAACA,MAAM,IAAI,QAAX,IAAuBkf,KAAK,EAAnC;AACD,GAFD;;AAGA,MAAI0qF,eAAe,GAAG,UAAUC,SAAV,EAAqBhkC,GAArB,EAA0Bz/D,OAA1B,EAAmC4U,MAAnC,EAA2C;AAC/D,QAAI8uF,MAAJ,EAAYC,QAAZ;;AACA,QAAIlkC,GAAG,CAAC/0B,GAAJ,CAAQxgD,OAAR,CAAgB,OAAhB,MAA6B,CAAjC,EAAoC;AAClCy5G,MAAAA,QAAQ,GAAGF,SAAS,CAACG,QAAV,CAAmBnkC,GAAG,CAAC/0B,GAAvB,CAAX;;AACA,UAAIi5D,QAAJ,EAAc;AACZ3jG,QAAAA,OAAO,CAAC;AACN6jG,UAAAA,KAAK,EAAEpkC,GADD;AAENkkC,UAAAA,QAAQ,EAAEA;AAFJ,SAAD,CAAP;AAID,OALD,MAKO;AACLV,QAAAA,SAAS,CAACxjC,GAAG,CAAC/0B,GAAL,CAAT,CAAmB31B,IAAnB,CAAwB,UAAUouF,IAAV,EAAgB;AACtCD,UAAAA,aAAa,CAACC,IAAD,CAAb,CAAoBpuF,IAApB,CAAyB,UAAU+uF,OAAV,EAAmB;AAC1CJ,YAAAA,MAAM,GAAGhB,cAAc,CAACoB,OAAD,CAAd,CAAwBrsF,IAAjC;AACAksF,YAAAA,QAAQ,GAAGF,SAAS,CAACtkG,MAAV,CAAiB4vC,QAAQ,EAAzB,EAA6Bo0D,IAA7B,EAAmCO,MAAnC,CAAX;AACAD,YAAAA,SAAS,CAACn5E,GAAV,CAAcq5E,QAAd;AACA3jG,YAAAA,OAAO,CAAC;AACN6jG,cAAAA,KAAK,EAAEpkC,GADD;AAENkkC,cAAAA,QAAQ,EAAEA;AAFJ,aAAD,CAAP;AAID,WARD;AASD,SAVD,EAUG,UAAUhuF,GAAV,EAAe;AAChBf,UAAAA,MAAM,CAACe,GAAD,CAAN;AACD,SAZD;AAaD;;AACD;AACD;;AACD,QAAIkjC,EAAE,GAAG6pD,cAAc,CAACjjC,GAAG,CAAC/0B,GAAL,CAAvB;AAAA,QAAkCjzB,IAAI,GAAGohC,EAAE,CAACphC,IAA5C;AAAA,QAAkDxnB,IAAI,GAAG4oD,EAAE,CAAC5oD,IAA5D;;AACAyzG,IAAAA,MAAM,GAAGjsF,IAAT;AACAksF,IAAAA,QAAQ,GAAGF,SAAS,CAACM,SAAV,CAAoBL,MAApB,EAA4BzzG,IAA5B,CAAX;;AACA,QAAI0zG,QAAJ,EAAc;AACZ3jG,MAAAA,OAAO,CAAC;AACN6jG,QAAAA,KAAK,EAAEpkC,GADD;AAENkkC,QAAAA,QAAQ,EAAEA;AAFJ,OAAD,CAAP;AAID,KALD,MAKO;AACLV,MAAAA,SAAS,CAACxjC,GAAG,CAAC/0B,GAAL,CAAT,CAAmB31B,IAAnB,CAAwB,UAAUouF,IAAV,EAAgB;AACtCQ,QAAAA,QAAQ,GAAGF,SAAS,CAACtkG,MAAV,CAAiB4vC,QAAQ,EAAzB,EAA6Bo0D,IAA7B,EAAmCO,MAAnC,CAAX;AACAD,QAAAA,SAAS,CAACn5E,GAAV,CAAcq5E,QAAd;AACA3jG,QAAAA,OAAO,CAAC;AACN6jG,UAAAA,KAAK,EAAEpkC,GADD;AAENkkC,UAAAA,QAAQ,EAAEA;AAFJ,SAAD,CAAP;AAID,OAPD,EAOG,UAAUhuF,GAAV,EAAe;AAChBf,QAAAA,MAAM,CAACe,GAAD,CAAN;AACD,OATD;AAUD;AACF,GA9CD;;AA+CA,MAAIquF,YAAY,GAAG,UAAUh0F,GAAV,EAAe;AAChC,WAAOA,GAAG,GAAGjd,MAAM,CAACid,GAAG,CAACwU,oBAAJ,CAAyB,KAAzB,CAAD,CAAT,GAA6C,EAAvD;AACD,GAFD;;AAGA,MAAIy/E,YAAY,GAAG,UAAUC,YAAV,EAAwBT,SAAxB,EAAmC;AACpD,QAAIU,cAAc,GAAG,EAArB;;AACA,QAAIvsD,OAAO,GAAG,UAAU5nC,GAAV,EAAexa,SAAf,EAA0B;AACtC,UAAI,CAACA,SAAL,EAAgB;AACdA,QAAAA,SAAS,GAAGhI,MAAZ;AACD;;AACD,UAAI42G,MAAM,GAAGn1G,MAAM,CAAC+0G,YAAY,CAACh0F,GAAD,CAAb,EAAoB,UAAUyvD,GAAV,EAAe;AACpD,YAAI/0B,GAAG,GAAG+0B,GAAG,CAAC/0B,GAAd;;AACA,YAAI,CAAChtC,GAAG,CAACJ,OAAT,EAAkB;AAChB,iBAAO,KAAP;AACD;;AACD,YAAImiE,GAAG,CAAC9yD,YAAJ,CAAiB,gBAAjB,CAAJ,EAAwC;AACtC,iBAAO,KAAP;AACD;;AACD,YAAI8yD,GAAG,CAAC9yD,YAAJ,CAAiB,sBAAjB,CAAJ,EAA8C;AAC5C,iBAAO,KAAP;AACD;;AACD,YAAI,CAAC+9B,GAAD,IAAQA,GAAG,KAAKhtC,GAAG,CAACK,cAAxB,EAAwC;AACtC,iBAAO,KAAP;AACD;;AACD,YAAI2sC,GAAG,CAACxgD,OAAJ,CAAY,OAAZ,MAAyB,CAA7B,EAAgC;AAC9B,iBAAO,CAACg6G,YAAY,CAACG,UAAb,CAAwB35D,GAAxB,CAAD,IAAiCl1C,SAAS,CAACiqE,GAAD,CAAjD;AACD;;AACD,YAAI/0B,GAAG,CAACxgD,OAAJ,CAAY,OAAZ,MAAyB,CAA7B,EAAgC;AAC9B,iBAAOsL,SAAS,CAACiqE,GAAD,CAAhB;AACD;;AACD,eAAO,KAAP;AACD,OArBkB,CAAnB;AAsBA,UAAI6kC,QAAQ,GAAG11G,GAAG,CAACw1G,MAAD,EAAS,UAAU3kC,GAAV,EAAe;AACxC,YAAI0kC,cAAc,CAAC1kC,GAAG,CAAC/0B,GAAL,CAAd,KAA4BjhD,SAAhC,EAA2C;AACzC,iBAAO,IAAIwyB,UAAJ,CAAe,UAAUjc,OAAV,EAAmB;AACvCmkG,YAAAA,cAAc,CAAC1kC,GAAG,CAAC/0B,GAAL,CAAd,CAAwB31B,IAAxB,CAA6B,UAAUwvF,SAAV,EAAqB;AAChD,kBAAI,OAAOA,SAAP,KAAqB,QAAzB,EAAmC;AACjC,uBAAOA,SAAP;AACD;;AACDvkG,cAAAA,OAAO,CAAC;AACN6jG,gBAAAA,KAAK,EAAEpkC,GADD;AAENkkC,gBAAAA,QAAQ,EAAEY,SAAS,CAACZ;AAFd,eAAD,CAAP;AAID,aARD;AASD,WAVM,CAAP;AAWD;;AACD,YAAIa,UAAU,GAAG,IAAIvoF,UAAJ,CAAe,UAAUjc,OAAV,EAAmB4U,MAAnB,EAA2B;AACzD4uF,UAAAA,eAAe,CAACC,SAAD,EAAYhkC,GAAZ,EAAiBz/D,OAAjB,EAA0B4U,MAA1B,CAAf;AACD,SAFgB,EAEdG,IAFc,CAET,UAAUuG,MAAV,EAAkB;AACxB,iBAAO6oF,cAAc,CAAC7oF,MAAM,CAACuoF,KAAP,CAAan5D,GAAd,CAArB;AACA,iBAAOpvB,MAAP;AACD,SALgB,EAKdU,KALc,CAKR,UAAUva,KAAV,EAAiB;AACxB,iBAAO0iG,cAAc,CAAC1kC,GAAG,CAAC/0B,GAAL,CAArB;AACA,iBAAOjpC,KAAP;AACD,SARgB,CAAjB;AASA0iG,QAAAA,cAAc,CAAC1kC,GAAG,CAAC/0B,GAAL,CAAd,GAA0B85D,UAA1B;AACA,eAAOA,UAAP;AACD,OAzBiB,CAAlB;AA0BA,aAAOvoF,UAAU,CAAChvB,GAAX,CAAeq3G,QAAf,CAAP;AACD,KArDD;;AAsDA,WAAO;AAAE1sD,MAAAA,OAAO,EAAEA;AAAX,KAAP;AACD,GAzDD;;AA2DA,MAAI6sD,aAAa,GAAG,UAAUlnF,QAAV,EAAoBrxB,IAApB,EAA0Bq0F,aAA1B,EAAyC1+E,IAAzC,EAA+C;AACjE,QAAI6iG,WAAW,GAAGnnF,QAAQ,CAAConF,kBAAT,IAA+Bz4G,IAAI,CAAC+gF,MAAtD;;AACA,QAAIy3B,WAAW,IAAInkB,aAAa,CAAC1+E,IAAI,CAAC9X,IAAN,CAAhC,EAA6C;AAC3C8X,MAAAA,IAAI,CAAC8G,KAAL,GAAaR,MAAb,CAAoB,IAAI6kE,OAAJ,CAAY,IAAZ,EAAkB,CAAlB,CAApB,EAA0CK,UAA1C,GAAuD,IAAvD;AACD,KAFD,MAEO;AACLxrE,MAAAA,IAAI,CAAC8G,KAAL,GAAaR,MAAb,CAAoB,IAAI6kE,OAAJ,CAAY,OAAZ,EAAqB,CAArB,CAApB,EAA6CrgF,KAA7C,GAAqD81B,IAArD;AACD;AACF,GAPD;;AAQA,MAAImiF,gBAAgB,GAAG,UAAU/iG,IAAV,EAAgB;AACrC,WAAOgjG,YAAY,CAAChjG,IAAD,EAAO,OAAP,CAAZ,IAA+BA,IAAI,CAAC2E,UAAL,CAAgB7Z,KAAhB,KAA0B81B,IAAhE;AACD,GAFD;;AAGA,MAAIoiF,YAAY,GAAG,UAAUhjG,IAAV,EAAgB9X,IAAhB,EAAsB;AACvC,WAAO8X,IAAI,IAAIA,IAAI,CAAC2E,UAAb,IAA2B3E,IAAI,CAAC2E,UAAL,KAAoB3E,IAAI,CAAC4E,SAApD,IAAiE5E,IAAI,CAAC2E,UAAL,CAAgBzc,IAAhB,KAAyBA,IAAjG;AACD,GAFD;;AAGA,MAAI+6G,QAAQ,GAAG,UAAU/6E,MAAV,EAAkBloB,IAAlB,EAAwB;AACrC,QAAIktB,IAAI,GAAGhF,MAAM,CAACwF,cAAP,CAAsB1tB,IAAI,CAAC9X,IAA3B,CAAX;AACA,WAAOglC,IAAI,IAAIA,IAAI,CAAClB,SAApB;AACD,GAHD;;AAIA,MAAIk3E,SAAS,GAAG,UAAUh7E,MAAV,EAAkB02D,gBAAlB,EAAoCukB,kBAApC,EAAwDnjG,IAAxD,EAA8D;AAC5E,WAAOA,IAAI,CAAC+kB,OAAL,CAAa65D,gBAAb,EAA+BukB,kBAA/B,EAAmD,UAAUnjG,IAAV,EAAgB;AACxE,aAAOijG,QAAQ,CAAC/6E,MAAD,EAASloB,IAAT,CAAf;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAIojG,eAAe,GAAG,UAAUpjG,IAAV,EAAgB0+E,aAAhB,EAA+B;AACnD,WAAO1+E,IAAI,KAAK0+E,aAAa,CAAC1+E,IAAI,CAAC9X,IAAN,CAAb,IAA4B8X,IAAI,CAAC9X,IAAL,KAAc,IAA/C,CAAX;AACD,GAFD;;AAIA,MAAIm7G,YAAY,GAAG,UAAUzlC,GAAV,EAAe;AAChC,WAAOA,GAAG,CAAC5wD,IAAJ,CAAS,gBAAT,CAAP;AACD,GAFD;;AAGA,MAAIs2F,qBAAqB,GAAG,UAAU1lC,GAAV,EAAe;AACzC,WAAOA,GAAG,CAAC5wD,IAAJ,CAAS,KAAT,MAAoBnR,GAAG,CAACK,cAAxB,IAA0C0hE,GAAG,CAAC5wD,IAAJ,CAAS,sBAAT,CAAjD;AACD,GAFD;;AAGA,MAAIu2F,cAAc,GAAG,UAAU3lC,GAAV,EAAeliD,QAAf,EAAyB;AAC5C,QAAIA,QAAQ,CAAC8nF,qBAAb,EAAoC;AAClC,UAAIC,SAAS,GAAG,IAAIC,KAAJ,EAAhB;AACAD,MAAAA,SAAS,CAAC56D,GAAV,GAAgB+0B,GAAG,CAAC5wD,IAAJ,CAAS,KAAT,CAAhB;AACA3b,MAAAA,MAAM,CAACusE,GAAG,CAAC7wD,UAAJ,CAAehgB,GAAhB,EAAqB,UAAUjC,KAAV,EAAiBuH,GAAjB,EAAsB;AAC/CoxG,QAAAA,SAAS,CAACn3F,YAAV,CAAuBja,GAAvB,EAA4BvH,KAA5B;AACD,OAFK,CAAN;AAGA,aAAO4wB,QAAQ,CAAC8nF,qBAAT,CAA+BC,SAA/B,CAAP;AACD,KAPD,MAOO;AACL,aAAO,IAAP;AACD;AACF,GAXD;;AAYA,MAAIE,yBAAyB,GAAG,UAAU9hB,MAAV,EAAkBnmE,QAAlB,EAA4B;AAC1D,QAAIkmF,SAAS,GAAGlmF,QAAQ,CAACkoF,UAAzB;;AACA,QAAIC,YAAY,GAAG,UAAUjmC,GAAV,EAAe;AAChC,UAAIkmC,QAAQ,GAAGlmC,GAAG,CAAC5wD,IAAJ,CAAS,KAAT,CAAf;;AACA,UAAIs2F,qBAAqB,CAAC1lC,GAAD,CAArB,IAA8BylC,YAAY,CAACzlC,GAAD,CAA9C,EAAqD;AACnD;AACD;;AACDsO,MAAAA,YAAY,CAAC43B,QAAD,CAAZ,CAAuB12G,MAAvB,CAA8B,YAAY;AACxC,eAAOm2G,cAAc,CAAC3lC,GAAD,EAAMliD,QAAN,CAArB;AACD,OAFD,EAEGzuB,IAFH,CAEQ,UAAU+pD,EAAV,EAAc;AACpB,YAAI5oD,IAAI,GAAG4oD,EAAE,CAAC5oD,IAAd;AAAA,YAAoBwnB,IAAI,GAAGohC,EAAE,CAACphC,IAA9B;AACA,eAAO3nB,QAAQ,CAACD,IAAT,CAAc4zG,SAAS,CAACM,SAAV,CAAoBtsF,IAApB,EAA0BxnB,IAA1B,CAAd,EAA+CtB,OAA/C,CAAuD,YAAY;AACxE,iBAAOi0G,SAAS,CAAC3yG,IAAD,EAAOwnB,IAAP,CAAT,CAAsB7oB,GAAtB,CAA0B,UAAUu0G,IAAV,EAAgB;AAC/C,gBAAIQ,QAAQ,GAAGF,SAAS,CAACtkG,MAAV,CAAiB4vC,QAAQ,EAAzB,EAA6Bo0D,IAA7B,EAAmC1rF,IAAnC,CAAf;AACAgsF,YAAAA,SAAS,CAACn5E,GAAV,CAAcq5E,QAAd;AACA,mBAAOA,QAAP;AACD,WAJM,CAAP;AAKD,SANM,CAAP;AAOD,OAXD,EAWG90G,IAXH,CAWQ,UAAU80G,QAAV,EAAoB;AAC1BlkC,QAAAA,GAAG,CAAC5wD,IAAJ,CAAS,KAAT,EAAgB80F,QAAQ,CAACiC,OAAT,EAAhB;AACD,OAbD;AAcD,KAnBD;;AAoBA,QAAInC,SAAJ,EAAe;AACb/f,MAAAA,MAAM,CAACmiB,kBAAP,CAA0B,KAA1B,EAAiC,UAAU/1F,KAAV,EAAiB;AAChD,eAAOjhB,IAAI,CAACihB,KAAD,EAAQ41F,YAAR,CAAX;AACD,OAFD;AAGD;AACF,GA3BD;;AA4BA,MAAII,UAAU,GAAG,UAAUpiB,MAAV,EAAkBnmE,QAAlB,EAA4B;AAC3C,QAAIwM,MAAM,GAAG25D,MAAM,CAAC35D,MAApB;;AACA,QAAIxM,QAAQ,CAACwoF,mBAAb,EAAkC;AAChCriB,MAAAA,MAAM,CAACvqC,aAAP,CAAqB,IAArB,EAA2B,UAAUrpC,KAAV,EAAiBuJ,CAAjB,EAAoBntB,IAApB,EAA0B;AACnD,YAAIf,CAAJ;AACA,YAAIqJ,CAAC,GAAGsb,KAAK,CAAC7kB,MAAd;AACA,YAAI4W,IAAJ;AACA,YAAI0+E,aAAa,GAAG5/E,KAAK,CAACZ,MAAN,CAAa,EAAb,EAAiBgqB,MAAM,CAAC8G,gBAAP,EAAjB,CAApB;AACA,YAAI4vD,gBAAgB,GAAG12D,MAAM,CAACmH,mBAAP,EAAvB;AACA,YAAIjxB,MAAJ,EAAY2mC,UAAZ,EAAwBjmB,IAAxB,EAA8BqlF,QAA9B;AACA,YAAIC,kBAAkB,GAAGl8E,MAAM,CAACqH,qBAAP,EAAzB;AACA,YAAI++C,WAAJ,EAAiB5sD,QAAjB;AACAg9D,QAAAA,aAAa,CAACp3E,IAAd,GAAqB,CAArB;;AACA,aAAKhe,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGqJ,CAAhB,EAAmBrJ,CAAC,EAApB,EAAwB;AACtB0W,UAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAZ;AACA8U,UAAAA,MAAM,GAAG4B,IAAI,CAAC5B,MAAd;;AACA,cAAIsgF,aAAa,CAAC1+E,IAAI,CAAC5B,MAAL,CAAYlW,IAAb,CAAb,IAAmC8X,IAAI,KAAK5B,MAAM,CAACwG,SAAvD,EAAkE;AAChEka,YAAAA,IAAI,GAAG9e,IAAI,CAAC8e,IAAZ;;AACA,mBAAOA,IAAP,EAAa;AACXqlF,cAAAA,QAAQ,GAAGrlF,IAAI,CAAC52B,IAAhB;;AACA,kBAAIi8G,QAAQ,KAAK,MAAb,IAAuBrlF,IAAI,CAAC9R,IAAL,CAAU,eAAV,MAA+B,UAA1D,EAAsE;AACpE,oBAAIm3F,QAAQ,KAAK,IAAjB,EAAuB;AACrBnkG,kBAAAA,IAAI,GAAG,IAAP;AACD;;AACD;AACD;;AACD8e,cAAAA,IAAI,GAAGA,IAAI,CAACA,IAAZ;AACD;;AACD,gBAAI9e,IAAJ,EAAU;AACRA,cAAAA,IAAI,CAACiH,MAAL;;AACA,kBAAIi8F,SAAS,CAACh7E,MAAD,EAAS02D,gBAAT,EAA2BwlB,kBAA3B,EAA+ChmG,MAA/C,CAAb,EAAqE;AACnEkwE,gBAAAA,WAAW,GAAGpmD,MAAM,CAACwF,cAAP,CAAsBtvB,MAAM,CAAClW,IAA7B,CAAd;;AACA,oBAAIomF,WAAJ,EAAiB;AACf,sBAAIA,WAAW,CAACriD,WAAhB,EAA6B;AAC3B7tB,oBAAAA,MAAM,CAAC6I,MAAP;AACD,mBAFD,MAEO,IAAIqnE,WAAW,CAACtiD,SAAhB,EAA2B;AAChC42E,oBAAAA,aAAa,CAAClnF,QAAD,EAAWrxB,IAAX,EAAiBq0F,aAAjB,EAAgCtgF,MAAhC,CAAb;AACD;AACF;AACF;AACF;AACF,WAzBD,MAyBO;AACL2mC,YAAAA,UAAU,GAAG/kC,IAAb;;AACA,mBAAO5B,MAAM,IAAIA,MAAM,CAACuG,UAAP,KAAsBogC,UAAhC,IAA8C3mC,MAAM,CAACwG,SAAP,KAAqBmgC,UAA1E,EAAsF;AACpFA,cAAAA,UAAU,GAAG3mC,MAAb;;AACA,kBAAIsgF,aAAa,CAACtgF,MAAM,CAAClW,IAAR,CAAjB,EAAgC;AAC9B;AACD;;AACDkW,cAAAA,MAAM,GAAGA,MAAM,CAACA,MAAhB;AACD;;AACD,gBAAI2mC,UAAU,KAAK3mC,MAAf,IAAyBsd,QAAQ,CAAConF,kBAAT,KAAgC,IAA7D,EAAmE;AACjEphF,cAAAA,QAAQ,GAAG,IAAIypD,OAAJ,CAAY,OAAZ,EAAqB,CAArB,CAAX;AACAzpD,cAAAA,QAAQ,CAAC52B,KAAT,GAAiB81B,IAAjB;AACA5gB,cAAAA,IAAI,CAAC5J,OAAL,CAAasrB,QAAb;AACD;AACF;AACF;AACF,OAtDD;AAuDD;;AACDmgE,IAAAA,MAAM,CAACmiB,kBAAP,CAA0B,MAA1B,EAAkC,UAAU/1F,KAAV,EAAiB;AACjD,UAAI3kB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;;AACA,UAAIi7G,SAAS,GAAG,UAAU1mF,GAAV,EAAe;AAC7B,YAAIK,KAAK,GAAGL,GAAG,CAACxgB,KAAJ,CAAU,GAAV,EAAe/P,MAAf,CAAsB,UAAU2G,CAAV,EAAa;AAC7C,iBAAOA,CAAC,CAAC3K,MAAF,GAAW,CAAlB;AACD,SAFW,CAAZ;AAGA,eAAO40B,KAAK,CAAC3yB,MAAN,CAAa,CAAC,UAAD,CAAb,EAA2B/C,IAA3B,GAAkCqwB,IAAlC,CAAuC,GAAvC,CAAP;AACD,OALD;;AAMA,UAAI2rF,WAAW,GAAG,UAAU3mF,GAAV,EAAe;AAC/B,YAAI4mF,MAAM,GAAG5mF,GAAG,GAAG7e,KAAK,CAAC3G,IAAN,CAAWwlB,GAAX,CAAH,GAAqB,EAArC;;AACA,YAAI,CAAC,kBAAkB1oB,IAAlB,CAAuBsvG,MAAvB,CAAL,EAAqC;AACnC,iBAAOF,SAAS,CAACE,MAAD,CAAhB;AACD,SAFD,MAEO;AACL,iBAAOA,MAAP;AACD;AACF,OAPD;;AAQA,UAAI,CAAC7oF,QAAQ,CAAC8oF,wBAAd,EAAwC;AACtC,eAAOl7G,CAAC,EAAR,EAAY;AACV,cAAI0W,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAhB;;AACA,cAAI0W,IAAI,CAAC9X,IAAL,KAAc,GAAd,IAAqB8X,IAAI,CAACgN,IAAL,CAAU,QAAV,MAAwB,QAAjD,EAA2D;AACzDhN,YAAAA,IAAI,CAACgN,IAAL,CAAU,KAAV,EAAiBs3F,WAAW,CAACtkG,IAAI,CAACgN,IAAL,CAAU,KAAV,CAAD,CAA5B;AACD;AACF;AACF;AACF,KAxBD;;AAyBA,QAAI,CAAC0O,QAAQ,CAAC+oF,0BAAd,EAA0C;AACxC5iB,MAAAA,MAAM,CAACmiB,kBAAP,CAA0B,SAA1B,EAAqC,UAAU/1F,KAAV,EAAiB;AACpD,YAAI3kB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AAAA,YAAsBid,OAAtB;AAAA,YAA+BjC,WAA/B;AAAA,YAA4ChG,MAA5C;AAAA,YAAoD4B,IAApD;;AACA,eAAO1W,CAAC,EAAR,EAAY;AACV0W,UAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAZ;;AACA,cAAI0W,IAAI,CAAC9X,IAAL,KAAc,GAAd,IAAqB8X,IAAI,CAAC2E,UAA1B,IAAwC,CAAC3E,IAAI,CAACgN,IAAL,CAAU,MAAV,CAA7C,EAAgE;AAC9D5O,YAAAA,MAAM,GAAG4B,IAAI,CAAC5B,MAAd;AACAiI,YAAAA,OAAO,GAAGrG,IAAI,CAAC4E,SAAf;;AACA,eAAG;AACDR,cAAAA,WAAW,GAAGiC,OAAO,CAACyY,IAAtB;AACA1gB,cAAAA,MAAM,CAACgtE,MAAP,CAAc/kE,OAAd,EAAuBrG,IAAvB;AACAqG,cAAAA,OAAO,GAAGjC,WAAV;AACD,aAJD,QAISiC,OAJT;AAKD;AACF;AACF,OAdD;AAeD;;AACD,QAAIqV,QAAQ,CAACgpF,iBAAb,EAAgC;AAC9B7iB,MAAAA,MAAM,CAACvqC,aAAP,CAAqB,OAArB,EAA8B,UAAUrpC,KAAV,EAAiB;AAC7C,YAAI3kB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AAAA,YAAsB4W,IAAtB;AAAA,YAA4B0D,UAA5B;;AACA,eAAOpa,CAAC,EAAR,EAAY;AACV0W,UAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAZ;AACAoa,UAAAA,UAAU,GAAG1D,IAAI,CAAC5B,MAAlB;;AACA,cAAIsF,UAAU,CAACxb,IAAX,KAAoB,IAApB,IAA4Bwb,UAAU,CAACxb,IAAX,KAAoB,IAApD,EAA0D;AACxD,gBAAI8X,IAAI,CAAC8e,IAAL,IAAa9e,IAAI,CAAC8e,IAAL,CAAU52B,IAAV,KAAmB,IAApC,EAA0C;AACxC8X,cAAAA,IAAI,CAAC8e,IAAL,CAAUxY,MAAV,CAAiBtG,IAAjB;AACD,aAFD,MAEO;AACL,kBAAIguB,EAAE,GAAG,IAAIm9C,OAAJ,CAAY,IAAZ,EAAkB,CAAlB,CAAT;AACAn9C,cAAAA,EAAE,CAAChhB,IAAH,CAAQ,OAAR,EAAiB,uBAAjB;AACAhN,cAAAA,IAAI,CAAC0G,IAAL,CAAUsnB,EAAV;AACD;AACF;AACF;AACF,OAfD;AAgBD;;AACD,QAAItS,QAAQ,CAACqrD,QAAT,IAAqB7+C,MAAM,CAAC4G,eAAP,EAAzB,EAAmD;AACjD+yD,MAAAA,MAAM,CAACmiB,kBAAP,CAA0B,OAA1B,EAAmC,UAAU/1F,KAAV,EAAiB;AAClD,YAAI3kB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AAAA,YAAsB4W,IAAtB;AAAA,YAA4Bq0C,SAA5B;AAAA,YAAuChe,EAAvC;AAAA,YAA2CoG,SAA3C;AAAA,YAAsDkoE,UAAtD;AACA,YAAIx6E,YAAY,GAAGjC,MAAM,CAAC4G,eAAP,EAAnB;AACA,YAAI81E,eAAJ,EAAqB51B,KAArB;;AACA,eAAO1lF,CAAC,EAAR,EAAY;AACV0W,UAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAZ;AACA+qD,UAAAA,SAAS,GAAGr0C,IAAI,CAACgN,IAAL,CAAU,OAAV,EAAmB7P,KAAnB,CAAyB,GAAzB,CAAZ;AACAwnG,UAAAA,UAAU,GAAG,EAAb;;AACA,eAAKtuE,EAAE,GAAG,CAAV,EAAaA,EAAE,GAAGge,SAAS,CAACjrD,MAA5B,EAAoCitC,EAAE,EAAtC,EAA0C;AACxCoG,YAAAA,SAAS,GAAG4X,SAAS,CAAChe,EAAD,CAArB;AACA24C,YAAAA,KAAK,GAAG,KAAR;AACA41B,YAAAA,eAAe,GAAGz6E,YAAY,CAAC,GAAD,CAA9B;;AACA,gBAAIy6E,eAAe,IAAIA,eAAe,CAACnoE,SAAD,CAAtC,EAAmD;AACjDuyC,cAAAA,KAAK,GAAG,IAAR;AACD;;AACD41B,YAAAA,eAAe,GAAGz6E,YAAY,CAACnqB,IAAI,CAAC9X,IAAN,CAA9B;;AACA,gBAAI,CAAC8mF,KAAD,IAAU41B,eAAV,IAA6BA,eAAe,CAACnoE,SAAD,CAAhD,EAA6D;AAC3DuyC,cAAAA,KAAK,GAAG,IAAR;AACD;;AACD,gBAAIA,KAAJ,EAAW;AACT,kBAAI21B,UAAJ,EAAgB;AACdA,gBAAAA,UAAU,IAAI,GAAd;AACD;;AACDA,cAAAA,UAAU,IAAIloE,SAAd;AACD;AACF;;AACD,cAAI,CAACkoE,UAAU,CAACv7G,MAAhB,EAAwB;AACtBu7G,YAAAA,UAAU,GAAG,IAAb;AACD;;AACD3kG,UAAAA,IAAI,CAACgN,IAAL,CAAU,OAAV,EAAmB23F,UAAnB;AACD;AACF,OA/BD;AAgCD;;AACDhB,IAAAA,yBAAyB,CAAC9hB,MAAD,EAASnmE,QAAT,CAAzB;AACD,GA1JD;;AA4JA,MAAImpF,SAAS,GAAG/lG,KAAK,CAAC9B,OAAtB;AAAA,MAA+B8nG,MAAM,GAAGhmG,KAAK,CAAC9R,IAA9C;AAAA,MAAoD+3G,SAAS,GAAGjmG,KAAK,CAACJ,OAAtE;AAAA,MAA+EsmG,QAAQ,GAAGlmG,KAAK,CAACZ,MAAhG;;AACA,MAAI+mG,SAAS,GAAG,UAAUvpF,QAAV,EAAoBwM,MAApB,EAA4B;AAC1C,QAAIA,MAAM,KAAK,KAAK,CAApB,EAAuB;AACrBA,MAAAA,MAAM,GAAGkB,MAAM,EAAf;AACD;;AACD,QAAIo5D,WAAW,GAAG,EAAlB;AACA,QAAIC,gBAAgB,GAAG,EAAvB;AACA,QAAIyiB,YAAY,GAAG,EAAnB;AACA,QAAIC,iBAAiB,GAAG,EAAxB;AACAzpF,IAAAA,QAAQ,GAAGA,QAAQ,IAAI,EAAvB;AACAA,IAAAA,QAAQ,CAACqrD,QAAT,GAAoB,cAAcrrD,QAAd,GAAyBA,QAAQ,CAACqrD,QAAlC,GAA6C,IAAjE;AACArrD,IAAAA,QAAQ,CAAC0pF,SAAT,GAAqB1pF,QAAQ,CAAC0pF,SAAT,IAAsB,MAA3C;;AACA,QAAIC,kBAAkB,GAAG,UAAUp3F,KAAV,EAAiB;AACxC,UAAIya,EAAJ,EAAQ1oB,IAAR,EAAc5B,MAAd,EAAsBuF,OAAtB,EAA+B2hG,SAA/B,EAA0CC,WAA1C,EAAuDC,QAAvD,EAAiExb,SAAjE,EAA4E1gG,CAA5E;AACA,UAAI+c,OAAJ,EAAa8kD,QAAb;AACA,UAAIs6C,oBAAoB,GAAGZ,SAAS,CAAC,kCAAD,CAApC;AACA,UAAIjmB,gBAAgB,GAAG12D,MAAM,CAACmH,mBAAP,EAAvB;AACA,UAAI8zE,kBAAkB,GAAGj7E,MAAM,CAACqH,qBAAP,EAAzB;AACA,UAAIm2E,iBAAiB,GAAGx9E,MAAM,CAAC+G,oBAAP,EAAxB;AACA,UAAI1F,eAAe,GAAGrB,MAAM,CAACsH,kBAAP,EAAtB;;AACA,WAAK9G,EAAE,GAAG,CAAV,EAAaA,EAAE,GAAGza,KAAK,CAAC7kB,MAAxB,EAAgCs/B,EAAE,EAAlC,EAAsC;AACpC1oB,QAAAA,IAAI,GAAGiO,KAAK,CAACya,EAAD,CAAZ;;AACA,YAAI,CAAC1oB,IAAI,CAAC5B,MAAN,IAAgB4B,IAAI,CAAC2lG,KAAzB,EAAgC;AAC9B;AACD;;AACD,YAAID,iBAAiB,CAAC1lG,IAAI,CAAC9X,IAAN,CAAjB,IAAgC8X,IAAI,CAAC5B,MAAL,CAAYlW,IAAZ,KAAqB,IAAzD,EAA+D;AAC7Dme,UAAAA,OAAO,GAAGrG,IAAI,CAAC6e,IAAf;;AACA,iBAAOxY,OAAP,EAAgB;AACd,gBAAIq/F,iBAAiB,CAACr/F,OAAO,CAACne,IAAT,CAArB,EAAqC;AACnCme,cAAAA,OAAO,CAACne,IAAR,GAAe,IAAf;AACAme,cAAAA,OAAO,CAACs/F,KAAR,GAAgB,IAAhB;AACA3lG,cAAAA,IAAI,CAAC5B,MAAL,CAAYgtE,MAAZ,CAAmB/kE,OAAnB,EAA4BrG,IAAI,CAAC5B,MAAjC;AACD,aAJD,MAIO;AACL;AACD;;AACDiI,YAAAA,OAAO,GAAGA,OAAO,CAACwY,IAAlB;AACD;;AACD7e,UAAAA,IAAI,CAACmH,MAAL,CAAYnH,IAAZ;AACA;AACD;;AACD2D,QAAAA,OAAO,GAAG,CAAC3D,IAAD,CAAV;;AACA,aAAK5B,MAAM,GAAG4B,IAAI,CAAC5B,MAAnB,EAA2BA,MAAM,IAAI,CAAC8pB,MAAM,CAACuH,YAAP,CAAoBrxB,MAAM,CAAClW,IAA3B,EAAiC8X,IAAI,CAAC9X,IAAtC,CAAX,IAA0D,CAACu9G,oBAAoB,CAACrnG,MAAM,CAAClW,IAAR,CAA1G,EAAyHkW,MAAM,GAAGA,MAAM,CAACA,MAAzI,EAAiJ;AAC/IuF,UAAAA,OAAO,CAACvU,IAAR,CAAagP,MAAb;AACD;;AACD,YAAIA,MAAM,IAAIuF,OAAO,CAACva,MAAR,GAAiB,CAA/B,EAAkC;AAChCua,UAAAA,OAAO,CAACpT,OAAR;AACA+0G,UAAAA,SAAS,GAAGC,WAAW,GAAGK,UAAU,CAACjiG,OAAO,CAAC,CAAD,CAAP,CAAWlb,KAAX,EAAD,CAApC;;AACA,eAAKa,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGqa,OAAO,CAACva,MAAR,GAAiB,CAAjC,EAAoCE,CAAC,EAArC,EAAyC;AACvC,gBAAI4+B,MAAM,CAACuH,YAAP,CAAoB81E,WAAW,CAACr9G,IAAhC,EAAsCyb,OAAO,CAACra,CAAD,CAAP,CAAWpB,IAAjD,CAAJ,EAA4D;AAC1Ds9G,cAAAA,QAAQ,GAAGI,UAAU,CAACjiG,OAAO,CAACra,CAAD,CAAP,CAAWb,KAAX,EAAD,CAArB;AACA88G,cAAAA,WAAW,CAACj/F,MAAZ,CAAmBk/F,QAAnB;AACD,aAHD,MAGO;AACLA,cAAAA,QAAQ,GAAGD,WAAX;AACD;;AACD,iBAAKvb,SAAS,GAAGrmF,OAAO,CAACra,CAAD,CAAP,CAAWqb,UAA5B,EAAwCqlF,SAAS,IAAIA,SAAS,KAAKrmF,OAAO,CAACra,CAAC,GAAG,CAAL,CAA1E,GAAoF;AAClF6hE,cAAAA,QAAQ,GAAG6+B,SAAS,CAACnrE,IAArB;AACA2mF,cAAAA,QAAQ,CAACl/F,MAAT,CAAgB0jF,SAAhB;AACAA,cAAAA,SAAS,GAAG7+B,QAAZ;AACD;;AACDo6C,YAAAA,WAAW,GAAGC,QAAd;AACD;;AACD,cAAI,CAACtC,SAAS,CAACh7E,MAAD,EAAS02D,gBAAT,EAA2BukB,kBAA3B,EAA+CmC,SAA/C,CAAd,EAAyE;AACvElnG,YAAAA,MAAM,CAACgtE,MAAP,CAAck6B,SAAd,EAAyB3hG,OAAO,CAAC,CAAD,CAAhC,EAAqC,IAArC;AACAvF,YAAAA,MAAM,CAACgtE,MAAP,CAAcprE,IAAd,EAAoBslG,SAApB;AACD,WAHD,MAGO;AACLlnG,YAAAA,MAAM,CAACgtE,MAAP,CAAcprE,IAAd,EAAoB2D,OAAO,CAAC,CAAD,CAA3B,EAAgC,IAAhC;AACD;;AACDvF,UAAAA,MAAM,GAAGuF,OAAO,CAAC,CAAD,CAAhB;;AACA,cAAIu/F,SAAS,CAACh7E,MAAD,EAAS02D,gBAAT,EAA2BukB,kBAA3B,EAA+C/kG,MAA/C,CAAT,IAAmE4kG,YAAY,CAAC5kG,MAAD,EAAS,IAAT,CAAnF,EAAmG;AACjGA,YAAAA,MAAM,CAAC0I,KAAP,GAAeG,MAAf;AACD;AACF,SA3BD,MA2BO,IAAIjH,IAAI,CAAC5B,MAAT,EAAiB;AACtB,cAAI4B,IAAI,CAAC9X,IAAL,KAAc,IAAlB,EAAwB;AACtBme,YAAAA,OAAO,GAAGrG,IAAI,CAAC8e,IAAf;;AACA,gBAAIzY,OAAO,KAAKA,OAAO,CAACne,IAAR,KAAiB,IAAjB,IAAyBme,OAAO,CAACne,IAAR,KAAiB,IAA/C,CAAX,EAAiE;AAC/Dme,cAAAA,OAAO,CAACC,MAAR,CAAetG,IAAf;AACA;AACD;;AACDqG,YAAAA,OAAO,GAAGrG,IAAI,CAAC6e,IAAf;;AACA,gBAAIxY,OAAO,KAAKA,OAAO,CAACne,IAAR,KAAiB,IAAjB,IAAyBme,OAAO,CAACne,IAAR,KAAiB,IAA/C,CAAX,EAAiE;AAC/Dme,cAAAA,OAAO,CAAC+kE,MAAR,CAAeprE,IAAf,EAAqBqG,OAAO,CAAC1B,UAA7B,EAAyC,IAAzC;AACA;AACD;;AACD3E,YAAAA,IAAI,CAAC0G,IAAL,CAAUk/F,UAAU,CAAC,IAAIz6B,OAAJ,CAAY,IAAZ,EAAkB,CAAlB,CAAD,CAApB;AACA;AACD;;AACD,cAAIjjD,MAAM,CAACuH,YAAP,CAAoBzvB,IAAI,CAAC5B,MAAL,CAAYlW,IAAhC,EAAsC,KAAtC,KAAgDggC,MAAM,CAACuH,YAAP,CAAoB,KAApB,EAA2BzvB,IAAI,CAAC9X,IAAhC,CAApD,EAA2F;AACzF8X,YAAAA,IAAI,CAAC0G,IAAL,CAAUk/F,UAAU,CAAC,IAAIz6B,OAAJ,CAAY,KAAZ,EAAmB,CAAnB,CAAD,CAApB;AACD,WAFD,MAEO;AACL,gBAAI5hD,eAAe,CAACvpB,IAAI,CAAC9X,IAAN,CAAnB,EAAgC;AAC9B8X,cAAAA,IAAI,CAAC8G,KAAL,GAAaG,MAAb;AACD,aAFD,MAEO;AACLjH,cAAAA,IAAI,CAACmH,MAAL;AACD;AACF;AACF;AACF;AACF,KArFD;;AAsFA,QAAIy+F,UAAU,GAAG,UAAU5lG,IAAV,EAAgB;AAC/B,UAAI1W,CAAJ,EAAOpB,IAAP,EAAa29G,IAAb;AACA39G,MAAAA,IAAI,GAAG8X,IAAI,CAAC9X,IAAZ;;AACA,UAAIA,IAAI,IAAIs6F,WAAZ,EAAyB;AACvBqjB,QAAAA,IAAI,GAAGX,YAAY,CAACh9G,IAAD,CAAnB;;AACA,YAAI29G,IAAJ,EAAU;AACRA,UAAAA,IAAI,CAACz2G,IAAL,CAAU4Q,IAAV;AACD,SAFD,MAEO;AACLklG,UAAAA,YAAY,CAACh9G,IAAD,CAAZ,GAAqB,CAAC8X,IAAD,CAArB;AACD;AACF;;AACD1W,MAAAA,CAAC,GAAGm5F,gBAAgB,CAACr5F,MAArB;;AACA,aAAOE,CAAC,EAAR,EAAY;AACVpB,QAAAA,IAAI,GAAGu6F,gBAAgB,CAACn5F,CAAD,CAAhB,CAAoBpB,IAA3B;;AACA,YAAIA,IAAI,IAAI8X,IAAI,CAAC+M,UAAL,CAAgBhgB,GAA5B,EAAiC;AAC/B84G,UAAAA,IAAI,GAAGV,iBAAiB,CAACj9G,IAAD,CAAxB;;AACA,cAAI29G,IAAJ,EAAU;AACRA,YAAAA,IAAI,CAACz2G,IAAL,CAAU4Q,IAAV;AACD,WAFD,MAEO;AACLmlG,YAAAA,iBAAiB,CAACj9G,IAAD,CAAjB,GAA0B,CAAC8X,IAAD,CAA1B;AACD;AACF;AACF;;AACD,aAAOA,IAAP;AACD,KAxBD;;AAyBA,QAAIs3C,aAAa,GAAG,UAAUpvD,IAAV,EAAgB6K,QAAhB,EAA0B;AAC5C+xG,MAAAA,MAAM,CAACC,SAAS,CAAC78G,IAAD,CAAV,EAAkB,UAAUA,IAAV,EAAgB;AACtC,YAAI29G,IAAI,GAAGrjB,WAAW,CAACt6F,IAAD,CAAtB;;AACA,YAAI,CAAC29G,IAAL,EAAW;AACTrjB,UAAAA,WAAW,CAACt6F,IAAD,CAAX,GAAoB29G,IAAI,GAAG,EAA3B;AACD;;AACDA,QAAAA,IAAI,CAACz2G,IAAL,CAAU2D,QAAV;AACD,OANK,CAAN;AAOD,KARD;;AASA,QAAIwwF,cAAc,GAAG,YAAY;AAC/B,UAAIvwF,GAAG,GAAG,EAAV;;AACA,WAAK,IAAIwL,MAAT,IAAmBgkF,WAAnB,EAAgC;AAC9B,YAAIA,WAAW,CAACpxF,cAAZ,CAA2BoN,MAA3B,CAAJ,EAAwC;AACtCxL,UAAAA,GAAG,CAAC5D,IAAJ,CAAS;AACPlH,YAAAA,IAAI,EAAEsW,MADC;AAEPqX,YAAAA,SAAS,EAAE2sE,WAAW,CAAChkF,MAAD;AAFf,WAAT;AAID;AACF;;AACD,aAAOxL,GAAP;AACD,KAXD;;AAYA,QAAIgxG,kBAAkB,GAAG,UAAU97G,IAAV,EAAgB6K,QAAhB,EAA0B;AACjD+xG,MAAAA,MAAM,CAACC,SAAS,CAAC78G,IAAD,CAAV,EAAkB,UAAUA,IAAV,EAAgB;AACtC,YAAIoB,CAAJ;;AACA,aAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGm5F,gBAAgB,CAACr5F,MAAjC,EAAyCE,CAAC,EAA1C,EAA8C;AAC5C,cAAIm5F,gBAAgB,CAACn5F,CAAD,CAAhB,CAAoBpB,IAApB,KAA6BA,IAAjC,EAAuC;AACrCu6F,YAAAA,gBAAgB,CAACn5F,CAAD,CAAhB,CAAoBusB,SAApB,CAA8BzmB,IAA9B,CAAmC2D,QAAnC;AACA;AACD;AACF;;AACD0vF,QAAAA,gBAAgB,CAACrzF,IAAjB,CAAsB;AACpBlH,UAAAA,IAAI,EAAEA,IADc;AAEpB2tB,UAAAA,SAAS,EAAE,CAAC9iB,QAAD;AAFS,SAAtB;AAID,OAZK,CAAN;AAaD,KAdD;;AAeA,QAAIywF,mBAAmB,GAAG,YAAY;AACpC,aAAO,GAAGn4F,MAAH,CAAUo3F,gBAAV,CAAP;AACD,KAFD;;AAGA,QAAIhyD,KAAK,GAAG,UAAUtxB,IAAV,EAAgB9U,IAAhB,EAAsB;AAChC,UAAI4jB,KAAJ,EAAW3kB,CAAX,EAAcqJ,CAAd,EAAiBmzG,EAAjB,EAAqBC,EAArB,EAAyBF,IAAzB,EAA+B39G,IAA/B;AACA,UAAI89G,eAAe,GAAG,EAAtB;AACA,UAAIC,8BAAJ;AACA,UAAIjmG,IAAJ;;AACA,UAAIkmG,gBAAgB,GAAG,UAAUh+G,IAAV,EAAgB;AACrC,YAAIA,IAAI,KAAK,KAAb,EAAoB;AAClB,iBAAO,EAAP;AACD,SAFD,MAEO,IAAIA,IAAI,KAAK,IAAb,EAAmB;AACxB,iBAAO,GAAP;AACD,SAFM,MAEA;AACL,iBAAOA,IAAP;AACD;AACF,OARD;;AASAmC,MAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;AACA66G,MAAAA,YAAY,GAAG,EAAf;AACAC,MAAAA,iBAAiB,GAAG,EAApB;AACA,UAAIzmB,aAAa,GAAGsmB,QAAQ,CAACH,SAAS,CAAC,8CAAD,CAAV,EAA4D38E,MAAM,CAAC8G,gBAAP,EAA5D,CAA5B;AACA,UAAI4vD,gBAAgB,GAAG12D,MAAM,CAACmH,mBAAP,EAAvB;AACA,UAAIlrB,QAAQ,GAAG+jB,MAAM,CAAC/jB,QAAtB;AACA,UAAI4iE,QAAQ,GAAGrrD,QAAQ,CAACqrD,QAAxB;AACA,UAAIoc,mBAAmB,GAAG,uBAAuB94F,IAAvB,GAA8BA,IAAI,CAACmkG,iBAAnC,GAAuD9yE,QAAQ,CAAC8yE,iBAA1F;AACA,UAAI2X,aAAa,GAAGD,gBAAgB,CAAC/iB,mBAAD,CAApC;AACA,UAAIihB,kBAAkB,GAAGl8E,MAAM,CAACqH,qBAAP,EAAzB;AACA,UAAI62E,qBAAqB,GAAG,aAA5B;AACA,UAAIC,mBAAmB,GAAG,aAA1B;AACA,UAAIC,mBAAmB,GAAG,aAA1B;AACA,UAAIC,qBAAqB,GAAG,cAA5B;AACAN,MAAAA,8BAA8B,GAAG7B,kBAAkB,CAAChzG,cAAnB,CAAkC/G,IAAI,CAACqwC,OAAvC,KAAmD0pE,kBAAkB,CAAChzG,cAAnB,CAAkCsqB,QAAQ,CAAC0pF,SAA3C,CAApF;;AACA,UAAIoB,aAAa,GAAG,YAAY;AAC9B,YAAIxmG,IAAI,GAAG4e,QAAQ,CAACja,UAApB;AAAA,YAAgCka,IAAhC;AAAA,YAAsC4nF,aAAtC;;AACA,YAAItuG,IAAI,GAAG,UAAUsuG,aAAV,EAAyB;AAClC,cAAIA,aAAJ,EAAmB;AACjBzmG,YAAAA,IAAI,GAAGymG,aAAa,CAAC9hG,UAArB;;AACA,gBAAI3E,IAAI,IAAIA,IAAI,CAAC5R,IAAL,KAAc,CAA1B,EAA6B;AAC3B4R,cAAAA,IAAI,CAAClV,KAAL,GAAakV,IAAI,CAAClV,KAAL,CAAWsL,OAAX,CAAmBgwG,qBAAnB,EAA0C,EAA1C,CAAb;AACD;;AACDpmG,YAAAA,IAAI,GAAGymG,aAAa,CAAC7hG,SAArB;;AACA,gBAAI5E,IAAI,IAAIA,IAAI,CAAC5R,IAAL,KAAc,CAA1B,EAA6B;AAC3B4R,cAAAA,IAAI,CAAClV,KAAL,GAAakV,IAAI,CAAClV,KAAL,CAAWsL,OAAX,CAAmBiwG,mBAAnB,EAAwC,EAAxC,CAAb;AACD;AACF;AACF,SAXD;;AAYA,YAAI,CAACn+E,MAAM,CAACuH,YAAP,CAAoB7Q,QAAQ,CAAC12B,IAA7B,EAAmCi+G,aAAa,CAAC1vG,WAAd,EAAnC,CAAL,EAAsE;AACpE;AACD;;AACD,eAAOuJ,IAAP,EAAa;AACX6e,UAAAA,IAAI,GAAG7e,IAAI,CAAC6e,IAAZ;;AACA,cAAI7e,IAAI,CAAC5R,IAAL,KAAc,CAAd,IAAmB4R,IAAI,CAAC5R,IAAL,KAAc,CAAd,IAAmB4R,IAAI,CAAC9X,IAAL,KAAc,GAAjC,IAAwC,CAACw2F,aAAa,CAAC1+E,IAAI,CAAC9X,IAAN,CAAtD,IAAqE,CAAC8X,IAAI,CAACgN,IAAL,CAAU,eAAV,CAA7F,EAAyH;AACvH,gBAAI,CAACy5F,aAAL,EAAoB;AAClBA,cAAAA,aAAa,GAAGC,UAAU,CAACP,aAAD,EAAgB,CAAhB,CAA1B;AACAM,cAAAA,aAAa,CAACz5F,IAAd,CAAmB0O,QAAQ,CAACgvE,uBAA5B;AACA9rE,cAAAA,QAAQ,CAACwsD,MAAT,CAAgBq7B,aAAhB,EAA+BzmG,IAA/B;AACAymG,cAAAA,aAAa,CAACngG,MAAd,CAAqBtG,IAArB;AACD,aALD,MAKO;AACLymG,cAAAA,aAAa,CAACngG,MAAd,CAAqBtG,IAArB;AACD;AACF,WATD,MASO;AACL7H,YAAAA,IAAI,CAACsuG,aAAD,CAAJ;AACAA,YAAAA,aAAa,GAAG,IAAhB;AACD;;AACDzmG,UAAAA,IAAI,GAAG6e,IAAP;AACD;;AACD1mB,QAAAA,IAAI,CAACsuG,aAAD,CAAJ;AACD,OAnCD;;AAoCA,UAAIC,UAAU,GAAG,UAAUx+G,IAAV,EAAgBkG,IAAhB,EAAsB;AACrC,YAAI4R,IAAI,GAAG,IAAImrE,OAAJ,CAAYjjF,IAAZ,EAAkBkG,IAAlB,CAAX;AACA,YAAIy3G,IAAJ;;AACA,YAAI39G,IAAI,IAAIs6F,WAAZ,EAAyB;AACvBqjB,UAAAA,IAAI,GAAGX,YAAY,CAACh9G,IAAD,CAAnB;;AACA,cAAI29G,IAAJ,EAAU;AACRA,YAAAA,IAAI,CAACz2G,IAAL,CAAU4Q,IAAV;AACD,WAFD,MAEO;AACLklG,YAAAA,YAAY,CAACh9G,IAAD,CAAZ,GAAqB,CAAC8X,IAAD,CAArB;AACD;AACF;;AACD,eAAOA,IAAP;AACD,OAZD;;AAaA,UAAI2mG,sBAAsB,GAAG,UAAU3mG,IAAV,EAAgB;AAC3C,YAAI0hB,QAAJ,EAAcklF,YAAd,EAA4BC,OAA5B,EAAqCxgG,OAArC;AACA,YAAIq4E,aAAa,GAAGx2D,MAAM,CAAC8G,gBAAP,EAApB;;AACA,aAAKtN,QAAQ,GAAG1hB,IAAI,CAAC8e,IAArB,EAA2B4C,QAAQ,IAAIA,QAAQ,CAACtzB,IAAT,KAAkB,CAAzD,GAA6D;AAC3Dy4G,UAAAA,OAAO,GAAGnlF,QAAQ,CAAC52B,KAAT,CAAesL,OAAf,CAAuBiwG,mBAAvB,EAA4C,EAA5C,CAAV;;AACA,cAAIQ,OAAO,CAACz9G,MAAR,GAAiB,CAArB,EAAwB;AACtBs4B,YAAAA,QAAQ,CAAC52B,KAAT,GAAiB+7G,OAAjB;AACA;AACD;;AACDD,UAAAA,YAAY,GAAGllF,QAAQ,CAAC7C,IAAxB;;AACA,cAAI+nF,YAAJ,EAAkB;AAChB,gBAAIA,YAAY,CAACx4G,IAAb,KAAsB,CAAtB,IAA2Bw4G,YAAY,CAAC97G,KAAb,CAAmB1B,MAAlD,EAA0D;AACxDs4B,cAAAA,QAAQ,GAAGA,QAAQ,CAAC5C,IAApB;AACA;AACD;;AACD,gBAAI,CAAC4/D,aAAa,CAACkoB,YAAY,CAAC1+G,IAAd,CAAd,IAAqC0+G,YAAY,CAAC1+G,IAAb,KAAsB,QAA3D,IAAuE0+G,YAAY,CAAC1+G,IAAb,KAAsB,OAAjG,EAA0G;AACxGw5B,cAAAA,QAAQ,GAAGA,QAAQ,CAAC5C,IAApB;AACA;AACD;AACF;;AACDzY,UAAAA,OAAO,GAAGqb,QAAQ,CAAC5C,IAAnB;AACA4C,UAAAA,QAAQ,CAACza,MAAT;AACAya,UAAAA,QAAQ,GAAGrb,OAAX;AACD;AACF,OAxBD;;AAyBA,UAAIygG,qBAAqB,GAAG,UAAU3nE,KAAV,EAAiB;AAC3C,YAAIj3C,IAAJ;AACA,YAAI2mD,MAAM,GAAG,EAAb;;AACA,aAAK3mD,IAAL,IAAai3C,KAAb,EAAoB;AAClB,cAAIj3C,IAAI,KAAK,IAAT,IAAiBA,IAAI,KAAK,GAA9B,EAAmC;AACjC2mD,YAAAA,MAAM,CAAC3mD,IAAD,CAAN,GAAei3C,KAAK,CAACj3C,IAAD,CAApB;AACD;AACF;;AACD,eAAO2mD,MAAP;AACD,OATD;;AAUA,UAAIgzC,MAAM,GAAGrU,SAAS,CAAC;AACrBzG,QAAAA,QAAQ,EAAEA,QADW;AAErB2F,QAAAA,oBAAoB,EAAEhxD,QAAQ,CAACgxD,oBAFV;AAGrB36C,QAAAA,mBAAmB,EAAErW,QAAQ,CAACqW,mBAHT;AAIrBF,QAAAA,iBAAiB,EAAEnW,QAAQ,CAACmW,iBAJP;AAKrBs9C,QAAAA,0BAA0B,EAAEzzD,QAAQ,CAACyzD,0BALhB;AAMrBqB,QAAAA,cAAc,EAAE90D,QAAQ,CAAC80D,cANJ;AAOrBR,QAAAA,qBAAqB,EAAE82B,qBAAqB,CAAC5+E,MAAM,CAACkH,sBAAP,EAAD,CAPvB;AAQrBu+C,QAAAA,KAAK,EAAE,UAAUztE,IAAV,EAAgB;AACrBF,UAAAA,IAAI,CAACsG,MAAL,CAAYogG,UAAU,CAAC,QAAD,EAAW,CAAX,CAAtB,EAAqC57G,KAArC,GAA6CoV,IAA7C;AACD,SAVoB;AAWrBA,QAAAA,IAAI,EAAE,UAAUA,IAAV,EAAgBwN,GAAhB,EAAqB;AACzB,cAAIgU,QAAJ;;AACA,cAAI,CAACukF,8BAAL,EAAqC;AACnC/lG,YAAAA,IAAI,GAAGA,IAAI,CAAC9J,OAAL,CAAakwG,mBAAb,EAAkC,GAAlC,CAAP;;AACA,gBAAIlD,eAAe,CAACpjG,IAAI,CAAC4E,SAAN,EAAiB85E,aAAjB,CAAnB,EAAoD;AAClDx+E,cAAAA,IAAI,GAAGA,IAAI,CAAC9J,OAAL,CAAagwG,qBAAb,EAAoC,EAApC,CAAP;AACD;AACF;;AACD,cAAIlmG,IAAI,CAAC9W,MAAL,KAAgB,CAApB,EAAuB;AACrBs4B,YAAAA,QAAQ,GAAGglF,UAAU,CAAC,OAAD,EAAU,CAAV,CAArB;AACAhlF,YAAAA,QAAQ,CAAChU,GAAT,GAAe,CAAC,CAACA,GAAjB;AACA1N,YAAAA,IAAI,CAACsG,MAAL,CAAYob,QAAZ,EAAsB52B,KAAtB,GAA8BoV,IAA9B;AACD;AACF,SAxBoB;AAyBrBwtE,QAAAA,OAAO,EAAE,UAAUxtE,IAAV,EAAgB;AACvBF,UAAAA,IAAI,CAACsG,MAAL,CAAYogG,UAAU,CAAC,UAAD,EAAa,CAAb,CAAtB,EAAuC57G,KAAvC,GAA+CoV,IAA/C;AACD,SA3BoB;AA4BrB0tE,QAAAA,EAAE,EAAE,UAAU1lF,IAAV,EAAgBgY,IAAhB,EAAsB;AACxBF,UAAAA,IAAI,CAACsG,MAAL,CAAYogG,UAAU,CAACx+G,IAAD,EAAO,CAAP,CAAtB,EAAiC4C,KAAjC,GAAyCoV,IAAzC;AACAymG,UAAAA,sBAAsB,CAAC3mG,IAAD,CAAtB;AACD,SA/BoB;AAgCrB6tE,QAAAA,OAAO,EAAE,UAAU3tE,IAAV,EAAgB;AACvB,cAAIi4E,OAAO,GAAGn4E,IAAI,CAACsG,MAAL,CAAYogG,UAAU,CAAC,UAAD,EAAa,EAAb,CAAtB,CAAd;AACAvuB,UAAAA,OAAO,CAACrtF,KAAR,GAAgBoV,IAAhB;AACAymG,UAAAA,sBAAsB,CAAC3mG,IAAD,CAAtB;AACD,SApCoB;AAqCrBnI,QAAAA,KAAK,EAAE,UAAU3P,IAAV,EAAgBukB,KAAhB,EAAuB3F,KAAvB,EAA8B;AACnC,cAAIqxE,OAAJ,EAAa4uB,cAAb,EAA6Bh8F,QAA7B,EAAuC3M,MAAvC;AACA,cAAIkwE,WAAW,GAAGvH,QAAQ,GAAG7+C,MAAM,CAACwF,cAAP,CAAsBxlC,IAAtB,CAAH,GAAiC,EAA3D;;AACA,cAAIomF,WAAJ,EAAiB;AACf6J,YAAAA,OAAO,GAAGuuB,UAAU,CAACp4B,WAAW,CAAC5iD,UAAZ,IAA0BxjC,IAA3B,EAAiC,CAAjC,CAApB;AACAiwF,YAAAA,OAAO,CAACprE,UAAR,GAAqBN,KAArB;AACA0rE,YAAAA,OAAO,CAAC3M,UAAR,GAAqB1kE,KAArB;AACA9G,YAAAA,IAAI,CAACsG,MAAL,CAAY6xE,OAAZ;AACA/5E,YAAAA,MAAM,GAAG+F,QAAQ,CAACnE,IAAI,CAAC9X,IAAN,CAAjB;;AACA,gBAAIkW,MAAM,IAAI+F,QAAQ,CAACg0E,OAAO,CAACjwF,IAAT,CAAlB,IAAoC,CAACkW,MAAM,CAAC+5E,OAAO,CAACjwF,IAAT,CAA/C,EAA+D;AAC7D89G,cAAAA,eAAe,CAAC52G,IAAhB,CAAqB+oF,OAArB;AACD;;AACD4uB,YAAAA,cAAc,GAAGtkB,gBAAgB,CAACr5F,MAAlC;;AACA,mBAAO29G,cAAc,EAArB,EAAyB;AACvBh8F,cAAAA,QAAQ,GAAG03E,gBAAgB,CAACskB,cAAD,CAAhB,CAAiC7+G,IAA5C;;AACA,kBAAI6iB,QAAQ,IAAI0B,KAAK,CAAC1f,GAAtB,EAA2B;AACzB84G,gBAAAA,IAAI,GAAGV,iBAAiB,CAACp6F,QAAD,CAAxB;;AACA,oBAAI86F,IAAJ,EAAU;AACRA,kBAAAA,IAAI,CAACz2G,IAAL,CAAU+oF,OAAV;AACD,iBAFD,MAEO;AACLgtB,kBAAAA,iBAAiB,CAACp6F,QAAD,CAAjB,GAA8B,CAACotE,OAAD,CAA9B;AACD;AACF;AACF;;AACD,gBAAIuG,aAAa,CAACx2F,IAAD,CAAjB,EAAyB;AACvBy+G,cAAAA,sBAAsB,CAACxuB,OAAD,CAAtB;AACD;;AACD,gBAAI,CAACrxE,KAAL,EAAY;AACV9G,cAAAA,IAAI,GAAGm4E,OAAP;AACD;;AACD,gBAAI,CAAC8tB,8BAAD,IAAmC7B,kBAAkB,CAACl8G,IAAD,CAAzD,EAAiE;AAC/D+9G,cAAAA,8BAA8B,GAAG,IAAjC;AACD;AACF;AACF,SAvEoB;AAwErBxmD,QAAAA,GAAG,EAAE,UAAUv3D,IAAV,EAAgB;AACnB,cAAIw5B,QAAJ,EAAcxhB,IAAd,EAAoBmG,OAApB,EAA6Bm/F,QAA7B;AACA,cAAIl3B,WAAW,GAAGvH,QAAQ,GAAG7+C,MAAM,CAACwF,cAAP,CAAsBxlC,IAAtB,CAAH,GAAiC,EAA3D;;AACA,cAAIomF,WAAJ,EAAiB;AACf,gBAAIoQ,aAAa,CAACx2F,IAAD,CAAjB,EAAyB;AACvB,kBAAI,CAAC+9G,8BAAL,EAAqC;AACnCvkF,gBAAAA,QAAQ,GAAG1hB,IAAI,CAAC2E,UAAhB;;AACA,oBAAI+c,QAAQ,IAAIA,QAAQ,CAACtzB,IAAT,KAAkB,CAAlC,EAAqC;AACnC8R,kBAAAA,IAAI,GAAGwhB,QAAQ,CAAC52B,KAAT,CAAesL,OAAf,CAAuBgwG,qBAAvB,EAA8C,EAA9C,CAAP;;AACA,sBAAIlmG,IAAI,CAAC9W,MAAL,GAAc,CAAlB,EAAqB;AACnBs4B,oBAAAA,QAAQ,CAAC52B,KAAT,GAAiBoV,IAAjB;AACAwhB,oBAAAA,QAAQ,GAAGA,QAAQ,CAAC7C,IAApB;AACD,mBAHD,MAGO;AACLxY,oBAAAA,OAAO,GAAGqb,QAAQ,CAAC7C,IAAnB;AACA6C,oBAAAA,QAAQ,CAACza,MAAT;AACAya,oBAAAA,QAAQ,GAAGrb,OAAX;;AACA,2BAAOqb,QAAQ,IAAIA,QAAQ,CAACtzB,IAAT,KAAkB,CAArC,EAAwC;AACtC8R,sBAAAA,IAAI,GAAGwhB,QAAQ,CAAC52B,KAAhB;AACAub,sBAAAA,OAAO,GAAGqb,QAAQ,CAAC7C,IAAnB;;AACA,0BAAI3e,IAAI,CAAC9W,MAAL,KAAgB,CAAhB,IAAqBm9G,qBAAqB,CAACtxG,IAAtB,CAA2BiL,IAA3B,CAAzB,EAA2D;AACzDwhB,wBAAAA,QAAQ,CAACza,MAAT;AACAya,wBAAAA,QAAQ,GAAGrb,OAAX;AACD;;AACDqb,sBAAAA,QAAQ,GAAGrb,OAAX;AACD;AACF;AACF;;AACDqb,gBAAAA,QAAQ,GAAG1hB,IAAI,CAAC4E,SAAhB;;AACA,oBAAI8c,QAAQ,IAAIA,QAAQ,CAACtzB,IAAT,KAAkB,CAAlC,EAAqC;AACnC8R,kBAAAA,IAAI,GAAGwhB,QAAQ,CAAC52B,KAAT,CAAesL,OAAf,CAAuBiwG,mBAAvB,EAA4C,EAA5C,CAAP;;AACA,sBAAInmG,IAAI,CAAC9W,MAAL,GAAc,CAAlB,EAAqB;AACnBs4B,oBAAAA,QAAQ,CAAC52B,KAAT,GAAiBoV,IAAjB;AACAwhB,oBAAAA,QAAQ,GAAGA,QAAQ,CAAC5C,IAApB;AACD,mBAHD,MAGO;AACLzY,oBAAAA,OAAO,GAAGqb,QAAQ,CAAC5C,IAAnB;AACA4C,oBAAAA,QAAQ,CAACza,MAAT;AACAya,oBAAAA,QAAQ,GAAGrb,OAAX;;AACA,2BAAOqb,QAAQ,IAAIA,QAAQ,CAACtzB,IAAT,KAAkB,CAArC,EAAwC;AACtC8R,sBAAAA,IAAI,GAAGwhB,QAAQ,CAAC52B,KAAhB;AACAub,sBAAAA,OAAO,GAAGqb,QAAQ,CAAC5C,IAAnB;;AACA,0BAAI5e,IAAI,CAAC9W,MAAL,KAAgB,CAAhB,IAAqBm9G,qBAAqB,CAACtxG,IAAtB,CAA2BiL,IAA3B,CAAzB,EAA2D;AACzDwhB,wBAAAA,QAAQ,CAACza,MAAT;AACAya,wBAAAA,QAAQ,GAAGrb,OAAX;AACD;;AACDqb,sBAAAA,QAAQ,GAAGrb,OAAX;AACD;AACF;AACF;AACF;AACF;;AACD,gBAAI4/F,8BAA8B,IAAI7B,kBAAkB,CAACl8G,IAAD,CAAxD,EAAgE;AAC9D+9G,cAAAA,8BAA8B,GAAG,KAAjC;AACD;;AACD,gBAAI33B,WAAW,CAACriD,WAAZ,IAA2Bi3E,SAAS,CAACh7E,MAAD,EAAS02D,gBAAT,EAA2BwlB,kBAA3B,EAA+CpkG,IAA/C,CAAxC,EAA8F;AAC5FwlG,cAAAA,QAAQ,GAAGxlG,IAAI,CAAC5B,MAAhB;;AACA,kBAAIsgF,aAAa,CAAC1+E,IAAI,CAAC9X,IAAN,CAAjB,EAA8B;AAC5B8X,gBAAAA,IAAI,CAAC8G,KAAL,GAAaG,MAAb;AACD,eAFD,MAEO;AACLjH,gBAAAA,IAAI,CAACmH,MAAL;AACD;;AACDnH,cAAAA,IAAI,GAAGwlG,QAAP;AACA;AACD;;AACD,gBAAIl3B,WAAW,CAACtiD,SAAZ,KAA0B+2E,gBAAgB,CAAC/iG,IAAD,CAAhB,IAA0BkjG,SAAS,CAACh7E,MAAD,EAAS02D,gBAAT,EAA2BwlB,kBAA3B,EAA+CpkG,IAA/C,CAA7D,CAAJ,EAAwH;AACtH4iG,cAAAA,aAAa,CAAClnF,QAAD,EAAWrxB,IAAX,EAAiBq0F,aAAjB,EAAgC1+E,IAAhC,CAAb;AACD;;AACDA,YAAAA,IAAI,GAAGA,IAAI,CAAC5B,MAAZ;AACD;AACF;AA5IoB,OAAD,EA6InB8pB,MA7ImB,CAAtB;AA8IA,UAAItJ,QAAQ,GAAG5e,IAAI,GAAG,IAAImrE,OAAJ,CAAY9gF,IAAI,CAACqwC,OAAL,IAAgBhf,QAAQ,CAAC0pF,SAArC,EAAgD,EAAhD,CAAtB;AACAvjB,MAAAA,MAAM,CAACpxD,KAAP,CAAatxB,IAAb,EAAmB9U,IAAI,CAACgmE,MAAxB;;AACA,UAAI0W,QAAQ,IAAIi/B,eAAe,CAAC58G,MAAhC,EAAwC;AACtC,YAAI,CAACiB,IAAI,CAACqwC,OAAV,EAAmB;AACjB2qE,UAAAA,kBAAkB,CAACW,eAAD,CAAlB;AACD,SAFD,MAEO;AACL37G,UAAAA,IAAI,CAAC+3F,OAAL,GAAe,IAAf;AACD;AACF;;AACD,UAAI+jB,aAAa,KAAKvnF,QAAQ,CAAC12B,IAAT,KAAkB,MAAlB,IAA4BmC,IAAI,CAACg5F,aAAtC,CAAjB,EAAuE;AACrEmjB,QAAAA,aAAa;AACd;;AACD,UAAI,CAACn8G,IAAI,CAAC+3F,OAAV,EAAmB;AACjB,aAAKl6F,IAAL,IAAag9G,YAAb,EAA2B;AACzB,cAAI,CAACA,YAAY,CAAC9zG,cAAb,CAA4BlJ,IAA5B,CAAL,EAAwC;AACtC;AACD;;AACD29G,UAAAA,IAAI,GAAGrjB,WAAW,CAACt6F,IAAD,CAAlB;AACA+lB,UAAAA,KAAK,GAAGi3F,YAAY,CAACh9G,IAAD,CAApB;AACA49G,UAAAA,EAAE,GAAG73F,KAAK,CAAC7kB,MAAX;;AACA,iBAAO08G,EAAE,EAAT,EAAa;AACX,gBAAI,CAAC73F,KAAK,CAAC63F,EAAD,CAAL,CAAU1nG,MAAf,EAAuB;AACrB6P,cAAAA,KAAK,CAACoe,MAAN,CAAay5E,EAAb,EAAiB,CAAjB;AACD;AACF;;AACD,eAAKx8G,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAGkzG,IAAI,CAACz8G,MAArB,EAA6BE,CAAC,GAAGqJ,CAAjC,EAAoCrJ,CAAC,EAArC,EAAyC;AACvCu8G,YAAAA,IAAI,CAACv8G,CAAD,CAAJ,CAAQ2kB,KAAR,EAAe/lB,IAAf,EAAqBmC,IAArB;AACD;AACF;;AACD,aAAKf,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAG8vF,gBAAgB,CAACr5F,MAAjC,EAAyCE,CAAC,GAAGqJ,CAA7C,EAAgDrJ,CAAC,EAAjD,EAAqD;AACnDu8G,UAAAA,IAAI,GAAGpjB,gBAAgB,CAACn5F,CAAD,CAAvB;;AACA,cAAIu8G,IAAI,CAAC39G,IAAL,IAAai9G,iBAAjB,EAAoC;AAClCl3F,YAAAA,KAAK,GAAGk3F,iBAAiB,CAACU,IAAI,CAAC39G,IAAN,CAAzB;AACA49G,YAAAA,EAAE,GAAG73F,KAAK,CAAC7kB,MAAX;;AACA,mBAAO08G,EAAE,EAAT,EAAa;AACX,kBAAI,CAAC73F,KAAK,CAAC63F,EAAD,CAAL,CAAU1nG,MAAf,EAAuB;AACrB6P,gBAAAA,KAAK,CAACoe,MAAN,CAAay5E,EAAb,EAAiB,CAAjB;AACD;AACF;;AACD,iBAAKA,EAAE,GAAG,CAAL,EAAQC,EAAE,GAAGF,IAAI,CAAChwF,SAAL,CAAezsB,MAAjC,EAAyC08G,EAAE,GAAGC,EAA9C,EAAkDD,EAAE,EAApD,EAAwD;AACtDD,cAAAA,IAAI,CAAChwF,SAAL,CAAeiwF,EAAf,EAAmB73F,KAAnB,EAA0B43F,IAAI,CAAC39G,IAA/B,EAAqCmC,IAArC;AACD;AACF;AACF;AACF;;AACD,aAAOu0B,QAAP;AACD,KA7SD;;AA8SA,QAAI5P,OAAO,GAAG;AACZkZ,MAAAA,MAAM,EAAEA,MADI;AAEZ87E,MAAAA,kBAAkB,EAAEA,kBAFR;AAGZxgB,MAAAA,mBAAmB,EAAEA,mBAHT;AAIZlsC,MAAAA,aAAa,EAAEA,aAJH;AAKZisC,MAAAA,cAAc,EAAEA,cALJ;AAMZqiB,MAAAA,UAAU,EAAEA,UANA;AAOZn1E,MAAAA,KAAK,EAAEA;AAPK,KAAd;AASAwzE,IAAAA,UAAU,CAACj1F,OAAD,EAAU0M,QAAV,CAAV;AACAykF,IAAAA,UAAU,CAACnxF,OAAD,EAAU0M,QAAV,CAAV;AACA,WAAO1M,OAAP;AACD,GA3dD;;AA6dA,MAAIg4F,UAAU,GAAG,UAAUC,UAAV,EAAsBvrF,QAAtB,EAAgCtb,GAAhC,EAAqC;AACpD6mG,IAAAA,UAAU,CAACjD,kBAAX,CAA8B,mBAA9B,EAAmD,UAAU/1F,KAAV,EAAiB/lB,IAAjB,EAAuB;AACxE,UAAIoB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AAAA,UAAsB4W,IAAtB;;AACA,aAAO1W,CAAC,EAAR,EAAY;AACV0W,QAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAZ;AACA0W,QAAAA,IAAI,CAACgN,IAAL,CAAU,UAAV,EAAsBhN,IAAI,CAACgN,IAAL,CAAU,mBAAV,CAAtB;AACAhN,QAAAA,IAAI,CAACgN,IAAL,CAAU9kB,IAAV,EAAgB,IAAhB;AACD;AACF,KAPD;AAQA++G,IAAAA,UAAU,CAACjD,kBAAX,CAA8B,gBAA9B,EAAgD,UAAU/1F,KAAV,EAAiB/lB,IAAjB,EAAuB;AACrE,UAAIoB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AAAA,UAAsB4W,IAAtB;AAAA,UAA4BlV,KAA5B;AACA,UAAIo8G,YAAY,GAAG,cAAch/G,IAAjC;AACA,UAAIyoC,YAAY,GAAGjV,QAAQ,CAACkV,aAA5B;AACA,UAAIC,iBAAiB,GAAGnV,QAAQ,CAACoV,mBAAjC;;AACA,aAAOxnC,CAAC,EAAR,EAAY;AACV0W,QAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAZ;AACAwB,QAAAA,KAAK,GAAGkV,IAAI,CAACgN,IAAL,CAAUk6F,YAAV,CAAR;;AACA,YAAIp8G,KAAK,KAAKlD,SAAd,EAAyB;AACvBoY,UAAAA,IAAI,CAACgN,IAAL,CAAU9kB,IAAV,EAAgB4C,KAAK,CAAC1B,MAAN,GAAe,CAAf,GAAmB0B,KAAnB,GAA2B,IAA3C;AACAkV,UAAAA,IAAI,CAACgN,IAAL,CAAUk6F,YAAV,EAAwB,IAAxB;AACD,SAHD,MAGO;AACLp8G,UAAAA,KAAK,GAAGkV,IAAI,CAACgN,IAAL,CAAU9kB,IAAV,CAAR;;AACA,cAAIA,IAAI,KAAK,OAAb,EAAsB;AACpB4C,YAAAA,KAAK,GAAGsV,GAAG,CAACwsC,cAAJ,CAAmBxsC,GAAG,CAACssC,UAAJ,CAAe5hD,KAAf,CAAnB,EAA0CkV,IAAI,CAAC9X,IAA/C,CAAR;AACD,WAFD,MAEO,IAAIyoC,YAAJ,EAAkB;AACvB7lC,YAAAA,KAAK,GAAG6lC,YAAY,CAAChoC,IAAb,CAAkBkoC,iBAAlB,EAAqC/lC,KAArC,EAA4C5C,IAA5C,EAAkD8X,IAAI,CAAC9X,IAAvD,CAAR;AACD;;AACD8X,UAAAA,IAAI,CAACgN,IAAL,CAAU9kB,IAAV,EAAgB4C,KAAK,CAAC1B,MAAN,GAAe,CAAf,GAAmB0B,KAAnB,GAA2B,IAA3C;AACD;AACF;AACF,KArBD;AAsBAm8G,IAAAA,UAAU,CAACjD,kBAAX,CAA8B,OAA9B,EAAuC,UAAU/1F,KAAV,EAAiB;AACtD,UAAI3kB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AAAA,UAAsB4W,IAAtB;AAAA,UAA4BlV,KAA5B;;AACA,aAAOxB,CAAC,EAAR,EAAY;AACV0W,QAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAZ;AACAwB,QAAAA,KAAK,GAAGkV,IAAI,CAACgN,IAAL,CAAU,OAAV,CAAR;;AACA,YAAIliB,KAAJ,EAAW;AACTA,UAAAA,KAAK,GAAGkV,IAAI,CAACgN,IAAL,CAAU,OAAV,EAAmB5W,OAAnB,CAA2B,6BAA3B,EAA0D,EAA1D,CAAR;AACA4J,UAAAA,IAAI,CAACgN,IAAL,CAAU,OAAV,EAAmBliB,KAAK,CAAC1B,MAAN,GAAe,CAAf,GAAmB0B,KAAnB,GAA2B,IAA9C;AACD;AACF;AACF,KAVD;AAWAm8G,IAAAA,UAAU,CAACjD,kBAAX,CAA8B,eAA9B,EAA+C,UAAU/1F,KAAV,EAAiB/lB,IAAjB,EAAuBmC,IAAvB,EAA6B;AAC1E,UAAIf,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AAAA,UAAsB4W,IAAtB;;AACA,aAAO1W,CAAC,EAAR,EAAY;AACV0W,QAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAZ;;AACA,YAAI0W,IAAI,CAACgN,IAAL,CAAU,eAAV,MAA+B,UAA/B,IAA6C,CAAC3iB,IAAI,CAAC4lD,OAAvD,EAAgE;AAC9D,cAAIk3D,WAAW,GAAGl5G,QAAQ,CAACD,IAAT,CAAcgS,IAAI,CAAC2E,UAAnB,EAA+BzX,MAA/B,CAAsC,UAAUyX,UAAV,EAAsB;AAC5E,mBAAO,CAACsc,QAAQ,CAACtc,UAAU,CAAC7Z,KAAZ,CAAhB;AACD,WAFiB,CAAlB;;AAGA,cAAIq8G,WAAJ,EAAiB;AACfnnG,YAAAA,IAAI,CAACmH,MAAL;AACD,WAFD,MAEO;AACLnH,YAAAA,IAAI,CAACiH,MAAL;AACD;AACF;AACF;AACF,KAfD;AAgBAggG,IAAAA,UAAU,CAAC3vD,aAAX,CAAyB,UAAzB,EAAqC,UAAUrpC,KAAV,EAAiB;AACpD,UAAI3kB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AAAA,UAAsB4W,IAAtB;;AACA,aAAO1W,CAAC,EAAR,EAAY;AACV0W,QAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAL,CAASqb,UAAhB;;AACA,YAAI3E,IAAJ,EAAU;AACRA,UAAAA,IAAI,CAAClV,KAAL,GAAa48B,QAAQ,CAACD,MAAT,CAAgBznB,IAAI,CAAClV,KAArB,CAAb;AACD;AACF;AACF,KARD;AASAm8G,IAAAA,UAAU,CAAC3vD,aAAX,CAAyB,cAAzB,EAAyC,UAAUrpC,KAAV,EAAiB/lB,IAAjB,EAAuB;AAC9D,UAAIoB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AAAA,UAAsB4W,IAAtB;AAAA,UAA4BlV,KAA5B;AAAA,UAAmCsD,IAAnC;;AACA,UAAI+J,IAAI,GAAG,UAAUrN,KAAV,EAAiB;AAC1B,eAAOA,KAAK,CAACsL,OAAN,CAAc,0BAAd,EAA0C,IAA1C,EAAgDA,OAAhD,CAAwD,oBAAxD,EAA8E,EAA9E,EAAkFA,OAAlF,CAA0F,yHAA1F,EAAqN,EAArN,EAAyNA,OAAzN,CAAiO,2GAAjO,EAA8U,EAA9U,CAAP;AACD,OAFD;;AAGA,aAAO9M,CAAC,EAAR,EAAY;AACV0W,QAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAZ;AACAwB,QAAAA,KAAK,GAAGkV,IAAI,CAAC2E,UAAL,GAAkB3E,IAAI,CAAC2E,UAAL,CAAgB7Z,KAAlC,GAA0C,EAAlD;;AACA,YAAI5C,IAAI,KAAK,QAAb,EAAuB;AACrBkG,UAAAA,IAAI,GAAG4R,IAAI,CAACgN,IAAL,CAAU,MAAV,CAAP;;AACA,cAAI5e,IAAJ,EAAU;AACR4R,YAAAA,IAAI,CAACgN,IAAL,CAAU,MAAV,EAAkB5e,IAAI,KAAK,aAAT,GAAyB,IAAzB,GAAgCA,IAAI,CAACgI,OAAL,CAAa,QAAb,EAAuB,EAAvB,CAAlD;AACD;;AACD,cAAIslB,QAAQ,CAAC82D,cAAT,KAA4B,OAA5B,IAAuC1nF,KAAK,CAAC1B,MAAN,GAAe,CAA1D,EAA6D;AAC3D4W,YAAAA,IAAI,CAAC2E,UAAL,CAAgB7Z,KAAhB,GAAwB,mBAAmBqN,IAAI,CAACrN,KAAD,CAAvB,GAAiC,UAAzD;AACD;AACF,SARD,MAQO;AACL,cAAI4wB,QAAQ,CAAC82D,cAAT,KAA4B,OAA5B,IAAuC1nF,KAAK,CAAC1B,MAAN,GAAe,CAA1D,EAA6D;AAC3D4W,YAAAA,IAAI,CAAC2E,UAAL,CAAgB7Z,KAAhB,GAAwB,WAAWqN,IAAI,CAACrN,KAAD,CAAf,GAAyB,OAAjD;AACD;AACF;AACF;AACF,KAtBD;AAuBAm8G,IAAAA,UAAU,CAAC3vD,aAAX,CAAyB,UAAzB,EAAqC,UAAUrpC,KAAV,EAAiB;AACpD,UAAI3kB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AAAA,UAAsB4W,IAAtB;;AACA,aAAO1W,CAAC,EAAR,EAAY;AACV0W,QAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAZ;;AACA,YAAIoyB,QAAQ,CAAC80D,cAAT,IAA2BxwE,IAAI,CAAClV,KAAL,CAAWzC,OAAX,CAAmB,SAAnB,MAAkC,CAAjE,EAAoE;AAClE2X,UAAAA,IAAI,CAAC9X,IAAL,GAAY,QAAZ;AACA8X,UAAAA,IAAI,CAAC5R,IAAL,GAAY,CAAZ;AACA4R,UAAAA,IAAI,CAAClV,KAAL,GAAasV,GAAG,CAACqnB,MAAJ,CAAWznB,IAAI,CAAClV,KAAL,CAAWsL,OAAX,CAAmB,mBAAnB,EAAwC,EAAxC,CAAX,CAAb;AACD,SAJD,MAIO,IAAI4J,IAAI,CAAClV,KAAL,CAAWzC,OAAX,CAAmB,gBAAnB,MAAyC,CAA7C,EAAgD;AACrD2X,UAAAA,IAAI,CAAC9X,IAAL,GAAY,OAAZ;AACA8X,UAAAA,IAAI,CAAC5R,IAAL,GAAY,CAAZ;AACA4R,UAAAA,IAAI,CAAC0N,GAAL,GAAW,IAAX;AACA1N,UAAAA,IAAI,CAAClV,KAAL,GAAa+kF,QAAQ,CAAC7vE,IAAI,CAAClV,KAAN,CAAR,CAAqB8M,MAArB,CAA4B,EAA5B,CAAb;AACD;AACF;AACF,KAfD;AAgBAqvG,IAAAA,UAAU,CAAC3vD,aAAX,CAAyB,qBAAzB,EAAgD,UAAUrpC,KAAV,EAAiB/lB,IAAjB,EAAuB;AACrE,UAAIoB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AAAA,UAAsB4W,IAAtB;;AACA,aAAO1W,CAAC,EAAR,EAAY;AACV0W,QAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAZ;;AACA,YAAI0W,IAAI,CAAC5R,IAAL,KAAc,CAAlB,EAAqB;AACnB4R,UAAAA,IAAI,CAACiH,MAAL;AACD,SAFD,MAEO,IAAIjH,IAAI,CAAC5R,IAAL,KAAc,CAAlB,EAAqB;AAC1B,cAAIlG,IAAI,KAAK,OAAT,IAAoB,CAAC8X,IAAI,CAACgN,IAAL,CAAU,MAAV,CAAzB,EAA4C;AAC1ChN,YAAAA,IAAI,CAACgN,IAAL,CAAU,MAAV,EAAkB,MAAlB;AACD;AACF;AACF;AACF,KAZD;AAaAi6F,IAAAA,UAAU,CAACjD,kBAAX,CAA8B,eAA9B,EAA+C,UAAU/1F,KAAV,EAAiB;AAC9DjhB,MAAAA,IAAI,CAACihB,KAAD,EAAQ,UAAUjO,IAAV,EAAgB;AAC1B,YAAIA,IAAI,CAACgN,IAAL,CAAU,eAAV,MAA+B,cAAnC,EAAmD;AACjD,cAAIhN,IAAI,CAAC+kB,OAAL,CAAakiF,UAAU,CAAC/+E,MAAX,CAAkBmH,mBAAlB,EAAb,CAAJ,EAA2D;AACzDrvB,YAAAA,IAAI,CAACiH,MAAL;AACD,WAFD,MAEO;AACLjH,YAAAA,IAAI,CAACmH,MAAL;AACD;AACF;AACF,OARG,CAAJ;AASD,KAVD;AAWA8/F,IAAAA,UAAU,CAACjD,kBAAX,CAA8B,+CAA+C,qCAA/C,GAAuF,oDAArH,EAA2K,UAAU/1F,KAAV,EAAiB/lB,IAAjB,EAAuB;AAChM,UAAIoB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;;AACA,aAAOE,CAAC,EAAR,EAAY;AACV2kB,QAAAA,KAAK,CAAC3kB,CAAD,CAAL,CAAS0jB,IAAT,CAAc9kB,IAAd,EAAoB,IAApB;AACD;AACF,KALD;AAMD,GAxID;;AAyIA,MAAIk/G,cAAc,GAAG,UAAUxoF,QAAV,EAAoB;AACvC,QAAI/S,IAAI,GAAG,UAAU7L,IAAV,EAAgB;AACzB,aAAOA,IAAI,IAAIA,IAAI,CAAC9X,IAAL,KAAc,IAA7B;AACD,KAFD;;AAGA,QAAIm/G,OAAO,GAAGzoF,QAAQ,CAACha,SAAvB;;AACA,QAAIiH,IAAI,CAACw7F,OAAD,CAAR,EAAmB;AACjB,UAAIC,OAAO,GAAGD,OAAO,CAACvoF,IAAtB;;AACA,UAAIjT,IAAI,CAACy7F,OAAD,CAAR,EAAmB;AACjBD,QAAAA,OAAO,CAACpgG,MAAR;AACAqgG,QAAAA,OAAO,CAACrgG,MAAR;AACD;AACF;AACF,GAZD;;AAcA,MAAIsgG,UAAU,GAAG,UAAUnsF,MAAV,EAAkBpb,IAAlB,EAAwB3V,IAAxB,EAA8B;AAC7C,QAAIgV,GAAJ,EAASmoG,MAAT;AACA,QAAIpnG,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACAJ,IAAAA,IAAI,GAAGA,IAAI,CAACilC,SAAL,CAAe,IAAf,CAAP;AACA,QAAIwiE,IAAI,GAAGlrG,QAAQ,CAACw5F,cAApB;;AACA,QAAI0R,IAAI,CAACzR,kBAAT,EAA6B;AAC3B32F,MAAAA,GAAG,GAAGooG,IAAI,CAACzR,kBAAL,CAAwB,EAAxB,CAAN;AACAl3F,MAAAA,KAAK,CAAC9R,IAAN,CAAWgT,IAAI,CAAC6C,QAAL,KAAkB,MAAlB,GAA2B7C,IAAI,CAACN,UAAhC,GAA6C,CAACM,IAAD,CAAxD,EAAgE,UAAUA,IAAV,EAAgB;AAC9EX,QAAAA,GAAG,CAACiI,IAAJ,CAASb,WAAT,CAAqBpH,GAAG,CAACkmF,UAAJ,CAAevlF,IAAf,EAAqB,IAArB,CAArB;AACD,OAFD;;AAGA,UAAIA,IAAI,CAAC6C,QAAL,KAAkB,MAAtB,EAA8B;AAC5B7C,QAAAA,IAAI,GAAGX,GAAG,CAACiI,IAAJ,CAAS3C,UAAhB;AACD,OAFD,MAEO;AACL3E,QAAAA,IAAI,GAAGX,GAAG,CAACiI,IAAX;AACD;;AACDkgG,MAAAA,MAAM,GAAGpnG,GAAG,CAACf,GAAb;AACAe,MAAAA,GAAG,CAACf,GAAJ,GAAUA,GAAV;AACD;;AACDs4D,IAAAA,cAAc,CAACv8C,MAAD,EAASvnB,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKxJ,IAAL,CAAT,EAAqB;AAAE2V,MAAAA,IAAI,EAAEA;AAAR,KAArB,CAAjB,CAAd;;AACA,QAAIwnG,MAAJ,EAAY;AACVpnG,MAAAA,GAAG,CAACf,GAAJ,GAAUmoG,MAAV;AACD;;AACD,WAAOxnG,IAAP;AACD,GAvBD;;AAwBA,MAAI0nG,eAAe,GAAG,UAAUtsF,MAAV,EAAkB/wB,IAAlB,EAAwB;AAC5C,WAAO+wB,MAAM,IAAIA,MAAM,CAACusF,iBAAP,CAAyB,YAAzB,CAAV,IAAoD,CAACt9G,IAAI,CAACknF,SAAjE;AACD,GAFD;;AAGA,MAAI7hE,OAAO,GAAG,UAAU0L,MAAV,EAAkBpb,IAAlB,EAAwB3V,IAAxB,EAA8B;AAC1C,WAAOq9G,eAAe,CAACtsF,MAAD,EAAS/wB,IAAT,CAAf,GAAgCk9G,UAAU,CAACnsF,MAAD,EAASpb,IAAT,EAAe3V,IAAf,CAA1C,GAAiE2V,IAAxE;AACD,GAFD;;AAIA,MAAI4nG,WAAW,GAAG,UAAUX,UAAV,EAAsBt2B,SAAtB,EAAiCzoF,IAAjC,EAAuC;AACvD,QAAI4W,KAAK,CAACE,OAAN,CAAc2xE,SAAd,EAAyBzoF,IAAzB,MAAmC,CAAC,CAAxC,EAA2C;AACzC++G,MAAAA,UAAU,CAACjD,kBAAX,CAA8B97G,IAA9B,EAAoC,UAAU+lB,KAAV,EAAiB/lB,IAAjB,EAAuB;AACzD,YAAIoB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;;AACA,eAAOE,CAAC,EAAR,EAAY;AACV2kB,UAAAA,KAAK,CAAC3kB,CAAD,CAAL,CAAS0jB,IAAT,CAAc9kB,IAAd,EAAoB,IAApB;AACD;AACF,OALD;AAMAyoF,MAAAA,SAAS,CAACvhF,IAAV,CAAelH,IAAf;AACD;AACF,GAVD;;AAWA,MAAI2/G,aAAa,GAAG,UAAUzsF,MAAV,EAAkB/wB,IAAlB,EAAwBu8C,OAAxB,EAAiC;AACnD,QAAI,CAACv8C,IAAI,CAACknF,SAAN,IAAmBn2D,MAAvB,EAA+B;AAC7B,UAAI0sF,OAAO,GAAGlwC,eAAe,CAACx8C,MAAD,EAASvnB,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKxJ,IAAL,CAAT,EAAqB;AAAEu8C,QAAAA,OAAO,EAAEA;AAAX,OAArB,CAAjB,CAA7B;AACA,aAAOkhE,OAAO,CAAClhE,OAAf;AACD,KAHD,MAGO;AACL,aAAOA,OAAP;AACD;AACF,GAPD;;AAQA,MAAImhE,eAAe,GAAG,UAAU3nG,GAAV,EAAeJ,IAAf,EAAqB3V,IAArB,EAA2B;AAC/C,QAAI8U,IAAI,GAAG+hB,MAAM,CAAC72B,IAAI,CAACinF,QAAL,GAAgBtxE,IAAI,CAACR,SAArB,GAAiCY,GAAG,CAAC+sC,YAAJ,CAAiBntC,IAAjB,CAAlC,CAAjB;AACA,WAAO3V,IAAI,CAACirD,SAAL,IAAkB70B,mBAAmB,CAACjgB,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAD,CAArC,GAAoEb,IAApE,GAA2EL,KAAK,CAAC3G,IAAN,CAAWgH,IAAX,CAAlF;AACD,GAHD;;AAIA,MAAI6oG,SAAS,GAAG,UAAUf,UAAV,EAAsB9nG,IAAtB,EAA4B9U,IAA5B,EAAkC;AAChD,QAAI43F,UAAU,GAAG53F,IAAI,CAACirD,SAAL,GAAiBzhD,QAAQ,CAAC;AAAE26F,MAAAA,iBAAiB,EAAE;AAArB,KAAD,EAA+BnkG,IAA/B,CAAzB,GAAgEA,IAAjF;AACA,QAAIu0B,QAAQ,GAAGqoF,UAAU,CAACx2E,KAAX,CAAiBtxB,IAAjB,EAAuB8iF,UAAvB,CAAf;AACAmlB,IAAAA,cAAc,CAACxoF,QAAD,CAAd;AACA,WAAOA,QAAP;AACD,GALD;;AAMA,MAAIqpF,aAAa,GAAG,UAAUvsF,QAAV,EAAoBwM,MAApB,EAA4BloB,IAA5B,EAAkC;AACpD,QAAIkoG,cAAc,GAAGv1B,cAAc,CAACj3D,QAAD,EAAWwM,MAAX,CAAnC;AACA,WAAOggF,cAAc,CAACh2E,SAAf,CAAyBlyB,IAAzB,CAAP;AACD,GAHD;;AAIA,MAAImoG,MAAM,GAAG,UAAU/sF,MAAV,EAAkBM,QAAlB,EAA4BwM,MAA5B,EAAoCtJ,QAApC,EAA8Cv0B,IAA9C,EAAoD;AAC/D,QAAIu8C,OAAO,GAAGqhE,aAAa,CAACvsF,QAAD,EAAWwM,MAAX,EAAmBtJ,QAAnB,CAA3B;AACA,WAAOipF,aAAa,CAACzsF,MAAD,EAAS/wB,IAAT,EAAeu8C,OAAf,CAApB;AACD,GAHD;;AAIA,MAAIwhE,iBAAiB,GAAG,UAAU1sF,QAAV,EAAoBN,MAApB,EAA4B;AAClD,QAAIu1D,SAAS,GAAG,CAAC,mBAAD,CAAhB;AACA,QAAIvwE,GAAG,GAAGgb,MAAM,IAAIA,MAAM,CAAChb,GAAjB,GAAuBgb,MAAM,CAAChb,GAA9B,GAAoC+oC,QAAQ,CAAC2D,GAAvD;AACA,QAAI5kB,MAAM,GAAG9M,MAAM,IAAIA,MAAM,CAAC8M,MAAjB,GAA0B9M,MAAM,CAAC8M,MAAjC,GAA0CkB,MAAM,CAAC1N,QAAD,CAA7D;AACAA,IAAAA,QAAQ,CAAC42D,eAAT,GAA2B52D,QAAQ,CAAC42D,eAAT,IAA4B,OAAvD;AACA52D,IAAAA,QAAQ,CAACwoF,mBAAT,GAA+B,yBAAyBxoF,QAAzB,GAAoCA,QAAQ,CAACwoF,mBAA7C,GAAmE,IAAlG;AACA,QAAI+C,UAAU,GAAGhC,SAAS,CAACvpF,QAAD,EAAWwM,MAAX,CAA1B;AACA8+E,IAAAA,UAAU,CAACC,UAAD,EAAavrF,QAAb,EAAuBtb,GAAvB,CAAV;;AACA,QAAI8xB,SAAS,GAAG,UAAUlyB,IAAV,EAAgBiiF,UAAhB,EAA4B;AAC1C,UAAIA,UAAU,KAAK,KAAK,CAAxB,EAA2B;AACzBA,QAAAA,UAAU,GAAG,EAAb;AACD;;AACD,UAAI53F,IAAI,GAAGwJ,QAAQ,CAAC;AAAEw8D,QAAAA,MAAM,EAAE;AAAV,OAAD,EAAqB4xB,UAArB,CAAnB;;AACA,UAAIt9D,UAAU,GAAGjV,OAAO,CAAC0L,MAAD,EAASpb,IAAT,EAAe3V,IAAf,CAAxB;AACA,UAAI8U,IAAI,GAAG4oG,eAAe,CAAC3nG,GAAD,EAAMukB,UAAN,EAAkBt6B,IAAlB,CAA1B;AACA,UAAIu0B,QAAQ,GAAGopF,SAAS,CAACf,UAAD,EAAa9nG,IAAb,EAAmB9U,IAAnB,CAAxB;AACA,aAAOA,IAAI,CAACgmE,MAAL,KAAgB,MAAhB,GAAyBzxC,QAAzB,GAAoCupF,MAAM,CAAC/sF,MAAD,EAASM,QAAT,EAAmBwM,MAAnB,EAA2BtJ,QAA3B,EAAqCv0B,IAArC,CAAjD;AACD,KATD;;AAUA,WAAO;AACL69B,MAAAA,MAAM,EAAEA,MADH;AAELovB,MAAAA,aAAa,EAAE2vD,UAAU,CAAC3vD,aAFrB;AAGL0sD,MAAAA,kBAAkB,EAAEiD,UAAU,CAACjD,kBAH1B;AAIL9xE,MAAAA,SAAS,EAAEA,SAJN;AAKLm2E,MAAAA,QAAQ,EAAE,UAAUC,KAAV,EAAiB;AACzBpgF,QAAAA,MAAM,CAACgD,gBAAP,CAAwBo9E,KAAxB;AACD,OAPI;AAQLC,MAAAA,QAAQ,EAAE,UAAUD,KAAV,EAAiB;AACzBpgF,QAAAA,MAAM,CAAC0E,gBAAP,CAAwB07E,KAAxB;AACD,OAVI;AAWLV,MAAAA,WAAW,EAAE58G,KAAK,CAAC48G,WAAD,EAAcX,UAAd,EAA0Bt2B,SAA1B,CAXb;AAYLM,MAAAA,YAAY,EAAEpmF,QAAQ,CAAC8lF,SAAD,CAZjB;AAaL4S,MAAAA,cAAc,EAAE0jB,UAAU,CAAC1jB,cAbtB;AAcLC,MAAAA,mBAAmB,EAAEyjB,UAAU,CAACzjB;AAd3B,KAAP;AAgBD,GAlCD;;AAoCA,MAAIglB,aAAa,GAAG,UAAU9sF,QAAV,EAAoBN,MAApB,EAA4B;AAC9C,QAAIqtF,aAAa,GAAGL,iBAAiB,CAAC1sF,QAAD,EAAWN,MAAX,CAArC;AACA,WAAO;AACL8M,MAAAA,MAAM,EAAEugF,aAAa,CAACvgF,MADjB;AAELovB,MAAAA,aAAa,EAAEmxD,aAAa,CAACnxD,aAFxB;AAGL0sD,MAAAA,kBAAkB,EAAEyE,aAAa,CAACzE,kBAH7B;AAIL9xE,MAAAA,SAAS,EAAEu2E,aAAa,CAACv2E,SAJpB;AAKLm2E,MAAAA,QAAQ,EAAEI,aAAa,CAACJ,QALnB;AAMLE,MAAAA,QAAQ,EAAEE,aAAa,CAACF,QANnB;AAOLX,MAAAA,WAAW,EAAEa,aAAa,CAACb,WAPtB;AAQL32B,MAAAA,YAAY,EAAEw3B,aAAa,CAACx3B,YARvB;AASLsS,MAAAA,cAAc,EAAEklB,aAAa,CAACllB,cATzB;AAULC,MAAAA,mBAAmB,EAAEilB,aAAa,CAACjlB;AAV9B,KAAP;AAYD,GAdD;;AAgBA,MAAIklB,eAAe,GAAG,MAAtB;;AACA,MAAIC,YAAY,GAAG,UAAUvtF,MAAV,EAAkB/wB,IAAlB,EAAwB;AACzC,QAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AACnBA,MAAAA,IAAI,GAAG,EAAP;AACD;;AACD,QAAIgmE,MAAM,GAAGhmE,IAAI,CAACgmE,MAAL,GAAchmE,IAAI,CAACgmE,MAAnB,GAA4Bq4C,eAAzC;AACA,WAAOh2B,UAAU,CAACt3D,MAAD,EAAS/wB,IAAT,EAAegmE,MAAf,CAAjB;AACD,GAND;;AAQA,MAAIu4C,YAAY,GAAG,UAAUxtF,MAAV,EAAkBwrB,OAAlB,EAA2Bv8C,IAA3B,EAAiC;AAClD,QAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AACnBA,MAAAA,IAAI,GAAG,EAAP;AACD;;AACD,WAAO0vF,UAAU,CAAC3+D,MAAD,EAASwrB,OAAT,EAAkBv8C,IAAlB,CAAjB;AACD,GALD;;AAOA,MAAIw+G,KAAK,GAAG1/D,QAAQ,CAAC2D,GAArB;;AACA,MAAIg8D,qBAAqB,GAAG,UAAU1tF,MAAV,EAAkB;AAC5CytF,IAAAA,KAAK,CAAC99D,QAAN,CAAe3vB,MAAM,CAACnvB,EAAtB,EAA0B,SAA1B,EAAqCmvB,MAAM,CAAC2tF,UAA5C;AACD,GAFD;;AAGA,MAAIC,WAAW,GAAG,UAAUrhH,CAAV,EAAa;AAC7B,WAAOsG,QAAQ,CAACD,IAAT,CAAcrG,CAAd,EAAiBqF,IAAjB,CAAsB,UAAUrF,CAAV,EAAa;AACxC,aAAOA,CAAC,CAAC+uC,OAAF,EAAP;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAIuyE,kBAAkB,GAAG,UAAU7tF,MAAV,EAAkB;AACzCA,IAAAA,MAAM,CAAC8tF,oBAAP,GAA8B9tF,MAAM,CAAC+tF,WAAP,GAAqB/tF,MAAM,CAAC1e,SAAP,GAAmB0e,MAAM,CAACguF,eAAP,GAAyB,IAA/F;AACAhuF,IAAAA,MAAM,CAACiuF,WAAP,GAAqBjuF,MAAM,CAACusB,eAAP,GAAyBvsB,MAAM,CAACwsB,aAAP,GAAuB,IAArE;AACAxsB,IAAAA,MAAM,CAACkuD,aAAP,GAAuBluD,MAAM,CAAC4hD,SAAP,GAAmB,IAA1C;;AACA,QAAI5hD,MAAM,CAACk6B,SAAX,EAAsB;AACpBl6B,MAAAA,MAAM,CAACk6B,SAAP,GAAmBl6B,MAAM,CAACk6B,SAAP,CAAiBttC,GAAjB,GAAuBoT,MAAM,CAACk6B,SAAP,CAAiBl1C,GAAjB,GAAuBgb,MAAM,CAACk6B,SAAP,CAAiBl1C,GAAjB,CAAqBf,GAArB,GAA2B,IAA5F;AACD;AACF,GAPD;;AAQA,MAAIiqG,WAAW,GAAG,UAAUluF,MAAV,EAAkB;AAClC,QAAImuF,IAAI,GAAGnuF,MAAM,CAAC+tF,WAAlB;;AACA,QAAII,IAAJ,EAAU;AACR,UAAIA,IAAI,CAACC,aAAT,EAAwB;AACtBD,QAAAA,IAAI,CAACE,MAAL,GAAcF,IAAI,CAACC,aAAnB;AACAD,QAAAA,IAAI,CAACC,aAAL,GAAqB,IAArB;AACD;;AACDX,MAAAA,KAAK,CAACzyE,MAAN,CAAamzE,IAAb,EAAmB,cAAnB,EAAmCnuF,MAAM,CAACsuF,iBAA1C;AACD;AACF,GATD;;AAUA,MAAIC,QAAQ,GAAG,UAAUvuF,MAAV,EAAkB;AAC/B,QAAI,CAACA,MAAM,CAACC,OAAZ,EAAqB;AACnB,UAAI6mE,mBAAmB,GAAG9mE,MAAM,CAAC8mE,mBAAjC;AAAA,UAAsD0nB,YAAY,GAAGxuF,MAAM,CAACwuF,YAA5E;AACA,UAAItiG,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAAX;AACA,UAAIl0C,OAAO,GAAG8Z,MAAM,CAACsoC,UAAP,EAAd;;AACA,UAAIp8C,IAAJ,EAAU;AACR8T,QAAAA,MAAM,CAACyuF,IAAP,CAAY;AAAEC,UAAAA,WAAW,EAAE;AAAf,SAAZ;AACD;;AACD1uF,MAAAA,MAAM,CAACC,OAAP,GAAiB,IAAjB;AACAD,MAAAA,MAAM,CAAC2uF,qBAAP;;AACA,UAAI3uF,MAAM,CAACkpC,cAAP,IAAyBhjD,OAA7B,EAAsC;AACpCunG,QAAAA,KAAK,CAAC5hG,MAAN,CAAa3F,OAAO,CAACgD,WAArB;AACD;;AACDuzD,MAAAA,UAAU,CAACz8C,MAAD,CAAV;AACAA,MAAAA,MAAM,CAACmtD,aAAP,CAAqBthE,MAArB,CAA4BmU,MAA5B;;AACA,UAAI,CAACA,MAAM,CAAC+R,MAAR,IAAkB7lB,IAAtB,EAA4B;AAC1BwhG,QAAAA,qBAAqB,CAAC1tF,MAAD,CAArB;AACD;;AACD08C,MAAAA,UAAU,CAAC18C,MAAD,CAAV;AACAytF,MAAAA,KAAK,CAAC5hG,MAAN,CAAamU,MAAM,CAACyuE,YAAP,EAAb;AACAmf,MAAAA,WAAW,CAAC9mB,mBAAD,CAAX;AACA8mB,MAAAA,WAAW,CAACY,YAAD,CAAX;AACAxuF,MAAAA,MAAM,CAACsb,OAAP;AACD;AACF,GAxBD;;AAyBA,MAAIA,OAAO,GAAG,UAAUtb,MAAV,EAAkB4uF,SAAlB,EAA6B;AACzC,QAAI10D,SAAS,GAAGl6B,MAAM,CAACk6B,SAAvB;AAAA,QAAkCl1C,GAAG,GAAGgb,MAAM,CAAChb,GAA/C;;AACA,QAAIgb,MAAM,CAAC6uF,SAAX,EAAsB;AACpB;AACD;;AACD,QAAI,CAACD,SAAD,IAAc,CAAC5uF,MAAM,CAACC,OAA1B,EAAmC;AACjCD,MAAAA,MAAM,CAACnU,MAAP;AACA;AACD;;AACD,QAAI,CAAC+iG,SAAL,EAAgB;AACd5uF,MAAAA,MAAM,CAACmtD,aAAP,CAAqBl3D,GAArB,CAAyB,cAAzB,EAAyC+J,MAAM,CAAC8uF,aAAhD;;AACA,UAAI9uF,MAAM,CAAC+uF,KAAP,IAAgB/uF,MAAM,CAAC+uF,KAAP,CAAazzE,OAAjC,EAA0C;AACxCtb,QAAAA,MAAM,CAAC+uF,KAAP,CAAazzE,OAAb;AACD;;AACDsyE,MAAAA,WAAW,CAAC1zD,SAAD,CAAX;AACA0zD,MAAAA,WAAW,CAAC5oG,GAAD,CAAX;AACD;;AACDkpG,IAAAA,WAAW,CAACluF,MAAD,CAAX;AACA6tF,IAAAA,kBAAkB,CAAC7tF,MAAD,CAAlB;AACAA,IAAAA,MAAM,CAAC6uF,SAAP,GAAmB,IAAnB;AACD,GApBD;;AAsBA,MAAIG,gBAAgB,GAAG1gH,MAAM,CAAC3B,SAAP,CAAiBqJ,cAAxC;;AACA,MAAIi5G,MAAM,GAAG,UAAUtvE,GAAV,EAAe1kC,EAAf,EAAmB;AAC9B,QAAIi0G,WAAW,GAAG97G,QAAQ,CAACusC,GAAD,CAAR,IAAiBvsC,QAAQ,CAAC6H,EAAD,CAA3C;AACA,WAAOi0G,WAAW,GAAGC,SAAS,CAACxvE,GAAD,EAAM1kC,EAAN,CAAZ,GAAwBA,EAA1C;AACD,GAHD;;AAIA,MAAIm0G,SAAS,GAAG,UAAUC,MAAV,EAAkB;AAChC,WAAO,YAAY;AACjB,UAAIC,OAAO,GAAG,EAAd;;AACA,WAAK,IAAIpgH,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CogH,QAAAA,OAAO,CAACpgH,EAAD,CAAP,GAAcC,SAAS,CAACD,EAAD,CAAvB;AACD;;AACD,UAAIogH,OAAO,CAACthH,MAAR,KAAmB,CAAvB,EAA0B;AACxB,cAAM,IAAIqC,KAAJ,CAAU,2BAAV,CAAN;AACD;;AACD,UAAIqY,GAAG,GAAG,EAAV;;AACA,WAAK,IAAIxP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGo2G,OAAO,CAACthH,MAA5B,EAAoCkL,CAAC,EAArC,EAAyC;AACvC,YAAIq2G,SAAS,GAAGD,OAAO,CAACp2G,CAAD,CAAvB;;AACA,aAAK,IAAIjC,GAAT,IAAgBs4G,SAAhB,EAA2B;AACzB,cAAIP,gBAAgB,CAACzhH,IAAjB,CAAsBgiH,SAAtB,EAAiCt4G,GAAjC,CAAJ,EAA2C;AACzCyR,YAAAA,GAAG,CAACzR,GAAD,CAAH,GAAWo4G,MAAM,CAAC3mG,GAAG,CAACzR,GAAD,CAAJ,EAAWs4G,SAAS,CAACt4G,GAAD,CAApB,CAAjB;AACD;AACF;AACF;;AACD,aAAOyR,GAAP;AACD,KAlBD;AAmBD,GApBD;;AAqBA,MAAIymG,SAAS,GAAGC,SAAS,CAACH,MAAD,CAAzB;;AAEA,MAAIO,aAAa,GAAG,UAAUC,QAAV,EAAoBnvF,QAApB,EAA8B;AAChD,WAAO;AACLmvF,MAAAA,QAAQ,EAAEhgH,QAAQ,CAACggH,QAAD,CADb;AAELnvF,MAAAA,QAAQ,EAAE7wB,QAAQ,CAAC6wB,QAAD;AAFb,KAAP;AAID,GALD;;AAMA,MAAIovF,eAAe,GAAGxvG,QAAQ,GAAGR,UAAjC;AACA,MAAIzF,OAAO,GAAGy1G,eAAe,CAACz1G,OAAhB,EAAd;AACA,MAAIE,OAAO,GAAGu1G,eAAe,CAACv1G,OAAhB,EAAd;AACA,MAAID,QAAQ,GAAGw1G,eAAe,CAACx1G,QAAhB,EAAf;AACA,MAAIy1G,mBAAmB,GAAG,CACxB,OADwB,EAExB,UAFwB,EAGxB,UAHwB,CAA1B;AAKA,MAAIC,oBAAoB,GAAG;AACzBC,IAAAA,UAAU,EAAE,KADa;AAEzBC,IAAAA,eAAe,EAAE,KAFQ;AAGzBC,IAAAA,MAAM,EAAE;AAHiB,GAA3B;;AAKA,MAAIC,gBAAgB,GAAG,UAAUpR,OAAV,EAAmB;AACxC,QAAIqR,WAAW,GAAG58G,OAAO,CAACurG,OAAD,CAAP,GAAmBA,OAAO,CAACrhF,IAAR,CAAa,GAAb,CAAnB,GAAuCqhF,OAAzD;AACA,QAAIsR,cAAc,GAAGv+G,GAAG,CAACwB,QAAQ,CAAC88G,WAAD,CAAR,GAAwBA,WAAW,CAACluG,KAAZ,CAAkB,GAAlB,CAAxB,GAAiD,EAAlD,EAAsDhF,IAAtD,CAAxB;AACA,WAAO/K,MAAM,CAACk+G,cAAD,EAAiB,UAAUr4G,IAAV,EAAgB;AAC5C,aAAOA,IAAI,CAAC7J,MAAL,GAAc,CAArB;AACD,KAFY,CAAb;AAGD,GAND;;AAOA,MAAImiH,yBAAyB,GAAG,UAAUvR,OAAV,EAAmB;AACjD,WAAO5sG,MAAM,CAAC4sG,OAAD,EAAUhvG,KAAK,CAACwE,QAAD,EAAWu7G,mBAAX,CAAf,CAAb;AACD,GAFD;;AAGA,MAAIS,eAAe,GAAG,UAAU7hH,IAAV,EAAgB+xB,QAAhB,EAA0B;AAC9C,QAAIjC,MAAM,GAAGznB,QAAQ,CAAC0pB,QAAD,EAAW,UAAU5wB,KAAV,EAAiBuH,GAAjB,EAAsB;AACpD,aAAO7C,QAAQ,CAAC7F,IAAD,EAAO0I,GAAP,CAAf;AACD,KAFoB,CAArB;AAGA,WAAOu4G,aAAa,CAACnxF,MAAM,CAAC5xB,CAAR,EAAW4xB,MAAM,CAAC3wB,CAAlB,CAApB;AACD,GALD;;AAMA,MAAI2iH,UAAU,GAAG,UAAUb,aAAV,EAAyB1iH,IAAzB,EAA+BggD,QAA/B,EAAyC;AACxD,QAAIA,QAAQ,KAAK,KAAK,CAAtB,EAAyB;AACvBA,MAAAA,QAAQ,GAAG,EAAX;AACD;;AACD,QAAI2iE,QAAQ,GAAGD,aAAa,CAACC,QAAd,EAAf;AACA,QAAIa,eAAe,GAAGb,QAAQ,CAACz5G,cAAT,CAAwBlJ,IAAxB,IAAgC2iH,QAAQ,CAAC3iH,IAAD,CAAxC,GAAiD,EAAvE;AACA,WAAO4W,KAAK,CAACZ,MAAN,CAAa,EAAb,EAAiBgqC,QAAjB,EAA2BwjE,eAA3B,CAAP;AACD,GAPD;;AAQA,MAAIC,UAAU,GAAG,UAAUf,aAAV,EAAyB1iH,IAAzB,EAA+B;AAC9C,WAAO0iH,aAAa,CAACC,QAAd,GAAyBz5G,cAAzB,CAAwClJ,IAAxC,CAAP;AACD,GAFD;;AAGA,MAAI0jH,cAAc,GAAG,UAAUhB,aAAV,EAAyB1iH,IAAzB,EAA+BiiH,KAA/B,EAAsC;AACzD,QAAI0B,OAAO,GAAGjB,aAAa,CAACC,QAAd,EAAd;AACA,WAAOc,UAAU,CAACf,aAAD,EAAgB1iH,IAAhB,CAAV,IAAmC2jH,OAAO,CAAC3jH,IAAD,CAAP,CAAciiH,KAAd,KAAwBA,KAAlE;AACD,GAHD;;AAIA,MAAI2B,gBAAgB,GAAG,UAAUlB,aAAV,EAAyB1iH,IAAzB,EAA+B;AACpD,WAAOyjH,UAAU,CAACf,aAAD,EAAgB1iH,IAAhB,CAAV,GAAkC0iH,aAAa,CAACC,QAAd,GAAyB3iH,IAAzB,CAAlC,GAAmE,EAA1E;AACD,GAFD;;AAGA,MAAI6jH,cAAc,GAAG,UAAUrwF,QAAV,EAAoBsuB,UAApB,EAAgC;AACnD,WAAO53C,KAAK,CAACspB,QAAD,EAAW,cAAX,CAAL,CAAgC5uB,OAAhC,CAAwC,YAAY;AACzD,aAAOsF,KAAK,CAACspB,QAAD,EAAW,gBAAX,CAAL,CAAkC3uB,GAAlC,CAAsC,UAAU6mB,GAAV,EAAe;AAC1D,eAAOA,GAAG,KAAK,KAAR,GAAgB,MAAhB,GAAyBA,GAAhC;AACD,OAFM,CAAP;AAGD,KAJM,EAIJpnB,KAJI,CAIEw9C,UAJF,CAAP;AAKD,GAND;;AAOA,MAAIgiE,kBAAkB,GAAG,UAAUtwF,QAAV,EAAoBzvB,EAApB,EAAwBggH,eAAxB,EAAyC52G,OAAzC,EAAkD+lB,MAAlD,EAA0D;AACjF,QAAI8wF,YAAY,GAAG;AACjBjgH,MAAAA,EAAE,EAAEA,EADa;AAEjBk+G,MAAAA,KAAK,EAAE,QAFU;AAGjBgC,MAAAA,YAAY,EAAEJ,cAAc,CAACrwF,QAAD,EAAW,UAAX,CAHX;AAIjBs+E,MAAAA,OAAO,EAAE,EAJQ;AAKjBoS,MAAAA,iBAAiB,EAAEH,eALF;AAMjBI,MAAAA,uBAAuB,EAAE,IANR;AAOjBC,MAAAA,YAAY,EAAE,IAPG;AAQjBC,MAAAA,kBAAkB,EAAE,IARH;AASjBC,MAAAA,YAAY,EAAE,IATG;AAUjBC,MAAAA,aAAa,EAAE,IAVE;AAWjBC,MAAAA,kBAAkB,EAAE,IAXH;AAYjBxB,MAAAA,eAAe,EAAE,IAZA;AAajBr9B,MAAAA,OAAO,EAAE,iBAbQ;AAcjB8+B,MAAAA,MAAM,EAAE,IAdS;AAejBzM,MAAAA,uBAAuB,EAAE,mDAfR;AAgBjB1R,MAAAA,iBAAiB,EAAE,GAhBF;AAiBjBoe,MAAAA,YAAY,EAAE,IAjBG;AAkBjBxM,MAAAA,aAAa,EAAE,IAlBE;AAmBjBH,MAAAA,sBAAsB,EAAE,IAnBP;AAoBjBhuB,MAAAA,MAAM,EAAE,IApBS;AAqBjBE,MAAAA,aAAa,EAAE,wGAAwG,gGArBtG;AAsBjBE,MAAAA,YAAY,EAAE,wGAAwG,gGAtBrG;AAuBjBC,MAAAA,eAAe,EAAE,OAvBA;AAwBjB1hD,MAAAA,aAAa,EAAExV,MAAM,CAACyxF,UAxBL;AAyBjB/7E,MAAAA,mBAAmB,EAAE1V;AAzBJ,KAAnB;AA2BA,WAAOvnB,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKq4G,YAAL,CAAT,EAA6B72G,OAAO,GAAG21G,oBAAH,GAA0B,EAA9D,CAAf;AACD,GA7BD;;AA8BA,MAAI8B,wBAAwB,GAAG,UAAUC,cAAV,EAA0Bx3G,OAA1B,EAAmC;AAChE,QAAIy3G,qBAAqB,GAAG;AAC1B7B,MAAAA,MAAM,EAAE,KADkB;AAE1BgB,MAAAA,YAAY,EAAEJ,cAAc,CAACgB,cAAD,EAAiB,WAAjB,CAFF;AAG1BE,MAAAA,cAAc,EAAE;AAHU,KAA5B;AAKA,QAAIC,oBAAoB,GAAG;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAA3B;AACA,WAAOt5G,QAAQ,CAACA,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKm3G,oBAAL,CAAT,EAAqCgC,qBAArC,CAAT,EAAsEz3G,OAAO,GAAG23G,oBAAH,GAA0B,EAAvG,CAAf;AACD,GARD;;AASA,MAAIE,oBAAoB,GAAG,UAAUC,gBAAV,EAA4B3xF,QAA5B,EAAsC;AAC/D,QAAI4xF,0BAA0B,GAAG5xF,QAAQ,CAAC6xF,gBAAT,GAA4B7xF,QAAQ,CAAC6xF,gBAArC,GAAwD,EAAzF;;AACA,QAAIF,gBAAgB,IAAIA,gBAAgB,CAACE,gBAAzC,EAA2D;AACzD,aAAOzuG,KAAK,CAACZ,MAAN,CAAa,EAAb,EAAiBmvG,gBAAgB,CAACE,gBAAlC,EAAoDD,0BAApD,CAAP;AACD,KAFD,MAEO;AACL,aAAOA,0BAAP;AACD;AACF,GAPD;;AAQA,MAAIE,cAAc,GAAG,UAAUC,aAAV,EAAyBzT,OAAzB,EAAkC;AACrD,WAAO,GAAG3uG,MAAH,CAAU+/G,gBAAgB,CAACqC,aAAD,CAA1B,EAA2CpiH,MAA3C,CAAkD+/G,gBAAgB,CAACpR,OAAD,CAAlE,CAAP;AACD,GAFD;;AAGA,MAAI0T,kBAAkB,GAAG,UAAUC,cAAV,EAA0B/C,aAA1B,EAAyCgD,cAAzC,EAAyDC,aAAzD,EAAwE;AAC/F,QAAIF,cAAc,IAAI/B,cAAc,CAAChB,aAAD,EAAgB,QAAhB,EAA0B,QAA1B,CAApC,EAAyE;AACvE,aAAOW,yBAAyB,CAACsC,aAAD,CAAhC;AACD,KAFD,MAEO,IAAIF,cAAc,IAAIhC,UAAU,CAACf,aAAD,EAAgB,QAAhB,CAAhC,EAA2D;AAChE,aAAOiD,aAAP;AACD,KAFM,MAEA;AACL,aAAOD,cAAP;AACD;AACF,GARD;;AASA,MAAIE,cAAc,GAAG,UAAUH,cAAV,EAA0B/C,aAA1B,EAAyCmD,uBAAzC,EAAkEryF,QAAlE,EAA4E;AAC/F,QAAI+xF,aAAa,GAAGrC,gBAAgB,CAAC2C,uBAAuB,CAACC,cAAzB,CAApC;AACA,QAAIJ,cAAc,GAAGxC,gBAAgB,CAAC1vF,QAAQ,CAACs+E,OAAV,CAArC;AACA,QAAIiU,YAAY,GAAGnC,gBAAgB,CAAClB,aAAD,EAAgB,QAAhB,CAAnC;AACA,QAAIiD,aAAa,GAAGI,YAAY,CAACjU,OAAb,GAAuBoR,gBAAgB,CAAC6C,YAAY,CAACjU,OAAd,CAAvC,GAAgE4T,cAApF;AACA,QAAIM,eAAe,GAAGR,kBAAkB,CAACC,cAAD,EAAiB/C,aAAjB,EAAgCgD,cAAhC,EAAgDC,aAAhD,CAAxC;AACA,QAAIM,eAAe,GAAGX,cAAc,CAACC,aAAD,EAAgBS,eAAhB,CAApC;;AACA,QAAIryG,GAAG,CAACjH,OAAJ,CAAY2E,IAAZ,MAAsB/J,QAAQ,CAAC2+G,eAAD,EAAkB,KAAlB,CAAlC,EAA4D;AAC1D,YAAM,IAAI1iH,KAAJ,CAAU,uCAAV,CAAN;AACD;;AACD,WAAOqT,KAAK,CAACZ,MAAN,CAAawd,QAAb,EAAuB;AAAEs+E,MAAAA,OAAO,EAAEmU,eAAe,CAACx1F,IAAhB,CAAqB,GAArB;AAAX,KAAvB,CAAP;AACD,GAXD;;AAYA,MAAIy1F,UAAU,GAAG,UAAUT,cAAV,EAA0B/C,aAA1B,EAAyC;AACxD,WAAO+C,cAAc,IAAIhC,UAAU,CAACf,aAAD,EAAgB,QAAhB,CAAnC;AACD,GAFD;;AAGA,MAAIyD,eAAe,GAAG,UAAUV,cAAV,EAA0Bp4G,OAA1B,EAAmC+4G,eAAnC,EAAoDP,uBAApD,EAA6EryF,QAA7E,EAAuF;AAC3G,QAAI6yF,qBAAqB,GAAGZ,cAAc,GAAG;AAAEa,MAAAA,MAAM,EAAE1B,wBAAwB,CAACpxF,QAAQ,CAAC8yF,MAAT,IAAmB,EAApB,EAAwBj5G,OAAxB;AAAlC,KAAH,GAA0E,EAApH;AACA,QAAIq1G,aAAa,GAAGY,eAAe,CAAC,CAAC,QAAD,CAAD,EAAajB,SAAS,CAACgE,qBAAD,EAAwB7yF,QAAxB,CAAtB,CAAnC;AACA,QAAI+yF,gBAAgB,GAAG3vG,KAAK,CAACZ,MAAN,CAAaowG,eAAb,EAA8BP,uBAA9B,EAAuDnD,aAAa,CAAClvF,QAAd,EAAvD,EAAiF0yF,UAAU,CAACT,cAAD,EAAiB/C,aAAjB,CAAV,GAA4Ca,UAAU,CAACb,aAAD,EAAgB,QAAhB,CAAtD,GAAkF,EAAnK,EAAuK;AAC5L7jC,MAAAA,QAAQ,EAAE,IADkL;AAE5LwmC,MAAAA,gBAAgB,EAAEH,oBAAoB,CAACW,uBAAD,EAA0BnD,aAAa,CAAClvF,QAAd,EAA1B;AAFsJ,KAAvK,CAAvB;AAIA,WAAOoyF,cAAc,CAACH,cAAD,EAAiB/C,aAAjB,EAAgCmD,uBAAhC,EAAyDU,gBAAzD,CAArB;AACD,GARD;;AASA,MAAIC,iBAAiB,GAAG,UAAUtzF,MAAV,EAAkBnvB,EAAlB,EAAsBggH,eAAtB,EAAuC8B,uBAAvC,EAAgEryF,QAAhE,EAA0E;AAChG,QAAI4yF,eAAe,GAAGtC,kBAAkB,CAACtwF,QAAD,EAAWzvB,EAAX,EAAeggH,eAAf,EAAgC52G,OAAhC,EAAyC+lB,MAAzC,CAAxC;AACA,WAAOizF,eAAe,CAAC94G,OAAO,IAAID,QAAZ,EAAsBC,OAAtB,EAA+B+4G,eAA/B,EAAgDP,uBAAhD,EAAyEryF,QAAzE,CAAtB;AACD,GAHD;;AAIA,MAAIizF,WAAW,GAAG,UAAUh7G,SAAV,EAAqBynB,MAArB,EAA6BlzB,IAA7B,EAAmC;AACnD,WAAO+F,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAACM,QAAP,CAAgBxzB,IAAhB,CAAd,EAAqCkF,MAArC,CAA4CuG,SAA5C,CAAP;AACD,GAFD;;AAGA,MAAIi7G,cAAc,GAAG,UAAU9jH,KAAV,EAAiB;AACpC,QAAI+jD,MAAM,GAAG,EAAb;;AACA,QAAI,OAAO/jD,KAAP,KAAiB,QAArB,EAA+B;AAC7BkC,MAAAA,IAAI,CAAClC,KAAK,CAACzC,OAAN,CAAc,GAAd,IAAqB,CAArB,GAAyByC,KAAK,CAACqS,KAAN,CAAY,2BAAZ,CAAzB,GAAoErS,KAAK,CAACqS,KAAN,CAAY,GAAZ,CAArE,EAAuF,UAAUyW,GAAV,EAAe;AACxG,YAAI9jB,GAAG,GAAG8jB,GAAG,CAACzW,KAAJ,CAAU,GAAV,CAAV;;AACA,YAAIrN,GAAG,CAAC1G,MAAJ,GAAa,CAAjB,EAAoB;AAClBylD,UAAAA,MAAM,CAAC/vC,KAAK,CAAC3G,IAAN,CAAWrI,GAAG,CAAC,CAAD,CAAd,CAAD,CAAN,GAA6BgP,KAAK,CAAC3G,IAAN,CAAWrI,GAAG,CAAC,CAAD,CAAd,CAA7B;AACD,SAFD,MAEO;AACL++C,UAAAA,MAAM,CAAC/vC,KAAK,CAAC3G,IAAN,CAAWrI,GAAG,CAAC,CAAD,CAAd,CAAD,CAAN,GAA6BgP,KAAK,CAAC3G,IAAN,CAAWrI,GAAG,CAAC,CAAD,CAAd,CAA7B;AACD;AACF,OAPG,CAAJ;AAQD,KATD,MASO;AACL++C,MAAAA,MAAM,GAAG/jD,KAAT;AACD;;AACD,WAAO+jD,MAAP;AACD,GAfD;;AAgBA,MAAIggE,SAAS,GAAG,UAAU96G,CAAV,EAAa;AAC3B,WAAO,UAAUnJ,CAAV,EAAa;AAClB,aAAO6D,OAAO,CAAC7D,CAAD,CAAP,IAAcuC,MAAM,CAACvC,CAAD,EAAImJ,CAAJ,CAA3B;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIgtD,QAAQ,GAAG,UAAU3lC,MAAV,EAAkBlzB,IAAlB,EAAwB8hD,UAAxB,EAAoC57C,IAApC,EAA0C;AACvD,QAAItD,KAAK,GAAG5C,IAAI,IAAIkzB,MAAM,CAACM,QAAf,GAA0BN,MAAM,CAACM,QAAP,CAAgBxzB,IAAhB,CAA1B,GAAkD8hD,UAA9D;;AACA,QAAI57C,IAAI,KAAK,MAAb,EAAqB;AACnB,aAAOwgH,cAAc,CAAC9jH,KAAD,CAArB;AACD,KAFD,MAEO,IAAIsD,IAAI,KAAK,QAAb,EAAuB;AAC5B,aAAOugH,WAAW,CAACpgH,QAAD,EAAW6sB,MAAX,EAAmBlzB,IAAnB,CAAX,CAAoCsE,KAApC,CAA0Cw9C,UAA1C,CAAP;AACD,KAFM,MAEA,IAAI57C,IAAI,KAAK,QAAb,EAAuB;AAC5B,aAAOugH,WAAW,CAAC3/G,QAAD,EAAWosB,MAAX,EAAmBlzB,IAAnB,CAAX,CAAoCsE,KAApC,CAA0Cw9C,UAA1C,CAAP;AACD,KAFM,MAEA,IAAI57C,IAAI,KAAK,SAAb,EAAwB;AAC7B,aAAOugH,WAAW,CAAChgH,SAAD,EAAYysB,MAAZ,EAAoBlzB,IAApB,CAAX,CAAqCsE,KAArC,CAA2Cw9C,UAA3C,CAAP;AACD,KAFM,MAEA,IAAI57C,IAAI,KAAK,QAAb,EAAuB;AAC5B,aAAOugH,WAAW,CAACngH,QAAD,EAAW4sB,MAAX,EAAmBlzB,IAAnB,CAAX,CAAoCsE,KAApC,CAA0Cw9C,UAA1C,CAAP;AACD,KAFM,MAEA,IAAI57C,IAAI,KAAK,OAAb,EAAsB;AAC3B,aAAOugH,WAAW,CAAClgH,OAAD,EAAU2sB,MAAV,EAAkBlzB,IAAlB,CAAX,CAAmCsE,KAAnC,CAAyCw9C,UAAzC,CAAP;AACD,KAFM,MAEA,IAAI57C,IAAI,KAAK,UAAb,EAAyB;AAC9B,aAAOugH,WAAW,CAACE,SAAS,CAACtgH,QAAD,CAAV,EAAsB6sB,MAAtB,EAA8BlzB,IAA9B,CAAX,CAA+CsE,KAA/C,CAAqDw9C,UAArD,CAAP;AACD,KAFM,MAEA,IAAI57C,IAAI,KAAK,UAAb,EAAyB;AAC9B,aAAOugH,WAAW,CAAC5/G,UAAD,EAAaqsB,MAAb,EAAqBlzB,IAArB,CAAX,CAAsCsE,KAAtC,CAA4Cw9C,UAA5C,CAAP;AACD,KAFM,MAEA;AACL,aAAOl/C,KAAP;AACD;AACF,GArBD;;AAuBA,MAAIgkH,iBAAiB,GAAG,YAAY;AAClC,QAAIhvF,MAAM,GAAG,EAAb;;AACA,QAAI2I,GAAG,GAAG,UAAUx8B,EAAV,EAAc8iH,QAAd,EAAwB;AAChCjvF,MAAAA,MAAM,CAAC7zB,EAAD,CAAN,GAAa8iH,QAAb;AACD,KAFD;;AAGA,QAAIh+G,GAAG,GAAG,UAAU9E,EAAV,EAAc;AACtB,UAAI6zB,MAAM,CAAC7zB,EAAD,CAAV,EAAgB;AACd,eAAO6zB,MAAM,CAAC7zB,EAAD,CAAb;AACD;;AACD,aAAO;AAAE+iH,QAAAA,KAAK,EAAE;AAAT,OAAP;AACD,KALD;;AAMA,QAAIpiG,KAAK,GAAG,UAAU3gB,EAAV,EAAc;AACxB,aAAOqG,GAAG,CAACwtB,MAAD,EAAS7zB,EAAT,CAAV;AACD,KAFD;;AAGA,WAAO;AACLw8B,MAAAA,GAAG,EAAEA,GADA;AAEL13B,MAAAA,GAAG,EAAEA,GAFA;AAGLuB,MAAAA,GAAG,EAAEsa;AAHA,KAAP;AAKD,GAnBD;;AAoBA,MAAIqiG,WAAW,GAAGH,iBAAiB,EAAnC;;AAEA,MAAII,OAAO,GAAG,UAAUC,QAAV,EAAoBhhG,GAApB,EAAyB;AACrC,QAAI42E,MAAM,GAAG52E,GAAG,CAAC/N,GAAjB;AACA,WAAO2kF,MAAM,CAACoqB,QAAD,CAAb;AACD,GAHD;;AAIA,MAAIC,mBAAmB,GAAG,UAAUD,QAAV,EAAoBhhG,GAApB,EAAyB;AACjD,WAAOuY,QAAQ,CAACpZ,KAAK,CAACa,GAAD,EAAMghG,QAAN,CAAN,EAAuB,EAAvB,CAAf;AACD,GAFD;;AAGA,MAAIE,cAAc,GAAGrkH,KAAK,CAACkkH,OAAD,EAAU,aAAV,CAA1B;AACA,MAAII,eAAe,GAAGtkH,KAAK,CAACkkH,OAAD,EAAU,cAAV,CAA3B;AACA,MAAIK,YAAY,GAAGvkH,KAAK,CAACokH,mBAAD,EAAsB,YAAtB,CAAxB;AACA,MAAII,aAAa,GAAGxkH,KAAK,CAACokH,mBAAD,EAAsB,aAAtB,CAAzB;;AACA,MAAIK,uBAAuB,GAAG,UAAUthG,GAAV,EAAe;AAC3C,WAAOA,GAAG,CAAC/N,GAAJ,CAAQyH,qBAAR,EAAP;AACD,GAFD;;AAGA,MAAI6nG,0BAA0B,GAAG,UAAUC,OAAV,EAAmBz7E,OAAnB,EAA4BG,OAA5B,EAAqC;AACpE,QAAI1qB,WAAW,GAAG0lG,cAAc,CAACM,OAAD,CAAhC;AACA,QAAI/lG,YAAY,GAAG0lG,eAAe,CAACK,OAAD,CAAlC;AACA,WAAOz7E,OAAO,IAAI,CAAX,IAAgBG,OAAO,IAAI,CAA3B,IAAgCH,OAAO,IAAIvqB,WAA3C,IAA0D0qB,OAAO,IAAIzqB,YAA5E;AACD,GAJD;;AAKA,MAAIgmG,SAAS,GAAG,UAAUziF,MAAV,EAAkBhf,GAAlB,EAAuB+lB,OAAvB,EAAgCG,OAAhC,EAAyC;AACvD,QAAIynB,UAAU,GAAG2zD,uBAAuB,CAACthG,GAAD,CAAxC;AACA,QAAI+tD,MAAM,GAAG/uC,MAAM,GAAG2uB,UAAU,CAACv0C,IAAX,GAAkB4G,GAAG,CAAC/N,GAAJ,CAAQoI,UAA1B,GAAuCgnG,aAAa,CAACrhG,GAAD,CAAvD,GAA+D,CAAlF;AACA,QAAIguD,MAAM,GAAGhvC,MAAM,GAAG2uB,UAAU,CAACt0C,GAAX,GAAiB2G,GAAG,CAAC/N,GAAJ,CAAQmI,SAAzB,GAAqCgnG,YAAY,CAACphG,GAAD,CAApD,GAA4D,CAA/E;AACA,QAAIxmB,CAAC,GAAGusC,OAAO,GAAGgoC,MAAlB;AACA,QAAIlzE,CAAC,GAAGqrC,OAAO,GAAG8nC,MAAlB;AACA,WAAO;AACLx0E,MAAAA,CAAC,EAAEA,CADE;AAELqB,MAAAA,CAAC,EAAEA;AAFE,KAAP;AAID,GAVD;;AAWA,MAAI6mH,iBAAiB,GAAG,UAAUz0F,MAAV,EAAkB8Y,OAAlB,EAA2BG,OAA3B,EAAoC;AAC1D,QAAIs7E,OAAO,GAAGnvG,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAd;AACA,QAAIwnB,SAAS,GAAG5hD,MAAM,CAAC+R,MAAP,GAAgBwiF,OAAhB,GAA0BnsG,eAAe,CAACmsG,OAAD,CAAzD;AACA,QAAIG,eAAe,GAAGF,SAAS,CAACx0F,MAAM,CAAC+R,MAAR,EAAgB6vC,SAAhB,EAA2B9oC,OAA3B,EAAoCG,OAApC,CAA/B;AACA,WAAOq7E,0BAA0B,CAAC1yC,SAAD,EAAY8yC,eAAe,CAACnoH,CAA5B,EAA+BmoH,eAAe,CAAC9mH,CAA/C,CAAjC;AACD,GALD;;AAMA,MAAI+mH,WAAW,GAAG,UAAU/vG,IAAV,EAAgB;AAChC,WAAO/R,QAAQ,CAACD,IAAT,CAAcgS,IAAd,EAAoBjT,GAApB,CAAwByT,YAAY,CAACX,OAArC,CAAP;AACD,GAFD;;AAGA,MAAImwG,qBAAqB,GAAG,UAAU50F,MAAV,EAAkB;AAC5C,QAAI60F,YAAY,GAAG70F,MAAM,CAAC+R,MAAP,GAAgB/R,MAAM,CAACo6B,OAAP,EAAhB,GAAmCp6B,MAAM,CAAC80F,uBAAP,EAAtD;AACA,WAAOH,WAAW,CAACE,YAAD,CAAX,CAA0BljH,GAA1B,CAA8Bsa,MAA9B,EAAsC7a,KAAtC,CAA4C,KAA5C,CAAP;AACD,GAHD;;AAKA,MAAI2jH,uBAAuB,GAAG,YAAY;AACxC,QAAIC,aAAa,GAAG,YAAY;AAC9B,YAAM,IAAI3kH,KAAJ,CAAU,6DAAV,CAAN;AACD,KAFD;;AAGA,WAAO;AACLg1G,MAAAA,IAAI,EAAE2P,aADD;AAEL57F,MAAAA,KAAK,EAAE47F,aAFF;AAGLzoD,MAAAA,UAAU,EAAEyoD,aAHP;AAILC,MAAAA,OAAO,EAAED;AAJJ,KAAP;AAMD,GAVD;;AAYA,MAAIE,mBAAmB,GAAG,UAAUl1F,MAAV,EAAkB;AAC1C,QAAIm1F,aAAa,GAAG,EAApB;;AACA,QAAIC,iBAAiB,GAAG,YAAY;AAClC,UAAIrG,KAAK,GAAG/uF,MAAM,CAAC+uF,KAAnB;AACA,aAAOA,KAAK,IAAIA,KAAK,CAACsG,0BAAf,GAA4CtG,KAAK,CAACsG,0BAAN,EAA5C,GAAiFN,uBAAuB,EAA/G;AACD,KAHD;;AAIA,QAAIO,kBAAkB,GAAG,YAAY;AACnC,aAAOziH,QAAQ,CAACD,IAAT,CAAcuiH,aAAa,CAAC,CAAD,CAA3B,CAAP;AACD,KAFD;;AAGA,QAAIx2D,OAAO,GAAG,UAAUnvD,CAAV,EAAamD,CAAb,EAAgB;AAC5B,aAAOnD,CAAC,CAACwD,IAAF,KAAWL,CAAC,CAACK,IAAb,IAAqBxD,CAAC,CAACsV,IAAF,KAAWnS,CAAC,CAACmS,IAAlC,IAA0C,CAACtV,CAAC,CAAC+lH,WAA7C,IAA4D,CAAC/lH,CAAC,CAAC8lB,OAA/D,IAA0E,CAAC3iB,CAAC,CAAC4iH,WAA7E,IAA4F,CAAC5iH,CAAC,CAAC2iB,OAAtG;AACD,KAFD;;AAGA,QAAIi3C,UAAU,GAAG,YAAY;AAC3B,UAAI4oD,aAAa,CAACnnH,MAAd,GAAuB,CAA3B,EAA8B;AAC5BonH,QAAAA,iBAAiB,GAAG7oD,UAApB,CAA+B4oD,aAA/B;AACD;AACF,KAJD;;AAKA,QAAIK,eAAe,GAAG,UAAUC,YAAV,EAAwB;AAC5CN,MAAAA,aAAa,CAACnhH,IAAd,CAAmByhH,YAAnB;AACD,KAFD;;AAGA,QAAIC,iBAAiB,GAAG,UAAUD,YAAV,EAAwB;AAC9CxgH,MAAAA,SAAS,CAACkgH,aAAD,EAAgB,UAAUQ,iBAAV,EAA6B;AACpD,eAAOA,iBAAiB,KAAKF,YAA7B;AACD,OAFQ,CAAT,CAEG7jH,IAFH,CAEQ,UAAUkG,KAAV,EAAiB;AACvBq9G,QAAAA,aAAa,CAAClkF,MAAd,CAAqBn5B,KAArB,EAA4B,CAA5B;AACD,OAJD;AAKD,KAND;;AAOA,QAAIutG,IAAI,GAAG,UAAUuQ,IAAV,EAAgBC,SAAhB,EAA2B;AACpC,UAAIA,SAAS,KAAK,KAAK,CAAvB,EAA0B;AACxBA,QAAAA,SAAS,GAAG,IAAZ;AACD;;AACD,UAAI71F,MAAM,CAACC,OAAP,IAAkB,CAAC20F,qBAAqB,CAAC50F,MAAD,CAA5C,EAAsD;AACpD;AACD;;AACD,UAAI61F,SAAJ,EAAe;AACb71F,QAAAA,MAAM,CAACmb,IAAP,CAAY,wBAAZ,EAAsC;AAAEs6E,UAAAA,YAAY,EAAEG;AAAhB,SAAtC;AACD;;AACD,aAAO5gH,IAAI,CAACmgH,aAAD,EAAgB,UAAUM,YAAV,EAAwB;AACjD,eAAO92D,OAAO,CAACy2D,iBAAiB,GAAGH,OAApB,CAA4BQ,YAA5B,CAAD,EAA4CG,IAA5C,CAAd;AACD,OAFU,CAAJ,CAEJvkH,UAFI,CAEO,YAAY;AACxB2uB,QAAAA,MAAM,CAACmtD,aAAP,CAAqBE,SAArB,CAA+BrtD,MAA/B;AACA,YAAIy1F,YAAY,GAAGL,iBAAiB,GAAG/P,IAApB,CAAyBuQ,IAAzB,EAA+B,YAAY;AAC5DF,UAAAA,iBAAiB,CAACD,YAAD,CAAjB;AACAlpD,UAAAA,UAAU;AACV+oD,UAAAA,kBAAkB,GAAGtkH,IAArB,CAA0B,YAAY;AACpC,mBAAOgvB,MAAM,CAACskB,KAAP,EAAP;AACD,WAFD,EAEG,UAAUl4B,GAAV,EAAe;AAChB,mBAAOk4B,KAAK,CAACl/B,YAAY,CAACX,OAAb,CAAqB2H,GAAG,CAAC0pG,KAAJ,EAArB,CAAD,CAAZ;AACD,WAJD;AAKD,SARkB,CAAnB;AASAN,QAAAA,eAAe,CAACC,YAAD,CAAf;AACAlpD,QAAAA,UAAU;AACVvsC,QAAAA,MAAM,CAACmb,IAAP,CAAY,kBAAZ,EAAgC1iC,QAAQ,CAAC,EAAD,EAAKg9G,YAAL,CAAxC;AACA,eAAOA,YAAP;AACD,OAjBM,CAAP;AAkBD,KA5BD;;AA6BA,QAAIr8F,KAAK,GAAG,YAAY;AACtBk8F,MAAAA,kBAAkB,GAAG1jH,IAArB,CAA0B,UAAU6jH,YAAV,EAAwB;AAChDL,QAAAA,iBAAiB,GAAGh8F,KAApB,CAA0Bq8F,YAA1B;AACAC,QAAAA,iBAAiB,CAACD,YAAD,CAAjB;AACAlpD,QAAAA,UAAU;AACX,OAJD;AAKD,KAND;;AAOA,QAAIwpD,gBAAgB,GAAG,YAAY;AACjC,aAAOZ,aAAP;AACD,KAFD;;AAGA,QAAIjoC,cAAc,GAAG,UAAUltD,MAAV,EAAkB;AACrCA,MAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwB,YAAY;AAClC,YAAIkgG,cAAc,GAAGxtD,iBAAiB,CAACxoC,MAAD,CAAtC;;AACA,YAAIg2F,cAAJ,EAAoB;AAClB3Q,UAAAA,IAAI,CAAC;AACHvgG,YAAAA,IAAI,EAAEkxG,cADH;AAEHhjH,YAAAA,IAAI,EAAE,SAFH;AAGHsiB,YAAAA,OAAO,EAAE;AAHN,WAAD,EAID,KAJC,CAAJ;AAKD;AACF,OATD;AAUA0K,MAAAA,MAAM,CAAClK,EAAP,CAAU,sCAAV,EAAkD,YAAY;AAC5DgK,QAAAA,KAAK,CAACZ,qBAAN,CAA4BqtC,UAA5B;AACD,OAFD;AAGAvsC,MAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB,YAAY;AAC9BlkB,QAAAA,IAAI,CAACujH,aAAa,CAAC7nH,KAAd,EAAD,EAAwB,UAAUmoH,YAAV,EAAwB;AAClDL,UAAAA,iBAAiB,GAAGh8F,KAApB,CAA0Bq8F,YAA1B;AACD,SAFG,CAAJ;AAGD,OAJD;AAKD,KAnBD;;AAoBAvoC,IAAAA,cAAc,CAACltD,MAAD,CAAd;AACA,WAAO;AACLqlF,MAAAA,IAAI,EAAEA,IADD;AAELjsF,MAAAA,KAAK,EAAEA,KAFF;AAGL28F,MAAAA,gBAAgB,EAAEA;AAHb,KAAP;AAKD,GA5FD;;AA8FA,MAAIt9D,aAAa,GAAG5B,YAAY,CAAC4B,aAAjC;AAEA,MAAIC,YAAY,GAAG7B,YAAY,CAAC6B,YAAhC;;AAEA,WAASu9D,iBAAT,GAA8B;AAC5B,QAAIjB,aAAa,GAAG,YAAY;AAC9B,YAAM,IAAI3kH,KAAJ,CAAU,uDAAV,CAAN;AACD,KAFD;;AAGA,WAAO;AACLg1G,MAAAA,IAAI,EAAE2P,aADD;AAELkB,MAAAA,OAAO,EAAElB,aAFJ;AAGLmB,MAAAA,KAAK,EAAEnB,aAHF;AAILoB,MAAAA,OAAO,EAAEpB,aAJJ;AAKL57F,MAAAA,KAAK,EAAE47F,aALF;AAMLqB,MAAAA,SAAS,EAAErB,aANN;AAOLsB,MAAAA,SAAS,EAAEtB;AAPN,KAAP;AASD;;AAED,MAAIuB,aAAa,GAAG,UAAUv2F,MAAV,EAAkB;AACpC,QAAIw2F,OAAO,GAAG,EAAd;;AACA,QAAIpB,iBAAiB,GAAG,YAAY;AAClC,UAAIrG,KAAK,GAAG/uF,MAAM,CAAC+uF,KAAnB;AACA,aAAOA,KAAK,IAAIA,KAAK,CAAC0H,oBAAf,GAAsC1H,KAAK,CAAC0H,oBAAN,EAAtC,GAAqER,iBAAiB,EAA7F;AACD,KAHD;;AAIA,QAAIS,QAAQ,GAAG,UAAU1yG,KAAV,EAAiBtW,CAAjB,EAAoB;AACjC,aAAO,YAAY;AACjB,YAAIuB,IAAI,GAAG,EAAX;;AACA,aAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CD,UAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWC,SAAS,CAACD,EAAD,CAApB;AACD;;AACD,eAAOxB,CAAC,GAAGA,CAAC,CAAC0B,KAAF,CAAQ4U,KAAR,EAAe/U,IAAf,CAAH,GAA0BzC,SAAlC;AACD,OAND;AAOD,KARD;;AASA,QAAImqH,aAAa,GAAG,UAAUC,MAAV,EAAkB;AACpC52F,MAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ,EAA0B;AAAEy7E,QAAAA,MAAM,EAAEA;AAAV,OAA1B;AACD,KAFD;;AAGA,QAAIC,cAAc,GAAG,UAAUD,MAAV,EAAkB;AACrC52F,MAAAA,MAAM,CAACmb,IAAP,CAAY,aAAZ,EAA2B;AAAEy7E,QAAAA,MAAM,EAAEA;AAAV,OAA3B;AACD,KAFD;;AAGA,QAAIE,SAAS,GAAG,UAAUF,MAAV,EAAkB;AAChCJ,MAAAA,OAAO,CAACxiH,IAAR,CAAa4iH,MAAb;AACAD,MAAAA,aAAa,CAACC,MAAD,CAAb;AACD,KAHD;;AAIA,QAAIG,WAAW,GAAG,UAAUH,MAAV,EAAkB;AAClCC,MAAAA,cAAc,CAACD,MAAD,CAAd;AACAJ,MAAAA,OAAO,GAAGxkH,MAAM,CAACwkH,OAAD,EAAU,UAAUQ,WAAV,EAAuB;AAC/C,eAAOA,WAAW,KAAKJ,MAAvB;AACD,OAFe,CAAhB;;AAGA,UAAIJ,OAAO,CAACxoH,MAAR,KAAmB,CAAvB,EAA0B;AACxBgyB,QAAAA,MAAM,CAACskB,KAAP;AACD;AACF,KARD;;AASA,QAAI2yE,YAAY,GAAG,YAAY;AAC7B,aAAOpkH,QAAQ,CAACD,IAAT,CAAc4jH,OAAO,CAACA,OAAO,CAACxoH,MAAR,GAAiB,CAAlB,CAArB,CAAP;AACD,KAFD;;AAGA,QAAIkpH,2BAA2B,GAAG,UAAUC,UAAV,EAAsB;AACtDn3F,MAAAA,MAAM,CAACmtD,aAAP,CAAqBE,SAArB,CAA+BrtD,MAA/B;AACA6rD,MAAAA,KAAK,CAAC7rD,MAAD,CAAL;AACA,UAAI42F,MAAM,GAAGO,UAAU,EAAvB;AACAL,MAAAA,SAAS,CAACF,MAAD,CAAT;AACA,aAAOA,MAAP;AACD,KAND;;AAOA,QAAIvR,IAAI,GAAG,UAAUp2G,IAAV,EAAgB4uB,MAAhB,EAAwB;AACjC,aAAOq5F,2BAA2B,CAAC,YAAY;AAC7C,eAAO9B,iBAAiB,GAAG/P,IAApB,CAAyBp2G,IAAzB,EAA+B4uB,MAA/B,EAAuCk5F,WAAvC,CAAP;AACD,OAFiC,CAAlC;AAGD,KAJD;;AAKA,QAAIb,OAAO,GAAG,UAAUjnH,IAAV,EAAgB;AAC5B,aAAOioH,2BAA2B,CAAC,YAAY;AAC7C,eAAO9B,iBAAiB,GAAGc,OAApB,CAA4BjnH,IAA5B,EAAkC8nH,WAAlC,CAAP;AACD,OAFiC,CAAlC;AAGD,KAJD;;AAKA,QAAIZ,KAAK,GAAG,UAAU15F,OAAV,EAAmB9kB,QAAnB,EAA6BqM,KAA7B,EAAoC;AAC9C,UAAIozG,iBAAiB,GAAGhC,iBAAiB,EAAzC;AACAgC,MAAAA,iBAAiB,CAACjB,KAAlB,CAAwB15F,OAAxB,EAAiCi6F,QAAQ,CAAC1yG,KAAK,GAAGA,KAAH,GAAWozG,iBAAjB,EAAoCz/G,QAApC,CAAzC;AACD,KAHD;;AAIA,QAAIy+G,OAAO,GAAG,UAAU35F,OAAV,EAAmB9kB,QAAnB,EAA6BqM,KAA7B,EAAoC;AAChD,UAAIozG,iBAAiB,GAAGhC,iBAAiB,EAAzC;AACAgC,MAAAA,iBAAiB,CAAChB,OAAlB,CAA0B35F,OAA1B,EAAmCi6F,QAAQ,CAAC1yG,KAAK,GAAGA,KAAH,GAAWozG,iBAAjB,EAAoCz/G,QAApC,CAA3C;AACD,KAHD;;AAIA,QAAIyhB,KAAK,GAAG,YAAY;AACtB69F,MAAAA,YAAY,GAAGrlH,IAAf,CAAoB,UAAUglH,MAAV,EAAkB;AACpCxB,QAAAA,iBAAiB,GAAGh8F,KAApB,CAA0Bw9F,MAA1B;AACAG,QAAAA,WAAW,CAACH,MAAD,CAAX;AACD,OAHD;AAID,KALD;;AAMA52F,IAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB,YAAY;AAC9BlkB,MAAAA,IAAI,CAAC4kH,OAAD,EAAU,UAAUI,MAAV,EAAkB;AAC9BxB,QAAAA,iBAAiB,GAAGh8F,KAApB,CAA0Bw9F,MAA1B;AACD,OAFG,CAAJ;AAGD,KAJD;AAKA,WAAO;AACLvR,MAAAA,IAAI,EAAEA,IADD;AAEL6Q,MAAAA,OAAO,EAAEA,OAFJ;AAGLC,MAAAA,KAAK,EAAEA,KAHF;AAILC,MAAAA,OAAO,EAAEA,OAJJ;AAKLh9F,MAAAA,KAAK,EAAEA;AALF,KAAP;AAOD,GAhFD;;AAkFA,MAAIi+F,mBAAmB,GAAG,UAAUr3F,MAAV,EAAkBvD,OAAlB,EAA2B;AACnDuD,IAAAA,MAAM,CAACs3F,mBAAP,CAA2BjS,IAA3B,CAAgC;AAC9BryG,MAAAA,IAAI,EAAE,OADwB;AAE9B8R,MAAAA,IAAI,EAAE2X;AAFwB,KAAhC;AAID,GALD;;AAMA,MAAI86F,YAAY,GAAG,UAAUv3F,MAAV,EAAkBvD,OAAlB,EAA2B;AAC5C,QAAIuD,MAAM,CAACw3F,WAAX,EAAwB;AACtBH,MAAAA,mBAAmB,CAACr3F,MAAD,EAASvD,OAAT,CAAnB;AACD,KAFD,MAEO;AACLuD,MAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwB,YAAY;AAClCuhG,QAAAA,mBAAmB,CAACr3F,MAAD,EAASvD,OAAT,CAAnB;AACD,OAFD;AAGD;AACF,GARD;;AASA,MAAIg7F,WAAW,GAAG,UAAUz3F,MAAV,EAAkBvD,OAAlB,EAA2B;AAC3C86F,IAAAA,YAAY,CAACv3F,MAAD,EAAS42B,IAAI,CAACvqC,SAAL,CAAe,CAClC,6BADkC,EAElCoQ,OAFkC,CAAf,CAAT,CAAZ;AAID,GALD;;AAMA,MAAIi7F,QAAQ,GAAG,UAAU13F,MAAV,EAAkBo9C,SAAlB,EAA6BhtE,GAA7B,EAAkC;AAC/C+sE,IAAAA,SAAS,CAACn9C,MAAD,EAASo9C,SAAT,EAAoB;AAAE3gD,MAAAA,OAAO,EAAErsB;AAAX,KAApB,CAAT;AACAmU,IAAAA,OAAO,CAACC,KAAR,CAAcpU,GAAd;AACD,GAHD;;AAIA,MAAIunH,eAAe,GAAG,UAAU3kH,IAAV,EAAgByQ,GAAhB,EAAqB3W,IAArB,EAA2B;AAC/C,WAAOA,IAAI,GAAG,oBAAoBkG,IAApB,GAA2B,IAA3B,GAAkClG,IAAlC,GAAyC,YAAzC,GAAwD2W,GAA3D,GAAiE,oBAAoBzQ,IAApB,GAA2B,QAA3B,GAAsCyQ,GAAlH;AACD,GAFD;;AAGA,MAAIm0G,eAAe,GAAG,UAAU53F,MAAV,EAAkBvc,GAAlB,EAAuB3W,IAAvB,EAA6B;AACjD4qH,IAAAA,QAAQ,CAAC13F,MAAD,EAAS,iBAAT,EAA4B23F,eAAe,CAAC,QAAD,EAAWl0G,GAAX,EAAgB3W,IAAhB,CAA3C,CAAR;AACD,GAFD;;AAGA,MAAI+qH,cAAc,GAAG,UAAU73F,MAAV,EAAkBvc,GAAlB,EAAuB3W,IAAvB,EAA6B;AAChD4qH,IAAAA,QAAQ,CAAC13F,MAAD,EAAS,gBAAT,EAA2B23F,eAAe,CAAC,OAAD,EAAUl0G,GAAV,EAAe3W,IAAf,CAA1C,CAAR;AACD,GAFD;;AAGA,MAAIgrH,iBAAiB,GAAG,UAAU93F,MAAV,EAAkBvc,GAAlB,EAAuB3W,IAAvB,EAA6B;AACnD4qH,IAAAA,QAAQ,CAAC13F,MAAD,EAAS,mBAAT,EAA8B23F,eAAe,CAAC,UAAD,EAAal0G,GAAb,EAAkB3W,IAAlB,CAA7C,CAAR;AACD,GAFD;;AAGA,MAAIirH,eAAe,GAAG,UAAU/3F,MAAV,EAAkBlzB,IAAlB,EAAwB4rB,GAAxB,EAA6B;AACjD,QAAI+D,OAAO,GAAGm6B,IAAI,CAACvqC,SAAL,CAAe,CAC3B,kCAD2B,EAE3Bvf,IAF2B,CAAf,CAAd;AAIAqwE,IAAAA,SAAS,CAACn9C,MAAD,EAAS,iBAAT,EAA4B;AAAEvD,MAAAA,OAAO,EAAEA;AAAX,KAA5B,CAAT;AACAu7F,IAAAA,SAAS,CAACv7F,OAAD,EAAU/D,GAAV,CAAT;AACA6+F,IAAAA,YAAY,CAACv3F,MAAD,EAASvD,OAAT,CAAZ;AACD,GARD;;AASA,MAAIu7F,SAAS,GAAG,UAAUv7F,OAAV,EAAmB;AACjC,QAAIlwB,CAAC,GAAG,EAAR;;AACA,SAAK,IAAI2C,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5C3C,MAAAA,CAAC,CAAC2C,EAAE,GAAG,CAAN,CAAD,GAAYC,SAAS,CAACD,EAAD,CAArB;AACD;;AACD,QAAIqV,OAAO,GAAG1E,MAAM,CAAC0E,OAArB;;AACA,QAAIA,OAAJ,EAAa;AACX,UAAIA,OAAO,CAACC,KAAZ,EAAmB;AACjBD,QAAAA,OAAO,CAACC,KAAR,CAAcpV,KAAd,CAAoBmV,OAApB,EAA6BvL,cAAc,CAAC,CAACyjB,OAAD,CAAD,EAAYlwB,CAAZ,CAA3C;AACD,OAFD,MAEO;AACLgY,QAAAA,OAAO,CAACoZ,GAAR,CAAYvuB,KAAZ,CAAkBmV,OAAlB,EAA2BvL,cAAc,CAAC,CAACyjB,OAAD,CAAD,EAAYlwB,CAAZ,CAAzC;AACD;AACF;AACF,GAbD;;AAeA,MAAI0rH,oBAAoB,GAAG,UAAUx0G,GAAV,EAAe;AACxC,WAAO,iBAAiB5J,IAAjB,CAAsB4J,GAAtB,CAAP;AACD,GAFD;;AAGA,MAAIy0G,iBAAiB,GAAG,UAAUl4F,MAAV,EAAkB;AACxC,WAAOm4F,eAAe,CAACn4F,MAAD,EAAS6nC,aAAa,CAAC7nC,MAAD,CAAtB,CAAtB;AACD,GAFD;;AAGA,MAAIo4F,cAAc,GAAG,UAAUp4F,MAAV,EAAkB;AACrC,WAAOm4F,eAAe,CAACn4F,MAAD,EAAS+nC,UAAU,CAAC/nC,MAAD,CAAnB,CAAtB;AACD,GAFD;;AAGA,MAAIm4F,eAAe,GAAG,UAAUn4F,MAAV,EAAkBq4F,QAAlB,EAA4B;AAChD,QAAIC,OAAO,GAAGt4F,MAAM,CAACmtD,aAAP,CAAqB50B,OAArB,GAA+B,gBAA7C;AACA,QAAI3iB,MAAM,GAAG5V,MAAM,CAACmtD,aAAP,CAAqBv3C,MAAlC;AACA,QAAI2iF,cAAc,GAAG,YAAY3iF,MAAZ,GAAqB,MAA1C;AACA,QAAI7D,MAAM,GAAG/R,MAAM,CAAC+R,MAAP,KAAkB,IAA/B;AACA,WAAOpgC,GAAG,CAAC0mH,QAAD,EAAW,UAAU50G,GAAV,EAAe;AAClC,UAAIw0G,oBAAoB,CAACx0G,GAAD,CAApB,IAA6B,CAACsuB,MAAlC,EAA0C;AACxC,eAAOumF,OAAO,GAAG,GAAV,GAAgB70G,GAAhB,GAAsB,GAAtB,GAA4B80G,cAAnC;AACD,OAFD,MAEO;AACL,eAAOv4F,MAAM,CAACw4F,eAAP,CAAuBC,UAAvB,CAAkCh1G,GAAlC,CAAP;AACD;AACF,KANS,CAAV;AAOD,GAZD;;AAaA,MAAIi1G,4BAA4B,GAAG,UAAU14F,MAAV,EAAkB;AACnDA,IAAAA,MAAM,CAAC24F,UAAP,GAAoB34F,MAAM,CAAC24F,UAAP,CAAkB1oH,MAAlB,CAAyBioH,iBAAiB,CAACl4F,MAAD,CAA1C,EAAoDo4F,cAAc,CAACp4F,MAAD,CAAlE,CAApB;AACD,GAFD;;AAIA,MAAI44F,YAAY,GAAG,YAAY;AAC7B,QAAIC,OAAO,GAAG,CAAd;AAAA,QAAiBC,QAAQ,GAAG,CAA5B;AACA,QAAIC,eAAe,GAAG,EAAtB;;AACA,QAAIC,YAAY,GAAG,UAAUv3F,MAAV,EAAkBw3F,SAAlB,EAA6B;AAC9C,aAAO;AACLx3F,QAAAA,MAAM,EAAEA,MADH;AAELw3F,QAAAA,SAAS,EAAEA;AAFN,OAAP;AAID,KALD;;AAMA,QAAIC,UAAU,GAAG,UAAUvQ,OAAV,EAAmB;AAClC,aAAOA,OAAO,IAAIoQ,eAAlB;AACD,KAFD;;AAGA,QAAII,YAAY,GAAG,UAAUxQ,OAAV,EAAmB;AACpC,UAAItqF,MAAM,GAAG06F,eAAe,CAACpQ,OAAD,CAA5B;AACA,aAAOtqF,MAAM,GAAGA,MAAM,CAAC46F,SAAV,GAAsB,IAAnC;AACD,KAHD;;AAIA,QAAIG,SAAS,GAAG,UAAUzQ,OAAV,EAAmB;AACjC,aAAOuQ,UAAU,CAACvQ,OAAD,CAAV,GAAsBoQ,eAAe,CAACpQ,OAAD,CAAf,CAAyBlnF,MAAzB,KAAoCo3F,OAA1D,GAAoE,KAA3E;AACD,KAFD;;AAGA,QAAIzR,UAAU,GAAG,UAAUuB,OAAV,EAAmB;AAClC,aAAOuQ,UAAU,CAACvQ,OAAD,CAAV,GAAsBoQ,eAAe,CAACpQ,OAAD,CAAf,CAAyBlnF,MAAzB,KAAoCq3F,QAA1D,GAAqE,KAA5E;AACD,KAFD;;AAGA,QAAIO,WAAW,GAAG,UAAU1Q,OAAV,EAAmB;AACnCoQ,MAAAA,eAAe,CAACpQ,OAAD,CAAf,GAA2BqQ,YAAY,CAACH,OAAD,EAAU,IAAV,CAAvC;AACD,KAFD;;AAGA,QAAIS,YAAY,GAAG,UAAU3Q,OAAV,EAAmBsQ,SAAnB,EAA8B;AAC/CF,MAAAA,eAAe,CAACpQ,OAAD,CAAf,GAA2BqQ,YAAY,CAACF,QAAD,EAAWG,SAAX,CAAvC;AACD,KAFD;;AAGA,QAAIM,YAAY,GAAG,UAAU5Q,OAAV,EAAmB;AACpC,aAAOoQ,eAAe,CAACpQ,OAAD,CAAtB;AACD,KAFD;;AAGA,QAAIrtE,OAAO,GAAG,YAAY;AACxBy9E,MAAAA,eAAe,GAAG,EAAlB;AACD,KAFD;;AAGA,WAAO;AACLG,MAAAA,UAAU,EAAEA,UADP;AAELC,MAAAA,YAAY,EAAEA,YAFT;AAGLC,MAAAA,SAAS,EAAEA,SAHN;AAILhS,MAAAA,UAAU,EAAEA,UAJP;AAKLiS,MAAAA,WAAW,EAAEA,WALR;AAMLC,MAAAA,YAAY,EAAEA,YANT;AAOLC,MAAAA,YAAY,EAAEA,YAPT;AAQLj+E,MAAAA,OAAO,EAAEA;AARJ,KAAP;AAUD,GA5CD;;AA8CA,MAAIk+E,OAAO,GAAG,CAAd;;AACA,MAAIh6E,IAAI,GAAG,YAAY;AACrB,QAAIi6E,GAAG,GAAG,YAAY;AACpB,aAAO/qG,IAAI,CAAC4vC,KAAL,CAAW5vC,IAAI,CAAC25B,MAAL,KAAgB,UAA3B,EAAuCj2C,QAAvC,CAAgD,EAAhD,CAAP;AACD,KAFD;;AAGA,QAAI4vB,GAAG,GAAG,IAAID,IAAJ,GAAW06B,OAAX,EAAV;AACA,WAAO,MAAMz6B,GAAG,CAAC5vB,QAAJ,CAAa,EAAb,CAAN,GAAyBqnH,GAAG,EAA5B,GAAiCA,GAAG,EAApC,GAAyCA,GAAG,EAAnD;AACD,GAND;;AAOA,MAAIC,IAAI,GAAG,UAAU/8G,MAAV,EAAkB;AAC3B,WAAOA,MAAM,GAAG68G,OAAO,EAAhB,GAAqBh6E,IAAI,EAAhC;AACD,GAFD;;AAIA,MAAIm6E,SAAS,GAAG,YAAY;AAC1B,QAAIp+F,KAAK,GAAG,EAAZ;;AACA,QAAIq+F,SAAS,GAAG,UAAUC,IAAV,EAAgB;AAC9B,UAAIC,KAAK,GAAG;AACV,sBAAc,KADJ;AAEV,qBAAa,KAFH;AAGV,qBAAa,KAHH;AAIV,qBAAa,KAJH;AAKV,sBAAc,MALJ;AAMV,sBAAc,MANJ;AAOV,yBAAiB,KAPP;AAQV,sBAAc,MARJ;AASV,qBAAa,KATH;AAUV,sBAAc;AAVJ,OAAZ;AAYA,aAAOA,KAAK,CAACD,IAAI,CAACx+G,WAAL,EAAD,CAAL,IAA6B,KAApC;AACD,KAdD;;AAeA,QAAI6G,MAAM,GAAG,UAAUxR,CAAV,EAAaw1G,IAAb,EAAmBO,MAAnB,EAA2B35G,IAA3B,EAAiCitH,QAAjC,EAA2C;AACtD,UAAI5mH,QAAQ,CAACzC,CAAD,CAAZ,EAAiB;AACf,YAAIG,EAAE,GAAGH,CAAT;AACA,eAAOspH,UAAU,CAAC;AAChBnpH,UAAAA,EAAE,EAAEA,EADY;AAEhB/D,UAAAA,IAAI,EAAEA,IAFU;AAGhBitH,UAAAA,QAAQ,EAAEA,QAHM;AAIhB7T,UAAAA,IAAI,EAAEA,IAJU;AAKhBO,UAAAA,MAAM,EAAEA;AALQ,SAAD,CAAjB;AAOD,OATD,MASO,IAAIrzG,QAAQ,CAAC1C,CAAD,CAAZ,EAAiB;AACtB,eAAOspH,UAAU,CAACtpH,CAAD,CAAjB;AACD,OAFM,MAEA;AACL,cAAM,IAAIL,KAAJ,CAAU,oBAAV,CAAN;AACD;AACF,KAfD;;AAgBA,QAAI2pH,UAAU,GAAG,UAAUtpH,CAAV,EAAa;AAC5B,UAAI,CAACA,CAAC,CAACw1G,IAAH,IAAW,CAACx1G,CAAC,CAAC+1G,MAAlB,EAA0B;AACxB,cAAM,IAAIp2G,KAAJ,CAAU,sFAAV,CAAN;AACD;;AACD,UAAIQ,EAAE,GAAGH,CAAC,CAACG,EAAF,IAAQ6oH,IAAI,CAAC,QAAD,CAArB;AACA,UAAI5sH,IAAI,GAAG4D,CAAC,CAAC5D,IAAF,IAAU+D,EAArB;AACA,UAAIq1G,IAAI,GAAGx1G,CAAC,CAACw1G,IAAb;AACA,aAAO;AACLr1G,QAAAA,EAAE,EAAEpB,QAAQ,CAACoB,EAAD,CADP;AAEL/D,QAAAA,IAAI,EAAE2C,QAAQ,CAAC3C,IAAD,CAFT;AAGLitH,QAAAA,QAAQ,EAAEtqH,QAAQ,CAACiB,CAAC,CAACqpH,QAAF,IAAcjtH,IAAI,GAAG,GAAP,GAAa8sH,SAAS,CAAC1T,IAAI,CAAClzG,IAAN,CAArC,CAHb;AAILkzG,QAAAA,IAAI,EAAEz2G,QAAQ,CAACy2G,IAAD,CAJT;AAKLO,QAAAA,MAAM,EAAEh3G,QAAQ,CAACiB,CAAC,CAAC+1G,MAAH,CALX;AAMLkC,QAAAA,OAAO,EAAEl5G,QAAQ,CAACiB,CAAC,CAACi4G,OAAF,IAAaroG,GAAG,CAACC,eAAJ,CAAoB2lG,IAApB,CAAd,CANZ;AAOLx1B,QAAAA,GAAG,EAAEjhF,QAAQ,CAACiB,CAAC,CAACggF,GAAH;AAPR,OAAP;AASD,KAhBD;;AAiBA,QAAIrjD,GAAG,GAAG,UAAUq5E,QAAV,EAAoB;AAC5B,UAAI,CAAC/wG,GAAG,CAAC+wG,QAAQ,CAAC71G,EAAT,EAAD,CAAR,EAAyB;AACvB0qB,QAAAA,KAAK,CAACvnB,IAAN,CAAW0yG,QAAX;AACD;AACF,KAJD;;AAKA,QAAIuT,SAAS,GAAG,UAAU1hH,SAAV,EAAqB;AACnC,aAAOvD,IAAI,CAACumB,KAAD,EAAQhjB,SAAR,CAAJ,CAAuB/G,cAAvB,EAAP;AACD,KAFD;;AAGA,QAAImE,GAAG,GAAG,UAAU9E,EAAV,EAAc;AACtB,aAAOopH,SAAS,CAAC,UAAUC,cAAV,EAA0B;AACzC,eAAOA,cAAc,CAACrpH,EAAf,OAAwBA,EAA/B;AACD,OAFe,CAAhB;AAGD,KAJD;;AAKA,QAAI81G,QAAQ,GAAG,UAAUgC,OAAV,EAAmB;AAChC,aAAOsR,SAAS,CAAC,UAAUvT,QAAV,EAAoB;AACnC,eAAOA,QAAQ,CAACiC,OAAT,OAAuBA,OAA9B;AACD,OAFe,CAAhB;AAGD,KAJD;;AAKA,QAAI7B,SAAS,GAAG,UAAUL,MAAV,EAAkBzzG,IAAlB,EAAwB;AACtC,aAAOinH,SAAS,CAAC,UAAUvT,QAAV,EAAoB;AACnC,eAAOA,QAAQ,CAACD,MAAT,OAAsBA,MAAtB,IAAgCC,QAAQ,CAACR,IAAT,GAAgBlzG,IAAhB,KAAyBA,IAAhE;AACD,OAFe,CAAhB;AAGD,KAJD;;AAKA,QAAImnH,WAAW,GAAG,UAAUxR,OAAV,EAAmB;AACnCptF,MAAAA,KAAK,GAAGvpB,MAAM,CAACupB,KAAD,EAAQ,UAAUmrF,QAAV,EAAoB;AACxC,YAAIA,QAAQ,CAACiC,OAAT,OAAuBA,OAA3B,EAAoC;AAClCroG,UAAAA,GAAG,CAAC85G,eAAJ,CAAoB1T,QAAQ,CAACiC,OAAT,EAApB;AACA,iBAAO,KAAP;AACD;;AACD,eAAO,IAAP;AACD,OANa,CAAd;AAOD,KARD;;AASA,QAAIrtE,OAAO,GAAG,YAAY;AACxB1pC,MAAAA,IAAI,CAAC2pB,KAAD,EAAQ,UAAU2+F,cAAV,EAA0B;AACpC55G,QAAAA,GAAG,CAAC85G,eAAJ,CAAoBF,cAAc,CAACvR,OAAf,EAApB;AACD,OAFG,CAAJ;AAGAptF,MAAAA,KAAK,GAAG,EAAR;AACD,KALD;;AAMA,WAAO;AACLrZ,MAAAA,MAAM,EAAEA,MADH;AAELmrB,MAAAA,GAAG,EAAEA,GAFA;AAGL13B,MAAAA,GAAG,EAAEA,GAHA;AAILgxG,MAAAA,QAAQ,EAAEA,QAJL;AAKLG,MAAAA,SAAS,EAAEA,SALN;AAMLmT,MAAAA,SAAS,EAAEA,SANN;AAOLE,MAAAA,WAAW,EAAEA,WAPR;AAQL7+E,MAAAA,OAAO,EAAEA;AARJ,KAAP;AAUD,GAlGD;;AAoGA,MAAI++E,QAAQ,GAAG,UAAUpT,YAAV,EAAwB3mF,QAAxB,EAAkC;AAC/C,QAAIg6F,eAAe,GAAG,EAAtB;;AACA,QAAIC,QAAQ,GAAG,UAAUC,KAAV,EAAiBC,KAAjB,EAAwB;AACrC,UAAID,KAAJ,EAAW;AACT,eAAOA,KAAK,CAACx/G,OAAN,CAAc,KAAd,EAAqB,EAArB,IAA2B,GAA3B,GAAiCy/G,KAAK,CAACz/G,OAAN,CAAc,KAAd,EAAqB,EAArB,CAAxC;AACD;;AACD,aAAOy/G,KAAP;AACD,KALD;;AAMA,QAAIC,cAAc,GAAG,UAAUhU,QAAV,EAAoBtlF,OAApB,EAA6BC,OAA7B,EAAsCs5F,QAAtC,EAAgD;AACnE,UAAIC,GAAG,GAAG,IAAIxV,cAAJ,EAAV;AACAwV,MAAAA,GAAG,CAACvV,IAAJ,CAAS,MAAT,EAAiB/kF,QAAQ,CAAC7c,GAA1B;AACAm3G,MAAAA,GAAG,CAACC,eAAJ,GAAsBv6F,QAAQ,CAACw6F,WAA/B;;AACAF,MAAAA,GAAG,CAACG,MAAJ,CAAWC,UAAX,GAAwB,UAAUniH,CAAV,EAAa;AACnC8hH,QAAAA,QAAQ,CAAC9hH,CAAC,CAACoiH,MAAF,GAAWpiH,CAAC,CAACqiH,KAAb,GAAqB,GAAtB,CAAR;AACD,OAFD;;AAGAN,MAAAA,GAAG,CAACj5F,OAAJ,GAAc,YAAY;AACxBN,QAAAA,OAAO,CAAC,6DAA6Du5F,GAAG,CAACn5F,MAAlE,CAAP;AACD,OAFD;;AAGAm5F,MAAAA,GAAG,CAACl5F,MAAJ,GAAa,YAAY;AACvB,YAAIk5F,GAAG,CAACn5F,MAAJ,GAAa,GAAb,IAAoBm5F,GAAG,CAACn5F,MAAJ,IAAc,GAAtC,EAA2C;AACzCJ,UAAAA,OAAO,CAAC,iBAAiBu5F,GAAG,CAACn5F,MAAtB,CAAP;AACA;AACD;;AACD,YAAI05F,IAAI,GAAGC,IAAI,CAAC/lF,KAAL,CAAWulF,GAAG,CAACS,YAAf,CAAX;;AACA,YAAI,CAACF,IAAD,IAAS,OAAOA,IAAI,CAAC92E,QAAZ,KAAyB,QAAtC,EAAgD;AAC9ChjB,UAAAA,OAAO,CAAC,mBAAmBu5F,GAAG,CAACS,YAAxB,CAAP;AACA;AACD;;AACDj6F,QAAAA,OAAO,CAACm5F,QAAQ,CAACj6F,QAAQ,CAACg7F,QAAV,EAAoBH,IAAI,CAAC92E,QAAzB,CAAT,CAAP;AACD,OAXD;;AAYA,UAAIk3E,QAAQ,GAAG,IAAIC,QAAJ,EAAf;AACAD,MAAAA,QAAQ,CAACrwG,MAAT,CAAgB,MAAhB,EAAwBw7F,QAAQ,CAACR,IAAT,EAAxB,EAAyCQ,QAAQ,CAACqT,QAAT,EAAzC;AACAa,MAAAA,GAAG,CAACpV,IAAJ,CAAS+V,QAAT;AACD,KAzBD;;AA0BA,QAAIE,QAAQ,GAAG,YAAY;AACzB,aAAO,IAAIz8F,UAAJ,CAAe,UAAUjc,OAAV,EAAmB;AACvCA,QAAAA,OAAO,CAAC,EAAD,CAAP;AACD,OAFM,CAAP;AAGD,KAJD;;AAKA,QAAI24G,cAAc,GAAG,UAAUhV,QAAV,EAAoBjjG,GAApB,EAAyB;AAC5C,aAAO;AACLA,QAAAA,GAAG,EAAEA,GADA;AAELijG,QAAAA,QAAQ,EAAEA,QAFL;AAGLjlF,QAAAA,MAAM,EAAE;AAHH,OAAP;AAKD,KAND;;AAOA,QAAIk6F,cAAc,GAAG,UAAUjV,QAAV,EAAoBjqF,OAApB,EAA6Bm/F,OAA7B,EAAsC;AACzD,aAAO;AACLn4G,QAAAA,GAAG,EAAE,EADA;AAELijG,QAAAA,QAAQ,EAAEA,QAFL;AAGLjlF,QAAAA,MAAM,EAAE,KAHH;AAILjd,QAAAA,KAAK,EAAE;AACLiY,UAAAA,OAAO,EAAEA,OADJ;AAELm/F,UAAAA,OAAO,EAAEA;AAFJ;AAJF,OAAP;AASD,KAVD;;AAWA,QAAIC,cAAc,GAAG,UAAUlT,OAAV,EAAmBtqF,MAAnB,EAA2B;AAC9C3a,MAAAA,KAAK,CAAC9R,IAAN,CAAW0oH,eAAe,CAAC3R,OAAD,CAA1B,EAAqC,UAAU5lG,OAAV,EAAmB;AACtDA,QAAAA,OAAO,CAACsb,MAAD,CAAP;AACD,OAFD;AAGA,aAAOi8F,eAAe,CAAC3R,OAAD,CAAtB;AACD,KALD;;AAMA,QAAImT,cAAc,GAAG,UAAUpV,QAAV,EAAoBhvB,OAApB,EAA6BqkC,gBAA7B,EAA+C;AAClE9U,MAAAA,YAAY,CAACoS,WAAb,CAAyB3S,QAAQ,CAACiC,OAAT,EAAzB;AACA,aAAO,IAAI3pF,UAAJ,CAAe,UAAUjc,OAAV,EAAmB;AACvC,YAAI0yG,YAAJ,EAAkBkF,QAAlB;;AACA,YAAI;AACF,cAAIqB,mBAAmB,GAAG,YAAY;AACpC,gBAAIvG,YAAJ,EAAkB;AAChBA,cAAAA,YAAY,CAACr8F,KAAb;AACAuhG,cAAAA,QAAQ,GAAG9rH,IAAX;AACD;AACF,WALD;;AAMA,cAAIuyB,OAAO,GAAG,UAAU3d,GAAV,EAAe;AAC3Bu4G,YAAAA,mBAAmB;AACnB/U,YAAAA,YAAY,CAACqS,YAAb,CAA0B5S,QAAQ,CAACiC,OAAT,EAA1B,EAA8CllG,GAA9C;AACAo4G,YAAAA,cAAc,CAACnV,QAAQ,CAACiC,OAAT,EAAD,EAAqB+S,cAAc,CAAChV,QAAD,EAAWjjG,GAAX,CAAnC,CAAd;AACAV,YAAAA,OAAO,CAAC24G,cAAc,CAAChV,QAAD,EAAWjjG,GAAX,CAAf,CAAP;AACD,WALD;;AAMA,cAAI4d,OAAO,GAAG,UAAU7c,KAAV,EAAiBo3G,OAAjB,EAA0B;AACtC,gBAAIK,cAAc,GAAGL,OAAO,GAAGA,OAAH,GAAa,EAAzC;AACAI,YAAAA,mBAAmB;AACnB/U,YAAAA,YAAY,CAACsS,YAAb,CAA0B7S,QAAQ,CAACiC,OAAT,EAA1B;AACAkT,YAAAA,cAAc,CAACnV,QAAQ,CAACiC,OAAT,EAAD,EAAqBgT,cAAc,CAACjV,QAAD,EAAWliG,KAAX,EAAkBy3G,cAAlB,CAAnC,CAAd;AACAl5G,YAAAA,OAAO,CAAC44G,cAAc,CAACjV,QAAD,EAAWliG,KAAX,EAAkBy3G,cAAlB,CAAf,CAAP;AACD,WAND;;AAOAtB,UAAAA,QAAQ,GAAG,UAAUuB,OAAV,EAAmB;AAC5B,gBAAIA,OAAO,GAAG,CAAV,IAAeA,OAAO,GAAG,GAA7B,EAAkC;AAChC;AACD;;AACDrpH,YAAAA,QAAQ,CAACD,IAAT,CAAc6iH,YAAd,EAA4B/jH,OAA5B,CAAoC,YAAY;AAC9C,qBAAOmB,QAAQ,CAACD,IAAT,CAAcmpH,gBAAd,EAAgCpqH,GAAhC,CAAoCvC,KAApC,CAAP;AACD,aAFD,EAEGwC,IAFH,CAEQ,UAAUd,CAAV,EAAa;AACnB2kH,cAAAA,YAAY,GAAG3kH,CAAf;AACAA,cAAAA,CAAC,CAACykH,WAAF,CAAc7lH,KAAd,CAAoBwsH,OAApB;AACD,aALD;AAMD,WAVD;;AAWAxkC,UAAAA,OAAO,CAACgvB,QAAD,EAAWtlF,OAAX,EAAoBC,OAApB,EAA6Bs5F,QAA7B,CAAP;AACD,SAhCD,CAgCE,OAAOviG,EAAP,EAAW;AACXrV,UAAAA,OAAO,CAAC44G,cAAc,CAACjV,QAAD,EAAWtuF,EAAE,CAACqE,OAAd,EAAuB,EAAvB,CAAf,CAAP;AACD;AACF,OArCM,CAAP;AAsCD,KAxCD;;AAyCA,QAAI0/F,gBAAgB,GAAG,UAAUzkC,OAAV,EAAmB;AACxC,aAAOA,OAAO,KAAKgjC,cAAnB;AACD,KAFD;;AAGA,QAAI0B,qBAAqB,GAAG,UAAU1V,QAAV,EAAoB;AAC9C,UAAIiC,OAAO,GAAGjC,QAAQ,CAACiC,OAAT,EAAd;AACA,aAAO,IAAI3pF,UAAJ,CAAe,UAAUjc,OAAV,EAAmB;AACvCu3G,QAAAA,eAAe,CAAC3R,OAAD,CAAf,GAA2B2R,eAAe,CAAC3R,OAAD,CAAf,IAA4B,EAAvD;AACA2R,QAAAA,eAAe,CAAC3R,OAAD,CAAf,CAAyB30G,IAAzB,CAA8B+O,OAA9B;AACD,OAHM,CAAP;AAID,KAND;;AAOA,QAAIs5G,WAAW,GAAG,UAAUC,SAAV,EAAqBP,gBAArB,EAAuC;AACvDO,MAAAA,SAAS,GAAG54G,KAAK,CAACC,IAAN,CAAW24G,SAAX,EAAsB,UAAU5V,QAAV,EAAoB;AACpD,eAAO,CAACO,YAAY,CAACG,UAAb,CAAwBV,QAAQ,CAACiC,OAAT,EAAxB,CAAR;AACD,OAFW,CAAZ;AAGA,aAAO3pF,UAAU,CAAChvB,GAAX,CAAe0T,KAAK,CAAC/R,GAAN,CAAU2qH,SAAV,EAAqB,UAAU5V,QAAV,EAAoB;AAC7D,eAAOO,YAAY,CAACmS,SAAb,CAAuB1S,QAAQ,CAACiC,OAAT,EAAvB,IAA6CyT,qBAAqB,CAAC1V,QAAD,CAAlE,GAA+EoV,cAAc,CAACpV,QAAD,EAAWpmF,QAAQ,CAACo3D,OAApB,EAA6BqkC,gBAA7B,CAApG;AACD,OAFqB,CAAf,CAAP;AAGD,KAPD;;AAQA,QAAIhB,MAAM,GAAG,UAAUuB,SAAV,EAAqBP,gBAArB,EAAuC;AAClD,aAAO,CAACz7F,QAAQ,CAAC7c,GAAV,IAAiB04G,gBAAgB,CAAC77F,QAAQ,CAACo3D,OAAV,CAAjC,GAAsD+jC,QAAQ,EAA9D,GAAmEY,WAAW,CAACC,SAAD,EAAYP,gBAAZ,CAArF;AACD,KAFD;;AAGA,QAAIpoH,UAAU,CAAC2sB,QAAQ,CAACo3D,OAAV,CAAV,KAAiC,KAArC,EAA4C;AAC1Cp3D,MAAAA,QAAQ,CAACo3D,OAAT,GAAmBgjC,cAAnB;AACD;;AACD,WAAO;AAAEK,MAAAA,MAAM,EAAEA;AAAV,KAAP;AACD,GAjID;;AAmIA,MAAIgB,gBAAgB,GAAG,UAAU/7F,MAAV,EAAkB;AACvC,WAAO,YAAY;AACjB,aAAOA,MAAM,CAACs3F,mBAAP,CAA2BjS,IAA3B,CAAgC;AACrCvgG,QAAAA,IAAI,EAAEkb,MAAM,CAAC3T,SAAP,CAAiB,oBAAjB,CAD+B;AAErCrZ,QAAAA,IAAI,EAAE,MAF+B;AAGrCsiB,QAAAA,OAAO,EAAE,CAAC,CAH2B;AAIrCigG,QAAAA,WAAW,EAAE;AAJwB,OAAhC,CAAP;AAMD,KAPD;AAQD,GATD;;AAUA,MAAIgH,cAAc,GAAG,UAAUv8F,MAAV,EAAkBinF,YAAlB,EAAgC;AACnD,WAAOoT,QAAQ,CAACpT,YAAD,EAAe;AAC5BxjG,MAAAA,GAAG,EAAE0jD,iBAAiB,CAACnnC,MAAD,CADM;AAE5Bs7F,MAAAA,QAAQ,EAAEl0D,sBAAsB,CAACpnC,MAAD,CAFJ;AAG5B86F,MAAAA,WAAW,EAAEzzD,0BAA0B,CAACrnC,MAAD,CAHX;AAI5B03D,MAAAA,OAAO,EAAEpwB,sBAAsB,CAACtnC,MAAD;AAJH,KAAf,CAAf;AAMD,GAPD;;AAQA,MAAIw8F,aAAa,GAAG,UAAUx8F,MAAV,EAAkB;AACpC,QAAIinF,YAAY,GAAG2R,YAAY,EAA/B;AACA,QAAI6D,QAAQ,GAAGF,cAAc,CAACv8F,MAAD,EAASinF,YAAT,CAA7B;AACA,WAAO;AACL8T,MAAAA,MAAM,EAAE,UAAUuB,SAAV,EAAqBI,gBAArB,EAAuC;AAC7C,YAAIA,gBAAgB,KAAK,KAAK,CAA9B,EAAiC;AAC/BA,UAAAA,gBAAgB,GAAG,IAAnB;AACD;;AACD,eAAOD,QAAQ,CAAC1B,MAAT,CAAgBuB,SAAhB,EAA2BI,gBAAgB,GAAGX,gBAAgB,CAAC/7F,MAAD,CAAnB,GAA8BxzB,SAAzE,CAAP;AACD;AANI,KAAP;AAQD,GAXD;;AAaA,MAAImwH,mBAAmB,GAAG,UAAU38F,MAAV,EAAkB;AAC1C,QAAI48F,gBAAgB,GAAGrnE,IAAI,CAAC,IAAD,CAA3B;AACAv1B,IAAAA,MAAM,CAAClK,EAAP,CAAU,gBAAV,EAA4B,UAAUjd,CAAV,EAAa;AACvC+jH,MAAAA,gBAAgB,CAACzrG,GAAjB,CAAqB1Y,QAAQ,CAAC,EAAD,EAAKI,CAAC,CAACwiG,KAAP,CAA7B;AACD,KAFD;;AAGA,QAAIwhB,aAAa,GAAG,YAAY;AAC9B,UAAIriG,IAAI,GAAGwF,MAAM,CAAC27C,WAAP,CAAmBnhD,IAA9B;AACA3kB,MAAAA,IAAI,CAAC2kB,IAAD,CAAJ,CAAWxoB,MAAX,CAAkB,UAAUqpG,KAAV,EAAiB;AACjC,eAAO,CAACO,MAAM,CAACghB,gBAAgB,CAACjnH,GAAjB,EAAD,EAAyB0lG,KAAzB,CAAd;AACD,OAFD,EAEGzpG,IAFH,CAEQ,UAAUypG,KAAV,EAAiB;AACvBr7E,QAAAA,MAAM,CAACy8E,QAAP,CAAgB,IAAhB;AACAz8E,QAAAA,MAAM,CAACmb,IAAP,CAAY,QAAZ,EAAsB;AACpBkgE,UAAAA,KAAK,EAAEA,KADa;AAEpBiB,UAAAA,SAAS,EAAE3mG,GAAG,CAAC6kB,IAAD,EAAOA,IAAI,CAACxsB,MAAL,GAAc,CAArB,CAAH,CAA2BuD,SAA3B;AAFS,SAAtB;AAID,OARD;AASD,KAXD;;AAYA,WAAO;AAAEsrH,MAAAA,aAAa,EAAEA;AAAjB,KAAP;AACD,GAlBD;;AAmBA,MAAIC,YAAY,GAAG,UAAU98F,MAAV,EAAkB;AACnC,QAAIwmF,SAAS,GAAGmT,SAAS,EAAzB;AACA,QAAI8C,QAAJ,EAAcM,YAAd;AACA,QAAI9V,YAAY,GAAG2R,YAAY,EAA/B;AACA,QAAIoE,UAAU,GAAG,EAAjB;AACA,QAAIC,aAAa,GAAGN,mBAAmB,CAAC38F,MAAD,CAAvC;;AACA,QAAIk9F,UAAU,GAAG,UAAUvlH,QAAV,EAAoB;AACnC,aAAO,UAAU0mB,MAAV,EAAkB;AACvB,YAAI2B,MAAM,CAACk6B,SAAX,EAAsB;AACpB,iBAAOviD,QAAQ,CAAC0mB,MAAD,CAAf;AACD;;AACD,eAAO,EAAP;AACD,OALD;AAMD,KAPD;;AAQA,QAAI8+F,gBAAgB,GAAG,UAAU15G,GAAV,EAAe;AACpC,aAAOA,GAAG,IAAIA,GAAG,CAACxW,OAAJ,CAAY,GAAZ,MAAqB,CAAC,CAAtB,GAA0B,GAA1B,GAAgC,GAApC,CAAH,GAA8C,IAAI80B,IAAJ,GAAW06B,OAAX,EAArD;AACD,KAFD;;AAGA,QAAI2gE,aAAa,GAAG,UAAU5xE,OAAV,EAAmB7vC,MAAnB,EAA2BX,OAA3B,EAAoC;AACtD,UAAIlD,KAAK,GAAG,CAAZ;;AACA,SAAG;AACDA,QAAAA,KAAK,GAAG0zC,OAAO,CAACv+C,OAAR,CAAgB0O,MAAhB,EAAwB7D,KAAxB,CAAR;;AACA,YAAIA,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChB0zC,UAAAA,OAAO,GAAGA,OAAO,CAAClvC,SAAR,CAAkB,CAAlB,EAAqBxE,KAArB,IAA8BkD,OAA9B,GAAwCwwC,OAAO,CAAChvC,MAAR,CAAe1E,KAAK,GAAG6D,MAAM,CAAC3N,MAA9B,CAAlD;AACA8J,UAAAA,KAAK,IAAIkD,OAAO,CAAChN,MAAR,GAAiB2N,MAAM,CAAC3N,MAAxB,GAAiC,CAA1C;AACD;AACF,OAND,QAMS8J,KAAK,KAAK,CAAC,CANpB;;AAOA,aAAO0zC,OAAP;AACD,KAVD;;AAWA,QAAI6xE,eAAe,GAAG,UAAU7xE,OAAV,EAAmB8xE,SAAnB,EAA8BC,cAA9B,EAA8C;AAClE,UAAIC,iBAAiB,GAAG,UAAUD,cAAV,GAA2B,GAA3B,IAAkCA,cAAc,KAAK98G,GAAG,CAACK,cAAvB,GAAwC,2BAAxC,GAAsE,EAAxG,CAAxB;AACA0qC,MAAAA,OAAO,GAAG4xE,aAAa,CAAC5xE,OAAD,EAAU,UAAU8xE,SAAV,GAAsB,GAAhC,EAAqCE,iBAArC,CAAvB;AACAhyE,MAAAA,OAAO,GAAG4xE,aAAa,CAAC5xE,OAAD,EAAU,mBAAmB8xE,SAAnB,GAA+B,GAAzC,EAA8C,mBAAmBC,cAAnB,GAAoC,GAAlF,CAAvB;AACA,aAAO/xE,OAAP;AACD,KALD;;AAMA,QAAIiyE,qBAAqB,GAAG,UAAUH,SAAV,EAAqBC,cAArB,EAAqC;AAC/D3rH,MAAAA,IAAI,CAACouB,MAAM,CAAC27C,WAAP,CAAmBnhD,IAApB,EAA0B,UAAU6gF,KAAV,EAAiB;AAC7C,YAAIA,KAAK,CAACroG,IAAN,KAAe,YAAnB,EAAiC;AAC/BqoG,UAAAA,KAAK,CAACd,SAAN,GAAkB5oG,GAAG,CAAC0pG,KAAK,CAACd,SAAP,EAAkB,UAAUr9C,QAAV,EAAoB;AACzD,mBAAOmgE,eAAe,CAACngE,QAAD,EAAWogE,SAAX,EAAsBC,cAAtB,CAAtB;AACD,WAFoB,CAArB;AAGD,SAJD,MAIO;AACLliB,UAAAA,KAAK,CAAC7vD,OAAN,GAAgB6xE,eAAe,CAAChiB,KAAK,CAAC7vD,OAAP,EAAgB8xE,SAAhB,EAA2BC,cAA3B,CAA/B;AACD;AACF,OARG,CAAJ;AASD,KAVD;;AAWA,QAAIG,qBAAqB,GAAG,UAAU9W,KAAV,EAAiBqS,SAAjB,EAA4B;AACtD,UAAIxrE,GAAG,GAAGztB,MAAM,CAACyxF,UAAP,CAAkBwH,SAAlB,EAA6B,KAA7B,CAAV;AACAwE,MAAAA,qBAAqB,CAAC7W,KAAK,CAACn5D,GAAP,EAAYwrE,SAAZ,CAArB;AACAj5F,MAAAA,MAAM,CAACwuB,CAAP,CAASo4D,KAAT,EAAgBh1F,IAAhB,CAAqB;AACnB,eAAOm1C,mBAAmB,CAAC/mC,MAAD,CAAnB,GAA8Bm9F,gBAAgB,CAAClE,SAAD,CAA9C,GAA4DA,SADhD;AAEnB,wBAAgBxrE;AAFG,OAArB;AAID,KAPD;;AAQA,QAAIkwE,YAAY,GAAG,UAAUhmH,QAAV,EAAoB;AACrC,UAAI,CAAC8kH,QAAL,EAAe;AACbA,QAAAA,QAAQ,GAAGF,cAAc,CAACv8F,MAAD,EAASinF,YAAT,CAAzB;AACD;;AACD,aAAO2W,aAAa,GAAG9lG,IAAhB,CAAqBolG,UAAU,CAAC,UAAUW,UAAV,EAAsB;AAC3D,YAAIvB,SAAS,GAAG3qH,GAAG,CAACksH,UAAD,EAAa,UAAUvW,SAAV,EAAqB;AACnD,iBAAOA,SAAS,CAACZ,QAAjB;AACD,SAFkB,CAAnB;AAGA,eAAO+V,QAAQ,CAAC1B,MAAT,CAAgBuB,SAAhB,EAA2BP,gBAAgB,CAAC/7F,MAAD,CAA3C,EAAqDlI,IAArD,CAA0DolG,UAAU,CAAC,UAAU7+F,MAAV,EAAkB;AAC5F,cAAIy/F,cAAc,GAAG,EAArB;AACA,cAAIC,cAAc,GAAGpsH,GAAG,CAAC0sB,MAAD,EAAS,UAAU2/F,UAAV,EAAsBlmH,KAAtB,EAA6B;AAC5D,gBAAI4uG,QAAQ,GAAGmX,UAAU,CAAC/lH,KAAD,CAAV,CAAkB4uG,QAAjC;AACA,gBAAIE,KAAK,GAAGiX,UAAU,CAAC/lH,KAAD,CAAV,CAAkB8uG,KAA9B;;AACA,gBAAIoX,UAAU,CAACv8F,MAAX,IAAqBulC,qBAAqB,CAAChnC,MAAD,CAA9C,EAAwD;AACtDwmF,cAAAA,SAAS,CAAC2T,WAAV,CAAsBvT,KAAK,CAACn5D,GAA5B;AACAiwE,cAAAA,qBAAqB,CAAC9W,KAAD,EAAQoX,UAAU,CAACv6G,GAAnB,CAArB;AACD,aAHD,MAGO,IAAIu6G,UAAU,CAACx5G,KAAf,EAAsB;AAC3B,kBAAIw5G,UAAU,CAACx5G,KAAX,CAAiBo3G,OAAjB,CAAyB/vG,MAA7B,EAAqC;AACnC4xG,gBAAAA,qBAAqB,CAAC7W,KAAK,CAAC92F,YAAN,CAAmB,KAAnB,CAAD,EAA4BrP,GAAG,CAACK,cAAhC,CAArB;AACAg9G,gBAAAA,cAAc,CAAC9pH,IAAf,CAAoB4yG,KAApB;AACD;;AACD6Q,cAAAA,WAAW,CAACz3F,MAAD,EAASg+F,UAAU,CAACx5G,KAAX,CAAiBiY,OAA1B,CAAX;AACD;;AACD,mBAAO;AACLvW,cAAAA,OAAO,EAAE0gG,KADJ;AAELnlF,cAAAA,MAAM,EAAEu8F,UAAU,CAACv8F,MAFd;AAGLw8F,cAAAA,SAAS,EAAED,UAAU,CAACv6G,GAHjB;AAILijG,cAAAA,QAAQ,EAAEA;AAJL,aAAP;AAMD,WAnBuB,CAAxB;;AAoBA,cAAIqX,cAAc,CAAC/vH,MAAf,GAAwB,CAA5B,EAA+B;AAC7BivH,YAAAA,aAAa,CAACJ,aAAd;AACD;;AACD,cAAIiB,cAAc,CAAC9vH,MAAf,GAAwB,CAA5B,EAA+B;AAC7B,gBAAI2wG,KAAK,CAAC3+E,MAAD,CAAT,EAAmB;AACjBzb,cAAAA,OAAO,CAACC,KAAR,CAAc,oEAAd;AACD,aAFD,MAEO;AACLwb,cAAAA,MAAM,CAAC27C,WAAP,CAAmBC,QAAnB,CAA4B,YAAY;AACtChqE,gBAAAA,IAAI,CAACksH,cAAD,EAAiB,UAAU53G,OAAV,EAAmB;AACtC8Z,kBAAAA,MAAM,CAAChb,GAAP,CAAW6G,MAAX,CAAkB3F,OAAlB;AACAsgG,kBAAAA,SAAS,CAAC2T,WAAV,CAAsBj0G,OAAO,CAACunC,GAA9B;AACD,iBAHG,CAAJ;AAID,eALD;AAMD;AACF;;AACD,cAAI91C,QAAJ,EAAc;AACZA,YAAAA,QAAQ,CAAComH,cAAD,CAAR;AACD;;AACD,iBAAOA,cAAP;AACD,SAzC0E,CAApE,CAAP;AA0CD,OA9CqC,CAA/B,CAAP;AA+CD,KAnDD;;AAoDA,QAAIG,gBAAgB,GAAG,UAAUvmH,QAAV,EAAoB;AACzC,UAAImvD,yBAAyB,CAAC9mC,MAAD,CAA7B,EAAuC;AACrC,eAAO29F,YAAY,CAAChmH,QAAD,CAAnB;AACD;AACF,KAJD;;AAKA,QAAIwmH,mBAAmB,GAAG,UAAUC,MAAV,EAAkB;AAC1C,UAAIrsH,MAAM,CAACirH,UAAD,EAAa,UAAUhrH,MAAV,EAAkB;AACrC,eAAOA,MAAM,CAACosH,MAAD,CAAb;AACD,OAFO,CAAN,KAEK,KAFT,EAEgB;AACd,eAAO,KAAP;AACD;;AACD,UAAIA,MAAM,CAACtuG,YAAP,CAAoB,KAApB,EAA2B7iB,OAA3B,CAAmC,OAAnC,MAAgD,CAApD,EAAuD;AACrD,YAAIoxH,aAAa,GAAGx3D,sBAAsB,CAAC7mC,MAAD,CAA1C;AACA,eAAOq+F,aAAa,CAACD,MAAD,CAApB;AACD;;AACD,aAAO,IAAP;AACD,KAXD;;AAYA,QAAIE,SAAS,GAAG,UAAUtsH,MAAV,EAAkB;AAChCgrH,MAAAA,UAAU,CAAChpH,IAAX,CAAgBhC,MAAhB;AACD,KAFD;;AAGA,QAAI4rH,aAAa,GAAG,YAAY;AAC9B,UAAI,CAACb,YAAL,EAAmB;AACjBA,QAAAA,YAAY,GAAG/V,YAAY,CAACC,YAAD,EAAeT,SAAf,CAA3B;AACD;;AACD,aAAOuW,YAAY,CAACpiE,OAAb,CAAqB36B,MAAM,CAACo6B,OAAP,EAArB,EAAuC+jE,mBAAvC,EAA4DrmG,IAA5D,CAAiEolG,UAAU,CAAC,UAAU7+F,MAAV,EAAkB;AACnGA,QAAAA,MAAM,GAAGrsB,MAAM,CAACqsB,MAAD,EAAS,UAAUkgG,UAAV,EAAsB;AAC5C,cAAI,OAAOA,UAAP,KAAsB,QAA1B,EAAoC;AAClChH,YAAAA,YAAY,CAACv3F,MAAD,EAASu+F,UAAT,CAAZ;AACA,mBAAO,KAAP;AACD;;AACD,iBAAO,IAAP;AACD,SANc,CAAf;AAOA3sH,QAAAA,IAAI,CAACysB,MAAD,EAAS,UAAUkgG,UAAV,EAAsB;AACjCd,UAAAA,qBAAqB,CAACc,UAAU,CAAC3X,KAAX,CAAiBn5D,GAAlB,EAAuB8wE,UAAU,CAAC7X,QAAX,CAAoBiC,OAApB,EAAvB,CAArB;AACA4V,UAAAA,UAAU,CAAC3X,KAAX,CAAiBn5D,GAAjB,GAAuB8wE,UAAU,CAAC7X,QAAX,CAAoBiC,OAApB,EAAvB;AACA4V,UAAAA,UAAU,CAAC3X,KAAX,CAAiBl1F,eAAjB,CAAiC,cAAjC;AACD,SAJG,CAAJ;AAKA,eAAO2M,MAAP;AACD,OAdiF,CAA3E,CAAP;AAeD,KAnBD;;AAoBA,QAAIid,OAAO,GAAG,YAAY;AACxBkrE,MAAAA,SAAS,CAAClrE,OAAV;AACA2rE,MAAAA,YAAY,CAAC3rE,OAAb;AACAyhF,MAAAA,YAAY,GAAGN,QAAQ,GAAG,IAA1B;AACD,KAJD;;AAKA,QAAI+B,eAAe,GAAG,UAAUhzE,OAAV,EAAmB;AACvC,aAAOA,OAAO,CAACxwC,OAAR,CAAgB,qBAAhB,EAAuC,UAAU0H,KAAV,EAAiBimG,OAAjB,EAA0B;AACtE,YAAIsQ,SAAS,GAAGhS,YAAY,CAACkS,YAAb,CAA0BxQ,OAA1B,CAAhB;;AACA,YAAIsQ,SAAJ,EAAe;AACb,iBAAO,UAAUA,SAAV,GAAsB,GAA7B;AACD;;AACD,YAAIvS,QAAQ,GAAGF,SAAS,CAACG,QAAV,CAAmBgC,OAAnB,CAAf;;AACA,YAAI,CAACjC,QAAL,EAAe;AACbA,UAAAA,QAAQ,GAAG7xG,KAAK,CAACmrB,MAAM,CAACmtD,aAAP,CAAqBx3E,GAArB,EAAD,EAA6B,UAAU0oB,MAAV,EAAkB2B,MAAlB,EAA0B;AACrE,mBAAO3B,MAAM,IAAI2B,MAAM,CAACwuF,YAAP,IAAuBxuF,MAAM,CAACwuF,YAAP,CAAoBhI,SAApB,CAA8BG,QAA9B,CAAuCgC,OAAvC,CAAxC;AACD,WAFe,EAEb,IAFa,CAAhB;AAGD;;AACD,YAAIjC,QAAJ,EAAc;AACZ,cAAIR,IAAI,GAAGQ,QAAQ,CAACR,IAAT,EAAX;AACA,iBAAO,eAAeA,IAAI,CAAClzG,IAApB,GAA2B,UAA3B,GAAwC0zG,QAAQ,CAACD,MAAT,EAAxC,GAA4D,GAAnE;AACD;;AACD,eAAO/jG,KAAP;AACD,OAhBM,CAAP;AAiBD,KAlBD;;AAmBAsd,IAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwB,YAAY;AAClC,UAAIgxC,yBAAyB,CAAC9mC,MAAD,CAA7B,EAAuC;AACrCk+F,QAAAA,gBAAgB;AACjB,OAFD,MAEO;AACLN,QAAAA,aAAa;AACd;AACF,KAND;AAOA59F,IAAAA,MAAM,CAAClK,EAAP,CAAU,gBAAV,EAA4B,UAAUjd,CAAV,EAAa;AACvCA,MAAAA,CAAC,CAAC2yC,OAAF,GAAYgzE,eAAe,CAAC3lH,CAAC,CAAC2yC,OAAH,CAA3B;AACD,KAFD;AAGAxrB,IAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwB,UAAUjd,CAAV,EAAa;AACnC,UAAIA,CAAC,CAAC4lH,WAAF,IAAiB5lH,CAAC,CAACo8D,MAAF,KAAa,KAA9B,IAAuCp8D,CAAC,CAACo8D,MAAF,KAAa,MAAxD,EAAgE;AAC9D;AACD;;AACDp8D,MAAAA,CAAC,CAAC2yC,OAAF,GAAYgzE,eAAe,CAAC3lH,CAAC,CAAC2yC,OAAH,CAA3B;AACD,KALD;AAMAxrB,IAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwB,YAAY;AAClCkK,MAAAA,MAAM,CAACymE,MAAP,CAAcvqC,aAAd,CAA4B,KAA5B,EAAmC,UAAUirD,MAAV,EAAkB;AACnDv1G,QAAAA,IAAI,CAACu1G,MAAD,EAAS,UAAU3kC,GAAV,EAAe;AAC1B,cAAI/0B,GAAG,GAAG+0B,GAAG,CAAC5wD,IAAJ,CAAS,KAAT,CAAV;;AACA,cAAI40F,SAAS,CAACG,QAAV,CAAmBl5D,GAAnB,CAAJ,EAA6B;AAC3B;AACD;;AACD,cAAIwrE,SAAS,GAAGhS,YAAY,CAACkS,YAAb,CAA0B1rE,GAA1B,CAAhB;;AACA,cAAIwrE,SAAJ,EAAe;AACbz2C,YAAAA,GAAG,CAAC5wD,IAAJ,CAAS,KAAT,EAAgBqnG,SAAhB;AACD;AACF,SATG,CAAJ;AAUD,OAXD;AAYD,KAbD;AAcA,WAAO;AACLzS,MAAAA,SAAS,EAAEA,SADN;AAEL8X,MAAAA,SAAS,EAAEA,SAFN;AAGLX,MAAAA,YAAY,EAAEA,YAHT;AAILO,MAAAA,gBAAgB,EAAEA,gBAJb;AAKLN,MAAAA,aAAa,EAAEA,aALV;AAMLtiF,MAAAA,OAAO,EAAEA;AANJ,KAAP;AAQD,GA/MD;;AAiNA,MAAIojF,KAAK,GAAG,UAAU15G,GAAV,EAAe;AACzB,QAAIgvF,OAAO,GAAG;AACZ2qB,MAAAA,SAAS,EAAE,CAAC;AACRx4G,QAAAA,QAAQ,EAAE,OADF;AAERgM,QAAAA,MAAM,EAAE;AAAEysG,UAAAA,aAAa,EAAE;AAAjB;AAFA,OAAD,CADC;AAKZC,MAAAA,YAAY,EAAE,CAAC;AACX14G,QAAAA,QAAQ,EAAE,OADC;AAEXgM,QAAAA,MAAM,EAAE;AAAEysG,UAAAA,aAAa,EAAE;AAAjB;AAFG,OAAD,CALF;AASZE,MAAAA,YAAY,EAAE,CAAC;AACX34G,QAAAA,QAAQ,EAAE,OADC;AAEXgM,QAAAA,MAAM,EAAE;AAAEysG,UAAAA,aAAa,EAAE;AAAjB;AAFG,OAAD,CATF;AAaZG,MAAAA,SAAS,EAAE,CACT;AACE54G,QAAAA,QAAQ,EAAE,cADZ;AAEE6+C,QAAAA,SAAS,EAAE,KAFb;AAGEpI,QAAAA,OAAO,EAAE,YAHX;AAIEm0C,QAAAA,eAAe,EAAE,IAJnB;AAKEiuB,QAAAA,OAAO,EAAE;AALX,OADS,EAQT;AACE74G,QAAAA,QAAQ,EAAE,kDADZ;AAEEgM,QAAAA,MAAM,EAAE;AAAE8sG,UAAAA,SAAS,EAAE;AAAb,SAFV;AAGEl2B,QAAAA,OAAO,EAAE,KAHX;AAIEi2B,QAAAA,OAAO,EAAE,KAJX;AAKEn1B,QAAAA,YAAY,EAAE;AALhB,OARS,EAeT;AACE1jF,QAAAA,QAAQ,EAAE,WADZ;AAEE6+C,QAAAA,SAAS,EAAE,KAFb;AAGE7yC,QAAAA,MAAM,EAAE;AAAEk4B,UAAAA,KAAK,EAAE;AAAT,SAHV;AAIE20E,QAAAA,OAAO,EAAE;AAJX,OAfS,CAbC;AAmCZE,MAAAA,WAAW,EAAE,CACX;AACE/4G,QAAAA,QAAQ,EAAE,kDADZ;AAEEgM,QAAAA,MAAM,EAAE;AAAE8sG,UAAAA,SAAS,EAAE;AAAb,SAFV;AAGEl2B,QAAAA,OAAO,EAAE,KAHX;AAIEi2B,QAAAA,OAAO,EAAE,uBAJX;AAKEn1B,QAAAA,YAAY,EAAE;AALhB,OADW,EAQX;AACE1jF,QAAAA,QAAQ,EAAE,cADZ;AAEE6+C,QAAAA,SAAS,EAAE,KAFb;AAGEpI,QAAAA,OAAO,EAAE,cAHX;AAIEm0C,QAAAA,eAAe,EAAE,IAJnB;AAKEiuB,QAAAA,OAAO,EAAE;AALX,OARW,EAeX;AACE74G,QAAAA,QAAQ,EAAE,KADZ;AAEE6+C,QAAAA,SAAS,EAAE,KAFb;AAGE7yC,QAAAA,MAAM,EAAE;AACNkvD,UAAAA,OAAO,EAAE,OADH;AAEN89C,UAAAA,UAAU,EAAE,MAFN;AAGNC,UAAAA,WAAW,EAAE;AAHP,SAHV;AAQEJ,QAAAA,OAAO,EAAE;AARX,OAfW,EAyBX;AACE74G,QAAAA,QAAQ,EAAE,OADZ;AAEE6+C,QAAAA,SAAS,EAAE,KAFb;AAGE7yC,QAAAA,MAAM,EAAE;AACNgtG,UAAAA,UAAU,EAAE,MADN;AAENC,UAAAA,WAAW,EAAE;AAFP,SAHV;AAOEJ,QAAAA,OAAO,EAAE;AAPX,OAzBW,CAnCD;AAsEZK,MAAAA,UAAU,EAAE,CACV;AACEl5G,QAAAA,QAAQ,EAAE,cADZ;AAEE6+C,QAAAA,SAAS,EAAE,KAFb;AAGEpI,QAAAA,OAAO,EAAE,aAHX;AAIEm0C,QAAAA,eAAe,EAAE,IAJnB;AAKEiuB,QAAAA,OAAO,EAAE;AALX,OADU,EAQV;AACE74G,QAAAA,QAAQ,EAAE,kDADZ;AAEEgM,QAAAA,MAAM,EAAE;AAAE8sG,UAAAA,SAAS,EAAE;AAAb,SAFV;AAGEl2B,QAAAA,OAAO,EAAE,KAHX;AAIEi2B,QAAAA,OAAO,EAAE,uBAJX;AAKEn1B,QAAAA,YAAY,EAAE;AALhB,OARU,EAeV;AACE1jF,QAAAA,QAAQ,EAAE,WADZ;AAEE6+C,QAAAA,SAAS,EAAE,KAFb;AAGE7yC,QAAAA,MAAM,EAAE;AAAEk4B,UAAAA,KAAK,EAAE;AAAT,SAHV;AAIE20E,QAAAA,OAAO,EAAE;AAJX,OAfU,CAtEA;AA4FZM,MAAAA,YAAY,EAAE,CAAC;AACXn5G,QAAAA,QAAQ,EAAE,kDADC;AAEXgM,QAAAA,MAAM,EAAE;AAAE8sG,UAAAA,SAAS,EAAE;AAAb,SAFG;AAGXl2B,QAAAA,OAAO,EAAE,KAHE;AAIXc,QAAAA,YAAY,EAAE,KAJH;AAKXm1B,QAAAA,OAAO,EAAE;AALE,OAAD,CA5FF;AAmGZO,MAAAA,IAAI,EAAE,CACJ;AACExtF,QAAAA,MAAM,EAAE,QADV;AAEElmB,QAAAA,MAAM,EAAE,KAFV;AAGE6jF,QAAAA,mBAAmB,EAAE,CACnB,OADmB,EAEnB,OAFmB;AAHvB,OADI,EASJ;AACE39D,QAAAA,MAAM,EAAE,MADV;AAEE5f,QAAAA,MAAM,EAAE;AAAEqtG,UAAAA,UAAU,EAAE;AAAd;AAFV,OATI,EAaJ;AACEztF,QAAAA,MAAM,EAAE,GADV;AAEElmB,QAAAA,MAAM,EAAE,KAFV;AAGE6jF,QAAAA,mBAAmB,EAAE,CACnB,OADmB,EAEnB,OAFmB;AAHvB,OAbI,CAnGM;AAyHZ+vB,MAAAA,MAAM,EAAE,CACN;AACE1tF,QAAAA,MAAM,EAAE,IADV;AAEElmB,QAAAA,MAAM,EAAE,KAFV;AAGE6jF,QAAAA,mBAAmB,EAAE,CACnB,OADmB,EAEnB,OAFmB;AAHvB,OADM,EASN;AACE39D,QAAAA,MAAM,EAAE,MADV;AAEE5f,QAAAA,MAAM,EAAE;AAAEutG,UAAAA,SAAS,EAAE;AAAb;AAFV,OATM,EAaN;AACE3tF,QAAAA,MAAM,EAAE,GADV;AAEElmB,QAAAA,MAAM,EAAE,KAFV;AAGE6jF,QAAAA,mBAAmB,EAAE,CACnB,OADmB,EAEnB,OAFmB;AAHvB,OAbM,CAzHI;AA+IZiwB,MAAAA,SAAS,EAAE,CACT;AACE5tF,QAAAA,MAAM,EAAE,MADV;AAEE5f,QAAAA,MAAM,EAAE;AAAE2+E,UAAAA,cAAc,EAAE;AAAlB,SAFV;AAGEvmB,QAAAA,KAAK,EAAE;AAHT,OADS,EAMT;AACEx4C,QAAAA,MAAM,EAAE,GADV;AAEElmB,QAAAA,MAAM,EAAE,KAFV;AAGE6jF,QAAAA,mBAAmB,EAAE,CACnB,OADmB,EAEnB,OAFmB;AAHvB,OANS,CA/IC;AA8JZkwB,MAAAA,aAAa,EAAE,CACb;AACE7tF,QAAAA,MAAM,EAAE,MADV;AAEE5f,QAAAA,MAAM,EAAE;AAAE2+E,UAAAA,cAAc,EAAE;AAAlB,SAFV;AAGEvmB,QAAAA,KAAK,EAAE;AAHT,OADa,EAMb;AACEx4C,QAAAA,MAAM,EAAE,QADV;AAEElmB,QAAAA,MAAM,EAAE,KAFV;AAGE6jF,QAAAA,mBAAmB,EAAE,CACnB,OADmB,EAEnB,OAFmB;AAHvB,OANa,EAcb;AACE39D,QAAAA,MAAM,EAAE,GADV;AAEElmB,QAAAA,MAAM,EAAE,KAFV;AAGE6jF,QAAAA,mBAAmB,EAAE,CACnB,OADmB,EAEnB,OAFmB;AAHvB,OAda,CA9JH;AAqLZmwB,MAAAA,SAAS,EAAE;AACT9tF,QAAAA,MAAM,EAAE,MADC;AAET5f,QAAAA,MAAM,EAAE;AAAEijB,UAAAA,KAAK,EAAE;AAAT,SAFC;AAGT04D,QAAAA,KAAK,EAAE,IAHE;AAIT8B,QAAAA,cAAc,EAAE,IAJP;AAKT/B,QAAAA,kBAAkB,EAAE;AALX,OArLC;AA4LZiyB,MAAAA,WAAW,EAAE;AACX/tF,QAAAA,MAAM,EAAE,MADG;AAEX5f,QAAAA,MAAM,EAAE;AAAEi/E,UAAAA,eAAe,EAAE;AAAnB,SAFG;AAGXtD,QAAAA,KAAK,EAAE,IAHI;AAIX8B,QAAAA,cAAc,EAAE,IAJL;AAKX/B,QAAAA,kBAAkB,EAAE;AALT,OA5LD;AAmMZkyB,MAAAA,QAAQ,EAAE;AACRhuF,QAAAA,MAAM,EAAE,MADA;AAERqiE,QAAAA,MAAM,EAAE,KAFA;AAGRjiF,QAAAA,MAAM,EAAE;AAAE6tG,UAAAA,UAAU,EAAE;AAAd,SAHA;AAIRnyB,QAAAA,kBAAkB,EAAE;AAJZ,OAnME;AAyMZoyB,MAAAA,QAAQ,EAAE;AACRluF,QAAAA,MAAM,EAAE,MADA;AAERqiE,QAAAA,MAAM,EAAE,KAFA;AAGRjiF,QAAAA,MAAM,EAAE;AAAE+tG,UAAAA,QAAQ,EAAE;AAAZ,SAHA;AAIRryB,QAAAA,kBAAkB,EAAE;AAJZ,OAzME;AA+MZsyB,MAAAA,UAAU,EAAE;AACVh6G,QAAAA,QAAQ,EAAE,kCADA;AAEV0jF,QAAAA,YAAY,EAAE,GAFJ;AAGV13E,QAAAA,MAAM,EAAE;AAAEiuG,UAAAA,UAAU,EAAE;AAAd;AAHE,OA/MA;AAoNZC,MAAAA,cAAc,EAAE;AACdtuF,QAAAA,MAAM,EAAE,MADM;AAEdpgB,QAAAA,UAAU,EAAE;AAAEu4B,UAAAA,KAAK,EAAE;AAAT;AAFE,OApNJ;AAwNZo2E,MAAAA,UAAU,EAAE;AACVj6D,QAAAA,KAAK,EAAE,YADG;AAEV96C,QAAAA,OAAO,EAAE,IAFC;AAGVM,QAAAA,MAAM,EAAE;AAHE,OAxNA;AA6NZ00G,MAAAA,SAAS,EAAE;AAAExuF,QAAAA,MAAM,EAAE;AAAV,OA7NC;AA8NZyuF,MAAAA,WAAW,EAAE;AAAEzuF,QAAAA,MAAM,EAAE;AAAV,OA9ND;AA+NZ1d,MAAAA,IAAI,EAAE;AAAE0d,QAAAA,MAAM,EAAE;AAAV,OA/NM;AAgOZzQ,MAAAA,IAAI,EAAE;AACJyQ,QAAAA,MAAM,EAAE,GADJ;AAEJ5rB,QAAAA,QAAQ,EAAE,GAFN;AAGJ0F,QAAAA,MAAM,EAAE,KAHJ;AAIJ9J,QAAAA,KAAK,EAAE,IAJH;AAKJmtC,QAAAA,IAAI,EAAE,IALF;AAMJo6C,QAAAA,OAAO,EAAE,UAAU1kF,IAAV,EAAgB67G,IAAhB,EAAsBC,SAAtB,EAAiC;AACxC,iBAAOzxG,WAAW,CAACrK,IAAD,CAAX,IAAqBA,IAAI,CAAC8K,YAAL,CAAkB,MAAlB,CAA5B;AACD,SARG;AASJ2iF,QAAAA,QAAQ,EAAE,UAAUt/E,GAAV,EAAe0tG,IAAf,EAAqBlsD,IAArB,EAA2B;AACnC7wD,UAAAA,KAAK,CAAC9R,IAAN,CAAW2iE,IAAX,EAAiB,UAAU7kE,KAAV,EAAiBuH,GAAjB,EAAsB;AACrC+N,YAAAA,GAAG,CAAC8pC,SAAJ,CAAc/7B,GAAd,EAAmB9b,GAAnB,EAAwBvH,KAAxB;AACD,WAFD;AAGD;AAbG,OAhOM;AA+OZixH,MAAAA,YAAY,EAAE,CACZ;AACEx6G,QAAAA,QAAQ,EAAE,iFADZ;AAEE0F,QAAAA,MAAM,EAAE,KAFV;AAGE9J,QAAAA,KAAK,EAAE,IAHT;AAIE81D,QAAAA,MAAM,EAAE,KAJV;AAKEN,QAAAA,YAAY,EAAE,IALhB;AAMEroB,QAAAA,IAAI,EAAE;AANR,OADY,EASZ;AACE/oC,QAAAA,QAAQ,EAAE,MADZ;AAEEwL,QAAAA,UAAU,EAAE,CACV,OADU,EAEV,OAFU,CAFd;AAME9F,QAAAA,MAAM,EAAE,OANV;AAOE9J,QAAAA,KAAK,EAAE,IAPT;AAQE81D,QAAAA,MAAM,EAAE,KARV;AASE3oB,QAAAA,IAAI,EAAE;AATR,OATY,EAoBZ;AACE/oC,QAAAA,QAAQ,EAAE,GADZ;AAEEwL,QAAAA,UAAU,EAAE,CACV,OADU,EAEV,OAFU,CAFd;AAME5P,QAAAA,KAAK,EAAE,KANT;AAOE81D,QAAAA,MAAM,EAAE,KAPV;AAQE3oB,QAAAA,IAAI,EAAE;AARR,OApBY;AA/OF,KAAd;AA+QAxrC,IAAAA,KAAK,CAAC9R,IAAN,CAAW,qDAAqDmQ,KAArD,CAA2D,IAA3D,CAAX,EAA6E,UAAUjV,IAAV,EAAgB;AAC3FknG,MAAAA,OAAO,CAAClnG,IAAD,CAAP,GAAgB;AACdu5D,QAAAA,KAAK,EAAEv5D,IADO;AAEd+e,QAAAA,MAAM,EAAE;AAFM,OAAhB;AAID,KALD;AAMA,WAAOmoF,OAAP;AACD,GAvRD;;AAyRA,MAAI4sB,cAAc,GAAG,UAAU5gG,MAAV,EAAkB;AACrC,QAAIg0E,OAAO,GAAG,EAAd;;AACA,QAAIr+F,GAAG,GAAG,UAAU7I,IAAV,EAAgB;AACxB,aAAOA,IAAI,GAAGknG,OAAO,CAAClnG,IAAD,CAAV,GAAmBknG,OAA9B;AACD,KAFD;;AAGA,QAAIxiF,KAAK,GAAG,UAAU1kB,IAAV,EAAgB;AAC1B,aAAOoK,GAAG,CAAC88F,OAAD,EAAUlnG,IAAV,CAAV;AACD,KAFD;;AAGA,QAAIwvD,QAAQ,GAAG,UAAUxvD,IAAV,EAAgBmoE,MAAhB,EAAwB;AACrC,UAAInoE,IAAJ,EAAU;AACR,YAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC5B4W,UAAAA,KAAK,CAAC9R,IAAN,CAAW9E,IAAX,EAAiB,UAAUmoE,MAAV,EAAkBnoE,IAAlB,EAAwB;AACvCwvD,YAAAA,QAAQ,CAACxvD,IAAD,EAAOmoE,MAAP,CAAR;AACD,WAFD;AAGD,SAJD,MAIO;AACL,cAAI,CAAC5hE,OAAO,CAAC4hE,MAAD,CAAZ,EAAsB;AACpBA,YAAAA,MAAM,GAAG,CAACA,MAAD,CAAT;AACD;;AACDvxD,UAAAA,KAAK,CAAC9R,IAAN,CAAWqjE,MAAX,EAAmB,UAAUA,MAAV,EAAkB;AACnC,gBAAI,OAAOA,MAAM,CAAC/lB,IAAd,KAAuB,WAA3B,EAAwC;AACtC+lB,cAAAA,MAAM,CAAC/lB,IAAP,GAAc,CAAC+lB,MAAM,CAAC9uD,QAAtB;AACD;;AACD,gBAAI,OAAO8uD,MAAM,CAAClzD,KAAd,KAAwB,WAA5B,EAAyC;AACvCkzD,cAAAA,MAAM,CAAClzD,KAAP,GAAe,CAACkzD,MAAM,CAAC9uD,QAAR,IAAoB8uD,MAAM,CAACljC,MAA1C;AACD;;AACD,gBAAI,OAAOkjC,MAAM,CAACppD,MAAd,KAAyB,WAAzB,IAAwCopD,MAAM,CAAC9uD,QAA/C,IAA2D,CAAC8uD,MAAM,CAACljC,MAAvE,EAA+E;AAC7EkjC,cAAAA,MAAM,CAACppD,MAAP,GAAgB,MAAhB;AACD;;AACD,gBAAIopD,MAAM,CAAC9uD,QAAP,IAAmB8uD,MAAM,CAACljC,MAA9B,EAAsC;AACpCkjC,cAAAA,MAAM,CAACs7B,KAAP,GAAe,IAAf;AACAt7B,cAAAA,MAAM,CAACsC,YAAP,GAAsB,IAAtB;AACD;;AACD,gBAAI,OAAOtC,MAAM,CAACrY,OAAd,KAA0B,QAA9B,EAAwC;AACtCqY,cAAAA,MAAM,CAACrY,OAAP,GAAiBqY,MAAM,CAACrY,OAAP,CAAe76C,KAAf,CAAqB,KAArB,CAAjB;AACD;AACF,WAjBD;AAkBAiyF,UAAAA,OAAO,CAAClnG,IAAD,CAAP,GAAgBmoE,MAAhB;AACD;AACF;AACF,KA/BD;;AAgCA,QAAI4rD,UAAU,GAAG,UAAU/zH,IAAV,EAAgB;AAC/B,UAAIA,IAAI,IAAIknG,OAAO,CAAClnG,IAAD,CAAnB,EAA2B;AACzB,eAAOknG,OAAO,CAAClnG,IAAD,CAAd;AACD;;AACD,aAAOknG,OAAP;AACD,KALD;;AAMA13C,IAAAA,QAAQ,CAACoiE,KAAK,CAAC1+F,MAAM,CAAChb,GAAR,CAAN,CAAR;AACAs3C,IAAAA,QAAQ,CAACsM,UAAU,CAAC5oC,MAAD,CAAX,CAAR;AACA,WAAO;AACLrqB,MAAAA,GAAG,EAAEA,GADA;AAELuB,MAAAA,GAAG,EAAEsa,KAFA;AAGL8qC,MAAAA,QAAQ,EAAEA,QAHL;AAILukE,MAAAA,UAAU,EAAEA;AAJP,KAAP;AAMD,GAtDD;;AAwDA,MAAIC,MAAM,GAAGp9G,KAAK,CAAC9R,IAAnB;AACA,MAAIoT,GAAG,GAAG+oC,QAAQ,CAAC2D,GAAnB;;AACA,MAAIqvE,oBAAoB,GAAG,UAAUC,QAAV,EAAoBhhG,MAApB,EAA4B;AACrD,QAAIjN,GAAJ,EAASlb,IAAT,EAAeqlD,QAAf;AACA,QAAIpwB,MAAM,GAAG9M,MAAM,IAAIA,MAAM,CAAC8M,MAAjB,IAA2BkB,MAAM,CAAC,EAAD,CAA9C;;AACA,QAAI2sC,QAAQ,GAAG,UAAU5nD,GAAV,EAAelb,IAAf,EAAqB;AAClC,UAAIA,IAAI,CAAC+kD,OAAL,CAAa5uD,MAAjB,EAAyB;AACvBgX,QAAAA,GAAG,CAAC4mC,QAAJ,CAAa74B,GAAb,EAAkBlb,IAAI,CAAC+kD,OAAL,CAAar/B,IAAb,CAAkB,GAAlB,CAAlB;AACD;;AACDvY,MAAAA,GAAG,CAAC2rC,UAAJ,CAAe59B,GAAf,EAAoBlb,IAAI,CAACwZ,KAAzB;AACD,KALD;;AAMA,QAAIlN,aAAa,GAAG,UAAU88G,KAAV,EAAiB;AACnCppH,MAAAA,IAAI,GAAG,OAAOopH,KAAP,KAAiB,QAAjB,GAA4B;AACjCn0H,QAAAA,IAAI,EAAEm0H,KAD2B;AAEjCrkE,QAAAA,OAAO,EAAE,EAFwB;AAGjCvrC,QAAAA,KAAK,EAAE;AAH0B,OAA5B,GAIH4vG,KAJJ;AAKA,UAAIluG,GAAG,GAAG/N,GAAG,CAAC9C,MAAJ,CAAWrK,IAAI,CAAC/K,IAAhB,CAAV;AACA6tE,MAAAA,QAAQ,CAAC5nD,GAAD,EAAMlb,IAAN,CAAR;AACA,aAAOkb,GAAP;AACD,KATD;;AAUA,QAAImuG,iBAAiB,GAAG,UAAUnuG,GAAV,EAAerX,SAAf,EAA0B;AAChD,UAAI5O,IAAI,GAAG,OAAOimB,GAAP,KAAe,QAAf,GAA0BA,GAAG,CAACtL,QAAJ,CAAapM,WAAb,EAA1B,GAAuD0X,GAAlE;AACA,UAAIouG,OAAO,GAAGr0F,MAAM,CAACwF,cAAP,CAAsBxlC,IAAtB,CAAd;AACA,UAAIwmC,eAAe,GAAG6tF,OAAO,IAAIA,OAAO,CAAC7tF,eAAzC;;AACA,UAAIA,eAAe,IAAIA,eAAe,CAACtlC,MAAvC,EAA+C;AAC7C,eAAO0N,SAAS,IAAIgI,KAAK,CAACE,OAAN,CAAc0vB,eAAd,EAA+B53B,SAA/B,MAA8C,CAAC,CAA5D,GAAgEA,SAAhE,GAA4E43B,eAAe,CAAC,CAAD,CAAlG;AACD,OAFD,MAEO;AACL,eAAO,KAAP;AACD;AACF,KATD;;AAUA,QAAI8tF,UAAU,GAAG,UAAUruG,GAAV,EAAeiuG,QAAf,EAAyBp4G,QAAzB,EAAmC;AAClD,UAAI5F,MAAJ,EAAYq+G,eAAZ;AACA,UAAI9iG,QAAQ,GAAGyiG,QAAQ,CAAChzH,MAAT,GAAkB,CAAlB,IAAuBgzH,QAAQ,CAAC,CAAD,CAA9C;AACA,UAAIM,YAAY,GAAG/iG,QAAQ,IAAIA,QAAQ,CAACzxB,IAAxC;AACA,UAAIy0H,cAAc,GAAGL,iBAAiB,CAACnuG,GAAD,EAAMuuG,YAAN,CAAtC;;AACA,UAAIC,cAAJ,EAAoB;AAClB,YAAID,YAAY,KAAKC,cAArB,EAAqC;AACnCF,UAAAA,eAAe,GAAGL,QAAQ,CAAC,CAAD,CAA1B;AACAA,UAAAA,QAAQ,GAAGA,QAAQ,CAAC1zH,KAAT,CAAe,CAAf,CAAX;AACD,SAHD,MAGO;AACL+zH,UAAAA,eAAe,GAAGE,cAAlB;AACD;AACF,OAPD,MAOO,IAAIhjG,QAAJ,EAAc;AACnB8iG,QAAAA,eAAe,GAAGL,QAAQ,CAAC,CAAD,CAA1B;AACAA,QAAAA,QAAQ,GAAGA,QAAQ,CAAC1zH,KAAT,CAAe,CAAf,CAAX;AACD,OAHM,MAGA,IAAI,CAACsb,QAAL,EAAe;AACpB,eAAOmK,GAAP;AACD;;AACD,UAAIsuG,eAAJ,EAAqB;AACnBr+G,QAAAA,MAAM,GAAGmB,aAAa,CAACk9G,eAAD,CAAtB;AACAr+G,QAAAA,MAAM,CAACqI,WAAP,CAAmB0H,GAAnB;AACD;;AACD,UAAInK,QAAJ,EAAc;AACZ,YAAI,CAAC5F,MAAL,EAAa;AACXA,UAAAA,MAAM,GAAGgC,GAAG,CAAC9C,MAAJ,CAAW,KAAX,CAAT;AACAc,UAAAA,MAAM,CAACqI,WAAP,CAAmB0H,GAAnB;AACD;;AACDrP,QAAAA,KAAK,CAAC9R,IAAN,CAAWgX,QAAX,EAAqB,UAAUqC,OAAV,EAAmB;AACtC,cAAIu2G,UAAU,GAAGr9G,aAAa,CAAC8G,OAAD,CAA9B;AACAjI,UAAAA,MAAM,CAAC+H,YAAP,CAAoBy2G,UAApB,EAAgCzuG,GAAhC;AACD,SAHD;AAID;;AACD,aAAOquG,UAAU,CAACp+G,MAAD,EAASg+G,QAAT,EAAmBK,eAAe,IAAIA,eAAe,CAACz4G,QAAtD,CAAjB;AACD,KAjCD;;AAkCA,QAAIo4G,QAAQ,IAAIA,QAAQ,CAAChzH,MAAzB,EAAiC;AAC/B6J,MAAAA,IAAI,GAAGmpH,QAAQ,CAAC,CAAD,CAAf;AACAjuG,MAAAA,GAAG,GAAG5O,aAAa,CAACtM,IAAD,CAAnB;AACAqlD,MAAAA,QAAQ,GAAGl4C,GAAG,CAAC9C,MAAJ,CAAW,KAAX,CAAX;AACAg7C,MAAAA,QAAQ,CAAC7xC,WAAT,CAAqB+1G,UAAU,CAACruG,GAAD,EAAMiuG,QAAQ,CAAC1zH,KAAT,CAAe,CAAf,CAAN,EAAyBuK,IAAI,CAAC+Q,QAA9B,CAA/B;AACA,aAAOs0C,QAAP;AACD,KAND,MAMO;AACL,aAAO,EAAP;AACD;AACF,GAxED;;AAyEA,MAAIukE,iBAAiB,GAAG,UAAU5pH,IAAV,EAAgB;AACtC,QAAIqY,OAAJ;AACA,QAAIha,GAAG,GAAG;AACR0mD,MAAAA,OAAO,EAAE,EADD;AAERvrC,MAAAA,KAAK,EAAE;AAFC,KAAV;AAIAxZ,IAAAA,IAAI,GAAG3B,GAAG,CAACiQ,QAAJ,GAAezC,KAAK,CAAC3G,IAAN,CAAWlF,IAAX,CAAtB;;AACA,QAAIA,IAAI,KAAK,GAAb,EAAkB;AAChBqY,MAAAA,OAAO,GAAGrY,IAAI,CAACmD,OAAL,CAAa,2CAAb,EAA0D,UAAU0mH,EAAV,EAAclrE,EAAd,EAAkBC,EAAlB,EAAsBkrE,EAAtB,EAA0BC,EAA1B,EAA8B;AAChG,gBAAQprE,EAAR;AACA,eAAK,GAAL;AACEtgD,YAAAA,GAAG,CAACmb,KAAJ,CAAUxgB,EAAV,GAAe4lD,EAAf;AACA;;AACF,eAAK,GAAL;AACEvgD,YAAAA,GAAG,CAAC0mD,OAAJ,CAAY5oD,IAAZ,CAAiByiD,EAAjB;AACA;;AACF,eAAK,GAAL;AACE,gBAAI/yC,KAAK,CAACE,OAAN,CAAc,8CAA8C7B,KAA9C,CAAoD,GAApD,CAAd,EAAwE00C,EAAxE,MAAgF,CAAC,CAArF,EAAwF;AACtFvgD,cAAAA,GAAG,CAACmb,KAAJ,CAAUolC,EAAV,IAAgBA,EAAhB;AACD;;AACD;AAXF;;AAaA,YAAIkrE,EAAE,KAAK,GAAX,EAAgB;AACd,cAAIliF,CAAC,GAAGmiF,EAAE,CAACl/G,KAAH,CAAS,4BAAT,CAAR;;AACA,cAAI+8B,CAAJ,EAAO;AACLvpC,YAAAA,GAAG,CAACmb,KAAJ,CAAUouB,CAAC,CAAC,CAAD,CAAX,IAAkBA,CAAC,CAAC,CAAD,CAAnB;AACD;AACF;;AACD,eAAO,EAAP;AACD,OArBS,CAAV;AAsBD;;AACDvpC,IAAAA,GAAG,CAACpJ,IAAJ,GAAWojB,OAAO,IAAI,KAAtB;AACA,WAAOha,GAAP;AACD,GAjCD;;AAkCA,MAAI2rH,aAAa,GAAG,UAAU17G,QAAV,EAAoB;AACtC,QAAI,CAACA,QAAD,IAAa,OAAOA,QAAP,KAAoB,QAArC,EAA+C;AAC7C,aAAO,EAAP;AACD;;AACDA,IAAAA,QAAQ,GAAGA,QAAQ,CAACpE,KAAT,CAAe,SAAf,EAA0B,CAA1B,CAAX;AACAoE,IAAAA,QAAQ,GAAGA,QAAQ,CAACnL,OAAT,CAAiB,qBAAjB,EAAwC,IAAxC,CAAX;AACA,WAAO0I,KAAK,CAAC/R,GAAN,CAAUwU,QAAQ,CAACpE,KAAT,CAAe,yBAAf,CAAV,EAAqD,UAAUlK,IAAV,EAAgB;AAC1E,UAAI+Q,QAAQ,GAAGlF,KAAK,CAAC/R,GAAN,CAAUkG,IAAI,CAACkK,KAAL,CAAW,cAAX,CAAV,EAAsC0/G,iBAAtC,CAAf;AACA,UAAIvrH,GAAG,GAAG0S,QAAQ,CAACu0B,GAAT,EAAV;;AACA,UAAIv0B,QAAQ,CAAC5a,MAAb,EAAqB;AACnBkI,QAAAA,GAAG,CAAC0S,QAAJ,GAAeA,QAAf;AACD;;AACD,aAAO1S,GAAP;AACD,KAPM,EAOJf,OAPI,EAAP;AAQD,GAdD;;AAeA,MAAI2sH,UAAU,GAAG,UAAU9hG,MAAV,EAAkBi1C,MAAlB,EAA0B;AACzC,QAAInoE,IAAJ,EAAUi1H,WAAV;AACA,QAAIC,UAAU,GAAG,EAAjB;AAAA,QAAqBC,cAArB;AACA,QAAIC,aAAa,GAAGr5D,gBAAgB,CAAC7oC,MAAD,CAApC;;AACA,QAAIkiG,aAAa,KAAK,EAAtB,EAA0B;AACxB,aAAO,EAAP;AACD;;AACD,QAAIC,UAAU,GAAG,UAAU3pG,GAAV,EAAe;AAC9B,aAAOA,GAAG,CAACxd,OAAJ,CAAY,SAAZ,EAAuB,EAAvB,CAAP;AACD,KAFD;;AAGA,QAAI,OAAOi6D,MAAP,KAAkB,QAAtB,EAAgC;AAC9BA,MAAAA,MAAM,GAAGj1C,MAAM,CAACq1C,SAAP,CAAiB1/D,GAAjB,CAAqBs/D,MAArB,CAAT;;AACA,UAAI,CAACA,MAAL,EAAa;AACX;AACD;;AACDA,MAAAA,MAAM,GAAGA,MAAM,CAAC,CAAD,CAAf;AACD;;AACD,QAAI,aAAaA,MAAjB,EAAyB;AACvB,UAAImtD,UAAU,GAAGprH,KAAK,CAACi+D,MAAD,EAAS,SAAT,CAAtB;;AACA,UAAImtD,UAAU,CAAClxH,EAAX,CAAc,KAAd,CAAJ,EAA0B;AACxB,eAAO,EAAP;AACD,OAFD,MAEO;AACLgxH,QAAAA,aAAa,GAAGE,UAAU,CAAChxH,KAAX,CAAiB8wH,aAAjB,CAAhB;AACD;AACF;;AACDp1H,IAAAA,IAAI,GAAGmoE,MAAM,CAAC5O,KAAP,IAAgB4O,MAAM,CAACljC,MAAvB,IAAiC,MAAxC;AACA,QAAIlwB,KAAK,GAAGggH,aAAa,CAAC5sD,MAAM,CAAC9uD,QAAR,CAAzB;;AACA,QAAItE,KAAK,CAAC7T,MAAV,EAAkB;AAChB,UAAI,CAAC6T,KAAK,CAAC,CAAD,CAAL,CAAS/U,IAAd,EAAoB;AAClB+U,QAAAA,KAAK,CAAC,CAAD,CAAL,CAAS/U,IAAT,GAAgBA,IAAhB;AACD;;AACDA,MAAAA,IAAI,GAAGmoE,MAAM,CAAC9uD,QAAd;AACA47G,MAAAA,WAAW,GAAGhB,oBAAoB,CAACl/G,KAAD,EAAQme,MAAR,CAAlC;AACD,KAND,MAMO;AACL+hG,MAAAA,WAAW,GAAGhB,oBAAoB,CAAC,CAACj0H,IAAD,CAAD,EAASkzB,MAAT,CAAlC;AACD;;AACD,QAAIqiG,UAAU,GAAGr9G,GAAG,CAAC+2B,MAAJ,CAAWjvC,IAAX,EAAiBi1H,WAAjB,EAA8B,CAA9B,KAAoCA,WAAW,CAACx4G,UAAjE;AACAu3G,IAAAA,MAAM,CAAC7rD,MAAM,CAAC9iD,MAAR,EAAgB,UAAUziB,KAAV,EAAiB5C,IAAjB,EAAuB;AAC3C,UAAI+qB,QAAQ,GAAGsqG,UAAU,CAACzyH,KAAD,CAAzB;;AACA,UAAImoB,QAAJ,EAAc;AACZ7S,QAAAA,GAAG,CAAC2qC,QAAJ,CAAa0yE,UAAb,EAAyBv1H,IAAzB,EAA+B+qB,QAA/B;AACD;AACF,KALK,CAAN;AAMAipG,IAAAA,MAAM,CAAC7rD,MAAM,CAACtjD,UAAR,EAAoB,UAAUjiB,KAAV,EAAiB5C,IAAjB,EAAuB;AAC/C,UAAI+qB,QAAQ,GAAGsqG,UAAU,CAACzyH,KAAD,CAAzB;;AACA,UAAImoB,QAAJ,EAAc;AACZ7S,QAAAA,GAAG,CAAC8pC,SAAJ,CAAcuzE,UAAd,EAA0Bv1H,IAA1B,EAAgC+qB,QAAhC;AACD;AACF,KALK,CAAN;AAMAipG,IAAAA,MAAM,CAAC7rD,MAAM,CAACrY,OAAR,EAAiB,UAAUltD,KAAV,EAAiB;AACtC,UAAImoB,QAAQ,GAAGsqG,UAAU,CAACzyH,KAAD,CAAzB;;AACA,UAAI,CAACsV,GAAG,CAACykC,QAAJ,CAAa44E,UAAb,EAAyBxqG,QAAzB,CAAL,EAAyC;AACvC7S,QAAAA,GAAG,CAAC4mC,QAAJ,CAAay2E,UAAb,EAAyBxqG,QAAzB;AACD;AACF,KALK,CAAN;AAMAmI,IAAAA,MAAM,CAACmb,IAAP,CAAY,gBAAZ;AACAn2B,IAAAA,GAAG,CAAC6qC,SAAJ,CAAckyE,WAAd,EAA2B;AACzBvxD,MAAAA,QAAQ,EAAE,UADe;AAEzBrkD,MAAAA,IAAI,EAAE,CAAC;AAFkB,KAA3B;AAIA6T,IAAAA,MAAM,CAACo6B,OAAP,GAAiB/uC,WAAjB,CAA6B02G,WAA7B;AACAE,IAAAA,cAAc,GAAGj9G,GAAG,CAAC+qC,QAAJ,CAAa/vB,MAAM,CAACo6B,OAAP,EAAb,EAA+B,UAA/B,EAA2C,IAA3C,CAAjB;AACA6nE,IAAAA,cAAc,GAAG,MAAMpoH,IAAN,CAAWooH,cAAX,IAA6B32F,QAAQ,CAAC22F,cAAD,EAAiB,EAAjB,CAArC,GAA4D,CAA7E;AACAnB,IAAAA,MAAM,CAACoB,aAAa,CAACngH,KAAd,CAAoB,GAApB,CAAD,EAA2B,UAAUjV,IAAV,EAAgB;AAC/C,UAAI4C,KAAK,GAAGsV,GAAG,CAAC+qC,QAAJ,CAAasyE,UAAb,EAAyBv1H,IAAzB,EAA+B,IAA/B,CAAZ;;AACA,UAAIA,IAAI,KAAK,kBAAT,IAA+B,oCAAoC+M,IAApC,CAAyCnK,KAAzC,CAAnC,EAAoF;AAClFA,QAAAA,KAAK,GAAGsV,GAAG,CAAC+qC,QAAJ,CAAa/vB,MAAM,CAACo6B,OAAP,EAAb,EAA+BttD,IAA/B,EAAqC,IAArC,CAAR;;AACA,YAAIkY,GAAG,CAACyvB,KAAJ,CAAU/kC,KAAV,EAAiB2L,WAAjB,OAAmC,SAAvC,EAAkD;AAChD;AACD;AACF;;AACD,UAAIvO,IAAI,KAAK,OAAb,EAAsB;AACpB,YAAIkY,GAAG,CAACyvB,KAAJ,CAAU/kC,KAAV,EAAiB2L,WAAjB,OAAmC,SAAvC,EAAkD;AAChD;AACD;AACF;;AACD,UAAIvO,IAAI,KAAK,WAAb,EAA0B;AACxB,YAAI,QAAQ+M,IAAR,CAAanK,KAAb,CAAJ,EAAyB;AACvB,cAAIuyH,cAAc,KAAK,CAAvB,EAA0B;AACxB;AACD;;AACD,cAAIK,QAAQ,GAAG38C,UAAU,CAACj2E,KAAD,CAAV,IAAqB,KAAKmK,IAAL,CAAUnK,KAAV,IAAmB,GAAnB,GAAyB,CAA9C,CAAf;AACAA,UAAAA,KAAK,GAAG4yH,QAAQ,GAAGL,cAAX,GAA4B,IAApC;AACD;AACF;;AACD,UAAIn1H,IAAI,KAAK,QAAT,IAAqB4C,KAAzB,EAAgC;AAC9BsyH,QAAAA,UAAU,IAAI,gBAAd;AACD;;AACDA,MAAAA,UAAU,IAAIl1H,IAAI,GAAG,GAAP,GAAa4C,KAAb,GAAqB,GAAnC;AACD,KA1BK,CAAN;AA2BAswB,IAAAA,MAAM,CAACmb,IAAP,CAAY,qBAAZ;AACAn2B,IAAAA,GAAG,CAAC6G,MAAJ,CAAWk2G,WAAX;AACA,WAAOC,UAAP;AACD,GA7FD;;AA+FA,MAAIO,OAAO,GAAG,UAAUviG,MAAV,EAAkB;AAC9BA,IAAAA,MAAM,CAACwiG,WAAP,CAAmB,QAAnB,EAA6B,EAA7B,EAAiC,MAAjC;AACAxiG,IAAAA,MAAM,CAACwiG,WAAP,CAAmB,QAAnB,EAA6B,EAA7B,EAAiC,QAAjC;AACAxiG,IAAAA,MAAM,CAACwiG,WAAP,CAAmB,QAAnB,EAA6B,EAA7B,EAAiC,WAAjC;;AACA,SAAK,IAAIt0H,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAI,CAArB,EAAwBA,CAAC,EAAzB,EAA6B;AAC3B8xB,MAAAA,MAAM,CAACwiG,WAAP,CAAmB,YAAYt0H,CAA/B,EAAkC,EAAlC,EAAsC,CACpC,aADoC,EAEpC,KAFoC,EAGpC,MAAMA,CAH8B,CAAtC;AAKD;;AACD8xB,IAAAA,MAAM,CAACwiG,WAAP,CAAmB,UAAnB,EAA+B,EAA/B,EAAmC,CACjC,aADiC,EAEjC,KAFiC,EAGjC,GAHiC,CAAnC;AAKAxiG,IAAAA,MAAM,CAACwiG,WAAP,CAAmB,UAAnB,EAA+B,EAA/B,EAAmC,CACjC,aADiC,EAEjC,KAFiC,EAGjC,KAHiC,CAAnC;AAKAxiG,IAAAA,MAAM,CAACwiG,WAAP,CAAmB,UAAnB,EAA+B,EAA/B,EAAmC,CACjC,aADiC,EAEjC,KAFiC,EAGjC,SAHiC,CAAnC;AAKD,GA1BD;;AA4BA,MAAIC,SAAS,GAAG,UAAUziG,MAAV,EAAkB;AAChC,QAAIg0E,OAAO,GAAG4sB,cAAc,CAAC5gG,MAAD,CAA5B;AACA,QAAI0iG,iBAAiB,GAAGntE,IAAI,CAAC,IAAD,CAA5B;AACAgtE,IAAAA,OAAO,CAACviG,MAAD,CAAP;AACAksE,IAAAA,OAAO,CAAClsE,MAAD,CAAP;AACA,WAAO;AACLrqB,MAAAA,GAAG,EAAEq+F,OAAO,CAACr+F,GADR;AAELuB,MAAAA,GAAG,EAAE88F,OAAO,CAAC98F,GAFR;AAGLolD,MAAAA,QAAQ,EAAE03C,OAAO,CAAC13C,QAHb;AAILukE,MAAAA,UAAU,EAAE7sB,OAAO,CAAC6sB,UAJf;AAKLzxH,MAAAA,KAAK,EAAE,UAAUtC,IAAV,EAAgBynE,IAAhB,EAAsB3vD,IAAtB,EAA4B;AACjCw7F,QAAAA,aAAa,CAACpgF,MAAD,EAASlzB,IAAT,EAAeynE,IAAf,EAAqB3vD,IAArB,CAAb;AACD,OAPI;AAQLiH,MAAAA,MAAM,EAAE,UAAU/e,IAAV,EAAgBynE,IAAhB,EAAsB3vD,IAAtB,EAA4BykF,OAA5B,EAAqC;AAC3CgX,QAAAA,cAAc,CAACrgF,MAAD,EAASlzB,IAAT,EAAeynE,IAAf,EAAqB3vD,IAArB,EAA2BykF,OAA3B,CAAd;AACD,OAVI;AAWL+K,MAAAA,MAAM,EAAE,UAAUtnG,IAAV,EAAgBynE,IAAhB,EAAsB3vD,IAAtB,EAA4B;AAClC07F,QAAAA,YAAY,CAACtgF,MAAD,EAASlzB,IAAT,EAAeynE,IAAf,EAAqB3vD,IAArB,CAAZ;AACD,OAbI;AAcLlC,MAAAA,KAAK,EAAE,UAAU5V,IAAV,EAAgBynE,IAAhB,EAAsB3vD,IAAtB,EAA4B;AACjC,eAAOm7F,WAAW,CAAC//E,MAAD,EAASlzB,IAAT,EAAeynE,IAAf,EAAqB3vD,IAArB,CAAlB;AACD,OAhBI;AAiBL4Z,MAAAA,OAAO,EAAE,UAAUrP,KAAV,EAAiB;AACxB,eAAOgxF,aAAa,CAACngF,MAAD,EAAS7Q,KAAT,CAApB;AACD,OAnBI;AAoBLo6E,MAAAA,QAAQ,EAAE,UAAUp6E,KAAV,EAAiBolD,IAAjB,EAAuB;AAC/B,eAAOyrC,eAAe,CAAChgF,MAAD,EAAS7Q,KAAT,EAAgBolD,IAAhB,CAAtB;AACD,OAtBI;AAuBL00B,MAAAA,SAAS,EAAE,UAAUrkF,IAAV,EAAgBuK,KAAhB,EAAuBolD,IAAvB,EAA6B80B,OAA7B,EAAsC;AAC/C,eAAO4W,eAAe,CAACjgF,MAAD,EAASpb,IAAT,EAAeuK,KAAf,EAAsBolD,IAAtB,EAA4B80B,OAA5B,CAAtB;AACD,OAzBI;AA0BLO,MAAAA,QAAQ,EAAE,UAAU98F,IAAV,EAAgB;AACxB,eAAOozG,cAAc,CAAClgF,MAAD,EAASlzB,IAAT,CAArB;AACD,OA5BI;AA6BL2wG,MAAAA,aAAa,EAAE,UAAUzJ,OAAV,EAAmBr8F,QAAnB,EAA6B0xF,OAA7B,EAAsC;AACnD,eAAOoU,aAAa,CAACz9E,MAAD,EAAS0iG,iBAAT,EAA4B1uB,OAA5B,EAAqCr8F,QAArC,EAA+C0xF,OAA/C,CAApB;AACD,OA/BI;AAgCLy4B,MAAAA,UAAU,EAAElyH,KAAK,CAACkyH,UAAD,EAAa9hG,MAAb;AAhCZ,KAAP;AAkCD,GAvCD;;AAyCA,MAAI2iG,gBAAgB,GAAG,UAAU3iG,MAAV,EAAkB27C,WAAlB,EAA+BmgC,KAA/B,EAAsC;AAC3D,QAAI8mB,qBAAqB,GAAGrtE,IAAI,CAAC,KAAD,CAAhC;;AACA,QAAIstE,qBAAqB,GAAG,UAAUhqH,CAAV,EAAa;AACvCkjG,MAAAA,SAAS,CAACpgC,WAAD,EAAc,KAAd,EAAqBmgC,KAArB,CAAT;AACAngC,MAAAA,WAAW,CAACtuC,GAAZ,CAAgB,EAAhB,EAAoBx0B,CAApB;AACD,KAHD;;AAIAmnB,IAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,YAAY;AAC5B6lD,MAAAA,WAAW,CAACtuC,GAAZ;AACD,KAFD;AAGArN,IAAAA,MAAM,CAAClK,EAAP,CAAU,mBAAV,EAA+B,UAAUjd,CAAV,EAAa;AAC1C,UAAIiqH,GAAG,GAAGjqH,CAAC,CAACkqH,OAAF,CAAU1nH,WAAV,EAAV;;AACA,UAAIynH,GAAG,KAAK,MAAR,IAAkBA,GAAG,KAAK,MAA1B,IAAoCA,GAAG,KAAK,YAAhD,EAA8D;AAC5D7mB,QAAAA,SAAS,CAACtgC,WAAD,EAAcmgC,KAAd,CAAT;AACAngC,QAAAA,WAAW,CAACwgC,YAAZ;AACD;AACF,KAND;AAOAn8E,IAAAA,MAAM,CAAClK,EAAP,CAAU,aAAV,EAAyB,UAAUjd,CAAV,EAAa;AACpC,UAAIiqH,GAAG,GAAGjqH,CAAC,CAACkqH,OAAF,CAAU1nH,WAAV,EAAV;;AACA,UAAIynH,GAAG,KAAK,MAAR,IAAkBA,GAAG,KAAK,MAA1B,IAAoCA,GAAG,KAAK,YAAhD,EAA8D;AAC5DD,QAAAA,qBAAqB,CAAChqH,CAAD,CAArB;AACD;AACF,KALD;AAMAmnB,IAAAA,MAAM,CAAClK,EAAP,CAAU,uBAAV,EAAmC,YAAY;AAC7C6lD,MAAAA,WAAW,CAACwgC,YAAZ;AACD,KAFD;AAGAn8E,IAAAA,MAAM,CAAClK,EAAP,CAAU,gCAAV,EAA4C+sG,qBAA5C;AACA7iG,IAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB+sG,qBAArB;AACA7iG,IAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,UAAUjd,CAAV,EAAa;AAC9B,UAAIozF,OAAO,GAAGpzF,CAAC,CAACozF,OAAhB;;AACA,UAAIpzF,CAAC,CAACk/B,kBAAF,EAAJ,EAA4B;AAC1B;AACD;;AACD,UAAIk0D,OAAO,IAAI,EAAX,IAAiBA,OAAO,IAAI,EAA5B,IAAkCA,OAAO,IAAI,EAAX,IAAiBA,OAAO,IAAI,EAA9D,IAAoEA,OAAO,KAAK,EAAhF,IAAsFpzF,CAAC,CAACslE,OAA5F,EAAqG;AACnG0kD,QAAAA,qBAAqB;AACrB7iG,QAAAA,MAAM,CAAC2hD,WAAP;AACD;;AACD,UAAIsqB,OAAO,KAAK,EAAZ,IAAkBA,OAAO,KAAK,CAAlC,EAAqC;AACnCjsE,QAAAA,MAAM,CAAC2hD,WAAP;AACD;;AACD,UAAIihD,qBAAqB,CAACjtH,GAAtB,MAA+BgmE,WAAW,CAACqgC,MAA3C,IAAqDJ,MAAM,CAACX,gBAAgB,CAACj7E,MAAD,CAAjB,EAA2B27C,WAAW,CAACnhD,IAAZ,CAAiB,CAAjB,CAA3B,CAAN,KAA0D,KAAnH,EAA0H;AACxH,YAAIwF,MAAM,CAACgjG,OAAP,OAAqB,KAAzB,EAAgC;AAC9BhjG,UAAAA,MAAM,CAACy8E,QAAP,CAAgB,IAAhB;AACAz8E,UAAAA,MAAM,CAACmb,IAAP,CAAY,QAAZ,EAAsB;AACpBkgE,YAAAA,KAAK,EAAE1/B,WAAW,CAACnhD,IAAZ,CAAiB,CAAjB,CADa;AAEpB8hF,YAAAA,SAAS,EAAE;AAFS,WAAtB;AAID;;AACDt8E,QAAAA,MAAM,CAACmb,IAAP,CAAY,YAAZ;AACAynF,QAAAA,qBAAqB,CAACzxG,GAAtB,CAA0B,KAA1B;AACA6O,QAAAA,MAAM,CAAC2hD,WAAP;AACD;AACF,KAxBD;AAyBA3hD,IAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAUjd,CAAV,EAAa;AAChC,UAAIozF,OAAO,GAAGpzF,CAAC,CAACozF,OAAhB;;AACA,UAAIpzF,CAAC,CAACk/B,kBAAF,EAAJ,EAA4B;AAC1B;AACD;;AACD,UAAIk0D,OAAO,IAAI,EAAX,IAAiBA,OAAO,IAAI,EAA5B,IAAkCA,OAAO,IAAI,EAAX,IAAiBA,OAAO,IAAI,EAA9D,IAAoEA,OAAO,KAAK,EAApF,EAAwF;AACtF,YAAItwB,WAAW,CAACqgC,MAAhB,EAAwB;AACtB6mB,UAAAA,qBAAqB,CAAChqH,CAAD,CAArB;AACD;;AACD;AACD;;AACD,UAAIoqH,MAAM,GAAGpqH,CAAC,CAACslE,OAAF,IAAa,CAACtlE,CAAC,CAACulE,MAAhB,IAA0BvlE,CAAC,CAAC4gC,OAAzC;;AACA,UAAI,CAACwyD,OAAO,GAAG,EAAV,IAAgBA,OAAO,GAAG,EAA3B,KAAkCA,OAAO,KAAK,GAA9C,IAAqDA,OAAO,KAAK,EAAjE,IAAuE,CAACtwB,WAAW,CAACqgC,MAApF,IAA8F,CAACinB,MAAnG,EAA2G;AACzGtnD,QAAAA,WAAW,CAACwgC,YAAZ;AACAJ,QAAAA,SAAS,CAACpgC,WAAD,EAAc,IAAd,EAAoBmgC,KAApB,CAAT;AACAngC,QAAAA,WAAW,CAACtuC,GAAZ,CAAgB,EAAhB,EAAoBx0B,CAApB;AACA+pH,QAAAA,qBAAqB,CAACzxG,GAAtB,CAA0B,IAA1B;AACD;AACF,KAlBD;AAmBA6O,IAAAA,MAAM,CAAClK,EAAP,CAAU,WAAV,EAAuB,UAAUjd,CAAV,EAAa;AAClC,UAAI8iE,WAAW,CAACqgC,MAAhB,EAAwB;AACtB6mB,QAAAA,qBAAqB,CAAChqH,CAAD,CAArB;AACD;AACF,KAJD;;AAKA,QAAIqqH,uBAAuB,GAAG,UAAU54G,KAAV,EAAiB;AAC7C,aAAOA,KAAK,CAAC64G,SAAN,KAAoB,uBAA3B;AACD,KAFD;;AAGA,QAAIC,oBAAoB,GAAG,UAAU94G,KAAV,EAAiB;AAC1C,aAAOA,KAAK,CAAC64G,SAAN,KAAoB,YAApB,IAAoC74G,KAAK,CAACkQ,IAAN,KAAe,IAA1D;AACD,KAFD;;AAGA,QAAI6oG,uBAAuB,GAAG,UAAU/4G,KAAV,EAAiB;AAC7C,aAAOA,KAAK,CAAC64G,SAAN,KAAoB,iBAApB,IAAyC74G,KAAK,CAAC64G,SAAN,KAAoB,gBAApE;AACD,KAFD;;AAGAnjG,IAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,UAAUjd,CAAV,EAAa;AAC9B,UAAIA,CAAC,CAACsqH,SAAF,KAAgBD,uBAAuB,CAACrqH,CAAD,CAAvB,IAA8BuqH,oBAAoB,CAACvqH,CAAD,CAAlD,IAAyDwqH,uBAAuB,CAACxqH,CAAD,CAAhG,CAAJ,EAA0G;AACxGgqH,QAAAA,qBAAqB,CAAChqH,CAAD,CAArB;AACD;AACF,KAJD;AAKAmnB,IAAAA,MAAM,CAAClK,EAAP,CAAU,8BAAV,EAA0C,UAAUjd,CAAV,EAAa;AACrD,UAAI,CAACA,CAAC,CAACk/B,kBAAF,EAAL,EAA6B;AAC3B/X,QAAAA,MAAM,CAAC2hD,WAAP;AACD;AACF,KAJD;AAKD,GA/FD;;AAgGA,MAAI2hD,oBAAoB,GAAG,UAAUtjG,MAAV,EAAkB;AAC3CA,IAAAA,MAAM,CAACwiG,WAAP,CAAmB,QAAnB,EAA6B,EAA7B,EAAiC,MAAjC;AACAxiG,IAAAA,MAAM,CAACwiG,WAAP,CAAmB,qBAAnB,EAA0C,EAA1C,EAA8C,MAA9C;AACD,GAHD;;AAKA,MAAIe,WAAW,GAAG,UAAUvjG,MAAV,EAAkB;AAClC,QAAI+6E,cAAc,GAAGxlD,IAAI,CAAC1iD,QAAQ,CAACrC,IAAT,EAAD,CAAzB;AACA,QAAIsrG,KAAK,GAAGvmD,IAAI,CAAC,CAAD,CAAhB;AACA,QAAIz9C,KAAK,GAAGy9C,IAAI,CAAC,CAAD,CAAhB;AACA,QAAIomB,WAAW,GAAG;AAChBnhD,MAAAA,IAAI,EAAE,EADU;AAEhBwhF,MAAAA,MAAM,EAAE,KAFQ;AAGhBG,MAAAA,YAAY,EAAE,YAAY;AACxBiD,QAAAA,cAAc,CAACp/E,MAAD,EAAS87E,KAAT,EAAgBf,cAAhB,CAAd;AACD,OALe;AAMhB1tE,MAAAA,GAAG,EAAE,UAAUguE,KAAV,EAAiB/wF,KAAjB,EAAwB;AAC3B,eAAO+0F,cAAc,CAACr/E,MAAD,EAAS27C,WAAT,EAAsB7jE,KAAtB,EAA6BgkG,KAA7B,EAAoCf,cAApC,EAAoDM,KAApD,EAA2D/wF,KAA3D,CAArB;AACD,OARe;AAShByyF,MAAAA,IAAI,EAAE,YAAY;AAChB,eAAOuC,MAAM,CAACt/E,MAAD,EAAS27C,WAAT,EAAsBmgC,KAAtB,EAA6BhkG,KAA7B,CAAb;AACD,OAXe;AAYhBglG,MAAAA,IAAI,EAAE,YAAY;AAChB,eAAOyC,MAAM,CAACv/E,MAAD,EAASloB,KAAT,EAAgB6jE,WAAW,CAACnhD,IAA5B,CAAb;AACD,OAde;AAehBkiF,MAAAA,KAAK,EAAE,YAAY;AACjB8C,QAAAA,OAAO,CAACx/E,MAAD,EAAS27C,WAAT,EAAsB7jE,KAAtB,CAAP;AACD,OAjBe;AAkBhBu/E,MAAAA,KAAK,EAAE,YAAY;AACjBooB,QAAAA,OAAO,CAACz/E,MAAD,EAAS27C,WAAT,CAAP;AACD,OApBe;AAqBhBqhC,MAAAA,OAAO,EAAE,YAAY;AACnB,eAAO0C,SAAS,CAAC1/E,MAAD,EAAS27C,WAAT,EAAsB7jE,KAAtB,CAAhB;AACD,OAvBe;AAwBhBmlG,MAAAA,OAAO,EAAE,YAAY;AACnB,eAAO0C,SAAS,CAAC3/E,MAAD,EAAS27C,WAAT,EAAsB7jE,KAAtB,CAAhB;AACD,OA1Be;AA2BhB8jE,MAAAA,QAAQ,EAAE,UAAUjkE,QAAV,EAAoB;AAC5B,eAAOioG,UAAU,CAAC5/E,MAAD,EAAS27C,WAAT,EAAsBmgC,KAAtB,EAA6BnkG,QAA7B,CAAjB;AACD,OA7Be;AA8BhBulG,MAAAA,MAAM,EAAE,UAAUvlG,QAAV,EAAoB;AAC1BkoG,QAAAA,QAAQ,CAAC7/E,MAAD,EAAS87E,KAAT,EAAgBnkG,QAAhB,CAAR;AACD,OAhCe;AAiChBglG,MAAAA,KAAK,EAAE,UAAUC,SAAV,EAAqBC,SAArB,EAAgC;AACrCiD,QAAAA,OAAO,CAAC9/E,MAAD,EAAS27C,WAAT,EAAsB7jE,KAAtB,EAA6B8kG,SAA7B,EAAwCC,SAAxC,CAAP;AACD;AAnCe,KAAlB;;AAqCA,QAAI,CAAC8B,KAAK,CAAC3+E,MAAD,CAAV,EAAoB;AAClB2iG,MAAAA,gBAAgB,CAAC3iG,MAAD,EAAS27C,WAAT,EAAsBmgC,KAAtB,CAAhB;AACD;;AACDwnB,IAAAA,oBAAoB,CAACtjG,MAAD,CAApB;AACA,WAAO27C,WAAP;AACD,GA9CD;;AAgDA,MAAI6nD,iBAAiB,GAAG,CACtB,CADsB,EAEtB,EAFsB,EAGtBnmD,EAAE,CAACW,IAHmB,EAItBX,EAAE,CAACU,GAJmB,EAKtB,EALsB,EAMtB,EANsB,EAOtB,EAPsB,EAQtB,GARsB,EAStB,GATsB,EAUtB,EAVsB,EAWtB,EAXsB,EAYtB,EAZsB,EAatB,EAbsB,EActB,EAdsB,EAetB,EAfsB,EAgBtB,EAhBsB,EAiBtB,EAjBsB,EAkBtB,EAlBsB,EAmBtBV,EAAE,CAACG,IAnBmB,EAoBtBH,EAAE,CAACS,EApBmB,EAqBtBT,EAAE,CAACK,IArBmB,EAsBtBL,EAAE,CAACM,KAtBmB,EAuBtB1tE,MAvBsB,CAuBfwQ,GAAG,CAACjH,OAAJ,CAAY6E,SAAZ,KAA0B,CAAC,GAAD,CAA1B,GAAkC,EAvBnB,CAAxB;AAwBA,MAAIolH,eAAe,GAAG,sBAAtB;;AACA,MAAIC,eAAe,GAAG,UAAU7qH,CAAV,EAAa;AACjC,WAAOA,CAAC,CAAC7F,IAAF,KAAW,SAAX,IAAwB6F,CAAC,CAAC7F,IAAF,KAAW,OAA1C;AACD,GAFD;;AAGA,MAAI2wH,aAAa,GAAG,UAAU9qH,CAAV,EAAa;AAC/B,QAAIozF,OAAO,GAAGpzF,CAAC,CAACozF,OAAhB;AACA,WAAOA,OAAO,KAAK5uB,EAAE,CAACC,SAAf,IAA4B2uB,OAAO,KAAK5uB,EAAE,CAACE,MAAlD;AACD,GAHD;;AAIA,MAAIqmD,wBAAwB,GAAG,UAAU/qH,CAAV,EAAa;AAC1C,QAAI6qH,eAAe,CAAC7qH,CAAD,CAAnB,EAAwB;AACtB,UAAIozF,OAAO,GAAGpzF,CAAC,CAACozF,OAAhB;AACA,aAAO,CAAC03B,aAAa,CAAC9qH,CAAD,CAAd,KAAsBwkE,EAAE,CAACgB,cAAH,CAAkBxlE,CAAlB,KAAwBA,CAAC,CAACulE,MAA1B,IAAoC6tB,OAAO,IAAI,GAAX,IAAkBA,OAAO,IAAI,GAAjE,IAAwE73F,QAAQ,CAACovH,iBAAD,EAAoBv3B,OAApB,CAAtG,CAAP;AACD,KAHD,MAGO;AACL,aAAO,KAAP;AACD;AACF,GAPD;;AAQA,MAAI43B,qBAAqB,GAAG,UAAUhrH,CAAV,EAAa;AACvC,WAAO6qH,eAAe,CAAC7qH,CAAD,CAAf,IAAsB,EAAE8qH,aAAa,CAAC9qH,CAAD,CAAb,IAAoBA,CAAC,CAAC7F,IAAF,KAAW,OAAX,IAAsB6F,CAAC,CAACozF,OAAF,KAAc,GAA1D,CAA7B;AACD,GAFD;;AAGA,MAAI63B,eAAe,GAAG,UAAU9+G,GAAV,EAAeuO,OAAf,EAAwB67E,eAAxB,EAAyC;AAC7D,QAAIzlE,OAAO,CAACvkB,YAAY,CAACX,OAAb,CAAqB8O,OAArB,CAAD,EAAgC,KAAhC,CAAX,EAAmD;AACjD,UAAIwwG,sBAAsB,GAAG30B,eAAe,KAAK,EAAjD;AACA,UAAIx8E,YAAY,GAAGW,OAAO,CAAC+sD,iBAA3B;;AACA,UAAI,CAAC1tD,YAAL,EAAmB;AACjB,eAAO,IAAP;AACD,OAFD,MAEO,IAAI5N,GAAG,CAAC+qC,QAAJ,CAAax8B,OAAO,CAAC+sD,iBAArB,EAAwC,cAAxC,KAA2Dt7D,GAAG,CAAC+qC,QAAJ,CAAax8B,OAAO,CAAC+sD,iBAArB,EAAwC,eAAxC,CAA/D,EAAyH;AAC9H,eAAO,KAAP;AACD,OAFM,MAEA;AACL,eAAOyjD,sBAAsB,GAAG,CAAC/+G,GAAG,CAAC4f,OAAJ,CAAYhS,YAAZ,CAAJ,GAAgCw8E,eAAe,KAAKx8E,YAAY,CAACnL,QAAb,CAAsBpM,WAAtB,EAAjF;AACD;AACF,KAVD,MAUO;AACL,aAAO,KAAP;AACD;AACF,GAdD;;AAeA,MAAI2oH,OAAO,GAAG,UAAUhkG,MAAV,EAAkB;AAC9B,QAAIhb,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,QAAIinD,SAAS,GAAG7F,kBAAkB,CAACpmC,MAAD,CAAlC;AACA,QAAIikG,WAAW,GAAG57D,cAAc,CAACroC,MAAD,CAAhC;;AACA,QAAIkkG,iBAAiB,GAAG,UAAUrrH,CAAV,EAAa28C,OAAb,EAAsB;AAC5C,UAAIouE,wBAAwB,CAAC/qH,CAAD,CAA5B,EAAiC;AAC/B;AACD;;AACD,UAAIqT,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAAX;AACA,UAAI+pE,eAAe,GAAGN,qBAAqB,CAAChrH,CAAD,CAArB,GAA2B,KAA3B,GAAmCirH,eAAe,CAAC9+G,GAAD,EAAMkH,IAAN,EAAY+/C,SAAZ,CAAxE;AACA,UAAIm4D,kBAAkB,GAAGp/G,GAAG,CAAC2pC,SAAJ,CAAcziC,IAAd,EAAoBu3G,eAApB,MAAyC,EAAlE;;AACA,UAAIW,kBAAkB,KAAKD,eAAvB,IAA0C3uE,OAA9C,EAAuD;AACrDxwC,QAAAA,GAAG,CAAC8pC,SAAJ,CAAc5iC,IAAd,EAAoBu3G,eAApB,EAAqCU,eAAe,GAAGF,WAAH,GAAiB,IAArE;AACAj/G,QAAAA,GAAG,CAAC8pC,SAAJ,CAAc5iC,IAAd,EAAoB,kBAApB,EAAwCi4G,eAAe,GAAGF,WAAH,GAAiB,IAAxE;AACA/mD,QAAAA,qBAAqB,CAACl9C,MAAD,EAASmkG,eAAT,CAArB;AACAnkG,QAAAA,MAAM,CAAClK,EAAP,CAAUquG,eAAe,GAAG,SAAH,GAAe,OAAxC,EAAiDD,iBAAjD;AACAlkG,QAAAA,MAAM,CAAC/J,GAAP,CAAWkuG,eAAe,GAAG,OAAH,GAAa,SAAvC,EAAkDD,iBAAlD;AACD;AACF,KAdD;;AAeA,QAAID,WAAJ,EAAiB;AACfjkG,MAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,UAAUjd,CAAV,EAAa;AAC7BqrH,QAAAA,iBAAiB,CAACrrH,CAAD,EAAI,IAAJ,CAAjB;AACAmnB,QAAAA,MAAM,CAAClK,EAAP,CAAU,+BAAV,EAA2CouG,iBAA3C;AACAlkG,QAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,UAAUjd,CAAV,EAAa;AAC9B,iBAAOinB,KAAK,CAACC,gBAAN,CAAuBC,MAAvB,EAA+B,YAAY;AAChD,mBAAOkkG,iBAAiB,CAACrrH,CAAD,CAAxB;AACD,WAFM,CAAP;AAGD,SAJD;AAKD,OARD;AASD;AACF,GA9BD;;AAgCA,MAAIwrH,SAAS,GAAG,2CAAhB;;AACA,MAAIC,YAAY,GAAG,UAAUx/G,IAAV,EAAgB;AACjC,WAAOu/G,SAAS,CAACxqH,IAAV,CAAeiL,IAAf,CAAP;AACD,GAFD;;AAIA,MAAIy/G,cAAc,GAAG,UAAUvkG,MAAV,EAAkBjN,GAAlB,EAAuB;AAC1C,WAAO9M,IAAI,CAACb,YAAY,CAACX,OAAb,CAAqBsO,GAArB,CAAD,EAA4Bm1C,yBAAyB,CAACloC,MAAD,CAArD,CAAX;AACD,GAFD;;AAGA,MAAIwkG,OAAO,GAAG,UAAUt+G,OAAV,EAAmB;AAC/B,WAAO6nC,QAAQ,CAAC2D,GAAT,CAAa3B,QAAb,CAAsB7pC,OAAtB,EAA+B,WAA/B,EAA4C,IAA5C,MAAsD,KAAtD,IAA+Do+G,YAAY,CAACp+G,OAAO,CAACyF,WAAT,CAAlF;AACD,GAFD;;AAGA,MAAI84G,iBAAiB,GAAG,UAAUF,cAAV,EAA0B/gG,QAA1B,EAAoC/P,GAApC,EAAyC;AAC/D,WAAOzhB,MAAM,CAAC+7C,QAAQ,CAAC2D,GAAT,CAAatB,UAAb,CAAwB38B,GAAG,CAACnS,SAAJ,EAAxB,EAAyC,GAAzC,EAA8CkiB,QAA9C,CAAD,EAA0D+gG,cAA1D,CAAb;AACD,GAFD;;AAGA,MAAIG,cAAc,GAAG,UAAUH,cAAV,EAA0B/gG,QAA1B,EAAoC/P,GAApC,EAAyC;AAC5D,QAAIlL,OAAO,GAAGk8G,iBAAiB,CAACF,cAAD,EAAiB/gG,QAAjB,EAA2B/P,GAA3B,CAA/B;AACA,WAAO5gB,QAAQ,CAACD,IAAT,CAAc2V,OAAO,CAACA,OAAO,CAACva,MAAR,GAAiB,CAAlB,CAArB,CAAP;AACD,GAHD;;AAIA,MAAI22H,kBAAkB,GAAG,UAAUnhG,QAAV,EAAoB2qC,KAApB,EAA2BC,KAA3B,EAAkC;AACzD,QAAIw2D,MAAM,GAAGp3D,cAAc,CAACW,KAAD,EAAQ3qC,QAAR,CAA3B;AACA,QAAIqhG,MAAM,GAAGr3D,cAAc,CAACY,KAAD,EAAQ5qC,QAAR,CAA3B;AACA,WAAOohG,MAAM,IAAIA,MAAM,KAAKC,MAA5B;AACD,GAJD;;AAKA,MAAIC,QAAQ,GAAG,UAAUrxG,GAAV,EAAe;AAC5B,WAAOiT,cAAc,CAACjT,GAAD,CAAd,IAAuBqT,aAAa,CAACrT,GAAD,CAA3C;AACD,GAFD;;AAGA,MAAIsxG,iBAAiB,GAAG,UAAU1hF,OAAV,EAAmB5vB,GAAnB,EAAwB;AAC9C,QAAI,CAACA,GAAL,EAAU;AACR,aAAOA,GAAP;AACD;;AACD,QAAInS,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,EAAhB;AAAA,QAAiCslB,MAAM,GAAGnT,GAAG,CAACmT,MAAJ,EAA1C;;AACA,QAAIyc,OAAJ,EAAa;AACX,UAAInd,sBAAsB,CAAC5kB,SAAD,CAA1B,EAAuC;AACrC,YAAI+O,QAAQ,CAAC/O,SAAS,CAAC4H,WAAX,CAAZ,EAAqC;AACnC,iBAAO24C,aAAa,CAACvgD,SAAS,CAAC4H,WAAX,EAAwB,CAAxB,CAApB;AACD,SAFD,MAEO;AACL,iBAAO24C,aAAa,CAAC72C,KAAd,CAAoB1J,SAApB,CAAP;AACD;AACF,OAND,MAMO;AACL,eAAOolB,cAAc,CAACjT,GAAD,CAAd,GAAsBouC,aAAa,CAACvgD,SAAD,EAAYslB,MAAM,GAAG,CAArB,CAAnC,GAA6DnT,GAApE;AACD;AACF,KAVD,MAUO;AACL,UAAIyS,sBAAsB,CAAC5kB,SAAD,CAA1B,EAAuC;AACrC,YAAI+O,QAAQ,CAAC/O,SAAS,CAAC2H,eAAX,CAAZ,EAAyC;AACvC,iBAAO44C,aAAa,CAACvgD,SAAS,CAAC2H,eAAX,EAA4B3H,SAAS,CAAC2H,eAAV,CAA0BuR,IAA1B,CAA+BxsB,MAA3D,CAApB;AACD,SAFD,MAEO;AACL,iBAAO6zD,aAAa,CAACj3C,MAAd,CAAqBtJ,SAArB,CAAP;AACD;AACF,OAND,MAMO;AACL,eAAOwlB,aAAa,CAACrT,GAAD,CAAb,GAAqBouC,aAAa,CAACvgD,SAAD,EAAYslB,MAAM,GAAG,CAArB,CAAlC,GAA4DnT,GAAnE;AACD;AACF;AACF,GA1BD;;AA2BA,MAAIuxG,iBAAiB,GAAGp1H,KAAK,CAACm1H,iBAAD,EAAoB,IAApB,CAA7B;AACA,MAAIE,kBAAkB,GAAGr1H,KAAK,CAACm1H,iBAAD,EAAoB,KAApB,CAA9B;;AAEA,MAAIG,YAAY,GAAG,UAAU1hG,QAAV,EAAoB;AACrC,WAAO,UAAUzQ,GAAV,EAAe;AACpB,aAAOhM,IAAI,CAACyc,QAAD,EAAWpe,YAAY,CAACX,OAAb,CAAqBsO,GAAG,CAAC/N,GAAJ,CAAQsD,UAA7B,CAAX,CAAX;AACD,KAFD;AAGD,GAJD;;AAKA,MAAI68G,gBAAgB,GAAG,UAAU3hG,QAAV,EAAoBzQ,GAApB,EAAyB;AAC9C,WAAOzL,UAAU,CAACkc,QAAD,EAAWzQ,GAAX,CAAV,GAA4ByL,OAAO,CAACzL,GAAD,EAAM,UAAU7M,OAAV,EAAmB;AACjE,aAAO8e,WAAW,CAAC9e,OAAD,CAAX,IAAwBgf,UAAU,CAAChf,OAAD,CAAzC;AACD,KAFyC,EAEvCg/G,YAAY,CAAC1hG,QAAD,CAF2B,CAAnC,GAEsB3wB,QAAQ,CAACrC,IAAT,EAF7B;AAGD,GAJD;;AAKA,MAAI40H,qBAAqB,GAAG,UAAUplG,MAAV,EAAkB;AAC5C,QAAI9T,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAAX;AACA,QAAIx1C,IAAI,GAAGsH,IAAI,CAAC3C,UAAL,IAAmByW,MAAM,CAAChb,GAAP,CAAW4f,OAAX,CAAmB1Y,IAAI,CAAC3C,UAAxB,CAAnB,GAAyD2C,IAAI,CAAC3C,UAA9D,GAA2E2C,IAAtF;AACA8T,IAAAA,MAAM,CAACk6B,SAAP,CAAiB0kC,iBAAjB,CAAmCh6E,IAAnC,EAAyC,CAAzC;AACD,GAJD;;AAKA,MAAIygH,aAAa,GAAG,UAAUrlG,MAAV,EAAkB;AACpC,QAAIA,MAAM,CAAChb,GAAP,CAAW2kB,OAAX,CAAmB3J,MAAM,CAACo6B,OAAP,EAAnB,CAAJ,EAA0C;AACxCp6B,MAAAA,MAAM,CAAC2+D,UAAP,CAAkB,EAAlB;AACAymC,MAAAA,qBAAqB,CAACplG,MAAD,CAArB;AACD;AACF,GALD;;AAMA,MAAIslG,+BAA+B,GAAG,UAAUjiF,OAAV,EAAmBu/C,OAAnB,EAA4B7vE,GAA5B,EAAiC;AACrE,WAAOirC,KAAK,CAACsT,eAAe,CAACv+C,GAAD,CAAhB,EAAuBw+C,cAAc,CAACx+C,GAAD,CAArC,EAA4C,UAAU4oE,QAAV,EAAoBI,OAApB,EAA6B;AACnF,UAAIwpC,kBAAkB,GAAGR,iBAAiB,CAAC,IAAD,EAAOppC,QAAP,CAA1C;AACA,UAAI6pC,iBAAiB,GAAGT,iBAAiB,CAAC,KAAD,EAAQhpC,OAAR,CAAzC;AACA,UAAI0pC,iBAAiB,GAAGV,iBAAiB,CAAC,KAAD,EAAQniC,OAAR,CAAzC;;AACA,UAAIv/C,OAAJ,EAAa;AACX,eAAO+tB,YAAY,CAACr+C,GAAD,EAAM0yG,iBAAN,CAAZ,CAAqC3zH,MAArC,CAA4C,UAAU4zH,OAAV,EAAmB;AACpE,iBAAOA,OAAO,CAAC/mE,OAAR,CAAgB6mE,iBAAhB,KAAsC5iC,OAAO,CAACjkC,OAAR,CAAgB4mE,kBAAhB,CAA7C;AACD,SAFM,CAAP;AAGD,OAJD,MAIO;AACL,eAAOl0D,YAAY,CAACt+C,GAAD,EAAM0yG,iBAAN,CAAZ,CAAqC3zH,MAArC,CAA4C,UAAU6zH,OAAV,EAAmB;AACpE,iBAAOA,OAAO,CAAChnE,OAAR,CAAgB4mE,kBAAhB,KAAuC3iC,OAAO,CAACjkC,OAAR,CAAgB6mE,iBAAhB,CAA9C;AACD,SAFM,CAAP;AAGD;AACF,KAbW,CAAL,CAaJp0H,KAbI,CAaE,IAbF,CAAP;AAcD,GAfD;;AAiBA,MAAIw0H,aAAa,GAAG,UAAUv/D,KAAV,EAAiBmK,QAAjB,EAA2B;AAC7C,WAAO;AACLnK,MAAAA,KAAK,EAAEA,KADF;AAELmK,MAAAA,QAAQ,EAAEA;AAFL,KAAP;AAID,GALD;;AAMA,MAAIq1D,aAAa,GAAG,UAAUjzH,IAAV,EAAgB4a,EAAhB,EAAoB;AACtC,WAAO;AACL5a,MAAAA,IAAI,EAAEA,IADD;AAEL4a,MAAAA,EAAE,EAAEA;AAFC,KAAP;AAID,GALD;;AAMA,MAAIs4G,gBAAgB,GAAG,UAAUtiG,QAAV,EAAoB/P,GAApB,EAAyB;AAC9C,QAAIF,OAAO,GAAGnO,YAAY,CAACX,OAAb,CAAqB+e,QAArB,CAAd;AACA,QAAIuiG,YAAY,GAAG3gH,YAAY,CAACX,OAAb,CAAqBgP,GAAG,CAACnS,SAAJ,EAArB,CAAnB;AACA,WAAO6jH,gBAAgB,CAAC5xG,OAAD,EAAUwyG,YAAV,CAAhB,CAAwCp0H,GAAxC,CAA4C,UAAU00D,KAAV,EAAiB;AAClE,aAAOu/D,aAAa,CAACv/D,KAAD,EAAQ5yC,GAAR,CAApB;AACD,KAFM,CAAP;AAGD,GAND;;AAOA,MAAIuyG,iBAAiB,GAAG,UAAUH,aAAV,EAAyB;AAC/C,WAAO9+G,IAAI,CAAC8+G,aAAa,CAACjzH,IAAd,CAAmByzD,KAApB,EAA2Bw/D,aAAa,CAACr4G,EAAd,CAAiB64C,KAA5C,CAAJ,KAA2D,KAAlE;AACD,GAFD;;AAGA,MAAI4/D,aAAa,GAAG,UAAUJ,aAAV,EAAyB;AAC3C,WAAO7iH,MAAM,CAAC6iH,aAAa,CAACjzH,IAAd,CAAmByzD,KAApB,CAAN,CAAiCx0D,IAAjC,CAAsC,UAAUq0H,OAAV,EAAmB;AAC9D,aAAOljH,MAAM,CAAC6iH,aAAa,CAACr4G,EAAd,CAAiB64C,KAAlB,CAAN,CAA+Br0D,MAA/B,CAAsC,UAAUm0H,OAAV,EAAmB;AAC9D,eAAOp/G,IAAI,CAACm/G,OAAD,EAAUC,OAAV,CAAX;AACD,OAFM,CAAP;AAGD,KAJM,EAIJh1H,MAJI,EAAP;AAKD,GAND;;AAOA,MAAIi1H,UAAU,GAAG,UAAUP,aAAV,EAAyB;AACxC,WAAOj1G,sBAAsB,CAACi1G,aAAa,CAACjzH,IAAd,CAAmByzD,KAAnB,CAAyBrhD,GAA1B,CAAtB,KAAyD,KAAzD,IAAkE4L,sBAAsB,CAACi1G,aAAa,CAACr4G,EAAd,CAAiB64C,KAAjB,CAAuBrhD,GAAxB,CAAtB,KAAuD,KAAhI;AACD,GAFD;;AAGA,MAAIqhH,UAAU,GAAG,UAAU7iG,QAAV,EAAoB6f,OAApB,EAA6BuiF,aAA7B,EAA4C;AAC3D,QAAIn1G,IAAI,CAACm1G,aAAa,CAACp1D,QAAd,CAAuBlR,OAAvB,EAAD,CAAJ,IAA0C31B,OAAO,CAACi8F,aAAa,CAACv/D,KAAf,CAAP,KAAiC,KAA/E,EAAsF;AACpF,aAAO8K,UAAU,CAAC,KAAD,EAAQy0D,aAAa,CAACv/D,KAAd,CAAoBrhD,GAA5B,CAAV,CAA2CnT,IAA3C,CAAgD,UAAUy0H,mBAAV,EAA+B;AACpF,YAAIA,mBAAmB,CAAC3nE,OAApB,CAA4BinE,aAAa,CAACp1D,QAA1C,CAAJ,EAAyD;AACvD,iBAAOC,YAAY,CAACptB,OAAD,EAAU7f,QAAV,EAAoB8iG,mBAApB,CAAZ,CAAqDz0H,IAArD,CAA0D,UAAU2b,EAAV,EAAc;AAC7E,mBAAOs4G,gBAAgB,CAACtiG,QAAD,EAAWhW,EAAX,CAAvB;AACD,WAFM,CAAP;AAGD,SAJD,MAIO;AACL,iBAAO3a,QAAQ,CAACR,IAAT,CAAcuzH,aAAd,CAAP;AACD;AACF,OARM,EAQJx0H,KARI,CAQEw0H,aARF,CAAP;AASD,KAVD,MAUO;AACL,aAAOA,aAAP;AACD;AACF,GAdD;;AAeA,MAAIW,aAAa,GAAG,UAAU/iG,QAAV,EAAoB6f,OAApB,EAA6B4W,GAA7B,EAAkC;AACpD,QAAIusE,YAAY,GAAGV,gBAAgB,CAACtiG,QAAD,EAAWq+B,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAX,CAAnC;AACA,QAAIwsE,UAAU,GAAGD,YAAY,CAAC30H,IAAb,CAAkB,UAAU60H,QAAV,EAAoB;AACrD,aAAOj2D,YAAY,CAACptB,OAAD,EAAU7f,QAAV,EAAoBkjG,QAAQ,CAACl2D,QAA7B,CAAZ,CAAmD3+D,IAAnD,CAAwD,UAAU2b,EAAV,EAAc;AAC3E,eAAOs4G,gBAAgB,CAACtiG,QAAD,EAAWhW,EAAX,CAAhB,CAA+B7b,GAA/B,CAAmC,UAAU+0H,QAAV,EAAoB;AAC5D,iBAAOL,UAAU,CAAC7iG,QAAD,EAAW6f,OAAX,EAAoBqjF,QAApB,CAAjB;AACD,SAFM,CAAP;AAGD,OAJM,CAAP;AAKD,KANgB,CAAjB;AAOA,WAAO1oE,KAAK,CAACwoE,YAAD,EAAeC,UAAf,EAA2BZ,aAA3B,CAAL,CAA+C7zH,MAA/C,CAAsD,UAAU6zH,aAAV,EAAyB;AACpF,aAAOG,iBAAiB,CAACH,aAAD,CAAjB,IAAoCI,aAAa,CAACJ,aAAD,CAAjD,IAAoEO,UAAU,CAACP,aAAD,CAArF;AACD,KAFM,CAAP;AAGD,GAZD;;AAaA,MAAIc,MAAM,GAAG,UAAUnjG,QAAV,EAAoB6f,OAApB,EAA6B4W,GAA7B,EAAkC;AAC7C,WAAOA,GAAG,CAAC+K,SAAJ,GAAgBuhE,aAAa,CAAC/iG,QAAD,EAAW6f,OAAX,EAAoB4W,GAApB,CAA7B,GAAwDpnD,QAAQ,CAACrC,IAAT,EAA/D;AACD,GAFD;;AAIA,MAAIo2H,6BAA6B,GAAG,UAAUvgE,KAAV,EAAiB;AACnD,QAAIr6C,UAAU,GAAGjD,QAAQ,CAACs9C,KAAD,CAAzB;AACA,WAAOpxD,SAAS,CAAC+W,UAAD,EAAa4Y,OAAb,CAAT,CAA+B5zB,IAA/B,CAAoC,YAAY;AACrD,aAAOgb,UAAP;AACD,KAFM,EAEJ,UAAUlU,KAAV,EAAiB;AAClB,aAAOkU,UAAU,CAAC1e,KAAX,CAAiB,CAAjB,EAAoBwK,KAApB,CAAP;AACD,KAJM,CAAP;AAKD,GAPD;;AAQA,MAAI+uH,eAAe,GAAG,UAAUxgE,KAAV,EAAiB;AACrC,QAAIt9C,QAAQ,GAAG69G,6BAA6B,CAACvgE,KAAD,CAA5C;AACAz0D,IAAAA,IAAI,CAACmX,QAAD,EAAW8C,MAAX,CAAJ;AACA,WAAO9C,QAAP;AACD,GAJD;;AAKA,MAAI+9G,eAAe,GAAG,UAAUtjG,QAAV,EAAoB6iC,KAApB,EAA2B;AAC/C,QAAI99C,OAAO,GAAGgxE,cAAc,CAAClzB,KAAD,EAAQ7iC,QAAR,CAA5B;AACA,WAAOxuB,IAAI,CAACuT,OAAO,CAACpT,OAAR,EAAD,EAAoB,UAAU+Q,OAAV,EAAmB;AAChD,aAAOyjB,OAAO,CAACzjB,OAAD,CAAd;AACD,KAFU,CAAJ,CAEJtU,IAFI,CAECia,MAFD,CAAP;AAGD,GALD;;AAMA,MAAIk7G,aAAa,GAAG,UAAUx8G,EAAV,EAAc;AAChC,WAAOvY,MAAM,CAACmX,YAAY,CAACoB,EAAD,CAAb,EAAmB,UAAUA,EAAV,EAAc;AAC5C,aAAO,CAACof,OAAO,CAACpf,EAAD,CAAf;AACD,KAFY,CAAN,CAEJvc,MAFI,KAEO,CAFd;AAGD,GAJD;;AAKA,MAAIg5H,gBAAgB,GAAG,UAAUxjG,QAAV,EAAoBo2D,SAApB,EAA+BqtC,OAA/B,EAAwCC,cAAxC,EAAwD;AAC7E,QAAIv9F,OAAO,CAACs9F,OAAD,CAAX,EAAsB;AACpBhuC,MAAAA,iBAAiB,CAACguC,OAAD,CAAjB;AACA,aAAO31D,eAAe,CAAC21D,OAAO,CAACjiH,GAAT,CAAtB;AACD;;AACD,QAAI+hH,aAAa,CAACG,cAAD,CAAb,IAAiCv9F,OAAO,CAACiwD,SAAD,CAA5C,EAAyD;AACvDhvE,MAAAA,MAAM,CAACs8G,cAAD,EAAiB9hH,YAAY,CAACV,OAAb,CAAqB,IAArB,CAAjB,CAAN;AACD;;AACD,QAAI8rD,QAAQ,GAAGa,YAAY,CAAC41D,OAAO,CAACjiH,GAAT,EAAc68C,aAAa,CAACj3C,MAAd,CAAqBs8G,cAAc,CAACliH,GAApC,CAAd,CAA3B;AACApT,IAAAA,IAAI,CAACi1H,eAAe,CAACjtC,SAAD,CAAhB,EAA6B,UAAUvwE,KAAV,EAAiB;AAChDuB,MAAAA,MAAM,CAACs8G,cAAD,EAAiB79G,KAAjB,CAAN;AACD,KAFG,CAAJ;AAGAy9G,IAAAA,eAAe,CAACtjG,QAAD,EAAWo2D,SAAX,CAAf;AACA,WAAOppB,QAAP;AACD,GAdD;;AAeA,MAAI22D,kBAAkB,GAAG,UAAU3jG,QAAV,EAAoBo2D,SAApB,EAA+BqtC,OAA/B,EAAwC;AAC/D,QAAIt9F,OAAO,CAACs9F,OAAD,CAAX,EAAsB;AACpBp7G,MAAAA,MAAM,CAACo7G,OAAD,CAAN;;AACA,UAAIt9F,OAAO,CAACiwD,SAAD,CAAX,EAAwB;AACtBX,QAAAA,iBAAiB,CAACW,SAAD,CAAjB;AACD;;AACD,aAAOtoB,eAAe,CAACsoB,SAAS,CAAC50E,GAAX,CAAtB;AACD;;AACD,QAAIwrD,QAAQ,GAAGe,cAAc,CAAC01D,OAAO,CAACjiH,GAAT,CAA7B;AACApT,IAAAA,IAAI,CAACi1H,eAAe,CAACjtC,SAAD,CAAhB,EAA6B,UAAUvwE,KAAV,EAAiB;AAChD6B,MAAAA,MAAM,CAAC+7G,OAAD,EAAU59G,KAAV,CAAN;AACD,KAFG,CAAJ;AAGAy9G,IAAAA,eAAe,CAACtjG,QAAD,EAAWo2D,SAAX,CAAf;AACA,WAAOppB,QAAP;AACD,GAdD;;AAeA,MAAI42D,kBAAkB,GAAG,UAAUH,OAAV,EAAmB5gE,KAAnB,EAA0B;AACjD,QAAIghE,gBAAgB,GAAG9tC,cAAc,CAAClzB,KAAD,EAAQ4gE,OAAR,CAArC;AACA,WAAOp0H,QAAQ,CAACD,IAAT,CAAcy0H,gBAAgB,CAACA,gBAAgB,CAACr5H,MAAjB,GAA0B,CAA3B,CAA9B,CAAP;AACD,GAHD;;AAIA,MAAIs5H,iBAAiB,GAAG,UAAU1tC,SAAV,EAAqBqtC,OAArB,EAA8B;AACpD,WAAO3/G,UAAU,CAAC2/G,OAAD,EAAUrtC,SAAV,CAAV,GAAiCwtC,kBAAkB,CAACH,OAAD,EAAUrtC,SAAV,CAAnD,GAA0E/mF,QAAQ,CAACrC,IAAT,EAAjF;AACD,GAFD;;AAGA,MAAI+2H,MAAM,GAAG,UAAU3kF,KAAV,EAAiByjB,KAAjB,EAAwB;AACnC8K,IAAAA,UAAU,CAACvuB,KAAD,EAAQyjB,KAAK,CAACrhD,GAAd,CAAV,CAA6BrT,GAA7B,CAAiC,UAAU6+D,QAAV,EAAoB;AACnD,aAAOA,QAAQ,CAAClR,OAAT,EAAP;AACD,KAFD,EAEG3tD,GAFH,CAEOyT,YAAY,CAACX,OAFpB,EAE6BzS,MAF7B,CAEoC+yB,MAFpC,EAE4CnzB,IAF5C,CAEiDia,MAFjD;AAGD,GAJD;;AAKA,MAAI27G,cAAc,GAAG,UAAUhkG,QAAV,EAAoBo2D,SAApB,EAA+BqtC,OAA/B,EAAwC;AAC3DM,IAAAA,MAAM,CAAC,IAAD,EAAO3tC,SAAP,CAAN;AACA2tC,IAAAA,MAAM,CAAC,KAAD,EAAQN,OAAR,CAAN;AACA,WAAOK,iBAAiB,CAAC1tC,SAAD,EAAYqtC,OAAZ,CAAjB,CAAsCj2H,IAAtC,CAA2CpB,KAAK,CAACu3H,kBAAD,EAAqB3jG,QAArB,EAA+Bo2D,SAA/B,EAA0CqtC,OAA1C,CAAhD,EAAoGr3H,KAAK,CAACo3H,gBAAD,EAAmBxjG,QAAnB,EAA6Bo2D,SAA7B,EAAwCqtC,OAAxC,CAAzG,CAAP;AACD,GAJD;;AAKA,MAAIQ,WAAW,GAAG,UAAUjkG,QAAV,EAAoB6f,OAApB,EAA6BuhF,MAA7B,EAAqCC,MAArC,EAA6C;AAC7D,WAAOxhF,OAAO,GAAGmkF,cAAc,CAAChkG,QAAD,EAAWqhG,MAAX,EAAmBD,MAAnB,CAAjB,GAA8C4C,cAAc,CAAChkG,QAAD,EAAWohG,MAAX,EAAmBC,MAAnB,CAA1E;AACD,GAFD;;AAIA,MAAI6C,iBAAiB,GAAG,UAAU1nG,MAAV,EAAkBqjB,OAAlB,EAA2B;AACjD,QAAI7f,QAAQ,GAAGpe,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAf;AACA,QAAIoW,QAAQ,GAAGm2D,MAAM,CAACnjG,QAAQ,CAACxe,GAAV,EAAeq+B,OAAf,EAAwBrjB,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAxB,CAAN,CAAyDtoD,IAAzD,CAA8D,UAAUg0H,aAAV,EAAyB;AACpG,aAAO4B,WAAW,CAACjkG,QAAD,EAAW6f,OAAX,EAAoBwiF,aAAa,CAACjzH,IAAd,CAAmByzD,KAAvC,EAA8Cw/D,aAAa,CAACr4G,EAAd,CAAiB64C,KAA/D,CAAlB;AACD,KAFc,CAAf;AAGAmK,IAAAA,QAAQ,CAAC5+D,IAAT,CAAc,UAAU6hB,GAAV,EAAe;AAC3BuM,MAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwB1/C,GAAG,CAACquC,OAAJ,EAAxB;AACD,KAFD;AAGA,WAAO0O,QAAQ,CAACr/D,MAAT,EAAP;AACD,GATD;;AAWA,MAAIw2H,sBAAsB,GAAG,UAAUnkG,QAAV,EAAoB02B,SAApB,EAA+B;AAC1D,QAAID,GAAG,GAAGC,SAAS,CAACC,MAAV,EAAV;AACA,WAAO6D,KAAK,CAACmnE,gBAAgB,CAAC3hG,QAAD,EAAWpe,YAAY,CAACX,OAAb,CAAqBw1C,GAAG,CAACryB,cAAzB,CAAX,CAAjB,EAAuEu9F,gBAAgB,CAAC3hG,QAAD,EAAWpe,YAAY,CAACX,OAAb,CAAqBw1C,GAAG,CAAClG,YAAzB,CAAX,CAAvF,EAA2I,UAAU6wE,MAAV,EAAkBC,MAAlB,EAA0B;AAC/K,UAAI99G,IAAI,CAAC69G,MAAD,EAASC,MAAT,CAAJ,KAAyB,KAA7B,EAAoC;AAClC5qE,QAAAA,GAAG,CAACinC,cAAJ;AACAumC,QAAAA,WAAW,CAACjkG,QAAD,EAAW,IAAX,EAAiBohG,MAAjB,EAAyBC,MAAzB,CAAX,CAA4CjzH,IAA5C,CAAiD,UAAU6hB,GAAV,EAAe;AAC9DymC,UAAAA,SAAS,CAACiZ,MAAV,CAAiB1/C,GAAG,CAACquC,OAAJ,EAAjB;AACD,SAFD;AAGA,eAAO,IAAP;AACD,OAND,MAMO;AACL,eAAO,KAAP;AACD;AACF,KAVW,CAAL,CAUJ1wD,KAVI,CAUE,KAVF,CAAP;AAWD,GAbD;;AAcA,MAAIw2H,gBAAgB,GAAG,UAAUzlH,IAAV,EAAgB22E,OAAhB,EAAyB;AAC9C,QAAIl0E,IAAI,GAAGQ,YAAY,CAACX,OAAb,CAAqBq0E,OAArB,CAAX;AACA,QAAItwE,MAAM,GAAG5Y,KAAK,CAACmX,IAAD,EAAO5E,IAAP,CAAlB;AACA,WAAOoc,QAAQ,CAAC3Z,IAAD,EAAOwgB,aAAP,EAAsB5c,MAAtB,CAAR,CAAsCrX,MAAtC,EAAP;AACD,GAJD;;AAKA,MAAI02H,kBAAkB,GAAG,UAAU1lH,IAAV,EAAgB83C,GAAhB,EAAqB;AAC5C,WAAO2tE,gBAAgB,CAACzlH,IAAD,EAAO83C,GAAG,CAACryB,cAAX,CAAhB,IAA8CggG,gBAAgB,CAACzlH,IAAD,EAAO83C,GAAG,CAAClG,YAAX,CAArE;AACD,GAFD;;AAGA,MAAI+zE,oBAAoB,GAAG,UAAU3lH,IAAV,EAAgB83C,GAAhB,EAAqB;AAC9C,QAAI8tE,UAAU,GAAG12D,YAAY,CAAClvD,IAAI,CAAC6C,GAAN,EAAW68C,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAX,CAAZ,CAA0DtpD,MAA1D,EAAjB;AACA,QAAIq3H,MAAM,GAAG52D,YAAY,CAACjvD,IAAI,CAAC6C,GAAN,EAAW68C,aAAa,CAACI,YAAd,CAA2BhI,GAA3B,CAAX,CAAZ,CAAwDtpD,MAAxD,EAAb;AACA,WAAO,CAACk3H,kBAAkB,CAAC1lH,IAAD,EAAO83C,GAAP,CAAnB,IAAkC8tE,UAAlC,IAAgDC,MAAvD;AACD,GAJD;;AAKA,MAAIC,WAAW,GAAG,UAAUjoG,MAAV,EAAkB;AAClCA,IAAAA,MAAM,CAAC2+D,UAAP,CAAkB,EAAlB;AACA3+D,IAAAA,MAAM,CAACk6B,SAAP,CAAiB0kC,iBAAjB;AACA,WAAO,IAAP;AACD,GAJD;;AAKA,MAAIspC,aAAa,GAAG,UAAUloG,MAAV,EAAkB;AACpC,QAAIwD,QAAQ,GAAGpe,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAf;AACA,QAAIH,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AACA,WAAO2tE,oBAAoB,CAACtkG,QAAD,EAAWy2B,GAAX,CAApB,GAAsCguE,WAAW,CAACjoG,MAAD,CAAjD,GAA4D2nG,sBAAsB,CAACnkG,QAAD,EAAWxD,MAAM,CAACk6B,SAAlB,CAAzF;AACD,GAJD;;AAKA,MAAIiuE,iBAAiB,GAAG,UAAUnoG,MAAV,EAAkBooG,QAAlB,EAA4B;AAClD,WAAOpoG,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,KAAiC,KAAjC,GAAyC8jE,aAAa,CAACloG,MAAD,CAA7D;AACD,GAFD;;AAIA,MAAIqoG,uBAAuB,GAAG13G,qBAA9B;AACA,MAAI23G,wBAAwB,GAAG13G,sBAA/B;;AACA,MAAI23G,SAAS,GAAG,UAAU9qE,SAAV,EAAqBz9B,MAArB,EAA6Bpb,IAA7B,EAAmCgG,MAAnC,EAA2CiD,cAA3C,EAA2D;AACzE,WAAOhb,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAAC8mE,mBAAP,CAA2ByhC,SAA3B,CAAqC9qE,SAArC,EAAgD74C,IAAhD,EAAsDgG,MAAtD,EAA8DiD,cAA9D,CAAd,CAAP;AACD,GAFD;;AAGA,MAAI26G,YAAY,GAAG,UAAU5jH,IAAV,EAAgB;AACjC,QAAIq1C,GAAG,GAAGr1C,IAAI,CAACqD,aAAL,CAAmB+qC,WAAnB,EAAV;AACAiH,IAAAA,GAAG,CAAC+Y,UAAJ,CAAepuD,IAAf;AACA,WAAOq1C,GAAP;AACD,GAJD;;AAKA,MAAI+Y,UAAU,GAAG,UAAUhzC,MAAV,EAAkBpb,IAAlB,EAAwB;AACvC,QAAI/L,CAAC,GAAGmnB,MAAM,CAACmb,IAAP,CAAY,sBAAZ,EAAoC;AAAE/9B,MAAAA,MAAM,EAAEwH;AAAV,KAApC,CAAR;;AACA,QAAI/L,CAAC,CAACk/B,kBAAF,EAAJ,EAA4B;AAC1B,aAAOllC,QAAQ,CAACrC,IAAT,EAAP;AACD;;AACD,WAAOqC,QAAQ,CAACR,IAAT,CAAcm2H,YAAY,CAAC5jH,IAAD,CAA1B,CAAP;AACD,GAND;;AAOA,MAAI6jH,kBAAkB,GAAG,UAAUzoG,MAAV,EAAkBhf,KAAlB,EAAyB6M,cAAzB,EAAyC;AAChE,QAAIghD,eAAe,GAAGL,cAAc,CAAC,CAAD,EAAIxuC,MAAM,CAACo6B,OAAP,EAAJ,EAAsBp5C,KAAtB,CAApC;AACA,QAAIygD,aAAa,GAAGI,aAAa,CAACG,cAAd,CAA6B6M,eAA7B,CAApB;AACA,QAAI65D,iBAAiB,GAAGjnE,aAAa,CAACnC,OAAd,EAAxB;;AACA,QAAIgN,uBAAuB,CAACo8D,iBAAD,CAA3B,EAAgD;AAC9C,aAAOH,SAAS,CAAC,CAAD,EAAIvoG,MAAJ,EAAY0oG,iBAAZ,EAA+B,CAACjnE,aAAa,CAAC16B,OAAd,EAAhC,EAAyD,KAAzD,CAAhB;AACD;;AACD,QAAI4hG,uBAAuB,GAAGlnE,aAAa,CAACnC,OAAd,CAAsB,IAAtB,CAA9B;;AACA,QAAIgN,uBAAuB,CAACq8D,uBAAD,CAA3B,EAAsD;AACpD,aAAOJ,SAAS,CAAC,CAAD,EAAIvoG,MAAJ,EAAY2oG,uBAAZ,EAAqC,KAArC,EAA4C,KAA5C,CAAhB;AACD;;AACD,QAAIC,MAAM,GAAG5oG,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqBkR,aAAa,CAACnC,OAAd,EAArB,EAA8C,UAAU16C,IAAV,EAAgB;AACzE,aAAO0jH,wBAAwB,CAAC1jH,IAAD,CAAxB,IAAkCyjH,uBAAuB,CAACzjH,IAAD,CAAhE;AACD,KAFY,CAAb;;AAGA,QAAI0nD,uBAAuB,CAACs8D,MAAD,CAA3B,EAAqC;AACnC,aAAOL,SAAS,CAAC,CAAD,EAAIvoG,MAAJ,EAAY4oG,MAAZ,EAAoB,KAApB,EAA2B/6G,cAA3B,CAAhB;AACD;;AACD,WAAOhb,QAAQ,CAACrC,IAAT,EAAP;AACD,GAlBD;;AAmBA,MAAIq4H,gBAAgB,GAAG,UAAU7oG,MAAV,EAAkBhf,KAAlB,EAAyB6M,cAAzB,EAAyC;AAC9D,WAAO7M,KAAK,CAACgkD,SAAN,GAAkByjE,kBAAkB,CAACzoG,MAAD,EAAShf,KAAT,EAAgB6M,cAAhB,CAAlB,CAAkDzc,KAAlD,CAAwD4P,KAAxD,CAAlB,GAAmFA,KAA1F;AACD,GAFD;;AAIA,MAAI8nH,gBAAgB,GAAG,UAAUr1G,GAAV,EAAe;AACpC,WAAOklE,4BAA4B,CAACllE,GAAD,CAA5B,IAAqC8kE,aAAa,CAAC9kE,GAAD,CAAzD;AACD,GAFD;;AAGA,MAAIs1G,eAAe,GAAG,UAAUt1G,GAAV,EAAe;AACnC,WAAOmlE,2BAA2B,CAACnlE,GAAD,CAA3B,IAAoC+kE,YAAY,CAAC/kE,GAAD,CAAvD;AACD,GAFD;;AAGA,MAAIu1G,mBAAmB,GAAG,UAAUhkH,GAAV,EAAeJ,IAAf,EAAqB;AAC7C,QAAIyL,QAAQ,CAACzL,IAAD,CAAR,IAAkBA,IAAI,CAAC4V,IAAL,CAAUxsB,MAAV,KAAqB,CAA3C,EAA8C;AAC5CgX,MAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX;AACD;AACF,GAJD;;AAKA,MAAIqkH,yBAAyB,GAAG,UAAUjpG,MAAV,EAAkBhf,KAAlB,EAAyB4D,IAAzB,EAA+B64C,SAA/B,EAA0Cpa,OAA1C,EAAmD6lF,iBAAnD,EAAsE;AACpGX,IAAAA,SAAS,CAAC9qE,SAAD,EAAYz9B,MAAZ,EAAoBkpG,iBAAiB,CAAC5pE,OAAlB,CAA0B,CAACjc,OAA3B,CAApB,EAAyDA,OAAzD,EAAkE,IAAlE,CAAT,CAAiFzxC,IAAjF,CAAsF,UAAUu3H,UAAV,EAAsB;AAC1G,UAAInoH,KAAK,CAACgkD,SAAV,EAAqB;AACnB,YAAI68B,WAAW,GAAG7gF,KAAK,CAACigD,UAAN,EAAlB;;AACA,YAAI5d,OAAJ,EAAa;AACXw+C,UAAAA,WAAW,CAACvuC,MAAZ,CAAmB61E,UAAU,CAACvhG,cAA9B,EAA8CuhG,UAAU,CAACr1E,WAAzD;AACD,SAFD,MAEO;AACL+tC,UAAAA,WAAW,CAACxuC,QAAZ,CAAqB81E,UAAU,CAACp1E,YAAhC,EAA8Co1E,UAAU,CAACn1E,SAAzD;AACD;;AACD6tC,QAAAA,WAAW,CAACX,cAAZ;AACD,OARD,MAQO;AACLlgF,QAAAA,KAAK,CAACkgF,cAAN;AACD;;AACDlhE,MAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBg2D,UAAxB;AACD,KAbD;AAcAH,IAAAA,mBAAmB,CAAChpG,MAAM,CAAChb,GAAR,EAAaJ,IAAb,CAAnB;AACA,WAAO,IAAP;AACD,GAjBD;;AAkBA,MAAIwkH,kBAAkB,GAAG,UAAUppG,MAAV,EAAkBqjB,OAAlB,EAA2B;AAClD,QAAIriC,KAAK,GAAGgf,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAZ;;AACA,QAAI,CAAC9pC,QAAQ,CAACrP,KAAK,CAACsuE,uBAAP,CAAb,EAA8C;AAC5C,aAAO,KAAP;AACD;;AACD,QAAI7xB,SAAS,GAAGpa,OAAO,GAAG+rB,UAAU,CAACa,QAAd,GAAyBb,UAAU,CAACkB,SAA3D;AACA,QAAIm0B,WAAW,GAAGp0B,WAAW,CAACrwC,MAAM,CAACo6B,OAAP,EAAD,CAA7B;AACA,QAAIivE,YAAY,GAAGz5H,KAAK,CAACo/D,sBAAD,EAAyB3rB,OAAO,GAAGohD,WAAW,CAAChhE,IAAf,GAAsBghE,WAAW,CAAC/gE,IAAlE,CAAxB;AACA,QAAI4lG,UAAU,GAAGjmF,OAAO,GAAGylF,gBAAH,GAAsBC,eAA9C;AACA,QAAItnE,aAAa,GAAGmN,0BAA0B,CAACnR,SAAD,EAAYz9B,MAAM,CAACo6B,OAAP,EAAZ,EAA8Bp5C,KAA9B,CAA9C;AACA,QAAIuoH,iBAAiB,GAAGxE,iBAAiB,CAAC1hF,OAAD,EAAUgmF,YAAY,CAAC5nE,aAAD,CAAtB,CAAzC;;AACA,QAAI,CAAC8nE,iBAAD,IAAsB,CAACr6D,qBAAqB,CAACzN,aAAD,EAAgB8nE,iBAAhB,CAAhD,EAAoF;AAClF,aAAO,KAAP;AACD,KAFD,MAEO,IAAID,UAAU,CAACC,iBAAD,CAAd,EAAmC;AACxC,aAAON,yBAAyB,CAACjpG,MAAD,EAAShf,KAAT,EAAgBygD,aAAa,CAACnC,OAAd,EAAhB,EAAyC7B,SAAzC,EAAoDpa,OAApD,EAA6DkmF,iBAA7D,CAAhC;AACD;;AACD,QAAIL,iBAAiB,GAAGG,YAAY,CAACE,iBAAD,CAApC;;AACA,QAAIL,iBAAiB,IAAII,UAAU,CAACJ,iBAAD,CAAnC,EAAwD;AACtD,UAAIh6D,qBAAqB,CAACq6D,iBAAD,EAAoBL,iBAApB,CAAzB,EAAiE;AAC/D,eAAOD,yBAAyB,CAACjpG,MAAD,EAAShf,KAAT,EAAgBygD,aAAa,CAACnC,OAAd,EAAhB,EAAyC7B,SAAzC,EAAoDpa,OAApD,EAA6D6lF,iBAA7D,CAAhC;AACD;AACF;;AACD,WAAO,KAAP;AACD,GAvBD;;AAwBA,MAAIM,iBAAiB,GAAG,UAAUxpG,MAAV,EAAkBqjB,OAAlB,EAA2B;AACjD,WAAO+lF,kBAAkB,CAACppG,MAAD,EAASqjB,OAAT,CAAzB;AACD,GAFD;;AAIA,MAAIomF,iBAAiB,GAAG,UAAU7kH,IAAV,EAAgB;AACtC,WAAOwgB,aAAa,CAAChgB,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAD,CAAb,IAA6CsgB,UAAU,CAAC9f,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAD,CAA9D;AACD,GAFD;;AAGA,MAAI8kH,YAAY,GAAG5rG,GAAG,CAAChB,QAAJ,CAAa,CAC9B;AAAEjR,IAAAA,MAAM,EAAE,CAAC,SAAD;AAAV,GAD8B,EAE9B;AAAE89G,IAAAA,aAAa,EAAE,CAAC,SAAD;AAAjB,GAF8B,EAG9B;AAAEC,IAAAA,cAAc,EAAE,CAAC,UAAD;AAAlB,GAH8B,CAAb,CAAnB;;AAKA,MAAIC,6BAA6B,GAAG,UAAUxmF,OAAV,EAAmBzwC,IAAnB,EAAyB;AAC3D,QAAImgB,GAAG,GAAGngB,IAAI,CAAC0sD,OAAL,CAAajc,OAAO,KAAK,KAAzB,CAAV;AACA,QAAIymF,aAAa,GAAGzmF,OAAO,GAAG,OAAH,GAAa,QAAxC;AACA,WAAOp0B,WAAW,CAAC8D,GAAD,CAAX,IAAoBA,GAAG,CAACjD,YAAJ,CAAiB,gBAAjB,MAAuCg6G,aAAlE;AACD,GAJD;;AAKA,MAAIC,8BAA8B,GAAG,UAAU5nH,IAAV,EAAgBkhC,OAAhB,EAAyBzwC,IAAzB,EAA+B4a,EAA/B,EAAmC;AACtE,QAAI2hD,WAAW,GAAG,UAAUp8C,GAAV,EAAe;AAC/B,aAAO+R,QAAQ,CAAC1f,YAAY,CAACX,OAAb,CAAqBsO,GAArB,CAAD,CAAR,IAAuC,CAAC06C,aAAa,CAAC76D,IAAD,EAAO4a,EAAP,EAAWrL,IAAX,CAA5D;AACD,KAFD;;AAGA,WAAOwsD,iBAAiB,CAAC,CAACtrB,OAAF,EAAWzwC,IAAX,CAAjB,CAAkC5B,IAAlC,CAAuC,YAAY;AACxD,aAAO29D,iBAAiB,CAACtrB,OAAD,EAAU71B,EAAV,CAAjB,CAA+Bxc,IAA/B,CAAoCV,KAApC,EAA2C6+D,WAA3C,CAAP;AACD,KAFM,EAEJA,WAFI,CAAP;AAGD,GAPD;;AAQA,MAAI66D,2BAA2B,GAAG,UAAU7nH,IAAV,EAAgBkhC,OAAhB,EAAyBzwC,IAAzB,EAA+B4a,EAA/B,EAAmC;AACnE,QAAIy8G,QAAQ,GAAGz8G,EAAE,CAAC8xC,OAAH,CAAWjc,OAAO,KAAK,KAAvB,CAAf;AACA,WAAO8hF,gBAAgB,CAAC//G,YAAY,CAACX,OAAb,CAAqBtC,IAArB,CAAD,EAA6BiD,YAAY,CAACX,OAAb,CAAqB7R,IAAI,CAAC0sD,OAAL,EAArB,CAA7B,CAAhB,CAAmF3tD,GAAnF,CAAuF,UAAUu4H,QAAV,EAAoB;AAChH,aAAOvgG,OAAO,CAACugG,QAAD,CAAP,GAAoBR,YAAY,CAAC79G,MAAb,CAAoBq+G,QAAQ,CAACllH,GAA7B,CAApB,GAAwD0kH,YAAY,CAACC,aAAb,CAA2BM,QAA3B,CAA/D;AACD,KAFM,EAEJv4H,OAFI,CAEI,YAAY;AACrB,aAAOmB,QAAQ,CAACR,IAAT,CAAcq3H,YAAY,CAACC,aAAb,CAA2BM,QAA3B,CAAd,CAAP;AACD,KAJM,CAAP;AAKD,GAPD;;AAQA,MAAIE,eAAe,GAAG,UAAUhoH,IAAV,EAAgBkhC,OAAhB,EAAyBzwC,IAAzB,EAA+B;AACnD,WAAO69D,YAAY,CAACptB,OAAD,EAAUlhC,IAAV,EAAgBvP,IAAhB,CAAZ,CAAkCf,IAAlC,CAAuC,UAAU2b,EAAV,EAAc;AAC1D,UAAIi8G,iBAAiB,CAACj8G,EAAE,CAAC8xC,OAAH,EAAD,CAArB,EAAqC;AACnC,eAAOzsD,QAAQ,CAACrC,IAAT,EAAP;AACD,OAFD,MAEO,IAAIu5H,8BAA8B,CAAC5nH,IAAD,EAAOkhC,OAAP,EAAgBzwC,IAAhB,EAAsB4a,EAAtB,CAAlC,EAA6D;AAClE,eAAO3a,QAAQ,CAACrC,IAAT,EAAP;AACD,OAFM,MAEA,IAAI6yC,OAAO,IAAIzyB,sBAAsB,CAACpD,EAAE,CAAC8xC,OAAH,EAAD,CAArC,EAAqD;AAC1D,eAAO0qE,2BAA2B,CAAC7nH,IAAD,EAAOkhC,OAAP,EAAgBzwC,IAAhB,EAAsB4a,EAAtB,CAAlC;AACD,OAFM,MAEA,IAAI61B,OAAO,KAAK,KAAZ,IAAqBzyB,sBAAsB,CAACpD,EAAE,CAAC8xC,OAAH,CAAW,IAAX,CAAD,CAA/C,EAAmE;AACxE,eAAO0qE,2BAA2B,CAAC7nH,IAAD,EAAOkhC,OAAP,EAAgBzwC,IAAhB,EAAsB4a,EAAtB,CAAlC;AACD,OAFM,MAEA,IAAI61B,OAAO,IAAIu1C,2BAA2B,CAAChmF,IAAD,CAA1C,EAAkD;AACvD,eAAOC,QAAQ,CAACR,IAAT,CAAcq3H,YAAY,CAACE,cAAb,CAA4Bp8G,EAA5B,CAAd,CAAP;AACD,OAFM,MAEA,IAAI61B,OAAO,KAAK,KAAZ,IAAqBs1C,4BAA4B,CAAC/lF,IAAD,CAArD,EAA6D;AAClE,eAAOC,QAAQ,CAACR,IAAT,CAAcq3H,YAAY,CAACE,cAAb,CAA4Bp8G,EAA5B,CAAd,CAAP;AACD,OAFM,MAEA;AACL,eAAO3a,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF,KAhBM,CAAP;AAiBD,GAlBD;;AAmBA,MAAI45H,6BAA6B,GAAG,UAAU/mF,OAAV,EAAmBtwB,GAAnB,EAAwB;AAC1D,QAAIswB,OAAO,IAAIzyB,sBAAsB,CAACmC,GAAG,CAAC7J,WAAL,CAArC,EAAwD;AACtD,aAAOrW,QAAQ,CAACR,IAAT,CAAcq3H,YAAY,CAACC,aAAb,CAA2B52G,GAAG,CAAC7J,WAA/B,CAAd,CAAP;AACD,KAFD,MAEO,IAAIm6B,OAAO,KAAK,KAAZ,IAAqBzyB,sBAAsB,CAACmC,GAAG,CAAC9J,eAAL,CAA/C,EAAsE;AAC3E,aAAOpW,QAAQ,CAACR,IAAT,CAAcq3H,YAAY,CAACC,aAAb,CAA2B52G,GAAG,CAAC9J,eAA/B,CAAd,CAAP;AACD,KAFM,MAEA;AACL,aAAOpW,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF,GARD;;AASA,MAAI65H,sCAAsC,GAAG,UAAUloH,IAAV,EAAgBvP,IAAhB,EAAsBqsF,YAAtB,EAAoC;AAC/E,WAAOA,YAAY,CAACjuF,IAAb,CAAkB,UAAU+hB,GAAV,EAAe;AACtC,aAAOlgB,QAAQ,CAACR,IAAT,CAAcq3H,YAAY,CAAC79G,MAAb,CAAoBkH,GAApB,CAAd,CAAP;AACD,KAFM,EAEJ,UAAUA,GAAV,EAAe;AAChB,aAAOlgB,QAAQ,CAACR,IAAT,CAAcq3H,YAAY,CAACC,aAAb,CAA2B52G,GAA3B,CAAd,CAAP;AACD,KAJM,EAIJ,UAAUvF,EAAV,EAAc;AACf,UAAIigD,aAAa,CAAC76D,IAAD,EAAO4a,EAAP,EAAWrL,IAAX,CAAjB,EAAmC;AACjC,eAAOtP,QAAQ,CAACrC,IAAT,EAAP;AACD,OAFD,MAEO;AACL,eAAOqC,QAAQ,CAACR,IAAT,CAAcq3H,YAAY,CAACE,cAAb,CAA4Bp8G,EAA5B,CAAd,CAAP;AACD;AACF,KAVM,CAAP;AAWD,GAZD;;AAaA,MAAI88G,wBAAwB,GAAG,UAAUnoH,IAAV,EAAgBkhC,OAAhB,EAAyBzwC,IAAzB,EAA+B;AAC5D,QAAIi3H,6BAA6B,CAACxmF,OAAD,EAAUzwC,IAAV,CAAjC,EAAkD;AAChD,aAAOw3H,6BAA6B,CAAC/mF,OAAD,EAAUzwC,IAAI,CAAC0sD,OAAL,CAAajc,OAAO,KAAK,KAAzB,CAAV,CAA7B,CAAwEryC,IAAxE,CAA6E,YAAY;AAC9F,eAAOm5H,eAAe,CAAChoH,IAAD,EAAOkhC,OAAP,EAAgBzwC,IAAhB,CAAtB;AACD,OAFM,EAEJC,QAAQ,CAACR,IAFL,CAAP;AAGD,KAJD,MAIO;AACL,aAAO83H,eAAe,CAAChoH,IAAD,EAAOkhC,OAAP,EAAgBzwC,IAAhB,CAAf,CAAqCf,IAArC,CAA0C,UAAUotF,YAAV,EAAwB;AACvE,eAAOorC,sCAAsC,CAACloH,IAAD,EAAOvP,IAAP,EAAaqsF,YAAb,CAA7C;AACD,OAFM,CAAP;AAGD;AACF,GAVD;;AAWA,MAAIsrC,MAAM,GAAG,UAAUpoH,IAAV,EAAgBkhC,OAAhB,EAAyB4W,GAAzB,EAA8B;AACzC,QAAI4U,eAAe,GAAGL,cAAc,CAACnrB,OAAO,GAAG,CAAH,GAAO,CAAC,CAAhB,EAAmBlhC,IAAnB,EAAyB83C,GAAzB,CAApC;AACA,QAAIrnD,IAAI,GAAGivD,aAAa,CAACG,cAAd,CAA6B6M,eAA7B,CAAX;AACA,QAAI9lC,WAAW,GAAG3jB,YAAY,CAACX,OAAb,CAAqBtC,IAArB,CAAlB;;AACA,QAAIkhC,OAAO,KAAK,KAAZ,IAAqBu1C,2BAA2B,CAAChmF,IAAD,CAApD,EAA4D;AAC1D,aAAOC,QAAQ,CAACR,IAAT,CAAcq3H,YAAY,CAAC79G,MAAb,CAAoBjZ,IAAI,CAAC0sD,OAAL,CAAa,IAAb,CAApB,CAAd,CAAP;AACD,KAFD,MAEO,IAAIjc,OAAO,IAAIs1C,4BAA4B,CAAC/lF,IAAD,CAA3C,EAAmD;AACxD,aAAOC,QAAQ,CAACR,IAAT,CAAcq3H,YAAY,CAAC79G,MAAb,CAAoBjZ,IAAI,CAAC0sD,OAAL,EAApB,CAAd,CAAP;AACD,KAFM,MAEA,IAAIjc,OAAO,KAAK,KAAZ,IAAqBs1C,4BAA4B,CAAC/lF,IAAD,CAAjD,IAA2D0nF,SAAS,CAACvxD,WAAD,EAAcn2B,IAAd,CAAxE,EAA6F;AAClG,aAAO2nF,cAAc,CAACxxD,WAAD,EAAcn2B,IAAd,CAAd,CAAkCjB,GAAlC,CAAsC,UAAUs1B,EAAV,EAAc;AACzD,eAAOyiG,YAAY,CAAC79G,MAAb,CAAoBob,EAAE,CAACq4B,OAAH,EAApB,CAAP;AACD,OAFM,CAAP;AAGD,KAJM,MAIA,IAAIjc,OAAO,IAAIu1C,2BAA2B,CAAChmF,IAAD,CAAtC,IAAgDynF,UAAU,CAACtxD,WAAD,EAAcn2B,IAAd,CAA9D,EAAmF;AACxF,aAAO4nF,UAAU,CAACzxD,WAAD,EAAcn2B,IAAd,CAAV,CAA8BjB,GAA9B,CAAkC,UAAUs1B,EAAV,EAAc;AACrD,eAAOyiG,YAAY,CAAC79G,MAAb,CAAoBob,EAAE,CAACq4B,OAAH,EAApB,CAAP;AACD,OAFM,CAAP;AAGD,KAJM,MAIA;AACL,aAAOgrE,wBAAwB,CAACnoH,IAAD,EAAOkhC,OAAP,EAAgBzwC,IAAhB,CAA/B;AACD;AACF,GAnBD;;AAqBA,MAAI43H,eAAe,GAAG,UAAUxqG,MAAV,EAAkBqjB,OAAlB,EAA2B;AAC/C,WAAO,UAAUn9B,OAAV,EAAmB;AACxB8Z,MAAAA,MAAM,CAAC8mE,mBAAP,CAA2B2jC,aAA3B;;AACAnsC,MAAAA,aAAa,CAACt+D,MAAD,EAASqjB,OAAT,EAAkBj+B,YAAY,CAACX,OAAb,CAAqByB,OAArB,CAAlB,CAAb;AACA,aAAO,IAAP;AACD,KAJD;AAKD,GAND;;AAOA,MAAIyjH,aAAa,GAAG,UAAU3pG,MAAV,EAAkBqjB,OAAlB,EAA2B;AAC7C,WAAO,UAAUn9B,OAAV,EAAmB;AACxB,UAAIuN,GAAG,GAAG4vB,OAAO,GAAGwe,aAAa,CAACj3C,MAAd,CAAqB1E,OAArB,CAAH,GAAmC27C,aAAa,CAAC72C,KAAd,CAAoB9E,OAApB,CAApD;AACA8Z,MAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwB1/C,GAAG,CAACquC,OAAJ,EAAxB;AACA,aAAO,IAAP;AACD,KAJD;AAKD,GAND;;AAOA,MAAI8nE,cAAc,GAAG,UAAU5pG,MAAV,EAAkB;AACrC,WAAO,UAAUvM,GAAV,EAAe;AACpBuM,MAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwB1/C,GAAG,CAACquC,OAAJ,EAAxB;AACA,aAAO,IAAP;AACD,KAHD;AAID,GALD;;AAMA,MAAI4oE,aAAa,GAAG,UAAU1qG,MAAV,EAAkBpb,IAAlB,EAAwB;AAC1C,WAAO/R,QAAQ,CAACD,IAAT,CAAcypE,sBAAsB,CAACr8C,MAAM,CAACo6B,OAAP,EAAD,EAAmBx1C,IAAnB,CAApC,CAAP;AACD,GAFD;;AAGA,MAAI+lH,oBAAoB,GAAG,UAAU3qG,MAAV,EAAkBqjB,OAAlB,EAA2B;AACpD,QAAIunF,YAAY,GAAG5qG,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,EAAnB;AACA,WAAOorE,aAAa,CAAC1qG,MAAD,EAAS4qG,YAAT,CAAb,CAAoC54H,MAApC,CAA2C4e,sBAA3C,EAAmE5f,IAAnE,CAAwE,YAAY;AACzF,aAAOu5H,MAAM,CAACvqG,MAAM,CAACo6B,OAAP,EAAD,EAAmB/W,OAAnB,EAA4BrjB,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA5B,CAAN,CAA6DroD,MAA7D,CAAoE,UAAUmtF,YAAV,EAAwB;AACjG,eAAOA,YAAY,CAACjuF,IAAb,CAAkBw5H,eAAe,CAACxqG,MAAD,EAASqjB,OAAT,CAAjC,EAAoDsmF,aAAa,CAAC3pG,MAAD,EAASqjB,OAAT,CAAjE,EAAoFumF,cAAc,CAAC5pG,MAAD,CAAlG,CAAP;AACD,OAFM,CAAP;AAGD,KAJM,EAIJzvB,MAJI,CAAP;AAKD,GAPD;;AAQA,MAAIs6H,wBAAwB,GAAG,UAAU9hG,WAAV,EAAuB;AACpDn3B,IAAAA,IAAI,CAAC+nD,aAAa,CAAC5wB,WAAD,EAAc,0BAAd,CAAd,EAAyDld,MAAzD,CAAJ;AACD,GAFD;;AAGA,MAAIi/G,oBAAoB,GAAG,UAAU9qG,MAAV,EAAkBqjB,OAAlB,EAA2B;AACpD,QAAIunF,YAAY,GAAG5qG,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,EAAnB;;AACA,QAAI1uC,sBAAsB,CAACg6G,YAAD,CAA1B,EAA0C;AACxC,UAAIG,cAAc,GAAGL,aAAa,CAAC1qG,MAAD,EAAS4qG,YAAY,CAACtiH,UAAtB,CAAb,CAA+CtW,MAA/C,CAAsD4e,sBAAtD,CAArB;AACA,aAAOm6G,cAAc,CAAC/5H,IAAf,CAAoB,YAAY;AACrC65H,QAAAA,wBAAwB,CAACzlH,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAD,CAAxB;AACAkkC,QAAAA,aAAa,CAACt+D,MAAD,EAASqjB,OAAT,EAAkBj+B,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,EAArB,CAAlB,CAAb;AACA+lE,QAAAA,aAAa,CAACrlG,MAAD,CAAb;AACA,eAAO,IAAP;AACD,OALM,EAKJzvB,MALI,CAAP;AAMD;;AACD,WAAO,KAAP;AACD,GAZD;;AAaA,MAAIy6H,gBAAgB,GAAG,UAAUhrG,MAAV,EAAkB;AACvC,QAAIhb,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AAAA,QAAsBk1C,SAAS,GAAGl6B,MAAM,CAACk6B,SAAzC;AACA,QAAI0uE,MAAM,GAAGvsD,sBAAsB,CAACr8C,MAAM,CAACo6B,OAAP,EAAD,EAAmBF,SAAS,CAACoF,OAAV,EAAnB,CAAnC;;AACA,QAAI3uC,qBAAqB,CAACi4G,MAAD,CAArB,IAAiC5jH,GAAG,CAAC4f,OAAJ,CAAYgkG,MAAZ,CAAjC,IAAwD5jH,GAAG,CAAC2kB,OAAJ,CAAYi/F,MAAZ,CAA5D,EAAiF;AAC/E,UAAI3hG,EAAE,GAAGjiB,GAAG,CAAC9C,MAAJ,CAAW,IAAX,EAAiB;AAAE,0BAAkB;AAApB,OAAjB,CAAT;AACA8C,MAAAA,GAAG,CAAC4rC,OAAJ,CAAYg4E,MAAZ,EAAoB,EAApB;AACAA,MAAAA,MAAM,CAACv9G,WAAP,CAAmB4b,EAAnB;AACAizB,MAAAA,SAAS,CAACiZ,MAAV,CAAiBtR,aAAa,CAACj3C,MAAd,CAAqBqc,EAArB,EAAyB66B,OAAzB,EAAjB;AACD;;AACD,WAAO,IAAP;AACD,GAVD;;AAWA,MAAImpE,iBAAiB,GAAG,UAAUjrG,MAAV,EAAkBqjB,OAAlB,EAA2B;AACjD,QAAIrjB,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,EAAJ,EAAoC;AAClC,aAAOumE,oBAAoB,CAAC3qG,MAAD,EAASqjB,OAAT,CAA3B;AACD,KAFD,MAEO;AACL,aAAOynF,oBAAoB,CAAC9qG,MAAD,EAASqjB,OAAT,CAA3B;AACD;AACF,GAND;;AAQA,MAAI6nF,aAAa,GAAG,UAAUlrG,MAAV,EAAkBqjB,OAAlB,EAA2B;AAC7C,QAAIu/C,OAAO,GAAG/gC,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAd;AACA,WAAOsW,YAAY,CAACptB,OAAD,EAAUrjB,MAAM,CAACo6B,OAAP,EAAV,EAA4BwoC,OAA5B,CAAZ,CAAiD5wF,MAAjD,CAAwD,UAAUyhB,GAAV,EAAe;AAC5E,aAAO4vB,OAAO,GAAGg1C,kBAAkB,CAAC5kE,GAAD,CAArB,GAA6B6kE,iBAAiB,CAAC7kE,GAAD,CAA5D;AACD,KAFM,EAEJ5hB,IAFI,CAEC,UAAU4hB,GAAV,EAAe;AACrB,aAAO5gB,QAAQ,CAACD,IAAT,CAAcg7D,4BAA4B,CAACvqB,OAAO,GAAG,CAAH,GAAO,CAAC,CAAhB,EAAmB5vB,GAAnB,CAA1C,CAAP;AACD,KAJM,EAIJ3hB,MAJI,CAIG,UAAUihB,GAAV,EAAe;AACvBiN,MAAAA,MAAM,CAACk6B,SAAP,CAAiBne,MAAjB,CAAwBhpB,GAAxB;AACA,aAAO,IAAP;AACD,KAPM,CAAP;AAQD,GAVD;;AAWA,MAAIo4G,iBAAiB,GAAG,UAAUnrG,MAAV,EAAkBqjB,OAAlB,EAA2B;AACjD,WAAOrjB,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,KAAiC8mE,aAAa,CAAClrG,MAAD,EAASqjB,OAAT,CAA9C,GAAkE,KAAzE;AACD,GAFD;;AAIA,MAAI+nF,QAAQ,GAAG/6G,QAAf;;AACA,MAAIg7G,0BAA0B,GAAG,UAAUzmH,IAAV,EAAgB;AAC/C,WAAOwmH,QAAQ,CAACxmH,IAAD,CAAR,IAAkBA,IAAI,CAAC4V,IAAL,CAAU,CAAV,MAAiBoL,IAA1C;AACD,GAFD;;AAGA,MAAI0lG,wBAAwB,GAAG,UAAU1mH,IAAV,EAAgB;AAC7C,WAAOwmH,QAAQ,CAACxmH,IAAD,CAAR,IAAkBA,IAAI,CAAC4V,IAAL,CAAU5V,IAAI,CAAC4V,IAAL,CAAUxsB,MAAV,GAAmB,CAA7B,MAAoC43B,IAA7D;AACD,GAFD;;AAGA,MAAI2lG,UAAU,GAAG,UAAU3mH,IAAV,EAAgB;AAC/B,WAAOA,IAAI,CAACqD,aAAL,CAAmBlD,cAAnB,CAAkC6gB,IAAlC,CAAP;AACD,GAFD;;AAGA,MAAI4lG,cAAc,GAAG,UAAU5mH,IAAV,EAAgB;AACnC,QAAIwmH,QAAQ,CAACxmH,IAAI,CAACqE,eAAN,CAAZ,EAAoC;AAClC,UAAIqiH,wBAAwB,CAAC1mH,IAAI,CAACqE,eAAN,CAA5B,EAAoD;AAClD,eAAOrE,IAAI,CAACqE,eAAZ;AACD,OAFD,MAEO;AACLrE,QAAAA,IAAI,CAACqE,eAAL,CAAqBwpD,UAArB,CAAgC7sC,IAAhC;AACA,eAAOhhB,IAAI,CAACqE,eAAZ;AACD;AACF,KAPD,MAOO,IAAImiH,QAAQ,CAACxmH,IAAD,CAAZ,EAAoB;AACzB,UAAIymH,0BAA0B,CAACzmH,IAAD,CAA9B,EAAsC;AACpC,eAAOA,IAAP;AACD,OAFD,MAEO;AACLA,QAAAA,IAAI,CAACo4E,UAAL,CAAgB,CAAhB,EAAmBp3D,IAAnB;AACA,eAAOhhB,IAAP;AACD;AACF,KAPM,MAOA;AACL,UAAIm4E,OAAO,GAAGwuC,UAAU,CAAC3mH,IAAD,CAAxB;AACAA,MAAAA,IAAI,CAAC0D,UAAL,CAAgByC,YAAhB,CAA6BgyE,OAA7B,EAAsCn4E,IAAtC;AACA,aAAOm4E,OAAP;AACD;AACF,GApBD;;AAqBA,MAAI0uC,aAAa,GAAG,UAAU7mH,IAAV,EAAgB;AAClC,QAAIwmH,QAAQ,CAACxmH,IAAI,CAACsE,WAAN,CAAZ,EAAgC;AAC9B,UAAImiH,0BAA0B,CAACzmH,IAAI,CAACsE,WAAN,CAA9B,EAAkD;AAChD,eAAOtE,IAAI,CAACsE,WAAZ;AACD,OAFD,MAEO;AACLtE,QAAAA,IAAI,CAACsE,WAAL,CAAiB8zE,UAAjB,CAA4B,CAA5B,EAA+Bp3D,IAA/B;AACA,eAAOhhB,IAAI,CAACsE,WAAZ;AACD;AACF,KAPD,MAOO,IAAIkiH,QAAQ,CAACxmH,IAAD,CAAZ,EAAoB;AACzB,UAAI0mH,wBAAwB,CAAC1mH,IAAD,CAA5B,EAAoC;AAClC,eAAOA,IAAP;AACD,OAFD,MAEO;AACLA,QAAAA,IAAI,CAAC6tD,UAAL,CAAgB7sC,IAAhB;AACA,eAAOhhB,IAAP;AACD;AACF,KAPM,MAOA;AACL,UAAIm4E,OAAO,GAAGwuC,UAAU,CAAC3mH,IAAD,CAAxB;;AACA,UAAIA,IAAI,CAACsE,WAAT,EAAsB;AACpBtE,QAAAA,IAAI,CAAC0D,UAAL,CAAgByC,YAAhB,CAA6BgyE,OAA7B,EAAsCn4E,IAAI,CAACsE,WAA3C;AACD,OAFD,MAEO;AACLtE,QAAAA,IAAI,CAAC0D,UAAL,CAAgB+C,WAAhB,CAA4B0xE,OAA5B;AACD;;AACD,aAAOA,OAAP;AACD;AACF,GAxBD;;AAyBA,MAAI2uC,cAAc,GAAG,UAAU9gH,MAAV,EAAkBhG,IAAlB,EAAwB;AAC3C,WAAOgG,MAAM,GAAG4gH,cAAc,CAAC5mH,IAAD,CAAjB,GAA0B6mH,aAAa,CAAC7mH,IAAD,CAApD;AACD,GAFD;;AAGA,MAAI+mH,kBAAkB,GAAG/7H,KAAK,CAAC87H,cAAD,EAAiB,IAAjB,CAA9B;AACA,MAAIE,iBAAiB,GAAGh8H,KAAK,CAAC87H,cAAD,EAAiB,KAAjB,CAA7B;;AAEA,MAAIG,eAAe,GAAG,UAAUp4G,GAAV,EAAe7I,MAAf,EAAuB;AAC3C,QAAIyF,QAAQ,CAACoD,GAAG,CAACnS,SAAJ,EAAD,CAAZ,EAA+B;AAC7B,aAAOoqH,cAAc,CAAC9gH,MAAD,EAAS6I,GAAG,CAACnS,SAAJ,EAAT,CAArB;AACD,KAFD,MAEO;AACL,aAAOoqH,cAAc,CAAC9gH,MAAD,EAAS6I,GAAG,CAAC6rC,OAAJ,EAAT,CAArB;AACD;AACF,GAND;;AAOA,MAAIwsE,mBAAmB,GAAG,UAAUr4G,GAAV,EAAe04C,KAAf,EAAsB;AAC9C,QAAI4/D,SAAS,GAAG5/D,KAAK,CAACx2D,GAAN,EAAhB;AACA,WAAOo2H,SAAS,IAAIt4G,GAAG,CAACnS,SAAJ,OAAoByqH,SAAjC,IAA8C7lG,sBAAsB,CAAC6lG,SAAD,CAA3E;AACD,GAHD;;AAIA,MAAIC,WAAW,GAAG,UAAU7/D,KAAV,EAAiB9nB,QAAjB,EAA2B;AAC3C,WAAOA,QAAQ,CAACrzC,IAAT,CAAc,UAAUkV,OAAV,EAAmB;AACtCwkD,MAAAA,QAAQ,CAACyB,KAAK,CAACx2D,GAAN,EAAD,CAAR;AACA,UAAImP,IAAI,GAAG6mH,kBAAkB,CAACzlH,OAAD,CAA7B;AACAimD,MAAAA,KAAK,CAACh7C,GAAN,CAAUrM,IAAV;AACA,aAAOjS,QAAQ,CAACR,IAAT,CAAcwvD,aAAa,CAAC/8C,IAAD,EAAOA,IAAI,CAAC9W,MAAL,GAAc,CAArB,CAA3B,CAAP;AACD,KALM,EAKJ,UAAUkY,OAAV,EAAmB;AACpB,aAAOorD,eAAe,CAACprD,OAAD,CAAf,CAAyBvU,GAAzB,CAA6B,UAAU8hB,GAAV,EAAe;AACjD,YAAI,CAACq4G,mBAAmB,CAACr4G,GAAD,EAAM04C,KAAN,CAAxB,EAAsC;AACpCzB,UAAAA,QAAQ,CAACyB,KAAK,CAACx2D,GAAN,EAAD,CAAR;AACA,cAAImP,IAAI,GAAG+mH,eAAe,CAACp4G,GAAD,EAAM,IAAN,CAA1B;AACA04C,UAAAA,KAAK,CAACh7C,GAAN,CAAUrM,IAAV;AACA,iBAAO+8C,aAAa,CAAC/8C,IAAD,EAAO,CAAP,CAApB;AACD,SALD,MAKO;AACL,iBAAO+8C,aAAa,CAACsK,KAAK,CAACx2D,GAAN,EAAD,EAAc,CAAd,CAApB;AACD;AACF,OATM,CAAP;AAUD,KAhBM,EAgBJ,UAAUuQ,OAAV,EAAmB;AACpB,aAAOqrD,cAAc,CAACrrD,OAAD,CAAd,CAAwBvU,GAAxB,CAA4B,UAAU8hB,GAAV,EAAe;AAChD,YAAI,CAACq4G,mBAAmB,CAACr4G,GAAD,EAAM04C,KAAN,CAAxB,EAAsC;AACpCzB,UAAAA,QAAQ,CAACyB,KAAK,CAACx2D,GAAN,EAAD,CAAR;AACA,cAAImP,IAAI,GAAG+mH,eAAe,CAACp4G,GAAD,EAAM,KAAN,CAA1B;AACA04C,UAAAA,KAAK,CAACh7C,GAAN,CAAUrM,IAAV;AACA,iBAAO+8C,aAAa,CAAC/8C,IAAD,EAAOA,IAAI,CAAC9W,MAAL,GAAc,CAArB,CAApB;AACD,SALD,MAKO;AACL,iBAAO6zD,aAAa,CAACsK,KAAK,CAACx2D,GAAN,EAAD,EAAcw2D,KAAK,CAACx2D,GAAN,GAAY3H,MAAZ,GAAqB,CAAnC,CAApB;AACD;AACF,OATM,CAAP;AAUD,KA3BM,EA2BJ,UAAUkY,OAAV,EAAmB;AACpBwkD,MAAAA,QAAQ,CAACyB,KAAK,CAACx2D,GAAN,EAAD,CAAR;AACA,UAAImP,IAAI,GAAG8mH,iBAAiB,CAAC1lH,OAAD,CAA5B;AACAimD,MAAAA,KAAK,CAACh7C,GAAN,CAAUrM,IAAV;AACA,aAAOjS,QAAQ,CAACR,IAAT,CAAcwvD,aAAa,CAAC/8C,IAAD,EAAO,CAAP,CAA3B,CAAP;AACD,KAhCM,CAAP;AAiCD,GAlCD;;AAoCA,MAAImnH,aAAa,GAAG,UAAUC,GAAV,EAAej9H,IAAf,EAAqB;AACvC,SAAK,IAAIf,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGg+H,GAAG,CAACl+H,MAAxB,EAAgCE,CAAC,EAAjC,EAAqC;AACnC,UAAImwB,MAAM,GAAG6tG,GAAG,CAACh+H,CAAD,CAAH,CAAOkB,KAAP,CAAa,IAAb,EAAmBH,IAAnB,CAAb;;AACA,UAAIovB,MAAM,CAACltB,MAAP,EAAJ,EAAqB;AACnB,eAAOktB,MAAP;AACD;AACF;;AACD,WAAOxrB,QAAQ,CAACrC,IAAT,EAAP;AACD,GARD;;AAUA,MAAI27H,QAAQ,GAAGruG,GAAG,CAAChB,QAAJ,CAAa,CAC1B;AAAElS,IAAAA,MAAM,EAAE,CAAC,SAAD;AAAV,GAD0B,EAE1B;AAAEnO,IAAAA,KAAK,EAAE,CAAC,SAAD;AAAT,GAF0B,EAG1B;AAAE4nD,IAAAA,GAAG,EAAE,CAAC,SAAD;AAAP,GAH0B,EAI1B;AAAEr5C,IAAAA,KAAK,EAAE,CAAC,SAAD;AAAT,GAJ0B,CAAb,CAAf;;AAMA,MAAIohH,OAAO,GAAG,UAAU5oG,QAAV,EAAoB5e,IAApB,EAA0B;AACtC,QAAI65E,WAAW,GAAGjxB,cAAc,CAAC5oD,IAAD,EAAO4e,QAAP,CAAhC;AACA,WAAOi7D,WAAW,GAAGA,WAAH,GAAiBj7D,QAAnC;AACD,GAHD;;AAIA,MAAI6oG,QAAQ,GAAG,UAAU9H,cAAV,EAA0B/gG,QAA1B,EAAoC/P,GAApC,EAAyC;AACtD,QAAI64G,IAAI,GAAGtH,iBAAiB,CAACvxG,GAAD,CAA5B;AACA,QAAIzP,KAAK,GAAGooH,OAAO,CAAC5oG,QAAD,EAAW8oG,IAAI,CAAChrH,SAAL,EAAX,CAAnB;AACA,WAAOojH,cAAc,CAACH,cAAD,EAAiBvgH,KAAjB,EAAwBsoH,IAAxB,CAAd,CAA4Ct7H,IAA5C,CAAiD,YAAY;AAClE,aAAOogE,YAAY,CAACptD,KAAD,EAAQsoH,IAAR,CAAZ,CAA0Bz6H,IAA1B,CAA+BjC,KAAK,CAAC80H,cAAD,EAAiBH,cAAjB,EAAiCvgH,KAAjC,CAApC,EAA6ErS,GAA7E,CAAiF,UAAUogC,MAAV,EAAkB;AACxG,eAAOo6F,QAAQ,CAACvhH,MAAT,CAAgBmnB,MAAhB,CAAP;AACD,OAFM,CAAP;AAGD,KAJM,EAIJl/B,QAAQ,CAACrC,IAJL,CAAP;AAKD,GARD;;AASA,MAAI+7H,+BAA+B,GAAG,UAAU/oG,QAAV,EAAoBzQ,GAApB,EAAyB;AAC7D,WAAO2+C,uBAAuB,CAACluC,QAAD,EAAWzQ,GAAX,CAAvB,KAA2C,IAAlD;AACD,GAFD;;AAGA,MAAIy5G,oBAAoB,GAAG,UAAUjI,cAAV,EAA0B/gG,QAA1B,EAAoC/P,GAApC,EAAyC;AAClE,WAAOixG,cAAc,CAACH,cAAD,EAAiB/gG,QAAjB,EAA2B/P,GAA3B,CAAd,CAA8CzhB,MAA9C,CAAqDpC,KAAK,CAAC28H,+BAAD,EAAkC/oG,QAAlC,CAA1D,CAAP;AACD,GAFD;;AAGA,MAAI/mB,KAAK,GAAG,UAAU8nH,cAAV,EAA0B/gG,QAA1B,EAAoC/P,GAApC,EAAyC;AACnD,QAAI64G,IAAI,GAAGrH,kBAAkB,CAACxxG,GAAD,CAA7B;AACA,WAAO+4G,oBAAoB,CAACjI,cAAD,EAAiB/gG,QAAjB,EAA2B8oG,IAA3B,CAApB,CAAqDz6H,IAArD,CAA0D,UAAUkgC,MAAV,EAAkB;AACjF,UAAI4zF,OAAO,GAAGt0D,YAAY,CAACt/B,MAAD,EAASu6F,IAAT,CAA1B;AACA,aAAO3G,OAAO,CAACh1H,MAAR,KAAmBkC,QAAQ,CAACR,IAAT,CAAc85H,QAAQ,CAAC1vH,KAAT,CAAes1B,MAAf,CAAd,CAAnB,GAA2Dl/B,QAAQ,CAACrC,IAAT,EAAlE;AACD,KAHM,CAAP;AAID,GAND;;AAOA,MAAI6zD,GAAG,GAAG,UAAUkgE,cAAV,EAA0B/gG,QAA1B,EAAoC/P,GAApC,EAAyC;AACjD,QAAI64G,IAAI,GAAGtH,iBAAiB,CAACvxG,GAAD,CAA5B;AACA,WAAO+4G,oBAAoB,CAACjI,cAAD,EAAiB/gG,QAAjB,EAA2B8oG,IAA3B,CAApB,CAAqDz6H,IAArD,CAA0D,UAAUkgC,MAAV,EAAkB;AACjF,UAAI2zF,OAAO,GAAGt0D,YAAY,CAACr/B,MAAD,EAASu6F,IAAT,CAA1B;AACA,aAAO5G,OAAO,CAAC/0H,MAAR,KAAmBkC,QAAQ,CAACR,IAAT,CAAc85H,QAAQ,CAAC9nE,GAAT,CAAatyB,MAAb,CAAd,CAAnB,GAAyDl/B,QAAQ,CAACrC,IAAT,EAAhE;AACD,KAHM,CAAP;AAID,GAND;;AAOA,MAAIi8H,OAAO,GAAG,UAAUlI,cAAV,EAA0B/gG,QAA1B,EAAoC/P,GAApC,EAAyC;AACrD,QAAI64G,IAAI,GAAGrH,kBAAkB,CAACxxG,GAAD,CAA7B;AACA,QAAIzP,KAAK,GAAGooH,OAAO,CAAC5oG,QAAD,EAAW8oG,IAAI,CAAChrH,SAAL,EAAX,CAAnB;AACA,WAAOojH,cAAc,CAACH,cAAD,EAAiBvgH,KAAjB,EAAwBsoH,IAAxB,CAAd,CAA4Ct7H,IAA5C,CAAiD,YAAY;AAClE,aAAOqgE,YAAY,CAACrtD,KAAD,EAAQsoH,IAAR,CAAZ,CAA0Bz6H,IAA1B,CAA+BjC,KAAK,CAAC80H,cAAD,EAAiBH,cAAjB,EAAiCvgH,KAAjC,CAApC,EAA6ErS,GAA7E,CAAiF,UAAUogC,MAAV,EAAkB;AACxG,eAAOo6F,QAAQ,CAACnhH,KAAT,CAAe+mB,MAAf,CAAP;AACD,OAFM,CAAP;AAGD,KAJM,EAIJl/B,QAAQ,CAACrC,IAJL,CAAP;AAKD,GARD;;AASA,MAAIk8H,eAAe,GAAG,UAAUroF,QAAV,EAAoB;AACxC,WAAOmgF,OAAO,CAACl8D,UAAU,CAACjkB,QAAD,CAAX,CAAP,KAAkC,KAAzC;AACD,GAFD;;AAGA,MAAIsoF,YAAY,GAAG,UAAUpI,cAAV,EAA0B/gG,QAA1B,EAAoC/P,GAApC,EAAyC;AAC1D,QAAI4wB,QAAQ,GAAG4nF,aAAa,CAAC,CAC3BI,QAD2B,EAE3B5vH,KAF2B,EAG3B4nD,GAH2B,EAI3BooE,OAJ2B,CAAD,EAKzB,CACDlI,cADC,EAED/gG,QAFC,EAGD/P,GAHC,CALyB,CAA5B;AAUA,WAAO4wB,QAAQ,CAACryC,MAAT,CAAgB06H,eAAhB,CAAP;AACD,GAZD;;AAaA,MAAIpkE,UAAU,GAAG,UAAUjkB,QAAV,EAAoB;AACnC,WAAOA,QAAQ,CAACrzC,IAAT,CAAcrB,QAAd,EAAwBA,QAAxB,EAAkCA,QAAlC,EAA4CA,QAA5C,CAAP;AACD,GAFD;;AAGA,MAAIi9H,OAAO,GAAG,UAAUvoF,QAAV,EAAoB;AAChC,WAAOA,QAAQ,CAACrzC,IAAT,CAAcvB,QAAQ,CAAC,QAAD,CAAtB,EAAkCA,QAAQ,CAAC,OAAD,CAA1C,EAAqDA,QAAQ,CAAC,KAAD,CAA7D,EAAsEA,QAAQ,CAAC,OAAD,CAA9E,CAAP;AACD,GAFD;;AAGA,MAAIo9H,OAAO,GAAG,UAAUxoF,QAAV,EAAoB;AAChC,WAAOA,QAAQ,CAACrzC,IAAT,CAAcm7H,QAAQ,CAACvhH,MAAvB,EAA+BuhH,QAAQ,CAACvhH,MAAxC,EAAgDuhH,QAAQ,CAACnhH,KAAzD,EAAgEmhH,QAAQ,CAACnhH,KAAzE,CAAP;AACD,GAFD;;AAGA,MAAI8hH,MAAM,GAAG,UAAUzoF,QAAV,EAAoB;AAC/B,WAAOA,QAAQ,CAACrzC,IAAT,CAAcm7H,QAAQ,CAAC1vH,KAAvB,EAA8B0vH,QAAQ,CAAC1vH,KAAvC,EAA8C0vH,QAAQ,CAAC9nE,GAAvD,EAA4D8nE,QAAQ,CAAC9nE,GAArE,CAAP;AACD,GAFD;;AAGA,MAAI0oE,MAAM,GAAG,UAAUC,SAAV,EAAqBC,SAArB,EAAgC;AAC3C,WAAOL,OAAO,CAACI,SAAD,CAAP,KAAuBJ,OAAO,CAACK,SAAD,CAA9B,IAA6C3kE,UAAU,CAAC0kE,SAAD,CAAV,KAA0B1kE,UAAU,CAAC2kE,SAAD,CAAxF;AACD,GAFD;;AAGA,MAAIC,cAAc,GAAG,UAAU7pF,OAAV,EAAmBkhF,cAAnB,EAAmC/gG,QAAnC,EAA6C5wB,IAA7C,EAAmD4a,EAAnD,EAAuD62B,QAAvD,EAAiE;AACpF,WAAO2Z,KAAK,CAAC0mE,cAAc,CAACH,cAAD,EAAiB/gG,QAAjB,EAA2B5wB,IAA3B,CAAf,EAAiD8xH,cAAc,CAACH,cAAD,EAAiB/gG,QAAjB,EAA2BhW,EAA3B,CAA/D,EAA+F,UAAU2/G,UAAV,EAAsBC,QAAtB,EAAgC;AACzI,UAAID,UAAU,KAAKC,QAAf,IAA2BzI,kBAAkB,CAACnhG,QAAD,EAAW2pG,UAAX,EAAuBC,QAAvB,CAAjD,EAAmF;AACjF,eAAOjB,QAAQ,CAACnhH,KAAT,CAAeq4B,OAAO,GAAG8pF,UAAH,GAAgBC,QAAtC,CAAP;AACD,OAFD,MAEO;AACL,eAAO/oF,QAAP;AACD;AACF,KANW,CAAL,CAMJjzC,KANI,CAMEizC,QANF,CAAP;AAOD,GARD;;AASA,MAAIgpF,cAAc,GAAG,UAAUC,YAAV,EAAwBC,UAAxB,EAAoC;AACvD,WAAOD,YAAY,CAACt8H,IAAb,CAAkBT,MAAlB,EAA0B,UAAU+8H,YAAV,EAAwB;AACvD,aAAO,CAACP,MAAM,CAACO,YAAD,EAAeC,UAAf,CAAd;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAIC,oBAAoB,GAAG,UAAUnqF,OAAV,EAAmBkhF,cAAnB,EAAmC/gG,QAAnC,EAA6C8pG,YAA7C,EAA2D75G,GAA3D,EAAgE;AACzF,QAAI7gB,IAAI,GAAGmyH,iBAAiB,CAAC1hF,OAAD,EAAU5vB,GAAV,CAA5B;AACA,QAAIjG,EAAE,GAAGijD,YAAY,CAACptB,OAAD,EAAU7f,QAAV,EAAoB5wB,IAApB,CAAZ,CAAsCjB,GAAtC,CAA0C/B,KAAK,CAACm1H,iBAAD,EAAoB1hF,OAApB,CAA/C,CAAT;AACA,QAAIgB,QAAQ,GAAG72B,EAAE,CAACxc,IAAH,CAAQ,YAAY;AACjC,aAAOs8H,YAAY,CAAC37H,GAAb,CAAiBk7H,OAAjB,CAAP;AACD,KAFc,EAEZ,UAAUr/G,EAAV,EAAc;AACf,aAAOm/G,YAAY,CAACpI,cAAD,EAAiB/gG,QAAjB,EAA2BhW,EAA3B,CAAZ,CAA2C7b,GAA3C,CAA+C/B,KAAK,CAACs9H,cAAD,EAAiB7pF,OAAjB,EAA0BkhF,cAA1B,EAA0C/gG,QAA1C,EAAoD5wB,IAApD,EAA0D4a,EAA1D,CAApD,EAAmHxb,MAAnH,CAA0HpC,KAAK,CAACy9H,cAAD,EAAiBC,YAAjB,CAA/H,CAAP;AACD,KAJc,CAAf;AAKA,WAAOjpF,QAAQ,CAACryC,MAAT,CAAgB06H,eAAhB,CAAP;AACD,GATD;;AAUA,MAAIe,kBAAkB,GAAG,UAAUpqF,OAAV,EAAmBgB,QAAnB,EAA6B;AACpD,QAAIhB,OAAJ,EAAa;AACX,aAAOgB,QAAQ,CAACrzC,IAAT,CAAclC,OAAO,CAAC+D,QAAQ,CAACR,IAAV,EAAgB85H,QAAQ,CAAC1vH,KAAzB,CAArB,EAAsD5J,QAAQ,CAACrC,IAA/D,EAAqE1B,OAAO,CAAC+D,QAAQ,CAACR,IAAV,EAAgB85H,QAAQ,CAACnhH,KAAzB,CAA5E,EAA6GnY,QAAQ,CAACrC,IAAtH,CAAP;AACD,KAFD,MAEO;AACL,aAAO6zC,QAAQ,CAACrzC,IAAT,CAAc6B,QAAQ,CAACrC,IAAvB,EAA6B1B,OAAO,CAAC+D,QAAQ,CAACR,IAAV,EAAgB85H,QAAQ,CAACvhH,MAAzB,CAApC,EAAsE/X,QAAQ,CAACrC,IAA/E,EAAqF1B,OAAO,CAAC+D,QAAQ,CAACR,IAAV,EAAgB85H,QAAQ,CAAC9nE,GAAzB,CAA5F,CAAP;AACD;AACF,GAND;;AAOA,MAAIqpE,YAAY,GAAG,UAAUrqF,OAAV,EAAmBkhF,cAAnB,EAAmC/gG,QAAnC,EAA6C/P,GAA7C,EAAkD;AACnE,QAAI7gB,IAAI,GAAGmyH,iBAAiB,CAAC1hF,OAAD,EAAU5vB,GAAV,CAA5B;AACA,QAAI65G,YAAY,GAAGX,YAAY,CAACpI,cAAD,EAAiB/gG,QAAjB,EAA2B5wB,IAA3B,CAA/B;AACA,WAAO+5H,YAAY,CAACpI,cAAD,EAAiB/gG,QAAjB,EAA2B5wB,IAA3B,CAAZ,CAA6Cf,IAA7C,CAAkDjC,KAAK,CAAC69H,kBAAD,EAAqBpqF,OAArB,CAAvD,EAAsF3xC,OAAtF,CAA8F,YAAY;AAC/G,aAAO87H,oBAAoB,CAACnqF,OAAD,EAAUkhF,cAAV,EAA0B/gG,QAA1B,EAAoC8pG,YAApC,EAAkD75G,GAAlD,CAA3B;AACD,KAFM,CAAP;AAGD,GAND;;AAOA,MAAIk6G,YAAY,GAAG/9H,KAAK,CAAC89H,YAAD,EAAe,KAAf,CAAxB;AACA,MAAIE,YAAY,GAAGh+H,KAAK,CAAC89H,YAAD,EAAe,IAAf,CAAxB;;AAEA,MAAIG,qBAAqB,GAAG,UAAU7tG,MAAV,EAAkB;AAC5C,WAAOrsB,UAAU,CAACqsB,MAAM,CAACk6B,SAAP,CAAiBif,MAAjB,GAA0B20D,MAA3B,CAAjB;AACD,GAFD;;AAGA,MAAIC,OAAO,GAAG,UAAU1qF,OAAV,EAAmB6W,SAAnB,EAA8BzmC,GAA9B,EAAmC;AAC/C,QAAIqkE,KAAK,GAAGz0C,OAAO,GAAG,CAAH,GAAO,CAAC,CAA3B;AACA6W,IAAAA,SAAS,CAACiZ,MAAV,CAAiBtR,aAAa,CAACpuC,GAAG,CAACnS,SAAJ,EAAD,EAAkBmS,GAAG,CAACmT,MAAJ,KAAekxD,KAAjC,CAAb,CAAqDh2B,OAArD,EAAjB;AACA5H,IAAAA,SAAS,CAACif,MAAV,GAAmB20D,MAAnB,CAA0B,MAA1B,EAAkCzqF,OAAO,GAAG,SAAH,GAAe,UAAxD,EAAoE,MAApE;AACA,WAAO,IAAP;AACD,GALD;;AAMA,MAAI2qF,UAAU,GAAG,UAAU3qF,OAAV,EAAmBrjB,MAAnB,EAA2B;AAC1C,QAAIi6B,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AACA,QAAI1mC,GAAG,GAAG4vB,OAAO,GAAGwe,aAAa,CAACI,YAAd,CAA2BhI,GAA3B,CAAH,GAAqC4H,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAtD;;AACA,QAAI,CAAC4zE,qBAAqB,CAAC7tG,MAAD,CAA1B,EAAoC;AAClC,aAAO,KAAP;AACD,KAFD,MAEO,IAAIqjB,OAAO,IAAI3c,cAAc,CAACjT,GAAD,CAA7B,EAAoC;AACzC,aAAOs6G,OAAO,CAAC,IAAD,EAAO/tG,MAAM,CAACk6B,SAAd,EAAyBzmC,GAAzB,CAAd;AACD,KAFM,MAEA,IAAI,CAAC4vB,OAAD,IAAYvc,aAAa,CAACrT,GAAD,CAA7B,EAAoC;AACzC,aAAOs6G,OAAO,CAAC,KAAD,EAAQ/tG,MAAM,CAACk6B,SAAf,EAA0BzmC,GAA1B,CAAd;AACD,KAFM,MAEA;AACL,aAAO,KAAP;AACD;AACF,GAZD;;AAcA,MAAIw6G,gBAAgB,GAAG,UAAUjuG,MAAV,EAAkBvM,GAAlB,EAAuB;AAC5C,QAAIwmC,GAAG,GAAGj6B,MAAM,CAAChb,GAAP,CAAW+tC,SAAX,EAAV;AACAkH,IAAAA,GAAG,CAAC5G,QAAJ,CAAa5/B,GAAG,CAACnS,SAAJ,EAAb,EAA8BmS,GAAG,CAACmT,MAAJ,EAA9B;AACAqzB,IAAAA,GAAG,CAAC3G,MAAJ,CAAW7/B,GAAG,CAACnS,SAAJ,EAAX,EAA4BmS,GAAG,CAACmT,MAAJ,EAA5B;AACA5G,IAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB;AACD,GALD;;AAMA,MAAIi0E,WAAW,GAAG,UAAU1sG,KAAV,EAAiBzO,GAAjB,EAAsB;AACtC,QAAIyO,KAAJ,EAAW;AACTzO,MAAAA,GAAG,CAAC7B,YAAJ,CAAiB,mBAAjB,EAAsC,iBAAtC;AACD,KAFD,MAEO;AACL6B,MAAAA,GAAG,CAACrB,eAAJ,CAAoB,mBAApB;AACD;AACF,GAND;;AAOA,MAAIy8G,mBAAmB,GAAG,UAAUnuG,MAAV,EAAkBmsC,KAAlB,EAAyB9nB,QAAzB,EAAmC;AAC3D,WAAO2nF,WAAW,CAAC7/D,KAAD,EAAQ9nB,QAAR,CAAX,CAA6B1yC,GAA7B,CAAiC,UAAU8hB,GAAV,EAAe;AACrDw6G,MAAAA,gBAAgB,CAACjuG,MAAD,EAASvM,GAAT,CAAhB;AACA,aAAO4wB,QAAP;AACD,KAHM,CAAP;AAID,GALD;;AAMA,MAAI+pF,cAAc,GAAG,UAAUpuG,MAAV,EAAkBmsC,KAAlB,EAAyB9oB,OAAzB,EAAkC;AACrD,QAAI7f,QAAQ,GAAGxD,MAAM,CAACo6B,OAAP,EAAf;AACA,QAAIxnD,IAAI,GAAGivD,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAX;AACA,QAAIk0E,gBAAgB,GAAGz+H,KAAK,CAAC20H,cAAD,EAAiBvkG,MAAjB,CAA5B;AACA,QAAIqkB,QAAQ,GAAGqpF,YAAY,CAACrqF,OAAD,EAAUgrF,gBAAV,EAA4B7qG,QAA5B,EAAsC5wB,IAAtC,CAA3B;AACA,WAAOyxC,QAAQ,CAACxyC,IAAT,CAAc,UAAUwyC,QAAV,EAAoB;AACvC,aAAO8pF,mBAAmB,CAACnuG,MAAD,EAASmsC,KAAT,EAAgB9nB,QAAhB,CAA1B;AACD,KAFM,CAAP;AAGD,GARD;;AASA,MAAIiqF,aAAa,GAAG,UAAU/J,cAAV,EAA0Bv/G,GAA1B,EAA+BmrC,IAA/B,EAAqC;AACvD,QAAIo+E,gBAAgB,GAAG58H,GAAG,CAACgoD,aAAa,CAACv0C,YAAY,CAACX,OAAb,CAAqBO,GAAG,CAACypC,OAAJ,EAArB,CAAD,EAAsC,wCAAtC,CAAd,EAA+F,UAAU51C,CAAV,EAAa;AACpI,aAAOA,CAAC,CAACmM,GAAT;AACD,KAFyB,CAA1B;AAGA,QAAIwpH,eAAe,GAAGx8H,MAAM,CAACu8H,gBAAD,EAAmBhK,cAAnB,CAA5B;AACA,QAAIkK,aAAa,GAAGz8H,MAAM,CAACm+C,IAAD,EAAOo0E,cAAP,CAA1B;AACA3yH,IAAAA,IAAI,CAACwD,UAAU,CAACo5H,eAAD,EAAkBC,aAAlB,CAAX,EAA6C7+H,KAAK,CAACs+H,WAAD,EAAc,KAAd,CAAlD,CAAJ;AACAt8H,IAAAA,IAAI,CAACwD,UAAU,CAACq5H,aAAD,EAAgBD,eAAhB,CAAX,EAA6C5+H,KAAK,CAACs+H,WAAD,EAAc,IAAd,CAAlD,CAAJ;AACD,GARD;;AASA,MAAIQ,wBAAwB,GAAG,UAAU1uG,MAAV,EAAkBmsC,KAAlB,EAAyB;AACtD,QAAInsC,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,MAAkCpkC,MAAM,CAACijD,SAAP,KAAqB,IAAvD,IAA+D9W,KAAK,CAACx2D,GAAN,EAAnE,EAAgF;AAC9E,UAAI8d,GAAG,GAAGouC,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAV;;AACA,UAAI0H,aAAa,CAACO,cAAd,CAA6B3uC,GAA7B,KAAqCqxG,QAAQ,CAACrxG,GAAD,CAAR,KAAkB,KAA3D,EAAkE;AAChEw6G,QAAAA,gBAAgB,CAACjuG,MAAD,EAASgrC,mBAAmB,CAACmB,KAAK,CAACx2D,GAAN,EAAD,EAAc8d,GAAd,CAA5B,CAAhB;AACA04C,QAAAA,KAAK,CAACh7C,GAAN,CAAU,IAAV;AACD;AACF;AACF,GARD;;AASA,MAAIw9G,uBAAuB,GAAG,UAAUpK,cAAV,EAA0BvkG,MAA1B,EAAkCmsC,KAAlC,EAAyChc,IAAzC,EAA+C;AAC3E,QAAInwB,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,EAAJ,EAAoC;AAClC,UAAIwqE,OAAO,GAAG58H,MAAM,CAACm+C,IAAD,EAAOo0E,cAAP,CAApB;AACA3yH,MAAAA,IAAI,CAACg9H,OAAD,EAAU,UAAUC,OAAV,EAAmB;AAC/B,YAAIp7G,GAAG,GAAGouC,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAV;AACAwyE,QAAAA,YAAY,CAACpI,cAAD,EAAiBvkG,MAAM,CAACo6B,OAAP,EAAjB,EAAmC3mC,GAAnC,CAAZ,CAAoD5hB,IAApD,CAAyD,UAAUwyC,QAAV,EAAoB;AAC3E,iBAAO8pF,mBAAmB,CAACnuG,MAAD,EAASmsC,KAAT,EAAgB9nB,QAAhB,CAA1B;AACD,SAFD;AAGD,OALG,CAAJ;AAMD;AACF,GAVD;;AAWA,MAAIyqF,IAAI,GAAG,UAAU9uG,MAAV,EAAkBmsC,KAAlB,EAAyB9oB,OAAzB,EAAkC;AAC3C,WAAOslB,yBAAyB,CAAC3oC,MAAD,CAAzB,GAAoCouG,cAAc,CAACpuG,MAAD,EAASmsC,KAAT,EAAgB9oB,OAAhB,CAAd,CAAuClyC,MAAvC,EAApC,GAAsF,KAA7F;AACD,GAFD;;AAGA,MAAI49H,QAAQ,GAAG,UAAU1rF,OAAV,EAAmBrjB,MAAnB,EAA2BgvG,MAA3B,EAAmC;AAChD,WAAOrmE,yBAAyB,CAAC3oC,MAAD,CAAzB,GAAoCguG,UAAU,CAAC3qF,OAAD,EAAUrjB,MAAV,CAA9C,GAAkE,KAAzE;AACD,GAFD;;AAGA,MAAIivG,kBAAkB,GAAG,UAAUjvG,MAAV,EAAkB;AACzC,QAAImsC,KAAK,GAAG5W,IAAI,CAAC,IAAD,CAAhB;AACA,QAAI84E,gBAAgB,GAAGz+H,KAAK,CAAC20H,cAAD,EAAiBvkG,MAAjB,CAA5B;AACAA,IAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwB,UAAUjd,CAAV,EAAa;AACnC,UAAI8vD,yBAAyB,CAAC3oC,MAAD,CAAzB,IAAqC,EAAEvf,GAAG,CAACjH,OAAJ,CAAY2E,IAAZ,MAAsBtF,CAAC,CAAC28C,OAA1B,CAAzC,EAA6E;AAC3E84E,QAAAA,aAAa,CAACD,gBAAD,EAAmBruG,MAAM,CAAChb,GAA1B,EAA+BnM,CAAC,CAAC0P,OAAjC,CAAb;AACAmmH,QAAAA,wBAAwB,CAAC1uG,MAAD,EAASmsC,KAAT,CAAxB;AACAwiE,QAAAA,uBAAuB,CAACN,gBAAD,EAAmBruG,MAAnB,EAA2BmsC,KAA3B,EAAkCtzD,CAAC,CAAC0P,OAApC,CAAvB;AACD;AACF,KAND;AAOA,WAAO4jD,KAAP;AACD,GAXD;;AAYA,MAAI+iE,YAAY,GAAGt/H,KAAK,CAACm/H,QAAD,EAAW,IAAX,CAAxB;AACA,MAAII,YAAY,GAAGv/H,KAAK,CAACm/H,QAAD,EAAW,KAAX,CAAxB;;AAEA,MAAIK,kBAAkB,GAAG,UAAUx8H,IAAV,EAAgB4a,EAAhB,EAAoB;AAC3C,QAAIxM,KAAK,GAAGG,QAAQ,CAAC6xC,WAAT,EAAZ;AACAhyC,IAAAA,KAAK,CAACqyC,QAAN,CAAezgD,IAAI,CAAC0O,SAAL,EAAf,EAAiC1O,IAAI,CAACg0B,MAAL,EAAjC;AACA5lB,IAAAA,KAAK,CAACsyC,MAAN,CAAa9lC,EAAE,CAAClM,SAAH,EAAb,EAA6BkM,EAAE,CAACoZ,MAAH,EAA7B;AACA,WAAO5lB,KAAP;AACD,GALD;;AAMA,MAAIquH,6BAA6B,GAAG,UAAUt8G,GAAV,EAAe;AACjD,WAAOirC,KAAK,CAACsT,eAAe,CAACv+C,GAAD,CAAhB,EAAuBw+C,cAAc,CAACx+C,GAAD,CAArC,EAA4C,UAAU4oE,QAAV,EAAoBI,OAApB,EAA6B;AACnF,UAAIwpC,kBAAkB,GAAGR,iBAAiB,CAAC,IAAD,EAAOppC,QAAP,CAA1C;AACA,UAAI6pC,iBAAiB,GAAGT,iBAAiB,CAAC,KAAD,EAAQhpC,OAAR,CAAzC;AACA,aAAO3qB,YAAY,CAACr+C,GAAD,EAAMwyG,kBAAN,CAAZ,CAAsCxzH,MAAtC,CAA6C,UAAU0hB,GAAV,EAAe;AACjE,eAAOA,GAAG,CAACkrC,OAAJ,CAAY6mE,iBAAZ,CAAP;AACD,OAFM,CAAP;AAGD,KANW,CAAL,CAMJp0H,KANI,CAME,IANF,CAAP;AAOD,GARD;;AASA,MAAIk+H,gBAAgB,GAAG,UAAUtvG,MAAV,EAAkBmsC,KAAlB,EAAyB;AAC9C,WAAO,UAAU9nB,QAAV,EAAoB;AACzB,aAAO2nF,WAAW,CAAC7/D,KAAD,EAAQ9nB,QAAR,CAAX,CAA6BvyC,MAA7B,CAAoC,UAAU2hB,GAAV,EAAe;AACxDw6G,QAAAA,gBAAgB,CAACjuG,MAAD,EAASvM,GAAT,CAAhB;AACA,eAAO,IAAP;AACD,OAHM,CAAP;AAID,KALD;AAMD,GAPD;;AAQA,MAAI87G,YAAY,GAAG,UAAUvvG,MAAV,EAAkBmsC,KAAlB,EAAyBv5D,IAAzB,EAA+B4a,EAA/B,EAAmC;AACpD,QAAIgW,QAAQ,GAAGxD,MAAM,CAACo6B,OAAP,EAAf;AACA,QAAIi0E,gBAAgB,GAAGz+H,KAAK,CAAC20H,cAAD,EAAiBvkG,MAAjB,CAA5B;AACAA,IAAAA,MAAM,CAAC27C,WAAP,CAAmBuhC,MAAnB,CAA0B,YAAY;AACpCl9E,MAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBi8D,kBAAkB,CAACx8H,IAAD,EAAO4a,EAAP,CAA1C;AACAwS,MAAAA,MAAM,CAAC6iD,WAAP,CAAmB,QAAnB;AACA8pD,MAAAA,YAAY,CAAC0B,gBAAD,EAAmB7qG,QAAnB,EAA6Bq+B,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAA7B,CAAZ,CAAkGxoD,GAAlG,CAAsGm7H,MAAtG,EAA8Gn7H,GAA9G,CAAkH29H,gBAAgB,CAACtvG,MAAD,EAASmsC,KAAT,CAAlI;AACD,KAJD;AAKAnsC,IAAAA,MAAM,CAAC2hD,WAAP;AACD,GATD;;AAUA,MAAI6tD,SAAS,GAAG,UAAUhsG,QAAV,EAAoB5e,IAApB,EAA0B;AACxC,QAAI65E,WAAW,GAAGjxB,cAAc,CAAC5oD,IAAD,EAAO4e,QAAP,CAAhC;AACA,WAAOi7D,WAAW,GAAGA,WAAH,GAAiBj7D,QAAnC;AACD,GAHD;;AAIA,MAAIisG,wBAAwB,GAAG,UAAUzvG,MAAV,EAAkBmsC,KAAlB,EAAyB9oB,OAAzB,EAAkCzwC,IAAlC,EAAwC;AACrE,QAAI4wB,QAAQ,GAAGgsG,SAAS,CAACxvG,MAAM,CAACo6B,OAAP,EAAD,EAAmBxnD,IAAI,CAAC0O,SAAL,EAAnB,CAAxB;AACA,QAAI+sH,gBAAgB,GAAGz+H,KAAK,CAAC20H,cAAD,EAAiBvkG,MAAjB,CAA5B;AACA,QAAIstG,YAAY,GAAGX,YAAY,CAAC0B,gBAAD,EAAmB7qG,QAAnB,EAA6B5wB,IAA7B,CAA/B;AACA,WAAO06H,YAAY,CAACz7H,IAAb,CAAkB,UAAUwyC,QAAV,EAAoB;AAC3C,UAAIhB,OAAJ,EAAa;AACX,eAAOgB,QAAQ,CAACrzC,IAAT,CAAcvB,QAAQ,CAACoD,QAAQ,CAACR,IAAT,CAAcy6H,MAAM,CAACzoF,QAAD,CAApB,CAAD,CAAtB,EAAyDxxC,QAAQ,CAACrC,IAAlE,EAAwEf,QAAQ,CAACoD,QAAQ,CAACR,IAAT,CAAcw6H,OAAO,CAACxoF,QAAD,CAArB,CAAD,CAAhF,EAAoHxxC,QAAQ,CAACrC,IAA7H,CAAP;AACD,OAFD,MAEO;AACL,eAAO6zC,QAAQ,CAACrzC,IAAT,CAAc6B,QAAQ,CAACrC,IAAvB,EAA6Bf,QAAQ,CAACoD,QAAQ,CAACR,IAAT,CAAcw6H,OAAO,CAACxoF,QAAD,CAArB,CAAD,CAArC,EAAyExxC,QAAQ,CAACrC,IAAlF,EAAwFf,QAAQ,CAACoD,QAAQ,CAACR,IAAT,CAAcy6H,MAAM,CAACzoF,QAAD,CAApB,CAAD,CAAhG,CAAP;AACD;AACF,KANM,EAMJ1yC,GANI,CAMA29H,gBAAgB,CAACtvG,MAAD,EAASmsC,KAAT,CANhB,EAMiC96D,UANjC,CAM4C,YAAY;AAC7D,UAAIq+H,UAAU,GAAG1+D,QAAQ,CAAC3tB,OAAD,EAAU7f,QAAV,EAAoB5wB,IAApB,CAAzB;AACA,UAAI26H,UAAU,GAAGmC,UAAU,CAAC79H,IAAX,CAAgB,UAAU4hB,GAAV,EAAe;AAC9C,eAAOk5G,YAAY,CAAC0B,gBAAD,EAAmB7qG,QAAnB,EAA6B/P,GAA7B,CAAnB;AACD,OAFgB,CAAjB;AAGA,aAAOuqC,KAAK,CAACsvE,YAAD,EAAeC,UAAf,EAA2B,YAAY;AACjD,eAAO7I,cAAc,CAAC2J,gBAAD,EAAmB7qG,QAAnB,EAA6B5wB,IAA7B,CAAd,CAAiDd,MAAjD,CAAwD,UAAUihB,GAAV,EAAe;AAC5E,cAAIs8G,6BAA6B,CAACt8G,GAAD,CAAjC,EAAwC;AACtCurE,YAAAA,aAAa,CAACt+D,MAAD,EAASqjB,OAAT,EAAkBj+B,YAAY,CAACX,OAAb,CAAqBsO,GAArB,CAAlB,CAAb;AACA,mBAAO,IAAP;AACD,WAHD,MAGO;AACL,mBAAO,KAAP;AACD;AACF,SAPM,CAAP;AAQD,OATW,CAAL,CASJrhB,OATI,CASI,YAAY;AACrB,eAAO67H,UAAU,CAAC17H,IAAX,CAAgB,UAAUuqB,CAAV,EAAa;AAClC,iBAAOszG,UAAU,CAAC/9H,GAAX,CAAe,UAAU6b,EAAV,EAAc;AAClC,gBAAI61B,OAAJ,EAAa;AACXksF,cAAAA,YAAY,CAACvvG,MAAD,EAASmsC,KAAT,EAAgBv5D,IAAhB,EAAsB4a,EAAtB,CAAZ;AACD,aAFD,MAEO;AACL+hH,cAAAA,YAAY,CAACvvG,MAAD,EAASmsC,KAAT,EAAgB3+C,EAAhB,EAAoB5a,IAApB,CAAZ;AACD;;AACD,mBAAO,IAAP;AACD,WAPM,CAAP;AAQD,SATM,CAAP;AAUD,OApBM,EAoBJxB,KApBI,CAoBE,KApBF,CAAP;AAqBD,KAhCM,CAAP;AAiCD,GArCD;;AAsCA,MAAIu+H,iBAAiB,GAAG,UAAU3vG,MAAV,EAAkBmsC,KAAlB,EAAyB9oB,OAAzB,EAAkC;AACxD,QAAIrjB,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,MAAkCuE,yBAAyB,CAAC3oC,MAAD,CAA/D,EAAyE;AACvE,UAAIptB,IAAI,GAAGivD,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAX;AACA,aAAOs1E,wBAAwB,CAACzvG,MAAD,EAASmsC,KAAT,EAAgB9oB,OAAhB,EAAyBzwC,IAAzB,CAA/B;AACD;;AACD,WAAO,KAAP;AACD,GAND;;AAQA,MAAIg9H,gBAAgB,GAAG,UAAUr8G,OAAV,EAAmB8uD,QAAnB,EAA6B;AAClD,QAAI95D,OAAO,GAAGgxE,cAAc,CAAClX,QAAD,EAAW9uD,OAAX,CAA5B;AACA,WAAOte,SAAS,CAACsT,OAAD,EAAUqc,OAAV,CAAT,CAA4B5zB,IAA5B,CAAiCvB,QAAQ,CAAC8Y,OAAD,CAAzC,EAAoD,UAAUzQ,KAAV,EAAiB;AAC1E,aAAOyQ,OAAO,CAACjb,KAAR,CAAc,CAAd,EAAiBwK,KAAjB,CAAP;AACD,KAFM,CAAP;AAGD,GALD;;AAMA,MAAI+3H,iBAAiB,GAAG,UAAU98G,GAAV,EAAe;AACrC,WAAOhK,QAAQ,CAACgK,GAAD,CAAR,CAAc/kB,MAAd,KAAyB,CAAhC;AACD,GAFD;;AAGA,MAAI8hI,kBAAkB,GAAG,UAAUzsF,OAAV,EAAmBrjB,MAAnB,EAA2B5iB,MAA3B,EAAmC2yH,aAAnC,EAAkD;AACzE,QAAIC,iBAAiB,GAAGpgI,KAAK,CAACy8F,eAAD,EAAkBrsE,MAAlB,CAA7B;AACA,QAAIgrE,WAAW,GAAGr5F,GAAG,CAACK,MAAM,CAAC+9H,aAAD,EAAgBC,iBAAhB,CAAP,EAA2C,UAAUj9G,GAAV,EAAe;AAC7E,aAAOA,GAAG,CAAC/N,GAAX;AACD,KAFoB,CAArB;;AAGA,QAAIgmF,WAAW,CAACh9F,MAAZ,KAAuB,CAA3B,EAA8B;AAC5BswF,MAAAA,aAAa,CAACt+D,MAAD,EAASqjB,OAAT,EAAkBjmC,MAAlB,CAAb;AACD,KAFD,MAEO;AACL,UAAIqW,GAAG,GAAG04E,sBAAsB,CAAC/uF,MAAM,CAAC4H,GAAR,EAAagmF,WAAb,CAAhC;AACAhrE,MAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwB1/C,GAAG,CAACquC,OAAJ,EAAxB;AACD;AACF,GAXD;;AAYA,MAAImuE,aAAa,GAAG,UAAUjwG,MAAV,EAAkBqjB,OAAlB,EAA2B;AAC7C,QAAI9vB,OAAO,GAAGnO,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAd;AACA,QAAIioB,QAAQ,GAAGj9D,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,EAArB,CAAf;AACA,QAAIqtD,aAAa,GAAG/9H,MAAM,CAAC49H,gBAAgB,CAACr8G,OAAD,EAAU8uD,QAAV,CAAjB,EAAsCwtD,iBAAtC,CAA1B;AACA,WAAOh6H,IAAI,CAACk6H,aAAD,CAAJ,CAAoBj+H,MAApB,CAA2B,UAAUsL,MAAV,EAAkB;AAClD,UAAIwlF,OAAO,GAAG/gC,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAd;;AACA,UAAImrE,+BAA+B,CAACjiF,OAAD,EAAUu/C,OAAV,EAAmBxlF,MAAM,CAAC4H,GAA1B,CAA/B,IAAiE,CAACunF,yBAAyB,CAACnvF,MAAD,CAA/F,EAAyG;AACvG0yH,QAAAA,kBAAkB,CAACzsF,OAAD,EAAUrjB,MAAV,EAAkB5iB,MAAlB,EAA0B2yH,aAA1B,CAAlB;AACA,eAAO,IAAP;AACD,OAHD,MAGO;AACL,eAAO,KAAP;AACD;AACF,KARM,CAAP;AASD,GAbD;;AAcA,MAAIG,iBAAiB,GAAG,UAAUlwG,MAAV,EAAkBqjB,OAAlB,EAA2B;AACjD,WAAOrjB,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,KAAiC6rE,aAAa,CAACjwG,MAAD,EAASqjB,OAAT,CAA9C,GAAkE,KAAzE;AACD,GAFD;;AAIA,MAAI8sF,eAAe,GAAG,UAAUnwG,MAAV,EAAkBqjB,OAAlB,EAA2Bn9B,OAA3B,EAAoC;AACxD8Z,IAAAA,MAAM,CAAC8mE,mBAAP,CAA2B2jC,aAA3B;;AACAnsC,IAAAA,aAAa,CAACt+D,MAAD,EAASqjB,OAAT,EAAkBj+B,YAAY,CAACX,OAAb,CAAqByB,OAArB,CAAlB,CAAb;AACA,WAAO,IAAP;AACD,GAJD;;AAKA,MAAIkqH,aAAa,GAAG,UAAUpwG,MAAV,EAAkBqjB,OAAlB,EAA2B;AAC7C,QAAIgtF,WAAW,GAAGhtF,OAAO,GAAGk1C,aAAH,GAAmBC,YAA5C;AACA,QAAI/6B,SAAS,GAAGpa,OAAO,GAAG+rB,UAAU,CAACa,QAAd,GAAyBb,UAAU,CAACkB,SAA3D;AACA,QAAIsyB,OAAO,GAAGh0B,0BAA0B,CAACnR,SAAD,EAAYz9B,MAAM,CAACo6B,OAAP,EAAZ,EAA8Bp6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA9B,CAAxC;;AACA,QAAIk2E,WAAW,CAACztC,OAAD,CAAf,EAA0B;AACxB,aAAOutC,eAAe,CAACnwG,MAAD,EAASqjB,OAAT,EAAkBu/C,OAAO,CAACtjC,OAAR,CAAgB,CAACjc,OAAjB,CAAlB,CAAtB;AACD,KAFD,MAEO;AACL,aAAOxwC,QAAQ,CAACD,IAAT,CAAcmyH,iBAAiB,CAAC1hF,OAAD,EAAUu/C,OAAV,CAA/B,EAAmD5wF,MAAnD,CAA0D,UAAUyhB,GAAV,EAAe;AAC9E,eAAO48G,WAAW,CAAC58G,GAAD,CAAX,IAAoBy7C,qBAAqB,CAAC0zB,OAAD,EAAUnvE,GAAV,CAAhD;AACD,OAFM,EAEJ3hB,MAFI,CAEG,UAAU2hB,GAAV,EAAe;AACvB,eAAO08G,eAAe,CAACnwG,MAAD,EAASqjB,OAAT,EAAkB5vB,GAAG,CAAC6rC,OAAJ,CAAY,CAACjc,OAAb,CAAlB,CAAtB;AACD,OAJM,CAAP;AAKD;AACF,GAbD;;AAcA,MAAIitF,aAAa,GAAG,UAAUtwG,MAAV,EAAkBqjB,OAAlB,EAA2B;AAC7C,QAAIunF,YAAY,GAAG5qG,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,EAAnB;AACA,WAAOxuC,OAAO,CAAC85G,YAAD,CAAP,GAAwBuF,eAAe,CAACnwG,MAAD,EAASqjB,OAAT,EAAkBunF,YAAlB,CAAvC,GAAyE,KAAhF;AACD,GAHD;;AAIA,MAAI2F,iBAAiB,GAAG,UAAUvwG,MAAV,EAAkBqjB,OAAlB,EAA2B;AACjD,WAAOrjB,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,KAAiCgsE,aAAa,CAACpwG,MAAD,EAASqjB,OAAT,CAA9C,GAAkEitF,aAAa,CAACtwG,MAAD,EAASqjB,OAAT,CAAtF;AACD,GAFD;;AAIA,MAAImtF,YAAY,GAAG,UAAUpzH,MAAV,EAAkB;AACnC,WAAOohB,OAAO,CAACphB,MAAD,EAAS,UAAU2V,GAAV,EAAe;AACpC,aAAOpC,qBAAqB,CAACoC,GAAG,CAAC/N,GAAL,CAArB,IAAkC4L,sBAAsB,CAACmC,GAAG,CAAC/N,GAAL,CAA/D;AACD,KAFa,CAAP,CAEJlT,MAFI,CAEG,UAAUihB,GAAV,EAAe;AACvB,aAAOpC,qBAAqB,CAACoC,GAAG,CAAC/N,GAAL,CAA5B;AACD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAIyrH,gBAAgB,GAAG,UAAU/gI,KAAV,EAAiB;AACtC,QAAIghI,MAAM,GAAGplG,QAAQ,CAAC57B,KAAD,EAAQ,EAAR,CAArB;AACA,WAAOq2E,KAAK,CAAC2qD,MAAD,CAAL,GAAgB,CAAhB,GAAoBA,MAA3B;AACD,GAHD;;AAIA,MAAIC,kBAAkB,GAAG,UAAUC,SAAV,EAAqB1qH,OAArB,EAA8B;AACrD,QAAI2qH,eAAe,GAAGD,SAAS,IAAI/rG,SAAS,CAAC3e,OAAD,CAAtB,GAAkC,QAAlC,GAA6C,SAAnE;AACA,QAAI0vB,MAAM,GAAG1jB,KAAK,CAAChM,OAAD,EAAU,WAAV,CAAL,KAAgC,KAAhC,GAAwC,QAAxC,GAAmD,OAAhE;AACA,WAAO2qH,eAAe,GAAGj7F,MAAzB;AACD,GAJD;;AAKA,MAAIk7F,aAAa,GAAG,UAAU9rH,GAAV,EAAe+9G,OAAf,EAAwB6N,SAAxB,EAAmClhI,KAAnC,EAA0CqhI,IAA1C,EAAgD7qH,OAAhD,EAAyD;AAC3E,QAAI2qH,eAAe,GAAGF,kBAAkB,CAACC,SAAD,EAAYxrH,YAAY,CAACX,OAAb,CAAqByB,OAArB,CAAZ,CAAxC;;AACA,QAAI68G,OAAO,KAAK,SAAhB,EAA2B;AACzB,UAAIiO,UAAU,GAAGtiH,IAAI,CAACC,GAAL,CAAS,CAAT,EAAY8hH,gBAAgB,CAACvqH,OAAO,CAAC8K,KAAR,CAAc6/G,eAAd,CAAD,CAAhB,GAAmDnhI,KAA/D,CAAjB;AACAsV,MAAAA,GAAG,CAAC2qC,QAAJ,CAAazpC,OAAb,EAAsB2qH,eAAtB,EAAuCG,UAAU,GAAGA,UAAU,GAAGD,IAAhB,GAAuB,EAAxE;AACD,KAHD,MAGO;AACL,UAAIC,UAAU,GAAGP,gBAAgB,CAACvqH,OAAO,CAAC8K,KAAR,CAAc6/G,eAAd,CAAD,CAAhB,GAAmDnhI,KAAnD,GAA2DqhI,IAA5E;AACA/rH,MAAAA,GAAG,CAAC2qC,QAAJ,CAAazpC,OAAb,EAAsB2qH,eAAtB,EAAuCG,UAAvC;AACD;AACF,GATD;;AAUA,MAAIC,cAAc,GAAG,UAAUjxG,MAAV,EAAkBiE,MAAlB,EAA0B;AAC7C,WAAOlyB,MAAM,CAACkyB,MAAD,EAAS,UAAUoiC,KAAV,EAAiB;AACrC,UAAIwqE,eAAe,GAAGF,kBAAkB,CAAChpE,qBAAqB,CAAC3nC,MAAD,CAAtB,EAAgCqmC,KAAhC,CAAxC;AACA,UAAI6qE,WAAW,GAAG7+G,MAAM,CAACg0C,KAAD,EAAQwqE,eAAR,CAAN,CAA+Bl/H,GAA/B,CAAmC8+H,gBAAnC,EAAqDr/H,KAArD,CAA2D,CAA3D,CAAlB;AACA,UAAIyP,eAAe,GAAGmf,MAAM,CAAChb,GAAP,CAAW0uC,kBAAX,CAA8B2S,KAAK,CAACrhD,GAApC,CAAtB;AACA,aAAOnE,eAAe,KAAK,OAApB,IAA+BqwH,WAAW,GAAG,CAApD;AACD,KALY,CAAb;AAMD,GAPD;;AAQA,MAAIC,UAAU,GAAG,UAAUnxG,MAAV,EAAkB;AACjC,QAAIiE,MAAM,GAAGmtG,iBAAiB,CAACpxG,MAAD,CAA9B;AACA,WAAO,CAACA,MAAM,CAAC8N,IAAP,CAAY47B,UAAZ,EAAD,KAA8BzlC,MAAM,CAACj2B,MAAP,GAAgB,CAAhB,IAAqBijI,cAAc,CAACjxG,MAAD,EAASiE,MAAT,CAAjE,CAAP;AACD,GAHD;;AAIA,MAAIotG,eAAe,GAAG,UAAU9mH,EAAV,EAAc;AAClC,WAAO0a,MAAM,CAAC1a,EAAD,CAAN,IAAc2a,UAAU,CAAC3a,EAAD,CAA/B;AACD,GAFD;;AAGA,MAAI+mH,qBAAqB,GAAG,UAAU/mH,EAAV,EAAc;AACxC,WAAOvH,MAAM,CAACuH,EAAD,CAAN,CAAW5Y,GAAX,CAAe0/H,eAAf,EAAgCjgI,KAAhC,CAAsC,KAAtC,CAAP;AACD,GAFD;;AAGA,MAAIggI,iBAAiB,GAAG,UAAUpxG,MAAV,EAAkB;AACxC,WAAOhuB,MAAM,CAACL,GAAG,CAACquB,MAAM,CAACk6B,SAAP,CAAiBq1B,iBAAjB,EAAD,EAAuCnqE,YAAY,CAACX,OAApD,CAAJ,EAAkE,UAAU8F,EAAV,EAAc;AAC3F,aAAO,CAAC8mH,eAAe,CAAC9mH,EAAD,CAAhB,IAAwB,CAAC+mH,qBAAqB,CAAC/mH,EAAD,CAA9C,IAAsDimH,YAAY,CAACjmH,EAAD,CAAzE;AACD,KAFY,CAAb;AAGD,GAJD;;AAKA,MAAI+M,MAAM,GAAG,UAAU0I,MAAV,EAAkB+iG,OAAlB,EAA2B;AACtC,QAAI/9G,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AAAA,QAAsBk1C,SAAS,GAAGl6B,MAAM,CAACk6B,SAAzC;AAAA,QAAoDmb,SAAS,GAAGr1C,MAAM,CAACq1C,SAAvE;AACA,QAAIk8D,WAAW,GAAG3pE,cAAc,CAAC5nC,MAAD,CAAhC;AACA,QAAIwxG,UAAU,GAAG,YAAYhvH,IAAZ,CAAiB+uH,WAAjB,EAA8B,CAA9B,CAAjB;AACA,QAAIE,WAAW,GAAGnmG,QAAQ,CAACimG,WAAD,EAAc,EAAd,CAA1B;AACA,QAAIX,SAAS,GAAGjpE,qBAAqB,CAAC3nC,MAAD,CAArC;AACA,QAAIovE,eAAe,GAAGhpC,kBAAkB,CAACpmC,MAAD,CAAxC;;AACA,QAAI,CAACA,MAAM,CAAC0xG,iBAAP,CAAyB,qBAAzB,CAAD,IAAoD,CAAC1xG,MAAM,CAAC0xG,iBAAP,CAAyB,mBAAzB,CAAzD,EAAwG;AACtG,UAAItiC,eAAe,KAAK,EAApB,IAA0B,CAACpqF,GAAG,CAACurC,SAAJ,CAAc2J,SAAS,CAACoF,OAAV,EAAd,EAAmCt6C,GAAG,CAAC4f,OAAvC,CAA/B,EAAgF;AAC9EywC,QAAAA,SAAS,CAACjmE,KAAV,CAAgB,KAAhB;AACD;AACF;;AACDwC,IAAAA,IAAI,CAACw/H,iBAAiB,CAACpxG,MAAD,CAAlB,EAA4B,UAAUqmC,KAAV,EAAiB;AAC/CyqE,MAAAA,aAAa,CAAC9rH,GAAD,EAAM+9G,OAAN,EAAe6N,SAAf,EAA0Ba,WAA1B,EAAuCD,UAAvC,EAAmDnrE,KAAK,CAACrhD,GAAzD,CAAb;AACD,KAFG,CAAJ;AAGD,GAfD;;AAiBA,MAAI2sH,iBAAiB,GAAG,UAAU3xG,MAAV,EAAkBooG,QAAlB,EAA4B;AAClD,QAAIpoG,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,MAAkC+sE,UAAU,CAACnxG,MAAD,CAAhD,EAA0D;AACxD,UAAIhb,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,UAAIi1C,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AACA,UAAI1mC,GAAG,GAAGouC,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAV;AACA,UAAIoM,KAAK,GAAGrhD,GAAG,CAACurC,SAAJ,CAAc0J,GAAG,CAACryB,cAAlB,EAAkC5iB,GAAG,CAAC4f,OAAtC,CAAZ;;AACA,UAAIyhC,KAAK,KAAK,IAAV,IAAkByzB,gBAAgB,CAAC10E,YAAY,CAACX,OAAb,CAAqB4hD,KAArB,CAAD,EAA8B5yC,GAA9B,CAAtC,EAA0E;AACxE6D,QAAAA,MAAM,CAAC0I,MAAD,EAAS,SAAT,CAAN;AACA,eAAO,IAAP;AACD;AACF;;AACD,WAAO,KAAP;AACD,GAZD;;AAcA,MAAI4xG,aAAa,GAAG,UAAU5xG,MAAV,EAAkB+iG,OAAlB,EAA2B;AAC7C/iG,IAAAA,MAAM,CAACm7C,MAAP,GAAgB0H,WAAhB,CAA4BkgD,OAA5B,EAAqC,KAArC,EAA4C,IAA5C;AACD,GAFD;;AAGA,MAAI8O,aAAa,GAAG,UAAU7xG,MAAV,EAAkBmsC,KAAlB,EAAyB;AAC3C,QAAIwlE,iBAAiB,CAAC3xG,MAAD,CAArB,EAA+B;AAC7B;AACD,KAFD,MAEO,IAAIirG,iBAAiB,CAACjrG,MAAD,EAAS,KAAT,CAArB,EAAsC;AAC3C;AACD,KAFM,MAEA,IAAIwpG,iBAAiB,CAACxpG,MAAD,EAAS,KAAT,CAArB,EAAsC;AAC3C;AACD,KAFM,MAEA,IAAI2vG,iBAAiB,CAAC3vG,MAAD,EAASmsC,KAAT,EAAgB,KAAhB,CAArB,EAA6C;AAClD;AACD,KAFM,MAEA,IAAIu7D,iBAAiB,CAAC1nG,MAAD,EAAS,KAAT,CAArB,EAAsC;AAC3C;AACD,KAFM,MAEA,IAAI8iE,eAAe,CAAC9iE,MAAD,CAAnB,EAA6B;AAClC;AACD,KAFM,MAEA,IAAImrG,iBAAiB,CAACnrG,MAAD,EAAS,KAAT,CAArB,EAAsC;AAC3C;AACD,KAFM,MAEA,IAAIuwG,iBAAiB,CAACvwG,MAAD,EAAS,KAAT,CAArB,EAAsC;AAC3C;AACD,KAFM,MAEA,IAAImoG,iBAAiB,CAACnoG,MAAD,CAArB,EAA+B;AACpC;AACD,KAFM,MAEA,IAAIkwG,iBAAiB,CAAClwG,MAAD,EAAS,KAAT,CAArB,EAAsC;AAC3C;AACD,KAFM,MAEA;AACL4xG,MAAAA,aAAa,CAAC5xG,MAAD,EAAS,QAAT,CAAb;AACAqlG,MAAAA,aAAa,CAACrlG,MAAD,CAAb;AACD;AACF,GAzBD;;AA0BA,MAAI8xG,oBAAoB,GAAG,UAAU9xG,MAAV,EAAkBmsC,KAAlB,EAAyB;AAClD,QAAI8+D,iBAAiB,CAACjrG,MAAD,EAAS,IAAT,CAArB,EAAqC;AACnC;AACD,KAFD,MAEO,IAAIwpG,iBAAiB,CAACxpG,MAAD,EAAS,IAAT,CAArB,EAAqC;AAC1C;AACD,KAFM,MAEA,IAAI2vG,iBAAiB,CAAC3vG,MAAD,EAASmsC,KAAT,EAAgB,IAAhB,CAArB,EAA4C;AACjD;AACD,KAFM,MAEA,IAAIu7D,iBAAiB,CAAC1nG,MAAD,EAAS,IAAT,CAArB,EAAqC;AAC1C;AACD,KAFM,MAEA,IAAI8iE,eAAe,CAAC9iE,MAAD,CAAnB,EAA6B;AAClC;AACD,KAFM,MAEA,IAAImrG,iBAAiB,CAACnrG,MAAD,EAAS,IAAT,CAArB,EAAqC;AAC1C;AACD,KAFM,MAEA,IAAIuwG,iBAAiB,CAACvwG,MAAD,EAAS,IAAT,CAArB,EAAqC;AAC1C;AACD,KAFM,MAEA,IAAImoG,iBAAiB,CAACnoG,MAAD,CAArB,EAA+B;AACpC;AACD,KAFM,MAEA,IAAIkwG,iBAAiB,CAAClwG,MAAD,EAAS,IAAT,CAArB,EAAqC;AAC1C;AACD,KAFM,MAEA;AACL4xG,MAAAA,aAAa,CAAC5xG,MAAD,EAAS,eAAT,CAAb;AACD;AACF,GAtBD;;AAuBA,MAAI+xG,OAAO,GAAG,UAAU/xG,MAAV,EAAkBmsC,KAAlB,EAAyB;AACrCnsC,IAAAA,MAAM,CAACgyG,UAAP,CAAkB,QAAlB,EAA4B,YAAY;AACtCH,MAAAA,aAAa,CAAC7xG,MAAD,EAASmsC,KAAT,CAAb;AACD,KAFD;AAGAnsC,IAAAA,MAAM,CAACgyG,UAAP,CAAkB,eAAlB,EAAmC,YAAY;AAC7CF,MAAAA,oBAAoB,CAAC9xG,MAAD,EAASmsC,KAAT,CAApB;AACD,KAFD;AAGD,GAPD;;AASA,MAAI8lE,gBAAgB,GAAG,CAAvB;AACA,MAAIC,eAAe,GAAG,GAAtB;;AACA,MAAIC,QAAQ,GAAG,UAAU7nH,KAAV,EAAiB;AAC9B,QAAIA,KAAK,CAAC61D,OAAN,KAAkB3zE,SAAlB,IAA+B8d,KAAK,CAAC61D,OAAN,CAAcnyE,MAAd,KAAyB,CAA5D,EAA+D;AAC7D,aAAO6E,QAAQ,CAACrC,IAAT,EAAP;AACD;;AACD,WAAOqC,QAAQ,CAACR,IAAT,CAAciY,KAAK,CAAC61D,OAAN,CAAc,CAAd,CAAd,CAAP;AACD,GALD;;AAMA,MAAIiyD,WAAW,GAAG,UAAUlyD,KAAV,EAAiB1lD,IAAjB,EAAuB;AACvC,QAAI63G,KAAK,GAAG3jH,IAAI,CAAC8wD,GAAL,CAASU,KAAK,CAACpnC,OAAN,GAAgBte,IAAI,CAACjuB,CAA9B,CAAZ;AACA,QAAI+lI,KAAK,GAAG5jH,IAAI,CAAC8wD,GAAL,CAASU,KAAK,CAACjnC,OAAN,GAAgBze,IAAI,CAAC5sB,CAA9B,CAAZ;AACA,WAAOykI,KAAK,GAAGJ,gBAAR,IAA4BK,KAAK,GAAGL,gBAA3C;AACD,GAJD;;AAKA,MAAIM,OAAO,GAAG,UAAUvyG,MAAV,EAAkB;AAC9B,QAAIwyG,SAAS,GAAGj9E,IAAI,CAAC1iD,QAAQ,CAACrC,IAAT,EAAD,CAApB;AACA,QAAIiiI,cAAc,GAAGl9E,IAAI,CAAC,KAAD,CAAzB;AACA,QAAIm9E,iBAAiB,GAAG95E,MAAM,CAAC,UAAU//C,CAAV,EAAa;AAC1CmnB,MAAAA,MAAM,CAACmb,IAAP,CAAY,WAAZ,EAAyB1iC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKI,CAAL,CAAT,EAAkB;AAAE7F,QAAAA,IAAI,EAAE;AAAR,OAAlB,CAAjC;AACAy/H,MAAAA,cAAc,CAACthH,GAAf,CAAmB,IAAnB;AACD,KAH6B,EAG3B+gH,eAH2B,CAA9B;AAIAlyG,IAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwB,UAAUjd,CAAV,EAAa;AACnCs5H,MAAAA,QAAQ,CAACt5H,CAAD,CAAR,CAAYjH,IAAZ,CAAiB,UAAUsuE,KAAV,EAAiB;AAChCwyD,QAAAA,iBAAiB,CAACn3F,MAAlB;AACA,YAAI/gB,IAAI,GAAG;AACTjuB,UAAAA,CAAC,EAAE2zE,KAAK,CAACpnC,OADA;AAETlrC,UAAAA,CAAC,EAAEsyE,KAAK,CAACjnC,OAFA;AAGT77B,UAAAA,MAAM,EAAEvE,CAAC,CAACuE;AAHD,SAAX;AAKAs1H,QAAAA,iBAAiB,CAACvyG,QAAlB,CAA2BtnB,CAA3B;AACA45H,QAAAA,cAAc,CAACthH,GAAf,CAAmB,KAAnB;AACAqhH,QAAAA,SAAS,CAACrhH,GAAV,CAActe,QAAQ,CAACR,IAAT,CAAcmoB,IAAd,CAAd;AACD,OAVD;AAWD,KAZD,EAYG,IAZH;AAaAwF,IAAAA,MAAM,CAAClK,EAAP,CAAU,WAAV,EAAuB,UAAUjd,CAAV,EAAa;AAClC65H,MAAAA,iBAAiB,CAACn3F,MAAlB;AACA42F,MAAAA,QAAQ,CAACt5H,CAAD,CAAR,CAAYjH,IAAZ,CAAiB,UAAUsuE,KAAV,EAAiB;AAChCsyD,QAAAA,SAAS,CAAC78H,GAAV,GAAgB/D,IAAhB,CAAqB,UAAU4oB,IAAV,EAAgB;AACnC,cAAI43G,WAAW,CAAClyD,KAAD,EAAQ1lD,IAAR,CAAf,EAA8B;AAC5Bg4G,YAAAA,SAAS,CAACrhH,GAAV,CAActe,QAAQ,CAACrC,IAAT,EAAd;AACAiiI,YAAAA,cAAc,CAACthH,GAAf,CAAmB,KAAnB;AACA6O,YAAAA,MAAM,CAACmb,IAAP,CAAY,iBAAZ;AACD;AACF,SAND;AAOD,OARD;AASD,KAXD,EAWG,IAXH;AAYAnb,IAAAA,MAAM,CAAClK,EAAP,CAAU,sBAAV,EAAkC,UAAUjd,CAAV,EAAa;AAC7C65H,MAAAA,iBAAiB,CAACn3F,MAAlB;;AACA,UAAI1iC,CAAC,CAAC7F,IAAF,KAAW,aAAf,EAA8B;AAC5B;AACD;;AACDw/H,MAAAA,SAAS,CAAC78H,GAAV,GAAgB3D,MAAhB,CAAuB,UAAUwoB,IAAV,EAAgB;AACrC,eAAOA,IAAI,CAACpd,MAAL,CAAYu1H,WAAZ,CAAwB95H,CAAC,CAACuE,MAA1B,CAAP;AACD,OAFD,EAEGxL,IAFH,CAEQ,YAAY;AAClB,YAAI6gI,cAAc,CAAC98H,GAAf,EAAJ,EAA0B;AACxBkD,UAAAA,CAAC,CAACqgC,cAAF;AACD,SAFD,MAEO;AACLlZ,UAAAA,MAAM,CAACmb,IAAP,CAAY,KAAZ,EAAmB1iC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKI,CAAL,CAAT,EAAkB;AAAE7F,YAAAA,IAAI,EAAE;AAAR,WAAlB,CAA3B;AACD;AACF,OARD;AASD,KAdD,EAcG,IAdH;AAeD,GA/CD;;AAiDA,MAAI4/H,cAAc,GAAG,UAAUtvC,aAAV,EAAyB1+E,IAAzB,EAA+B;AAClD,WAAO0+E,aAAa,CAACttF,cAAd,CAA6B4O,IAAI,CAAC6C,QAAlC,CAAP;AACD,GAFD;;AAGA,MAAIorH,aAAa,GAAG,UAAUvvC,aAAV,EAAyB1+E,IAAzB,EAA+B;AACjD,QAAIyL,QAAQ,CAACzL,IAAD,CAAZ,EAAoB;AAClB,aAAO,IAAP;AACD,KAFD,MAEO,IAAIqK,WAAW,CAACrK,IAAD,CAAf,EAAuB;AAC5B,aAAO,CAACguH,cAAc,CAACtvC,aAAD,EAAgB1+E,IAAhB,CAAf,IAAwC,CAACwuD,gBAAgB,CAACxuD,IAAD,CAAhE;AACD,KAFM,MAEA;AACL,aAAO,KAAP;AACD;AACF,GARD;;AASA,MAAIkuH,cAAc,GAAG,UAAUxvC,aAAV,EAAyBnhF,IAAzB,EAA+ByC,IAA/B,EAAqC;AACxD,WAAO9S,MAAM,CAACwnF,SAAS,CAACl0E,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAD,EAA6BQ,YAAY,CAACX,OAAb,CAAqBtC,IAArB,CAA7B,CAAV,EAAoE,UAAU4Q,GAAV,EAAe;AAC9F,aAAO6/G,cAAc,CAACtvC,aAAD,EAAgBvwE,GAAG,CAAC/N,GAApB,CAArB;AACD,KAFY,CAAb;AAGD,GAJD;;AAKA,MAAI+tH,oBAAoB,GAAG,UAAUzvC,aAAV,EAAyB1+E,IAAzB,EAA+B;AACxD,QAAIyL,QAAQ,CAACzL,IAAD,CAAZ,EAAoB;AAClB,UAAIA,IAAI,CAAC49B,SAAL,CAAex0C,MAAf,KAA0B,CAA9B,EAAiC;AAC/B,eAAO,IAAP;AACD,OAFD,MAEO,IAAI,QAAQ6L,IAAR,CAAa+K,IAAI,CAAC49B,SAAlB,MAAiC,CAAC59B,IAAI,CAACsE,WAAN,IAAqB0pH,cAAc,CAACtvC,aAAD,EAAgB1+E,IAAI,CAACsE,WAArB,CAApE,CAAJ,EAA4G;AACjH,eAAO,IAAP;AACD;AACF;;AACD,WAAO,KAAP;AACD,GATD;;AAUA,MAAIkiG,aAAa,GAAG,UAAUprF,MAAV,EAAkB;AACpC,QAAIhb,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AAAA,QAAsBk1C,SAAS,GAAGl6B,MAAM,CAACk6B,SAAzC;AACA,QAAIptB,MAAM,GAAG9M,MAAM,CAAC8M,MAApB;AAAA,QAA4Bw2D,aAAa,GAAGx2D,MAAM,CAAC8G,gBAAP,EAA5C;AACA,QAAIhvB,IAAI,GAAGs1C,SAAS,CAACwoB,QAAV,EAAX;AACA,QAAIl/C,QAAQ,GAAGxD,MAAM,CAACo6B,OAAP,EAAf;AACA,QAAIixD,aAAJ,EAAmBjB,QAAnB,EAA6BzT,OAA7B;AACA,QAAIvH,eAAe,GAAGhpC,kBAAkB,CAACpmC,MAAD,CAAxC;;AACA,QAAI,CAACpb,IAAD,IAAS,CAACqK,WAAW,CAACrK,IAAD,CAArB,IAA+B,CAACwqF,eAApC,EAAqD;AACnD;AACD;;AACD,QAAI4jC,YAAY,GAAGxvG,QAAQ,CAAC/b,QAAT,CAAkBpM,WAAlB,EAAnB;;AACA,QAAI,CAACyxB,MAAM,CAACuH,YAAP,CAAoB2+F,YAApB,EAAkC5jC,eAAe,CAAC/zF,WAAhB,EAAlC,CAAD,IAAqEy3H,cAAc,CAACxvC,aAAD,EAAgB9/D,QAAhB,EAA0B5e,IAA1B,CAAvF,EAAwH;AACtH;AACD;;AACD,QAAIq1C,GAAG,GAAGC,SAAS,CAACC,MAAV,EAAV;AACA,QAAIvyB,cAAc,GAAGqyB,GAAG,CAACryB,cAAzB;AACA,QAAIksB,WAAW,GAAGmG,GAAG,CAACnG,WAAtB;AACA,QAAIC,YAAY,GAAGkG,GAAG,CAAClG,YAAvB;AACA,QAAIC,SAAS,GAAGiG,GAAG,CAACjG,SAApB;AACA,QAAIi/E,gBAAgB,GAAG3kD,UAAU,CAACtuD,MAAD,CAAjC;AACApb,IAAAA,IAAI,GAAG4e,QAAQ,CAACja,UAAhB;;AACA,WAAO3E,IAAP,EAAa;AACX,UAAIiuH,aAAa,CAACvvC,aAAD,EAAgB1+E,IAAhB,CAAjB,EAAwC;AACtC,YAAImuH,oBAAoB,CAACzvC,aAAD,EAAgB1+E,IAAhB,CAAxB,EAA+C;AAC7CwlG,UAAAA,QAAQ,GAAGxlG,IAAX;AACAA,UAAAA,IAAI,GAAGA,IAAI,CAACsE,WAAZ;AACAlE,UAAAA,GAAG,CAAC6G,MAAJ,CAAWu+F,QAAX;AACA;AACD;;AACD,YAAI,CAACiB,aAAL,EAAoB;AAClBA,UAAAA,aAAa,GAAGrmG,GAAG,CAAC9C,MAAJ,CAAWktF,eAAX,EAA4B9oC,uBAAuB,CAACtmC,MAAD,CAAnD,CAAhB;AACApb,UAAAA,IAAI,CAAC0D,UAAL,CAAgByC,YAAhB,CAA6BsgG,aAA7B,EAA4CzmG,IAA5C;AACA+xF,UAAAA,OAAO,GAAG,IAAV;AACD;;AACDyT,QAAAA,QAAQ,GAAGxlG,IAAX;AACAA,QAAAA,IAAI,GAAGA,IAAI,CAACsE,WAAZ;AACAmiG,QAAAA,aAAa,CAAChgG,WAAd,CAA0B++F,QAA1B;AACD,OAfD,MAeO;AACLiB,QAAAA,aAAa,GAAG,IAAhB;AACAzmG,QAAAA,IAAI,GAAGA,IAAI,CAACsE,WAAZ;AACD;AACF;;AACD,QAAIytF,OAAO,IAAIs8B,gBAAf,EAAiC;AAC/Bh5E,MAAAA,GAAG,CAAC5G,QAAJ,CAAazrB,cAAb,EAA6BksB,WAA7B;AACAmG,MAAAA,GAAG,CAAC3G,MAAJ,CAAWS,YAAX,EAAyBC,SAAzB;AACAkG,MAAAA,SAAS,CAACiZ,MAAV,CAAiBlZ,GAAjB;AACAj6B,MAAAA,MAAM,CAAC2hD,WAAP;AACD;AACF,GAhDD;;AAiDA,MAAIuxD,OAAO,GAAG,UAAUlzG,MAAV,EAAkB;AAC9B,QAAIomC,kBAAkB,CAACpmC,MAAD,CAAtB,EAAgC;AAC9BA,MAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwBlmB,KAAK,CAACw7G,aAAD,EAAgBprF,MAAhB,CAA7B;AACD;AACF,GAJD;;AAMA,MAAImzG,uBAAuB,GAAG,UAAUnzG,MAAV,EAAkB;AAC9C,WAAOrB,UAAU,CAACvZ,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAD,EAAyC,mBAAzC,CAAV,CAAwEppD,IAAxE,CAA6EvB,QAAQ,CAAC,IAAD,CAArF,EAA6F,UAAUsjB,GAAV,EAAe;AACjH,aAAOA,GAAG,CAAC/N,GAAX;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAIouH,mBAAmB,GAAG,UAAUpzG,MAAV,EAAkB;AAC1CA,IAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBnzC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAxB;AACD,GAFD;;AAGA,MAAI4sC,uBAAuB,GAAG,UAAU/mE,MAAV,EAAkBqzG,mBAAlB,EAAuC;AACnE,QAAIA,mBAAmB,CAAC3jH,YAApB,CAAiC,gBAAjC,CAAJ,EAAwD;AACtD+X,MAAAA,uBAAuB,CAAC4rG,mBAAD,CAAvB;AACAD,MAAAA,mBAAmB,CAACpzG,MAAD,CAAnB;AACAA,MAAAA,MAAM,CAACk6B,SAAP,CAAiBrsC,cAAjB,CAAgCwlH,mBAAhC;AACD;AACF,GAND;;AAOA,MAAIC,oBAAoB,GAAG,UAAUtzG,MAAV,EAAkBnnB,CAAlB,EAAqB;AAC9C,QAAIw6H,mBAAmB,GAAGF,uBAAuB,CAACnzG,MAAD,CAAjD;;AACA,QAAI,CAACqzG,mBAAL,EAA0B;AACxB;AACD;;AACD,QAAIx6H,CAAC,CAAC7F,IAAF,KAAW,kBAAf,EAAmC;AACjC6F,MAAAA,CAAC,CAACqgC,cAAF;AACArgC,MAAAA,CAAC,CAACugC,eAAF;AACA2tD,MAAAA,uBAAuB,CAAC/mE,MAAD,EAASqzG,mBAAT,CAAvB;AACA;AACD;;AACD,QAAIjtG,UAAU,CAACitG,mBAAD,CAAd,EAAqC;AACnCtsC,MAAAA,uBAAuB,CAAC/mE,MAAD,EAASqzG,mBAAT,CAAvB;AACArzG,MAAAA,MAAM,CAAC27C,WAAP,CAAmBtuC,GAAnB;AACD;AACF,GAfD;;AAgBA,MAAIkmG,OAAO,GAAG,UAAUvzG,MAAV,EAAkB;AAC9BA,IAAAA,MAAM,CAAClK,EAAP,CAAU,wBAAV,EAAoClmB,KAAK,CAAC0jI,oBAAD,EAAuBtzG,MAAvB,CAAzC;AACD,GAFD;;AAIA,MAAIwzG,SAAJ;;AACC,aAAUA,SAAV,EAAqB;AACpBA,IAAAA,SAAS,CAACA,SAAS,CAAC,IAAD,CAAT,GAAkB,CAAnB,CAAT,GAAiC,IAAjC;AACAA,IAAAA,SAAS,CAACA,SAAS,CAAC,OAAD,CAAT,GAAqB,CAAtB,CAAT,GAAoC,OAApC;AACAA,IAAAA,SAAS,CAACA,SAAS,CAAC,MAAD,CAAT,GAAoB,CAArB,CAAT,GAAmC,MAAnC;AACAA,IAAAA,SAAS,CAACA,SAAS,CAAC,KAAD,CAAT,GAAmB,CAApB,CAAT,GAAkC,KAAlC;AACD,GALA,EAKCA,SAAS,KAAKA,SAAS,GAAG,EAAjB,CALV,CAAD;;AAMA,MAAIC,IAAI,GAAG,UAAUh2E,SAAV,EAAqBi2E,SAArB,EAAgC;AACzC,WAAOj2E,SAAS,KAAK2R,UAAU,CAACkB,SAAzB,GAAqCn7D,OAAO,CAACu+H,SAAD,CAA5C,GAA0DA,SAAjE;AACD,GAFD;;AAGA,MAAIC,MAAM,GAAG,UAAUl2E,SAAV,EAAqBgnC,WAArB,EAAkChxE,GAAlC,EAAuC;AAClD,WAAOgqC,SAAS,KAAK2R,UAAU,CAACa,QAAzB,GAAoCw0B,WAAW,CAAChhE,IAAZ,CAAiBhQ,GAAjB,CAApC,GAA4DgxE,WAAW,CAAC/gE,IAAZ,CAAiBjQ,GAAjB,CAAnE;AACD,GAFD;;AAGA,MAAImgH,YAAY,GAAG,UAAU5vH,KAAV,EAAiBy5C,SAAjB,EAA4Bo2E,UAA5B,EAAwCnO,OAAxC,EAAiD;AAClE,QAAIj1G,IAAI,CAACi1G,OAAO,CAACpmE,OAAR,CAAgB7B,SAAS,KAAK2R,UAAU,CAACa,QAAzC,CAAD,CAAR,EAA8D;AAC5D,aAAOujE,SAAS,CAACM,EAAjB;AACD,KAFD,MAEO,IAAIrmE,aAAa,CAAComE,UAAD,EAAanO,OAAb,CAAb,KAAuC,KAA3C,EAAkD;AACvD,aAAO8N,SAAS,CAACO,KAAjB;AACD,KAFM,MAEA;AACL,aAAOP,SAAS,CAACQ,IAAjB;AACD;AACF,GARD;;AASA,MAAIC,iBAAiB,GAAG,UAAU17H,SAAV,EAAqBklD,SAArB,EAAgCz5C,KAAhC,EAAuCvH,KAAvC,EAA8C;AACpE,QAAIgoF,WAAW,GAAGp0B,WAAW,CAACrsD,KAAD,CAA7B;AACA,QAAI6vH,UAAU,GAAGp3H,KAAjB;AAAA,QAAwBipH,OAAxB;AACA,QAAIgO,SAAS,GAAG,EAAhB;;AACA,WAAOG,UAAP,EAAmB;AACjBnO,MAAAA,OAAO,GAAGiO,MAAM,CAACl2E,SAAD,EAAYgnC,WAAZ,EAAyBovC,UAAzB,CAAhB;;AACA,UAAI,CAACnO,OAAL,EAAc;AACZ;AACD;;AACD,UAAIj1G,IAAI,CAACi1G,OAAO,CAACpmE,OAAR,CAAgB,KAAhB,CAAD,CAAR,EAAkC;AAChC,YAAI7B,SAAS,KAAK2R,UAAU,CAACa,QAA7B,EAAuC;AACrC,iBAAO;AACLyjE,YAAAA,SAAS,EAAED,IAAI,CAACh2E,SAAD,EAAYi2E,SAAZ,CAAJ,CAA2BzjI,MAA3B,CAAkC,CAACy1H,OAAD,CAAlC,CADN;AAELwO,YAAAA,SAAS,EAAEV,SAAS,CAACM,EAFhB;AAGLK,YAAAA,OAAO,EAAEthI,QAAQ,CAACR,IAAT,CAAcqzH,OAAd;AAHJ,WAAP;AAKD,SAND,MAMO;AACL,iBAAO;AACLgO,YAAAA,SAAS,EAAED,IAAI,CAACh2E,SAAD,EAAYi2E,SAAZ,CADV;AAELQ,YAAAA,SAAS,EAAEV,SAAS,CAACM,EAFhB;AAGLK,YAAAA,OAAO,EAAEthI,QAAQ,CAACR,IAAT,CAAcqzH,OAAd;AAHJ,WAAP;AAKD;AACF;;AACD,UAAI,CAACA,OAAO,CAAC3jE,SAAR,EAAL,EAA0B;AACxB8xE,QAAAA,UAAU,GAAGnO,OAAb;AACA;AACD;;AACD,UAAIntH,SAAS,CAACs7H,UAAD,EAAanO,OAAb,CAAb,EAAoC;AAClC,YAAIwO,SAAS,GAAGN,YAAY,CAAC5vH,KAAD,EAAQy5C,SAAR,EAAmBo2E,UAAnB,EAA+BnO,OAA/B,CAA5B;AACA,eAAO;AACLgO,UAAAA,SAAS,EAAED,IAAI,CAACh2E,SAAD,EAAYi2E,SAAZ,CADV;AAELQ,UAAAA,SAAS,EAAEA,SAFN;AAGLC,UAAAA,OAAO,EAAEthI,QAAQ,CAACR,IAAT,CAAcqzH,OAAd;AAHJ,SAAP;AAKD;;AACDgO,MAAAA,SAAS,CAAC1/H,IAAV,CAAe0xH,OAAf;AACAmO,MAAAA,UAAU,GAAGnO,OAAb;AACD;;AACD,WAAO;AACLgO,MAAAA,SAAS,EAAED,IAAI,CAACh2E,SAAD,EAAYi2E,SAAZ,CADV;AAELQ,MAAAA,SAAS,EAAEV,SAAS,CAACY,GAFhB;AAGLD,MAAAA,OAAO,EAAEthI,QAAQ,CAACrC,IAAT;AAHJ,KAAP;AAKD,GA5CD;;AA6CA,MAAI6jI,wBAAwB,GAAG,UAAU52E,SAAV,EAAqB62E,sBAArB,EAA6CtwH,KAA7C,EAAoDvH,KAApD,EAA2D;AACxF,WAAO63H,sBAAsB,CAACtwH,KAAD,EAAQvH,KAAR,CAAtB,CAAqC03H,OAArC,CAA6CxiI,GAA7C,CAAiD,UAAU8hB,GAAV,EAAe;AACrE,UAAIigH,SAAS,GAAGY,sBAAsB,CAACtwH,KAAD,EAAQyP,GAAR,CAAtB,CAAmCigH,SAAnD;AACA,aAAOj2E,SAAS,KAAK2R,UAAU,CAACkB,SAAzB,GAAqCojE,SAAS,CAACzjI,MAAV,CAAiBwjB,GAAjB,CAArC,GAA6D,CAACA,GAAD,EAAMxjB,MAAN,CAAayjI,SAAb,CAApE;AACD,KAHM,EAGJtiI,KAHI,CAGE,EAHF,CAAP;AAID,GALD;;AAMA,MAAImjI,sCAAsC,GAAG,UAAUb,SAAV,EAAqBnnI,CAArB,EAAwB;AACnE,WAAOsI,KAAK,CAAC6+H,SAAD,EAAY,UAAU9+H,GAAV,EAAe+kF,MAAf,EAAuB;AAC7C,aAAO/kF,GAAG,CAAC5D,IAAJ,CAAS,YAAY;AAC1B,eAAO6B,QAAQ,CAACR,IAAT,CAAcsnF,MAAd,CAAP;AACD,OAFM,EAEJ,UAAUoC,OAAV,EAAmB;AACpB,eAAO/9B,KAAK,CAACpoD,IAAI,CAACmmF,OAAO,CAAC16B,cAAR,EAAD,CAAL,EAAiCzrD,IAAI,CAAC+jF,MAAM,CAACt4B,cAAP,EAAD,CAArC,EAAgE,UAAUmzE,QAAV,EAAoBC,OAApB,EAA6B;AACvG,cAAIC,QAAQ,GAAGhmH,IAAI,CAAC8wD,GAAL,CAASjzE,CAAC,GAAGioI,QAAQ,CAACroH,IAAtB,CAAf;AACA,cAAIwoH,OAAO,GAAGjmH,IAAI,CAAC8wD,GAAL,CAASjzE,CAAC,GAAGkoI,OAAO,CAACtoH,IAArB,CAAd;AACA,iBAAOwoH,OAAO,IAAID,QAAX,GAAsB/6C,MAAtB,GAA+BoC,OAAtC;AACD,SAJW,CAAL,CAIJtqF,EAJI,CAIDmD,GAJC,CAAP;AAKD,OARM,CAAP;AASD,KAVW,EAUT/B,QAAQ,CAACrC,IAAT,EAVS,CAAZ;AAWD,GAZD;;AAaA,MAAIokI,6BAA6B,GAAG,UAAUlB,SAAV,EAAqBjgH,GAArB,EAA0B;AAC5D,WAAO7d,IAAI,CAAC6d,GAAG,CAAC4tC,cAAJ,EAAD,CAAJ,CAA2BxvD,IAA3B,CAAgC,UAAUgjI,UAAV,EAAsB;AAC3D,aAAON,sCAAsC,CAACb,SAAD,EAAYmB,UAAU,CAAC1oH,IAAvB,CAA7C;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAI2oH,6BAA6B,GAAGllI,KAAK,CAACqkI,iBAAD,EAAoBpyE,aAAa,CAAC5C,OAAlC,EAA2C,CAAC,CAA5C,CAAzC;AACA,MAAI81E,yBAAyB,GAAGnlI,KAAK,CAACqkI,iBAAD,EAAoBpyE,aAAa,CAAC1C,OAAlC,EAA2C,CAA3C,CAArC;;AACA,MAAI61E,aAAa,GAAG,UAAUhxH,KAAV,EAAiByP,GAAjB,EAAsB;AACxC,WAAOqhH,6BAA6B,CAAC9wH,KAAD,EAAQyP,GAAR,CAA7B,CAA0C0gH,OAA1C,CAAkDxjI,MAAlD,EAAP;AACD,GAFD;;AAGA,MAAIskI,YAAY,GAAG,UAAUjxH,KAAV,EAAiByP,GAAjB,EAAsB;AACvC,WAAOshH,yBAAyB,CAAC/wH,KAAD,EAAQyP,GAAR,CAAzB,CAAsC0gH,OAAtC,CAA8CxjI,MAA9C,EAAP;AACD,GAFD;;AAGA,MAAIukI,iBAAiB,GAAGtlI,KAAK,CAACykI,wBAAD,EAA2B,CAAC,CAA5B,EAA+BS,6BAA/B,CAA7B;AACA,MAAIK,iBAAiB,GAAGvlI,KAAK,CAACykI,wBAAD,EAA2B,CAA3B,EAA8BU,yBAA9B,CAA7B;;AACA,MAAIK,qBAAqB,GAAG,UAAUpxH,KAAV,EAAiB;AAC3C,WAAOstD,eAAe,CAACttD,KAAD,CAAf,CAAuBrS,GAAvB,CAA2B,UAAU8hB,GAAV,EAAe;AAC/C,aAAO,CAACA,GAAD,EAAMxjB,MAAN,CAAa8kI,yBAAyB,CAAC/wH,KAAD,EAAQyP,GAAR,CAAzB,CAAsCigH,SAAnD,CAAP;AACD,KAFM,EAEJtiI,KAFI,CAEE,EAFF,CAAP;AAGD,GAJD;;AAKA,MAAIikI,oBAAoB,GAAG,UAAUrxH,KAAV,EAAiB;AAC1C,WAAOutD,cAAc,CAACvtD,KAAD,CAAd,CAAsBrS,GAAtB,CAA0B,UAAU8hB,GAAV,EAAe;AAC9C,aAAOqhH,6BAA6B,CAAC9wH,KAAD,EAAQyP,GAAR,CAA7B,CAA0CigH,SAA1C,CAAoDzjI,MAApD,CAA2DwjB,GAA3D,CAAP;AACD,KAFM,EAEJriB,KAFI,CAEE,EAFF,CAAP;AAGD,GAJD;;AAMA,MAAIkkI,kBAAkB,GAAG,UAAU1wH,IAAV,EAAgB;AACvC,QAAI2wH,eAAe,GAAG,UAAUn0E,WAAV,EAAuB;AAC3C,aAAOzvD,GAAG,CAACyvD,WAAD,EAAc,UAAUV,UAAV,EAAsB;AAC5CA,QAAAA,UAAU,GAAGnC,OAAO,CAACmC,UAAD,CAApB;AACAA,QAAAA,UAAU,CAAC97C,IAAX,GAAkBA,IAAlB;AACA,eAAO87C,UAAP;AACD,OAJS,CAAV;AAKD,KAND;;AAOA,QAAIzxC,WAAW,CAACrK,IAAD,CAAf,EAAuB;AACrB,aAAO2wH,eAAe,CAAC3wH,IAAI,CAACy8C,cAAL,EAAD,CAAtB;AACD;;AACD,QAAIhxC,QAAQ,CAACzL,IAAD,CAAZ,EAAoB;AAClB,UAAIq1C,GAAG,GAAGr1C,IAAI,CAACqD,aAAL,CAAmB+qC,WAAnB,EAAV;AACAiH,MAAAA,GAAG,CAAC5G,QAAJ,CAAazuC,IAAb,EAAmB,CAAnB;AACAq1C,MAAAA,GAAG,CAAC3G,MAAJ,CAAW1uC,IAAX,EAAiBA,IAAI,CAAC4V,IAAL,CAAUxsB,MAA3B;AACA,aAAOunI,eAAe,CAACt7E,GAAG,CAACoH,cAAJ,EAAD,CAAtB;AACD;AACF,GAjBD;;AAkBA,MAAIA,cAAc,GAAG,UAAUxuC,KAAV,EAAiB;AACpC,WAAOhhB,IAAI,CAACghB,KAAD,EAAQyiH,kBAAR,CAAX;AACD,GAFD;;AAIA,MAAIE,UAAJ;;AACC,aAAUA,UAAV,EAAsB;AACrBA,IAAAA,UAAU,CAACA,UAAU,CAAC,IAAD,CAAV,GAAmB,CAAC,CAArB,CAAV,GAAoC,IAApC;AACAA,IAAAA,UAAU,CAACA,UAAU,CAAC,MAAD,CAAV,GAAqB,CAAtB,CAAV,GAAqC,MAArC;AACD,GAHA,EAGCA,UAAU,KAAKA,UAAU,GAAG,EAAlB,CAHX,CAAD;;AAIA,MAAIC,WAAW,GAAG,UAAUh4E,SAAV,EAAqBt7C,IAArB,EAA2BmrD,WAA3B,EAAwC1oD,IAAxC,EAA8C;AAC9D,WAAOA,IAAI,GAAGyoD,QAAQ,CAACzoD,IAAD,EAAO64C,SAAP,EAAkB90B,wBAAlB,EAA4CxmB,IAA5C,CAAtB,EAAyE;AACvE,UAAImrD,WAAW,CAAC1oD,IAAD,CAAf,EAAuB;AACrB;AACD;AACF;AACF,GAND;;AAOA,MAAI8wH,SAAS,GAAG,UAAUj4E,SAAV,EAAqBk4E,SAArB,EAAgCC,UAAhC,EAA4CzzH,IAA5C,EAAkDmrD,WAAlD,EAA+D7L,aAA/D,EAA8E;AAC5F,QAAIo0E,IAAI,GAAG,CAAX;AACA,QAAIx3G,MAAM,GAAG,EAAb;;AACA,QAAIgP,GAAG,GAAG,UAAUzoB,IAAV,EAAgB;AACxB,UAAI1W,CAAJ,EAAOwyD,UAAP,EAAmBU,WAAnB;AACAA,MAAAA,WAAW,GAAGC,cAAc,CAAC,CAACz8C,IAAD,CAAD,CAA5B;;AACA,UAAI64C,SAAS,KAAK,CAAC,CAAnB,EAAsB;AACpB2D,QAAAA,WAAW,GAAGA,WAAW,CAACjsD,OAAZ,EAAd;AACD;;AACD,WAAKjH,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGkzD,WAAW,CAACpzD,MAA5B,EAAoCE,CAAC,EAArC,EAAyC;AACvCwyD,QAAAA,UAAU,GAAGU,WAAW,CAAClzD,CAAD,CAAxB;;AACA,YAAI0nI,UAAU,CAACl1E,UAAD,EAAao1E,gBAAb,CAAd,EAA8C;AAC5C;AACD;;AACD,YAAIz3G,MAAM,CAACrwB,MAAP,GAAgB,CAAhB,IAAqB2nI,SAAS,CAACj1E,UAAD,EAAaloD,MAAM,CAAC6lB,MAAD,CAAnB,CAAlC,EAAgE;AAC9Dw3G,UAAAA,IAAI;AACL;;AACDn1E,QAAAA,UAAU,CAACm1E,IAAX,GAAkBA,IAAlB;;AACA,YAAIvoE,WAAW,CAAC5M,UAAD,CAAf,EAA6B;AAC3B,iBAAO,IAAP;AACD;;AACDriC,QAAAA,MAAM,CAACrqB,IAAP,CAAY0sD,UAAZ;AACD;AACF,KApBD;;AAqBA,QAAIo1E,gBAAgB,GAAGt9H,MAAM,CAACipD,aAAa,CAACJ,cAAd,EAAD,CAA7B;;AACA,QAAI,CAACy0E,gBAAL,EAAuB;AACrB,aAAOz3G,MAAP;AACD;;AACD,QAAIzZ,IAAI,GAAG68C,aAAa,CAACnC,OAAd,EAAX;AACAjyB,IAAAA,GAAG,CAACzoB,IAAD,CAAH;AACA6wH,IAAAA,WAAW,CAACh4E,SAAD,EAAYt7C,IAAZ,EAAkBkrB,GAAlB,EAAuBzoB,IAAvB,CAAX;AACA,WAAOyZ,MAAP;AACD,GAhCD;;AAiCA,MAAI03G,eAAe,GAAG,UAAUC,UAAV,EAAsBt1E,UAAtB,EAAkC;AACtD,WAAOA,UAAU,CAACm1E,IAAX,GAAkBG,UAAzB;AACD,GAFD;;AAGA,MAAIC,YAAY,GAAG,UAAUD,UAAV,EAAsBt1E,UAAtB,EAAkC;AACnD,WAAOA,UAAU,CAACm1E,IAAX,KAAoBG,UAA3B;AACD,GAFD;;AAGA,MAAIE,OAAO,GAAGtmI,KAAK,CAAC8lI,SAAD,EAAYF,UAAU,CAACW,EAAvB,EAA2Bl3E,OAA3B,EAAoCE,OAApC,CAAnB;AACA,MAAIi3E,SAAS,GAAGxmI,KAAK,CAAC8lI,SAAD,EAAYF,UAAU,CAACa,IAAvB,EAA6Bl3E,OAA7B,EAAsCF,OAAtC,CAArB;;AACA,MAAIq3E,cAAc,GAAG,UAAU74E,SAAV,EAAqBt7C,IAArB,EAA2BmrD,WAA3B,EAAwC1oD,IAAxC,EAA8C;AACjE,QAAI6/E,WAAW,GAAGp0B,WAAW,CAACluD,IAAD,CAA7B;AACA,QAAI8sD,MAAJ,EAAYsnE,SAAZ,EAAuBZ,SAAvB,EAAkCl0E,aAAlC;AACA,QAAIpjC,MAAM,GAAG,EAAb;AACA,QAAIw3G,IAAI,GAAG,CAAX;AAAA,QAAcn1E,UAAd;;AACA,QAAI81E,aAAa,GAAG,UAAU/0E,aAAV,EAAyB;AAC3C,UAAIhE,SAAS,KAAK,CAAlB,EAAqB;AACnB,eAAOjlD,MAAM,CAACipD,aAAa,CAACJ,cAAd,EAAD,CAAb;AACD;;AACD,aAAO7oD,MAAM,CAACipD,aAAa,CAACJ,cAAd,EAAD,CAAb;AACD,KALD;;AAMA,QAAI5D,SAAS,KAAK,CAAlB,EAAqB;AACnBwR,MAAAA,MAAM,GAAGw1B,WAAW,CAAChhE,IAArB;AACA8yG,MAAAA,SAAS,GAAGp3E,OAAZ;AACAw2E,MAAAA,SAAS,GAAG12E,OAAZ;AACAwC,MAAAA,aAAa,GAAGI,aAAa,CAAC72C,KAAd,CAAoBpG,IAApB,CAAhB;AACD,KALD,MAKO;AACLqqD,MAAAA,MAAM,GAAGw1B,WAAW,CAAC/gE,IAArB;AACA6yG,MAAAA,SAAS,GAAGt3E,OAAZ;AACA02E,MAAAA,SAAS,GAAGx2E,OAAZ;AACAsC,MAAAA,aAAa,GAAGI,aAAa,CAACj3C,MAAd,CAAqBhG,IAArB,CAAhB;AACD;;AACD,QAAIkxH,gBAAgB,GAAGU,aAAa,CAAC/0E,aAAD,CAApC;;AACA,OAAG;AACD,UAAI,CAACA,aAAa,CAACM,SAAd,EAAL,EAAgC;AAC9B;AACD;;AACDrB,MAAAA,UAAU,GAAG81E,aAAa,CAAC/0E,aAAD,CAA1B;;AACA,UAAIk0E,SAAS,CAACj1E,UAAD,EAAao1E,gBAAb,CAAb,EAA6C;AAC3C;AACD;;AACD,UAAIz3G,MAAM,CAACrwB,MAAP,GAAgB,CAAhB,IAAqBuoI,SAAS,CAAC71E,UAAD,EAAaloD,MAAM,CAAC6lB,MAAD,CAAnB,CAAlC,EAAgE;AAC9Dw3G,QAAAA,IAAI;AACL;;AACDn1E,MAAAA,UAAU,GAAGnC,OAAO,CAACmC,UAAD,CAApB;AACAA,MAAAA,UAAU,CAAC8P,QAAX,GAAsB/O,aAAtB;AACAf,MAAAA,UAAU,CAACm1E,IAAX,GAAkBA,IAAlB;;AACA,UAAIvoE,WAAW,CAAC5M,UAAD,CAAf,EAA6B;AAC3B,eAAOriC,MAAP;AACD;;AACDA,MAAAA,MAAM,CAACrqB,IAAP,CAAY0sD,UAAZ;AACD,KAlBD,QAkBSe,aAAa,GAAGwN,MAAM,CAACxN,aAAD,CAlB/B;;AAmBA,WAAOpjC,MAAP;AACD,GA3CD;;AA4CA,MAAIo4G,WAAW,GAAG,UAAUT,UAAV,EAAsB;AACtC,WAAO,UAAUt1E,UAAV,EAAsB;AAC3B,aAAOq1E,eAAe,CAACC,UAAD,EAAat1E,UAAb,CAAtB;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIg2E,MAAM,GAAG,UAAUV,UAAV,EAAsB;AACjC,WAAO,UAAUt1E,UAAV,EAAsB;AAC3B,aAAOu1E,YAAY,CAACD,UAAD,EAAat1E,UAAb,CAAnB;AACD,KAFD;AAGD,GAJD;;AAMA,MAAIi2E,wBAAwB,GAAG/lH,sBAA/B;AACA,MAAIgmH,UAAU,GAAGvpE,QAAjB;;AACA,MAAIwpE,kBAAkB,GAAG,UAAUn2E,UAAV,EAAsB5nB,OAAtB,EAA+B;AACtD,WAAOpqB,IAAI,CAAC8wD,GAAL,CAAS9e,UAAU,CAACv0C,IAAX,GAAkB2sB,OAA3B,CAAP;AACD,GAFD;;AAGA,MAAIg+F,mBAAmB,GAAG,UAAUp2E,UAAV,EAAsB5nB,OAAtB,EAA+B;AACvD,WAAOpqB,IAAI,CAAC8wD,GAAL,CAAS9e,UAAU,CAACvyC,KAAX,GAAmB2qB,OAA5B,CAAP;AACD,GAFD;;AAGA,MAAIi+F,SAAS,GAAG,UAAUj+F,OAAV,EAAmB4nB,UAAnB,EAA+B;AAC7C,WAAO5nB,OAAO,IAAI4nB,UAAU,CAACv0C,IAAtB,IAA8B2sB,OAAO,IAAI4nB,UAAU,CAACvyC,KAA3D;AACD,GAFD;;AAGA,MAAI6oH,SAAS,GAAG,UAAU/9F,OAAV,EAAmBynB,UAAnB,EAA+B;AAC7C,WAAOznB,OAAO,IAAIynB,UAAU,CAACt0C,GAAtB,IAA6B6sB,OAAO,IAAIynB,UAAU,CAACtyC,MAA1D;AACD,GAFD;;AAGA,MAAI6oH,qBAAqB,GAAG,UAAU71E,WAAV,EAAuBtoB,OAAvB,EAAgC;AAC1D,WAAO7gC,MAAM,CAACmpD,WAAD,EAAc,UAAU81E,aAAV,EAAyBx2E,UAAzB,EAAqC;AAC9D,UAAIy2E,WAAW,GAAGzoH,IAAI,CAACswC,GAAL,CAAS63E,kBAAkB,CAACK,aAAD,EAAgBp+F,OAAhB,CAA3B,EAAqDg+F,mBAAmB,CAACI,aAAD,EAAgBp+F,OAAhB,CAAxE,CAAlB;AACA,UAAIs+F,WAAW,GAAG1oH,IAAI,CAACswC,GAAL,CAAS63E,kBAAkB,CAACn2E,UAAD,EAAa5nB,OAAb,CAA3B,EAAkDg+F,mBAAmB,CAACp2E,UAAD,EAAa5nB,OAAb,CAArE,CAAlB;;AACA,UAAIi+F,SAAS,CAACj+F,OAAD,EAAU4nB,UAAV,CAAb,EAAoC;AAClC,eAAOA,UAAP;AACD;;AACD,UAAIq2E,SAAS,CAACj+F,OAAD,EAAUo+F,aAAV,CAAb,EAAuC;AACrC,eAAOA,aAAP;AACD;;AACD,UAAIE,WAAW,KAAKD,WAAhB,IAA+BR,wBAAwB,CAACj2E,UAAU,CAAC97C,IAAZ,CAA3D,EAA8E;AAC5E,eAAO87C,UAAP;AACD;;AACD,UAAI02E,WAAW,GAAGD,WAAlB,EAA+B;AAC7B,eAAOz2E,UAAP;AACD;;AACD,aAAOw2E,aAAP;AACD,KAhBY,CAAb;AAiBD,GAlBD;;AAmBA,MAAIG,WAAW,GAAG,UAAU55E,SAAV,EAAqBt7C,IAArB,EAA2BmrD,WAA3B,EAAwC/pC,SAAxC,EAAmD+zG,eAAnD,EAAoE;AACpF,QAAI1yH,IAAI,GAAGgyH,UAAU,CAACrzG,SAAD,EAAYk6B,SAAZ,EAAuB90B,wBAAvB,EAAiDxmB,IAAjD,EAAuD,CAACm1H,eAAxD,CAArB;;AACA,OAAG;AACD,UAAI,CAAC1yH,IAAD,IAAS0oD,WAAW,CAAC1oD,IAAD,CAAxB,EAAgC;AAC9B;AACD;AACF,KAJD,QAISA,IAAI,GAAGgyH,UAAU,CAAChyH,IAAD,EAAO64C,SAAP,EAAkB90B,wBAAlB,EAA4CxmB,IAA5C,CAJ1B;AAKD,GAPD;;AAQA,MAAIo1H,iBAAiB,GAAG,UAAUp1H,IAAV,EAAgBq1H,cAAhB,EAAgCF,eAAhC,EAAiD;AACvE,QAAIA,eAAe,KAAK,KAAK,CAA7B,EAAgC;AAC9BA,MAAAA,eAAe,GAAG,IAAlB;AACD;;AACD,QAAIl2E,WAAW,GAAG,EAAlB;;AACA,QAAI/Q,OAAO,GAAG,UAAUonF,UAAV,EAAsB7yH,IAAtB,EAA4B;AACxC,UAAI8yH,SAAS,GAAG1lI,MAAM,CAACqvD,cAAc,CAAC,CAACz8C,IAAD,CAAD,CAAf,EAAyB,UAAU87C,UAAV,EAAsB;AACnE,eAAO,CAAC+2E,UAAU,CAAC/2E,UAAD,EAAa82E,cAAb,CAAlB;AACD,OAFqB,CAAtB;AAGAp2E,MAAAA,WAAW,GAAGA,WAAW,CAACnxD,MAAZ,CAAmBynI,SAAnB,CAAd;AACA,aAAOA,SAAS,CAAC1pI,MAAV,KAAqB,CAA5B;AACD,KAND;;AAOAozD,IAAAA,WAAW,CAACptD,IAAZ,CAAiBwjI,cAAjB;AACAH,IAAAA,WAAW,CAAC7B,UAAU,CAACW,EAAZ,EAAgBh0H,IAAhB,EAAsBvS,KAAK,CAACygD,OAAD,EAAU4O,OAAV,CAA3B,EAA+Cu4E,cAAc,CAAC5yH,IAA9D,EAAoE0yH,eAApE,CAAX;AACAD,IAAAA,WAAW,CAAC7B,UAAU,CAACa,IAAZ,EAAkBl0H,IAAlB,EAAwBvS,KAAK,CAACygD,OAAD,EAAU8O,OAAV,CAA7B,EAAiDq4E,cAAc,CAAC5yH,IAAhE,EAAsE0yH,eAAtE,CAAX;AACA,WAAOl2E,WAAP;AACD,GAhBD;;AAiBA,MAAIu2E,mBAAmB,GAAG,UAAUx1H,IAAV,EAAgB;AACxC,WAAOnQ,MAAM,CAAC8D,MAAM,CAACqM,IAAI,CAAColB,oBAAL,CAA0B,GAA1B,CAAD,CAAP,EAAyCmlC,iBAAzC,CAAb;AACD,GAFD;;AAGA,MAAIkrE,SAAS,GAAG,UAAUl3E,UAAV,EAAsB5nB,OAAtB,EAA+B;AAC7C,WAAO;AACLl0B,MAAAA,IAAI,EAAE87C,UAAU,CAAC97C,IADZ;AAELgG,MAAAA,MAAM,EAAEisH,kBAAkB,CAACn2E,UAAD,EAAa5nB,OAAb,CAAlB,GAA0Cg+F,mBAAmB,CAACp2E,UAAD,EAAa5nB,OAAb;AAFhE,KAAP;AAID,GALD;;AAMA,MAAI++F,gBAAgB,GAAG,UAAU11H,IAAV,EAAgB22B,OAAhB,EAAyBG,OAAzB,EAAkC;AACvD,QAAI6+F,mBAAmB,GAAGz2E,cAAc,CAACs2E,mBAAmB,CAACx1H,IAAD,CAApB,CAAxC;AACA,QAAI41H,eAAe,GAAG/lI,MAAM,CAAC8lI,mBAAD,EAAsBloI,KAAK,CAAConI,SAAD,EAAY/9F,OAAZ,CAA3B,CAA5B;AACA,QAAI++F,eAAe,GAAGf,qBAAqB,CAACc,eAAD,EAAkBj/F,OAAlB,CAA3C;;AACA,QAAIk/F,eAAJ,EAAqB;AACnB,UAAIV,eAAe,GAAG,CAACrnH,OAAO,CAAC+nH,eAAe,CAACpzH,IAAjB,CAAR,IAAkC,CAACkM,OAAO,CAACknH,eAAe,CAACpzH,IAAjB,CAAhE;AACAozH,MAAAA,eAAe,GAAGf,qBAAqB,CAACM,iBAAiB,CAACp1H,IAAD,EAAO61H,eAAP,EAAwBV,eAAxB,CAAlB,EAA4Dx+F,OAA5D,CAAvC;;AACA,UAAIk/F,eAAe,IAAItrE,iBAAiB,CAACsrE,eAAe,CAACpzH,IAAjB,CAAxC,EAAgE;AAC9D,eAAOgzH,SAAS,CAACI,eAAD,EAAkBl/F,OAAlB,CAAhB;AACD;AACF;;AACD,WAAO,IAAP;AACD,GAZD;;AAcA,MAAIm/F,WAAW,GAAG,UAAUj4G,MAAV,EAAkBi6B,GAAlB,EAAuB;AACvCj6B,IAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB;AACAovB,IAAAA,mBAAmB,CAACrpD,MAAD,EAASA,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAT,CAAnB;AACD,GAHD;;AAIA,MAAI+9E,mBAAmB,GAAG,UAAUl4G,MAAV,EAAkBhf,KAAlB,EAAyB6M,cAAzB,EAAyC;AACjE,WAAOhb,QAAQ,CAACR,IAAT,CAAcw2H,gBAAgB,CAAC7oG,MAAD,EAAShf,KAAT,EAAgB6M,cAAhB,CAA9B,CAAP;AACD,GAFD;;AAGA,MAAIsqH,gBAAgB,GAAG,UAAUn4G,MAAV,EAAkBy9B,SAAlB,EAA6Bz8C,KAA7B,EAAoCo3H,QAApC,EAA8CC,OAA9C,EAAuDzwH,SAAvD,EAAkE;AACvF,QAAIk2C,QAAQ,GAAGL,SAAS,KAAK2R,UAAU,CAACa,QAAxC;AACA,QAAIw0B,WAAW,GAAGp0B,WAAW,CAACrwC,MAAM,CAACo6B,OAAP,EAAD,CAA7B;AACA,QAAIivE,YAAY,GAAGz5H,KAAK,CAACo/D,sBAAD,EAAyBlR,QAAQ,GAAG2mC,WAAW,CAAChhE,IAAf,GAAsBghE,WAAW,CAAC/gE,IAAnE,CAAxB;AACA,QAAI4lG,UAAU,GAAGxrE,QAAQ,GAAGs6E,QAAH,GAAcC,OAAvC;;AACA,QAAI,CAACr3H,KAAK,CAACgkD,SAAX,EAAsB;AACpB,UAAIpgD,IAAI,GAAGy6C,eAAe,CAACr+C,KAAD,CAA1B;;AACA,UAAI4G,SAAS,CAAChD,IAAD,CAAb,EAAqB;AACnB,eAAO2jH,SAAS,CAAC9qE,SAAD,EAAYz9B,MAAZ,EAAoBpb,IAApB,EAA0B64C,SAAS,KAAK2R,UAAU,CAACkB,SAAnD,EAA8D,KAA9D,CAAhB;AACD;AACF;;AACD,QAAI7O,aAAa,GAAGmN,0BAA0B,CAACnR,SAAD,EAAYz9B,MAAM,CAACo6B,OAAP,EAAZ,EAA8Bp5C,KAA9B,CAA9C;;AACA,QAAIsoH,UAAU,CAAC7nE,aAAD,CAAd,EAA+B;AAC7B,aAAOuR,UAAU,CAAChzC,MAAD,EAASyhC,aAAa,CAACnC,OAAd,CAAsB,CAACxB,QAAvB,CAAT,CAAjB;AACD;;AACD,QAAIyrE,iBAAiB,GAAGxE,iBAAiB,CAACjnE,QAAD,EAAWurE,YAAY,CAAC5nE,aAAD,CAAvB,CAAzC;AACA,QAAI62E,uBAAuB,GAAG3wG,4BAA4B,CAAC3mB,KAAD,CAA1D;;AACA,QAAI,CAACuoH,iBAAL,EAAwB;AACtB,aAAO+O,uBAAuB,GAAGzlI,QAAQ,CAACR,IAAT,CAAc2O,KAAd,CAAH,GAA0BnO,QAAQ,CAACrC,IAAT,EAAxD;AACD;;AACD,QAAI84H,UAAU,CAACC,iBAAD,CAAd,EAAmC;AACjC,aAAOhB,SAAS,CAAC9qE,SAAD,EAAYz9B,MAAZ,EAAoBupG,iBAAiB,CAACjqE,OAAlB,CAA0B,CAACxB,QAA3B,CAApB,EAA0DA,QAA1D,EAAoE,KAApE,CAAhB;AACD;;AACD,QAAIorE,iBAAiB,GAAGG,YAAY,CAACE,iBAAD,CAApC;;AACA,QAAIL,iBAAiB,IAAII,UAAU,CAACJ,iBAAD,CAAnC,EAAwD;AACtD,UAAIh6D,qBAAqB,CAACq6D,iBAAD,EAAoBL,iBAApB,CAAzB,EAAiE;AAC/D,eAAOX,SAAS,CAAC9qE,SAAD,EAAYz9B,MAAZ,EAAoBkpG,iBAAiB,CAAC5pE,OAAlB,CAA0B,CAACxB,QAA3B,CAApB,EAA0DA,QAA1D,EAAoE,KAApE,CAAhB;AACD;AACF;;AACD,QAAIw6E,uBAAJ,EAA6B;AAC3B,aAAOJ,mBAAmB,CAACl4G,MAAD,EAASupG,iBAAiB,CAACznE,OAAlB,EAAT,EAAsC,KAAtC,CAA1B;AACD;;AACD,WAAOjvD,QAAQ,CAACrC,IAAT,EAAP;AACD,GAjCD;;AAkCA,MAAI+nI,cAAc,GAAG,UAAUv4G,MAAV,EAAkBy9B,SAAlB,EAA6Bz8C,KAA7B,EAAoCo3H,QAApC,EAA8CC,OAA9C,EAAuDzwH,SAAvD,EAAkE;AACrF,QAAI65C,aAAa,GAAGmN,0BAA0B,CAACnR,SAAD,EAAYz9B,MAAM,CAACo6B,OAAP,EAAZ,EAA8Bp5C,KAA9B,CAA9C;AACA,QAAIw3H,eAAe,GAAGhgI,MAAM,CAACipD,aAAa,CAACJ,cAAd,EAAD,CAA5B;AACA,QAAIvD,QAAQ,GAAGL,SAAS,KAAK+3E,UAAU,CAACa,IAAxC;;AACA,QAAI,CAACmC,eAAL,EAAsB;AACpB,aAAO3lI,QAAQ,CAACrC,IAAT,EAAP;AACD;;AACD,QAAIioI,QAAQ,GAAG36E,QAAQ,GAAGs4E,SAAH,GAAeF,OAAtC;AACA,QAAIwC,aAAa,GAAGD,QAAQ,CAACz4G,MAAM,CAACo6B,OAAP,EAAD,EAAmBq8E,WAAW,CAAC,CAAD,CAA9B,EAAmCh1E,aAAnC,CAA5B;AACA,QAAIk3E,iBAAiB,GAAG3mI,MAAM,CAAC0mI,aAAD,EAAgBhC,MAAM,CAAC,CAAD,CAAtB,CAA9B;AACA,QAAI59F,OAAO,GAAG0/F,eAAe,CAACrsH,IAA9B;AACA,QAAIysH,YAAY,GAAG3B,qBAAqB,CAAC0B,iBAAD,EAAoB7/F,OAApB,CAAxC;;AACA,QAAI8/F,YAAY,IAAIhxH,SAAS,CAACgxH,YAAY,CAACh0H,IAAd,CAA7B,EAAkD;AAChD,UAAIi0H,KAAK,GAAGnqH,IAAI,CAAC8wD,GAAL,CAAS1mC,OAAO,GAAG8/F,YAAY,CAACzsH,IAAhC,CAAZ;AACA,UAAI2sH,KAAK,GAAGpqH,IAAI,CAAC8wD,GAAL,CAAS1mC,OAAO,GAAG8/F,YAAY,CAACzqH,KAAhC,CAAZ;AACA,aAAOo6G,SAAS,CAAC9qE,SAAD,EAAYz9B,MAAZ,EAAoB44G,YAAY,CAACh0H,IAAjC,EAAuCi0H,KAAK,GAAGC,KAA/C,EAAsD,KAAtD,CAAhB;AACD;;AACD,QAAI3uB,WAAJ;;AACA,QAAIiuB,QAAQ,CAAC32E,aAAD,CAAZ,EAA6B;AAC3B0oD,MAAAA,WAAW,GAAG1oD,aAAa,CAACnC,OAAd,EAAd;AACD,KAFD,MAEO,IAAI+4E,OAAO,CAAC52E,aAAD,CAAX,EAA4B;AACjC0oD,MAAAA,WAAW,GAAG1oD,aAAa,CAACnC,OAAd,CAAsB,IAAtB,CAAd;AACD,KAFM,MAEA;AACL6qD,MAAAA,WAAW,GAAG9qD,eAAe,CAACr+C,KAAD,CAA7B;AACD;;AACD,QAAImpG,WAAJ,EAAiB;AACf,UAAI4uB,cAAc,GAAGzC,cAAc,CAAC74E,SAAD,EAAYz9B,MAAM,CAACo6B,OAAP,EAAZ,EAA8Bq8E,WAAW,CAAC,CAAD,CAAzC,EAA8CtsB,WAA9C,CAAnC;AACA,UAAI6uB,mBAAmB,GAAG/B,qBAAqB,CAACjlI,MAAM,CAAC+mI,cAAD,EAAiBrC,MAAM,CAAC,CAAD,CAAvB,CAAP,EAAoC59F,OAApC,CAA/C;;AACA,UAAIkgG,mBAAJ,EAAyB;AACvB,eAAOd,mBAAmB,CAACl4G,MAAD,EAASg5G,mBAAmB,CAACxoE,QAApB,CAA6B1O,OAA7B,EAAT,EAAiD,KAAjD,CAA1B;AACD;;AACDk3E,MAAAA,mBAAmB,GAAGxgI,MAAM,CAACxG,MAAM,CAAC+mI,cAAD,EAAiBrC,MAAM,CAAC,CAAD,CAAvB,CAAP,CAA5B;;AACA,UAAIsC,mBAAJ,EAAyB;AACvB,eAAOd,mBAAmB,CAACl4G,MAAD,EAASg5G,mBAAmB,CAACxoE,QAApB,CAA6B1O,OAA7B,EAAT,EAAiD,KAAjD,CAA1B;AACD;AACF;;AACD,QAAI62E,iBAAiB,CAAC3qI,MAAlB,KAA6B,CAAjC,EAAoC;AAClC,aAAOirI,eAAe,CAACj5G,MAAD,EAAS89B,QAAT,CAAf,CAAkC9rD,MAAlC,CAAyC8rD,QAAQ,GAAGu6E,OAAH,GAAaD,QAA9D,EAAwEzmI,GAAxE,CAA4E,UAAU8hB,GAAV,EAAe;AAChG,eAAOo1G,gBAAgB,CAAC7oG,MAAD,EAASvM,GAAG,CAACquC,OAAJ,EAAT,EAAwB,KAAxB,CAAvB;AACD,OAFM,CAAP;AAGD;;AACD,WAAOjvD,QAAQ,CAACrC,IAAT,EAAP;AACD,GA1CD;;AA2CA,MAAIyoI,eAAe,GAAG,UAAUj5G,MAAV,EAAkBqjB,OAAlB,EAA2B;AAC/C,QAAI4W,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AACA,QAAIjuC,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAAX;;AACA,QAAI/W,OAAJ,EAAa;AACX,UAAIzwC,IAAI,GAAGivD,aAAa,CAACI,YAAd,CAA2BhI,GAA3B,CAAX;AACA,UAAI57B,MAAM,GAAG02G,yBAAyB,CAAC7oH,IAAD,EAAOtZ,IAAP,CAAtC;AACA,aAAOiD,IAAI,CAACwoB,MAAM,CAACq1G,SAAR,CAAX;AACD,KAJD,MAIO;AACL,UAAI9gI,IAAI,GAAGivD,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAX;AACA,UAAI57B,MAAM,GAAGy2G,6BAA6B,CAAC5oH,IAAD,EAAOtZ,IAAP,CAA1C;AACA,aAAOgD,IAAI,CAACyoB,MAAM,CAACq1G,SAAR,CAAX;AACD;AACF,GAZD;;AAaA,MAAIwF,kBAAkB,GAAG,UAAUl5G,MAAV,EAAkBqjB,OAAlB,EAA2Bgf,iBAA3B,EAA8C;AACrE,WAAO42E,eAAe,CAACj5G,MAAD,EAASqjB,OAAT,CAAf,CAAiCrxC,MAAjC,CAAwCqwD,iBAAxC,EAA2DvwD,MAA3D,CAAkE,UAAU2hB,GAAV,EAAe;AACtFuM,MAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwB1/C,GAAG,CAACquC,OAAJ,EAAxB;AACA,aAAO,IAAP;AACD,KAHM,CAAP;AAID,GALD;;AAOA,MAAIq3E,wBAAwB,GAAGvoH,sBAA/B;;AACA,MAAIwoH,yBAAyB,GAAG,UAAU37E,SAAV,EAAqBz9B,MAArB,EAA6Bhf,KAA7B,EAAoC;AAClE,WAAOm3H,gBAAgB,CAACn4G,MAAD,EAASy9B,SAAT,EAAoBz8C,KAApB,EAA2B23E,4BAA3B,EAAyDC,2BAAzD,EAAsFugD,wBAAtF,CAAvB;AACD,GAFD;;AAGA,MAAIE,uBAAuB,GAAG,UAAU57E,SAAV,EAAqBz9B,MAArB,EAA6Bhf,KAA7B,EAAoC;AAChE,QAAIo3H,QAAQ,GAAG,UAAU32E,aAAV,EAAyB;AACtC,aAAOk3B,4BAA4B,CAACl3B,aAAD,CAA5B,IAA+Cg3B,aAAa,CAACh3B,aAAD,CAAnE;AACD,KAFD;;AAGA,QAAI42E,OAAO,GAAG,UAAU52E,aAAV,EAAyB;AACrC,aAAOm3B,2BAA2B,CAACn3B,aAAD,CAA3B,IAA8Ci3B,YAAY,CAACj3B,aAAD,CAAjE;AACD,KAFD;;AAGA,WAAO82E,cAAc,CAACv4G,MAAD,EAASy9B,SAAT,EAAoBz8C,KAApB,EAA2Bo3H,QAA3B,EAAqCC,OAArC,EAA8Cc,wBAA9C,CAArB;AACD,GARD;;AASA,MAAIG,eAAe,GAAG,UAAUt5G,MAAV,EAAkB;AACtC,QAAIu5G,SAAS,GAAGv5G,MAAM,CAAChb,GAAP,CAAW9C,MAAX,CAAkBkkD,kBAAkB,CAACpmC,MAAD,CAApC,CAAhB;;AACA,QAAI,CAACvf,GAAG,CAAChD,EAAL,IAAWgD,GAAG,CAAChD,EAAJ,IAAU,EAAzB,EAA6B;AAC3B87H,MAAAA,SAAS,CAACn1H,SAAV,GAAsB,yBAAtB;AACD;;AACD,WAAOm1H,SAAP;AACD,GAND;;AAOA,MAAIC,YAAY,GAAG,UAAUx5G,MAAV,EAAkBy9B,SAAlB,EAA6Bz8C,KAA7B,EAAoC;AACrD,QAAIyjF,WAAW,GAAGp0B,WAAW,CAACrwC,MAAM,CAACo6B,OAAP,EAAD,CAA7B;AACA,QAAIq/E,wBAAwB,GAAG7pI,KAAK,CAACo/D,sBAAD,EAAyBvR,SAAS,KAAK,CAAd,GAAkBgnC,WAAW,CAAChhE,IAA9B,GAAqCghE,WAAW,CAAC/gE,IAA1E,CAApC;;AACA,QAAI1iB,KAAK,CAACgkD,SAAN,IAAmBuE,kBAAkB,CAACvpC,MAAD,CAAzC,EAAmD;AACjD,UAAI+sE,GAAG,GAAG/sE,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqBvvC,KAAK,CAAC4mB,cAA3B,EAA2C,KAA3C,CAAV;;AACA,UAAI,CAACmlE,GAAL,EAAU;AACR;AACD;;AACD,UAAIjf,QAAQ,GAAG2rD,wBAAwB,CAAC53E,aAAa,CAACG,cAAd,CAA6BhhD,KAA7B,CAAD,CAAvC;;AACA,UAAI,CAAC8sE,QAAL,EAAe;AACb,YAAI4rD,QAAQ,GAAGJ,eAAe,CAACt5G,MAAD,CAA9B;;AACA,YAAIy9B,SAAS,KAAK,CAAlB,EAAqB;AACnBz9B,UAAAA,MAAM,CAACwuB,CAAP,CAASu+C,GAAT,EAAc/hF,KAAd,CAAoB0uH,QAApB;AACD,SAFD,MAEO;AACL15G,UAAAA,MAAM,CAACwuB,CAAP,CAASu+C,GAAT,EAAcniF,MAAd,CAAqB8uH,QAArB;AACD;;AACD15G,QAAAA,MAAM,CAACk6B,SAAP,CAAiBne,MAAjB,CAAwB29F,QAAxB,EAAkC,IAAlC;AACA15G,QAAAA,MAAM,CAACk6B,SAAP,CAAiBuE,QAAjB;AACD;AACF;AACF,GApBD;;AAqBA,MAAIk7E,kBAAkB,GAAG,UAAU35G,MAAV,EAAkBqjB,OAAlB,EAA2B;AAClD,QAAIoa,SAAS,GAAGpa,OAAO,GAAG+rB,UAAU,CAACa,QAAd,GAAyBb,UAAU,CAACkB,SAA3D;AACA,QAAItvD,KAAK,GAAGgf,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAZ;AACA,WAAOi/E,yBAAyB,CAAC37E,SAAD,EAAYz9B,MAAZ,EAAoBhf,KAApB,CAAzB,CAAoDtP,OAApD,CAA4D,YAAY;AAC7E8nI,MAAAA,YAAY,CAACx5G,MAAD,EAASy9B,SAAT,EAAoBz8C,KAApB,CAAZ;AACA,aAAOnO,QAAQ,CAACrC,IAAT,EAAP;AACD,KAHM,CAAP;AAID,GAPD;;AAQA,MAAIopI,gBAAgB,GAAG,UAAU55G,MAAV,EAAkB65G,IAAlB,EAAwB;AAC7C,QAAIp8E,SAAS,GAAGo8E,IAAI,GAAG,CAAH,GAAO,CAAC,CAA5B;AACA,QAAI74H,KAAK,GAAGgf,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAZ;AACA,WAAOk/E,uBAAuB,CAAC57E,SAAD,EAAYz9B,MAAZ,EAAoBhf,KAApB,CAAvB,CAAkDtP,OAAlD,CAA0D,YAAY;AAC3E8nI,MAAAA,YAAY,CAACx5G,MAAD,EAASy9B,SAAT,EAAoBz8C,KAApB,CAAZ;AACA,aAAOnO,QAAQ,CAACrC,IAAT,EAAP;AACD,KAHM,CAAP;AAID,GAPD;;AAQA,MAAIspI,KAAK,GAAG,UAAU95G,MAAV,EAAkBqjB,OAAlB,EAA2B;AACrC,WAAOs2F,kBAAkB,CAAC35G,MAAD,EAASqjB,OAAT,CAAlB,CAAoCvxC,MAApC,CAA2C,UAAUioI,QAAV,EAAoB;AACpE9B,MAAAA,WAAW,CAACj4G,MAAD,EAAS+5G,QAAT,CAAX;AACA,aAAO,IAAP;AACD,KAHM,CAAP;AAID,GALD;;AAMA,MAAIC,KAAK,GAAG,UAAUh6G,MAAV,EAAkB65G,IAAlB,EAAwB;AAClC,WAAOD,gBAAgB,CAAC55G,MAAD,EAAS65G,IAAT,CAAhB,CAA+B/nI,MAA/B,CAAsC,UAAUioI,QAAV,EAAoB;AAC/D9B,MAAAA,WAAW,CAACj4G,MAAD,EAAS+5G,QAAT,CAAX;AACA,aAAO,IAAP;AACD,KAHM,CAAP;AAID,GALD;;AAMA,MAAIE,oBAAoB,GAAG,UAAUj6G,MAAV,EAAkBqjB,OAAlB,EAA2B;AACpD,QAAI62F,aAAa,GAAG72F,OAAO,GAAGu1C,2BAAH,GAAiCD,4BAA5D;AACA,WAAOugD,kBAAkB,CAACl5G,MAAD,EAASqjB,OAAT,EAAkB62F,aAAlB,CAAzB;AACD,GAHD;;AAKA,MAAIC,QAAQ,GAAG,UAAUv1H,IAAV,EAAgB;AAC7B,WAAOxQ,QAAQ,CAAC,CAAC,YAAD,CAAD,EAAiBtH,IAAI,CAAC8X,IAAD,CAArB,CAAf;AACD,GAFD;;AAGA,MAAIw1H,WAAW,GAAG,UAAUh9H,MAAV,EAAkB;AAClC,QAAI68C,GAAG,GAAG94C,QAAQ,CAAC6xC,WAAT,EAAV;AACAiH,IAAAA,GAAG,CAAC8T,cAAJ,CAAmB3wD,MAAM,CAAC4H,GAA1B;AACAi1C,IAAAA,GAAG,CAAC+T,YAAJ,CAAiB5wD,MAAM,CAAC4H,GAAxB;AACA,WAAOi1C,GAAP;AACD,GALD;;AAMA,MAAIogF,aAAa,GAAG,UAAUl4H,IAAV,EAAgB4Q,GAAhB,EAAqBswB,OAArB,EAA8B;AAChD,QAAIA,OAAJ,EAAa;AACXn4B,MAAAA,MAAM,CAAC/I,IAAD,EAAO4Q,GAAP,CAAN;AACD,KAFD,MAEO;AACL5H,MAAAA,OAAO,CAAChJ,IAAD,EAAO4Q,GAAP,CAAP;AACD;AACF,GAND;;AAOA,MAAIunH,QAAQ,GAAG,UAAUn4H,IAAV,EAAgBkhC,OAAhB,EAAyB;AACtC,QAAIpc,EAAE,GAAG7hB,YAAY,CAACV,OAAb,CAAqB,IAArB,CAAT;AACA21H,IAAAA,aAAa,CAACl4H,IAAD,EAAO8kB,EAAP,EAAWoc,OAAX,CAAb;AACA,WAAO+2F,WAAW,CAACnzG,EAAD,CAAlB;AACD,GAJD;;AAKA,MAAIszG,aAAa,GAAG,UAAUp4H,IAAV,EAAgBkhC,OAAhB,EAAyBlc,SAAzB,EAAoC9V,KAApC,EAA2C;AAC7D,QAAIg1C,KAAK,GAAGjhD,YAAY,CAACV,OAAb,CAAqByiB,SAArB,CAAZ;AACA,QAAIF,EAAE,GAAG7hB,YAAY,CAACV,OAAb,CAAqB,IAArB,CAAT;AACA0M,IAAAA,MAAM,CAACi1C,KAAD,EAAQh1C,KAAR,CAAN;AACAnG,IAAAA,MAAM,CAACm7C,KAAD,EAAQp/B,EAAR,CAAN;AACAozG,IAAAA,aAAa,CAACl4H,IAAD,EAAOkkD,KAAP,EAAchjB,OAAd,CAAb;AACA,WAAO+2F,WAAW,CAACnzG,EAAD,CAAlB;AACD,GAPD;;AAQA,MAAIuzG,eAAe,GAAG,UAAUr4H,IAAV,EAAgB4oG,aAAhB,EAA+B15F,KAA/B,EAAsCgyB,OAAtC,EAA+C;AACnE,QAAI0nE,aAAa,KAAK,EAAtB,EAA0B;AACxB,aAAOuvB,QAAQ,CAACn4H,IAAD,EAAOkhC,OAAP,CAAf;AACD,KAFD,MAEO;AACL,aAAOk3F,aAAa,CAACp4H,IAAD,EAAOkhC,OAAP,EAAgB0nE,aAAhB,EAA+B15F,KAA/B,CAApB;AACD;AACF,GAND;;AAOA,MAAIopH,qBAAqB,GAAG,UAAUhnH,GAAV,EAAetR,IAAf,EAAqB;AAC/C,QAAIqG,MAAM,GAAG5Y,KAAK,CAACmX,IAAD,EAAO5E,IAAP,CAAlB;AACA,WAAOqc,OAAO,CAACpZ,YAAY,CAACX,OAAb,CAAqBgP,GAAG,CAACnS,SAAJ,EAArB,CAAD,EAAwCsjB,OAAxC,EAAiDpc,MAAjD,CAAP,CAAgExW,MAAhE,CAAuEmoI,QAAvE,CAAP;AACD,GAHD;;AAIA,MAAIO,mBAAmB,GAAG,UAAUv4H,IAAV,EAAgBkhC,OAAhB,EAAyB5vB,GAAzB,EAA8B;AACtD,WAAO4vB,OAAO,GAAG4xF,YAAY,CAAC9yH,IAAI,CAAC6C,GAAN,EAAWyO,GAAX,CAAf,GAAiCuhH,aAAa,CAAC7yH,IAAI,CAAC6C,GAAN,EAAWyO,GAAX,CAA5D;AACD,GAFD;;AAGA,MAAIknH,uBAAuB,GAAG,UAAU36G,MAAV,EAAkBqjB,OAAlB,EAA2B;AACvD,QAAIlhC,IAAI,GAAGiD,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAX;AACA,QAAI3mC,GAAG,GAAGouC,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAV;AACA,QAAI8R,SAAS,GAAG7F,kBAAkB,CAACpmC,MAAD,CAAlC;AACA,QAAI46G,cAAc,GAAGt0E,uBAAuB,CAACtmC,MAAD,CAA5C;AACA,WAAOy6G,qBAAqB,CAAChnH,GAAD,EAAMtR,IAAN,CAArB,CAAiCrQ,MAAjC,CAAwC,YAAY;AACzD,UAAI4oI,mBAAmB,CAACv4H,IAAD,EAAOkhC,OAAP,EAAgB5vB,GAAhB,CAAvB,EAA6C;AAC3C,YAAIwmC,GAAG,GAAGugF,eAAe,CAACr4H,IAAD,EAAO8pD,SAAP,EAAkB2uE,cAAlB,EAAkCv3F,OAAlC,CAAzB;AACArjB,QAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB;AACA,eAAO,IAAP;AACD,OAJD,MAIO;AACL,eAAO,KAAP;AACD;AACF,KARM,CAAP;AASD,GAdD;;AAeA,MAAI4gF,OAAO,GAAG,UAAU76G,MAAV,EAAkBqjB,OAAlB,EAA2B;AACvC,QAAIrjB,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,EAAJ,EAAoC;AAClC,aAAOu2E,uBAAuB,CAAC36G,MAAD,EAASqjB,OAAT,CAA9B;AACD,KAFD,MAEO;AACL,aAAO,KAAP;AACD;AACF,GAND;;AAQA,MAAIy3F,eAAe,GAAG,UAAUC,QAAV,EAAoB;AACxC,WAAOppI,GAAG,CAACopI,QAAD,EAAW,UAAUxpG,OAAV,EAAmB;AACtC,aAAO94B,QAAQ,CAAC;AACdylE,QAAAA,QAAQ,EAAE,KADI;AAEdE,QAAAA,MAAM,EAAE,KAFM;AAGdD,QAAAA,OAAO,EAAE,KAHK;AAId1kC,QAAAA,OAAO,EAAE,KAJK;AAKdwyD,QAAAA,OAAO,EAAE,CALK;AAMdzK,QAAAA,MAAM,EAAE3yF;AANM,OAAD,EAOZ0iC,OAPY,CAAf;AAQD,KATS,CAAV;AAUD,GAXD;;AAYA,MAAIypG,YAAY,GAAG,UAAUzpG,OAAV,EAAmBkJ,GAAnB,EAAwB;AACzC,WAAOA,GAAG,CAACwxD,OAAJ,KAAgB16D,OAAO,CAAC06D,OAAxB,IAAmCxxD,GAAG,CAACyjC,QAAJ,KAAiB3sC,OAAO,CAAC2sC,QAA5D,IAAwEzjC,GAAG,CAAC2jC,MAAJ,KAAe7sC,OAAO,CAAC6sC,MAA/F,IAAyG3jC,GAAG,CAAC0jC,OAAJ,KAAgB5sC,OAAO,CAAC4sC,OAAjI,IAA4I1jC,GAAG,CAAChB,OAAJ,KAAgBlI,OAAO,CAACkI,OAA3K;AACD,GAFD;;AAGA,MAAIwhG,OAAO,GAAG,UAAUF,QAAV,EAAoBtgG,GAApB,EAAyB;AACrC,WAAO5oC,IAAI,CAACipI,eAAe,CAACC,QAAD,CAAhB,EAA4B,UAAUxpG,OAAV,EAAmB;AACxD,aAAOypG,YAAY,CAACzpG,OAAD,EAAUkJ,GAAV,CAAZ,GAA6B,CAAClJ,OAAD,CAA7B,GAAyC,EAAhD;AACD,KAFU,CAAX;AAGD,GAJD;;AAKA,MAAIiwD,MAAM,GAAG,UAAU9zF,CAAV,EAAa;AACxB,QAAInB,CAAC,GAAG,EAAR;;AACA,SAAK,IAAI2C,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5C3C,MAAAA,CAAC,CAAC2C,EAAE,GAAG,CAAN,CAAD,GAAYC,SAAS,CAACD,EAAD,CAArB;AACD;;AACD,WAAO,YAAY;AACjB,aAAOxB,CAAC,CAAC0B,KAAF,CAAQ,IAAR,EAAc7C,CAAd,CAAP;AACD,KAFD;AAGD,GARD;;AASA,MAAI2uI,OAAO,GAAG,UAAUH,QAAV,EAAoBtgG,GAApB,EAAyB;AACrC,WAAOzlC,IAAI,CAACimI,OAAO,CAACF,QAAD,EAAWtgG,GAAX,CAAR,EAAyB,UAAUlJ,OAAV,EAAmB;AACrD,aAAOA,OAAO,CAACiwD,MAAR,EAAP;AACD,KAFU,CAAX;AAGD,GAJD;;AAMA,MAAI25C,OAAO,GAAG,UAAUn7G,MAAV,EAAkBqjB,OAAlB,EAA2B;AACvC,QAAIoa,SAAS,GAAGpa,OAAO,GAAG+rB,UAAU,CAACa,QAAd,GAAyBb,UAAU,CAACkB,SAA3D;AACA,QAAItvD,KAAK,GAAGgf,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAZ;AACA,WAAOg+E,gBAAgB,CAACn4G,MAAD,EAASy9B,SAAT,EAAoBz8C,KAApB,EAA2Bu3E,aAA3B,EAA0CC,YAA1C,EAAwD1nE,OAAxD,CAAhB,CAAiFhf,MAAjF,CAAwF,UAAUioI,QAAV,EAAoB;AACjH9B,MAAAA,WAAW,CAACj4G,MAAD,EAAS+5G,QAAT,CAAX;AACA,aAAO,IAAP;AACD,KAHM,CAAP;AAID,GAPD;;AAQA,MAAIqB,OAAO,GAAG,UAAUp7G,MAAV,EAAkB65G,IAAlB,EAAwB;AACpC,QAAIp8E,SAAS,GAAGo8E,IAAI,GAAG,CAAH,GAAO,CAAC,CAA5B;AACA,QAAI74H,KAAK,GAAGgf,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAZ;AACA,WAAOo+E,cAAc,CAACv4G,MAAD,EAASy9B,SAAT,EAAoBz8C,KAApB,EAA2Bu3E,aAA3B,EAA0CC,YAA1C,EAAwD1nE,OAAxD,CAAd,CAA+Ehf,MAA/E,CAAsF,UAAUioI,QAAV,EAAoB;AAC/G9B,MAAAA,WAAW,CAACj4G,MAAD,EAAS+5G,QAAT,CAAX;AACA,aAAO,IAAP;AACD,KAHM,CAAP;AAID,GAPD;;AAQA,MAAIsB,oBAAoB,GAAG,UAAUr7G,MAAV,EAAkBqjB,OAAlB,EAA2B;AACpD,QAAIgtF,WAAW,GAAGhtF,OAAO,GAAGm1C,YAAH,GAAkBD,aAA3C;AACA,WAAO2gD,kBAAkB,CAACl5G,MAAD,EAASqjB,OAAT,EAAkBgtF,WAAlB,CAAzB;AACD,GAHD;;AAKA,MAAIiL,OAAO,GAAG,UAAU98E,IAAV,EAAgBs5B,KAAhB,EAAuB;AACnC,WAAO;AACL3rE,MAAAA,IAAI,EAAEqyC,IAAI,CAACryC,IAAL,GAAY2rE,KADb;AAEL1rE,MAAAA,GAAG,EAAEoyC,IAAI,CAACpyC,GAAL,GAAW0rE,KAFX;AAGL3pE,MAAAA,KAAK,EAAEqwC,IAAI,CAACrwC,KAAL,GAAa2pE,KAAK,GAAG,CAHvB;AAIL1pE,MAAAA,MAAM,EAAEowC,IAAI,CAACpwC,MAAL,GAAc0pE,KAAK,GAAG,CAJzB;AAKL7pE,MAAAA,KAAK,EAAEuwC,IAAI,CAACvwC,KAAL,GAAa6pE,KALf;AAML5pE,MAAAA,MAAM,EAAEswC,IAAI,CAACtwC,MAAL,GAAc4pE;AANjB,KAAP;AAQD,GATD;;AAUA,MAAIyjD,UAAU,GAAG,UAAUC,aAAV,EAAyBC,GAAzB,EAA8B;AAC7C,WAAO5pI,IAAI,CAAC4pI,GAAD,EAAM,UAAU5oG,EAAV,EAAc;AAC7B,UAAI2rB,IAAI,GAAG88E,OAAO,CAAC/8E,OAAO,CAAC1rB,EAAE,CAACpmB,qBAAH,EAAD,CAAR,EAAsC,CAAC,CAAvC,CAAlB;AACA,aAAO,CACL;AACElgB,QAAAA,CAAC,EAAEiyD,IAAI,CAACryC,IADV;AAEEve,QAAAA,CAAC,EAAE4tI,aAAa,CAACh9E,IAAD,CAFlB;AAGEghC,QAAAA,IAAI,EAAE3sD;AAHR,OADK,EAML;AACEtmC,QAAAA,CAAC,EAAEiyD,IAAI,CAACrwC,KADV;AAEEvgB,QAAAA,CAAC,EAAE4tI,aAAa,CAACh9E,IAAD,CAFlB;AAGEghC,QAAAA,IAAI,EAAE3sD;AAHR,OANK,CAAP;AAYD,KAdU,CAAX;AAeD,GAhBD;;AAiBA,MAAI6oG,iBAAiB,GAAG,UAAUC,OAAV,EAAmBpvI,CAAnB,EAAsBqB,CAAtB,EAAyB;AAC/C,WAAOiH,KAAK,CAAC8mI,OAAD,EAAU,UAAU/mI,GAAV,EAAegnI,SAAf,EAA0B;AAC9C,aAAOhnI,GAAG,CAAC5D,IAAJ,CAAS,YAAY;AAC1B,eAAO6B,QAAQ,CAACR,IAAT,CAAcupI,SAAd,CAAP;AACD,OAFM,EAEJ,UAAUC,SAAV,EAAqB;AACtB,YAAIC,OAAO,GAAGptH,IAAI,CAACqtH,IAAL,CAAUrtH,IAAI,CAAC8wD,GAAL,CAASq8D,SAAS,CAACtvI,CAAV,GAAcA,CAAvB,IAA4BmiB,IAAI,CAAC8wD,GAAL,CAASq8D,SAAS,CAACjuI,CAAV,GAAcA,CAAvB,CAAtC,CAAd;AACA,YAAI+mI,OAAO,GAAGjmH,IAAI,CAACqtH,IAAL,CAAUrtH,IAAI,CAAC8wD,GAAL,CAASo8D,SAAS,CAACrvI,CAAV,GAAcA,CAAvB,IAA4BmiB,IAAI,CAAC8wD,GAAL,CAASo8D,SAAS,CAAChuI,CAAV,GAAcA,CAAvB,CAAtC,CAAd;AACA,eAAOiF,QAAQ,CAACR,IAAT,CAAcsiI,OAAO,GAAGmH,OAAV,GAAoBF,SAApB,GAAgCC,SAA9C,CAAP;AACD,OANM,CAAP;AAOD,KARW,EAQThpI,QAAQ,CAACrC,IAAT,EARS,CAAZ;AASD,GAVD;;AAWA,MAAIwrI,gBAAgB,GAAG,UAAUR,aAAV,EAAyBS,cAAzB,EAAyCtuG,KAAzC,EAAgDphC,CAAhD,EAAmDqB,CAAnD,EAAsD;AAC3E,QAAIoxF,KAAK,GAAGrlC,aAAa,CAACv0C,YAAY,CAACX,OAAb,CAAqBkpB,KAArB,CAAD,EAA8B,eAA9B,CAAb,CAA4Dh8B,GAA5D,CAAgE,UAAUkH,CAAV,EAAa;AACvF,aAAOA,CAAC,CAACmM,GAAT;AACD,KAFW,CAAZ;AAGA,QAAI22H,OAAO,GAAG3pI,MAAM,CAACupI,UAAU,CAACC,aAAD,EAAgBx8C,KAAhB,CAAX,EAAmC,UAAUk9C,MAAV,EAAkB;AACvE,aAAOD,cAAc,CAACC,MAAD,EAAStuI,CAAT,CAArB;AACD,KAFmB,CAApB;AAGA,WAAO8tI,iBAAiB,CAACC,OAAD,EAAUpvI,CAAV,EAAaqB,CAAb,CAAjB,CAAiC+D,GAAjC,CAAqC,UAAUuqI,MAAV,EAAkB;AAC5D,aAAOA,MAAM,CAAC18C,IAAd;AACD,KAFM,CAAP;AAGD,GAVD;;AAWA,MAAI28C,cAAc,GAAG,UAAU39E,IAAV,EAAgB;AACnC,WAAOA,IAAI,CAACpwC,MAAZ;AACD,GAFD;;AAGA,MAAIguH,WAAW,GAAG,UAAU59E,IAAV,EAAgB;AAChC,WAAOA,IAAI,CAACpyC,GAAZ;AACD,GAFD;;AAGA,MAAIiwH,SAAS,GAAG,UAAUH,MAAV,EAAkBtuI,CAAlB,EAAqB;AACnC,WAAOsuI,MAAM,CAACtuI,CAAP,GAAWA,CAAlB;AACD,GAFD;;AAGA,MAAI0uI,SAAS,GAAG,UAAUJ,MAAV,EAAkBtuI,CAAlB,EAAqB;AACnC,WAAOsuI,MAAM,CAACtuI,CAAP,GAAWA,CAAlB;AACD,GAFD;;AAGA,MAAI2uI,mBAAmB,GAAG3sI,KAAK,CAACosI,gBAAD,EAAmBG,cAAnB,EAAmCE,SAAnC,CAA/B;AACA,MAAIG,mBAAmB,GAAG5sI,KAAK,CAACosI,gBAAD,EAAmBI,WAAnB,EAAgCE,SAAhC,CAA/B;;AACA,MAAIG,8BAA8B,GAAG,UAAU9uG,KAAV,EAAiBla,GAAjB,EAAsB;AACzD,WAAO7d,IAAI,CAAC6d,GAAG,CAAC4tC,cAAJ,EAAD,CAAJ,CAA2BxvD,IAA3B,CAAgC,UAAU2sD,IAAV,EAAgB;AACrD,aAAO+9E,mBAAmB,CAAC5uG,KAAD,EAAQ6wB,IAAI,CAACryC,IAAb,EAAmBqyC,IAAI,CAACpyC,GAAxB,CAA1B;AACD,KAFM,EAEJva,IAFI,CAEC,UAAU2tF,IAAV,EAAgB;AACtB,aAAOo1C,6BAA6B,CAACS,oBAAoB,CAAC71C,IAAD,CAArB,EAA6B/rE,GAA7B,CAApC;AACD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAIipH,8BAA8B,GAAG,UAAU/uG,KAAV,EAAiBla,GAAjB,EAAsB;AACzD,WAAO5d,IAAI,CAAC4d,GAAG,CAAC4tC,cAAJ,EAAD,CAAJ,CAA2BxvD,IAA3B,CAAgC,UAAU2sD,IAAV,EAAgB;AACrD,aAAOg+E,mBAAmB,CAAC7uG,KAAD,EAAQ6wB,IAAI,CAACryC,IAAb,EAAmBqyC,IAAI,CAACpyC,GAAxB,CAA1B;AACD,KAFM,EAEJva,IAFI,CAEC,UAAU2tF,IAAV,EAAgB;AACtB,aAAOo1C,6BAA6B,CAACQ,qBAAqB,CAAC51C,IAAD,CAAtB,EAA8B/rE,GAA9B,CAApC;AACD,KAJM,CAAP;AAKD,GAND;;AAQA,MAAIkpH,YAAY,GAAG,UAAU1I,iBAAV,EAA6BjwH,KAA7B,EAAoC44H,QAApC,EAA8C;AAC/D,WAAOA,QAAQ,CAACzI,OAAT,CAAiBriI,MAAjB,CAAwB,UAAU+qI,QAAV,EAAoB;AACjD,aAAO5I,iBAAiB,CAACjwH,KAAD,EAAQ64H,QAAR,CAAjB,CAAmC1I,OAAnC,CAA2ChjI,MAA3C,EAAP;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAI2rI,mBAAmB,GAAG,UAAUF,QAAV,EAAoB;AAC5C,WAAOA,QAAQ,CAAC1I,SAAT,KAAuBV,SAAS,CAACQ,IAAjC,IAAyC4I,QAAQ,CAAClJ,SAAT,CAAmB1lI,MAAnB,KAA8B,CAA9E;AACD,GAFD;;AAGA,MAAI+uI,iBAAiB,GAAG,UAAUH,QAAV,EAAoB;AAC1C,WAAOA,QAAQ,CAAC1I,SAAT,KAAuBV,SAAS,CAACM,EAAjC,IAAuC8I,QAAQ,CAAClJ,SAAT,CAAmB1lI,MAAnB,KAA8B,CAA5E;AACD,GAFD;;AAGA,MAAIgvI,iBAAiB,GAAG,UAAU/I,iBAAV,EAA6BjwH,KAA7B,EAAoCyP,GAApC,EAAyC;AAC/D,QAAImpH,QAAQ,GAAG3I,iBAAiB,CAACjwH,KAAD,EAAQyP,GAAR,CAAhC;;AACA,QAAIqpH,mBAAmB,CAACF,QAAD,CAAnB,IAAiC,CAACnsH,IAAI,CAACgD,GAAG,CAAC6rC,OAAJ,EAAD,CAAL,IAAwBy9E,iBAAiB,CAACH,QAAD,CAA9E,EAA0F;AACxF,aAAO,CAACD,YAAY,CAAC1I,iBAAD,EAAoBjwH,KAApB,EAA2B44H,QAA3B,CAApB;AACD,KAFD,MAEO;AACL,aAAOA,QAAQ,CAACzI,OAAT,CAAiBxjI,MAAjB,EAAP;AACD;AACF,GAPD;;AAQA,MAAIssI,sBAAsB,GAAGrtI,KAAK,CAACotI,iBAAD,EAAoBlI,6BAApB,CAAlC;AACA,MAAIoI,qBAAqB,GAAGttI,KAAK,CAACotI,iBAAD,EAAoBjI,yBAApB,CAAjC;;AACA,MAAIoI,0BAA0B,GAAG,UAAU95F,OAAV,EAAmB4W,GAAnB,EAAwBtsB,KAAxB,EAA+B;AAC9D,QAAImgD,QAAQ,GAAGjsB,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAf;AACA,WAAOkX,UAAU,CAAC,CAAC9tB,OAAF,EAAW1V,KAAX,CAAV,CAA4B77B,MAA5B,CAAmC,UAAU2hB,GAAV,EAAe;AACvD,aAAOA,GAAG,CAACkrC,OAAJ,CAAYmvB,QAAZ,CAAP;AACD,KAFM,CAAP;AAGD,GALD;;AAMA,MAAIsvD,oBAAoB,GAAG,UAAUp9G,MAAV,EAAkBqjB,OAAlB,EAA2B1V,KAA3B,EAAkC0vG,GAAlC,EAAuC;AAChE,QAAIpjF,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AACA,QAAIsD,SAAS,GAAGpa,OAAO,GAAG,CAAH,GAAO,CAAC,CAA/B;;AACA,QAAIopB,uBAAuB,MAAM0wE,0BAA0B,CAAC95F,OAAD,EAAU4W,GAAV,EAAetsB,KAAf,CAA3D,EAAkF;AAChF46F,MAAAA,SAAS,CAAC9qE,SAAD,EAAYz9B,MAAZ,EAAoB2N,KAApB,EAA2B,CAAC0V,OAA5B,EAAqC,KAArC,CAAT,CAAqDzxC,IAArD,CAA0D,UAAUovD,MAAV,EAAkB;AAC1Ei3E,QAAAA,WAAW,CAACj4G,MAAD,EAASghC,MAAT,CAAX;AACD,OAFD;AAGA,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD,GAVD;;AAWA,MAAIs8E,uBAAuB,GAAG,UAAUn7H,IAAV,EAAgBwrB,KAAhB,EAAuBlxB,KAAvB,EAA8B;AAC1D,WAAOggI,8BAA8B,CAAC9uG,KAAD,EAAQlxB,KAAR,CAA9B,CAA6C/K,OAA7C,CAAqD,YAAY;AACtE,aAAOkE,IAAI,CAAC6G,KAAK,CAAC4kD,cAAN,EAAD,CAAJ,CAA6BxvD,IAA7B,CAAkC,UAAU2sD,IAAV,EAAgB;AACvD,eAAO+1E,sCAAsC,CAACW,iBAAiB,CAAC/yH,IAAD,EAAO0/C,aAAa,CAACj3C,MAAd,CAAqB+iB,KAArB,CAAP,CAAlB,EAAuD6wB,IAAI,CAACryC,IAA5D,CAA7C;AACD,OAFM,CAAP;AAGD,KAJM,EAIJ/a,KAJI,CAIEywD,aAAa,CAACj3C,MAAd,CAAqB+iB,KAArB,CAJF,CAAP;AAKD,GAND;;AAOA,MAAI4vG,uBAAuB,GAAG,UAAUp7H,IAAV,EAAgBwrB,KAAhB,EAAuBlxB,KAAvB,EAA8B;AAC1D,WAAOigI,8BAA8B,CAAC/uG,KAAD,EAAQlxB,KAAR,CAA9B,CAA6C/K,OAA7C,CAAqD,YAAY;AACtE,aAAOkE,IAAI,CAAC6G,KAAK,CAAC4kD,cAAN,EAAD,CAAJ,CAA6BxvD,IAA7B,CAAkC,UAAU2sD,IAAV,EAAgB;AACvD,eAAO+1E,sCAAsC,CAACY,iBAAiB,CAAChzH,IAAD,EAAO0/C,aAAa,CAAC72C,KAAd,CAAoB2iB,KAApB,CAAP,CAAlB,EAAsD6wB,IAAI,CAACryC,IAA3D,CAA7C;AACD,OAFM,CAAP;AAGD,KAJM,EAIJ/a,KAJI,CAIEywD,aAAa,CAAC72C,KAAd,CAAoB2iB,KAApB,CAJF,CAAP;AAKD,GAND;;AAOA,MAAI6vG,QAAQ,GAAG,UAAUriF,QAAV,EAAoB1nC,GAApB,EAAyB;AACtC,QAAI7O,IAAI,GAAG6O,GAAG,CAAC6rC,OAAJ,CAAYnE,QAAZ,CAAX;AACA,WAAOlsC,WAAW,CAACrK,IAAD,CAAX,IAAqBA,IAAI,CAAC6C,QAAL,KAAkB,OAAvC,GAAiD5U,QAAQ,CAACR,IAAT,CAAcuS,IAAd,CAAjD,GAAuE/R,QAAQ,CAACrC,IAAT,EAA9E;AACD,GAHD;;AAIA,MAAIitI,WAAW,GAAG,UAAU5D,IAAV,EAAgB75G,MAAhB,EAAwB2N,KAAxB,EAA+Bla,GAA/B,EAAoC;AACpD,QAAI27E,eAAe,GAAGhpC,kBAAkB,CAACpmC,MAAD,CAAxC;;AACA,QAAIovE,eAAJ,EAAqB;AACnBpvE,MAAAA,MAAM,CAAC27C,WAAP,CAAmBC,QAAnB,CAA4B,YAAY;AACtC,YAAI11D,OAAO,GAAGd,YAAY,CAACV,OAAb,CAAqB0qF,eAArB,CAAd;AACAh+E,QAAAA,MAAM,CAAClL,OAAD,EAAUogD,uBAAuB,CAACtmC,MAAD,CAAjC,CAAN;AACA9U,QAAAA,MAAM,CAAChF,OAAD,EAAUd,YAAY,CAACV,OAAb,CAAqB,IAArB,CAAV,CAAN;;AACA,YAAIm1H,IAAJ,EAAU;AACR7uH,UAAAA,KAAK,CAAC5F,YAAY,CAACX,OAAb,CAAqBkpB,KAArB,CAAD,EAA8BznB,OAA9B,CAAL;AACD,SAFD,MAEO;AACL0E,UAAAA,MAAM,CAACxF,YAAY,CAACX,OAAb,CAAqBkpB,KAArB,CAAD,EAA8BznB,OAA9B,CAAN;AACD;;AACD,YAAI+zC,GAAG,GAAGj6B,MAAM,CAAChb,GAAP,CAAW+tC,SAAX,EAAV;AACAkH,QAAAA,GAAG,CAAC5G,QAAJ,CAAantC,OAAO,CAAClB,GAArB,EAA0B,CAA1B;AACAi1C,QAAAA,GAAG,CAAC3G,MAAJ,CAAWptC,OAAO,CAAClB,GAAnB,EAAwB,CAAxB;AACAizH,QAAAA,WAAW,CAACj4G,MAAD,EAASi6B,GAAT,CAAX;AACD,OAbD;AAcD,KAfD,MAeO;AACLg+E,MAAAA,WAAW,CAACj4G,MAAD,EAASvM,GAAG,CAACquC,OAAJ,EAAT,CAAX;AACD;AACF,GApBD;;AAqBA,MAAIy8B,SAAS,GAAG,UAAUv+D,MAAV,EAAkB65G,IAAlB,EAAwBpmH,GAAxB,EAA6B;AAC3C,QAAIka,KAAK,GAAGksG,IAAI,GAAG2D,QAAQ,CAAC,IAAD,EAAO/pH,GAAP,CAAX,GAAyB+pH,QAAQ,CAAC,KAAD,EAAQ/pH,GAAR,CAAjD;AACA,QAAI5d,IAAI,GAAGgkI,IAAI,KAAK,KAApB;AACAlsG,IAAAA,KAAK,CAAC38B,IAAN,CAAW,YAAY;AACrB,aAAOinI,WAAW,CAACj4G,MAAD,EAASvM,GAAG,CAACquC,OAAJ,EAAT,CAAlB;AACD,KAFD,EAEG,UAAUn0B,KAAV,EAAiB;AAClB,aAAOwjC,UAAU,CAACt7D,IAAD,EAAOmqB,MAAM,CAACo6B,OAAP,EAAP,CAAV,CAAmCpoD,MAAnC,CAA0C,UAAU+pF,OAAV,EAAmB;AAClE,eAAOA,OAAO,CAACp9B,OAAR,CAAgBlrC,GAAhB,CAAP;AACD,OAFM,EAEJziB,IAFI,CAEC,YAAY;AAClB,eAAOinI,WAAW,CAACj4G,MAAD,EAASvM,GAAG,CAACquC,OAAJ,EAAT,CAAlB;AACD,OAJM,EAIJ,UAAU1lC,CAAV,EAAa;AACd,eAAOqhH,WAAW,CAAC5D,IAAD,EAAO75G,MAAP,EAAe2N,KAAf,EAAsBla,GAAtB,CAAlB;AACD,OANM,CAAP;AAOD,KAVD;AAWD,GAdD;;AAeA,MAAIiqH,kBAAkB,GAAG,UAAU19G,MAAV,EAAkB65G,IAAlB,EAAwBlsG,KAAxB,EAA+BkF,EAA/B,EAAmC;AAC1D,QAAIonB,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AACA,QAAI1mC,GAAG,GAAGouC,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAV;AACA,QAAI93C,IAAI,GAAG6d,MAAM,CAACo6B,OAAP,EAAX;;AACA,QAAI,CAACy/E,IAAD,IAASoD,sBAAsB,CAACpqG,EAAD,EAAKpf,GAAL,CAAnC,EAA8C;AAC5C,UAAIkmE,MAAM,GAAG2jD,uBAAuB,CAACn7H,IAAD,EAAOwrB,KAAP,EAAcla,GAAd,CAApC;AACA8qE,MAAAA,SAAS,CAACv+D,MAAD,EAAS65G,IAAT,EAAelgD,MAAf,CAAT;AACA,aAAO,IAAP;AACD,KAJD,MAIO,IAAIkgD,IAAI,IAAIqD,qBAAqB,CAACrqG,EAAD,EAAKpf,GAAL,CAAjC,EAA4C;AACjD,UAAIkmE,MAAM,GAAG4jD,uBAAuB,CAACp7H,IAAD,EAAOwrB,KAAP,EAAcla,GAAd,CAApC;AACA8qE,MAAAA,SAAS,CAACv+D,MAAD,EAAS65G,IAAT,EAAelgD,MAAf,CAAT;AACA,aAAO,IAAP;AACD,KAJM,MAIA;AACL,aAAO,KAAP;AACD;AACF,GAfD;;AAgBA,MAAIgkD,MAAM,GAAG,UAAU39G,MAAV,EAAkBqjB,OAAlB,EAA2Bu6F,KAA3B,EAAkC;AAC7C,WAAO/qI,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqBvwB,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,EAArB,EAAiD,OAAjD,CAAd,EAAyEztD,IAAzE,CAA8E,UAAUghC,EAAV,EAAc;AACjG,aAAOhgC,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqB1d,EAArB,EAAyB,OAAzB,CAAd,EAAiDlhC,GAAjD,CAAqD,UAAUg8B,KAAV,EAAiB;AAC3E,eAAOiwG,KAAK,CAAC59G,MAAD,EAASqjB,OAAT,EAAkB1V,KAAlB,EAAyBkF,EAAzB,CAAZ;AACD,OAFM,CAAP;AAGD,KAJM,EAIJzhC,KAJI,CAIE,KAJF,CAAP;AAKD,GAND;;AAOA,MAAIysI,OAAO,GAAG,UAAU79G,MAAV,EAAkBqjB,OAAlB,EAA2B;AACvC,WAAOs6F,MAAM,CAAC39G,MAAD,EAASqjB,OAAT,EAAkB+5F,oBAAlB,CAAb;AACD,GAFD;;AAGA,MAAIU,OAAO,GAAG,UAAU99G,MAAV,EAAkBqjB,OAAlB,EAA2B;AACvC,WAAOs6F,MAAM,CAAC39G,MAAD,EAASqjB,OAAT,EAAkBq6F,kBAAlB,CAAb;AACD,GAFD;;AAIA,MAAIK,sBAAsB,GAAG,UAAU/9G,MAAV,EAAkBmsC,KAAlB,EAAyB1xB,GAAzB,EAA8B;AACzD,QAAIlhC,EAAE,GAAG2G,QAAQ,GAAG3G,EAApB;AACA2hI,IAAAA,OAAO,CAAC,CACN;AACEjvC,MAAAA,OAAO,EAAE5uB,EAAE,CAACM,KADd;AAEE6jB,MAAAA,MAAM,EAAEA,MAAM,CAACs4C,KAAD,EAAQ95G,MAAR,EAAgB,IAAhB;AAFhB,KADM,EAKN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACK,IADd;AAEE8jB,MAAAA,MAAM,EAAEA,MAAM,CAACs4C,KAAD,EAAQ95G,MAAR,EAAgB,KAAhB;AAFhB,KALM,EASN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACS,EADd;AAEE0jB,MAAAA,MAAM,EAAEA,MAAM,CAACw4C,KAAD,EAAQh6G,MAAR,EAAgB,KAAhB;AAFhB,KATM,EAaN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACG,IADd;AAEEgkB,MAAAA,MAAM,EAAEA,MAAM,CAACw4C,KAAD,EAAQh6G,MAAR,EAAgB,IAAhB;AAFhB,KAbM,EAiBN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACM,KADd;AAEE6jB,MAAAA,MAAM,EAAEA,MAAM,CAACq8C,OAAD,EAAU79G,MAAV,EAAkB,IAAlB;AAFhB,KAjBM,EAqBN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACK,IADd;AAEE8jB,MAAAA,MAAM,EAAEA,MAAM,CAACq8C,OAAD,EAAU79G,MAAV,EAAkB,KAAlB;AAFhB,KArBM,EAyBN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACS,EADd;AAEE0jB,MAAAA,MAAM,EAAEA,MAAM,CAACs8C,OAAD,EAAU99G,MAAV,EAAkB,KAAlB;AAFhB,KAzBM,EA6BN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACG,IADd;AAEEgkB,MAAAA,MAAM,EAAEA,MAAM,CAACs8C,OAAD,EAAU99G,MAAV,EAAkB,IAAlB;AAFhB,KA7BM,EAiCN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACM,KADd;AAEE6jB,MAAAA,MAAM,EAAEA,MAAM,CAAC25C,OAAD,EAAUn7G,MAAV,EAAkB,IAAlB;AAFhB,KAjCM,EAqCN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACK,IADd;AAEE8jB,MAAAA,MAAM,EAAEA,MAAM,CAAC25C,OAAD,EAAUn7G,MAAV,EAAkB,KAAlB;AAFhB,KArCM,EAyCN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACS,EADd;AAEE0jB,MAAAA,MAAM,EAAEA,MAAM,CAAC45C,OAAD,EAAUp7G,MAAV,EAAkB,KAAlB;AAFhB,KAzCM,EA6CN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACG,IADd;AAEEgkB,MAAAA,MAAM,EAAEA,MAAM,CAAC45C,OAAD,EAAUp7G,MAAV,EAAkB,IAAlB;AAFhB,KA7CM,EAiDN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACM,KADd;AAEE6jB,MAAAA,MAAM,EAAEA,MAAM,CAACstC,IAAD,EAAO9uG,MAAP,EAAemsC,KAAf,EAAsB,IAAtB;AAFhB,KAjDM,EAqDN;AACE8/B,MAAAA,OAAO,EAAE5uB,EAAE,CAACK,IADd;AAEE8jB,MAAAA,MAAM,EAAEA,MAAM,CAACstC,IAAD,EAAO9uG,MAAP,EAAemsC,KAAf,EAAsB,KAAtB;AAFhB,KArDM,EAyDN;AACE8/B,MAAAA,OAAO,EAAE5uB,EAAE,CAACM,KADd;AAEEQ,MAAAA,OAAO,EAAE,CAAC5kE,EAAE,CAAC4F,KAAH,EAFZ;AAGEi/D,MAAAA,MAAM,EAAE7kE,EAAE,CAAC4F,KAAH,EAHV;AAIEqiF,MAAAA,MAAM,EAAEA,MAAM,CAAC0tC,YAAD,EAAelvG,MAAf,EAAuBmsC,KAAvB;AAJhB,KAzDM,EA+DN;AACE8/B,MAAAA,OAAO,EAAE5uB,EAAE,CAACK,IADd;AAEES,MAAAA,OAAO,EAAE,CAAC5kE,EAAE,CAAC4F,KAAH,EAFZ;AAGEi/D,MAAAA,MAAM,EAAE7kE,EAAE,CAAC4F,KAAH,EAHV;AAIEqiF,MAAAA,MAAM,EAAEA,MAAM,CAAC2tC,YAAD,EAAenvG,MAAf,EAAuBmsC,KAAvB;AAJhB,KA/DM,EAqEN;AACE8/B,MAAAA,OAAO,EAAE5uB,EAAE,CAACS,EADd;AAEE0jB,MAAAA,MAAM,EAAEA,MAAM,CAACq5C,OAAD,EAAU76G,MAAV,EAAkB,KAAlB;AAFhB,KArEM,EAyEN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACG,IADd;AAEEgkB,MAAAA,MAAM,EAAEA,MAAM,CAACq5C,OAAD,EAAU76G,MAAV,EAAkB,IAAlB;AAFhB,KAzEM,CAAD,EA6EJya,GA7EI,CAAP,CA6EQ7oC,IA7ER,CA6Ea,UAAUwqB,CAAV,EAAa;AACxBqe,MAAAA,GAAG,CAACvB,cAAJ;AACD,KA/ED;AAgFD,GAlFD;;AAmFA,MAAI8kG,OAAO,GAAG,UAAUh+G,MAAV,EAAkBmsC,KAAlB,EAAyB;AACrCnsC,IAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAU2kB,GAAV,EAAe;AAClC,UAAIA,GAAG,CAAC1C,kBAAJ,OAA6B,KAAjC,EAAwC;AACtCgmG,QAAAA,sBAAsB,CAAC/9G,MAAD,EAASmsC,KAAT,EAAgB1xB,GAAhB,CAAtB;AACD;AACF,KAJD;AAKD,GAND;;AAQA,MAAIwjG,wBAAwB,GAAG,UAAUj+G,MAAV,EAAkBmsC,KAAlB,EAAyB1xB,GAAzB,EAA8B;AAC3DygG,IAAAA,OAAO,CAAC,CACN;AACEjvC,MAAAA,OAAO,EAAE5uB,EAAE,CAACC,SADd;AAEEkkB,MAAAA,MAAM,EAAEA,MAAM,CAACmwC,iBAAD,EAAoB3xG,MAApB,EAA4B,KAA5B;AAFhB,KADM,EAKN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACC,SADd;AAEEkkB,MAAAA,MAAM,EAAEA,MAAM,CAACypC,iBAAD,EAAoBjrG,MAApB,EAA4B,KAA5B;AAFhB,KALM,EASN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACE,MADd;AAEEikB,MAAAA,MAAM,EAAEA,MAAM,CAACypC,iBAAD,EAAoBjrG,MAApB,EAA4B,IAA5B;AAFhB,KATM,EAaN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACC,SADd;AAEEkkB,MAAAA,MAAM,EAAEA,MAAM,CAACgoC,iBAAD,EAAoBxpG,MAApB,EAA4B,KAA5B;AAFhB,KAbM,EAiBN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACE,MADd;AAEEikB,MAAAA,MAAM,EAAEA,MAAM,CAACgoC,iBAAD,EAAoBxpG,MAApB,EAA4B,IAA5B;AAFhB,KAjBM,EAqBN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACC,SADd;AAEEkkB,MAAAA,MAAM,EAAEA,MAAM,CAACmuC,iBAAD,EAAoB3vG,MAApB,EAA4BmsC,KAA5B,EAAmC,KAAnC;AAFhB,KArBM,EAyBN;AACE8/B,MAAAA,OAAO,EAAE5uB,EAAE,CAACE,MADd;AAEEikB,MAAAA,MAAM,EAAEA,MAAM,CAACmuC,iBAAD,EAAoB3vG,MAApB,EAA4BmsC,KAA5B,EAAmC,IAAnC;AAFhB,KAzBM,EA6BN;AACE8/B,MAAAA,OAAO,EAAE5uB,EAAE,CAACC,SADd;AAEEkkB,MAAAA,MAAM,EAAEA,MAAM,CAACsB,eAAD,EAAkB9iE,MAAlB,EAA0B,KAA1B;AAFhB,KA7BM,EAiCN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACE,MADd;AAEEikB,MAAAA,MAAM,EAAEA,MAAM,CAACsB,eAAD,EAAkB9iE,MAAlB,EAA0B,IAA1B;AAFhB,KAjCM,EAqCN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACC,SADd;AAEEkkB,MAAAA,MAAM,EAAEA,MAAM,CAAC2pC,iBAAD,EAAoBnrG,MAApB,EAA4B,KAA5B;AAFhB,KArCM,EAyCN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACE,MADd;AAEEikB,MAAAA,MAAM,EAAEA,MAAM,CAAC2pC,iBAAD,EAAoBnrG,MAApB,EAA4B,IAA5B;AAFhB,KAzCM,EA6CN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACC,SADd;AAEEkkB,MAAAA,MAAM,EAAEA,MAAM,CAAC+uC,iBAAD,EAAoBvwG,MAApB,EAA4B,KAA5B;AAFhB,KA7CM,EAiDN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACE,MADd;AAEEikB,MAAAA,MAAM,EAAEA,MAAM,CAAC+uC,iBAAD,EAAoBvwG,MAApB,EAA4B,IAA5B;AAFhB,KAjDM,EAqDN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACC,SADd;AAEEkkB,MAAAA,MAAM,EAAEA,MAAM,CAAC2mC,iBAAD,EAAoBnoG,MAApB,EAA4B,KAA5B;AAFhB,KArDM,EAyDN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACE,MADd;AAEEikB,MAAAA,MAAM,EAAEA,MAAM,CAAC2mC,iBAAD,EAAoBnoG,MAApB,EAA4B,IAA5B;AAFhB,KAzDM,EA6DN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACC,SADd;AAEEkkB,MAAAA,MAAM,EAAEA,MAAM,CAACkmC,iBAAD,EAAoB1nG,MAApB,EAA4B,KAA5B;AAFhB,KA7DM,EAiEN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACE,MADd;AAEEikB,MAAAA,MAAM,EAAEA,MAAM,CAACkmC,iBAAD,EAAoB1nG,MAApB,EAA4B,IAA5B;AAFhB,KAjEM,EAqEN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACC,SADd;AAEEkkB,MAAAA,MAAM,EAAEA,MAAM,CAAC0uC,iBAAD,EAAoBlwG,MAApB,EAA4B,KAA5B;AAFhB,KArEM,EAyEN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACE,MADd;AAEEikB,MAAAA,MAAM,EAAEA,MAAM,CAAC0uC,iBAAD,EAAoBlwG,MAApB,EAA4B,IAA5B;AAFhB,KAzEM,CAAD,EA6EJya,GA7EI,CAAP,CA6EQ7oC,IA7ER,CA6Ea,UAAUwqB,CAAV,EAAa;AACxBqe,MAAAA,GAAG,CAACvB,cAAJ;AACD,KA/ED;AAgFD,GAjFD;;AAkFA,MAAIglG,oBAAoB,GAAG,UAAUl+G,MAAV,EAAkBya,GAAlB,EAAuB;AAChDygG,IAAAA,OAAO,CAAC,CACN;AACEjvC,MAAAA,OAAO,EAAE5uB,EAAE,CAACC,SADd;AAEEkkB,MAAAA,MAAM,EAAEA,MAAM,CAACwpC,gBAAD,EAAmBhrG,MAAnB;AAFhB,KADM,EAKN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACE,MADd;AAEEikB,MAAAA,MAAM,EAAEA,MAAM,CAACwpC,gBAAD,EAAmBhrG,MAAnB;AAFhB,KALM,CAAD,EASJya,GATI,CAAP;AAUD,GAXD;;AAYA,MAAI0jG,OAAO,GAAG,UAAUn+G,MAAV,EAAkBmsC,KAAlB,EAAyB;AACrCnsC,IAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAU2kB,GAAV,EAAe;AAClC,UAAIA,GAAG,CAAC1C,kBAAJ,OAA6B,KAAjC,EAAwC;AACtCkmG,QAAAA,wBAAwB,CAACj+G,MAAD,EAASmsC,KAAT,EAAgB1xB,GAAhB,CAAxB;AACD;AACF,KAJD;AAKAza,IAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,UAAU2kB,GAAV,EAAe;AAChC,UAAIA,GAAG,CAAC1C,kBAAJ,OAA6B,KAAjC,EAAwC;AACtCmmG,QAAAA,oBAAoB,CAACl+G,MAAD,EAASya,GAAT,CAApB;AACD;AACF,KAJD;AAKD,GAXD;;AAaA,MAAI2jG,6BAA6B,GAAG,UAAUx5H,IAAV,EAAgB;AAClD,WAAOA,IAAP,EAAa;AACX,UAAIA,IAAI,CAACwB,QAAL,KAAkB,CAAlB,IAAuBxB,IAAI,CAACwB,QAAL,KAAkB,CAAlB,IAAuBxB,IAAI,CAAC4V,IAA5B,IAAoC,WAAW3gB,IAAX,CAAgB+K,IAAI,CAAC4V,IAArB,CAA/D,EAA2F;AACzF,eAAO5V,IAAP;AACD;;AACDA,MAAAA,IAAI,GAAGA,IAAI,CAACsE,WAAZ;AACD;AACF,GAPD;;AAQA,MAAIm1H,mBAAmB,GAAG,UAAUr+G,MAAV,EAAkB7d,IAAlB,EAAwB;AAChD,QAAIyC,IAAJ;AAAA,QAAUu8E,QAAQ,GAAGh/E,IAArB;AACA,QAAI6C,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,QAAIuqB,iCAAiC,GAAGvP,MAAM,CAAC8M,MAAP,CAAcoH,iCAAd,EAAxC;;AACA,QAAI,CAAC/xB,IAAL,EAAW;AACT;AACD;;AACD,QAAI,eAAetI,IAAf,CAAoBsI,IAAI,CAACsF,QAAzB,CAAJ,EAAwC;AACtC,UAAI8B,UAAU,GAAG60H,6BAA6B,CAACj8H,IAAI,CAACoH,UAAN,CAA9C;;AACA,UAAIA,UAAU,IAAI,eAAe1P,IAAf,CAAoB0P,UAAU,CAAC9B,QAA/B,CAAlB,EAA4D;AAC1DtF,QAAAA,IAAI,CAAC4I,YAAL,CAAkB/F,GAAG,CAACf,GAAJ,CAAQc,cAAR,CAAuBygB,IAAvB,CAAlB,EAAgDrjB,IAAI,CAACoH,UAArD;AACD;AACF;;AACD,QAAI0wC,GAAG,GAAGj1C,GAAG,CAAC+tC,SAAJ,EAAV;AACA5wC,IAAAA,IAAI,CAAC8iE,SAAL;;AACA,QAAI9iE,IAAI,CAACkC,aAAL,EAAJ,EAA0B;AACxB,UAAIqlB,MAAM,GAAG,IAAIpG,aAAJ,CAAkBnhB,IAAlB,EAAwBA,IAAxB,CAAb;;AACA,aAAOyC,IAAI,GAAG8kB,MAAM,CAAC3tB,OAAP,EAAd,EAAgC;AAC9B,YAAIsU,QAAQ,CAACzL,IAAD,CAAZ,EAAoB;AAClBq1C,UAAAA,GAAG,CAAC5G,QAAJ,CAAazuC,IAAb,EAAmB,CAAnB;AACAq1C,UAAAA,GAAG,CAAC3G,MAAJ,CAAW1uC,IAAX,EAAiB,CAAjB;AACA;AACD;;AACD,YAAI2qB,iCAAiC,CAAC3qB,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,EAAD,CAArC,EAAoE;AAClE4+C,UAAAA,GAAG,CAAC8T,cAAJ,CAAmBnpD,IAAnB;AACAq1C,UAAAA,GAAG,CAAC+T,YAAJ,CAAiBppD,IAAjB;AACA;AACD;;AACDu8E,QAAAA,QAAQ,GAAGv8E,IAAX;AACAA,QAAAA,IAAI,GAAG8kB,MAAM,CAACjG,IAAP,EAAP;AACD;;AACD,UAAI,CAAC7e,IAAL,EAAW;AACTq1C,QAAAA,GAAG,CAAC5G,QAAJ,CAAa8tC,QAAb,EAAuB,CAAvB;AACAlnC,QAAAA,GAAG,CAAC3G,MAAJ,CAAW6tC,QAAX,EAAqB,CAArB;AACD;AACF,KApBD,MAoBO;AACL,UAAI1wE,IAAI,CAACtO,IAAD,CAAR,EAAgB;AACd,YAAIA,IAAI,CAAC+G,WAAL,IAAoBlE,GAAG,CAAC4f,OAAJ,CAAYziB,IAAI,CAAC+G,WAAjB,CAAxB,EAAuD;AACrD+wC,UAAAA,GAAG,CAAC8T,cAAJ,CAAmB5rD,IAAnB;AACA83C,UAAAA,GAAG,CAAC+T,YAAJ,CAAiB7rD,IAAjB;AACD,SAHD,MAGO;AACL83C,UAAAA,GAAG,CAACgU,aAAJ,CAAkB9rD,IAAlB;AACA83C,UAAAA,GAAG,CAACiH,WAAJ,CAAgB/+C,IAAhB;AACD;AACF,OARD,MAQO;AACL83C,QAAAA,GAAG,CAAC5G,QAAJ,CAAalxC,IAAb,EAAmB,CAAnB;AACA83C,QAAAA,GAAG,CAAC3G,MAAJ,CAAWnxC,IAAX,EAAiB,CAAjB;AACD;AACF;;AACD6d,IAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB;AACAovB,IAAAA,mBAAmB,CAACrpD,MAAD,EAASi6B,GAAT,CAAnB;AACD,GAnDD;;AAoDA,MAAIqkF,eAAe,GAAG,UAAUt5H,GAAV,EAAeJ,IAAf,EAAqB;AACzC,QAAIzC,IAAI,GAAG6C,GAAG,CAACypC,OAAJ,EAAX;AACA,QAAIzrC,MAAJ,EAAYu7H,YAAZ;AACAv7H,IAAAA,MAAM,GAAG4B,IAAT;;AACA,WAAO5B,MAAM,KAAKb,IAAX,IAAmB6C,GAAG,CAAC0uC,kBAAJ,CAAuB1wC,MAAvB,MAAmC,OAA7D,EAAsE;AACpE,UAAIgC,GAAG,CAAC0uC,kBAAJ,CAAuB1wC,MAAvB,MAAmC,MAAvC,EAA+C;AAC7Cu7H,QAAAA,YAAY,GAAGv7H,MAAf;AACD;;AACDA,MAAAA,MAAM,GAAGA,MAAM,CAACsF,UAAhB;AACD;;AACD,WAAOtF,MAAM,KAAKb,IAAX,GAAkBo8H,YAAlB,GAAiCp8H,IAAxC;AACD,GAXD;;AAYA,MAAIq8H,gBAAgB,GAAG,UAAUx+G,MAAV,EAAkB;AACvC,WAAOntB,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqBvwB,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,CAA0B,IAA1B,CAArB,EAAsD1iD,MAAM,CAAChb,GAAP,CAAW4f,OAAjE,CAAd,CAAP;AACD,GAFD;;AAGA,MAAI65G,kBAAkB,GAAG,UAAUz+G,MAAV,EAAkB;AACzC,WAAOw+G,gBAAgB,CAACx+G,MAAD,CAAhB,CAAyBhvB,IAAzB,CAA8BvB,QAAQ,CAAC,EAAD,CAAtC,EAA4C,UAAUgvF,WAAV,EAAuB;AACxE,aAAOA,WAAW,CAACh3E,QAAZ,CAAqBsmB,WAArB,EAAP;AACD,KAFM,CAAP;AAGD,GAJD;;AAKA,MAAI2wG,qBAAqB,GAAG,UAAU1+G,MAAV,EAAkB;AAC5C,WAAOw+G,gBAAgB,CAACx+G,MAAD,CAAhB,CAAyBhuB,MAAzB,CAAgC,UAAU+gB,GAAV,EAAe;AACpD,aAAOmS,UAAU,CAAC9f,YAAY,CAACX,OAAb,CAAqBsO,GAArB,CAAD,CAAjB;AACD,KAFM,EAEJ5hB,MAFI,EAAP;AAGD,GAJD;;AAMA,MAAIwtI,aAAa,GAAG,UAAU5rH,GAAV,EAAejmB,IAAf,EAAqB;AACvC,WAAOimB,GAAG,CAACxJ,UAAJ,IAAkBwJ,GAAG,CAACxJ,UAAJ,CAAe9B,QAAf,KAA4B3a,IAArD;AACD,GAFD;;AAGA,MAAI8xI,YAAY,GAAG,UAAU7rH,GAAV,EAAe;AAChC,QAAI6oC,EAAJ;;AACA,WAAO,CAAC,CAACA,EAAE,GAAG7oC,GAAG,CAACzK,UAAV,MAA0B,IAA1B,IAAkCszC,EAAE,KAAK,KAAK,CAA9C,GAAkD,KAAK,CAAvD,GAA2DA,EAAE,CAACryC,UAA/D,MAA+EwJ,GAAtF;AACD,GAHD;;AAIA,MAAI8rH,WAAW,GAAG,UAAU9rH,GAAV,EAAe8+E,UAAf,EAA2B;AAC3C,WAAO9+E,GAAG,IAAIA,GAAG,CAACzK,UAAX,IAAyByK,GAAG,CAACzK,UAAJ,CAAeb,QAAf,KAA4BoqF,UAA5D;AACD,GAFD;;AAGA,MAAIitC,WAAW,GAAG,UAAU/rH,GAAV,EAAe;AAC/B,WAAOA,GAAG,IAAI,eAAelZ,IAAf,CAAoBkZ,GAAG,CAACtL,QAAxB,CAAd;AACD,GAFD;;AAGA,MAAIs3H,YAAY,GAAG,UAAUhsH,GAAV,EAAe;AAChC,WAAO+rH,WAAW,CAAC/rH,GAAD,CAAX,IAAoB+rH,WAAW,CAAC/rH,GAAG,CAACzK,UAAL,CAAtC;AACD,GAFD;;AAGA,MAAI02H,iBAAiB,GAAG,UAAUC,cAAV,EAA0B;AAChD,QAAIC,oBAAoB,GAAGD,cAAc,CAAC32H,UAA1C;;AACA,QAAI,eAAezO,IAAf,CAAoBqlI,oBAAoB,CAACz3H,QAAzC,CAAJ,EAAwD;AACtD,aAAOy3H,oBAAP;AACD;;AACD,WAAOD,cAAP;AACD,GAND;;AAOA,MAAIE,eAAe,GAAG,UAAUF,cAAV,EAA0BxgD,WAA1B,EAAuC77C,KAAvC,EAA8C;AAClE,QAAIh+B,IAAI,GAAGq6H,cAAc,CAACr8F,KAAK,GAAG,YAAH,GAAkB,WAAxB,CAAzB;;AACA,WAAOh+B,IAAP,EAAa;AACX,UAAIqK,WAAW,CAACrK,IAAD,CAAf,EAAuB;AACrB;AACD;;AACDA,MAAAA,IAAI,GAAGA,IAAI,CAACg+B,KAAK,GAAG,aAAH,GAAmB,iBAAzB,CAAX;AACD;;AACD,WAAOh+B,IAAI,KAAK65E,WAAhB;AACD,GATD;;AAUA,MAAIzO,MAAM,GAAG,UAAUhwD,MAAV,EAAkBo/G,cAAlB,EAAkCH,cAAlC,EAAkDxgD,WAAlD,EAA+D4gD,YAA/D,EAA6E;AACxF,QAAIr6H,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,QAAIi1C,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;;AACA,QAAI8kF,cAAc,KAAKj/G,MAAM,CAACo6B,OAAP,EAAvB,EAAyC;AACvC;AACD;;AACD,QAAI2kF,YAAY,CAACE,cAAD,CAAhB,EAAkC;AAChCI,MAAAA,YAAY,GAAG,IAAf;AACD;;AACD,QAAI3F,QAAQ,GAAG2F,YAAY,GAAGD,cAAc,CAACC,YAAD,CAAjB,GAAkCr6H,GAAG,CAAC9C,MAAJ,CAAW,IAAX,CAA7D;;AACA,QAAIi9H,eAAe,CAACF,cAAD,EAAiBxgD,WAAjB,EAA8B,IAA9B,CAAf,IAAsD0gD,eAAe,CAACF,cAAD,EAAiBxgD,WAAjB,EAA8B,KAA9B,CAAzE,EAA+G;AAC7G,UAAIogD,WAAW,CAACI,cAAD,EAAiB,IAAjB,CAAf,EAAuC;AACrC,YAAIC,oBAAoB,GAAGF,iBAAiB,CAACC,cAAD,CAA5C;AACAj6H,QAAAA,GAAG,CAACktC,WAAJ,CAAgBwnF,QAAhB,EAA0BwF,oBAA1B;;AACA,YAAIN,YAAY,CAACK,cAAD,CAAhB,EAAkC;AAChCj6H,UAAAA,GAAG,CAAC6G,MAAJ,CAAWqzH,oBAAX;AACD,SAFD,MAEO;AACLl6H,UAAAA,GAAG,CAAC6G,MAAJ,CAAWozH,cAAX;AACD;AACF,OARD,MAQO;AACLj6H,QAAAA,GAAG,CAAChK,OAAJ,CAAY0+H,QAAZ,EAAsBuF,cAAtB;AACD;AACF,KAZD,MAYO,IAAIE,eAAe,CAACF,cAAD,EAAiBxgD,WAAjB,EAA8B,IAA9B,CAAnB,EAAwD;AAC7D,UAAIogD,WAAW,CAACI,cAAD,EAAiB,IAAjB,CAAf,EAAuC;AACrCj6H,QAAAA,GAAG,CAACktC,WAAJ,CAAgBwnF,QAAhB,EAA0BsF,iBAAiB,CAACC,cAAD,CAA3C;AACAvF,QAAAA,QAAQ,CAACruH,WAAT,CAAqBrG,GAAG,CAACf,GAAJ,CAAQc,cAAR,CAAuB,GAAvB,CAArB;AACA20H,QAAAA,QAAQ,CAACruH,WAAT,CAAqB4zH,cAArB;AACD,OAJD,MAIO;AACLA,QAAAA,cAAc,CAAC32H,UAAf,CAA0ByC,YAA1B,CAAuC2uH,QAAvC,EAAiDuF,cAAjD;AACD;;AACDj6H,MAAAA,GAAG,CAAC6G,MAAJ,CAAW4yE,WAAX;AACD,KATM,MASA,IAAI0gD,eAAe,CAACF,cAAD,EAAiBxgD,WAAjB,EAA8B,KAA9B,CAAnB,EAAyD;AAC9Dz5E,MAAAA,GAAG,CAACktC,WAAJ,CAAgBwnF,QAAhB,EAA0BsF,iBAAiB,CAACC,cAAD,CAA3C;AACAj6H,MAAAA,GAAG,CAAC6G,MAAJ,CAAW4yE,WAAX;AACD,KAHM,MAGA;AACLwgD,MAAAA,cAAc,GAAGD,iBAAiB,CAACC,cAAD,CAAlC;AACA,UAAIK,MAAM,GAAGrlF,GAAG,CAACgH,UAAJ,EAAb;AACAq+E,MAAAA,MAAM,CAACrxE,aAAP,CAAqBwwB,WAArB;AACA6gD,MAAAA,MAAM,CAACp+E,WAAP,CAAmB+9E,cAAnB;AACA,UAAI/hF,QAAQ,GAAGoiF,MAAM,CAAC/rF,eAAP,EAAf;;AACA,UAAI8rF,YAAY,KAAK,IAAjB,IAAyBV,aAAa,CAACzhF,QAAD,EAAW,IAAX,CAA1C,EAA4D;AAC1Dw8E,QAAAA,QAAQ,GAAGx8E,QAAQ,CAAC3zC,UAApB;AACAvE,QAAAA,GAAG,CAACktC,WAAJ,CAAgBgL,QAAhB,EAA0B+hF,cAA1B;AACD,OAHD,MAGO;AACLj6H,QAAAA,GAAG,CAACktC,WAAJ,CAAgBgL,QAAhB,EAA0B+hF,cAA1B;AACAj6H,QAAAA,GAAG,CAACktC,WAAJ,CAAgBwnF,QAAhB,EAA0BuF,cAA1B;AACD;;AACDj6H,MAAAA,GAAG,CAAC6G,MAAJ,CAAW4yE,WAAX;AACD;;AACD4/C,IAAAA,mBAAmB,CAACr+G,MAAD,EAAS05G,QAAT,CAAnB;AACD,GAlDD;;AAoDA,MAAI6F,QAAQ,GAAG,UAAUriF,QAAV,EAAoB;AACjCtrD,IAAAA,IAAI,CAAC8nD,WAAW,CAACt0C,YAAY,CAACX,OAAb,CAAqBy4C,QAArB,CAAD,EAAiCr1C,MAAjC,CAAZ,EAAsD,UAAU/C,IAAV,EAAgB;AACxE,UAAIg0E,OAAO,GAAGh0E,IAAI,CAACE,GAAnB;AACA8zE,MAAAA,OAAO,CAACt2C,SAAR,GAAoB1c,MAAM,CAACgzD,OAAO,CAACt2C,SAAT,CAA1B;AACD,KAHG,CAAJ;AAID,GALD;;AAMA,MAAIg9F,aAAa,GAAG,UAAUx6H,GAAV,EAAe+N,GAAf,EAAoB;AACtC,WAAOA,GAAG,IAAIA,GAAG,CAACtL,QAAJ,KAAiB,GAAxB,IAA+BzC,GAAG,CAAC2kB,OAAJ,CAAY5W,GAAZ,CAAtC;AACD,GAFD;;AAGA,MAAI0sH,aAAa,GAAG,UAAU76H,IAAV,EAAgB;AAClC,WAAOA,IAAI,IAAI,oBAAoB/K,IAApB,CAAyB+K,IAAI,CAAC6C,QAA9B,CAAf;AACD,GAFD;;AAGA,MAAIi4H,UAAU,GAAG,UAAU3sH,GAAV,EAAe;AAC9BA,IAAAA,GAAG,CAAC3O,SAAJ,GAAgB,yBAAhB;AACD,GAFD;;AAGA,MAAIu7H,uBAAuB,GAAG,UAAUr+H,SAAV,EAAqBmG,QAArB,EAA+B;AAC3D,WAAOnG,SAAS,CAACmG,QAAV,KAAuBA,QAAvB,IAAmCnG,SAAS,CAAC2H,eAAV,IAA6B3H,SAAS,CAAC2H,eAAV,CAA0BxB,QAA1B,KAAuCA,QAA9G;AACD,GAFD;;AAGA,MAAIm4H,aAAa,GAAG,UAAU56H,GAAV,EAAeJ,IAAf,EAAqB;AACvC,WAAOA,IAAI,IAAII,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAZ,CAAR,IAA6B,CAAC,yBAAyB/K,IAAzB,CAA8B+K,IAAI,CAAC6C,QAAnC,CAA9B,IAA8E,CAAC,qBAAqB5N,IAArB,CAA0B+K,IAAI,CAACoM,KAAL,CAAWw/C,QAArC,CAA/E,IAAiIxrD,GAAG,CAAC0uC,kBAAJ,CAAuB9uC,IAAvB,MAAiC,MAAzK;AACD,GAFD;;AAGA,MAAIi7H,mCAAmC,GAAG,UAAU76H,GAAV,EAAesqB,mBAAf,EAAoC+2B,KAApC,EAA2C;AACnF,QAAIzhD,IAAI,GAAGyhD,KAAX;AACA,QAAIy5E,WAAW,GAAG,EAAlB;AACA,QAAI5xI,CAAJ;;AACA,QAAI,CAAC0W,IAAL,EAAW;AACT;AACD;;AACD,WAAOA,IAAI,GAAGA,IAAI,CAAC2E,UAAnB,EAA+B;AAC7B,UAAIvE,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAZ,CAAJ,EAAuB;AACrB;AACD;;AACD,UAAIqK,WAAW,CAACrK,IAAD,CAAX,IAAqB,CAAC0qB,mBAAmB,CAAC1qB,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,EAAD,CAA7C,EAA4E;AAC1EykI,QAAAA,WAAW,CAAC9rI,IAAZ,CAAiB4Q,IAAjB;AACD;AACF;;AACD1W,IAAAA,CAAC,GAAG4xI,WAAW,CAAC9xI,MAAhB;;AACA,WAAOE,CAAC,EAAR,EAAY;AACV0W,MAAAA,IAAI,GAAGk7H,WAAW,CAAC5xI,CAAD,CAAlB;;AACA,UAAI,CAAC0W,IAAI,CAACP,aAAL,EAAD,IAAyBO,IAAI,CAAC2E,UAAL,KAAoB3E,IAAI,CAAC4E,SAAzB,IAAsC5E,IAAI,CAAC2E,UAAL,CAAgBi5B,SAAhB,KAA8B,EAAjG,EAAqG;AACnGx9B,QAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX;AACD,OAFD,MAEO;AACL,YAAI46H,aAAa,CAACx6H,GAAD,EAAMJ,IAAN,CAAjB,EAA8B;AAC5BI,UAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX;AACD;AACF;AACF;AACF,GA1BD;;AA2BA,MAAIm7H,mBAAmB,GAAG,UAAUtjI,KAAV,EAAiB6E,SAAjB,EAA4BslB,MAA5B,EAAoC;AAC5D,QAAIvW,QAAQ,CAAC/O,SAAD,CAAR,KAAwB,KAA5B,EAAmC;AACjC,aAAOslB,MAAP;AACD,KAFD,MAEO,IAAInqB,KAAJ,EAAW;AAChB,aAAOmqB,MAAM,KAAK,CAAX,IAAgBtlB,SAAS,CAACkZ,IAAV,CAAemM,MAAf,CAAsBC,MAAM,GAAG,CAA/B,MAAsChB,IAAtD,GAA6D,CAA7D,GAAiEgB,MAAxE;AACD,KAFM,MAEA;AACL,aAAOA,MAAM,KAAKtlB,SAAS,CAACkZ,IAAV,CAAexsB,MAAf,GAAwB,CAAnC,IAAwCsT,SAAS,CAACkZ,IAAV,CAAemM,MAAf,CAAsBC,MAAtB,MAAkChB,IAA1E,GAAiFtkB,SAAS,CAACkZ,IAAV,CAAexsB,MAAhG,GAAyG44B,MAAhH;AACD;AACF,GARD;;AASA,MAAIo5G,kBAAkB,GAAG,UAAU/lF,GAAV,EAAe;AACtC,QAAI+G,MAAM,GAAG/G,GAAG,CAACgH,UAAJ,EAAb;AACAD,IAAAA,MAAM,CAAC3N,QAAP,CAAgB4G,GAAG,CAACryB,cAApB,EAAoCm4G,mBAAmB,CAAC,IAAD,EAAO9lF,GAAG,CAACryB,cAAX,EAA2BqyB,GAAG,CAACnG,WAA/B,CAAvD;AACAkN,IAAAA,MAAM,CAAC1N,MAAP,CAAc2G,GAAG,CAAClG,YAAlB,EAAgCgsF,mBAAmB,CAAC,KAAD,EAAQ9lF,GAAG,CAAClG,YAAZ,EAA0BkG,GAAG,CAACjG,SAA9B,CAAnD;AACA,WAAOgN,MAAP;AACD,GALD;;AAMA,MAAIi/E,qBAAqB,GAAG,UAAUr7H,IAAV,EAAgB;AAC1C,OAAG;AACD,UAAIyL,QAAQ,CAACzL,IAAD,CAAZ,EAAoB;AAClBA,QAAAA,IAAI,CAAC49B,SAAL,GAAiB59B,IAAI,CAAC49B,SAAL,CAAexnC,OAAf,CAAuB,UAAvB,EAAmC,EAAnC,CAAjB;AACD;;AACD4J,MAAAA,IAAI,GAAGA,IAAI,CAAC2E,UAAZ;AACD,KALD,QAKS3E,IALT;AAMD,GAPD;;AAQA,MAAIs7H,iBAAiB,GAAG,UAAUl7H,GAAV,EAAeJ,IAAf,EAAqB;AAC3C,QAAIzC,IAAI,GAAG6C,GAAG,CAACypC,OAAJ,EAAX;AACA,QAAIzrC,MAAJ,EAAYu7H,YAAZ;AACAv7H,IAAAA,MAAM,GAAG4B,IAAT;;AACA,WAAO5B,MAAM,KAAKb,IAAX,IAAmB6C,GAAG,CAAC0uC,kBAAJ,CAAuB1wC,MAAvB,MAAmC,OAA7D,EAAsE;AACpE,UAAIgC,GAAG,CAAC0uC,kBAAJ,CAAuB1wC,MAAvB,MAAmC,MAAvC,EAA+C;AAC7Cu7H,QAAAA,YAAY,GAAGv7H,MAAf;AACD;;AACDA,MAAAA,MAAM,GAAGA,MAAM,CAACsF,UAAhB;AACD;;AACD,WAAOtF,MAAM,KAAKb,IAAX,GAAkBo8H,YAAlB,GAAiCp8H,IAAxC;AACD,GAXD;;AAYA,MAAIg+H,eAAe,GAAG,UAAUngH,MAAV,EAAkBpb,IAAlB,EAAwBw7H,oBAAxB,EAA8C;AAClE,QAAIp7H,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACAnS,IAAAA,QAAQ,CAACD,IAAT,CAAcwtI,oBAAoB,CAACpvH,KAAnC,EAA0Crf,GAA1C,CAA8CqT,GAAG,CAACssC,UAAlD,EAA8D1/C,IAA9D,CAAmE,UAAUyuI,UAAV,EAAsB;AACvF,UAAIC,aAAa,GAAG/tH,SAAS,CAACnN,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAD,CAA7B;;AACA,UAAI27H,SAAS,GAAG9nI,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK6nI,aAAL,CAAT,EAA8BD,UAA9B,CAAxB;;AACAr7H,MAAAA,GAAG,CAAC6qC,SAAJ,CAAcjrC,IAAd,EAAoB27H,SAApB;AACD,KAJD;AAKA,QAAIC,cAAc,GAAG3tI,QAAQ,CAACD,IAAT,CAAcwtI,oBAAoB,CAACl2F,KAAnC,EAA0Cv4C,GAA1C,CAA8C,UAAU8uI,WAAV,EAAuB;AACxF,aAAOA,WAAW,CAAC1+H,KAAZ,CAAkB,KAAlB,CAAP;AACD,KAFoB,CAArB;AAGA,QAAI2+H,iBAAiB,GAAG7tI,QAAQ,CAACD,IAAT,CAAcgS,IAAI,CAACy8B,SAAnB,EAA8B1vC,GAA9B,CAAkC,UAAUgvI,cAAV,EAA0B;AAClF,aAAO3uI,MAAM,CAAC2uI,cAAc,CAAC5+H,KAAf,CAAqB,KAArB,CAAD,EAA8B,UAAUq3C,KAAV,EAAiB;AAC1D,eAAOA,KAAK,KAAK,EAAjB;AACD,OAFY,CAAb;AAGD,KAJuB,CAAxB;AAKA4E,IAAAA,KAAK,CAACwiF,cAAD,EAAiBE,iBAAjB,EAAoC,UAAUD,WAAV,EAAuBE,cAAvB,EAAuC;AAC9E,UAAIC,eAAe,GAAG5uI,MAAM,CAAC2uI,cAAD,EAAiB,UAAUvnF,KAAV,EAAiB;AAC5D,eAAO,CAAChlD,QAAQ,CAACqsI,WAAD,EAAcrnF,KAAd,CAAhB;AACD,OAF2B,CAA5B;;AAGA,UAAIynF,UAAU,GAAG7nI,cAAc,CAACynI,WAAD,EAAcG,eAAd,CAA/B;;AACA57H,MAAAA,GAAG,CAAC8pC,SAAJ,CAAclqC,IAAd,EAAoB,OAApB,EAA6Bi8H,UAAU,CAACtjH,IAAX,CAAgB,GAAhB,CAA7B;AACD,KANI,CAAL;AAOA,QAAIujH,YAAY,GAAG,CACjB,OADiB,EAEjB,OAFiB,CAAnB;AAIA,QAAIC,cAAc,GAAGlqI,QAAQ,CAACupI,oBAAD,EAAuB,UAAUhkH,CAAV,EAAa/K,KAAb,EAAoB;AACtE,aAAO,CAACjd,QAAQ,CAAC0sI,YAAD,EAAezvH,KAAf,CAAhB;AACD,KAF4B,CAA7B;AAGArM,IAAAA,GAAG,CAAC2rC,UAAJ,CAAe/rC,IAAf,EAAqBm8H,cAArB;AACD,GA9BD;;AA+BA,MAAIC,mBAAmB,GAAG,UAAUhhH,MAAV,EAAkBpb,IAAlB,EAAwB;AAChD,QAAImjF,mBAAmB,GAAG3hC,kBAAkB,CAACpmC,MAAD,CAA5C;;AACA,QAAI+nE,mBAAmB,IAAIA,mBAAmB,CAAC1sF,WAApB,OAAsCuJ,IAAI,CAACsL,OAAL,CAAa7U,WAAb,EAAjE,EAA6F;AAC3F,UAAI+kI,oBAAoB,GAAG95E,uBAAuB,CAACtmC,MAAD,CAAlD;AACAmgH,MAAAA,eAAe,CAACngH,MAAD,EAASpb,IAAT,EAAew7H,oBAAf,CAAf;AACD;AACF,GAND;;AAOA,MAAIa,iCAAiC,GAAG,UAAUjhH,MAAV,EAAkBq/G,YAAlB,EAAgCplF,GAAhC,EAAqC34C,SAArC,EAAgDslB,MAAhD,EAAwD;AAC9F,QAAI8yG,QAAJ,EAAcj7C,WAAd,EAA2Bl7D,SAA3B,EAAsC3e,IAAtC,EAA4C6e,IAA5C,EAAkDsnF,aAAlD;AACA,QAAI5jF,SAAS,GAAGk4G,YAAY,IAAI,GAAhC;AACA,QAAIr6H,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AAAA,QAAsBu5H,YAAY,GAAG2B,iBAAiB,CAACl7H,GAAD,EAAM1D,SAAN,CAAtD;AACAm9E,IAAAA,WAAW,GAAGz5E,GAAG,CAACurC,SAAJ,CAAcjvC,SAAd,EAAyB0D,GAAG,CAAC4f,OAA7B,CAAd;;AACA,QAAI,CAAC65D,WAAD,IAAgB,CAACmhD,aAAa,CAAC56H,GAAD,EAAMy5E,WAAN,CAAlC,EAAsD;AACpDA,MAAAA,WAAW,GAAGA,WAAW,IAAI8/C,YAA7B;;AACA,UAAI9/C,WAAW,KAAKz+D,MAAM,CAACo6B,OAAP,EAAhB,IAAoCqlF,aAAa,CAAChhD,WAAD,CAArD,EAAoE;AAClEssB,QAAAA,aAAa,GAAGtsB,WAAW,CAACh3E,QAAZ,CAAqBpM,WAArB,EAAhB;AACD,OAFD,MAEO;AACL0vG,QAAAA,aAAa,GAAGtsB,WAAW,CAACn2E,UAAZ,CAAuBb,QAAvB,CAAgCpM,WAAhC,EAAhB;AACD;;AACD,UAAI,CAACojF,WAAW,CAACp6E,aAAZ,EAAL,EAAkC;AAChCq1H,QAAAA,QAAQ,GAAG10H,GAAG,CAAC9C,MAAJ,CAAWilB,SAAX,CAAX;AACA65G,QAAAA,mBAAmB,CAAChhH,MAAD,EAAS05G,QAAT,CAAnB;AACAj7C,QAAAA,WAAW,CAACpzE,WAAZ,CAAwBquH,QAAxB;AACAz/E,QAAAA,GAAG,CAAC5G,QAAJ,CAAaqmF,QAAb,EAAuB,CAAvB;AACAz/E,QAAAA,GAAG,CAAC3G,MAAJ,CAAWomF,QAAX,EAAqB,CAArB;AACA,eAAOA,QAAP;AACD;;AACD90H,MAAAA,IAAI,GAAGtD,SAAP;;AACA,aAAOsD,IAAI,CAAC0D,UAAL,KAAoBm2E,WAA3B,EAAwC;AACtC75E,QAAAA,IAAI,GAAGA,IAAI,CAAC0D,UAAZ;AACD;;AACD,aAAO1D,IAAI,IAAI,CAACI,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAZ,CAAhB,EAAmC;AACjC2e,QAAAA,SAAS,GAAG3e,IAAZ;AACAA,QAAAA,IAAI,GAAGA,IAAI,CAACqE,eAAZ;AACD;;AACD,UAAIsa,SAAS,IAAIvD,MAAM,CAAC8M,MAAP,CAAcuH,YAAd,CAA2B02E,aAA3B,EAA0C5jF,SAAS,CAAC9rB,WAAV,EAA1C,CAAjB,EAAqF;AACnFq+H,QAAAA,QAAQ,GAAG10H,GAAG,CAAC9C,MAAJ,CAAWilB,SAAX,CAAX;AACA65G,QAAAA,mBAAmB,CAAChhH,MAAD,EAAS05G,QAAT,CAAnB;AACAn2G,QAAAA,SAAS,CAACjb,UAAV,CAAqByC,YAArB,CAAkC2uH,QAAlC,EAA4Cn2G,SAA5C;AACA3e,QAAAA,IAAI,GAAG2e,SAAP;;AACA,eAAO3e,IAAI,IAAI,CAACI,GAAG,CAAC4f,OAAJ,CAAYhgB,IAAZ,CAAhB,EAAmC;AACjC6e,UAAAA,IAAI,GAAG7e,IAAI,CAACsE,WAAZ;AACAwwH,UAAAA,QAAQ,CAACruH,WAAT,CAAqBzG,IAArB;AACAA,UAAAA,IAAI,GAAG6e,IAAP;AACD;;AACDw2B,QAAAA,GAAG,CAAC5G,QAAJ,CAAa/xC,SAAb,EAAwBslB,MAAxB;AACAqzB,QAAAA,GAAG,CAAC3G,MAAJ,CAAWhyC,SAAX,EAAsBslB,MAAtB;AACD;AACF;;AACD,WAAOtlB,SAAP;AACD,GA3CD;;AA4CA,MAAI4/H,oBAAoB,GAAG,UAAUl8H,GAAV,EAAeqhD,KAAf,EAAsB;AAC/CA,IAAAA,KAAK,CAAC4e,SAAN;AACA,QAAIz7D,SAAS,GAAG68C,KAAK,CAAC78C,SAAtB;;AACA,QAAI,CAACA,SAAD,IAAc,mBAAmB3P,IAAnB,CAAwBmL,GAAG,CAAC+qC,QAAJ,CAAavmC,SAAb,EAAwB,OAAxB,EAAiC,IAAjC,CAAxB,CAAlB,EAAmF;AACjFxE,MAAAA,GAAG,CAACqoB,GAAJ,CAAQg5B,KAAR,EAAe,IAAf;AACD;AACF,GAND;;AAOA,MAAI86E,QAAQ,GAAG,UAAUnhH,MAAV,EAAkBya,GAAlB,EAAuB;AACpC,QAAI6kG,MAAJ,EAAYh+H,SAAZ,EAAuBslB,MAAvB,EAA+B63D,WAA/B;AACA,QAAIi7C,QAAJ,EAAcx8E,QAAd,EAAwB+hF,cAAxB,EAAwCmC,eAAxC,EAAyD/B,YAAzD,EAAuEgC,0BAAvE;AACA,QAAIr8H,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,QAAI8nB,MAAM,GAAG9M,MAAM,CAAC8M,MAApB;AAAA,QAA4BwC,mBAAmB,GAAGxC,MAAM,CAACmH,mBAAP,EAAlD;AACA,QAAIgmB,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;;AACA,QAAIilF,cAAc,GAAG,UAAUtyI,IAAV,EAAgB;AACnC,UAAI8X,IAAI,GAAGtD,SAAX;AAAA,UAAsB+kD,KAAtB;AAAA,UAA6Bi7E,UAA7B;AAAA,UAAyCvV,SAAzC;AACA,UAAItmC,kBAAkB,GAAG34D,MAAM,CAACgH,qBAAP,EAAzB;;AACA,UAAIhnC,IAAI,IAAIs0I,eAAe,KAAK,OAA5B,IAAuCA,eAAe,KAAK,IAA/D,EAAqE;AACnE/6E,QAAAA,KAAK,GAAGrhD,GAAG,CAAC9C,MAAJ,CAAWpV,IAAI,IAAIuyI,YAAnB,CAAR;AACD,OAFD,MAEO;AACLh5E,QAAAA,KAAK,GAAGo4B,WAAW,CAAC50C,SAAZ,CAAsB,KAAtB,CAAR;AACD;;AACDkiF,MAAAA,SAAS,GAAG1lE,KAAZ;;AACA,UAAII,gBAAgB,CAACzmC,MAAD,CAAhB,KAA6B,KAAjC,EAAwC;AACtChb,QAAAA,GAAG,CAAC8pC,SAAJ,CAAcuX,KAAd,EAAqB,OAArB,EAA8B,IAA9B;AACArhD,QAAAA,GAAG,CAAC8pC,SAAJ,CAAcuX,KAAd,EAAqB,OAArB,EAA8B,IAA9B;AACD,OAHD,MAGO;AACL,WAAG;AACD,cAAIo/B,kBAAkB,CAAC7gF,IAAI,CAAC6C,QAAN,CAAtB,EAAuC;AACrC,gBAAIgqD,WAAW,CAAC7sD,IAAD,CAAX,IAAqBwuD,gBAAgB,CAACxuD,IAAD,CAAzC,EAAiD;AAC/C;AACD;;AACD08H,YAAAA,UAAU,GAAG18H,IAAI,CAACilC,SAAL,CAAe,KAAf,CAAb;AACA7kC,YAAAA,GAAG,CAAC8pC,SAAJ,CAAcwyF,UAAd,EAA0B,IAA1B,EAAgC,EAAhC;;AACA,gBAAIj7E,KAAK,CAAChiD,aAAN,EAAJ,EAA2B;AACzBi9H,cAAAA,UAAU,CAACj2H,WAAX,CAAuBg7C,KAAK,CAAC98C,UAA7B;AACA88C,cAAAA,KAAK,CAACh7C,WAAN,CAAkBi2H,UAAlB;AACD,aAHD,MAGO;AACLvV,cAAAA,SAAS,GAAGuV,UAAZ;AACAj7E,cAAAA,KAAK,CAACh7C,WAAN,CAAkBi2H,UAAlB;AACD;AACF;AACF,SAfD,QAeS,CAAC18H,IAAI,GAAGA,IAAI,CAAC0D,UAAb,KAA4B1D,IAAI,KAAK25H,YAf9C;AAgBD;;AACDyC,MAAAA,mBAAmB,CAAChhH,MAAD,EAASqmC,KAAT,CAAnB;AACAq5E,MAAAA,UAAU,CAAC3T,SAAD,CAAV;AACA,aAAO1lE,KAAP;AACD,KAjCD;;AAkCA,QAAIk7E,0BAA0B,GAAG,UAAU9kI,KAAV,EAAiB;AAChD,UAAImI,IAAJ,EAAU9X,IAAV;AACA,UAAI00I,gBAAgB,GAAGzB,mBAAmB,CAACtjI,KAAD,EAAQ6E,SAAR,EAAmBslB,MAAnB,CAA1C;;AACA,UAAIvW,QAAQ,CAAC/O,SAAD,CAAR,KAAwB7E,KAAK,GAAG+kI,gBAAgB,GAAG,CAAtB,GAA0BA,gBAAgB,GAAGlgI,SAAS,CAACkhC,SAAV,CAAoBx0C,MAA9F,CAAJ,EAA2G;AACzG,eAAO,KAAP;AACD;;AACD,UAAIsT,SAAS,CAACgH,UAAV,KAAyBm2E,WAAzB,IAAwC4iD,0BAAxC,IAAsE,CAAC5kI,KAA3E,EAAkF;AAChF,eAAO,IAAP;AACD;;AACD,UAAIA,KAAK,IAAIwS,WAAW,CAAC3N,SAAD,CAApB,IAAmCA,SAAS,KAAKm9E,WAAW,CAACl1E,UAAjE,EAA6E;AAC3E,eAAO,IAAP;AACD;;AACD,UAAIo2H,uBAAuB,CAACr+H,SAAD,EAAY,OAAZ,CAAvB,IAA+Cq+H,uBAAuB,CAACr+H,SAAD,EAAY,IAAZ,CAA1E,EAA6F;AAC3F,eAAO+/H,0BAA0B,IAAI,CAAC5kI,KAA/B,IAAwC,CAAC4kI,0BAAD,IAA+B5kI,KAA9E;AACD;;AACD,UAAIitB,MAAM,GAAG,IAAIpG,aAAJ,CAAkBhiB,SAAlB,EAA6Bm9E,WAA7B,CAAb;;AACA,UAAIpuE,QAAQ,CAAC/O,SAAD,CAAZ,EAAyB;AACvB,YAAI7E,KAAK,IAAI+kI,gBAAgB,KAAK,CAAlC,EAAqC;AACnC93G,UAAAA,MAAM,CAAChG,IAAP;AACD,SAFD,MAEO,IAAI,CAACjnB,KAAD,IAAU+kI,gBAAgB,KAAKlgI,SAAS,CAACkhC,SAAV,CAAoBx0C,MAAvD,EAA+D;AACpE07B,UAAAA,MAAM,CAACjG,IAAP;AACD;AACF;;AACD,aAAO7e,IAAI,GAAG8kB,MAAM,CAAC3tB,OAAP,EAAd,EAAgC;AAC9B,YAAIkT,WAAW,CAACrK,IAAD,CAAf,EAAuB;AACrB,cAAI,CAACA,IAAI,CAACkL,YAAL,CAAkB,gBAAlB,CAAL,EAA0C;AACxChjB,YAAAA,IAAI,GAAG8X,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,EAAP;;AACA,gBAAIi0B,mBAAmB,CAACxiC,IAAD,CAAnB,IAA6BA,IAAI,KAAK,IAA1C,EAAgD;AAC9C,qBAAO,KAAP;AACD;AACF;AACF,SAPD,MAOO,IAAIujB,QAAQ,CAACzL,IAAD,CAAR,IAAkB,CAACikB,gBAAgB,CAACjkB,IAAI,CAAC49B,SAAN,CAAvC,EAAyD;AAC9D,iBAAO,KAAP;AACD;;AACD,YAAI/lC,KAAJ,EAAW;AACTitB,UAAAA,MAAM,CAAChG,IAAP;AACD,SAFD,MAEO;AACLgG,UAAAA,MAAM,CAACjG,IAAP;AACD;AACF;;AACD,aAAO,IAAP;AACD,KAzCD;;AA0CA,QAAIg+G,mBAAmB,GAAG,YAAY;AACpC,UAAI,wBAAwB5nI,IAAxB,CAA6BunI,eAA7B,KAAiDM,kBAAkB,KAAK,QAA5E,EAAsF;AACpFhI,QAAAA,QAAQ,GAAG0F,cAAc,CAACC,YAAD,CAAzB;AACD,OAFD,MAEO;AACL3F,QAAAA,QAAQ,GAAG0F,cAAc,EAAzB;AACD;;AACD,UAAI14E,8BAA8B,CAAC1mC,MAAD,CAA9B,IAA0C4/G,aAAa,CAAC56H,GAAD,EAAMi6H,cAAN,CAAvD,IAAgFj6H,GAAG,CAAC2kB,OAAJ,CAAY80D,WAAZ,CAApF,EAA8G;AAC5Gi7C,QAAAA,QAAQ,GAAG10H,GAAG,CAACjD,KAAJ,CAAUk9H,cAAV,EAA0BxgD,WAA1B,CAAX;AACD,OAFD,MAEO;AACLz5E,QAAAA,GAAG,CAACktC,WAAJ,CAAgBwnF,QAAhB,EAA0Bj7C,WAA1B;AACD;;AACD4/C,MAAAA,mBAAmB,CAACr+G,MAAD,EAAS05G,QAAT,CAAnB;AACD,KAZD;;AAaAz0D,IAAAA,SAAS,CAACjgE,GAAD,EAAMi1C,GAAN,CAAT,CAAoBroD,IAApB,CAAyB,UAAUszE,OAAV,EAAmB;AAC1CjrB,MAAAA,GAAG,CAAC5G,QAAJ,CAAa6xB,OAAO,CAACt9C,cAArB,EAAqCs9C,OAAO,CAACpxB,WAA7C;AACAmG,MAAAA,GAAG,CAAC3G,MAAJ,CAAW4xB,OAAO,CAACnxB,YAAnB,EAAiCmxB,OAAO,CAAClxB,SAAzC;AACD,KAHD;AAIA1yC,IAAAA,SAAS,GAAG24C,GAAG,CAACryB,cAAhB;AACAhB,IAAAA,MAAM,GAAGqzB,GAAG,CAACnG,WAAb;AACAurF,IAAAA,YAAY,GAAGj5E,kBAAkB,CAACpmC,MAAD,CAAjC;AACA,QAAIk+C,QAAQ,GAAG,CAAC,EAAEzjC,GAAG,IAAIA,GAAG,CAACyjC,QAAb,CAAhB;AACA,QAAIC,OAAO,GAAG,CAAC,EAAE1jC,GAAG,IAAIA,GAAG,CAAC0jC,OAAb,CAAf;;AACA,QAAIlvD,WAAW,CAAC3N,SAAD,CAAX,IAA0BA,SAAS,CAAC+C,aAAV,EAA9B,EAAyD;AACvDg9H,MAAAA,0BAA0B,GAAGz6G,MAAM,GAAGtlB,SAAS,CAACgD,UAAV,CAAqBtW,MAArB,GAA8B,CAApE;AACAsT,MAAAA,SAAS,GAAGA,SAAS,CAACgD,UAAV,CAAqBoK,IAAI,CAACswC,GAAL,CAASp4B,MAAT,EAAiBtlB,SAAS,CAACgD,UAAV,CAAqBtW,MAArB,GAA8B,CAA/C,CAArB,KAA2EsT,SAAvF;;AACA,UAAI+/H,0BAA0B,IAAIhxH,QAAQ,CAAC/O,SAAD,CAA1C,EAAuD;AACrDslB,QAAAA,MAAM,GAAGtlB,SAAS,CAACkhC,SAAV,CAAoBx0C,MAA7B;AACD,OAFD,MAEO;AACL44B,QAAAA,MAAM,GAAG,CAAT;AACD;AACF;;AACD,QAAI23G,YAAY,GAAG2B,iBAAiB,CAACl7H,GAAD,EAAM1D,SAAN,CAApC;;AACA,QAAI,CAACi9H,YAAL,EAAmB;AACjB;AACD;;AACD,QAAIc,YAAY,IAAI,CAACnhE,QAAjB,IAA6B,CAACmhE,YAAD,IAAiBnhE,QAAlD,EAA4D;AAC1D58D,MAAAA,SAAS,GAAG2/H,iCAAiC,CAACjhH,MAAD,EAASq/G,YAAT,EAAuBplF,GAAvB,EAA4B34C,SAA5B,EAAuCslB,MAAvC,CAA7C;AACD;;AACD63D,IAAAA,WAAW,GAAGz5E,GAAG,CAACurC,SAAJ,CAAcjvC,SAAd,EAAyB0D,GAAG,CAAC4f,OAA7B,CAAd;AACAq6G,IAAAA,cAAc,GAAGxgD,WAAW,GAAGz5E,GAAG,CAACurC,SAAJ,CAAckuC,WAAW,CAACn2E,UAA1B,EAAsCtD,GAAG,CAAC4f,OAA1C,CAAH,GAAwD,IAApF;AACAw8G,IAAAA,eAAe,GAAG3iD,WAAW,GAAGA,WAAW,CAACh3E,QAAZ,CAAqBsmB,WAArB,EAAH,GAAwC,EAArE;AACA,QAAI2zG,kBAAkB,GAAGzC,cAAc,GAAGA,cAAc,CAACx3H,QAAf,CAAwBsmB,WAAxB,EAAH,GAA2C,EAAlF;;AACA,QAAI2zG,kBAAkB,KAAK,IAAvB,IAA+B,CAACvjE,OAApC,EAA6C;AAC3CsgB,MAAAA,WAAW,GAAGwgD,cAAd;AACAA,MAAAA,cAAc,GAAGA,cAAc,CAAC32H,UAAhC;AACA84H,MAAAA,eAAe,GAAGM,kBAAlB;AACD;;AACD,QAAI,eAAe7nI,IAAf,CAAoBunI,eAApB,CAAJ,EAA0C;AACxC,UAAIp8H,GAAG,CAAC2kB,OAAJ,CAAY80D,WAAZ,CAAJ,EAA8B;AAC5BzO,QAAAA,MAAM,CAAChwD,MAAD,EAASo/G,cAAT,EAAyBH,cAAzB,EAAyCxgD,WAAzC,EAAsD4gD,YAAtD,CAAN;AACA;AACD;AACF;;AACD,QAAIA,YAAY,IAAI5gD,WAAW,KAAKz+D,MAAM,CAACo6B,OAAP,EAApC,EAAsD;AACpD;AACD;;AACDilF,IAAAA,YAAY,GAAGA,YAAY,IAAI,GAA/B;;AACA,QAAIp5G,qBAAqB,CAACw4D,WAAD,CAAzB,EAAwC;AACtCi7C,MAAAA,QAAQ,GAAGjyG,uBAAuB,CAACg3D,WAAD,CAAlC;;AACA,UAAIz5E,GAAG,CAAC2kB,OAAJ,CAAY80D,WAAZ,CAAJ,EAA8B;AAC5BihD,QAAAA,UAAU,CAACjhD,WAAD,CAAV;AACD;;AACDuiD,MAAAA,mBAAmB,CAAChhH,MAAD,EAAS05G,QAAT,CAAnB;AACA2E,MAAAA,mBAAmB,CAACr+G,MAAD,EAAS05G,QAAT,CAAnB;AACD,KAPD,MAOO,IAAI6H,0BAA0B,EAA9B,EAAkC;AACvCE,MAAAA,mBAAmB;AACpB,KAFM,MAEA,IAAIF,0BAA0B,CAAC,IAAD,CAA9B,EAAsC;AAC3C7H,MAAAA,QAAQ,GAAGj7C,WAAW,CAACn2E,UAAZ,CAAuByC,YAAvB,CAAoCq0H,cAAc,EAAlD,EAAsD3gD,WAAtD,CAAX;AACA4/C,MAAAA,mBAAmB,CAACr+G,MAAD,EAAS2/G,uBAAuB,CAAClhD,WAAD,EAAc,IAAd,CAAvB,GAA6Ci7C,QAA7C,GAAwDj7C,WAAjE,CAAnB;AACD,KAHM,MAGA;AACL6gD,MAAAA,MAAM,GAAGU,kBAAkB,CAAC/lF,GAAD,CAAlB,CAAwBgH,UAAxB,EAAT;AACAq+E,MAAAA,MAAM,CAACp+E,WAAP,CAAmBu9B,WAAnB;AACAvhC,MAAAA,QAAQ,GAAGoiF,MAAM,CAAC/rF,eAAP,EAAX;AACAgsF,MAAAA,QAAQ,CAACriF,QAAD,CAAR;AACA+iF,MAAAA,qBAAqB,CAAC/iF,QAAD,CAArB;AACAw8E,MAAAA,QAAQ,GAAGx8E,QAAQ,CAAC3zC,UAApB;AACAvE,MAAAA,GAAG,CAACktC,WAAJ,CAAgBgL,QAAhB,EAA0BuhC,WAA1B;AACAohD,MAAAA,mCAAmC,CAAC76H,GAAD,EAAMsqB,mBAAN,EAA2BoqG,QAA3B,CAAnC;AACAwH,MAAAA,oBAAoB,CAACl8H,GAAD,EAAMy5E,WAAN,CAApB;;AACA,UAAIz5E,GAAG,CAAC2kB,OAAJ,CAAY80D,WAAZ,CAAJ,EAA8B;AAC5BihD,QAAAA,UAAU,CAACjhD,WAAD,CAAV;AACD;;AACDi7C,MAAAA,QAAQ,CAACz0D,SAAT;;AACA,UAAIjgE,GAAG,CAAC2kB,OAAJ,CAAY+vG,QAAZ,CAAJ,EAA2B;AACzB10H,QAAAA,GAAG,CAAC6G,MAAJ,CAAW6tH,QAAX;AACA+H,QAAAA,mBAAmB;AACpB,OAHD,MAGO;AACLT,QAAAA,mBAAmB,CAAChhH,MAAD,EAAS05G,QAAT,CAAnB;AACA2E,QAAAA,mBAAmB,CAACr+G,MAAD,EAAS05G,QAAT,CAAnB;AACD;AACF;;AACD10H,IAAAA,GAAG,CAAC8pC,SAAJ,CAAc4qF,QAAd,EAAwB,IAAxB,EAA8B,EAA9B;AACA15G,IAAAA,MAAM,CAACmb,IAAP,CAAY,UAAZ,EAAwB;AAAEu+F,MAAAA,QAAQ,EAAEA;AAAZ,KAAxB;AACD,GA/KD;;AAiLA,MAAIiI,mBAAmB,GAAG,UAAU70G,MAAV,EAAkBxrB,SAAlB,EAA6Bm9E,WAA7B,EAA0C;AAClE,QAAI/0D,MAAM,GAAG,IAAIpG,aAAJ,CAAkBhiB,SAAlB,EAA6Bm9E,WAA7B,CAAb;AACA,QAAI75E,IAAJ;AACA,QAAI0qB,mBAAmB,GAAGxC,MAAM,CAACmH,mBAAP,EAA1B;;AACA,WAAOrvB,IAAI,GAAG8kB,MAAM,CAACjG,IAAP,EAAd,EAA6B;AAC3B,UAAI6L,mBAAmB,CAAC1qB,IAAI,CAAC6C,QAAL,CAAcpM,WAAd,EAAD,CAAnB,IAAoDuJ,IAAI,CAAC5W,MAAL,GAAc,CAAtE,EAAyE;AACvE,eAAO,IAAP;AACD;AACF;AACF,GATD;;AAUA,MAAI4zI,iBAAiB,GAAG,UAAU5hH,MAAV,EAAkB6hH,KAAlB,EAAyBC,OAAzB,EAAkC;AACxD,QAAI7nF,GAAG,GAAGj6B,MAAM,CAAChb,GAAP,CAAW+tC,SAAX,EAAV;;AACA,QAAI,CAAC+uF,OAAL,EAAc;AACZ7nF,MAAAA,GAAG,CAACgU,aAAJ,CAAkB4zE,KAAlB;AACA5nF,MAAAA,GAAG,CAACiH,WAAJ,CAAgB2gF,KAAhB;AACD,KAHD,MAGO;AACL5nF,MAAAA,GAAG,CAAC8T,cAAJ,CAAmB8zE,KAAnB;AACA5nF,MAAAA,GAAG,CAAC+T,YAAJ,CAAiB6zE,KAAjB;AACD;;AACD7hH,IAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB;AACAovB,IAAAA,mBAAmB,CAACrpD,MAAD,EAASi6B,GAAT,CAAnB;AACD,GAXD;;AAYA,MAAI8nF,eAAe,GAAG,UAAU/hH,MAAV,EAAkBya,GAAlB,EAAuB;AAC3C,QAAIyf,SAAS,GAAGl6B,MAAM,CAACk6B,SAAvB;AACA,QAAIl1C,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,QAAIi1C,GAAG,GAAGC,SAAS,CAACC,MAAV,EAAV;AACA,QAAI0nF,KAAJ;AACA,QAAIC,OAAJ;AACA78D,IAAAA,SAAS,CAACjgE,GAAD,EAAMi1C,GAAN,CAAT,CAAoBroD,IAApB,CAAyB,UAAUszE,OAAV,EAAmB;AAC1CjrB,MAAAA,GAAG,CAAC5G,QAAJ,CAAa6xB,OAAO,CAACt9C,cAArB,EAAqCs9C,OAAO,CAACpxB,WAA7C;AACAmG,MAAAA,GAAG,CAAC3G,MAAJ,CAAW4xB,OAAO,CAACnxB,YAAnB,EAAiCmxB,OAAO,CAAClxB,SAAzC;AACD,KAHD;AAIA,QAAIptB,MAAM,GAAGqzB,GAAG,CAACnG,WAAjB;AACA,QAAIxyC,SAAS,GAAG24C,GAAG,CAACryB,cAApB;;AACA,QAAItmB,SAAS,CAAC8E,QAAV,KAAuB,CAAvB,IAA4B9E,SAAS,CAAC+C,aAAV,EAAhC,EAA2D;AACzD,UAAIg9H,0BAA0B,GAAGz6G,MAAM,GAAGtlB,SAAS,CAACgD,UAAV,CAAqBtW,MAArB,GAA8B,CAAxE;AACAsT,MAAAA,SAAS,GAAGA,SAAS,CAACgD,UAAV,CAAqBoK,IAAI,CAACswC,GAAL,CAASp4B,MAAT,EAAiBtlB,SAAS,CAACgD,UAAV,CAAqBtW,MAArB,GAA8B,CAA/C,CAArB,KAA2EsT,SAAvF;;AACA,UAAI+/H,0BAA0B,IAAI//H,SAAS,CAAC8E,QAAV,KAAuB,CAAzD,EAA4D;AAC1DwgB,QAAAA,MAAM,GAAGtlB,SAAS,CAACkhC,SAAV,CAAoBx0C,MAA7B;AACD,OAFD,MAEO;AACL44B,QAAAA,MAAM,GAAG,CAAT;AACD;AACF;;AACD,QAAI63D,WAAW,GAAGz5E,GAAG,CAACurC,SAAJ,CAAcjvC,SAAd,EAAyB0D,GAAG,CAAC4f,OAA7B,CAAlB;AACA,QAAIq6G,cAAc,GAAGxgD,WAAW,GAAGz5E,GAAG,CAACurC,SAAJ,CAAckuC,WAAW,CAACn2E,UAA1B,EAAsCtD,GAAG,CAAC4f,OAA1C,CAAH,GAAwD,IAAxF;AACA,QAAI88G,kBAAkB,GAAGzC,cAAc,GAAGA,cAAc,CAACx3H,QAAf,CAAwBsmB,WAAxB,EAAH,GAA2C,EAAlF;AACA,QAAIi0G,YAAY,GAAG,CAAC,EAAEvnG,GAAG,IAAIA,GAAG,CAAC0jC,OAAb,CAApB;;AACA,QAAIujE,kBAAkB,KAAK,IAAvB,IAA+B,CAACM,YAApC,EAAkD;AAChDvjD,MAAAA,WAAW,GAAGwgD,cAAd;AACD;;AACD,QAAI39H,SAAS,IAAIA,SAAS,CAAC8E,QAAV,KAAuB,CAApC,IAAyCwgB,MAAM,IAAItlB,SAAS,CAACkhC,SAAV,CAAoBx0C,MAA3E,EAAmF;AACjF,UAAI,CAAC2zI,mBAAmB,CAAC3hH,MAAM,CAAC8M,MAAR,EAAgBxrB,SAAhB,EAA2Bm9E,WAA3B,CAAxB,EAAiE;AAC/DojD,QAAAA,KAAK,GAAG78H,GAAG,CAAC9C,MAAJ,CAAW,IAAX,CAAR;AACA+3C,QAAAA,GAAG,CAACsI,UAAJ,CAAes/E,KAAf;AACA5nF,QAAAA,GAAG,CAACgU,aAAJ,CAAkB4zE,KAAlB;AACA5nF,QAAAA,GAAG,CAACiH,WAAJ,CAAgB2gF,KAAhB;AACAC,QAAAA,OAAO,GAAG,IAAV;AACD;AACF;;AACDD,IAAAA,KAAK,GAAG78H,GAAG,CAAC9C,MAAJ,CAAW,IAAX,CAAR;AACAugD,IAAAA,eAAe,CAACz9C,GAAD,EAAMi1C,GAAN,EAAW4nF,KAAX,CAAf;AACAD,IAAAA,iBAAiB,CAAC5hH,MAAD,EAAS6hH,KAAT,EAAgBC,OAAhB,CAAjB;AACA9hH,IAAAA,MAAM,CAAC27C,WAAP,CAAmBtuC,GAAnB;AACD,GAzCD;;AA0CA,MAAI40G,cAAc,GAAG,UAAUjiH,MAAV,EAAkB+R,MAAlB,EAA0B;AAC7C,QAAI9K,EAAE,GAAG7hB,YAAY,CAACV,OAAb,CAAqB,IAArB,CAAT;AACAkG,IAAAA,MAAM,CAACxF,YAAY,CAACX,OAAb,CAAqBstB,MAArB,CAAD,EAA+B9K,EAA/B,CAAN;AACAjH,IAAAA,MAAM,CAAC27C,WAAP,CAAmBtuC,GAAnB;AACD,GAJD;;AAKA,MAAI60G,aAAa,GAAG,UAAUliH,MAAV,EAAkB+R,MAAlB,EAA0B;AAC5C,QAAI,CAACowG,UAAU,CAACniH,MAAM,CAACo6B,OAAP,EAAD,EAAmBroB,MAAnB,CAAf,EAA2C;AACzC/mB,MAAAA,KAAK,CAAC5F,YAAY,CAACX,OAAb,CAAqBstB,MAArB,CAAD,EAA+B3sB,YAAY,CAACV,OAAb,CAAqB,IAArB,CAA/B,CAAL;AACD;;AACD,QAAIuiB,EAAE,GAAG7hB,YAAY,CAACV,OAAb,CAAqB,IAArB,CAAT;AACAsG,IAAAA,KAAK,CAAC5F,YAAY,CAACX,OAAb,CAAqBstB,MAArB,CAAD,EAA+B9K,EAA/B,CAAL;AACA26G,IAAAA,iBAAiB,CAAC5hH,MAAD,EAASiH,EAAE,CAACjiB,GAAZ,EAAiB,KAAjB,CAAjB;AACAgb,IAAAA,MAAM,CAAC27C,WAAP,CAAmBtuC,GAAnB;AACD,GARD;;AASA,MAAI+0G,YAAY,GAAG,UAAU3uH,GAAV,EAAe;AAChC,WAAOhD,IAAI,CAACgD,GAAG,CAAC6rC,OAAJ,EAAD,CAAX;AACD,GAFD;;AAGA,MAAI6iF,UAAU,GAAG,UAAU3+G,QAAV,EAAoBD,SAApB,EAA+B;AAC9C,QAAI6+G,YAAY,CAACvgF,aAAa,CAAC72C,KAAd,CAAoBuY,SAApB,CAAD,CAAhB,EAAkD;AAChD,aAAO,IAAP;AACD,KAFD,MAEO;AACL,aAAO6tC,YAAY,CAAC5tC,QAAD,EAAWq+B,aAAa,CAAC72C,KAAd,CAAoBuY,SAApB,CAAX,CAAZ,CAAuD5xB,GAAvD,CAA2D,UAAU8hB,GAAV,EAAe;AAC/E,eAAOhD,IAAI,CAACgD,GAAG,CAAC6rC,OAAJ,EAAD,CAAX;AACD,OAFM,EAEJluD,KAFI,CAEE,KAFF,CAAP;AAGD;AACF,GARD;;AASA,MAAIixI,YAAY,GAAG,UAAUtvH,GAAV,EAAe;AAChC,WAAOA,GAAG,IAAIA,GAAG,CAACtL,QAAJ,KAAiB,GAAxB,IAA+B,UAAUsL,GAAhD;AACD,GAFD;;AAGA,MAAIuvH,cAAc,GAAG,UAAUj+F,QAAV,EAAoB;AACvC,WAAOA,QAAQ,CAACrzC,IAAT,CAAcV,KAAd,EAAqB+xI,YAArB,EAAmCA,YAAnC,EAAiD/xI,KAAjD,CAAP;AACD,GAFD;;AAGA,MAAIiyI,wBAAwB,GAAG,UAAUviH,MAAV,EAAkB;AAC/C,QAAIquG,gBAAgB,GAAGz+H,KAAK,CAAC20H,cAAD,EAAiBvkG,MAAjB,CAA5B;AACA,QAAIwwC,QAAQ,GAAG3O,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAf;AACA,WAAOwyE,YAAY,CAAC0B,gBAAD,EAAmBruG,MAAM,CAACo6B,OAAP,EAAnB,EAAqCoW,QAArC,CAAZ,CAA2Dx+D,MAA3D,CAAkEswI,cAAlE,CAAP;AACD,GAJD;;AAKA,MAAIE,qBAAqB,GAAG,UAAUxiH,MAAV,EAAkBqkB,QAAlB,EAA4B;AACtDA,IAAAA,QAAQ,CAACrzC,IAAT,CAAcnC,IAAd,EAAoBe,KAAK,CAACqyI,cAAD,EAAiBjiH,MAAjB,CAAzB,EAAmDpwB,KAAK,CAACsyI,aAAD,EAAgBliH,MAAhB,CAAxD,EAAiFnxB,IAAjF;AACD,GAFD;;AAGA,MAAI4zI,QAAQ,GAAG,UAAUziH,MAAV,EAAkBya,GAAlB,EAAuB;AACpC,QAAIioG,cAAc,GAAGH,wBAAwB,CAACviH,MAAD,CAA7C;;AACA,QAAI0iH,cAAc,CAACvxI,MAAf,EAAJ,EAA6B;AAC3BuxI,MAAAA,cAAc,CAAC9wI,IAAf,CAAoBhC,KAAK,CAAC4yI,qBAAD,EAAwBxiH,MAAxB,CAAzB;AACD,KAFD,MAEO;AACL+hH,MAAAA,eAAe,CAAC/hH,MAAD,EAASya,GAAT,CAAf;AACD;AACF,GAPD;;AASA,MAAIuH,eAAe,GAAG,UAAUhiB,MAAV,EAAkB7Z,QAAlB,EAA4B;AAChD,WAAOq4H,gBAAgB,CAACx+G,MAAD,CAAhB,CAAyBhuB,MAAzB,CAAgC,UAAUysF,WAAV,EAAuB;AAC5D,aAAOt4E,QAAQ,CAACnY,MAAT,GAAkB,CAAlB,IAAuBiY,IAAI,CAACb,YAAY,CAACX,OAAb,CAAqBg6E,WAArB,CAAD,EAAoCt4E,QAApC,CAAlC;AACD,KAFM,EAEJhV,MAFI,EAAP;AAGD,GAJD;;AAKA,MAAIwxI,cAAc,GAAG,UAAU3iH,MAAV,EAAkB;AACrC,WAAOgiB,eAAe,CAAChiB,MAAD,EAASumC,oBAAoB,CAACvmC,MAAD,CAA7B,CAAtB;AACD,GAFD;;AAGA,MAAI4iH,kBAAkB,GAAG,UAAU5iH,MAAV,EAAkB;AACzC,WAAOgiB,eAAe,CAAChiB,MAAD,EAASwmC,oBAAoB,CAACxmC,MAAD,CAA7B,CAAtB;AACD,GAFD;;AAIA,MAAI6iH,aAAa,GAAG/kH,GAAG,CAAChB,QAAJ,CAAa,CAC/B;AAAEmK,IAAAA,EAAE,EAAE;AAAN,GAD+B,EAE/B;AAAEo/B,IAAAA,KAAK,EAAE;AAAT,GAF+B,EAG/B;AAAE71D,IAAAA,IAAI,EAAE;AAAR,GAH+B,CAAb,CAApB;;AAKA,MAAIsyI,oBAAoB,GAAG,UAAU9iH,MAAV,EAAkB+iH,SAAlB,EAA6B;AACtD,WAAOH,kBAAkB,CAAC5iH,MAAD,CAAzB;AACD,GAFD;;AAGA,MAAIgjH,QAAQ,GAAG,UAAUC,aAAV,EAAyB;AACtC,WAAO,UAAUjjH,MAAV,EAAkB+iH,SAAlB,EAA6B;AAClC,UAAIG,MAAM,GAAG98E,kBAAkB,CAACpmC,MAAD,CAAlB,KAA+B,EAA5C;AACA,aAAOkjH,MAAM,KAAKD,aAAlB;AACD,KAHD;AAID,GALD;;AAMA,MAAIE,WAAW,GAAG,UAAUF,aAAV,EAAyB;AACzC,WAAO,UAAUjjH,MAAV,EAAkB+iH,SAAlB,EAA6B;AAClC,aAAOrE,qBAAqB,CAAC1+G,MAAD,CAArB,KAAkCijH,aAAzC;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIG,OAAO,GAAG,UAAUj8G,SAAV,EAAqB87G,aAArB,EAAoC;AAChD,WAAO,UAAUjjH,MAAV,EAAkB+iH,SAAlB,EAA6B;AAClC,UAAIvhH,KAAK,GAAGi9G,kBAAkB,CAACz+G,MAAD,CAAlB,KAA+BmH,SAAS,CAAC4G,WAAV,EAA3C;AACA,aAAOvM,KAAK,KAAKyhH,aAAjB;AACD,KAHD;AAID,GALD;;AAMA,MAAII,UAAU,GAAG,UAAUJ,aAAV,EAAyB;AACxC,WAAOG,OAAO,CAAC,KAAD,EAAQH,aAAR,CAAd;AACD,GAFD;;AAGA,MAAIK,cAAc,GAAG,YAAY;AAC/B,WAAOF,OAAO,CAAC,SAAD,EAAY,IAAZ,CAAd;AACD,GAFD;;AAGA,MAAIG,kBAAkB,GAAG,UAAUN,aAAV,EAAyB;AAChD,WAAO,UAAUjjH,MAAV,EAAkB+iH,SAAlB,EAA6B;AAClC,aAAO58E,gBAAgB,CAACnmC,MAAD,CAAhB,KAA6BijH,aAApC;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIO,WAAW,GAAG,UAAUxjH,MAAV,EAAkB+iH,SAAlB,EAA6B;AAC7C,WAAOJ,cAAc,CAAC3iH,MAAD,CAArB;AACD,GAFD;;AAGA,MAAIyjH,WAAW,GAAG,UAAUC,OAAV,EAAmBxlE,QAAnB,EAA6B;AAC7C,WAAOA,QAAP;AACD,GAFD;;AAGA,MAAIylE,yBAAyB,GAAG,UAAU3jH,MAAV,EAAkB;AAChD,QAAIovE,eAAe,GAAGhpC,kBAAkB,CAACpmC,MAAD,CAAxC;AACA,QAAI4jH,YAAY,GAAGtF,eAAe,CAACt+G,MAAM,CAAChb,GAAR,EAAagb,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,EAAb,CAAlC;AACA,WAAOkhE,YAAY,IAAI5jH,MAAM,CAAC8M,MAAP,CAAcuH,YAAd,CAA2BuvG,YAAY,CAACn8H,QAAxC,EAAkD2nF,eAAe,GAAGA,eAAH,GAAqB,GAAtF,CAAvB;AACD,GAJD;;AAKA,MAAIy0C,OAAO,GAAG,UAAUC,UAAV,EAAsBtiD,MAAtB,EAA8B;AAC1C,WAAO,UAAUxhE,MAAV,EAAkBk+C,QAAlB,EAA4B;AACjC,UAAI6lE,OAAO,GAAGlvI,KAAK,CAACivI,UAAD,EAAa,UAAUvrH,GAAV,EAAe5f,CAAf,EAAkB;AAChD,eAAO4f,GAAG,IAAI5f,CAAC,CAACqnB,MAAD,EAASk+C,QAAT,CAAf;AACD,OAFkB,EAEhB,IAFgB,CAAnB;AAGA,aAAO6lE,OAAO,GAAGlxI,QAAQ,CAACR,IAAT,CAAcmvF,MAAd,CAAH,GAA2B3uF,QAAQ,CAACrC,IAAT,EAAzC;AACD,KALD;AAMD,GAPD;;AAQA,MAAIwzI,WAAW,GAAG,UAAUhkH,MAAV,EAAkBya,GAAlB,EAAuB;AACvC,WAAOwxF,aAAa,CAAC,CACnB4X,OAAO,CAAC,CAACf,oBAAD,CAAD,EAAyBD,aAAa,CAACryI,IAAd,EAAzB,CADY,EAEnBqzI,OAAO,CAAC,CAACP,cAAc,EAAf,CAAD,EAAqBT,aAAa,CAAC57G,EAAd,EAArB,CAFY,EAGnB48G,OAAO,CAAC,CACNR,UAAU,CAAC,IAAD,CADJ,EAENE,kBAAkB,CAAC,KAAD,CAFZ,EAGNE,WAHM,CAAD,EAIJZ,aAAa,CAAC57G,EAAd,EAJI,CAHY,EAQnB48G,OAAO,CAAC,CACNR,UAAU,CAAC,IAAD,CADJ,EAENE,kBAAkB,CAAC,KAAD,CAFZ,CAAD,EAGJV,aAAa,CAACx8E,KAAd,EAHI,CARY,EAYnBw9E,OAAO,CAAC,CACNR,UAAU,CAAC,IAAD,CADJ,EAENE,kBAAkB,CAAC,IAAD,CAFZ,EAGNE,WAHM,CAAD,EAIJZ,aAAa,CAACx8E,KAAd,EAJI,CAZY,EAiBnBw9E,OAAO,CAAC,CACNR,UAAU,CAAC,IAAD,CADJ,EAENE,kBAAkB,CAAC,IAAD,CAFZ,CAAD,EAGJV,aAAa,CAAC57G,EAAd,EAHI,CAjBY,EAqBnB48G,OAAO,CAAC,CACNV,WAAW,CAAC,IAAD,CADL,EAENM,WAFM,CAAD,EAGJZ,aAAa,CAAC57G,EAAd,EAHI,CArBY,EAyBnB48G,OAAO,CAAC,CAACV,WAAW,CAAC,IAAD,CAAZ,CAAD,EAAsBN,aAAa,CAACx8E,KAAd,EAAtB,CAzBY,EA0BnBw9E,OAAO,CAAC,CACNb,QAAQ,CAAC,IAAD,CADF,EAENS,WAFM,EAGNE,yBAHM,CAAD,EAIJd,aAAa,CAACx8E,KAAd,EAJI,CA1BY,EA+BnBw9E,OAAO,CAAC,CAACb,QAAQ,CAAC,IAAD,CAAT,CAAD,EAAmBH,aAAa,CAAC57G,EAAd,EAAnB,CA/BY,EAgCnB48G,OAAO,CAAC,CAACL,WAAD,CAAD,EAAgBX,aAAa,CAAC57G,EAAd,EAAhB,CAhCY,EAiCnB48G,OAAO,CAAC,CACNb,QAAQ,CAAC,KAAD,CADF,EAENS,WAFM,CAAD,EAGJZ,aAAa,CAAC57G,EAAd,EAHI,CAjCY,EAqCnB48G,OAAO,CAAC,CAACF,yBAAD,CAAD,EAA8Bd,aAAa,CAACx8E,KAAd,EAA9B,CArCY,CAAD,EAsCjB,CACDrmC,MADC,EAED,CAAC,EAAEya,GAAG,IAAIA,GAAG,CAACyjC,QAAb,CAFA,CAtCiB,CAAb,CAyCJ9sE,KAzCI,CAyCEyxI,aAAa,CAACryI,IAAd,EAzCF,CAAP;AA0CD,GA3CD;;AA6CA,MAAIyzI,QAAQ,GAAG,UAAUjkH,MAAV,EAAkBya,GAAlB,EAAuB;AACpCupG,IAAAA,WAAW,CAAChkH,MAAD,EAASya,GAAT,CAAX,CAAyBzpC,IAAzB,CAA8B,YAAY;AACxCyxI,MAAAA,QAAQ,CAACziH,MAAD,EAASya,GAAT,CAAR;AACD,KAFD,EAEG,YAAY;AACb0mG,MAAAA,QAAQ,CAACnhH,MAAD,EAASya,GAAT,CAAR;AACD,KAJD,EAIG5rC,IAJH;AAKD,GAND;;AAQA,MAAIq1I,mBAAmB,GAAG,UAAUlkH,MAAV,EAAkB1V,KAAlB,EAAyB;AACjD,QAAIA,KAAK,CAACytB,kBAAN,EAAJ,EAAgC;AAC9B;AACD;;AACDztB,IAAAA,KAAK,CAAC4uB,cAAN;AACAgjE,IAAAA,yBAAyB,CAACl8E,MAAM,CAAC27C,WAAR,CAAzB;AACA37C,IAAAA,MAAM,CAAC27C,WAAP,CAAmBC,QAAnB,CAA4B,YAAY;AACtC,UAAI57C,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,OAAmC,KAAvC,EAA8C;AAC5CpkC,QAAAA,MAAM,CAAC6iD,WAAP,CAAmB,QAAnB;AACD;;AACDohE,MAAAA,QAAQ,CAACjkH,MAAD,EAAS1V,KAAT,CAAR;AACD,KALD;AAMD,GAZD;;AAaA,MAAI65H,OAAO,GAAG,UAAUnkH,MAAV,EAAkB;AAC9BA,IAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAUxL,KAAV,EAAiB;AACpC,UAAIA,KAAK,CAAC2hF,OAAN,KAAkB5uB,EAAE,CAACI,KAAzB,EAAgC;AAC9BymE,QAAAA,mBAAmB,CAAClkH,MAAD,EAAS1V,KAAT,CAAnB;AACD;AACF,KAJD;AAKD,GAND;;AAQA,MAAI85H,wBAAwB,GAAG,UAAUpkH,MAAV,EAAkBya,GAAlB,EAAuB;AACpDygG,IAAAA,OAAO,CAAC,CACN;AACEjvC,MAAAA,OAAO,EAAE5uB,EAAE,CAACU,GADd;AAEEyjB,MAAAA,MAAM,EAAEA,MAAM,CAACy4C,oBAAD,EAAuBj6G,MAAvB,EAA+B,IAA/B;AAFhB,KADM,EAKN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACW,IADd;AAEEwjB,MAAAA,MAAM,EAAEA,MAAM,CAACy4C,oBAAD,EAAuBj6G,MAAvB,EAA+B,KAA/B;AAFhB,KALM,EASN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACU,GADd;AAEEyjB,MAAAA,MAAM,EAAEA,MAAM,CAAC65C,oBAAD,EAAuBr7G,MAAvB,EAA+B,IAA/B;AAFhB,KATM,EAaN;AACEisE,MAAAA,OAAO,EAAE5uB,EAAE,CAACW,IADd;AAEEwjB,MAAAA,MAAM,EAAEA,MAAM,CAAC65C,oBAAD,EAAuBr7G,MAAvB,EAA+B,KAA/B;AAFhB,KAbM,CAAD,EAiBJya,GAjBI,CAAP,CAiBQ7oC,IAjBR,CAiBa,UAAUwqB,CAAV,EAAa;AACxBqe,MAAAA,GAAG,CAACvB,cAAJ;AACD,KAnBD;AAoBD,GArBD;;AAsBA,MAAImrG,OAAO,GAAG,UAAUrkH,MAAV,EAAkB;AAC9BA,IAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAU2kB,GAAV,EAAe;AAClC,UAAIA,GAAG,CAAC1C,kBAAJ,OAA6B,KAAjC,EAAwC;AACtCqsG,QAAAA,wBAAwB,CAACpkH,MAAD,EAASya,GAAT,CAAxB;AACD;AACF,KAJD;AAKD,GAND;;AAQA,MAAI6pG,SAAS,GAAGpkI,QAAQ,GAAG1G,OAA3B;;AACA,MAAI+qI,YAAY,GAAG,UAAUvkH,MAAV,EAAkB;AACnC,QAAIwkH,gBAAgB,GAAG5hG,KAAK,CAAC,YAAY;AACvC,UAAI,CAAC5iB,MAAM,CAACijD,SAAZ,EAAuB;AACrBgZ,QAAAA,sBAAsB,CAACj8D,MAAD,CAAtB;AACD;AACF,KAJ2B,EAIzB,CAJyB,CAA5B;;AAKA,QAAIskH,SAAS,CAACnmI,IAAV,EAAJ,EAAsB;AACpB6hB,MAAAA,MAAM,CAAClK,EAAP,CAAU,UAAV,EAAsB,UAAUklD,EAAV,EAAc;AAClCwpE,QAAAA,gBAAgB,CAACrkH,QAAjB;AACD,OAFD;AAGAH,MAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB,UAAUklD,EAAV,EAAc;AAChCwpE,QAAAA,gBAAgB,CAACjpG,MAAjB;AACD,OAFD;AAGD;AACF,GAdD;;AAeA,MAAIkpG,OAAO,GAAG,UAAUzkH,MAAV,EAAkB;AAC9BukH,IAAAA,YAAY,CAACvkH,MAAD,CAAZ;AACAA,IAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,UAAUjd,CAAV,EAAa;AAC9B,UAAIA,CAAC,CAAC6rI,WAAF,KAAkB,KAAtB,EAA6B;AAC3BzoD,QAAAA,sBAAsB,CAACj8D,MAAD,CAAtB;AACD;AACF,KAJD;AAKD,GAPD;;AASA,MAAI2kH,oBAAoB,GAAG,UAAU7/H,IAAV,EAAgB2O,GAAhB,EAAqB;AAC9C,QAAInS,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,EAAhB;AACA,QAAIslB,MAAM,GAAGnT,GAAG,CAACmT,MAAJ,EAAb;;AACA,QAAIvW,QAAQ,CAAC/O,SAAD,CAAZ,EAAyB;AACvBA,MAAAA,SAAS,CAAC07E,UAAV,CAAqBp2D,MAArB,EAA6B9hB,IAA7B;AACA,aAAOjS,QAAQ,CAACR,IAAT,CAAcwvD,aAAa,CAACvgD,SAAD,EAAYslB,MAAM,GAAG9hB,IAAI,CAAC9W,MAA1B,CAA3B,CAAP;AACD,KAHD,MAGO;AACL,aAAO8gE,sBAAsB,CAACr7C,GAAD,CAAtB,CAA4B9hB,GAA5B,CAAgC,UAAUohB,GAAV,EAAe;AACpD,YAAIuT,QAAQ,GAAGlhB,YAAY,CAACP,QAAb,CAAsBC,IAAtB,CAAf;;AACA,YAAI2O,GAAG,CAACsT,OAAJ,EAAJ,EAAmB;AACjB/b,UAAAA,KAAK,CAAC+H,GAAD,EAAMuT,QAAN,CAAL;AACD,SAFD,MAEO;AACL1b,UAAAA,MAAM,CAACmI,GAAD,EAAMuT,QAAN,CAAN;AACD;;AACD,eAAOu7B,aAAa,CAACv7B,QAAQ,CAACthB,GAAV,EAAeF,IAAI,CAAC9W,MAApB,CAApB;AACD,OARM,CAAP;AASD;AACF,GAjBD;;AAkBA,MAAI42I,oBAAoB,GAAGh1I,KAAK,CAAC+0I,oBAAD,EAAuBn/G,IAAvB,CAAhC;AACA,MAAIq/G,qBAAqB,GAAGj1I,KAAK,CAAC+0I,oBAAD,EAAuB,GAAvB,CAAjC;;AAEA,MAAIG,uBAAuB,GAAG,UAAU3iI,IAAV,EAAgB;AAC5C,WAAO,UAAUkiC,QAAV,EAAoB;AACzB,aAAOA,QAAQ,CAACrzC,IAAT,CAAc,UAAUkV,OAAV,EAAmB;AACtC,eAAOmrD,YAAY,CAAClvD,IAAI,CAAC6C,GAAN,EAAW68C,aAAa,CAACj3C,MAAd,CAAqB1E,OAArB,CAAX,CAAnB;AACD,OAFM,EAEJ,UAAUA,OAAV,EAAmB;AACpB,eAAOorD,eAAe,CAACprD,OAAD,CAAtB;AACD,OAJM,EAIJ,UAAUA,OAAV,EAAmB;AACpB,eAAOqrD,cAAc,CAACrrD,OAAD,CAArB;AACD,OANM,EAMJ,UAAUA,OAAV,EAAmB;AACpB,eAAOkrD,YAAY,CAACjvD,IAAI,CAAC6C,GAAN,EAAW68C,aAAa,CAAC72C,KAAd,CAAoB9E,OAApB,CAAX,CAAnB;AACD,OARM,CAAP;AASD,KAVD;AAWD,GAZD;;AAaA,MAAI6+H,+BAA+B,GAAG,UAAU5iI,IAAV,EAAgBsR,GAAhB,EAAqB;AACzD,WAAO,UAAUuxH,QAAV,EAAoB;AACzB,aAAO9pD,eAAe,CAAC/4E,IAAD,EAAO6iI,QAAP,CAAf,GAAkCJ,oBAAoB,CAACnxH,GAAD,CAAtD,GAA8DoxH,qBAAqB,CAACpxH,GAAD,CAA1F;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIwxH,cAAc,GAAG,UAAUjlH,MAAV,EAAkB;AACrC,WAAO,UAAUvM,GAAV,EAAe;AACpBuM,MAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwB1/C,GAAG,CAACquC,OAAJ,EAAxB;AACA9hC,MAAAA,MAAM,CAAC2hD,WAAP;AACA,aAAO,IAAP;AACD,KAJD;AAKD,GAND;;AAOA,MAAIujE,4BAA4B,GAAG,UAAUllH,MAAV,EAAkB;AACnD,QAAIvM,GAAG,GAAGouC,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAAV;AACA,QAAIh4C,IAAI,GAAGiD,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAX;;AACA,QAAIp6B,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,EAAJ,EAAoC;AAClC,UAAIiqE,gBAAgB,GAAGz+H,KAAK,CAAC20H,cAAD,EAAiBvkG,MAAjB,CAA5B;AACA,UAAIyhC,aAAa,GAAGI,aAAa,CAACG,cAAd,CAA6BhiC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAA7B,CAApB;AACA,aAAOwyE,YAAY,CAAC0B,gBAAD,EAAmBruG,MAAM,CAACo6B,OAAP,EAAnB,EAAqCqH,aAArC,CAAZ,CAAgE5vD,IAAhE,CAAqEizI,uBAAuB,CAAC3iI,IAAD,CAA5F,EAAoGtQ,IAApG,CAAyGkzI,+BAA+B,CAAC5iI,IAAD,EAAOsR,GAAP,CAAxI,EAAqJ3hB,MAArJ,CAA4JmzI,cAAc,CAACjlH,MAAD,CAA1K,CAAP;AACD,KAJD,MAIO;AACL,aAAO,KAAP;AACD;AACF,GAVD;;AAYA,MAAImlH,wBAAwB,GAAG,UAAUnlH,MAAV,EAAkBya,GAAlB,EAAuB;AACpDygG,IAAAA,OAAO,CAAC,CAAC;AACLjvC,MAAAA,OAAO,EAAE5uB,EAAE,CAACO,QADP;AAEL4jB,MAAAA,MAAM,EAAEA,MAAM,CAAC0jD,4BAAD,EAA+BllH,MAA/B;AAFT,KAAD,CAAD,EAGDya,GAHC,CAAP,CAGW7oC,IAHX,CAGgB,UAAUwqB,CAAV,EAAa;AAC3Bqe,MAAAA,GAAG,CAACvB,cAAJ;AACD,KALD;AAMD,GAPD;;AAQA,MAAIksG,OAAO,GAAG,UAAUplH,MAAV,EAAkB;AAC9BA,IAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAU2kB,GAAV,EAAe;AAClC,UAAIA,GAAG,CAAC1C,kBAAJ,OAA6B,KAAjC,EAAwC;AACtCotG,QAAAA,wBAAwB,CAACnlH,MAAD,EAASya,GAAT,CAAxB;AACD;AACF,KAJD;AAKD,GAND;;AAQA,MAAI4qG,yBAAyB,GAAG,UAAUrlH,MAAV,EAAkB;AAChD,QAAImsC,KAAK,GAAG8iE,kBAAkB,CAACjvG,MAAD,CAA9B;AACAuzG,IAAAA,OAAO,CAACvzG,MAAD,CAAP;AACAg+G,IAAAA,OAAO,CAACh+G,MAAD,EAASmsC,KAAT,CAAP;AACAgyE,IAAAA,OAAO,CAACn+G,MAAD,EAASmsC,KAAT,CAAP;AACAg4E,IAAAA,OAAO,CAACnkH,MAAD,CAAP;AACAolH,IAAAA,OAAO,CAACplH,MAAD,CAAP;AACAykH,IAAAA,OAAO,CAACzkH,MAAD,CAAP;AACAqkH,IAAAA,OAAO,CAACrkH,MAAD,CAAP;AACA,WAAOmsC,KAAP;AACD,GAVD;;AAWA,MAAIm5E,OAAO,GAAG,UAAUtlH,MAAV,EAAkB;AAC9B,QAAI,CAAC2+E,KAAK,CAAC3+E,MAAD,CAAV,EAAoB;AAClB,aAAOqlH,yBAAyB,CAACrlH,MAAD,CAAhC;AACD,KAFD,MAEO;AACL,aAAOu1B,IAAI,CAAC,IAAD,CAAX;AACD;AACF,GAND;;AAQA,MAAIgwF,UAAU,GAAG,YAAY;AAC3B,aAASA,UAAT,CAAoBvlH,MAApB,EAA4B;AAC1B,WAAKwlH,QAAL,GAAgB,EAAhB;AACA,WAAKxlH,MAAL,GAAcA,MAAd;AACA,UAAIylH,OAAJ;AACA,UAAIlzI,IAAI,GAAG,IAAX;;AACA,UAAI,EAAE,uBAAuBytB,MAAM,CAACm7C,MAAP,EAAzB,CAAJ,EAA+C;AAC7Cn7C,QAAAA,MAAM,CAAClK,EAAP,CAAU,sCAAV,EAAkD,UAAUjd,CAAV,EAAa;AAC7D,cAAI6sI,SAAS,GAAG1lH,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAhB;AACA,cAAIwrF,OAAO,GAAG;AACZ/9G,YAAAA,cAAc,EAAE89G,SAAS,CAAC99G,cADd;AAEZksB,YAAAA,WAAW,EAAE4xF,SAAS,CAAC5xF,WAFX;AAGZC,YAAAA,YAAY,EAAE2xF,SAAS,CAAC3xF,YAHZ;AAIZC,YAAAA,SAAS,EAAE0xF,SAAS,CAAC1xF;AAJT,WAAd;;AAMA,cAAIn7C,CAAC,CAAC7F,IAAF,KAAW,YAAX,IAA2B,CAACgxE,MAAM,CAAC2hE,OAAD,EAAUF,OAAV,CAAtC,EAA0D;AACxDzlH,YAAAA,MAAM,CAACmb,IAAP,CAAY,iBAAZ;AACD;;AACDsqG,UAAAA,OAAO,GAAGE,OAAV;AACD,SAZD;AAaD;;AACD3lH,MAAAA,MAAM,CAAClK,EAAP,CAAU,aAAV,EAAyB,YAAY;AACnCkK,QAAAA,MAAM,CAACmb,IAAP,CAAY,iBAAZ;AACD,OAFD;AAGAnb,MAAAA,MAAM,CAAClK,EAAP,CAAU,iBAAV,EAA6B,YAAY;AACvC,YAAIusD,QAAQ,GAAGriD,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,CAA0B,IAA1B,CAAf;;AACA,YAAI,CAACL,QAAD,IAAa,CAAC5hE,GAAG,CAACO,KAAL,IAAcgf,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,EAA/B,EAA+D;AAC7D;AACD;;AACD,YAAIsV,YAAY,CAAC15C,MAAD,CAAZ,IAAwB,CAACztB,IAAI,CAACqzI,iBAAL,CAAuBvjE,QAAvB,CAAzB,IAA6DriD,MAAM,CAAChb,GAAP,CAAW4uC,SAAX,CAAqByuB,QAArB,EAA+BriD,MAAM,CAACo6B,OAAP,EAA/B,CAAjE,EAAmH;AACjHp6B,UAAAA,MAAM,CAAC2hD,WAAP,CAAmB;AAAEyK,YAAAA,eAAe,EAAE;AAAnB,WAAnB;AACD;AACF,OARD;AASApsD,MAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAUjd,CAAV,EAAa;AAChC,YAAI,CAACA,CAAC,CAACk/B,kBAAF,EAAD,IAA2B2hC,YAAY,CAAC15C,MAAD,CAA3C,EAAqD;AACnD,cAAIA,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,GAA2B73C,QAA3B,KAAwC,KAA5C,EAAmD;AACjDqY,YAAAA,KAAK,CAACC,gBAAN,CAAuBC,MAAvB,EAA+B,YAAY;AACzCA,cAAAA,MAAM,CAAC2hD,WAAP;AACD,aAFD;AAGD,WAJD,MAIO;AACL3hD,YAAAA,MAAM,CAAC2hD,WAAP;AACD;AACF;AACF,OAVD;AAWD;;AACD4jE,IAAAA,UAAU,CAAC54I,SAAX,CAAqBg1E,WAArB,GAAmC,UAAU1yE,IAAV,EAAgB;AACjD,UAAIirD,SAAS,GAAG,KAAKl6B,MAAL,CAAYk6B,SAA5B;AACA,UAAIt1C,IAAJ,EAAU2D,OAAV,EAAmBpG,IAAnB;;AACA,UAAI,KAAK6d,MAAL,CAAY6lH,WAAZ,IAA2B3rF,SAA3B,IAAwC,CAACuP,uBAAuB,CAAC,KAAKzpC,MAAN,CAAhE,IAAiF,CAAC,KAAKA,MAAL,CAAY8N,IAAZ,CAAiB47B,UAAjB,EAAtF,EAAqH;AACnHvnD,QAAAA,IAAI,GAAG,KAAK6d,MAAL,CAAYo6B,OAAZ,EAAP;AACAx1C,QAAAA,IAAI,GAAGs1C,SAAS,CAACwoB,QAAV,CAAmB,IAAnB,KAA4BvgE,IAAnC;;AACA,YAAIyC,IAAI,CAACqD,aAAL,KAAuB,KAAK+X,MAAL,CAAYm7C,MAAZ,EAAvB,IAA+C,CAAC,KAAKn7C,MAAL,CAAYhb,GAAZ,CAAgB4uC,SAAhB,CAA0BhvC,IAA1B,EAAgCzC,IAAhC,CAApD,EAA2F;AACzFyC,UAAAA,IAAI,GAAGzC,IAAP;AACD;;AACDoG,QAAAA,OAAO,GAAG,EAAV;AACA,aAAKyX,MAAL,CAAYhb,GAAZ,CAAgBurC,SAAhB,CAA0B3rC,IAA1B,EAAgC,UAAUA,IAAV,EAAgB;AAC9C,cAAIA,IAAI,KAAKzC,IAAb,EAAmB;AACjB,mBAAO,IAAP;AACD;;AACDoG,UAAAA,OAAO,CAACvU,IAAR,CAAa4Q,IAAb;AACD,SALD;AAMA3V,QAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;AACAA,QAAAA,IAAI,CAACiX,OAAL,GAAetB,IAAf;AACA3V,QAAAA,IAAI,CAACsZ,OAAL,GAAeA,OAAf;AACA,aAAKyX,MAAL,CAAYmb,IAAZ,CAAiB,YAAjB,EAA+BlsC,IAA/B;AACD;AACF,KArBD;;AAsBAs2I,IAAAA,UAAU,CAAC54I,SAAX,CAAqBi5I,iBAArB,GAAyC,UAAUvjE,QAAV,EAAoB;AAC3D,UAAIn0E,CAAJ;AACA,UAAI43I,WAAW,GAAG,KAAK9lH,MAAL,CAAYwuB,CAAZ,CAAc6zB,QAAd,EAAwB31B,YAAxB,CAAqC,KAAK1sB,MAAL,CAAYo6B,OAAZ,EAArC,EAA4D/sB,GAA5D,CAAgEg1C,QAAhE,CAAlB;;AACA,UAAIyjE,WAAW,CAAC93I,MAAZ,KAAuB,KAAKw3I,QAAL,CAAcx3I,MAAzC,EAAiD;AAC/C,aAAKE,CAAC,GAAG43I,WAAW,CAAC93I,MAArB,EAA6BE,CAAC,IAAI,CAAlC,EAAqCA,CAAC,EAAtC,EAA0C;AACxC,cAAI43I,WAAW,CAAC53I,CAAD,CAAX,KAAmB,KAAKs3I,QAAL,CAAct3I,CAAd,CAAvB,EAAyC;AACvC;AACD;AACF;;AACD,YAAIA,CAAC,KAAK,CAAC,CAAX,EAAc;AACZ,eAAKs3I,QAAL,GAAgBM,WAAhB;AACA,iBAAO,IAAP;AACD;AACF;;AACD,WAAKN,QAAL,GAAgBM,WAAhB;AACA,aAAO,KAAP;AACD,KAhBD;;AAiBA,WAAOP,UAAP;AACD,GArFgB,EAAjB;;AAuFA,MAAIQ,oBAAoB,GAAG,UAAU/lH,MAAV,EAAkB;AAC3CA,IAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,UAAUjd,CAAV,EAAa;AAC9B,UAAImnB,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqB13C,CAAC,CAACuE,MAAvB,EAA+B,SAA/B,CAAJ,EAA+C;AAC7CvE,QAAAA,CAAC,CAACqgC,cAAF;AACD;AACF,KAJD;AAKD,GAND;;AAOA,MAAI8sG,aAAa,GAAG,UAAUhmH,MAAV,EAAkB;AACpCA,IAAAA,MAAM,CAACymE,MAAP,CAAcvqC,aAAd,CAA4B,SAA5B,EAAuC,UAAU/L,IAAV,EAAgB;AACrDv+C,MAAAA,IAAI,CAACu+C,IAAD,EAAO,UAAUq2C,OAAV,EAAmB;AAC5BA,QAAAA,OAAO,CAAC50E,IAAR,CAAa,eAAb,EAA8B40E,OAAO,CAAC50E,IAAR,CAAa,MAAb,CAA9B;AACA40E,QAAAA,OAAO,CAAC50E,IAAR,CAAa,MAAb,EAAqB,MAArB;AACD,OAHG,CAAJ;AAID,KALD;AAMAoO,IAAAA,MAAM,CAACi8B,UAAP,CAAkBC,aAAlB,CAAgC,SAAhC,EAA2C,UAAU/L,IAAV,EAAgB;AACzDv+C,MAAAA,IAAI,CAACu+C,IAAD,EAAO,UAAUq2C,OAAV,EAAmB;AAC5B,YAAI6e,IAAI,GAAG7e,OAAO,CAAC50E,IAAR,CAAa,eAAb,CAAX;AACA40E,QAAAA,OAAO,CAAC50E,IAAR,CAAa,MAAb,EAAqBze,QAAQ,CAACkyG,IAAD,CAAR,GAAiBA,IAAjB,GAAwB,IAA7C;AACA7e,QAAAA,OAAO,CAAC50E,IAAR,CAAa,eAAb,EAA8B,IAA9B;AACD,OAJG,CAAJ;AAKD,KAND;AAOD,GAdD;;AAeA,MAAIq0H,OAAO,GAAG,UAAUjmH,MAAV,EAAkB;AAC9B+lH,IAAAA,oBAAoB,CAAC/lH,MAAD,CAApB;AACAgmH,IAAAA,aAAa,CAAChmH,MAAD,CAAb;AACD,GAHD;;AAKA,MAAIkmH,eAAe,GAAG,UAAUthI,IAAV,EAAgB;AACpC,WAAOqK,WAAW,CAACrK,IAAD,CAAX,IAAqBogB,WAAW,CAAC5f,YAAY,CAACX,OAAb,CAAqBG,IAArB,CAAD,CAAvC;AACD,GAFD;;AAGA,MAAIuhI,oBAAoB,GAAG,UAAUnmH,MAAV,EAAkB;AAC3C,QAAIi6B,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;AACA,QAAI+V,QAAQ,GAAGrO,aAAa,CAACG,cAAd,CAA6B/H,GAA7B,CAAf;AACA,QAAI2Y,MAAM,GAAG/Q,aAAa,CAACI,YAAd,CAA2BhI,GAA3B,CAAb;;AACA,QAAI4H,aAAa,CAACQ,iBAAd,CAAgC6N,QAAhC,CAAJ,EAA+C;AAC7C,UAAI5uD,SAAS,GAAG4uD,QAAQ,CAAC5uD,SAAT,EAAhB;;AACA,UAAI4kI,eAAe,CAAC5kI,SAAD,CAAnB,EAAgC;AAC9BgwD,QAAAA,eAAe,CAAChwD,SAAD,CAAf,CAA2B1P,IAA3B,CAAgC,UAAU6hB,GAAV,EAAe;AAC7C,iBAAOwmC,GAAG,CAAC5G,QAAJ,CAAa5/B,GAAG,CAACnS,SAAJ,EAAb,EAA8BmS,GAAG,CAACmT,MAAJ,EAA9B,CAAP;AACD,SAFD;AAGD;AACF;;AACD,QAAIi7B,aAAa,CAACQ,iBAAd,CAAgCuQ,MAAhC,CAAJ,EAA6C;AAC3C,UAAItxD,SAAS,GAAG4uD,QAAQ,CAAC5uD,SAAT,EAAhB;;AACA,UAAI4kI,eAAe,CAAC5kI,SAAD,CAAnB,EAAgC;AAC9BiwD,QAAAA,cAAc,CAACjwD,SAAD,CAAd,CAA0B1P,IAA1B,CAA+B,UAAU6hB,GAAV,EAAe;AAC5C,iBAAOwmC,GAAG,CAAC3G,MAAJ,CAAW7/B,GAAG,CAACnS,SAAJ,EAAX,EAA4BmS,GAAG,CAACmT,MAAJ,EAA5B,CAAP;AACD,SAFD;AAGD;AACF;;AACD5G,IAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwB+vB,WAAW,CAACjpC,GAAD,CAAnC;AACD,GArBD;;AAsBA,MAAImsF,OAAO,GAAG,UAAUpmH,MAAV,EAAkB;AAC9BA,IAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,UAAUjd,CAAV,EAAa;AAC9B,UAAIA,CAAC,CAACwtI,MAAF,IAAY,CAAhB,EAAmB;AACjBF,QAAAA,oBAAoB,CAACnmH,MAAD,CAApB;AACD;AACF,KAJD;AAKD,GAND;;AAQA,MAAIsmH,OAAO,GAAG,YAAY;AACxB,QAAIz8D,OAAO,GAAGt0B,IAAI,CAAC1iD,QAAQ,CAACrC,IAAT,EAAD,CAAlB;;AACA,QAAIksG,KAAK,GAAG,YAAY;AACtB,aAAO7yB,OAAO,CAAC14D,GAAR,CAAYte,QAAQ,CAACrC,IAAT,EAAZ,CAAP;AACD,KAFD;;AAGA,QAAI2gB,GAAG,GAAG,UAAU3e,CAAV,EAAa;AACrB,aAAOq3E,OAAO,CAAC14D,GAAR,CAAYte,QAAQ,CAACR,IAAT,CAAcG,CAAd,CAAZ,CAAP;AACD,KAFD;;AAGA,QAAI+zI,KAAK,GAAG,YAAY;AACtB,aAAO18D,OAAO,CAACl0E,GAAR,GAAcxE,MAAd,EAAP;AACD,KAFD;;AAGA,QAAI2kB,EAAE,GAAG,UAAUpoB,CAAV,EAAa;AACpB,aAAOm8E,OAAO,CAACl0E,GAAR,GAAc/D,IAAd,CAAmBlE,CAAnB,CAAP;AACD,KAFD;;AAGA,WAAO;AACLgvG,MAAAA,KAAK,EAAEA,KADF;AAELvrF,MAAAA,GAAG,EAAEA,GAFA;AAGLo1H,MAAAA,KAAK,EAAEA,KAHF;AAILzwH,MAAAA,EAAE,EAAEA;AAJC,KAAP;AAMD,GApBD;;AAsBA,MAAI0wH,mBAAmB,GAAG,UAAUzzH,GAAV,EAAe;AACvC,QAAI2tC,UAAU,GAAG3tC,GAAG,CAACtG,qBAAJ,EAAjB;AACA,QAAIxI,GAAG,GAAG8O,GAAG,CAAC9K,aAAd;AACA,QAAIo0B,OAAO,GAAGp4B,GAAG,CAACmE,eAAlB;AACA,QAAIwE,GAAG,GAAG3I,GAAG,CAACoE,WAAd;AACA,WAAO;AACL+D,MAAAA,GAAG,EAAEs0C,UAAU,CAACt0C,GAAX,GAAiBQ,GAAG,CAACI,WAArB,GAAmCqvB,OAAO,CAAClvB,SAD3C;AAELhB,MAAAA,IAAI,EAAEu0C,UAAU,CAACv0C,IAAX,GAAkBS,GAAG,CAACM,WAAtB,GAAoCmvB,OAAO,CAACjvB;AAF7C,KAAP;AAID,GATD;;AAUA,MAAIq5H,eAAe,GAAG,UAAUzmH,MAAV,EAAkB;AACtC,WAAOA,MAAM,CAAC+R,MAAP,GAAgBy0G,mBAAmB,CAACxmH,MAAM,CAACo6B,OAAP,EAAD,CAAnC,GAAwD;AAC7DjuC,MAAAA,IAAI,EAAE,CADuD;AAE7DC,MAAAA,GAAG,EAAE;AAFwD,KAA/D;AAID,GALD;;AAMA,MAAIs6H,iBAAiB,GAAG,UAAU1mH,MAAV,EAAkB;AACxC,QAAI9T,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAAX;AACA,WAAOp6B,MAAM,CAAC+R,MAAP,GAAgB;AACrB5lB,MAAAA,IAAI,EAAED,IAAI,CAACe,UADU;AAErBb,MAAAA,GAAG,EAAEF,IAAI,CAACa;AAFW,KAAhB,GAGH;AACFZ,MAAAA,IAAI,EAAE,CADJ;AAEFC,MAAAA,GAAG,EAAE;AAFH,KAHJ;AAOD,GATD;;AAUA,MAAIu6H,aAAa,GAAG,UAAU3mH,MAAV,EAAkB;AACpC,QAAI9T,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAAX;AAAA,QAA6Bl1C,MAAM,GAAG8a,MAAM,CAACm7C,MAAP,GAAgB/yD,eAAtD;AACA,QAAIw+H,YAAY,GAAG;AACjBz6H,MAAAA,IAAI,EAAED,IAAI,CAACe,UADM;AAEjBb,MAAAA,GAAG,EAAEF,IAAI,CAACa;AAFO,KAAnB;AAIA,QAAI85H,YAAY,GAAG;AACjB16H,MAAAA,IAAI,EAAED,IAAI,CAACe,UAAL,IAAmB/H,MAAM,CAAC+H,UADf;AAEjBb,MAAAA,GAAG,EAAEF,IAAI,CAACa,SAAL,IAAkB7H,MAAM,CAAC6H;AAFb,KAAnB;AAIA,WAAOiT,MAAM,CAAC+R,MAAP,GAAgB60G,YAAhB,GAA+BC,YAAtC;AACD,GAXD;;AAYA,MAAIC,gBAAgB,GAAG,UAAU9mH,MAAV,EAAkB1V,KAAlB,EAAyB;AAC9C,QAAIA,KAAK,CAAClN,MAAN,CAAa6K,aAAb,KAA+B+X,MAAM,CAACm7C,MAAP,EAAnC,EAAoD;AAClD,UAAI4rE,cAAc,GAAGP,mBAAmB,CAACxmH,MAAM,CAAC80F,uBAAP,EAAD,CAAxC;AACA,UAAIkyB,cAAc,GAAGL,aAAa,CAAC3mH,MAAD,CAAlC;AACA,aAAO;AACL7T,QAAAA,IAAI,EAAE7B,KAAK,CAACuuB,KAAN,GAAckuG,cAAc,CAAC56H,IAA7B,GAAoC66H,cAAc,CAAC76H,IADpD;AAELC,QAAAA,GAAG,EAAE9B,KAAK,CAAC0uB,KAAN,GAAc+tG,cAAc,CAAC36H,GAA7B,GAAmC46H,cAAc,CAAC56H;AAFlD,OAAP;AAID;;AACD,WAAO;AACLD,MAAAA,IAAI,EAAE7B,KAAK,CAACuuB,KADP;AAELzsB,MAAAA,GAAG,EAAE9B,KAAK,CAAC0uB;AAFN,KAAP;AAID,GAbD;;AAcA,MAAIiuG,iBAAiB,GAAG,UAAUC,YAAV,EAAwBF,cAAxB,EAAwCG,aAAxC,EAAuD;AAC7E,WAAO;AACLtuG,MAAAA,KAAK,EAAEsuG,aAAa,CAACh7H,IAAd,GAAqB+6H,YAAY,CAAC/6H,IAAlC,GAAyC66H,cAAc,CAAC76H,IAD1D;AAEL6sB,MAAAA,KAAK,EAAEmuG,aAAa,CAAC/6H,GAAd,GAAoB86H,YAAY,CAAC96H,GAAjC,GAAuC46H,cAAc,CAAC56H;AAFxD,KAAP;AAID,GALD;;AAMA,MAAIg7H,IAAI,GAAG,UAAUpnH,MAAV,EAAkB1V,KAAlB,EAAyB;AAClC,WAAO28H,iBAAiB,CAACR,eAAe,CAACzmH,MAAD,CAAhB,EAA0B0mH,iBAAiB,CAAC1mH,MAAD,CAA3C,EAAqD8mH,gBAAgB,CAAC9mH,MAAD,EAAS1V,KAAT,CAArE,CAAxB;AACD,GAFD;;AAIA,MAAI+8H,wBAAwB,GAAGz2H,sBAA/B;AAAA,MAAuD02H,uBAAuB,GAAG32H,qBAAjF;;AACA,MAAI42H,WAAW,GAAG,UAAUh0H,OAAV,EAAmBR,GAAnB,EAAwB;AACxC,WAAOs0H,wBAAwB,CAACt0H,GAAD,CAAxB,IAAiCA,GAAG,KAAKQ,OAAhD;AACD,GAFD;;AAGA,MAAIi0H,iBAAiB,GAAG,UAAUxnH,MAAV,EAAkBynH,aAAlB,EAAiCC,WAAjC,EAA8C;AACpE,QAAID,aAAa,KAAKC,WAAlB,IAAiC1nH,MAAM,CAAChb,GAAP,CAAW4uC,SAAX,CAAqB6zF,aAArB,EAAoCC,WAApC,CAArC,EAAuF;AACrF,aAAO,KAAP;AACD;;AACD,WAAO,CAACL,wBAAwB,CAACI,aAAD,CAAhC;AACD,GALD;;AAMA,MAAIE,YAAY,GAAG,UAAU50H,GAAV,EAAe;AAChC,QAAI60H,QAAQ,GAAG70H,GAAG,CAAC82B,SAAJ,CAAc,IAAd,CAAf;AACA+9F,IAAAA,QAAQ,CAACl2H,eAAT,CAAyB,mBAAzB;AACA,WAAOk2H,QAAP;AACD,GAJD;;AAKA,MAAIC,WAAW,GAAG,UAAU7nH,MAAV,EAAkBjN,GAAlB,EAAuB9E,KAAvB,EAA8BC,MAA9B,EAAsC;AACtD,QAAIlJ,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,QAAI8iI,SAAS,GAAG/0H,GAAG,CAAC82B,SAAJ,CAAc,IAAd,CAAhB;AACA7kC,IAAAA,GAAG,CAAC6qC,SAAJ,CAAci4F,SAAd,EAAyB;AACvB75H,MAAAA,KAAK,EAAEA,KADgB;AAEvBC,MAAAA,MAAM,EAAEA;AAFe,KAAzB;AAIAlJ,IAAAA,GAAG,CAAC8pC,SAAJ,CAAcg5F,SAAd,EAAyB,mBAAzB,EAA8C,IAA9C;AACA,QAAIlnE,QAAQ,GAAG57D,GAAG,CAAC9C,MAAJ,CAAW,KAAX,EAAkB;AAC/B,eAAS,oBADsB;AAE/B,wBAAkB,KAFa;AAG/B,sBAAgB,IAHe;AAI/B,yBAAmB;AAJY,KAAlB,CAAf;AAMA8C,IAAAA,GAAG,CAAC6qC,SAAJ,CAAc+wB,QAAd,EAAwB;AACtBpQ,MAAAA,QAAQ,EAAE,UADY;AAEtBu3E,MAAAA,OAAO,EAAE,GAFa;AAGtBC,MAAAA,QAAQ,EAAE,QAHY;AAItBnxG,MAAAA,MAAM,EAAE,CAJc;AAKtBoxG,MAAAA,OAAO,EAAE,CALa;AAMtBv8E,MAAAA,MAAM,EAAE,CANc;AAOtBz9C,MAAAA,KAAK,EAAEA,KAPe;AAQtBC,MAAAA,MAAM,EAAEA;AARc,KAAxB;AAUAlJ,IAAAA,GAAG,CAAC6qC,SAAJ,CAAci4F,SAAd,EAAyB;AACvBp8E,MAAAA,MAAM,EAAE,CADe;AAEvBw8E,MAAAA,SAAS,EAAE;AAFY,KAAzB;AAIAtnE,IAAAA,QAAQ,CAACv1D,WAAT,CAAqBy8H,SAArB;AACA,WAAOlnE,QAAP;AACD,GA9BD;;AA+BA,MAAIunE,iBAAiB,GAAG,UAAUvnE,QAAV,EAAoB2zC,OAApB,EAA6B;AACnD,QAAI3zC,QAAQ,CAACt4D,UAAT,KAAwBisG,OAA5B,EAAqC;AACnCA,MAAAA,OAAO,CAAClpG,WAAR,CAAoBu1D,QAApB;AACD;AACF,GAJD;;AAKA,MAAIwnE,SAAS,GAAG,UAAUxnE,QAAV,EAAoBpQ,QAApB,EAA8BviD,KAA9B,EAAqCC,MAArC,EAA6Cm6H,IAA7C,EAAmDC,IAAnD,EAAyD;AACvE,QAAIC,SAAS,GAAG,CAAhB;AAAA,QAAmBxpF,SAAS,GAAG,CAA/B;AACA6hB,IAAAA,QAAQ,CAAC5vD,KAAT,CAAe7E,IAAf,GAAsBqkD,QAAQ,CAAC33B,KAAT,GAAiB,IAAvC;AACA+nC,IAAAA,QAAQ,CAAC5vD,KAAT,CAAe5E,GAAf,GAAqBokD,QAAQ,CAACx3B,KAAT,GAAiB,IAAtC;;AACA,QAAIw3B,QAAQ,CAAC33B,KAAT,GAAiB5qB,KAAjB,GAAyBo6H,IAA7B,EAAmC;AACjCE,MAAAA,SAAS,GAAG/3E,QAAQ,CAAC33B,KAAT,GAAiB5qB,KAAjB,GAAyBo6H,IAArC;AACD;;AACD,QAAI73E,QAAQ,CAACx3B,KAAT,GAAiB9qB,MAAjB,GAA0Bo6H,IAA9B,EAAoC;AAClCvpF,MAAAA,SAAS,GAAGyR,QAAQ,CAACx3B,KAAT,GAAiB9qB,MAAjB,GAA0Bo6H,IAAtC;AACD;;AACD1nE,IAAAA,QAAQ,CAAC5vD,KAAT,CAAe/C,KAAf,GAAuBA,KAAK,GAAGs6H,SAAR,GAAoB,IAA3C;AACA3nE,IAAAA,QAAQ,CAAC5vD,KAAT,CAAe9C,MAAf,GAAwBA,MAAM,GAAG6wC,SAAT,GAAqB,IAA7C;AACD,GAZD;;AAaA,MAAIypF,aAAa,GAAG,UAAUz1H,GAAV,EAAe;AACjC,QAAIA,GAAG,IAAIA,GAAG,CAACzK,UAAf,EAA2B;AACzByK,MAAAA,GAAG,CAACzK,UAAJ,CAAewD,WAAf,CAA2BiH,GAA3B;AACD;AACF,GAJD;;AAKA,MAAI01H,wBAAwB,GAAG,UAAU5vI,CAAV,EAAa;AAC1C,WAAOA,CAAC,CAACosC,MAAF,KAAa,CAApB;AACD,GAFD;;AAGA,MAAIyjG,WAAW,GAAG,UAAUlnH,KAAV,EAAiBgvC,QAAjB,EAA2B;AAC3C,WAAO;AACL33B,MAAAA,KAAK,EAAE23B,QAAQ,CAAC33B,KAAT,GAAiBrX,KAAK,CAACmnH,IADzB;AAEL3vG,MAAAA,KAAK,EAAEw3B,QAAQ,CAACx3B,KAAT,GAAiB;AAFnB,KAAP;AAID,GALD;;AAMA,MAAI4vG,OAAO,GAAG,UAAUpnH,KAAV,EAAiBxB,MAAjB,EAAyB;AACrC,WAAO,UAAUnnB,CAAV,EAAa;AAClB,UAAI4vI,wBAAwB,CAAC5vI,CAAD,CAA5B,EAAiC;AAC/B,YAAIgwI,KAAK,GAAG7zI,IAAI,CAACgrB,MAAM,CAAChb,GAAP,CAAWorC,UAAX,CAAsBv3C,CAAC,CAACuE,MAAxB,CAAD,EAAkC3L,EAAE,CAAC41I,wBAAD,EAA2BC,uBAA3B,CAApC,CAAJ,CAA6Fl2I,KAA7F,CAAmG,IAAnG,CAAZ;;AACA,YAAIm2I,WAAW,CAACvnH,MAAM,CAACo6B,OAAP,EAAD,EAAmByuF,KAAnB,CAAf,EAA0C;AACxC,cAAIC,MAAM,GAAG9oH,MAAM,CAAChb,GAAP,CAAWsO,MAAX,CAAkBu1H,KAAlB,CAAb;AACA,cAAIt0B,OAAO,GAAGv0F,MAAM,CAACo6B,OAAP,EAAd;AACA,cAAIl1C,MAAM,GAAG8a,MAAM,CAACm7C,MAAP,GAAgB/yD,eAA7B;AACAoZ,UAAAA,KAAK,CAACrQ,GAAN,CAAU;AACRjL,YAAAA,OAAO,EAAE2iI,KADD;AAERE,YAAAA,QAAQ,EAAE,KAFF;AAGR5nE,YAAAA,OAAO,EAAEtoE,CAAC,CAACsoE,OAHH;AAIRC,YAAAA,OAAO,EAAEvoE,CAAC,CAACuoE,OAJH;AAKRinE,YAAAA,IAAI,EAAE,CAACroH,MAAM,CAAC+R,MAAP,GAAgBwiF,OAAO,CAACjzC,WAAxB,GAAsCp8D,MAAM,CAACwN,WAA9C,IAA6D,CAL3D;AAMR41H,YAAAA,IAAI,EAAE,CAACtoH,MAAM,CAAC+R,MAAP,GAAgBwiF,OAAO,CAAChzC,YAAxB,GAAuCr8D,MAAM,CAACkO,YAA/C,IAA+D,CAN7D;AAORu1H,YAAAA,IAAI,EAAE9vI,CAAC,CAACggC,KAAF,GAAUiwG,MAAM,CAACv8I,CAPf;AAQRy8I,YAAAA,IAAI,EAAEnwI,CAAC,CAACmgC,KAAF,GAAU8vG,MAAM,CAACl7I,CARf;AASRqgB,YAAAA,KAAK,EAAE46H,KAAK,CAACn2H,WATL;AAURxE,YAAAA,MAAM,EAAE26H,KAAK,CAACz1H,YAVN;AAWR61H,YAAAA,KAAK,EAAEpB,WAAW,CAAC7nH,MAAD,EAAS6oH,KAAT,EAAgBA,KAAK,CAACn2H,WAAtB,EAAmCm2H,KAAK,CAACz1H,YAAzC;AAXV,WAAV;AAaD;AACF;AACF,KAtBD;AAuBD,GAxBD;;AAyBA,MAAI81H,MAAM,GAAG,UAAU1nH,KAAV,EAAiBxB,MAAjB,EAAyB;AACpC,QAAImpH,qBAAqB,GAAGrpH,KAAK,CAACK,QAAN,CAAe,UAAU2Y,OAAV,EAAmBG,OAAnB,EAA4B;AACrEjZ,MAAAA,MAAM,CAAC8mE,mBAAP,CAA2B2jC,aAA3B;;AACAzqG,MAAAA,MAAM,CAACk6B,SAAP,CAAiBkqD,YAAjB,CAA8BtrE,OAA9B,EAAuCG,OAAvC;AACD,KAH2B,EAGzB,CAHyB,CAA5B;AAIAjZ,IAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoBqzH,qBAAqB,CAAC1gI,IAA1C;AACA,WAAO,UAAU5P,CAAV,EAAa;AAClB,aAAO2oB,KAAK,CAAC1L,EAAN,CAAS,UAAU0L,KAAV,EAAiB;AAC/B,YAAI4nH,QAAQ,GAAG16H,IAAI,CAACC,GAAL,CAASD,IAAI,CAAC8wD,GAAL,CAAS3mE,CAAC,CAACsoE,OAAF,GAAY3/C,KAAK,CAAC2/C,OAA3B,CAAT,EAA8CzyD,IAAI,CAAC8wD,GAAL,CAAS3mE,CAAC,CAACuoE,OAAF,GAAY5/C,KAAK,CAAC4/C,OAA3B,CAA9C,CAAf;;AACA,YAAI,CAAC5/C,KAAK,CAACunH,QAAP,IAAmBK,QAAQ,GAAG,EAAlC,EAAsC;AACpC,cAAIn6I,IAAI,GAAG+wB,MAAM,CAACmb,IAAP,CAAY,WAAZ,EAAyB;AAAE/9B,YAAAA,MAAM,EAAEokB,KAAK,CAACtb;AAAhB,WAAzB,CAAX;;AACA,cAAIjX,IAAI,CAAC8oC,kBAAL,EAAJ,EAA+B;AAC7B;AACD;;AACDvW,UAAAA,KAAK,CAACunH,QAAN,GAAiB,IAAjB;AACA/oH,UAAAA,MAAM,CAACskB,KAAP;AACD;;AACD,YAAI9iB,KAAK,CAACunH,QAAV,EAAoB;AAClB,cAAIM,SAAS,GAAGX,WAAW,CAAClnH,KAAD,EAAQ4lH,IAAI,CAACpnH,MAAD,EAASnnB,CAAT,CAAZ,CAA3B;AACAsvI,UAAAA,iBAAiB,CAAC3mH,KAAK,CAACynH,KAAP,EAAcjpH,MAAM,CAACo6B,OAAP,EAAd,CAAjB;AACAguF,UAAAA,SAAS,CAAC5mH,KAAK,CAACynH,KAAP,EAAcI,SAAd,EAAyB7nH,KAAK,CAACvT,KAA/B,EAAsCuT,KAAK,CAACtT,MAA5C,EAAoDsT,KAAK,CAAC6mH,IAA1D,EAAgE7mH,KAAK,CAAC8mH,IAAtE,CAAT;AACAa,UAAAA,qBAAqB,CAACtwI,CAAC,CAACigC,OAAH,EAAYjgC,CAAC,CAACogC,OAAd,CAArB;AACD;AACF,OAhBM,CAAP;AAiBD,KAlBD;AAmBD,GAzBD;;AA0BA,MAAIqwG,YAAY,GAAG,UAAUpvF,SAAV,EAAqB;AACtC,QAAID,GAAG,GAAGC,SAAS,CAACif,MAAV,GAAmBR,UAAnB,CAA8B,CAA9B,CAAV;AACA,QAAI/wC,cAAc,GAAGqyB,GAAG,CAACryB,cAAzB;AACA,WAAOA,cAAc,CAACxhB,QAAf,KAA4B,CAA5B,GAAgCwhB,cAAc,CAACtf,UAA/C,GAA4Dsf,cAAnE;AACD,GAJD;;AAKA,MAAI2hH,IAAI,GAAG,UAAU/nH,KAAV,EAAiBxB,MAAjB,EAAyB;AAClC,WAAO,UAAUnnB,CAAV,EAAa;AAClB2oB,MAAAA,KAAK,CAAC1L,EAAN,CAAS,UAAU0L,KAAV,EAAiB;AACxB,YAAIA,KAAK,CAACunH,QAAV,EAAoB;AAClB,cAAIvB,iBAAiB,CAACxnH,MAAD,EAASspH,YAAY,CAACtpH,MAAM,CAACk6B,SAAR,CAArB,EAAyC14B,KAAK,CAACtb,OAA/C,CAArB,EAA8E;AAC5E,gBAAIsjI,aAAa,GAAG7B,YAAY,CAACnmH,KAAK,CAACtb,OAAP,CAAhC;AACA,gBAAIjX,IAAI,GAAG+wB,MAAM,CAACmb,IAAP,CAAY,MAAZ,EAAoB;AAC7BrC,cAAAA,OAAO,EAAEjgC,CAAC,CAACigC,OADkB;AAE7BG,cAAAA,OAAO,EAAEpgC,CAAC,CAACogC;AAFkB,aAApB,CAAX;;AAIA,gBAAI,CAAChqC,IAAI,CAAC8oC,kBAAL,EAAL,EAAgC;AAC9B/X,cAAAA,MAAM,CAAC27C,WAAP,CAAmBC,QAAnB,CAA4B,YAAY;AACtC4sE,gBAAAA,aAAa,CAAChnH,KAAK,CAACtb,OAAP,CAAb;AACA8Z,gBAAAA,MAAM,CAAC09E,aAAP,CAAqB19E,MAAM,CAAChb,GAAP,CAAW+sC,YAAX,CAAwBy3F,aAAxB,CAArB;;AACAxpH,gBAAAA,MAAM,CAAC8mE,mBAAP,CAA2B2jC,aAA3B;AACD,eAJD;AAKD;AACF;AACF;AACF,OAjBD;AAkBAgf,MAAAA,eAAe,CAACjoH,KAAD,CAAf;AACD,KApBD;AAqBD,GAtBD;;AAuBA,MAAI/Y,IAAI,GAAG,UAAU+Y,KAAV,EAAiBxB,MAAjB,EAAyB;AAClC,WAAO,YAAY;AACjBwB,MAAAA,KAAK,CAAC1L,EAAN,CAAS,UAAU0L,KAAV,EAAiB;AACxB,YAAIA,KAAK,CAACunH,QAAV,EAAoB;AAClB/oH,UAAAA,MAAM,CAACmb,IAAP,CAAY,SAAZ;AACD;AACF,OAJD;AAKAsuG,MAAAA,eAAe,CAACjoH,KAAD,CAAf;AACD,KAPD;AAQD,GATD;;AAUA,MAAIioH,eAAe,GAAG,UAAUjoH,KAAV,EAAiB;AACrCA,IAAAA,KAAK,CAAC1L,EAAN,CAAS,UAAU0L,KAAV,EAAiB;AACxBgnH,MAAAA,aAAa,CAAChnH,KAAK,CAACynH,KAAP,CAAb;AACD,KAFD;AAGAznH,IAAAA,KAAK,CAACk7E,KAAN;AACD,GALD;;AAMA,MAAIgtC,kBAAkB,GAAG,UAAU1pH,MAAV,EAAkB;AACzC,QAAIwB,KAAK,GAAG8kH,OAAO,EAAnB;AACA,QAAIqD,OAAO,GAAG57F,QAAQ,CAAC2D,GAAvB;AACA,QAAI6tB,YAAY,GAAGp+D,QAAnB;AACA,QAAIyoI,gBAAgB,GAAGhB,OAAO,CAACpnH,KAAD,EAAQxB,MAAR,CAA9B;AACA,QAAI6pH,WAAW,GAAGX,MAAM,CAAC1nH,KAAD,EAAQxB,MAAR,CAAxB;AACA,QAAI8pH,WAAW,GAAGP,IAAI,CAAC/nH,KAAD,EAAQxB,MAAR,CAAtB;AACA,QAAI+pH,cAAc,GAAGthI,IAAI,CAAC+Y,KAAD,EAAQxB,MAAR,CAAzB;AACAA,IAAAA,MAAM,CAAClK,EAAP,CAAU,WAAV,EAAuB8zH,gBAAvB;AACA5pH,IAAAA,MAAM,CAAClK,EAAP,CAAU,WAAV,EAAuB+zH,WAAvB;AACA7pH,IAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqBg0H,WAArB;AACAH,IAAAA,OAAO,CAAC93I,IAAR,CAAa0tE,YAAb,EAA2B,WAA3B,EAAwCsqE,WAAxC;AACAF,IAAAA,OAAO,CAAC93I,IAAR,CAAa0tE,YAAb,EAA2B,SAA3B,EAAsCwqE,cAAtC;AACA/pH,IAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB,YAAY;AAC9B6zH,MAAAA,OAAO,CAAC3uG,MAAR,CAAeukC,YAAf,EAA6B,WAA7B,EAA0CsqE,WAA1C;AACAF,MAAAA,OAAO,CAAC3uG,MAAR,CAAeukC,YAAf,EAA6B,SAA7B,EAAwCwqE,cAAxC;AACD,KAHD;AAID,GAjBD;;AAkBA,MAAIC,WAAW,GAAG,UAAUhqH,MAAV,EAAkB;AAClCA,IAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,UAAUjd,CAAV,EAAa;AAC7B,UAAIoxI,UAAU,GAAG,OAAOpxI,CAAC,CAACigC,OAAT,KAAqB,WAArB,GAAmC9Y,MAAM,CAACm7C,MAAP,GAAgBh2D,gBAAhB,CAAiCtM,CAAC,CAACigC,OAAnC,EAA4CjgC,CAAC,CAACogC,OAA9C,CAAnC,GAA4F,IAA7G;;AACA,UAAIouG,wBAAwB,CAAC4C,UAAD,CAAxB,IAAwCjqH,MAAM,CAAChb,GAAP,CAAW2uC,wBAAX,CAAoCs2F,UAApC,MAAoD,OAAhG,EAAyG;AACvGpxI,QAAAA,CAAC,CAACqgC,cAAF;AACD;AACF,KALD;AAMD,GAPD;;AAQA,MAAIgxG,wBAAwB,GAAG,UAAUlqH,MAAV,EAAkB;AAC/C,QAAImqH,eAAe,GAAG,UAAUtxI,CAAV,EAAa;AACjC,UAAI,CAACA,CAAC,CAACk/B,kBAAF,EAAL,EAA6B;AAC3B,YAAIqyG,YAAY,GAAGvxI,CAAC,CAACuxI,YAArB;;AACA,YAAIA,YAAY,KAAKh2I,QAAQ,CAACg2I,YAAY,CAACC,KAAd,EAAqB,OAArB,CAAR,IAAyCD,YAAY,CAACn8F,KAAb,CAAmBjgD,MAAnB,GAA4B,CAA1E,CAAhB,EAA8F;AAC5F6K,UAAAA,CAAC,CAACqgC,cAAF;;AACA,cAAIrgC,CAAC,CAAC7F,IAAF,KAAW,MAAf,EAAuB;AACrBukH,YAAAA,YAAY,CAACv3F,MAAD,EAAS,oCAAT,CAAZ;AACD;AACF;AACF;AACF,KAVD;;AAWA,QAAIsqH,0BAA0B,GAAG,UAAUzxI,CAAV,EAAa;AAC5C,UAAIk0E,WAAW,CAAC/sD,MAAD,EAASnnB,CAAC,CAACuE,MAAX,CAAf,EAAmC;AACjC+sI,QAAAA,eAAe,CAACtxI,CAAD,CAAf;AACD;AACF,KAJD;;AAKA,QAAIkiD,KAAK,GAAG,YAAY;AACtB,UAAI4uF,OAAO,GAAG57F,QAAQ,CAAC2D,GAAvB;AACA,UAAI1sC,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,UAAIf,GAAG,GAAG9C,QAAV;AACA,UAAIopI,UAAU,GAAGvqH,MAAM,CAAC+R,MAAP,GAAgB/R,MAAM,CAACo6B,OAAP,EAAhB,GAAmCp6B,MAAM,CAACm7C,MAAP,EAApD;AACA,UAAIqvE,UAAU,GAAG,CACf,MADe,EAEf,UAFe,CAAjB;AAIA54I,MAAAA,IAAI,CAAC44I,UAAD,EAAa,UAAU19I,IAAV,EAAgB;AAC/B68I,QAAAA,OAAO,CAAC93I,IAAR,CAAaoS,GAAb,EAAkBnX,IAAlB,EAAwBw9I,0BAAxB;AACAtlI,QAAAA,GAAG,CAACnT,IAAJ,CAAS04I,UAAT,EAAqBz9I,IAArB,EAA2Bq9I,eAA3B;AACD,OAHG,CAAJ;AAIAnqH,MAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB,YAAY;AAC9BlkB,QAAAA,IAAI,CAAC44I,UAAD,EAAa,UAAU19I,IAAV,EAAgB;AAC/B68I,UAAAA,OAAO,CAAC3uG,MAAR,CAAe/2B,GAAf,EAAoBnX,IAApB,EAA0Bw9I,0BAA1B;AACAtlI,UAAAA,GAAG,CAACg2B,MAAJ,CAAWuvG,UAAX,EAAuBz9I,IAAvB,EAA6Bq9I,eAA7B;AACD,SAHG,CAAJ;AAID,OALD;AAMD,KAnBD;;AAoBAnqH,IAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,YAAY;AAC5BgK,MAAAA,KAAK,CAACC,gBAAN,CAAuBC,MAAvB,EAA+B+6B,KAA/B,EAAsC,CAAtC;AACD,KAFD;AAGD,GAxCD;;AAyCA,MAAItQ,IAAI,GAAG,UAAUzqB,MAAV,EAAkB;AAC3B0pH,IAAAA,kBAAkB,CAAC1pH,MAAD,CAAlB;AACAgqH,IAAAA,WAAW,CAAChqH,MAAD,CAAX;;AACA,QAAI8pC,0BAA0B,CAAC9pC,MAAD,CAA9B,EAAwC;AACtCkqH,MAAAA,wBAAwB,CAAClqH,MAAD,CAAxB;AACD;AACF,GAND;;AAQA,MAAIyqH,OAAO,GAAG,UAAUzqH,MAAV,EAAkB;AAC9B,QAAI0qH,gBAAgB,GAAG9nG,KAAK,CAAC,YAAY;AACvC,UAAI,CAAC5iB,MAAM,CAACC,OAAR,IAAmBD,MAAM,CAACo6B,OAAP,GAAiBhmD,QAAjB,CAA0B+M,QAAQ,CAACojC,aAAnC,CAAvB,EAA0E;AACxE,YAAI0V,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAV;;AACA,YAAIF,GAAG,CAAC+K,SAAR,EAAmB;AACjB,cAAImkE,UAAU,GAAGN,gBAAgB,CAAC7oG,MAAD,EAASi6B,GAAT,EAAc,KAAd,CAAjC;AACAj6B,UAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBg2D,UAAxB;AACD;AACF;AACF,KAR2B,EAQzB,CARyB,CAA5B;AASAnpG,IAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,YAAY;AAC7B40H,MAAAA,gBAAgB,CAACvqH,QAAjB;AACD,KAFD;AAGAH,IAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,YAAY;AAC5B40H,MAAAA,gBAAgB,CAACnvG,MAAjB;AACD,KAFD;AAGD,GAhBD;;AAkBA,MAAIovG,OAAO,GAAG,UAAU3qH,MAAV,EAAkB;AAC9BA,IAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,YAAY;AAC5BkK,MAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAUjd,CAAV,EAAa;AAChC,YAAIuE,MAAM,GAAGvE,CAAC,CAACuE,MAAf;;AACA,YAAI0T,OAAO,CAAC1T,MAAD,CAAX,EAAqB;AACnB,cAAIwrH,MAAM,GAAGvsD,sBAAsB,CAACr8C,MAAM,CAACo6B,OAAP,EAAD,EAAmBh9C,MAAnB,CAAnC;AACA,cAAIwH,IAAI,GAAGgM,sBAAsB,CAACg4G,MAAD,CAAtB,GAAiCA,MAAjC,GAA0CxrH,MAArD;;AACA,cAAI4iB,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,OAA+B16C,IAAnC,EAAyC;AACvCouD,YAAAA,UAAU,CAAChzC,MAAD,EAASpb,IAAT,CAAV,CAAyBhT,IAAzB,CAA8B,UAAUqoD,GAAV,EAAe;AAC3C,qBAAOj6B,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB,CAAP;AACD,aAFD;AAGD;AACF;AACF,OAXD;AAYD,KAbD;AAcD,GAfD;;AAiBA,MAAI2wF,uBAAuB,GAAGj6H,qBAA9B;AACA,MAAIk6H,wBAAwB,GAAGj6H,sBAA/B;;AACA,MAAIk6H,wBAAwB,GAAG,UAAU9qH,MAAV,EAAkBpb,IAAlB,EAAwB;AACrD,WAAOy3D,sBAAsB,CAACr8C,MAAM,CAACo6B,OAAP,EAAD,EAAmBx1C,IAAnB,CAA7B;AACD,GAFD;;AAGA,MAAImmI,kBAAkB,GAAG,UAAU/qH,MAAV,EAAkB;AACzC,QAAIk6B,SAAS,GAAGl6B,MAAM,CAACk6B,SAAvB;AAAA,QAAkCl1C,GAAG,GAAGgb,MAAM,CAAChb,GAA/C;AACA,QAAI4f,OAAO,GAAG5f,GAAG,CAAC4f,OAAlB;AACA,QAAIpB,QAAQ,GAAGxD,MAAM,CAACo6B,OAAP,EAAf;AACA,QAAI4wF,SAAS,GAAGl/E,SAAS,CAAC9rC,MAAD,EAASwD,QAAT,EAAmBoB,OAAnB,EAA4B,YAAY;AAC/D,aAAO0pD,UAAU,CAACtuD,MAAD,CAAjB;AACD,KAFwB,CAAzB;AAGA,QAAIirH,eAAe,GAAG,SAASjmI,GAAG,CAAC8sC,QAAJ,EAA/B;AACA,QAAI0sB,oBAAoB,GAAG,mBAA3B;AACA,QAAI0sE,eAAJ;;AACA,QAAIC,sBAAsB,GAAG,UAAUvmI,IAAV,EAAgB;AAC3C,aAAOI,GAAG,CAACykC,QAAJ,CAAa7kC,IAAb,EAAmB,yBAAnB,CAAP;AACD,KAFD;;AAGA,QAAIwmI,4BAA4B,GAAG,UAAUxmI,IAAV,EAAgB;AACjD,aAAOA,IAAI,KAAK4e,QAAT,KAAsBqnH,wBAAwB,CAACjmI,IAAD,CAAxB,IAAkCkM,OAAO,CAAClM,IAAD,CAA/D,KAA0EI,GAAG,CAAC4uC,SAAJ,CAAchvC,IAAd,EAAoB4e,QAApB,CAAjF;AACD,KAFD;;AAGA,QAAI6nH,0BAA0B,GAAG,UAAU53H,GAAV,EAAe;AAC9C,aAAOklE,4BAA4B,CAACllE,GAAD,CAA5B,IAAqCmlE,2BAA2B,CAACnlE,GAAD,CAAhE,IAAyE8kE,aAAa,CAAC9kE,GAAD,CAAtF,IAA+F+kE,YAAY,CAAC/kE,GAAD,CAAlH;AACD,KAFD;;AAGA,QAAI63H,uBAAuB,GAAG,YAAY;AACxC,UAAIhqI,SAAS,GAAG0D,GAAG,CAACrP,GAAJ,CAAQs1I,eAAR,CAAhB;AACA,aAAO3pI,SAAS,GAAGA,SAAS,CAACimB,oBAAV,CAA+B,GAA/B,EAAoC,CAApC,CAAH,GAA4CjmB,SAA5D;AACD,KAHD;;AAIA,QAAIiqI,QAAQ,GAAG,UAAUvqI,KAAV,EAAiB;AAC9B,UAAIA,KAAJ,EAAW;AACTk5C,QAAAA,SAAS,CAACiZ,MAAV,CAAiBnyD,KAAjB;AACD;AACF,KAJD;;AAKA,QAAIwqI,QAAQ,GAAGtxF,SAAS,CAACC,MAAzB;;AACA,QAAIouE,SAAS,GAAG,UAAU9qE,SAAV,EAAqB74C,IAArB,EAA2BgG,MAA3B,EAAmCiD,cAAnC,EAAmD;AACjE,UAAIA,cAAc,KAAK,KAAK,CAA5B,EAA+B;AAC7BA,QAAAA,cAAc,GAAG,IAAjB;AACD;;AACD,UAAIhV,CAAC,GAAGmnB,MAAM,CAACmb,IAAP,CAAY,WAAZ,EAAyB;AAC/B/9B,QAAAA,MAAM,EAAEwH,IADuB;AAE/B64C,QAAAA,SAAS,EAAEA,SAFoB;AAG/B7yC,QAAAA,MAAM,EAAEA;AAHuB,OAAzB,CAAR;;AAKA,UAAI/R,CAAC,CAACk/B,kBAAF,EAAJ,EAA4B;AAC1B,eAAO,IAAP;AACD;;AACD,UAAIlqB,cAAJ,EAAoB;AAClBqsC,QAAAA,SAAS,CAACrsC,cAAV,CAAyBjJ,IAAzB,EAA+B64C,SAAS,KAAK,CAAC,CAA9C;AACD;;AACD,aAAOutF,SAAS,CAAC9+F,IAAV,CAAethC,MAAf,EAAuBhG,IAAvB,CAAP;AACD,KAhBD;;AAiBA,QAAImiF,uBAAuB,GAAG,UAAUssC,mBAAV,EAA+B;AAC3D,UAAIA,mBAAmB,CAAC3jH,YAApB,CAAiC,gBAAjC,CAAJ,EAAwD;AACtD+X,QAAAA,uBAAuB,CAAC4rG,mBAAD,CAAvB;AACAkY,QAAAA,QAAQ,CAACC,QAAQ,EAAT,CAAR;AACAtxF,QAAAA,SAAS,CAACrsC,cAAV,CAAyBwlH,mBAAzB;AACD;AACF,KAND;;AAOA,QAAInmD,cAAc,GAAG,YAAY;AAC/BltD,MAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAUjd,CAAV,EAAa;AAChC,YAAImI,KAAK,GAAGwqI,QAAQ,EAApB;;AACA,YAAIxqI,KAAK,CAACgkD,SAAN,IAAmByvD,iBAAiB,CAACz0F,MAAD,EAASnnB,CAAC,CAACigC,OAAX,EAAoBjgC,CAAC,CAACogC,OAAtB,CAAxC,EAAwE;AACtEwvF,UAAAA,kBAAkB,CAACzoG,MAAD,EAAShf,KAAT,EAAgB,KAAhB,CAAlB,CAAyCpP,IAAzC,CAA8C25I,QAA9C;AACD;AACF,OALD;AAMAvrH,MAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,UAAUjd,CAAV,EAAa;AAC9B,YAAI4yI,mBAAmB,GAAGX,wBAAwB,CAAC9qH,MAAD,EAASnnB,CAAC,CAACuE,MAAX,CAAlD;;AACA,YAAIquI,mBAAJ,EAAyB;AACvB,cAAIZ,wBAAwB,CAACY,mBAAD,CAA5B,EAAmD;AACjD5yI,YAAAA,CAAC,CAACqgC,cAAF;AACAlZ,YAAAA,MAAM,CAACskB,KAAP;AACD;;AACD,cAAIsmG,uBAAuB,CAACa,mBAAD,CAA3B,EAAkD;AAChD,gBAAIzmI,GAAG,CAAC4uC,SAAJ,CAAc63F,mBAAd,EAAmCvxF,SAAS,CAACoF,OAAV,EAAnC,CAAJ,EAA6D;AAC3DosF,cAAAA,sBAAsB;AACvB;AACF;AACF;AACF,OAbD;AAcA1rH,MAAAA,MAAM,CAAClK,EAAP,CAAU,eAAV,EAA2B41H,sBAA3B;AACA1rH,MAAAA,MAAM,CAAClK,EAAP,CAAU,qCAAV,EAAiDk1H,SAAS,CAACz+E,UAA3D;;AACA,UAAIo/E,sBAAsB,GAAG,UAAU54H,GAAV,EAAe;AAC1C,YAAI0xE,WAAW,GAAGp0B,WAAW,CAACt9C,GAAD,CAA7B;;AACA,YAAI,CAACA,GAAG,CAACxJ,UAAT,EAAqB;AACnB,iBAAO,KAAP;AACD;;AACD,YAAI2mD,QAAQ,GAAGrO,aAAa,CAACj3C,MAAd,CAAqBmI,GAAG,CAACxJ,UAAzB,CAAf;AACA,YAAIowE,MAAM,GAAG8K,WAAW,CAAChhE,IAAZ,CAAiBysC,QAAjB,CAAb;AACA,eAAOypB,MAAM,IAAI,CAAC0xD,0BAA0B,CAAC1xD,MAAD,CAA5C;AACD,OARD;;AASA,UAAIlsB,aAAa,GAAG,UAAUU,KAAV,EAAiBC,KAAjB,EAAwB;AAC1C,YAAIw2D,MAAM,GAAG5/G,GAAG,CAACurC,SAAJ,CAAc4d,KAAd,EAAqBvpC,OAArB,CAAb;AACA,YAAIigG,MAAM,GAAG7/G,GAAG,CAACurC,SAAJ,CAAc6d,KAAd,EAAqBxpC,OAArB,CAAb;AACA,eAAOggG,MAAM,KAAKC,MAAlB;AACD,OAJD;;AAKA,UAAI+mB,oBAAoB,GAAG,UAAUriH,UAAV,EAAsBwiG,SAAtB,EAAiC;AAC1D,YAAI8f,WAAW,GAAG7mI,GAAG,CAACurC,SAAJ,CAAchnB,UAAd,EAA0B3E,OAA1B,CAAlB;AACA,YAAIsnC,UAAU,GAAGlnD,GAAG,CAACurC,SAAJ,CAAcw7E,SAAd,EAAyBnnG,OAAzB,CAAjB;;AACA,YAAIinH,WAAW,IAAItiH,UAAU,KAAK2iC,UAA9B,IAA4ClnD,GAAG,CAAC4uC,SAAJ,CAAci4F,WAAd,EAA2B3/E,UAA3B,CAA5C,IAAsF2+E,wBAAwB,CAACC,wBAAwB,CAAC9qH,MAAD,EAAS6rH,WAAT,CAAzB,CAAxB,KAA4E,KAAtK,EAA6K;AAC3K,iBAAO,IAAP;AACD;;AACD,eAAOA,WAAW,IAAI,CAACp+E,aAAa,CAACo+E,WAAD,EAAc3/E,UAAd,CAA7B,IAA0Dy/E,sBAAsB,CAACE,WAAD,CAAvF;AACD,OAPD;;AAQA7rH,MAAAA,MAAM,CAAClK,EAAP,CAAU,KAAV,EAAiB,UAAUjd,CAAV,EAAa;AAC5B,YAAI+oE,SAAS,GAAG/oE,CAAC,CAACuE,MAAlB;AACA,YAAIquI,mBAAmB,GAAGX,wBAAwB,CAAC9qH,MAAD,EAAS4hD,SAAT,CAAlD;;AACA,YAAIipE,wBAAwB,CAACY,mBAAD,CAA5B,EAAmD;AACjD5yI,UAAAA,CAAC,CAACqgC,cAAF;AACA85B,UAAAA,UAAU,CAAChzC,MAAD,EAASyrH,mBAAT,CAAV,CAAwC75I,IAAxC,CAA6Ck6I,mBAA7C;AACD,SAHD,MAGO,IAAIV,4BAA4B,CAACxpE,SAAD,CAAhC,EAA6C;AAClD5O,UAAAA,UAAU,CAAChzC,MAAD,EAAS4hD,SAAT,CAAV,CAA8BhwE,IAA9B,CAAmCk6I,mBAAnC;AACD;AACF,OATD,EASG,IATH;AAUA9rH,MAAAA,MAAM,CAAClK,EAAP,CAAU,WAAV,EAAuB,UAAUjd,CAAV,EAAa;AAClC,YAAI+oE,SAAS,GAAG/oE,CAAC,CAACuE,MAAlB;;AACA,YAAIwkE,SAAS,KAAKp+C,QAAd,IAA0Bo+C,SAAS,CAACn6D,QAAV,KAAuB,MAAjD,IAA2D,CAACzC,GAAG,CAAC4uC,SAAJ,CAAcguB,SAAd,EAAyBp+C,QAAzB,CAAhE,EAAoG;AAClG;AACD;;AACD,YAAIixF,iBAAiB,CAACz0F,MAAD,EAASnnB,CAAC,CAACigC,OAAX,EAAoBjgC,CAAC,CAACogC,OAAtB,CAAjB,KAAoD,KAAxD,EAA+D;AAC7D;AACD;;AACD,YAAIwyG,mBAAmB,GAAGX,wBAAwB,CAAC9qH,MAAD,EAAS4hD,SAAT,CAAlD;;AACA,YAAI6pE,mBAAJ,EAAyB;AACvB,cAAIZ,wBAAwB,CAACY,mBAAD,CAA5B,EAAmD;AACjD5yI,YAAAA,CAAC,CAACqgC,cAAF;AACA85B,YAAAA,UAAU,CAAChzC,MAAD,EAASyrH,mBAAT,CAAV,CAAwC75I,IAAxC,CAA6Ck6I,mBAA7C;AACD,WAHD,MAGO;AACLJ,YAAAA,sBAAsB;;AACtB,gBAAI,EAAEd,uBAAuB,CAACa,mBAAD,CAAvB,IAAgD5yI,CAAC,CAACqlE,QAApD,KAAiE,CAAC5B,eAAe,CAACzjE,CAAC,CAACigC,OAAH,EAAYjgC,CAAC,CAACogC,OAAd,EAAuBihB,SAAS,CAACC,MAAV,EAAvB,CAArF,EAAiI;AAC/HswE,cAAAA,aAAa;AACbvwE,cAAAA,SAAS,CAACkqD,YAAV,CAAuBvrG,CAAC,CAACigC,OAAzB,EAAkCjgC,CAAC,CAACogC,OAApC;AACD;AACF;AACF,SAXD,MAWO,IAAImyG,4BAA4B,CAACxpE,SAAD,CAAhC,EAA6C;AAClD5O,UAAAA,UAAU,CAAChzC,MAAD,EAAS4hD,SAAT,CAAV,CAA8BhwE,IAA9B,CAAmCk6I,mBAAnC;AACD,SAFM,MAEA,IAAIp/E,iBAAiB,CAACkV,SAAD,CAAjB,KAAiC,KAArC,EAA4C;AACjD8pE,UAAAA,sBAAsB;AACtBjhB,UAAAA,aAAa;AACb,cAAIshB,aAAa,GAAGlU,gBAAgB,CAACr0G,QAAD,EAAW3qB,CAAC,CAACigC,OAAb,EAAsBjgC,CAAC,CAACogC,OAAxB,CAApC;;AACA,cAAI8yG,aAAJ,EAAmB;AACjB,gBAAI,CAACH,oBAAoB,CAAChqE,SAAD,EAAYmqE,aAAa,CAACnnI,IAA1B,CAAzB,EAA0D;AACxD/L,cAAAA,CAAC,CAACqgC,cAAF;AACA,kBAAIl4B,KAAK,GAAGunH,SAAS,CAAC,CAAD,EAAIwjB,aAAa,CAACnnI,IAAlB,EAAwBmnI,aAAa,CAACnhI,MAAtC,EAA8C,KAA9C,CAArB;AACAoV,cAAAA,MAAM,CAACo6B,OAAP,GAAiB9V,KAAjB;AACAinG,cAAAA,QAAQ,CAACvqI,KAAD,CAAR;AACD;AACF;AACF;AACF,OAnCD;AAoCAgf,MAAAA,MAAM,CAAClK,EAAP,CAAU,UAAV,EAAsB,UAAUjd,CAAV,EAAa;AACjC,YAAIwkE,EAAE,CAACY,eAAH,CAAmBplE,CAAnB,CAAJ,EAA2B;AACzB;AACD;;AACD,YAAIgyI,wBAAwB,CAAC3wF,SAAS,CAACoF,OAAV,EAAD,CAA5B,EAAmD;AACjDzmD,UAAAA,CAAC,CAACqgC,cAAF;AACD;AACF,OAPD;AAQAlZ,MAAAA,MAAM,CAAClK,EAAP,CAAU,mBAAV,EAA+B,UAAUjd,CAAV,EAAa;AAC1C,YAAIohD,GAAG,GAAGphD,CAAC,CAACmI,KAAZ;;AACA,YAAIkqI,eAAJ,EAAqB;AACnB,cAAI,CAACA,eAAe,CAAC5iI,UAArB,EAAiC;AAC/B4iI,YAAAA,eAAe,GAAG,IAAlB;AACA;AACD;;AACDjxF,UAAAA,GAAG,GAAGA,GAAG,CAACgH,UAAJ,EAAN;AACAhH,UAAAA,GAAG,CAAC+Y,UAAJ,CAAek4E,eAAf;AACAryI,UAAAA,CAAC,CAACmI,KAAF,GAAUi5C,GAAV;AACD;AACF,OAXD;AAYAj6B,MAAAA,MAAM,CAAClK,EAAP,CAAU,mBAAV,EAA+B,UAAUjd,CAAV,EAAa;AAC1CA,QAAAA,CAAC,CAACmI,KAAF,GAAUgrI,mCAAmC,CAACnzI,CAAC,CAACmI,KAAH,CAA7C;AACA,YAAIi5C,GAAG,GAAG6xF,mBAAmB,CAACjzI,CAAC,CAACmI,KAAH,EAAUnI,CAAC,CAACwqC,OAAZ,CAA7B;;AACA,YAAI4W,GAAJ,EAAS;AACPphD,UAAAA,CAAC,CAACmI,KAAF,GAAUi5C,GAAV;AACD;AACF,OAND;;AAOA,UAAIgyF,UAAU,GAAG,UAAUrnI,IAAV,EAAgB;AAC/B,eAAOA,IAAI,CAAC/T,EAAL,KAAY,aAAnB;AACD,OAFD;;AAGAmvB,MAAAA,MAAM,CAAClK,EAAP,CAAU,wBAAV,EAAoC,UAAUjd,CAAV,EAAa;AAC/C,YAAIohD,GAAG,GAAGphD,CAAC,CAACmI,KAAZ;AACA,YAAIsH,UAAU,GAAG2xC,GAAG,CAACryB,cAAJ,CAAmBtf,UAApC;;AACA,YAAI,CAAC4jI,uBAAuB,CAACjyF,GAAD,CAAxB,IAAiC,CAACgyF,UAAU,CAAC3jI,UAAD,CAAhD,EAA8D;AAC5DmiH,UAAAA,aAAa;AACd;;AACD,YAAI,CAAC0gB,sBAAsB,CAAC7iI,UAAD,CAA3B,EAAyC;AACvCojI,UAAAA,sBAAsB;AACvB;AACF,OATD;AAUA1rH,MAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,UAAUjd,CAAV,EAAa;AAC7B,YAAIszI,aAAa,GAAGtzI,CAAC,CAACszI,aAAtB;;AACA,YAAI,CAACtzI,CAAC,CAACk/B,kBAAF,EAAD,IAA2Bl/B,CAAC,CAACszI,aAA7B,IAA8C,CAAC1rI,GAAG,CAAChD,EAAvD,EAA2D;AACzD,cAAI2uI,oBAAoB,GAAGd,uBAAuB,EAAlD;;AACA,cAAIc,oBAAJ,EAA0B;AACxBvzI,YAAAA,CAAC,CAACqgC,cAAF;AACAizG,YAAAA,aAAa,CAACE,SAAd;AACAF,YAAAA,aAAa,CAACG,OAAd,CAAsB,WAAtB,EAAmCF,oBAAoB,CAACp6F,SAAxD;AACAm6F,YAAAA,aAAa,CAACG,OAAd,CAAsB,YAAtB,EAAoCF,oBAAoB,CAACG,SAArB,IAAkCH,oBAAoB,CAACphH,SAA3F;AACD;AACF;AACF,OAXD;AAYAyf,MAAAA,IAAI,CAACzqB,MAAD,CAAJ;AACAyqH,MAAAA,OAAO,CAACzqH,MAAD,CAAP;AACA2qH,MAAAA,OAAO,CAAC3qH,MAAD,CAAP;AACD,KAlJD;;AAmJA,QAAIwsH,sBAAsB,GAAG,UAAU5nI,IAAV,EAAgB;AAC3C,aAAOuhB,gBAAgB,CAACvhB,IAAD,CAAhB,IAA0B2hB,wBAAwB,CAAC3hB,IAAD,CAAlD,IAA4D6hB,sBAAsB,CAAC7hB,IAAD,CAAzF;AACD,KAFD;;AAGA,QAAIsnI,uBAAuB,GAAG,UAAUjyF,GAAV,EAAe;AAC3C,aAAOuyF,sBAAsB,CAACvyF,GAAG,CAACryB,cAAL,CAAtB,IAA8C4kH,sBAAsB,CAACvyF,GAAG,CAAClG,YAAL,CAA3E;AACD,KAFD;;AAGA,QAAIi4F,mCAAmC,GAAG,UAAU/xF,GAAV,EAAe;AACvD,UAAIw3B,kBAAkB,GAAGzxD,MAAM,CAAC8M,MAAP,CAAciH,qBAAd,EAAzB;AACA,UAAIitB,MAAM,GAAGh8C,GAAG,CAAC+tC,SAAJ,EAAb;AACA,UAAInrB,cAAc,GAAGqyB,GAAG,CAACryB,cAAzB;AACA,UAAIksB,WAAW,GAAGmG,GAAG,CAACnG,WAAtB;AACA,UAAIC,YAAY,GAAGkG,GAAG,CAAClG,YAAvB;AACA,UAAIC,SAAS,GAAGiG,GAAG,CAACjG,SAApB;;AACA,UAAI98C,GAAG,CAACu6E,kBAAD,EAAqB7pD,cAAc,CAACngB,QAAf,CAAwBpM,WAAxB,EAArB,CAAP,EAAoE;AAClE,YAAIy4C,WAAW,KAAK,CAApB,EAAuB;AACrBkN,UAAAA,MAAM,CAAC+M,cAAP,CAAsBnmC,cAAtB;AACD,SAFD,MAEO;AACLo5B,UAAAA,MAAM,CAACiN,aAAP,CAAqBrmC,cAArB;AACD;AACF,OAND,MAMO;AACLo5B,QAAAA,MAAM,CAAC3N,QAAP,CAAgBzrB,cAAhB,EAAgCksB,WAAhC;AACD;;AACD,UAAI58C,GAAG,CAACu6E,kBAAD,EAAqB19B,YAAY,CAACtsC,QAAb,CAAsBpM,WAAtB,EAArB,CAAP,EAAkE;AAChE,YAAI24C,SAAS,KAAK,CAAlB,EAAqB;AACnBgN,UAAAA,MAAM,CAACgN,YAAP,CAAoBja,YAApB;AACD,SAFD,MAEO;AACLiN,UAAAA,MAAM,CAACE,WAAP,CAAmBnN,YAAnB;AACD;AACF,OAND,MAMO;AACLiN,QAAAA,MAAM,CAAC1N,MAAP,CAAcS,YAAd,EAA4BC,SAA5B;AACD;;AACD,aAAOgN,MAAP;AACD,KA1BD;;AA2BA,QAAIyrF,uBAAuB,GAAG,UAAU7nI,IAAV,EAAgB8nI,WAAhB,EAA6BC,eAA7B,EAA8C;AAC1E,UAAIn+F,CAAC,GAAGxuB,MAAM,CAACwuB,CAAf;AACA,UAAIo+F,uBAAuB,GAAGjuH,UAAU,CAACvZ,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAD,EAAyC,MAAM6wF,eAA/C,CAAV,CAA0Ej6I,IAA1E,CAA+E,YAAY;AACvH,eAAOw9C,CAAC,CAAC,EAAD,CAAR;AACD,OAF6B,EAE3B,UAAUz7B,GAAV,EAAe;AAChB,eAAOy7B,CAAC,CAAC,CAACz7B,GAAG,CAAC/N,GAAL,CAAD,CAAR;AACD,OAJ6B,CAA9B;;AAKA,UAAI4nI,uBAAuB,CAAC5+I,MAAxB,KAAmC,CAAvC,EAA0C;AACxC4+I,QAAAA,uBAAuB,GAAGp+F,CAAC,CAAC,kEAAD,CAAD,CAAsE58B,IAAtE,CAA2E,IAA3E,EAAiFq5H,eAAjF,CAA1B;AACA2B,QAAAA,uBAAuB,CAACvhG,QAAxB,CAAiCrrB,MAAM,CAACo6B,OAAP,EAAjC;AACD;;AACD,UAAI2/E,QAAQ,GAAG/0H,GAAG,CAAC+tC,SAAJ,EAAf;;AACA,UAAI25F,WAAW,KAAKC,eAAhB,IAAmClsI,GAAG,CAAChD,EAA3C,EAA+C;AAC7CmvI,QAAAA,uBAAuB,CAAClhI,KAAxB,GAAgCR,MAAhC,CAAuC,uDAAvC,EAAgGA,MAAhG,CAAuGwhI,WAAvG;AACA3S,QAAAA,QAAQ,CAAC9rE,aAAT,CAAuB2+E,uBAAuB,CAAC,CAAD,CAAvB,CAA2BrjI,UAA3B,CAAsCA,UAA7D;AACAwwH,QAAAA,QAAQ,CAAC74E,WAAT,CAAqBwrF,WAArB;AACD,OAJD,MAIO;AACLE,QAAAA,uBAAuB,CAAClhI,KAAxB,GAAgCR,MAAhC,CAAuCsa,IAAvC,EAA6Cta,MAA7C,CAAoDwhI,WAApD,EAAiExhI,MAAjE,CAAwEsa,IAAxE;AACAu0G,QAAAA,QAAQ,CAAC1mF,QAAT,CAAkBu5F,uBAAuB,CAAC,CAAD,CAAvB,CAA2BrjI,UAA7C,EAAyD,CAAzD;AACAwwH,QAAAA,QAAQ,CAACzmF,MAAT,CAAgBs5F,uBAAuB,CAAC,CAAD,CAAvB,CAA2BpjI,SAA3C,EAAsD,CAAtD;AACD;;AACDojI,MAAAA,uBAAuB,CAAC36H,GAAxB,CAA4B;AAAE7F,QAAAA,GAAG,EAAEpH,GAAG,CAACsO,MAAJ,CAAW1O,IAAX,EAAiBob,MAAM,CAACo6B,OAAP,EAAjB,EAAmCxsD;AAA1C,OAA5B;AACAg/I,MAAAA,uBAAuB,CAAC,CAAD,CAAvB,CAA2BtoG,KAA3B;AACA,UAAIq1B,GAAG,GAAGzf,SAAS,CAACif,MAAV,EAAV;AACAQ,MAAAA,GAAG,CAAC2pC,eAAJ;AACA3pC,MAAAA,GAAG,CAAC4pC,QAAJ,CAAaw2B,QAAb;AACA,aAAOA,QAAP;AACD,KA3BD;;AA4BA,QAAI8S,aAAa,GAAG,UAAU95H,GAAV,EAAe;AACjC,UAAI25H,WAAW,GAAG35H,GAAG,CAAC82B,SAAJ,CAAc,IAAd,CAAlB;AACA,UAAIhxC,CAAC,GAAGmnB,MAAM,CAACmb,IAAP,CAAY,gBAAZ,EAA8B;AACpC/9B,QAAAA,MAAM,EAAE2V,GAD4B;AAEpC25H,QAAAA,WAAW,EAAEA;AAFuB,OAA9B,CAAR;;AAIA,UAAI7zI,CAAC,CAACk/B,kBAAF,EAAJ,EAA4B;AAC1B,eAAO,IAAP;AACD;;AACD,UAAI/2B,KAAK,GAAGyrI,uBAAuB,CAAC15H,GAAD,EAAMla,CAAC,CAAC6zI,WAAR,EAAqBA,WAArB,CAAnC;AACA,UAAII,OAAO,GAAG1nI,YAAY,CAACX,OAAb,CAAqBsO,GAArB,CAAd;AACAnhB,MAAAA,IAAI,CAAC+nD,aAAa,CAACv0C,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAD,EAAyC,sBAAzC,CAAd,EAAgF,UAAUrnC,GAAV,EAAe;AACjG,YAAI,CAAChM,IAAI,CAAC+lI,OAAD,EAAU/5H,GAAV,CAAT,EAAyB;AACvBtB,UAAAA,QAAQ,CAACsB,GAAD,EAAMyrD,oBAAN,CAAR;AACD;AACF,OAJG,CAAJ;;AAKA,UAAI,CAACx5D,GAAG,CAAC2pC,SAAJ,CAAc57B,GAAd,EAAmByrD,oBAAnB,CAAL,EAA+C;AAC7CzrD,QAAAA,GAAG,CAAC7B,YAAJ,CAAiBstD,oBAAjB,EAAuC,GAAvC;AACD;;AACD0sE,MAAAA,eAAe,GAAGn4H,GAAlB;AACA03G,MAAAA,aAAa;AACb,aAAOzpH,KAAP;AACD,KAtBD;;AAuBA,QAAI8qI,mBAAmB,GAAG,UAAU9qI,KAAV,EAAiBqiC,OAAjB,EAA0B;AAClD,UAAI,CAACriC,KAAL,EAAY;AACV,eAAO,IAAP;AACD;;AACD,UAAIA,KAAK,CAACgkD,SAAV,EAAqB;AACnB,YAAI,CAACknF,uBAAuB,CAAClrI,KAAD,CAA5B,EAAqC;AACnC,cAAI2V,GAAG,GAAG0sB,OAAO,GAAG,CAAH,GAAO,CAAC,CAAzB;AACA,cAAIoe,aAAa,GAAGmN,0BAA0B,CAACj4C,GAAD,EAAM6M,QAAN,EAAgBxiB,KAAhB,CAA9C;AACA,cAAI0gD,UAAU,GAAGD,aAAa,CAACnC,OAAd,CAAsB,CAACjc,OAAvB,CAAjB;;AACA,cAAIqpB,iBAAiB,CAAChL,UAAD,CAArB,EAAmC;AACjC,mBAAO6mE,SAAS,CAAC5xG,GAAD,EAAM+qC,UAAN,EAAkBre,OAAO,GAAG,CAACoe,aAAa,CAAC16B,OAAd,EAAJ,GAA8B,KAAvD,EAA8D,KAA9D,CAAhB;AACD;;AACD,cAAIgmH,SAAS,GAAGtrF,aAAa,CAACnC,OAAd,CAAsBjc,OAAtB,CAAhB;;AACA,cAAIqpB,iBAAiB,CAACqgF,SAAD,CAArB,EAAkC;AAChC,mBAAOxkB,SAAS,CAAC5xG,GAAD,EAAMo2H,SAAN,EAAiB1pG,OAAO,GAAG,KAAH,GAAW,CAACoe,aAAa,CAAC16B,OAAd,EAApC,EAA6D,KAA7D,CAAhB;AACD;AACF;;AACD,eAAO,IAAP;AACD;;AACD,UAAIa,cAAc,GAAG5mB,KAAK,CAAC4mB,cAA3B;AACA,UAAIksB,WAAW,GAAG9yC,KAAK,CAAC8yC,WAAxB;AACA,UAAIE,SAAS,GAAGhzC,KAAK,CAACgzC,SAAtB;;AACA,UAAIpsB,cAAc,CAACxhB,QAAf,KAA4B,CAA5B,IAAiC0tC,WAAW,KAAK,CAAjD,IAAsD+2F,wBAAwB,CAACjjH,cAAc,CAACtf,UAAhB,CAAlF,EAA+G;AAC7Gsf,QAAAA,cAAc,GAAGA,cAAc,CAACtf,UAAhC;AACAwrC,QAAAA,WAAW,GAAG9uC,GAAG,CAACy+B,SAAJ,CAAc7b,cAAd,CAAd;AACAA,QAAAA,cAAc,GAAGA,cAAc,CAACtf,UAAhC;AACD;;AACD,UAAIsf,cAAc,CAACxhB,QAAf,KAA4B,CAAhC,EAAmC;AACjC,eAAO,IAAP;AACD;;AACD,UAAI4tC,SAAS,KAAKF,WAAW,GAAG,CAA5B,IAAiClsB,cAAc,KAAK5mB,KAAK,CAAC+yC,YAA9D,EAA4E;AAC1E,YAAInvC,IAAI,GAAGgjB,cAAc,CAACtjB,UAAf,CAA0BwvC,WAA1B,CAAX;;AACA,YAAIs3F,4BAA4B,CAACxmI,IAAD,CAAhC,EAAwC;AACtC,iBAAOioI,aAAa,CAACjoI,IAAD,CAApB;AACD;AACF;;AACD,aAAO,IAAP;AACD,KArCD;;AAsCA,QAAI8mI,sBAAsB,GAAG,YAAY;AACvC,UAAIR,eAAJ,EAAqB;AACnBA,QAAAA,eAAe,CAACx5H,eAAhB,CAAgC8sD,oBAAhC;AACD;;AACD7/C,MAAAA,UAAU,CAACvZ,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAD,EAAyC,MAAM6wF,eAA/C,CAAV,CAA0Er5I,IAA1E,CAA+Eia,MAA/E;AACAq/H,MAAAA,eAAe,GAAG,IAAlB;AACD,KAND;;AAOA,QAAI5vG,OAAO,GAAG,YAAY;AACxB0vG,MAAAA,SAAS,CAAC1vG,OAAV;AACA4vG,MAAAA,eAAe,GAAG,IAAlB;AACD,KAHD;;AAIA,QAAIzgB,aAAa,GAAG,YAAY;AAC9BugB,MAAAA,SAAS,CAAC7+F,IAAV;AACD,KAFD;;AAGA,QAAI1rC,GAAG,CAACW,OAAR,EAAiB;AACf8rE,MAAAA,cAAc;AACf;;AACD,WAAO;AACLq7C,MAAAA,SAAS,EAAEA,SADN;AAELxhC,MAAAA,uBAAuB,EAAEA,uBAFpB;AAGL0jC,MAAAA,aAAa,EAAEA,aAHV;AAILnvF,MAAAA,OAAO,EAAEA;AAJJ,KAAP;AAMD,GAzVD;;AA2VA,MAAI0xG,MAAM,GAAG,UAAUhtH,MAAV,EAAkB;AAC7B,QAAIpuB,IAAI,GAAG8R,KAAK,CAAC9R,IAAjB;AACA,QAAI0rE,SAAS,GAAGD,EAAE,CAACC,SAAnB;AAAA,QAA8BC,MAAM,GAAGF,EAAE,CAACE,MAA1C;AAAA,QAAkDv4D,GAAG,GAAGgb,MAAM,CAAChb,GAA/D;AAAA,QAAoEk1C,SAAS,GAAGl6B,MAAM,CAACk6B,SAAvF;AAAA,QAAkGusC,MAAM,GAAGzmE,MAAM,CAACymE,MAAlH;AACA,QAAIwmD,OAAO,GAAGxsI,GAAG,CAACC,KAAlB;AAAA,QAAyBvC,IAAI,GAAGsC,GAAG,CAAChD,EAApC;AAAA,QAAwCyvI,QAAQ,GAAGzsI,GAAG,CAACL,MAAvD;AACA,QAAI+sI,oBAAoB,GAAG,yBAA3B;AACA,QAAIC,mBAAmB,GAAGjvI,IAAI,GAAG,MAAH,GAAY,KAA1C;;AACA,QAAIkvI,qBAAqB,GAAG,UAAUvqB,GAAV,EAAethG,KAAf,EAAsB;AAChD,UAAI;AACFxB,QAAAA,MAAM,CAACm7C,MAAP,GAAgB0H,WAAhB,CAA4BigD,GAA5B,EAAiC,KAAjC,EAAwCthG,KAAxC;AACD,OAFD,CAEE,OAAOpJ,EAAP,EAAW,CACZ;AACF,KALD;;AAMA,QAAI2f,kBAAkB,GAAG,UAAUl/B,CAAV,EAAa;AACpC,aAAOA,CAAC,CAACk/B,kBAAF,EAAP;AACD,KAFD;;AAGA,QAAIu1G,qBAAqB,GAAG,UAAUz0I,CAAV,EAAa;AACvC,UAAI00I,aAAJ,EAAmBC,eAAnB;;AACA,UAAI30I,CAAC,CAACuxI,YAAN,EAAoB;AAClB,YAAIpqH,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,MAAkCvrD,CAAC,CAACuE,MAAF,CAAS8S,OAAT,KAAqB,KAA3D,EAAkE;AAChEgqC,UAAAA,SAAS,CAACne,MAAV,CAAiBljC,CAAC,CAACuE,MAAnB;AACD;;AACDmwI,QAAAA,aAAa,GAAGvtH,MAAM,CAACk6B,SAAP,CAAiBo9B,UAAjB,EAAhB;;AACA,YAAIi2D,aAAa,CAACv/I,MAAd,GAAuB,CAA3B,EAA8B;AAC5Bw/I,UAAAA,eAAe,GAAGL,oBAAoB,GAAGM,MAAM,CAACztH,MAAM,CAACnvB,EAAR,CAA7B,GAA2C,GAA3C,GAAiD48I,MAAM,CAACF,aAAD,CAAzE;AACA10I,UAAAA,CAAC,CAACuxI,YAAF,CAAekC,OAAf,CAAuBc,mBAAvB,EAA4CI,eAA5C;AACD;AACF;AACF,KAZD;;AAaA,QAAIE,qBAAqB,GAAG,UAAU70I,CAAV,EAAa;AACvC,UAAI20I,eAAJ;;AACA,UAAI30I,CAAC,CAACuxI,YAAN,EAAoB;AAClBoD,QAAAA,eAAe,GAAG30I,CAAC,CAACuxI,YAAF,CAAev0F,OAAf,CAAuBu3F,mBAAvB,CAAlB;;AACA,YAAII,eAAe,IAAIA,eAAe,CAACvgJ,OAAhB,CAAwBkgJ,oBAAxB,KAAiD,CAAxE,EAA2E;AACzEK,UAAAA,eAAe,GAAGA,eAAe,CAAChxI,MAAhB,CAAuB2wI,oBAAoB,CAACn/I,MAA5C,EAAoD+T,KAApD,CAA0D,GAA1D,CAAlB;AACA,iBAAO;AACLlR,YAAAA,EAAE,EAAE4jF,QAAQ,CAAC+4D,eAAe,CAAC,CAAD,CAAhB,CADP;AAELzpI,YAAAA,IAAI,EAAE0wE,QAAQ,CAAC+4D,eAAe,CAAC,CAAD,CAAhB;AAFT,WAAP;AAID;AACF;;AACD,aAAO,IAAP;AACD,KAbD;;AAcA,QAAIG,uBAAuB,GAAG,UAAUniG,OAAV,EAAmBoiG,QAAnB,EAA6B;AACzD,UAAI5tH,MAAM,CAAC6tH,qBAAP,CAA6B,2BAA7B,CAAJ,EAA+D;AAC7D7tH,QAAAA,MAAM,CAAC6iD,WAAP,CAAmB,2BAAnB,EAAgD,KAAhD,EAAuD;AACrDr3B,UAAAA,OAAO,EAAEA,OAD4C;AAErDoiG,UAAAA,QAAQ,EAAEA;AAF2C,SAAvD;AAID,OALD,MAKO;AACL5tH,QAAAA,MAAM,CAAC6iD,WAAP,CAAmB,kBAAnB,EAAuC,KAAvC,EAA8Cr3B,OAA9C;AACD;AACF,KATD;;AAUA,QAAIsiG,uBAAuB,GAAG,YAAY;AACxC,UAAIC,YAAY,GAAG,UAAU9zF,GAAV,EAAe;AAChC,YAAI/tC,IAAI,GAAGlH,GAAG,CAAC9C,MAAJ,CAAW,MAAX,CAAX;AACA,YAAIypC,QAAQ,GAAGsO,GAAG,CAACsqC,aAAJ,EAAf;AACAr4E,QAAAA,IAAI,CAACb,WAAL,CAAiBsgC,QAAjB;AACA,eAAOuO,SAAS,CAAC+B,UAAV,CAAqBnlB,SAArB,CAA+B5qB,IAA/B,EAAqC;AAAE+oD,UAAAA,MAAM,EAAE;AAAV,SAArC,CAAP;AACD,OALD;;AAMA,UAAI+4E,mBAAmB,GAAG,UAAU/zF,GAAV,EAAe;AACvC,YAAIC,SAAS,GAAG6zF,YAAY,CAAC9zF,GAAD,CAA5B;AACA,YAAIg0F,MAAM,GAAGjpI,GAAG,CAAC+tC,SAAJ,EAAb;AACAk7F,QAAAA,MAAM,CAACj7E,UAAP,CAAkBhzC,MAAM,CAACo6B,OAAP,EAAlB;AACA,YAAI8zF,YAAY,GAAGH,YAAY,CAACE,MAAD,CAA/B;AACA,eAAO/zF,SAAS,KAAKg0F,YAArB;AACD,OAND;;AAOAluH,MAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAUjd,CAAV,EAAa;AAChC,YAAIozF,OAAO,GAAGpzF,CAAC,CAACozF,OAAhB;AACA,YAAI7nC,WAAJ,EAAiBl4C,IAAjB;;AACA,YAAI,CAAC6rB,kBAAkB,CAACl/B,CAAD,CAAnB,KAA2BozF,OAAO,KAAK1uB,MAAZ,IAAsB0uB,OAAO,KAAK3uB,SAA7D,CAAJ,EAA6E;AAC3ElZ,UAAAA,WAAW,GAAGpkC,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,EAAd;AACAl4C,UAAAA,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAAP;;AACA,cAAIgK,WAAW,IAAI,CAACp/C,GAAG,CAAC2kB,OAAJ,CAAYzd,IAAZ,CAApB,EAAuC;AACrC;AACD;;AACD,cAAI,CAACk4C,WAAD,IAAgB,CAAC4pF,mBAAmB,CAAChuH,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAD,CAAxC,EAAqE;AACnE;AACD;;AACDthD,UAAAA,CAAC,CAACqgC,cAAF;AACAlZ,UAAAA,MAAM,CAAC2+D,UAAP,CAAkB,EAAlB;;AACA,cAAIzyE,IAAI,CAAC3C,UAAL,IAAmBvE,GAAG,CAAC4f,OAAJ,CAAY1Y,IAAI,CAAC3C,UAAjB,CAAvB,EAAqD;AACnDyW,YAAAA,MAAM,CAACk6B,SAAP,CAAiB0kC,iBAAjB,CAAmC1yE,IAAI,CAAC3C,UAAxC,EAAoD,CAApD;AACD,WAFD,MAEO;AACLyW,YAAAA,MAAM,CAACk6B,SAAP,CAAiB0kC,iBAAjB,CAAmC1yE,IAAnC,EAAyC,CAAzC;AACD;;AACD8T,UAAAA,MAAM,CAAC2hD,WAAP;AACD;AACF,OArBD;AAsBD,KApCD;;AAqCA,QAAIwsE,SAAS,GAAG,YAAY;AAC1BnuH,MAAAA,MAAM,CAACouH,SAAP,CAAiB/gH,GAAjB,CAAqB,QAArB,EAA+B,IAA/B,EAAqC,WAArC;AACD,KAFD;;AAGA,QAAIghH,gBAAgB,GAAG,YAAY;AACjC,UAAI,CAACruH,MAAM,CAAC+R,MAAZ,EAAoB;AAClB/sB,QAAAA,GAAG,CAACnT,IAAJ,CAASmuB,MAAM,CAACm7C,MAAP,EAAT,EAA0B,mBAA1B,EAA+C,UAAUtiE,CAAV,EAAa;AAC1D,cAAIohD,GAAJ;;AACA,cAAIphD,CAAC,CAACuE,MAAF,KAAa4iB,MAAM,CAACm7C,MAAP,GAAgB/yD,eAAjC,EAAkD;AAChD6xC,YAAAA,GAAG,GAAGC,SAAS,CAACC,MAAV,EAAN;AACAn6B,YAAAA,MAAM,CAACo6B,OAAP,GAAiB9V,KAAjB;;AACA,gBAAIzrC,CAAC,CAAC7F,IAAF,KAAW,WAAf,EAA4B;AAC1B,kBAAImzB,gBAAgB,CAAC8zB,GAAG,CAACryB,cAAL,CAApB,EAA0C;AACxC;AACD;;AACDsyB,cAAAA,SAAS,CAACkqD,YAAV,CAAuBvrG,CAAC,CAACigC,OAAzB,EAAkCjgC,CAAC,CAACogC,OAApC;AACD,aALD,MAKO;AACLihB,cAAAA,SAAS,CAACiZ,MAAV,CAAiBlZ,GAAjB;AACD;AACF;AACF,SAdD;AAeD;AACF,KAlBD;;AAmBA,QAAIq0F,mBAAmB,GAAG,YAAY;AACpCtuH,MAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAUjd,CAAV,EAAa;AAChC,YAAI,CAACk/B,kBAAkB,CAACl/B,CAAD,CAAnB,IAA0BA,CAAC,CAACozF,OAAF,KAAc3uB,SAA5C,EAAuD;AACrD,cAAI,CAACt9C,MAAM,CAACo6B,OAAP,GAAiB7yB,oBAAjB,CAAsC,IAAtC,EAA4Cv5B,MAAjD,EAAyD;AACvD;AACD;;AACD,cAAIksD,SAAS,CAACkK,WAAV,MAA2BlK,SAAS,CAACC,MAAV,GAAmBrG,WAAnB,KAAmC,CAAlE,EAAqE;AACnE,gBAAIlvC,IAAI,GAAGs1C,SAAS,CAACoF,OAAV,EAAX;AACA,gBAAIr2C,eAAe,GAAGrE,IAAI,CAACqE,eAA3B;;AACA,gBAAIrE,IAAI,CAAC6C,QAAL,KAAkB,IAAtB,EAA4B;AAC1BzC,cAAAA,GAAG,CAAC6G,MAAJ,CAAWjH,IAAX;AACA/L,cAAAA,CAAC,CAACqgC,cAAF;AACA;AACD;;AACD,gBAAIjwB,eAAe,IAAIA,eAAe,CAACxB,QAAnC,IAA+CwB,eAAe,CAACxB,QAAhB,CAAyBpM,WAAzB,OAA2C,IAA9F,EAAoG;AAClG2J,cAAAA,GAAG,CAAC6G,MAAJ,CAAW5C,eAAX;AACApQ,cAAAA,CAAC,CAACqgC,cAAF;AACD;AACF;AACF;AACF,OAnBD;AAoBD,KArBD;;AAsBA,QAAI60C,SAAS,GAAG,YAAY;AAC1B,UAAI,CAACwgE,KAAK,CAAC5hJ,SAAN,CAAgB00D,cAArB,EAAqC;AACnCrhC,QAAAA,MAAM,CAAClK,EAAP,CAAU,WAAV,EAAuB,UAAUjd,CAAV,EAAa;AAClC,cAAI,CAACk/B,kBAAkB,CAACl/B,CAAD,CAAnB,IAA0BA,CAAC,CAACuE,MAAF,CAASqK,QAAT,KAAsB,MAApD,EAA4D;AAC1D,gBAAI+mI,MAAM,GAAGxuH,MAAM,CAACo6B,OAAP,EAAb;AACAo0F,YAAAA,MAAM,CAACC,IAAP;AACA3uH,YAAAA,KAAK,CAACC,gBAAN,CAAuBC,MAAvB,EAA+B,YAAY;AACzCwuH,cAAAA,MAAM,CAAClqG,KAAP;AACD,aAFD;AAGD;AACF,SARD;AASD;AACF,KAZD;;AAaA,QAAIoqG,qBAAqB,GAAG,YAAY;AACtC1uH,MAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,UAAUjd,CAAV,EAAa;AAC9B,YAAIuE,MAAM,GAAGvE,CAAC,CAACuE,MAAf;;AACA,YAAI,aAAavD,IAAb,CAAkBuD,MAAM,CAACqK,QAAzB,KAAsCzC,GAAG,CAAC2uC,wBAAJ,CAA6Bv2C,MAA7B,MAAyC,OAAnF,EAA4F;AAC1FvE,UAAAA,CAAC,CAACqgC,cAAF;AACAlZ,UAAAA,MAAM,CAACk6B,SAAP,CAAiBne,MAAjB,CAAwB3+B,MAAxB;AACA4iB,UAAAA,MAAM,CAAC2hD,WAAP;AACD;;AACD,YAAIvkE,MAAM,CAACqK,QAAP,KAAoB,GAApB,IAA2BzC,GAAG,CAACykC,QAAJ,CAAarsC,MAAb,EAAqB,iBAArB,CAA/B,EAAwE;AACtEvE,UAAAA,CAAC,CAACqgC,cAAF;AACAghB,UAAAA,SAAS,CAACne,MAAV,CAAiB3+B,MAAjB;AACD;AACF,OAXD;AAYD,KAbD;;AAcA,QAAIuxI,2CAA2C,GAAG,YAAY;AAC5D,UAAIC,yBAAyB,GAAG,YAAY;AAC1C,YAAIC,QAAQ,GAAG7pI,GAAG,CAAC6pC,UAAJ,CAAeqL,SAAS,CAACwoB,QAAV,GAAqB74B,SAArB,CAA+B,KAA/B,CAAf,CAAf;AACA,eAAO,YAAY;AACjB,cAAIzsC,MAAM,GAAG88C,SAAS,CAACwoB,QAAV,EAAb;;AACA,cAAItlE,MAAM,KAAK4iB,MAAM,CAACo6B,OAAP,EAAf,EAAiC;AAC/Bp1C,YAAAA,GAAG,CAAC8pC,SAAJ,CAAc1xC,MAAd,EAAsB,OAAtB,EAA+B,IAA/B;AACAxL,YAAAA,IAAI,CAACi9I,QAAD,EAAW,UAAUj9H,IAAV,EAAgB;AAC7BxU,cAAAA,MAAM,CAAC0xI,gBAAP,CAAwBl9H,IAAI,CAACi4B,SAAL,CAAe,IAAf,CAAxB;AACD,aAFG,CAAJ;AAGD;AACF,SARD;AASD,OAXD;;AAYA,UAAIklG,yBAAyB,GAAG,YAAY;AAC1C,eAAO,CAAC70F,SAAS,CAACkK,WAAV,EAAD,IAA4Bp/C,GAAG,CAACurC,SAAJ,CAAc2J,SAAS,CAACwoB,QAAV,EAAd,EAAoC19D,GAAG,CAAC4f,OAAxC,MAAqD5f,GAAG,CAACurC,SAAJ,CAAc2J,SAAS,CAACyoB,MAAV,EAAd,EAAkC39D,GAAG,CAAC4f,OAAtC,CAAxF;AACD,OAFD;;AAGA5E,MAAAA,MAAM,CAAClK,EAAP,CAAU,UAAV,EAAsB,UAAUjd,CAAV,EAAa;AACjC,YAAIsnI,eAAJ;;AACA,YAAI,CAACpoG,kBAAkB,CAACl/B,CAAD,CAAnB,KAA2BA,CAAC,CAACozF,OAAF,KAAc,CAAd,IAAmBpzF,CAAC,CAACozF,OAAF,KAAc,EAA5D,KAAmE8iD,yBAAyB,EAAhG,EAAoG;AAClG5O,UAAAA,eAAe,GAAGyO,yBAAyB,EAA3C;AACA5uH,UAAAA,MAAM,CAACm7C,MAAP,GAAgB0H,WAAhB,CAA4B,QAA5B,EAAsC,KAAtC,EAA6C,IAA7C;AACAs9D,UAAAA,eAAe;AACftnI,UAAAA,CAAC,CAACqgC,cAAF;AACA,iBAAO,KAAP;AACD;AACF,OATD;AAUAl0B,MAAAA,GAAG,CAACnT,IAAJ,CAASmuB,MAAM,CAACm7C,MAAP,EAAT,EAA0B,KAA1B,EAAiC,UAAUtiE,CAAV,EAAa;AAC5C,YAAIsnI,eAAJ;;AACA,YAAI,CAACpoG,kBAAkB,CAACl/B,CAAD,CAAnB,IAA0Bk2I,yBAAyB,EAAvD,EAA2D;AACzD5O,UAAAA,eAAe,GAAGyO,yBAAyB,EAA3C;AACA9uH,UAAAA,KAAK,CAACC,gBAAN,CAAuBC,MAAvB,EAA+B,YAAY;AACzCmgH,YAAAA,eAAe;AAChB,WAFD;AAGD;AACF,OARD;AASD,KAnCD;;AAoCA,QAAI6O,0BAA0B,GAAG,YAAY;AAC3ChvH,MAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAUjd,CAAV,EAAa;AAChC,YAAI,CAACk/B,kBAAkB,CAACl/B,CAAD,CAAnB,IAA0BA,CAAC,CAACozF,OAAF,KAAc3uB,SAA5C,EAAuD;AACrD,cAAIpjB,SAAS,CAACkK,WAAV,MAA2BlK,SAAS,CAACC,MAAV,GAAmBrG,WAAnB,KAAmC,CAAlE,EAAqE;AACnE,gBAAI7qC,eAAe,GAAGixC,SAAS,CAACoF,OAAV,GAAoBr2C,eAA1C;;AACA,gBAAIA,eAAe,IAAIA,eAAe,CAACxB,QAAnC,IAA+CwB,eAAe,CAACxB,QAAhB,CAAyBpM,WAAzB,OAA2C,OAA9F,EAAuG;AACrGxC,cAAAA,CAAC,CAACqgC,cAAF;AACA,qBAAO,KAAP;AACD;AACF;AACF;AACF,OAVD;AAWD,KAZD;;AAaA,QAAI+1G,2BAA2B,GAAG,YAAY;AAC5CjvH,MAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAUjd,CAAV,EAAa;AAChC,YAAIohD,GAAJ,EAASj3C,MAAT;;AACA,YAAI+0B,kBAAkB,CAACl/B,CAAD,CAAlB,IAAyBA,CAAC,CAACozF,OAAF,KAAc5uB,EAAE,CAACC,SAA9C,EAAyD;AACvD;AACD;;AACDrjB,QAAAA,GAAG,GAAGC,SAAS,CAACC,MAAV,EAAN;AACA,YAAI74C,SAAS,GAAG24C,GAAG,CAACryB,cAApB;AACA,YAAIhB,MAAM,GAAGqzB,GAAG,CAACnG,WAAjB;AACA,YAAI3xC,IAAI,GAAG6C,GAAG,CAACypC,OAAJ,EAAX;AACAzrC,QAAAA,MAAM,GAAG1B,SAAT;;AACA,YAAI,CAAC24C,GAAG,CAAC+K,SAAL,IAAkBp+B,MAAM,KAAK,CAAjC,EAAoC;AAClC;AACD;;AACD,eAAO5jB,MAAM,IAAIA,MAAM,CAACsF,UAAjB,IAA+BtF,MAAM,CAACsF,UAAP,CAAkBiB,UAAlB,KAAiCvG,MAAhE,IAA0EA,MAAM,CAACsF,UAAP,KAAsBnG,IAAvG,EAA6G;AAC3Ga,UAAAA,MAAM,GAAGA,MAAM,CAACsF,UAAhB;AACD;;AACD,YAAItF,MAAM,CAACkN,OAAP,KAAmB,YAAvB,EAAqC;AACnC8P,UAAAA,MAAM,CAACq1C,SAAP,CAAiB++B,MAAjB,CAAwB,YAAxB,EAAsC,IAAtC,EAA4CpxF,MAA5C;AACAi3C,UAAAA,GAAG,GAAGj1C,GAAG,CAAC+tC,SAAJ,EAAN;AACAkH,UAAAA,GAAG,CAAC5G,QAAJ,CAAa/xC,SAAb,EAAwB,CAAxB;AACA24C,UAAAA,GAAG,CAAC3G,MAAJ,CAAWhyC,SAAX,EAAsB,CAAtB;AACA44C,UAAAA,SAAS,CAACiZ,MAAV,CAAiBlZ,GAAjB;AACD;AACF,OAvBD;AAwBD,KAzBD;;AA0BA,QAAIi1F,sBAAsB,GAAG,YAAY;AACvC,UAAIC,OAAO,GAAG,YAAY;AACxB9B,QAAAA,qBAAqB,CAAC,cAAD,EAAiB,KAAjB,CAArB;AACAA,QAAAA,qBAAqB,CAAC,0BAAD,EAA6B,KAA7B,CAArB;;AACA,YAAI,CAACllF,iBAAiB,CAACnoC,MAAD,CAAtB,EAAgC;AAC9BqtH,UAAAA,qBAAqB,CAAC,sBAAD,EAAyB,KAAzB,CAArB;AACD;AACF,OAND;;AAOA,UAAI,CAAC3jF,UAAU,CAAC1pC,MAAD,CAAf,EAAyB;AACvBA,QAAAA,MAAM,CAAClK,EAAP,CAAU,6BAAV,EAAyCq5H,OAAzC;AACD;AACF,KAXD;;AAYA,QAAIC,mBAAmB,GAAG,YAAY;AACpC,UAAIC,QAAQ,GAAG,YAAY;AACzBz9I,QAAAA,IAAI,CAACoT,GAAG,CAAC+2B,MAAJ,CAAW,GAAX,CAAD,EAAkB,UAAUn3B,IAAV,EAAgB;AACpC,cAAI0D,UAAU,GAAG1D,IAAI,CAAC0D,UAAtB;AACA,cAAInG,IAAI,GAAG6C,GAAG,CAACypC,OAAJ,EAAX;;AACA,cAAInmC,UAAU,CAACkB,SAAX,KAAyB5E,IAA7B,EAAmC;AACjC,mBAAO0D,UAAU,IAAI,CAACtD,GAAG,CAAC4f,OAAJ,CAAYtc,UAAZ,CAAtB,EAA+C;AAC7C,kBAAIA,UAAU,CAACA,UAAX,CAAsBkB,SAAtB,KAAoClB,UAApC,IAAkDA,UAAU,KAAKnG,IAArE,EAA2E;AACzE;AACD;;AACDmG,cAAAA,UAAU,GAAGA,UAAU,CAACA,UAAxB;AACD;;AACDtD,YAAAA,GAAG,CAACqoB,GAAJ,CAAQ/kB,UAAR,EAAoB,IAApB,EAA0B;AAAE,gCAAkB;AAApB,aAA1B;AACD;AACF,SAZG,CAAJ;AAaD,OAdD;;AAeA0X,MAAAA,MAAM,CAAClK,EAAP,CAAU,wBAAV,EAAoC,UAAUjd,CAAV,EAAa;AAC/C,YAAIA,CAAC,CAAC7F,IAAF,KAAW,YAAX,IAA2B6F,CAAC,CAACkqH,OAAF,KAAc,eAA7C,EAA8D;AAC5DssB,UAAAA,QAAQ;AACT;AACF,OAJD;AAKD,KArBD;;AAsBA,QAAIC,mBAAmB,GAAG,YAAY;AACpC,UAAIlpF,kBAAkB,CAACpmC,MAAD,CAAtB,EAAgC;AAC9BA,QAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,YAAY;AAC5Bu3H,UAAAA,qBAAqB,CAAC,2BAAD,EAA8BjnF,kBAAkB,CAACpmC,MAAD,CAAhD,CAArB;AACD,SAFD;AAGD;AACF,KAND;;AAOA,QAAI6tD,kBAAkB,GAAG,YAAY;AACnC7tD,MAAAA,MAAM,CAAClK,EAAP,CAAU,uBAAV,EAAmC,UAAUjd,CAAV,EAAa;AAC9C,YAAI,CAACwkE,EAAE,CAACY,eAAH,CAAmBplE,CAAnB,CAAL,EAA4B;AAC1BqhD,UAAAA,SAAS,CAAC+qB,SAAV;AACD;AACF,OAJD,EAIG,IAJH;AAKD,KAND;;AAOA,QAAIsqE,mBAAmB,GAAG,YAAY;AACpCvvH,MAAAA,MAAM,CAACwvH,aAAP,CAAqBx7I,IAArB,CAA0B,sBAAsB,iCAAtB,GAA0D,iBAA1D,GAA8E,iBAA9E,GAAkG,GAA5H;AACD,KAFD;;AAGA,QAAIy7I,qBAAqB,GAAG,YAAY;AACtC,UAAI,CAACzvH,MAAM,CAAC+R,MAAZ,EAAoB;AAClB/R,QAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,YAAY;AAC/B,cAAI3U,QAAQ,CAACojC,aAAT,KAA2BpjC,QAAQ,CAAC+K,IAAxC,EAA8C;AAC5C8T,YAAAA,MAAM,CAACgrD,MAAP,GAAgB1mC,KAAhB;AACD;AACF,SAJD;AAKD;AACF,KARD;;AASA,QAAIorG,UAAU,GAAG,YAAY;AAC3B,UAAI,CAAC1vH,MAAM,CAAC+R,MAAZ,EAAoB;AAClB/R,QAAAA,MAAM,CAACwvH,aAAP,CAAqBx7I,IAArB,CAA0B,0BAA1B;AACAgsB,QAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,UAAUjd,CAAV,EAAa;AAC9B,cAAIohD,GAAJ;;AACA,cAAIphD,CAAC,CAACuE,MAAF,CAASqK,QAAT,KAAsB,MAA1B,EAAkC;AAChC,gBAAIhH,GAAG,CAAChD,EAAJ,GAAS,EAAb,EAAiB;AACfuiB,cAAAA,MAAM,CAACo6B,OAAP,GAAiB9V,KAAjB;AACA;AACD;;AACD2V,YAAAA,GAAG,GAAGj6B,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAN;AACAn6B,YAAAA,MAAM,CAACo6B,OAAP,GAAiB9V,KAAjB;AACAtkB,YAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB;AACAj6B,YAAAA,MAAM,CAACk6B,SAAP,CAAiB+qB,SAAjB;AACAjlD,YAAAA,MAAM,CAAC2hD,WAAP;AACD;AACF,SAbD;AAcD;AACF,KAlBD;;AAmBA,QAAIguE,uBAAuB,GAAG,YAAY;AACxC,UAAIlvI,GAAG,CAACE,GAAR,EAAa;AACXqf,QAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,UAAUjd,CAAV,EAAa;AAChC,cAAIwkE,EAAE,CAACgB,cAAH,CAAkBxlE,CAAlB,KAAwB,CAACA,CAAC,CAACqlE,QAA3B,KAAwCrlE,CAAC,CAACozF,OAAF,KAAc,EAAd,IAAoBpzF,CAAC,CAACozF,OAAF,KAAc,EAA1E,CAAJ,EAAmF;AACjFpzF,YAAAA,CAAC,CAACqgC,cAAF;AACA,gBAAI02G,WAAW,GAAG5vH,MAAM,CAACk6B,SAAP,CAAiBif,MAAjB,EAAlB;AACAy2E,YAAAA,WAAW,CAAC9hB,MAAZ,CAAmB,MAAnB,EAA2Bj1H,CAAC,CAACozF,OAAF,KAAc,EAAd,GAAmB,UAAnB,GAAgC,SAA3D,EAAsE,cAAtE;AACD;AACF,SAND;AAOD;AACF,KAVD;;AAWA,QAAI4jD,oBAAoB,GAAG,YAAY;AACrCxC,MAAAA,qBAAqB,CAAC,eAAD,EAAkB,KAAlB,CAArB;AACD,KAFD;;AAGA,QAAIyC,iBAAiB,GAAG,YAAY;AAClC9vH,MAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,UAAUjd,CAAV,EAAa;AAC9B,YAAIka,GAAG,GAAGla,CAAC,CAACuE,MAAZ;;AACA,WAAG;AACD,cAAI2V,GAAG,CAAC7C,OAAJ,KAAgB,GAApB,EAAyB;AACvBrX,YAAAA,CAAC,CAACqgC,cAAF;AACA;AACD;AACF,SALD,QAKSnmB,GAAG,GAAGA,GAAG,CAACzK,UALnB;AAMD,OARD;AASA0X,MAAAA,MAAM,CAACwvH,aAAP,CAAqBx7I,IAArB,CAA0B,iDAA1B;AACD,KAXD;;AAYA,QAAI+7I,2BAA2B,GAAG,YAAY;AAC5C/vH,MAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,YAAY;AAC5BkK,QAAAA,MAAM,CAAChb,GAAP,CAAWnT,IAAX,CAAgBmuB,MAAM,CAACo6B,OAAP,EAAhB,EAAkC,QAAlC,EAA4C,UAAUvhD,CAAV,EAAa;AACvDA,UAAAA,CAAC,CAACqgC,cAAF;AACD,SAFD;AAGD,OAJD;AAKD,KAND;;AAOA,QAAI82G,yBAAyB,GAAG,YAAY;AAC1CvpD,MAAAA,MAAM,CAACvqC,aAAP,CAAqB,IAArB,EAA2B,UAAUrpC,KAAV,EAAiB;AAC1C,YAAI3kB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;;AACA,eAAOE,CAAC,EAAR,EAAY;AACV,cAAI2kB,KAAK,CAAC3kB,CAAD,CAAL,CAAS0jB,IAAT,CAAc,OAAd,MAA2B,2BAA/B,EAA4D;AAC1DiB,YAAAA,KAAK,CAAC3kB,CAAD,CAAL,CAAS2d,MAAT;AACD;AACF;AACF,OAPD;AAQD,KATD;;AAUA,QAAIokI,qBAAqB,GAAG,YAAY;AACtCjwH,MAAAA,MAAM,CAAClK,EAAP,CAAU,WAAV,EAAuB,UAAUjd,CAAV,EAAa;AAClCy0I,QAAAA,qBAAqB,CAACz0I,CAAD,CAArB;AACD,OAFD;AAGAmnB,MAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,UAAUjd,CAAV,EAAa;AAC7B,YAAI,CAACk/B,kBAAkB,CAACl/B,CAAD,CAAvB,EAA4B;AAC1B,cAAI20I,eAAe,GAAGE,qBAAqB,CAAC70I,CAAD,CAA3C;;AACA,cAAI20I,eAAe,IAAIA,eAAe,CAAC38I,EAAhB,KAAuBmvB,MAAM,CAACnvB,EAArD,EAAyD;AACvDgI,YAAAA,CAAC,CAACqgC,cAAF;AACA,gBAAI+gB,GAAG,GAAG0pB,WAAW,CAAC9qE,CAAC,CAACtM,CAAH,EAAMsM,CAAC,CAACjL,CAAR,EAAWoyB,MAAM,CAACm7C,MAAP,EAAX,CAArB;AACAjhB,YAAAA,SAAS,CAACiZ,MAAV,CAAiBlZ,GAAjB;AACA0zF,YAAAA,uBAAuB,CAACH,eAAe,CAACzpI,IAAjB,EAAuB,IAAvB,CAAvB;AACD;AACF;AACF,OAVD;AAWD,KAfD;;AAgBA,QAAI2qE,sBAAsB,GAAG7/E,IAA7B;;AACA,QAAIgjD,QAAQ,GAAG,YAAY;AACzB,UAAI,CAACo7F,OAAD,IAAYjtH,MAAM,CAACC,OAAvB,EAAgC;AAC9B,eAAO,KAAP;AACD;;AACD,UAAI05C,GAAG,GAAG35C,MAAM,CAACk6B,SAAP,CAAiBif,MAAjB,EAAV;AACA,aAAO,CAACQ,GAAD,IAAQ,CAACA,GAAG,CAACjB,UAAb,IAA2BiB,GAAG,CAACjB,UAAJ,KAAmB,CAArD;AACD,KAND;;AAOAu2E,IAAAA,2BAA2B;AAC3BnB,IAAAA,uBAAuB;;AACvB,QAAI,CAACrtI,GAAG,CAACD,YAAT,EAAuB;AACrBqtE,MAAAA,kBAAkB;AACnB;;AACD,QAAIq/D,QAAJ,EAAc;AACZmB,MAAAA,gBAAgB;AAChBK,MAAAA,qBAAqB;AACrBY,MAAAA,mBAAmB;AACnBS,MAAAA,2BAA2B;AAC3Bf,MAAAA,0BAA0B;AAC1BgB,MAAAA,yBAAyB;;AACzB,UAAIvvI,GAAG,CAACG,GAAR,EAAa;AACX6uI,QAAAA,qBAAqB;AACrBC,QAAAA,UAAU;AACVI,QAAAA,iBAAiB;AAClB,OAJD,MAIO;AACL3B,QAAAA,SAAS;AACV;AACF;;AACD,QAAI1tI,GAAG,CAAChD,EAAJ,IAAU,EAAd,EAAkB;AAChBiyI,MAAAA,UAAU;AACVV,MAAAA,0BAA0B;AAC3B;;AACD,QAAIvuI,GAAG,CAAChD,EAAR,EAAY;AACV0wI,MAAAA,SAAS;AACT0B,MAAAA,oBAAoB;AACpBI,MAAAA,qBAAqB;AACtB;;AACD,QAAIhD,OAAJ,EAAa;AACXqB,MAAAA,mBAAmB;AACnBvgE,MAAAA,SAAS;AACT4gE,MAAAA,2CAA2C;AAC3CO,MAAAA,sBAAsB;AACtBE,MAAAA,mBAAmB;AACnBG,MAAAA,mBAAmB;AACnBI,MAAAA,uBAAuB;AACvBX,MAAAA,0BAA0B;AAC3B;;AACD,WAAO;AACLtgE,MAAAA,sBAAsB,EAAEA,sBADnB;AAEL78B,MAAAA,QAAQ,EAAEA;AAFL,KAAP;AAID,GAxaD;;AA0aA,MAAIq+F,KAAK,GAAGniG,QAAQ,CAAC2D,GAArB;;AACA,MAAIy+F,WAAW,GAAG,UAAUnwH,MAAV,EAAkBlb,IAAlB,EAAwB;AACxC,QAAIoH,IAAI,GAAG9G,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAX;AACA,QAAI94C,SAAS,GAAG4I,iBAAiB,CAACF,WAAW,CAACkC,IAAD,CAAZ,CAAjC;AACA,QAAI8E,KAAK,GAAG5L,YAAY,CAACV,OAAb,CAAqB,OAArB,CAAZ;AACAyM,IAAAA,GAAG,CAACH,KAAD,EAAQ,MAAR,EAAgB,UAAhB,CAAH;AACA9F,IAAAA,MAAM,CAAC8F,KAAD,EAAQ5L,YAAY,CAACP,QAAb,CAAsBC,IAAtB,CAAR,CAAN;AACAoG,IAAAA,MAAM,CAAC5J,SAAD,EAAY0P,KAAZ,CAAN;AACAgP,IAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB,YAAY;AAC9BjK,MAAAA,MAAM,CAACmF,KAAD,CAAN;AACD,KAFD;AAGD,GAVD;;AAWA,MAAIo/H,WAAW,GAAG,UAAUpwH,MAAV,EAAkB;AAClC,WAAOA,MAAM,CAAC+R,MAAP,GAAgB/R,MAAM,CAACsoC,UAAP,GAAoB7gD,QAApB,CAA6BpM,WAA7B,EAAhB,GAA6D7O,SAApE;AACD,GAFD;;AAGA,MAAI6jJ,eAAe,GAAG,UAAUn6I,GAAV,EAAe;AACnC,WAAOW,QAAQ,CAACX,GAAD,EAAM,UAAUzD,CAAV,EAAa;AAChC,aAAOe,WAAW,CAACf,CAAD,CAAX,KAAmB,KAA1B;AACD,KAFc,CAAf;AAGD,GAJD;;AAKA,MAAI69I,gBAAgB,GAAG,UAAUtwH,MAAV,EAAkB;AACvC,QAAIM,QAAQ,GAAGN,MAAM,CAACM,QAAtB;AACA,QAAIkmF,SAAS,GAAGxmF,MAAM,CAACwuF,YAAP,CAAoBhI,SAApC;AACA,WAAO6pC,eAAe,CAAC;AACrBt8D,MAAAA,0BAA0B,EAAEzzD,QAAQ,CAACyzD,0BADhB;AAErBzC,MAAAA,oBAAoB,EAAEhxD,QAAQ,CAACgxD,oBAFV;AAGrB36C,MAAAA,mBAAmB,EAAErW,QAAQ,CAACqW,mBAHT;AAIrB0yE,MAAAA,0BAA0B,EAAE/oF,QAAQ,CAAC+oF,0BAJhB;AAKrB5yE,MAAAA,iBAAiB,EAAEnW,QAAQ,CAACmW,iBALP;AAMrB2yE,MAAAA,wBAAwB,EAAE9oF,QAAQ,CAAC8oF,wBANd;AAOrBvE,MAAAA,sBAAsB,EAAEvkF,QAAQ,CAACukF,sBAPZ;AAQrByE,MAAAA,iBAAiB,EAAEhpF,QAAQ,CAACgpF,iBARP;AASrBxE,MAAAA,uBAAuB,EAAExkF,QAAQ,CAACwkF,uBATb;AAUrB1R,MAAAA,iBAAiB,EAAE9yE,QAAQ,CAAC8yE,iBAVP;AAWrB9D,MAAAA,uBAAuB,EAAEhvE,QAAQ,CAACgvE,uBAXb;AAYrBoY,MAAAA,kBAAkB,EAAEpnF,QAAQ,CAAConF,kBAZR;AAarBtyB,MAAAA,cAAc,EAAE90D,QAAQ,CAAC80D,cAbJ;AAcrB0zB,MAAAA,mBAAmB,EAAExoF,QAAQ,CAACwoF,mBAdT;AAerB9D,MAAAA,aAAa,EAAE1kF,QAAQ,CAAC0kF,aAfH;AAgBrBgF,MAAAA,SAAS,EAAEomC,WAAW,CAACpwH,MAAD,CAhBD;AAiBrB2rD,MAAAA,QAAQ,EAAE,IAjBW;AAkBrB68B,MAAAA,UAAU,EAAEhC,SAlBS;AAmBrB4B,MAAAA,qBAAqB,EAAE9nF,QAAQ,CAAC8nF;AAnBX,KAAD,CAAtB;AAqBD,GAxBD;;AAyBA,MAAImoC,oBAAoB,GAAG,UAAUvwH,MAAV,EAAkB;AAC3C,QAAIM,QAAQ,GAAGN,MAAM,CAACM,QAAtB;AACA,WAAO7nB,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK63I,gBAAgB,CAACtwH,MAAD,CAArB,CAAT,EAAyCqwH,eAAe,CAAC;AACtE76G,MAAAA,aAAa,EAAElV,QAAQ,CAACkV,aAD8C;AAEtEE,MAAAA,mBAAmB,EAAEpV,QAAQ,CAACoV,mBAFwC;AAGtE0hD,MAAAA,cAAc,EAAE92D,QAAQ,CAAC82D,cAH6C;AAItEvrD,MAAAA,QAAQ,EAAEvL,QAAQ,CAACuL,QAJmD;AAKtEqrD,MAAAA,eAAe,EAAE52D,QAAQ,CAAC42D,eAL4C;AAMtEL,MAAAA,MAAM,EAAEv2D,QAAQ,CAACu2D,MANqD;AAOtEI,MAAAA,YAAY,EAAE32D,QAAQ,CAAC22D,YAP+C;AAQtEF,MAAAA,aAAa,EAAEz2D,QAAQ,CAACy2D,aAR8C;AAStEllD,MAAAA,cAAc,EAAEvR,QAAQ,CAACuR,cAT6C;AAUtE2+G,MAAAA,kBAAkB,EAAElwH,QAAQ,CAACkwH,kBAVyC;AAWtEj+G,MAAAA,eAAe,EAAEjS,QAAQ,CAACiS,eAX4C;AAYtEE,MAAAA,uBAAuB,EAAEnS,QAAQ,CAACmS,uBAZoC;AAatEc,MAAAA,gBAAgB,EAAEjT,QAAQ,CAACiT,gBAb2C;AActEzE,MAAAA,cAAc,EAAExO,QAAQ,CAACwO,cAd6C;AAetE2hH,MAAAA,mCAAmC,EAAEnwH,QAAQ,CAACmwH,mCAfwB;AAgBtEC,MAAAA,kBAAkB,EAAEpwH,QAAQ,CAACowH,kBAhByC;AAiBtE5jH,MAAAA,MAAM,EAAExM,QAAQ,CAACwM,MAjBqD;AAkBtE8nD,MAAAA,qBAAqB,EAAEt0D,QAAQ,CAACs0D,qBAlBsC;AAmBtE+7D,MAAAA,oBAAoB,EAAErwH,QAAQ,CAACqwH,oBAnBuC;AAoBtEhhH,MAAAA,OAAO,EAAErP,QAAQ,CAACqP,OApBoD;AAqBtEiC,MAAAA,mBAAmB,EAAEtR,QAAQ,CAACsR,mBArBwC;AAsBtEg/G,MAAAA,oBAAoB,EAAEtwH,QAAQ,CAACswH,oBAtBuC;AAuBtEp+G,MAAAA,cAAc,EAAElS,QAAQ,CAACkS,cAvB6C;AAwBtExD,MAAAA,aAAa,EAAE1O,QAAQ,CAAC0O,aAxB8C;AAyBtEN,MAAAA,cAAc,EAAEpO,QAAQ,CAACoO,cAzB6C;AA0BtEE,MAAAA,YAAY,EAAEtO,QAAQ,CAACsO,YA1B+C;AA2BtEH,MAAAA,WAAW,EAAEnO,QAAQ,CAACmO,WA3BgD;AA4BtEoiH,MAAAA,mBAAmB,EAAEvwH,QAAQ,CAACuwH;AA5BwC,KAAD,CAAxD,CAAf;AA8BD,GAhCD;;AAiCA,MAAIC,YAAY,GAAG,UAAU9wH,MAAV,EAAkB;AACnC,QAAIymE,MAAM,GAAGojB,SAAS,CAACymC,gBAAgB,CAACtwH,MAAD,CAAjB,EAA2BA,MAAM,CAAC8M,MAAlC,CAAtB;AACA25D,IAAAA,MAAM,CAACmiB,kBAAP,CAA0B,yBAA1B,EAAqD,UAAU/1F,KAAV,EAAiB/lB,IAAjB,EAAuB;AAC1E,UAAIoB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AAAA,UAAsB4W,IAAtB;AAAA,UAA4BlV,KAA5B;AACA,UAAIsV,GAAG,GAAGgb,MAAM,CAAChb,GAAjB;AACA,UAAI8mG,YAAY,GAAG,cAAch/G,IAAjC;;AACA,aAAOoB,CAAC,EAAR,EAAY;AACV0W,QAAAA,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAZ;AACAwB,QAAAA,KAAK,GAAGkV,IAAI,CAACgN,IAAL,CAAU9kB,IAAV,CAAR;;AACA,YAAI4C,KAAK,IAAI,CAACkV,IAAI,CAACgN,IAAL,CAAUk6F,YAAV,CAAd,EAAuC;AACrC,cAAIp8G,KAAK,CAACzC,OAAN,CAAc,OAAd,MAA2B,CAA3B,IAAgCyC,KAAK,CAACzC,OAAN,CAAc,OAAd,MAA2B,CAA/D,EAAkE;AAChE;AACD;;AACD,cAAIH,IAAI,KAAK,OAAb,EAAsB;AACpB4C,YAAAA,KAAK,GAAGsV,GAAG,CAACwsC,cAAJ,CAAmBxsC,GAAG,CAACssC,UAAJ,CAAe5hD,KAAf,CAAnB,EAA0CkV,IAAI,CAAC9X,IAA/C,CAAR;;AACA,gBAAI,CAAC4C,KAAK,CAAC1B,MAAX,EAAmB;AACjB0B,cAAAA,KAAK,GAAG,IAAR;AACD;;AACDkV,YAAAA,IAAI,CAACgN,IAAL,CAAUk6F,YAAV,EAAwBp8G,KAAxB;AACAkV,YAAAA,IAAI,CAACgN,IAAL,CAAU9kB,IAAV,EAAgB4C,KAAhB;AACD,WAPD,MAOO,IAAI5C,IAAI,KAAK,UAAb,EAAyB;AAC9B8X,YAAAA,IAAI,CAACgN,IAAL,CAAUk6F,YAAV,EAAwBp8G,KAAxB;AACAkV,YAAAA,IAAI,CAACgN,IAAL,CAAU9kB,IAAV,EAAgB,IAAhB;AACD,WAHM,MAGA;AACL8X,YAAAA,IAAI,CAACgN,IAAL,CAAUk6F,YAAV,EAAwB9rF,MAAM,CAACyxF,UAAP,CAAkB/hH,KAAlB,EAAyB5C,IAAzB,EAA+B8X,IAAI,CAAC9X,IAApC,CAAxB;AACD;AACF;AACF;AACF,KA1BD;AA2BA25F,IAAAA,MAAM,CAACvqC,aAAP,CAAqB,QAArB,EAA+B,UAAUrpC,KAAV,EAAiB;AAC9C,UAAI3kB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;;AACA,aAAOE,CAAC,EAAR,EAAY;AACV,YAAI0W,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAhB;AACA,YAAI8E,IAAI,GAAG4R,IAAI,CAACgN,IAAL,CAAU,MAAV,KAAqB,SAAhC;;AACA,YAAI5e,IAAI,CAAC/F,OAAL,CAAa,MAAb,MAAyB,CAA7B,EAAgC;AAC9B2X,UAAAA,IAAI,CAACgN,IAAL,CAAU,MAAV,EAAkB,SAAS5e,IAA3B;AACD;AACF;AACF,KATD;;AAUA,QAAIgtB,MAAM,CAACM,QAAP,CAAgB80D,cAApB,EAAoC;AAClCqR,MAAAA,MAAM,CAACvqC,aAAP,CAAqB,QAArB,EAA+B,UAAUrpC,KAAV,EAAiB;AAC9C,YAAI3kB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;;AACA,eAAOE,CAAC,EAAR,EAAY;AACV,cAAI0W,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAhB;AACA0W,UAAAA,IAAI,CAAC5R,IAAL,GAAY,CAAZ;AACA4R,UAAAA,IAAI,CAAC9X,IAAL,GAAY,UAAZ;AACA8X,UAAAA,IAAI,CAAClV,KAAL,GAAa,YAAYswB,MAAM,CAAChb,GAAP,CAAWgxB,MAAX,CAAkBpxB,IAAI,CAAClV,KAAvB,CAAZ,GAA4C,IAAzD;AACD;AACF,OARD;AASD;;AACD+2F,IAAAA,MAAM,CAACvqC,aAAP,CAAqB,yBAArB,EAAgD,UAAUrpC,KAAV,EAAiB;AAC/D,UAAI3kB,CAAC,GAAG2kB,KAAK,CAAC7kB,MAAd;AACA,UAAIw1F,gBAAgB,GAAGxjE,MAAM,CAAC8M,MAAP,CAAcmH,mBAAd,EAAvB;;AACA,aAAO/lC,CAAC,EAAR,EAAY;AACV,YAAI0W,IAAI,GAAGiO,KAAK,CAAC3kB,CAAD,CAAhB;;AACA,YAAI0W,IAAI,CAAC+kB,OAAL,CAAa65D,gBAAb,KAAkC5+E,IAAI,CAACu3D,MAAL,CAAY,IAAZ,EAAkBnuE,MAAlB,KAA6B,CAAnE,EAAsE;AACpE4W,UAAAA,IAAI,CAACsG,MAAL,CAAY,IAAI6kE,OAAJ,CAAY,IAAZ,EAAkB,CAAlB,CAAZ,EAAkCK,UAAlC,GAA+C,IAA/C;AACD;AACF;AACF,KATD;AAUA,WAAOqW,MAAP;AACD,GA7DD;;AA8DA,MAAIsqD,SAAS,GAAG,UAAU/wH,MAAV,EAAkB;AAChC,QAAIA,MAAM,CAACM,QAAP,CAAgB0wH,UAApB,EAAgC;AAC9BlxH,MAAAA,KAAK,CAACC,gBAAN,CAAuBC,MAAvB,EAA+B,YAAY;AACzC,YAAIwuD,WAAJ;;AACA,YAAIxuD,MAAM,CAACM,QAAP,CAAgB0wH,UAAhB,KAA+B,IAAnC,EAAyC;AACvCxiE,UAAAA,WAAW,GAAGxuD,MAAd;AACD,SAFD,MAEO;AACLwuD,UAAAA,WAAW,GAAGxuD,MAAM,CAACmtD,aAAP,CAAqBx3E,GAArB,CAAyBqqB,MAAM,CAACM,QAAP,CAAgB0wH,UAAzC,CAAd;AACD;;AACD,YAAI,CAACxiE,WAAW,CAACqgC,SAAjB,EAA4B;AAC1BrgC,UAAAA,WAAW,CAAClqC,KAAZ;AACD;AACF,OAVD,EAUG,GAVH;AAWD;AACF,GAdD;;AAeA,MAAI2sG,iCAAiC,GAAG,UAAUjxH,MAAV,EAAkB;AACxD,QAAI7d,IAAI,GAAG6d,MAAM,CAAChb,GAAP,CAAWypC,OAAX,EAAX;;AACA,QAAI,CAACzuB,MAAM,CAAC+R,MAAR,KAAmB,CAAC2nC,YAAY,CAAC15C,MAAD,CAAb,IAAyBA,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,CAA0B,IAA1B,MAAoCvgE,IAAhF,CAAJ,EAA2F;AACzFmvD,MAAAA,eAAe,CAACnvD,IAAD,CAAf,CAAsBvQ,IAAtB,CAA2B,UAAU6hB,GAAV,EAAe;AACxC,YAAI7O,IAAI,GAAG6O,GAAG,CAAC6rC,OAAJ,EAAX;AACA,YAAIwuB,QAAQ,GAAG79D,OAAO,CAACrL,IAAD,CAAP,GAAgB0sD,eAAe,CAAC1sD,IAAD,CAAf,CAAsBxT,KAAtB,CAA4BqiB,GAA5B,CAAhB,GAAmDA,GAAlE;;AACA,YAAIhT,GAAG,CAACjH,OAAJ,CAAY2E,IAAZ,EAAJ,EAAwB;AACtB4tE,UAAAA,WAAW,CAAC/rD,MAAD,EAAS8tD,QAAQ,CAAChsB,OAAT,EAAT,CAAX;AACD,SAFD,MAEO;AACL9hC,UAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwB2a,QAAQ,CAAChsB,OAAT,EAAxB;AACD;AACF,OARD;AASD;AACF,GAbD;;AAcA,MAAIovF,UAAU,GAAG,UAAUlxH,MAAV,EAAkB;AACjCA,IAAAA,MAAM,CAACmxH,yBAAP;AACAnxH,IAAAA,MAAM,CAAC6lH,WAAP,GAAqB,IAArB;AACA5oE,IAAAA,QAAQ,CAACj9C,MAAD,CAAR;AACAA,IAAAA,MAAM,CAACskB,KAAP,CAAa,IAAb;AACA2sG,IAAAA,iCAAiC,CAACjxH,MAAD,CAAjC;AACAA,IAAAA,MAAM,CAAC2hD,WAAP,CAAmB;AAAEnsB,MAAAA,OAAO,EAAE;AAAX,KAAnB;AACAx1B,IAAAA,MAAM,CAACoxH,YAAP,CAAoB,wBAApB,EAA8CpxH,MAA9C;AACA+wH,IAAAA,SAAS,CAAC/wH,MAAD,CAAT;AACD,GATD;;AAUA,MAAIqxH,mBAAmB,GAAG,UAAUrxH,MAAV,EAAkB;AAC1C,WAAOA,MAAM,CAAC+R,MAAP,GAAgB/R,MAAM,CAACsxH,EAAP,CAAUjjG,gBAA1B,GAA6CruB,MAAM,CAAChb,GAAP,CAAWqpC,gBAA/D;AACD,GAFD;;AAGA,MAAIkjG,6BAA6B,GAAG,UAAUvxH,MAAV,EAAkB/N,GAAlB,EAAuBu/H,WAAvB,EAAoC;AACtE,QAAInqC,QAAQ,GAAG,CAAC,IAAIroF,UAAJ,CAAe,UAAUjc,OAAV,EAAmB4U,MAAnB,EAA2B;AACtD,aAAO05H,mBAAmB,CAACrxH,MAAD,CAAnB,CAA4B0C,OAA5B,CAAoCzQ,GAApC,EAAyClP,OAAzC,EAAkD4U,MAAlD,CAAP;AACD,KAFa,CAAD,CAAf;;AAGA,QAAIqI,MAAM,CAAC+R,MAAX,EAAmB;AACjB,aAAOs1E,QAAP;AACD,KAFD,MAEO;AACL,aAAOA,QAAQ,CAACp3G,MAAT,CAAgB,CAAC,IAAI+uB,UAAJ,CAAe,UAAUjc,OAAV,EAAmB4U,MAAnB,EAA2B;AAC9D,eAAOqI,MAAM,CAACsxH,EAAP,CAAUjjG,gBAAV,CAA2B3rB,OAA3B,CAAmC8uH,WAAnC,EAAgDzuI,OAAhD,EAAyD4U,MAAzD,CAAP;AACD,OAFqB,CAAD,CAAhB,CAAP;AAGD;AACF,GAXD;;AAYA,MAAI85H,cAAc,GAAG,UAAUzxH,MAAV,EAAkB/N,GAAlB,EAAuB;AAC1C,QAAIo8B,gBAAgB,GAAGgjG,mBAAmB,CAACrxH,MAAD,CAA1C;AACA,QAAIgoC,OAAO,GAAGD,UAAU,CAAC/nC,MAAD,CAAxB;;AACA,QAAI0xH,SAAS,GAAG,YAAY;AAC1BrjG,MAAAA,gBAAgB,CAACvrB,SAAjB,CAA2B7Q,GAA3B;;AACA,UAAI,CAAC+N,MAAM,CAAC+R,MAAZ,EAAoB;AAClB/R,QAAAA,MAAM,CAACsxH,EAAP,CAAUjjG,gBAAV,CAA2BvrB,SAA3B,CAAqCklC,OAArC;AACD;AACF,KALD;;AAMA,QAAIizD,MAAM,GAAG,YAAY;AACvB,UAAIj7F,MAAM,CAACC,OAAX,EAAoB;AAClByxH,QAAAA,SAAS;AACV,OAFD,MAEO;AACL1xH,QAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB47H,SAApB;AACAR,QAAAA,UAAU,CAAClxH,MAAD,CAAV;AACD;AACF,KAPD;;AAQAhB,IAAAA,UAAU,CAAChvB,GAAX,CAAeuhJ,6BAA6B,CAACvxH,MAAD,EAAS/N,GAAT,EAAc+1C,OAAd,CAA5C,EAAoElwC,IAApE,CAAyEmjG,MAAzE,EAAiFl8F,KAAjF,CAAuFk8F,MAAvF;AACD,GAlBD;;AAmBA,MAAI02B,OAAO,GAAG,UAAU3xH,MAAV,EAAkB4xH,OAAlB,EAA2B;AACvC,QAAItxH,QAAQ,GAAGN,MAAM,CAACM,QAAtB;AAAA,QAAgCrc,GAAG,GAAG+b,MAAM,CAACm7C,MAAP,EAAtC;AAAA,QAAuDjvD,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAA9D;;AACA,QAAI,CAAC95B,QAAQ,CAACuxH,kBAAV,IAAgC,CAACvxH,QAAQ,CAACwxH,gBAA9C,EAAgE;AAC9D7tI,MAAAA,GAAG,CAACiI,IAAJ,CAAS6lI,UAAT,GAAsB,KAAtB;AACA7B,MAAAA,KAAK,CAACphG,SAAN,CAAgB5iC,IAAhB,EAAsB,YAAtB,EAAoC,OAApC;AACD;;AACD8T,IAAAA,MAAM,CAACyuD,MAAP,GAAgBu+D,MAAM,CAAChtH,MAAD,CAAtB;AACAg9C,IAAAA,cAAc,CAACh9C,MAAD,CAAd;AACA,QAAIgyH,cAAc,GAAG/pF,iBAAiB,CAACjoC,MAAD,CAAtC;;AACA,QAAIgyH,cAAc,KAAKxlJ,SAAvB,EAAkC;AAChC0f,MAAAA,IAAI,CAACyK,GAAL,GAAWq7H,cAAX;AACD;;AACD,QAAI1xH,QAAQ,CAAC2xH,OAAb,EAAsB;AACpBjyH,MAAAA,MAAM,CAAClK,EAAP,CAAU,kBAAV,EAA8B,UAAUjd,CAAV,EAAa;AACzC6K,QAAAA,KAAK,CAAC9R,IAAN,CAAW0uB,QAAQ,CAAC2xH,OAApB,EAA6B,UAAU1gH,OAAV,EAAmB;AAC9C14B,UAAAA,CAAC,CAAC2yC,OAAF,GAAY3yC,CAAC,CAAC2yC,OAAF,CAAUxwC,OAAV,CAAkBu2B,OAAlB,EAA2B,UAAUn1B,GAAV,EAAe;AACpD,mBAAO,uBAAuBqxI,MAAM,CAACrxI,GAAD,CAA7B,GAAqC,KAA5C;AACD,WAFW,CAAZ;AAGD,SAJD;AAKD,OAND;AAOD;;AACD4jB,IAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwB,YAAY;AAClCkK,MAAAA,MAAM,CAACinE,SAAP,CAAiBjnE,MAAM,CAACo6B,OAAP,EAAjB;AACD,KAFD;;AAGA,QAAIw3F,OAAO,KAAK,KAAhB,EAAuB;AACrB5xH,MAAAA,MAAM,CAACmB,IAAP,CAAY;AACVq0B,QAAAA,OAAO,EAAE,IADC;AAEVyf,QAAAA,MAAM,EAAE;AAFE,OAAZ;AAID;;AACDj1C,IAAAA,MAAM,CAACkyH,YAAP,GAAsBlyH,MAAM,CAACs3D,UAAP,CAAkB;AAAEriB,MAAAA,MAAM,EAAE;AAAV,KAAlB,CAAtB;AACAj1C,IAAAA,MAAM,CAAClK,EAAP,CAAU,iCAAV,EAA6C,UAAUjd,CAAV,EAAa;AACxDmnB,MAAAA,MAAM,CAACijD,SAAP,GAAmBpqE,CAAC,CAAC7F,IAAF,KAAW,kBAA9B;AACD,KAFD;;AAGA,QAAIgtB,MAAM,CAACwvH,aAAP,CAAqBxhJ,MAArB,GAA8B,CAAlC,EAAqC;AACnC,UAAImkJ,gBAAgB,GAAG,EAAvB;AACAzuI,MAAAA,KAAK,CAAC9R,IAAN,CAAWouB,MAAM,CAACwvH,aAAlB,EAAiC,UAAUx+H,KAAV,EAAiB;AAChDmhI,QAAAA,gBAAgB,IAAInhI,KAAK,GAAG,MAA5B;AACD,OAFD;AAGAgP,MAAAA,MAAM,CAAChb,GAAP,CAAW6b,QAAX,CAAoBsxH,gBAApB;AACD;;AACDV,IAAAA,cAAc,CAACzxH,MAAD,EAASA,MAAM,CAAC24F,UAAhB,CAAd;;AACA,QAAIr4F,QAAQ,CAAC8xH,aAAb,EAA4B;AAC1BjC,MAAAA,WAAW,CAACnwH,MAAD,EAASM,QAAQ,CAAC8xH,aAAlB,CAAX;AACD;AACF,GA7CD;;AA8CA,MAAIC,eAAe,GAAG,UAAUryH,MAAV,EAAkBsyH,SAAlB,EAA6B;AACjD,QAAIhyH,QAAQ,GAAGN,MAAM,CAACM,QAAtB;AACA,QAAIshD,SAAS,GAAG5hD,MAAM,CAACsoC,UAAP,EAAhB;AACA,QAAIrkD,GAAG,GAAG+b,MAAM,CAACm7C,MAAP,EAAV;;AACA,QAAI,CAAC76C,QAAQ,CAACyR,MAAd,EAAsB;AACpB/R,MAAAA,MAAM,CAACsoC,UAAP,GAAoBt3C,KAApB,CAA0BuhI,UAA1B,GAAuCvyH,MAAM,CAACwyH,aAA9C;AACD;;AACD,QAAI,CAACF,SAAD,IAAc,CAACtyH,MAAM,CAAC+R,MAA1B,EAAkC;AAChC9tB,MAAAA,GAAG,CAACohG,IAAJ;AACAphG,MAAAA,GAAG,CAACq2F,KAAJ,CAAUt6E,MAAM,CAACyyH,UAAjB;AACAxuI,MAAAA,GAAG,CAACmV,KAAJ;AACD;;AACD,QAAI4G,MAAM,CAAC+R,MAAX,EAAmB;AACjBm+G,MAAAA,KAAK,CAACtkG,QAAN,CAAeg2B,SAAf,EAA0B,kBAA1B;AACA5hD,MAAAA,MAAM,CAACusB,eAAP,GAAyBtoC,GAAG,GAAG9C,QAA/B;AACA6e,MAAAA,MAAM,CAACwsB,aAAP,GAAuB3sC,MAAvB;AACAmgB,MAAAA,MAAM,CAACiuF,WAAP,GAAqBrsC,SAArB;AACA5hD,MAAAA,MAAM,CAAC8tF,oBAAP,GAA8BlsC,SAA9B;AACD;;AACD,QAAI11D,IAAI,GAAG8T,MAAM,CAACo6B,OAAP,EAAX;AACAluC,IAAAA,IAAI,CAAC04B,QAAL,GAAgB,IAAhB;AACA5kB,IAAAA,MAAM,CAACmqB,QAAP,GAAkB,CAAC,CAAC7pB,QAAQ,CAAC6pB,QAA7B;;AACA,QAAI,CAACnqB,MAAM,CAACmqB,QAAZ,EAAsB;AACpB,UAAInqB,MAAM,CAAC+R,MAAP,IAAiBm+G,KAAK,CAACngG,QAAN,CAAe7jC,IAAf,EAAqB,UAArB,EAAiC,IAAjC,MAA2C,QAAhE,EAA0E;AACxEA,QAAAA,IAAI,CAAC8E,KAAL,CAAWw/C,QAAX,GAAsB,UAAtB;AACD;;AACDtkD,MAAAA,IAAI,CAACrL,eAAL,GAAuBmf,MAAM,CAAC2lC,QAAP,CAAgB,wBAAhB,EAA0C,IAA1C,CAAvB;AACD;;AACDz5C,IAAAA,IAAI,CAAC04B,QAAL,GAAgB,KAAhB;AACA5kB,IAAAA,MAAM,CAACwuF,YAAP,GAAsBsO,YAAY,CAAC98F,MAAD,CAAlC;AACAA,IAAAA,MAAM,CAAC8M,MAAP,GAAgBkB,MAAM,CAAC1N,QAAD,CAAtB;AACAN,IAAAA,MAAM,CAAChb,GAAP,GAAa+oC,QAAQ,CAAC9pC,GAAD,EAAM;AACzBqpC,MAAAA,WAAW,EAAE,IADY;AAEzB9X,MAAAA,aAAa,EAAExV,MAAM,CAACyxF,UAFG;AAGzB/7E,MAAAA,mBAAmB,EAAE1V,MAHI;AAIzB0yH,MAAAA,UAAU,EAAEpyH,QAAQ,CAACqyH,sBAJI;AAKzB/iG,MAAAA,aAAa,EAAE,IALU;AAMzBR,MAAAA,YAAY,EAAEpvB,MAAM,CAAC+R,MAAP,GAAgB/R,MAAM,CAACo6B,OAAP,EAAhB,GAAmC,IANxB;AAOzB/J,MAAAA,OAAO,EAAE,YAAY;AACnB,eAAOrwB,MAAM,CAAC+R,MAAd;AACD,OATwB;AAUzBjF,MAAAA,MAAM,EAAE9M,MAAM,CAAC8M,MAVU;AAWzBtK,MAAAA,cAAc,EAAE+kC,uBAAuB,CAACvnC,MAAD,CAXd;AAYzBY,MAAAA,cAAc,EAAE4mC,iBAAiB,CAACxnC,MAAD,CAZR;AAazBgvB,MAAAA,WAAW,EAAE,UAAUn2C,CAAV,EAAa;AACxBmnB,QAAAA,MAAM,CAACmb,IAAP,CAAY,WAAZ,EAAyBtiC,CAAzB;AACD;AAfwB,KAAN,CAArB;AAiBAmnB,IAAAA,MAAM,CAACymE,MAAP,GAAgBqqD,YAAY,CAAC9wH,MAAD,CAA5B;AACAA,IAAAA,MAAM,CAACi8B,UAAP,GAAoBmxD,aAAa,CAACmjC,oBAAoB,CAACvwH,MAAD,CAArB,EAA+BA,MAA/B,CAAjC;AACAA,IAAAA,MAAM,CAACk6B,SAAP,GAAmBooD,eAAe,CAACtiF,MAAM,CAAChb,GAAR,EAAagb,MAAM,CAACgrD,MAAP,EAAb,EAA8BhrD,MAAM,CAACi8B,UAArC,EAAiDj8B,MAAjD,CAAlC;AACAA,IAAAA,MAAM,CAAC4yH,SAAP,GAAmB52E,SAAS,CAACh8C,MAAD,CAA5B;AACAA,IAAAA,MAAM,CAACq1C,SAAP,GAAmBotD,SAAS,CAACziG,MAAD,CAA5B;AACAA,IAAAA,MAAM,CAAC27C,WAAP,GAAqB4nD,WAAW,CAACvjG,MAAD,CAAhC;AACAA,IAAAA,MAAM,CAAC6yH,qBAAP,GAA+B,IAAItN,UAAJ,CAAevlH,MAAf,CAA/B;AACAA,IAAAA,MAAM,CAAC8mE,mBAAP,GAA6BikD,kBAAkB,CAAC/qH,MAAD,CAA/C;AACAuyG,IAAAA,OAAO,CAACvyG,MAAD,CAAP;AACAimH,IAAAA,OAAO,CAACjmH,MAAD,CAAP;;AACA,QAAI,CAAC2+E,KAAK,CAAC3+E,MAAD,CAAV,EAAoB;AAClBomH,MAAAA,OAAO,CAACpmH,MAAD,CAAP;AACD;;AACD,QAAImsC,KAAK,GAAGm5E,OAAO,CAACtlH,MAAD,CAAnB;AACA+xG,IAAAA,OAAO,CAAC/xG,MAAD,EAASmsC,KAAT,CAAP;AACA+mE,IAAAA,OAAO,CAAClzG,MAAD,CAAP;AACAgkG,IAAAA,OAAO,CAAChkG,MAAD,CAAP;AACA+8C,IAAAA,WAAW,CAAC/8C,MAAD,CAAX;AACA6+E,IAAAA,OAAO,CAAC7+E,MAAD,CAAP,CAAgBhvB,IAAhB,CAAqB,YAAY;AAC/B2gJ,MAAAA,OAAO,CAAC3xH,MAAD,EAAS,KAAT,CAAP;AACD,KAFD,EAEG,UAAU8yH,UAAV,EAAsB;AACvB9yH,MAAAA,MAAM,CAAC+yH,gBAAP,CAAwB,IAAxB;AACAD,MAAAA,UAAU,CAACh7H,IAAX,CAAgB,UAAU85H,OAAV,EAAmB;AACjC5xH,QAAAA,MAAM,CAAC+yH,gBAAP,CAAwB,KAAxB;AACApB,QAAAA,OAAO,CAAC3xH,MAAD,EAAS4xH,OAAT,CAAP;AACD,OAHD,EAGG,UAAUl5H,GAAV,EAAe;AAChBsH,QAAAA,MAAM,CAACs3F,mBAAP,CAA2BjS,IAA3B,CAAgC;AAC9BryG,UAAAA,IAAI,EAAE,OADwB;AAE9B8R,UAAAA,IAAI,EAAE/X,MAAM,CAAC2rB,GAAD;AAFkB,SAAhC;AAIAi5H,QAAAA,OAAO,CAAC3xH,MAAD,EAAS,IAAT,CAAP;AACD,OATD;AAUD,KAdD;AAeD,GAjFD;;AAmFA,MAAIgzH,KAAK,GAAGjlG,QAAQ,CAAC2D,GAArB;;AACA,MAAIuhG,WAAW,GAAG,UAAUjzH,MAAV,EAAkBkzH,GAAlB,EAAuB;AACvC,QAAI/xI,QAAQ,CAACgyI,MAAT,KAAoBtzI,MAAM,CAACwkC,QAAP,CAAgB+uG,QAApC,IAAgD3yI,GAAG,CAACjH,OAAJ,CAAY2E,IAAZ,EAApD,EAAwE;AACtE,UAAIk1I,QAAQ,GAAG35B,IAAI,CAAC,KAAD,CAAnB;;AACA15F,MAAAA,MAAM,CAACqzH,QAAD,CAAN,GAAmB,YAAY;AAC7BhB,QAAAA,eAAe,CAACryH,MAAD,CAAf;AACD,OAFD;;AAGA,UAAIszH,cAAc,GAAG,4BAA4B,mCAA5B,GAAkEnyI,QAAQ,CAACgyI,MAA3E,GAAoF,IAApF,GAA2F,sCAA3F,GAAoInzH,MAAM,CAACnvB,EAA3I,GAAgJ,mCAAhJ,GAAsL,sBAAtL,GAA+MwiJ,QAA/M,GAA0N,aAA/O;AACAL,MAAAA,KAAK,CAAClkG,SAAN,CAAgBokG,GAAhB,EAAqB,KAArB,EAA4BI,cAA5B;AACA,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD,GAXD;;AAYA,MAAIC,mBAAmB,GAAG,UAAU1iJ,EAAV,EAAc6kB,KAAd,EAAqBxH,MAArB,EAA6BslI,WAA7B,EAA0C;AAClE,QAAIC,MAAM,GAAGruI,YAAY,CAACV,OAAb,CAAqB,QAArB,CAAb;AACA0M,IAAAA,MAAM,CAACqiI,MAAD,EAASD,WAAT,CAAN;AACApiI,IAAAA,MAAM,CAACqiI,MAAD,EAAS;AACb5iJ,MAAAA,EAAE,EAAEA,EAAE,GAAG,MADI;AAEb6iJ,MAAAA,WAAW,EAAE,GAFA;AAGbC,MAAAA,iBAAiB,EAAE,MAHN;AAIbj+H,MAAAA,KAAK,EAAEA;AAJM,KAAT,CAAN;AAMA4jC,IAAAA,KAAK,CAACm6F,MAAD,EAAS,uBAAT,CAAL;AACA,WAAOA,MAAP;AACD,GAXD;;AAYA,MAAIG,aAAa,GAAG,UAAU5zH,MAAV,EAAkB;AACpC,QAAIyyH,UAAU,GAAG3sF,UAAU,CAAC9lC,MAAD,CAAV,GAAqB,cAAtC;;AACA,QAAI+lC,kBAAkB,CAAC/lC,MAAD,CAAlB,KAA+BA,MAAM,CAAC6wF,eAA1C,EAA2D;AACzD4hC,MAAAA,UAAU,IAAI,iBAAiBzyH,MAAM,CAACw4F,eAAP,CAAuBq7B,MAAvB,EAAjB,GAAmD,MAAjE;AACD;;AACDpB,IAAAA,UAAU,IAAI,uEAAd;AACA,QAAIqB,MAAM,GAAG9tF,SAAS,CAAChmC,MAAD,CAAtB;AACA,QAAI+zH,SAAS,GAAG9tF,YAAY,CAACjmC,MAAD,CAA5B;;AACA,QAAIkmC,wBAAwB,CAAClmC,MAAD,CAA5B,EAAsC;AACpCyyH,MAAAA,UAAU,IAAI,yDAAyDvsF,wBAAwB,CAAClmC,MAAD,CAAjF,GAA4F,MAA1G;AACD;;AACDyyH,IAAAA,UAAU,IAAI,sBAAsBqB,MAAtB,GAA+B,4BAA/B,GAA8DC,SAA9D,GAA0E,aAA1E,GAA0F/zH,MAAM,CAACnvB,EAAjG,GAAsG,sBAApH;AACA,WAAO4hJ,UAAP;AACD,GAbD;;AAcA,MAAIuB,YAAY,GAAG,UAAUh0H,MAAV,EAAkBtvB,CAAlB,EAAqB;AACtC,QAAIglB,KAAK,GAAGsK,MAAM,CAACmtD,aAAP,CAAqB9gE,SAArB,CAA+B,uCAA/B,CAAZ;AACA,QAAI6mI,GAAG,GAAGK,mBAAmB,CAACvzH,MAAM,CAACnvB,EAAR,EAAY6kB,KAAZ,EAAmBhlB,CAAC,CAACwd,MAArB,EAA6B23C,cAAc,CAAC7lC,MAAD,CAA3C,CAAnB,CAAwEhb,GAAlF;;AACAkuI,IAAAA,GAAG,CAACxxH,MAAJ,GAAa,YAAY;AACvBwxH,MAAAA,GAAG,CAACxxH,MAAJ,GAAa,IAAb;AACA1B,MAAAA,MAAM,CAACmb,IAAP,CAAY,MAAZ;AACD,KAHD;;AAIA,QAAI84G,eAAe,GAAGhB,WAAW,CAACjzH,MAAD,EAASkzH,GAAT,CAAjC;AACAlzH,IAAAA,MAAM,CAAC8tF,oBAAP,GAA8Bp9G,CAAC,CAACwjJ,eAAhC;AACAl0H,IAAAA,MAAM,CAACkuD,aAAP,GAAuBglE,GAAvB;AACAlzH,IAAAA,MAAM,CAACyyH,UAAP,GAAoBmB,aAAa,CAAC5zH,MAAD,CAAjC;AACAgzH,IAAAA,KAAK,CAAC3lH,GAAN,CAAU38B,CAAC,CAACwjJ,eAAZ,EAA6BhB,GAA7B;AACA,WAAOe,eAAP;AACD,GAbD;;AAcA,MAAIE,MAAM,GAAG,UAAUn0H,MAAV,EAAkBo0H,OAAlB,EAA2B;AACtC,QAAIH,eAAe,GAAGD,YAAY,CAACh0H,MAAD,EAASo0H,OAAT,CAAlC;;AACA,QAAIA,OAAO,CAACpmC,eAAZ,EAA6B;AAC3BglC,MAAAA,KAAK,CAACr9I,GAAN,CAAUy+I,OAAO,CAACpmC,eAAlB,EAAmCh9F,KAAnC,CAAyCqwD,OAAzC,GAAmDrhD,MAAM,CAAC2tF,UAA1D;AACA3tF,MAAAA,MAAM,CAACq0H,MAAP,GAAgBrB,KAAK,CAACnhG,QAAN,CAAeuiG,OAAO,CAACpmC,eAAvB,CAAhB;AACD;;AACDhuF,IAAAA,MAAM,CAACsoC,UAAP,GAAoBt3C,KAApB,CAA0BqwD,OAA1B,GAAoC,MAApC;AACA2xE,IAAAA,KAAK,CAAClkG,SAAN,CAAgB9uB,MAAM,CAACnvB,EAAvB,EAA2B,aAA3B,EAA0C,MAA1C;;AACA,QAAI,CAACojJ,eAAL,EAAsB;AACpB5B,MAAAA,eAAe,CAACryH,MAAD,CAAf;AACD;AACF,GAXD;;AAaA,MAAIs0H,KAAK,GAAGvmG,QAAQ,CAAC2D,GAArB;;AACA,MAAI6iG,UAAU,GAAG,UAAUv0H,MAAV,EAAkBw0H,kBAAlB,EAAsCC,MAAtC,EAA8C;AAC7D,QAAIC,MAAM,GAAGj8F,aAAa,CAAC9iD,GAAd,CAAkB8+I,MAAlB,CAAb;AACA,QAAIx8F,SAAS,GAAGQ,aAAa,CAAC91B,IAAd,CAAmB8xH,MAAnB,KAA8Bz0H,MAAM,CAAC6wF,eAAP,CAAuB71G,OAAvB,CAA+B,KAA/B,EAAsC,EAAtC,CAA9C;AACAy5I,IAAAA,MAAM,GAAG/wI,KAAK,CAAC3G,IAAN,CAAW03I,MAAX,CAAT;;AACA,QAAIC,MAAM,IAAIhxI,KAAK,CAACE,OAAN,CAAc4wI,kBAAd,EAAkCC,MAAlC,MAA8C,CAAC,CAA7D,EAAgE;AAC9D/wI,MAAAA,KAAK,CAAC9R,IAAN,CAAW6mD,aAAa,CAACvB,YAAd,CAA2Bu9F,MAA3B,CAAX,EAA+C,UAAU58F,GAAV,EAAe;AAC5D08F,QAAAA,UAAU,CAACv0H,MAAD,EAASw0H,kBAAT,EAA6B38F,GAA7B,CAAV;AACD,OAFD;;AAGA,UAAI73B,MAAM,CAAC4+E,OAAP,CAAe61C,MAAf,CAAJ,EAA4B;AAC1B;AACD;;AACD,UAAI;AACF,YAAIE,cAAc,GAAG,IAAID,MAAJ,CAAW10H,MAAX,EAAmBi4B,SAAnB,EAA8Bj4B,MAAM,CAACwuB,CAArC,CAArB;AACAxuB,QAAAA,MAAM,CAAC4+E,OAAP,CAAe61C,MAAf,IAAyBE,cAAzB;;AACA,YAAIA,cAAc,CAAClqG,IAAnB,EAAyB;AACvBkqG,UAAAA,cAAc,CAAClqG,IAAf,CAAoBzqB,MAApB,EAA4Bi4B,SAA5B;AACAu8F,UAAAA,kBAAkB,CAACxgJ,IAAnB,CAAwBygJ,MAAxB;AACD;AACF,OAPD,CAOE,OAAO57I,CAAP,EAAU;AACVk/G,QAAAA,eAAe,CAAC/3F,MAAD,EAASy0H,MAAT,EAAiB57I,CAAjB,CAAf;AACD;AACF;AACF,GAtBD;;AAuBA,MAAI+7I,gBAAgB,GAAG,UAAU9nJ,IAAV,EAAgB;AACrC,WAAOA,IAAI,CAACkO,OAAL,CAAa,KAAb,EAAoB,EAApB,CAAP;AACD,GAFD;;AAGA,MAAI65I,WAAW,GAAG,UAAU70H,MAAV,EAAkB;AAClC,QAAIw0H,kBAAkB,GAAG,EAAzB;AACA9wI,IAAAA,KAAK,CAAC9R,IAAN,CAAWg4D,UAAU,CAAC5pC,MAAD,CAAV,CAAmBje,KAAnB,CAAyB,MAAzB,CAAX,EAA6C,UAAUjV,IAAV,EAAgB;AAC3DynJ,MAAAA,UAAU,CAACv0H,MAAD,EAASw0H,kBAAT,EAA6BI,gBAAgB,CAAC9nJ,IAAD,CAA7C,CAAV;AACD,KAFD;AAGD,GALD;;AAMA,MAAIgoJ,SAAS,GAAG,UAAU90H,MAAV,EAAkB;AAChC,QAAI+0H,YAAY,GAAGrxI,KAAK,CAAC3G,IAAN,CAAWkqD,eAAe,CAACjnC,MAAD,CAA1B,CAAnB;AACA,QAAIg1H,YAAY,GAAGh1H,MAAM,CAACsxH,EAAP,CAAUx1F,QAAV,CAAmBqgB,MAAnB,GAA4By3C,KAA/C;;AACA,QAAIqhC,SAAS,GAAGx8I,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKo7G,WAAW,CAACl+G,GAAZ,CAAgB,SAAhB,EAA2Bi+G,KAAhC,CAAT,EAAiDC,WAAW,CAACl+G,GAAZ,CAAgBo/I,YAAhB,EAA8BnhC,KAA/E,CAAxB;;AACA39G,IAAAA,MAAM,CAACg/I,SAAD,EAAY,UAAUC,OAAV,EAAmBC,IAAnB,EAAyB;AACzC,UAAI,CAACj+I,GAAG,CAAC89I,YAAD,EAAeG,IAAf,CAAR,EAA8B;AAC5Bn1H,QAAAA,MAAM,CAACsxH,EAAP,CAAUx1F,QAAV,CAAmBs5F,OAAnB,CAA2BD,IAA3B,EAAiCD,OAAjC;AACD;AACF,KAJK,CAAN;AAKD,GATD;;AAUA,MAAIG,SAAS,GAAG,UAAUr1H,MAAV,EAAkB;AAChC,QAAI+uF,KAAK,GAAGtmD,QAAQ,CAACzoC,MAAD,CAApB;;AACA,QAAI7sB,QAAQ,CAAC47G,KAAD,CAAZ,EAAqB;AACnB/uF,MAAAA,MAAM,CAACM,QAAP,CAAgByuF,KAAhB,GAAwB6lC,gBAAgB,CAAC7lC,KAAD,CAAxC;AACA,UAAIumC,KAAK,GAAG58F,YAAY,CAAC/iD,GAAb,CAAiBo5G,KAAjB,CAAZ;AACA/uF,MAAAA,MAAM,CAAC+uF,KAAP,GAAe,IAAIumC,KAAJ,CAAUt1H,MAAV,EAAkB04B,YAAY,CAAC/1B,IAAb,CAAkBosF,KAAlB,CAAlB,CAAf;;AACA,UAAI/uF,MAAM,CAAC+uF,KAAP,CAAatkE,IAAjB,EAAuB;AACrBzqB,QAAAA,MAAM,CAAC+uF,KAAP,CAAatkE,IAAb,CAAkBzqB,MAAlB,EAA0B04B,YAAY,CAAC/1B,IAAb,CAAkBosF,KAAlB,KAA4B/uF,MAAM,CAAC6wF,eAAP,CAAuB71G,OAAvB,CAA+B,KAA/B,EAAsC,EAAtC,CAAtD,EAAiGglB,MAAM,CAACwuB,CAAxG;AACD;AACF,KAPD,MAOO;AACLxuB,MAAAA,MAAM,CAAC+uF,KAAP,GAAe,EAAf;AACD;AACF,GAZD;;AAaA,MAAIwmC,qBAAqB,GAAG,UAAUv1H,MAAV,EAAkB;AAC5C,WAAOA,MAAM,CAAC+uF,KAAP,CAAaymC,QAAb,EAAP;AACD,GAFD;;AAGA,MAAIC,mBAAmB,GAAG,UAAUz1H,MAAV,EAAkB;AAC1C,QAAIjN,GAAG,GAAGiN,MAAM,CAACsoC,UAAP,EAAV;AACA,QAAIymD,KAAK,GAAGtmD,QAAQ,CAACzoC,MAAD,CAApB;AACA,QAAIjiB,IAAI,GAAGgxG,KAAK,CAAC/uF,MAAD,EAASjN,GAAT,CAAhB;;AACA,QAAIhV,IAAI,CAACiwG,eAAL,CAAqB5nG,QAAzB,EAAmC;AACjCrI,MAAAA,IAAI,CAACiwG,eAAL,CAAqBn9G,EAArB,GAA0BkN,IAAI,CAACiwG,eAAL,CAAqBn9G,EAArB,IAA2BmvB,MAAM,CAACnvB,EAAP,GAAY,SAAjE;AACD;;AACD,QAAIkN,IAAI,CAACm2I,eAAL,IAAwBn2I,IAAI,CAACm2I,eAAL,CAAqB9tI,QAAjD,EAA2D;AACzDrI,MAAAA,IAAI,CAACm2I,eAAL,CAAqBrjJ,EAArB,GAA0BkN,IAAI,CAACm2I,eAAL,CAAqBrjJ,EAArB,IAA2BmvB,MAAM,CAACnvB,EAAP,GAAY,kBAAjE;AACD;;AACDkN,IAAAA,IAAI,CAACmQ,MAAL,GAAcnQ,IAAI,CAAC23I,YAAL,GAAoB33I,IAAI,CAAC23I,YAAzB,GAAwC3iI,GAAG,CAACK,YAA1D;AACA,WAAOrV,IAAP;AACD,GAZD;;AAaA,MAAI43I,sBAAsB,GAAG,UAAUzvI,OAAV,EAAmB;AAC9C,WAAO;AACL8nG,MAAAA,eAAe,EAAE9nG,OADZ;AAELguI,MAAAA,eAAe,EAAEhuI,OAFZ;AAGLk0D,MAAAA,GAAG,EAAE;AAHA,KAAP;AAKD,GAND;;AAOA,MAAIw7E,sBAAsB,GAAG,UAAUnO,aAAV,EAAyB;AACpD,QAAIyM,eAAe,GAAGI,KAAK,CAACpyI,MAAN,CAAa,KAAb,CAAtB;AACAoyI,IAAAA,KAAK,CAACpiG,WAAN,CAAkBgiG,eAAlB,EAAmCzM,aAAnC;AACA,WAAOkO,sBAAsB,CAACzB,eAAD,CAA7B;AACD,GAJD;;AAKA,MAAI2B,gBAAgB,GAAG,UAAU71H,MAAV,EAAkB;AACvC,QAAIynH,aAAa,GAAGznH,MAAM,CAACsoC,UAAP,EAApB;AACA,WAAOtoC,MAAM,CAAC+R,MAAP,GAAgB4jH,sBAAsB,CAAC,IAAD,CAAtC,GAA+CC,sBAAsB,CAACnO,aAAD,CAA5E;AACD,GAHD;;AAIA,MAAIqO,aAAa,GAAG,UAAU91H,MAAV,EAAkB;AACpC,QAAIjN,GAAG,GAAGiN,MAAM,CAACsoC,UAAP,EAAV;AACAtoC,IAAAA,MAAM,CAAC2tF,UAAP,GAAoB56F,GAAG,CAAC/B,KAAJ,CAAUqwD,OAA9B;;AACA,QAAIluE,QAAQ,CAACs1D,QAAQ,CAACzoC,MAAD,CAAT,CAAZ,EAAgC;AAC9B,aAAOu1H,qBAAqB,CAACv1H,MAAD,CAA5B;AACD,KAFD,MAEO,IAAIrsB,UAAU,CAAC80D,QAAQ,CAACzoC,MAAD,CAAT,CAAd,EAAkC;AACvC,aAAOy1H,mBAAmB,CAACz1H,MAAD,CAA1B;AACD,KAFM,MAEA;AACL,aAAO61H,gBAAgB,CAAC71H,MAAD,CAAvB;AACD;AACF,GAVD;;AAWA,MAAI+1H,kBAAkB,GAAG,UAAU/1H,MAAV,EAAkBo6C,GAAlB,EAAuB;AAC9C,QAAI47E,WAAW,GAAG;AAChB9pG,MAAAA,IAAI,EAAEr5C,QAAQ,CAACD,IAAT,CAAcwnE,GAAG,CAACluB,IAAlB,EAAwB96C,KAAxB,CAA8BvC,IAA9B,CADU;AAEhBs9C,MAAAA,IAAI,EAAEt5C,QAAQ,CAACD,IAAT,CAAcwnE,GAAG,CAACjuB,IAAlB,EAAwB/6C,KAAxB,CAA8BvC,IAA9B,CAFU;AAGhBonJ,MAAAA,OAAO,EAAEpjJ,QAAQ,CAACD,IAAT,CAAcwnE,GAAG,CAAC67E,OAAlB,EAA2B7kJ,KAA3B,CAAiCvC,IAAjC,CAHO;AAIhBqnJ,MAAAA,UAAU,EAAErjJ,QAAQ,CAACD,IAAT,CAAcwnE,GAAG,CAAC87E,UAAlB,EAA8B9kJ,KAA9B,CAAoCd,KAApC,CAJI;AAKhB6lJ,MAAAA,MAAM,EAAE,YAAY;AAClB,YAAI,CAACn2H,MAAM,CAAC8N,IAAP,CAAY47B,UAAZ,EAAL,EAA+B;AAC7B72D,UAAAA,QAAQ,CAACD,IAAT,CAAcwnE,GAAG,CAAC+7E,MAAlB,EAA0BxkJ,GAA1B,CAA8BpE,IAA9B;AACD;AACF;AATe,KAAlB;AAWAyyB,IAAAA,MAAM,CAACsxH,EAAP,GAAY74I,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKunB,MAAM,CAACsxH,EAAZ,CAAT,EAA0B0E,WAA1B,CAApB;AACD,GAbD;;AAcA,MAAII,MAAM,GAAG,UAAUp2H,MAAV,EAAkB;AAC7BA,IAAAA,MAAM,CAACmb,IAAP,CAAY,eAAZ;AACA25G,IAAAA,SAAS,CAAC90H,MAAD,CAAT;AACAq1H,IAAAA,SAAS,CAACr1H,MAAD,CAAT;AACA60H,IAAAA,WAAW,CAAC70H,MAAD,CAAX;AACA,QAAIq2H,UAAU,GAAGP,aAAa,CAAC91H,MAAD,CAA9B;AACA+1H,IAAAA,kBAAkB,CAAC/1H,MAAD,EAASntB,QAAQ,CAACD,IAAT,CAAcyjJ,UAAU,CAACj8E,GAAzB,EAA8BhpE,KAA9B,CAAoC,EAApC,CAAT,CAAlB;AACA,QAAIgjJ,OAAO,GAAG;AACZpmC,MAAAA,eAAe,EAAEqoC,UAAU,CAACroC,eADhB;AAEZkmC,MAAAA,eAAe,EAAEmC,UAAU,CAACnC;AAFhB,KAAd;AAIAl0H,IAAAA,MAAM,CAACguF,eAAP,GAAyBomC,OAAO,CAACpmC,eAAR,GAA0BomC,OAAO,CAACpmC,eAAlC,GAAoD,IAA7E;AACA0K,IAAAA,4BAA4B,CAAC14F,MAAD,CAA5B;;AACA,QAAIA,MAAM,CAAC+R,MAAX,EAAmB;AACjB,aAAOsgH,eAAe,CAACryH,MAAD,CAAtB;AACD,KAFD,MAEO;AACL,aAAOm0H,MAAM,CAACn0H,MAAD,EAASo0H,OAAT,CAAb;AACD;AACF,GAlBD;;AAoBA,MAAIkC,KAAK,GAAGvoG,QAAQ,CAAC2D,GAArB;;AACA,MAAI6kG,iBAAiB,GAAG,UAAUzpJ,IAAV,EAAgB;AACtC,WAAOA,IAAI,CAAC65B,MAAL,CAAY,CAAZ,MAAmB,GAA1B;AACD,GAFD;;AAGA,MAAI6vH,YAAY,GAAG,UAAUC,YAAV,EAAwBz2H,MAAxB,EAAgC;AACjD,QAAI02H,YAAY,GAAGjvF,eAAe,CAACznC,MAAD,CAAlC;AACA,QAAI22H,WAAW,GAAGjvF,cAAc,CAAC1nC,MAAD,CAAhC;;AACA,QAAI42B,IAAI,CAACD,OAAL,CAAa+/F,YAAb,MAA+B,KAA/B,IAAwCA,YAAY,KAAK,IAA7D,EAAmE;AACjE,UAAIE,KAAK,GAAGD,WAAW,KAAK,EAAhB,GAAqBA,WAArB,GAAmC32H,MAAM,CAACmtD,aAAP,CAAqB50B,OAArB,GAA+B,SAA/B,GAA2Cm+F,YAA3C,GAA0D,KAAzG;AACAD,MAAAA,YAAY,CAACppH,GAAb,CAAiBupH,KAAjB,EAAwB/nJ,IAAxB,EAA8BrC,SAA9B,EAAyC,YAAY;AACnDsrH,QAAAA,iBAAiB,CAAC93F,MAAD,EAAS42H,KAAT,EAAgBF,YAAhB,CAAjB;AACD,OAFD;AAGD;AACF,GATD;;AAUA,MAAIG,SAAS,GAAG,UAAUJ,YAAV,EAAwBz2H,MAAxB,EAAgC4V,MAAhC,EAAwCj+B,QAAxC,EAAkD;AAChE,QAAIo3G,KAAK,GAAGtmD,QAAQ,CAACzoC,MAAD,CAApB;;AACA,QAAI7sB,QAAQ,CAAC47G,KAAD,CAAZ,EAAqB;AACnB,UAAI,CAACwnC,iBAAiB,CAACxnC,KAAD,CAAlB,IAA6B,CAACr2D,YAAY,CAAC/1B,IAAb,CAAkB3sB,cAAlB,CAAiC+4G,KAAjC,CAAlC,EAA2E;AACzE,YAAI+nC,QAAQ,GAAG9tF,WAAW,CAAChpC,MAAD,CAA1B;;AACA,YAAI82H,QAAJ,EAAc;AACZp+F,UAAAA,YAAY,CAACv3B,IAAb,CAAkB4tF,KAAlB,EAAyB/uF,MAAM,CAACw4F,eAAP,CAAuBC,UAAvB,CAAkCq+B,QAAlC,CAAzB;AACD,SAFD,MAEO;AACLp+F,UAAAA,YAAY,CAACv3B,IAAb,CAAkB4tF,KAAlB,EAAyB,YAAYA,KAAZ,GAAoB,QAApB,GAA+Bn5E,MAA/B,GAAwC,KAAjE;AACD;AACF;;AACD6gH,MAAAA,YAAY,CAACzhG,SAAb,CAAuB,YAAY;AACjC0D,QAAAA,YAAY,CAACpB,OAAb,CAAqBy3D,KAArB,EAA4Bp3G,QAA5B;AACD,OAFD;AAGD,KAZD,MAYO;AACLA,MAAAA,QAAQ;AACT;AACF,GAjBD;;AAkBA,MAAIo/I,sBAAsB,GAAG,UAAU/2H,MAAV,EAAkB;AAC7C,WAAOntB,QAAQ,CAACD,IAAT,CAAcs0D,WAAW,CAAClnC,MAAD,CAAzB,EAAmChuB,MAAnC,CAA0C,UAAUyR,GAAV,EAAe;AAC9D,aAAOA,GAAG,CAACzV,MAAJ,GAAa,CAApB;AACD,KAFM,EAEJ2D,GAFI,CAEA,UAAU8R,GAAV,EAAe;AACpB,aAAO;AACLA,QAAAA,GAAG,EAAEA,GADA;AAEL3W,QAAAA,IAAI,EAAE+F,QAAQ,CAACrC,IAAT;AAFD,OAAP;AAID,KAPM,CAAP;AAQD,GATD;;AAUA,MAAIwmJ,uBAAuB,GAAG,UAAUh3H,MAAV,EAAkBlzB,IAAlB,EAAwB8oC,MAAxB,EAAgC;AAC5D,WAAO/iC,QAAQ,CAACD,IAAT,CAAc9F,IAAd,EAAoBkF,MAApB,CAA2B,UAAUlF,IAAV,EAAgB;AAChD,aAAOA,IAAI,CAACkB,MAAL,GAAc,CAAd,IAAmB,CAAC6lH,WAAW,CAAC38G,GAAZ,CAAgBpK,IAAhB,CAA3B;AACD,KAFM,EAEJ6E,GAFI,CAEA,UAAU7E,IAAV,EAAgB;AACrB,aAAO;AACL2W,QAAAA,GAAG,EAAEuc,MAAM,CAACmtD,aAAP,CAAqB50B,OAArB,GAA+B,SAA/B,GAA2CzrD,IAA3C,GAAkD,QAAlD,GAA6D8oC,MAA7D,GAAsE,KADtE;AAEL9oC,QAAAA,IAAI,EAAE+F,QAAQ,CAACR,IAAT,CAAcvF,IAAd;AAFD,OAAP;AAID,KAPM,CAAP;AAQD,GATD;;AAUA,MAAImoJ,SAAS,GAAG,UAAUwB,YAAV,EAAwBz2H,MAAxB,EAAgC4V,MAAhC,EAAwC;AACtD,QAAIqhH,eAAe,GAAGD,uBAAuB,CAACh3H,MAAD,EAAS,SAAT,EAAoB4V,MAApB,CAA7C;AACA,QAAIshH,cAAc,GAAGH,sBAAsB,CAAC/2H,MAAD,CAAtB,CAA+BtuB,OAA/B,CAAuC,YAAY;AACtE,aAAOslJ,uBAAuB,CAACh3H,MAAD,EAASinC,eAAe,CAACjnC,MAAD,CAAxB,EAAkC,EAAlC,CAA9B;AACD,KAFoB,CAArB;AAGApuB,IAAAA,IAAI,CAACmsD,GAAG,CAAC,CACPk5F,eADO,EAEPC,cAFO,CAAD,CAAJ,EAGA,UAAUC,OAAV,EAAmB;AACrBV,MAAAA,YAAY,CAACppH,GAAb,CAAiB8pH,OAAO,CAAC1zI,GAAzB,EAA8B5U,IAA9B,EAAoCrC,SAApC,EAA+C,YAAY;AACzDqrH,QAAAA,cAAc,CAAC73F,MAAD,EAASm3H,OAAO,CAAC1zI,GAAjB,EAAsB0zI,OAAO,CAACrqJ,IAAR,CAAa0E,cAAb,EAAtB,CAAd;AACD,OAFD;AAGD,KAPG,CAAJ;AAQD,GAbD;;AAcA,MAAI4lJ,WAAW,GAAG,UAAUp3H,MAAV,EAAkB4V,MAAlB,EAA0B;AAC1ClyB,IAAAA,KAAK,CAAC9R,IAAN,CAAWi4D,kBAAkB,CAAC7pC,MAAD,CAA7B,EAAuC,UAAUvc,GAAV,EAAe3W,IAAf,EAAqB;AAC1D2rD,MAAAA,aAAa,CAACt3B,IAAd,CAAmBr0B,IAAnB,EAAyB2W,GAAzB,EAA8B5U,IAA9B,EAAoCrC,SAApC,EAA+C,YAAY;AACzDorH,QAAAA,eAAe,CAAC53F,MAAD,EAASvc,GAAT,EAAc3W,IAAd,CAAf;AACD,OAFD;AAGAkzB,MAAAA,MAAM,CAACM,QAAP,CAAgBs+E,OAAhB,IAA2B,MAAM9xG,IAAjC;AACD,KALD;AAMA4W,IAAAA,KAAK,CAAC9R,IAAN,CAAWg4D,UAAU,CAAC5pC,MAAD,CAAV,CAAmBje,KAAnB,CAAyB,MAAzB,CAAX,EAA6C,UAAU0yI,MAAV,EAAkB;AAC7DA,MAAAA,MAAM,GAAG/wI,KAAK,CAAC3G,IAAN,CAAW03I,MAAX,CAAT;;AACA,UAAIA,MAAM,IAAI,CAACh8F,aAAa,CAAC91B,IAAd,CAAmB8xH,MAAnB,CAAf,EAA2C;AACzC,YAAI8B,iBAAiB,CAAC9B,MAAD,CAArB,EAA+B;AAC7BA,UAAAA,MAAM,GAAGA,MAAM,CAACj4I,MAAP,CAAc,CAAd,EAAiBi4I,MAAM,CAACzmJ,MAAxB,CAAT;AACA,cAAIkpD,YAAY,GAAGuB,aAAa,CAACvB,YAAd,CAA2Bu9F,MAA3B,CAAnB;AACA/wI,UAAAA,KAAK,CAAC9R,IAAN,CAAWslD,YAAX,EAAyB,UAAUmgG,SAAV,EAAqB;AAC5C,gBAAInkC,eAAe,GAAG;AACpBv2G,cAAAA,MAAM,EAAE,UADY;AAEpBm7C,cAAAA,QAAQ,EAAEu/F,SAFU;AAGpBzhH,cAAAA,MAAM,EAAE,YAAYA,MAAZ,GAAqB;AAHT,aAAtB;AAKA,gBAAIiiB,GAAG,GAAGY,aAAa,CAACd,SAAd,CAAwBu7D,eAAxB,EAAyCmkC,SAAzC,CAAV;AACA5+F,YAAAA,aAAa,CAACt3B,IAAd,CAAmB02B,GAAG,CAACC,QAAvB,EAAiCD,GAAjC,EAAsChpD,IAAtC,EAA4CrC,SAA5C,EAAuD,YAAY;AACjEorH,cAAAA,eAAe,CAAC53F,MAAD,EAAS63B,GAAG,CAACl7C,MAAJ,GAAak7C,GAAG,CAACC,QAAjB,GAA4BD,GAAG,CAACjiB,MAAzC,EAAiDiiB,GAAG,CAACC,QAArD,CAAf;AACD,aAFD;AAGD,WAVD;AAWD,SAdD,MAcO;AACL,cAAIw/F,KAAK,GAAG;AACV36I,YAAAA,MAAM,EAAE,UADE;AAEVm7C,YAAAA,QAAQ,EAAE28F,MAFA;AAGV7+G,YAAAA,MAAM,EAAE,YAAYA,MAAZ,GAAqB;AAHnB,WAAZ;AAKA6iB,UAAAA,aAAa,CAACt3B,IAAd,CAAmBszH,MAAnB,EAA2B6C,KAA3B,EAAkCzoJ,IAAlC,EAAwCrC,SAAxC,EAAmD,YAAY;AAC7DorH,YAAAA,eAAe,CAAC53F,MAAD,EAASs3H,KAAK,CAAC36I,MAAN,GAAe26I,KAAK,CAACx/F,QAArB,GAAgCw/F,KAAK,CAAC1hH,MAA/C,EAAuD6+G,MAAvD,CAAf;AACD,WAFD;AAGD;AACF;AACF,KA5BD;AA6BD,GApCD;;AAqCA,MAAIx/F,WAAW,GAAG,UAAUj1B,MAAV,EAAkB4V,MAAlB,EAA0B;AAC1C,QAAI6gH,YAAY,GAAGliG,YAAY,CAACA,YAAhC;AACAsiG,IAAAA,SAAS,CAACJ,YAAD,EAAez2H,MAAf,EAAuB4V,MAAvB,EAA+B,YAAY;AAClD4gH,MAAAA,YAAY,CAACC,YAAD,EAAez2H,MAAf,CAAZ;AACAi1H,MAAAA,SAAS,CAACwB,YAAD,EAAez2H,MAAf,EAAuB4V,MAAvB,CAAT;AACAwhH,MAAAA,WAAW,CAACp3H,MAAD,EAAS4V,MAAT,CAAX;AACA6gH,MAAAA,YAAY,CAACzhG,SAAb,CAAuB,YAAY;AACjC,YAAI,CAACh1B,MAAM,CAACC,OAAZ,EAAqB;AACnBm2H,UAAAA,MAAM,CAACp2H,MAAD,CAAN;AACD;AACF,OAJD,EAIGA,MAJH,EAIW,YAAY;AACrB,YAAI,CAACA,MAAM,CAACC,OAAZ,EAAqB;AACnBm2H,UAAAA,MAAM,CAACp2H,MAAD,CAAN;AACD;AACF,OARD;AASD,KAbQ,CAAT;AAcD,GAhBD;;AAiBA,MAAIu3H,qBAAqB,GAAG,UAAUrxI,OAAV,EAAmB8Z,MAAnB,EAA2B;AACrD,WAAOqD,QAAQ,CAACJ,UAAT,CAAoB/c,OAApB,EAA6B;AAClCsc,MAAAA,cAAc,EAAEmnC,iBAAiB,CAAC3pC,MAAD,CADC;AAElCY,MAAAA,cAAc,EAAE4mC,iBAAiB,CAACxnC,MAAD;AAFC,KAA7B,CAAP;AAID,GALD;;AAMA,MAAIw3H,MAAM,GAAG,UAAUx3H,MAAV,EAAkB;AAC7B,QAAInvB,EAAE,GAAGmvB,MAAM,CAACnvB,EAAhB;AACA+lD,IAAAA,IAAI,CAACd,OAAL,CAAa2R,eAAe,CAACznC,MAAD,CAA5B;;AACA,QAAI+Z,YAAY,GAAG,YAAY;AAC7Bu8G,MAAAA,KAAK,CAACt7G,MAAN,CAAan7B,MAAb,EAAqB,OAArB,EAA8Bk6B,YAA9B;AACA/Z,MAAAA,MAAM,CAACw3H,MAAP;AACD,KAHD;;AAIA,QAAI,CAACx9G,UAAU,CAACwB,KAAX,CAAiB5B,SAAtB,EAAiC;AAC/B08G,MAAAA,KAAK,CAACzkJ,IAAN,CAAWgO,MAAX,EAAmB,OAAnB,EAA4Bk6B,YAA5B;AACA;AACD;;AACD,QAAI,CAAC/Z,MAAM,CAACsoC,UAAP,EAAL,EAA0B;AACxB;AACD;;AACD,QAAI,CAAC7nD,GAAG,CAACI,eAAT,EAA0B;AACxB;AACD;;AACD,QAAIqF,OAAO,GAAGd,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACsoC,UAAP,EAArB,CAAd;AACA,QAAImvF,QAAQ,GAAGpqJ,KAAK,CAAC6Y,OAAD,CAApB;AACA8Z,IAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB,YAAY;AAC9BxhB,MAAAA,KAAK,CAAC4R,OAAO,CAAClB,GAAR,CAAY2M,UAAb,EAAyB,UAAUC,IAAV,EAAgB;AAC5C,eAAOH,QAAQ,CAACvL,OAAD,EAAU0L,IAAI,CAAC9kB,IAAf,CAAf;AACD,OAFI,CAAL;AAGAskB,MAAAA,MAAM,CAAClL,OAAD,EAAUuxI,QAAV,CAAN;AACD,KALD;AAMAz3H,IAAAA,MAAM,CAACsxH,EAAP,CAAUjjG,gBAAV,GAA6BkpG,qBAAqB,CAACrxI,OAAD,EAAU8Z,MAAV,CAAlD;;AACA,QAAI,CAACipC,UAAU,CAACjpC,MAAD,CAAf,EAAyB;AACvBA,MAAAA,MAAM,CAACwyH,aAAP,GAAuBxyH,MAAM,CAACsoC,UAAP,GAAoBt3C,KAApB,CAA0BuhI,UAAjD;AACAvyH,MAAAA,MAAM,CAACsoC,UAAP,GAAoBt3C,KAApB,CAA0BuhI,UAA1B,GAAuC,QAAvC;AACD,KAHD,MAGO;AACLvyH,MAAAA,MAAM,CAAC+R,MAAP,GAAgB,IAAhB;AACD;;AACD,QAAIo8E,IAAI,GAAGnuF,MAAM,CAACsoC,UAAP,GAAoB6lD,IAApB,IAA4BmoC,KAAK,CAAC/lG,SAAN,CAAgB1/C,EAAhB,EAAoB,MAApB,CAAvC;;AACA,QAAIs9G,IAAJ,EAAU;AACRnuF,MAAAA,MAAM,CAAC+tF,WAAP,GAAqBI,IAArB;;AACA,UAAIjlD,cAAc,CAAClpC,MAAD,CAAd,IAA0B,CAAC5P,iBAAiB,CAAC4P,MAAM,CAACsoC,UAAP,EAAD,CAAhD,EAAuE;AACrEguF,QAAAA,KAAK,CAACpkG,WAAN,CAAkBokG,KAAK,CAACp0I,MAAN,CAAa,OAAb,EAAsB;AACtClP,UAAAA,IAAI,EAAE,QADgC;AAEtClG,UAAAA,IAAI,EAAE+D;AAFgC,SAAtB,CAAlB,EAGIA,EAHJ;AAIAmvB,QAAAA,MAAM,CAACkpC,cAAP,GAAwB,IAAxB;AACD;;AACDlpC,MAAAA,MAAM,CAACsuF,iBAAP,GAA2B,UAAUz1G,CAAV,EAAa;AACtCmnB,QAAAA,MAAM,CAACmb,IAAP,CAAYtiC,CAAC,CAAC7F,IAAd,EAAoB6F,CAApB;AACD,OAFD;;AAGAy9I,MAAAA,KAAK,CAACzkJ,IAAN,CAAWs8G,IAAX,EAAiB,cAAjB,EAAiCnuF,MAAM,CAACsuF,iBAAxC;AACAtuF,MAAAA,MAAM,CAAClK,EAAP,CAAU,OAAV,EAAmB,YAAY;AAC7BkK,QAAAA,MAAM,CAAC03H,YAAP;AACD,OAFD;;AAGA,UAAIvuF,iBAAiB,CAACnpC,MAAD,CAAjB,IAA6B,CAACmuF,IAAI,CAACE,MAAL,CAAYjoG,QAA1C,IAAsD,CAAC+nG,IAAI,CAACE,MAAL,CAAYrgH,MAAnE,IAA6E,CAACmgH,IAAI,CAACC,aAAvF,EAAsG;AACpGD,QAAAA,IAAI,CAACC,aAAL,GAAqBD,IAAI,CAACE,MAA1B;;AACAF,QAAAA,IAAI,CAACE,MAAL,GAAc,YAAY;AACxBruF,UAAAA,MAAM,CAACmtD,aAAP,CAAqBwqE,WAArB;AACA33H,UAAAA,MAAM,CAACy8E,QAAP,CAAgB,KAAhB;AACA,iBAAO0R,IAAI,CAACC,aAAL,CAAmBD,IAAnB,CAAP;AACD,SAJD;AAKD;AACF;;AACDnuF,IAAAA,MAAM,CAAC43H,aAAP,GAAuBrhC,aAAa,CAACv2F,MAAD,CAApC;AACAA,IAAAA,MAAM,CAACs3F,mBAAP,GAA6BpC,mBAAmB,CAACl1F,MAAD,CAAhD;;AACA,QAAIopC,aAAa,CAACppC,MAAD,CAAjB,EAA2B;AACzBA,MAAAA,MAAM,CAAClK,EAAP,CAAU,YAAV,EAAwB,UAAUjd,CAAV,EAAa;AACnC,YAAIA,CAAC,CAAC41G,IAAN,EAAY;AACV51G,UAAAA,CAAC,CAAC2yC,OAAF,GAAY8qG,KAAK,CAACtgH,MAAN,CAAan9B,CAAC,CAAC2yC,OAAf,CAAZ;AACD;AACF,OAJD;AAKD;;AACD,QAAI6d,0BAA0B,CAACrpC,MAAD,CAA9B,EAAwC;AACtCA,MAAAA,MAAM,CAAClK,EAAP,CAAU,QAAV,EAAoB,YAAY;AAC9B,YAAIkK,MAAM,CAAC6lH,WAAX,EAAwB;AACtB7lH,UAAAA,MAAM,CAACyuF,IAAP;AACD;AACF,OAJD;AAKD;;AACD,QAAInlD,sBAAsB,CAACtpC,MAAD,CAA1B,EAAoC;AAClCA,MAAAA,MAAM,CAAC8uF,aAAP,GAAuB,YAAY;AACjC,YAAI9uF,MAAM,CAAC6lH,WAAP,IAAsB,CAAC7lH,MAAM,CAAC6uF,SAA9B,IAA2C,CAAC7uF,MAAM,CAAC6xB,QAAP,EAAhD,EAAmE;AACjE7xB,UAAAA,MAAM,CAACyuF,IAAP,CAAY;AACVx5C,YAAAA,MAAM,EAAE,KADE;AAEVkhB,YAAAA,SAAS,EAAE,IAFD;AAGV0hE,YAAAA,SAAS,EAAE;AAHD,WAAZ;AAKD;AACF,OARD;;AASA73H,MAAAA,MAAM,CAACmtD,aAAP,CAAqBr3D,EAArB,CAAwB,cAAxB,EAAwCkK,MAAM,CAAC8uF,aAA/C;AACD;;AACD9uF,IAAAA,MAAM,CAACmtD,aAAP,CAAqB9/C,GAArB,CAAyBrN,MAAzB;AACAi1B,IAAAA,WAAW,CAACj1B,MAAD,EAASA,MAAM,CAAC4V,MAAhB,CAAX;AACD,GAxFD;;AA0FA,MAAIkiH,WAAW,GAAG,UAAU93H,MAAV,EAAkBjN,GAAlB,EAAuB;AACvC,WAAOk0E,SAAS,CAACjnE,MAAD,EAASjN,GAAT,CAAhB;AACD,GAFD;;AAIA,MAAIglI,eAAe,GAAG;AACpB,iBAAa,MADO;AAEpB,mBAAe;AAFK,GAAtB;;AAIA,MAAIC,oBAAoB,GAAG,UAAUjkC,QAAV,EAAoBxgG,OAApB,EAA6BR,GAA7B,EAAkC;AAC3D,QAAIklI,WAAW,GAAG,UAAUllI,GAAV,EAAe;AAC/B,aAAOV,MAAM,CAACU,GAAD,EAAMghG,QAAN,CAAN,CAAsBriH,OAAtB,CAA8B,YAAY;AAC/C,YAAI5E,IAAI,CAACimB,GAAD,CAAJ,KAAc,MAAlB,EAA0B;AACxB,iBAAO/b,KAAK,CAAC+gJ,eAAD,EAAkBhkC,QAAlB,CAAL,CAAiCliH,IAAjC,CAAsC,UAAUqmJ,cAAV,EAA0B;AACrE,mBAAO3mI,MAAM,CAACwB,GAAD,EAAMmlI,cAAN,CAAb;AACD,WAFM,CAAP;AAGD,SAJD,MAIO;AACL,iBAAOrlJ,QAAQ,CAACrC,IAAT,EAAP;AACD;AACF,OARM,CAAP;AASD,KAVD;;AAWA,QAAIgY,MAAM,GAAG,UAAUuK,GAAV,EAAe;AAC1B,aAAOhM,IAAI,CAAC3B,YAAY,CAACX,OAAb,CAAqB8O,OAArB,CAAD,EAAgCR,GAAhC,CAAX;AACD,KAFD;;AAGA,WAAO41E,SAAS,CAACvjF,YAAY,CAACX,OAAb,CAAqBsO,GAArB,CAAD,EAA4B,UAAUA,GAAV,EAAe;AACzD,aAAOklI,WAAW,CAACllI,GAAD,CAAlB;AACD,KAFe,EAEbvK,MAFa,CAAhB;AAGD,GAlBD;;AAmBA,MAAI2vI,mBAAmB,GAAG,UAAUn4B,UAAV,EAAsB;AAC9C,WAAOA,UAAU,CAAChlH,OAAX,CAAmB,WAAnB,EAAgC,EAAhC,EAAoCA,OAApC,CAA4C,OAA5C,EAAqD,GAArD,CAAP;AACD,GAFD;;AAGA,MAAIo9I,mBAAmB,GAAG,UAAUrkC,QAAV,EAAoBhhG,GAApB,EAAyB;AACjD,WAAOlgB,QAAQ,CAACD,IAAT,CAAcm7C,QAAQ,CAAC2D,GAAT,CAAa3B,QAAb,CAAsBh9B,GAAtB,EAA2BghG,QAA3B,EAAqC,IAArC,CAAd,CAAP;AACD,GAFD;;AAGA,MAAIskC,WAAW,GAAG,UAAUtkC,QAAV,EAAoB;AACpC,WAAO,UAAUxgG,OAAV,EAAmBR,GAAnB,EAAwB;AAC7B,aAAOlgB,QAAQ,CAACD,IAAT,CAAcmgB,GAAd,EAAmBphB,GAAnB,CAAuByT,YAAY,CAACX,OAApC,EAA6CzS,MAA7C,CAAoD4V,SAApD,EAA+D/V,IAA/D,CAAoE,UAAUqU,OAAV,EAAmB;AAC5F,eAAO8xI,oBAAoB,CAACjkC,QAAD,EAAWxgG,OAAX,EAAoBrN,OAAO,CAAClB,GAA5B,CAApB,CAAqDvT,EAArD,CAAwD2mJ,mBAAmB,CAACrkC,QAAD,EAAW7tG,OAAO,CAAClB,GAAnB,CAA3E,CAAP;AACD,OAFM,EAEJ5T,KAFI,CAEE,EAFF,CAAP;AAGD,KAJD;AAKD,GAND;;AAOA,MAAIknJ,WAAW,GAAGD,WAAW,CAAC,WAAD,CAA7B;AACA,MAAIE,aAAa,GAAGzpJ,OAAO,CAACqpJ,mBAAD,EAAsBE,WAAW,CAAC,aAAD,CAAjC,CAA3B;;AAEA,MAAIG,qBAAqB,GAAG,UAAUx4H,MAAV,EAAkB;AAC5C,WAAOsxC,eAAe,CAACtxC,MAAM,CAACo6B,OAAP,EAAD,CAAf,CAAkCzoD,GAAlC,CAAsC,UAAUw6D,KAAV,EAAiB;AAC5D,UAAI7qD,SAAS,GAAG6qD,KAAK,CAAC7qD,SAAN,EAAhB;AACA,aAAO+O,QAAQ,CAAC/O,SAAD,CAAR,GAAsBA,SAAS,CAACgH,UAAhC,GAA6ChH,SAApD;AACD,KAHM,CAAP;AAID,GALD;;AAMA,MAAIm3I,eAAe,GAAG,UAAUz4H,MAAV,EAAkB;AACtC,WAAOntB,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAd,EAAyCtoD,IAAzC,CAA8C,UAAUooD,GAAV,EAAe;AAClE,UAAI93C,IAAI,GAAG6d,MAAM,CAACo6B,OAAP,EAAX;AACA,UAAIs+F,aAAa,GAAGz+F,GAAG,CAACryB,cAAJ,KAAuBzlB,IAAvB,IAA+B83C,GAAG,CAACnG,WAAJ,KAAoB,CAAvE;AACA,aAAO4kG,aAAa,GAAG7lJ,QAAQ,CAACrC,IAAT,EAAH,GAAqBqC,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,CAA0B,IAA1B,CAAd,CAAzC;AACD,KAJM,CAAP;AAKD,GAND;;AAOA,MAAIi2E,QAAQ,GAAG,UAAU34H,MAAV,EAAkB44H,MAAlB,EAA0B;AACvC,WAAOH,eAAe,CAACz4H,MAAD,CAAf,CAAwBtuB,OAAxB,CAAgC9B,KAAK,CAAC4oJ,qBAAD,EAAwBx4H,MAAxB,CAArC,EAAsEruB,GAAtE,CAA0EyT,YAAY,CAACX,OAAvF,EAAgGzS,MAAhG,CAAuG4V,SAAvG,EAAkHjW,GAAlH,CAAsHinJ,MAAtH,CAAP;AACD,GAFD;;AAIA,MAAIC,kBAAkB,GAAG,UAAU74H,MAAV,EAAkBtwB,KAAlB,EAAyB;AAChD,QAAI,YAAYmK,IAAZ,CAAiBnK,KAAjB,CAAJ,EAA6B;AAC3B,UAAIopJ,cAAc,GAAGxtH,QAAQ,CAAC57B,KAAD,EAAQ,EAAR,CAA7B;;AACA,UAAIopJ,cAAc,IAAI,CAAlB,IAAuBA,cAAc,IAAI,CAA7C,EAAgD;AAC9C,YAAIr0C,SAAS,GAAG99C,kBAAkB,CAAC3mC,MAAD,CAAlC;AACA,YAAI+4H,WAAW,GAAGnyF,kBAAkB,CAAC5mC,MAAD,CAApC;;AACA,YAAI+4H,WAAJ,EAAiB;AACf,iBAAOA,WAAW,CAACD,cAAc,GAAG,CAAlB,CAAX,IAAmCppJ,KAA1C;AACD,SAFD,MAEO;AACL,iBAAO+0G,SAAS,CAACq0C,cAAc,GAAG,CAAlB,CAAT,IAAiCppJ,KAAxC;AACD;AACF,OARD,MAQO;AACL,eAAOA,KAAP;AACD;AACF,KAbD,MAaO;AACL,aAAOA,KAAP;AACD;AACF,GAjBD;;AAkBA,MAAIspJ,kBAAkB,GAAG,UAAUC,IAAV,EAAgB;AACvC,QAAIC,KAAK,GAAGD,IAAI,CAACl3I,KAAL,CAAW,SAAX,CAAZ;AACA,WAAOpQ,GAAG,CAACunJ,KAAD,EAAQ,UAAUD,IAAV,EAAgB;AAChC,UAAIA,IAAI,CAAChsJ,OAAL,CAAa,GAAb,MAAsB,CAAC,CAAvB,IAA4B,EAAE2P,UAAU,CAACq8I,IAAD,EAAO,GAAP,CAAV,IAAyBr8I,UAAU,CAACq8I,IAAD,EAAO,IAAP,CAArC,CAAhC,EAAoF;AAClF,eAAO,OAAOA,IAAP,GAAc,IAArB;AACD,OAFD,MAEO;AACL,eAAOA,IAAP;AACD;AACF,KANS,CAAH,CAMJ17H,IANI,CAMC,GAND,CAAP;AAOD,GATD;;AAUA,MAAI47H,cAAc,GAAG,UAAUn5H,MAAV,EAAkBtwB,KAAlB,EAAyB;AAC5C,QAAIupJ,IAAI,GAAGJ,kBAAkB,CAAC74H,MAAD,EAAStwB,KAAT,CAA7B;AACAswB,IAAAA,MAAM,CAACq1C,SAAP,CAAiB++B,MAAjB,CAAwB,UAAxB,EAAoC;AAAE1kG,MAAAA,KAAK,EAAEspJ,kBAAkB,CAACC,IAAD;AAA3B,KAApC;AACAj5H,IAAAA,MAAM,CAAC2hD,WAAP;AACD,GAJD;;AAKA,MAAIy3E,aAAa,GAAG,UAAUp5H,MAAV,EAAkB;AACpC,WAAO24H,QAAQ,CAAC34H,MAAD,EAAS,UAAUjN,GAAV,EAAe;AACrC,aAAOwlI,aAAa,CAACv4H,MAAM,CAACo6B,OAAP,EAAD,EAAmBrnC,GAAG,CAAC/N,GAAvB,CAApB;AACD,KAFc,CAAR,CAEJ5T,KAFI,CAEE,EAFF,CAAP;AAGD,GAJD;;AAKA,MAAIioJ,cAAc,GAAG,UAAUr5H,MAAV,EAAkBtwB,KAAlB,EAAyB;AAC5CswB,IAAAA,MAAM,CAACq1C,SAAP,CAAiB++B,MAAjB,CAAwB,UAAxB,EAAoC;AAAE1kG,MAAAA,KAAK,EAAEmpJ,kBAAkB,CAAC74H,MAAD,EAAStwB,KAAT;AAA3B,KAApC;AACAswB,IAAAA,MAAM,CAAC2hD,WAAP;AACD,GAHD;;AAIA,MAAI23E,aAAa,GAAG,UAAUt5H,MAAV,EAAkB;AACpC,WAAO24H,QAAQ,CAAC34H,MAAD,EAAS,UAAUjN,GAAV,EAAe;AACrC,aAAOulI,WAAW,CAACt4H,MAAM,CAACo6B,OAAP,EAAD,EAAmBrnC,GAAG,CAAC/N,GAAvB,CAAlB;AACD,KAFc,CAAR,CAEJ5T,KAFI,CAEE,EAFF,CAAP;AAGD,GAJD;;AAMA,MAAImoJ,eAAe,GAAG,UAAUv5H,MAAV,EAAkB;AACtC,WAAO24H,QAAQ,CAAC34H,MAAD,EAAS,UAAUjN,GAAV,EAAe;AACrC,UAAI5Q,IAAI,GAAGiD,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAX;AACA,UAAIo/F,cAAc,GAAG7wD,SAAS,CAAC51E,GAAD,EAAM,UAAUA,GAAV,EAAe;AACjD,eAAOV,MAAM,CAACU,GAAD,EAAM,aAAN,CAAb;AACD,OAF6B,EAE3BnjB,KAAK,CAACmX,IAAD,EAAO5E,IAAP,CAFsB,CAA9B;;AAGA,UAAIs3I,aAAa,GAAG,YAAY;AAC9B,YAAIr5B,UAAU,GAAGz6C,UAAU,CAACzzD,KAAK,CAACa,GAAD,EAAM,aAAN,CAAN,CAA3B;AACA,YAAImtG,QAAQ,GAAGv6C,UAAU,CAACzzD,KAAK,CAACa,GAAD,EAAM,WAAN,CAAN,CAAzB;AACA,eAAOhmB,MAAM,CAACqzH,UAAU,GAAGF,QAAd,CAAb;AACD,OAJD;;AAKA,aAAOs5B,cAAc,CAACnoJ,UAAf,CAA0BooJ,aAA1B,CAAP;AACD,KAXc,CAAR,CAWJroJ,KAXI,CAWE,EAXF,CAAP;AAYD,GAbD;;AAcA,MAAIsoJ,gBAAgB,GAAG,UAAU15H,MAAV,EAAkBogG,UAAlB,EAA8B;AACnDpgG,IAAAA,MAAM,CAAC27C,WAAP,CAAmBC,QAAnB,CAA4B,YAAY;AACtC57C,MAAAA,MAAM,CAACq1C,SAAP,CAAiB++B,MAAjB,CAAwB,YAAxB,EAAsC;AAAE1kG,QAAAA,KAAK,EAAE3C,MAAM,CAACqzH,UAAD;AAAf,OAAtC;AACApgG,MAAAA,MAAM,CAAC2hD,WAAP;AACD,KAHD;AAID,GALD;;AAOA,MAAIg4E,YAAY,GAAG,UAAUjqJ,KAAV,EAAiB;AAClC,QAAI82F,OAAJ;;AACA,QAAI,OAAO92F,KAAP,KAAiB,QAArB,EAA+B;AAC7B82F,MAAAA,OAAO,GAAG9iF,KAAK,CAACZ,MAAN,CAAa;AACrB6jF,QAAAA,KAAK,EAAEj3F,KAAK,CAACi3F,KADQ;AAErBnsE,QAAAA,IAAI,EAAE;AAAEmsE,UAAAA,KAAK,EAAEj3F,KAAK,CAACi3F;AAAf;AAFe,OAAb,EAGPj3F,KAHO,CAAV;AAIA,aAAO;AACL87C,QAAAA,OAAO,EAAE97C,KAAK,CAAC87C,OADV;AAELg7C,QAAAA,OAAO,EAAEA;AAFJ,OAAP;AAID;;AACD,WAAO;AACLh7C,MAAAA,OAAO,EAAE97C,KADJ;AAEL82F,MAAAA,OAAO,EAAE;AAFJ,KAAP;AAID,GAhBD;;AAiBA,MAAIozD,eAAe,GAAG,UAAU55H,MAAV,EAAkBtwB,KAAlB,EAAyB;AAC7C,QAAI2uB,MAAM,GAAGs7H,YAAY,CAACjqJ,KAAD,CAAzB;AACAguG,IAAAA,aAAa,CAAC19E,MAAD,EAAS3B,MAAM,CAACmtB,OAAhB,EAAyBntB,MAAM,CAACmoE,OAAhC,CAAb;AACD,GAHD;;AAKA,MAAIqzD,MAAM,GAAGn2I,KAAK,CAAC9R,IAAnB;AACA,MAAIkoJ,KAAK,GAAGp2I,KAAK,CAAC/R,GAAlB;AAAA,MAAuBooJ,SAAS,GAAGr2I,KAAK,CAACE,OAAzC;;AACA,MAAIo2I,cAAc,GAAG,YAAY;AAC/B,aAASA,cAAT,CAAwBh6H,MAAxB,EAAgC;AAC9B,WAAKi6H,QAAL,GAAgB;AACdz4H,QAAAA,KAAK,EAAE,EADO;AAEdhf,QAAAA,IAAI,EAAE,EAFQ;AAGd9S,QAAAA,KAAK,EAAE;AAHO,OAAhB;AAKA,WAAKswB,MAAL,GAAcA,MAAd;AACA,WAAKk6H,aAAL,CAAmBl6H,MAAnB;AACD;;AACDg6H,IAAAA,cAAc,CAACrtJ,SAAf,CAAyBk2E,WAAzB,GAAuC,UAAUkgD,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8BT,IAA9B,EAAoC;AACzE,UAAI4wB,IAAJ;AAAA,UAAU2B,KAAK,GAAG,KAAlB;AACA,UAAIjvB,IAAI,GAAG,IAAX;;AACA,UAAIA,IAAI,CAACytB,MAAL,CAAYC,OAAhB,EAAyB;AACvB;AACD;;AACD,UAAI,CAAC,mEAAmEpmB,IAAnE,CAAwEkpH,OAAxE,CAAD,KAAsF,CAAC9zH,IAAD,IAAS,CAACA,IAAI,CAACkrJ,UAArG,CAAJ,EAAsH;AACpH5nJ,QAAAA,IAAI,CAACytB,MAAL,CAAYskB,KAAZ;AACD,OAFD,MAEO;AACL0nC,QAAAA,OAAO,CAACz5E,IAAI,CAACytB,MAAN,CAAP;AACD;;AACD/wB,MAAAA,IAAI,GAAGsD,IAAI,CAACytB,MAAL,CAAYmb,IAAZ,CAAiB,mBAAjB,EAAsC;AAC3C4nF,QAAAA,OAAO,EAAEA,OADkC;AAE3CuuB,QAAAA,EAAE,EAAEA,EAFuC;AAG3C5hJ,QAAAA,KAAK,EAAEA;AAHoC,OAAtC,CAAP;;AAKA,UAAIT,IAAI,CAAC8oC,kBAAL,EAAJ,EAA+B;AAC7B,eAAO,KAAP;AACD;;AACD,UAAIqiH,aAAa,GAAGr3B,OAAO,CAAC1nH,WAAR,EAApB;;AACA,UAAIwkB,IAAI,GAAGttB,IAAI,CAAC0nJ,QAAL,CAAcz3I,IAAd,CAAmB43I,aAAnB,CAAX,EAA8C;AAC5Cv6H,QAAAA,IAAI,CAACu6H,aAAD,EAAgB9I,EAAhB,EAAoB5hJ,KAApB,CAAJ;AACA6C,QAAAA,IAAI,CAACytB,MAAL,CAAYmb,IAAZ,CAAiB,aAAjB,EAAgC;AAC9B4nF,UAAAA,OAAO,EAAEA,OADqB;AAE9BuuB,UAAAA,EAAE,EAAEA,EAF0B;AAG9B5hJ,UAAAA,KAAK,EAAEA;AAHuB,SAAhC;AAKA,eAAO,IAAP;AACD;;AACDmqJ,MAAAA,MAAM,CAAC,KAAK75H,MAAL,CAAY4+E,OAAb,EAAsB,UAAUjmG,CAAV,EAAa;AACvC,YAAIA,CAAC,CAACkqE,WAAF,IAAiBlqE,CAAC,CAACkqE,WAAF,CAAckgD,OAAd,EAAuBuuB,EAAvB,EAA2B5hJ,KAA3B,CAArB,EAAwD;AACtD6C,UAAAA,IAAI,CAACytB,MAAL,CAAYmb,IAAZ,CAAiB,aAAjB,EAAgC;AAC9B4nF,YAAAA,OAAO,EAAEA,OADqB;AAE9BuuB,YAAAA,EAAE,EAAEA,EAF0B;AAG9B5hJ,YAAAA,KAAK,EAAEA;AAHuB,WAAhC;AAKA8xB,UAAAA,KAAK,GAAG,IAAR;AACA,iBAAO,KAAP;AACD;AACF,OAVK,CAAN;;AAWA,UAAIA,KAAJ,EAAW;AACT,eAAOA,KAAP;AACD;;AACD,UAAIjvB,IAAI,CAACytB,MAAL,CAAY+uF,KAAZ,IAAqBx8G,IAAI,CAACytB,MAAL,CAAY+uF,KAAZ,CAAkBlsC,WAAvC,IAAsDtwE,IAAI,CAACytB,MAAL,CAAY+uF,KAAZ,CAAkBlsC,WAAlB,CAA8BkgD,OAA9B,EAAuCuuB,EAAvC,EAA2C5hJ,KAA3C,CAA1D,EAA6G;AAC3G6C,QAAAA,IAAI,CAACytB,MAAL,CAAYmb,IAAZ,CAAiB,aAAjB,EAAgC;AAC9B4nF,UAAAA,OAAO,EAAEA,OADqB;AAE9BuuB,UAAAA,EAAE,EAAEA,EAF0B;AAG9B5hJ,UAAAA,KAAK,EAAEA;AAHuB,SAAhC;AAKA,eAAO,IAAP;AACD;;AACD,UAAI;AACF8xB,QAAAA,KAAK,GAAGjvB,IAAI,CAACytB,MAAL,CAAYm7C,MAAZ,GAAqB0H,WAArB,CAAiCkgD,OAAjC,EAA0CuuB,EAA1C,EAA8C5hJ,KAA9C,CAAR;AACD,OAFD,CAEE,OAAO0oB,EAAP,EAAW,CACZ;;AACD,UAAIoJ,KAAJ,EAAW;AACTjvB,QAAAA,IAAI,CAACytB,MAAL,CAAYmb,IAAZ,CAAiB,aAAjB,EAAgC;AAC9B4nF,UAAAA,OAAO,EAAEA,OADqB;AAE9BuuB,UAAAA,EAAE,EAAEA,EAF0B;AAG9B5hJ,UAAAA,KAAK,EAAEA;AAHuB,SAAhC;AAKA,eAAO,IAAP;AACD;;AACD,aAAO,KAAP;AACD,KAhED;;AAiEAsqJ,IAAAA,cAAc,CAACrtJ,SAAf,CAAyB+kI,iBAAzB,GAA6C,UAAU3O,OAAV,EAAmB;AAC9D,UAAIljG,IAAJ;;AACA,UAAI,KAAKG,MAAL,CAAYyuD,MAAZ,CAAmB58B,QAAnB,MAAiC,KAAK7xB,MAAL,CAAYC,OAAjD,EAA0D;AACxD;AACD;;AACD8iG,MAAAA,OAAO,GAAGA,OAAO,CAAC1nH,WAAR,EAAV;;AACA,UAAIwkB,IAAI,GAAG,KAAKo6H,QAAL,CAAcz4H,KAAd,CAAoBuhG,OAApB,CAAX,EAAyC;AACvC,eAAOljG,IAAI,CAACkjG,OAAD,CAAX;AACD;;AACD,UAAI;AACF,eAAO,KAAK/iG,MAAL,CAAYm7C,MAAZ,GAAqBu2D,iBAArB,CAAuC3O,OAAvC,CAAP;AACD,OAFD,CAEE,OAAO3qG,EAAP,EAAW,CACZ;;AACD,aAAO,KAAP;AACD,KAdD;;AAeA4hI,IAAAA,cAAc,CAACrtJ,SAAf,CAAyB0tJ,iBAAzB,GAA6C,UAAUt3B,OAAV,EAAmB;AAC9D,UAAIljG,IAAJ;;AACA,UAAI,KAAKG,MAAL,CAAYyuD,MAAZ,CAAmB58B,QAAnB,MAAiC,KAAK7xB,MAAL,CAAYC,OAAjD,EAA0D;AACxD;AACD;;AACD8iG,MAAAA,OAAO,GAAGA,OAAO,CAAC1nH,WAAR,EAAV;;AACA,UAAIwkB,IAAI,GAAG,KAAKo6H,QAAL,CAAcvqJ,KAAd,CAAoBqzH,OAApB,CAAX,EAAyC;AACvC,eAAOljG,IAAI,CAACkjG,OAAD,CAAX;AACD;;AACD,UAAI;AACF,eAAO,KAAK/iG,MAAL,CAAYm7C,MAAZ,GAAqBk/E,iBAArB,CAAuCt3B,OAAvC,CAAP;AACD,OAFD,CAEE,OAAO3qG,EAAP,EAAW,CACZ;AACF,KAbD;;AAcA4hI,IAAAA,cAAc,CAACrtJ,SAAf,CAAyB2tJ,WAAzB,GAAuC,UAAUC,WAAV,EAAuBvnJ,IAAvB,EAA6B;AAClE,UAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AACnBA,QAAAA,IAAI,GAAG,MAAP;AACD;;AACD,UAAIT,IAAI,GAAG,IAAX;AACAsnJ,MAAAA,MAAM,CAACU,WAAD,EAAc,UAAU5iJ,QAAV,EAAoBorH,OAApB,EAA6B;AAC/C82B,QAAAA,MAAM,CAAC92B,OAAO,CAAC1nH,WAAR,GAAsB0G,KAAtB,CAA4B,GAA5B,CAAD,EAAmC,UAAUghH,OAAV,EAAmB;AAC1DxwH,UAAAA,IAAI,CAAC0nJ,QAAL,CAAcjnJ,IAAd,EAAoB+vH,OAApB,IAA+BprH,QAA/B;AACD,SAFK,CAAN;AAGD,OAJK,CAAN;AAKD,KAVD;;AAWAqiJ,IAAAA,cAAc,CAACrtJ,SAAf,CAAyBqlI,UAAzB,GAAsC,UAAUjP,OAAV,EAAmBprH,QAAnB,EAA6BqM,KAA7B,EAAoC;AACxE,UAAI4wB,KAAK,GAAG,IAAZ;;AACAmuF,MAAAA,OAAO,GAAGA,OAAO,CAAC1nH,WAAR,EAAV;;AACA,WAAK4+I,QAAL,CAAcz3I,IAAd,CAAmBugH,OAAnB,IAA8B,UAAUA,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8BT,IAA9B,EAAoC;AAChE,eAAO0I,QAAQ,CAACpK,IAAT,CAAcyW,KAAK,IAAI4wB,KAAK,CAAC5U,MAA7B,EAAqCsxH,EAArC,EAAyC5hJ,KAAzC,EAAgDT,IAAhD,CAAP;AACD,OAFD;AAGD,KAND;;AAOA+qJ,IAAAA,cAAc,CAACrtJ,SAAf,CAAyBkhJ,qBAAzB,GAAiD,UAAU9qB,OAAV,EAAmB;AAClEA,MAAAA,OAAO,GAAGA,OAAO,CAAC1nH,WAAR,EAAV;;AACA,UAAI,KAAK4+I,QAAL,CAAcz3I,IAAd,CAAmBugH,OAAnB,CAAJ,EAAiC;AAC/B,eAAO,IAAP;AACD;;AACD,UAAI;AACF,eAAO,KAAK/iG,MAAL,CAAYm7C,MAAZ,GAAqB0yE,qBAArB,CAA2C9qB,OAA3C,CAAP;AACD,OAFD,CAEE,OAAO3qG,EAAP,EAAW,CACZ;;AACD,aAAO,KAAP;AACD,KAVD;;AAWA4hI,IAAAA,cAAc,CAACrtJ,SAAf,CAAyB6tJ,oBAAzB,GAAgD,UAAUz3B,OAAV,EAAmBprH,QAAnB,EAA6BqM,KAA7B,EAAoC;AAClF,UAAI4wB,KAAK,GAAG,IAAZ;;AACAmuF,MAAAA,OAAO,GAAGA,OAAO,CAAC1nH,WAAR,EAAV;;AACA,WAAK4+I,QAAL,CAAcz4H,KAAd,CAAoBuhG,OAApB,IAA+B,YAAY;AACzC,eAAOprH,QAAQ,CAACpK,IAAT,CAAcyW,KAAK,IAAI4wB,KAAK,CAAC5U,MAA7B,CAAP;AACD,OAFD;AAGD,KAND;;AAOAg6H,IAAAA,cAAc,CAACrtJ,SAAf,CAAyB8tJ,oBAAzB,GAAgD,UAAU13B,OAAV,EAAmBprH,QAAnB,EAA6BqM,KAA7B,EAAoC;AAClF,UAAI4wB,KAAK,GAAG,IAAZ;;AACAmuF,MAAAA,OAAO,GAAGA,OAAO,CAAC1nH,WAAR,EAAV;;AACA,WAAK4+I,QAAL,CAAcvqJ,KAAd,CAAoBqzH,OAApB,IAA+B,YAAY;AACzC,eAAOprH,QAAQ,CAACpK,IAAT,CAAcyW,KAAK,IAAI4wB,KAAK,CAAC5U,MAA7B,CAAP;AACD,OAFD;AAGD,KAND;;AAOAg6H,IAAAA,cAAc,CAACrtJ,SAAf,CAAyB+tJ,gBAAzB,GAA4C,UAAU33B,OAAV,EAAmB;AAC7DA,MAAAA,OAAO,GAAGA,OAAO,CAAC1nH,WAAR,EAAV;AACA,aAAO,CAAC,CAAC,KAAK4+I,QAAL,CAAcz3I,IAAd,CAAmBugH,OAAnB,CAAT;AACD,KAHD;;AAIAi3B,IAAAA,cAAc,CAACrtJ,SAAf,CAAyBguJ,iBAAzB,GAA6C,UAAU53B,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AACzE,UAAI4hJ,EAAE,KAAK9kJ,SAAX,EAAsB;AACpB8kJ,QAAAA,EAAE,GAAG,KAAL;AACD;;AACD,UAAI5hJ,KAAK,KAAKlD,SAAd,EAAyB;AACvBkD,QAAAA,KAAK,GAAG,IAAR;AACD;;AACD,aAAO,KAAKswB,MAAL,CAAYm7C,MAAZ,GAAqB0H,WAArB,CAAiCkgD,OAAjC,EAA0CuuB,EAA1C,EAA8C5hJ,KAA9C,CAAP;AACD,KARD;;AASAsqJ,IAAAA,cAAc,CAACrtJ,SAAf,CAAyBiuJ,aAAzB,GAAyC,UAAU9tJ,IAAV,EAAgB;AACvD,aAAO,KAAKkzB,MAAL,CAAYq1C,SAAZ,CAAsB3yD,KAAtB,CAA4B5V,IAA5B,CAAP;AACD,KAFD;;AAGAktJ,IAAAA,cAAc,CAACrtJ,SAAf,CAAyB2zG,YAAzB,GAAwC,UAAUxzG,IAAV,EAAgB4C,KAAhB,EAAuB;AAC7D,WAAKswB,MAAL,CAAYq1C,SAAZ,CAAsB++B,MAAtB,CAA6BtnG,IAA7B,EAAmC4C,KAAK,GAAG;AAAEA,QAAAA,KAAK,EAAEA;AAAT,OAAH,GAAsBlD,SAA9D;AACA,WAAKwzB,MAAL,CAAY2hD,WAAZ;AACD,KAHD;;AAIAq4E,IAAAA,cAAc,CAACrtJ,SAAf,CAAyBkuJ,cAAzB,GAA0C,UAAU7nJ,IAAV,EAAgB;AACxD,WAAK8nJ,iBAAL,GAAyB,KAAK96H,MAAL,CAAYk6B,SAAZ,CAAsBoL,WAAtB,CAAkCtyD,IAAlC,CAAzB;AACD,KAFD;;AAGAgnJ,IAAAA,cAAc,CAACrtJ,SAAf,CAAyBsmI,gBAAzB,GAA4C,YAAY;AACtD,WAAKjzG,MAAL,CAAYk6B,SAAZ,CAAsBkL,cAAtB,CAAqC,KAAK01F,iBAA1C;AACD,KAFD;;AAGAd,IAAAA,cAAc,CAACrtJ,SAAf,CAAyButJ,aAAzB,GAAyC,UAAUl6H,MAAV,EAAkB;AACzD,UAAIztB,IAAI,GAAG,IAAX;AACA,WAAK+nJ,WAAL,CAAiB;AACf,gDAAwCzrJ,IADzB;AAEf,2CAAmC,YAAY;AAC7CmxB,UAAAA,MAAM,CAAC27C,WAAP,CAAmBtuC,GAAnB;AACD,SAJc;AAKf,0BAAkB,UAAU01F,OAAV,EAAmB;AACnC,cAAI9+G,GAAG,GAAG+b,MAAM,CAACm7C,MAAP,EAAV;AACA,cAAIj6C,MAAJ;;AACA,cAAI;AACF3uB,YAAAA,IAAI,CAACooJ,iBAAL,CAAuB53B,OAAvB;AACD,WAFD,CAEE,OAAO3qG,EAAP,EAAW;AACX8I,YAAAA,MAAM,GAAG,IAAT;AACD;;AACD,cAAI6hG,OAAO,KAAK,OAAZ,IAAuB,CAAC9+G,GAAG,CAAC82I,mBAAJ,CAAwBh4B,OAAxB,CAA5B,EAA8D;AAC5D7hG,YAAAA,MAAM,GAAG,IAAT;AACD;;AACD,cAAIA,MAAM,IAAI,CAACjd,GAAG,CAAC4pI,qBAAJ,CAA0B9qB,OAA1B,CAAf,EAAmD;AACjD,gBAAI3yH,GAAG,GAAG4vB,MAAM,CAAC3T,SAAP,CAAiB,mEAAmE,uDAApF,CAAV;;AACA,gBAAI5L,GAAG,CAACE,GAAR,EAAa;AACXvQ,cAAAA,GAAG,GAAGA,GAAG,CAAC4K,OAAJ,CAAY,SAAZ,EAAuB,SAAvB,CAAN;AACD;;AACDglB,YAAAA,MAAM,CAACs3F,mBAAP,CAA2BjS,IAA3B,CAAgC;AAC9BvgG,cAAAA,IAAI,EAAE1U,GADwB;AAE9B4C,cAAAA,IAAI,EAAE;AAFwB,aAAhC;AAID;AACF,SA1Bc;AA2Bf,kBAAU,YAAY;AACpB,cAAIgtB,MAAM,CAACk6B,SAAP,CAAiBkK,WAAjB,EAAJ,EAAoC;AAClC,gBAAIrxC,GAAG,GAAGiN,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqBvwB,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,EAArB,EAAkD,GAAlD,CAAV;;AACA,gBAAI3vD,GAAJ,EAAS;AACPiN,cAAAA,MAAM,CAAChb,GAAP,CAAW6G,MAAX,CAAkBkH,GAAlB,EAAuB,IAAvB;AACD;;AACD;AACD;;AACDiN,UAAAA,MAAM,CAACq1C,SAAP,CAAiBxpD,MAAjB,CAAwB,MAAxB;AACD,SApCc;AAqCf,0EAAkE,UAAUk3G,OAAV,EAAmB;AACnF,cAAIv6C,KAAK,GAAGu6C,OAAO,CAACzmH,SAAR,CAAkB,CAAlB,CAAZ;;AACA,cAAIksE,KAAK,KAAK,MAAd,EAAsB;AACpBA,YAAAA,KAAK,GAAG,SAAR;AACD;;AACDqxE,UAAAA,MAAM,CAAC,4BAA4B93I,KAA5B,CAAkC,GAAlC,CAAD,EAAyC,UAAUjV,IAAV,EAAgB;AAC7D,gBAAI07E,KAAK,KAAK17E,IAAd,EAAoB;AAClBkzB,cAAAA,MAAM,CAACq1C,SAAP,CAAiBxpD,MAAjB,CAAwB,UAAU/e,IAAlC;AACD;AACF,WAJK,CAAN;;AAKA,cAAI07E,KAAK,KAAK,MAAd,EAAsB;AACpBj2E,YAAAA,IAAI,CAAC+tG,YAAL,CAAkB,UAAU93B,KAA5B;AACD;AACF,SAlDc;AAmDf,iDAAyC,UAAUu6C,OAAV,EAAmB;AAC1D,cAAIi4B,UAAJ;AACAzoJ,UAAAA,IAAI,CAACooJ,iBAAL,CAAuB53B,OAAvB;AACA,cAAIzsB,OAAO,GAAGt2E,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqBvwB,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,EAArB,EAAiD,OAAjD,CAAd;;AACA,cAAIg3C,OAAJ,EAAa;AACX0kD,YAAAA,UAAU,GAAG1kD,OAAO,CAAChuF,UAArB;;AACA,gBAAI,2BAA2BzO,IAA3B,CAAgCmhJ,UAAU,CAACvzI,QAA3C,CAAJ,EAA0D;AACxDlV,cAAAA,IAAI,CAACsoJ,cAAL;AACA76H,cAAAA,MAAM,CAAChb,GAAP,CAAWjD,KAAX,CAAiBi5I,UAAjB,EAA6B1kD,OAA7B;AACA/jG,cAAAA,IAAI,CAAC0gI,gBAAL;AACD;AACF;AACF,SA/Dc;AAgEf,qEAA6D,UAAUlQ,OAAV,EAAmB;AAC9ExwH,UAAAA,IAAI,CAAC+tG,YAAL,CAAkByiB,OAAlB;AACD,SAlEc;AAmEf,iCAAyB,UAAUA,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AACrD6C,UAAAA,IAAI,CAAC+tG,YAAL,CAAkByiB,OAAlB,EAA2BrzH,KAA3B;AACD,SArEc;AAsEf,oBAAY,UAAUqzH,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AACxCypJ,UAAAA,cAAc,CAACn5H,MAAD,EAAStwB,KAAT,CAAd;AACD,SAxEc;AAyEf,oBAAY,UAAUqzH,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AACxC2pJ,UAAAA,cAAc,CAACr5H,MAAD,EAAStwB,KAAT,CAAd;AACD,SA3Ec;AA4Ef,sBAAc,UAAUqzH,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AAC1CgqJ,UAAAA,gBAAgB,CAAC15H,MAAD,EAAStwB,KAAT,CAAhB;AACD,SA9Ec;AA+Ef,wBAAgB,UAAUqzH,OAAV,EAAmB;AACjC/iG,UAAAA,MAAM,CAACq1C,SAAP,CAAiBxpD,MAAjB,CAAwBk3G,OAAxB;AACD,SAjFc;AAkFf,yBAAiB,YAAY;AAC3BxwH,UAAAA,IAAI,CAAC+tG,YAAL,CAAkB,YAAlB;AACD,SApFc;AAqFf,uBAAe,UAAUyiB,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AAC3C,iBAAO6C,IAAI,CAAC+tG,YAAL,CAAkB5wG,KAAK,IAAI,GAA3B,CAAP;AACD,SAvFc;AAwFf,sBAAc,YAAY;AACxB,cAAIy0D,QAAQ,GAAGnkC,MAAM,CAACk6B,SAAP,CAAiBoL,WAAjB,EAAf;AACAtlC,UAAAA,MAAM,CAAC2+D,UAAP,CAAkB3+D,MAAM,CAACs3D,UAAP,EAAlB;AACAt3D,UAAAA,MAAM,CAACk6B,SAAP,CAAiBkL,cAAjB,CAAgCjB,QAAhC;AACD,SA5Fc;AA6Ff,yBAAiB,UAAU4+D,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AAC7C,cAAIkV,IAAI,GAAGlV,KAAK,IAAIswB,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,EAApB;;AACA,cAAI16C,IAAI,KAAKob,MAAM,CAACo6B,OAAP,EAAb,EAA+B;AAC7B7nD,YAAAA,IAAI,CAACsoJ,cAAL;AACA76H,YAAAA,MAAM,CAAChb,GAAP,CAAW6G,MAAX,CAAkBjH,IAAlB,EAAwB,IAAxB;AACArS,YAAAA,IAAI,CAAC0gI,gBAAL;AACD;AACF,SApGc;AAqGf,8BAAsB,UAAUlQ,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AAClD,cAAIw+C,OAAO,GAAG,CAAd;AACAluB,UAAAA,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqBvwB,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,EAArB,EAAiD,UAAU16C,IAAV,EAAgB;AAC/D,gBAAIA,IAAI,CAACwB,QAAL,KAAkB,CAAlB,IAAuB8nC,OAAO,OAAOx+C,KAAzC,EAAgD;AAC9CswB,cAAAA,MAAM,CAACk6B,SAAP,CAAiBne,MAAjB,CAAwBn3B,IAAxB;AACA,qBAAO,KAAP;AACD;AACF,WALD,EAKGob,MAAM,CAACo6B,OAAP,EALH;AAMD,SA7Gc;AA8Gf,yBAAiB,UAAU2oE,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AAC7CswB,UAAAA,MAAM,CAACk6B,SAAP,CAAiBne,MAAjB,CAAwBrsC,KAAxB;AACD,SAhHc;AAiHf,4BAAoB,UAAUqzH,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AAChDkqJ,UAAAA,eAAe,CAAC55H,MAAD,EAAStwB,KAAT,CAAf;AACD,SAnHc;AAoHf,4BAAoB,UAAUqzH,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AAChDswB,UAAAA,MAAM,CAACk6B,SAAP,CAAiBykC,UAAjB,CAA4B,iBAA5B;AACA,cAAInzC,OAAO,GAAGxrB,MAAM,CAACs3D,UAAP,EAAd;AACAt3D,UAAAA,MAAM,CAAC2+D,UAAP,CAAkBnzC,OAAO,CAACxwC,OAAR,CAAgB,kBAAhB,EAAoC,YAAY;AAChE,mBAAOtL,KAAP;AACD,WAFiB,CAAlB;AAGD,SA1Hc;AA2Hf,4BAAoB,UAAUqzH,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AAChDu0I,UAAAA,QAAQ,CAACjkH,MAAD,EAAStwB,KAAT,CAAR;AACD,SA7Hc;AA8Hf,2BAAmB,UAAUqzH,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AAC/C6C,UAAAA,IAAI,CAAC+tG,YAAL,CAAkB5wG,KAAlB;AACD,SAhIc;AAiIf,yBAAiB,UAAUqzH,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AAC7CswB,UAAAA,MAAM,CAAC2+D,UAAP,CAAkBjvF,KAAlB;AACD,SAnIc;AAoIf,0BAAkB,UAAUqzH,OAAV,EAAmB;AACnCzrG,UAAAA,MAAM,CAAC0I,MAAD,EAAS+iG,OAAT,CAAN;AACD,SAtIc;AAuIf,sBAAcl0H,IAvIC;AAwIf,gCAAwB,YAAY;AAClCmxB,UAAAA,MAAM,CAAC6iD,WAAP,CAAmB,kBAAnB,EAAuC,KAAvC,EAA8C,QAA9C;AACD,SA1Ic;AA2If,8BAAsB,YAAY;AAChC7iD,UAAAA,MAAM,CAACo9E,SAAP,GAAmB,CAACp9E,MAAM,CAACo9E,SAA3B;AACAp9E,UAAAA,MAAM,CAACinE,SAAP;AACD,SA9Ic;AA+If,6BAAqB,UAAU87B,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AACjDswB,UAAAA,MAAM,CAAC6iD,WAAP,CAAmB,kBAAnB,EAAuC,KAAvC,EAA8CnzE,KAAK,CAACsL,OAAN,CAAc,kBAAd,EAAkCglB,MAAM,CAACk6B,SAAP,CAAiBo9B,UAAjB,CAA4B;AAAEriB,YAAAA,MAAM,EAAE;AAAV,WAA5B,CAAlC,CAA9C;AACD,SAjJc;AAkJf,yBAAiB,UAAU8tD,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AAC7C,cAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7BA,YAAAA,KAAK,GAAG;AAAE+0C,cAAAA,IAAI,EAAE/0C;AAAR,aAAR;AACD;;AACD,cAAIurJ,MAAM,GAAGj7H,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqBvwB,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,EAArB,EAAiD,GAAjD,CAAb;AACA5vD,UAAAA,KAAK,CAAC+0C,IAAN,GAAa/0C,KAAK,CAAC+0C,IAAN,CAAWzpC,OAAX,CAAmB,IAAnB,EAAyB,KAAzB,CAAb;;AACA,cAAI,CAACigJ,MAAD,IAAW,CAACvrJ,KAAK,CAAC+0C,IAAtB,EAA4B;AAC1BzkB,YAAAA,MAAM,CAACq1C,SAAP,CAAiBxpD,MAAjB,CAAwB,MAAxB;AACD;;AACD,cAAInc,KAAK,CAAC+0C,IAAV,EAAgB;AACdzkB,YAAAA,MAAM,CAACq1C,SAAP,CAAiBjmE,KAAjB,CAAuB,MAAvB,EAA+BM,KAA/B,EAAsCurJ,MAAtC;AACD;AACF,SA9Jc;AA+Jf,qBAAa,YAAY;AACvB,cAAIC,WAAW,GAAGl7H,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqBvwB,MAAM,CAACk6B,SAAP,CAAiBwoB,QAAjB,EAArB,EAAkD/xD,qBAAlD,CAAlB;;AACA,cAAIuqI,WAAJ,EAAiB;AACf,gBAAIjhG,GAAG,GAAGj6B,MAAM,CAAChb,GAAP,CAAW+tC,SAAX,EAAV;AACAkH,YAAAA,GAAG,CAACkhG,kBAAJ,CAAuBD,WAAvB;AACAl7H,YAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBlZ,GAAxB;AACD;AACF,SAtKc;AAuKf,0BAAkB,YAAY;AAC5Bj6B,UAAAA,MAAM,CAAC2+D,UAAP,CAAkB,EAAlB;AACD,SAzKc;AA0Kf,2BAAmB,UAAUokC,OAAV,EAAmBuuB,EAAnB,EAAuB5hJ,KAAvB,EAA8B;AAC/C+yI,UAAAA,QAAQ,CAACziH,MAAD,EAAStwB,KAAT,CAAR;AACA,iBAAO,IAAP;AACD;AA7Kc,OAAjB;;AA+KA,UAAI0rJ,WAAW,GAAG,UAAUtuJ,IAAV,EAAgB;AAChC,eAAO,YAAY;AACjB,cAAIotD,SAAS,GAAGl6B,MAAM,CAACk6B,SAAvB;AACA,cAAIrnC,KAAK,GAAGqnC,SAAS,CAACkK,WAAV,KAA0B,CAACpkC,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqB2J,SAAS,CAACoF,OAAV,EAArB,EAA0Ct/B,MAAM,CAAChb,GAAP,CAAW4f,OAArD,CAAD,CAA1B,GAA4Fs1B,SAAS,CAACq1B,iBAAV,EAAxG;AACA,cAAIxvE,OAAO,GAAG+5I,KAAK,CAACjnI,KAAD,EAAQ,UAAUjO,IAAV,EAAgB;AACzC,mBAAO,CAAC,CAACob,MAAM,CAACq1C,SAAP,CAAiB4zB,SAAjB,CAA2BrkF,IAA3B,EAAiC9X,IAAjC,CAAT;AACD,WAFkB,CAAnB;AAGA,iBAAOitJ,SAAS,CAACh6I,OAAD,EAAU,IAAV,CAAT,KAA6B,CAAC,CAArC;AACD,SAPD;AAQD,OATD;;AAUAxN,MAAAA,IAAI,CAAC+nJ,WAAL,CAAiB;AACf,uBAAec,WAAW,CAAC,WAAD,CADX;AAEf,yBAAiBA,WAAW,CAAC,aAAD,CAFb;AAGf,wBAAgBA,WAAW,CAAC,YAAD,CAHZ;AAIf,uBAAeA,WAAW,CAAC,cAAD,CAJX;AAKf,qEAA6D,UAAUr4B,OAAV,EAAmB;AAC9E,iBAAOxwH,IAAI,CAACqoJ,aAAL,CAAmB73B,OAAnB,CAAP;AACD,SAPc;AAQf,yBAAiB,YAAY;AAC3B,iBAAOxwH,IAAI,CAACqoJ,aAAL,CAAmB,YAAnB,CAAP;AACD,SAVc;AAWf,mBAAW,YAAY;AACrB,iBAAOzpB,UAAU,CAACnxG,MAAD,CAAjB;AACD,SAbc;AAcf,iDAAyC,UAAU+iG,OAAV,EAAmB;AAC1D,cAAItY,IAAI,GAAGzqF,MAAM,CAAChb,GAAP,CAAWurC,SAAX,CAAqBvwB,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,EAArB,EAAiD,OAAjD,CAAX;AACA,iBAAOmrD,IAAI,KAAKsY,OAAO,KAAK,qBAAZ,IAAqCtY,IAAI,CAACv6F,OAAL,KAAiB,IAAtD,IAA8D6yG,OAAO,KAAK,mBAAZ,IAAmCtY,IAAI,CAACv6F,OAAL,KAAiB,IAAvH,CAAX;AACD;AAjBc,OAAjB,EAkBG,OAlBH;AAmBA3d,MAAAA,IAAI,CAAC+nJ,WAAL,CAAiB;AACfe,QAAAA,IAAI,EAAE,YAAY;AAChBr7H,UAAAA,MAAM,CAAC27C,WAAP,CAAmBohC,IAAnB;AACD,SAHc;AAIfu+C,QAAAA,IAAI,EAAE,YAAY;AAChBt7H,UAAAA,MAAM,CAAC27C,WAAP,CAAmBmhC,IAAnB;AACD;AANc,OAAjB;AAQAvqG,MAAAA,IAAI,CAACkoJ,oBAAL,CAA0B,UAA1B,EAAsC,YAAY;AAChD,eAAOrB,aAAa,CAACp5H,MAAD,CAApB;AACD,OAFD,EAEG,IAFH;AAGAztB,MAAAA,IAAI,CAACkoJ,oBAAL,CAA0B,UAA1B,EAAsC,YAAY;AAChD,eAAOnB,aAAa,CAACt5H,MAAD,CAApB;AACD,OAFD,EAEG,IAFH;AAGAztB,MAAAA,IAAI,CAACkoJ,oBAAL,CAA0B,YAA1B,EAAwC,YAAY;AAClD,eAAOlB,eAAe,CAACv5H,MAAD,CAAtB;AACD,OAFD,EAEG,IAFH;AAGD,KA/ND;;AAgOA,WAAOg6H,cAAP;AACD,GA9YoB,EAArB;;AAgZA,MAAIuB,2BAA2B,GAAG,0BAAlC;;AACA,MAAI1vG,WAAW,GAAG,UAAU94B,GAAV,EAAe6+B,GAAf,EAAoBpwB,KAApB,EAA2B;AAC3C,QAAIi4B,KAAK,CAAC1mC,GAAD,EAAM6+B,GAAN,CAAL,IAAmBpwB,KAAK,KAAK,KAAjC,EAAwC;AACtCg4B,MAAAA,QAAQ,CAACzmC,GAAD,EAAM6+B,GAAN,CAAR;AACD,KAFD,MAEO,IAAIpwB,KAAJ,EAAW;AAChB83B,MAAAA,KAAK,CAACvmC,GAAD,EAAM6+B,GAAN,CAAL;AACD;AACF,GAND;;AAOA,MAAIy7F,qBAAqB,GAAG,UAAUrtH,MAAV,EAAkB8iG,GAAlB,EAAuBthG,KAAvB,EAA8B;AACxD,QAAI;AACFxB,MAAAA,MAAM,CAACm7C,MAAP,GAAgB0H,WAAhB,CAA4BigD,GAA5B,EAAiC,KAAjC,EAAwC/1H,MAAM,CAACy0B,KAAD,CAA9C;AACD,KAFD,CAEE,OAAOpJ,EAAP,EAAW,CACZ;AACF,GALD;;AAMA,MAAIojI,kBAAkB,GAAG,UAAUzoI,GAAV,EAAeyO,KAAf,EAAsB;AAC7CzO,IAAAA,GAAG,CAAC/N,GAAJ,CAAQnE,eAAR,GAA0B2gB,KAAK,GAAG,MAAH,GAAY,OAA3C;AACD,GAFD;;AAGA,MAAIi6H,4BAA4B,GAAG,UAAU1oI,GAAV,EAAe;AAChDnhB,IAAAA,IAAI,CAAC+nD,aAAa,CAAC5mC,GAAD,EAAM,2BAAN,CAAd,EAAkD,UAAUA,GAAV,EAAe;AACnE5B,MAAAA,GAAG,CAAC4B,GAAD,EAAMwoI,2BAAN,EAAmC,MAAnC,CAAH;AACAC,MAAAA,kBAAkB,CAACzoI,GAAD,EAAM,KAAN,CAAlB;AACD,KAHG,CAAJ;AAID,GALD;;AAMA,MAAI2oI,2BAA2B,GAAG,UAAU3oI,GAAV,EAAe;AAC/CnhB,IAAAA,IAAI,CAAC+nD,aAAa,CAAC5mC,GAAD,EAAM,OAAOwoI,2BAAP,GAAqC,UAA3C,CAAd,EAAsE,UAAUxoI,GAAV,EAAe;AACvFtB,MAAAA,QAAQ,CAACsB,GAAD,EAAMwoI,2BAAN,CAAR;AACAC,MAAAA,kBAAkB,CAACzoI,GAAD,EAAM,IAAN,CAAlB;AACD,KAHG,CAAJ;AAID,GALD;;AAMA,MAAI4oI,mBAAmB,GAAG,UAAU37H,MAAV,EAAkB;AAC1CntB,IAAAA,QAAQ,CAACD,IAAT,CAAcotB,MAAM,CAACk6B,SAAP,CAAiBoF,OAAjB,EAAd,EAA0C1tD,IAA1C,CAA+C,UAAUmhB,GAAV,EAAe;AAC5DA,MAAAA,GAAG,CAACrB,eAAJ,CAAoB,mBAApB;AACD,KAFD;AAGD,GAJD;;AAKA,MAAIkqI,oBAAoB,GAAG,UAAU57H,MAAV,EAAkB;AAC3CA,IAAAA,MAAM,CAACk6B,SAAP,CAAiBiZ,MAAjB,CAAwBnzC,MAAM,CAACk6B,SAAP,CAAiBC,MAAjB,EAAxB;AACD,GAFD;;AAGA,MAAI0hG,cAAc,GAAG,UAAU77H,MAAV,EAAkBwB,KAAlB,EAAyB;AAC5C,QAAItV,IAAI,GAAG9G,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAX;AACAvO,IAAAA,WAAW,CAAC3/B,IAAD,EAAO,sBAAP,EAA+BsV,KAA/B,CAAX;;AACA,QAAIA,KAAJ,EAAW;AACTxB,MAAAA,MAAM,CAACk6B,SAAP,CAAiBmqD,gBAAjB,CAAkCriC,cAAlC;;AACAhiD,MAAAA,MAAM,CAAC8mE,mBAAP,CAA2B2jC,aAA3B;;AACAkxB,MAAAA,mBAAmB,CAAC37H,MAAD,CAAnB;AACAA,MAAAA,MAAM,CAACmqB,QAAP,GAAkB,IAAlB;AACAqxG,MAAAA,kBAAkB,CAACtvI,IAAD,EAAO,KAAP,CAAlB;AACAuvI,MAAAA,4BAA4B,CAACvvI,IAAD,CAA5B;AACD,KAPD,MAOO;AACL8T,MAAAA,MAAM,CAACmqB,QAAP,GAAkB,KAAlB;AACAqxG,MAAAA,kBAAkB,CAACtvI,IAAD,EAAO,IAAP,CAAlB;AACAwvI,MAAAA,2BAA2B,CAACxvI,IAAD,CAA3B;AACAmhI,MAAAA,qBAAqB,CAACrtH,MAAD,EAAS,cAAT,EAAyB,KAAzB,CAArB;AACAqtH,MAAAA,qBAAqB,CAACrtH,MAAD,EAAS,0BAAT,EAAqC,KAArC,CAArB;AACAqtH,MAAAA,qBAAqB,CAACrtH,MAAD,EAAS,sBAAT,EAAiC,KAAjC,CAArB;;AACA,UAAIuuD,kBAAkB,CAACvuD,MAAD,CAAtB,EAAgC;AAC9BA,QAAAA,MAAM,CAACskB,KAAP;AACD;;AACDs3G,MAAAA,oBAAoB,CAAC57H,MAAD,CAApB;AACAA,MAAAA,MAAM,CAAC2hD,WAAP;AACD;AACF,GAvBD;;AAwBA,MAAIm6E,YAAY,GAAG,UAAU97H,MAAV,EAAkB;AACnC,WAAOA,MAAM,CAACmqB,QAAd;AACD,GAFD;;AAGA,MAAI4xG,eAAe,GAAG,UAAU/7H,MAAV,EAAkB;AACtCA,IAAAA,MAAM,CAACymE,MAAP,CAAcmiB,kBAAd,CAAiC,iBAAjC,EAAoD,UAAU/1F,KAAV,EAAiB;AACnE,UAAIipI,YAAY,CAAC97H,MAAD,CAAhB,EAA0B;AACxBpuB,QAAAA,IAAI,CAACihB,KAAD,EAAQ,UAAUjO,IAAV,EAAgB;AAC1BA,UAAAA,IAAI,CAACgN,IAAL,CAAU2pI,2BAAV,EAAuC32I,IAAI,CAACgN,IAAL,CAAU,iBAAV,CAAvC;AACAhN,UAAAA,IAAI,CAACgN,IAAL,CAAU,iBAAV,EAA6B,OAA7B;AACD,SAHG,CAAJ;AAID;AACF,KAPD;AAQAoO,IAAAA,MAAM,CAACi8B,UAAP,CAAkB2sD,kBAAlB,CAAqC2yC,2BAArC,EAAkE,UAAU1oI,KAAV,EAAiB;AACjF,UAAIipI,YAAY,CAAC97H,MAAD,CAAhB,EAA0B;AACxBpuB,QAAAA,IAAI,CAACihB,KAAD,EAAQ,UAAUjO,IAAV,EAAgB;AAC1BA,UAAAA,IAAI,CAACgN,IAAL,CAAU,iBAAV,EAA6BhN,IAAI,CAACgN,IAAL,CAAU2pI,2BAAV,CAA7B;AACD,SAFG,CAAJ;AAGD;AACF,KAND;AAOAv7H,IAAAA,MAAM,CAACi8B,UAAP,CAAkBuwD,WAAlB,CAA8B+uC,2BAA9B;AACD,GAjBD;;AAkBA,MAAIS,8BAA8B,GAAG,UAAUh8H,MAAV,EAAkB;AACrD,QAAIA,MAAM,CAACi8B,UAAX,EAAuB;AACrB8/F,MAAAA,eAAe,CAAC/7H,MAAD,CAAf;AACD,KAFD,MAEO;AACLA,MAAAA,MAAM,CAAClK,EAAP,CAAU,SAAV,EAAqB,YAAY;AAC/BimI,QAAAA,eAAe,CAAC/7H,MAAD,CAAf;AACD,OAFD;AAGD;AACF,GARD;;AASA,MAAIi8H,YAAY,GAAG,UAAUpjJ,CAAV,EAAa;AAC9B,WAAOA,CAAC,CAAC7F,IAAF,KAAW,OAAlB;AACD,GAFD;;AAGA,MAAIkpJ,gBAAgB,GAAG,UAAUl8H,MAAV,EAAkBjN,GAAlB,EAAuB;AAC5C,QAAIvK,MAAM,GAAG,UAAUuK,GAAV,EAAe;AAC1B,aAAOhM,IAAI,CAACgM,GAAD,EAAM3N,YAAY,CAACX,OAAb,CAAqBub,MAAM,CAACo6B,OAAP,EAArB,CAAN,CAAX;AACD,KAFD;;AAGA,WAAOx7B,SAAS,CAAC7L,GAAD,EAAM,GAAN,EAAWvK,MAAX,CAAT,CAA4B3W,IAA5B,CAAiC,UAAUrC,CAAV,EAAa;AACnD,aAAO+hB,MAAM,CAAC/hB,CAAD,EAAI,MAAJ,CAAb;AACD,KAFM,CAAP;AAGD,GAPD;;AAQA,MAAI2sJ,qBAAqB,GAAG,UAAUn8H,MAAV,EAAkBnnB,CAAlB,EAAqB;AAC/C,QAAIojJ,YAAY,CAACpjJ,CAAD,CAAZ,IAAmB,CAACwkE,EAAE,CAACgB,cAAH,CAAkBxlE,CAAlB,CAAxB,EAA8C;AAC5C,UAAIka,GAAG,GAAG3N,YAAY,CAACX,OAAb,CAAqB5L,CAAC,CAACuE,MAAvB,CAAV;AACA8+I,MAAAA,gBAAgB,CAACl8H,MAAD,EAASjN,GAAT,CAAhB,CAA8BnhB,IAA9B,CAAmC,UAAU6yC,IAAV,EAAgB;AACjD5rC,QAAAA,CAAC,CAACqgC,cAAF;;AACA,YAAI,KAAKr/B,IAAL,CAAU4qC,IAAV,CAAJ,EAAqB;AACnB,cAAI23G,QAAQ,GAAGp8H,MAAM,CAAChb,GAAP,CAAW+2B,MAAX,CAAkB0I,IAAI,GAAG,UAAP,GAAoB/nC,aAAa,CAAC+nC,IAAD,EAAO,GAAP,CAAjC,GAA+C,IAAjE,CAAf;;AACA,cAAI23G,QAAQ,CAACpuJ,MAAb,EAAqB;AACnBgyB,YAAAA,MAAM,CAACk6B,SAAP,CAAiBrsC,cAAjB,CAAgCuuI,QAAQ,CAAC,CAAD,CAAxC,EAA6C,IAA7C;AACD;AACF,SALD,MAKO;AACLv8I,UAAAA,MAAM,CAACwlG,IAAP,CAAY5gE,IAAZ,EAAkB,QAAlB,EAA4B,sGAA5B;AACD;AACF,OAVD;AAWD;AACF,GAfD;;AAgBA,MAAI43G,iCAAiC,GAAG,UAAUr8H,MAAV,EAAkB;AACxDA,IAAAA,MAAM,CAAClK,EAAP,CAAU,WAAV,EAAuB,UAAUjd,CAAV,EAAa;AAClC,UAAIijJ,YAAY,CAAC97H,MAAD,CAAhB,EAA0B;AACxBnnB,QAAAA,CAAC,CAACqgC,cAAF;AACD;AACF,KAJD;AAKAlZ,IAAAA,MAAM,CAAClK,EAAP,CAAU,gBAAV,EAA4B,UAAUjd,CAAV,EAAa;AACvC,UAAIijJ,YAAY,CAAC97H,MAAD,CAAhB,EAA0B;AACxBnnB,QAAAA,CAAC,CAACqgC,cAAF;AACD;AACF,KAJD;AAKD,GAXD;;AAaA,MAAIojH,YAAY,GAAG54I,KAAK,CAAC9B,OAAN,CAAc,iIAAiI,uHAAjI,GAA2P,wCAA3P,GAAsS,6FAApT,EAAmZ,GAAnZ,CAAnB;;AACA,MAAI26I,eAAe,GAAG,YAAY;AAChC,aAASA,eAAT,CAAyBj8H,QAAzB,EAAmC;AACjC,WAAKk8H,QAAL,GAAgB,EAAhB;AACA,WAAKl8H,QAAL,GAAgBA,QAAQ,IAAI,EAA5B;AACA,WAAKtc,KAAL,GAAa,KAAKsc,QAAL,CAActc,KAAd,IAAuB,IAApC;AACA,WAAKy4I,WAAL,GAAmB,KAAKn8H,QAAL,CAAcm8H,WAAd,IAA6BnsJ,KAAhD;AACD;;AACDisJ,IAAAA,eAAe,CAACG,QAAhB,GAA2B,UAAU5vJ,IAAV,EAAgB;AACzC,aAAO,CAAC,CAACwvJ,YAAY,CAACxvJ,IAAI,CAACuO,WAAL,EAAD,CAArB;AACD,KAFD;;AAGAkhJ,IAAAA,eAAe,CAAC5vJ,SAAhB,CAA0BwuC,IAA1B,GAAiC,UAAUwhH,MAAV,EAAkBC,MAAlB,EAA0B;AACzD,UAAI9vJ,IAAI,GAAG6vJ,MAAM,CAACthJ,WAAP,EAAX;AACA,UAAIpM,IAAI,GAAG2tJ,MAAM,IAAI,EAArB;AACA3tJ,MAAAA,IAAI,CAAC+D,IAAL,GAAYlG,IAAZ;;AACA,UAAI,CAACmC,IAAI,CAACmO,MAAV,EAAkB;AAChBnO,QAAAA,IAAI,CAACmO,MAAL,GAAc,KAAK4G,KAAnB;AACD;;AACD,UAAI,CAAC/U,IAAI,CAACiqC,cAAV,EAA0B;AACxBjqC,QAAAA,IAAI,CAACiqC,cAAL,GAAsB,YAAY;AAChCjqC,UAAAA,IAAI,CAAC8oC,kBAAL,GAA0BxnC,MAA1B;AACD,SAFD;;AAGAtB,QAAAA,IAAI,CAACmqC,eAAL,GAAuB,YAAY;AACjCnqC,UAAAA,IAAI,CAACqqC,oBAAL,GAA4B/oC,MAA5B;AACD,SAFD;;AAGAtB,QAAAA,IAAI,CAACsqC,wBAAL,GAAgC,YAAY;AAC1CtqC,UAAAA,IAAI,CAACuqC,6BAAL,GAAqCjpC,MAArC;AACD,SAFD;;AAGAtB,QAAAA,IAAI,CAAC8oC,kBAAL,GAA0BznC,KAA1B;AACArB,QAAAA,IAAI,CAACqqC,oBAAL,GAA4BhpC,KAA5B;AACArB,QAAAA,IAAI,CAACuqC,6BAAL,GAAqClpC,KAArC;AACD;;AACD,UAAI,KAAKgwB,QAAL,CAAcu8H,UAAlB,EAA8B;AAC5B,aAAKv8H,QAAL,CAAcu8H,UAAd,CAAyB5tJ,IAAzB;AACD;;AACD,UAAIwoF,QAAQ,GAAG,KAAK+kE,QAAL,CAAc1vJ,IAAd,CAAf;;AACA,UAAI2qF,QAAJ,EAAc;AACZ,aAAK,IAAIvpF,CAAC,GAAG,CAAR,EAAWqJ,CAAC,GAAGkgF,QAAQ,CAACzpF,MAA7B,EAAqCE,CAAC,GAAGqJ,CAAzC,EAA4CrJ,CAAC,EAA7C,EAAiD;AAC/C,cAAIyJ,QAAQ,GAAG8/E,QAAQ,CAACvpF,CAAD,CAAvB;;AACA,cAAIyJ,QAAQ,CAACqe,IAAb,EAAmB;AACjB,iBAAKC,GAAL,CAASnpB,IAAT,EAAe6K,QAAQ,CAACkoB,IAAxB;AACD;;AACD,cAAI5wB,IAAI,CAACuqC,6BAAL,EAAJ,EAA0C;AACxCvqC,YAAAA,IAAI,CAACmqC,eAAL;AACA,mBAAOnqC,IAAP;AACD;;AACD,cAAI0I,QAAQ,CAACkoB,IAAT,CAActyB,IAAd,CAAmB,KAAKyW,KAAxB,EAA+B/U,IAA/B,MAAyC,KAA7C,EAAoD;AAClDA,YAAAA,IAAI,CAACiqC,cAAL;AACA,mBAAOjqC,IAAP;AACD;AACF;AACF;;AACD,aAAOA,IAAP;AACD,KA1CD;;AA2CAstJ,IAAAA,eAAe,CAAC5vJ,SAAhB,CAA0BmpB,EAA1B,GAA+B,UAAUhpB,IAAV,EAAgB6K,QAAhB,EAA0BwT,OAA1B,EAAmCwxF,KAAnC,EAA0C;AACvE,UAAIhlG,QAAQ,KAAK,KAAjB,EAAwB;AACtBA,QAAAA,QAAQ,GAAGrH,KAAX;AACD;;AACD,UAAIqH,QAAJ,EAAc;AACZ,YAAImlJ,eAAe,GAAG;AAAEj9H,UAAAA,IAAI,EAAEloB;AAAR,SAAtB;;AACA,YAAIglG,KAAJ,EAAW;AACTj5F,UAAAA,KAAK,CAACZ,MAAN,CAAag6I,eAAb,EAA8BngD,KAA9B;AACD;;AACD,YAAIxtF,KAAK,GAAGriB,IAAI,CAACuO,WAAL,GAAmB0G,KAAnB,CAAyB,GAAzB,CAAZ;AACA,YAAI7T,CAAC,GAAGihB,KAAK,CAACnhB,MAAd;;AACA,eAAOE,CAAC,EAAR,EAAY;AACV,cAAI6uJ,WAAW,GAAG5tI,KAAK,CAACjhB,CAAD,CAAvB;AACA,cAAIupF,QAAQ,GAAG,KAAK+kE,QAAL,CAAcO,WAAd,CAAf;;AACA,cAAI,CAACtlE,QAAL,EAAe;AACbA,YAAAA,QAAQ,GAAG,KAAK+kE,QAAL,CAAcO,WAAd,IAA6B,EAAxC;AACA,iBAAKN,WAAL,CAAiBM,WAAjB,EAA8B,IAA9B;AACD;;AACD,cAAI5xI,OAAJ,EAAa;AACXssE,YAAAA,QAAQ,CAAC31C,OAAT,CAAiBg7G,eAAjB;AACD,WAFD,MAEO;AACLrlE,YAAAA,QAAQ,CAACzjF,IAAT,CAAc8oJ,eAAd;AACD;AACF;AACF;;AACD,aAAO,IAAP;AACD,KA1BD;;AA2BAP,IAAAA,eAAe,CAAC5vJ,SAAhB,CAA0BspB,GAA1B,GAAgC,UAAUnpB,IAAV,EAAgB6K,QAAhB,EAA0B;AACxD,UAAIi9B,KAAK,GAAG,IAAZ;;AACA,UAAI9nC,IAAJ,EAAU;AACR,YAAIqiB,KAAK,GAAGriB,IAAI,CAACuO,WAAL,GAAmB0G,KAAnB,CAAyB,GAAzB,CAAZ;AACA,YAAI7T,CAAC,GAAGihB,KAAK,CAACnhB,MAAd;;AACA,eAAOE,CAAC,EAAR,EAAY;AACV,cAAI6uJ,WAAW,GAAG5tI,KAAK,CAACjhB,CAAD,CAAvB;AACA,cAAIupF,QAAQ,GAAG,KAAK+kE,QAAL,CAAcO,WAAd,CAAf;;AACA,cAAI,CAACA,WAAL,EAAkB;AAChB9mJ,YAAAA,MAAM,CAAC,KAAKumJ,QAAN,EAAgB,UAAUrlI,MAAV,EAAkB6lI,WAAlB,EAA+B;AACnDpoH,cAAAA,KAAK,CAAC6nH,WAAN,CAAkBO,WAAlB,EAA+B,KAA/B;;AACA,qBAAOpoH,KAAK,CAAC4nH,QAAN,CAAeQ,WAAf,CAAP;AACD,aAHK,CAAN;AAIA,mBAAO,IAAP;AACD;;AACD,cAAIvlE,QAAJ,EAAc;AACZ,gBAAI,CAAC9/E,QAAL,EAAe;AACb8/E,cAAAA,QAAQ,CAACzpF,MAAT,GAAkB,CAAlB;AACD,aAFD,MAEO;AACL,kBAAIivJ,EAAE,GAAGxlE,QAAQ,CAACzpF,MAAlB;;AACA,qBAAOivJ,EAAE,EAAT,EAAa;AACX,oBAAIxlE,QAAQ,CAACwlE,EAAD,CAAR,CAAap9H,IAAb,KAAsBloB,QAA1B,EAAoC;AAClC8/E,kBAAAA,QAAQ,GAAGA,QAAQ,CAACnqF,KAAT,CAAe,CAAf,EAAkB2vJ,EAAlB,EAAsBhtJ,MAAtB,CAA6BwnF,QAAQ,CAACnqF,KAAT,CAAe2vJ,EAAE,GAAG,CAApB,CAA7B,CAAX;AACA,uBAAKT,QAAL,CAAcO,WAAd,IAA6BtlE,QAA7B;AACD;AACF;AACF;;AACD,gBAAI,CAACA,QAAQ,CAACzpF,MAAd,EAAsB;AACpB,mBAAKyuJ,WAAL,CAAiB3vJ,IAAjB,EAAuB,KAAvB;AACA,qBAAO,KAAK0vJ,QAAL,CAAcO,WAAd,CAAP;AACD;AACF;AACF;AACF,OA/BD,MA+BO;AACL9mJ,QAAAA,MAAM,CAAC,KAAKumJ,QAAN,EAAgB,UAAUrlI,MAAV,EAAkBrqB,IAAlB,EAAwB;AAC5C8nC,UAAAA,KAAK,CAAC6nH,WAAN,CAAkB3vJ,IAAlB,EAAwB,KAAxB;AACD,SAFK,CAAN;AAGA,aAAK0vJ,QAAL,GAAgB,EAAhB;AACD;;AACD,aAAO,IAAP;AACD,KAxCD;;AAyCAD,IAAAA,eAAe,CAAC5vJ,SAAhB,CAA0BqpB,IAA1B,GAAiC,UAAUlpB,IAAV,EAAgB6K,QAAhB,EAA0BwT,OAA1B,EAAmC;AAClE,aAAO,KAAK2K,EAAL,CAAQhpB,IAAR,EAAc6K,QAAd,EAAwBwT,OAAxB,EAAiC;AAAE6K,QAAAA,IAAI,EAAE;AAAR,OAAjC,CAAP;AACD,KAFD;;AAGAumI,IAAAA,eAAe,CAAC5vJ,SAAhB,CAA0BuK,GAA1B,GAAgC,UAAUpK,IAAV,EAAgB;AAC9CA,MAAAA,IAAI,GAAGA,IAAI,CAACuO,WAAL,EAAP;AACA,aAAO,EAAE,CAAC,KAAKmhJ,QAAL,CAAc1vJ,IAAd,CAAD,IAAwB,KAAK0vJ,QAAL,CAAc1vJ,IAAd,EAAoBkB,MAApB,KAA+B,CAAzD,CAAP;AACD,KAHD;;AAIA,WAAOuuJ,eAAP;AACD,GAjIqB,EAAtB;;AAmIA,MAAIW,kBAAkB,GAAG,UAAUhnJ,GAAV,EAAe;AACtC,QAAI,CAACA,GAAG,CAACinJ,gBAAT,EAA2B;AACzBjnJ,MAAAA,GAAG,CAACinJ,gBAAJ,GAAuB,IAAIZ,eAAJ,CAAoB;AACzCv4I,QAAAA,KAAK,EAAE9N,GADkC;AAEzCumJ,QAAAA,WAAW,EAAE,UAAU3vJ,IAAV,EAAgB00B,KAAhB,EAAuB;AAClC,cAAI+6H,eAAe,CAACG,QAAhB,CAAyB5vJ,IAAzB,KAAkCoJ,GAAG,CAACknJ,iBAA1C,EAA6D;AAC3DlnJ,YAAAA,GAAG,CAACknJ,iBAAJ,CAAsBtwJ,IAAtB,EAA4B00B,KAA5B;AACD;AACF;AANwC,OAApB,CAAvB;AAQD;;AACD,WAAOtrB,GAAG,CAACinJ,gBAAX;AACD,GAZD;;AAaA,MAAIE,UAAU,GAAG;AACfliH,IAAAA,IAAI,EAAE,UAAUruC,IAAV,EAAgBmC,IAAhB,EAAsBquJ,MAAtB,EAA8B;AAClC,UAAI/qJ,IAAI,GAAG,IAAX;;AACA,UAAIA,IAAI,CAAC0tB,OAAL,IAAgBnzB,IAAI,KAAK,QAAzB,IAAqCA,IAAI,KAAK,QAAlD,EAA4D;AAC1D,eAAOmC,IAAP;AACD;;AACD,UAAIsuJ,cAAc,GAAGL,kBAAkB,CAAC3qJ,IAAD,CAAlB,CAAyB4oC,IAAzB,CAA8BruC,IAA9B,EAAoCmC,IAApC,CAArB;;AACA,UAAIquJ,MAAM,KAAK,KAAX,IAAoB/qJ,IAAI,CAACyQ,MAA7B,EAAqC;AACnC,YAAIs1D,QAAQ,GAAG/lE,IAAI,CAACyQ,MAAL,EAAf;;AACA,eAAOs1D,QAAQ,IAAI,CAACilF,cAAc,CAACjkH,oBAAf,EAApB,EAA2D;AACzDg/B,UAAAA,QAAQ,CAACn9B,IAAT,CAAcruC,IAAd,EAAoBywJ,cAApB,EAAoC,KAApC;AACAjlF,UAAAA,QAAQ,GAAGA,QAAQ,CAACt1D,MAAT,EAAX;AACD;AACF;;AACD,aAAOu6I,cAAP;AACD,KAfc;AAgBfznI,IAAAA,EAAE,EAAE,UAAUhpB,IAAV,EAAgB6K,QAAhB,EAA0BwT,OAA1B,EAAmC;AACrC,aAAO+xI,kBAAkB,CAAC,IAAD,CAAlB,CAAyBpnI,EAAzB,CAA4BhpB,IAA5B,EAAkC6K,QAAlC,EAA4CwT,OAA5C,CAAP;AACD,KAlBc;AAmBf8K,IAAAA,GAAG,EAAE,UAAUnpB,IAAV,EAAgB6K,QAAhB,EAA0B;AAC7B,aAAOulJ,kBAAkB,CAAC,IAAD,CAAlB,CAAyBjnI,GAAzB,CAA6BnpB,IAA7B,EAAmC6K,QAAnC,CAAP;AACD,KArBc;AAsBfqe,IAAAA,IAAI,EAAE,UAAUlpB,IAAV,EAAgB6K,QAAhB,EAA0B;AAC9B,aAAOulJ,kBAAkB,CAAC,IAAD,CAAlB,CAAyBlnI,IAAzB,CAA8BlpB,IAA9B,EAAoC6K,QAApC,CAAP;AACD,KAxBc;AAyBf40G,IAAAA,iBAAiB,EAAE,UAAUz/G,IAAV,EAAgB;AACjC,aAAOowJ,kBAAkB,CAAC,IAAD,CAAlB,CAAyBhmJ,GAAzB,CAA6BpK,IAA7B,CAAP;AACD;AA3Bc,GAAjB;AA8BA,MAAI0wJ,KAAK,GAAGzvG,QAAQ,CAAC2D,GAArB;AACA,MAAI+rG,wBAAJ;;AACA,MAAIC,cAAc,GAAG,UAAU19H,MAAV,EAAkB29H,SAAlB,EAA6B;AAChD,QAAIA,SAAS,KAAK,iBAAlB,EAAqC;AACnC,aAAO39H,MAAM,CAACm7C,MAAP,EAAP;AACD;;AACD,QAAI,CAACn7C,MAAM,CAAC+R,MAAR,IAAkB,uDAAuDl4B,IAAvD,CAA4D8jJ,SAA5D,CAAtB,EAA8F;AAC5F,aAAO39H,MAAM,CAACm7C,MAAP,GAAgB/yD,eAAvB;AACD;;AACD,QAAIw1I,SAAS,GAAGr1F,YAAY,CAACvoC,MAAD,CAA5B;;AACA,QAAI49H,SAAJ,EAAe;AACb,UAAI,CAAC59H,MAAM,CAAC49H,SAAZ,EAAuB;AACrB59H,QAAAA,MAAM,CAAC49H,SAAP,GAAmBJ,KAAK,CAACzhH,MAAN,CAAa6hH,SAAb,EAAwB,CAAxB,CAAnB;AACD;;AACD,aAAO59H,MAAM,CAAC49H,SAAd;AACD;;AACD,WAAO59H,MAAM,CAACo6B,OAAP,EAAP;AACD,GAfD;;AAgBA,MAAIyjG,WAAW,GAAG,UAAU79H,MAAV,EAAkB;AAClC,WAAO,CAACA,MAAM,CAACq0H,MAAR,IAAkB,CAACyH,YAAY,CAAC97H,MAAD,CAAtC;AACD,GAFD;;AAGA,MAAI61F,SAAS,GAAG,UAAU71F,MAAV,EAAkB29H,SAAlB,EAA6B9kJ,CAA7B,EAAgC;AAC9C,QAAIglJ,WAAW,CAAC79H,MAAD,CAAf,EAAyB;AACvBA,MAAAA,MAAM,CAACmb,IAAP,CAAYwiH,SAAZ,EAAuB9kJ,CAAvB;AACD,KAFD,MAEO,IAAIijJ,YAAY,CAAC97H,MAAD,CAAhB,EAA0B;AAC/Bm8H,MAAAA,qBAAqB,CAACn8H,MAAD,EAASnnB,CAAT,CAArB;AACD;AACF,GAND;;AAOA,MAAIilJ,iBAAiB,GAAG,UAAU99H,MAAV,EAAkB29H,SAAlB,EAA6B;AACnD,QAAII,QAAJ;;AACA,QAAI,CAAC/9H,MAAM,CAACg+H,SAAZ,EAAuB;AACrBh+H,MAAAA,MAAM,CAACg+H,SAAP,GAAmB,EAAnB;AACD;;AACD,QAAIh+H,MAAM,CAACg+H,SAAP,CAAiBL,SAAjB,KAA+B39H,MAAM,CAACC,OAA1C,EAAmD;AACjD;AACD;;AACD,QAAIg+H,YAAY,GAAGP,cAAc,CAAC19H,MAAD,EAAS29H,SAAT,CAAjC;;AACA,QAAIp1F,YAAY,CAACvoC,MAAD,CAAhB,EAA0B;AACxB,UAAI,CAACy9H,wBAAL,EAA+B;AAC7BA,QAAAA,wBAAwB,GAAG,EAA3B;AACAz9H,QAAAA,MAAM,CAACmtD,aAAP,CAAqBr3D,EAArB,CAAwB,cAAxB,EAAwC,YAAY;AAClD,cAAI,CAACkK,MAAM,CAACmtD,aAAP,CAAqBI,YAA1B,EAAwC;AACtC,gBAAIkwE,wBAAJ,EAA8B;AAC5BxnJ,cAAAA,MAAM,CAACwnJ,wBAAD,EAA2B,UAAUtmI,MAAV,EAAkBrqB,IAAlB,EAAwB;AACvDkzB,gBAAAA,MAAM,CAAChb,GAAP,CAAWg2B,MAAX,CAAkB0iH,cAAc,CAAC19H,MAAD,EAASlzB,IAAT,CAAhC;AACD,eAFK,CAAN;AAGA2wJ,cAAAA,wBAAwB,GAAG,IAA3B;AACD;AACF;AACF,SATD;AAUD;;AACD,UAAIA,wBAAwB,CAACE,SAAD,CAA5B,EAAyC;AACvC;AACD;;AACDI,MAAAA,QAAQ,GAAG,UAAUllJ,CAAV,EAAa;AACtB,YAAIuE,MAAM,GAAGvE,CAAC,CAACuE,MAAf;AACA,YAAI8gJ,OAAO,GAAGl+H,MAAM,CAACmtD,aAAP,CAAqBx3E,GAArB,EAAd;AACA,YAAIzH,CAAC,GAAGgwJ,OAAO,CAAClwJ,MAAhB;;AACA,eAAOE,CAAC,EAAR,EAAY;AACV,cAAIge,IAAI,GAAGgyI,OAAO,CAAChwJ,CAAD,CAAP,CAAWksD,OAAX,EAAX;;AACA,cAAIluC,IAAI,KAAK9O,MAAT,IAAmBogJ,KAAK,CAAC5pG,SAAN,CAAgBx2C,MAAhB,EAAwB8O,IAAxB,CAAvB,EAAsD;AACpD2pG,YAAAA,SAAS,CAACqoC,OAAO,CAAChwJ,CAAD,CAAR,EAAayvJ,SAAb,EAAwB9kJ,CAAxB,CAAT;AACD;AACF;AACF,OAVD;;AAWA4kJ,MAAAA,wBAAwB,CAACE,SAAD,CAAxB,GAAsCI,QAAtC;AACAP,MAAAA,KAAK,CAAC3rJ,IAAN,CAAWosJ,YAAX,EAAyBN,SAAzB,EAAoCI,QAApC;AACD,KA9BD,MA8BO;AACLA,MAAAA,QAAQ,GAAG,UAAUllJ,CAAV,EAAa;AACtBg9G,QAAAA,SAAS,CAAC71F,MAAD,EAAS29H,SAAT,EAAoB9kJ,CAApB,CAAT;AACD,OAFD;;AAGA2kJ,MAAAA,KAAK,CAAC3rJ,IAAN,CAAWosJ,YAAX,EAAyBN,SAAzB,EAAoCI,QAApC;AACA/9H,MAAAA,MAAM,CAACg+H,SAAP,CAAiBL,SAAjB,IAA8BI,QAA9B;AACD;AACF,GA9CD;;AA+CA,MAAII,gBAAgB,GAAG1lJ,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4kJ,UAAL,CAAT,EAA2B;AACxDlM,IAAAA,yBAAyB,EAAE,YAAY;AACrC,UAAI5+I,IAAI,GAAG,IAAX;AACAmR,MAAAA,KAAK,CAAC9R,IAAN,CAAWW,IAAI,CAAC6rJ,oBAAhB,EAAsC,UAAUtxJ,IAAV,EAAgB;AACpDgxJ,QAAAA,iBAAiB,CAACvrJ,IAAD,EAAOzF,IAAP,CAAjB;AACD,OAFD;AAGD,KANuD;AAOxDswJ,IAAAA,iBAAiB,EAAE,UAAUtwJ,IAAV,EAAgB00B,KAAhB,EAAuB;AACxC,UAAIjvB,IAAI,GAAG,IAAX;;AACA,UAAIzF,IAAI,KAAK,OAAT,IAAoBA,IAAI,KAAK,MAAjC,EAAyC;AACvC;AACD;;AACD,UAAI00B,KAAJ,EAAW;AACT,YAAIjvB,IAAI,CAACszI,WAAT,EAAsB;AACpBiY,UAAAA,iBAAiB,CAACvrJ,IAAD,EAAOzF,IAAP,CAAjB;AACD,SAFD,MAEO;AACL,cAAI,CAACyF,IAAI,CAAC6rJ,oBAAV,EAAgC;AAC9B7rJ,YAAAA,IAAI,CAAC6rJ,oBAAL,GAA4B,CAACtxJ,IAAD,CAA5B;AACD,WAFD,MAEO;AACLyF,YAAAA,IAAI,CAAC6rJ,oBAAL,CAA0BpqJ,IAA1B,CAA+BlH,IAA/B;AACD;AACF;AACF,OAVD,MAUO,IAAIyF,IAAI,CAACszI,WAAT,EAAsB;AAC3BtzI,QAAAA,IAAI,CAACyS,GAAL,CAASg2B,MAAT,CAAgB0iH,cAAc,CAACnrJ,IAAD,EAAOzF,IAAP,CAA9B,EAA4CA,IAA5C,EAAkDyF,IAAI,CAACyrJ,SAAL,CAAelxJ,IAAf,CAAlD;AACA,eAAOyF,IAAI,CAACyrJ,SAAL,CAAelxJ,IAAf,CAAP;AACD;AACF,KA1BuD;AA2BxD6hH,IAAAA,qBAAqB,EAAE,YAAY;AACjC,UAAIp8G,IAAI,GAAG,IAAX;AACA,UAAI2Z,IAAI,GAAG3Z,IAAI,CAAC6nD,OAAL,EAAX;AACA,UAAIp1C,GAAG,GAAGzS,IAAI,CAACyS,GAAf;;AACA,UAAIzS,IAAI,CAACyrJ,SAAT,EAAoB;AAClB/nJ,QAAAA,MAAM,CAAC1D,IAAI,CAACyrJ,SAAN,EAAiB,UAAUtuJ,KAAV,EAAiB5C,IAAjB,EAAuB;AAC5CyF,UAAAA,IAAI,CAACyS,GAAL,CAASg2B,MAAT,CAAgB0iH,cAAc,CAACnrJ,IAAD,EAAOzF,IAAP,CAA9B,EAA4CA,IAA5C,EAAkD4C,KAAlD;AACD,SAFK,CAAN;AAGA,eAAO6C,IAAI,CAACyrJ,SAAZ;AACD;;AACD,UAAI,CAACzrJ,IAAI,CAACw/B,MAAN,IAAgB7lB,IAAhB,IAAwBlH,GAA5B,EAAiC;AAC/BkH,QAAAA,IAAI,CAACwV,MAAL,GAAc,IAAd;AACA1c,QAAAA,GAAG,CAACg2B,MAAJ,CAAWzoC,IAAI,CAACy4E,MAAL,EAAX;AACAhmE,QAAAA,GAAG,CAACg2B,MAAJ,CAAWzoC,IAAI,CAAC4oE,MAAL,EAAX;AACD;;AACD,UAAIn2D,GAAJ,EAAS;AACPA,QAAAA,GAAG,CAACg2B,MAAJ,CAAW9uB,IAAX;AACAlH,QAAAA,GAAG,CAACg2B,MAAJ,CAAWzoC,IAAI,CAACk8F,YAAL,EAAX;AACD;AACF;AA9CuD,GAA3B,CAA/B;;AAiDA,MAAI4vD,YAAY,GAAG,CACjB,QADiB,EAEjB,UAFiB,CAAnB;;AAIA,MAAIC,YAAY,GAAG,UAAUt+H,MAAV,EAAkBu+H,UAAlB,EAA8BC,cAA9B,EAA8C1wH,IAA9C,EAAoD;AACrE,QAAI2wH,OAAO,GAAGD,cAAc,CAACD,UAAU,CAAC5oJ,GAAX,EAAD,CAA5B;AACA,QAAI+oJ,OAAO,GAAGF,cAAc,CAAC1wH,IAAD,CAA5B;;AACA,QAAI;AACF4wH,MAAAA,OAAO,CAACC,QAAR;AACD,KAFD,CAEE,OAAO9lJ,CAAP,EAAU;AACV0L,MAAAA,OAAO,CAACC,KAAR,CAAc,0CAA0CspB,IAA1C,GAAiD,GAA/D,EAAoEj1B,CAApE;AACA;AACD;;AACD4lJ,IAAAA,OAAO,CAACG,UAAR;;AACA,QAAIH,OAAO,CAACI,cAAR,KAA2BH,OAAO,CAACG,cAAvC,EAAuD;AACrDhD,MAAAA,cAAc,CAAC77H,MAAD,EAAS0+H,OAAO,CAACG,cAAjB,CAAd;AACD;;AACDN,IAAAA,UAAU,CAACptI,GAAX,CAAe2c,IAAf;AACA6uC,IAAAA,cAAc,CAAC38C,MAAD,EAAS8N,IAAT,CAAd;AACD,GAfD;;AAgBA,MAAIgxH,OAAO,GAAG,UAAU9+H,MAAV,EAAkBw+H,cAAlB,EAAkCD,UAAlC,EAA8CzwH,IAA9C,EAAoD;AAChE,QAAIA,IAAI,KAAKywH,UAAU,CAAC5oJ,GAAX,EAAb,EAA+B;AAC7B;AACD,KAFD,MAEO,IAAI,CAACuB,GAAG,CAACsnJ,cAAD,EAAiB1wH,IAAjB,CAAR,EAAgC;AACrC,YAAM,IAAIz9B,KAAJ,CAAU,mBAAmBy9B,IAAnB,GAA0B,eAApC,CAAN;AACD;;AACD,QAAI9N,MAAM,CAAC6lH,WAAX,EAAwB;AACtByY,MAAAA,YAAY,CAACt+H,MAAD,EAASu+H,UAAT,EAAqBC,cAArB,EAAqC1wH,IAArC,CAAZ;AACD,KAFD,MAEO;AACL9N,MAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,YAAY;AAC5B,eAAOwoI,YAAY,CAACt+H,MAAD,EAASu+H,UAAT,EAAqBC,cAArB,EAAqC1wH,IAArC,CAAnB;AACD,OAFD;AAGD;AACF,GAbD;;AAcA,MAAIixH,YAAY,GAAG,UAAUP,cAAV,EAA0B1wH,IAA1B,EAAgCssC,GAAhC,EAAqC;AACtD,QAAIxe,EAAJ;;AACA,QAAIxnD,QAAQ,CAACiqJ,YAAD,EAAevwH,IAAf,CAAZ,EAAkC;AAChC,YAAM,IAAIz9B,KAAJ,CAAU,kCAAkCy9B,IAA5C,CAAN;AACD;;AACD,WAAOr1B,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK+lJ,cAAL,CAAT,GAAgC5iG,EAAE,GAAG,EAAL,EAASA,EAAE,CAAC9tB,IAAD,CAAF,GAAWr1B,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK2hE,GAAL,CAAT,EAAoB;AAC7FwkF,MAAAA,UAAU,EAAE,YAAY;AACtB,YAAI;AACFxkF,UAAAA,GAAG,CAACwkF,UAAJ;AACD,SAFD,CAEE,OAAO/lJ,CAAP,EAAU;AACV0L,UAAAA,OAAO,CAACC,KAAR,CAAc,4CAA4CspB,IAA5C,GAAmD,GAAjE,EAAsEj1B,CAAtE;AACD;AACF;AAP4F,KAApB,CAA5B,EAQ3C+iD,EARW,EAAf;AASD,GAdD;;AAgBA,MAAIojG,QAAQ,GAAG,UAAUh/H,MAAV,EAAkB;AAC/B,QAAIu+H,UAAU,GAAGhpG,IAAI,CAAC,QAAD,CAArB;AACA,QAAIipG,cAAc,GAAGjpG,IAAI,CAAC;AACxB0pG,MAAAA,MAAM,EAAE;AACNN,QAAAA,QAAQ,EAAE9vJ,IADJ;AAEN+vJ,QAAAA,UAAU,EAAE/vJ,IAFN;AAGNgwJ,QAAAA,cAAc,EAAE;AAHV,OADgB;AAMxB10G,MAAAA,QAAQ,EAAE;AACRw0G,QAAAA,QAAQ,EAAE9vJ,IADF;AAER+vJ,QAAAA,UAAU,EAAE/vJ,IAFJ;AAGRgwJ,QAAAA,cAAc,EAAE;AAHR;AANc,KAAD,CAAzB;AAYA7C,IAAAA,8BAA8B,CAACh8H,MAAD,CAA9B;AACAq8H,IAAAA,iCAAiC,CAACr8H,MAAD,CAAjC;AACA,WAAO;AACL0pC,MAAAA,UAAU,EAAE,YAAY;AACtB,eAAOoyF,YAAY,CAAC97H,MAAD,CAAnB;AACD,OAHI;AAIL7O,MAAAA,GAAG,EAAE,UAAU2c,IAAV,EAAgB;AACnB,eAAOgxH,OAAO,CAAC9+H,MAAD,EAASw+H,cAAc,CAAC7oJ,GAAf,EAAT,EAA+B4oJ,UAA/B,EAA2CzwH,IAA3C,CAAd;AACD,OANI;AAOLn4B,MAAAA,GAAG,EAAE,YAAY;AACf,eAAO4oJ,UAAU,CAAC5oJ,GAAX,EAAP;AACD,OATI;AAUL2mD,MAAAA,QAAQ,EAAE,UAAUxuB,IAAV,EAAgBssC,GAAhB,EAAqB;AAC7BokF,QAAAA,cAAc,CAACrtI,GAAf,CAAmB4tI,YAAY,CAACP,cAAc,CAAC7oJ,GAAf,EAAD,EAAuBm4B,IAAvB,EAA6BssC,GAA7B,CAA/B;AACD;AAZI,KAAP;AAcD,GA9BD;;AAgCA,MAAI8kF,MAAM,GAAGx7I,KAAK,CAAC9R,IAAnB;AAAA,MAAyButJ,SAAS,GAAGz7I,KAAK,CAACJ,OAA3C;AACA,MAAI87I,aAAa,GAAG;AAClBC,IAAAA,EAAE,EAAE,GADc;AAElBC,IAAAA,EAAE,EAAE,GAFc;AAGlBC,IAAAA,EAAE,EAAE,GAHc;AAIlBC,IAAAA,EAAE,EAAE,GAJc;AAKlBC,IAAAA,EAAE,EAAE,GALc;AAMlBC,IAAAA,EAAE,EAAE,GANc;AAOlBC,IAAAA,EAAE,EAAE,GAPc;AAQlBC,IAAAA,EAAE,EAAE,GARc;AASlBC,IAAAA,EAAE,EAAE,GATc;AAUlBC,IAAAA,GAAG,EAAE,GAVa;AAWlBC,IAAAA,GAAG,EAAE,GAXa;AAYlBC,IAAAA,GAAG,EAAE;AAZa,GAApB;AAcA,MAAIC,aAAa,GAAGv8I,KAAK,CAAC9B,OAAN,CAAc,4BAAd,CAApB;;AACA,MAAIs+I,aAAa,GAAG,UAAU3uH,OAAV,EAAmB;AACrC,QAAIt6B,GAAJ;AACA,QAAIkpJ,QAAQ,GAAG,EAAf;AACAjB,IAAAA,MAAM,CAACC,SAAS,CAAC5tH,OAAO,CAACl2B,WAAR,EAAD,EAAwB,GAAxB,CAAV,EAAwC,UAAU3L,KAAV,EAAiB;AAC7D,UAAIA,KAAK,IAAIuwJ,aAAb,EAA4B;AAC1BE,QAAAA,QAAQ,CAACzwJ,KAAD,CAAR,GAAkB,IAAlB;AACD,OAFD,MAEO;AACL,YAAI,cAAcmK,IAAd,CAAmBnK,KAAnB,CAAJ,EAA+B;AAC7BywJ,UAAAA,QAAQ,CAACl0D,OAAT,GAAmB3gE,QAAQ,CAAC57B,KAAD,EAAQ,EAAR,CAA3B;AACD,SAFD,MAEO;AACLywJ,UAAAA,QAAQ,CAACC,QAAT,GAAoB1wJ,KAAK,CAACi8B,UAAN,CAAiB,CAAjB,CAApB;AACAw0H,UAAAA,QAAQ,CAACl0D,OAAT,GAAmBmzD,aAAa,CAAC1vJ,KAAD,CAAb,IAAwBA,KAAK,CAACq+B,WAAN,GAAoBpC,UAApB,CAA+B,CAA/B,CAA3C;AACD;AACF;AACF,KAXK,CAAN;AAYA,QAAI96B,EAAE,GAAG,CAACsvJ,QAAQ,CAACl0D,OAAV,CAAT;;AACA,SAAKh1F,GAAL,IAAYgpJ,aAAZ,EAA2B;AACzB,UAAIE,QAAQ,CAAClpJ,GAAD,CAAZ,EAAmB;AACjBpG,QAAAA,EAAE,CAACmD,IAAH,CAAQiD,GAAR;AACD,OAFD,MAEO;AACLkpJ,QAAAA,QAAQ,CAAClpJ,GAAD,CAAR,GAAgB,KAAhB;AACD;AACF;;AACDkpJ,IAAAA,QAAQ,CAACtvJ,EAAT,GAAcA,EAAE,CAAC0sB,IAAH,CAAQ,GAAR,CAAd;;AACA,QAAI4iI,QAAQ,CAACE,MAAb,EAAqB;AACnBF,MAAAA,QAAQ,CAACG,GAAT,GAAe,IAAf;;AACA,UAAI7/I,GAAG,CAACE,GAAR,EAAa;AACXw/I,QAAAA,QAAQ,CAACI,IAAT,GAAgB,IAAhB;AACD,OAFD,MAEO;AACLJ,QAAAA,QAAQ,CAAC7/G,KAAT,GAAiB,IAAjB;AACD;AACF;;AACD,QAAI6/G,QAAQ,CAACK,IAAb,EAAmB;AACjB,UAAI//I,GAAG,CAACE,GAAR,EAAa;AACXw/I,QAAAA,QAAQ,CAACK,IAAT,GAAgB,IAAhB;AACD,OAFD,MAEO;AACLL,QAAAA,QAAQ,CAACI,IAAT,GAAgB,IAAhB;AACAJ,QAAAA,QAAQ,CAACK,IAAT,GAAgB,KAAhB;AACD;AACF;;AACD,WAAOL,QAAP;AACD,GAzCD;;AA0CA,MAAIM,SAAS,GAAG,YAAY;AAC1B,aAASA,SAAT,CAAmBzgI,MAAnB,EAA2B;AACzB,WAAKouH,SAAL,GAAiB,EAAjB;AACA,WAAKsS,eAAL,GAAuB,EAAvB;AACA,WAAK1gI,MAAL,GAAcA,MAAd;AACA,UAAIztB,IAAI,GAAG,IAAX;AACAytB,MAAAA,MAAM,CAAClK,EAAP,CAAU,wBAAV,EAAoC,UAAUjd,CAAV,EAAa;AAC/C,YAAI,CAACtG,IAAI,CAACouJ,WAAL,CAAiB9nJ,CAAjB,KAAuBtG,IAAI,CAACquJ,aAAL,CAAmB/nJ,CAAnB,CAAxB,KAAkD,CAACA,CAAC,CAACk/B,kBAAF,EAAvD,EAA+E;AAC7EmnH,UAAAA,MAAM,CAAC3sJ,IAAI,CAAC67I,SAAN,EAAiB,UAAU+R,QAAV,EAAoB;AACzC,gBAAI5tJ,IAAI,CAACsuJ,aAAL,CAAmBhoJ,CAAnB,EAAsBsnJ,QAAtB,CAAJ,EAAqC;AACnC5tJ,cAAAA,IAAI,CAACmuJ,eAAL,GAAuBP,QAAQ,CAACW,WAAT,CAAqBxzJ,KAArB,CAA2B,CAA3B,CAAvB;;AACA,kBAAIuL,CAAC,CAAC7F,IAAF,KAAW,SAAf,EAA0B;AACxBT,gBAAAA,IAAI,CAACwuJ,qBAAL,CAA2BZ,QAA3B;AACD;;AACD,qBAAO,IAAP;AACD;AACF,WARK,CAAN;;AASA,cAAI5tJ,IAAI,CAACsuJ,aAAL,CAAmBhoJ,CAAnB,EAAsBtG,IAAI,CAACmuJ,eAAL,CAAqB,CAArB,CAAtB,CAAJ,EAAoD;AAClD,gBAAInuJ,IAAI,CAACmuJ,eAAL,CAAqB1yJ,MAArB,KAAgC,CAApC,EAAuC;AACrC,kBAAI6K,CAAC,CAAC7F,IAAF,KAAW,SAAf,EAA0B;AACxBT,gBAAAA,IAAI,CAACwuJ,qBAAL,CAA2BxuJ,IAAI,CAACmuJ,eAAL,CAAqB,CAArB,CAA3B;AACD;AACF;;AACDnuJ,YAAAA,IAAI,CAACmuJ,eAAL,CAAqBpgH,KAArB;AACD;AACF;AACF,OApBD;AAqBD;;AACDmgH,IAAAA,SAAS,CAAC9zJ,SAAV,CAAoB0gC,GAApB,GAA0B,UAAUkE,OAAV,EAAmByvH,IAAnB,EAAyBC,OAAzB,EAAkCj9I,KAAlC,EAAyC;AACjE,UAAIzR,IAAI,GAAG,IAAX;AACA,UAAIstB,IAAI,GAAGttB,IAAI,CAAC2uJ,oBAAL,CAA0BD,OAA1B,CAAX;AACA/B,MAAAA,MAAM,CAACC,SAAS,CAACz7I,KAAK,CAAC3G,IAAN,CAAWw0B,OAAX,CAAD,CAAV,EAAiC,UAAUA,OAAV,EAAmB;AACxD,YAAI4uH,QAAQ,GAAG5tJ,IAAI,CAAC4uJ,cAAL,CAAoB5vH,OAApB,EAA6ByvH,IAA7B,EAAmCnhI,IAAnC,EAAyC7b,KAAzC,CAAf;AACAzR,QAAAA,IAAI,CAAC67I,SAAL,CAAe+R,QAAQ,CAACtvJ,EAAxB,IAA8BsvJ,QAA9B;AACD,OAHK,CAAN;AAIA,aAAO,IAAP;AACD,KARD;;AASAM,IAAAA,SAAS,CAAC9zJ,SAAV,CAAoBkf,MAApB,GAA6B,UAAU0lB,OAAV,EAAmB;AAC9C,UAAI4uH,QAAQ,GAAG,KAAKgB,cAAL,CAAoB5vH,OAApB,CAAf;;AACA,UAAI,KAAK68G,SAAL,CAAe+R,QAAQ,CAACtvJ,EAAxB,CAAJ,EAAiC;AAC/B,eAAO,KAAKu9I,SAAL,CAAe+R,QAAQ,CAACtvJ,EAAxB,CAAP;AACA,eAAO,IAAP;AACD;;AACD,aAAO,KAAP;AACD,KAPD;;AAQA4vJ,IAAAA,SAAS,CAAC9zJ,SAAV,CAAoBu0J,oBAApB,GAA2C,UAAUD,OAAV,EAAmB;AAC5D,UAAI1uJ,IAAI,GAAG,IAAX;AACA,UAAIuwH,GAAG,GAAGm+B,OAAV;;AACA,UAAI,OAAOn+B,GAAP,KAAe,QAAnB,EAA6B;AAC3B,eAAO,YAAY;AACjBvwH,UAAAA,IAAI,CAACytB,MAAL,CAAY6iD,WAAZ,CAAwBigD,GAAxB,EAA6B,KAA7B,EAAoC,IAApC;AACD,SAFD;AAGD,OAJD,MAIO,IAAIp/G,KAAK,CAACrQ,OAAN,CAAcyvH,GAAd,CAAJ,EAAwB;AAC7B,eAAO,YAAY;AACjBvwH,UAAAA,IAAI,CAACytB,MAAL,CAAY6iD,WAAZ,CAAwBigD,GAAG,CAAC,CAAD,CAA3B,EAAgCA,GAAG,CAAC,CAAD,CAAnC,EAAwCA,GAAG,CAAC,CAAD,CAA3C;AACD,SAFD;AAGD,OAJM,MAIA;AACL,eAAOA,GAAP;AACD;AACF,KAdD;;AAeA29B,IAAAA,SAAS,CAAC9zJ,SAAV,CAAoBw0J,cAApB,GAAqC,UAAU5vH,OAAV,EAAmByvH,IAAnB,EAAyBC,OAAzB,EAAkCj9I,KAAlC,EAAyC;AAC5E,UAAIoqI,SAAS,GAAG1qI,KAAK,CAAC/R,GAAN,CAAUwtJ,SAAS,CAAC5tH,OAAD,EAAU,GAAV,CAAnB,EAAmC2uH,aAAnC,CAAhB;AACA9R,MAAAA,SAAS,CAACA,SAAS,CAACpgJ,MAAV,GAAmB,CAApB,CAAT,GAAkC0V,KAAK,CAACZ,MAAN,CAAasrI,SAAS,CAACA,SAAS,CAACpgJ,MAAV,GAAmB,CAApB,CAAtB,EAA8C;AAC9E6xB,QAAAA,IAAI,EAAEohI,OADwE;AAE9Ej9I,QAAAA,KAAK,EAAEA,KAAK,IAAI,KAAKgc;AAFyD,OAA9C,CAAlC;AAIA,aAAOtc,KAAK,CAACZ,MAAN,CAAasrI,SAAS,CAAC,CAAD,CAAtB,EAA2B;AAChC4S,QAAAA,IAAI,EAAE,KAAKhhI,MAAL,CAAY3T,SAAZ,CAAsB20I,IAAtB,CAD0B;AAEhCF,QAAAA,WAAW,EAAE1S,SAAS,CAAC9gJ,KAAV,CAAgB,CAAhB;AAFmB,OAA3B,CAAP;AAID,KAVD;;AAWAmzJ,IAAAA,SAAS,CAAC9zJ,SAAV,CAAoBg0J,WAApB,GAAkC,UAAU9nJ,CAAV,EAAa;AAC7C,aAAOA,CAAC,CAACulE,MAAF,IAAYvlE,CAAC,CAACslE,OAAd,IAAyBtlE,CAAC,CAAC4gC,OAAlC;AACD,KAFD;;AAGAgnH,IAAAA,SAAS,CAAC9zJ,SAAV,CAAoBi0J,aAApB,GAAoC,UAAU/nJ,CAAV,EAAa;AAC/C,aAAOA,CAAC,CAAC7F,IAAF,KAAW,SAAX,IAAwB6F,CAAC,CAACozF,OAAF,IAAa,GAArC,IAA4CpzF,CAAC,CAACozF,OAAF,IAAa,GAAhE;AACD,KAFD;;AAGAw0D,IAAAA,SAAS,CAAC9zJ,SAAV,CAAoBk0J,aAApB,GAAoC,UAAUhoJ,CAAV,EAAasnJ,QAAb,EAAuB;AACzD,UAAI,CAACA,QAAL,EAAe;AACb,eAAO,KAAP;AACD;;AACD,UAAIA,QAAQ,CAACI,IAAT,KAAkB1nJ,CAAC,CAACslE,OAApB,IAA+BgiF,QAAQ,CAACK,IAAT,KAAkB3nJ,CAAC,CAAC4gC,OAAvD,EAAgE;AAC9D,eAAO,KAAP;AACD;;AACD,UAAI0mH,QAAQ,CAACG,GAAT,KAAiBznJ,CAAC,CAACulE,MAAnB,IAA6B+hF,QAAQ,CAAC7/G,KAAT,KAAmBznC,CAAC,CAACqlE,QAAtD,EAAgE;AAC9D,eAAO,KAAP;AACD;;AACD,UAAIrlE,CAAC,CAACozF,OAAF,KAAck0D,QAAQ,CAACl0D,OAAvB,IAAkCpzF,CAAC,CAACunJ,QAAF,IAAcvnJ,CAAC,CAACunJ,QAAF,KAAeD,QAAQ,CAACC,QAA5E,EAAsF;AACpFvnJ,QAAAA,CAAC,CAACqgC,cAAF;AACA,eAAO,IAAP;AACD;;AACD,aAAO,KAAP;AACD,KAfD;;AAgBAunH,IAAAA,SAAS,CAAC9zJ,SAAV,CAAoBo0J,qBAApB,GAA4C,UAAUZ,QAAV,EAAoB;AAC9D,aAAOA,QAAQ,CAACtgI,IAAT,GAAgBsgI,QAAQ,CAACtgI,IAAT,CAActyB,IAAd,CAAmB4yJ,QAAQ,CAACn8I,KAA5B,CAAhB,GAAqD,IAA5D;AACD,KAFD;;AAGA,WAAOy8I,SAAP;AACD,GAjGe,EAAhB;;AAmGA,MAAIW,QAAQ,GAAG,YAAY;AACzB,QAAIC,OAAO,GAAG,EAAd;AACA,QAAIC,SAAS,GAAG,EAAhB;AACA,QAAIC,MAAM,GAAG,EAAb;AACA,QAAI3tC,KAAK,GAAG,EAAZ;AACA,QAAI4tC,YAAY,GAAG,EAAnB;AACA,QAAIC,eAAe,GAAG,EAAtB;AACA,QAAIC,QAAQ,GAAG,EAAf;;AACA,QAAIr0H,GAAG,GAAG,UAAUn1B,UAAV,EAAsBlF,IAAtB,EAA4B;AACpC,aAAO,UAAUlG,IAAV,EAAgB8oH,IAAhB,EAAsB;AAC3B,eAAO19G,UAAU,CAACpL,IAAI,CAACuO,WAAL,EAAD,CAAV,GAAiC5C,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKm9G,IAAL,CAAT,EAAqB;AAAE5iH,UAAAA,IAAI,EAAEA;AAAR,SAArB,CAAhD;AACD,OAFD;AAGD,KAJD;;AAKA,QAAIoiJ,OAAO,GAAG,UAAUtoJ,IAAV,EAAgBooJ,OAAhB,EAAyB;AACrC,aAAOthC,KAAK,CAAC9mH,IAAI,CAACuO,WAAL,EAAD,CAAL,GAA4B65I,OAAnC;AACD,KAFD;;AAGA,WAAO;AACLyM,MAAAA,SAAS,EAAEt0H,GAAG,CAACg0H,OAAD,EAAU,QAAV,CADT;AAELO,MAAAA,qBAAqB,EAAEv0H,GAAG,CAACg0H,OAAD,EAAU,oBAAV,CAFrB;AAGLQ,MAAAA,eAAe,EAAEx0H,GAAG,CAACg0H,OAAD,EAAU,cAAV,CAHf;AAILS,MAAAA,aAAa,EAAEz0H,GAAG,CAACg0H,OAAD,EAAU,YAAV,CAJb;AAKLU,MAAAA,cAAc,EAAE10H,GAAG,CAACg0H,OAAD,EAAU,aAAV,CALd;AAMLW,MAAAA,WAAW,EAAE30H,GAAG,CAACi0H,SAAD,EAAY,UAAZ,CANX;AAOLW,MAAAA,iBAAiB,EAAE50H,GAAG,CAACi0H,SAAD,EAAY,gBAAZ,CAPjB;AAQLY,MAAAA,iBAAiB,EAAE70H,GAAG,CAACi0H,SAAD,EAAY,gBAAZ,CARjB;AASLa,MAAAA,gBAAgB,EAAE90H,GAAG,CAACk0H,MAAD,EAAS,eAAT,CAThB;AAULa,MAAAA,cAAc,EAAE/0H,GAAG,CAACm0H,YAAD,EAAe,aAAf,CAVd;AAWLa,MAAAA,iBAAiB,EAAEh1H,GAAG,CAACo0H,eAAD,EAAkB,gBAAlB,CAXjB;AAYLa,MAAAA,cAAc,EAAEj1H,GAAG,CAACo0H,eAAD,EAAkB,aAAlB,CAZd;AAaLc,MAAAA,UAAU,EAAEl1H,GAAG,CAACq0H,QAAD,EAAW,SAAX,CAbV;AAcLtM,MAAAA,OAAO,EAAEA,OAdJ;AAeLj5E,MAAAA,MAAM,EAAE,YAAY;AAClB,eAAO;AACLklF,UAAAA,OAAO,EAAEA,OADJ;AAELC,UAAAA,SAAS,EAAEA,SAFN;AAGL1tC,UAAAA,KAAK,EAAEA,KAHF;AAIL2tC,UAAAA,MAAM,EAAEA,MAJH;AAKLC,UAAAA,YAAY,EAAEA,YALT;AAMLC,UAAAA,eAAe,EAAEA,eANZ;AAOLC,UAAAA,QAAQ,EAAEA;AAPL,SAAP;AASD;AAzBI,KAAP;AA2BD,GA3CD;;AA6CA,MAAI5lG,QAAQ,GAAG,YAAY;AACzB,QAAI0mG,MAAM,GAAGpB,QAAQ,EAArB;AACA,WAAO;AACLe,MAAAA,gBAAgB,EAAEK,MAAM,CAACL,gBADpB;AAELR,MAAAA,SAAS,EAAEa,MAAM,CAACb,SAFb;AAGLW,MAAAA,cAAc,EAAEE,MAAM,CAACF,cAHlB;AAILF,MAAAA,cAAc,EAAEI,MAAM,CAACJ,cAJlB;AAKLC,MAAAA,iBAAiB,EAAEG,MAAM,CAACH,iBALrB;AAMLjN,MAAAA,OAAO,EAAEoN,MAAM,CAACpN,OANX;AAOL0M,MAAAA,aAAa,EAAEU,MAAM,CAACV,aAPjB;AAQLE,MAAAA,WAAW,EAAEQ,MAAM,CAACR,WARf;AASLC,MAAAA,iBAAiB,EAAEO,MAAM,CAACP,iBATrB;AAULM,MAAAA,UAAU,EAAEC,MAAM,CAACD,UAVd;AAWLR,MAAAA,cAAc,EAAES,MAAM,CAACT,cAXlB;AAYLF,MAAAA,eAAe,EAAEW,MAAM,CAACX,eAZnB;AAaLD,MAAAA,qBAAqB,EAAEY,MAAM,CAACZ,qBAbzB;AAcLM,MAAAA,iBAAiB,EAAEM,MAAM,CAACN,iBAdrB;AAeL/lF,MAAAA,MAAM,EAAEqmF,MAAM,CAACrmF;AAfV,KAAP;AAiBD,GAnBD;;AAqBA,MAAIsmF,MAAM,GAAG/+I,KAAK,CAAC9R,IAAnB;AAAA,MAAyB8wJ,MAAM,GAAGh/I,KAAK,CAAC3G,IAAxC;AACA,MAAI4lJ,UAAU,GAAG,uGAAuG5gJ,KAAvG,CAA6G,GAA7G,CAAjB;AACA,MAAI6gJ,aAAa,GAAG;AAClBC,IAAAA,GAAG,EAAE,EADa;AAElBC,IAAAA,IAAI,EAAE,EAFY;AAGlBC,IAAAA,KAAK,EAAE,GAHW;AAIlBC,IAAAA,MAAM,EAAE;AAJU,GAApB;;AAMA,MAAIC,GAAG,GAAG,YAAY;AACpB,aAASA,GAAT,CAAax/I,GAAb,EAAkB6c,QAAlB,EAA4B;AAC1B7c,MAAAA,GAAG,GAAGi/I,MAAM,CAACj/I,GAAD,CAAZ;AACA,WAAK6c,QAAL,GAAgBA,QAAQ,IAAI,EAA5B;AACA,UAAI4iI,OAAO,GAAG,KAAK5iI,QAAL,CAAc6iI,QAA5B;AACA,UAAI5wJ,IAAI,GAAG,IAAX;;AACA,UAAI,yBAAyBsH,IAAzB,CAA8B4J,GAA9B,KAAsC,QAAQ5J,IAAR,CAAa4J,GAAb,CAA1C,EAA6D;AAC3DlR,QAAAA,IAAI,CAAC6wJ,MAAL,GAAc3/I,GAAd;AACA;AACD;;AACD,UAAI4/I,kBAAkB,GAAG5/I,GAAG,CAACxW,OAAJ,CAAY,IAAZ,MAAsB,CAA/C;;AACA,UAAIwW,GAAG,CAACxW,OAAJ,CAAY,GAAZ,MAAqB,CAArB,IAA0B,CAACo2J,kBAA/B,EAAmD;AACjD5/I,QAAAA,GAAG,GAAG,CAACy/I,OAAO,GAAGA,OAAO,CAACI,QAAR,IAAoB,MAAvB,GAAgC,MAAxC,IAAkD,aAAlD,GAAkE7/I,GAAxE;AACD;;AACD,UAAI,CAAC,iBAAiB5J,IAAjB,CAAsB4J,GAAtB,CAAL,EAAiC;AAC/B,YAAIm0C,OAAO,GAAG,KAAKt3B,QAAL,CAAc6iI,QAAd,GAAyB,KAAK7iI,QAAL,CAAc6iI,QAAd,CAAuB9/F,IAAhD,GAAuD,IAAI4/F,GAAJ,CAAQ9hJ,QAAQ,CAACkjC,QAAT,CAAkBI,IAA1B,EAAgCoW,SAArG;;AACA,YAAI,KAAKv6B,QAAL,CAAc6iI,QAAd,IAA0B,KAAK7iI,QAAL,CAAc6iI,QAAd,CAAuBG,QAAvB,IAAmC,EAAjE,EAAqE;AACnE7/I,UAAAA,GAAG,GAAG,eAAelR,IAAI,CAACgxJ,SAAL,CAAe3rG,OAAf,EAAwBn0C,GAAxB,CAArB;AACD,SAFD,MAEO;AACL,cAAIf,KAAK,GAAG,oBAAoBF,IAApB,CAAyBiB,GAAzB,CAAZ;AACAA,UAAAA,GAAG,GAAG,CAACy/I,OAAO,IAAIA,OAAO,CAACI,QAAnB,IAA+B,MAAhC,IAA0C,aAA1C,GAA0D/wJ,IAAI,CAACgxJ,SAAL,CAAe3rG,OAAf,EAAwBl1C,KAAK,CAAC,CAAD,CAA7B,CAA1D,GAA8FA,KAAK,CAAC,CAAD,CAAzG;AACD;AACF;;AACDe,MAAAA,GAAG,GAAGA,GAAG,CAACzI,OAAJ,CAAY,KAAZ,EAAmB,UAAnB,CAAN;AACA,UAAIwoJ,QAAQ,GAAG,uNAAuNhhJ,IAAvN,CAA4NiB,GAA5N,CAAf;AACAg/I,MAAAA,MAAM,CAACE,UAAD,EAAa,UAAUlwJ,CAAV,EAAavE,CAAb,EAAgB;AACjC,YAAIu1J,IAAI,GAAGD,QAAQ,CAACt1J,CAAD,CAAnB;;AACA,YAAIu1J,IAAJ,EAAU;AACRA,UAAAA,IAAI,GAAGA,IAAI,CAACzoJ,OAAL,CAAa,aAAb,EAA4B,IAA5B,CAAP;AACD;;AACDzI,QAAAA,IAAI,CAACE,CAAD,CAAJ,GAAUgxJ,IAAV;AACD,OANK,CAAN;;AAOA,UAAIP,OAAJ,EAAa;AACX,YAAI,CAAC3wJ,IAAI,CAAC+wJ,QAAV,EAAoB;AAClB/wJ,UAAAA,IAAI,CAAC+wJ,QAAL,GAAgBJ,OAAO,CAACI,QAAxB;AACD;;AACD,YAAI,CAAC/wJ,IAAI,CAACmxJ,QAAV,EAAoB;AAClBnxJ,UAAAA,IAAI,CAACmxJ,QAAL,GAAgBR,OAAO,CAACQ,QAAxB;AACD;;AACD,YAAI,CAACnxJ,IAAI,CAACoxJ,IAAN,IAAcpxJ,IAAI,CAACqX,IAAL,KAAc,UAAhC,EAA4C;AAC1CrX,UAAAA,IAAI,CAACoxJ,IAAL,GAAYT,OAAO,CAACS,IAApB;AACD;;AACD,YAAI,CAACpxJ,IAAI,CAACqX,IAAN,IAAcrX,IAAI,CAACqX,IAAL,KAAc,UAAhC,EAA4C;AAC1CrX,UAAAA,IAAI,CAACqX,IAAL,GAAYs5I,OAAO,CAACt5I,IAApB;AACD;;AACDrX,QAAAA,IAAI,CAAC6wJ,MAAL,GAAc,EAAd;AACD;;AACD,UAAIC,kBAAJ,EAAwB;AACtB9wJ,QAAAA,IAAI,CAAC+wJ,QAAL,GAAgB,EAAhB;AACD;AACF;;AACDL,IAAAA,GAAG,CAACnyE,YAAJ,GAAmB,UAAUJ,GAAV,EAAe;AAChC,UAAI19E,IAAJ;AACA,UAAI4wJ,aAAa,GAAG7yE,kBAAkB,CAACL,GAAD,CAAlB,CAAwB3uE,KAAxB,CAA8B,GAA9B,CAApB;AACA,UAAIhC,OAAO,GAAG,eAAeyC,IAAf,CAAoBohJ,aAAa,CAAC,CAAD,CAAjC,CAAd;;AACA,UAAI7jJ,OAAJ,EAAa;AACX/M,QAAAA,IAAI,GAAG+M,OAAO,CAAC,CAAD,CAAd;AACD;;AACD,aAAO;AACL/M,QAAAA,IAAI,EAAEA,IADD;AAELwnB,QAAAA,IAAI,EAAEopI,aAAa,CAAC,CAAD;AAFd,OAAP;AAID,KAXD;;AAYAX,IAAAA,GAAG,CAACl9F,kBAAJ,GAAyB,UAAUihB,GAAV,EAAe;AACtC,UAAIpvB,OAAJ;;AACA,UAAIovB,GAAG,CAACs8E,QAAJ,CAAar2J,OAAb,CAAqB,MAArB,MAAiC,CAAjC,IAAsC+5E,GAAG,CAACs8E,QAAJ,KAAiB,OAA3D,EAAoE;AAClE1rG,QAAAA,OAAO,GAAGovB,GAAG,CAACviC,IAAd;AACD,OAFD,MAEO;AACLmT,QAAAA,OAAO,GAAGovB,GAAG,CAACs8E,QAAJ,GAAe,IAAf,GAAsBt8E,GAAG,CAACp9D,IAA1B,GAAiCo9D,GAAG,CAAC68E,QAA/C;AACD;;AACD,UAAI,yBAAyBhqJ,IAAzB,CAA8B+9C,OAA9B,CAAJ,EAA4C;AAC1CA,QAAAA,OAAO,GAAGA,OAAO,CAAC58C,OAAR,CAAgB,UAAhB,EAA4B,EAA5B,EAAgCA,OAAhC,CAAwC,eAAxC,EAAyD,EAAzD,CAAV;;AACA,YAAI,CAAC,UAAUnB,IAAV,CAAe+9C,OAAf,CAAL,EAA8B;AAC5BA,UAAAA,OAAO,IAAI,GAAX;AACD;AACF;;AACD,aAAOA,OAAP;AACD,KAdD;;AAeAqrG,IAAAA,GAAG,CAACt2J,SAAJ,CAAcm3J,OAAd,GAAwB,UAAUzgG,IAAV,EAAgB;AACtC,UAAI0gG,SAAS,GAAG,mBAAmBvhJ,IAAnB,CAAwB6gD,IAAxB,CAAhB;AACA,WAAKA,IAAL,GAAY0gG,SAAS,CAAC,CAAD,CAArB;AACA,WAAKlpG,SAAL,GAAiBkpG,SAAS,CAAC,CAAD,CAA1B;AACA,WAAKC,IAAL,GAAYD,SAAS,CAAC,CAAD,CAArB;AACA,WAAKX,MAAL,GAAc,EAAd;AACA,WAAKvP,MAAL;AACD,KAPD;;AAQAoP,IAAAA,GAAG,CAACt2J,SAAJ,CAAcs3J,UAAd,GAA2B,UAAUvzE,GAAV,EAAe;AACxC,UAAIj9B,MAAJ;;AACA,UAAIi9B,GAAG,KAAK,IAAZ,EAAkB;AAChB,eAAOA,GAAP;AACD;;AACD,UAAIwzE,WAAW,GAAG,IAAIjB,GAAJ,CAAQvyE,GAAR,EAAa;AAAEyyE,QAAAA,QAAQ,EAAE;AAAZ,OAAb,CAAlB;;AACA,UAAIe,WAAW,CAACt6I,IAAZ,KAAqB,UAArB,IAAmC,KAAKA,IAAL,KAAcs6I,WAAW,CAACt6I,IAA7D,IAAqEs6I,WAAW,CAACt6I,IAAjF,IAAyF,KAAK+5I,IAAL,KAAcO,WAAW,CAACP,IAAnH,IAA2H,KAAKL,QAAL,KAAkBY,WAAW,CAACZ,QAA9B,IAA0CY,WAAW,CAACZ,QAAZ,KAAyB,EAAlM,EAAsM;AACpM,eAAOY,WAAW,CAACrQ,MAAZ,EAAP;AACD;;AACD,UAAIsQ,EAAE,GAAG,KAAKtQ,MAAL,EAAT;AAAA,UAAwBuQ,EAAE,GAAGF,WAAW,CAACrQ,MAAZ,EAA7B;;AACA,UAAIsQ,EAAE,KAAKC,EAAP,IAAaD,EAAE,CAACx9H,MAAH,CAAUw9H,EAAE,CAACn2J,MAAH,GAAY,CAAtB,MAA6B,GAA7B,IAAoCm2J,EAAE,CAAC3nJ,MAAH,CAAU,CAAV,EAAa2nJ,EAAE,CAACn2J,MAAH,GAAY,CAAzB,MAAgCo2J,EAArF,EAAyF;AACvF,eAAOD,EAAP;AACD;;AACD1wG,MAAAA,MAAM,GAAG,KAAK4wG,SAAL,CAAe,KAAKhhG,IAApB,EAA0B6gG,WAAW,CAAC7gG,IAAtC,CAAT;;AACA,UAAI6gG,WAAW,CAACtkJ,KAAhB,EAAuB;AACrB6zC,QAAAA,MAAM,IAAI,MAAMywG,WAAW,CAACtkJ,KAA5B;AACD;;AACD,UAAIskJ,WAAW,CAACjJ,MAAhB,EAAwB;AACtBxnG,QAAAA,MAAM,IAAI,MAAMywG,WAAW,CAACjJ,MAA5B;AACD;;AACD,aAAOxnG,MAAP;AACD,KArBD;;AAsBAwvG,IAAAA,GAAG,CAACt2J,SAAJ,CAAc8rH,UAAd,GAA2B,UAAU/nC,GAAV,EAAe4zE,MAAf,EAAuB;AAChD,UAAIC,WAAW,GAAG,IAAItB,GAAJ,CAAQvyE,GAAR,EAAa;AAAEyyE,QAAAA,QAAQ,EAAE;AAAZ,OAAb,CAAlB;AACA,aAAOoB,WAAW,CAAC1Q,MAAZ,CAAmByQ,MAAM,IAAI,KAAKE,YAAL,CAAkBD,WAAlB,CAA7B,CAAP;AACD,KAHD;;AAIAtB,IAAAA,GAAG,CAACt2J,SAAJ,CAAc63J,YAAd,GAA6B,UAAU9zE,GAAV,EAAe;AAC1C,UAAI,KAAK9mE,IAAL,IAAa8mE,GAAG,CAAC9mE,IAAjB,IAAyB,KAAK05I,QAAL,IAAiB5yE,GAAG,CAAC4yE,QAAlD,EAA4D;AAC1D,YAAI,KAAKK,IAAL,IAAajzE,GAAG,CAACizE,IAArB,EAA2B;AACzB,iBAAO,IAAP;AACD;;AACD,YAAIc,WAAW,GAAG7B,aAAa,CAAC,KAAKU,QAAN,CAA/B;;AACA,YAAImB,WAAW,IAAI,CAAC,KAAKd,IAAL,IAAac,WAAd,MAA+B/zE,GAAG,CAACizE,IAAJ,IAAYc,WAA3C,CAAnB,EAA4E;AAC1E,iBAAO,IAAP;AACD;AACF;;AACD,aAAO,KAAP;AACD,KAXD;;AAYAxB,IAAAA,GAAG,CAACt2J,SAAJ,CAAc03J,SAAd,GAA0B,UAAU19I,IAAV,EAAgB08C,IAAhB,EAAsB;AAC9C,UAAIqhG,UAAU,GAAG,CAAjB;AAAA,UAAoB9sJ,GAAG,GAAG,EAA1B;AAAA,UAA8B1J,CAA9B;AAAA,UAAiCqJ,CAAjC;AACA,UAAIotJ,cAAc,GAAGh+I,IAAI,CAACrK,SAAL,CAAe,CAAf,EAAkBqK,IAAI,CAAC6xC,WAAL,CAAiB,GAAjB,CAAlB,EAAyCz2C,KAAzC,CAA+C,GAA/C,CAArB;AACA,UAAIF,KAAK,GAAGwhD,IAAI,CAACthD,KAAL,CAAW,GAAX,CAAZ;;AACA,UAAI4iJ,cAAc,CAAC32J,MAAf,IAAyB6T,KAAK,CAAC7T,MAAnC,EAA2C;AACzC,aAAKE,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAGotJ,cAAc,CAAC32J,MAA/B,EAAuCE,CAAC,GAAGqJ,CAA3C,EAA8CrJ,CAAC,EAA/C,EAAmD;AACjD,cAAIA,CAAC,IAAI2T,KAAK,CAAC7T,MAAX,IAAqB22J,cAAc,CAACz2J,CAAD,CAAd,KAAsB2T,KAAK,CAAC3T,CAAD,CAApD,EAAyD;AACvDw2J,YAAAA,UAAU,GAAGx2J,CAAC,GAAG,CAAjB;AACA;AACD;AACF;AACF;;AACD,UAAIy2J,cAAc,CAAC32J,MAAf,GAAwB6T,KAAK,CAAC7T,MAAlC,EAA0C;AACxC,aAAKE,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAGsK,KAAK,CAAC7T,MAAtB,EAA8BE,CAAC,GAAGqJ,CAAlC,EAAqCrJ,CAAC,EAAtC,EAA0C;AACxC,cAAIA,CAAC,IAAIy2J,cAAc,CAAC32J,MAApB,IAA8B22J,cAAc,CAACz2J,CAAD,CAAd,KAAsB2T,KAAK,CAAC3T,CAAD,CAA7D,EAAkE;AAChEw2J,YAAAA,UAAU,GAAGx2J,CAAC,GAAG,CAAjB;AACA;AACD;AACF;AACF;;AACD,UAAIw2J,UAAU,KAAK,CAAnB,EAAsB;AACpB,eAAOrhG,IAAP;AACD;;AACD,WAAKn1D,CAAC,GAAG,CAAJ,EAAOqJ,CAAC,GAAGotJ,cAAc,CAAC32J,MAAf,IAAyB02J,UAAU,GAAG,CAAtC,CAAhB,EAA0Dx2J,CAAC,GAAGqJ,CAA9D,EAAiErJ,CAAC,EAAlE,EAAsE;AACpE0J,QAAAA,GAAG,IAAI,KAAP;AACD;;AACD,WAAK1J,CAAC,GAAGw2J,UAAU,GAAG,CAAjB,EAAoBntJ,CAAC,GAAGsK,KAAK,CAAC7T,MAAnC,EAA2CE,CAAC,GAAGqJ,CAA/C,EAAkDrJ,CAAC,EAAnD,EAAuD;AACrD,YAAIA,CAAC,KAAKw2J,UAAU,GAAG,CAAvB,EAA0B;AACxB9sJ,UAAAA,GAAG,IAAI,MAAMiK,KAAK,CAAC3T,CAAD,CAAlB;AACD,SAFD,MAEO;AACL0J,UAAAA,GAAG,IAAIiK,KAAK,CAAC3T,CAAD,CAAZ;AACD;AACF;;AACD,aAAO0J,GAAP;AACD,KAlCD;;AAmCAqrJ,IAAAA,GAAG,CAACt2J,SAAJ,CAAc42J,SAAd,GAA0B,UAAU58I,IAAV,EAAgB08C,IAAhB,EAAsB;AAC9C,UAAIn1D,CAAJ;AAAA,UAAO02J,EAAE,GAAG,CAAZ;AAAA,UAAel0J,CAAC,GAAG,EAAnB;AAAA,UAAuBm0J,OAAvB;AACA,UAAI9xH,EAAE,GAAG,MAAMl5B,IAAN,CAAWwpD,IAAX,IAAmB,GAAnB,GAAyB,EAAlC;AACA,UAAIshG,cAAc,GAAGh+I,IAAI,CAAC5E,KAAL,CAAW,GAAX,CAArB;AACA,UAAI+iJ,cAAc,GAAGzhG,IAAI,CAACthD,KAAL,CAAW,GAAX,CAArB;AACA0gJ,MAAAA,MAAM,CAACkC,cAAD,EAAiB,UAAUvuJ,CAAV,EAAa;AAClC,YAAIA,CAAJ,EAAO;AACL1F,UAAAA,CAAC,CAACsD,IAAF,CAAOoC,CAAP;AACD;AACF,OAJK,CAAN;AAKAuuJ,MAAAA,cAAc,GAAGj0J,CAAjB;;AACA,WAAKxC,CAAC,GAAG42J,cAAc,CAAC92J,MAAf,GAAwB,CAA5B,EAA+B0C,CAAC,GAAG,EAAxC,EAA4CxC,CAAC,IAAI,CAAjD,EAAoDA,CAAC,EAArD,EAAyD;AACvD,YAAI42J,cAAc,CAAC52J,CAAD,CAAd,CAAkBF,MAAlB,KAA6B,CAA7B,IAAkC82J,cAAc,CAAC52J,CAAD,CAAd,KAAsB,GAA5D,EAAiE;AAC/D;AACD;;AACD,YAAI42J,cAAc,CAAC52J,CAAD,CAAd,KAAsB,IAA1B,EAAgC;AAC9B02J,UAAAA,EAAE;AACF;AACD;;AACD,YAAIA,EAAE,GAAG,CAAT,EAAY;AACVA,UAAAA,EAAE;AACF;AACD;;AACDl0J,QAAAA,CAAC,CAACsD,IAAF,CAAO8wJ,cAAc,CAAC52J,CAAD,CAArB;AACD;;AACDA,MAAAA,CAAC,GAAGy2J,cAAc,CAAC32J,MAAf,GAAwB42J,EAA5B;;AACA,UAAI12J,CAAC,IAAI,CAAT,EAAY;AACV22J,QAAAA,OAAO,GAAG1vJ,OAAO,CAACzE,CAAD,CAAP,CAAW6sB,IAAX,CAAgB,GAAhB,CAAV;AACD,OAFD,MAEO;AACLsnI,QAAAA,OAAO,GAAGF,cAAc,CAACr3J,KAAf,CAAqB,CAArB,EAAwBY,CAAxB,EAA2BqvB,IAA3B,CAAgC,GAAhC,IAAuC,GAAvC,GAA6CpoB,OAAO,CAACzE,CAAD,CAAP,CAAW6sB,IAAX,CAAgB,GAAhB,CAAvD;AACD;;AACD,UAAIsnI,OAAO,CAAC53J,OAAR,CAAgB,GAAhB,MAAyB,CAA7B,EAAgC;AAC9B43J,QAAAA,OAAO,GAAG,MAAMA,OAAhB;AACD;;AACD,UAAI9xH,EAAE,IAAI8xH,OAAO,CAACrsG,WAAR,CAAoB,GAApB,MAA6BqsG,OAAO,CAAC72J,MAAR,GAAiB,CAAxD,EAA2D;AACzD62J,QAAAA,OAAO,IAAI9xH,EAAX;AACD;;AACD,aAAO8xH,OAAP;AACD,KAtCD;;AAuCA5B,IAAAA,GAAG,CAACt2J,SAAJ,CAAcknJ,MAAd,GAAuB,UAAUkR,WAAV,EAAuB;AAC5C,UAAIA,WAAW,KAAK,KAAK,CAAzB,EAA4B;AAC1BA,QAAAA,WAAW,GAAG,KAAd;AACD;;AACD,UAAIvyJ,CAAJ;;AACA,UAAI,CAAC,KAAK4wJ,MAAN,IAAgB2B,WAApB,EAAiC;AAC/BvyJ,QAAAA,CAAC,GAAG,EAAJ;;AACA,YAAI,CAACuyJ,WAAL,EAAkB;AAChB,cAAI,KAAKzB,QAAT,EAAmB;AACjB9wJ,YAAAA,CAAC,IAAI,KAAK8wJ,QAAL,GAAgB,KAArB;AACD,WAFD,MAEO;AACL9wJ,YAAAA,CAAC,IAAI,IAAL;AACD;;AACD,cAAI,KAAKkxJ,QAAT,EAAmB;AACjBlxJ,YAAAA,CAAC,IAAI,KAAKkxJ,QAAL,GAAgB,GAArB;AACD;;AACD,cAAI,KAAK95I,IAAT,EAAe;AACbpX,YAAAA,CAAC,IAAI,KAAKoX,IAAV;AACD;;AACD,cAAI,KAAK+5I,IAAT,EAAe;AACbnxJ,YAAAA,CAAC,IAAI,MAAM,KAAKmxJ,IAAhB;AACD;AACF;;AACD,YAAI,KAAKtgG,IAAT,EAAe;AACb7wD,UAAAA,CAAC,IAAI,KAAK6wD,IAAV;AACD;;AACD,YAAI,KAAKzjD,KAAT,EAAgB;AACdpN,UAAAA,CAAC,IAAI,MAAM,KAAKoN,KAAhB;AACD;;AACD,YAAI,KAAKq7I,MAAT,EAAiB;AACfzoJ,UAAAA,CAAC,IAAI,MAAM,KAAKyoJ,MAAhB;AACD;;AACD,aAAKmI,MAAL,GAAc5wJ,CAAd;AACD;;AACD,aAAO,KAAK4wJ,MAAZ;AACD,KAnCD;;AAoCA,WAAOH,GAAP;AACD,GA3OS,EAAV;;AA6OA,MAAI+B,KAAK,GAAGj3G,QAAQ,CAAC2D,GAArB;AACA,MAAIuzG,QAAQ,GAAGvhJ,KAAK,CAACZ,MAArB;AAAA,MAA6BoiJ,MAAM,GAAGxhJ,KAAK,CAAC9R,IAA5C;AACA,MAAIuzJ,SAAS,GAAGzhJ,KAAK,CAACX,OAAtB;AACA,MAAIqiJ,IAAI,GAAG3kJ,GAAG,CAAChD,EAAf;;AACA,MAAI4nJ,MAAM,GAAG,YAAY;AACvB,aAASA,MAAT,CAAgBx0J,EAAhB,EAAoByvB,QAApB,EAA8B6sD,aAA9B,EAA6C;AAC3C,UAAIv4C,KAAK,GAAG,IAAZ;;AACA,WAAKgqE,OAAL,GAAe,EAAf;AACA,WAAK+Z,UAAL,GAAkB,EAAlB;AACA,WAAK62B,aAAL,GAAqB,EAArB;AACA,WAAK8V,SAAL,GAAiB,EAAjB;AACA,WAAKC,UAAL,GAAkB,KAAlB;AACA,WAAKp4E,aAAL,GAAqBA,aAArB;AACA,WAAK0jC,eAAL,GAAuB1jC,aAAa,CAACq4E,eAArC;AACAP,MAAAA,QAAQ,CAAC,IAAD,EAAO9G,gBAAP,CAAR;AACA,WAAK79H,QAAL,GAAgBgzF,iBAAiB,CAAC,IAAD,EAAOziH,EAAP,EAAW,KAAKggH,eAAhB,EAAiC1jC,aAAa,CAAC+lC,eAA/C,EAAgE5yF,QAAhE,CAAjC;;AACA,UAAI,KAAKA,QAAL,CAAcsV,MAAlB,EAA0B;AACxBu3C,QAAAA,aAAa,CAACv3C,MAAd,GAAuB,KAAKtV,QAAL,CAAcsV,MAArC;AACD;;AACD,WAAKA,MAAL,GAAcu3C,aAAa,CAACv3C,MAA5B;;AACA,UAAI,KAAKtV,QAAL,CAAcmlI,QAAlB,EAA4B;AAC1Bt4E,QAAAA,aAAa,CAACu4E,WAAd,CAA0B,KAAKplI,QAAL,CAAcmlI,QAAxC;AACD;;AACD,WAAKvC,OAAL,GAAe/1E,aAAa,CAACw4E,OAA7B;;AACA,UAAI,KAAKrlI,QAAL,CAAcslI,eAAlB,EAAmC;AACjCrxG,QAAAA,YAAY,CAACA,YAAb,CAA0B5zB,kBAA1B,CAA6C,KAAKL,QAAL,CAAcslI,eAA3D;;AACA73G,QAAAA,QAAQ,CAAC2D,GAAT,CAAarD,gBAAb,CAA8B1tB,kBAA9B,CAAiD,KAAKL,QAAL,CAAcslI,eAA/D;AACD;;AACD/uG,MAAAA,YAAY,CAACQ,YAAb,GAA4B,KAAK/2B,QAAL,CAAculI,aAA1C;AACAhvG,MAAAA,YAAY,CAAC0B,OAAb,GAAuB40B,aAAa,CAAC50B,OAArC;AACA,WAAK1nD,EAAL,GAAUA,EAAV;AACA,WAAK4rG,QAAL,CAAc,KAAd;AACA,WAAK+b,eAAL,GAAuB,IAAIyqC,GAAJ,CAAQ,KAAK3iI,QAAL,CAAc0wF,iBAAtB,EAAyC;AAAEmyC,QAAAA,QAAQ,EAAE,KAAKD;AAAjB,OAAzC,CAAvB;AACA,WAAKyC,OAAL,GAAe,KAAKzC,OAApB;AACA,WAAKnxH,MAAL,GAAc,CAAC,CAAC,KAAKzR,QAAL,CAAcyR,MAA9B;AACA,WAAKq8G,SAAL,GAAiB,IAAIqS,SAAJ,CAAc,IAAd,CAAjB;AACA,WAAKqF,cAAL,GAAsB,IAAI9L,cAAJ,CAAmB,IAAnB,CAAtB;;AACA,UAAI,KAAK15H,QAAL,CAAcylI,YAAlB,EAAgC;AAC9BtlJ,QAAAA,GAAG,CAACY,WAAJ,GAAkB,KAAKif,QAAL,CAAcylI,YAAd,CAA2B/qJ,OAA3B,CAAmC,UAAnC,EAA+C,EAA/C,CAAlB;AACD;;AACD,WAAKs2I,EAAL,GAAU;AACRx1F,QAAAA,QAAQ,EAAEA,QAAQ,EADV;AAERzN,QAAAA,gBAAgB,EAAE7hD,SAFV;AAGR0/C,QAAAA,IAAI,EAAEr9C,IAHE;AAIRs9C,QAAAA,IAAI,EAAEt9C,IAJE;AAKRsnJ,QAAAA,MAAM,EAAEtnJ,IALA;AAMRonJ,QAAAA,OAAO,EAAEpnJ,IAND;AAORqnJ,QAAAA,UAAU,EAAE5lJ;AAPJ,OAAV;AASA,UAAIiC,IAAI,GAAG,IAAX;AACA,UAAIyzJ,YAAY,GAAGhH,QAAQ,CAACzsJ,IAAD,CAA3B;AACA,WAAKu7B,IAAL,GAAYk4H,YAAZ;AACA,WAAKlH,OAAL,GAAekH,YAAY,CAAC70I,GAA5B;AACAg8D,MAAAA,aAAa,CAAChyC,IAAd,CAAmB,aAAnB,EAAkC;AAAEnb,QAAAA,MAAM,EAAE;AAAV,OAAlC;AACA,WAAKoxH,YAAL,CAAkB,OAAlB,EAA2B,IAA3B;AACA,WAAK5iG,CAAL,GAASjF,QAAQ,CAACsD,gBAAT,CAA0B,YAAY;AAC7C,eAAO;AACLvN,UAAAA,OAAO,EAAE1K,KAAK,CAAC7C,MAAN,GAAe6C,KAAK,CAACwlB,OAAN,EAAf,GAAiCxlB,KAAK,CAACumC,MAAN,EADrC;AAELj1D,UAAAA,OAAO,EAAE0uB,KAAK,CAACwlB,OAAN;AAFJ,SAAP;AAID,OALQ,CAAT;AAMD;;AACDirG,IAAAA,MAAM,CAAC14J,SAAP,CAAiB6qJ,MAAjB,GAA0B,YAAY;AACpCA,MAAAA,MAAM,CAAC,IAAD,CAAN;AACD,KAFD;;AAGA6N,IAAAA,MAAM,CAAC14J,SAAP,CAAiB23C,KAAjB,GAAyB,UAAUyqC,SAAV,EAAqB;AAC5CD,MAAAA,OAAO,CAAC,IAAD,EAAOC,SAAP,CAAP;AACD,KAFD;;AAGAs2E,IAAAA,MAAM,CAAC14J,SAAP,CAAiB63C,QAAjB,GAA4B,YAAY;AACtC,aAAO8pC,UAAU,CAAC,IAAD,CAAjB;AACD,KAFD;;AAGA+2E,IAAAA,MAAM,CAAC14J,SAAP,CAAiBykJ,YAAjB,GAAgC,UAAUtkJ,IAAV,EAAgB;AAC9C,UAAIP,CAAC,GAAG,EAAR;;AACA,WAAK,IAAI2C,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5C3C,QAAAA,CAAC,CAAC2C,EAAE,GAAG,CAAN,CAAD,GAAYC,SAAS,CAACD,EAAD,CAArB;AACD;;AACD,UAAIqD,IAAI,GAAG,IAAX;AACA,UAAIoF,QAAQ,GAAGpF,IAAI,CAAC+tB,QAAL,CAAcxzB,IAAd,CAAf;AAAA,UAAoCkX,KAApC;;AACA,UAAI,CAACrM,QAAL,EAAe;AACb;AACD;;AACD,UAAIpF,IAAI,CAAC0zJ,cAAL,KAAwBjiJ,KAAK,GAAGzR,IAAI,CAAC0zJ,cAAL,CAAoBn5J,IAApB,CAAhC,CAAJ,EAAgE;AAC9D6K,QAAAA,QAAQ,GAAGqM,KAAK,CAAC6b,IAAjB;AACA7b,QAAAA,KAAK,GAAGA,KAAK,CAACA,KAAd;AACD;;AACD,UAAI,OAAOrM,QAAP,KAAoB,QAAxB,EAAkC;AAChCqM,QAAAA,KAAK,GAAGrM,QAAQ,CAACqD,OAAT,CAAiB,QAAjB,EAA2B,EAA3B,CAAR;AACAgJ,QAAAA,KAAK,GAAGA,KAAK,GAAGmhJ,SAAS,CAACnhJ,KAAD,CAAZ,GAAsB,CAAnC;AACArM,QAAAA,QAAQ,GAAGwtJ,SAAS,CAACxtJ,QAAD,CAApB;AACApF,QAAAA,IAAI,CAAC0zJ,cAAL,GAAsB1zJ,IAAI,CAAC0zJ,cAAL,IAAuB,EAA7C;AACA1zJ,QAAAA,IAAI,CAAC0zJ,cAAL,CAAoBn5J,IAApB,IAA4B;AAC1B+yB,UAAAA,IAAI,EAAEloB,QADoB;AAE1BqM,UAAAA,KAAK,EAAEA;AAFmB,SAA5B;AAID;;AACD,aAAOrM,QAAQ,CAACvI,KAAT,CAAe4U,KAAK,IAAIzR,IAAxB,EAA8BhG,CAA9B,CAAP;AACD,KAzBD;;AA0BA84J,IAAAA,MAAM,CAAC14J,SAAP,CAAiB0f,SAAjB,GAA6B,UAAUvH,IAAV,EAAgB;AAC3C,aAAO8xC,IAAI,CAACvqC,SAAL,CAAevH,IAAf,CAAP;AACD,KAFD;;AAGAugJ,IAAAA,MAAM,CAAC14J,SAAP,CAAiBg5D,QAAjB,GAA4B,UAAU74D,IAAV,EAAgB8hD,UAAhB,EAA4B57C,IAA5B,EAAkC;AAC5D,aAAO2yD,QAAQ,CAAC,IAAD,EAAO74D,IAAP,EAAa8hD,UAAb,EAAyB57C,IAAzB,CAAf;AACD,KAFD;;AAGAqyJ,IAAAA,MAAM,CAAC14J,SAAP,CAAiBu5J,SAAjB,GAA6B,UAAUp5J,IAAV,EAAgBmuH,MAAhB,EAAwB;AACnD,UAAIirC,SAAS,GAAG9xJ,QAAQ,CAACw1D,UAAU,CAAC,IAAD,CAAV,CAAiB7nD,KAAjB,CAAuB,MAAvB,CAAD,EAAiCjV,IAAjC,CAAxB;;AACA,UAAIo5J,SAAJ,EAAe;AACb,eAAOjrC,MAAM,GAAGxiE,aAAa,CAAC9iD,GAAd,CAAkB7I,IAAlB,MAA4BN,SAA/B,GAA2C,IAAxD;AACD,OAFD,MAEO;AACL,eAAO,KAAP;AACD;AACF,KAPD;;AAQA64J,IAAAA,MAAM,CAAC14J,SAAP,CAAiBg1E,WAAjB,GAA+B,UAAU1yE,IAAV,EAAgB;AAC7C,WAAK4jJ,qBAAL,CAA2BlxE,WAA3B,CAAuC1yE,IAAvC;AACD,KAFD;;AAGAo2J,IAAAA,MAAM,CAAC14J,SAAP,CAAiBqlI,UAAjB,GAA8B,UAAUllI,IAAV,EAAgB6K,QAAhB,EAA0BqM,KAA1B,EAAiC;AAC7D,WAAK8hJ,cAAL,CAAoB9zB,UAApB,CAA+BllI,IAA/B,EAAqC6K,QAArC,EAA+CqM,KAA/C;AACD,KAFD;;AAGAqhJ,IAAAA,MAAM,CAAC14J,SAAP,CAAiB6tJ,oBAAjB,GAAwC,UAAU1tJ,IAAV,EAAgB6K,QAAhB,EAA0BqM,KAA1B,EAAiC;AACvE,WAAK8hJ,cAAL,CAAoBtL,oBAApB,CAAyC1tJ,IAAzC,EAA+C6K,QAA/C,EAAyDqM,KAAzD;AACD,KAFD;;AAGAqhJ,IAAAA,MAAM,CAAC14J,SAAP,CAAiB8tJ,oBAAjB,GAAwC,UAAU3tJ,IAAV,EAAgB6K,QAAhB,EAA0BqM,KAA1B,EAAiC;AACvE,WAAK8hJ,cAAL,CAAoBrL,oBAApB,CAAyC3tJ,IAAzC,EAA+C6K,QAA/C,EAAyDqM,KAAzD;AACD,KAFD;;AAGAqhJ,IAAAA,MAAM,CAAC14J,SAAP,CAAiB61H,WAAjB,GAA+B,UAAUjxF,OAAV,EAAmByvH,IAAnB,EAAyBC,OAAzB,EAAkCj9I,KAAlC,EAAyC;AACtE,WAAKoqI,SAAL,CAAe/gH,GAAf,CAAmBkE,OAAnB,EAA4ByvH,IAA5B,EAAkCC,OAAlC,EAA2Cj9I,KAA3C;AACD,KAFD;;AAGAqhJ,IAAAA,MAAM,CAAC14J,SAAP,CAAiBk2E,WAAjB,GAA+B,UAAUigD,GAAV,EAAewuB,EAAf,EAAmB5hJ,KAAnB,EAA0BT,IAA1B,EAAgC;AAC7D,aAAO,KAAK62J,cAAL,CAAoBjjF,WAApB,CAAgCigD,GAAhC,EAAqCwuB,EAArC,EAAyC5hJ,KAAzC,EAAgDT,IAAhD,CAAP;AACD,KAFD;;AAGAo2J,IAAAA,MAAM,CAAC14J,SAAP,CAAiB+kI,iBAAjB,GAAqC,UAAU5O,GAAV,EAAe;AAClD,aAAO,KAAKgjC,cAAL,CAAoBp0B,iBAApB,CAAsC5O,GAAtC,CAAP;AACD,KAFD;;AAGAuiC,IAAAA,MAAM,CAAC14J,SAAP,CAAiB0tJ,iBAAjB,GAAqC,UAAUv3B,GAAV,EAAe;AAClD,aAAO,KAAKgjC,cAAL,CAAoBzL,iBAApB,CAAsCv3B,GAAtC,CAAP;AACD,KAFD;;AAGAuiC,IAAAA,MAAM,CAAC14J,SAAP,CAAiBkhJ,qBAAjB,GAAyC,UAAU/qB,GAAV,EAAe;AACtD,aAAO,KAAKgjC,cAAL,CAAoBjY,qBAApB,CAA0C/qB,GAA1C,CAAP;AACD,KAFD;;AAGAuiC,IAAAA,MAAM,CAAC14J,SAAP,CAAiBu/C,IAAjB,GAAwB,YAAY;AAClC,UAAI35C,IAAI,GAAG,IAAX;;AACA,UAAIA,IAAI,CAAC8hJ,MAAT,EAAiB;AACf9hJ,QAAAA,IAAI,CAAC8hJ,MAAL,GAAc,KAAd;;AACA,YAAI9hJ,IAAI,CAACw/B,MAAT,EAAiB;AACfx/B,UAAAA,IAAI,CAAC6nD,OAAL,GAAev5C,eAAf,GAAiC,MAAjC;AACD,SAFD,MAEO;AACLmkJ,UAAAA,KAAK,CAAC94G,IAAN,CAAW35C,IAAI,CAACk8F,YAAL,EAAX;AACAu2D,UAAAA,KAAK,CAAC74G,IAAN,CAAW55C,IAAI,CAAC1B,EAAhB;AACD;;AACD0B,QAAAA,IAAI,CAAC4uB,IAAL;AACA5uB,QAAAA,IAAI,CAAC4oC,IAAL,CAAU,MAAV;AACD;AACF,KAbD;;AAcAkqH,IAAAA,MAAM,CAAC14J,SAAP,CAAiBw/C,IAAjB,GAAwB,YAAY;AAClC,UAAI55C,IAAI,GAAG,IAAX;AAAA,UAAiB0R,GAAG,GAAG1R,IAAI,CAAC4oE,MAAL,EAAvB;;AACA,UAAI,CAAC5oE,IAAI,CAAC8hJ,MAAV,EAAkB;AAChB,YAAI+Q,IAAI,IAAInhJ,GAAR,IAAe,CAAC1R,IAAI,CAACw/B,MAAzB,EAAiC;AAC/B9tB,UAAAA,GAAG,CAAC4+D,WAAJ,CAAgB,WAAhB;AACD;;AACDtwE,QAAAA,IAAI,CAACk8G,IAAL;;AACA,YAAIl8G,IAAI,CAACw/B,MAAT,EAAiB;AACfx/B,UAAAA,IAAI,CAAC6nD,OAAL,GAAev5C,eAAf,GAAiC,OAAjC;;AACA,cAAItO,IAAI,KAAKA,IAAI,CAAC46E,aAAL,CAAmBC,aAAhC,EAA+C;AAC7C76E,YAAAA,IAAI,CAAC46E,aAAL,CAAmBC,aAAnB,GAAmC,IAAnC;AACD;AACF,SALD,MAKO;AACL43E,UAAAA,KAAK,CAAC74G,IAAN,CAAW55C,IAAI,CAACk8F,YAAL,EAAX;AACAu2D,UAAAA,KAAK,CAACr1G,QAAN,CAAep9C,IAAI,CAAC1B,EAApB,EAAwB,SAAxB,EAAmC0B,IAAI,CAACo7G,UAAxC;AACD;;AACDp7G,QAAAA,IAAI,CAAC8hJ,MAAL,GAAc,IAAd;AACA9hJ,QAAAA,IAAI,CAAC4oC,IAAL,CAAU,MAAV;AACD;AACF,KAnBD;;AAoBAkqH,IAAAA,MAAM,CAAC14J,SAAP,CAAiBklD,QAAjB,GAA4B,YAAY;AACtC,aAAO,CAAC,CAAC,KAAKwiG,MAAd;AACD,KAFD;;AAGAgR,IAAAA,MAAM,CAAC14J,SAAP,CAAiBomJ,gBAAjB,GAAoC,UAAUvxH,KAAV,EAAiBjC,IAAjB,EAAuB;AACzD,WAAK4b,IAAL,CAAU,eAAV,EAA2B;AACzB3Z,QAAAA,KAAK,EAAEA,KADkB;AAEzBjC,QAAAA,IAAI,EAAEA;AAFmB,OAA3B;AAID,KALD;;AAMA8lI,IAAAA,MAAM,CAAC14J,SAAP,CAAiBw0B,IAAjB,GAAwB,UAAUlyB,IAAV,EAAgB;AACtC,UAAIsD,IAAI,GAAG,IAAX;AACA,UAAIwgB,GAAG,GAAGxgB,IAAI,CAAC+1D,UAAL,EAAV;AAAA,UAA6BvkD,IAA7B;;AACA,UAAIxR,IAAI,CAAC0tB,OAAT,EAAkB;AAChB,eAAO,EAAP;AACD;;AACD,UAAIlN,GAAJ,EAAS;AACP9jB,QAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;AACAA,QAAAA,IAAI,CAACkyB,IAAL,GAAY,IAAZ;AACA,YAAIzxB,KAAK,GAAG0gB,iBAAiB,CAAC2C,GAAD,CAAjB,GAAyBA,GAAG,CAACrjB,KAA7B,GAAqCqjB,GAAG,CAAC3O,SAArD;AACAL,QAAAA,IAAI,GAAGxR,IAAI,CAACosF,UAAL,CAAgBjvF,KAAhB,EAAuBT,IAAvB,CAAP;AACAA,QAAAA,IAAI,CAACiX,OAAL,GAAe6M,GAAf;;AACA,YAAI,CAAC9jB,IAAI,CAACknF,SAAV,EAAqB;AACnB5jF,UAAAA,IAAI,CAAC4oC,IAAL,CAAU,aAAV,EAAyBlsC,IAAzB;AACD;;AACDA,QAAAA,IAAI,CAACiX,OAAL,GAAe6M,GAAG,GAAG,IAArB;AACA,eAAOhP,IAAP;AACD;AACF,KAlBD;;AAmBAshJ,IAAAA,MAAM,CAAC14J,SAAP,CAAiB8hH,IAAjB,GAAwB,UAAUx/G,IAAV,EAAgB;AACtC,UAAIsD,IAAI,GAAG,IAAX;AACA,UAAIwgB,GAAG,GAAGxgB,IAAI,CAAC+1D,UAAL,EAAV;AAAA,UAA6BvkD,IAA7B;AAAA,UAAmCoqG,IAAnC;;AACA,UAAI,CAACp7F,GAAD,IAAQ,CAACxgB,IAAI,CAACszI,WAAd,IAA6BtzI,IAAI,CAAC0tB,OAAtC,EAA+C;AAC7C;AACD;;AACDhxB,MAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;AACAA,MAAAA,IAAI,CAACw/G,IAAL,GAAY,IAAZ;AACAx/G,MAAAA,IAAI,CAACiX,OAAL,GAAe6M,GAAf;AACAhP,MAAAA,IAAI,GAAG9U,IAAI,CAACu8C,OAAL,GAAej5C,IAAI,CAAC+kF,UAAL,CAAgBroF,IAAhB,CAAtB;;AACA,UAAI,CAACA,IAAI,CAACknF,SAAV,EAAqB;AACnB5jF,QAAAA,IAAI,CAAC4oC,IAAL,CAAU,aAAV,EAAyBlsC,IAAzB;AACD;;AACD,UAAIA,IAAI,CAACgmE,MAAL,KAAgB,KAApB,EAA2B;AACzB1iE,QAAAA,IAAI,CAAC4oC,IAAL,CAAU,gBAAV,EAA4BlsC,IAA5B;AACD;;AACD8U,MAAAA,IAAI,GAAG9U,IAAI,CAACu8C,OAAZ;;AACA,UAAI,CAACp7B,iBAAiB,CAAC2C,GAAD,CAAtB,EAA6B;AAC3B,YAAI9jB,IAAI,CAACy/G,WAAL,IAAoB,CAACn8G,IAAI,CAACw/B,MAA9B,EAAsC;AACpChf,UAAAA,GAAG,CAAC3O,SAAJ,GAAgBL,IAAhB;AACD;;AACD,YAAIoqG,IAAI,GAAG62C,KAAK,CAACz0G,SAAN,CAAgBh+C,IAAI,CAAC1B,EAArB,EAAyB,MAAzB,CAAX,EAA6C;AAC3Cq0J,UAAAA,MAAM,CAAC/2C,IAAI,CAACrlG,QAAN,EAAgB,UAAUiK,GAAV,EAAe;AACnC,gBAAIA,GAAG,CAACjmB,IAAJ,KAAayF,IAAI,CAAC1B,EAAtB,EAA0B;AACxBkiB,cAAAA,GAAG,CAACrjB,KAAJ,GAAYqU,IAAZ;AACA,qBAAO,KAAP;AACD;AACF,WALK,CAAN;AAMD;AACF,OAZD,MAYO;AACLgP,QAAAA,GAAG,CAACrjB,KAAJ,GAAYqU,IAAZ;AACD;;AACD9U,MAAAA,IAAI,CAACiX,OAAL,GAAe6M,GAAG,GAAG,IAArB;;AACA,UAAI9jB,IAAI,CAAC4oJ,SAAL,KAAmB,KAAvB,EAA8B;AAC5BtlJ,QAAAA,IAAI,CAACkqG,QAAL,CAAc,KAAd;AACD;;AACD,aAAO14F,IAAP;AACD,KArCD;;AAsCAshJ,IAAAA,MAAM,CAAC14J,SAAP,CAAiBgyF,UAAjB,GAA8B,UAAUnzC,OAAV,EAAmBv8C,IAAnB,EAAyB;AACrD,aAAOu+G,YAAY,CAAC,IAAD,EAAOhiE,OAAP,EAAgBv8C,IAAhB,CAAnB;AACD,KAFD;;AAGAo2J,IAAAA,MAAM,CAAC14J,SAAP,CAAiB2qF,UAAjB,GAA8B,UAAUroF,IAAV,EAAgB;AAC5C,aAAOs+G,YAAY,CAAC,IAAD,EAAOt+G,IAAP,CAAnB;AACD,KAFD;;AAGAo2J,IAAAA,MAAM,CAAC14J,SAAP,CAAiB+wG,aAAjB,GAAiC,UAAUlyD,OAAV,EAAmBv8C,IAAnB,EAAyB;AACxD,UAAIA,IAAJ,EAAU;AACRu8C,QAAAA,OAAO,GAAGy5G,QAAQ,CAAC;AAAEz5G,UAAAA,OAAO,EAAEA;AAAX,SAAD,EAAuBv8C,IAAvB,CAAlB;AACD;;AACD,WAAK4zE,WAAL,CAAiB,kBAAjB,EAAqC,KAArC,EAA4Cr3B,OAA5C;AACD,KALD;;AAMA65G,IAAAA,MAAM,CAAC14J,SAAP,CAAiB+qJ,YAAjB,GAAgC,UAAUyO,cAAV,EAA0B;AACxD,UAAIA,cAAc,KAAK35J,SAAvB,EAAkC;AAChCghH,QAAAA,YAAY,CAAC,IAAD,EAAO,KAAK0kC,YAAZ,EAA0B;AAAEj9E,UAAAA,MAAM,EAAE;AAAV,SAA1B,CAAZ;AACD,OAFD,MAEO;AACLu4C,QAAAA,YAAY,CAAC,IAAD,EAAO24C,cAAP,CAAZ;AACD;;AACD,WAAKxqF,WAAL,CAAiB0b,KAAjB;AACA,WAAKolB,QAAL,CAAc,KAAd;AACA,WAAK96B,WAAL;AACD,KATD;;AAUA0jF,IAAAA,MAAM,CAAC14J,SAAP,CAAiBq2H,OAAjB,GAA2B,YAAY;AACrC,aAAO,CAAC,KAAKuiC,UAAb;AACD,KAFD;;AAGAF,IAAAA,MAAM,CAAC14J,SAAP,CAAiB8vG,QAAjB,GAA4B,UAAUj7E,KAAV,EAAiB;AAC3C,UAAI4kI,QAAQ,GAAG,CAAC,KAAKb,UAArB;AACA,WAAKA,UAAL,GAAkB,CAAC/jI,KAAnB;;AACA,UAAIA,KAAK,IAAIA,KAAK,KAAK4kI,QAAvB,EAAiC;AAC/B,aAAKjrH,IAAL,CAAU,OAAV;AACD;AACF,KAND;;AAOAkqH,IAAAA,MAAM,CAAC14J,SAAP,CAAiB8hG,YAAjB,GAAgC,YAAY;AAC1C,UAAIl8F,IAAI,GAAG,IAAX;;AACA,UAAI,CAACA,IAAI,CAAC+O,SAAV,EAAqB;AACnB/O,QAAAA,IAAI,CAAC+O,SAAL,GAAiB0jJ,KAAK,CAACrvJ,GAAN,CAAUpD,IAAI,CAACy7G,eAAL,IAAwBz7G,IAAI,CAAC1B,EAAL,GAAU,SAA5C,CAAjB;AACD;;AACD,aAAO0B,IAAI,CAAC+O,SAAZ;AACD,KAND;;AAOA+jJ,IAAAA,MAAM,CAAC14J,SAAP,CAAiBmoH,uBAAjB,GAA2C,YAAY;AACrD,aAAO,KAAKhH,oBAAZ;AACD,KAFD;;AAGAu3C,IAAAA,MAAM,CAAC14J,SAAP,CAAiB27D,UAAjB,GAA8B,YAAY;AACxC,UAAI,CAAC,KAAKsZ,SAAV,EAAqB;AACnB,aAAKA,SAAL,GAAiBojF,KAAK,CAACrvJ,GAAN,CAAU,KAAK9E,EAAf,CAAjB;AACD;;AACD,aAAO,KAAK+wE,SAAZ;AACD,KALD;;AAMAyjF,IAAAA,MAAM,CAAC14J,SAAP,CAAiBq+E,MAAjB,GAA0B,YAAY;AACpC,UAAIz4E,IAAI,GAAG,IAAX;AACA,UAAIwgB,GAAJ;;AACA,UAAI,CAACxgB,IAAI,CAACi6C,aAAV,EAAyB;AACvBz5B,QAAAA,GAAG,GAAGxgB,IAAI,CAAC27E,aAAX;;AACA,YAAIn7D,GAAJ,EAAS;AACPxgB,UAAAA,IAAI,CAACi6C,aAAL,GAAqBz5B,GAAG,CAACy5B,aAAzB;AACD;AACF;;AACD,aAAOj6C,IAAI,CAACi6C,aAAZ;AACD,KAVD;;AAWA64G,IAAAA,MAAM,CAAC14J,SAAP,CAAiBwuE,MAAjB,GAA0B,YAAY;AACpC,UAAI5oE,IAAI,GAAG,IAAX;AACA,UAAIqa,GAAJ;;AACA,UAAI,CAACra,IAAI,CAACg6C,eAAV,EAA2B;AACzB3/B,QAAAA,GAAG,GAAGra,IAAI,CAACy4E,MAAL,EAAN;;AACA,YAAIp+D,GAAJ,EAAS;AACPra,UAAAA,IAAI,CAACg6C,eAAL,GAAuB3/B,GAAG,CAACzL,QAA3B;AACD;AACF;;AACD,aAAO5O,IAAI,CAACg6C,eAAZ;AACD,KAVD;;AAWA84G,IAAAA,MAAM,CAAC14J,SAAP,CAAiBytD,OAAjB,GAA2B,YAAY;AACrC,UAAIn2C,GAAG,GAAG,KAAKk3D,MAAL,EAAV;AACA,aAAO,KAAK8yC,WAAL,KAAqBhqG,GAAG,GAAGA,GAAG,CAACiI,IAAP,GAAc,IAAtC,CAAP;AACD,KAHD;;AAIAm5I,IAAAA,MAAM,CAAC14J,SAAP,CAAiB8kH,UAAjB,GAA8B,UAAUhuG,GAAV,EAAe3W,IAAf,EAAqBimB,GAArB,EAA0B;AACtD,UAAIxgB,IAAI,GAAG,IAAX;AAAA,UAAiB+tB,QAAQ,GAAG/tB,IAAI,CAAC+tB,QAAjC;;AACA,UAAIA,QAAQ,CAAC+lI,qBAAb,EAAoC;AAClC,eAAO9zJ,IAAI,CAAC6+I,YAAL,CAAkB,uBAAlB,EAA2C3tI,GAA3C,EAAgDsP,GAAhD,EAAqD,IAArD,EAA2DjmB,IAA3D,CAAP;AACD;;AACD,UAAI,CAACwzB,QAAQ,CAAC8wF,YAAV,IAA0Br+F,GAAG,IAAIA,GAAG,CAACtL,QAAJ,KAAiB,MAAlD,IAA4DhE,GAAG,CAACxW,OAAJ,CAAY,OAAZ,MAAyB,CAArF,IAA0FwW,GAAG,CAACzV,MAAJ,KAAe,CAA7G,EAAgH;AAC9G,eAAOyV,GAAP;AACD;;AACD,UAAI6c,QAAQ,CAAC+wF,aAAb,EAA4B;AAC1B,eAAO9+G,IAAI,CAACimH,eAAL,CAAqByrC,UAArB,CAAgCxgJ,GAAhC,CAAP;AACD;;AACDA,MAAAA,GAAG,GAAGlR,IAAI,CAACimH,eAAL,CAAqBC,UAArB,CAAgCh1G,GAAhC,EAAqC6c,QAAQ,CAACgxF,kBAA9C,CAAN;AACA,aAAO7tG,GAAP;AACD,KAbD;;AAcA4hJ,IAAAA,MAAM,CAAC14J,SAAP,CAAiBs6F,SAAjB,GAA6B,UAAUl0E,GAAV,EAAe;AAC1C+kI,MAAAA,WAAW,CAAC,IAAD,EAAO/kI,GAAP,CAAX;AACD,KAFD;;AAGAsyI,IAAAA,MAAM,CAAC14J,SAAP,CAAiBkf,MAAjB,GAA0B,YAAY;AACpC0iG,MAAAA,QAAQ,CAAC,IAAD,CAAR;AACD,KAFD;;AAGA82C,IAAAA,MAAM,CAAC14J,SAAP,CAAiB2uC,OAAjB,GAA2B,UAAUszE,SAAV,EAAqB;AAC9CtzE,MAAAA,OAAO,CAAC,IAAD,EAAOszE,SAAP,CAAP;AACD,KAFD;;AAGAy2C,IAAAA,MAAM,CAAC14J,SAAP,CAAiBgxH,YAAjB,GAAgC,UAAUhmH,QAAV,EAAoB;AAClD,aAAO,KAAK62G,YAAL,CAAkBmP,YAAlB,CAA+BhmH,QAA/B,CAAP;AACD,KAFD;;AAGA0tJ,IAAAA,MAAM,CAAC14J,SAAP,CAAiB25J,cAAjB,GAAkC,YAAY;AAC5C,aAAO,KAAK93C,YAAL,CAAkBoP,aAAlB,EAAP;AACD,KAFD;;AAGAynC,IAAAA,MAAM,CAAC14J,SAAP,CAAiBg1J,SAAjB,GAA6B,YAAY;AACvC,YAAM,IAAItxJ,KAAJ,CAAU,sKAAV,CAAN;AACD,KAFD;;AAGAg1J,IAAAA,MAAM,CAAC14J,SAAP,CAAiB41J,UAAjB,GAA8B,YAAY;AACxC,YAAM,IAAIlyJ,KAAJ,CAAU,6FAAV,CAAN;AACD,KAFD;;AAGAg1J,IAAAA,MAAM,CAAC14J,SAAP,CAAiBq1J,WAAjB,GAA+B,YAAY;AACzC,YAAM,IAAI3xJ,KAAJ,CAAU,+FAAV,CAAN;AACD,KAFD;;AAGAg1J,IAAAA,MAAM,CAAC14J,SAAP,CAAiB01J,iBAAjB,GAAqC,YAAY;AAC/C,YAAM,IAAIhyJ,KAAJ,CAAU,2GAAV,CAAN;AACD,KAFD;;AAGA,WAAOg1J,MAAP;AACD,GA9VY,EAAb;;AAgWA,MAAIkB,KAAK,GAAGx4G,QAAQ,CAAC2D,GAArB;AACA,MAAI80G,SAAS,GAAG9iJ,KAAK,CAACJ,OAAtB;AAAA,MAA+BmjJ,MAAM,GAAG/iJ,KAAK,CAAC9R,IAA9C;AAAA,MAAoD80J,QAAQ,GAAGhjJ,KAAK,CAACZ,MAArE;AACA,MAAI6jJ,eAAe,GAAG,CAAtB;AAAA,MAAyBC,iBAAiB,GAAG,KAA7C;AACA,MAAIC,oBAAJ;AACA,MAAIC,aAAa,GAAG,EAApB;AACA,MAAI5I,OAAO,GAAG,EAAd;;AACA,MAAI6I,gBAAgB,GAAG,UAAUl2J,EAAV,EAAc;AACnC,WAAOA,EAAE,KAAK,QAAd;AACD,GAFD;;AAGA,MAAIm2J,mBAAmB,GAAG,UAAUnuJ,CAAV,EAAa;AACrC,QAAI7F,IAAI,GAAG6F,CAAC,CAAC7F,IAAb;AACAyzJ,IAAAA,MAAM,CAACQ,aAAa,CAACtxJ,GAAd,EAAD,EAAsB,UAAUqqB,MAAV,EAAkB;AAC5C,cAAQhtB,IAAR;AACA,aAAK,QAAL;AACEgtB,UAAAA,MAAM,CAACmb,IAAP,CAAY,cAAZ,EAA4BtiC,CAA5B;AACA;;AACF,aAAK,QAAL;AACEmnB,UAAAA,MAAM,CAACmb,IAAP,CAAY,cAAZ,EAA4BtiC,CAA5B;AACA;AANF;AAQD,KATK,CAAN;AAUD,GAZD;;AAaA,MAAIquJ,kBAAkB,GAAG,UAAU1lI,KAAV,EAAiB;AACxC,QAAIA,KAAK,KAAKolI,iBAAd,EAAiC;AAC/B,UAAIplI,KAAJ,EAAW;AACT+nB,QAAAA,QAAQ,CAAC1pC,MAAD,CAAR,CAAiBiW,EAAjB,CAAoB,eAApB,EAAqCkxI,mBAArC;AACD,OAFD,MAEO;AACLz9G,QAAAA,QAAQ,CAAC1pC,MAAD,CAAR,CAAiBoW,GAAjB,CAAqB,eAArB,EAAsC+wI,mBAAtC;AACD;;AACDJ,MAAAA,iBAAiB,GAAGplI,KAApB;AACD;AACF,GATD;;AAUA,MAAI2lI,oBAAoB,GAAG,UAAUC,YAAV,EAAwB;AACjD,QAAIC,UAAU,GAAGnJ,OAAjB;AACA,WAAO4I,aAAa,CAACM,YAAY,CAACv2J,EAAd,CAApB;;AACA,SAAK,IAAI3C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG44J,aAAa,CAAC94J,MAAlC,EAA0CE,CAAC,EAA3C,EAA+C;AAC7C,UAAI44J,aAAa,CAAC54J,CAAD,CAAb,KAAqBk5J,YAAzB,EAAuC;AACrCN,QAAAA,aAAa,CAAC71H,MAAd,CAAqB/iC,CAArB,EAAwB,CAAxB;AACA;AACD;AACF;;AACDgwJ,IAAAA,OAAO,GAAGlsJ,MAAM,CAACksJ,OAAD,EAAU,UAAUl+H,MAAV,EAAkB;AAC1C,aAAOonI,YAAY,KAAKpnI,MAAxB;AACD,KAFe,CAAhB;;AAGA,QAAIinI,aAAa,CAAC15E,YAAd,KAA+B65E,YAAnC,EAAiD;AAC/CH,MAAAA,aAAa,CAAC15E,YAAd,GAA6B2wE,OAAO,CAAClwJ,MAAR,GAAiB,CAAjB,GAAqBkwJ,OAAO,CAAC,CAAD,CAA5B,GAAkC,IAA/D;AACD;;AACD,QAAI+I,aAAa,CAAC75E,aAAd,KAAgCg6E,YAApC,EAAkD;AAChDH,MAAAA,aAAa,CAAC75E,aAAd,GAA8B,IAA9B;AACD;;AACD,WAAOi6E,UAAU,CAACr5J,MAAX,KAAsBkwJ,OAAO,CAAClwJ,MAArC;AACD,GAnBD;;AAoBA,MAAIs5J,oBAAoB,GAAG,UAAUtnI,MAAV,EAAkB;AAC3C,QAAIA,MAAM,IAAIA,MAAM,CAAC6lH,WAAjB,IAAgC,CAAC,CAAC7lH,MAAM,CAACyuE,YAAP,MAAyBzuE,MAAM,CAACo6B,OAAP,EAA1B,EAA4C9xC,UAAjF,EAA6F;AAC3F6+I,MAAAA,oBAAoB,CAACnnI,MAAD,CAApB;AACAA,MAAAA,MAAM,CAAC2uF,qBAAP;AACA3uF,MAAAA,MAAM,CAACsb,OAAP,CAAe,IAAf;AACAtb,MAAAA,MAAM,CAACC,OAAP,GAAiB,IAAjB;AACAD,MAAAA,MAAM,GAAG,IAAT;AACD;;AACD,WAAOA,MAAP;AACD,GATD;;AAUA,MAAIunI,YAAY,GAAGpmJ,QAAQ,CAACqmJ,UAAT,KAAwB,YAA3C;;AACA,MAAIP,aAAa,GAAGxuJ,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4kJ,UAAL,CAAT,EAA2B;AACrDsI,IAAAA,OAAO,EAAE,IAD4C;AAErDptG,IAAAA,OAAO,EAAE,IAF4C;AAGrD26D,IAAAA,eAAe,EAAE,EAHoC;AAIrDsyC,IAAAA,eAAe,EAAE,IAJoC;AAKrD5vH,IAAAA,MAAM,EAAE,IAL6C;AAMrD4Y,IAAAA,CAAC,EAAEjF,QANkD;AAOrDk+G,IAAAA,YAAY,EAAE,GAPuC;AAQrDC,IAAAA,YAAY,EAAE,KARuC;AASrDC,IAAAA,WAAW,EAAE,YATwC;AAUrDzJ,IAAAA,OAAO,EAAE4I,aAV4C;AAWrDc,IAAAA,IAAI,EAAEhxG,IAX+C;AAYrD22B,IAAAA,YAAY,EAAE,IAZuC;AAarDH,IAAAA,aAAa,EAAE,IAbsC;AAcrD9sD,IAAAA,QAAQ,EAAE,EAd2C;AAerDy6B,IAAAA,KAAK,EAAE,YAAY;AACjB,UAAIxoD,IAAI,GAAG,IAAX;AACA,UAAIgmD,OAAJ;AAAA,UAAaitG,eAAb;AAAA,UAA8B5vH,MAAM,GAAG,EAAvC;AACA4vH,MAAAA,eAAe,GAAGvC,GAAG,CAACl9F,kBAAJ,CAAuB5kD,QAAQ,CAACkjC,QAAhC,CAAlB;;AACA,UAAI,yBAAyBxqC,IAAzB,CAA8B2rJ,eAA9B,CAAJ,EAAoD;AAClDA,QAAAA,eAAe,GAAGA,eAAe,CAACxqJ,OAAhB,CAAwB,UAAxB,EAAoC,EAApC,EAAwCA,OAAxC,CAAgD,eAAhD,EAAiE,EAAjE,CAAlB;;AACA,YAAI,CAAC,UAAUnB,IAAV,CAAe2rJ,eAAf,CAAL,EAAsC;AACpCA,UAAAA,eAAe,IAAI,GAAnB;AACD;AACF;;AACD,UAAI7T,OAAO,GAAG9xI,MAAM,CAACgoJ,OAAP,IAAkBhoJ,MAAM,CAACioJ,cAAvC;;AACA,UAAInW,OAAJ,EAAa;AACXp5F,QAAAA,OAAO,GAAGo5F,OAAO,CAAChrI,IAAR,IAAgBgrI,OAAO,CAACp5F,OAAlC;AACA3iB,QAAAA,MAAM,GAAG+7G,OAAO,CAAC/7G,MAAjB;AACD,OAHD,MAGO;AACL,YAAIsf,OAAO,GAAG/zC,QAAQ,CAAComB,oBAAT,CAA8B,QAA9B,CAAd;;AACA,aAAK,IAAIr5B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgnD,OAAO,CAAClnD,MAA5B,EAAoCE,CAAC,EAArC,EAAyC;AACvC,cAAIu/C,GAAG,GAAGyH,OAAO,CAAChnD,CAAD,CAAP,CAAWu/C,GAAX,IAAkB,EAA5B;;AACA,cAAIA,GAAG,KAAK,EAAZ,EAAgB;AACd;AACD;;AACD,cAAIs6G,SAAS,GAAGt6G,GAAG,CAACnxC,SAAJ,CAAcmxC,GAAG,CAAC+K,WAAJ,CAAgB,GAAhB,CAAd,CAAhB;;AACA,cAAI,8CAA8C3+C,IAA9C,CAAmD4zC,GAAnD,CAAJ,EAA6D;AAC3D,gBAAIs6G,SAAS,CAAC96J,OAAV,CAAkB,MAAlB,MAA8B,CAAC,CAAnC,EAAsC;AACpC2oC,cAAAA,MAAM,GAAG,MAAT;AACD;;AACD2iB,YAAAA,OAAO,GAAG9K,GAAG,CAACnxC,SAAJ,CAAc,CAAd,EAAiBmxC,GAAG,CAAC+K,WAAJ,CAAgB,GAAhB,CAAjB,CAAV;AACA;AACD;AACF;;AACD,YAAI,CAACD,OAAD,IAAYp3C,QAAQ,CAAC6mJ,aAAzB,EAAwC;AACtC,cAAIv6G,GAAG,GAAGtsC,QAAQ,CAAC6mJ,aAAT,CAAuBv6G,GAAjC;;AACA,cAAIA,GAAG,CAACxgD,OAAJ,CAAY,MAAZ,MAAwB,CAAC,CAA7B,EAAgC;AAC9B2oC,YAAAA,MAAM,GAAG,MAAT;AACD;;AACD2iB,UAAAA,OAAO,GAAG9K,GAAG,CAACnxC,SAAJ,CAAc,CAAd,EAAiBmxC,GAAG,CAAC+K,WAAJ,CAAgB,GAAhB,CAAjB,CAAV;AACD;AACF;;AACDjmD,MAAAA,IAAI,CAACgmD,OAAL,GAAe,IAAI0qG,GAAJ,CAAQuC,eAAR,EAAyB/sC,UAAzB,CAAoClgE,OAApC,CAAf;AACAhmD,MAAAA,IAAI,CAACizJ,eAAL,GAAuBA,eAAvB;AACAjzJ,MAAAA,IAAI,CAACozJ,OAAL,GAAe,IAAI1C,GAAJ,CAAQ1wJ,IAAI,CAACgmD,OAAb,CAAf;AACAhmD,MAAAA,IAAI,CAACqjC,MAAL,GAAcA,MAAd;AACA63C,MAAAA,OAAO,CAACl7E,IAAD,CAAP;AACD,KA1DoD;AA2DrDs6C,IAAAA,gBAAgB,EAAE,UAAUqmE,eAAV,EAA2B;AAC3C,UAAIt7D,OAAO,GAAGs7D,eAAe,CAACuyC,QAA9B;;AACA,UAAI7tG,OAAJ,EAAa;AACX,aAAK8tG,WAAL,CAAiB9tG,OAAjB;AACD;;AACD,UAAIhiB,MAAM,GAAGs9E,eAAe,CAACt9E,MAA7B;;AACA,UAAIs9E,eAAe,CAACt9E,MAApB,EAA4B;AAC1B,aAAKA,MAAL,GAAcA,MAAd;AACD;;AACD,WAAKs9E,eAAL,GAAuBA,eAAvB;AACA,UAAI+0C,cAAc,GAAG/0C,eAAe,CAACg1C,gBAArC;;AACA,UAAID,cAAc,KAAKz7J,SAAvB,EAAkC;AAChCyJ,QAAAA,MAAM,CAACgyJ,cAAD,EAAiB,UAAUE,aAAV,EAAyBnwG,UAAzB,EAAqC;AAC1DnB,UAAAA,YAAY,CAAC4B,aAAb,CAA2B91B,IAA3B,CAAgCq1B,UAAhC,IAA8CmwG,aAA9C;AACD,SAFK,CAAN;AAGD;AACF,KA3EoD;AA4ErD19G,IAAAA,IAAI,EAAE,UAAUnqB,QAAV,EAAoB;AACxB,UAAI/tB,IAAI,GAAG,IAAX;AACA,UAAI8rB,MAAJ;AACA,UAAI+pI,oBAAoB,GAAG1kJ,KAAK,CAAC9B,OAAN,CAAc,iGAAiG,gHAA/G,EAAiO,GAAjO,CAA3B;;AACA,UAAIymJ,qBAAqB,GAAG,UAAU/nI,QAAV,EAAoBvN,GAApB,EAAyB;AACnD,eAAOuN,QAAQ,CAACyR,MAAT,IAAmBhf,GAAG,CAAC7C,OAAJ,CAAY7U,WAAZ,MAA6B+sJ,oBAAvD;AACD,OAFD;;AAGA,UAAIE,QAAQ,GAAG,UAAUv1I,GAAV,EAAe;AAC5B,YAAIliB,EAAE,GAAGkiB,GAAG,CAACliB,EAAb;;AACA,YAAI,CAACA,EAAL,EAAS;AACPA,UAAAA,EAAE,GAAGmG,KAAK,CAAC+b,GAAD,EAAM,MAAN,CAAL,CAAmB/gB,MAAnB,CAA0B,UAAUlF,IAAV,EAAgB;AAC7C,mBAAO,CAACy5J,KAAK,CAAC5wJ,GAAN,CAAU7I,IAAV,CAAR;AACD,WAFI,EAEFuE,UAFE,CAESk1J,KAAK,CAACz0G,QAFf,CAAL;AAGA/+B,UAAAA,GAAG,CAAC7B,YAAJ,CAAiB,IAAjB,EAAuBrgB,EAAvB;AACD;;AACD,eAAOA,EAAP;AACD,OATD;;AAUA,UAAIugJ,YAAY,GAAG,UAAUtkJ,IAAV,EAAgB;AACjC,YAAI6K,QAAQ,GAAG2oB,QAAQ,CAACxzB,IAAD,CAAvB;;AACA,YAAI,CAAC6K,QAAL,EAAe;AACb;AACD;;AACD,eAAOA,QAAQ,CAACvI,KAAT,CAAemD,IAAf,EAAqB,EAArB,CAAP;AACD,OAND;;AAOA,UAAIk3C,QAAQ,GAAG,UAAU12B,GAAV,EAAesuB,SAAf,EAA0B;AACvC,eAAOA,SAAS,CAACx0C,WAAV,KAA0B+iC,MAA1B,GAAmCyR,SAAS,CAACxnC,IAAV,CAAekZ,GAAG,CAACsuB,SAAnB,CAAnC,GAAmEklH,KAAK,CAAC98G,QAAN,CAAe12B,GAAf,EAAoBsuB,SAApB,CAA1E;AACD,OAFD;;AAGA,UAAIknH,WAAW,GAAG,UAAUjoI,QAAV,EAAoB;AACpC,YAAIogD,OAAO,GAAG,EAAd;;AACA,YAAIjgE,GAAG,CAACjH,OAAJ,CAAY2E,IAAZ,MAAsBsC,GAAG,CAACjH,OAAJ,CAAYsC,OAAZ,CAAoBlB,KAApB,GAA4B,EAAtD,EAA0D;AACxDo9G,UAAAA,SAAS,CAAC,gFAAgF,qFAAjF,CAAT;AACA,iBAAO,EAAP;AACD,SAHD,MAGO,IAAIuvC,YAAJ,EAAkB;AACvBvvC,UAAAA,SAAS,CAAC,+EAA+E,kCAAhF,CAAT;AACA,iBAAO,EAAP;AACD;;AACD,YAAI13F,QAAQ,CAAC+pH,KAAb,EAAoB;AAClBoc,UAAAA,MAAM,CAACnmI,QAAQ,CAAC+pH,KAAV,EAAiB,UAAUr3I,IAAV,EAAgB;AACrC0tE,YAAAA,OAAO,GAAGA,OAAO,CAACzwE,MAAR,CAAes2J,KAAK,CAACxqH,MAAN,CAAa/oC,IAAI,CAACmT,QAAlB,CAAf,CAAV;AACD,WAFK,CAAN;AAGA,iBAAOu6D,OAAP;AACD,SALD,MAKO,IAAIpgD,QAAQ,CAACna,QAAb,EAAuB;AAC5B,iBAAOogJ,KAAK,CAACxqH,MAAN,CAAazb,QAAQ,CAACna,QAAtB,CAAP;AACD,SAFM,MAEA,IAAIma,QAAQ,CAACljB,MAAb,EAAqB;AAC1B,iBAAO,CAACkjB,QAAQ,CAACljB,MAAV,CAAP;AACD;;AACD,gBAAQkjB,QAAQ,CAACwN,IAAjB;AACA,eAAK,OAAL;AACE,gBAAIv2B,CAAC,GAAG+oB,QAAQ,CAACxX,QAAT,IAAqB,EAA7B;;AACA,gBAAIvR,CAAC,CAACvJ,MAAF,GAAW,CAAf,EAAkB;AAChBy4J,cAAAA,MAAM,CAACD,SAAS,CAACjvJ,CAAD,CAAV,EAAe,UAAU1G,EAAV,EAAc;AACjC,oBAAIkiB,GAAG,GAAGwzI,KAAK,CAAC5wJ,GAAN,CAAU9E,EAAV,CAAV;;AACA,oBAAIkiB,GAAJ,EAAS;AACP2tD,kBAAAA,OAAO,CAAC1sE,IAAR,CAAa+e,GAAb;AACD,iBAFD,MAEO;AACL0zI,kBAAAA,MAAM,CAACtlJ,QAAQ,CAACqnJ,KAAV,EAAiB,UAAU96J,CAAV,EAAa;AAClC+4J,oBAAAA,MAAM,CAAC/4J,CAAC,CAACob,QAAH,EAAa,UAAUjQ,CAAV,EAAa;AAC9B,0BAAIA,CAAC,CAAC/L,IAAF,KAAW+D,EAAf,EAAmB;AACjBA,wBAAAA,EAAE,GAAG,gBAAgB81J,eAAe,EAApC;AACAJ,wBAAAA,KAAK,CAACz3G,SAAN,CAAgBj2C,CAAhB,EAAmB,IAAnB,EAAyBhI,EAAzB;AACA6vE,wBAAAA,OAAO,CAAC1sE,IAAR,CAAa6E,CAAb;AACD;AACF,qBANK,CAAN;AAOD,mBARK,CAAN;AASD;AACF,eAfK,CAAN;AAgBD;;AACD;;AACF,eAAK,WAAL;AACA,eAAK,oBAAL;AACE4tJ,YAAAA,MAAM,CAACF,KAAK,CAACxqH,MAAN,CAAa,UAAb,CAAD,EAA2B,UAAUhpB,GAAV,EAAe;AAC9C,kBAAIuN,QAAQ,CAACmoI,iBAAT,IAA8Bh/G,QAAQ,CAAC12B,GAAD,EAAMuN,QAAQ,CAACmoI,iBAAf,CAA1C,EAA6E;AAC3E;AACD;;AACD,kBAAI,CAACnoI,QAAQ,CAACooI,eAAV,IAA6Bj/G,QAAQ,CAAC12B,GAAD,EAAMuN,QAAQ,CAACooI,eAAf,CAAzC,EAA0E;AACxEhoF,gBAAAA,OAAO,CAAC1sE,IAAR,CAAa+e,GAAb;AACD;AACF,aAPK,CAAN;AAQA;AAhCF;;AAkCA,eAAO2tD,OAAP;AACD,OAtDD;;AAuDA,UAAIioF,cAAc,GAAG,UAAUzK,OAAV,EAAmB;AACtC7/H,QAAAA,MAAM,GAAG6/H,OAAT;AACD,OAFD;;AAGA,UAAI0K,WAAW,GAAG,YAAY;AAC5B,YAAIC,SAAS,GAAG,CAAhB;AACA,YAAI3K,OAAO,GAAG,EAAd;AACA,YAAIx9E,OAAJ;;AACA,YAAIooF,YAAY,GAAG,UAAUj4J,EAAV,EAAcyvB,QAAd,EAAwBshD,SAAxB,EAAmC;AACpD,cAAI5hD,MAAM,GAAG,IAAIqlI,MAAJ,CAAWx0J,EAAX,EAAeyvB,QAAf,EAAyB/tB,IAAzB,CAAb;AACA2rJ,UAAAA,OAAO,CAAClqJ,IAAR,CAAagsB,MAAb;AACAA,UAAAA,MAAM,CAAClK,EAAP,CAAU,MAAV,EAAkB,YAAY;AAC5B,gBAAI,EAAE+yI,SAAF,KAAgBnoF,OAAO,CAAC1yE,MAA5B,EAAoC;AAClC26J,cAAAA,cAAc,CAACzK,OAAD,CAAd;AACD;AACF,WAJD;AAKAl+H,UAAAA,MAAM,CAAC4hD,SAAP,GAAmB5hD,MAAM,CAAC4hD,SAAP,IAAoBA,SAAvC;AACA5hD,UAAAA,MAAM,CAACw3H,MAAP;AACD,SAVD;;AAWA+O,QAAAA,KAAK,CAACvrH,MAAN,CAAan7B,MAAb,EAAqB,OAArB,EAA8B+oJ,WAA9B;AACAxX,QAAAA,YAAY,CAAC,YAAD,CAAZ;AACA1wE,QAAAA,OAAO,GAAGn3B,QAAQ,CAACuB,MAAT,CAAgBy9G,WAAW,CAACjoI,QAAD,CAA3B,CAAV;;AACA,YAAIA,QAAQ,CAAC+pH,KAAb,EAAoB;AAClBoc,UAAAA,MAAM,CAACnmI,QAAQ,CAAC+pH,KAAV,EAAiB,UAAUr3I,IAAV,EAAgB;AACrC0Q,YAAAA,KAAK,CAAC9R,IAAN,CAAW8uE,OAAX,EAAoB,UAAU3tD,GAAV,EAAe;AACjC,kBAAIwzI,KAAK,CAACr1J,EAAN,CAAS6hB,GAAT,EAAc/f,IAAI,CAACmT,QAAnB,CAAJ,EAAkC;AAChC2iJ,gBAAAA,YAAY,CAACR,QAAQ,CAACv1I,GAAD,CAAT,EAAgB2zI,QAAQ,CAAC,EAAD,EAAKpmI,QAAL,EAAettB,IAAf,CAAxB,EAA8C+f,GAA9C,CAAZ;AACA,uBAAO,KAAP;AACD;;AACD,qBAAO,IAAP;AACD,aAND;AAOD,WARK,CAAN;AASA;AACD;;AACDrP,QAAAA,KAAK,CAAC9R,IAAN,CAAW8uE,OAAX,EAAoB,UAAU3tD,GAAV,EAAe;AACjCu0I,UAAAA,oBAAoB,CAAC/0J,IAAI,CAACoD,GAAL,CAASod,GAAG,CAACliB,EAAb,CAAD,CAApB;AACD,SAFD;AAGA6vE,QAAAA,OAAO,GAAGh9D,KAAK,CAACC,IAAN,CAAW+8D,OAAX,EAAoB,UAAU3tD,GAAV,EAAe;AAC3C,iBAAO,CAACxgB,IAAI,CAACoD,GAAL,CAASod,GAAG,CAACliB,EAAb,CAAR;AACD,SAFS,CAAV;;AAGA,YAAI6vE,OAAO,CAAC1yE,MAAR,KAAmB,CAAvB,EAA0B;AACxB26J,UAAAA,cAAc,CAAC,EAAD,CAAd;AACD,SAFD,MAEO;AACLlC,UAAAA,MAAM,CAAC/lF,OAAD,EAAU,UAAU3tD,GAAV,EAAe;AAC7B,gBAAIs1I,qBAAqB,CAAC/nI,QAAD,EAAWvN,GAAX,CAAzB,EAA0C;AACxCilG,cAAAA,SAAS,CAAC,qEAAD,EAAwEjlG,GAAxE,CAAT;AACD,aAFD,MAEO;AACL+1I,cAAAA,YAAY,CAACR,QAAQ,CAACv1I,GAAD,CAAT,EAAgBuN,QAAhB,EAA0BvN,GAA1B,CAAZ;AACD;AACF,WANK,CAAN;AAOD;AACF,OA/CD;;AAgDAxgB,MAAAA,IAAI,CAAC+tB,QAAL,GAAgBA,QAAhB;AACAimI,MAAAA,KAAK,CAAC10J,IAAN,CAAWgO,MAAX,EAAmB,OAAnB,EAA4B+oJ,WAA5B;AACA,aAAO,IAAI5pI,UAAJ,CAAe,UAAUjc,OAAV,EAAmB;AACvC,YAAIsb,MAAJ,EAAY;AACVtb,UAAAA,OAAO,CAACsb,MAAD,CAAP;AACD,SAFD,MAEO;AACLsqI,UAAAA,cAAc,GAAG,UAAUzK,OAAV,EAAmB;AAClCn7I,YAAAA,OAAO,CAACm7I,OAAD,CAAP;AACD,WAFD;AAGD;AACF,OARM,CAAP;AASD,KA5NoD;AA6NrDvoJ,IAAAA,GAAG,EAAE,UAAU9E,EAAV,EAAc;AACjB,UAAI1B,SAAS,CAACnB,MAAV,KAAqB,CAAzB,EAA4B;AAC1B,eAAOkwJ,OAAO,CAAC5wJ,KAAR,CAAc,CAAd,CAAP;AACD,OAFD,MAEO,IAAI6F,QAAQ,CAACtC,EAAD,CAAZ,EAAkB;AACvB,eAAOmE,IAAI,CAACkpJ,OAAD,EAAU,UAAUl+H,MAAV,EAAkB;AACrC,iBAAOA,MAAM,CAACnvB,EAAP,KAAcA,EAArB;AACD,SAFU,CAAJ,CAEJO,KAFI,CAEE,IAFF,CAAP;AAGD,OAJM,MAIA,IAAIwC,QAAQ,CAAC/C,EAAD,CAAZ,EAAkB;AACvB,eAAOqtJ,OAAO,CAACrtJ,EAAD,CAAP,GAAcqtJ,OAAO,CAACrtJ,EAAD,CAArB,GAA4B,IAAnC;AACD,OAFM,MAEA;AACL,eAAO,IAAP;AACD;AACF,KAzOoD;AA0OrDw8B,IAAAA,GAAG,EAAE,UAAUrN,MAAV,EAAkB;AACrB,UAAIztB,IAAI,GAAG,IAAX;AACA,UAAIw2J,cAAc,GAAGjC,aAAa,CAAC9mI,MAAM,CAACnvB,EAAR,CAAlC;;AACA,UAAIk4J,cAAc,KAAK/oI,MAAvB,EAA+B;AAC7B,eAAOA,MAAP;AACD;;AACD,UAAIztB,IAAI,CAACoD,GAAL,CAASqqB,MAAM,CAACnvB,EAAhB,MAAwB,IAA5B,EAAkC;AAChC,YAAIk2J,gBAAgB,CAAC/mI,MAAM,CAACnvB,EAAR,CAApB,EAAiC;AAC/Bi2J,UAAAA,aAAa,CAAC9mI,MAAM,CAACnvB,EAAR,CAAb,GAA2BmvB,MAA3B;AACD;;AACD8mI,QAAAA,aAAa,CAAC9yJ,IAAd,CAAmBgsB,MAAnB;AACAk+H,QAAAA,OAAO,CAAClqJ,IAAR,CAAagsB,MAAb;AACD;;AACDknI,MAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACA30J,MAAAA,IAAI,CAACg7E,YAAL,GAAoBvtD,MAApB;AACAztB,MAAAA,IAAI,CAAC4oC,IAAL,CAAU,WAAV,EAAuB;AAAEnb,QAAAA,MAAM,EAAEA;AAAV,OAAvB;;AACA,UAAI,CAAC6mI,oBAAL,EAA2B;AACzBA,QAAAA,oBAAoB,GAAG,UAAUhuJ,CAAV,EAAa;AAClC,cAAIyR,KAAK,GAAG/X,IAAI,CAAC4oC,IAAL,CAAU,cAAV,CAAZ;;AACA,cAAI7wB,KAAK,CAACmtB,WAAV,EAAuB;AACrB5+B,YAAAA,CAAC,CAACqgC,cAAF;AACArgC,YAAAA,CAAC,CAAC4+B,WAAF,GAAgBntB,KAAK,CAACmtB,WAAtB;AACA,mBAAOntB,KAAK,CAACmtB,WAAb;AACD;AACF,SAPD;;AAQA53B,QAAAA,MAAM,CAACu4B,gBAAP,CAAwB,cAAxB,EAAwCyuH,oBAAxC;AACD;;AACD,aAAO7mI,MAAP;AACD,KAtQoD;AAuQrD8oI,IAAAA,YAAY,EAAE,UAAUj4J,EAAV,EAAcyvB,QAAd,EAAwB;AACpC,aAAO,KAAK+M,GAAL,CAAS,IAAIg4H,MAAJ,CAAWx0J,EAAX,EAAeyvB,QAAf,EAAyB,IAAzB,CAAT,CAAP;AACD,KAzQoD;AA0QrDzU,IAAAA,MAAM,EAAE,UAAU1F,QAAV,EAAoB;AAC1B,UAAI5T,IAAI,GAAG,IAAX;AACA,UAAIrE,CAAJ,EAAO8xB,MAAP;;AACA,UAAI,CAAC7Z,QAAL,EAAe;AACb,aAAKjY,CAAC,GAAGgwJ,OAAO,CAAClwJ,MAAR,GAAiB,CAA1B,EAA6BE,CAAC,IAAI,CAAlC,EAAqCA,CAAC,EAAtC,EAA0C;AACxCqE,UAAAA,IAAI,CAACsZ,MAAL,CAAYqyI,OAAO,CAAChwJ,CAAD,CAAnB;AACD;;AACD;AACD;;AACD,UAAIiF,QAAQ,CAACgT,QAAD,CAAZ,EAAwB;AACtBsgJ,QAAAA,MAAM,CAACF,KAAK,CAACxqH,MAAN,CAAa51B,QAAb,CAAD,EAAyB,UAAU4M,GAAV,EAAe;AAC5CiN,UAAAA,MAAM,GAAGztB,IAAI,CAACoD,GAAL,CAASod,GAAG,CAACliB,EAAb,CAAT;;AACA,cAAImvB,MAAJ,EAAY;AACVztB,YAAAA,IAAI,CAACsZ,MAAL,CAAYmU,MAAZ;AACD;AACF,SALK,CAAN;AAMA;AACD;;AACDA,MAAAA,MAAM,GAAG7Z,QAAT;;AACA,UAAI7S,MAAM,CAACf,IAAI,CAACoD,GAAL,CAASqqB,MAAM,CAACnvB,EAAhB,CAAD,CAAV,EAAiC;AAC/B,eAAO,IAAP;AACD;;AACD,UAAIs2J,oBAAoB,CAACnnI,MAAD,CAAxB,EAAkC;AAChCztB,QAAAA,IAAI,CAAC4oC,IAAL,CAAU,cAAV,EAA0B;AAAEnb,UAAAA,MAAM,EAAEA;AAAV,SAA1B;AACD;;AACD,UAAIk+H,OAAO,CAAClwJ,MAAR,KAAmB,CAAvB,EAA0B;AACxB6R,QAAAA,MAAM,CAAC04B,mBAAP,CAA2B,cAA3B,EAA2CsuH,oBAA3C;AACD;;AACD7mI,MAAAA,MAAM,CAACnU,MAAP;AACAq7I,MAAAA,kBAAkB,CAAChJ,OAAO,CAAClwJ,MAAR,GAAiB,CAAlB,CAAlB;AACA,aAAOgyB,MAAP;AACD,KAzSoD;AA0SrD6iD,IAAAA,WAAW,EAAE,UAAUigD,GAAV,EAAewuB,EAAf,EAAmB5hJ,KAAnB,EAA0B;AACrC,UAAI6C,IAAI,GAAG,IAAX;AAAA,UAAiBytB,MAAM,GAAGztB,IAAI,CAACoD,GAAL,CAASjG,KAAT,CAA1B;;AACA,cAAQozH,GAAR;AACA,aAAK,cAAL;AACE,cAAI,CAACvwH,IAAI,CAACoD,GAAL,CAASjG,KAAT,CAAL,EAAsB;AACpB,gBAAI21J,MAAJ,CAAW31J,KAAX,EAAkB6C,IAAI,CAAC+tB,QAAvB,EAAiC/tB,IAAjC,EAAuCilJ,MAAvC;AACD;;AACD,iBAAO,IAAP;;AACF,aAAK,iBAAL;AACE,cAAIx3H,MAAJ,EAAY;AACVA,YAAAA,MAAM,CAACnU,MAAP;AACD;;AACD,iBAAO,IAAP;;AACF,aAAK,iBAAL;AACE,cAAI,CAACmU,MAAL,EAAa;AACXztB,YAAAA,IAAI,CAACswE,WAAL,CAAiB,cAAjB,EAAiC,KAAjC,EAAwCnzE,KAAxC;AACA,mBAAO,IAAP;AACD;;AACD,cAAIswB,MAAM,CAAC6xB,QAAP,EAAJ,EAAuB;AACrB7xB,YAAAA,MAAM,CAACksB,IAAP;AACD,WAFD,MAEO;AACLlsB,YAAAA,MAAM,CAACmsB,IAAP;AACD;;AACD,iBAAO,IAAP;AArBF;;AAuBA,UAAI55C,IAAI,CAACg7E,YAAT,EAAuB;AACrB,eAAOh7E,IAAI,CAACg7E,YAAL,CAAkB1K,WAAlB,CAA8BigD,GAA9B,EAAmCwuB,EAAnC,EAAuC5hJ,KAAvC,CAAP;AACD;;AACD,aAAO,KAAP;AACD,KAvUoD;AAwUrDioJ,IAAAA,WAAW,EAAE,YAAY;AACvB8O,MAAAA,MAAM,CAACvI,OAAD,EAAU,UAAUl+H,MAAV,EAAkB;AAChCA,QAAAA,MAAM,CAACyuF,IAAP;AACD,OAFK,CAAN;AAGD,KA5UoD;AA6UrDu6C,IAAAA,OAAO,EAAE,UAAU30I,IAAV,EAAgBxS,KAAhB,EAAuB;AAC9B+0C,MAAAA,IAAI,CAACvpB,GAAL,CAAShZ,IAAT,EAAexS,KAAf;AACD,KA/UoD;AAgVrDwK,IAAAA,SAAS,EAAE,UAAUvH,IAAV,EAAgB;AACzB,aAAO8xC,IAAI,CAACvqC,SAAL,CAAevH,IAAf,CAAP;AACD,KAlVoD;AAmVrDuoE,IAAAA,SAAS,EAAE,UAAUrtD,MAAV,EAAkB;AAC3B,UAAIutD,YAAY,GAAG,KAAKA,YAAxB;;AACA,UAAI,KAAKA,YAAL,KAAsBvtD,MAA1B,EAAkC;AAChC,YAAIutD,YAAJ,EAAkB;AAChBA,UAAAA,YAAY,CAACpyC,IAAb,CAAkB,YAAlB,EAAgC;AAAEJ,YAAAA,aAAa,EAAE/a;AAAjB,WAAhC;AACD;;AACDA,QAAAA,MAAM,CAACmb,IAAP,CAAY,UAAZ,EAAwB;AAAEJ,UAAAA,aAAa,EAAEwyC;AAAjB,SAAxB;AACD;;AACD,WAAKA,YAAL,GAAoBvtD,MAApB;AACD,KA5VoD;AA6VrD0lI,IAAAA,WAAW,EAAE,UAAU9tG,OAAV,EAAmB;AAC9B,WAAKW,OAAL,GAAe,IAAI0qG,GAAJ,CAAQ,KAAKuC,eAAb,EAA8B/sC,UAA9B,CAAyC7gE,OAAO,CAAC58C,OAAR,CAAgB,MAAhB,EAAwB,EAAxB,CAAzC,CAAf;AACA,WAAK2qJ,OAAL,GAAe,IAAI1C,GAAJ,CAAQ,KAAK1qG,OAAb,CAAf;AACD;AAhWoD,GAA3B,CAA5B;;AAkWA0uG,EAAAA,aAAa,CAAClsG,KAAd;AAEA,MAAIiE,GAAG,GAAGtwC,IAAI,CAACswC,GAAf;AAAA,MAAoBrwC,GAAG,GAAGD,IAAI,CAACC,GAA/B;AAAA,MAAoCs6I,OAAO,GAAGv6I,IAAI,CAAC4vC,KAAnD;;AACA,MAAI4qG,gBAAgB,GAAG,UAAU1qG,IAAV,EAAgBq2E,UAAhB,EAA4BtyG,GAA5B,EAAiC;AACtD,QAAIh2B,CAAC,GAAGsoI,UAAU,CAACtoI,CAAnB;AACA,QAAIqB,CAAC,GAAGinI,UAAU,CAACjnI,CAAnB;AACA,QAAI4hD,CAAC,GAAGgP,IAAI,CAAChP,CAAb;AACA,QAAIC,CAAC,GAAG+O,IAAI,CAAC/O,CAAb;AACA,QAAI05G,OAAO,GAAGt0B,UAAU,CAACrlF,CAAzB;AACA,QAAI45G,OAAO,GAAGv0B,UAAU,CAACplF,CAAzB;AACA,QAAI45G,QAAQ,GAAG,CAAC9mI,GAAG,IAAI,EAAR,EAAYxgB,KAAZ,CAAkB,EAAlB,CAAf;;AACA,QAAIsnJ,QAAQ,CAAC,CAAD,CAAR,KAAgB,GAApB,EAAyB;AACvBz7J,MAAAA,CAAC,IAAIw7J,OAAL;AACD;;AACD,QAAIC,QAAQ,CAAC,CAAD,CAAR,KAAgB,GAApB,EAAyB;AACvB98J,MAAAA,CAAC,IAAI48J,OAAL;AACD;;AACD,QAAIE,QAAQ,CAAC,CAAD,CAAR,KAAgB,GAApB,EAAyB;AACvBz7J,MAAAA,CAAC,IAAIq7J,OAAO,CAACG,OAAO,GAAG,CAAX,CAAZ;AACD;;AACD,QAAIC,QAAQ,CAAC,CAAD,CAAR,KAAgB,GAApB,EAAyB;AACvB98J,MAAAA,CAAC,IAAI08J,OAAO,CAACE,OAAO,GAAG,CAAX,CAAZ;AACD;;AACD,QAAIE,QAAQ,CAAC,CAAD,CAAR,KAAgB,GAApB,EAAyB;AACvBz7J,MAAAA,CAAC,IAAI6hD,CAAL;AACD;;AACD,QAAI45G,QAAQ,CAAC,CAAD,CAAR,KAAgB,GAApB,EAAyB;AACvB98J,MAAAA,CAAC,IAAIijD,CAAL;AACD;;AACD,QAAI65G,QAAQ,CAAC,CAAD,CAAR,KAAgB,GAApB,EAAyB;AACvBz7J,MAAAA,CAAC,IAAIq7J,OAAO,CAACx5G,CAAC,GAAG,CAAL,CAAZ;AACD;;AACD,QAAI45G,QAAQ,CAAC,CAAD,CAAR,KAAgB,GAApB,EAAyB;AACvB98J,MAAAA,CAAC,IAAI08J,OAAO,CAACz5G,CAAC,GAAG,CAAL,CAAZ;AACD;;AACD,WAAO85G,QAAQ,CAAC/8J,CAAD,EAAIqB,CAAJ,EAAO4hD,CAAP,EAAUC,CAAV,CAAf;AACD,GAjCD;;AAkCA,MAAI85G,wBAAwB,GAAG,UAAU/qG,IAAV,EAAgBq2E,UAAhB,EAA4B20B,aAA5B,EAA2CC,IAA3C,EAAiD;AAC9E,QAAIh2I,GAAJ,EAASvlB,CAAT;;AACA,SAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGu7J,IAAI,CAACz7J,MAArB,EAA6BE,CAAC,EAA9B,EAAkC;AAChCulB,MAAAA,GAAG,GAAGy1I,gBAAgB,CAAC1qG,IAAD,EAAOq2E,UAAP,EAAmB40B,IAAI,CAACv7J,CAAD,CAAvB,CAAtB;;AACA,UAAIulB,GAAG,CAAClnB,CAAJ,IAASi9J,aAAa,CAACj9J,CAAvB,IAA4BknB,GAAG,CAAClnB,CAAJ,GAAQknB,GAAG,CAAC+7B,CAAZ,IAAiBg6G,aAAa,CAACh6G,CAAd,GAAkBg6G,aAAa,CAACj9J,CAA7E,IAAkFknB,GAAG,CAAC7lB,CAAJ,IAAS47J,aAAa,CAAC57J,CAAzG,IAA8G6lB,GAAG,CAAC7lB,CAAJ,GAAQ6lB,GAAG,CAACg8B,CAAZ,IAAiB+5G,aAAa,CAAC/5G,CAAd,GAAkB+5G,aAAa,CAAC57J,CAAnK,EAAsK;AACpK,eAAO67J,IAAI,CAACv7J,CAAD,CAAX;AACD;AACF;;AACD,WAAO,IAAP;AACD,GATD;;AAUA,MAAIw7J,OAAO,GAAG,UAAUlrG,IAAV,EAAgBhP,CAAhB,EAAmBC,CAAnB,EAAsB;AAClC,WAAO65G,QAAQ,CAAC9qG,IAAI,CAACjyD,CAAL,GAASijD,CAAV,EAAagP,IAAI,CAAC5wD,CAAL,GAAS6hD,CAAtB,EAAyB+O,IAAI,CAAChP,CAAL,GAASA,CAAC,GAAG,CAAtC,EAAyCgP,IAAI,CAAC/O,CAAL,GAASA,CAAC,GAAG,CAAtD,CAAf;AACD,GAFD;;AAGA,MAAIk6G,SAAS,GAAG,UAAUnrG,IAAV,EAAgBorG,QAAhB,EAA0B;AACxC,QAAIC,EAAE,GAAGl7I,GAAG,CAAC6vC,IAAI,CAACjyD,CAAN,EAASq9J,QAAQ,CAACr9J,CAAlB,CAAZ;AACA,QAAIu9J,EAAE,GAAGn7I,GAAG,CAAC6vC,IAAI,CAAC5wD,CAAN,EAASg8J,QAAQ,CAACh8J,CAAlB,CAAZ;AACA,QAAIknG,EAAE,GAAG91C,GAAG,CAACR,IAAI,CAACjyD,CAAL,GAASiyD,IAAI,CAAChP,CAAf,EAAkBo6G,QAAQ,CAACr9J,CAAT,GAAaq9J,QAAQ,CAACp6G,CAAxC,CAAZ;AACA,QAAIqlD,EAAE,GAAG71C,GAAG,CAACR,IAAI,CAAC5wD,CAAL,GAAS4wD,IAAI,CAAC/O,CAAf,EAAkBm6G,QAAQ,CAACh8J,CAAT,GAAag8J,QAAQ,CAACn6G,CAAxC,CAAZ;;AACA,QAAIqlD,EAAE,GAAG+0D,EAAL,GAAU,CAAV,IAAeh1D,EAAE,GAAGi1D,EAAL,GAAU,CAA7B,EAAgC;AAC9B,aAAO,IAAP;AACD;;AACD,WAAOR,QAAQ,CAACO,EAAD,EAAKC,EAAL,EAASh1D,EAAE,GAAG+0D,EAAd,EAAkBh1D,EAAE,GAAGi1D,EAAvB,CAAf;AACD,GATD;;AAUA,MAAIC,OAAO,GAAG,UAAUvrG,IAAV,EAAgBwrG,SAAhB,EAA2BC,SAA3B,EAAsC;AAClD,QAAIJ,EAAE,GAAGrrG,IAAI,CAACjyD,CAAd;AACA,QAAIu9J,EAAE,GAAGtrG,IAAI,CAAC5wD,CAAd;AACA,QAAIknG,EAAE,GAAGt2C,IAAI,CAACjyD,CAAL,GAASiyD,IAAI,CAAChP,CAAvB;AACA,QAAIqlD,EAAE,GAAGr2C,IAAI,CAAC5wD,CAAL,GAAS4wD,IAAI,CAAC/O,CAAvB;AACA,QAAIy6G,GAAG,GAAGF,SAAS,CAACz9J,CAAV,GAAcy9J,SAAS,CAACx6G,CAAlC;AACA,QAAI26G,GAAG,GAAGH,SAAS,CAACp8J,CAAV,GAAco8J,SAAS,CAACv6G,CAAlC;AACA,QAAI26G,WAAW,GAAGz7I,GAAG,CAAC,CAAD,EAAIq7I,SAAS,CAACz9J,CAAV,GAAcs9J,EAAlB,CAArB;AACA,QAAIQ,WAAW,GAAG17I,GAAG,CAAC,CAAD,EAAIq7I,SAAS,CAACp8J,CAAV,GAAck8J,EAAlB,CAArB;AACA,QAAIQ,UAAU,GAAG37I,GAAG,CAAC,CAAD,EAAImmF,EAAE,GAAGo1D,GAAT,CAApB;AACA,QAAIK,UAAU,GAAG57I,GAAG,CAAC,CAAD,EAAIkmF,EAAE,GAAGs1D,GAAT,CAApB;AACAN,IAAAA,EAAE,IAAIO,WAAN;AACAN,IAAAA,EAAE,IAAIO,WAAN;;AACA,QAAIJ,SAAJ,EAAe;AACbn1D,MAAAA,EAAE,IAAIs1D,WAAN;AACAv1D,MAAAA,EAAE,IAAIw1D,WAAN;AACAR,MAAAA,EAAE,IAAIS,UAAN;AACAR,MAAAA,EAAE,IAAIS,UAAN;AACD;;AACDz1D,IAAAA,EAAE,IAAIw1D,UAAN;AACAz1D,IAAAA,EAAE,IAAI01D,UAAN;AACA,WAAOjB,QAAQ,CAACO,EAAD,EAAKC,EAAL,EAASh1D,EAAE,GAAG+0D,EAAd,EAAkBh1D,EAAE,GAAGi1D,EAAvB,CAAf;AACD,GAtBD;;AAuBA,MAAIR,QAAQ,GAAG,UAAU/8J,CAAV,EAAaqB,CAAb,EAAgB4hD,CAAhB,EAAmBC,CAAnB,EAAsB;AACnC,WAAO;AACLljD,MAAAA,CAAC,EAAEA,CADE;AAELqB,MAAAA,CAAC,EAAEA,CAFE;AAGL4hD,MAAAA,CAAC,EAAEA,CAHE;AAILC,MAAAA,CAAC,EAAEA;AAJE,KAAP;AAMD,GAPD;;AAQA,MAAI+6G,cAAc,GAAG,UAAU9pG,UAAV,EAAsB;AACzC,WAAO4oG,QAAQ,CAAC5oG,UAAU,CAACv0C,IAAZ,EAAkBu0C,UAAU,CAACt0C,GAA7B,EAAkCs0C,UAAU,CAACzyC,KAA7C,EAAoDyyC,UAAU,CAACxyC,MAA/D,CAAf;AACD,GAFD;;AAGA,MAAIu8I,IAAI,GAAG;AACTf,IAAAA,OAAO,EAAEA,OADA;AAETR,IAAAA,gBAAgB,EAAEA,gBAFT;AAGTK,IAAAA,wBAAwB,EAAEA,wBAHjB;AAITI,IAAAA,SAAS,EAAEA,SAJF;AAKTx+E,IAAAA,KAAK,EAAE4+E,OALE;AAMT7nJ,IAAAA,MAAM,EAAEonJ,QANC;AAOTkB,IAAAA,cAAc,EAAEA;AAPP,GAAX;;AAUA,MAAIE,OAAO,GAAG,UAAUC,SAAV,EAAqBC,QAArB,EAA+Bt1I,OAA/B,EAAwC;AACpD,QAAIA,OAAO,KAAK,KAAK,CAArB,EAAwB;AACtBA,MAAAA,OAAO,GAAG,IAAV;AACD;;AACD,QAAI4C,IAAI,GAAG,KAAX;AACA,QAAI0H,KAAK,GAAG,IAAZ;;AACA,QAAIirI,QAAQ,GAAG,UAAUC,SAAV,EAAqB;AAClC,aAAO,YAAY;AACjB,YAAI77J,IAAI,GAAG,EAAX;;AACA,aAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CD,UAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWC,SAAS,CAACD,EAAD,CAApB;AACD;;AACD,YAAI,CAACgpB,IAAL,EAAW;AACTA,UAAAA,IAAI,GAAG,IAAP;;AACA,cAAI0H,KAAK,KAAK,IAAd,EAAoB;AAClBhL,YAAAA,YAAY,CAACgL,KAAD,CAAZ;AACAA,YAAAA,KAAK,GAAG,IAAR;AACD;;AACDkrI,UAAAA,SAAS,CAAC17J,KAAV,CAAgB,IAAhB,EAAsBH,IAAtB;AACD;AACF,OAbD;AAcD,KAfD;;AAgBA,QAAI8T,OAAO,GAAG8nJ,QAAQ,CAACF,SAAD,CAAtB;AACA,QAAIhzI,MAAM,GAAGkzI,QAAQ,CAACD,QAAD,CAArB;;AACA,QAAInuJ,KAAK,GAAG,YAAY;AACtB,UAAIxN,IAAI,GAAG,EAAX;;AACA,WAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACnB,MAAhC,EAAwCkB,EAAE,EAA1C,EAA8C;AAC5CD,QAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWC,SAAS,CAACD,EAAD,CAApB;AACD;;AACD,UAAI,CAACgpB,IAAD,IAAS0H,KAAK,KAAK,IAAvB,EAA6B;AAC3BA,QAAAA,KAAK,GAAGjL,UAAU,CAAC,YAAY;AAC7B,iBAAOgD,MAAM,CAACvoB,KAAP,CAAa,IAAb,EAAmBH,IAAnB,CAAP;AACD,SAFiB,EAEfqmB,OAFe,CAAlB;AAGD;AACF,KAVD;;AAWA,WAAO;AACL7Y,MAAAA,KAAK,EAAEA,KADF;AAELsG,MAAAA,OAAO,EAAEA,OAFJ;AAGL4U,MAAAA,MAAM,EAAEA;AAHH,KAAP;AAKD,GAxCD;;AAyCA,MAAIozI,QAAQ,GAAG,YAAY;AACzB,QAAIC,KAAK,GAAG,EAAZ;AACA,QAAIC,SAAS,GAAG,EAAhB;;AACA,QAAI9pI,IAAI,GAAG,UAAUtwB,EAAV,EAAc4S,GAAd,EAAmB;AAC5B,UAAIynJ,UAAU,GAAG,oBAAoBznJ,GAApB,GAA0B,kBAA3C;AACA,UAAI0nJ,SAAS,GAAG,oBAAoB1nJ,GAApB,GAA0B,yCAA1B,GAAsE5S,EAAtE,GAA2E,4BAA3F;;AACA,UAAIm6J,KAAK,CAACn6J,EAAD,CAAL,KAAcrE,SAAlB,EAA6B;AAC3B,eAAOw+J,KAAK,CAACn6J,EAAD,CAAZ;AACD,OAFD,MAEO;AACL,YAAIu6J,IAAI,GAAG,IAAIpsI,UAAJ,CAAe,UAAUjc,OAAV,EAAmB4U,MAAnB,EAA2B;AACnD,cAAI0zI,MAAM,GAAGX,OAAO,CAAC3nJ,OAAD,EAAU4U,MAAV,CAApB;AACAszI,UAAAA,SAAS,CAACp6J,EAAD,CAAT,GAAgBw6J,MAAM,CAACtoJ,OAAvB;AACAwxC,UAAAA,YAAY,CAACA,YAAb,CAA0BK,UAA1B,CAAqCnxC,GAArC,EAA0C,YAAY;AACpD,mBAAO4nJ,MAAM,CAAC5uJ,KAAP,CAAa0uJ,SAAb,CAAP;AACD,WAFD,EAEG,YAAY;AACb,mBAAOE,MAAM,CAAC1zI,MAAP,CAAcuzI,UAAd,CAAP;AACD,WAJD;AAKD,SARU,CAAX;AASAF,QAAAA,KAAK,CAACn6J,EAAD,CAAL,GAAYu6J,IAAZ;AACA,eAAOA,IAAP;AACD;AACF,KAlBD;;AAmBA,QAAI/9H,GAAG,GAAG,UAAUx8B,EAAV,EAAc2pB,IAAd,EAAoB;AAC5B,UAAIywI,SAAS,CAACp6J,EAAD,CAAT,KAAkBrE,SAAtB,EAAiC;AAC/By+J,QAAAA,SAAS,CAACp6J,EAAD,CAAT,CAAc2pB,IAAd;AACA,eAAOywI,SAAS,CAACp6J,EAAD,CAAhB;AACD;;AACDm6J,MAAAA,KAAK,CAACn6J,EAAD,CAAL,GAAYmuB,UAAU,CAACjc,OAAX,CAAmByX,IAAnB,CAAZ;AACD,KAND;;AAOA,WAAO;AACL2G,MAAAA,IAAI,EAAEA,IADD;AAELkM,MAAAA,GAAG,EAAEA;AAFA,KAAP;AAID,GAjCD;;AAkCA,MAAIi+H,QAAQ,GAAGP,QAAQ,EAAvB;AAEA,MAAIQ,MAAM,GAAG7nJ,KAAK,CAAC9R,IAAnB;AAAA,MAAyB45J,QAAQ,GAAG9nJ,KAAK,CAACZ,MAA1C;AACA,MAAI2oJ,WAAJ,EAAiBC,YAAjB;;AACA,MAAIC,KAAK,GAAG,YAAY,CACvB,CADD;;AAEAA,EAAAA,KAAK,CAAC7oJ,MAAN,GAAe2oJ,WAAW,GAAG,UAAUt1J,KAAV,EAAiB;AAC5C,QAAI5D,IAAI,GAAG,IAAX;AACA,QAAIq5J,MAAM,GAAGr5J,IAAI,CAAC5F,SAAlB;;AACA,QAAIg/J,KAAK,GAAG,YAAY;AACtB,UAAIz9J,CAAJ,EAAO29J,MAAP,EAAeC,KAAf;AACA,UAAIv5J,IAAI,GAAG,IAAX;;AACA,UAAI,CAACm5J,YAAL,EAAmB;AACjB,YAAIn5J,IAAI,CAACk4C,IAAT,EAAe;AACbl4C,UAAAA,IAAI,CAACk4C,IAAL,CAAUr7C,KAAV,CAAgBmD,IAAhB,EAAsBpD,SAAtB;AACD;;AACD08J,QAAAA,MAAM,GAAGt5J,IAAI,CAACw5J,MAAd;;AACA,YAAIF,MAAJ,EAAY;AACV39J,UAAAA,CAAC,GAAG29J,MAAM,CAAC79J,MAAX;;AACA,iBAAOE,CAAC,EAAR,EAAY;AACV49J,YAAAA,KAAK,GAAGD,MAAM,CAAC39J,CAAD,CAAd;;AACA,gBAAI49J,KAAK,CAACrhH,IAAV,EAAgB;AACdqhH,cAAAA,KAAK,CAACrhH,IAAN,CAAWr7C,KAAX,CAAiBmD,IAAjB,EAAuBpD,SAAvB;AACD;AACF;AACF;AACF;AACF,KAlBD;;AAmBA,QAAI68J,KAAK,GAAG,YAAY;AACtB,aAAO,IAAP;AACD,KAFD;;AAGA,QAAIC,YAAY,GAAG,UAAUn/J,IAAV,EAAgB+C,EAAhB,EAAoB;AACrC,aAAO,YAAY;AACjB,YAAI0C,IAAI,GAAG,IAAX;AACA,YAAI6uC,GAAG,GAAG7uC,IAAI,CAACq5J,MAAf;AACAr5J,QAAAA,IAAI,CAACq5J,MAAL,GAAcA,MAAM,CAAC9+J,IAAD,CAApB;AACA,YAAI4b,GAAG,GAAG7Y,EAAE,CAACT,KAAH,CAASmD,IAAT,EAAepD,SAAf,CAAV;AACAoD,QAAAA,IAAI,CAACq5J,MAAL,GAAcxqH,GAAd;AACA,eAAO14B,GAAP;AACD,OAPD;AAQD,KATD;;AAUAgjJ,IAAAA,YAAY,GAAG,IAAf;AACA,QAAI/+J,SAAS,GAAG,IAAI4F,IAAJ,EAAhB;AACAm5J,IAAAA,YAAY,GAAG,KAAf;;AACA,QAAIv1J,KAAK,CAAC41J,MAAV,EAAkB;AAChBR,MAAAA,MAAM,CAACp1J,KAAK,CAAC41J,MAAP,EAAe,UAAUD,KAAV,EAAiB;AACpC,aAAK,IAAI1oJ,MAAT,IAAmB0oJ,KAAnB,EAA0B;AACxB,cAAI1oJ,MAAM,KAAK,MAAf,EAAuB;AACrBjN,YAAAA,KAAK,CAACiN,MAAD,CAAL,GAAgB0oJ,KAAK,CAAC1oJ,MAAD,CAArB;AACD;AACF;AACF,OANK,CAAN;;AAOA,UAAIwoJ,MAAM,CAACG,MAAX,EAAmB;AACjB51J,QAAAA,KAAK,CAAC41J,MAAN,GAAeH,MAAM,CAACG,MAAP,CAAc97J,MAAd,CAAqBkG,KAAK,CAAC41J,MAA3B,CAAf;AACD;AACF;;AACD,QAAI51J,KAAK,CAAC+1J,OAAV,EAAmB;AACjBX,MAAAA,MAAM,CAACp1J,KAAK,CAAC+1J,OAAN,CAAcnqJ,KAAd,CAAoB,GAApB,CAAD,EAA2B,UAAUjV,IAAV,EAAgB;AAC/CqJ,QAAAA,KAAK,CAACrJ,IAAD,CAAL,GAAck/J,KAAd;AACD,OAFK,CAAN;AAGD;;AACD,QAAI71J,KAAK,CAACg2J,UAAV,EAAsB;AACpBZ,MAAAA,MAAM,CAACp1J,KAAK,CAACg2J,UAAN,CAAiBpqJ,KAAjB,CAAuB,GAAvB,CAAD,EAA8B,UAAUjV,IAAV,EAAgB;AAClD,YAAIs/J,SAAS,GAAG,MAAMt/J,IAAtB;;AACAqJ,QAAAA,KAAK,CAACrJ,IAAD,CAAL,GAAc,UAAU4C,KAAV,EAAiB;AAC7B,cAAI6C,IAAI,GAAG,IAAX;;AACA,cAAI7C,KAAK,KAAKlD,SAAd,EAAyB;AACvB+F,YAAAA,IAAI,CAAC65J,SAAD,CAAJ,GAAkB18J,KAAlB;AACA,mBAAO6C,IAAP;AACD;;AACD,iBAAOA,IAAI,CAAC65J,SAAD,CAAX;AACD,SAPD;AAQD,OAVK,CAAN;AAWD;;AACD,QAAIj2J,KAAK,CAACk2J,OAAV,EAAmB;AACjBd,MAAAA,MAAM,CAACp1J,KAAK,CAACk2J,OAAP,EAAgB,UAAUxsI,IAAV,EAAgB/yB,IAAhB,EAAsB;AAC1C6+J,QAAAA,KAAK,CAAC7+J,IAAD,CAAL,GAAc+yB,IAAd;AACD,OAFK,CAAN;AAGD;;AACD,QAAI1pB,KAAK,CAACm2J,QAAN,IAAkBV,MAAM,CAACU,QAA7B,EAAuC;AACrCn2J,MAAAA,KAAK,CAACm2J,QAAN,GAAiBd,QAAQ,CAAC,EAAD,EAAKI,MAAM,CAACU,QAAZ,EAAsBn2J,KAAK,CAACm2J,QAA5B,CAAzB;AACD;;AACDr2J,IAAAA,MAAM,CAACE,KAAD,EAAQ,UAAUo2J,MAAV,EAAkBz/J,IAAlB,EAAwB;AACpC,UAAI,OAAOy/J,MAAP,KAAkB,UAAlB,IAAgCX,MAAM,CAAC9+J,IAAD,CAA1C,EAAkD;AAChDH,QAAAA,SAAS,CAACG,IAAD,CAAT,GAAkBm/J,YAAY,CAACn/J,IAAD,EAAOy/J,MAAP,CAA9B;AACD,OAFD,MAEO;AACL5/J,QAAAA,SAAS,CAACG,IAAD,CAAT,GAAkBy/J,MAAlB;AACD;AACF,KANK,CAAN;AAOAZ,IAAAA,KAAK,CAACh/J,SAAN,GAAkBA,SAAlB;AACAg/J,IAAAA,KAAK,CAAC9+J,WAAN,GAAoB8+J,KAApB;AACAA,IAAAA,KAAK,CAAC7oJ,MAAN,GAAe2oJ,WAAf;AACA,WAAOE,KAAP;AACD,GAvFD;;AAyFA,MAAIa,KAAK,GAAG99I,IAAI,CAACswC,GAAjB;AAAA,MAAsBytG,KAAK,GAAG/9I,IAAI,CAACC,GAAnC;AAAA,MAAwC+9I,OAAO,GAAGh+I,IAAI,CAAC4vC,KAAvD;;AACA,MAAIquG,KAAK,GAAG,UAAUj9J,KAAV,EAAiB;AAC3B,QAAI6C,IAAI,GAAG,EAAX;AACA,QAAI4B,CAAC,GAAG,CAAR;AAAA,QAAW8f,CAAC,GAAG,CAAf;AAAA,QAAkBthB,CAAC,GAAG,CAAtB;;AACA,QAAIi6J,OAAO,GAAG,UAAUz4J,CAAV,EAAa8f,CAAb,EAAgBthB,CAAhB,EAAmB;AAC/B,UAAI88C,CAAJ,EAAOj9C,CAAP,EAAUC,CAAV;AACAg9C,MAAAA,CAAC,GAAG,CAAJ;AACAj9C,MAAAA,CAAC,GAAG,CAAJ;AACAC,MAAAA,CAAC,GAAG,CAAJ;AACA0B,MAAAA,CAAC,GAAGA,CAAC,GAAG,GAAR;AACA8f,MAAAA,CAAC,GAAGA,CAAC,GAAG,GAAR;AACAthB,MAAAA,CAAC,GAAGA,CAAC,GAAG,GAAR;AACA,UAAIk6J,MAAM,GAAGL,KAAK,CAACr4J,CAAD,EAAIq4J,KAAK,CAACv4I,CAAD,EAAIthB,CAAJ,CAAT,CAAlB;AACA,UAAIm6J,MAAM,GAAGL,KAAK,CAACt4J,CAAD,EAAIs4J,KAAK,CAACx4I,CAAD,EAAIthB,CAAJ,CAAT,CAAlB;;AACA,UAAIk6J,MAAM,KAAKC,MAAf,EAAuB;AACrBr6J,QAAAA,CAAC,GAAGo6J,MAAJ;AACA,eAAO;AACLp9G,UAAAA,CAAC,EAAE,CADE;AAELj9C,UAAAA,CAAC,EAAE,CAFE;AAGLC,UAAAA,CAAC,EAAEA,CAAC,GAAG;AAHF,SAAP;AAKD;;AACD,UAAI8Q,CAAC,GAAGpP,CAAC,KAAK04J,MAAN,GAAe54I,CAAC,GAAGthB,CAAnB,GAAuBA,CAAC,KAAKk6J,MAAN,GAAe14J,CAAC,GAAG8f,CAAnB,GAAuBthB,CAAC,GAAGwB,CAA1D;AACAs7C,MAAAA,CAAC,GAAGt7C,CAAC,KAAK04J,MAAN,GAAe,CAAf,GAAmBl6J,CAAC,KAAKk6J,MAAN,GAAe,CAAf,GAAmB,CAA1C;AACAp9G,MAAAA,CAAC,GAAG,MAAMA,CAAC,GAAGlsC,CAAC,IAAIupJ,MAAM,GAAGD,MAAb,CAAX,CAAJ;AACAr6J,MAAAA,CAAC,GAAG,CAACs6J,MAAM,GAAGD,MAAV,IAAoBC,MAAxB;AACAr6J,MAAAA,CAAC,GAAGq6J,MAAJ;AACA,aAAO;AACLr9G,QAAAA,CAAC,EAAEi9G,OAAO,CAACj9G,CAAD,CADL;AAELj9C,QAAAA,CAAC,EAAEk6J,OAAO,CAACl6J,CAAC,GAAG,GAAL,CAFL;AAGLC,QAAAA,CAAC,EAAEi6J,OAAO,CAACj6J,CAAC,GAAG,GAAL;AAHL,OAAP;AAKD,KA5BD;;AA6BA,QAAIs6J,QAAQ,GAAG,UAAUC,GAAV,EAAeC,UAAf,EAA2BC,UAA3B,EAAuC;AACpDF,MAAAA,GAAG,GAAG,CAAC1hI,QAAQ,CAAC0hI,GAAD,EAAM,EAAN,CAAR,IAAqB,CAAtB,IAA2B,GAAjC;AACAC,MAAAA,UAAU,GAAG3hI,QAAQ,CAAC2hI,UAAD,EAAa,EAAb,CAAR,GAA2B,GAAxC;AACAC,MAAAA,UAAU,GAAG5hI,QAAQ,CAAC4hI,UAAD,EAAa,EAAb,CAAR,GAA2B,GAAxC;AACAD,MAAAA,UAAU,GAAGR,KAAK,CAAC,CAAD,EAAID,KAAK,CAACS,UAAD,EAAa,CAAb,CAAT,CAAlB;AACAC,MAAAA,UAAU,GAAGT,KAAK,CAAC,CAAD,EAAID,KAAK,CAACU,UAAD,EAAa,CAAb,CAAT,CAAlB;;AACA,UAAID,UAAU,KAAK,CAAnB,EAAsB;AACpB94J,QAAAA,CAAC,GAAG8f,CAAC,GAAGthB,CAAC,GAAG+5J,OAAO,CAAC,MAAMQ,UAAP,CAAnB;AACA;AACD;;AACD,UAAIC,IAAI,GAAGH,GAAG,GAAG,EAAjB;AACA,UAAII,MAAM,GAAGF,UAAU,GAAGD,UAA1B;AACA,UAAI1gK,CAAC,GAAG6gK,MAAM,IAAI,IAAI1+I,IAAI,CAAC8wD,GAAL,CAAS2tF,IAAI,GAAG,CAAP,GAAW,CAApB,CAAR,CAAd;AACA,UAAIzqJ,KAAK,GAAGwqJ,UAAU,GAAGE,MAAzB;;AACA,cAAQ1+I,IAAI,CAACguC,KAAL,CAAWywG,IAAX,CAAR;AACA,aAAK,CAAL;AACEh5J,UAAAA,CAAC,GAAGi5J,MAAJ;AACAn5I,UAAAA,CAAC,GAAG1nB,CAAJ;AACAoG,UAAAA,CAAC,GAAG,CAAJ;AACA;;AACF,aAAK,CAAL;AACEwB,UAAAA,CAAC,GAAG5H,CAAJ;AACA0nB,UAAAA,CAAC,GAAGm5I,MAAJ;AACAz6J,UAAAA,CAAC,GAAG,CAAJ;AACA;;AACF,aAAK,CAAL;AACEwB,UAAAA,CAAC,GAAG,CAAJ;AACA8f,UAAAA,CAAC,GAAGm5I,MAAJ;AACAz6J,UAAAA,CAAC,GAAGpG,CAAJ;AACA;;AACF,aAAK,CAAL;AACE4H,UAAAA,CAAC,GAAG,CAAJ;AACA8f,UAAAA,CAAC,GAAG1nB,CAAJ;AACAoG,UAAAA,CAAC,GAAGy6J,MAAJ;AACA;;AACF,aAAK,CAAL;AACEj5J,UAAAA,CAAC,GAAG5H,CAAJ;AACA0nB,UAAAA,CAAC,GAAG,CAAJ;AACAthB,UAAAA,CAAC,GAAGy6J,MAAJ;AACA;;AACF,aAAK,CAAL;AACEj5J,UAAAA,CAAC,GAAGi5J,MAAJ;AACAn5I,UAAAA,CAAC,GAAG,CAAJ;AACAthB,UAAAA,CAAC,GAAGpG,CAAJ;AACA;;AACF;AACE4H,UAAAA,CAAC,GAAG8f,CAAC,GAAGthB,CAAC,GAAG,CAAZ;AAhCF;;AAkCAwB,MAAAA,CAAC,GAAGu4J,OAAO,CAAC,OAAOv4J,CAAC,GAAGuO,KAAX,CAAD,CAAX;AACAuR,MAAAA,CAAC,GAAGy4I,OAAO,CAAC,OAAOz4I,CAAC,GAAGvR,KAAX,CAAD,CAAX;AACA/P,MAAAA,CAAC,GAAG+5J,OAAO,CAAC,OAAO/5J,CAAC,GAAG+P,KAAX,CAAD,CAAX;AACD,KAnDD;;AAoDA,QAAI+xB,KAAK,GAAG,YAAY;AACtB,UAAIC,GAAG,GAAG,UAAUlc,GAAV,EAAe;AACvBA,QAAAA,GAAG,GAAG8S,QAAQ,CAAC9S,GAAD,EAAM,EAAN,CAAR,CAAkBpmB,QAAlB,CAA2B,EAA3B,CAAN;AACA,eAAOomB,GAAG,CAACxqB,MAAJ,GAAa,CAAb,GAAiBwqB,GAAjB,GAAuB,MAAMA,GAApC;AACD,OAHD;;AAIA,aAAO,MAAMkc,GAAG,CAACvgC,CAAD,CAAT,GAAeugC,GAAG,CAACzgB,CAAD,CAAlB,GAAwBygB,GAAG,CAAC/hC,CAAD,CAAlC;AACD,KAND;;AAOA,QAAI06J,KAAK,GAAG,YAAY;AACtB,aAAO;AACLl5J,QAAAA,CAAC,EAAEA,CADE;AAEL8f,QAAAA,CAAC,EAAEA,CAFE;AAGLthB,QAAAA,CAAC,EAAEA;AAHE,OAAP;AAKD,KAND;;AAOA,QAAI26J,KAAK,GAAG,YAAY;AACtB,aAAOV,OAAO,CAACz4J,CAAD,EAAI8f,CAAJ,EAAOthB,CAAP,CAAd;AACD,KAFD;;AAGA,QAAI0iC,KAAK,GAAG,UAAU3lC,KAAV,EAAiB;AAC3B,UAAIqQ,OAAJ;;AACA,UAAI,OAAOrQ,KAAP,KAAiB,QAArB,EAA+B;AAC7B,YAAI,OAAOA,KAAX,EAAkB;AAChByE,UAAAA,CAAC,GAAGzE,KAAK,CAACyE,CAAV;AACA8f,UAAAA,CAAC,GAAGvkB,KAAK,CAACukB,CAAV;AACAthB,UAAAA,CAAC,GAAGjD,KAAK,CAACiD,CAAV;AACD,SAJD,MAIO,IAAI,OAAOjD,KAAX,EAAkB;AACvBq9J,UAAAA,QAAQ,CAACr9J,KAAK,CAAC+/C,CAAP,EAAU//C,KAAK,CAAC8C,CAAhB,EAAmB9C,KAAK,CAAC+C,CAAzB,CAAR;AACD;AACF,OARD,MAQO;AACL,YAAIsN,OAAO,GAAG,8DAA8DyC,IAA9D,CAAmE9S,KAAnE,CAAd,EAAyF;AACvFyE,UAAAA,CAAC,GAAGm3B,QAAQ,CAACvrB,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAAZ;AACAkU,UAAAA,CAAC,GAAGqX,QAAQ,CAACvrB,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAAZ;AACApN,UAAAA,CAAC,GAAG24B,QAAQ,CAACvrB,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAAZ;AACD,SAJD,MAIO,IAAIA,OAAO,GAAG,oCAAoCyC,IAApC,CAAyC9S,KAAzC,CAAd,EAA+D;AACpEyE,UAAAA,CAAC,GAAGm3B,QAAQ,CAACvrB,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAAZ;AACAkU,UAAAA,CAAC,GAAGqX,QAAQ,CAACvrB,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAAZ;AACApN,UAAAA,CAAC,GAAG24B,QAAQ,CAACvrB,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAAZ;AACD,SAJM,MAIA,IAAIA,OAAO,GAAG,2BAA2ByC,IAA3B,CAAgC9S,KAAhC,CAAd,EAAsD;AAC3DyE,UAAAA,CAAC,GAAGm3B,QAAQ,CAACvrB,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAArB,EAA0B,EAA1B,CAAZ;AACAkU,UAAAA,CAAC,GAAGqX,QAAQ,CAACvrB,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAArB,EAA0B,EAA1B,CAAZ;AACApN,UAAAA,CAAC,GAAG24B,QAAQ,CAACvrB,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAArB,EAA0B,EAA1B,CAAZ;AACD;AACF;;AACD5L,MAAAA,CAAC,GAAGA,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAYA,CAAC,GAAG,GAAJ,GAAU,GAAV,GAAgBA,CAAhC;AACA8f,MAAAA,CAAC,GAAGA,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAYA,CAAC,GAAG,GAAJ,GAAU,GAAV,GAAgBA,CAAhC;AACAthB,MAAAA,CAAC,GAAGA,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAYA,CAAC,GAAG,GAAJ,GAAU,GAAV,GAAgBA,CAAhC;AACA,aAAOJ,IAAP;AACD,KA7BD;;AA8BA,QAAI7C,KAAJ,EAAW;AACT2lC,MAAAA,KAAK,CAAC3lC,KAAD,CAAL;AACD;;AACD6C,IAAAA,IAAI,CAAC86J,KAAL,GAAaA,KAAb;AACA96J,IAAAA,IAAI,CAAC+6J,KAAL,GAAaA,KAAb;AACA/6J,IAAAA,IAAI,CAACkiC,KAAL,GAAaA,KAAb;AACAliC,IAAAA,IAAI,CAAC8iC,KAAL,GAAaA,KAAb;AACA,WAAO9iC,IAAP;AACD,GA3ID;;AA6IA,MAAIukC,SAAS,GAAG,UAAU5gC,GAAV,EAAe;AAC7B,QAAIskB,IAAI,GAAG4gG,IAAI,CAACmyC,SAAL,CAAer3J,GAAf,CAAX;;AACA,QAAI,CAAC/C,QAAQ,CAACqnB,IAAD,CAAb,EAAqB;AACnB,aAAOA,IAAP;AACD;;AACD,WAAOA,IAAI,CAACxf,OAAL,CAAa,kBAAb,EAAiC,UAAU0H,KAAV,EAAiB;AACvD,UAAI8qJ,OAAO,GAAG9qJ,KAAK,CAACipB,UAAN,CAAiB,CAAjB,EAAoBv5B,QAApB,CAA6B,EAA7B,CAAd;AACA,aAAO,QAAQ,OAAOkK,SAAP,CAAiBkxJ,OAAO,CAACx/J,MAAzB,CAAR,GAA2Cw/J,OAAlD;AACD,KAHM,CAAP;AAID,GATD;;AAUA,MAAIC,SAAS,GAAG;AACd32H,IAAAA,SAAS,EAAEA,SADG;AAEdzB,IAAAA,KAAK,EAAE,UAAUvwB,IAAV,EAAgB;AACrB,UAAI;AACF,eAAOs2G,IAAI,CAAC/lF,KAAL,CAAWvwB,IAAX,CAAP;AACD,OAFD,CAEE,OAAOsT,EAAP,EAAW,CACZ;AACF;AAPa,GAAhB;AAUA,MAAIs1I,KAAK,GAAG;AACVjzI,IAAAA,SAAS,EAAE,EADD;AAEVoB,IAAAA,KAAK,EAAE,CAFG;AAGV2pF,IAAAA,IAAI,EAAE,UAAUllF,QAAV,EAAoB;AACxB,UAAI/tB,IAAI,GAAG,IAAX;AAAA,UAAiByS,GAAG,GAAG+oC,QAAQ,CAAC2D,GAAhC;AAAA,UAAqC71B,KAAK,GAAGyE,QAAQ,CAACzE,KAAT,KAAmBrvB,SAAnB,GAA+B8zB,QAAQ,CAACzE,KAAxC,GAAgDtpB,IAAI,CAACspB,KAAlG;AACA,UAAIhrB,EAAE,GAAG,mBAAmBgrB,KAA5B;;AACAtpB,MAAAA,IAAI,CAACkoB,SAAL,CAAeoB,KAAf,IAAwB,UAAUs/F,IAAV,EAAgB;AACtCn2G,QAAAA,GAAG,CAAC6G,MAAJ,CAAWhb,EAAX;AACA,eAAO0B,IAAI,CAACkoB,SAAL,CAAeoB,KAAf,CAAP;AACAyE,QAAAA,QAAQ,CAAC3oB,QAAT,CAAkBwjH,IAAlB;AACD,OAJD;;AAKAn2G,MAAAA,GAAG,CAACqoB,GAAJ,CAAQroB,GAAG,CAACf,GAAJ,CAAQiI,IAAhB,EAAsB,QAAtB,EAAgC;AAC9Brb,QAAAA,EAAE,EAAEA,EAD0B;AAE9B48C,QAAAA,GAAG,EAAEntB,QAAQ,CAAC7c,GAFgB;AAG9BzQ,QAAAA,IAAI,EAAE;AAHwB,OAAhC;AAKAT,MAAAA,IAAI,CAACspB,KAAL;AACD;AAjBS,GAAZ;;AAoBA,MAAI8xI,GAAG,GAAGl1J,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4kJ,UAAL,CAAT,EAA2B;AAC3C73C,IAAAA,IAAI,EAAE,UAAUllF,QAAV,EAAoB;AACxB,UAAIs6F,GAAJ;AAAA,UAAS/+F,KAAK,GAAG,CAAjB;;AACA,UAAI+xI,KAAK,GAAG,YAAY;AACtB,YAAI,CAACttI,QAAQ,CAACutI,KAAV,IAAmBjzC,GAAG,CAAC9gF,UAAJ,KAAmB,CAAtC,IAA2Cje,KAAK,KAAK,KAAzD,EAAgE;AAC9D,cAAIyE,QAAQ,CAACc,OAAT,IAAoBvF,KAAK,GAAG,KAA5B,IAAqC++F,GAAG,CAACn5F,MAAJ,KAAe,GAAxD,EAA6D;AAC3DnB,YAAAA,QAAQ,CAACc,OAAT,CAAiB7zB,IAAjB,CAAsB+yB,QAAQ,CAACwtI,aAA/B,EAA8C,KAAKlzC,GAAG,CAACS,YAAvD,EAAqET,GAArE,EAA0Et6F,QAA1E;AACD,WAFD,MAEO,IAAIA,QAAQ,CAAC9b,KAAb,EAAoB;AACzB8b,YAAAA,QAAQ,CAAC9b,KAAT,CAAejX,IAAf,CAAoB+yB,QAAQ,CAACytI,WAA7B,EAA0ClyI,KAAK,GAAG,KAAR,GAAgB,WAAhB,GAA8B,SAAxE,EAAmF++F,GAAnF,EAAwFt6F,QAAxF;AACD;;AACDs6F,UAAAA,GAAG,GAAG,IAAN;AACD,SAPD,MAOO;AACL96F,UAAAA,KAAK,CAACnL,UAAN,CAAiBi5I,KAAjB,EAAwB,EAAxB;AACD;AACF,OAXD;;AAYAttI,MAAAA,QAAQ,CAACtc,KAAT,GAAiBsc,QAAQ,CAACtc,KAAT,IAAkB,IAAnC;AACAsc,MAAAA,QAAQ,CAACwtI,aAAT,GAAyBxtI,QAAQ,CAACwtI,aAAT,IAA0BxtI,QAAQ,CAACtc,KAA5D;AACAsc,MAAAA,QAAQ,CAACytI,WAAT,GAAuBztI,QAAQ,CAACytI,WAAT,IAAwBztI,QAAQ,CAACtc,KAAxD;AACAsc,MAAAA,QAAQ,CAACutI,KAAT,GAAiBvtI,QAAQ,CAACutI,KAAT,KAAmB,KAApC;AACAvtI,MAAAA,QAAQ,CAAC9F,IAAT,GAAgB8F,QAAQ,CAAC9F,IAAT,IAAiB,EAAjC;AACAmzI,MAAAA,GAAG,CAACxyH,IAAJ,CAAS,kBAAT,EAA6B;AAAE7a,QAAAA,QAAQ,EAAEA;AAAZ,OAA7B;AACAs6F,MAAAA,GAAG,GAAG,IAAIxV,cAAJ,EAAN;;AACA,UAAIwV,GAAG,CAACozC,gBAAR,EAA0B;AACxBpzC,QAAAA,GAAG,CAACozC,gBAAJ,CAAqB1tI,QAAQ,CAAC2tI,YAA9B;AACD;;AACDrzC,MAAAA,GAAG,CAACvV,IAAJ,CAAS/kF,QAAQ,CAACttB,IAAT,KAAkBstB,QAAQ,CAAC9F,IAAT,GAAgB,MAAhB,GAAyB,KAA3C,CAAT,EAA4D8F,QAAQ,CAAC7c,GAArE,EAA0E6c,QAAQ,CAACutI,KAAnF;;AACA,UAAIvtI,QAAQ,CAAC4tI,WAAb,EAA0B;AACxBtzC,QAAAA,GAAG,CAACC,eAAJ,GAAsB,IAAtB;AACD;;AACD,UAAIv6F,QAAQ,CAAC2tI,YAAb,EAA2B;AACzBrzC,QAAAA,GAAG,CAACuzC,gBAAJ,CAAqB,cAArB,EAAqC7tI,QAAQ,CAAC2tI,YAA9C;AACD;;AACD,UAAI3tI,QAAQ,CAAC8tI,cAAb,EAA6B;AAC3B1qJ,QAAAA,KAAK,CAAC9R,IAAN,CAAW0uB,QAAQ,CAAC8tI,cAApB,EAAoC,UAAUppH,MAAV,EAAkB;AACpD41E,UAAAA,GAAG,CAACuzC,gBAAJ,CAAqBnpH,MAAM,CAAC/tC,GAA5B,EAAiC+tC,MAAM,CAACt1C,KAAxC;AACD,SAFD;AAGD;;AACDkrH,MAAAA,GAAG,CAACuzC,gBAAJ,CAAqB,kBAArB,EAAyC,gBAAzC;AACAvzC,MAAAA,GAAG,GAAG+yC,GAAG,CAACxyH,IAAJ,CAAS,YAAT,EAAuB;AAC3By/E,QAAAA,GAAG,EAAEA,GADsB;AAE3Bt6F,QAAAA,QAAQ,EAAEA;AAFiB,OAAvB,EAGHs6F,GAHH;AAIAA,MAAAA,GAAG,CAACpV,IAAJ,CAASllF,QAAQ,CAAC9F,IAAlB;;AACA,UAAI,CAAC8F,QAAQ,CAACutI,KAAd,EAAqB;AACnB,eAAOD,KAAK,EAAZ;AACD;;AACD9tI,MAAAA,KAAK,CAACnL,UAAN,CAAiBi5I,KAAjB,EAAwB,EAAxB;AACD;AA/C0C,GAA3B,CAAlB;;AAkDA,MAAIS,QAAQ,GAAG3qJ,KAAK,CAACZ,MAArB;;AACA,MAAIwrJ,WAAW,GAAG,YAAY;AAC5B,aAASA,WAAT,CAAqBhuI,QAArB,EAA+B;AAC7B,WAAKA,QAAL,GAAgB+tI,QAAQ,CAAC,EAAD,EAAK/tI,QAAL,CAAxB;AACA,WAAKzE,KAAL,GAAa,CAAb;AACD;;AACDyyI,IAAAA,WAAW,CAACC,OAAZ,GAAsB,UAAU79J,CAAV,EAAa;AACjC,aAAO,IAAI49J,WAAJ,GAAkB9oD,IAAlB,CAAuB90G,CAAvB,CAAP;AACD,KAFD;;AAGA49J,IAAAA,WAAW,CAAC3hK,SAAZ,CAAsB64G,IAAtB,GAA6B,UAAUv2G,IAAV,EAAgB;AAC3C,UAAIu/J,GAAG,GAAGv/J,IAAI,CAACuV,KAAf;AAAA,UAAsBiqJ,GAAG,GAAGx/J,IAAI,CAACmyB,OAAjC;AACA,UAAIstI,OAAO,GAAGL,QAAQ,CAAC,KAAK/tI,QAAN,EAAgBrxB,IAAhB,CAAtB;;AACAy/J,MAAAA,OAAO,CAACttI,OAAR,GAAkB,UAAU9e,CAAV,EAAa/V,CAAb,EAAgB;AAChC+V,QAAAA,CAAC,GAAGmrJ,SAAS,CAACp4H,KAAV,CAAgB/yB,CAAhB,CAAJ;;AACA,YAAI,OAAOA,CAAP,KAAa,WAAjB,EAA8B;AAC5BA,UAAAA,CAAC,GAAG;AAAEkC,YAAAA,KAAK,EAAE;AAAT,WAAJ;AACD;;AACD,YAAIlC,CAAC,CAACkC,KAAN,EAAa;AACXgqJ,UAAAA,GAAG,CAACjhK,IAAJ,CAASmhK,OAAO,CAACX,WAAR,IAAuBW,OAAO,CAAC1qJ,KAAxC,EAA+C1B,CAAC,CAACkC,KAAjD,EAAwDjY,CAAxD;AACD,SAFD,MAEO;AACLkiK,UAAAA,GAAG,CAAClhK,IAAJ,CAASmhK,OAAO,CAACZ,aAAR,IAAyBY,OAAO,CAAC1qJ,KAA1C,EAAiD1B,CAAC,CAAC+b,MAAnD;AACD;AACF,OAVD;;AAWAqwI,MAAAA,OAAO,CAAClqJ,KAAR,GAAgB,UAAU5V,EAAV,EAAcrC,CAAd,EAAiB;AAC/B,YAAIiiK,GAAJ,EAAS;AACPA,UAAAA,GAAG,CAACjhK,IAAJ,CAASmhK,OAAO,CAACX,WAAR,IAAuBW,OAAO,CAAC1qJ,KAAxC,EAA+CpV,EAA/C,EAAmDrC,CAAnD;AACD;AACF,OAJD;;AAKAmiK,MAAAA,OAAO,CAACl0I,IAAR,GAAeizI,SAAS,CAAC32H,SAAV,CAAoB;AACjCjmC,QAAAA,EAAE,EAAE5B,IAAI,CAAC4B,EAAL,IAAW,MAAM,KAAKgrB,KAAL,EADY;AAEjC8yI,QAAAA,MAAM,EAAE1/J,IAAI,CAAC0/J,MAFoB;AAGjC9wI,QAAAA,MAAM,EAAE5uB,IAAI,CAAC4uB;AAHoB,OAApB,CAAf;AAKA6wI,MAAAA,OAAO,CAACT,YAAR,GAAuB,kBAAvB;AACAN,MAAAA,GAAG,CAACnoD,IAAJ,CAASkpD,OAAT;AACD,KA1BD;;AA2BA,WAAOJ,WAAP;AACD,GApCiB,EAAlB;;AAsCA,MAAIM,QAAQ,GAAG,YAAY;AACzB,WAAO,YAAY;AACjB,UAAIp0I,IAAI,GAAG,EAAX;AACA,UAAIjsB,IAAI,GAAG,EAAX;AACA,UAAIsgK,OAAO,GAAG;AACZC,QAAAA,OAAO,EAAE,UAAU73J,GAAV,EAAe;AACtB,cAAIY,IAAI,GAAG2iB,IAAI,CAACvjB,GAAD,CAAf;AACA,iBAAOY,IAAI,GAAGA,IAAH,GAAU,IAArB;AACD,SAJW;AAKZk3J,QAAAA,OAAO,EAAE,UAAU93J,GAAV,EAAevH,KAAf,EAAsB;AAC7BnB,UAAAA,IAAI,CAACyF,IAAL,CAAUiD,GAAV;AACAujB,UAAAA,IAAI,CAACvjB,GAAD,CAAJ,GAAYlK,MAAM,CAAC2C,KAAD,CAAlB;AACD,SARW;AASZuH,QAAAA,GAAG,EAAE,UAAUa,KAAV,EAAiB;AACpB,iBAAOvJ,IAAI,CAACuJ,KAAD,CAAX;AACD,SAXW;AAYZk3J,QAAAA,UAAU,EAAE,UAAU/3J,GAAV,EAAe;AACzB1I,UAAAA,IAAI,GAAGA,IAAI,CAACyD,MAAL,CAAY,UAAUoE,CAAV,EAAa;AAC9B,mBAAOA,CAAC,KAAKa,GAAb;AACD,WAFM,CAAP;AAGA,iBAAOujB,IAAI,CAACvjB,GAAD,CAAX;AACD,SAjBW;AAkBZylG,QAAAA,KAAK,EAAE,YAAY;AACjBnuG,UAAAA,IAAI,GAAG,EAAP;AACAisB,UAAAA,IAAI,GAAG,EAAP;AACD,SArBW;AAsBZxsB,QAAAA,MAAM,EAAE;AAtBI,OAAd;AAwBAM,MAAAA,MAAM,CAAC2gK,cAAP,CAAsBJ,OAAtB,EAA+B,QAA/B,EAAyC;AACvCl5J,QAAAA,GAAG,EAAE,YAAY;AACf,iBAAOpH,IAAI,CAACP,MAAZ;AACD,SAHsC;AAIvCkhK,QAAAA,YAAY,EAAE,KAJyB;AAKvCC,QAAAA,UAAU,EAAE;AAL2B,OAAzC;AAOA,aAAON,OAAP;AACD,KAnCM,EAAP;AAoCD,GArCD;;AAuCA,MAAIO,YAAJ;;AACA,MAAI;AACF,QAAIv1J,IAAI,GAAG,kBAAX;AACAu1J,IAAAA,YAAY,GAAGvvJ,MAAM,CAACuvJ,YAAtB;AACAA,IAAAA,YAAY,CAACL,OAAb,CAAqBl1J,IAArB,EAA2BA,IAA3B;AACAu1J,IAAAA,YAAY,CAACJ,UAAb,CAAwBn1J,IAAxB;AACD,GALD,CAKE,OAAOhB,CAAP,EAAU;AACVu2J,IAAAA,YAAY,GAAGR,QAAQ,EAAvB;AACD;;AACD,MAAIS,YAAY,GAAGD,YAAnB;AAEA,MAAIE,SAAS,GAAG;AACdC,IAAAA,IAAI,EAAE;AAAE9E,MAAAA,IAAI,EAAEA;AAAR,KADQ;AAEd+E,IAAAA,IAAI,EAAE;AACJz4I,MAAAA,OAAO,EAAEiI,UADL;AAEJc,MAAAA,KAAK,EAAEA,KAFH;AAGJpc,MAAAA,KAAK,EAAEA,KAHH;AAIJ25D,MAAAA,EAAE,EAAEA,EAJA;AAKJ4lF,MAAAA,GAAG,EAAEA,GALD;AAMJ0I,MAAAA,KAAK,EAAEA,KANH;AAOJpP,MAAAA,eAAe,EAAEA,eAPb;AAQJc,MAAAA,UAAU,EAAEA,UARR;AASJzmG,MAAAA,IAAI,EAAEA,IATF;AAUJ+2G,MAAAA,GAAG,EAAEA,GAVD;AAWJvyC,MAAAA,IAAI,EAAEqyC,SAXF;AAYJa,MAAAA,WAAW,EAAEA,WAZT;AAaJZ,MAAAA,KAAK,EAAEA,KAbH;AAcJ2B,MAAAA,YAAY,EAAEA,YAdV;AAeJ1C,MAAAA,KAAK,EAAEA,KAfH;AAgBJnwC,MAAAA,aAAa,EAAEA;AAhBX,KAFQ;AAoBdx3G,IAAAA,GAAG,EAAE;AACHg1B,MAAAA,UAAU,EAAEA,UADT;AAEHqF,MAAAA,MAAM,EAAEA,MAFL;AAGHkK,MAAAA,QAAQ,EAAEA,QAHP;AAIHkmH,MAAAA,UAAU,EAAEnsI,aAJT;AAKHo6B,MAAAA,UAAU,EAAEA,UALT;AAMH3P,MAAAA,QAAQ,EAAEA,QANP;AAOHwG,MAAAA,YAAY,EAAEA,YAPX;AAQH6wB,MAAAA,UAAU,EAAEA,UART;AASHsqF,MAAAA,UAAU,EAAEtiD,aATT;AAUHhtF,MAAAA,gBAAgB,EAAEA,gBAVf;AAWHm+C,MAAAA,gBAAgB,EAAEA,gBAXf;AAYHnC,MAAAA,eAAe,EAAEA,eAZd;AAaHuzF,MAAAA,SAAS,EAAErtD,eAbR;AAcH9mE,MAAAA,KAAK,EAAExB,UAAU,CAACwB;AAdf,KApBS;AAoCdz3B,IAAAA,IAAI,EAAE;AACJ4wB,MAAAA,MAAM,EAAEA,MADJ;AAEJrI,MAAAA,QAAQ,EAAEA,QAFN;AAGJ5mB,MAAAA,IAAI,EAAEqqE,OAHF;AAIJ/hD,MAAAA,MAAM,EAAEA,MAJJ;AAKJokD,MAAAA,SAAS,EAAEA,SALP;AAMJy3B,MAAAA,SAAS,EAAEA,SANP;AAOJjzB,MAAAA,MAAM,EAAEA,MAPJ;AAQJ84E,MAAAA,UAAU,EAAEn4E;AARR,KApCQ;AA8Cd92E,IAAAA,GAAG,EAAEA,GA9CS;AA+Cdo2C,IAAAA,YAAY,EAAEA,YA/CA;AAgDdmlB,IAAAA,SAAS,EAAEA,SAhDG;AAiDdymD,IAAAA,SAAS,EAAEA,SAjDG;AAkDdc,IAAAA,WAAW,EAAEA,WAlDC;AAmDdy2B,IAAAA,cAAc,EAAEA,cAnDF;AAoDdzjC,IAAAA,aAAa,EAAEA,aApDD;AAqDdrB,IAAAA,mBAAmB,EAAEA,mBArDP;AAsDdipC,IAAAA,gBAAgB,EAAEA,gBAtDJ;AAuDdsC,IAAAA,SAAS,EAAEA,SAvDG;AAwDd4E,IAAAA,MAAM,EAAEA,MAxDM;AAyDdn5E,IAAAA,YAAY,EAAEA,YAzDA;AA0Dd+6E,IAAAA,aAAa,EAAEA,aA1DD;AA2Ddv1G,IAAAA,GAAG,EAAE3D,QAAQ,CAAC2D,GA3DA;AA4Dd6C,IAAAA,YAAY,EAAEA,YAAY,CAACA,YA5Db;AA6DdkE,IAAAA,aAAa,EAAEA,aA7DD;AA8DdC,IAAAA,YAAY,EAAEA,YA9DA;AA+Ddm7D,IAAAA,WAAW,EAAEA,WA/DC;AAgEdy3C,IAAAA,QAAQ,EAAEA,QAhEI;AAiEdvuJ,IAAAA,IAAI,EAAE2G,KAAK,CAAC3G,IAjEE;AAkEd1J,IAAAA,OAAO,EAAEqQ,KAAK,CAACrQ,OAlED;AAmEdnC,IAAAA,EAAE,EAAEwS,KAAK,CAACxS,EAnEI;AAoEdiB,IAAAA,OAAO,EAAEuR,KAAK,CAACvR,OApED;AAqEdyP,IAAAA,OAAO,EAAE8B,KAAK,CAAC9B,OArED;AAsEdhQ,IAAAA,IAAI,EAAE8R,KAAK,CAAC9R,IAtEE;AAuEdD,IAAAA,GAAG,EAAE+R,KAAK,CAAC/R,GAvEG;AAwEdgS,IAAAA,IAAI,EAAED,KAAK,CAACC,IAxEE;AAyEdC,IAAAA,OAAO,EAAEF,KAAK,CAACE,OAzED;AA0Edd,IAAAA,MAAM,EAAEY,KAAK,CAACZ,MA1EA;AA2EdZ,IAAAA,MAAM,EAAEwB,KAAK,CAACxB,MA3EA;AA4EdmB,IAAAA,IAAI,EAAEK,KAAK,CAACL,IA5EE;AA6EdT,IAAAA,QAAQ,EAAEc,KAAK,CAACd,QA7EF;AA8EdG,IAAAA,OAAO,EAAEW,KAAK,CAACX,OA9ED;AA+EdO,IAAAA,OAAO,EAAEI,KAAK,CAACJ,OA/ED;AAgFdE,IAAAA,eAAe,EAAEE,KAAK,CAACF,eAhFT;AAiFdpF,IAAAA,OAAO,EAAEqC,GAAG,CAAC/C,KAjFC;AAkFdwvI,IAAAA,QAAQ,EAAEzsI,GAAG,CAACL,MAlFA;AAmFdjC,IAAAA,IAAI,EAAEsC,GAAG,CAAChD,EAnFI;AAoFdwvI,IAAAA,OAAO,EAAExsI,GAAG,CAACC,KApFC;AAqFdkvJ,IAAAA,KAAK,EAAEnvJ,GAAG,CAACE;AArFG,GAAhB;AAuFA,MAAIknJ,OAAO,GAAGnkJ,KAAK,CAACZ,MAAN,CAAamkJ,aAAb,EAA4BqI,SAA5B,CAAd;;AAEA,MAAIO,qBAAqB,GAAG,UAAUhI,OAAV,EAAmB;AAC7C,QAAI,OAAO/zI,MAAP,KAAkB,QAAtB,EAAgC;AAC9B,UAAI;AACFA,QAAAA,MAAM,CAACF,OAAP,GAAiBi0I,OAAjB;AACD,OAFD,CAEE,OAAOzrI,CAAP,EAAU,CACX;AACF;AACF,GAPD;;AAQA,MAAI0zI,oBAAoB,GAAG,UAAUjI,OAAV,EAAmB;AAC5ChoJ,IAAAA,MAAM,CAACgoJ,OAAP,GAAiBA,OAAjB;AACAhoJ,IAAAA,MAAM,CAACkwJ,OAAP,GAAiBlI,OAAjB;AACD,GAHD;;AAIAiI,EAAAA,oBAAoB,CAACjI,OAAD,CAApB;AACAgI,EAAAA,qBAAqB,CAAChI,OAAD,CAArB;AAEH,CA5q6BA,GAAD","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.7.1 (2021-03-17)\n */\n(function () {\n    'use strict';\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      if (x === undefined) {\n        return 'undefined';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isEquatableType = function (x) {\n      return [\n        'undefined',\n        'boolean',\n        'number',\n        'string',\n        'function',\n        'xml',\n        'null'\n      ].indexOf(x) !== -1;\n    };\n\n    var sort = function (xs, compareFn) {\n      var clone = Array.prototype.slice.call(xs);\n      return clone.sort(compareFn);\n    };\n\n    var contramap = function (eqa, f) {\n      return eq(function (x, y) {\n        return eqa.eq(f(x), f(y));\n      });\n    };\n    var eq = function (f) {\n      return { eq: f };\n    };\n    var tripleEq = eq(function (x, y) {\n      return x === y;\n    });\n    var eqString = tripleEq;\n    var eqArray = function (eqa) {\n      return eq(function (x, y) {\n        if (x.length !== y.length) {\n          return false;\n        }\n        var len = x.length;\n        for (var i = 0; i < len; i++) {\n          if (!eqa.eq(x[i], y[i])) {\n            return false;\n          }\n        }\n        return true;\n      });\n    };\n    var eqSortedArray = function (eqa, compareFn) {\n      return contramap(eqArray(eqa), function (xs) {\n        return sort(xs, compareFn);\n      });\n    };\n    var eqRecord = function (eqa) {\n      return eq(function (x, y) {\n        var kx = Object.keys(x);\n        var ky = Object.keys(y);\n        if (!eqSortedArray(eqString).eq(kx, ky)) {\n          return false;\n        }\n        var len = kx.length;\n        for (var i = 0; i < len; i++) {\n          var q = kx[i];\n          if (!eqa.eq(x[q], y[q])) {\n            return false;\n          }\n        }\n        return true;\n      });\n    };\n    var eqAny = eq(function (x, y) {\n      if (x === y) {\n        return true;\n      }\n      var tx = typeOf(x);\n      var ty = typeOf(y);\n      if (tx !== ty) {\n        return false;\n      }\n      if (isEquatableType(tx)) {\n        return x === y;\n      } else if (tx === 'array') {\n        return eqArray(eqAny).eq(x, y);\n      } else if (tx === 'object') {\n        return eqRecord(eqAny).eq(x, y);\n      }\n      return false;\n    });\n\n    var noop = function () {\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var compose1 = function (fbc, fab) {\n      return function (a) {\n        return fbc(fab(a));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function (t) {\n        return !f(t);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var apply = function (f) {\n      return f();\n    };\n    var call = function (f) {\n      f();\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf$1 = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf$1(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var eq$1 = function (t) {\n      return function (a) {\n        return t === a;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isNull = eq$1(null);\n    var isBoolean = isSimpleType('boolean');\n    var isUndefined = eq$1(undefined);\n    var isNullable = function (a) {\n      return a === null || a === undefined;\n    };\n    var isNonNullable = function (a) {\n      return !isNullable(a);\n    };\n    var isFunction = isSimpleType('function');\n    var isNumber = isSimpleType('number');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var indexOf = function (xs, x) {\n      var r = rawIndexOf(xs, x);\n      return r === -1 ? Optional.none() : Optional.some(r);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var partition = function (xs, pred) {\n      var pass = [];\n      var fail = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var arr = pred(x, i) ? pass : fail;\n        arr.push(x);\n      }\n      return {\n        pass: pass,\n        fail: fail\n      };\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var findUntil = function (xs, pred, until) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(x);\n        } else if (until(x, i)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var find = function (xs, pred) {\n      return findUntil(xs, pred, never);\n    };\n    var findIndex = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(i);\n        }\n      }\n      return Optional.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map(xs, f));\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var difference = function (a1, a2) {\n      return filter(a1, function (x) {\n        return !contains(a2, x);\n      });\n    };\n    var mapToObject = function (xs, f) {\n      var r = {};\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        r[String(x)] = f(x, i);\n      }\n      return r;\n    };\n    var sort$1 = function (xs, comparator) {\n      var copy = nativeSlice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n    var get = function (xs, i) {\n      return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n    };\n    var head = function (xs) {\n      return get(xs, 0);\n    };\n    var last = function (xs) {\n      return get(xs, xs.length - 1);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Optional.none();\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map$1 = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var bifilter = function (obj, pred) {\n      var t = {};\n      var f = {};\n      internalFilter(obj, pred, objAcc(t), objAcc(f));\n      return {\n        t: t,\n        f: f\n      };\n    };\n    var filter$1 = function (obj, pred) {\n      var t = {};\n      internalFilter(obj, pred, objAcc(t), noop);\n      return t;\n    };\n    var mapToArray = function (obj, f) {\n      var r = [];\n      each$1(obj, function (value, name) {\n        r.push(f(value, name));\n      });\n      return r;\n    };\n    var values = function (obj) {\n      return mapToArray(obj, function (v) {\n        return v;\n      });\n    };\n    var get$1 = function (obj, key) {\n      return has(obj, key) ? Optional.from(obj[key]) : Optional.none();\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n    var hasNonNullableKey = function (obj, key) {\n      return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n    };\n    var equal = function (a1, a2, eq) {\n      if (eq === void 0) {\n        eq = eqAny;\n      }\n      return eqRecord(eq).eq(a1, a2);\n    };\n\n    var isArray$1 = Array.isArray;\n    var toArray = function (obj) {\n      if (!isArray$1(obj)) {\n        var array = [];\n        for (var i = 0, l = obj.length; i < l; i++) {\n          array[i] = obj[i];\n        }\n        return array;\n      } else {\n        return obj;\n      }\n    };\n    var each$2 = function (o, cb, s) {\n      var n, l;\n      if (!o) {\n        return false;\n      }\n      s = s || o;\n      if (o.length !== undefined) {\n        for (n = 0, l = o.length; n < l; n++) {\n          if (cb.call(s, o[n], n, o) === false) {\n            return false;\n          }\n        }\n      } else {\n        for (n in o) {\n          if (o.hasOwnProperty(n)) {\n            if (cb.call(s, o[n], n, o) === false) {\n              return false;\n            }\n          }\n        }\n      }\n      return true;\n    };\n    var map$2 = function (array, callback) {\n      var out = [];\n      each$2(array, function (item, index) {\n        out.push(callback(item, index, array));\n      });\n      return out;\n    };\n    var filter$2 = function (a, f) {\n      var o = [];\n      each$2(a, function (v, index) {\n        if (!f || f(v, index, a)) {\n          o.push(v);\n        }\n      });\n      return o;\n    };\n    var indexOf$1 = function (a, v) {\n      if (a) {\n        for (var i = 0, l = a.length; i < l; i++) {\n          if (a[i] === v) {\n            return i;\n          }\n        }\n      }\n      return -1;\n    };\n    var reduce = function (collection, iteratee, accumulator, thisArg) {\n      var acc = isUndefined(accumulator) ? collection[0] : accumulator;\n      for (var i = 0; i < collection.length; i++) {\n        acc = iteratee.call(thisArg, acc, collection[i], i);\n      }\n      return acc;\n    };\n    var findIndex$1 = function (array, predicate, thisArg) {\n      var i, l;\n      for (i = 0, l = array.length; i < l; i++) {\n        if (predicate.call(thisArg, array[i], i, array)) {\n          return i;\n        }\n      }\n      return -1;\n    };\n    var last$1 = function (collection) {\n      return collection[collection.length - 1];\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n    function __rest(s, e) {\n      var t = {};\n      for (var p in s)\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n          t[p] = s[p];\n      if (s != null && typeof Object.getOwnPropertySymbols === 'function')\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n            t[p[i]] = s[p[i]];\n        }\n      return t;\n    }\n    function __spreadArrays() {\n      for (var s = 0, i = 0, il = arguments.length; i < il; i++)\n        s += arguments[i].length;\n      for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n      return r;\n    }\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var removeFromStart = function (str, numChars) {\n      return str.substring(numChars);\n    };\n\n    var checkRange = function (str, substr, start) {\n      return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n    };\n    var removeLeading = function (str, prefix) {\n      return startsWith(str, prefix) ? removeFromStart(str, prefix.length) : str;\n    };\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var startsWith = function (str, prefix) {\n      return checkRange(str, prefix, 0);\n    };\n    var blank = function (r) {\n      return function (s) {\n        return s.replace(r, '');\n      };\n    };\n    var trim = blank(/^\\s+|\\s+$/g);\n    var lTrim = blank(/^\\s+/g);\n    var rTrim = blank(/\\s+$/g);\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$1(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('mac os x'),\n        versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      },\n      {\n        name: 'ChromeOS',\n        search: checkContains('cros'),\n        versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isBrowser = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge),\n        isChrome: isBrowser(chrome),\n        isIE: isBrowser(ie),\n        isOpera: isBrowser(opera),\n        isFirefox: isBrowser(firefox),\n        isSafari: isBrowser(safari)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var chromeos = 'ChromeOS';\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isOS = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows),\n        isiOS: isOS(ios),\n        isAndroid: isOS(android),\n        isOSX: isOS(osx),\n        isLinux: isOS(linux),\n        isSolaris: isOS(solaris),\n        isFreeBSD: isOS(freebsd),\n        isChromeOS: isOS(chromeos)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd),\n      chromeos: constant(chromeos)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return window.matchMedia(query).matches;\n    };\n    var platform = cached(function () {\n      return PlatformDetection.detect(navigator.userAgent, mediaMatch);\n    });\n    var detect$3 = function () {\n      return platform();\n    };\n\n    var userAgent = navigator.userAgent;\n    var platform$1 = detect$3();\n    var browser = platform$1.browser;\n    var os = platform$1.os;\n    var deviceType = platform$1.deviceType;\n    var webkit = /WebKit/.test(userAgent) && !browser.isEdge();\n    var fileApi = 'FormData' in window && 'FileReader' in window && 'URL' in window && !!URL.createObjectURL;\n    var windowsPhone = userAgent.indexOf('Windows Phone') !== -1;\n    var Env = {\n      opera: browser.isOpera(),\n      webkit: webkit,\n      ie: browser.isIE() || browser.isEdge() ? browser.version.major : false,\n      gecko: browser.isFirefox(),\n      mac: os.isOSX() || os.isiOS(),\n      iOS: deviceType.isiPad() || deviceType.isiPhone(),\n      android: os.isAndroid(),\n      contentEditable: true,\n      transparentSrc: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',\n      caretAfter: true,\n      range: window.getSelection && 'Range' in window,\n      documentMode: browser.isIE() ? document.documentMode || 7 : 10,\n      fileApi: fileApi,\n      ceFalse: true,\n      cacheSuffix: null,\n      container: null,\n      experimentalShadowDom: false,\n      canHaveCSP: !browser.isIE(),\n      desktop: deviceType.isDesktop(),\n      windowsPhone: windowsPhone,\n      browser: {\n        current: browser.current,\n        version: browser.version,\n        isChrome: browser.isChrome,\n        isEdge: browser.isEdge,\n        isFirefox: browser.isFirefox,\n        isIE: browser.isIE,\n        isOpera: browser.isOpera,\n        isSafari: browser.isSafari\n      },\n      os: {\n        current: os.current,\n        version: os.version,\n        isAndroid: os.isAndroid,\n        isChromeOS: os.isChromeOS,\n        isFreeBSD: os.isFreeBSD,\n        isiOS: os.isiOS,\n        isLinux: os.isLinux,\n        isOSX: os.isOSX,\n        isSolaris: os.isSolaris,\n        isWindows: os.isWindows\n      },\n      deviceType: {\n        isDesktop: deviceType.isDesktop,\n        isiPad: deviceType.isiPad,\n        isiPhone: deviceType.isiPhone,\n        isPhone: deviceType.isPhone,\n        isTablet: deviceType.isTablet,\n        isTouch: deviceType.isTouch,\n        isWebView: deviceType.isWebView\n      }\n    };\n\n    var whiteSpaceRegExp = /^\\s*|\\s*$/g;\n    var trim$1 = function (str) {\n      return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp, '');\n    };\n    var is = function (obj, type) {\n      if (!type) {\n        return obj !== undefined;\n      }\n      if (type === 'array' && isArray$1(obj)) {\n        return true;\n      }\n      return typeof obj === type;\n    };\n    var makeMap = function (items, delim, map) {\n      var i;\n      items = items || [];\n      delim = delim || ',';\n      if (typeof items === 'string') {\n        items = items.split(delim);\n      }\n      map = map || {};\n      i = items.length;\n      while (i--) {\n        map[items[i]] = {};\n      }\n      return map;\n    };\n    var hasOwnProperty$1 = function (obj, prop) {\n      return Object.prototype.hasOwnProperty.call(obj, prop);\n    };\n    var create = function (s, p, root) {\n      var self = this;\n      var sp, scn, c, de = 0;\n      s = /^((static) )?([\\w.]+)(:([\\w.]+))?/.exec(s);\n      var cn = s[3].match(/(^|\\.)(\\w+)$/i)[2];\n      var ns = self.createNS(s[3].replace(/\\.\\w+$/, ''), root);\n      if (ns[cn]) {\n        return;\n      }\n      if (s[2] === 'static') {\n        ns[cn] = p;\n        if (this.onCreate) {\n          this.onCreate(s[2], s[3], ns[cn]);\n        }\n        return;\n      }\n      if (!p[cn]) {\n        p[cn] = noop;\n        de = 1;\n      }\n      ns[cn] = p[cn];\n      self.extend(ns[cn].prototype, p);\n      if (s[5]) {\n        sp = self.resolve(s[5]).prototype;\n        scn = s[5].match(/\\.(\\w+)$/i)[1];\n        c = ns[cn];\n        if (de) {\n          ns[cn] = function () {\n            return sp[scn].apply(this, arguments);\n          };\n        } else {\n          ns[cn] = function () {\n            this.parent = sp[scn];\n            return c.apply(this, arguments);\n          };\n        }\n        ns[cn].prototype[cn] = ns[cn];\n        self.each(sp, function (f, n) {\n          ns[cn].prototype[n] = sp[n];\n        });\n        self.each(p, function (f, n) {\n          if (sp[n]) {\n            ns[cn].prototype[n] = function () {\n              this.parent = sp[n];\n              return f.apply(this, arguments);\n            };\n          } else {\n            if (n !== cn) {\n              ns[cn].prototype[n] = f;\n            }\n          }\n        });\n      }\n      self.each(p.static, function (f, n) {\n        ns[cn][n] = f;\n      });\n    };\n    var extend = function (obj) {\n      var exts = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        exts[_i - 1] = arguments[_i];\n      }\n      for (var i = 0; i < exts.length; i++) {\n        var ext = exts[i];\n        for (var name_1 in ext) {\n          if (ext.hasOwnProperty(name_1)) {\n            var value = ext[name_1];\n            if (value !== undefined) {\n              obj[name_1] = value;\n            }\n          }\n        }\n      }\n      return obj;\n    };\n    var walk = function (o, f, n, s) {\n      s = s || this;\n      if (o) {\n        if (n) {\n          o = o[n];\n        }\n        each$2(o, function (o, i) {\n          if (f.call(s, o, i, n) === false) {\n            return false;\n          }\n          walk(o, f, n, s);\n        });\n      }\n    };\n    var createNS = function (n, o) {\n      var i, v;\n      o = o || window;\n      n = n.split('.');\n      for (i = 0; i < n.length; i++) {\n        v = n[i];\n        if (!o[v]) {\n          o[v] = {};\n        }\n        o = o[v];\n      }\n      return o;\n    };\n    var resolve = function (n, o) {\n      var i, l;\n      o = o || window;\n      n = n.split('.');\n      for (i = 0, l = n.length; i < l; i++) {\n        o = o[n[i]];\n        if (!o) {\n          break;\n        }\n      }\n      return o;\n    };\n    var explode = function (s, d) {\n      if (!s || is(s, 'array')) {\n        return s;\n      }\n      return map$2(s.split(d || ','), trim$1);\n    };\n    var _addCacheSuffix = function (url) {\n      var cacheSuffix = Env.cacheSuffix;\n      if (cacheSuffix) {\n        url += (url.indexOf('?') === -1 ? '?' : '&') + cacheSuffix;\n      }\n      return url;\n    };\n    var Tools = {\n      trim: trim$1,\n      isArray: isArray$1,\n      is: is,\n      toArray: toArray,\n      makeMap: makeMap,\n      each: each$2,\n      map: map$2,\n      grep: filter$2,\n      inArray: indexOf$1,\n      hasOwn: hasOwnProperty$1,\n      extend: extend,\n      create: create,\n      walk: walk,\n      createNS: createNS,\n      resolve: resolve,\n      explode: explode,\n      _addCacheSuffix: _addCacheSuffix\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var toArray$1 = function (target, f) {\n      var r = [];\n      var recurse = function (e) {\n        r.push(e);\n        return f(e);\n      };\n      var cur = f(target);\n      do {\n        cur = cur.bind(recurse);\n      } while (cur.isSome());\n      return r;\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n\n    var COMMENT = 8;\n    var DOCUMENT = 9;\n    var DOCUMENT_FRAGMENT = 11;\n    var ELEMENT = 1;\n    var TEXT = 3;\n\n    var is$1 = function (element, selector) {\n      var dom = element.dom;\n      if (dom.nodeType !== ELEMENT) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), SugarElement.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n    };\n\n    var eq$2 = function (e1, e2) {\n      return e1.dom === e2.dom;\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom;\n      var d2 = e2.dom;\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return documentPositionContainedBy(e1.dom, e2.dom);\n    };\n    var contains$2 = function (e1, e2) {\n      return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n    };\n\n    var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom.nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom.nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isComment = function (element) {\n      return type(element) === COMMENT || name(element) === '#comment';\n    };\n    var isElement = isType$1(ELEMENT);\n    var isText = isType$1(TEXT);\n    var isDocument = isType$1(DOCUMENT);\n    var isDocumentFragment = isType$1(DOCUMENT_FRAGMENT);\n\n    var owner = function (element) {\n      return SugarElement.fromDom(element.dom.ownerDocument);\n    };\n    var documentOrOwner = function (dos) {\n      return isDocument(dos) ? dos : owner(dos);\n    };\n    var documentElement = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);\n    };\n    var defaultView = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n    };\n    var parent = function (element) {\n      return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n    };\n    var parents = function (element, isRoot) {\n      var stop = isFunction(isRoot) ? isRoot : never;\n      var dom = element.dom;\n      var ret = [];\n      while (dom.parentNode !== null && dom.parentNode !== undefined) {\n        var rawParent = dom.parentNode;\n        var p = SugarElement.fromDom(rawParent);\n        ret.push(p);\n        if (stop(p) === true) {\n          break;\n        } else {\n          dom = rawParent;\n        }\n      }\n      return ret;\n    };\n    var siblings = function (element) {\n      var filterSelf = function (elements) {\n        return filter(elements, function (x) {\n          return !eq$2(element, x);\n        });\n      };\n      return parent(element).map(children).map(filterSelf).getOr([]);\n    };\n    var prevSibling = function (element) {\n      return Optional.from(element.dom.previousSibling).map(SugarElement.fromDom);\n    };\n    var nextSibling = function (element) {\n      return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n    };\n    var prevSiblings = function (element) {\n      return reverse(toArray$1(element, prevSibling));\n    };\n    var nextSiblings = function (element) {\n      return toArray$1(element, nextSibling);\n    };\n    var children = function (element) {\n      return map(element.dom.childNodes, SugarElement.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom.childNodes;\n      return Optional.from(cs[index]).map(SugarElement.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n    var lastChild = function (element) {\n      return child(element, element.dom.childNodes.length - 1);\n    };\n    var childNodesCount = function (element) {\n      return element.dom.childNodes.length;\n    };\n\n    var getHead = function (doc) {\n      var b = doc.dom.head;\n      if (b === null || b === undefined) {\n        throw new Error('Head is not available yet');\n      }\n      return SugarElement.fromDom(b);\n    };\n\n    var isShadowRoot = function (dos) {\n      return isDocumentFragment(dos) && isNonNullable(dos.dom.host);\n    };\n    var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n    var isSupported = constant(supported);\n    var getRootNode = supported ? function (e) {\n      return SugarElement.fromDom(e.dom.getRootNode());\n    } : documentOrOwner;\n    var getStyleContainer = function (dos) {\n      return isShadowRoot(dos) ? dos : getHead(documentOrOwner(dos));\n    };\n    var getShadowRoot = function (e) {\n      var r = getRootNode(e);\n      return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n    };\n    var getShadowHost = function (e) {\n      return SugarElement.fromDom(e.dom.host);\n    };\n    var getOriginalEventTarget = function (event) {\n      if (isSupported() && isNonNullable(event.target)) {\n        var el = SugarElement.fromDom(event.target);\n        if (isElement(el) && isOpenShadowHost(el)) {\n          if (event.composed && event.composedPath) {\n            var composedPath = event.composedPath();\n            if (composedPath) {\n              return head(composedPath);\n            }\n          }\n        }\n      }\n      return Optional.from(event.target);\n    };\n    var isOpenShadowHost = function (element) {\n      return isNonNullable(element.dom.shadowRoot);\n    };\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom.insertBefore(element.dom, marker.dom);\n      });\n    };\n    var after = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append(v, element);\n        });\n      }, function (v) {\n        before(v, element);\n      });\n    };\n    var prepend = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append(parent, element);\n      }, function (v) {\n        parent.dom.insertBefore(element.dom, v.dom);\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom.appendChild(element.dom);\n    };\n    var wrap = function (element, wrapper) {\n      before(element, wrapper);\n      append(wrapper, element);\n    };\n\n    var before$1 = function (marker, elements) {\n      each(elements, function (x) {\n        before(marker, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom.textContent = '';\n      each(children(element), function (rogue) {\n        remove(rogue);\n      });\n    };\n    var remove = function (element) {\n      var dom = element.dom;\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n    var unwrap = function (wrapper) {\n      var children$1 = children(wrapper);\n      if (children$1.length > 0) {\n        before$1(wrapper, children$1);\n      }\n      remove(wrapper);\n    };\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom.parentNode : element.dom;\n      if (dom === undefined || dom === null || dom.ownerDocument === null) {\n        return false;\n      }\n      var doc = dom.ownerDocument;\n      return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n        return doc.body.contains(dom);\n      }, compose1(inBody, getShadowHost));\n    };\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: left,\n        top: top,\n        translate: translate\n      };\n    };\n    var SugarPosition = r;\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return SugarPosition(box.left, box.top);\n    };\n    var firstDefinedOrZero = function (a, b) {\n      if (a !== undefined) {\n        return a;\n      } else {\n        return b !== undefined ? b : 0;\n      }\n    };\n    var absolute = function (element) {\n      var doc = element.dom.ownerDocument;\n      var body = doc.body;\n      var win = doc.defaultView;\n      var html = doc.documentElement;\n      if (body === element.dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n    var viewport = function (element) {\n      var dom = element.dom;\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      if (body === dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      if (!inBody(element)) {\n        return SugarPosition(0, 0);\n      }\n      return boxPosition(dom);\n    };\n\n    var get$2 = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return SugarPosition(x, y);\n    };\n    var to = function (x, y, _DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var win = doc.defaultView;\n      if (win) {\n        win.scrollTo(x, y);\n      }\n    };\n    var intoView = function (element, alignToTop) {\n      var isSafari = detect$3().browser.isSafari();\n      if (isSafari && isFunction(element.dom.scrollIntoViewIfNeeded)) {\n        element.dom.scrollIntoViewIfNeeded(false);\n      } else {\n        element.dom.scrollIntoView(alignToTop);\n      }\n    };\n\n    var get$3 = function (_win) {\n      var win = _win === undefined ? window : _win;\n      return Optional.from(win['visualViewport']);\n    };\n    var bounds = function (x, y, width, height) {\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        right: x + width,\n        bottom: y + height\n      };\n    };\n    var getBounds = function (_win) {\n      var win = _win === undefined ? window : _win;\n      var doc = win.document;\n      var scroll = get$2(SugarElement.fromDom(doc));\n      return get$3(win).fold(function () {\n        var html = win.document.documentElement;\n        var width = html.clientWidth;\n        var height = html.clientHeight;\n        return bounds(scroll.left, scroll.top, width, height);\n      }, function (visualViewport) {\n        return bounds(Math.max(visualViewport.pageLeft, scroll.left), Math.max(visualViewport.pageTop, scroll.top), visualViewport.width, visualViewport.height);\n      });\n    };\n\n    var isNodeType = function (type) {\n      return function (node) {\n        return !!node && node.nodeType === type;\n      };\n    };\n    var isRestrictedNode = function (node) {\n      return !!node && !Object.getPrototypeOf(node);\n    };\n    var isElement$1 = isNodeType(1);\n    var matchNodeNames = function (names) {\n      var lowercasedNames = names.map(function (s) {\n        return s.toLowerCase();\n      });\n      return function (node) {\n        if (node && node.nodeName) {\n          var nodeName = node.nodeName.toLowerCase();\n          return contains(lowercasedNames, nodeName);\n        }\n        return false;\n      };\n    };\n    var matchStyleValues = function (name, values) {\n      var items = values.toLowerCase().split(' ');\n      return function (node) {\n        var i, cssValue;\n        if (isElement$1(node)) {\n          for (i = 0; i < items.length; i++) {\n            var computed = node.ownerDocument.defaultView.getComputedStyle(node, null);\n            cssValue = computed ? computed.getPropertyValue(name) : null;\n            if (cssValue === items[i]) {\n              return true;\n            }\n          }\n        }\n        return false;\n      };\n    };\n    var hasAttribute = function (attrName) {\n      return function (node) {\n        return isElement$1(node) && node.hasAttribute(attrName);\n      };\n    };\n    var hasAttributeValue = function (attrName, attrValue) {\n      return function (node) {\n        return isElement$1(node) && node.getAttribute(attrName) === attrValue;\n      };\n    };\n    var isBogus = function (node) {\n      return isElement$1(node) && node.hasAttribute('data-mce-bogus');\n    };\n    var isBogusAll = function (node) {\n      return isElement$1(node) && node.getAttribute('data-mce-bogus') === 'all';\n    };\n    var isTable = function (node) {\n      return isElement$1(node) && node.tagName === 'TABLE';\n    };\n    var hasContentEditableState = function (value) {\n      return function (node) {\n        if (isElement$1(node)) {\n          if (node.contentEditable === value) {\n            return true;\n          }\n          if (node.getAttribute('data-mce-contenteditable') === value) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var isTextareaOrInput = matchNodeNames([\n      'textarea',\n      'input'\n    ]);\n    var isText$1 = isNodeType(3);\n    var isComment$1 = isNodeType(8);\n    var isDocument$1 = isNodeType(9);\n    var isDocumentFragment$1 = isNodeType(11);\n    var isBr = matchNodeNames(['br']);\n    var isImg = matchNodeNames(['img']);\n    var isContentEditableTrue = hasContentEditableState('true');\n    var isContentEditableFalse = hasContentEditableState('false');\n    var isTableCell = matchNodeNames([\n      'td',\n      'th'\n    ]);\n    var isMedia = matchNodeNames([\n      'video',\n      'audio',\n      'object',\n      'embed'\n    ]);\n\n    var isSupported$1 = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom, key, value);\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom;\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var get$4 = function (element, key) {\n      var v = element.dom.getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var getOpt = function (element, key) {\n      return Optional.from(get$4(element, key));\n    };\n    var has$1 = function (element, key) {\n      var dom = element.dom;\n      return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n    };\n    var remove$1 = function (element, key) {\n      element.dom.removeAttribute(key);\n    };\n    var clone = function (element) {\n      return foldl(element.dom.attributes, function (acc, attr) {\n        acc[attr.name] = attr.value;\n        return acc;\n      }, {});\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported$1(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var setAll$1 = function (element, css) {\n      var dom = element.dom;\n      each$1(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n    var get$5 = function (element, property) {\n      var dom = element.dom;\n      var styles = window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported$1(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw = function (element, property) {\n      var dom = element.dom;\n      var raw = getUnsafeProperty(dom, property);\n      return Optional.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var getAllRaw = function (element) {\n      var css = {};\n      var dom = element.dom;\n      if (isSupported$1(dom)) {\n        for (var i = 0; i < dom.style.length; i++) {\n          var ruleName = dom.style.item(i);\n          css[ruleName] = dom.style[ruleName];\n        }\n      }\n      return css;\n    };\n    var reflow = function (e) {\n      return e.dom.offsetWidth;\n    };\n\n    var browser$1 = detect$3().browser;\n    var firstElement = function (nodes) {\n      return find(nodes, isElement);\n    };\n    var getTableCaptionDeltaY = function (elm) {\n      if (browser$1.isFirefox() && name(elm) === 'table') {\n        return firstElement(children(elm)).filter(function (elm) {\n          return name(elm) === 'caption';\n        }).bind(function (caption) {\n          return firstElement(nextSiblings(caption)).map(function (body) {\n            var bodyTop = body.dom.offsetTop;\n            var captionTop = caption.dom.offsetTop;\n            var captionHeight = caption.dom.offsetHeight;\n            return bodyTop <= captionTop ? -captionHeight : 0;\n          });\n        }).getOr(0);\n      } else {\n        return 0;\n      }\n    };\n    var hasChild = function (elm, child) {\n      return elm.children && contains(elm.children, child);\n    };\n    var getPos = function (body, elm, rootElm) {\n      var x = 0, y = 0, offsetParent;\n      var doc = body.ownerDocument;\n      var pos;\n      rootElm = rootElm ? rootElm : body;\n      if (elm) {\n        if (rootElm === body && elm.getBoundingClientRect && get$5(SugarElement.fromDom(body), 'position') === 'static') {\n          pos = elm.getBoundingClientRect();\n          x = pos.left + (doc.documentElement.scrollLeft || body.scrollLeft) - doc.documentElement.clientLeft;\n          y = pos.top + (doc.documentElement.scrollTop || body.scrollTop) - doc.documentElement.clientTop;\n          return {\n            x: x,\n            y: y\n          };\n        }\n        offsetParent = elm;\n        while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n          x += offsetParent.offsetLeft || 0;\n          y += offsetParent.offsetTop || 0;\n          offsetParent = offsetParent.offsetParent;\n        }\n        offsetParent = elm.parentNode;\n        while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n          x -= offsetParent.scrollLeft || 0;\n          y -= offsetParent.scrollTop || 0;\n          offsetParent = offsetParent.parentNode;\n        }\n        y += getTableCaptionDeltaY(SugarElement.fromDom(elm));\n      }\n      return {\n        x: x,\n        y: y\n      };\n    };\n\n    var exports$1 = {}, module$1 = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (f) {\n        if (typeof exports === 'object' && typeof module !== 'undefined') {\n          module.exports = f();\n        } else if (typeof define === 'function' && define.amd) {\n          define([], f);\n        } else {\n          var g;\n          if (typeof window !== 'undefined') {\n            g = window;\n          } else if (typeof global !== 'undefined') {\n            g = global;\n          } else if (typeof self !== 'undefined') {\n            g = self;\n          } else {\n            g = this;\n          }\n          g.EphoxContactWrapper = f();\n        }\n      }(function () {\n        return function () {\n          function r(e, n, t) {\n            function o(i, f) {\n              if (!n[i]) {\n                if (!e[i]) {\n                  var c = 'function' == typeof require && require;\n                  if (!f && c)\n                    return c(i, !0);\n                  if (u)\n                    return u(i, !0);\n                  var a = new Error('Cannot find module \\'' + i + '\\'');\n                  throw a.code = 'MODULE_NOT_FOUND', a;\n                }\n                var p = n[i] = { exports: {} };\n                e[i][0].call(p.exports, function (r) {\n                  var n = e[i][1][r];\n                  return o(n || r);\n                }, p, p.exports, r, e, n, t);\n              }\n              return n[i].exports;\n            }\n            for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++)\n              o(t[i]);\n            return o;\n          }\n          return r;\n        }()({\n          1: [\n            function (require, module, exports) {\n              var process = module.exports = {};\n              var cachedSetTimeout;\n              var cachedClearTimeout;\n              function defaultSetTimout() {\n                throw new Error('setTimeout has not been defined');\n              }\n              function defaultClearTimeout() {\n                throw new Error('clearTimeout has not been defined');\n              }\n              (function () {\n                try {\n                  if (typeof setTimeout === 'function') {\n                    cachedSetTimeout = setTimeout;\n                  } else {\n                    cachedSetTimeout = defaultSetTimout;\n                  }\n                } catch (e) {\n                  cachedSetTimeout = defaultSetTimout;\n                }\n                try {\n                  if (typeof clearTimeout === 'function') {\n                    cachedClearTimeout = clearTimeout;\n                  } else {\n                    cachedClearTimeout = defaultClearTimeout;\n                  }\n                } catch (e) {\n                  cachedClearTimeout = defaultClearTimeout;\n                }\n              }());\n              function runTimeout(fun) {\n                if (cachedSetTimeout === setTimeout) {\n                  return setTimeout(fun, 0);\n                }\n                if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n                  cachedSetTimeout = setTimeout;\n                  return setTimeout(fun, 0);\n                }\n                try {\n                  return cachedSetTimeout(fun, 0);\n                } catch (e) {\n                  try {\n                    return cachedSetTimeout.call(null, fun, 0);\n                  } catch (e) {\n                    return cachedSetTimeout.call(this, fun, 0);\n                  }\n                }\n              }\n              function runClearTimeout(marker) {\n                if (cachedClearTimeout === clearTimeout) {\n                  return clearTimeout(marker);\n                }\n                if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n                  cachedClearTimeout = clearTimeout;\n                  return clearTimeout(marker);\n                }\n                try {\n                  return cachedClearTimeout(marker);\n                } catch (e) {\n                  try {\n                    return cachedClearTimeout.call(null, marker);\n                  } catch (e) {\n                    return cachedClearTimeout.call(this, marker);\n                  }\n                }\n              }\n              var queue = [];\n              var draining = false;\n              var currentQueue;\n              var queueIndex = -1;\n              function cleanUpNextTick() {\n                if (!draining || !currentQueue) {\n                  return;\n                }\n                draining = false;\n                if (currentQueue.length) {\n                  queue = currentQueue.concat(queue);\n                } else {\n                  queueIndex = -1;\n                }\n                if (queue.length) {\n                  drainQueue();\n                }\n              }\n              function drainQueue() {\n                if (draining) {\n                  return;\n                }\n                var timeout = runTimeout(cleanUpNextTick);\n                draining = true;\n                var len = queue.length;\n                while (len) {\n                  currentQueue = queue;\n                  queue = [];\n                  while (++queueIndex < len) {\n                    if (currentQueue) {\n                      currentQueue[queueIndex].run();\n                    }\n                  }\n                  queueIndex = -1;\n                  len = queue.length;\n                }\n                currentQueue = null;\n                draining = false;\n                runClearTimeout(timeout);\n              }\n              process.nextTick = function (fun) {\n                var args = new Array(arguments.length - 1);\n                if (arguments.length > 1) {\n                  for (var i = 1; i < arguments.length; i++) {\n                    args[i - 1] = arguments[i];\n                  }\n                }\n                queue.push(new Item(fun, args));\n                if (queue.length === 1 && !draining) {\n                  runTimeout(drainQueue);\n                }\n              };\n              function Item(fun, array) {\n                this.fun = fun;\n                this.array = array;\n              }\n              Item.prototype.run = function () {\n                this.fun.apply(null, this.array);\n              };\n              process.title = 'browser';\n              process.browser = true;\n              process.env = {};\n              process.argv = [];\n              process.version = '';\n              process.versions = {};\n              function noop() {\n              }\n              process.on = noop;\n              process.addListener = noop;\n              process.once = noop;\n              process.off = noop;\n              process.removeListener = noop;\n              process.removeAllListeners = noop;\n              process.emit = noop;\n              process.prependListener = noop;\n              process.prependOnceListener = noop;\n              process.listeners = function (name) {\n                return [];\n              };\n              process.binding = function (name) {\n                throw new Error('process.binding is not supported');\n              };\n              process.cwd = function () {\n                return '/';\n              };\n              process.chdir = function (dir) {\n                throw new Error('process.chdir is not supported');\n              };\n              process.umask = function () {\n                return 0;\n              };\n            },\n            {}\n          ],\n          2: [\n            function (require, module, exports) {\n              (function (setImmediate) {\n                (function (root) {\n                  var setTimeoutFunc = setTimeout;\n                  function noop() {\n                  }\n                  function bind(fn, thisArg) {\n                    return function () {\n                      fn.apply(thisArg, arguments);\n                    };\n                  }\n                  function Promise(fn) {\n                    if (typeof this !== 'object')\n                      throw new TypeError('Promises must be constructed via new');\n                    if (typeof fn !== 'function')\n                      throw new TypeError('not a function');\n                    this._state = 0;\n                    this._handled = false;\n                    this._value = undefined;\n                    this._deferreds = [];\n                    doResolve(fn, this);\n                  }\n                  function handle(self, deferred) {\n                    while (self._state === 3) {\n                      self = self._value;\n                    }\n                    if (self._state === 0) {\n                      self._deferreds.push(deferred);\n                      return;\n                    }\n                    self._handled = true;\n                    Promise._immediateFn(function () {\n                      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                      if (cb === null) {\n                        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                        return;\n                      }\n                      var ret;\n                      try {\n                        ret = cb(self._value);\n                      } catch (e) {\n                        reject(deferred.promise, e);\n                        return;\n                      }\n                      resolve(deferred.promise, ret);\n                    });\n                  }\n                  function resolve(self, newValue) {\n                    try {\n                      if (newValue === self)\n                        throw new TypeError('A promise cannot be resolved with itself.');\n                      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                        var then = newValue.then;\n                        if (newValue instanceof Promise) {\n                          self._state = 3;\n                          self._value = newValue;\n                          finale(self);\n                          return;\n                        } else if (typeof then === 'function') {\n                          doResolve(bind(then, newValue), self);\n                          return;\n                        }\n                      }\n                      self._state = 1;\n                      self._value = newValue;\n                      finale(self);\n                    } catch (e) {\n                      reject(self, e);\n                    }\n                  }\n                  function reject(self, newValue) {\n                    self._state = 2;\n                    self._value = newValue;\n                    finale(self);\n                  }\n                  function finale(self) {\n                    if (self._state === 2 && self._deferreds.length === 0) {\n                      Promise._immediateFn(function () {\n                        if (!self._handled) {\n                          Promise._unhandledRejectionFn(self._value);\n                        }\n                      });\n                    }\n                    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                      handle(self, self._deferreds[i]);\n                    }\n                    self._deferreds = null;\n                  }\n                  function Handler(onFulfilled, onRejected, promise) {\n                    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                    this.promise = promise;\n                  }\n                  function doResolve(fn, self) {\n                    var done = false;\n                    try {\n                      fn(function (value) {\n                        if (done)\n                          return;\n                        done = true;\n                        resolve(self, value);\n                      }, function (reason) {\n                        if (done)\n                          return;\n                        done = true;\n                        reject(self, reason);\n                      });\n                    } catch (ex) {\n                      if (done)\n                        return;\n                      done = true;\n                      reject(self, ex);\n                    }\n                  }\n                  Promise.prototype['catch'] = function (onRejected) {\n                    return this.then(null, onRejected);\n                  };\n                  Promise.prototype.then = function (onFulfilled, onRejected) {\n                    var prom = new this.constructor(noop);\n                    handle(this, new Handler(onFulfilled, onRejected, prom));\n                    return prom;\n                  };\n                  Promise.all = function (arr) {\n                    var args = Array.prototype.slice.call(arr);\n                    return new Promise(function (resolve, reject) {\n                      if (args.length === 0)\n                        return resolve([]);\n                      var remaining = args.length;\n                      function res(i, val) {\n                        try {\n                          if (val && (typeof val === 'object' || typeof val === 'function')) {\n                            var then = val.then;\n                            if (typeof then === 'function') {\n                              then.call(val, function (val) {\n                                res(i, val);\n                              }, reject);\n                              return;\n                            }\n                          }\n                          args[i] = val;\n                          if (--remaining === 0) {\n                            resolve(args);\n                          }\n                        } catch (ex) {\n                          reject(ex);\n                        }\n                      }\n                      for (var i = 0; i < args.length; i++) {\n                        res(i, args[i]);\n                      }\n                    });\n                  };\n                  Promise.resolve = function (value) {\n                    if (value && typeof value === 'object' && value.constructor === Promise) {\n                      return value;\n                    }\n                    return new Promise(function (resolve) {\n                      resolve(value);\n                    });\n                  };\n                  Promise.reject = function (value) {\n                    return new Promise(function (resolve, reject) {\n                      reject(value);\n                    });\n                  };\n                  Promise.race = function (values) {\n                    return new Promise(function (resolve, reject) {\n                      for (var i = 0, len = values.length; i < len; i++) {\n                        values[i].then(resolve, reject);\n                      }\n                    });\n                  };\n                  Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                    setImmediate(fn);\n                  } : function (fn) {\n                    setTimeoutFunc(fn, 0);\n                  };\n                  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                    if (typeof console !== 'undefined' && console) {\n                      console.warn('Possible Unhandled Promise Rejection:', err);\n                    }\n                  };\n                  Promise._setImmediateFn = function _setImmediateFn(fn) {\n                    Promise._immediateFn = fn;\n                  };\n                  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                    Promise._unhandledRejectionFn = fn;\n                  };\n                  if (typeof module !== 'undefined' && module.exports) {\n                    module.exports = Promise;\n                  } else if (!root.Promise) {\n                    root.Promise = Promise;\n                  }\n                }(this));\n              }.call(this, require('timers').setImmediate));\n            },\n            { 'timers': 3 }\n          ],\n          3: [\n            function (require, module, exports) {\n              (function (setImmediate, clearImmediate) {\n                var nextTick = require('process/browser.js').nextTick;\n                var apply = Function.prototype.apply;\n                var slice = Array.prototype.slice;\n                var immediateIds = {};\n                var nextImmediateId = 0;\n                exports.setTimeout = function () {\n                  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n                };\n                exports.setInterval = function () {\n                  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n                };\n                exports.clearTimeout = exports.clearInterval = function (timeout) {\n                  timeout.close();\n                };\n                function Timeout(id, clearFn) {\n                  this._id = id;\n                  this._clearFn = clearFn;\n                }\n                Timeout.prototype.unref = Timeout.prototype.ref = function () {\n                };\n                Timeout.prototype.close = function () {\n                  this._clearFn.call(window, this._id);\n                };\n                exports.enroll = function (item, msecs) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = msecs;\n                };\n                exports.unenroll = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = -1;\n                };\n                exports._unrefActive = exports.active = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  var msecs = item._idleTimeout;\n                  if (msecs >= 0) {\n                    item._idleTimeoutId = setTimeout(function onTimeout() {\n                      if (item._onTimeout)\n                        item._onTimeout();\n                    }, msecs);\n                  }\n                };\n                exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n                  var id = nextImmediateId++;\n                  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n                  immediateIds[id] = true;\n                  nextTick(function onNextTick() {\n                    if (immediateIds[id]) {\n                      if (args) {\n                        fn.apply(null, args);\n                      } else {\n                        fn.call(null);\n                      }\n                      exports.clearImmediate(id);\n                    }\n                  });\n                  return id;\n                };\n                exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n                  delete immediateIds[id];\n                };\n              }.call(this, require('timers').setImmediate, require('timers').clearImmediate));\n            },\n            {\n              'process/browser.js': 1,\n              'timers': 3\n            }\n          ],\n          4: [\n            function (require, module, exports) {\n              var promisePolyfill = require('promise-polyfill');\n              var Global = function () {\n                if (typeof window !== 'undefined') {\n                  return window;\n                } else {\n                  return Function('return this;')();\n                }\n              }();\n              module.exports = { boltExport: Global.Promise || promisePolyfill };\n            },\n            { 'promise-polyfill': 2 }\n          ]\n        }, {}, [4])(4);\n      }));\n    }(undefined, exports$1, module$1, undefined));\n    var Promise = module$1.exports.boltExport;\n\n    var nu$3 = function (baseFn) {\n      var data = Optional.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu$3(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        if (!isReady()) {\n          data = Optional.some(x);\n          run(callbacks);\n          callbacks = [];\n        }\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure = function (a) {\n      return nu$3(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu$3,\n      pure: pure\n    };\n\n    var errorReporter = function (err) {\n      setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu$4 = function (baseFn) {\n      return make(function () {\n        return new Promise(baseFn);\n      });\n    };\n    var pure$1 = function (a) {\n      return make(function () {\n        return Promise.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu$4,\n      pure: pure$1\n    };\n\n    var par = function (asyncValues, nu) {\n      return nu(function (callback) {\n        var r = [];\n        var count = 0;\n        var cb = function (i) {\n          return function (value) {\n            r[i] = value;\n            count++;\n            if (count >= asyncValues.length) {\n              callback(r);\n            }\n          };\n        };\n        if (asyncValues.length === 0) {\n          callback([]);\n        } else {\n          each(asyncValues, function (asyncValue, i) {\n            asyncValue.get(cb(i));\n          });\n        }\n      });\n    };\n\n    var par$1 = function (futures) {\n      return par(futures, Future.nu);\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (_opt) {\n        return value(o);\n      };\n      var orThunk = function (_f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (_f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOptional = function () {\n        return Optional.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOptional: toOptional\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (_f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (_f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOptional: Optional.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var generate = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          var argLength = args.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              var foldArgs = [];\n              for (var _i = 0; _i < arguments.length; _i++) {\n                foldArgs[_i] = arguments[_i];\n              }\n              if (foldArgs.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n              }\n              var target = foldArgs[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate };\n\n    var comparison = Adt.generate([\n      {\n        bothErrors: [\n          'error1',\n          'error2'\n        ]\n      },\n      {\n        firstError: [\n          'error1',\n          'value2'\n        ]\n      },\n      {\n        secondError: [\n          'value1',\n          'error2'\n        ]\n      },\n      {\n        bothValues: [\n          'value1',\n          'value2'\n        ]\n      }\n    ]);\n    var unite = function (result) {\n      return result.fold(identity, identity);\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      if (is(scope, a)) {\n        return Optional.some(scope);\n      } else if (isFunction(isRoot) && isRoot(scope)) {\n        return Optional.none();\n      } else {\n        return ancestor(scope, a, isRoot);\n      }\n    }\n\n    var ancestor = function (scope, predicate, isRoot) {\n      var element = scope.dom;\n      var stop = isFunction(isRoot) ? isRoot : never;\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        if (predicate(el)) {\n          return Optional.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n    };\n    var sibling = function (scope, predicate) {\n      var element = scope.dom;\n      if (!element.parentNode) {\n        return Optional.none();\n      }\n      return child$1(SugarElement.fromDom(element.parentNode), function (x) {\n        return !eq$2(scope, x) && predicate(x);\n      });\n    };\n    var child$1 = function (scope, predicate) {\n      var pred = function (node) {\n        return predicate(SugarElement.fromDom(node));\n      };\n      var result = find(scope.dom.childNodes, pred);\n      return result.map(SugarElement.fromDom);\n    };\n\n    var ancestor$1 = function (scope, selector, isRoot) {\n      return ancestor(scope, function (e) {\n        return is$1(e, selector);\n      }, isRoot);\n    };\n    var descendant = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$1 = function (scope, selector, isRoot) {\n      var is = function (element, selector) {\n        return is$1(element, selector);\n      };\n      return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n    };\n\n    var promise = function () {\n      var bind = function (fn, thisArg) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          fn.apply(thisArg, args);\n        };\n      };\n      var isArray = Array.isArray || function (value) {\n        return Object.prototype.toString.call(value) === '[object Array]';\n      };\n      var Promise = function (fn) {\n        if (typeof this !== 'object') {\n          throw new TypeError('Promises must be constructed via new');\n        }\n        if (typeof fn !== 'function') {\n          throw new TypeError('not a function');\n        }\n        this._state = null;\n        this._value = null;\n        this._deferreds = [];\n        doResolve(fn, bind(resolve, this), bind(reject, this));\n      };\n      var asap = Promise.immediateFn || typeof setImmediate === 'function' && setImmediate || function (fn) {\n        return setTimeout(fn, 1);\n      };\n      function handle(deferred) {\n        var me = this;\n        if (this._state === null) {\n          this._deferreds.push(deferred);\n          return;\n        }\n        asap(function () {\n          var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n          if (cb === null) {\n            (me._state ? deferred.resolve : deferred.reject)(me._value);\n            return;\n          }\n          var ret;\n          try {\n            ret = cb(me._value);\n          } catch (e) {\n            deferred.reject(e);\n            return;\n          }\n          deferred.resolve(ret);\n        });\n      }\n      function resolve(newValue) {\n        try {\n          if (newValue === this) {\n            throw new TypeError('A promise cannot be resolved with itself.');\n          }\n          if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n            var then = newValue.then;\n            if (typeof then === 'function') {\n              doResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n              return;\n            }\n          }\n          this._state = true;\n          this._value = newValue;\n          finale.call(this);\n        } catch (e) {\n          reject.call(this, e);\n        }\n      }\n      function reject(newValue) {\n        this._state = false;\n        this._value = newValue;\n        finale.call(this);\n      }\n      function finale() {\n        for (var i = 0, len = this._deferreds.length; i < len; i++) {\n          handle.call(this, this._deferreds[i]);\n        }\n        this._deferreds = null;\n      }\n      function Handler(onFulfilled, onRejected, resolve, reject) {\n        this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n        this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n        this.resolve = resolve;\n        this.reject = reject;\n      }\n      var doResolve = function (fn, onFulfilled, onRejected) {\n        var done = false;\n        try {\n          fn(function (value) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onFulfilled(value);\n          }, function (reason) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onRejected(reason);\n          });\n        } catch (ex) {\n          if (done) {\n            return;\n          }\n          done = true;\n          onRejected(ex);\n        }\n      };\n      Promise.prototype.catch = function (onRejected) {\n        return this.then(null, onRejected);\n      };\n      Promise.prototype.then = function (onFulfilled, onRejected) {\n        var me = this;\n        return new Promise(function (resolve, reject) {\n          handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n        });\n      };\n      Promise.all = function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        var args = Array.prototype.slice.call(values.length === 1 && isArray(values[0]) ? values[0] : values);\n        return new Promise(function (resolve, reject) {\n          if (args.length === 0) {\n            return resolve([]);\n          }\n          var remaining = args.length;\n          var res = function (i, val) {\n            try {\n              if (val && (typeof val === 'object' || typeof val === 'function')) {\n                var then = val.then;\n                if (typeof then === 'function') {\n                  then.call(val, function (val) {\n                    res(i, val);\n                  }, reject);\n                  return;\n                }\n              }\n              args[i] = val;\n              if (--remaining === 0) {\n                resolve(args);\n              }\n            } catch (ex) {\n              reject(ex);\n            }\n          };\n          for (var i = 0; i < args.length; i++) {\n            res(i, args[i]);\n          }\n        });\n      };\n      Promise.resolve = function (value) {\n        if (value && typeof value === 'object' && value.constructor === Promise) {\n          return value;\n        }\n        return new Promise(function (resolve) {\n          resolve(value);\n        });\n      };\n      Promise.reject = function (value) {\n        return new Promise(function (resolve, reject) {\n          reject(value);\n        });\n      };\n      Promise.race = function (values) {\n        return new Promise(function (resolve, reject) {\n          for (var i = 0, len = values.length; i < len; i++) {\n            values[i].then(resolve, reject);\n          }\n        });\n      };\n      return Promise;\n    };\n    var promiseObj = window.Promise ? window.Promise : promise();\n\n    var requestAnimationFramePromise;\n    var requestAnimationFrame = function (callback, element) {\n      var requestAnimationFrameFunc = window.requestAnimationFrame;\n      var vendors = [\n        'ms',\n        'moz',\n        'webkit'\n      ];\n      var featurefill = function (cb) {\n        window.setTimeout(cb, 0);\n      };\n      for (var i = 0; i < vendors.length && !requestAnimationFrameFunc; i++) {\n        requestAnimationFrameFunc = window[vendors[i] + 'RequestAnimationFrame'];\n      }\n      if (!requestAnimationFrameFunc) {\n        requestAnimationFrameFunc = featurefill;\n      }\n      requestAnimationFrameFunc(callback, element);\n    };\n    var wrappedSetTimeout = function (callback, time) {\n      if (typeof time !== 'number') {\n        time = 0;\n      }\n      return setTimeout(callback, time);\n    };\n    var wrappedSetInterval = function (callback, time) {\n      if (typeof time !== 'number') {\n        time = 1;\n      }\n      return setInterval(callback, time);\n    };\n    var wrappedClearTimeout = function (id) {\n      return clearTimeout(id);\n    };\n    var wrappedClearInterval = function (id) {\n      return clearInterval(id);\n    };\n    var debounce = function (callback, time) {\n      var timer;\n      var func = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        clearTimeout(timer);\n        timer = wrappedSetTimeout(function () {\n          callback.apply(this, args);\n        }, time);\n      };\n      func.stop = function () {\n        clearTimeout(timer);\n      };\n      return func;\n    };\n    var Delay = {\n      requestAnimationFrame: function (callback, element) {\n        if (requestAnimationFramePromise) {\n          requestAnimationFramePromise.then(callback);\n          return;\n        }\n        requestAnimationFramePromise = new promiseObj(function (resolve) {\n          if (!element) {\n            element = document.body;\n          }\n          requestAnimationFrame(resolve, element);\n        }).then(callback);\n      },\n      setTimeout: wrappedSetTimeout,\n      setInterval: wrappedSetInterval,\n      setEditorTimeout: function (editor, callback, time) {\n        return wrappedSetTimeout(function () {\n          if (!editor.removed) {\n            callback();\n          }\n        }, time);\n      },\n      setEditorInterval: function (editor, callback, time) {\n        var timer = wrappedSetInterval(function () {\n          if (!editor.removed) {\n            callback();\n          } else {\n            clearInterval(timer);\n          }\n        }, time);\n        return timer;\n      },\n      debounce: debounce,\n      throttle: debounce,\n      clearInterval: wrappedClearInterval,\n      clearTimeout: wrappedClearTimeout\n    };\n\n    var StyleSheetLoader = function (documentOrShadowRoot, settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n      var idCount = 0;\n      var loadedStates = {};\n      var edos = SugarElement.fromDom(documentOrShadowRoot);\n      var doc = documentOrOwner(edos);\n      var maxLoadTime = settings.maxLoadTime || 5000;\n      var _setReferrerPolicy = function (referrerPolicy) {\n        settings.referrerPolicy = referrerPolicy;\n      };\n      var addStyle = function (element) {\n        append(getStyleContainer(edos), element);\n      };\n      var removeStyle = function (id) {\n        var styleContainer = getStyleContainer(edos);\n        descendant(styleContainer, '#' + id).each(remove);\n      };\n      var getOrCreateState = function (url) {\n        return get$1(loadedStates, url).getOrThunk(function () {\n          return {\n            id: 'mce-u' + idCount++,\n            passed: [],\n            failed: [],\n            count: 0\n          };\n        });\n      };\n      var load = function (url, success, failure) {\n        var link;\n        var urlWithSuffix = Tools._addCacheSuffix(url);\n        var state = getOrCreateState(urlWithSuffix);\n        loadedStates[urlWithSuffix] = state;\n        state.count++;\n        var resolve = function (callbacks, status) {\n          var i = callbacks.length;\n          while (i--) {\n            callbacks[i]();\n          }\n          state.status = status;\n          state.passed = [];\n          state.failed = [];\n          if (link) {\n            link.onload = null;\n            link.onerror = null;\n            link = null;\n          }\n        };\n        var passed = function () {\n          return resolve(state.passed, 2);\n        };\n        var failed = function () {\n          return resolve(state.failed, 3);\n        };\n        var wait = function (testCallback, waitCallback) {\n          if (!testCallback()) {\n            if (Date.now() - startTime < maxLoadTime) {\n              Delay.setTimeout(waitCallback);\n            } else {\n              failed();\n            }\n          }\n        };\n        var waitForWebKitLinkLoaded = function () {\n          wait(function () {\n            var styleSheets = documentOrShadowRoot.styleSheets;\n            var i = styleSheets.length;\n            while (i--) {\n              var styleSheet = styleSheets[i];\n              var owner = styleSheet.ownerNode;\n              if (owner && owner.id === link.id) {\n                passed();\n                return true;\n              }\n            }\n            return false;\n          }, waitForWebKitLinkLoaded);\n        };\n        if (success) {\n          state.passed.push(success);\n        }\n        if (failure) {\n          state.failed.push(failure);\n        }\n        if (state.status === 1) {\n          return;\n        }\n        if (state.status === 2) {\n          passed();\n          return;\n        }\n        if (state.status === 3) {\n          failed();\n          return;\n        }\n        state.status = 1;\n        var linkElem = SugarElement.fromTag('link', doc.dom);\n        setAll(linkElem, {\n          rel: 'stylesheet',\n          type: 'text/css',\n          id: state.id\n        });\n        var startTime = Date.now();\n        if (settings.contentCssCors) {\n          set(linkElem, 'crossOrigin', 'anonymous');\n        }\n        if (settings.referrerPolicy) {\n          set(linkElem, 'referrerpolicy', settings.referrerPolicy);\n        }\n        link = linkElem.dom;\n        link.onload = waitForWebKitLinkLoaded;\n        link.onerror = failed;\n        addStyle(linkElem);\n        set(linkElem, 'href', urlWithSuffix);\n      };\n      var loadF = function (url) {\n        return Future.nu(function (resolve) {\n          load(url, compose(resolve, constant(Result.value(url))), compose(resolve, constant(Result.error(url))));\n        });\n      };\n      var loadAll = function (urls, success, failure) {\n        par$1(map(urls, loadF)).get(function (result) {\n          var parts = partition(result, function (r) {\n            return r.isValue();\n          });\n          if (parts.fail.length > 0) {\n            failure(parts.fail.map(unite));\n          } else {\n            success(parts.pass.map(unite));\n          }\n        });\n      };\n      var unload = function (url) {\n        var urlWithSuffix = Tools._addCacheSuffix(url);\n        get$1(loadedStates, urlWithSuffix).each(function (state) {\n          var count = --state.count;\n          if (count === 0) {\n            delete loadedStates[urlWithSuffix];\n            removeStyle(state.id);\n          }\n        });\n      };\n      var unloadAll = function (urls) {\n        each(urls, function (url) {\n          unload(url);\n        });\n      };\n      return {\n        load: load,\n        loadAll: loadAll,\n        unload: unload,\n        unloadAll: unloadAll,\n        _setReferrerPolicy: _setReferrerPolicy\n      };\n    };\n\n    var create$1 = function () {\n      var map = new WeakMap();\n      var forElement = function (referenceElement, settings) {\n        var root = getRootNode(referenceElement);\n        var rootDom = root.dom;\n        return Optional.from(map.get(rootDom)).getOrThunk(function () {\n          var sl = StyleSheetLoader(rootDom, settings);\n          map.set(rootDom, sl);\n          return sl;\n        });\n      };\n      return { forElement: forElement };\n    };\n    var instance = create$1();\n\n    var DomTreeWalker = function () {\n      function DomTreeWalker(startNode, rootNode) {\n        this.node = startNode;\n        this.rootNode = rootNode;\n        this.current = this.current.bind(this);\n        this.next = this.next.bind(this);\n        this.prev = this.prev.bind(this);\n        this.prev2 = this.prev2.bind(this);\n      }\n      DomTreeWalker.prototype.current = function () {\n        return this.node;\n      };\n      DomTreeWalker.prototype.next = function (shallow) {\n        this.node = this.findSibling(this.node, 'firstChild', 'nextSibling', shallow);\n        return this.node;\n      };\n      DomTreeWalker.prototype.prev = function (shallow) {\n        this.node = this.findSibling(this.node, 'lastChild', 'previousSibling', shallow);\n        return this.node;\n      };\n      DomTreeWalker.prototype.prev2 = function (shallow) {\n        this.node = this.findPreviousNode(this.node, 'lastChild', 'previousSibling', shallow);\n        return this.node;\n      };\n      DomTreeWalker.prototype.findSibling = function (node, startName, siblingName, shallow) {\n        var sibling, parent;\n        if (node) {\n          if (!shallow && node[startName]) {\n            return node[startName];\n          }\n          if (node !== this.rootNode) {\n            sibling = node[siblingName];\n            if (sibling) {\n              return sibling;\n            }\n            for (parent = node.parentNode; parent && parent !== this.rootNode; parent = parent.parentNode) {\n              sibling = parent[siblingName];\n              if (sibling) {\n                return sibling;\n              }\n            }\n          }\n        }\n      };\n      DomTreeWalker.prototype.findPreviousNode = function (node, startName, siblingName, shallow) {\n        var sibling, parent, child;\n        if (node) {\n          sibling = node[siblingName];\n          if (this.rootNode && sibling === this.rootNode) {\n            return;\n          }\n          if (sibling) {\n            if (!shallow) {\n              for (child = sibling[startName]; child; child = child[startName]) {\n                if (!child[startName]) {\n                  return child;\n                }\n              }\n            }\n            return sibling;\n          }\n          parent = node.parentNode;\n          if (parent && parent !== this.rootNode) {\n            return parent;\n          }\n        }\n      };\n      return DomTreeWalker;\n    }();\n\n    var blocks = [\n      'article',\n      'aside',\n      'details',\n      'div',\n      'dt',\n      'figcaption',\n      'footer',\n      'form',\n      'fieldset',\n      'header',\n      'hgroup',\n      'html',\n      'main',\n      'nav',\n      'section',\n      'summary',\n      'body',\n      'p',\n      'dl',\n      'multicol',\n      'dd',\n      'figure',\n      'address',\n      'center',\n      'blockquote',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'listing',\n      'xmp',\n      'pre',\n      'plaintext',\n      'menu',\n      'dir',\n      'ul',\n      'ol',\n      'li',\n      'hr',\n      'table',\n      'tbody',\n      'thead',\n      'tfoot',\n      'th',\n      'tr',\n      'td',\n      'caption'\n    ];\n    var tableCells = [\n      'td',\n      'th'\n    ];\n    var tableSections = [\n      'thead',\n      'tbody',\n      'tfoot'\n    ];\n    var textBlocks = [\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'p',\n      'div',\n      'address',\n      'pre',\n      'form',\n      'blockquote',\n      'center',\n      'dir',\n      'fieldset',\n      'header',\n      'footer',\n      'article',\n      'section',\n      'hgroup',\n      'aside',\n      'nav',\n      'figure'\n    ];\n    var headings = [\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6'\n    ];\n    var listItems = [\n      'li',\n      'dd',\n      'dt'\n    ];\n    var lists = [\n      'ul',\n      'ol',\n      'dl'\n    ];\n    var wsElements = [\n      'pre',\n      'script',\n      'textarea',\n      'style'\n    ];\n    var lazyLookup = function (items) {\n      var lookup;\n      return function (node) {\n        lookup = lookup ? lookup : mapToObject(items, always);\n        return lookup.hasOwnProperty(name(node));\n      };\n    };\n    var isHeading = lazyLookup(headings);\n    var isBlock = lazyLookup(blocks);\n    var isTable$1 = function (node) {\n      return name(node) === 'table';\n    };\n    var isInline = function (node) {\n      return isElement(node) && !isBlock(node);\n    };\n    var isBr$1 = function (node) {\n      return isElement(node) && name(node) === 'br';\n    };\n    var isTextBlock = lazyLookup(textBlocks);\n    var isList = lazyLookup(lists);\n    var isListItem = lazyLookup(listItems);\n    var isTableSection = lazyLookup(tableSections);\n    var isTableCell$1 = lazyLookup(tableCells);\n    var isWsPreserveElement = lazyLookup(wsElements);\n\n    var ancestor$2 = function (scope, selector, isRoot) {\n      return ancestor$1(scope, selector, isRoot).isSome();\n    };\n\n    var zeroWidth = '\\uFEFF';\n    var nbsp = '\\xA0';\n    var isZwsp = function (char) {\n      return char === zeroWidth;\n    };\n    var removeZwsp = function (s) {\n      return s.replace(/\\uFEFF/g, '');\n    };\n\n    var ZWSP = zeroWidth;\n    var isZwsp$1 = isZwsp;\n    var trim$2 = removeZwsp;\n\n    var isElement$2 = isElement$1;\n    var isText$2 = isText$1;\n    var isCaretContainerBlock = function (node) {\n      if (isText$2(node)) {\n        node = node.parentNode;\n      }\n      return isElement$2(node) && node.hasAttribute('data-mce-caret');\n    };\n    var isCaretContainerInline = function (node) {\n      return isText$2(node) && isZwsp$1(node.data);\n    };\n    var isCaretContainer = function (node) {\n      return isCaretContainerBlock(node) || isCaretContainerInline(node);\n    };\n    var hasContent = function (node) {\n      return node.firstChild !== node.lastChild || !isBr(node.firstChild);\n    };\n    var insertInline = function (node, before) {\n      var sibling;\n      var doc = node.ownerDocument;\n      var textNode = doc.createTextNode(ZWSP);\n      var parentNode = node.parentNode;\n      if (!before) {\n        sibling = node.nextSibling;\n        if (isText$2(sibling)) {\n          if (isCaretContainer(sibling)) {\n            return sibling;\n          }\n          if (startsWithCaretContainer(sibling)) {\n            sibling.splitText(1);\n            return sibling;\n          }\n        }\n        if (node.nextSibling) {\n          parentNode.insertBefore(textNode, node.nextSibling);\n        } else {\n          parentNode.appendChild(textNode);\n        }\n      } else {\n        sibling = node.previousSibling;\n        if (isText$2(sibling)) {\n          if (isCaretContainer(sibling)) {\n            return sibling;\n          }\n          if (endsWithCaretContainer(sibling)) {\n            return sibling.splitText(sibling.data.length - 1);\n          }\n        }\n        parentNode.insertBefore(textNode, node);\n      }\n      return textNode;\n    };\n    var isBeforeInline = function (pos) {\n      var container = pos.container();\n      if (!isText$1(container)) {\n        return false;\n      }\n      return container.data.charAt(pos.offset()) === ZWSP || pos.isAtStart() && isCaretContainerInline(container.previousSibling);\n    };\n    var isAfterInline = function (pos) {\n      var container = pos.container();\n      if (!isText$1(container)) {\n        return false;\n      }\n      return container.data.charAt(pos.offset() - 1) === ZWSP || pos.isAtEnd() && isCaretContainerInline(container.nextSibling);\n    };\n    var createBogusBr = function () {\n      var br = document.createElement('br');\n      br.setAttribute('data-mce-bogus', '1');\n      return br;\n    };\n    var insertBlock = function (blockName, node, before) {\n      var doc = node.ownerDocument;\n      var blockNode = doc.createElement(blockName);\n      blockNode.setAttribute('data-mce-caret', before ? 'before' : 'after');\n      blockNode.setAttribute('data-mce-bogus', 'all');\n      blockNode.appendChild(createBogusBr());\n      var parentNode = node.parentNode;\n      if (!before) {\n        if (node.nextSibling) {\n          parentNode.insertBefore(blockNode, node.nextSibling);\n        } else {\n          parentNode.appendChild(blockNode);\n        }\n      } else {\n        parentNode.insertBefore(blockNode, node);\n      }\n      return blockNode;\n    };\n    var startsWithCaretContainer = function (node) {\n      return isText$2(node) && node.data[0] === ZWSP;\n    };\n    var endsWithCaretContainer = function (node) {\n      return isText$2(node) && node.data[node.data.length - 1] === ZWSP;\n    };\n    var trimBogusBr = function (elm) {\n      var brs = elm.getElementsByTagName('br');\n      var lastBr = brs[brs.length - 1];\n      if (isBogus(lastBr)) {\n        lastBr.parentNode.removeChild(lastBr);\n      }\n    };\n    var showCaretContainerBlock = function (caretContainer) {\n      if (caretContainer && caretContainer.hasAttribute('data-mce-caret')) {\n        trimBogusBr(caretContainer);\n        caretContainer.removeAttribute('data-mce-caret');\n        caretContainer.removeAttribute('data-mce-bogus');\n        caretContainer.removeAttribute('style');\n        caretContainer.removeAttribute('_moz_abspos');\n        return caretContainer;\n      }\n      return null;\n    };\n    var isRangeInCaretContainerBlock = function (range) {\n      return isCaretContainerBlock(range.startContainer);\n    };\n\n    var isContentEditableTrue$1 = isContentEditableTrue;\n    var isContentEditableFalse$1 = isContentEditableFalse;\n    var isBr$2 = isBr;\n    var isText$3 = isText$1;\n    var isInvalidTextElement = matchNodeNames([\n      'script',\n      'style',\n      'textarea'\n    ]);\n    var isAtomicInline = matchNodeNames([\n      'img',\n      'input',\n      'textarea',\n      'hr',\n      'iframe',\n      'video',\n      'audio',\n      'object',\n      'embed'\n    ]);\n    var isTable$2 = matchNodeNames(['table']);\n    var isCaretContainer$1 = isCaretContainer;\n    var isCaretCandidate = function (node) {\n      if (isCaretContainer$1(node)) {\n        return false;\n      }\n      if (isText$3(node)) {\n        return !isInvalidTextElement(node.parentNode);\n      }\n      return isAtomicInline(node) || isBr$2(node) || isTable$2(node) || isNonUiContentEditableFalse(node);\n    };\n    var isUnselectable = function (node) {\n      return isElement$1(node) && node.getAttribute('unselectable') === 'true';\n    };\n    var isNonUiContentEditableFalse = function (node) {\n      return isUnselectable(node) === false && isContentEditableFalse$1(node);\n    };\n    var isInEditable = function (node, root) {\n      for (node = node.parentNode; node && node !== root; node = node.parentNode) {\n        if (isNonUiContentEditableFalse(node)) {\n          return false;\n        }\n        if (isContentEditableTrue$1(node)) {\n          return true;\n        }\n      }\n      return true;\n    };\n    var isAtomicContentEditableFalse = function (node) {\n      if (!isNonUiContentEditableFalse(node)) {\n        return false;\n      }\n      return foldl(from$1(node.getElementsByTagName('*')), function (result, elm) {\n        return result || isContentEditableTrue$1(elm);\n      }, false) !== true;\n    };\n    var isAtomic = function (node) {\n      return isAtomicInline(node) || isAtomicContentEditableFalse(node);\n    };\n    var isEditableCaretCandidate = function (node, root) {\n      return isCaretCandidate(node) && isInEditable(node, root);\n    };\n\n    var whiteSpaceRegExp$1 = /^[ \\t\\r\\n]*$/;\n    var isWhitespaceText = function (text) {\n      return whiteSpaceRegExp$1.test(text);\n    };\n\n    var hasWhitespacePreserveParent = function (node, rootNode) {\n      var rootElement = SugarElement.fromDom(rootNode);\n      var startNode = SugarElement.fromDom(node);\n      return ancestor$2(startNode, 'pre,code', curry(eq$2, rootElement));\n    };\n    var isWhitespace = function (node, rootNode) {\n      return isText$1(node) && isWhitespaceText(node.data) && hasWhitespacePreserveParent(node, rootNode) === false;\n    };\n    var isNamedAnchor = function (node) {\n      return isElement$1(node) && node.nodeName === 'A' && !node.hasAttribute('href') && (node.hasAttribute('name') || node.hasAttribute('id'));\n    };\n    var isContent = function (node, rootNode) {\n      return isCaretCandidate(node) && isWhitespace(node, rootNode) === false || isNamedAnchor(node) || isBookmark(node);\n    };\n    var isBookmark = hasAttribute('data-mce-bookmark');\n    var isBogus$1 = hasAttribute('data-mce-bogus');\n    var isBogusAll$1 = hasAttributeValue('data-mce-bogus', 'all');\n    var isEmptyNode = function (targetNode, skipBogus) {\n      var node, brCount = 0;\n      if (isContent(targetNode, targetNode)) {\n        return false;\n      } else {\n        node = targetNode.firstChild;\n        if (!node) {\n          return true;\n        }\n        var walker = new DomTreeWalker(node, targetNode);\n        do {\n          if (skipBogus) {\n            if (isBogusAll$1(node)) {\n              node = walker.next(true);\n              continue;\n            }\n            if (isBogus$1(node)) {\n              node = walker.next();\n              continue;\n            }\n          }\n          if (isBr(node)) {\n            brCount++;\n            node = walker.next();\n            continue;\n          }\n          if (isContent(node, targetNode)) {\n            return false;\n          }\n          node = walker.next();\n        } while (node);\n        return brCount <= 1;\n      }\n    };\n    var isEmpty = function (elm, skipBogus) {\n      if (skipBogus === void 0) {\n        skipBogus = true;\n      }\n      return isEmptyNode(elm.dom, skipBogus);\n    };\n\n    var isSpan = function (node) {\n      return node.nodeName.toLowerCase() === 'span';\n    };\n    var isInlineContent = function (node, root) {\n      return isNonNullable(node) && (isContent(node, root) || isInline(SugarElement.fromDom(node)));\n    };\n    var surroundedByInlineContent = function (node, root) {\n      var prev = new DomTreeWalker(node, root).prev(false);\n      var next = new DomTreeWalker(node, root).next(false);\n      var prevIsInline = isUndefined(prev) || isInlineContent(prev, root);\n      var nextIsInline = isUndefined(next) || isInlineContent(next, root);\n      return prevIsInline && nextIsInline;\n    };\n    var isBookmarkNode = function (node) {\n      return isSpan(node) && node.getAttribute('data-mce-type') === 'bookmark';\n    };\n    var isKeepTextNode = function (node, root) {\n      return isText$1(node) && node.data.length > 0 && surroundedByInlineContent(node, root);\n    };\n    var isKeepElement = function (node) {\n      return isElement$1(node) ? node.childNodes.length > 0 : false;\n    };\n    var isDocument$2 = function (node) {\n      return isDocumentFragment$1(node) || isDocument$1(node);\n    };\n    var trimNode = function (dom, node, root) {\n      var rootNode = root || node;\n      if (isElement$1(node) && isBookmarkNode(node)) {\n        return node;\n      }\n      var children = node.childNodes;\n      for (var i = children.length - 1; i >= 0; i--) {\n        trimNode(dom, children[i], rootNode);\n      }\n      if (isElement$1(node)) {\n        var currentChildren = node.childNodes;\n        if (currentChildren.length === 1 && isBookmarkNode(currentChildren[0])) {\n          node.parentNode.insertBefore(currentChildren[0], node);\n        }\n      }\n      if (!isDocument$2(node) && !isContent(node, rootNode) && !isKeepElement(node) && !isKeepTextNode(node, rootNode)) {\n        dom.remove(node);\n      }\n      return node;\n    };\n\n    var makeMap$1 = Tools.makeMap;\n    var attrsCharsRegExp = /[&<>\\\"\\u0060\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n    var textCharsRegExp = /[<>&\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n    var rawCharsRegExp = /[<>&\\\"\\']/g;\n    var entityRegExp = /&#([a-z0-9]+);?|&([a-z0-9]+);/gi;\n    var asciiMap = {\n      128: '\\u20AC',\n      130: '\\u201A',\n      131: '\\u0192',\n      132: '\\u201E',\n      133: '\\u2026',\n      134: '\\u2020',\n      135: '\\u2021',\n      136: '\\u02c6',\n      137: '\\u2030',\n      138: '\\u0160',\n      139: '\\u2039',\n      140: '\\u0152',\n      142: '\\u017d',\n      145: '\\u2018',\n      146: '\\u2019',\n      147: '\\u201C',\n      148: '\\u201D',\n      149: '\\u2022',\n      150: '\\u2013',\n      151: '\\u2014',\n      152: '\\u02DC',\n      153: '\\u2122',\n      154: '\\u0161',\n      155: '\\u203A',\n      156: '\\u0153',\n      158: '\\u017e',\n      159: '\\u0178'\n    };\n    var baseEntities = {\n      '\"': '&quot;',\n      '\\'': '&#39;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '&': '&amp;',\n      '`': '&#96;'\n    };\n    var reverseEntities = {\n      '&lt;': '<',\n      '&gt;': '>',\n      '&amp;': '&',\n      '&quot;': '\"',\n      '&apos;': '\\''\n    };\n    var nativeDecode = function (text) {\n      var elm = SugarElement.fromTag('div').dom;\n      elm.innerHTML = text;\n      return elm.textContent || elm.innerText || text;\n    };\n    var buildEntitiesLookup = function (items, radix) {\n      var i, chr, entity;\n      var lookup = {};\n      if (items) {\n        items = items.split(',');\n        radix = radix || 10;\n        for (i = 0; i < items.length; i += 2) {\n          chr = String.fromCharCode(parseInt(items[i], radix));\n          if (!baseEntities[chr]) {\n            entity = '&' + items[i + 1] + ';';\n            lookup[chr] = entity;\n            lookup[entity] = chr;\n          }\n        }\n        return lookup;\n      }\n    };\n    var namedEntities = buildEntitiesLookup('50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,' + '5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,' + '5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,' + '5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,' + '68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,' + '6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,' + '6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,' + '75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,' + '7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,' + '7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,' + 'sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,' + 'st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,' + 't9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,' + 'tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,' + 'u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,' + '81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,' + '8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,' + '8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,' + '8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,' + '8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,' + 'nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,' + 'rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,' + 'Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,' + '80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,' + '811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro', 32);\n    var encodeRaw = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        return baseEntities[chr] || chr;\n      });\n    };\n    var encodeAllRaw = function (text) {\n      return ('' + text).replace(rawCharsRegExp, function (chr) {\n        return baseEntities[chr] || chr;\n      });\n    };\n    var encodeNumeric = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        if (chr.length > 1) {\n          return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n        }\n        return baseEntities[chr] || '&#' + chr.charCodeAt(0) + ';';\n      });\n    };\n    var encodeNamed = function (text, attr, entities) {\n      entities = entities || namedEntities;\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        return baseEntities[chr] || entities[chr] || chr;\n      });\n    };\n    var getEncodeFunc = function (name, entities) {\n      var entitiesMap = buildEntitiesLookup(entities) || namedEntities;\n      var encodeNamedAndNumeric = function (text, attr) {\n        return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n          if (baseEntities[chr] !== undefined) {\n            return baseEntities[chr];\n          }\n          if (entitiesMap[chr] !== undefined) {\n            return entitiesMap[chr];\n          }\n          if (chr.length > 1) {\n            return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n          }\n          return '&#' + chr.charCodeAt(0) + ';';\n        });\n      };\n      var encodeCustomNamed = function (text, attr) {\n        return encodeNamed(text, attr, entitiesMap);\n      };\n      var nameMap = makeMap$1(name.replace(/\\+/g, ','));\n      if (nameMap.named && nameMap.numeric) {\n        return encodeNamedAndNumeric;\n      }\n      if (nameMap.named) {\n        if (entities) {\n          return encodeCustomNamed;\n        }\n        return encodeNamed;\n      }\n      if (nameMap.numeric) {\n        return encodeNumeric;\n      }\n      return encodeRaw;\n    };\n    var decode = function (text) {\n      return text.replace(entityRegExp, function (all, numeric) {\n        if (numeric) {\n          if (numeric.charAt(0).toLowerCase() === 'x') {\n            numeric = parseInt(numeric.substr(1), 16);\n          } else {\n            numeric = parseInt(numeric, 10);\n          }\n          if (numeric > 65535) {\n            numeric -= 65536;\n            return String.fromCharCode(55296 + (numeric >> 10), 56320 + (numeric & 1023));\n          }\n          return asciiMap[numeric] || String.fromCharCode(numeric);\n        }\n        return reverseEntities[all] || namedEntities[all] || nativeDecode(all);\n      });\n    };\n    var Entities = {\n      encodeRaw: encodeRaw,\n      encodeAllRaw: encodeAllRaw,\n      encodeNumeric: encodeNumeric,\n      encodeNamed: encodeNamed,\n      getEncodeFunc: getEncodeFunc,\n      decode: decode\n    };\n\n    var mapCache = {}, dummyObj = {};\n    var makeMap$2 = Tools.makeMap, each$3 = Tools.each, extend$1 = Tools.extend, explode$1 = Tools.explode, inArray = Tools.inArray;\n    var split = function (items, delim) {\n      items = Tools.trim(items);\n      return items ? items.split(delim || ' ') : [];\n    };\n    var compileSchema = function (type) {\n      var schema = {};\n      var globalAttributes, blockContent;\n      var phrasingContent, flowContent, html4BlockContent, html4PhrasingContent;\n      var add = function (name, attributes, children) {\n        var ni, attributesOrder, element;\n        var arrayToMap = function (array, obj) {\n          var map = {};\n          var i, l;\n          for (i = 0, l = array.length; i < l; i++) {\n            map[array[i]] = obj || {};\n          }\n          return map;\n        };\n        children = children || [];\n        attributes = attributes || '';\n        if (typeof children === 'string') {\n          children = split(children);\n        }\n        var names = split(name);\n        ni = names.length;\n        while (ni--) {\n          attributesOrder = split([\n            globalAttributes,\n            attributes\n          ].join(' '));\n          element = {\n            attributes: arrayToMap(attributesOrder),\n            attributesOrder: attributesOrder,\n            children: arrayToMap(children, dummyObj)\n          };\n          schema[names[ni]] = element;\n        }\n      };\n      var addAttrs = function (name, attributes) {\n        var ni, schemaItem, i, l;\n        var names = split(name);\n        ni = names.length;\n        var attrs = split(attributes);\n        while (ni--) {\n          schemaItem = schema[names[ni]];\n          for (i = 0, l = attrs.length; i < l; i++) {\n            schemaItem.attributes[attrs[i]] = {};\n            schemaItem.attributesOrder.push(attrs[i]);\n          }\n        }\n      };\n      if (mapCache[type]) {\n        return mapCache[type];\n      }\n      globalAttributes = 'id accesskey class dir lang style tabindex title role';\n      blockContent = 'address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul';\n      phrasingContent = 'a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd ' + 'label map noscript object q s samp script select small span strong sub sup ' + 'textarea u var #text #comment';\n      if (type !== 'html4') {\n        globalAttributes += ' contenteditable contextmenu draggable dropzone ' + 'hidden spellcheck translate';\n        blockContent += ' article aside details dialog figure main header footer hgroup section nav';\n        phrasingContent += ' audio canvas command datalist mark meter output picture ' + 'progress time wbr video ruby bdi keygen';\n      }\n      if (type !== 'html5-strict') {\n        globalAttributes += ' xml:lang';\n        html4PhrasingContent = 'acronym applet basefont big font strike tt';\n        phrasingContent = [\n          phrasingContent,\n          html4PhrasingContent\n        ].join(' ');\n        each$3(split(html4PhrasingContent), function (name) {\n          add(name, '', phrasingContent);\n        });\n        html4BlockContent = 'center dir isindex noframes';\n        blockContent = [\n          blockContent,\n          html4BlockContent\n        ].join(' ');\n        flowContent = [\n          blockContent,\n          phrasingContent\n        ].join(' ');\n        each$3(split(html4BlockContent), function (name) {\n          add(name, '', flowContent);\n        });\n      }\n      flowContent = flowContent || [\n        blockContent,\n        phrasingContent\n      ].join(' ');\n      add('html', 'manifest', 'head body');\n      add('head', '', 'base command link meta noscript script style title');\n      add('title hr noscript br');\n      add('base', 'href target');\n      add('link', 'href rel media hreflang type sizes hreflang');\n      add('meta', 'name http-equiv content charset');\n      add('style', 'media type scoped');\n      add('script', 'src async defer type charset');\n      add('body', 'onafterprint onbeforeprint onbeforeunload onblur onerror onfocus ' + 'onhashchange onload onmessage onoffline ononline onpagehide onpageshow ' + 'onpopstate onresize onscroll onstorage onunload', flowContent);\n      add('address dt dd div caption', '', flowContent);\n      add('h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn', '', phrasingContent);\n      add('blockquote', 'cite', flowContent);\n      add('ol', 'reversed start type', 'li');\n      add('ul', '', 'li');\n      add('li', 'value', flowContent);\n      add('dl', '', 'dt dd');\n      add('a', 'href target rel media hreflang type', phrasingContent);\n      add('q', 'cite', phrasingContent);\n      add('ins del', 'cite datetime', flowContent);\n      add('img', 'src sizes srcset alt usemap ismap width height');\n      add('iframe', 'src name width height', flowContent);\n      add('embed', 'src type width height');\n      add('object', 'data type typemustmatch name usemap form width height', [\n        flowContent,\n        'param'\n      ].join(' '));\n      add('param', 'name value');\n      add('map', 'name', [\n        flowContent,\n        'area'\n      ].join(' '));\n      add('area', 'alt coords shape href target rel media hreflang type');\n      add('table', 'border', 'caption colgroup thead tfoot tbody tr' + (type === 'html4' ? ' col' : ''));\n      add('colgroup', 'span', 'col');\n      add('col', 'span');\n      add('tbody thead tfoot', '', 'tr');\n      add('tr', '', 'td th');\n      add('td', 'colspan rowspan headers', flowContent);\n      add('th', 'colspan rowspan headers scope abbr', flowContent);\n      add('form', 'accept-charset action autocomplete enctype method name novalidate target', flowContent);\n      add('fieldset', 'disabled form name', [\n        flowContent,\n        'legend'\n      ].join(' '));\n      add('label', 'form for', phrasingContent);\n      add('input', 'accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate ' + 'formtarget height list max maxlength min multiple name pattern readonly required size src step type value width');\n      add('button', 'disabled form formaction formenctype formmethod formnovalidate formtarget name type value', type === 'html4' ? flowContent : phrasingContent);\n      add('select', 'disabled form multiple name required size', 'option optgroup');\n      add('optgroup', 'disabled label', 'option');\n      add('option', 'disabled label selected value');\n      add('textarea', 'cols dirname disabled form maxlength name readonly required rows wrap');\n      add('menu', 'type label', [\n        flowContent,\n        'li'\n      ].join(' '));\n      add('noscript', '', flowContent);\n      if (type !== 'html4') {\n        add('wbr');\n        add('ruby', '', [\n          phrasingContent,\n          'rt rp'\n        ].join(' '));\n        add('figcaption', '', flowContent);\n        add('mark rt rp summary bdi', '', phrasingContent);\n        add('canvas', 'width height', flowContent);\n        add('video', 'src crossorigin poster preload autoplay mediagroup loop ' + 'muted controls width height buffered', [\n          flowContent,\n          'track source'\n        ].join(' '));\n        add('audio', 'src crossorigin preload autoplay mediagroup loop muted controls ' + 'buffered volume', [\n          flowContent,\n          'track source'\n        ].join(' '));\n        add('picture', '', 'img source');\n        add('source', 'src srcset type media sizes');\n        add('track', 'kind src srclang label default');\n        add('datalist', '', [\n          phrasingContent,\n          'option'\n        ].join(' '));\n        add('article section nav aside main header footer', '', flowContent);\n        add('hgroup', '', 'h1 h2 h3 h4 h5 h6');\n        add('figure', '', [\n          flowContent,\n          'figcaption'\n        ].join(' '));\n        add('time', 'datetime', phrasingContent);\n        add('dialog', 'open', flowContent);\n        add('command', 'type label icon disabled checked radiogroup command');\n        add('output', 'for form name', phrasingContent);\n        add('progress', 'value max', phrasingContent);\n        add('meter', 'value min max low high optimum', phrasingContent);\n        add('details', 'open', [\n          flowContent,\n          'summary'\n        ].join(' '));\n        add('keygen', 'autofocus challenge disabled form keytype name');\n      }\n      if (type !== 'html5-strict') {\n        addAttrs('script', 'language xml:space');\n        addAttrs('style', 'xml:space');\n        addAttrs('object', 'declare classid code codebase codetype archive standby align border hspace vspace');\n        addAttrs('embed', 'align name hspace vspace');\n        addAttrs('param', 'valuetype type');\n        addAttrs('a', 'charset name rev shape coords');\n        addAttrs('br', 'clear');\n        addAttrs('applet', 'codebase archive code object alt name width height align hspace vspace');\n        addAttrs('img', 'name longdesc align border hspace vspace');\n        addAttrs('iframe', 'longdesc frameborder marginwidth marginheight scrolling align');\n        addAttrs('font basefont', 'size color face');\n        addAttrs('input', 'usemap align');\n        addAttrs('select');\n        addAttrs('textarea');\n        addAttrs('h1 h2 h3 h4 h5 h6 div p legend caption', 'align');\n        addAttrs('ul', 'type compact');\n        addAttrs('li', 'type');\n        addAttrs('ol dl menu dir', 'compact');\n        addAttrs('pre', 'width xml:space');\n        addAttrs('hr', 'align noshade size width');\n        addAttrs('isindex', 'prompt');\n        addAttrs('table', 'summary width frame rules cellspacing cellpadding align bgcolor');\n        addAttrs('col', 'width align char charoff valign');\n        addAttrs('colgroup', 'width align char charoff valign');\n        addAttrs('thead', 'align char charoff valign');\n        addAttrs('tr', 'align char charoff valign bgcolor');\n        addAttrs('th', 'axis align char charoff valign nowrap bgcolor width height');\n        addAttrs('form', 'accept');\n        addAttrs('td', 'abbr axis scope align char charoff valign nowrap bgcolor width height');\n        addAttrs('tfoot', 'align char charoff valign');\n        addAttrs('tbody', 'align char charoff valign');\n        addAttrs('area', 'nohref');\n        addAttrs('body', 'background bgcolor text link vlink alink');\n      }\n      if (type !== 'html4') {\n        addAttrs('input button select textarea', 'autofocus');\n        addAttrs('input textarea', 'placeholder');\n        addAttrs('a', 'download');\n        addAttrs('link script img', 'crossorigin');\n        addAttrs('img', 'loading');\n        addAttrs('iframe', 'sandbox seamless allowfullscreen loading');\n      }\n      each$3(split('a form meter progress dfn'), function (name) {\n        if (schema[name]) {\n          delete schema[name].children[name];\n        }\n      });\n      delete schema.caption.children.table;\n      delete schema.script;\n      mapCache[type] = schema;\n      return schema;\n    };\n    var compileElementMap = function (value, mode) {\n      var styles;\n      if (value) {\n        styles = {};\n        if (typeof value === 'string') {\n          value = { '*': value };\n        }\n        each$3(value, function (value, key) {\n          styles[key] = styles[key.toUpperCase()] = mode === 'map' ? makeMap$2(value, /[, ]/) : explode$1(value, /[, ]/);\n        });\n      }\n      return styles;\n    };\n    var Schema = function (settings) {\n      var elements = {};\n      var children = {};\n      var patternElements = [];\n      var customElementsMap = {}, specialElements = {};\n      var createLookupTable = function (option, defaultValue, extendWith) {\n        var value = settings[option];\n        if (!value) {\n          value = mapCache[option];\n          if (!value) {\n            value = makeMap$2(defaultValue, ' ', makeMap$2(defaultValue.toUpperCase(), ' '));\n            value = extend$1(value, extendWith);\n            mapCache[option] = value;\n          }\n        } else {\n          value = makeMap$2(value, /[, ]/, makeMap$2(value.toUpperCase(), /[, ]/));\n        }\n        return value;\n      };\n      settings = settings || {};\n      var schemaItems = compileSchema(settings.schema);\n      if (settings.verify_html === false) {\n        settings.valid_elements = '*[*]';\n      }\n      var validStyles = compileElementMap(settings.valid_styles);\n      var invalidStyles = compileElementMap(settings.invalid_styles, 'map');\n      var validClasses = compileElementMap(settings.valid_classes, 'map');\n      var whiteSpaceElementsMap = createLookupTable('whitespace_elements', 'pre script noscript style textarea video audio iframe object code');\n      var selfClosingElementsMap = createLookupTable('self_closing_elements', 'colgroup dd dt li option p td tfoot th thead tr');\n      var shortEndedElementsMap = createLookupTable('short_ended_elements', 'area base basefont br col frame hr img input isindex link ' + 'meta param embed source wbr track');\n      var boolAttrMap = createLookupTable('boolean_attributes', 'checked compact declare defer disabled ismap multiple nohref noresize ' + 'noshade nowrap readonly selected autoplay loop controls');\n      var nonEmptyOrMoveCaretBeforeOnEnter = 'td th iframe video audio object script code';\n      var nonEmptyElementsMap = createLookupTable('non_empty_elements', nonEmptyOrMoveCaretBeforeOnEnter + ' pre', shortEndedElementsMap);\n      var moveCaretBeforeOnEnterElementsMap = createLookupTable('move_caret_before_on_enter_elements', nonEmptyOrMoveCaretBeforeOnEnter + ' table', shortEndedElementsMap);\n      var textBlockElementsMap = createLookupTable('text_block_elements', 'h1 h2 h3 h4 h5 h6 p div address pre form ' + 'blockquote center dir fieldset header footer article section hgroup aside main nav figure');\n      var blockElementsMap = createLookupTable('block_elements', 'hr table tbody thead tfoot ' + 'th tr td li ol ul caption dl dt dd noscript menu isindex option ' + 'datalist select optgroup figcaption details summary', textBlockElementsMap);\n      var textInlineElementsMap = createLookupTable('text_inline_elements', 'span strong b em i font strike u var cite ' + 'dfn code mark q sup sub samp');\n      each$3((settings.special || 'script noscript iframe noframes noembed title style textarea xmp').split(' '), function (name) {\n        specialElements[name] = new RegExp('</' + name + '[^>]*>', 'gi');\n      });\n      var patternToRegExp = function (str) {\n        return new RegExp('^' + str.replace(/([?+*])/g, '.$1') + '$');\n      };\n      var addValidElements = function (validElements) {\n        var ei, el, ai, al, matches, element, attr, attrData, elementName, attrName, attrType, attributes, attributesOrder, prefix, outputName, globalAttributes, globalAttributesOrder, value;\n        var elementRuleRegExp = /^([#+\\-])?([^\\[!\\/]+)(?:\\/([^\\[!]+))?(?:(!?)\\[([^\\]]+)])?$/, attrRuleRegExp = /^([!\\-])?(\\w+[\\\\:]:\\w+|[^=:<]+)?(?:([=:<])(.*))?$/, hasPatternsRegExp = /[*?+]/;\n        if (validElements) {\n          var validElementsArr = split(validElements, ',');\n          if (elements['@']) {\n            globalAttributes = elements['@'].attributes;\n            globalAttributesOrder = elements['@'].attributesOrder;\n          }\n          for (ei = 0, el = validElementsArr.length; ei < el; ei++) {\n            matches = elementRuleRegExp.exec(validElementsArr[ei]);\n            if (matches) {\n              prefix = matches[1];\n              elementName = matches[2];\n              outputName = matches[3];\n              attrData = matches[5];\n              attributes = {};\n              attributesOrder = [];\n              element = {\n                attributes: attributes,\n                attributesOrder: attributesOrder\n              };\n              if (prefix === '#') {\n                element.paddEmpty = true;\n              }\n              if (prefix === '-') {\n                element.removeEmpty = true;\n              }\n              if (matches[4] === '!') {\n                element.removeEmptyAttrs = true;\n              }\n              if (globalAttributes) {\n                each$1(globalAttributes, function (value, key) {\n                  attributes[key] = value;\n                });\n                attributesOrder.push.apply(attributesOrder, globalAttributesOrder);\n              }\n              if (attrData) {\n                attrData = split(attrData, '|');\n                for (ai = 0, al = attrData.length; ai < al; ai++) {\n                  matches = attrRuleRegExp.exec(attrData[ai]);\n                  if (matches) {\n                    attr = {};\n                    attrType = matches[1];\n                    attrName = matches[2].replace(/[\\\\:]:/g, ':');\n                    prefix = matches[3];\n                    value = matches[4];\n                    if (attrType === '!') {\n                      element.attributesRequired = element.attributesRequired || [];\n                      element.attributesRequired.push(attrName);\n                      attr.required = true;\n                    }\n                    if (attrType === '-') {\n                      delete attributes[attrName];\n                      attributesOrder.splice(inArray(attributesOrder, attrName), 1);\n                      continue;\n                    }\n                    if (prefix) {\n                      if (prefix === '=') {\n                        element.attributesDefault = element.attributesDefault || [];\n                        element.attributesDefault.push({\n                          name: attrName,\n                          value: value\n                        });\n                        attr.defaultValue = value;\n                      }\n                      if (prefix === ':') {\n                        element.attributesForced = element.attributesForced || [];\n                        element.attributesForced.push({\n                          name: attrName,\n                          value: value\n                        });\n                        attr.forcedValue = value;\n                      }\n                      if (prefix === '<') {\n                        attr.validValues = makeMap$2(value, '?');\n                      }\n                    }\n                    if (hasPatternsRegExp.test(attrName)) {\n                      element.attributePatterns = element.attributePatterns || [];\n                      attr.pattern = patternToRegExp(attrName);\n                      element.attributePatterns.push(attr);\n                    } else {\n                      if (!attributes[attrName]) {\n                        attributesOrder.push(attrName);\n                      }\n                      attributes[attrName] = attr;\n                    }\n                  }\n                }\n              }\n              if (!globalAttributes && elementName === '@') {\n                globalAttributes = attributes;\n                globalAttributesOrder = attributesOrder;\n              }\n              if (outputName) {\n                element.outputName = elementName;\n                elements[outputName] = element;\n              }\n              if (hasPatternsRegExp.test(elementName)) {\n                element.pattern = patternToRegExp(elementName);\n                patternElements.push(element);\n              } else {\n                elements[elementName] = element;\n              }\n            }\n          }\n        }\n      };\n      var setValidElements = function (validElements) {\n        elements = {};\n        patternElements = [];\n        addValidElements(validElements);\n        each$3(schemaItems, function (element, name) {\n          children[name] = element.children;\n        });\n      };\n      var addCustomElements = function (customElements) {\n        var customElementRegExp = /^(~)?(.+)$/;\n        if (customElements) {\n          mapCache.text_block_elements = mapCache.block_elements = null;\n          each$3(split(customElements, ','), function (rule) {\n            var matches = customElementRegExp.exec(rule), inline = matches[1] === '~', cloneName = inline ? 'span' : 'div', name = matches[2];\n            children[name] = children[cloneName];\n            customElementsMap[name] = cloneName;\n            if (!inline) {\n              blockElementsMap[name.toUpperCase()] = {};\n              blockElementsMap[name] = {};\n            }\n            if (!elements[name]) {\n              var customRule = elements[cloneName];\n              customRule = extend$1({}, customRule);\n              delete customRule.removeEmptyAttrs;\n              delete customRule.removeEmpty;\n              elements[name] = customRule;\n            }\n            each$3(children, function (element, elmName) {\n              if (element[cloneName]) {\n                children[elmName] = element = extend$1({}, children[elmName]);\n                element[name] = element[cloneName];\n              }\n            });\n          });\n        }\n      };\n      var addValidChildren = function (validChildren) {\n        var childRuleRegExp = /^([+\\-]?)([A-Za-z0-9_\\-.\\u00b7\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u037d\\u037f-\\u1fff\\u200c-\\u200d\\u203f-\\u2040\\u2070-\\u218f\\u2c00-\\u2fef\\u3001-\\ud7ff\\uf900-\\ufdcf\\ufdf0-\\ufffd]+)\\[([^\\]]+)]$/;\n        mapCache[settings.schema] = null;\n        if (validChildren) {\n          each$3(split(validChildren, ','), function (rule) {\n            var matches = childRuleRegExp.exec(rule);\n            var parent, prefix;\n            if (matches) {\n              prefix = matches[1];\n              if (prefix) {\n                parent = children[matches[2]];\n              } else {\n                parent = children[matches[2]] = { '#comment': {} };\n              }\n              parent = children[matches[2]];\n              each$3(split(matches[3], '|'), function (child) {\n                if (prefix === '-') {\n                  delete parent[child];\n                } else {\n                  parent[child] = {};\n                }\n              });\n            }\n          });\n        }\n      };\n      var getElementRule = function (name) {\n        var element = elements[name], i;\n        if (element) {\n          return element;\n        }\n        i = patternElements.length;\n        while (i--) {\n          element = patternElements[i];\n          if (element.pattern.test(name)) {\n            return element;\n          }\n        }\n      };\n      if (!settings.valid_elements) {\n        each$3(schemaItems, function (element, name) {\n          elements[name] = {\n            attributes: element.attributes,\n            attributesOrder: element.attributesOrder\n          };\n          children[name] = element.children;\n        });\n        if (settings.schema !== 'html5') {\n          each$3(split('strong/b em/i'), function (item) {\n            var items = split(item, '/');\n            elements[items[1]].outputName = items[0];\n          });\n        }\n        each$3(split('ol ul sub sup blockquote span font a table tbody strong em b i'), function (name) {\n          if (elements[name]) {\n            elements[name].removeEmpty = true;\n          }\n        });\n        each$3(split('p h1 h2 h3 h4 h5 h6 th td pre div address caption li'), function (name) {\n          elements[name].paddEmpty = true;\n        });\n        each$3(split('span'), function (name) {\n          elements[name].removeEmptyAttrs = true;\n        });\n      } else {\n        setValidElements(settings.valid_elements);\n      }\n      addCustomElements(settings.custom_elements);\n      addValidChildren(settings.valid_children);\n      addValidElements(settings.extended_valid_elements);\n      addValidChildren('+ol[ul|ol],+ul[ul|ol]');\n      each$3({\n        dd: 'dl',\n        dt: 'dl',\n        li: 'ul ol',\n        td: 'tr',\n        th: 'tr',\n        tr: 'tbody thead tfoot',\n        tbody: 'table',\n        thead: 'table',\n        tfoot: 'table',\n        legend: 'fieldset',\n        area: 'map',\n        param: 'video audio object'\n      }, function (parents, item) {\n        if (elements[item]) {\n          elements[item].parentsRequired = split(parents);\n        }\n      });\n      if (settings.invalid_elements) {\n        each$3(explode$1(settings.invalid_elements), function (item) {\n          if (elements[item]) {\n            delete elements[item];\n          }\n        });\n      }\n      if (!getElementRule('span')) {\n        addValidElements('span[!data-mce-type|*]');\n      }\n      var getValidStyles = function () {\n        return validStyles;\n      };\n      var getInvalidStyles = function () {\n        return invalidStyles;\n      };\n      var getValidClasses = function () {\n        return validClasses;\n      };\n      var getBoolAttrs = function () {\n        return boolAttrMap;\n      };\n      var getBlockElements = function () {\n        return blockElementsMap;\n      };\n      var getTextBlockElements = function () {\n        return textBlockElementsMap;\n      };\n      var getTextInlineElements = function () {\n        return textInlineElementsMap;\n      };\n      var getShortEndedElements = function () {\n        return shortEndedElementsMap;\n      };\n      var getSelfClosingElements = function () {\n        return selfClosingElementsMap;\n      };\n      var getNonEmptyElements = function () {\n        return nonEmptyElementsMap;\n      };\n      var getMoveCaretBeforeOnEnterElements = function () {\n        return moveCaretBeforeOnEnterElementsMap;\n      };\n      var getWhiteSpaceElements = function () {\n        return whiteSpaceElementsMap;\n      };\n      var getSpecialElements = function () {\n        return specialElements;\n      };\n      var isValidChild = function (name, child) {\n        var parent = children[name.toLowerCase()];\n        return !!(parent && parent[child.toLowerCase()]);\n      };\n      var isValid = function (name, attr) {\n        var attrPatterns, i;\n        var rule = getElementRule(name);\n        if (rule) {\n          if (attr) {\n            if (rule.attributes[attr]) {\n              return true;\n            }\n            attrPatterns = rule.attributePatterns;\n            if (attrPatterns) {\n              i = attrPatterns.length;\n              while (i--) {\n                if (attrPatterns[i].pattern.test(name)) {\n                  return true;\n                }\n              }\n            }\n          } else {\n            return true;\n          }\n        }\n        return false;\n      };\n      var getCustomElements = function () {\n        return customElementsMap;\n      };\n      return {\n        children: children,\n        elements: elements,\n        getValidStyles: getValidStyles,\n        getValidClasses: getValidClasses,\n        getBlockElements: getBlockElements,\n        getInvalidStyles: getInvalidStyles,\n        getShortEndedElements: getShortEndedElements,\n        getTextBlockElements: getTextBlockElements,\n        getTextInlineElements: getTextInlineElements,\n        getBoolAttrs: getBoolAttrs,\n        getElementRule: getElementRule,\n        getSelfClosingElements: getSelfClosingElements,\n        getNonEmptyElements: getNonEmptyElements,\n        getMoveCaretBeforeOnEnterElements: getMoveCaretBeforeOnEnterElements,\n        getWhiteSpaceElements: getWhiteSpaceElements,\n        getSpecialElements: getSpecialElements,\n        isValidChild: isValidChild,\n        isValid: isValid,\n        getCustomElements: getCustomElements,\n        addValidElements: addValidElements,\n        setValidElements: setValidElements,\n        addCustomElements: addCustomElements,\n        addValidChildren: addValidChildren\n      };\n    };\n\n    var toHex = function (match, r, g, b) {\n      var hex = function (val) {\n        val = parseInt(val, 10).toString(16);\n        return val.length > 1 ? val : '0' + val;\n      };\n      return '#' + hex(r) + hex(g) + hex(b);\n    };\n    var Styles = function (settings, schema) {\n      var _this = this;\n      var rgbRegExp = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*\\)/gi;\n      var urlOrStrRegExp = /(?:url(?:(?:\\(\\s*\\\"([^\\\"]+)\\\"\\s*\\))|(?:\\(\\s*\\'([^\\']+)\\'\\s*\\))|(?:\\(\\s*([^)\\s]+)\\s*\\))))|(?:\\'([^\\']+)\\')|(?:\\\"([^\\\"]+)\\\")/gi;\n      var styleRegExp = /\\s*([^:]+):\\s*([^;]+);?/g;\n      var trimRightRegExp = /\\s+$/;\n      var i;\n      var encodingLookup = {};\n      var validStyles;\n      var invalidStyles;\n      var invisibleChar = zeroWidth;\n      settings = settings || {};\n      if (schema) {\n        validStyles = schema.getValidStyles();\n        invalidStyles = schema.getInvalidStyles();\n      }\n      var encodingItems = ('\\\\\" \\\\\\' \\\\; \\\\: ; : ' + invisibleChar).split(' ');\n      for (i = 0; i < encodingItems.length; i++) {\n        encodingLookup[encodingItems[i]] = invisibleChar + i;\n        encodingLookup[invisibleChar + i] = encodingItems[i];\n      }\n      return {\n        toHex: function (color) {\n          return color.replace(rgbRegExp, toHex);\n        },\n        parse: function (css) {\n          var styles = {};\n          var matches, name, value, isEncoded;\n          var urlConverter = settings.url_converter;\n          var urlConverterScope = settings.url_converter_scope || _this;\n          var compress = function (prefix, suffix, noJoin) {\n            var top = styles[prefix + '-top' + suffix];\n            if (!top) {\n              return;\n            }\n            var right = styles[prefix + '-right' + suffix];\n            if (!right) {\n              return;\n            }\n            var bottom = styles[prefix + '-bottom' + suffix];\n            if (!bottom) {\n              return;\n            }\n            var left = styles[prefix + '-left' + suffix];\n            if (!left) {\n              return;\n            }\n            var box = [\n              top,\n              right,\n              bottom,\n              left\n            ];\n            i = box.length - 1;\n            while (i--) {\n              if (box[i] !== box[i + 1]) {\n                break;\n              }\n            }\n            if (i > -1 && noJoin) {\n              return;\n            }\n            styles[prefix + suffix] = i === -1 ? box[0] : box.join(' ');\n            delete styles[prefix + '-top' + suffix];\n            delete styles[prefix + '-right' + suffix];\n            delete styles[prefix + '-bottom' + suffix];\n            delete styles[prefix + '-left' + suffix];\n          };\n          var canCompress = function (key) {\n            var value = styles[key], i;\n            if (!value) {\n              return;\n            }\n            value = value.split(' ');\n            i = value.length;\n            while (i--) {\n              if (value[i] !== value[0]) {\n                return false;\n              }\n            }\n            styles[key] = value[0];\n            return true;\n          };\n          var compress2 = function (target, a, b, c) {\n            if (!canCompress(a)) {\n              return;\n            }\n            if (!canCompress(b)) {\n              return;\n            }\n            if (!canCompress(c)) {\n              return;\n            }\n            styles[target] = styles[a] + ' ' + styles[b] + ' ' + styles[c];\n            delete styles[a];\n            delete styles[b];\n            delete styles[c];\n          };\n          var encode = function (str) {\n            isEncoded = true;\n            return encodingLookup[str];\n          };\n          var decode = function (str, keepSlashes) {\n            if (isEncoded) {\n              str = str.replace(/\\uFEFF[0-9]/g, function (str) {\n                return encodingLookup[str];\n              });\n            }\n            if (!keepSlashes) {\n              str = str.replace(/\\\\([\\'\\\";:])/g, '$1');\n            }\n            return str;\n          };\n          var decodeSingleHexSequence = function (escSeq) {\n            return String.fromCharCode(parseInt(escSeq.slice(1), 16));\n          };\n          var decodeHexSequences = function (value) {\n            return value.replace(/\\\\[0-9a-f]+/gi, decodeSingleHexSequence);\n          };\n          var processUrl = function (match, url, url2, url3, str, str2) {\n            str = str || str2;\n            if (str) {\n              str = decode(str);\n              return '\\'' + str.replace(/\\'/g, '\\\\\\'') + '\\'';\n            }\n            url = decode(url || url2 || url3);\n            if (!settings.allow_script_urls) {\n              var scriptUrl = url.replace(/[\\s\\r\\n]+/g, '');\n              if (/(java|vb)script:/i.test(scriptUrl)) {\n                return '';\n              }\n              if (!settings.allow_svg_data_urls && /^data:image\\/svg/i.test(scriptUrl)) {\n                return '';\n              }\n            }\n            if (urlConverter) {\n              url = urlConverter.call(urlConverterScope, url, 'style');\n            }\n            return 'url(\\'' + url.replace(/\\'/g, '\\\\\\'') + '\\')';\n          };\n          if (css) {\n            css = css.replace(/[\\u0000-\\u001F]/g, '');\n            css = css.replace(/\\\\[\\\"\\';:\\uFEFF]/g, encode).replace(/\\\"[^\\\"]+\\\"|\\'[^\\']+\\'/g, function (str) {\n              return str.replace(/[;:]/g, encode);\n            });\n            while (matches = styleRegExp.exec(css)) {\n              styleRegExp.lastIndex = matches.index + matches[0].length;\n              name = matches[1].replace(trimRightRegExp, '').toLowerCase();\n              value = matches[2].replace(trimRightRegExp, '');\n              if (name && value) {\n                name = decodeHexSequences(name);\n                value = decodeHexSequences(value);\n                if (name.indexOf(invisibleChar) !== -1 || name.indexOf('\"') !== -1) {\n                  continue;\n                }\n                if (!settings.allow_script_urls && (name === 'behavior' || /expression\\s*\\(|\\/\\*|\\*\\//.test(value))) {\n                  continue;\n                }\n                if (name === 'font-weight' && value === '700') {\n                  value = 'bold';\n                } else if (name === 'color' || name === 'background-color') {\n                  value = value.toLowerCase();\n                }\n                value = value.replace(rgbRegExp, toHex);\n                value = value.replace(urlOrStrRegExp, processUrl);\n                styles[name] = isEncoded ? decode(value, true) : value;\n              }\n            }\n            compress('border', '', true);\n            compress('border', '-width');\n            compress('border', '-color');\n            compress('border', '-style');\n            compress('padding', '');\n            compress('margin', '');\n            compress2('border', 'border-width', 'border-style', 'border-color');\n            if (styles.border === 'medium none') {\n              delete styles.border;\n            }\n            if (styles['border-image'] === 'none') {\n              delete styles['border-image'];\n            }\n          }\n          return styles;\n        },\n        serialize: function (styles, elementName) {\n          var css = '';\n          var serializeStyles = function (name) {\n            var value;\n            var styleList = validStyles[name];\n            if (styleList) {\n              for (var i_1 = 0, l = styleList.length; i_1 < l; i_1++) {\n                name = styleList[i_1];\n                value = styles[name];\n                if (value) {\n                  css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n                }\n              }\n            }\n          };\n          var isValid = function (name, elementName) {\n            var styleMap = invalidStyles['*'];\n            if (styleMap && styleMap[name]) {\n              return false;\n            }\n            styleMap = invalidStyles[elementName];\n            return !(styleMap && styleMap[name]);\n          };\n          if (elementName && validStyles) {\n            serializeStyles('*');\n            serializeStyles(elementName);\n          } else {\n            each$1(styles, function (value, name) {\n              if (value && (!invalidStyles || isValid(name, elementName))) {\n                css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n              }\n            });\n          }\n          return css;\n        }\n      };\n    };\n\n    var eventExpandoPrefix = 'mce-data-';\n    var mouseEventRe = /^(?:mouse|contextmenu)|click/;\n    var deprecated = {\n      keyLocation: 1,\n      layerX: 1,\n      layerY: 1,\n      returnValue: 1,\n      webkitMovementX: 1,\n      webkitMovementY: 1,\n      keyIdentifier: 1,\n      mozPressure: 1\n    };\n    var hasIsDefaultPrevented = function (event) {\n      return event.isDefaultPrevented === returnTrue || event.isDefaultPrevented === returnFalse;\n    };\n    var returnFalse = never;\n    var returnTrue = always;\n    var addEvent = function (target, name, callback, capture) {\n      if (target.addEventListener) {\n        target.addEventListener(name, callback, capture || false);\n      } else if (target.attachEvent) {\n        target.attachEvent('on' + name, callback);\n      }\n    };\n    var removeEvent = function (target, name, callback, capture) {\n      if (target.removeEventListener) {\n        target.removeEventListener(name, callback, capture || false);\n      } else if (target.detachEvent) {\n        target.detachEvent('on' + name, callback);\n      }\n    };\n    var isMouseEvent = function (event) {\n      return mouseEventRe.test(event.type);\n    };\n    var fix = function (originalEvent, data) {\n      var name;\n      var event = data || {};\n      for (name in originalEvent) {\n        if (!deprecated[name]) {\n          event[name] = originalEvent[name];\n        }\n      }\n      if (!event.target) {\n        event.target = event.srcElement || document;\n      }\n      if (event.composedPath) {\n        event.composedPath = function () {\n          return originalEvent.composedPath();\n        };\n      }\n      if (originalEvent && isMouseEvent(originalEvent) && originalEvent.pageX === undefined && originalEvent.clientX !== undefined) {\n        var eventDoc = event.target.ownerDocument || document;\n        var doc = eventDoc.documentElement;\n        var body = eventDoc.body;\n        event.pageX = originalEvent.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);\n        event.pageY = originalEvent.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0);\n      }\n      event.preventDefault = function () {\n        event.defaultPrevented = true;\n        event.isDefaultPrevented = returnTrue;\n        if (originalEvent) {\n          if (originalEvent.preventDefault) {\n            originalEvent.preventDefault();\n          } else {\n            originalEvent.returnValue = false;\n          }\n        }\n      };\n      event.stopPropagation = function () {\n        event.cancelBubble = true;\n        event.isPropagationStopped = returnTrue;\n        if (originalEvent) {\n          if (originalEvent.stopPropagation) {\n            originalEvent.stopPropagation();\n          } else {\n            originalEvent.cancelBubble = true;\n          }\n        }\n      };\n      event.stopImmediatePropagation = function () {\n        event.isImmediatePropagationStopped = returnTrue;\n        event.stopPropagation();\n      };\n      if (hasIsDefaultPrevented(event) === false) {\n        event.isDefaultPrevented = event.defaultPrevented === true ? returnTrue : returnFalse;\n        event.isPropagationStopped = event.cancelBubble === true ? returnTrue : returnFalse;\n        event.isImmediatePropagationStopped = returnFalse;\n      }\n      if (typeof event.metaKey === 'undefined') {\n        event.metaKey = false;\n      }\n      return event;\n    };\n    var bindOnReady = function (win, callback, eventUtils) {\n      var doc = win.document, event = { type: 'ready' };\n      if (eventUtils.domLoaded) {\n        callback(event);\n        return;\n      }\n      var isDocReady = function () {\n        return doc.readyState === 'complete' || doc.readyState === 'interactive' && doc.body;\n      };\n      var readyHandler = function () {\n        removeEvent(win, 'DOMContentLoaded', readyHandler);\n        removeEvent(win, 'load', readyHandler);\n        if (!eventUtils.domLoaded) {\n          eventUtils.domLoaded = true;\n          callback(event);\n        }\n        win = null;\n      };\n      if (isDocReady()) {\n        readyHandler();\n      } else {\n        addEvent(win, 'DOMContentLoaded', readyHandler);\n      }\n      if (!eventUtils.domLoaded) {\n        addEvent(win, 'load', readyHandler);\n      }\n    };\n    var EventUtils = function () {\n      function EventUtils() {\n        this.domLoaded = false;\n        this.events = {};\n        this.count = 1;\n        this.expando = eventExpandoPrefix + (+new Date()).toString(32);\n        this.hasMouseEnterLeave = 'onmouseenter' in document.documentElement;\n        this.hasFocusIn = 'onfocusin' in document.documentElement;\n        this.count = 1;\n      }\n      EventUtils.prototype.bind = function (target, names, callback, scope) {\n        var self = this;\n        var id, callbackList, i, name, fakeName, nativeHandler, capture;\n        var win = window;\n        var defaultNativeHandler = function (evt) {\n          self.executeHandlers(fix(evt || win.event), id);\n        };\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return;\n        }\n        if (!target[self.expando]) {\n          id = self.count++;\n          target[self.expando] = id;\n          self.events[id] = {};\n        } else {\n          id = target[self.expando];\n        }\n        scope = scope || target;\n        var namesList = names.split(' ');\n        i = namesList.length;\n        while (i--) {\n          name = namesList[i];\n          nativeHandler = defaultNativeHandler;\n          fakeName = capture = false;\n          if (name === 'DOMContentLoaded') {\n            name = 'ready';\n          }\n          if (self.domLoaded && name === 'ready' && target.readyState === 'complete') {\n            callback.call(scope, fix({ type: name }));\n            continue;\n          }\n          if (!self.hasMouseEnterLeave) {\n            fakeName = self.mouseEnterLeave[name];\n            if (fakeName) {\n              nativeHandler = function (evt) {\n                var current = evt.currentTarget;\n                var related = evt.relatedTarget;\n                if (related && current.contains) {\n                  related = current.contains(related);\n                } else {\n                  while (related && related !== current) {\n                    related = related.parentNode;\n                  }\n                }\n                if (!related) {\n                  evt = fix(evt || win.event);\n                  evt.type = evt.type === 'mouseout' ? 'mouseleave' : 'mouseenter';\n                  evt.target = current;\n                  self.executeHandlers(evt, id);\n                }\n              };\n            }\n          }\n          if (!self.hasFocusIn && (name === 'focusin' || name === 'focusout')) {\n            capture = true;\n            fakeName = name === 'focusin' ? 'focus' : 'blur';\n            nativeHandler = function (evt) {\n              evt = fix(evt || win.event);\n              evt.type = evt.type === 'focus' ? 'focusin' : 'focusout';\n              self.executeHandlers(evt, id);\n            };\n          }\n          callbackList = self.events[id][name];\n          if (!callbackList) {\n            self.events[id][name] = callbackList = [{\n                func: callback,\n                scope: scope\n              }];\n            callbackList.fakeName = fakeName;\n            callbackList.capture = capture;\n            callbackList.nativeHandler = nativeHandler;\n            if (name === 'ready') {\n              bindOnReady(target, nativeHandler, self);\n            } else {\n              addEvent(target, fakeName || name, nativeHandler, capture);\n            }\n          } else {\n            if (name === 'ready' && self.domLoaded) {\n              callback(fix({ type: name }));\n            } else {\n              callbackList.push({\n                func: callback,\n                scope: scope\n              });\n            }\n          }\n        }\n        target = callbackList = null;\n        return callback;\n      };\n      EventUtils.prototype.unbind = function (target, names, callback) {\n        var callbackList, i, ci, name, eventMap;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        var id = target[this.expando];\n        if (id) {\n          eventMap = this.events[id];\n          if (names) {\n            var namesList = names.split(' ');\n            i = namesList.length;\n            while (i--) {\n              name = namesList[i];\n              callbackList = eventMap[name];\n              if (callbackList) {\n                if (callback) {\n                  ci = callbackList.length;\n                  while (ci--) {\n                    if (callbackList[ci].func === callback) {\n                      var nativeHandler = callbackList.nativeHandler;\n                      var fakeName = callbackList.fakeName, capture = callbackList.capture;\n                      callbackList = callbackList.slice(0, ci).concat(callbackList.slice(ci + 1));\n                      callbackList.nativeHandler = nativeHandler;\n                      callbackList.fakeName = fakeName;\n                      callbackList.capture = capture;\n                      eventMap[name] = callbackList;\n                    }\n                  }\n                }\n                if (!callback || callbackList.length === 0) {\n                  delete eventMap[name];\n                  removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n                }\n              }\n            }\n          } else {\n            each$1(eventMap, function (callbackList, name) {\n              removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n            });\n            eventMap = {};\n          }\n          for (name in eventMap) {\n            if (has(eventMap, name)) {\n              return this;\n            }\n          }\n          delete this.events[id];\n          try {\n            delete target[this.expando];\n          } catch (ex) {\n            target[this.expando] = null;\n          }\n        }\n        return this;\n      };\n      EventUtils.prototype.fire = function (target, name, args) {\n        var id;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        var event = fix(null, args);\n        event.type = name;\n        event.target = target;\n        do {\n          id = target[this.expando];\n          if (id) {\n            this.executeHandlers(event, id);\n          }\n          target = target.parentNode || target.ownerDocument || target.defaultView || target.parentWindow;\n        } while (target && !event.isPropagationStopped());\n        return this;\n      };\n      EventUtils.prototype.clean = function (target) {\n        var i, children;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        if (target[this.expando]) {\n          this.unbind(target);\n        }\n        if (!target.getElementsByTagName) {\n          target = target.document;\n        }\n        if (target && target.getElementsByTagName) {\n          this.unbind(target);\n          children = target.getElementsByTagName('*');\n          i = children.length;\n          while (i--) {\n            target = children[i];\n            if (target[this.expando]) {\n              this.unbind(target);\n            }\n          }\n        }\n        return this;\n      };\n      EventUtils.prototype.destroy = function () {\n        this.events = {};\n      };\n      EventUtils.prototype.cancel = function (e) {\n        if (e) {\n          e.preventDefault();\n          e.stopImmediatePropagation();\n        }\n        return false;\n      };\n      EventUtils.prototype.executeHandlers = function (evt, id) {\n        var container = this.events[id];\n        var callbackList = container && container[evt.type];\n        if (callbackList) {\n          for (var i = 0, l = callbackList.length; i < l; i++) {\n            var callback = callbackList[i];\n            if (callback && callback.func.call(callback.scope, evt) === false) {\n              evt.preventDefault();\n            }\n            if (evt.isImmediatePropagationStopped()) {\n              return;\n            }\n          }\n        }\n      };\n      EventUtils.Event = new EventUtils();\n      return EventUtils;\n    }();\n\n    var support, Expr, getText, isXML, tokenize, compile, select, outermostContext, sortInput, hasDuplicate, setDocument, document$1, docElem, documentIsHTML, rbuggyQSA, rbuggyMatches, matches, contains$3, expando = 'sizzle' + -new Date(), preferredDoc = window.document, dirruns = 0, done = 0, classCache = createCache(), tokenCache = createCache(), compilerCache = createCache(), sortOrder = function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n        }\n        return 0;\n      }, strundefined = typeof undefined, MAX_NEGATIVE = 1 << 31, hasOwn = {}.hasOwnProperty, arr = [], pop = arr.pop, push_native = arr.push, push = arr.push, slice = arr.slice, indexOf$2 = arr.indexOf || function (elem) {\n        var i = 0, len = this.length;\n        for (; i < len; i++) {\n          if (this[i] === elem) {\n            return i;\n          }\n        }\n        return -1;\n      }, booleans = 'checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped', whitespace = '[\\\\x20\\\\t\\\\r\\\\n\\\\f]', identifier = '(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+', attributes = '\\\\[' + whitespace + '*(' + identifier + ')(?:' + whitespace + '*([*^$|!~]?=)' + whitespace + '*(?:\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\"|(' + identifier + '))|)' + whitespace + '*\\\\]', pseudos = ':(' + identifier + ')(?:\\\\((' + '(\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\")|' + '((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|' + attributes + ')*)|' + '.*' + ')\\\\)|)', rtrim = new RegExp('^' + whitespace + '+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)' + whitespace + '+$', 'g'), rcomma = new RegExp('^' + whitespace + '*,' + whitespace + '*'), rcombinators = new RegExp('^' + whitespace + '*([>+~]|' + whitespace + ')' + whitespace + '*'), rattributeQuotes = new RegExp('=' + whitespace + '*([^\\\\]\\'\"]*?)' + whitespace + '*\\\\]', 'g'), rpseudo = new RegExp(pseudos), ridentifier = new RegExp('^' + identifier + '$'), matchExpr = {\n        ID: new RegExp('^#(' + identifier + ')'),\n        CLASS: new RegExp('^\\\\.(' + identifier + ')'),\n        TAG: new RegExp('^(' + identifier + '|[*])'),\n        ATTR: new RegExp('^' + attributes),\n        PSEUDO: new RegExp('^' + pseudos),\n        CHILD: new RegExp('^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(' + whitespace + '*(even|odd|(([+-]|)(\\\\d*)n|)' + whitespace + '*(?:([+-]|)' + whitespace + '*(\\\\d+)|))' + whitespace + '*\\\\)|)', 'i'),\n        bool: new RegExp('^(?:' + booleans + ')$', 'i'),\n        needsContext: new RegExp('^' + whitespace + '*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(' + whitespace + '*((?:-\\\\d)?\\\\d*)' + whitespace + '*\\\\)|)(?=[^-]|$)', 'i')\n      }, rinputs = /^(?:input|select|textarea|button)$/i, rheader = /^h\\d$/i, rnative = /^[^{]+\\{\\s*\\[native \\w/, rquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/, rsibling = /[+~]/, rescape = /'|\\\\/g, runescape = new RegExp('\\\\\\\\([\\\\da-f]{1,6}' + whitespace + '?|(' + whitespace + ')|.)', 'ig'), funescape = function (_, escaped, escapedWhitespace) {\n        var high = '0x' + escaped - 65536;\n        return high !== high || escapedWhitespace ? escaped : high < 0 ? String.fromCharCode(high + 65536) : String.fromCharCode(high >> 10 | 55296, high & 1023 | 56320);\n      };\n    try {\n      push.apply(arr = slice.call(preferredDoc.childNodes), preferredDoc.childNodes);\n      arr[preferredDoc.childNodes.length].nodeType;\n    } catch (e) {\n      push = {\n        apply: arr.length ? function (target, els) {\n          push_native.apply(target, slice.call(els));\n        } : function (target, els) {\n          var j = target.length, i = 0;\n          while (target[j++] = els[i++]) {\n          }\n          target.length = j - 1;\n        }\n      };\n    }\n    var Sizzle = function (selector, context, results, seed) {\n      var match, elem, m, nodeType, i, groups, old, nid, newContext, newSelector;\n      if ((context ? context.ownerDocument || context : preferredDoc) !== document$1) {\n        setDocument(context);\n      }\n      context = context || document$1;\n      results = results || [];\n      if (!selector || typeof selector !== 'string') {\n        return results;\n      }\n      if ((nodeType = context.nodeType) !== 1 && nodeType !== 9) {\n        return [];\n      }\n      if (documentIsHTML && !seed) {\n        if (match = rquickExpr.exec(selector)) {\n          if (m = match[1]) {\n            if (nodeType === 9) {\n              elem = context.getElementById(m);\n              if (elem && elem.parentNode) {\n                if (elem.id === m) {\n                  results.push(elem);\n                  return results;\n                }\n              } else {\n                return results;\n              }\n            } else {\n              if (context.ownerDocument && (elem = context.ownerDocument.getElementById(m)) && contains$3(context, elem) && elem.id === m) {\n                results.push(elem);\n                return results;\n              }\n            }\n          } else if (match[2]) {\n            push.apply(results, context.getElementsByTagName(selector));\n            return results;\n          } else if ((m = match[3]) && support.getElementsByClassName) {\n            push.apply(results, context.getElementsByClassName(m));\n            return results;\n          }\n        }\n        if (support.qsa && (!rbuggyQSA || !rbuggyQSA.test(selector))) {\n          nid = old = expando;\n          newContext = context;\n          newSelector = nodeType === 9 && selector;\n          if (nodeType === 1 && context.nodeName.toLowerCase() !== 'object') {\n            groups = tokenize(selector);\n            if (old = context.getAttribute('id')) {\n              nid = old.replace(rescape, '\\\\$&');\n            } else {\n              context.setAttribute('id', nid);\n            }\n            nid = '[id=\\'' + nid + '\\'] ';\n            i = groups.length;\n            while (i--) {\n              groups[i] = nid + toSelector(groups[i]);\n            }\n            newContext = rsibling.test(selector) && testContext(context.parentNode) || context;\n            newSelector = groups.join(',');\n          }\n          if (newSelector) {\n            try {\n              push.apply(results, newContext.querySelectorAll(newSelector));\n              return results;\n            } catch (qsaError) {\n            } finally {\n              if (!old) {\n                context.removeAttribute('id');\n              }\n            }\n          }\n        }\n      }\n      return select(selector.replace(rtrim, '$1'), context, results, seed);\n    };\n    function createCache() {\n      var keys = [];\n      function cache(key, value) {\n        if (keys.push(key + ' ') > Expr.cacheLength) {\n          delete cache[keys.shift()];\n        }\n        return cache[key + ' '] = value;\n      }\n      return cache;\n    }\n    function markFunction(fn) {\n      fn[expando] = true;\n      return fn;\n    }\n    function siblingCheck(a, b) {\n      var cur = b && a, diff = cur && a.nodeType === 1 && b.nodeType === 1 && (~b.sourceIndex || MAX_NEGATIVE) - (~a.sourceIndex || MAX_NEGATIVE);\n      if (diff) {\n        return diff;\n      }\n      if (cur) {\n        while (cur = cur.nextSibling) {\n          if (cur === b) {\n            return -1;\n          }\n        }\n      }\n      return a ? 1 : -1;\n    }\n    function createInputPseudo(type) {\n      return function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return name === 'input' && elem.type === type;\n      };\n    }\n    function createButtonPseudo(type) {\n      return function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return (name === 'input' || name === 'button') && elem.type === type;\n      };\n    }\n    function createPositionalPseudo(fn) {\n      return markFunction(function (argument) {\n        argument = +argument;\n        return markFunction(function (seed, matches) {\n          var j, matchIndexes = fn([], seed.length, argument), i = matchIndexes.length;\n          while (i--) {\n            if (seed[j = matchIndexes[i]]) {\n              seed[j] = !(matches[j] = seed[j]);\n            }\n          }\n        });\n      });\n    }\n    function testContext(context) {\n      return context && typeof context.getElementsByTagName !== strundefined && context;\n    }\n    support = Sizzle.support = {};\n    isXML = Sizzle.isXML = function (elem) {\n      var documentElement = elem && (elem.ownerDocument || elem).documentElement;\n      return documentElement ? documentElement.nodeName !== 'HTML' : false;\n    };\n    setDocument = Sizzle.setDocument = function (node) {\n      var hasCompare, doc = node ? node.ownerDocument || node : preferredDoc, parent = doc.defaultView;\n      function getTop(win) {\n        try {\n          return win.top;\n        } catch (ex) {\n        }\n        return null;\n      }\n      if (doc === document$1 || doc.nodeType !== 9 || !doc.documentElement) {\n        return document$1;\n      }\n      document$1 = doc;\n      docElem = doc.documentElement;\n      documentIsHTML = !isXML(doc);\n      if (parent && parent !== getTop(parent)) {\n        if (parent.addEventListener) {\n          parent.addEventListener('unload', function () {\n            setDocument();\n          }, false);\n        } else if (parent.attachEvent) {\n          parent.attachEvent('onunload', function () {\n            setDocument();\n          });\n        }\n      }\n      support.attributes = true;\n      support.getElementsByTagName = true;\n      support.getElementsByClassName = rnative.test(doc.getElementsByClassName);\n      support.getById = true;\n      Expr.find.ID = function (id, context) {\n        if (typeof context.getElementById !== strundefined && documentIsHTML) {\n          var m = context.getElementById(id);\n          return m && m.parentNode ? [m] : [];\n        }\n      };\n      Expr.filter.ID = function (id) {\n        var attrId = id.replace(runescape, funescape);\n        return function (elem) {\n          return elem.getAttribute('id') === attrId;\n        };\n      };\n      Expr.find.TAG = support.getElementsByTagName ? function (tag, context) {\n        if (typeof context.getElementsByTagName !== strundefined) {\n          return context.getElementsByTagName(tag);\n        }\n      } : function (tag, context) {\n        var elem, tmp = [], i = 0, results = context.getElementsByTagName(tag);\n        if (tag === '*') {\n          while (elem = results[i++]) {\n            if (elem.nodeType === 1) {\n              tmp.push(elem);\n            }\n          }\n          return tmp;\n        }\n        return results;\n      };\n      Expr.find.CLASS = support.getElementsByClassName && function (className, context) {\n        if (documentIsHTML) {\n          return context.getElementsByClassName(className);\n        }\n      };\n      rbuggyMatches = [];\n      rbuggyQSA = [];\n      support.disconnectedMatch = true;\n      rbuggyQSA = rbuggyQSA.length && new RegExp(rbuggyQSA.join('|'));\n      rbuggyMatches = rbuggyMatches.length && new RegExp(rbuggyMatches.join('|'));\n      hasCompare = rnative.test(docElem.compareDocumentPosition);\n      contains$3 = hasCompare || rnative.test(docElem.contains) ? function (a, b) {\n        var adown = a.nodeType === 9 ? a.documentElement : a, bup = b && b.parentNode;\n        return a === bup || !!(bup && bup.nodeType === 1 && (adown.contains ? adown.contains(bup) : a.compareDocumentPosition && a.compareDocumentPosition(bup) & 16));\n      } : function (a, b) {\n        if (b) {\n          while (b = b.parentNode) {\n            if (b === a) {\n              return true;\n            }\n          }\n        }\n        return false;\n      };\n      sortOrder = hasCompare ? function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n          return 0;\n        }\n        var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n        if (compare) {\n          return compare;\n        }\n        compare = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1;\n        if (compare & 1 || !support.sortDetached && b.compareDocumentPosition(a) === compare) {\n          if (a === doc || a.ownerDocument === preferredDoc && contains$3(preferredDoc, a)) {\n            return -1;\n          }\n          if (b === doc || b.ownerDocument === preferredDoc && contains$3(preferredDoc, b)) {\n            return 1;\n          }\n          return sortInput ? indexOf$2.call(sortInput, a) - indexOf$2.call(sortInput, b) : 0;\n        }\n        return compare & 4 ? -1 : 1;\n      } : function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n          return 0;\n        }\n        var cur, i = 0, aup = a.parentNode, bup = b.parentNode, ap = [a], bp = [b];\n        if (!aup || !bup) {\n          return a === doc ? -1 : b === doc ? 1 : aup ? -1 : bup ? 1 : sortInput ? indexOf$2.call(sortInput, a) - indexOf$2.call(sortInput, b) : 0;\n        } else if (aup === bup) {\n          return siblingCheck(a, b);\n        }\n        cur = a;\n        while (cur = cur.parentNode) {\n          ap.unshift(cur);\n        }\n        cur = b;\n        while (cur = cur.parentNode) {\n          bp.unshift(cur);\n        }\n        while (ap[i] === bp[i]) {\n          i++;\n        }\n        return i ? siblingCheck(ap[i], bp[i]) : ap[i] === preferredDoc ? -1 : bp[i] === preferredDoc ? 1 : 0;\n      };\n      return doc;\n    };\n    Sizzle.matches = function (expr, elements) {\n      return Sizzle(expr, null, null, elements);\n    };\n    Sizzle.matchesSelector = function (elem, expr) {\n      if ((elem.ownerDocument || elem) !== document$1) {\n        setDocument(elem);\n      }\n      expr = expr.replace(rattributeQuotes, '=\\'$1\\']');\n      if (support.matchesSelector && documentIsHTML && (!rbuggyMatches || !rbuggyMatches.test(expr)) && (!rbuggyQSA || !rbuggyQSA.test(expr))) {\n        try {\n          var ret = matches.call(elem, expr);\n          if (ret || support.disconnectedMatch || elem.document && elem.document.nodeType !== 11) {\n            return ret;\n          }\n        } catch (e) {\n        }\n      }\n      return Sizzle(expr, document$1, null, [elem]).length > 0;\n    };\n    Sizzle.contains = function (context, elem) {\n      if ((context.ownerDocument || context) !== document$1) {\n        setDocument(context);\n      }\n      return contains$3(context, elem);\n    };\n    Sizzle.attr = function (elem, name) {\n      if ((elem.ownerDocument || elem) !== document$1) {\n        setDocument(elem);\n      }\n      var fn = Expr.attrHandle[name.toLowerCase()], val = fn && hasOwn.call(Expr.attrHandle, name.toLowerCase()) ? fn(elem, name, !documentIsHTML) : undefined;\n      return val !== undefined ? val : support.attributes || !documentIsHTML ? elem.getAttribute(name) : (val = elem.getAttributeNode(name)) && val.specified ? val.value : null;\n    };\n    Sizzle.error = function (msg) {\n      throw new Error('Syntax error, unrecognized expression: ' + msg);\n    };\n    Sizzle.uniqueSort = function (results) {\n      var elem, duplicates = [], j = 0, i = 0;\n      hasDuplicate = !support.detectDuplicates;\n      sortInput = !support.sortStable && results.slice(0);\n      results.sort(sortOrder);\n      if (hasDuplicate) {\n        while (elem = results[i++]) {\n          if (elem === results[i]) {\n            j = duplicates.push(i);\n          }\n        }\n        while (j--) {\n          results.splice(duplicates[j], 1);\n        }\n      }\n      sortInput = null;\n      return results;\n    };\n    getText = Sizzle.getText = function (elem) {\n      var node, ret = '', i = 0, nodeType = elem.nodeType;\n      if (!nodeType) {\n        while (node = elem[i++]) {\n          ret += getText(node);\n        }\n      } else if (nodeType === 1 || nodeType === 9 || nodeType === 11) {\n        if (typeof elem.textContent === 'string') {\n          return elem.textContent;\n        } else {\n          for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n            ret += getText(elem);\n          }\n        }\n      } else if (nodeType === 3 || nodeType === 4) {\n        return elem.nodeValue;\n      }\n      return ret;\n    };\n    Expr = Sizzle.selectors = {\n      cacheLength: 50,\n      createPseudo: markFunction,\n      match: matchExpr,\n      attrHandle: {},\n      find: {},\n      relative: {\n        '>': {\n          dir: 'parentNode',\n          first: true\n        },\n        ' ': { dir: 'parentNode' },\n        '+': {\n          dir: 'previousSibling',\n          first: true\n        },\n        '~': { dir: 'previousSibling' }\n      },\n      preFilter: {\n        ATTR: function (match) {\n          match[1] = match[1].replace(runescape, funescape);\n          match[3] = (match[3] || match[4] || match[5] || '').replace(runescape, funescape);\n          if (match[2] === '~=') {\n            match[3] = ' ' + match[3] + ' ';\n          }\n          return match.slice(0, 4);\n        },\n        CHILD: function (match) {\n          match[1] = match[1].toLowerCase();\n          if (match[1].slice(0, 3) === 'nth') {\n            if (!match[3]) {\n              Sizzle.error(match[0]);\n            }\n            match[4] = +(match[4] ? match[5] + (match[6] || 1) : 2 * (match[3] === 'even' || match[3] === 'odd'));\n            match[5] = +(match[7] + match[8] || match[3] === 'odd');\n          } else if (match[3]) {\n            Sizzle.error(match[0]);\n          }\n          return match;\n        },\n        PSEUDO: function (match) {\n          var excess, unquoted = !match[6] && match[2];\n          if (matchExpr.CHILD.test(match[0])) {\n            return null;\n          }\n          if (match[3]) {\n            match[2] = match[4] || match[5] || '';\n          } else if (unquoted && rpseudo.test(unquoted) && (excess = tokenize(unquoted, true)) && (excess = unquoted.indexOf(')', unquoted.length - excess) - unquoted.length)) {\n            match[0] = match[0].slice(0, excess);\n            match[2] = unquoted.slice(0, excess);\n          }\n          return match.slice(0, 3);\n        }\n      },\n      filter: {\n        TAG: function (nodeNameSelector) {\n          var nodeName = nodeNameSelector.replace(runescape, funescape).toLowerCase();\n          return nodeNameSelector === '*' ? function () {\n            return true;\n          } : function (elem) {\n            return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n          };\n        },\n        CLASS: function (className) {\n          var pattern = classCache[className + ' '];\n          return pattern || (pattern = new RegExp('(^|' + whitespace + ')' + className + '(' + whitespace + '|$)')) && classCache(className, function (elem) {\n            return pattern.test(typeof elem.className === 'string' && elem.className || typeof elem.getAttribute !== strundefined && elem.getAttribute('class') || '');\n          });\n        },\n        ATTR: function (name, operator, check) {\n          return function (elem) {\n            var result = Sizzle.attr(elem, name);\n            if (result == null) {\n              return operator === '!=';\n            }\n            if (!operator) {\n              return true;\n            }\n            result += '';\n            return operator === '=' ? result === check : operator === '!=' ? result !== check : operator === '^=' ? check && result.indexOf(check) === 0 : operator === '*=' ? check && result.indexOf(check) > -1 : operator === '$=' ? check && result.slice(-check.length) === check : operator === '~=' ? (' ' + result + ' ').indexOf(check) > -1 : operator === '|=' ? result === check || result.slice(0, check.length + 1) === check + '-' : false;\n          };\n        },\n        CHILD: function (type, what, argument, first, last) {\n          var simple = type.slice(0, 3) !== 'nth', forward = type.slice(-4) !== 'last', ofType = what === 'of-type';\n          return first === 1 && last === 0 ? function (elem) {\n            return !!elem.parentNode;\n          } : function (elem, context, xml) {\n            var cache, outerCache, node, diff, nodeIndex, start, dir = simple !== forward ? 'nextSibling' : 'previousSibling', parent = elem.parentNode, name = ofType && elem.nodeName.toLowerCase(), useCache = !xml && !ofType;\n            if (parent) {\n              if (simple) {\n                while (dir) {\n                  node = elem;\n                  while (node = node[dir]) {\n                    if (ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) {\n                      return false;\n                    }\n                  }\n                  start = dir = type === 'only' && !start && 'nextSibling';\n                }\n                return true;\n              }\n              start = [forward ? parent.firstChild : parent.lastChild];\n              if (forward && useCache) {\n                outerCache = parent[expando] || (parent[expando] = {});\n                cache = outerCache[type] || [];\n                nodeIndex = cache[0] === dirruns && cache[1];\n                diff = cache[0] === dirruns && cache[2];\n                node = nodeIndex && parent.childNodes[nodeIndex];\n                while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                  if (node.nodeType === 1 && ++diff && node === elem) {\n                    outerCache[type] = [\n                      dirruns,\n                      nodeIndex,\n                      diff\n                    ];\n                    break;\n                  }\n                }\n              } else if (useCache && (cache = (elem[expando] || (elem[expando] = {}))[type]) && cache[0] === dirruns) {\n                diff = cache[1];\n              } else {\n                while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                  if ((ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) && ++diff) {\n                    if (useCache) {\n                      (node[expando] || (node[expando] = {}))[type] = [\n                        dirruns,\n                        diff\n                      ];\n                    }\n                    if (node === elem) {\n                      break;\n                    }\n                  }\n                }\n              }\n              diff -= last;\n              return diff === first || diff % first === 0 && diff / first >= 0;\n            }\n          };\n        },\n        PSEUDO: function (pseudo, argument) {\n          var args, fn = Expr.pseudos[pseudo] || Expr.setFilters[pseudo.toLowerCase()] || Sizzle.error('unsupported pseudo: ' + pseudo);\n          if (fn[expando]) {\n            return fn(argument);\n          }\n          if (fn.length > 1) {\n            args = [\n              pseudo,\n              pseudo,\n              '',\n              argument\n            ];\n            return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase()) ? markFunction(function (seed, matches) {\n              var idx, matched = fn(seed, argument), i = matched.length;\n              while (i--) {\n                idx = indexOf$2.call(seed, matched[i]);\n                seed[idx] = !(matches[idx] = matched[i]);\n              }\n            }) : function (elem) {\n              return fn(elem, 0, args);\n            };\n          }\n          return fn;\n        }\n      },\n      pseudos: {\n        not: markFunction(function (selector) {\n          var input = [], results = [], matcher = compile(selector.replace(rtrim, '$1'));\n          return matcher[expando] ? markFunction(function (seed, matches, context, xml) {\n            var elem, unmatched = matcher(seed, null, xml, []), i = seed.length;\n            while (i--) {\n              if (elem = unmatched[i]) {\n                seed[i] = !(matches[i] = elem);\n              }\n            }\n          }) : function (elem, context, xml) {\n            input[0] = elem;\n            matcher(input, null, xml, results);\n            input[0] = null;\n            return !results.pop();\n          };\n        }),\n        has: markFunction(function (selector) {\n          return function (elem) {\n            return Sizzle(selector, elem).length > 0;\n          };\n        }),\n        contains: markFunction(function (text) {\n          text = text.replace(runescape, funescape);\n          return function (elem) {\n            return (elem.textContent || elem.innerText || getText(elem)).indexOf(text) > -1;\n          };\n        }),\n        lang: markFunction(function (lang) {\n          if (!ridentifier.test(lang || '')) {\n            Sizzle.error('unsupported lang: ' + lang);\n          }\n          lang = lang.replace(runescape, funescape).toLowerCase();\n          return function (elem) {\n            var elemLang;\n            do {\n              if (elemLang = documentIsHTML ? elem.lang : elem.getAttribute('xml:lang') || elem.getAttribute('lang')) {\n                elemLang = elemLang.toLowerCase();\n                return elemLang === lang || elemLang.indexOf(lang + '-') === 0;\n              }\n            } while ((elem = elem.parentNode) && elem.nodeType === 1);\n            return false;\n          };\n        }),\n        target: function (elem) {\n          var hash = window.location && window.location.hash;\n          return hash && hash.slice(1) === elem.id;\n        },\n        root: function (elem) {\n          return elem === docElem;\n        },\n        focus: function (elem) {\n          return elem === document$1.activeElement && (!document$1.hasFocus || document$1.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n        },\n        enabled: function (elem) {\n          return elem.disabled === false;\n        },\n        disabled: function (elem) {\n          return elem.disabled === true;\n        },\n        checked: function (elem) {\n          var nodeName = elem.nodeName.toLowerCase();\n          return nodeName === 'input' && !!elem.checked || nodeName === 'option' && !!elem.selected;\n        },\n        selected: function (elem) {\n          if (elem.parentNode) {\n            elem.parentNode.selectedIndex;\n          }\n          return elem.selected === true;\n        },\n        empty: function (elem) {\n          for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n            if (elem.nodeType < 6) {\n              return false;\n            }\n          }\n          return true;\n        },\n        parent: function (elem) {\n          return !Expr.pseudos.empty(elem);\n        },\n        header: function (elem) {\n          return rheader.test(elem.nodeName);\n        },\n        input: function (elem) {\n          return rinputs.test(elem.nodeName);\n        },\n        button: function (elem) {\n          var name = elem.nodeName.toLowerCase();\n          return name === 'input' && elem.type === 'button' || name === 'button';\n        },\n        text: function (elem) {\n          var attr;\n          return elem.nodeName.toLowerCase() === 'input' && elem.type === 'text' && ((attr = elem.getAttribute('type')) == null || attr.toLowerCase() === 'text');\n        },\n        first: createPositionalPseudo(function () {\n          return [0];\n        }),\n        last: createPositionalPseudo(function (matchIndexes, length) {\n          return [length - 1];\n        }),\n        eq: createPositionalPseudo(function (matchIndexes, length, argument) {\n          return [argument < 0 ? argument + length : argument];\n        }),\n        even: createPositionalPseudo(function (matchIndexes, length) {\n          var i = 0;\n          for (; i < length; i += 2) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        odd: createPositionalPseudo(function (matchIndexes, length) {\n          var i = 1;\n          for (; i < length; i += 2) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        lt: createPositionalPseudo(function (matchIndexes, length, argument) {\n          var i = argument < 0 ? argument + length : argument;\n          for (; --i >= 0;) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        gt: createPositionalPseudo(function (matchIndexes, length, argument) {\n          var i = argument < 0 ? argument + length : argument;\n          for (; ++i < length;) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        })\n      }\n    };\n    Expr.pseudos.nth = Expr.pseudos.eq;\n    each([\n      'radio',\n      'checkbox',\n      'file',\n      'password',\n      'image'\n    ], function (i) {\n      Expr.pseudos[i] = createInputPseudo(i);\n    });\n    each([\n      'submit',\n      'reset'\n    ], function (i) {\n      Expr.pseudos[i] = createButtonPseudo(i);\n    });\n    function setFilters() {\n    }\n    setFilters.prototype = Expr.filters = Expr.pseudos;\n    Expr.setFilters = new setFilters();\n    tokenize = Sizzle.tokenize = function (selector, parseOnly) {\n      var matched, match, tokens, type, soFar, groups, preFilters, cached = tokenCache[selector + ' '];\n      if (cached) {\n        return parseOnly ? 0 : cached.slice(0);\n      }\n      soFar = selector;\n      groups = [];\n      preFilters = Expr.preFilter;\n      while (soFar) {\n        if (!matched || (match = rcomma.exec(soFar))) {\n          if (match) {\n            soFar = soFar.slice(match[0].length) || soFar;\n          }\n          groups.push(tokens = []);\n        }\n        matched = false;\n        if (match = rcombinators.exec(soFar)) {\n          matched = match.shift();\n          tokens.push({\n            value: matched,\n            type: match[0].replace(rtrim, ' ')\n          });\n          soFar = soFar.slice(matched.length);\n        }\n        for (type in Expr.filter) {\n          if (!Expr.filter.hasOwnProperty(type)) {\n            continue;\n          }\n          if ((match = matchExpr[type].exec(soFar)) && (!preFilters[type] || (match = preFilters[type](match)))) {\n            matched = match.shift();\n            tokens.push({\n              value: matched,\n              type: type,\n              matches: match\n            });\n            soFar = soFar.slice(matched.length);\n          }\n        }\n        if (!matched) {\n          break;\n        }\n      }\n      return parseOnly ? soFar.length : soFar ? Sizzle.error(selector) : tokenCache(selector, groups).slice(0);\n    };\n    function toSelector(tokens) {\n      var i = 0, len = tokens.length, selector = '';\n      for (; i < len; i++) {\n        selector += tokens[i].value;\n      }\n      return selector;\n    }\n    function addCombinator(matcher, combinator, base) {\n      var dir = combinator.dir, checkNonElements = base && dir === 'parentNode', doneName = done++;\n      return combinator.first ? function (elem, context, xml) {\n        while (elem = elem[dir]) {\n          if (elem.nodeType === 1 || checkNonElements) {\n            return matcher(elem, context, xml);\n          }\n        }\n      } : function (elem, context, xml) {\n        var oldCache, outerCache, newCache = [\n            dirruns,\n            doneName\n          ];\n        if (xml) {\n          while (elem = elem[dir]) {\n            if (elem.nodeType === 1 || checkNonElements) {\n              if (matcher(elem, context, xml)) {\n                return true;\n              }\n            }\n          }\n        } else {\n          while (elem = elem[dir]) {\n            if (elem.nodeType === 1 || checkNonElements) {\n              outerCache = elem[expando] || (elem[expando] = {});\n              if ((oldCache = outerCache[dir]) && oldCache[0] === dirruns && oldCache[1] === doneName) {\n                return newCache[2] = oldCache[2];\n              } else {\n                outerCache[dir] = newCache;\n                if (newCache[2] = matcher(elem, context, xml)) {\n                  return true;\n                }\n              }\n            }\n          }\n        }\n      };\n    }\n    function elementMatcher(matchers) {\n      return matchers.length > 1 ? function (elem, context, xml) {\n        var i = matchers.length;\n        while (i--) {\n          if (!matchers[i](elem, context, xml)) {\n            return false;\n          }\n        }\n        return true;\n      } : matchers[0];\n    }\n    function multipleContexts(selector, contexts, results) {\n      var i = 0, len = contexts.length;\n      for (; i < len; i++) {\n        Sizzle(selector, contexts[i], results);\n      }\n      return results;\n    }\n    function condense(unmatched, map, filter, context, xml) {\n      var elem, newUnmatched = [], i = 0, len = unmatched.length, mapped = map != null;\n      for (; i < len; i++) {\n        if (elem = unmatched[i]) {\n          if (!filter || filter(elem, context, xml)) {\n            newUnmatched.push(elem);\n            if (mapped) {\n              map.push(i);\n            }\n          }\n        }\n      }\n      return newUnmatched;\n    }\n    function setMatcher(preFilter, selector, matcher, postFilter, postFinder, postSelector) {\n      if (postFilter && !postFilter[expando]) {\n        postFilter = setMatcher(postFilter);\n      }\n      if (postFinder && !postFinder[expando]) {\n        postFinder = setMatcher(postFinder, postSelector);\n      }\n      return markFunction(function (seed, results, context, xml) {\n        var temp, i, elem, preMap = [], postMap = [], preexisting = results.length, elems = seed || multipleContexts(selector || '*', context.nodeType ? [context] : context, []), matcherIn = preFilter && (seed || !selector) ? condense(elems, preMap, preFilter, context, xml) : elems, matcherOut = matcher ? postFinder || (seed ? preFilter : preexisting || postFilter) ? [] : results : matcherIn;\n        if (matcher) {\n          matcher(matcherIn, matcherOut, context, xml);\n        }\n        if (postFilter) {\n          temp = condense(matcherOut, postMap);\n          postFilter(temp, [], context, xml);\n          i = temp.length;\n          while (i--) {\n            if (elem = temp[i]) {\n              matcherOut[postMap[i]] = !(matcherIn[postMap[i]] = elem);\n            }\n          }\n        }\n        if (seed) {\n          if (postFinder || preFilter) {\n            if (postFinder) {\n              temp = [];\n              i = matcherOut.length;\n              while (i--) {\n                if (elem = matcherOut[i]) {\n                  temp.push(matcherIn[i] = elem);\n                }\n              }\n              postFinder(null, matcherOut = [], temp, xml);\n            }\n            i = matcherOut.length;\n            while (i--) {\n              if ((elem = matcherOut[i]) && (temp = postFinder ? indexOf$2.call(seed, elem) : preMap[i]) > -1) {\n                seed[temp] = !(results[temp] = elem);\n              }\n            }\n          }\n        } else {\n          matcherOut = condense(matcherOut === results ? matcherOut.splice(preexisting, matcherOut.length) : matcherOut);\n          if (postFinder) {\n            postFinder(null, results, matcherOut, xml);\n          } else {\n            push.apply(results, matcherOut);\n          }\n        }\n      });\n    }\n    function matcherFromTokens(tokens) {\n      var checkContext, matcher, j, len = tokens.length, leadingRelative = Expr.relative[tokens[0].type], implicitRelative = leadingRelative || Expr.relative[' '], i = leadingRelative ? 1 : 0, matchContext = addCombinator(function (elem) {\n          return elem === checkContext;\n        }, implicitRelative, true), matchAnyContext = addCombinator(function (elem) {\n          return indexOf$2.call(checkContext, elem) > -1;\n        }, implicitRelative, true), matchers = [function (elem, context, xml) {\n            var ret = !leadingRelative && (xml || context !== outermostContext) || ((checkContext = context).nodeType ? matchContext(elem, context, xml) : matchAnyContext(elem, context, xml));\n            checkContext = null;\n            return ret;\n          }];\n      for (; i < len; i++) {\n        if (matcher = Expr.relative[tokens[i].type]) {\n          matchers = [addCombinator(elementMatcher(matchers), matcher)];\n        } else {\n          matcher = Expr.filter[tokens[i].type].apply(null, tokens[i].matches);\n          if (matcher[expando]) {\n            j = ++i;\n            for (; j < len; j++) {\n              if (Expr.relative[tokens[j].type]) {\n                break;\n              }\n            }\n            return setMatcher(i > 1 && elementMatcher(matchers), i > 1 && toSelector(tokens.slice(0, i - 1).concat({ value: tokens[i - 2].type === ' ' ? '*' : '' })).replace(rtrim, '$1'), matcher, i < j && matcherFromTokens(tokens.slice(i, j)), j < len && matcherFromTokens(tokens = tokens.slice(j)), j < len && toSelector(tokens));\n          }\n          matchers.push(matcher);\n        }\n      }\n      return elementMatcher(matchers);\n    }\n    function matcherFromGroupMatchers(elementMatchers, setMatchers) {\n      var bySet = setMatchers.length > 0, byElement = elementMatchers.length > 0, superMatcher = function (seed, context, xml, results, outermost) {\n          var elem, j, matcher, matchedCount = 0, i = '0', unmatched = seed && [], setMatched = [], contextBackup = outermostContext, elems = seed || byElement && Expr.find.TAG('*', outermost), dirrunsUnique = dirruns += contextBackup == null ? 1 : Math.random() || 0.1, len = elems.length;\n          if (outermost) {\n            outermostContext = context !== document$1 && context;\n          }\n          for (; i !== len && (elem = elems[i]) != null; i++) {\n            if (byElement && elem) {\n              j = 0;\n              while (matcher = elementMatchers[j++]) {\n                if (matcher(elem, context, xml)) {\n                  results.push(elem);\n                  break;\n                }\n              }\n              if (outermost) {\n                dirruns = dirrunsUnique;\n              }\n            }\n            if (bySet) {\n              if (elem = !matcher && elem) {\n                matchedCount--;\n              }\n              if (seed) {\n                unmatched.push(elem);\n              }\n            }\n          }\n          matchedCount += i;\n          if (bySet && i !== matchedCount) {\n            j = 0;\n            while (matcher = setMatchers[j++]) {\n              matcher(unmatched, setMatched, context, xml);\n            }\n            if (seed) {\n              if (matchedCount > 0) {\n                while (i--) {\n                  if (!(unmatched[i] || setMatched[i])) {\n                    setMatched[i] = pop.call(results);\n                  }\n                }\n              }\n              setMatched = condense(setMatched);\n            }\n            push.apply(results, setMatched);\n            if (outermost && !seed && setMatched.length > 0 && matchedCount + setMatchers.length > 1) {\n              Sizzle.uniqueSort(results);\n            }\n          }\n          if (outermost) {\n            dirruns = dirrunsUnique;\n            outermostContext = contextBackup;\n          }\n          return unmatched;\n        };\n      return bySet ? markFunction(superMatcher) : superMatcher;\n    }\n    compile = Sizzle.compile = function (selector, match) {\n      var i, setMatchers = [], elementMatchers = [], cached = compilerCache[selector + ' '];\n      if (!cached) {\n        if (!match) {\n          match = tokenize(selector);\n        }\n        i = match.length;\n        while (i--) {\n          cached = matcherFromTokens(match[i]);\n          if (cached[expando]) {\n            setMatchers.push(cached);\n          } else {\n            elementMatchers.push(cached);\n          }\n        }\n        cached = compilerCache(selector, matcherFromGroupMatchers(elementMatchers, setMatchers));\n        cached.selector = selector;\n      }\n      return cached;\n    };\n    select = Sizzle.select = function (selector, context, results, seed) {\n      var i, tokens, token, type, find, compiled = typeof selector === 'function' && selector, match = !seed && tokenize(selector = compiled.selector || selector);\n      results = results || [];\n      if (match.length === 1) {\n        tokens = match[0] = match[0].slice(0);\n        if (tokens.length > 2 && (token = tokens[0]).type === 'ID' && support.getById && context.nodeType === 9 && documentIsHTML && Expr.relative[tokens[1].type]) {\n          context = (Expr.find.ID(token.matches[0].replace(runescape, funescape), context) || [])[0];\n          if (!context) {\n            return results;\n          } else if (compiled) {\n            context = context.parentNode;\n          }\n          selector = selector.slice(tokens.shift().value.length);\n        }\n        i = matchExpr.needsContext.test(selector) ? 0 : tokens.length;\n        while (i--) {\n          token = tokens[i];\n          if (Expr.relative[type = token.type]) {\n            break;\n          }\n          if (find = Expr.find[type]) {\n            if (seed = find(token.matches[0].replace(runescape, funescape), rsibling.test(tokens[0].type) && testContext(context.parentNode) || context)) {\n              tokens.splice(i, 1);\n              selector = seed.length && toSelector(tokens);\n              if (!selector) {\n                push.apply(results, seed);\n                return results;\n              }\n              break;\n            }\n          }\n        }\n      }\n      (compiled || compile(selector, match))(seed, context, !documentIsHTML, results, rsibling.test(selector) && testContext(context.parentNode) || context);\n      return results;\n    };\n    support.sortStable = expando.split('').sort(sortOrder).join('') === expando;\n    support.detectDuplicates = !!hasDuplicate;\n    setDocument();\n    support.sortDetached = true;\n\n    var doc = document;\n    var push$1 = Array.prototype.push;\n    var slice$1 = Array.prototype.slice;\n    var rquickExpr$1 = /^(?:[^#<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/;\n    var Event = EventUtils.Event;\n    var skipUniques = Tools.makeMap('children,contents,next,prev');\n    var isDefined = function (obj) {\n      return typeof obj !== 'undefined';\n    };\n    var isString$1 = function (obj) {\n      return typeof obj === 'string';\n    };\n    var isWindow = function (obj) {\n      return obj && obj === obj.window;\n    };\n    var createFragment = function (html, fragDoc) {\n      fragDoc = fragDoc || doc;\n      var container = fragDoc.createElement('div');\n      var frag = fragDoc.createDocumentFragment();\n      container.innerHTML = html;\n      var node;\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n      return frag;\n    };\n    var domManipulate = function (targetNodes, sourceItem, callback, reverse) {\n      var i;\n      if (isString$1(sourceItem)) {\n        sourceItem = createFragment(sourceItem, getElementDocument(targetNodes[0]));\n      } else if (sourceItem.length && !sourceItem.nodeType) {\n        sourceItem = DomQuery.makeArray(sourceItem);\n        if (reverse) {\n          for (i = sourceItem.length - 1; i >= 0; i--) {\n            domManipulate(targetNodes, sourceItem[i], callback, reverse);\n          }\n        } else {\n          for (i = 0; i < sourceItem.length; i++) {\n            domManipulate(targetNodes, sourceItem[i], callback, reverse);\n          }\n        }\n        return targetNodes;\n      }\n      if (sourceItem.nodeType) {\n        i = targetNodes.length;\n        while (i--) {\n          callback.call(targetNodes[i], sourceItem);\n        }\n      }\n      return targetNodes;\n    };\n    var hasClass = function (node, className) {\n      return node && className && (' ' + node.className + ' ').indexOf(' ' + className + ' ') !== -1;\n    };\n    var wrap$1 = function (elements, wrapper, all) {\n      var lastParent, newWrapper;\n      wrapper = DomQuery(wrapper)[0];\n      elements.each(function () {\n        var self = this;\n        if (!all || lastParent !== self.parentNode) {\n          lastParent = self.parentNode;\n          newWrapper = wrapper.cloneNode(false);\n          self.parentNode.insertBefore(newWrapper, self);\n          newWrapper.appendChild(self);\n        } else {\n          newWrapper.appendChild(self);\n        }\n      });\n      return elements;\n    };\n    var numericCssMap = Tools.makeMap('fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom', ' ');\n    var booleanMap = Tools.makeMap('checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected', ' ');\n    var propFix = {\n      for: 'htmlFor',\n      class: 'className',\n      readonly: 'readOnly'\n    };\n    var cssFix = { float: 'cssFloat' };\n    var attrHooks = {}, cssHooks = {};\n    var DomQueryConstructor = function (selector, context) {\n      return new DomQuery.fn.init(selector, context);\n    };\n    var inArray$1 = function (item, array) {\n      var i;\n      if (array.indexOf) {\n        return array.indexOf(item);\n      }\n      i = array.length;\n      while (i--) {\n        if (array[i] === item) {\n          return i;\n        }\n      }\n      return -1;\n    };\n    var whiteSpaceRegExp$2 = /^\\s*|\\s*$/g;\n    var trim$3 = function (str) {\n      return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp$2, '');\n    };\n    var each$4 = function (obj, callback) {\n      var length, key, i, value;\n      if (obj) {\n        length = obj.length;\n        if (length === undefined) {\n          for (key in obj) {\n            if (obj.hasOwnProperty(key)) {\n              value = obj[key];\n              if (callback.call(value, key, value) === false) {\n                break;\n              }\n            }\n          }\n        } else {\n          for (i = 0; i < length; i++) {\n            value = obj[i];\n            if (callback.call(value, i, value) === false) {\n              break;\n            }\n          }\n        }\n      }\n      return obj;\n    };\n    var grep = function (array, callback) {\n      var out = [];\n      each$4(array, function (i, item) {\n        if (callback(item, i)) {\n          out.push(item);\n        }\n      });\n      return out;\n    };\n    var getElementDocument = function (element) {\n      if (!element) {\n        return doc;\n      }\n      if (element.nodeType === 9) {\n        return element;\n      }\n      return element.ownerDocument;\n    };\n    DomQueryConstructor.fn = DomQueryConstructor.prototype = {\n      constructor: DomQueryConstructor,\n      selector: '',\n      context: null,\n      length: 0,\n      init: function (selector, context) {\n        var self = this;\n        var match, node;\n        if (!selector) {\n          return self;\n        }\n        if (selector.nodeType) {\n          self.context = self[0] = selector;\n          self.length = 1;\n          return self;\n        }\n        if (context && context.nodeType) {\n          self.context = context;\n        } else {\n          if (context) {\n            return DomQuery(selector).attr(context);\n          }\n          self.context = context = document;\n        }\n        if (isString$1(selector)) {\n          self.selector = selector;\n          if (selector.charAt(0) === '<' && selector.charAt(selector.length - 1) === '>' && selector.length >= 3) {\n            match = [\n              null,\n              selector,\n              null\n            ];\n          } else {\n            match = rquickExpr$1.exec(selector);\n          }\n          if (match) {\n            if (match[1]) {\n              node = createFragment(selector, getElementDocument(context)).firstChild;\n              while (node) {\n                push$1.call(self, node);\n                node = node.nextSibling;\n              }\n            } else {\n              node = getElementDocument(context).getElementById(match[2]);\n              if (!node) {\n                return self;\n              }\n              if (node.id !== match[2]) {\n                return self.find(selector);\n              }\n              self.length = 1;\n              self[0] = node;\n            }\n          } else {\n            return DomQuery(context).find(selector);\n          }\n        } else {\n          this.add(selector, false);\n        }\n        return self;\n      },\n      toArray: function () {\n        return Tools.toArray(this);\n      },\n      add: function (items, sort) {\n        var self = this;\n        var nodes, i;\n        if (isString$1(items)) {\n          return self.add(DomQuery(items));\n        }\n        if (sort !== false) {\n          nodes = DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items)));\n          self.length = nodes.length;\n          for (i = 0; i < nodes.length; i++) {\n            self[i] = nodes[i];\n          }\n        } else {\n          push$1.apply(self, DomQuery.makeArray(items));\n        }\n        return self;\n      },\n      attr: function (name, value) {\n        var self = this;\n        var hook;\n        if (typeof name === 'object') {\n          each$4(name, function (name, value) {\n            self.attr(name, value);\n          });\n        } else if (isDefined(value)) {\n          this.each(function () {\n            var hook;\n            if (this.nodeType === 1) {\n              hook = attrHooks[name];\n              if (hook && hook.set) {\n                hook.set(this, value);\n                return;\n              }\n              if (value === null) {\n                this.removeAttribute(name, 2);\n              } else {\n                this.setAttribute(name, value, 2);\n              }\n            }\n          });\n        } else {\n          if (self[0] && self[0].nodeType === 1) {\n            hook = attrHooks[name];\n            if (hook && hook.get) {\n              return hook.get(self[0], name);\n            }\n            if (booleanMap[name]) {\n              return self.prop(name) ? name : undefined;\n            }\n            value = self[0].getAttribute(name, 2);\n            if (value === null) {\n              value = undefined;\n            }\n          }\n          return value;\n        }\n        return self;\n      },\n      removeAttr: function (name) {\n        return this.attr(name, null);\n      },\n      prop: function (name, value) {\n        var self = this;\n        name = propFix[name] || name;\n        if (typeof name === 'object') {\n          each$4(name, function (name, value) {\n            self.prop(name, value);\n          });\n        } else if (isDefined(value)) {\n          this.each(function () {\n            if (this.nodeType === 1) {\n              this[name] = value;\n            }\n          });\n        } else {\n          if (self[0] && self[0].nodeType && name in self[0]) {\n            return self[0][name];\n          }\n          return value;\n        }\n        return self;\n      },\n      css: function (name, value) {\n        var self = this;\n        var elm, hook;\n        var camel = function (name) {\n          return name.replace(/-(\\D)/g, function (a, b) {\n            return b.toUpperCase();\n          });\n        };\n        var dashed = function (name) {\n          return name.replace(/[A-Z]/g, function (a) {\n            return '-' + a;\n          });\n        };\n        if (typeof name === 'object') {\n          each$4(name, function (name, value) {\n            self.css(name, value);\n          });\n        } else {\n          if (isDefined(value)) {\n            name = camel(name);\n            if (typeof value === 'number' && !numericCssMap[name]) {\n              value = value.toString() + 'px';\n            }\n            self.each(function () {\n              var style = this.style;\n              hook = cssHooks[name];\n              if (hook && hook.set) {\n                hook.set(this, value);\n                return;\n              }\n              try {\n                this.style[cssFix[name] || name] = value;\n              } catch (ex) {\n              }\n              if (value === null || value === '') {\n                if (style.removeProperty) {\n                  style.removeProperty(dashed(name));\n                } else {\n                  style.removeAttribute(name);\n                }\n              }\n            });\n          } else {\n            elm = self[0];\n            hook = cssHooks[name];\n            if (hook && hook.get) {\n              return hook.get(elm);\n            }\n            if (elm.ownerDocument.defaultView) {\n              try {\n                return elm.ownerDocument.defaultView.getComputedStyle(elm, null).getPropertyValue(dashed(name));\n              } catch (ex) {\n                return undefined;\n              }\n            } else if (elm.currentStyle) {\n              return elm.currentStyle[camel(name)];\n            } else {\n              return '';\n            }\n          }\n        }\n        return self;\n      },\n      remove: function () {\n        var self = this;\n        var node, i = this.length;\n        while (i--) {\n          node = self[i];\n          Event.clean(node);\n          if (node.parentNode) {\n            node.parentNode.removeChild(node);\n          }\n        }\n        return this;\n      },\n      empty: function () {\n        var self = this;\n        var node, i = this.length;\n        while (i--) {\n          node = self[i];\n          while (node.firstChild) {\n            node.removeChild(node.firstChild);\n          }\n        }\n        return this;\n      },\n      html: function (value) {\n        var self = this;\n        var i;\n        if (isDefined(value)) {\n          i = self.length;\n          try {\n            while (i--) {\n              self[i].innerHTML = value;\n            }\n          } catch (ex) {\n            DomQuery(self[i]).empty().append(value);\n          }\n          return self;\n        }\n        return self[0] ? self[0].innerHTML : '';\n      },\n      text: function (value) {\n        var self = this;\n        var i;\n        if (isDefined(value)) {\n          i = self.length;\n          while (i--) {\n            if ('innerText' in self[i]) {\n              self[i].innerText = value;\n            } else {\n              self[0].textContent = value;\n            }\n          }\n          return self;\n        }\n        return self[0] ? self[0].innerText || self[0].textContent : '';\n      },\n      append: function () {\n        return domManipulate(this, arguments, function (node) {\n          if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n            this.appendChild(node);\n          }\n        });\n      },\n      prepend: function () {\n        return domManipulate(this, arguments, function (node) {\n          if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n            this.insertBefore(node, this.firstChild);\n          }\n        }, true);\n      },\n      before: function () {\n        var self = this;\n        if (self[0] && self[0].parentNode) {\n          return domManipulate(self, arguments, function (node) {\n            this.parentNode.insertBefore(node, this);\n          });\n        }\n        return self;\n      },\n      after: function () {\n        var self = this;\n        if (self[0] && self[0].parentNode) {\n          return domManipulate(self, arguments, function (node) {\n            this.parentNode.insertBefore(node, this.nextSibling);\n          }, true);\n        }\n        return self;\n      },\n      appendTo: function (val) {\n        DomQuery(val).append(this);\n        return this;\n      },\n      prependTo: function (val) {\n        DomQuery(val).prepend(this);\n        return this;\n      },\n      replaceWith: function (content) {\n        return this.before(content).remove();\n      },\n      wrap: function (content) {\n        return wrap$1(this, content);\n      },\n      wrapAll: function (content) {\n        return wrap$1(this, content, true);\n      },\n      wrapInner: function (content) {\n        this.each(function () {\n          DomQuery(this).contents().wrapAll(content);\n        });\n        return this;\n      },\n      unwrap: function () {\n        return this.parent().each(function () {\n          DomQuery(this).replaceWith(this.childNodes);\n        });\n      },\n      clone: function () {\n        var result = [];\n        this.each(function () {\n          result.push(this.cloneNode(true));\n        });\n        return DomQuery(result);\n      },\n      addClass: function (className) {\n        return this.toggleClass(className, true);\n      },\n      removeClass: function (className) {\n        return this.toggleClass(className, false);\n      },\n      toggleClass: function (className, state) {\n        var self = this;\n        if (typeof className !== 'string') {\n          return self;\n        }\n        if (className.indexOf(' ') !== -1) {\n          each$4(className.split(' '), function () {\n            self.toggleClass(this, state);\n          });\n        } else {\n          self.each(function (index, node) {\n            var classState = hasClass(node, className);\n            if (classState !== state) {\n              var existingClassName = node.className;\n              if (classState) {\n                node.className = trim$3((' ' + existingClassName + ' ').replace(' ' + className + ' ', ' '));\n              } else {\n                node.className += existingClassName ? ' ' + className : className;\n              }\n            }\n          });\n        }\n        return self;\n      },\n      hasClass: function (className) {\n        return hasClass(this[0], className);\n      },\n      each: function (callback) {\n        return each$4(this, callback);\n      },\n      on: function (name, callback) {\n        return this.each(function () {\n          Event.bind(this, name, callback);\n        });\n      },\n      off: function (name, callback) {\n        return this.each(function () {\n          Event.unbind(this, name, callback);\n        });\n      },\n      trigger: function (name) {\n        return this.each(function () {\n          if (typeof name === 'object') {\n            Event.fire(this, name.type, name);\n          } else {\n            Event.fire(this, name);\n          }\n        });\n      },\n      show: function () {\n        return this.css('display', '');\n      },\n      hide: function () {\n        return this.css('display', 'none');\n      },\n      slice: function () {\n        return DomQuery(slice$1.apply(this, arguments));\n      },\n      eq: function (index) {\n        return index === -1 ? this.slice(index) : this.slice(index, +index + 1);\n      },\n      first: function () {\n        return this.eq(0);\n      },\n      last: function () {\n        return this.eq(-1);\n      },\n      find: function (selector) {\n        var i, l;\n        var ret = [];\n        for (i = 0, l = this.length; i < l; i++) {\n          DomQuery.find(selector, this[i], ret);\n        }\n        return DomQuery(ret);\n      },\n      filter: function (selector) {\n        if (typeof selector === 'function') {\n          return DomQuery(grep(this.toArray(), function (item, i) {\n            return selector(i, item);\n          }));\n        }\n        return DomQuery(DomQuery.filter(selector, this.toArray()));\n      },\n      closest: function (selector) {\n        var result = [];\n        if (selector instanceof DomQuery) {\n          selector = selector[0];\n        }\n        this.each(function (i, node) {\n          while (node) {\n            if (typeof selector === 'string' && DomQuery(node).is(selector)) {\n              result.push(node);\n              break;\n            } else if (node === selector) {\n              result.push(node);\n              break;\n            }\n            node = node.parentNode;\n          }\n        });\n        return DomQuery(result);\n      },\n      offset: function (offset) {\n        var elm, doc, docElm;\n        var x = 0, y = 0, pos;\n        if (!offset) {\n          elm = this[0];\n          if (elm) {\n            doc = elm.ownerDocument;\n            docElm = doc.documentElement;\n            if (elm.getBoundingClientRect) {\n              pos = elm.getBoundingClientRect();\n              x = pos.left + (docElm.scrollLeft || doc.body.scrollLeft) - docElm.clientLeft;\n              y = pos.top + (docElm.scrollTop || doc.body.scrollTop) - docElm.clientTop;\n            }\n          }\n          return {\n            left: x,\n            top: y\n          };\n        }\n        return this.css(offset);\n      },\n      push: push$1,\n      sort: Array.prototype.sort,\n      splice: Array.prototype.splice\n    };\n    Tools.extend(DomQueryConstructor, {\n      extend: Tools.extend,\n      makeArray: function (object) {\n        if (isWindow(object) || object.nodeType) {\n          return [object];\n        }\n        return Tools.toArray(object);\n      },\n      inArray: inArray$1,\n      isArray: Tools.isArray,\n      each: each$4,\n      trim: trim$3,\n      grep: grep,\n      find: Sizzle,\n      expr: Sizzle.selectors,\n      unique: Sizzle.uniqueSort,\n      text: Sizzle.getText,\n      contains: Sizzle.contains,\n      filter: function (expr, elems, not) {\n        var i = elems.length;\n        if (not) {\n          expr = ':not(' + expr + ')';\n        }\n        while (i--) {\n          if (elems[i].nodeType !== 1) {\n            elems.splice(i, 1);\n          }\n        }\n        if (elems.length === 1) {\n          elems = DomQuery.find.matchesSelector(elems[0], expr) ? [elems[0]] : [];\n        } else {\n          elems = DomQuery.find.matches(expr, elems);\n        }\n        return elems;\n      }\n    });\n    var dir = function (el, prop, until) {\n      var matched = [];\n      var cur = el[prop];\n      if (typeof until !== 'string' && until instanceof DomQuery) {\n        until = until[0];\n      }\n      while (cur && cur.nodeType !== 9) {\n        if (until !== undefined) {\n          if (cur === until) {\n            break;\n          }\n          if (typeof until === 'string' && DomQuery(cur).is(until)) {\n            break;\n          }\n        }\n        if (cur.nodeType === 1) {\n          matched.push(cur);\n        }\n        cur = cur[prop];\n      }\n      return matched;\n    };\n    var sibling$1 = function (node, siblingName, nodeType, until) {\n      var result = [];\n      if (until instanceof DomQuery) {\n        until = until[0];\n      }\n      for (; node; node = node[siblingName]) {\n        if (nodeType && node.nodeType !== nodeType) {\n          continue;\n        }\n        if (until !== undefined) {\n          if (node === until) {\n            break;\n          }\n          if (typeof until === 'string' && DomQuery(node).is(until)) {\n            break;\n          }\n        }\n        result.push(node);\n      }\n      return result;\n    };\n    var firstSibling = function (node, siblingName, nodeType) {\n      for (node = node[siblingName]; node; node = node[siblingName]) {\n        if (node.nodeType === nodeType) {\n          return node;\n        }\n      }\n      return null;\n    };\n    each$4({\n      parent: function (node) {\n        var parent = node.parentNode;\n        return parent && parent.nodeType !== 11 ? parent : null;\n      },\n      parents: function (node) {\n        return dir(node, 'parentNode');\n      },\n      next: function (node) {\n        return firstSibling(node, 'nextSibling', 1);\n      },\n      prev: function (node) {\n        return firstSibling(node, 'previousSibling', 1);\n      },\n      children: function (node) {\n        return sibling$1(node.firstChild, 'nextSibling', 1);\n      },\n      contents: function (node) {\n        return Tools.toArray((node.nodeName === 'iframe' ? node.contentDocument || node.contentWindow.document : node).childNodes);\n      }\n    }, function (name, fn) {\n      DomQueryConstructor.fn[name] = function (selector) {\n        var self = this;\n        var result = [];\n        self.each(function () {\n          var nodes = fn.call(result, this, selector, result);\n          if (nodes) {\n            if (DomQuery.isArray(nodes)) {\n              result.push.apply(result, nodes);\n            } else {\n              result.push(nodes);\n            }\n          }\n        });\n        if (this.length > 1) {\n          if (!skipUniques[name]) {\n            result = DomQuery.unique(result);\n          }\n          if (name.indexOf('parents') === 0) {\n            result = result.reverse();\n          }\n        }\n        var wrappedResult = DomQuery(result);\n        if (selector) {\n          return wrappedResult.filter(selector);\n        }\n        return wrappedResult;\n      };\n    });\n    each$4({\n      parentsUntil: function (node, until) {\n        return dir(node, 'parentNode', until);\n      },\n      nextUntil: function (node, until) {\n        return sibling$1(node, 'nextSibling', 1, until).slice(1);\n      },\n      prevUntil: function (node, until) {\n        return sibling$1(node, 'previousSibling', 1, until).slice(1);\n      }\n    }, function (name, fn) {\n      DomQueryConstructor.fn[name] = function (selector, filter) {\n        var self = this;\n        var result = [];\n        self.each(function () {\n          var nodes = fn.call(result, this, selector, result);\n          if (nodes) {\n            if (DomQuery.isArray(nodes)) {\n              result.push.apply(result, nodes);\n            } else {\n              result.push(nodes);\n            }\n          }\n        });\n        if (this.length > 1) {\n          result = DomQuery.unique(result);\n          if (name.indexOf('parents') === 0 || name === 'prevUntil') {\n            result = result.reverse();\n          }\n        }\n        var wrappedResult = DomQuery(result);\n        if (filter) {\n          return wrappedResult.filter(filter);\n        }\n        return wrappedResult;\n      };\n    });\n    DomQueryConstructor.fn.is = function (selector) {\n      return !!selector && this.filter(selector).length > 0;\n    };\n    DomQueryConstructor.fn.init.prototype = DomQueryConstructor.fn;\n    DomQueryConstructor.overrideDefaults = function (callback) {\n      var defaults;\n      var sub = function (selector, context) {\n        defaults = defaults || callback();\n        if (arguments.length === 0) {\n          selector = defaults.element;\n        }\n        if (!context) {\n          context = defaults.context;\n        }\n        return new sub.fn.init(selector, context);\n      };\n      DomQuery.extend(sub, this);\n      return sub;\n    };\n    DomQueryConstructor.attrHooks = attrHooks;\n    DomQueryConstructor.cssHooks = cssHooks;\n    var DomQuery = DomQueryConstructor;\n\n    var each$5 = Tools.each;\n    var grep$1 = Tools.grep;\n    var isIE = Env.ie;\n    var simpleSelectorRe = /^([a-z0-9],?)+$/i;\n    var setupAttrHooks = function (styles, settings, getContext) {\n      var keepValues = settings.keep_values;\n      var keepUrlHook = {\n        set: function ($elm, value, name) {\n          if (settings.url_converter) {\n            value = settings.url_converter.call(settings.url_converter_scope || getContext(), value, name, $elm[0]);\n          }\n          $elm.attr('data-mce-' + name, value).attr(name, value);\n        },\n        get: function ($elm, name) {\n          return $elm.attr('data-mce-' + name) || $elm.attr(name);\n        }\n      };\n      var attrHooks = {\n        style: {\n          set: function ($elm, value) {\n            if (value !== null && typeof value === 'object') {\n              $elm.css(value);\n              return;\n            }\n            if (keepValues) {\n              $elm.attr('data-mce-style', value);\n            }\n            if (value !== null && typeof value === 'string') {\n              $elm.removeAttr('style');\n              $elm.css(styles.parse(value));\n            } else {\n              $elm.attr('style', value);\n            }\n          },\n          get: function ($elm) {\n            var value = $elm.attr('data-mce-style') || $elm.attr('style');\n            value = styles.serialize(styles.parse(value), $elm[0].nodeName);\n            return value;\n          }\n        }\n      };\n      if (keepValues) {\n        attrHooks.href = attrHooks.src = keepUrlHook;\n      }\n      return attrHooks;\n    };\n    var updateInternalStyleAttr = function (styles, $elm) {\n      var rawValue = $elm.attr('style');\n      var value = styles.serialize(styles.parse(rawValue), $elm[0].nodeName);\n      if (!value) {\n        value = null;\n      }\n      $elm.attr('data-mce-style', value);\n    };\n    var findNodeIndex = function (node, normalized) {\n      var idx = 0, lastNodeType, nodeType;\n      if (node) {\n        for (lastNodeType = node.nodeType, node = node.previousSibling; node; node = node.previousSibling) {\n          nodeType = node.nodeType;\n          if (normalized && nodeType === 3) {\n            if (nodeType === lastNodeType || !node.nodeValue.length) {\n              continue;\n            }\n          }\n          idx++;\n          lastNodeType = nodeType;\n        }\n      }\n      return idx;\n    };\n    var DOMUtils = function (doc, settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n      var addedStyles = {};\n      var win = window;\n      var files = {};\n      var counter = 0;\n      var stdMode = true;\n      var boxModel = true;\n      var styleSheetLoader = instance.forElement(SugarElement.fromDom(doc), {\n        contentCssCors: settings.contentCssCors,\n        referrerPolicy: settings.referrerPolicy\n      });\n      var boundEvents = [];\n      var schema = settings.schema ? settings.schema : Schema({});\n      var styles = Styles({\n        url_converter: settings.url_converter,\n        url_converter_scope: settings.url_converter_scope\n      }, settings.schema);\n      var events = settings.ownEvents ? new EventUtils() : EventUtils.Event;\n      var blockElementsMap = schema.getBlockElements();\n      var $ = DomQuery.overrideDefaults(function () {\n        return {\n          context: doc,\n          element: self.getRoot()\n        };\n      });\n      var isBlock = function (node) {\n        if (typeof node === 'string') {\n          return !!blockElementsMap[node];\n        } else if (node) {\n          var type = node.nodeType;\n          if (type) {\n            return !!(type === 1 && blockElementsMap[node.nodeName]);\n          }\n        }\n        return false;\n      };\n      var get = function (elm) {\n        return elm && doc && isString(elm) ? doc.getElementById(elm) : elm;\n      };\n      var $$ = function (elm) {\n        return $(typeof elm === 'string' ? get(elm) : elm);\n      };\n      var getAttrib = function (elm, name, defaultVal) {\n        var hook, value;\n        var $elm = $$(elm);\n        if ($elm.length) {\n          hook = attrHooks[name];\n          if (hook && hook.get) {\n            value = hook.get($elm, name);\n          } else {\n            value = $elm.attr(name);\n          }\n        }\n        if (typeof value === 'undefined') {\n          value = defaultVal || '';\n        }\n        return value;\n      };\n      var getAttribs = function (elm) {\n        var node = get(elm);\n        if (!node) {\n          return [];\n        }\n        return node.attributes;\n      };\n      var setAttrib = function (elm, name, value) {\n        if (value === '') {\n          value = null;\n        }\n        var $elm = $$(elm);\n        var originalValue = $elm.attr(name);\n        if (!$elm.length) {\n          return;\n        }\n        var hook = attrHooks[name];\n        if (hook && hook.set) {\n          hook.set($elm, value, name);\n        } else {\n          $elm.attr(name, value);\n        }\n        if (originalValue !== value && settings.onSetAttrib) {\n          settings.onSetAttrib({\n            attrElm: $elm,\n            attrName: name,\n            attrValue: value\n          });\n        }\n      };\n      var clone = function (node, deep) {\n        if (!isIE || node.nodeType !== 1 || deep) {\n          return node.cloneNode(deep);\n        } else {\n          var clone_1 = doc.createElement(node.nodeName);\n          each$5(getAttribs(node), function (attr) {\n            setAttrib(clone_1, attr.nodeName, getAttrib(node, attr.nodeName));\n          });\n          return clone_1;\n        }\n      };\n      var getRoot = function () {\n        return settings.root_element || doc.body;\n      };\n      var getViewPort = function (argWin) {\n        var vp = getBounds(argWin);\n        return {\n          x: vp.x,\n          y: vp.y,\n          w: vp.width,\n          h: vp.height\n        };\n      };\n      var getPos$1 = function (elm, rootElm) {\n        return getPos(doc.body, get(elm), rootElm);\n      };\n      var setStyle = function (elm, name, value) {\n        var $elm = isString(name) ? $$(elm).css(name, value) : $$(elm).css(name);\n        if (settings.update_styles) {\n          updateInternalStyleAttr(styles, $elm);\n        }\n      };\n      var setStyles = function (elm, stylesArg) {\n        var $elm = $$(elm).css(stylesArg);\n        if (settings.update_styles) {\n          updateInternalStyleAttr(styles, $elm);\n        }\n      };\n      var getStyle = function (elm, name, computed) {\n        var $elm = $$(elm);\n        if (computed) {\n          return $elm.css(name);\n        }\n        name = name.replace(/-(\\D)/g, function (a, b) {\n          return b.toUpperCase();\n        });\n        if (name === 'float') {\n          name = Env.browser.isIE() ? 'styleFloat' : 'cssFloat';\n        }\n        return $elm[0] && $elm[0].style ? $elm[0].style[name] : undefined;\n      };\n      var getSize = function (elm) {\n        var w, h;\n        elm = get(elm);\n        w = getStyle(elm, 'width');\n        h = getStyle(elm, 'height');\n        if (w.indexOf('px') === -1) {\n          w = 0;\n        }\n        if (h.indexOf('px') === -1) {\n          h = 0;\n        }\n        return {\n          w: parseInt(w, 10) || elm.offsetWidth || elm.clientWidth,\n          h: parseInt(h, 10) || elm.offsetHeight || elm.clientHeight\n        };\n      };\n      var getRect = function (elm) {\n        elm = get(elm);\n        var pos = getPos$1(elm);\n        var size = getSize(elm);\n        return {\n          x: pos.x,\n          y: pos.y,\n          w: size.w,\n          h: size.h\n        };\n      };\n      var is = function (elm, selector) {\n        var i;\n        if (!elm) {\n          return false;\n        }\n        if (!Array.isArray(elm)) {\n          if (selector === '*') {\n            return elm.nodeType === 1;\n          }\n          if (simpleSelectorRe.test(selector)) {\n            var selectors = selector.toLowerCase().split(/,/);\n            var elmName = elm.nodeName.toLowerCase();\n            for (i = selectors.length - 1; i >= 0; i--) {\n              if (selectors[i] === elmName) {\n                return true;\n              }\n            }\n            return false;\n          }\n          if (elm.nodeType && elm.nodeType !== 1) {\n            return false;\n          }\n        }\n        var elms = !Array.isArray(elm) ? [elm] : elm;\n        return Sizzle(selector, elms[0].ownerDocument || elms[0], null, elms).length > 0;\n      };\n      var getParents = function (elm, selector, root, collect) {\n        var result = [];\n        var selectorVal;\n        var node = get(elm);\n        collect = collect === undefined;\n        root = root || (getRoot().nodeName !== 'BODY' ? getRoot().parentNode : null);\n        if (Tools.is(selector, 'string')) {\n          selectorVal = selector;\n          if (selector === '*') {\n            selector = function (node) {\n              return node.nodeType === 1;\n            };\n          } else {\n            selector = function (node) {\n              return is(node, selectorVal);\n            };\n          }\n        }\n        while (node) {\n          if (node === root || isNullable(node.nodeType) || isDocument$1(node) || isDocumentFragment$1(node)) {\n            break;\n          }\n          if (!selector || typeof selector === 'function' && selector(node)) {\n            if (collect) {\n              result.push(node);\n            } else {\n              return [node];\n            }\n          }\n          node = node.parentNode;\n        }\n        return collect ? result : null;\n      };\n      var getParent = function (node, selector, root) {\n        var parents = getParents(node, selector, root, false);\n        return parents && parents.length > 0 ? parents[0] : null;\n      };\n      var _findSib = function (node, selector, name) {\n        var func = selector;\n        if (node) {\n          if (typeof selector === 'string') {\n            func = function (node) {\n              return is(node, selector);\n            };\n          }\n          for (node = node[name]; node; node = node[name]) {\n            if (typeof func === 'function' && func(node)) {\n              return node;\n            }\n          }\n        }\n        return null;\n      };\n      var getNext = function (node, selector) {\n        return _findSib(node, selector, 'nextSibling');\n      };\n      var getPrev = function (node, selector) {\n        return _findSib(node, selector, 'previousSibling');\n      };\n      var select = function (selector, scope) {\n        return Sizzle(selector, get(scope) || settings.root_element || doc, []);\n      };\n      var run = function (elm, func, scope) {\n        var result;\n        var node = typeof elm === 'string' ? get(elm) : elm;\n        if (!node) {\n          return false;\n        }\n        if (Tools.isArray(node) && (node.length || node.length === 0)) {\n          result = [];\n          each$5(node, function (elm, i) {\n            if (elm) {\n              result.push(func.call(scope, typeof elm === 'string' ? get(elm) : elm, i));\n            }\n          });\n          return result;\n        }\n        var context = scope ? scope : this;\n        return func.call(context, node);\n      };\n      var setAttribs = function (elm, attrs) {\n        $$(elm).each(function (i, node) {\n          each$5(attrs, function (value, name) {\n            setAttrib(node, name, value);\n          });\n        });\n      };\n      var setHTML = function (elm, html) {\n        var $elm = $$(elm);\n        if (isIE) {\n          $elm.each(function (i, target) {\n            if (target.canHaveHTML === false) {\n              return;\n            }\n            while (target.firstChild) {\n              target.removeChild(target.firstChild);\n            }\n            try {\n              target.innerHTML = '<br>' + html;\n              target.removeChild(target.firstChild);\n            } catch (ex) {\n              DomQuery('<div></div>').html('<br>' + html).contents().slice(1).appendTo(target);\n            }\n            return html;\n          });\n        } else {\n          $elm.html(html);\n        }\n      };\n      var add = function (parentElm, name, attrs, html, create) {\n        return run(parentElm, function (parentElm) {\n          var newElm = typeof name === 'string' ? doc.createElement(name) : name;\n          setAttribs(newElm, attrs);\n          if (html) {\n            if (typeof html !== 'string' && html.nodeType) {\n              newElm.appendChild(html);\n            } else if (typeof html === 'string') {\n              setHTML(newElm, html);\n            }\n          }\n          return !create ? parentElm.appendChild(newElm) : newElm;\n        });\n      };\n      var create = function (name, attrs, html) {\n        return add(doc.createElement(name), name, attrs, html, true);\n      };\n      var decode = Entities.decode;\n      var encode = Entities.encodeAllRaw;\n      var createHTML = function (name, attrs, html) {\n        var outHtml = '', key;\n        outHtml += '<' + name;\n        for (key in attrs) {\n          if (attrs.hasOwnProperty(key) && attrs[key] !== null && typeof attrs[key] !== 'undefined') {\n            outHtml += ' ' + key + '=\"' + encode(attrs[key]) + '\"';\n          }\n        }\n        if (typeof html !== 'undefined') {\n          return outHtml + '>' + html + '</' + name + '>';\n        }\n        return outHtml + ' />';\n      };\n      var createFragment = function (html) {\n        var node;\n        var container = doc.createElement('div');\n        var frag = doc.createDocumentFragment();\n        frag.appendChild(container);\n        if (html) {\n          container.innerHTML = html;\n        }\n        while (node = container.firstChild) {\n          frag.appendChild(node);\n        }\n        frag.removeChild(container);\n        return frag;\n      };\n      var remove = function (node, keepChildren) {\n        var $node = $$(node);\n        if (keepChildren) {\n          $node.each(function () {\n            var child;\n            while (child = this.firstChild) {\n              if (child.nodeType === 3 && child.data.length === 0) {\n                this.removeChild(child);\n              } else {\n                this.parentNode.insertBefore(child, this);\n              }\n            }\n          }).remove();\n        } else {\n          $node.remove();\n        }\n        return $node.length > 1 ? $node.toArray() : $node[0];\n      };\n      var removeAllAttribs = function (e) {\n        return run(e, function (e) {\n          var i;\n          var attrs = e.attributes;\n          for (i = attrs.length - 1; i >= 0; i--) {\n            e.removeAttributeNode(attrs.item(i));\n          }\n        });\n      };\n      var parseStyle = function (cssText) {\n        return styles.parse(cssText);\n      };\n      var serializeStyle = function (stylesArg, name) {\n        return styles.serialize(stylesArg, name);\n      };\n      var addStyle = function (cssText) {\n        var head, styleElm;\n        if (self !== DOMUtils.DOM && doc === document) {\n          if (addedStyles[cssText]) {\n            return;\n          }\n          addedStyles[cssText] = true;\n        }\n        styleElm = doc.getElementById('mceDefaultStyles');\n        if (!styleElm) {\n          styleElm = doc.createElement('style');\n          styleElm.id = 'mceDefaultStyles';\n          styleElm.type = 'text/css';\n          head = doc.getElementsByTagName('head')[0];\n          if (head.firstChild) {\n            head.insertBefore(styleElm, head.firstChild);\n          } else {\n            head.appendChild(styleElm);\n          }\n        }\n        if (styleElm.styleSheet) {\n          styleElm.styleSheet.cssText += cssText;\n        } else {\n          styleElm.appendChild(doc.createTextNode(cssText));\n        }\n      };\n      var loadCSS = function (urls) {\n        if (!urls) {\n          urls = '';\n        }\n        each(urls.split(','), function (url) {\n          files[url] = true;\n          styleSheetLoader.load(url, noop);\n        });\n      };\n      var toggleClass = function (elm, cls, state) {\n        $$(elm).toggleClass(cls, state).each(function () {\n          if (this.className === '') {\n            DomQuery(this).attr('class', null);\n          }\n        });\n      };\n      var addClass = function (elm, cls) {\n        $$(elm).addClass(cls);\n      };\n      var removeClass = function (elm, cls) {\n        toggleClass(elm, cls, false);\n      };\n      var hasClass = function (elm, cls) {\n        return $$(elm).hasClass(cls);\n      };\n      var show = function (elm) {\n        $$(elm).show();\n      };\n      var hide = function (elm) {\n        $$(elm).hide();\n      };\n      var isHidden = function (elm) {\n        return $$(elm).css('display') === 'none';\n      };\n      var uniqueId = function (prefix) {\n        return (!prefix ? 'mce_' : prefix) + counter++;\n      };\n      var getOuterHTML = function (elm) {\n        var node = typeof elm === 'string' ? get(elm) : elm;\n        return isElement$1(node) ? node.outerHTML : DomQuery('<div></div>').append(DomQuery(node).clone()).html();\n      };\n      var setOuterHTML = function (elm, html) {\n        $$(elm).each(function () {\n          try {\n            if ('outerHTML' in this) {\n              this.outerHTML = html;\n              return;\n            }\n          } catch (ex) {\n          }\n          remove(DomQuery(this).html(html), true);\n        });\n      };\n      var insertAfter = function (node, reference) {\n        var referenceNode = get(reference);\n        return run(node, function (node) {\n          var parent = referenceNode.parentNode;\n          var nextSibling = referenceNode.nextSibling;\n          if (nextSibling) {\n            parent.insertBefore(node, nextSibling);\n          } else {\n            parent.appendChild(node);\n          }\n          return node;\n        });\n      };\n      var replace = function (newElm, oldElm, keepChildren) {\n        return run(oldElm, function (oldElm) {\n          if (Tools.is(oldElm, 'array')) {\n            newElm = newElm.cloneNode(true);\n          }\n          if (keepChildren) {\n            each$5(grep$1(oldElm.childNodes), function (node) {\n              newElm.appendChild(node);\n            });\n          }\n          return oldElm.parentNode.replaceChild(newElm, oldElm);\n        });\n      };\n      var rename = function (elm, name) {\n        var newElm;\n        if (elm.nodeName !== name.toUpperCase()) {\n          newElm = create(name);\n          each$5(getAttribs(elm), function (attrNode) {\n            setAttrib(newElm, attrNode.nodeName, getAttrib(elm, attrNode.nodeName));\n          });\n          replace(newElm, elm, true);\n        }\n        return newElm || elm;\n      };\n      var findCommonAncestor = function (a, b) {\n        var ps = a, pe;\n        while (ps) {\n          pe = b;\n          while (pe && ps !== pe) {\n            pe = pe.parentNode;\n          }\n          if (ps === pe) {\n            break;\n          }\n          ps = ps.parentNode;\n        }\n        if (!ps && a.ownerDocument) {\n          return a.ownerDocument.documentElement;\n        }\n        return ps;\n      };\n      var toHex = function (rgbVal) {\n        return styles.toHex(Tools.trim(rgbVal));\n      };\n      var isNonEmptyElement = function (node) {\n        if (isElement$1(node)) {\n          var isNamedAnchor = node.nodeName.toLowerCase() === 'a' && !getAttrib(node, 'href') && getAttrib(node, 'id');\n          if (getAttrib(node, 'name') || getAttrib(node, 'data-mce-bookmark') || isNamedAnchor) {\n            return true;\n          }\n        }\n        return false;\n      };\n      var isEmpty = function (node, elements) {\n        var type, name, brCount = 0;\n        if (isNonEmptyElement(node)) {\n          return false;\n        }\n        node = node.firstChild;\n        if (node) {\n          var walker = new DomTreeWalker(node, node.parentNode);\n          var whitespace = schema ? schema.getWhiteSpaceElements() : {};\n          elements = elements || (schema ? schema.getNonEmptyElements() : null);\n          do {\n            type = node.nodeType;\n            if (isElement$1(node)) {\n              var bogusVal = node.getAttribute('data-mce-bogus');\n              if (bogusVal) {\n                node = walker.next(bogusVal === 'all');\n                continue;\n              }\n              name = node.nodeName.toLowerCase();\n              if (elements && elements[name]) {\n                if (name === 'br') {\n                  brCount++;\n                  node = walker.next();\n                  continue;\n                }\n                return false;\n              }\n              if (isNonEmptyElement(node)) {\n                return false;\n              }\n            }\n            if (type === 8) {\n              return false;\n            }\n            if (type === 3 && !isWhitespaceText(node.nodeValue)) {\n              return false;\n            }\n            if (type === 3 && node.parentNode && whitespace[node.parentNode.nodeName] && isWhitespaceText(node.nodeValue)) {\n              return false;\n            }\n            node = walker.next();\n          } while (node);\n        }\n        return brCount <= 1;\n      };\n      var createRng = function () {\n        return doc.createRange();\n      };\n      var split = function (parentElm, splitElm, replacementElm) {\n        var range = createRng();\n        var beforeFragment;\n        var afterFragment;\n        var parentNode;\n        if (parentElm && splitElm) {\n          range.setStart(parentElm.parentNode, findNodeIndex(parentElm));\n          range.setEnd(splitElm.parentNode, findNodeIndex(splitElm));\n          beforeFragment = range.extractContents();\n          range = createRng();\n          range.setStart(splitElm.parentNode, findNodeIndex(splitElm) + 1);\n          range.setEnd(parentElm.parentNode, findNodeIndex(parentElm) + 1);\n          afterFragment = range.extractContents();\n          parentNode = parentElm.parentNode;\n          parentNode.insertBefore(trimNode(self, beforeFragment), parentElm);\n          if (replacementElm) {\n            parentNode.insertBefore(replacementElm, parentElm);\n          } else {\n            parentNode.insertBefore(splitElm, parentElm);\n          }\n          parentNode.insertBefore(trimNode(self, afterFragment), parentElm);\n          remove(parentElm);\n          return replacementElm || splitElm;\n        }\n      };\n      var bind = function (target, name, func, scope) {\n        if (Tools.isArray(target)) {\n          var i = target.length;\n          var rv = [];\n          while (i--) {\n            rv[i] = bind(target[i], name, func, scope);\n          }\n          return rv;\n        }\n        if (settings.collect && (target === doc || target === win)) {\n          boundEvents.push([\n            target,\n            name,\n            func,\n            scope\n          ]);\n        }\n        var output = events.bind(target, name, func, scope || self);\n        return output;\n      };\n      var unbind = function (target, name, func) {\n        if (Tools.isArray(target)) {\n          var i = target.length;\n          var rv = [];\n          while (i--) {\n            rv[i] = unbind(target[i], name, func);\n          }\n          return rv;\n        } else {\n          if (boundEvents.length > 0 && (target === doc || target === win)) {\n            var i = boundEvents.length;\n            while (i--) {\n              var item = boundEvents[i];\n              if (target === item[0] && (!name || name === item[1]) && (!func || func === item[2])) {\n                events.unbind(item[0], item[1], item[2]);\n              }\n            }\n          }\n          return events.unbind(target, name, func);\n        }\n      };\n      var fire = function (target, name, evt) {\n        return events.fire(target, name, evt);\n      };\n      var getContentEditable = function (node) {\n        if (node && isElement$1(node)) {\n          var contentEditable = node.getAttribute('data-mce-contenteditable');\n          if (contentEditable && contentEditable !== 'inherit') {\n            return contentEditable;\n          }\n          return node.contentEditable !== 'inherit' ? node.contentEditable : null;\n        } else {\n          return null;\n        }\n      };\n      var getContentEditableParent = function (node) {\n        var root = getRoot();\n        var state = null;\n        for (; node && node !== root; node = node.parentNode) {\n          state = getContentEditable(node);\n          if (state !== null) {\n            break;\n          }\n        }\n        return state;\n      };\n      var destroy = function () {\n        if (boundEvents.length > 0) {\n          var i = boundEvents.length;\n          while (i--) {\n            var item = boundEvents[i];\n            events.unbind(item[0], item[1], item[2]);\n          }\n        }\n        each$1(files, function (_, url) {\n          styleSheetLoader.unload(url);\n          delete files[url];\n        });\n        if (Sizzle.setDocument) {\n          Sizzle.setDocument();\n        }\n      };\n      var isChildOf = function (node, parent) {\n        while (node) {\n          if (parent === node) {\n            return true;\n          }\n          node = node.parentNode;\n        }\n        return false;\n      };\n      var dumpRng = function (r) {\n        return 'startContainer: ' + r.startContainer.nodeName + ', startOffset: ' + r.startOffset + ', endContainer: ' + r.endContainer.nodeName + ', endOffset: ' + r.endOffset;\n      };\n      var self = {\n        doc: doc,\n        settings: settings,\n        win: win,\n        files: files,\n        stdMode: stdMode,\n        boxModel: boxModel,\n        styleSheetLoader: styleSheetLoader,\n        boundEvents: boundEvents,\n        styles: styles,\n        schema: schema,\n        events: events,\n        isBlock: isBlock,\n        $: $,\n        $$: $$,\n        root: null,\n        clone: clone,\n        getRoot: getRoot,\n        getViewPort: getViewPort,\n        getRect: getRect,\n        getSize: getSize,\n        getParent: getParent,\n        getParents: getParents,\n        get: get,\n        getNext: getNext,\n        getPrev: getPrev,\n        select: select,\n        is: is,\n        add: add,\n        create: create,\n        createHTML: createHTML,\n        createFragment: createFragment,\n        remove: remove,\n        setStyle: setStyle,\n        getStyle: getStyle,\n        setStyles: setStyles,\n        removeAllAttribs: removeAllAttribs,\n        setAttrib: setAttrib,\n        setAttribs: setAttribs,\n        getAttrib: getAttrib,\n        getPos: getPos$1,\n        parseStyle: parseStyle,\n        serializeStyle: serializeStyle,\n        addStyle: addStyle,\n        loadCSS: loadCSS,\n        addClass: addClass,\n        removeClass: removeClass,\n        hasClass: hasClass,\n        toggleClass: toggleClass,\n        show: show,\n        hide: hide,\n        isHidden: isHidden,\n        uniqueId: uniqueId,\n        setHTML: setHTML,\n        getOuterHTML: getOuterHTML,\n        setOuterHTML: setOuterHTML,\n        decode: decode,\n        encode: encode,\n        insertAfter: insertAfter,\n        replace: replace,\n        rename: rename,\n        findCommonAncestor: findCommonAncestor,\n        toHex: toHex,\n        run: run,\n        getAttribs: getAttribs,\n        isEmpty: isEmpty,\n        createRng: createRng,\n        nodeIndex: findNodeIndex,\n        split: split,\n        bind: bind,\n        unbind: unbind,\n        fire: fire,\n        getContentEditable: getContentEditable,\n        getContentEditableParent: getContentEditableParent,\n        destroy: destroy,\n        isChildOf: isChildOf,\n        dumpRng: dumpRng\n      };\n      var attrHooks = setupAttrHooks(styles, settings, function () {\n        return self;\n      });\n      return self;\n    };\n    DOMUtils.DOM = DOMUtils(document);\n    DOMUtils.nodeIndex = findNodeIndex;\n\n    var DOM = DOMUtils.DOM;\n    var each$6 = Tools.each, grep$2 = Tools.grep;\n    var QUEUED = 0;\n    var LOADING = 1;\n    var LOADED = 2;\n    var FAILED = 3;\n    var ScriptLoader = function () {\n      function ScriptLoader(settings) {\n        if (settings === void 0) {\n          settings = {};\n        }\n        this.states = {};\n        this.queue = [];\n        this.scriptLoadedCallbacks = {};\n        this.queueLoadedCallbacks = [];\n        this.loading = 0;\n        this.settings = settings;\n      }\n      ScriptLoader.prototype._setReferrerPolicy = function (referrerPolicy) {\n        this.settings.referrerPolicy = referrerPolicy;\n      };\n      ScriptLoader.prototype.loadScript = function (url, success, failure) {\n        var dom = DOM;\n        var elm;\n        var cleanup = function () {\n          dom.remove(id);\n          if (elm) {\n            elm.onerror = elm.onload = elm = null;\n          }\n        };\n        var done = function () {\n          cleanup();\n          success();\n        };\n        var error = function () {\n          cleanup();\n          if (isFunction(failure)) {\n            failure();\n          } else {\n            if (typeof console !== 'undefined' && console.log) {\n              console.log('Failed to load script: ' + url);\n            }\n          }\n        };\n        var id = dom.uniqueId();\n        elm = document.createElement('script');\n        elm.id = id;\n        elm.type = 'text/javascript';\n        elm.src = Tools._addCacheSuffix(url);\n        if (this.settings.referrerPolicy) {\n          dom.setAttrib(elm, 'referrerpolicy', this.settings.referrerPolicy);\n        }\n        elm.onload = done;\n        elm.onerror = error;\n        (document.getElementsByTagName('head')[0] || document.body).appendChild(elm);\n      };\n      ScriptLoader.prototype.isDone = function (url) {\n        return this.states[url] === LOADED;\n      };\n      ScriptLoader.prototype.markDone = function (url) {\n        this.states[url] = LOADED;\n      };\n      ScriptLoader.prototype.add = function (url, success, scope, failure) {\n        var state = this.states[url];\n        this.queue.push(url);\n        if (state === undefined) {\n          this.states[url] = QUEUED;\n        }\n        if (success) {\n          if (!this.scriptLoadedCallbacks[url]) {\n            this.scriptLoadedCallbacks[url] = [];\n          }\n          this.scriptLoadedCallbacks[url].push({\n            success: success,\n            failure: failure,\n            scope: scope || this\n          });\n        }\n      };\n      ScriptLoader.prototype.load = function (url, success, scope, failure) {\n        return this.add(url, success, scope, failure);\n      };\n      ScriptLoader.prototype.remove = function (url) {\n        delete this.states[url];\n        delete this.scriptLoadedCallbacks[url];\n      };\n      ScriptLoader.prototype.loadQueue = function (success, scope, failure) {\n        this.loadScripts(this.queue, success, scope, failure);\n      };\n      ScriptLoader.prototype.loadScripts = function (scripts, success, scope, failure) {\n        var self = this;\n        var failures = [];\n        var execCallbacks = function (name, url) {\n          each$6(self.scriptLoadedCallbacks[url], function (callback) {\n            if (isFunction(callback[name])) {\n              callback[name].call(callback.scope);\n            }\n          });\n          self.scriptLoadedCallbacks[url] = undefined;\n        };\n        self.queueLoadedCallbacks.push({\n          success: success,\n          failure: failure,\n          scope: scope || this\n        });\n        var loadScripts = function () {\n          var loadingScripts = grep$2(scripts);\n          scripts.length = 0;\n          each$6(loadingScripts, function (url) {\n            if (self.states[url] === LOADED) {\n              execCallbacks('success', url);\n              return;\n            }\n            if (self.states[url] === FAILED) {\n              execCallbacks('failure', url);\n              return;\n            }\n            if (self.states[url] !== LOADING) {\n              self.states[url] = LOADING;\n              self.loading++;\n              self.loadScript(url, function () {\n                self.states[url] = LOADED;\n                self.loading--;\n                execCallbacks('success', url);\n                loadScripts();\n              }, function () {\n                self.states[url] = FAILED;\n                self.loading--;\n                failures.push(url);\n                execCallbacks('failure', url);\n                loadScripts();\n              });\n            }\n          });\n          if (!self.loading) {\n            var notifyCallbacks = self.queueLoadedCallbacks.slice(0);\n            self.queueLoadedCallbacks.length = 0;\n            each$6(notifyCallbacks, function (callback) {\n              if (failures.length === 0) {\n                if (isFunction(callback.success)) {\n                  callback.success.call(callback.scope);\n                }\n              } else {\n                if (isFunction(callback.failure)) {\n                  callback.failure.call(callback.scope, failures);\n                }\n              }\n            });\n          }\n        };\n        loadScripts();\n      };\n      ScriptLoader.ScriptLoader = new ScriptLoader();\n      return ScriptLoader;\n    }();\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var isRaw = function (str) {\n      return isObject(str) && has(str, 'raw');\n    };\n    var isTokenised = function (str) {\n      return isArray(str) && str.length > 1;\n    };\n    var data = {};\n    var currentCode = Cell('en');\n    var getLanguageData = function () {\n      return get$1(data, currentCode.get());\n    };\n    var getData = function () {\n      return map$1(data, function (value) {\n        return __assign({}, value);\n      });\n    };\n    var setCode = function (newCode) {\n      if (newCode) {\n        currentCode.set(newCode);\n      }\n    };\n    var getCode = function () {\n      return currentCode.get();\n    };\n    var add = function (code, items) {\n      var langData = data[code];\n      if (!langData) {\n        data[code] = langData = {};\n      }\n      each$1(items, function (translation, name) {\n        langData[name.toLowerCase()] = translation;\n      });\n    };\n    var translate = function (text) {\n      var langData = getLanguageData().getOr({});\n      var toString = function (obj) {\n        if (isFunction(obj)) {\n          return Object.prototype.toString.call(obj);\n        }\n        return !isEmpty(obj) ? '' + obj : '';\n      };\n      var isEmpty = function (text) {\n        return text === '' || text === null || text === undefined;\n      };\n      var getLangData = function (text) {\n        var textstr = toString(text);\n        return get$1(langData, textstr.toLowerCase()).map(toString).getOr(textstr);\n      };\n      var removeContext = function (str) {\n        return str.replace(/{context:\\w+}$/, '');\n      };\n      if (isEmpty(text)) {\n        return '';\n      }\n      if (isRaw(text)) {\n        return toString(text.raw);\n      }\n      if (isTokenised(text)) {\n        var values_1 = text.slice(1);\n        var substitued = getLangData(text[0]).replace(/\\{([0-9]+)\\}/g, function ($1, $2) {\n          return has(values_1, $2) ? toString(values_1[$2]) : $1;\n        });\n        return removeContext(substitued);\n      }\n      return removeContext(getLangData(text));\n    };\n    var isRtl = function () {\n      return getLanguageData().bind(function (items) {\n        return get$1(items, '_dir');\n      }).exists(function (dir) {\n        return dir === 'rtl';\n      });\n    };\n    var hasCode = function (code) {\n      return has(data, code);\n    };\n    var I18n = {\n      getData: getData,\n      setCode: setCode,\n      getCode: getCode,\n      add: add,\n      translate: translate,\n      isRtl: isRtl,\n      hasCode: hasCode\n    };\n\n    var AddOnManager = function () {\n      var items = [];\n      var urls = {};\n      var lookup = {};\n      var _listeners = [];\n      var runListeners = function (name, state) {\n        var matchedListeners = filter(_listeners, function (listener) {\n          return listener.name === name && listener.state === state;\n        });\n        each(matchedListeners, function (listener) {\n          return listener.callback();\n        });\n      };\n      var get = function (name) {\n        if (lookup[name]) {\n          return lookup[name].instance;\n        }\n        return undefined;\n      };\n      var dependencies = function (name) {\n        var result;\n        if (lookup[name]) {\n          result = lookup[name].dependencies;\n        }\n        return result || [];\n      };\n      var requireLangPack = function (name, languages) {\n        if (AddOnManager.languageLoad !== false) {\n          waitFor(name, function () {\n            var language = I18n.getCode();\n            var wrappedLanguages = ',' + (languages || '') + ',';\n            if (!language || languages && wrappedLanguages.indexOf(',' + language + ',') === -1) {\n              return;\n            }\n            ScriptLoader.ScriptLoader.add(urls[name] + '/langs/' + language + '.js');\n          }, 'loaded');\n        }\n      };\n      var add = function (id, addOn, dependencies) {\n        var addOnConstructor = addOn;\n        items.push(addOnConstructor);\n        lookup[id] = {\n          instance: addOnConstructor,\n          dependencies: dependencies\n        };\n        runListeners(id, 'added');\n        return addOnConstructor;\n      };\n      var remove = function (name) {\n        delete urls[name];\n        delete lookup[name];\n      };\n      var createUrl = function (baseUrl, dep) {\n        if (typeof dep === 'object') {\n          return dep;\n        }\n        return typeof baseUrl === 'string' ? {\n          prefix: '',\n          resource: dep,\n          suffix: ''\n        } : {\n          prefix: baseUrl.prefix,\n          resource: dep,\n          suffix: baseUrl.suffix\n        };\n      };\n      var addComponents = function (pluginName, scripts) {\n        var pluginUrl = urls[pluginName];\n        each(scripts, function (script) {\n          ScriptLoader.ScriptLoader.add(pluginUrl + '/' + script);\n        });\n      };\n      var loadDependencies = function (name, addOnUrl, success, scope) {\n        var deps = dependencies(name);\n        each(deps, function (dep) {\n          var newUrl = createUrl(addOnUrl, dep);\n          load(newUrl.resource, newUrl, undefined, undefined);\n        });\n        if (success) {\n          if (scope) {\n            success.call(scope);\n          } else {\n            success.call(ScriptLoader);\n          }\n        }\n      };\n      var load = function (name, addOnUrl, success, scope, failure) {\n        if (urls[name]) {\n          return;\n        }\n        var urlString = typeof addOnUrl === 'string' ? addOnUrl : addOnUrl.prefix + addOnUrl.resource + addOnUrl.suffix;\n        if (urlString.indexOf('/') !== 0 && urlString.indexOf('://') === -1) {\n          urlString = AddOnManager.baseURL + '/' + urlString;\n        }\n        urls[name] = urlString.substring(0, urlString.lastIndexOf('/'));\n        var done = function () {\n          runListeners(name, 'loaded');\n          loadDependencies(name, addOnUrl, success, scope);\n        };\n        if (lookup[name]) {\n          done();\n        } else {\n          ScriptLoader.ScriptLoader.add(urlString, done, scope, failure);\n        }\n      };\n      var waitFor = function (name, callback, state) {\n        if (state === void 0) {\n          state = 'added';\n        }\n        if (has(lookup, name) && state === 'added') {\n          callback();\n        } else if (has(urls, name) && state === 'loaded') {\n          callback();\n        } else {\n          _listeners.push({\n            name: name,\n            state: state,\n            callback: callback\n          });\n        }\n      };\n      return {\n        items: items,\n        urls: urls,\n        lookup: lookup,\n        _listeners: _listeners,\n        get: get,\n        dependencies: dependencies,\n        requireLangPack: requireLangPack,\n        add: add,\n        remove: remove,\n        createUrl: createUrl,\n        addComponents: addComponents,\n        load: load,\n        waitFor: waitFor\n      };\n    };\n    AddOnManager.languageLoad = true;\n    AddOnManager.baseURL = '';\n    AddOnManager.PluginManager = AddOnManager();\n    AddOnManager.ThemeManager = AddOnManager();\n\n    var first = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer === null) {\n          timer = setTimeout(function () {\n            fn.apply(null, args);\n            timer = null;\n          }, rate);\n        }\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n    var last$2 = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer !== null) {\n          clearTimeout(timer);\n        }\n        timer = setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var read = function (element, attr) {\n      var value = get$4(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add$1 = function (element, attr, id) {\n      var old = read(element, attr);\n      var nu = old.concat([id]);\n      set(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$2 = function (element, attr, id) {\n      var nu = filter(read(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set(element, attr, nu.join(' '));\n      } else {\n        remove$1(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom.classList !== undefined;\n    };\n    var get$6 = function (element) {\n      return read(element, 'class');\n    };\n    var add$2 = function (element, clazz) {\n      return add$1(element, 'class', clazz);\n    };\n    var remove$3 = function (element, clazz) {\n      return remove$2(element, 'class', clazz);\n    };\n\n    var add$3 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom.classList.add(clazz);\n      } else {\n        add$2(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom.classList : get$6(element);\n      if (classList.length === 0) {\n        remove$1(element, 'class');\n      }\n    };\n    var remove$4 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom.classList;\n        classList.remove(clazz);\n      } else {\n        remove$3(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has$2 = function (element, clazz) {\n      return supports(element) && element.dom.classList.contains(clazz);\n    };\n\n    var descendants = function (scope, predicate) {\n      var result = [];\n      each(children(scope), function (x) {\n        if (predicate(x)) {\n          result = result.concat([x]);\n        }\n        result = result.concat(descendants(x, predicate));\n      });\n      return result;\n    };\n\n    var descendants$1 = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    var annotation = constant('mce-annotation');\n    var dataAnnotation = constant('data-mce-annotation');\n    var dataAnnotationId = constant('data-mce-annotation-uid');\n\n    var identify = function (editor, annotationName) {\n      var rng = editor.selection.getRng();\n      var start = SugarElement.fromDom(rng.startContainer);\n      var root = SugarElement.fromDom(editor.getBody());\n      var selector = annotationName.fold(function () {\n        return '.' + annotation();\n      }, function (an) {\n        return '[' + dataAnnotation() + '=\"' + an + '\"]';\n      });\n      var newStart = child(start, rng.startOffset).getOr(start);\n      var closest = closest$1(newStart, selector, function (n) {\n        return eq$2(n, root);\n      });\n      var getAttr = function (c, property) {\n        if (has$1(c, property)) {\n          return Optional.some(get$4(c, property));\n        } else {\n          return Optional.none();\n        }\n      };\n      return closest.bind(function (c) {\n        return getAttr(c, '' + dataAnnotationId()).bind(function (uid) {\n          return getAttr(c, '' + dataAnnotation()).map(function (name) {\n            var elements = findMarkers(editor, uid);\n            return {\n              uid: uid,\n              name: name,\n              elements: elements\n            };\n          });\n        });\n      });\n    };\n    var isAnnotation = function (elem) {\n      return isElement(elem) && has$2(elem, annotation());\n    };\n    var findMarkers = function (editor, uid) {\n      var body = SugarElement.fromDom(editor.getBody());\n      return descendants$1(body, '[' + dataAnnotationId() + '=\"' + uid + '\"]');\n    };\n    var findAll = function (editor, name) {\n      var body = SugarElement.fromDom(editor.getBody());\n      var markers = descendants$1(body, '[' + dataAnnotation() + '=\"' + name + '\"]');\n      var directory = {};\n      each(markers, function (m) {\n        var uid = get$4(m, dataAnnotationId());\n        var nodesAlready = directory.hasOwnProperty(uid) ? directory[uid] : [];\n        directory[uid] = nodesAlready.concat([m]);\n      });\n      return directory;\n    };\n\n    var setup = function (editor, _registry) {\n      var changeCallbacks = Cell({});\n      var initData = function () {\n        return {\n          listeners: [],\n          previous: Cell(Optional.none())\n        };\n      };\n      var withCallbacks = function (name, f) {\n        updateCallbacks(name, function (data) {\n          f(data);\n          return data;\n        });\n      };\n      var updateCallbacks = function (name, f) {\n        var callbackMap = changeCallbacks.get();\n        var data = callbackMap.hasOwnProperty(name) ? callbackMap[name] : initData();\n        var outputData = f(data);\n        callbackMap[name] = outputData;\n        changeCallbacks.set(callbackMap);\n      };\n      var fireCallbacks = function (name, uid, elements) {\n        withCallbacks(name, function (data) {\n          each(data.listeners, function (f) {\n            return f(true, name, {\n              uid: uid,\n              nodes: map(elements, function (elem) {\n                return elem.dom;\n              })\n            });\n          });\n        });\n      };\n      var fireNoAnnotation = function (name) {\n        withCallbacks(name, function (data) {\n          each(data.listeners, function (f) {\n            return f(false, name);\n          });\n        });\n      };\n      var onNodeChange = last$2(function () {\n        var callbackMap = changeCallbacks.get();\n        var annotations = sort$1(keys(callbackMap));\n        each(annotations, function (name) {\n          updateCallbacks(name, function (data) {\n            var prev = data.previous.get();\n            identify(editor, Optional.some(name)).fold(function () {\n              if (prev.isSome()) {\n                fireNoAnnotation(name);\n                data.previous.set(Optional.none());\n              }\n            }, function (_a) {\n              var uid = _a.uid, name = _a.name, elements = _a.elements;\n              if (!prev.is(uid)) {\n                fireCallbacks(name, uid, elements);\n                data.previous.set(Optional.some(uid));\n              }\n            });\n            return {\n              previous: data.previous,\n              listeners: data.listeners\n            };\n          });\n        });\n      }, 30);\n      editor.on('remove', function () {\n        onNodeChange.cancel();\n      });\n      editor.on('NodeChange', function () {\n        onNodeChange.throttle();\n      });\n      var addListener = function (name, f) {\n        updateCallbacks(name, function (data) {\n          return {\n            previous: data.previous,\n            listeners: data.listeners.concat([f])\n          };\n        });\n      };\n      return { addListener: addListener };\n    };\n\n    var setup$1 = function (editor, registry) {\n      var identifyParserNode = function (span) {\n        return Optional.from(span.attr(dataAnnotation())).bind(registry.lookup);\n      };\n      editor.on('init', function () {\n        editor.serializer.addNodeFilter('span', function (spans) {\n          each(spans, function (span) {\n            identifyParserNode(span).each(function (settings) {\n              if (settings.persistent === false) {\n                span.unwrap();\n              }\n            });\n          });\n        });\n      });\n    };\n\n    var create$2 = function () {\n      var annotations = {};\n      var register = function (name, settings) {\n        annotations[name] = {\n          name: name,\n          settings: settings\n        };\n      };\n      var lookup = function (name) {\n        return annotations.hasOwnProperty(name) ? Optional.from(annotations[name]).map(function (a) {\n          return a.settings;\n        }) : Optional.none();\n      };\n      return {\n        register: register,\n        lookup: lookup\n      };\n    };\n\n    var unique = 0;\n    var generate$1 = function (prefix) {\n      var date = new Date();\n      var time = date.getTime();\n      var random = Math.floor(Math.random() * 1000000000);\n      unique++;\n      return prefix + '_' + random + unique + String(time);\n    };\n\n    var add$4 = function (element, classes) {\n      each(classes, function (x) {\n        add$3(element, x);\n      });\n    };\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children(SugarElement.fromDom(div));\n    };\n\n    var get$7 = function (element) {\n      return element.dom.innerHTML;\n    };\n    var set$1 = function (element, content) {\n      var owner$1 = owner(element);\n      var docDom = owner$1.dom;\n      var fragment = SugarElement.fromDom(docDom.createDocumentFragment());\n      var contentElements = fromHtml$1(content, docDom);\n      append$1(fragment, contentElements);\n      empty(element);\n      append(element, fragment);\n    };\n\n    var clone$1 = function (original, isDeep) {\n      return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n    };\n    var shallow = function (original) {\n      return clone$1(original, false);\n    };\n    var deep = function (original) {\n      return clone$1(original, true);\n    };\n\n    var TextWalker = function (startNode, rootNode, isBoundary) {\n      if (isBoundary === void 0) {\n        isBoundary = never;\n      }\n      var walker = new DomTreeWalker(startNode, rootNode);\n      var walk = function (direction) {\n        var next;\n        do {\n          next = walker[direction]();\n        } while (next && !isText$1(next) && !isBoundary(next));\n        return Optional.from(next).filter(isText$1);\n      };\n      return {\n        current: function () {\n          return Optional.from(walker.current()).filter(isText$1);\n        },\n        next: function () {\n          return walk('next');\n        },\n        prev: function () {\n          return walk('prev');\n        },\n        prev2: function () {\n          return walk('prev2');\n        }\n      };\n    };\n\n    var TextSeeker = function (dom, isBoundary) {\n      var isBlockBoundary = isBoundary ? isBoundary : function (node) {\n        return dom.isBlock(node) || isBr(node) || isContentEditableFalse(node);\n      };\n      var walk = function (node, offset, walker, process) {\n        if (isText$1(node)) {\n          var newOffset = process(node, offset, node.data);\n          if (newOffset !== -1) {\n            return Optional.some({\n              container: node,\n              offset: newOffset\n            });\n          }\n        }\n        return walker().bind(function (next) {\n          return walk(next.container, next.offset, walker, process);\n        });\n      };\n      var backwards = function (node, offset, process, root) {\n        var walker = TextWalker(node, root, isBlockBoundary);\n        return walk(node, offset, function () {\n          return walker.prev().map(function (prev) {\n            return {\n              container: prev,\n              offset: prev.length\n            };\n          });\n        }, process).getOrNull();\n      };\n      var forwards = function (node, offset, process, root) {\n        var walker = TextWalker(node, root, isBlockBoundary);\n        return walk(node, offset, function () {\n          return walker.next().map(function (next) {\n            return {\n              container: next,\n              offset: 0\n            };\n          });\n        }, process).getOrNull();\n      };\n      return {\n        backwards: backwards,\n        forwards: forwards\n      };\n    };\n\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n    };\n    var lift3 = function (oa, ob, oc, f) {\n      return oa.isSome() && ob.isSome() && oc.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Optional.none();\n    };\n    var someIf = function (b, a) {\n      return b ? Optional.some(a) : Optional.none();\n    };\n\n    var round = Math.round;\n    var clone$2 = function (rect) {\n      if (!rect) {\n        return {\n          left: 0,\n          top: 0,\n          bottom: 0,\n          right: 0,\n          width: 0,\n          height: 0\n        };\n      }\n      return {\n        left: round(rect.left),\n        top: round(rect.top),\n        bottom: round(rect.bottom),\n        right: round(rect.right),\n        width: round(rect.width),\n        height: round(rect.height)\n      };\n    };\n    var collapse = function (rect, toStart) {\n      rect = clone$2(rect);\n      if (toStart) {\n        rect.right = rect.left;\n      } else {\n        rect.left = rect.left + rect.width;\n        rect.right = rect.left;\n      }\n      rect.width = 0;\n      return rect;\n    };\n    var isEqual = function (rect1, rect2) {\n      return rect1.left === rect2.left && rect1.top === rect2.top && rect1.bottom === rect2.bottom && rect1.right === rect2.right;\n    };\n    var isValidOverflow = function (overflowY, rect1, rect2) {\n      return overflowY >= 0 && overflowY <= Math.min(rect1.height, rect2.height) / 2;\n    };\n    var isAbove = function (rect1, rect2) {\n      var halfHeight = Math.min(rect2.height / 2, rect1.height / 2);\n      if (rect1.bottom - halfHeight < rect2.top) {\n        return true;\n      }\n      if (rect1.top > rect2.bottom) {\n        return false;\n      }\n      return isValidOverflow(rect2.top - rect1.bottom, rect1, rect2);\n    };\n    var isBelow = function (rect1, rect2) {\n      if (rect1.top > rect2.bottom) {\n        return true;\n      }\n      if (rect1.bottom < rect2.top) {\n        return false;\n      }\n      return isValidOverflow(rect2.bottom - rect1.top, rect1, rect2);\n    };\n    var containsXY = function (rect, clientX, clientY) {\n      return clientX >= rect.left && clientX <= rect.right && clientY >= rect.top && clientY <= rect.bottom;\n    };\n\n    var getSelectedNode = function (range) {\n      var startContainer = range.startContainer, startOffset = range.startOffset;\n      if (startContainer.hasChildNodes() && range.endOffset === startOffset + 1) {\n        return startContainer.childNodes[startOffset];\n      }\n      return null;\n    };\n    var getNode = function (container, offset) {\n      if (container.nodeType === 1 && container.hasChildNodes()) {\n        if (offset >= container.childNodes.length) {\n          offset = container.childNodes.length - 1;\n        }\n        container = container.childNodes[offset];\n      }\n      return container;\n    };\n\n    var extendingChars = new RegExp('[\\u0300-\\u036f\\u0483-\\u0487\\u0488-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1-\\u05c2\\u05c4-\\u05c5\\u05c7\\u0610-\\u061a' + '\\u064b-\\u065f\\u0670\\u06d6-\\u06dc\\u06df-\\u06e4\\u06e7-\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0' + '\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0859-\\u085b\\u08e3-\\u0902\\u093a\\u093c' + '\\u0941-\\u0948\\u094d\\u0951-\\u0957\\u0962-\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2-\\u09e3' + '\\u0a01-\\u0a02\\u0a3c\\u0a41-\\u0a42\\u0a47-\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70-\\u0a71\\u0a75\\u0a81-\\u0a82\\u0abc' + '\\u0ac1-\\u0ac5\\u0ac7-\\u0ac8\\u0acd\\u0ae2-\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57' + '\\u0b62-\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c00\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55-\\u0c56' + '\\u0c62-\\u0c63\\u0c81\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc-\\u0ccd\\u0cd5-\\u0cd6\\u0ce2-\\u0ce3\\u0d01\\u0d3e\\u0d41-\\u0d44' + '\\u0d4d\\u0d57\\u0d62-\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9' + '\\u0ebb-\\u0ebc\\u0ec8-\\u0ecd\\u0f18-\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97' + '\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039-\\u103a\\u103d-\\u103e\\u1058-\\u1059\\u105e-\\u1060\\u1071-\\u1074' + '\\u1082\\u1085-\\u1086\\u108d\\u109d\\u135d-\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752-\\u1753\\u1772-\\u1773\\u17b4-\\u17b5' + '\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927-\\u1928\\u1932\\u1939-\\u193b\\u1a17-\\u1a18' + '\\u1a1b\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1ab0-\\u1abd\\u1ABE\\u1b00-\\u1b03\\u1b34' + '\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80-\\u1b81\\u1ba2-\\u1ba5\\u1ba8-\\u1ba9\\u1bab-\\u1bad\\u1be6\\u1be8-\\u1be9' + '\\u1bed\\u1bef-\\u1bf1\\u1c2c-\\u1c33\\u1c36-\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1cf4\\u1cf8-\\u1cf9' + '\\u1dc0-\\u1df5\\u1dfc-\\u1dff\\u200c-\\u200d\\u20d0-\\u20dc\\u20DD-\\u20E0\\u20e1\\u20E2-\\u20E4\\u20e5-\\u20f0\\u2cef-\\u2cf1' + '\\u2d7f\\u2de0-\\u2dff\\u302a-\\u302d\\u302e-\\u302f\\u3099-\\u309a\\ua66f\\uA670-\\uA672\\ua674-\\ua67d\\ua69e-\\ua69f\\ua6f0-\\ua6f1' + '\\ua802\\ua806\\ua80b\\ua825-\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc' + '\\ua9e5\\uaa29-\\uaa2e\\uaa31-\\uaa32\\uaa35-\\uaa36\\uaa43\\uaa4c\\uaa7c\\uaab0\\uaab2-\\uaab4\\uaab7-\\uaab8\\uaabe-\\uaabf\\uaac1' + '\\uaaec-\\uaaed\\uaaf6\\uabe5\\uabe8\\uabed\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe2f\\uff9e-\\uff9f]');\n    var isExtendingChar = function (ch) {\n      return typeof ch === 'string' && ch.charCodeAt(0) >= 768 && extendingChars.test(ch);\n    };\n\n    var or = function () {\n      var args = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n      return function (x) {\n        for (var i = 0; i < args.length; i++) {\n          if (args[i](x)) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var and = function () {\n      var args = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n      return function (x) {\n        for (var i = 0; i < args.length; i++) {\n          if (!args[i](x)) {\n            return false;\n          }\n        }\n        return true;\n      };\n    };\n\n    var isElement$3 = isElement$1;\n    var isCaretCandidate$1 = isCaretCandidate;\n    var isBlock$1 = matchStyleValues('display', 'block table');\n    var isFloated = matchStyleValues('float', 'left right');\n    var isValidElementCaretCandidate = and(isElement$3, isCaretCandidate$1, not(isFloated));\n    var isNotPre = not(matchStyleValues('white-space', 'pre pre-line pre-wrap'));\n    var isText$4 = isText$1;\n    var isBr$3 = isBr;\n    var nodeIndex = DOMUtils.nodeIndex;\n    var resolveIndex = getNode;\n    var createRange = function (doc) {\n      return 'createRange' in doc ? doc.createRange() : DOMUtils.DOM.createRng();\n    };\n    var isWhiteSpace = function (chr) {\n      return chr && /[\\r\\n\\t ]/.test(chr);\n    };\n    var isRange = function (rng) {\n      return !!rng.setStart && !!rng.setEnd;\n    };\n    var isHiddenWhiteSpaceRange = function (range) {\n      var container = range.startContainer;\n      var offset = range.startOffset;\n      var text;\n      if (isWhiteSpace(range.toString()) && isNotPre(container.parentNode) && isText$1(container)) {\n        text = container.data;\n        if (isWhiteSpace(text[offset - 1]) || isWhiteSpace(text[offset + 1])) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var getBrClientRect = function (brNode) {\n      var doc = brNode.ownerDocument;\n      var rng = createRange(doc);\n      var nbsp$1 = doc.createTextNode(nbsp);\n      var parentNode = brNode.parentNode;\n      parentNode.insertBefore(nbsp$1, brNode);\n      rng.setStart(nbsp$1, 0);\n      rng.setEnd(nbsp$1, 1);\n      var clientRect = clone$2(rng.getBoundingClientRect());\n      parentNode.removeChild(nbsp$1);\n      return clientRect;\n    };\n    var getBoundingClientRectWebKitText = function (rng) {\n      var sc = rng.startContainer;\n      var ec = rng.endContainer;\n      var so = rng.startOffset;\n      var eo = rng.endOffset;\n      if (sc === ec && isText$1(ec) && so === 0 && eo === 1) {\n        var newRng = rng.cloneRange();\n        newRng.setEndAfter(ec);\n        return getBoundingClientRect(newRng);\n      } else {\n        return null;\n      }\n    };\n    var isZeroRect = function (r) {\n      return r.left === 0 && r.right === 0 && r.top === 0 && r.bottom === 0;\n    };\n    var getBoundingClientRect = function (item) {\n      var clientRect;\n      var clientRects = item.getClientRects();\n      if (clientRects.length > 0) {\n        clientRect = clone$2(clientRects[0]);\n      } else {\n        clientRect = clone$2(item.getBoundingClientRect());\n      }\n      if (!isRange(item) && isBr$3(item) && isZeroRect(clientRect)) {\n        return getBrClientRect(item);\n      }\n      if (isZeroRect(clientRect) && isRange(item)) {\n        return getBoundingClientRectWebKitText(item);\n      }\n      return clientRect;\n    };\n    var collapseAndInflateWidth = function (clientRect, toStart) {\n      var newClientRect = collapse(clientRect, toStart);\n      newClientRect.width = 1;\n      newClientRect.right = newClientRect.left + 1;\n      return newClientRect;\n    };\n    var getCaretPositionClientRects = function (caretPosition) {\n      var clientRects = [];\n      var beforeNode, node;\n      var addUniqueAndValidRect = function (clientRect) {\n        if (clientRect.height === 0) {\n          return;\n        }\n        if (clientRects.length > 0) {\n          if (isEqual(clientRect, clientRects[clientRects.length - 1])) {\n            return;\n          }\n        }\n        clientRects.push(clientRect);\n      };\n      var addCharacterOffset = function (container, offset) {\n        var range = createRange(container.ownerDocument);\n        if (offset < container.data.length) {\n          if (isExtendingChar(container.data[offset])) {\n            return clientRects;\n          }\n          if (isExtendingChar(container.data[offset - 1])) {\n            range.setStart(container, offset);\n            range.setEnd(container, offset + 1);\n            if (!isHiddenWhiteSpaceRange(range)) {\n              addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), false));\n              return clientRects;\n            }\n          }\n        }\n        if (offset > 0) {\n          range.setStart(container, offset - 1);\n          range.setEnd(container, offset);\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), false));\n          }\n        }\n        if (offset < container.data.length) {\n          range.setStart(container, offset);\n          range.setEnd(container, offset + 1);\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), true));\n          }\n        }\n      };\n      if (isText$4(caretPosition.container())) {\n        addCharacterOffset(caretPosition.container(), caretPosition.offset());\n        return clientRects;\n      }\n      if (isElement$3(caretPosition.container())) {\n        if (caretPosition.isAtEnd()) {\n          node = resolveIndex(caretPosition.container(), caretPosition.offset());\n          if (isText$4(node)) {\n            addCharacterOffset(node, node.data.length);\n          }\n          if (isValidElementCaretCandidate(node) && !isBr$3(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), false));\n          }\n        } else {\n          node = resolveIndex(caretPosition.container(), caretPosition.offset());\n          if (isText$4(node)) {\n            addCharacterOffset(node, 0);\n          }\n          if (isValidElementCaretCandidate(node) && caretPosition.isAtEnd()) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), false));\n            return clientRects;\n          }\n          beforeNode = resolveIndex(caretPosition.container(), caretPosition.offset() - 1);\n          if (isValidElementCaretCandidate(beforeNode) && !isBr$3(beforeNode)) {\n            if (isBlock$1(beforeNode) || isBlock$1(node) || !isValidElementCaretCandidate(node)) {\n              addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(beforeNode), false));\n            }\n          }\n          if (isValidElementCaretCandidate(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), true));\n          }\n        }\n      }\n      return clientRects;\n    };\n    var CaretPosition = function (container, offset, clientRects) {\n      var isAtStart = function () {\n        if (isText$4(container)) {\n          return offset === 0;\n        }\n        return offset === 0;\n      };\n      var isAtEnd = function () {\n        if (isText$4(container)) {\n          return offset >= container.data.length;\n        }\n        return offset >= container.childNodes.length;\n      };\n      var toRange = function () {\n        var range = createRange(container.ownerDocument);\n        range.setStart(container, offset);\n        range.setEnd(container, offset);\n        return range;\n      };\n      var getClientRects = function () {\n        if (!clientRects) {\n          clientRects = getCaretPositionClientRects(CaretPosition(container, offset));\n        }\n        return clientRects;\n      };\n      var isVisible = function () {\n        return getClientRects().length > 0;\n      };\n      var isEqual = function (caretPosition) {\n        return caretPosition && container === caretPosition.container() && offset === caretPosition.offset();\n      };\n      var getNode = function (before) {\n        return resolveIndex(container, before ? offset - 1 : offset);\n      };\n      return {\n        container: constant(container),\n        offset: constant(offset),\n        toRange: toRange,\n        getClientRects: getClientRects,\n        isVisible: isVisible,\n        isAtStart: isAtStart,\n        isAtEnd: isAtEnd,\n        isEqual: isEqual,\n        getNode: getNode\n      };\n    };\n    CaretPosition.fromRangeStart = function (range) {\n      return CaretPosition(range.startContainer, range.startOffset);\n    };\n    CaretPosition.fromRangeEnd = function (range) {\n      return CaretPosition(range.endContainer, range.endOffset);\n    };\n    CaretPosition.after = function (node) {\n      return CaretPosition(node.parentNode, nodeIndex(node) + 1);\n    };\n    CaretPosition.before = function (node) {\n      return CaretPosition(node.parentNode, nodeIndex(node));\n    };\n    CaretPosition.isAbove = function (pos1, pos2) {\n      return lift2(head(pos2.getClientRects()), last(pos1.getClientRects()), isAbove).getOr(false);\n    };\n    CaretPosition.isBelow = function (pos1, pos2) {\n      return lift2(last(pos2.getClientRects()), head(pos1.getClientRects()), isBelow).getOr(false);\n    };\n    CaretPosition.isAtStart = function (pos) {\n      return pos ? pos.isAtStart() : false;\n    };\n    CaretPosition.isAtEnd = function (pos) {\n      return pos ? pos.isAtEnd() : false;\n    };\n    CaretPosition.isTextPosition = function (pos) {\n      return pos ? isText$1(pos.container()) : false;\n    };\n    CaretPosition.isElementPosition = function (pos) {\n      return CaretPosition.isTextPosition(pos) === false;\n    };\n\n    var trimEmptyTextNode = function (dom, node) {\n      if (isText$1(node) && node.data.length === 0) {\n        dom.remove(node);\n      }\n    };\n    var insertNode = function (dom, rng, node) {\n      rng.insertNode(node);\n      trimEmptyTextNode(dom, node.previousSibling);\n      trimEmptyTextNode(dom, node.nextSibling);\n    };\n    var insertFragment = function (dom, rng, frag) {\n      var firstChild = Optional.from(frag.firstChild);\n      var lastChild = Optional.from(frag.lastChild);\n      rng.insertNode(frag);\n      firstChild.each(function (child) {\n        return trimEmptyTextNode(dom, child.previousSibling);\n      });\n      lastChild.each(function (child) {\n        return trimEmptyTextNode(dom, child.nextSibling);\n      });\n    };\n    var rangeInsertNode = function (dom, rng, node) {\n      if (isDocumentFragment$1(node)) {\n        insertFragment(dom, rng, node);\n      } else {\n        insertNode(dom, rng, node);\n      }\n    };\n\n    var isText$5 = isText$1;\n    var isBogus$2 = isBogus;\n    var nodeIndex$1 = DOMUtils.nodeIndex;\n    var normalizedParent = function (node) {\n      var parentNode = node.parentNode;\n      if (isBogus$2(parentNode)) {\n        return normalizedParent(parentNode);\n      }\n      return parentNode;\n    };\n    var getChildNodes = function (node) {\n      if (!node) {\n        return [];\n      }\n      return reduce(node.childNodes, function (result, node) {\n        if (isBogus$2(node) && node.nodeName !== 'BR') {\n          result = result.concat(getChildNodes(node));\n        } else {\n          result.push(node);\n        }\n        return result;\n      }, []);\n    };\n    var normalizedTextOffset = function (node, offset) {\n      while (node = node.previousSibling) {\n        if (!isText$5(node)) {\n          break;\n        }\n        offset += node.data.length;\n      }\n      return offset;\n    };\n    var equal$1 = function (a) {\n      return function (b) {\n        return a === b;\n      };\n    };\n    var normalizedNodeIndex = function (node) {\n      var nodes, index;\n      nodes = getChildNodes(normalizedParent(node));\n      index = findIndex$1(nodes, equal$1(node), node);\n      nodes = nodes.slice(0, index + 1);\n      var numTextFragments = reduce(nodes, function (result, node, i) {\n        if (isText$5(node) && isText$5(nodes[i - 1])) {\n          result++;\n        }\n        return result;\n      }, 0);\n      nodes = filter$2(nodes, matchNodeNames([node.nodeName]));\n      index = findIndex$1(nodes, equal$1(node), node);\n      return index - numTextFragments;\n    };\n    var createPathItem = function (node) {\n      var name;\n      if (isText$5(node)) {\n        name = 'text()';\n      } else {\n        name = node.nodeName.toLowerCase();\n      }\n      return name + '[' + normalizedNodeIndex(node) + ']';\n    };\n    var parentsUntil = function (root, node, predicate) {\n      var parents = [];\n      for (node = node.parentNode; node !== root; node = node.parentNode) {\n        if (predicate && predicate(node)) {\n          break;\n        }\n        parents.push(node);\n      }\n      return parents;\n    };\n    var create$3 = function (root, caretPosition) {\n      var container, offset, path = [], outputOffset, childNodes, parents;\n      container = caretPosition.container();\n      offset = caretPosition.offset();\n      if (isText$5(container)) {\n        outputOffset = normalizedTextOffset(container, offset);\n      } else {\n        childNodes = container.childNodes;\n        if (offset >= childNodes.length) {\n          outputOffset = 'after';\n          offset = childNodes.length - 1;\n        } else {\n          outputOffset = 'before';\n        }\n        container = childNodes[offset];\n      }\n      path.push(createPathItem(container));\n      parents = parentsUntil(root, container);\n      parents = filter$2(parents, not(isBogus));\n      path = path.concat(map$2(parents, function (node) {\n        return createPathItem(node);\n      }));\n      return path.reverse().join('/') + ',' + outputOffset;\n    };\n    var resolvePathItem = function (node, name, index) {\n      var nodes = getChildNodes(node);\n      nodes = filter$2(nodes, function (node, index) {\n        return !isText$5(node) || !isText$5(nodes[index - 1]);\n      });\n      nodes = filter$2(nodes, matchNodeNames([name]));\n      return nodes[index];\n    };\n    var findTextPosition = function (container, offset) {\n      var node = container, targetOffset = 0, dataLen;\n      while (isText$5(node)) {\n        dataLen = node.data.length;\n        if (offset >= targetOffset && offset <= targetOffset + dataLen) {\n          container = node;\n          offset = offset - targetOffset;\n          break;\n        }\n        if (!isText$5(node.nextSibling)) {\n          container = node;\n          offset = dataLen;\n          break;\n        }\n        targetOffset += dataLen;\n        node = node.nextSibling;\n      }\n      if (isText$5(container) && offset > container.data.length) {\n        offset = container.data.length;\n      }\n      return CaretPosition(container, offset);\n    };\n    var resolve$1 = function (root, path) {\n      var offset;\n      if (!path) {\n        return null;\n      }\n      var parts = path.split(',');\n      var paths = parts[0].split('/');\n      offset = parts.length > 1 ? parts[1] : 'before';\n      var container = reduce(paths, function (result, value) {\n        var match = /([\\w\\-\\(\\)]+)\\[([0-9]+)\\]/.exec(value);\n        if (!match) {\n          return null;\n        }\n        if (match[1] === 'text()') {\n          match[1] = '#text';\n        }\n        return resolvePathItem(result, match[1], parseInt(match[2], 10));\n      }, root);\n      if (!container) {\n        return null;\n      }\n      if (!isText$5(container)) {\n        if (offset === 'after') {\n          offset = nodeIndex$1(container) + 1;\n        } else {\n          offset = nodeIndex$1(container);\n        }\n        return CaretPosition(container.parentNode, offset);\n      }\n      return findTextPosition(container, parseInt(offset, 10));\n    };\n\n    var isContentEditableFalse$2 = isContentEditableFalse;\n    var getNormalizedTextOffset = function (trim, container, offset) {\n      var node, trimmedOffset;\n      trimmedOffset = trim(container.data.slice(0, offset)).length;\n      for (node = container.previousSibling; node && isText$1(node); node = node.previousSibling) {\n        trimmedOffset += trim(node.data).length;\n      }\n      return trimmedOffset;\n    };\n    var getPoint = function (dom, trim, normalized, rng, start) {\n      var container = rng[start ? 'startContainer' : 'endContainer'];\n      var offset = rng[start ? 'startOffset' : 'endOffset'];\n      var point = [];\n      var childNodes, after = 0;\n      var root = dom.getRoot();\n      if (isText$1(container)) {\n        point.push(normalized ? getNormalizedTextOffset(trim, container, offset) : offset);\n      } else {\n        childNodes = container.childNodes;\n        if (offset >= childNodes.length && childNodes.length) {\n          after = 1;\n          offset = Math.max(0, childNodes.length - 1);\n        }\n        point.push(dom.nodeIndex(childNodes[offset], normalized) + after);\n      }\n      for (; container && container !== root; container = container.parentNode) {\n        point.push(dom.nodeIndex(container, normalized));\n      }\n      return point;\n    };\n    var getLocation = function (trim, selection, normalized, rng) {\n      var dom = selection.dom, bookmark = {};\n      bookmark.start = getPoint(dom, trim, normalized, rng, true);\n      if (!selection.isCollapsed()) {\n        bookmark.end = getPoint(dom, trim, normalized, rng, false);\n      }\n      return bookmark;\n    };\n    var findIndex$2 = function (dom, name, element) {\n      var count = 0;\n      Tools.each(dom.select(name), function (node) {\n        if (node.getAttribute('data-mce-bogus') === 'all') {\n          return;\n        }\n        if (node === element) {\n          return false;\n        }\n        count++;\n      });\n      return count;\n    };\n    var moveEndPoint = function (rng, start) {\n      var container, offset, childNodes;\n      var prefix = start ? 'start' : 'end';\n      container = rng[prefix + 'Container'];\n      offset = rng[prefix + 'Offset'];\n      if (isElement$1(container) && container.nodeName === 'TR') {\n        childNodes = container.childNodes;\n        container = childNodes[Math.min(start ? offset : offset - 1, childNodes.length - 1)];\n        if (container) {\n          offset = start ? 0 : container.childNodes.length;\n          rng['set' + (start ? 'Start' : 'End')](container, offset);\n        }\n      }\n    };\n    var normalizeTableCellSelection = function (rng) {\n      moveEndPoint(rng, true);\n      moveEndPoint(rng, false);\n      return rng;\n    };\n    var findSibling = function (node, offset) {\n      var sibling;\n      if (isElement$1(node)) {\n        node = getNode(node, offset);\n        if (isContentEditableFalse$2(node)) {\n          return node;\n        }\n      }\n      if (isCaretContainer(node)) {\n        if (isText$1(node) && isCaretContainerBlock(node)) {\n          node = node.parentNode;\n        }\n        sibling = node.previousSibling;\n        if (isContentEditableFalse$2(sibling)) {\n          return sibling;\n        }\n        sibling = node.nextSibling;\n        if (isContentEditableFalse$2(sibling)) {\n          return sibling;\n        }\n      }\n    };\n    var findAdjacentContentEditableFalseElm = function (rng) {\n      return findSibling(rng.startContainer, rng.startOffset) || findSibling(rng.endContainer, rng.endOffset);\n    };\n    var getOffsetBookmark = function (trim, normalized, selection) {\n      var element = selection.getNode();\n      var name = element ? element.nodeName : null;\n      var rng = selection.getRng();\n      if (isContentEditableFalse$2(element) || name === 'IMG') {\n        return {\n          name: name,\n          index: findIndex$2(selection.dom, name, element)\n        };\n      }\n      var sibling = findAdjacentContentEditableFalseElm(rng);\n      if (sibling) {\n        name = sibling.tagName;\n        return {\n          name: name,\n          index: findIndex$2(selection.dom, name, sibling)\n        };\n      }\n      return getLocation(trim, selection, normalized, rng);\n    };\n    var getCaretBookmark = function (selection) {\n      var rng = selection.getRng();\n      return {\n        start: create$3(selection.dom.getRoot(), CaretPosition.fromRangeStart(rng)),\n        end: create$3(selection.dom.getRoot(), CaretPosition.fromRangeEnd(rng))\n      };\n    };\n    var getRangeBookmark = function (selection) {\n      return { rng: selection.getRng() };\n    };\n    var createBookmarkSpan = function (dom, id, filled) {\n      var args = {\n        'data-mce-type': 'bookmark',\n        id: id,\n        'style': 'overflow:hidden;line-height:0px'\n      };\n      return filled ? dom.create('span', args, '&#xFEFF;') : dom.create('span', args);\n    };\n    var getPersistentBookmark = function (selection, filled) {\n      var dom = selection.dom;\n      var rng = selection.getRng();\n      var id = dom.uniqueId();\n      var collapsed = selection.isCollapsed();\n      var element = selection.getNode();\n      var name = element.nodeName;\n      if (name === 'IMG') {\n        return {\n          name: name,\n          index: findIndex$2(dom, name, element)\n        };\n      }\n      var rng2 = normalizeTableCellSelection(rng.cloneRange());\n      if (!collapsed) {\n        rng2.collapse(false);\n        var endBookmarkNode = createBookmarkSpan(dom, id + '_end', filled);\n        rangeInsertNode(dom, rng2, endBookmarkNode);\n      }\n      rng = normalizeTableCellSelection(rng);\n      rng.collapse(true);\n      var startBookmarkNode = createBookmarkSpan(dom, id + '_start', filled);\n      rangeInsertNode(dom, rng, startBookmarkNode);\n      selection.moveToBookmark({\n        id: id,\n        keep: true\n      });\n      return { id: id };\n    };\n    var getBookmark = function (selection, type, normalized) {\n      if (type === 2) {\n        return getOffsetBookmark(trim$2, normalized, selection);\n      } else if (type === 3) {\n        return getCaretBookmark(selection);\n      } else if (type) {\n        return getRangeBookmark(selection);\n      } else {\n        return getPersistentBookmark(selection, false);\n      }\n    };\n    var getUndoBookmark = curry(getOffsetBookmark, identity, true);\n\n    var DOM$1 = DOMUtils.DOM;\n    var defaultPreviewStyles = 'font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow';\n    var getBodySetting = function (editor, name, defaultValue) {\n      var value = editor.getParam(name, defaultValue);\n      if (value.indexOf('=') !== -1) {\n        var bodyObj = editor.getParam(name, '', 'hash');\n        return bodyObj.hasOwnProperty(editor.id) ? bodyObj[editor.id] : defaultValue;\n      } else {\n        return value;\n      }\n    };\n    var getIframeAttrs = function (editor) {\n      return editor.getParam('iframe_attrs', {});\n    };\n    var getDocType = function (editor) {\n      return editor.getParam('doctype', '<!DOCTYPE html>');\n    };\n    var getDocumentBaseUrl = function (editor) {\n      return editor.getParam('document_base_url', '');\n    };\n    var getBodyId = function (editor) {\n      return getBodySetting(editor, 'body_id', 'tinymce');\n    };\n    var getBodyClass = function (editor) {\n      return getBodySetting(editor, 'body_class', '');\n    };\n    var getContentSecurityPolicy = function (editor) {\n      return editor.getParam('content_security_policy', '');\n    };\n    var shouldPutBrInPre = function (editor) {\n      return editor.getParam('br_in_pre', true);\n    };\n    var getForcedRootBlock = function (editor) {\n      if (editor.getParam('force_p_newlines', false)) {\n        return 'p';\n      }\n      var block = editor.getParam('forced_root_block', 'p');\n      if (block === false) {\n        return '';\n      } else if (block === true) {\n        return 'p';\n      } else {\n        return block;\n      }\n    };\n    var getForcedRootBlockAttrs = function (editor) {\n      return editor.getParam('forced_root_block_attrs', {});\n    };\n    var getBrNewLineSelector = function (editor) {\n      return editor.getParam('br_newline_selector', '.mce-toc h2,figcaption,caption');\n    };\n    var getNoNewLineSelector = function (editor) {\n      return editor.getParam('no_newline_selector', '');\n    };\n    var shouldKeepStyles = function (editor) {\n      return editor.getParam('keep_styles', true);\n    };\n    var shouldEndContainerOnEmptyBlock = function (editor) {\n      return editor.getParam('end_container_on_empty_block', false);\n    };\n    var getFontStyleValues = function (editor) {\n      return Tools.explode(editor.getParam('font_size_style_values', 'xx-small,x-small,small,medium,large,x-large,xx-large'));\n    };\n    var getFontSizeClasses = function (editor) {\n      return Tools.explode(editor.getParam('font_size_classes', ''));\n    };\n    var getImagesDataImgFilter = function (editor) {\n      return editor.getParam('images_dataimg_filter', always, 'function');\n    };\n    var isAutomaticUploadsEnabled = function (editor) {\n      return editor.getParam('automatic_uploads', true, 'boolean');\n    };\n    var shouldReuseFileName = function (editor) {\n      return editor.getParam('images_reuse_filename', false, 'boolean');\n    };\n    var shouldReplaceBlobUris = function (editor) {\n      return editor.getParam('images_replace_blob_uris', true, 'boolean');\n    };\n    var getIconPackName = function (editor) {\n      return editor.getParam('icons', '', 'string');\n    };\n    var getIconsUrl = function (editor) {\n      return editor.getParam('icons_url', '', 'string');\n    };\n    var getImageUploadUrl = function (editor) {\n      return editor.getParam('images_upload_url', '', 'string');\n    };\n    var getImageUploadBasePath = function (editor) {\n      return editor.getParam('images_upload_base_path', '', 'string');\n    };\n    var getImagesUploadCredentials = function (editor) {\n      return editor.getParam('images_upload_credentials', false, 'boolean');\n    };\n    var getImagesUploadHandler = function (editor) {\n      return editor.getParam('images_upload_handler', null, 'function');\n    };\n    var shouldUseContentCssCors = function (editor) {\n      return editor.getParam('content_css_cors', false, 'boolean');\n    };\n    var getReferrerPolicy = function (editor) {\n      return editor.getParam('referrer_policy', '', 'string');\n    };\n    var getLanguageCode = function (editor) {\n      return editor.getParam('language', 'en', 'string');\n    };\n    var getLanguageUrl = function (editor) {\n      return editor.getParam('language_url', '', 'string');\n    };\n    var shouldIndentUseMargin = function (editor) {\n      return editor.getParam('indent_use_margin', false);\n    };\n    var getIndentation = function (editor) {\n      return editor.getParam('indentation', '40px', 'string');\n    };\n    var getContentCss = function (editor) {\n      var contentCss = editor.getParam('content_css');\n      if (isString(contentCss)) {\n        return map(contentCss.split(','), trim);\n      } else if (isArray(contentCss)) {\n        return contentCss;\n      } else if (contentCss === false || editor.inline) {\n        return [];\n      } else {\n        return ['default'];\n      }\n    };\n    var getFontCss = function (editor) {\n      var fontCss = editor.getParam('font_css', []);\n      return isArray(fontCss) ? fontCss : map(fontCss.split(','), trim);\n    };\n    var getDirectionality = function (editor) {\n      return editor.getParam('directionality', I18n.isRtl() ? 'rtl' : undefined);\n    };\n    var getInlineBoundarySelector = function (editor) {\n      return editor.getParam('inline_boundaries_selector', 'a[href],code,.mce-annotation', 'string');\n    };\n    var getObjectResizing = function (editor) {\n      var selector = editor.getParam('object_resizing');\n      if (selector === false || Env.iOS) {\n        return false;\n      } else {\n        return isString(selector) ? selector : 'table,img,figure.image,div,video,iframe';\n      }\n    };\n    var getResizeImgProportional = function (editor) {\n      return editor.getParam('resize_img_proportional', true, 'boolean');\n    };\n    var getPlaceholder = function (editor) {\n      return editor.getParam('placeholder', DOM$1.getAttrib(editor.getElement(), 'placeholder'), 'string');\n    };\n    var getEventRoot = function (editor) {\n      return editor.getParam('event_root');\n    };\n    var getServiceMessage = function (editor) {\n      return editor.getParam('service_message');\n    };\n    var getTheme = function (editor) {\n      return editor.getParam('theme');\n    };\n    var shouldValidate = function (editor) {\n      return editor.getParam('validate');\n    };\n    var isInlineBoundariesEnabled = function (editor) {\n      return editor.getParam('inline_boundaries') !== false;\n    };\n    var getFormats = function (editor) {\n      return editor.getParam('formats');\n    };\n    var getPreviewStyles = function (editor) {\n      var style = editor.getParam('preview_styles', defaultPreviewStyles);\n      if (isString(style)) {\n        return style;\n      } else {\n        return '';\n      }\n    };\n    var canFormatEmptyLines = function (editor) {\n      return editor.getParam('format_empty_lines', false, 'boolean');\n    };\n    var getCustomUiSelector = function (editor) {\n      return editor.getParam('custom_ui_selector', '', 'string');\n    };\n    var getThemeUrl = function (editor) {\n      return editor.getParam('theme_url');\n    };\n    var isInline$1 = function (editor) {\n      return editor.getParam('inline');\n    };\n    var hasHiddenInput = function (editor) {\n      return editor.getParam('hidden_input');\n    };\n    var shouldPatchSubmit = function (editor) {\n      return editor.getParam('submit_patch');\n    };\n    var isEncodingXml = function (editor) {\n      return editor.getParam('encoding') === 'xml';\n    };\n    var shouldAddFormSubmitTrigger = function (editor) {\n      return editor.getParam('add_form_submit_trigger');\n    };\n    var shouldAddUnloadTrigger = function (editor) {\n      return editor.getParam('add_unload_trigger');\n    };\n    var hasForcedRootBlock = function (editor) {\n      return getForcedRootBlock(editor) !== '';\n    };\n    var getCustomUndoRedoLevels = function (editor) {\n      return editor.getParam('custom_undo_redo_levels', 0, 'number');\n    };\n    var shouldDisableNodeChange = function (editor) {\n      return editor.getParam('disable_nodechange');\n    };\n    var isReadOnly = function (editor) {\n      return editor.getParam('readonly');\n    };\n    var hasContentCssCors = function (editor) {\n      return editor.getParam('content_css_cors');\n    };\n    var getPlugins = function (editor) {\n      return editor.getParam('plugins', '', 'string');\n    };\n    var getExternalPlugins = function (editor) {\n      return editor.getParam('external_plugins');\n    };\n    var shouldBlockUnsupportedDrop = function (editor) {\n      return editor.getParam('block_unsupported_drop', true, 'boolean');\n    };\n    var isVisualAidsEnabled = function (editor) {\n      return editor.getParam('visual', true, 'boolean');\n    };\n    var getVisualAidsTableClass = function (editor) {\n      return editor.getParam('visual_table_class', 'mce-item-table', 'string');\n    };\n    var getVisualAidsAnchorClass = function (editor) {\n      return editor.getParam('visual_anchor_class', 'mce-item-anchor', 'string');\n    };\n\n    var isElement$4 = isElement$1;\n    var isText$6 = isText$1;\n    var removeNode = function (node) {\n      var parentNode = node.parentNode;\n      if (parentNode) {\n        parentNode.removeChild(node);\n      }\n    };\n    var trimCount = function (text) {\n      var trimmedText = trim$2(text);\n      return {\n        count: text.length - trimmedText.length,\n        text: trimmedText\n      };\n    };\n    var deleteZwspChars = function (caretContainer) {\n      var idx;\n      while ((idx = caretContainer.data.lastIndexOf(ZWSP)) !== -1) {\n        caretContainer.deleteData(idx, 1);\n      }\n    };\n    var removeUnchanged = function (caretContainer, pos) {\n      remove$5(caretContainer);\n      return pos;\n    };\n    var removeTextAndReposition = function (caretContainer, pos) {\n      var before = trimCount(caretContainer.data.substr(0, pos.offset()));\n      var after = trimCount(caretContainer.data.substr(pos.offset()));\n      var text = before.text + after.text;\n      if (text.length > 0) {\n        deleteZwspChars(caretContainer);\n        return CaretPosition(caretContainer, pos.offset() - before.count);\n      } else {\n        return pos;\n      }\n    };\n    var removeElementAndReposition = function (caretContainer, pos) {\n      var parentNode = pos.container();\n      var newPosition = indexOf(from$1(parentNode.childNodes), caretContainer).map(function (index) {\n        return index < pos.offset() ? CaretPosition(parentNode, pos.offset() - 1) : pos;\n      }).getOr(pos);\n      remove$5(caretContainer);\n      return newPosition;\n    };\n    var removeTextCaretContainer = function (caretContainer, pos) {\n      return isText$6(caretContainer) && pos.container() === caretContainer ? removeTextAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n    };\n    var removeElementCaretContainer = function (caretContainer, pos) {\n      return pos.container() === caretContainer.parentNode ? removeElementAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n    };\n    var removeAndReposition = function (container, pos) {\n      return CaretPosition.isTextPosition(pos) ? removeTextCaretContainer(container, pos) : removeElementCaretContainer(container, pos);\n    };\n    var remove$5 = function (caretContainerNode) {\n      if (isElement$4(caretContainerNode) && isCaretContainer(caretContainerNode)) {\n        if (hasContent(caretContainerNode)) {\n          caretContainerNode.removeAttribute('data-mce-caret');\n        } else {\n          removeNode(caretContainerNode);\n        }\n      }\n      if (isText$6(caretContainerNode)) {\n        deleteZwspChars(caretContainerNode);\n        if (caretContainerNode.data.length === 0) {\n          removeNode(caretContainerNode);\n        }\n      }\n    };\n\n    var browser$2 = detect$3().browser;\n    var isContentEditableFalse$3 = isContentEditableFalse;\n    var isMedia$1 = isMedia;\n    var isTableCell$2 = isTableCell;\n    var inlineFakeCaretSelector = '*[contentEditable=false],video,audio,embed,object';\n    var getAbsoluteClientRect = function (root, element, before) {\n      var clientRect = collapse(element.getBoundingClientRect(), before);\n      var docElm, scrollX, scrollY, margin, rootRect;\n      if (root.tagName === 'BODY') {\n        docElm = root.ownerDocument.documentElement;\n        scrollX = root.scrollLeft || docElm.scrollLeft;\n        scrollY = root.scrollTop || docElm.scrollTop;\n      } else {\n        rootRect = root.getBoundingClientRect();\n        scrollX = root.scrollLeft - rootRect.left;\n        scrollY = root.scrollTop - rootRect.top;\n      }\n      clientRect.left += scrollX;\n      clientRect.right += scrollX;\n      clientRect.top += scrollY;\n      clientRect.bottom += scrollY;\n      clientRect.width = 1;\n      margin = element.offsetWidth - element.clientWidth;\n      if (margin > 0) {\n        if (before) {\n          margin *= -1;\n        }\n        clientRect.left += margin;\n        clientRect.right += margin;\n      }\n      return clientRect;\n    };\n    var trimInlineCaretContainers = function (root) {\n      var fakeCaretTargetNodes = descendants$1(SugarElement.fromDom(root), inlineFakeCaretSelector);\n      for (var i = 0; i < fakeCaretTargetNodes.length; i++) {\n        var node = fakeCaretTargetNodes[i].dom;\n        var sibling = node.previousSibling;\n        if (endsWithCaretContainer(sibling)) {\n          var data = sibling.data;\n          if (data.length === 1) {\n            sibling.parentNode.removeChild(sibling);\n          } else {\n            sibling.deleteData(data.length - 1, 1);\n          }\n        }\n        sibling = node.nextSibling;\n        if (startsWithCaretContainer(sibling)) {\n          var data = sibling.data;\n          if (data.length === 1) {\n            sibling.parentNode.removeChild(sibling);\n          } else {\n            sibling.deleteData(0, 1);\n          }\n        }\n      }\n    };\n    var FakeCaret = function (editor, root, isBlock, hasFocus) {\n      var lastVisualCaret = Cell(Optional.none());\n      var cursorInterval, caretContainerNode;\n      var rootBlock = getForcedRootBlock(editor);\n      var caretBlock = rootBlock.length > 0 ? rootBlock : 'p';\n      var show = function (before, element) {\n        var clientRect, rng;\n        hide();\n        if (isTableCell$2(element)) {\n          return null;\n        }\n        if (isBlock(element)) {\n          caretContainerNode = insertBlock(caretBlock, element, before);\n          clientRect = getAbsoluteClientRect(root, element, before);\n          DomQuery(caretContainerNode).css('top', clientRect.top);\n          var caret = DomQuery('<div class=\"mce-visual-caret\" data-mce-bogus=\"all\"></div>').css(clientRect).appendTo(root)[0];\n          lastVisualCaret.set(Optional.some({\n            caret: caret,\n            element: element,\n            before: before\n          }));\n          lastVisualCaret.get().each(function (caretState) {\n            if (before) {\n              DomQuery(caretState.caret).addClass('mce-visual-caret-before');\n            }\n          });\n          startBlink();\n          rng = element.ownerDocument.createRange();\n          rng.setStart(caretContainerNode, 0);\n          rng.setEnd(caretContainerNode, 0);\n        } else {\n          caretContainerNode = insertInline(element, before);\n          rng = element.ownerDocument.createRange();\n          if (isInlineFakeCaretTarget(caretContainerNode.nextSibling)) {\n            rng.setStart(caretContainerNode, 0);\n            rng.setEnd(caretContainerNode, 0);\n          } else {\n            rng.setStart(caretContainerNode, 1);\n            rng.setEnd(caretContainerNode, 1);\n          }\n          return rng;\n        }\n        return rng;\n      };\n      var hide = function () {\n        trimInlineCaretContainers(root);\n        if (caretContainerNode) {\n          remove$5(caretContainerNode);\n          caretContainerNode = null;\n        }\n        lastVisualCaret.get().each(function (caretState) {\n          DomQuery(caretState.caret).remove();\n          lastVisualCaret.set(Optional.none());\n        });\n        if (cursorInterval) {\n          Delay.clearInterval(cursorInterval);\n          cursorInterval = null;\n        }\n      };\n      var startBlink = function () {\n        cursorInterval = Delay.setInterval(function () {\n          if (hasFocus()) {\n            DomQuery('div.mce-visual-caret', root).toggleClass('mce-visual-caret-hidden');\n          } else {\n            DomQuery('div.mce-visual-caret', root).addClass('mce-visual-caret-hidden');\n          }\n        }, 500);\n      };\n      var reposition = function () {\n        lastVisualCaret.get().each(function (caretState) {\n          var clientRect = getAbsoluteClientRect(root, caretState.element, caretState.before);\n          DomQuery(caretState.caret).css(__assign({}, clientRect));\n        });\n      };\n      var destroy = function () {\n        return Delay.clearInterval(cursorInterval);\n      };\n      var getCss = function () {\n        return '.mce-visual-caret {' + 'position: absolute;' + 'background-color: black;' + 'background-color: currentcolor;' + '}' + '.mce-visual-caret-hidden {' + 'display: none;' + '}' + '*[data-mce-caret] {' + 'position: absolute;' + 'left: -1000px;' + 'right: auto;' + 'top: 0;' + 'margin: 0;' + 'padding: 0;' + '}';\n      };\n      return {\n        show: show,\n        hide: hide,\n        getCss: getCss,\n        reposition: reposition,\n        destroy: destroy\n      };\n    };\n    var isFakeCaretTableBrowser = function () {\n      return browser$2.isIE() || browser$2.isEdge() || browser$2.isFirefox();\n    };\n    var isInlineFakeCaretTarget = function (node) {\n      return isContentEditableFalse$3(node) || isMedia$1(node);\n    };\n    var isFakeCaretTarget = function (node) {\n      return isInlineFakeCaretTarget(node) || isTable(node) && isFakeCaretTableBrowser();\n    };\n\n    var isContentEditableFalse$4 = isContentEditableFalse;\n    var isMedia$2 = isMedia;\n    var isBlockLike = matchStyleValues('display', 'block table table-cell table-caption list-item');\n    var isCaretContainer$2 = isCaretContainer;\n    var isCaretContainerBlock$1 = isCaretContainerBlock;\n    var isElement$5 = isElement$1;\n    var isCaretCandidate$2 = isCaretCandidate;\n    var isForwards = function (direction) {\n      return direction > 0;\n    };\n    var isBackwards = function (direction) {\n      return direction < 0;\n    };\n    var skipCaretContainers = function (walk, shallow) {\n      var node;\n      while (node = walk(shallow)) {\n        if (!isCaretContainerBlock$1(node)) {\n          return node;\n        }\n      }\n      return null;\n    };\n    var findNode = function (node, direction, predicateFn, rootNode, shallow) {\n      var walker = new DomTreeWalker(node, rootNode);\n      var isCefOrCaretContainer = isContentEditableFalse$4(node) || isCaretContainerBlock$1(node);\n      if (isBackwards(direction)) {\n        if (isCefOrCaretContainer) {\n          node = skipCaretContainers(walker.prev.bind(walker), true);\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n        while (node = skipCaretContainers(walker.prev.bind(walker), shallow)) {\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n      }\n      if (isForwards(direction)) {\n        if (isCefOrCaretContainer) {\n          node = skipCaretContainers(walker.next.bind(walker), true);\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n        while (node = skipCaretContainers(walker.next.bind(walker), shallow)) {\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n      }\n      return null;\n    };\n    var getParentBlock = function (node, rootNode) {\n      while (node && node !== rootNode) {\n        if (isBlockLike(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var isInSameBlock = function (caretPosition1, caretPosition2, rootNode) {\n      return getParentBlock(caretPosition1.container(), rootNode) === getParentBlock(caretPosition2.container(), rootNode);\n    };\n    var getChildNodeAtRelativeOffset = function (relativeOffset, caretPosition) {\n      if (!caretPosition) {\n        return null;\n      }\n      var container = caretPosition.container();\n      var offset = caretPosition.offset();\n      if (!isElement$5(container)) {\n        return null;\n      }\n      return container.childNodes[offset + relativeOffset];\n    };\n    var beforeAfter = function (before, node) {\n      var range = node.ownerDocument.createRange();\n      if (before) {\n        range.setStartBefore(node);\n        range.setEndBefore(node);\n      } else {\n        range.setStartAfter(node);\n        range.setEndAfter(node);\n      }\n      return range;\n    };\n    var isNodesInSameBlock = function (root, node1, node2) {\n      return getParentBlock(node1, root) === getParentBlock(node2, root);\n    };\n    var lean = function (left, root, node) {\n      var sibling, siblingName;\n      if (left) {\n        siblingName = 'previousSibling';\n      } else {\n        siblingName = 'nextSibling';\n      }\n      while (node && node !== root) {\n        sibling = node[siblingName];\n        if (isCaretContainer$2(sibling)) {\n          sibling = sibling[siblingName];\n        }\n        if (isContentEditableFalse$4(sibling) || isMedia$2(sibling)) {\n          if (isNodesInSameBlock(root, sibling, node)) {\n            return sibling;\n          }\n          break;\n        }\n        if (isCaretCandidate$2(sibling)) {\n          break;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var before$2 = curry(beforeAfter, true);\n    var after$1 = curry(beforeAfter, false);\n    var normalizeRange = function (direction, root, range) {\n      var node, container, location;\n      var leanLeft = curry(lean, true, root);\n      var leanRight = curry(lean, false, root);\n      container = range.startContainer;\n      var offset = range.startOffset;\n      if (isCaretContainerBlock(container)) {\n        if (!isElement$5(container)) {\n          container = container.parentNode;\n        }\n        location = container.getAttribute('data-mce-caret');\n        if (location === 'before') {\n          node = container.nextSibling;\n          if (isFakeCaretTarget(node)) {\n            return before$2(node);\n          }\n        }\n        if (location === 'after') {\n          node = container.previousSibling;\n          if (isFakeCaretTarget(node)) {\n            return after$1(node);\n          }\n        }\n      }\n      if (!range.collapsed) {\n        return range;\n      }\n      if (isText$1(container)) {\n        if (isCaretContainer$2(container)) {\n          if (direction === 1) {\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n            node = leanLeft(container);\n            if (node) {\n              return after$1(node);\n            }\n          }\n          if (direction === -1) {\n            node = leanLeft(container);\n            if (node) {\n              return after$1(node);\n            }\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n          }\n          return range;\n        }\n        if (endsWithCaretContainer(container) && offset >= container.data.length - 1) {\n          if (direction === 1) {\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n          }\n          return range;\n        }\n        if (startsWithCaretContainer(container) && offset <= 1) {\n          if (direction === -1) {\n            node = leanLeft(container);\n            if (node) {\n              return after$1(node);\n            }\n          }\n          return range;\n        }\n        if (offset === container.data.length) {\n          node = leanRight(container);\n          if (node) {\n            return before$2(node);\n          }\n          return range;\n        }\n        if (offset === 0) {\n          node = leanLeft(container);\n          if (node) {\n            return after$1(node);\n          }\n          return range;\n        }\n      }\n      return range;\n    };\n    var getRelativeCefElm = function (forward, caretPosition) {\n      return Optional.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, caretPosition)).filter(isContentEditableFalse$4);\n    };\n    var getNormalizedRangeEndPoint = function (direction, root, range) {\n      var normalizedRange = normalizeRange(direction, root, range);\n      if (direction === -1) {\n        return CaretPosition.fromRangeStart(normalizedRange);\n      }\n      return CaretPosition.fromRangeEnd(normalizedRange);\n    };\n    var getElementFromPosition = function (pos) {\n      return Optional.from(pos.getNode()).map(SugarElement.fromDom);\n    };\n    var getElementFromPrevPosition = function (pos) {\n      return Optional.from(pos.getNode(true)).map(SugarElement.fromDom);\n    };\n    var getVisualCaretPosition = function (walkFn, caretPosition) {\n      while (caretPosition = walkFn(caretPosition)) {\n        if (caretPosition.isVisible()) {\n          return caretPosition;\n        }\n      }\n      return caretPosition;\n    };\n    var isMoveInsideSameBlock = function (from, to) {\n      var inSameBlock = isInSameBlock(from, to);\n      if (!inSameBlock && isBr(from.getNode())) {\n        return true;\n      }\n      return inSameBlock;\n    };\n\n    var HDirection;\n    (function (HDirection) {\n      HDirection[HDirection['Backwards'] = -1] = 'Backwards';\n      HDirection[HDirection['Forwards'] = 1] = 'Forwards';\n    }(HDirection || (HDirection = {})));\n    var isContentEditableFalse$5 = isContentEditableFalse;\n    var isText$7 = isText$1;\n    var isElement$6 = isElement$1;\n    var isBr$4 = isBr;\n    var isCaretCandidate$3 = isCaretCandidate;\n    var isAtomic$1 = isAtomic;\n    var isEditableCaretCandidate$1 = isEditableCaretCandidate;\n    var getParents = function (node, root) {\n      var parents = [];\n      while (node && node !== root) {\n        parents.push(node);\n        node = node.parentNode;\n      }\n      return parents;\n    };\n    var nodeAtIndex = function (container, offset) {\n      if (container.hasChildNodes() && offset < container.childNodes.length) {\n        return container.childNodes[offset];\n      }\n      return null;\n    };\n    var getCaretCandidatePosition = function (direction, node) {\n      if (isForwards(direction)) {\n        if (isCaretCandidate$3(node.previousSibling) && !isText$7(node.previousSibling)) {\n          return CaretPosition.before(node);\n        }\n        if (isText$7(node)) {\n          return CaretPosition(node, 0);\n        }\n      }\n      if (isBackwards(direction)) {\n        if (isCaretCandidate$3(node.nextSibling) && !isText$7(node.nextSibling)) {\n          return CaretPosition.after(node);\n        }\n        if (isText$7(node)) {\n          return CaretPosition(node, node.data.length);\n        }\n      }\n      if (isBackwards(direction)) {\n        if (isBr$4(node)) {\n          return CaretPosition.before(node);\n        }\n        return CaretPosition.after(node);\n      }\n      return CaretPosition.before(node);\n    };\n    var moveForwardFromBr = function (root, nextNode) {\n      var nextSibling = nextNode.nextSibling;\n      if (nextSibling && isCaretCandidate$3(nextSibling)) {\n        if (isText$7(nextSibling)) {\n          return CaretPosition(nextSibling, 0);\n        } else {\n          return CaretPosition.before(nextSibling);\n        }\n      } else {\n        return findCaretPosition(HDirection.Forwards, CaretPosition.after(nextNode), root);\n      }\n    };\n    var findCaretPosition = function (direction, startPos, root) {\n      var node, nextNode, innerNode;\n      var caretPosition;\n      if (!isElement$6(root) || !startPos) {\n        return null;\n      }\n      if (startPos.isEqual(CaretPosition.after(root)) && root.lastChild) {\n        caretPosition = CaretPosition.after(root.lastChild);\n        if (isBackwards(direction) && isCaretCandidate$3(root.lastChild) && isElement$6(root.lastChild)) {\n          return isBr$4(root.lastChild) ? CaretPosition.before(root.lastChild) : caretPosition;\n        }\n      } else {\n        caretPosition = startPos;\n      }\n      var container = caretPosition.container();\n      var offset = caretPosition.offset();\n      if (isText$7(container)) {\n        if (isBackwards(direction) && offset > 0) {\n          return CaretPosition(container, --offset);\n        }\n        if (isForwards(direction) && offset < container.length) {\n          return CaretPosition(container, ++offset);\n        }\n        node = container;\n      } else {\n        if (isBackwards(direction) && offset > 0) {\n          nextNode = nodeAtIndex(container, offset - 1);\n          if (isCaretCandidate$3(nextNode)) {\n            if (!isAtomic$1(nextNode)) {\n              innerNode = findNode(nextNode, direction, isEditableCaretCandidate$1, nextNode);\n              if (innerNode) {\n                if (isText$7(innerNode)) {\n                  return CaretPosition(innerNode, innerNode.data.length);\n                }\n                return CaretPosition.after(innerNode);\n              }\n            }\n            if (isText$7(nextNode)) {\n              return CaretPosition(nextNode, nextNode.data.length);\n            }\n            return CaretPosition.before(nextNode);\n          }\n        }\n        if (isForwards(direction) && offset < container.childNodes.length) {\n          nextNode = nodeAtIndex(container, offset);\n          if (isCaretCandidate$3(nextNode)) {\n            if (isBr$4(nextNode)) {\n              return moveForwardFromBr(root, nextNode);\n            }\n            if (!isAtomic$1(nextNode)) {\n              innerNode = findNode(nextNode, direction, isEditableCaretCandidate$1, nextNode);\n              if (innerNode) {\n                if (isText$7(innerNode)) {\n                  return CaretPosition(innerNode, 0);\n                }\n                return CaretPosition.before(innerNode);\n              }\n            }\n            if (isText$7(nextNode)) {\n              return CaretPosition(nextNode, 0);\n            }\n            return CaretPosition.after(nextNode);\n          }\n        }\n        node = nextNode ? nextNode : caretPosition.getNode();\n      }\n      if (isForwards(direction) && caretPosition.isAtEnd() || isBackwards(direction) && caretPosition.isAtStart()) {\n        node = findNode(node, direction, always, root, true);\n        if (isEditableCaretCandidate$1(node, root)) {\n          return getCaretCandidatePosition(direction, node);\n        }\n      }\n      nextNode = findNode(node, direction, isEditableCaretCandidate$1, root);\n      var rootContentEditableFalseElm = last$1(filter(getParents(container, root), isContentEditableFalse$5));\n      if (rootContentEditableFalseElm && (!nextNode || !rootContentEditableFalseElm.contains(nextNode))) {\n        if (isForwards(direction)) {\n          caretPosition = CaretPosition.after(rootContentEditableFalseElm);\n        } else {\n          caretPosition = CaretPosition.before(rootContentEditableFalseElm);\n        }\n        return caretPosition;\n      }\n      if (nextNode) {\n        return getCaretCandidatePosition(direction, nextNode);\n      }\n      return null;\n    };\n    var CaretWalker = function (root) {\n      return {\n        next: function (caretPosition) {\n          return findCaretPosition(HDirection.Forwards, caretPosition, root);\n        },\n        prev: function (caretPosition) {\n          return findCaretPosition(HDirection.Backwards, caretPosition, root);\n        }\n      };\n    };\n\n    var walkToPositionIn = function (forward, root, start) {\n      var position = forward ? CaretPosition.before(start) : CaretPosition.after(start);\n      return fromPosition(forward, root, position);\n    };\n    var afterElement = function (node) {\n      return isBr(node) ? CaretPosition.before(node) : CaretPosition.after(node);\n    };\n    var isBeforeOrStart = function (position) {\n      if (CaretPosition.isTextPosition(position)) {\n        return position.offset() === 0;\n      } else {\n        return isCaretCandidate(position.getNode());\n      }\n    };\n    var isAfterOrEnd = function (position) {\n      if (CaretPosition.isTextPosition(position)) {\n        var container = position.container();\n        return position.offset() === container.data.length;\n      } else {\n        return isCaretCandidate(position.getNode(true));\n      }\n    };\n    var isBeforeAfterSameElement = function (from, to) {\n      return !CaretPosition.isTextPosition(from) && !CaretPosition.isTextPosition(to) && from.getNode() === to.getNode(true);\n    };\n    var isAtBr = function (position) {\n      return !CaretPosition.isTextPosition(position) && isBr(position.getNode());\n    };\n    var shouldSkipPosition = function (forward, from, to) {\n      if (forward) {\n        return !isBeforeAfterSameElement(from, to) && !isAtBr(from) && isAfterOrEnd(from) && isBeforeOrStart(to);\n      } else {\n        return !isBeforeAfterSameElement(to, from) && isBeforeOrStart(from) && isAfterOrEnd(to);\n      }\n    };\n    var fromPosition = function (forward, root, pos) {\n      var walker = CaretWalker(root);\n      return Optional.from(forward ? walker.next(pos) : walker.prev(pos));\n    };\n    var navigate = function (forward, root, from) {\n      return fromPosition(forward, root, from).bind(function (to) {\n        if (isInSameBlock(from, to, root) && shouldSkipPosition(forward, from, to)) {\n          return fromPosition(forward, root, to);\n        } else {\n          return Optional.some(to);\n        }\n      });\n    };\n    var navigateIgnore = function (forward, root, from, ignoreFilter) {\n      return navigate(forward, root, from).bind(function (pos) {\n        return ignoreFilter(pos) ? navigateIgnore(forward, root, pos, ignoreFilter) : Optional.some(pos);\n      });\n    };\n    var positionIn = function (forward, element) {\n      var startNode = forward ? element.firstChild : element.lastChild;\n      if (isText$1(startNode)) {\n        return Optional.some(CaretPosition(startNode, forward ? 0 : startNode.data.length));\n      } else if (startNode) {\n        if (isCaretCandidate(startNode)) {\n          return Optional.some(forward ? CaretPosition.before(startNode) : afterElement(startNode));\n        } else {\n          return walkToPositionIn(forward, element, startNode);\n        }\n      } else {\n        return Optional.none();\n      }\n    };\n    var nextPosition = curry(fromPosition, true);\n    var prevPosition = curry(fromPosition, false);\n    var firstPositionIn = curry(positionIn, true);\n    var lastPositionIn = curry(positionIn, false);\n\n    var CARET_ID = '_mce_caret';\n    var isCaretNode = function (node) {\n      return isElement$1(node) && node.id === CARET_ID;\n    };\n    var getParentCaretContainer = function (body, node) {\n      while (node && node !== body) {\n        if (node.id === CARET_ID) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n\n    var isStringPathBookmark = function (bookmark) {\n      return isString(bookmark.start);\n    };\n    var isRangeBookmark = function (bookmark) {\n      return bookmark.hasOwnProperty('rng');\n    };\n    var isIdBookmark = function (bookmark) {\n      return bookmark.hasOwnProperty('id');\n    };\n    var isIndexBookmark = function (bookmark) {\n      return bookmark.hasOwnProperty('name');\n    };\n    var isPathBookmark = function (bookmark) {\n      return Tools.isArray(bookmark.start);\n    };\n\n    var addBogus = function (dom, node) {\n      if (isElement$1(node) && dom.isBlock(node) && !node.innerHTML && !Env.ie) {\n        node.innerHTML = '<br data-mce-bogus=\"1\" />';\n      }\n      return node;\n    };\n    var resolveCaretPositionBookmark = function (dom, bookmark) {\n      var pos;\n      var rng = dom.createRng();\n      pos = resolve$1(dom.getRoot(), bookmark.start);\n      rng.setStart(pos.container(), pos.offset());\n      pos = resolve$1(dom.getRoot(), bookmark.end);\n      rng.setEnd(pos.container(), pos.offset());\n      return rng;\n    };\n    var insertZwsp = function (node, rng) {\n      var textNode = node.ownerDocument.createTextNode(ZWSP);\n      node.appendChild(textNode);\n      rng.setStart(textNode, 0);\n      rng.setEnd(textNode, 0);\n    };\n    var isEmpty$1 = function (node) {\n      return node.hasChildNodes() === false;\n    };\n    var tryFindRangePosition = function (node, rng) {\n      return lastPositionIn(node).fold(never, function (pos) {\n        rng.setStart(pos.container(), pos.offset());\n        rng.setEnd(pos.container(), pos.offset());\n        return true;\n      });\n    };\n    var padEmptyCaretContainer = function (root, node, rng) {\n      if (isEmpty$1(node) && getParentCaretContainer(root, node)) {\n        insertZwsp(node, rng);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var setEndPoint = function (dom, start, bookmark, rng) {\n      var point = bookmark[start ? 'start' : 'end'];\n      var i, node, offset, children;\n      var root = dom.getRoot();\n      if (point) {\n        offset = point[0];\n        for (node = root, i = point.length - 1; i >= 1; i--) {\n          children = node.childNodes;\n          if (padEmptyCaretContainer(root, node, rng)) {\n            return true;\n          }\n          if (point[i] > children.length - 1) {\n            if (padEmptyCaretContainer(root, node, rng)) {\n              return true;\n            }\n            return tryFindRangePosition(node, rng);\n          }\n          node = children[point[i]];\n        }\n        if (node.nodeType === 3) {\n          offset = Math.min(point[0], node.nodeValue.length);\n        }\n        if (node.nodeType === 1) {\n          offset = Math.min(point[0], node.childNodes.length);\n        }\n        if (start) {\n          rng.setStart(node, offset);\n        } else {\n          rng.setEnd(node, offset);\n        }\n      }\n      return true;\n    };\n    var isValidTextNode = function (node) {\n      return isText$1(node) && node.data.length > 0;\n    };\n    var restoreEndPoint = function (dom, suffix, bookmark) {\n      var marker = dom.get(bookmark.id + '_' + suffix), node, idx, next, prev;\n      var keep = bookmark.keep;\n      var container, offset;\n      if (marker) {\n        node = marker.parentNode;\n        if (suffix === 'start') {\n          if (!keep) {\n            idx = dom.nodeIndex(marker);\n          } else {\n            if (marker.hasChildNodes()) {\n              node = marker.firstChild;\n              idx = 1;\n            } else if (isValidTextNode(marker.nextSibling)) {\n              node = marker.nextSibling;\n              idx = 0;\n            } else if (isValidTextNode(marker.previousSibling)) {\n              node = marker.previousSibling;\n              idx = marker.previousSibling.data.length;\n            } else {\n              node = marker.parentNode;\n              idx = dom.nodeIndex(marker) + 1;\n            }\n          }\n          container = node;\n          offset = idx;\n        } else {\n          if (!keep) {\n            idx = dom.nodeIndex(marker);\n          } else {\n            if (marker.hasChildNodes()) {\n              node = marker.firstChild;\n              idx = 1;\n            } else if (isValidTextNode(marker.previousSibling)) {\n              node = marker.previousSibling;\n              idx = marker.previousSibling.data.length;\n            } else {\n              node = marker.parentNode;\n              idx = dom.nodeIndex(marker);\n            }\n          }\n          container = node;\n          offset = idx;\n        }\n        if (!keep) {\n          prev = marker.previousSibling;\n          next = marker.nextSibling;\n          Tools.each(Tools.grep(marker.childNodes), function (node) {\n            if (isText$1(node)) {\n              node.nodeValue = node.nodeValue.replace(/\\uFEFF/g, '');\n            }\n          });\n          while (marker = dom.get(bookmark.id + '_' + suffix)) {\n            dom.remove(marker, true);\n          }\n          if (prev && next && prev.nodeType === next.nodeType && isText$1(prev) && !Env.opera) {\n            idx = prev.nodeValue.length;\n            prev.appendData(next.nodeValue);\n            dom.remove(next);\n            container = prev;\n            offset = idx;\n          }\n        }\n        return Optional.some(CaretPosition(container, offset));\n      } else {\n        return Optional.none();\n      }\n    };\n    var resolvePaths = function (dom, bookmark) {\n      var rng = dom.createRng();\n      if (setEndPoint(dom, true, bookmark, rng) && setEndPoint(dom, false, bookmark, rng)) {\n        return Optional.some(rng);\n      } else {\n        return Optional.none();\n      }\n    };\n    var resolveId = function (dom, bookmark) {\n      var startPos = restoreEndPoint(dom, 'start', bookmark);\n      var endPos = restoreEndPoint(dom, 'end', bookmark);\n      return lift2(startPos, endPos.or(startPos), function (spos, epos) {\n        var rng = dom.createRng();\n        rng.setStart(addBogus(dom, spos.container()), spos.offset());\n        rng.setEnd(addBogus(dom, epos.container()), epos.offset());\n        return rng;\n      });\n    };\n    var resolveIndex$1 = function (dom, bookmark) {\n      return Optional.from(dom.select(bookmark.name)[bookmark.index]).map(function (elm) {\n        var rng = dom.createRng();\n        rng.selectNode(elm);\n        return rng;\n      });\n    };\n    var resolve$2 = function (selection, bookmark) {\n      var dom = selection.dom;\n      if (bookmark) {\n        if (isPathBookmark(bookmark)) {\n          return resolvePaths(dom, bookmark);\n        } else if (isStringPathBookmark(bookmark)) {\n          return Optional.some(resolveCaretPositionBookmark(dom, bookmark));\n        } else if (isIdBookmark(bookmark)) {\n          return resolveId(dom, bookmark);\n        } else if (isIndexBookmark(bookmark)) {\n          return resolveIndex$1(dom, bookmark);\n        } else if (isRangeBookmark(bookmark)) {\n          return Optional.some(bookmark.rng);\n        }\n      }\n      return Optional.none();\n    };\n\n    var getBookmark$1 = function (selection, type, normalized) {\n      return getBookmark(selection, type, normalized);\n    };\n    var moveToBookmark = function (selection, bookmark) {\n      resolve$2(selection, bookmark).each(function (rng) {\n        selection.setRng(rng);\n      });\n    };\n    var isBookmarkNode$1 = function (node) {\n      return isElement$1(node) && node.tagName === 'SPAN' && node.getAttribute('data-mce-type') === 'bookmark';\n    };\n\n    var is$2 = function (expected) {\n      return function (actual) {\n        return expected === actual;\n      };\n    };\n    var isNbsp = is$2(nbsp);\n    var isWhiteSpace$1 = function (chr) {\n      return chr !== '' && ' \\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n    };\n    var isContent$1 = function (chr) {\n      return !isWhiteSpace$1(chr) && !isNbsp(chr);\n    };\n\n    var isNode = function (node) {\n      return !!node.nodeType;\n    };\n    var isInlineBlock = function (node) {\n      return node && /^(IMG)$/.test(node.nodeName);\n    };\n    var moveStart = function (dom, selection, rng) {\n      var offset = rng.startOffset;\n      var container = rng.startContainer, walker, node, nodes;\n      if (rng.startContainer === rng.endContainer) {\n        if (isInlineBlock(rng.startContainer.childNodes[rng.startOffset])) {\n          return;\n        }\n      }\n      if (container.nodeType === 1) {\n        nodes = container.childNodes;\n        if (offset < nodes.length) {\n          container = nodes[offset];\n          walker = new DomTreeWalker(container, dom.getParent(container, dom.isBlock));\n        } else {\n          container = nodes[nodes.length - 1];\n          walker = new DomTreeWalker(container, dom.getParent(container, dom.isBlock));\n          walker.next(true);\n        }\n        for (node = walker.current(); node; node = walker.next()) {\n          if (node.nodeType === 3 && !isWhiteSpaceNode(node)) {\n            rng.setStart(node, 0);\n            selection.setRng(rng);\n            return;\n          }\n        }\n      }\n    };\n    var getNonWhiteSpaceSibling = function (node, next, inc) {\n      if (node) {\n        var nextName = next ? 'nextSibling' : 'previousSibling';\n        for (node = inc ? node : node[nextName]; node; node = node[nextName]) {\n          if (node.nodeType === 1 || !isWhiteSpaceNode(node)) {\n            return node;\n          }\n        }\n      }\n    };\n    var isTextBlock$1 = function (editor, name) {\n      if (isNode(name)) {\n        name = name.nodeName;\n      }\n      return !!editor.schema.getTextBlockElements()[name.toLowerCase()];\n    };\n    var isValid = function (ed, parent, child) {\n      return ed.schema.isValidChild(parent, child);\n    };\n    var isWhiteSpaceNode = function (node, allowSpaces) {\n      if (allowSpaces === void 0) {\n        allowSpaces = false;\n      }\n      if (isNonNullable(node) && isText$1(node)) {\n        var data = allowSpaces ? node.data.replace(/ /g, '\\xA0') : node.data;\n        return isWhitespaceText(data);\n      } else {\n        return false;\n      }\n    };\n    var isEmptyTextNode = function (node) {\n      return isNonNullable(node) && isText$1(node) && node.length === 0;\n    };\n    var replaceVars = function (value, vars) {\n      if (typeof value !== 'string') {\n        value = value(vars);\n      } else if (vars) {\n        value = value.replace(/%(\\w+)/g, function (str, name) {\n          return vars[name] || str;\n        });\n      }\n      return value;\n    };\n    var isEq = function (str1, str2) {\n      str1 = str1 || '';\n      str2 = str2 || '';\n      str1 = '' + (str1.nodeName || str1);\n      str2 = '' + (str2.nodeName || str2);\n      return str1.toLowerCase() === str2.toLowerCase();\n    };\n    var normalizeStyleValue = function (dom, value, name) {\n      if (name === 'color' || name === 'backgroundColor') {\n        value = dom.toHex(value);\n      }\n      if (name === 'fontWeight' && value === 700) {\n        value = 'bold';\n      }\n      if (name === 'fontFamily') {\n        value = value.replace(/[\\'\\\"]/g, '').replace(/,\\s+/g, ',');\n      }\n      return '' + value;\n    };\n    var getStyle = function (dom, node, name) {\n      return normalizeStyleValue(dom, dom.getStyle(node, name), name);\n    };\n    var getTextDecoration = function (dom, node) {\n      var decoration;\n      dom.getParent(node, function (n) {\n        decoration = dom.getStyle(n, 'text-decoration');\n        return decoration && decoration !== 'none';\n      });\n      return decoration;\n    };\n    var getParents$1 = function (dom, node, selector) {\n      return dom.getParents(node, selector, dom.getRoot());\n    };\n    var isVariableFormatName = function (editor, formatName) {\n      var hasVariableValues = function (format) {\n        var isVariableValue = function (val) {\n          return val.length > 1 && val.charAt(0) === '%';\n        };\n        return exists([\n          'styles',\n          'attributes'\n        ], function (key) {\n          return get$1(format, key).exists(function (field) {\n            var fieldValues = isArray(field) ? field : values(field);\n            return exists(fieldValues, isVariableValue);\n          });\n        });\n      };\n      return exists(editor.formatter.get(formatName), hasVariableValues);\n    };\n    var areSimilarFormats = function (editor, formatName, otherFormatName) {\n      var validKeys = [\n        'inline',\n        'block',\n        'selector',\n        'attributes',\n        'styles',\n        'classes'\n      ];\n      var filterObj = function (format) {\n        return filter$1(format, function (_, key) {\n          return exists(validKeys, function (validKey) {\n            return validKey === key;\n          });\n        });\n      };\n      return exists(editor.formatter.get(formatName), function (fmt1) {\n        var filteredFmt1 = filterObj(fmt1);\n        return exists(editor.formatter.get(otherFormatName), function (fmt2) {\n          var filteredFmt2 = filterObj(fmt2);\n          return equal(filteredFmt1, filteredFmt2);\n        });\n      });\n    };\n    var isBlockFormat = function (format) {\n      return hasNonNullableKey(format, 'block');\n    };\n    var isSelectorFormat = function (format) {\n      return hasNonNullableKey(format, 'selector');\n    };\n    var isInlineFormat = function (format) {\n      return hasNonNullableKey(format, 'inline');\n    };\n\n    var isBookmarkNode$2 = isBookmarkNode$1;\n    var getParents$2 = getParents$1;\n    var isWhiteSpaceNode$1 = isWhiteSpaceNode;\n    var isTextBlock$2 = isTextBlock$1;\n    var isBogusBr = function (node) {\n      return isBr(node) && node.getAttribute('data-mce-bogus') && !node.nextSibling;\n    };\n    var findParentContentEditable = function (dom, node) {\n      var parent = node;\n      while (parent) {\n        if (isElement$1(parent) && dom.getContentEditable(parent)) {\n          return dom.getContentEditable(parent) === 'false' ? parent : node;\n        }\n        parent = parent.parentNode;\n      }\n      return node;\n    };\n    var walkText = function (start, node, offset, predicate) {\n      var str = node.data;\n      for (var i = offset; start ? i >= 0 : i < str.length; start ? i-- : i++) {\n        if (predicate(str.charAt(i))) {\n          return start ? i + 1 : i;\n        }\n      }\n      return -1;\n    };\n    var findSpace = function (start, node, offset) {\n      return walkText(start, node, offset, function (c) {\n        return isNbsp(c) || isWhiteSpace$1(c);\n      });\n    };\n    var findContent = function (start, node, offset) {\n      return walkText(start, node, offset, isContent$1);\n    };\n    var findWordEndPoint = function (dom, body, container, offset, start, includeTrailingSpaces) {\n      var lastTextNode;\n      var rootNode = dom.getParent(container, dom.isBlock) || body;\n      var walk = function (container, offset, pred) {\n        var textSeeker = TextSeeker(dom);\n        var walker = start ? textSeeker.backwards : textSeeker.forwards;\n        return Optional.from(walker(container, offset, function (text, textOffset) {\n          if (isBookmarkNode$2(text.parentNode)) {\n            return -1;\n          } else {\n            lastTextNode = text;\n            return pred(start, text, textOffset);\n          }\n        }, rootNode));\n      };\n      var spaceResult = walk(container, offset, findSpace);\n      return spaceResult.bind(function (result) {\n        return includeTrailingSpaces ? walk(result.container, result.offset + (start ? -1 : 0), findContent) : Optional.some(result);\n      }).orThunk(function () {\n        return lastTextNode ? Optional.some({\n          container: lastTextNode,\n          offset: start ? 0 : lastTextNode.length\n        }) : Optional.none();\n      });\n    };\n    var findSelectorEndPoint = function (dom, format, rng, container, siblingName) {\n      if (isText$1(container) && container.nodeValue.length === 0 && container[siblingName]) {\n        container = container[siblingName];\n      }\n      var parents = getParents$2(dom, container);\n      for (var i = 0; i < parents.length; i++) {\n        for (var y = 0; y < format.length; y++) {\n          var curFormat = format[y];\n          if ('collapsed' in curFormat && curFormat.collapsed !== rng.collapsed) {\n            continue;\n          }\n          if (dom.is(parents[i], curFormat.selector)) {\n            return parents[i];\n          }\n        }\n      }\n      return container;\n    };\n    var findBlockEndPoint = function (editor, format, container, siblingName) {\n      var node;\n      var dom = editor.dom;\n      var root = dom.getRoot();\n      if (!format[0].wrapper) {\n        node = dom.getParent(container, format[0].block, root);\n      }\n      if (!node) {\n        var scopeRoot = dom.getParent(container, 'LI,TD,TH');\n        node = dom.getParent(isText$1(container) ? container.parentNode : container, function (node) {\n          return node !== root && isTextBlock$2(editor, node);\n        }, scopeRoot);\n      }\n      if (node && format[0].wrapper) {\n        node = getParents$2(dom, node, 'ul,ol').reverse()[0] || node;\n      }\n      if (!node) {\n        node = container;\n        while (node[siblingName] && !dom.isBlock(node[siblingName])) {\n          node = node[siblingName];\n          if (isEq(node, 'br')) {\n            break;\n          }\n        }\n      }\n      return node || container;\n    };\n    var isAtBlockBoundary = function (dom, root, container, siblingName) {\n      var parent = container.parentNode;\n      if (isNonNullable(container[siblingName])) {\n        return false;\n      } else if (parent === root || isNullable(parent) || dom.isBlock(parent)) {\n        return true;\n      } else {\n        return isAtBlockBoundary(dom, root, parent, siblingName);\n      }\n    };\n    var findParentContainer = function (dom, format, container, offset, start) {\n      var parent = container;\n      var sibling;\n      var siblingName = start ? 'previousSibling' : 'nextSibling';\n      var root = dom.getRoot();\n      if (isText$1(container) && !isWhiteSpaceNode$1(container)) {\n        if (start ? offset > 0 : offset < container.data.length) {\n          return container;\n        }\n      }\n      while (true) {\n        if (!format[0].block_expand && dom.isBlock(parent)) {\n          return parent;\n        }\n        for (sibling = parent[siblingName]; sibling; sibling = sibling[siblingName]) {\n          var allowSpaces = isText$1(sibling) && !isAtBlockBoundary(dom, root, sibling, siblingName);\n          if (!isBookmarkNode$2(sibling) && !isBogusBr(sibling) && !isWhiteSpaceNode$1(sibling, allowSpaces)) {\n            return parent;\n          }\n        }\n        if (parent === root || parent.parentNode === root) {\n          container = parent;\n          break;\n        }\n        parent = parent.parentNode;\n      }\n      return container;\n    };\n    var isSelfOrParentBookmark = function (container) {\n      return isBookmarkNode$2(container.parentNode) || isBookmarkNode$2(container);\n    };\n    var expandRng = function (editor, rng, format, includeTrailingSpace) {\n      if (includeTrailingSpace === void 0) {\n        includeTrailingSpace = false;\n      }\n      var startContainer = rng.startContainer, startOffset = rng.startOffset, endContainer = rng.endContainer, endOffset = rng.endOffset;\n      var dom = editor.dom;\n      if (isElement$1(startContainer) && startContainer.hasChildNodes()) {\n        startContainer = getNode(startContainer, startOffset);\n        if (isText$1(startContainer)) {\n          startOffset = 0;\n        }\n      }\n      if (isElement$1(endContainer) && endContainer.hasChildNodes()) {\n        endContainer = getNode(endContainer, rng.collapsed ? endOffset : endOffset - 1);\n        if (isText$1(endContainer)) {\n          endOffset = endContainer.nodeValue.length;\n        }\n      }\n      startContainer = findParentContentEditable(dom, startContainer);\n      endContainer = findParentContentEditable(dom, endContainer);\n      if (isSelfOrParentBookmark(startContainer)) {\n        startContainer = isBookmarkNode$2(startContainer) ? startContainer : startContainer.parentNode;\n        if (rng.collapsed) {\n          startContainer = startContainer.previousSibling || startContainer;\n        } else {\n          startContainer = startContainer.nextSibling || startContainer;\n        }\n        if (isText$1(startContainer)) {\n          startOffset = rng.collapsed ? startContainer.length : 0;\n        }\n      }\n      if (isSelfOrParentBookmark(endContainer)) {\n        endContainer = isBookmarkNode$2(endContainer) ? endContainer : endContainer.parentNode;\n        if (rng.collapsed) {\n          endContainer = endContainer.nextSibling || endContainer;\n        } else {\n          endContainer = endContainer.previousSibling || endContainer;\n        }\n        if (isText$1(endContainer)) {\n          endOffset = rng.collapsed ? 0 : endContainer.length;\n        }\n      }\n      if (rng.collapsed) {\n        var startPoint = findWordEndPoint(dom, editor.getBody(), startContainer, startOffset, true, includeTrailingSpace);\n        startPoint.each(function (_a) {\n          var container = _a.container, offset = _a.offset;\n          startContainer = container;\n          startOffset = offset;\n        });\n        var endPoint = findWordEndPoint(dom, editor.getBody(), endContainer, endOffset, false, includeTrailingSpace);\n        endPoint.each(function (_a) {\n          var container = _a.container, offset = _a.offset;\n          endContainer = container;\n          endOffset = offset;\n        });\n      }\n      if (format[0].inline || format[0].block_expand) {\n        if (!format[0].inline || (!isText$1(startContainer) || startOffset === 0)) {\n          startContainer = findParentContainer(dom, format, startContainer, startOffset, true);\n        }\n        if (!format[0].inline || (!isText$1(endContainer) || endOffset === endContainer.nodeValue.length)) {\n          endContainer = findParentContainer(dom, format, endContainer, endOffset, false);\n        }\n      }\n      if (format[0].selector && format[0].expand !== false && !format[0].inline) {\n        startContainer = findSelectorEndPoint(dom, format, rng, startContainer, 'previousSibling');\n        endContainer = findSelectorEndPoint(dom, format, rng, endContainer, 'nextSibling');\n      }\n      if (format[0].block || format[0].selector) {\n        startContainer = findBlockEndPoint(editor, format, startContainer, 'previousSibling');\n        endContainer = findBlockEndPoint(editor, format, endContainer, 'nextSibling');\n        if (format[0].block) {\n          if (!dom.isBlock(startContainer)) {\n            startContainer = findParentContainer(dom, format, startContainer, startOffset, true);\n          }\n          if (!dom.isBlock(endContainer)) {\n            endContainer = findParentContainer(dom, format, endContainer, endOffset, false);\n          }\n        }\n      }\n      if (isElement$1(startContainer)) {\n        startOffset = dom.nodeIndex(startContainer);\n        startContainer = startContainer.parentNode;\n      }\n      if (isElement$1(endContainer)) {\n        endOffset = dom.nodeIndex(endContainer) + 1;\n        endContainer = endContainer.parentNode;\n      }\n      return {\n        startContainer: startContainer,\n        startOffset: startOffset,\n        endContainer: endContainer,\n        endOffset: endOffset\n      };\n    };\n\n    var clampToExistingChildren = function (container, index) {\n      var childNodes = container.childNodes;\n      if (index >= childNodes.length) {\n        index = childNodes.length - 1;\n      } else if (index < 0) {\n        index = 0;\n      }\n      return childNodes[index] || container;\n    };\n    var getEndChild = function (container, index) {\n      return clampToExistingChildren(container, index - 1);\n    };\n    var walk$1 = function (dom, rng, callback) {\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n      var exclude = function (nodes) {\n        var node;\n        node = nodes[0];\n        if (node.nodeType === 3 && node === startContainer && startOffset >= node.nodeValue.length) {\n          nodes.splice(0, 1);\n        }\n        node = nodes[nodes.length - 1];\n        if (endOffset === 0 && nodes.length > 0 && node === endContainer && node.nodeType === 3) {\n          nodes.splice(nodes.length - 1, 1);\n        }\n        return nodes;\n      };\n      var collectSiblings = function (node, name, endNode) {\n        var siblings = [];\n        for (; node && node !== endNode; node = node[name]) {\n          siblings.push(node);\n        }\n        return siblings;\n      };\n      var findEndPoint = function (node, root) {\n        do {\n          if (node.parentNode === root) {\n            return node;\n          }\n          node = node.parentNode;\n        } while (node);\n      };\n      var walkBoundary = function (startNode, endNode, next) {\n        var siblingName = next ? 'nextSibling' : 'previousSibling';\n        for (var node = startNode, parent_1 = node.parentNode; node && node !== endNode; node = parent_1) {\n          parent_1 = node.parentNode;\n          var siblings_1 = collectSiblings(node === startNode ? node : node[siblingName], siblingName);\n          if (siblings_1.length) {\n            if (!next) {\n              siblings_1.reverse();\n            }\n            callback(exclude(siblings_1));\n          }\n        }\n      };\n      if (startContainer.nodeType === 1 && startContainer.hasChildNodes()) {\n        startContainer = clampToExistingChildren(startContainer, startOffset);\n      }\n      if (endContainer.nodeType === 1 && endContainer.hasChildNodes()) {\n        endContainer = getEndChild(endContainer, endOffset);\n      }\n      if (startContainer === endContainer) {\n        return callback(exclude([startContainer]));\n      }\n      var ancestor = dom.findCommonAncestor(startContainer, endContainer);\n      for (var node = startContainer; node; node = node.parentNode) {\n        if (node === endContainer) {\n          return walkBoundary(startContainer, ancestor, true);\n        }\n        if (node === ancestor) {\n          break;\n        }\n      }\n      for (var node = endContainer; node; node = node.parentNode) {\n        if (node === startContainer) {\n          return walkBoundary(endContainer, ancestor);\n        }\n        if (node === ancestor) {\n          break;\n        }\n      }\n      var startPoint = findEndPoint(startContainer, ancestor) || startContainer;\n      var endPoint = findEndPoint(endContainer, ancestor) || endContainer;\n      walkBoundary(startContainer, startPoint, true);\n      var siblings = collectSiblings(startPoint === startContainer ? startPoint : startPoint.nextSibling, 'nextSibling', endPoint === endContainer ? endPoint.nextSibling : endPoint);\n      if (siblings.length) {\n        callback(exclude(siblings));\n      }\n      walkBoundary(endContainer, endPoint);\n    };\n\n    var getRanges = function (selection) {\n      var ranges = [];\n      if (selection) {\n        for (var i = 0; i < selection.rangeCount; i++) {\n          ranges.push(selection.getRangeAt(i));\n        }\n      }\n      return ranges;\n    };\n    var getSelectedNodes = function (ranges) {\n      return bind(ranges, function (range) {\n        var node = getSelectedNode(range);\n        return node ? [SugarElement.fromDom(node)] : [];\n      });\n    };\n    var hasMultipleRanges = function (selection) {\n      return getRanges(selection).length > 1;\n    };\n\n    var getCellsFromRanges = function (ranges) {\n      return filter(getSelectedNodes(ranges), isTableCell$1);\n    };\n    var getCellsFromElement = function (elm) {\n      return descendants$1(elm, 'td[data-mce-selected],th[data-mce-selected]');\n    };\n    var getCellsFromElementOrRanges = function (ranges, element) {\n      var selectedCells = getCellsFromElement(element);\n      return selectedCells.length > 0 ? selectedCells : getCellsFromRanges(ranges);\n    };\n    var getCellsFromEditor = function (editor) {\n      return getCellsFromElementOrRanges(getRanges(editor.selection.getSel()), SugarElement.fromDom(editor.getBody()));\n    };\n\n    var getStartNode = function (rng) {\n      var sc = rng.startContainer, so = rng.startOffset;\n      if (isText$1(sc)) {\n        return so === 0 ? Optional.some(SugarElement.fromDom(sc)) : Optional.none();\n      } else {\n        return Optional.from(sc.childNodes[so]).map(SugarElement.fromDom);\n      }\n    };\n    var getEndNode = function (rng) {\n      var ec = rng.endContainer, eo = rng.endOffset;\n      if (isText$1(ec)) {\n        return eo === ec.data.length ? Optional.some(SugarElement.fromDom(ec)) : Optional.none();\n      } else {\n        return Optional.from(ec.childNodes[eo - 1]).map(SugarElement.fromDom);\n      }\n    };\n    var getFirstChildren = function (node) {\n      return firstChild(node).fold(constant([node]), function (child) {\n        return [node].concat(getFirstChildren(child));\n      });\n    };\n    var getLastChildren = function (node) {\n      return lastChild(node).fold(constant([node]), function (child) {\n        if (name(child) === 'br') {\n          return prevSibling(child).map(function (sibling) {\n            return [node].concat(getLastChildren(sibling));\n          }).getOr([]);\n        } else {\n          return [node].concat(getLastChildren(child));\n        }\n      });\n    };\n    var hasAllContentsSelected = function (elm, rng) {\n      return lift2(getStartNode(rng), getEndNode(rng), function (startNode, endNode) {\n        var start = find(getFirstChildren(elm), curry(eq$2, startNode));\n        var end = find(getLastChildren(elm), curry(eq$2, endNode));\n        return start.isSome() && end.isSome();\n      }).getOr(false);\n    };\n    var moveEndPoint$1 = function (dom, rng, node, start) {\n      var root = node, walker = new DomTreeWalker(node, root);\n      var moveCaretBeforeOnEnterElementsMap = filter$1(dom.schema.getMoveCaretBeforeOnEnterElements(), function (_, name) {\n        return !contains([\n          'td',\n          'th',\n          'table'\n        ], name.toLowerCase());\n      });\n      do {\n        if (isText$1(node) && Tools.trim(node.nodeValue).length !== 0) {\n          if (start) {\n            rng.setStart(node, 0);\n          } else {\n            rng.setEnd(node, node.nodeValue.length);\n          }\n          return;\n        }\n        if (moveCaretBeforeOnEnterElementsMap[node.nodeName]) {\n          if (start) {\n            rng.setStartBefore(node);\n          } else {\n            if (node.nodeName === 'BR') {\n              rng.setEndBefore(node);\n            } else {\n              rng.setEndAfter(node);\n            }\n          }\n          return;\n        }\n      } while (node = start ? walker.next() : walker.prev());\n      if (root.nodeName === 'BODY') {\n        if (start) {\n          rng.setStart(root, 0);\n        } else {\n          rng.setEnd(root, root.childNodes.length);\n        }\n      }\n    };\n    var hasAnyRanges = function (editor) {\n      var sel = editor.selection.getSel();\n      return sel && sel.rangeCount > 0;\n    };\n    var runOnRanges = function (editor, executor) {\n      var fakeSelectionNodes = getCellsFromEditor(editor);\n      if (fakeSelectionNodes.length > 0) {\n        each(fakeSelectionNodes, function (elem) {\n          var node = elem.dom;\n          var fakeNodeRng = editor.dom.createRng();\n          fakeNodeRng.setStartBefore(node);\n          fakeNodeRng.setEndAfter(node);\n          executor(fakeNodeRng, true);\n        });\n      } else {\n        executor(editor.selection.getRng(), false);\n      }\n    };\n    var preserve = function (selection, fillBookmark, executor) {\n      var bookmark = getPersistentBookmark(selection, fillBookmark);\n      executor(bookmark);\n      selection.moveToBookmark(bookmark);\n    };\n\n    var NodeValue = function (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom.nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    };\n\n    var api = NodeValue(isText, 'text');\n    var get$8 = function (element) {\n      return api.get(element);\n    };\n\n    var isZeroWidth = function (elem) {\n      return isText(elem) && get$8(elem) === ZWSP;\n    };\n    var context = function (editor, elem, wrapName, nodeName) {\n      return parent(elem).fold(function () {\n        return 'skipping';\n      }, function (parent) {\n        if (nodeName === 'br' || isZeroWidth(elem)) {\n          return 'valid';\n        } else if (isAnnotation(elem)) {\n          return 'existing';\n        } else if (isCaretNode(elem.dom)) {\n          return 'caret';\n        } else if (!isValid(editor, wrapName, nodeName) || !isValid(editor, name(parent), wrapName)) {\n          return 'invalid-child';\n        } else {\n          return 'valid';\n        }\n      });\n    };\n\n    var applyWordGrab = function (editor, rng) {\n      var r = expandRng(editor, rng, [{ inline: true }]);\n      rng.setStart(r.startContainer, r.startOffset);\n      rng.setEnd(r.endContainer, r.endOffset);\n      editor.selection.setRng(rng);\n    };\n    var makeAnnotation = function (eDoc, _a, annotationName, decorate) {\n      var _b = _a.uid, uid = _b === void 0 ? generate$1('mce-annotation') : _b, data = __rest(_a, ['uid']);\n      var master = SugarElement.fromTag('span', eDoc);\n      add$3(master, annotation());\n      set(master, '' + dataAnnotationId(), uid);\n      set(master, '' + dataAnnotation(), annotationName);\n      var _c = decorate(uid, data), _d = _c.attributes, attributes = _d === void 0 ? {} : _d, _e = _c.classes, classes = _e === void 0 ? [] : _e;\n      setAll(master, attributes);\n      add$4(master, classes);\n      return master;\n    };\n    var annotate = function (editor, rng, annotationName, decorate, data) {\n      var newWrappers = [];\n      var master = makeAnnotation(editor.getDoc(), data, annotationName, decorate);\n      var wrapper = Cell(Optional.none());\n      var finishWrapper = function () {\n        wrapper.set(Optional.none());\n      };\n      var getOrOpenWrapper = function () {\n        return wrapper.get().getOrThunk(function () {\n          var nu = shallow(master);\n          newWrappers.push(nu);\n          wrapper.set(Optional.some(nu));\n          return nu;\n        });\n      };\n      var processElements = function (elems) {\n        each(elems, processElement);\n      };\n      var processElement = function (elem) {\n        var ctx = context(editor, elem, 'span', name(elem));\n        switch (ctx) {\n        case 'invalid-child': {\n            finishWrapper();\n            var children$1 = children(elem);\n            processElements(children$1);\n            finishWrapper();\n            break;\n          }\n        case 'valid': {\n            var w = getOrOpenWrapper();\n            wrap(elem, w);\n            break;\n          }\n        }\n      };\n      var processNodes = function (nodes) {\n        var elems = map(nodes, SugarElement.fromDom);\n        processElements(elems);\n      };\n      walk$1(editor.dom, rng, function (nodes) {\n        finishWrapper();\n        processNodes(nodes);\n      });\n      return newWrappers;\n    };\n    var annotateWithBookmark = function (editor, name, settings, data) {\n      editor.undoManager.transact(function () {\n        var selection = editor.selection;\n        var initialRng = selection.getRng();\n        var hasFakeSelection = getCellsFromEditor(editor).length > 0;\n        if (initialRng.collapsed && !hasFakeSelection) {\n          applyWordGrab(editor, initialRng);\n        }\n        if (selection.getRng().collapsed && !hasFakeSelection) {\n          var wrapper = makeAnnotation(editor.getDoc(), data, name, settings.decorate);\n          set$1(wrapper, nbsp);\n          selection.getRng().insertNode(wrapper.dom);\n          selection.select(wrapper.dom);\n        } else {\n          preserve(selection, false, function () {\n            runOnRanges(editor, function (selectionRng) {\n              annotate(editor, selectionRng, name, settings.decorate, data);\n            });\n          });\n        }\n      });\n    };\n\n    var Annotator = function (editor) {\n      var registry = create$2();\n      setup$1(editor, registry);\n      var changes = setup(editor);\n      return {\n        register: function (name, settings) {\n          registry.register(name, settings);\n        },\n        annotate: function (name, data) {\n          registry.lookup(name).each(function (settings) {\n            annotateWithBookmark(editor, name, settings, data);\n          });\n        },\n        annotationChanged: function (name, callback) {\n          changes.addListener(name, callback);\n        },\n        remove: function (name) {\n          identify(editor, Optional.some(name)).each(function (_a) {\n            var elements = _a.elements;\n            each(elements, unwrap);\n          });\n        },\n        getAll: function (name) {\n          var directory = findAll(editor, name);\n          return map$1(directory, function (elems) {\n            return map(elems, function (elem) {\n              return elem.dom;\n            });\n          });\n        }\n      };\n    };\n\n    var BookmarkManager = function (selection) {\n      return {\n        getBookmark: curry(getBookmark$1, selection),\n        moveToBookmark: curry(moveToBookmark, selection)\n      };\n    };\n    BookmarkManager.isBookmarkNode = isBookmarkNode$1;\n\n    var getContentEditableRoot = function (root, node) {\n      while (node && node !== root) {\n        if (isContentEditableTrue(node) || isContentEditableFalse(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n\n    var isXYWithinRange = function (clientX, clientY, range) {\n      if (range.collapsed) {\n        return false;\n      }\n      if (Env.browser.isIE() && range.startOffset === range.endOffset - 1 && range.startContainer === range.endContainer) {\n        var elm = range.startContainer.childNodes[range.startOffset];\n        if (isElement$1(elm)) {\n          return exists(elm.getClientRects(), function (rect) {\n            return containsXY(rect, clientX, clientY);\n          });\n        }\n      }\n      return exists(range.getClientRects(), function (rect) {\n        return containsXY(rect, clientX, clientY);\n      });\n    };\n\n    var firePreProcess = function (editor, args) {\n      return editor.fire('PreProcess', args);\n    };\n    var firePostProcess = function (editor, args) {\n      return editor.fire('PostProcess', args);\n    };\n    var fireRemove = function (editor) {\n      return editor.fire('remove');\n    };\n    var fireDetach = function (editor) {\n      return editor.fire('detach');\n    };\n    var fireSwitchMode = function (editor, mode) {\n      return editor.fire('SwitchMode', { mode: mode });\n    };\n    var fireObjectResizeStart = function (editor, target, width, height, origin) {\n      editor.fire('ObjectResizeStart', {\n        target: target,\n        width: width,\n        height: height,\n        origin: origin\n      });\n    };\n    var fireObjectResized = function (editor, target, width, height, origin) {\n      editor.fire('ObjectResized', {\n        target: target,\n        width: width,\n        height: height,\n        origin: origin\n      });\n    };\n    var firePreInit = function (editor) {\n      return editor.fire('PreInit');\n    };\n    var firePostRender = function (editor) {\n      return editor.fire('PostRender');\n    };\n    var fireInit = function (editor) {\n      return editor.fire('Init');\n    };\n    var firePlaceholderToggle = function (editor, state) {\n      return editor.fire('PlaceholderToggle', { state: state });\n    };\n    var fireError = function (editor, errorType, error) {\n      return editor.fire(errorType, error);\n    };\n\n    var VK = {\n      BACKSPACE: 8,\n      DELETE: 46,\n      DOWN: 40,\n      ENTER: 13,\n      LEFT: 37,\n      RIGHT: 39,\n      SPACEBAR: 32,\n      TAB: 9,\n      UP: 38,\n      END: 35,\n      HOME: 36,\n      modifierPressed: function (e) {\n        return e.shiftKey || e.ctrlKey || e.altKey || VK.metaKeyPressed(e);\n      },\n      metaKeyPressed: function (e) {\n        return Env.mac ? e.metaKey : e.ctrlKey && !e.altKey;\n      }\n    };\n\n    var isContentEditableFalse$6 = isContentEditableFalse;\n    var ControlSelection = function (selection, editor) {\n      var elementSelectionAttr = 'data-mce-selected';\n      var dom = editor.dom, each$2 = Tools.each;\n      var selectedElm, selectedElmGhost, resizeHelper, selectedHandle, resizeBackdrop;\n      var startX, startY, selectedElmX, selectedElmY, startW, startH, ratio, resizeStarted;\n      var width, height;\n      var editableDoc = editor.getDoc(), rootDocument = document;\n      var abs = Math.abs, round = Math.round, rootElement = editor.getBody();\n      var startScrollWidth, startScrollHeight;\n      var resizeHandles = {\n        nw: [\n          0,\n          0,\n          -1,\n          -1\n        ],\n        ne: [\n          1,\n          0,\n          1,\n          -1\n        ],\n        se: [\n          1,\n          1,\n          1,\n          1\n        ],\n        sw: [\n          0,\n          1,\n          -1,\n          1\n        ]\n      };\n      var isImage = function (elm) {\n        return elm && (elm.nodeName === 'IMG' || editor.dom.is(elm, 'figure.image'));\n      };\n      var isMedia$1 = function (elm) {\n        return isMedia(elm) || dom.hasClass(elm, 'mce-preview-object');\n      };\n      var isEventOnImageOutsideRange = function (evt, range) {\n        if (evt.type === 'longpress' || evt.type.indexOf('touch') === 0) {\n          var touch = evt.touches[0];\n          return isImage(evt.target) && !isXYWithinRange(touch.clientX, touch.clientY, range);\n        } else {\n          return isImage(evt.target) && !isXYWithinRange(evt.clientX, evt.clientY, range);\n        }\n      };\n      var contextMenuSelectImage = function (evt) {\n        var target = evt.target;\n        if (isEventOnImageOutsideRange(evt, editor.selection.getRng()) && !evt.isDefaultPrevented()) {\n          editor.selection.select(target);\n        }\n      };\n      var getResizeTargets = function (elm) {\n        if (dom.is(elm, 'figure.image')) {\n          return [elm.querySelector('img')];\n        } else if (dom.hasClass(elm, 'mce-preview-object') && isNonNullable(elm.firstElementChild)) {\n          return [\n            elm,\n            elm.firstElementChild\n          ];\n        } else {\n          return [elm];\n        }\n      };\n      var isResizable = function (elm) {\n        var selector = getObjectResizing(editor);\n        if (!selector) {\n          return false;\n        }\n        if (elm.getAttribute('data-mce-resize') === 'false') {\n          return false;\n        }\n        if (elm === editor.getBody()) {\n          return false;\n        }\n        if (dom.hasClass(elm, 'mce-preview-object')) {\n          return is$1(SugarElement.fromDom(elm.firstElementChild), selector);\n        } else {\n          return is$1(SugarElement.fromDom(elm), selector);\n        }\n      };\n      var createGhostElement = function (elm) {\n        if (isMedia$1(elm)) {\n          return dom.create('img', { src: Env.transparentSrc });\n        } else {\n          return elm.cloneNode(true);\n        }\n      };\n      var setSizeProp = function (element, name, value) {\n        if (isNonNullable(value)) {\n          var targets = getResizeTargets(element);\n          each(targets, function (target) {\n            if (target.style[name] || !editor.schema.isValid(target.nodeName.toLowerCase(), name)) {\n              dom.setStyle(target, name, value);\n            } else {\n              dom.setAttrib(target, name, '' + value);\n            }\n          });\n        }\n      };\n      var setGhostElmSize = function (ghostElm, width, height) {\n        setSizeProp(ghostElm, 'width', width);\n        setSizeProp(ghostElm, 'height', height);\n      };\n      var resizeGhostElement = function (e) {\n        var deltaX, deltaY, proportional;\n        var resizeHelperX, resizeHelperY;\n        deltaX = e.screenX - startX;\n        deltaY = e.screenY - startY;\n        width = deltaX * selectedHandle[2] + startW;\n        height = deltaY * selectedHandle[3] + startH;\n        width = width < 5 ? 5 : width;\n        height = height < 5 ? 5 : height;\n        if ((isImage(selectedElm) || isMedia$1(selectedElm)) && getResizeImgProportional(editor) !== false) {\n          proportional = !VK.modifierPressed(e);\n        } else {\n          proportional = VK.modifierPressed(e);\n        }\n        if (proportional) {\n          if (abs(deltaX) > abs(deltaY)) {\n            height = round(width * ratio);\n            width = round(height / ratio);\n          } else {\n            width = round(height / ratio);\n            height = round(width * ratio);\n          }\n        }\n        setGhostElmSize(selectedElmGhost, width, height);\n        resizeHelperX = selectedHandle.startPos.x + deltaX;\n        resizeHelperY = selectedHandle.startPos.y + deltaY;\n        resizeHelperX = resizeHelperX > 0 ? resizeHelperX : 0;\n        resizeHelperY = resizeHelperY > 0 ? resizeHelperY : 0;\n        dom.setStyles(resizeHelper, {\n          left: resizeHelperX,\n          top: resizeHelperY,\n          display: 'block'\n        });\n        resizeHelper.innerHTML = width + ' &times; ' + height;\n        if (selectedHandle[2] < 0 && selectedElmGhost.clientWidth <= width) {\n          dom.setStyle(selectedElmGhost, 'left', selectedElmX + (startW - width));\n        }\n        if (selectedHandle[3] < 0 && selectedElmGhost.clientHeight <= height) {\n          dom.setStyle(selectedElmGhost, 'top', selectedElmY + (startH - height));\n        }\n        deltaX = rootElement.scrollWidth - startScrollWidth;\n        deltaY = rootElement.scrollHeight - startScrollHeight;\n        if (deltaX + deltaY !== 0) {\n          dom.setStyles(resizeHelper, {\n            left: resizeHelperX - deltaX,\n            top: resizeHelperY - deltaY\n          });\n        }\n        if (!resizeStarted) {\n          fireObjectResizeStart(editor, selectedElm, startW, startH, 'corner-' + selectedHandle.name);\n          resizeStarted = true;\n        }\n      };\n      var endGhostResize = function () {\n        var wasResizeStarted = resizeStarted;\n        resizeStarted = false;\n        if (wasResizeStarted) {\n          setSizeProp(selectedElm, 'width', width);\n          setSizeProp(selectedElm, 'height', height);\n        }\n        dom.unbind(editableDoc, 'mousemove', resizeGhostElement);\n        dom.unbind(editableDoc, 'mouseup', endGhostResize);\n        if (rootDocument !== editableDoc) {\n          dom.unbind(rootDocument, 'mousemove', resizeGhostElement);\n          dom.unbind(rootDocument, 'mouseup', endGhostResize);\n        }\n        dom.remove(selectedElmGhost);\n        dom.remove(resizeHelper);\n        dom.remove(resizeBackdrop);\n        showResizeRect(selectedElm);\n        if (wasResizeStarted) {\n          fireObjectResized(editor, selectedElm, width, height, 'corner-' + selectedHandle.name);\n          dom.setAttrib(selectedElm, 'style', dom.getAttrib(selectedElm, 'style'));\n        }\n        editor.nodeChanged();\n      };\n      var showResizeRect = function (targetElm) {\n        unbindResizeHandleEvents();\n        var position = dom.getPos(targetElm, rootElement);\n        var selectedElmX = position.x;\n        var selectedElmY = position.y;\n        var rect = targetElm.getBoundingClientRect();\n        var targetWidth = rect.width || rect.right - rect.left;\n        var targetHeight = rect.height || rect.bottom - rect.top;\n        if (selectedElm !== targetElm) {\n          hideResizeRect();\n          selectedElm = targetElm;\n          width = height = 0;\n        }\n        var e = editor.fire('ObjectSelected', { target: targetElm });\n        var selectedValue = dom.getAttrib(selectedElm, elementSelectionAttr, '1');\n        if (isResizable(targetElm) && !e.isDefaultPrevented()) {\n          each$2(resizeHandles, function (handle, name) {\n            var handleElm;\n            var startDrag = function (e) {\n              var target = getResizeTargets(selectedElm)[0];\n              startX = e.screenX;\n              startY = e.screenY;\n              startW = target.clientWidth;\n              startH = target.clientHeight;\n              ratio = startH / startW;\n              selectedHandle = handle;\n              selectedHandle.name = name;\n              selectedHandle.startPos = {\n                x: targetWidth * handle[0] + selectedElmX,\n                y: targetHeight * handle[1] + selectedElmY\n              };\n              startScrollWidth = rootElement.scrollWidth;\n              startScrollHeight = rootElement.scrollHeight;\n              resizeBackdrop = dom.add(rootElement, 'div', { class: 'mce-resize-backdrop' });\n              dom.setStyles(resizeBackdrop, {\n                position: 'fixed',\n                left: '0',\n                top: '0',\n                width: '100%',\n                height: '100%'\n              });\n              selectedElmGhost = createGhostElement(selectedElm);\n              dom.addClass(selectedElmGhost, 'mce-clonedresizable');\n              dom.setAttrib(selectedElmGhost, 'data-mce-bogus', 'all');\n              selectedElmGhost.contentEditable = 'false';\n              dom.setStyles(selectedElmGhost, {\n                left: selectedElmX,\n                top: selectedElmY,\n                margin: 0\n              });\n              setGhostElmSize(selectedElmGhost, targetWidth, targetHeight);\n              selectedElmGhost.removeAttribute(elementSelectionAttr);\n              rootElement.appendChild(selectedElmGhost);\n              dom.bind(editableDoc, 'mousemove', resizeGhostElement);\n              dom.bind(editableDoc, 'mouseup', endGhostResize);\n              if (rootDocument !== editableDoc) {\n                dom.bind(rootDocument, 'mousemove', resizeGhostElement);\n                dom.bind(rootDocument, 'mouseup', endGhostResize);\n              }\n              resizeHelper = dom.add(rootElement, 'div', {\n                'class': 'mce-resize-helper',\n                'data-mce-bogus': 'all'\n              }, startW + ' &times; ' + startH);\n            };\n            handleElm = dom.get('mceResizeHandle' + name);\n            if (handleElm) {\n              dom.remove(handleElm);\n            }\n            handleElm = dom.add(rootElement, 'div', {\n              'id': 'mceResizeHandle' + name,\n              'data-mce-bogus': 'all',\n              'class': 'mce-resizehandle',\n              'unselectable': true,\n              'style': 'cursor:' + name + '-resize; margin:0; padding:0'\n            });\n            if (Env.ie === 11) {\n              handleElm.contentEditable = false;\n            }\n            dom.bind(handleElm, 'mousedown', function (e) {\n              e.stopImmediatePropagation();\n              e.preventDefault();\n              startDrag(e);\n            });\n            handle.elm = handleElm;\n            dom.setStyles(handleElm, {\n              left: targetWidth * handle[0] + selectedElmX - handleElm.offsetWidth / 2,\n              top: targetHeight * handle[1] + selectedElmY - handleElm.offsetHeight / 2\n            });\n          });\n        } else {\n          hideResizeRect();\n        }\n        if (!dom.getAttrib(selectedElm, elementSelectionAttr)) {\n          selectedElm.setAttribute(elementSelectionAttr, selectedValue);\n        }\n      };\n      var hideResizeRect = function () {\n        unbindResizeHandleEvents();\n        if (selectedElm) {\n          selectedElm.removeAttribute(elementSelectionAttr);\n        }\n        each$1(resizeHandles, function (value, name) {\n          var handleElm = dom.get('mceResizeHandle' + name);\n          if (handleElm) {\n            dom.unbind(handleElm);\n            dom.remove(handleElm);\n          }\n        });\n      };\n      var updateResizeRect = function (e) {\n        var startElm, controlElm;\n        var isChildOrEqual = function (node, parent) {\n          if (node) {\n            do {\n              if (node === parent) {\n                return true;\n              }\n            } while (node = node.parentNode);\n          }\n        };\n        if (resizeStarted || editor.removed) {\n          return;\n        }\n        each$2(dom.select('img[data-mce-selected],hr[data-mce-selected]'), function (img) {\n          img.removeAttribute(elementSelectionAttr);\n        });\n        controlElm = e.type === 'mousedown' ? e.target : selection.getNode();\n        controlElm = dom.$(controlElm).closest('table,img,figure.image,hr,video,span.mce-preview-object')[0];\n        if (isChildOrEqual(controlElm, rootElement)) {\n          disableGeckoResize();\n          startElm = selection.getStart(true);\n          if (isChildOrEqual(startElm, controlElm) && isChildOrEqual(selection.getEnd(true), controlElm)) {\n            showResizeRect(controlElm);\n            return;\n          }\n        }\n        hideResizeRect();\n      };\n      var isWithinContentEditableFalse = function (elm) {\n        return isContentEditableFalse$6(getContentEditableRoot(editor.getBody(), elm));\n      };\n      var unbindResizeHandleEvents = function () {\n        each$1(resizeHandles, function (handle) {\n          if (handle.elm) {\n            dom.unbind(handle.elm);\n            delete handle.elm;\n          }\n        });\n      };\n      var disableGeckoResize = function () {\n        try {\n          editor.getDoc().execCommand('enableObjectResizing', false, 'false');\n        } catch (ex) {\n        }\n      };\n      editor.on('init', function () {\n        disableGeckoResize();\n        if (Env.browser.isIE() || Env.browser.isEdge()) {\n          editor.on('mousedown click', function (e) {\n            var target = e.target, nodeName = target.nodeName;\n            if (!resizeStarted && /^(TABLE|IMG|HR)$/.test(nodeName) && !isWithinContentEditableFalse(target)) {\n              if (e.button !== 2) {\n                editor.selection.select(target, nodeName === 'TABLE');\n              }\n              if (e.type === 'mousedown') {\n                editor.nodeChanged();\n              }\n            }\n          });\n          var handleMSControlSelect_1 = function (e) {\n            var delayedSelect = function (node) {\n              Delay.setEditorTimeout(editor, function () {\n                return editor.selection.select(node);\n              });\n            };\n            if (isWithinContentEditableFalse(e.target) || isMedia(e.target)) {\n              e.preventDefault();\n              delayedSelect(e.target);\n              return;\n            }\n            if (/^(TABLE|IMG|HR)$/.test(e.target.nodeName)) {\n              e.preventDefault();\n              if (e.target.tagName === 'IMG') {\n                delayedSelect(e.target);\n              }\n            }\n          };\n          dom.bind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n          editor.on('remove', function () {\n            return dom.unbind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n          });\n        }\n        var throttledUpdateResizeRect = Delay.throttle(function (e) {\n          if (!editor.composing) {\n            updateResizeRect(e);\n          }\n        });\n        editor.on('nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged', throttledUpdateResizeRect);\n        editor.on('keyup compositionend', function (e) {\n          if (selectedElm && selectedElm.nodeName === 'TABLE') {\n            throttledUpdateResizeRect(e);\n          }\n        });\n        editor.on('hide blur', hideResizeRect);\n        editor.on('contextmenu longpress', contextMenuSelectImage, true);\n      });\n      editor.on('remove', unbindResizeHandleEvents);\n      var destroy = function () {\n        selectedElm = selectedElmGhost = resizeBackdrop = null;\n      };\n      return {\n        isResizable: isResizable,\n        showResizeRect: showResizeRect,\n        hideResizeRect: hideResizeRect,\n        updateResizeRect: updateResizeRect,\n        destroy: destroy\n      };\n    };\n\n    var hasCeProperty = function (node) {\n      return isContentEditableTrue(node) || isContentEditableFalse(node);\n    };\n    var findParent = function (node, rootNode, predicate) {\n      while (node && node !== rootNode) {\n        if (predicate(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var findClosestIeRange = function (clientX, clientY, doc) {\n      var rects;\n      var element = doc.elementFromPoint(clientX, clientY);\n      var rng = doc.body.createTextRange();\n      if (!element || element.tagName === 'HTML') {\n        element = doc.body;\n      }\n      rng.moveToElementText(element);\n      rects = Tools.toArray(rng.getClientRects());\n      rects = rects.sort(function (a, b) {\n        a = Math.abs(Math.max(a.top - clientY, a.bottom - clientY));\n        b = Math.abs(Math.max(b.top - clientY, b.bottom - clientY));\n        return a - b;\n      });\n      if (rects.length > 0) {\n        clientY = (rects[0].bottom + rects[0].top) / 2;\n        try {\n          rng.moveToPoint(clientX, clientY);\n          rng.collapse(true);\n          return rng;\n        } catch (ex) {\n        }\n      }\n      return null;\n    };\n    var moveOutOfContentEditableFalse = function (rng, rootNode) {\n      var parentElement = rng && rng.parentElement ? rng.parentElement() : null;\n      return isContentEditableFalse(findParent(parentElement, rootNode, hasCeProperty)) ? null : rng;\n    };\n    var fromPoint$1 = function (clientX, clientY, doc) {\n      var rng, point;\n      var pointDoc = doc;\n      if (pointDoc.caretPositionFromPoint) {\n        point = pointDoc.caretPositionFromPoint(clientX, clientY);\n        if (point) {\n          rng = doc.createRange();\n          rng.setStart(point.offsetNode, point.offset);\n          rng.collapse(true);\n        }\n      } else if (doc.caretRangeFromPoint) {\n        rng = doc.caretRangeFromPoint(clientX, clientY);\n      } else if (pointDoc.body.createTextRange) {\n        rng = pointDoc.body.createTextRange();\n        try {\n          rng.moveToPoint(clientX, clientY);\n          rng.collapse(true);\n        } catch (ex) {\n          rng = findClosestIeRange(clientX, clientY, doc);\n        }\n        return moveOutOfContentEditableFalse(rng, doc.body);\n      }\n      return rng;\n    };\n\n    var isEq$1 = function (rng1, rng2) {\n      return rng1 && rng2 && (rng1.startContainer === rng2.startContainer && rng1.startOffset === rng2.startOffset) && (rng1.endContainer === rng2.endContainer && rng1.endOffset === rng2.endOffset);\n    };\n\n    var findParent$1 = function (node, rootNode, predicate) {\n      while (node && node !== rootNode) {\n        if (predicate(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var hasParent = function (node, rootNode, predicate) {\n      return findParent$1(node, rootNode, predicate) !== null;\n    };\n    var hasParentWithName = function (node, rootNode, name) {\n      return hasParent(node, rootNode, function (node) {\n        return node.nodeName === name;\n      });\n    };\n    var isTable$3 = function (node) {\n      return node && node.nodeName === 'TABLE';\n    };\n    var isTableCell$3 = function (node) {\n      return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n    };\n    var isCeFalseCaretContainer = function (node, rootNode) {\n      return isCaretContainer(node) && hasParent(node, rootNode, isCaretNode) === false;\n    };\n    var hasBrBeforeAfter = function (dom, node, left) {\n      var walker = new DomTreeWalker(node, dom.getParent(node.parentNode, dom.isBlock) || dom.getRoot());\n      while (node = walker[left ? 'prev' : 'next']()) {\n        if (isBr(node)) {\n          return true;\n        }\n      }\n    };\n    var isPrevNode = function (node, name) {\n      return node.previousSibling && node.previousSibling.nodeName === name;\n    };\n    var hasContentEditableFalseParent = function (body, node) {\n      while (node && node !== body) {\n        if (isContentEditableFalse(node)) {\n          return true;\n        }\n        node = node.parentNode;\n      }\n      return false;\n    };\n    var findTextNodeRelative = function (dom, isAfterNode, collapsed, left, startNode) {\n      var lastInlineElement;\n      var body = dom.getRoot();\n      var node;\n      var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n      var parentBlockContainer = dom.getParent(startNode.parentNode, dom.isBlock) || body;\n      if (left && isBr(startNode) && isAfterNode && dom.isEmpty(parentBlockContainer)) {\n        return Optional.some(CaretPosition(startNode.parentNode, dom.nodeIndex(startNode)));\n      }\n      var walker = new DomTreeWalker(startNode, parentBlockContainer);\n      while (node = walker[left ? 'prev' : 'next']()) {\n        if (dom.getContentEditableParent(node) === 'false' || isCeFalseCaretContainer(node, body)) {\n          return Optional.none();\n        }\n        if (isText$1(node) && node.nodeValue.length > 0) {\n          if (hasParentWithName(node, body, 'A') === false) {\n            return Optional.some(CaretPosition(node, left ? node.nodeValue.length : 0));\n          }\n          return Optional.none();\n        }\n        if (dom.isBlock(node) || nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n          return Optional.none();\n        }\n        lastInlineElement = node;\n      }\n      if (collapsed && lastInlineElement) {\n        return Optional.some(CaretPosition(lastInlineElement, 0));\n      }\n      return Optional.none();\n    };\n    var normalizeEndPoint = function (dom, collapsed, start, rng) {\n      var container, offset;\n      var body = dom.getRoot();\n      var node;\n      var directionLeft, normalized = false;\n      container = rng[(start ? 'start' : 'end') + 'Container'];\n      offset = rng[(start ? 'start' : 'end') + 'Offset'];\n      var isAfterNode = isElement$1(container) && offset === container.childNodes.length;\n      var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n      directionLeft = start;\n      if (isCaretContainer(container)) {\n        return Optional.none();\n      }\n      if (isElement$1(container) && offset > container.childNodes.length - 1) {\n        directionLeft = false;\n      }\n      if (isDocument$1(container)) {\n        container = body;\n        offset = 0;\n      }\n      if (container === body) {\n        if (directionLeft) {\n          node = container.childNodes[offset > 0 ? offset - 1 : 0];\n          if (node) {\n            if (isCaretContainer(node)) {\n              return Optional.none();\n            }\n            if (nonEmptyElementsMap[node.nodeName] || isTable$3(node)) {\n              return Optional.none();\n            }\n          }\n        }\n        if (container.hasChildNodes()) {\n          offset = Math.min(!directionLeft && offset > 0 ? offset - 1 : offset, container.childNodes.length - 1);\n          container = container.childNodes[offset];\n          offset = isText$1(container) && isAfterNode ? container.data.length : 0;\n          if (!collapsed && container === body.lastChild && isTable$3(container)) {\n            return Optional.none();\n          }\n          if (hasContentEditableFalseParent(body, container) || isCaretContainer(container)) {\n            return Optional.none();\n          }\n          if (container.hasChildNodes() && isTable$3(container) === false) {\n            node = container;\n            var walker = new DomTreeWalker(container, body);\n            do {\n              if (isContentEditableFalse(node) || isCaretContainer(node)) {\n                normalized = false;\n                break;\n              }\n              if (isText$1(node) && node.nodeValue.length > 0) {\n                offset = directionLeft ? 0 : node.nodeValue.length;\n                container = node;\n                normalized = true;\n                break;\n              }\n              if (nonEmptyElementsMap[node.nodeName.toLowerCase()] && !isTableCell$3(node)) {\n                offset = dom.nodeIndex(node);\n                container = node.parentNode;\n                if (!directionLeft) {\n                  offset++;\n                }\n                normalized = true;\n                break;\n              }\n            } while (node = directionLeft ? walker.next() : walker.prev());\n          }\n        }\n      }\n      if (collapsed) {\n        if (isText$1(container) && offset === 0) {\n          findTextNodeRelative(dom, isAfterNode, collapsed, true, container).each(function (pos) {\n            container = pos.container();\n            offset = pos.offset();\n            normalized = true;\n          });\n        }\n        if (isElement$1(container)) {\n          node = container.childNodes[offset];\n          if (!node) {\n            node = container.childNodes[offset - 1];\n          }\n          if (node && isBr(node) && !isPrevNode(node, 'A') && !hasBrBeforeAfter(dom, node, false) && !hasBrBeforeAfter(dom, node, true)) {\n            findTextNodeRelative(dom, isAfterNode, collapsed, true, node).each(function (pos) {\n              container = pos.container();\n              offset = pos.offset();\n              normalized = true;\n            });\n          }\n        }\n      }\n      if (directionLeft && !collapsed && isText$1(container) && offset === container.nodeValue.length) {\n        findTextNodeRelative(dom, isAfterNode, collapsed, false, container).each(function (pos) {\n          container = pos.container();\n          offset = pos.offset();\n          normalized = true;\n        });\n      }\n      return normalized ? Optional.some(CaretPosition(container, offset)) : Optional.none();\n    };\n    var normalize = function (dom, rng) {\n      var collapsed = rng.collapsed, normRng = rng.cloneRange();\n      var startPos = CaretPosition.fromRangeStart(rng);\n      normalizeEndPoint(dom, collapsed, true, normRng).each(function (pos) {\n        if (!collapsed || !CaretPosition.isAbove(startPos, pos)) {\n          normRng.setStart(pos.container(), pos.offset());\n        }\n      });\n      if (!collapsed) {\n        normalizeEndPoint(dom, collapsed, false, normRng).each(function (pos) {\n          normRng.setEnd(pos.container(), pos.offset());\n        });\n      }\n      if (collapsed) {\n        normRng.collapse(true);\n      }\n      return isEq$1(rng, normRng) ? Optional.none() : Optional.some(normRng);\n    };\n\n    var splitText = function (node, offset) {\n      return node.splitText(offset);\n    };\n    var split$1 = function (rng) {\n      var startContainer = rng.startContainer, startOffset = rng.startOffset, endContainer = rng.endContainer, endOffset = rng.endOffset;\n      if (startContainer === endContainer && isText$1(startContainer)) {\n        if (startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n          endContainer = splitText(startContainer, startOffset);\n          startContainer = endContainer.previousSibling;\n          if (endOffset > startOffset) {\n            endOffset = endOffset - startOffset;\n            startContainer = endContainer = splitText(endContainer, endOffset).previousSibling;\n            endOffset = endContainer.nodeValue.length;\n            startOffset = 0;\n          } else {\n            endOffset = 0;\n          }\n        }\n      } else {\n        if (isText$1(startContainer) && startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n          startContainer = splitText(startContainer, startOffset);\n          startOffset = 0;\n        }\n        if (isText$1(endContainer) && endOffset > 0 && endOffset < endContainer.nodeValue.length) {\n          endContainer = splitText(endContainer, endOffset).previousSibling;\n          endOffset = endContainer.nodeValue.length;\n        }\n      }\n      return {\n        startContainer: startContainer,\n        startOffset: startOffset,\n        endContainer: endContainer,\n        endOffset: endOffset\n      };\n    };\n\n    var RangeUtils = function (dom) {\n      var walk = function (rng, callback) {\n        return walk$1(dom, rng, callback);\n      };\n      var split = split$1;\n      var normalize$1 = function (rng) {\n        return normalize(dom, rng).fold(never, function (normalizedRng) {\n          rng.setStart(normalizedRng.startContainer, normalizedRng.startOffset);\n          rng.setEnd(normalizedRng.endContainer, normalizedRng.endOffset);\n          return true;\n        });\n      };\n      return {\n        walk: walk,\n        split: split,\n        normalize: normalize$1\n      };\n    };\n    RangeUtils.compareRanges = isEq$1;\n    RangeUtils.getCaretRangeFromPoint = fromPoint$1;\n    RangeUtils.getSelectedNode = getSelectedNode;\n    RangeUtils.getNode = getNode;\n\n    var Dimension = function (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom;\n        if (isSupported$1(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$5(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$5(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    };\n\n    var api$1 = Dimension('height', function (element) {\n      var dom = element.dom;\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$9 = function (element) {\n      return api$1.get(element);\n    };\n\n    var walkUp = function (navigation, doc) {\n      var frame = navigation.view(doc);\n      return frame.fold(constant([]), function (f) {\n        var parent = navigation.owner(f);\n        var rest = walkUp(navigation, parent);\n        return [f].concat(rest);\n      });\n    };\n    var pathTo = function (element, navigation) {\n      var d = navigation.owner(element);\n      return walkUp(navigation, d);\n    };\n\n    var view = function (doc) {\n      var _a;\n      var element = doc.dom === document ? Optional.none() : Optional.from((_a = doc.dom.defaultView) === null || _a === void 0 ? void 0 : _a.frameElement);\n      return element.map(SugarElement.fromDom);\n    };\n    var owner$1 = function (element) {\n      return documentOrOwner(element);\n    };\n\n    var Navigation = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        view: view,\n        owner: owner$1\n    });\n\n    var find$2 = function (element) {\n      var doc = SugarElement.fromDom(document);\n      var scroll = get$2(doc);\n      var frames = pathTo(element, Navigation);\n      var offset = viewport(element);\n      var r = foldr(frames, function (b, a) {\n        var loc = viewport(a);\n        return {\n          left: b.left + loc.left,\n          top: b.top + loc.top\n        };\n      }, {\n        left: 0,\n        top: 0\n      });\n      return SugarPosition(r.left + offset.left + scroll.left, r.top + offset.top + scroll.top);\n    };\n\n    var excludeFromDescend = function (element) {\n      return name(element) === 'textarea';\n    };\n    var fireScrollIntoViewEvent = function (editor, data) {\n      var scrollEvent = editor.fire('ScrollIntoView', data);\n      return scrollEvent.isDefaultPrevented();\n    };\n    var fireAfterScrollIntoViewEvent = function (editor, data) {\n      editor.fire('AfterScrollIntoView', data);\n    };\n    var descend = function (element, offset) {\n      var children$1 = children(element);\n      if (children$1.length === 0 || excludeFromDescend(element)) {\n        return {\n          element: element,\n          offset: offset\n        };\n      } else if (offset < children$1.length && !excludeFromDescend(children$1[offset])) {\n        return {\n          element: children$1[offset],\n          offset: 0\n        };\n      } else {\n        var last = children$1[children$1.length - 1];\n        if (excludeFromDescend(last)) {\n          return {\n            element: element,\n            offset: offset\n          };\n        } else {\n          if (name(last) === 'img') {\n            return {\n              element: last,\n              offset: 1\n            };\n          } else if (isText(last)) {\n            return {\n              element: last,\n              offset: get$8(last).length\n            };\n          } else {\n            return {\n              element: last,\n              offset: children(last).length\n            };\n          }\n        }\n      }\n    };\n    var markerInfo = function (element, cleanupFun) {\n      var pos = absolute(element);\n      var height = get$9(element);\n      return {\n        element: element,\n        bottom: pos.top + height,\n        height: height,\n        pos: pos,\n        cleanup: cleanupFun\n      };\n    };\n    var createMarker = function (element, offset) {\n      var startPoint = descend(element, offset);\n      var span = SugarElement.fromHtml('<span data-mce-bogus=\"all\">' + ZWSP + '</span>');\n      before(startPoint.element, span);\n      return markerInfo(span, function () {\n        return remove(span);\n      });\n    };\n    var elementMarker = function (element) {\n      return markerInfo(SugarElement.fromDom(element), noop);\n    };\n    var withMarker = function (editor, f, rng, alignToTop) {\n      preserveWith(editor, function (_s, _e) {\n        return applyWithMarker(editor, f, rng, alignToTop);\n      }, rng);\n    };\n    var withScrollEvents = function (editor, doc, f, marker, alignToTop) {\n      var data = {\n        elm: marker.element.dom,\n        alignToTop: alignToTop\n      };\n      if (fireScrollIntoViewEvent(editor, data)) {\n        return;\n      }\n      var scrollTop = get$2(doc).top;\n      f(doc, scrollTop, marker, alignToTop);\n      fireAfterScrollIntoViewEvent(editor, data);\n    };\n    var applyWithMarker = function (editor, f, rng, alignToTop) {\n      var body = SugarElement.fromDom(editor.getBody());\n      var doc = SugarElement.fromDom(editor.getDoc());\n      reflow(body);\n      var marker = createMarker(SugarElement.fromDom(rng.startContainer), rng.startOffset);\n      withScrollEvents(editor, doc, f, marker, alignToTop);\n      marker.cleanup();\n    };\n    var withElement = function (editor, element, f, alignToTop) {\n      var doc = SugarElement.fromDom(editor.getDoc());\n      withScrollEvents(editor, doc, f, elementMarker(element), alignToTop);\n    };\n    var preserveWith = function (editor, f, rng) {\n      var startElement = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endElement = rng.endContainer;\n      var endOffset = rng.endOffset;\n      f(SugarElement.fromDom(startElement), SugarElement.fromDom(endElement));\n      var newRng = editor.dom.createRng();\n      newRng.setStart(startElement, startOffset);\n      newRng.setEnd(endElement, endOffset);\n      editor.selection.setRng(rng);\n    };\n    var scrollToMarker = function (marker, viewHeight, alignToTop, doc) {\n      var pos = marker.pos;\n      if (alignToTop) {\n        to(pos.left, pos.top, doc);\n      } else {\n        var y = pos.top - viewHeight + marker.height;\n        to(pos.left, y, doc);\n      }\n    };\n    var intoWindowIfNeeded = function (doc, scrollTop, viewHeight, marker, alignToTop) {\n      var viewportBottom = viewHeight + scrollTop;\n      var markerTop = marker.pos.top;\n      var markerBottom = marker.bottom;\n      var largerThanViewport = markerBottom - markerTop >= viewHeight;\n      if (markerTop < scrollTop) {\n        scrollToMarker(marker, viewHeight, alignToTop !== false, doc);\n      } else if (markerTop > viewportBottom) {\n        var align = largerThanViewport ? alignToTop !== false : alignToTop === true;\n        scrollToMarker(marker, viewHeight, align, doc);\n      } else if (markerBottom > viewportBottom && !largerThanViewport) {\n        scrollToMarker(marker, viewHeight, alignToTop === true, doc);\n      }\n    };\n    var intoWindow = function (doc, scrollTop, marker, alignToTop) {\n      var viewHeight = doc.dom.defaultView.innerHeight;\n      intoWindowIfNeeded(doc, scrollTop, viewHeight, marker, alignToTop);\n    };\n    var intoFrame = function (doc, scrollTop, marker, alignToTop) {\n      var frameViewHeight = doc.dom.defaultView.innerHeight;\n      intoWindowIfNeeded(doc, scrollTop, frameViewHeight, marker, alignToTop);\n      var op = find$2(marker.element);\n      var viewportBounds = getBounds(window);\n      if (op.top < viewportBounds.y) {\n        intoView(marker.element, alignToTop !== false);\n      } else if (op.top > viewportBounds.bottom) {\n        intoView(marker.element, alignToTop === true);\n      }\n    };\n    var rangeIntoWindow = function (editor, rng, alignToTop) {\n      return withMarker(editor, intoWindow, rng, alignToTop);\n    };\n    var elementIntoWindow = function (editor, element, alignToTop) {\n      return withElement(editor, element, intoWindow, alignToTop);\n    };\n    var rangeIntoFrame = function (editor, rng, alignToTop) {\n      return withMarker(editor, intoFrame, rng, alignToTop);\n    };\n    var elementIntoFrame = function (editor, element, alignToTop) {\n      return withElement(editor, element, intoFrame, alignToTop);\n    };\n    var scrollElementIntoView = function (editor, element, alignToTop) {\n      var scroller = editor.inline ? elementIntoWindow : elementIntoFrame;\n      scroller(editor, element, alignToTop);\n    };\n    var scrollRangeIntoView = function (editor, rng, alignToTop) {\n      var scroller = editor.inline ? rangeIntoWindow : rangeIntoFrame;\n      scroller(editor, rng, alignToTop);\n    };\n\n    var getDocument = function () {\n      return SugarElement.fromDom(document);\n    };\n\n    var focus = function (element) {\n      return element.dom.focus();\n    };\n    var hasFocus = function (element) {\n      var root = getRootNode(element).dom;\n      return element.dom === root.activeElement;\n    };\n    var active = function (root) {\n      if (root === void 0) {\n        root = getDocument();\n      }\n      return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);\n    };\n    var search = function (element) {\n      return active(getRootNode(element)).filter(function (e) {\n        return element.dom.contains(e.dom);\n      });\n    };\n\n    var create$4 = function (start, soffset, finish, foffset) {\n      return {\n        start: start,\n        soffset: soffset,\n        finish: finish,\n        foffset: foffset\n      };\n    };\n    var SimRange = { create: create$4 };\n\n    var adt = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart = function (situ) {\n      return situ.fold(identity, identity, identity);\n    };\n    var before$3 = adt.before;\n    var on = adt.on;\n    var after$2 = adt.after;\n    var Situ = {\n      before: before$3,\n      on: on,\n      after: after$2,\n      cata: cata,\n      getStart: getStart\n    };\n\n    var adt$1 = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt$1.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n    };\n    var getStart$1 = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return SugarElement.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, _finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, _soffset, _finish, _foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt$1.domRange;\n    var relative = adt$1.relative;\n    var exact = adt$1.exact;\n    var getWin = function (selection) {\n      var start = getStart$1(selection);\n      return defaultView(start);\n    };\n    var range = SimRange.create;\n    var SimSelection = {\n      domRange: domRange,\n      relative: relative,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range\n    };\n\n    var browser$3 = detect$3().browser;\n    var clamp = function (offset, element) {\n      var max = isText(element) ? get$8(element).length : children(element).length + 1;\n      if (offset > max) {\n        return max;\n      } else if (offset < 0) {\n        return 0;\n      }\n      return offset;\n    };\n    var normalizeRng = function (rng) {\n      return SimSelection.range(rng.start, clamp(rng.soffset, rng.start), rng.finish, clamp(rng.foffset, rng.finish));\n    };\n    var isOrContains = function (root, elm) {\n      return !isRestrictedNode(elm.dom) && (contains$2(root, elm) || eq$2(root, elm));\n    };\n    var isRngInRoot = function (root) {\n      return function (rng) {\n        return isOrContains(root, rng.start) && isOrContains(root, rng.finish);\n      };\n    };\n    var shouldStore = function (editor) {\n      return editor.inline === true || browser$3.isIE();\n    };\n    var nativeRangeToSelectionRange = function (r) {\n      return SimSelection.range(SugarElement.fromDom(r.startContainer), r.startOffset, SugarElement.fromDom(r.endContainer), r.endOffset);\n    };\n    var readRange = function (win) {\n      var selection = win.getSelection();\n      var rng = !selection || selection.rangeCount === 0 ? Optional.none() : Optional.from(selection.getRangeAt(0));\n      return rng.map(nativeRangeToSelectionRange);\n    };\n    var getBookmark$2 = function (root) {\n      var win = defaultView(root);\n      return readRange(win.dom).filter(isRngInRoot(root));\n    };\n    var validate = function (root, bookmark) {\n      return Optional.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng);\n    };\n    var bookmarkToNativeRng = function (bookmark) {\n      var rng = document.createRange();\n      try {\n        rng.setStart(bookmark.start.dom, bookmark.soffset);\n        rng.setEnd(bookmark.finish.dom, bookmark.foffset);\n        return Optional.some(rng);\n      } catch (_) {\n        return Optional.none();\n      }\n    };\n    var store = function (editor) {\n      var newBookmark = shouldStore(editor) ? getBookmark$2(SugarElement.fromDom(editor.getBody())) : Optional.none();\n      editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n    };\n    var storeNative = function (editor, rng) {\n      var root = SugarElement.fromDom(editor.getBody());\n      var range = shouldStore(editor) ? Optional.from(rng) : Optional.none();\n      var newBookmark = range.map(nativeRangeToSelectionRange).filter(isRngInRoot(root));\n      editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n    };\n    var getRng = function (editor) {\n      var bookmark = editor.bookmark ? editor.bookmark : Optional.none();\n      return bookmark.bind(function (x) {\n        return validate(SugarElement.fromDom(editor.getBody()), x);\n      }).bind(bookmarkToNativeRng);\n    };\n    var restore = function (editor) {\n      getRng(editor).each(function (rng) {\n        return editor.selection.setRng(rng);\n      });\n    };\n\n    var isEditorUIElement = function (elm) {\n      var className = elm.className.toString();\n      return className.indexOf('tox-') !== -1 || className.indexOf('mce-') !== -1;\n    };\n    var FocusManager = { isEditorUIElement: isEditorUIElement };\n\n    var isManualNodeChange = function (e) {\n      return e.type === 'nodechange' && e.selectionChange;\n    };\n    var registerPageMouseUp = function (editor, throttledStore) {\n      var mouseUpPage = function () {\n        throttledStore.throttle();\n      };\n      DOMUtils.DOM.bind(document, 'mouseup', mouseUpPage);\n      editor.on('remove', function () {\n        DOMUtils.DOM.unbind(document, 'mouseup', mouseUpPage);\n      });\n    };\n    var registerFocusOut = function (editor) {\n      editor.on('focusout', function () {\n        store(editor);\n      });\n    };\n    var registerMouseUp = function (editor, throttledStore) {\n      editor.on('mouseup touchend', function (_e) {\n        throttledStore.throttle();\n      });\n    };\n    var registerEditorEvents = function (editor, throttledStore) {\n      var browser = detect$3().browser;\n      if (browser.isIE()) {\n        registerFocusOut(editor);\n      } else {\n        registerMouseUp(editor, throttledStore);\n      }\n      editor.on('keyup NodeChange', function (e) {\n        if (!isManualNodeChange(e)) {\n          store(editor);\n        }\n      });\n    };\n    var register = function (editor) {\n      var throttledStore = first(function () {\n        store(editor);\n      }, 0);\n      editor.on('init', function () {\n        if (editor.inline) {\n          registerPageMouseUp(editor, throttledStore);\n        }\n        registerEditorEvents(editor, throttledStore);\n      });\n      editor.on('remove', function () {\n        throttledStore.cancel();\n      });\n    };\n\n    var documentFocusInHandler;\n    var DOM$2 = DOMUtils.DOM;\n    var isEditorUIElement$1 = function (elm) {\n      return FocusManager.isEditorUIElement(elm);\n    };\n    var isEditorContentAreaElement = function (elm) {\n      var classList = elm.classList;\n      if (classList !== undefined) {\n        return classList.contains('tox-edit-area') || classList.contains('tox-edit-area__iframe') || classList.contains('mce-content-body');\n      } else {\n        return false;\n      }\n    };\n    var isUIElement = function (editor, elm) {\n      var customSelector = getCustomUiSelector(editor);\n      var parent = DOM$2.getParent(elm, function (elm) {\n        return isEditorUIElement$1(elm) || (customSelector ? editor.dom.is(elm, customSelector) : false);\n      });\n      return parent !== null;\n    };\n    var getActiveElement = function (editor) {\n      try {\n        var root = getRootNode(SugarElement.fromDom(editor.getElement()));\n        return active(root).fold(function () {\n          return document.body;\n        }, function (x) {\n          return x.dom;\n        });\n      } catch (ex) {\n        return document.body;\n      }\n    };\n    var registerEvents = function (editorManager, e) {\n      var editor = e.editor;\n      register(editor);\n      editor.on('focusin', function () {\n        var focusedEditor = editorManager.focusedEditor;\n        if (focusedEditor !== editor) {\n          if (focusedEditor) {\n            focusedEditor.fire('blur', { focusedEditor: editor });\n          }\n          editorManager.setActive(editor);\n          editorManager.focusedEditor = editor;\n          editor.fire('focus', { blurredEditor: focusedEditor });\n          editor.focus(true);\n        }\n      });\n      editor.on('focusout', function () {\n        Delay.setEditorTimeout(editor, function () {\n          var focusedEditor = editorManager.focusedEditor;\n          if (!isUIElement(editor, getActiveElement(editor)) && focusedEditor === editor) {\n            editor.fire('blur', { focusedEditor: null });\n            editorManager.focusedEditor = null;\n          }\n        });\n      });\n      if (!documentFocusInHandler) {\n        documentFocusInHandler = function (e) {\n          var activeEditor = editorManager.activeEditor;\n          if (activeEditor) {\n            getOriginalEventTarget(e).each(function (target) {\n              if (target.ownerDocument === document) {\n                if (target !== document.body && !isUIElement(activeEditor, target) && editorManager.focusedEditor === activeEditor) {\n                  activeEditor.fire('blur', { focusedEditor: null });\n                  editorManager.focusedEditor = null;\n                }\n              }\n            });\n          }\n        };\n        DOM$2.bind(document, 'focusin', documentFocusInHandler);\n      }\n    };\n    var unregisterDocumentEvents = function (editorManager, e) {\n      if (editorManager.focusedEditor === e.editor) {\n        editorManager.focusedEditor = null;\n      }\n      if (!editorManager.activeEditor) {\n        DOM$2.unbind(document, 'focusin', documentFocusInHandler);\n        documentFocusInHandler = null;\n      }\n    };\n    var setup$2 = function (editorManager) {\n      editorManager.on('AddEditor', curry(registerEvents, editorManager));\n      editorManager.on('RemoveEditor', curry(unregisterDocumentEvents, editorManager));\n    };\n\n    var getContentEditableHost = function (editor, node) {\n      return editor.dom.getParent(node, function (node) {\n        return editor.dom.getContentEditable(node) === 'true';\n      });\n    };\n    var getCollapsedNode = function (rng) {\n      return rng.collapsed ? Optional.from(getNode(rng.startContainer, rng.startOffset)).map(SugarElement.fromDom) : Optional.none();\n    };\n    var getFocusInElement = function (root, rng) {\n      return getCollapsedNode(rng).bind(function (node) {\n        if (isTableSection(node)) {\n          return Optional.some(node);\n        } else if (contains$2(root, node) === false) {\n          return Optional.some(root);\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var normalizeSelection = function (editor, rng) {\n      getFocusInElement(SugarElement.fromDom(editor.getBody()), rng).bind(function (elm) {\n        return firstPositionIn(elm.dom);\n      }).fold(function () {\n        editor.selection.normalize();\n        return;\n      }, function (caretPos) {\n        return editor.selection.setRng(caretPos.toRange());\n      });\n    };\n    var focusBody = function (body) {\n      if (body.setActive) {\n        try {\n          body.setActive();\n        } catch (ex) {\n          body.focus();\n        }\n      } else {\n        body.focus();\n      }\n    };\n    var hasElementFocus = function (elm) {\n      return hasFocus(elm) || search(elm).isSome();\n    };\n    var hasIframeFocus = function (editor) {\n      return editor.iframeElement && hasFocus(SugarElement.fromDom(editor.iframeElement));\n    };\n    var hasInlineFocus = function (editor) {\n      var rawBody = editor.getBody();\n      return rawBody && hasElementFocus(SugarElement.fromDom(rawBody));\n    };\n    var hasUiFocus = function (editor) {\n      var dos = getRootNode(SugarElement.fromDom(editor.getElement()));\n      return active(dos).filter(function (elem) {\n        return !isEditorContentAreaElement(elem.dom) && isUIElement(editor, elem.dom);\n      }).isSome();\n    };\n    var hasFocus$1 = function (editor) {\n      return editor.inline ? hasInlineFocus(editor) : hasIframeFocus(editor);\n    };\n    var hasEditorOrUiFocus = function (editor) {\n      return hasFocus$1(editor) || hasUiFocus(editor);\n    };\n    var focusEditor = function (editor) {\n      var selection = editor.selection;\n      var body = editor.getBody();\n      var rng = selection.getRng();\n      editor.quirks.refreshContentEditable();\n      if (editor.bookmark !== undefined && hasFocus$1(editor) === false) {\n        getRng(editor).each(function (bookmarkRng) {\n          editor.selection.setRng(bookmarkRng);\n          rng = bookmarkRng;\n        });\n      }\n      var contentEditableHost = getContentEditableHost(editor, selection.getNode());\n      if (editor.$.contains(body, contentEditableHost)) {\n        focusBody(contentEditableHost);\n        normalizeSelection(editor, rng);\n        activateEditor(editor);\n        return;\n      }\n      if (!editor.inline) {\n        if (!Env.opera) {\n          focusBody(body);\n        }\n        editor.getWin().focus();\n      }\n      if (Env.gecko || editor.inline) {\n        focusBody(body);\n        normalizeSelection(editor, rng);\n      }\n      activateEditor(editor);\n    };\n    var activateEditor = function (editor) {\n      return editor.editorManager.setActive(editor);\n    };\n    var focus$1 = function (editor, skipFocus) {\n      if (editor.removed) {\n        return;\n      }\n      skipFocus ? activateEditor(editor) : focusEditor(editor);\n    };\n\n    var getEndpointElement = function (root, rng, start, real, resolve) {\n      var container = start ? rng.startContainer : rng.endContainer;\n      var offset = start ? rng.startOffset : rng.endOffset;\n      return Optional.from(container).map(SugarElement.fromDom).map(function (elm) {\n        return !real || !rng.collapsed ? child(elm, resolve(elm, offset)).getOr(elm) : elm;\n      }).bind(function (elm) {\n        return isElement(elm) ? Optional.some(elm) : parent(elm).filter(isElement);\n      }).map(function (elm) {\n        return elm.dom;\n      }).getOr(root);\n    };\n    var getStart$2 = function (root, rng, real) {\n      return getEndpointElement(root, rng, true, real, function (elm, offset) {\n        return Math.min(childNodesCount(elm), offset);\n      });\n    };\n    var getEnd = function (root, rng, real) {\n      return getEndpointElement(root, rng, false, real, function (elm, offset) {\n        return offset > 0 ? offset - 1 : offset;\n      });\n    };\n    var skipEmptyTextNodes = function (node, forwards) {\n      var orig = node;\n      while (node && isText$1(node) && node.length === 0) {\n        node = forwards ? node.nextSibling : node.previousSibling;\n      }\n      return node || orig;\n    };\n    var getNode$1 = function (root, rng) {\n      var elm, startContainer, endContainer;\n      if (!rng) {\n        return root;\n      }\n      startContainer = rng.startContainer;\n      endContainer = rng.endContainer;\n      var startOffset = rng.startOffset;\n      var endOffset = rng.endOffset;\n      elm = rng.commonAncestorContainer;\n      if (!rng.collapsed) {\n        if (startContainer === endContainer) {\n          if (endOffset - startOffset < 2) {\n            if (startContainer.hasChildNodes()) {\n              elm = startContainer.childNodes[startOffset];\n            }\n          }\n        }\n        if (startContainer.nodeType === 3 && endContainer.nodeType === 3) {\n          if (startContainer.length === startOffset) {\n            startContainer = skipEmptyTextNodes(startContainer.nextSibling, true);\n          } else {\n            startContainer = startContainer.parentNode;\n          }\n          if (endOffset === 0) {\n            endContainer = skipEmptyTextNodes(endContainer.previousSibling, false);\n          } else {\n            endContainer = endContainer.parentNode;\n          }\n          if (startContainer && startContainer === endContainer) {\n            return startContainer;\n          }\n        }\n      }\n      if (elm && elm.nodeType === 3) {\n        return elm.parentNode;\n      }\n      return elm;\n    };\n    var getSelectedBlocks = function (dom, rng, startElm, endElm) {\n      var node;\n      var selectedBlocks = [];\n      var root = dom.getRoot();\n      startElm = dom.getParent(startElm || getStart$2(root, rng, rng.collapsed), dom.isBlock);\n      endElm = dom.getParent(endElm || getEnd(root, rng, rng.collapsed), dom.isBlock);\n      if (startElm && startElm !== root) {\n        selectedBlocks.push(startElm);\n      }\n      if (startElm && endElm && startElm !== endElm) {\n        node = startElm;\n        var walker = new DomTreeWalker(startElm, root);\n        while ((node = walker.next()) && node !== endElm) {\n          if (dom.isBlock(node)) {\n            selectedBlocks.push(node);\n          }\n        }\n      }\n      if (endElm && startElm !== endElm && endElm !== root) {\n        selectedBlocks.push(endElm);\n      }\n      return selectedBlocks;\n    };\n    var select$1 = function (dom, node, content) {\n      return Optional.from(node).map(function (node) {\n        var idx = dom.nodeIndex(node);\n        var rng = dom.createRng();\n        rng.setStart(node.parentNode, idx);\n        rng.setEnd(node.parentNode, idx + 1);\n        if (content) {\n          moveEndPoint$1(dom, rng, node, true);\n          moveEndPoint$1(dom, rng, node, false);\n        }\n        return rng;\n      });\n    };\n\n    var processRanges = function (editor, ranges) {\n      return map(ranges, function (range) {\n        var evt = editor.fire('GetSelectionRange', { range: range });\n        return evt.range !== range ? evt.range : range;\n      });\n    };\n\n    var typeLookup = {\n      '#text': 3,\n      '#comment': 8,\n      '#cdata': 4,\n      '#pi': 7,\n      '#doctype': 10,\n      '#document-fragment': 11\n    };\n    var walk$2 = function (node, root, prev) {\n      var startName = prev ? 'lastChild' : 'firstChild';\n      var siblingName = prev ? 'prev' : 'next';\n      if (node[startName]) {\n        return node[startName];\n      }\n      if (node !== root) {\n        var sibling = node[siblingName];\n        if (sibling) {\n          return sibling;\n        }\n        for (var parent_1 = node.parent; parent_1 && parent_1 !== root; parent_1 = parent_1.parent) {\n          sibling = parent_1[siblingName];\n          if (sibling) {\n            return sibling;\n          }\n        }\n      }\n    };\n    var isEmptyTextNode$1 = function (node) {\n      if (!isWhitespaceText(node.value)) {\n        return false;\n      }\n      var parentNode = node.parent;\n      if (parentNode && (parentNode.name !== 'span' || parentNode.attr('style')) && /^[ ]+$/.test(node.value)) {\n        return false;\n      }\n      return true;\n    };\n    var isNonEmptyElement = function (node) {\n      var isNamedAnchor = node.name === 'a' && !node.attr('href') && node.attr('id');\n      return node.attr('name') || node.attr('id') && !node.firstChild || node.attr('data-mce-bookmark') || isNamedAnchor;\n    };\n    var AstNode = function () {\n      function AstNode(name, type) {\n        this.name = name;\n        this.type = type;\n        if (type === 1) {\n          this.attributes = [];\n          this.attributes.map = {};\n        }\n      }\n      AstNode.create = function (name, attrs) {\n        var node = new AstNode(name, typeLookup[name] || 1);\n        if (attrs) {\n          each$1(attrs, function (value, attrName) {\n            node.attr(attrName, value);\n          });\n        }\n        return node;\n      };\n      AstNode.prototype.replace = function (node) {\n        var self = this;\n        if (node.parent) {\n          node.remove();\n        }\n        self.insert(node, self);\n        self.remove();\n        return self;\n      };\n      AstNode.prototype.attr = function (name, value) {\n        var self = this;\n        var attrs;\n        if (typeof name !== 'string') {\n          if (name !== undefined && name !== null) {\n            each$1(name, function (value, key) {\n              self.attr(key, value);\n            });\n          }\n          return self;\n        }\n        if (attrs = self.attributes) {\n          if (value !== undefined) {\n            if (value === null) {\n              if (name in attrs.map) {\n                delete attrs.map[name];\n                var i = attrs.length;\n                while (i--) {\n                  if (attrs[i].name === name) {\n                    attrs.splice(i, 1);\n                    return self;\n                  }\n                }\n              }\n              return self;\n            }\n            if (name in attrs.map) {\n              var i = attrs.length;\n              while (i--) {\n                if (attrs[i].name === name) {\n                  attrs[i].value = value;\n                  break;\n                }\n              }\n            } else {\n              attrs.push({\n                name: name,\n                value: value\n              });\n            }\n            attrs.map[name] = value;\n            return self;\n          }\n          return attrs.map[name];\n        }\n      };\n      AstNode.prototype.clone = function () {\n        var self = this;\n        var clone = new AstNode(self.name, self.type);\n        var selfAttrs;\n        if (selfAttrs = self.attributes) {\n          var cloneAttrs = [];\n          cloneAttrs.map = {};\n          for (var i = 0, l = selfAttrs.length; i < l; i++) {\n            var selfAttr = selfAttrs[i];\n            if (selfAttr.name !== 'id') {\n              cloneAttrs[cloneAttrs.length] = {\n                name: selfAttr.name,\n                value: selfAttr.value\n              };\n              cloneAttrs.map[selfAttr.name] = selfAttr.value;\n            }\n          }\n          clone.attributes = cloneAttrs;\n        }\n        clone.value = self.value;\n        clone.shortEnded = self.shortEnded;\n        return clone;\n      };\n      AstNode.prototype.wrap = function (wrapper) {\n        var self = this;\n        self.parent.insert(wrapper, self);\n        wrapper.append(self);\n        return self;\n      };\n      AstNode.prototype.unwrap = function () {\n        var self = this;\n        for (var node = self.firstChild; node;) {\n          var next = node.next;\n          self.insert(node, self, true);\n          node = next;\n        }\n        self.remove();\n      };\n      AstNode.prototype.remove = function () {\n        var self = this, parent = self.parent, next = self.next, prev = self.prev;\n        if (parent) {\n          if (parent.firstChild === self) {\n            parent.firstChild = next;\n            if (next) {\n              next.prev = null;\n            }\n          } else {\n            prev.next = next;\n          }\n          if (parent.lastChild === self) {\n            parent.lastChild = prev;\n            if (prev) {\n              prev.next = null;\n            }\n          } else {\n            next.prev = prev;\n          }\n          self.parent = self.next = self.prev = null;\n        }\n        return self;\n      };\n      AstNode.prototype.append = function (node) {\n        var self = this;\n        if (node.parent) {\n          node.remove();\n        }\n        var last = self.lastChild;\n        if (last) {\n          last.next = node;\n          node.prev = last;\n          self.lastChild = node;\n        } else {\n          self.lastChild = self.firstChild = node;\n        }\n        node.parent = self;\n        return node;\n      };\n      AstNode.prototype.insert = function (node, refNode, before) {\n        if (node.parent) {\n          node.remove();\n        }\n        var parent = refNode.parent || this;\n        if (before) {\n          if (refNode === parent.firstChild) {\n            parent.firstChild = node;\n          } else {\n            refNode.prev.next = node;\n          }\n          node.prev = refNode.prev;\n          node.next = refNode;\n          refNode.prev = node;\n        } else {\n          if (refNode === parent.lastChild) {\n            parent.lastChild = node;\n          } else {\n            refNode.next.prev = node;\n          }\n          node.next = refNode.next;\n          node.prev = refNode;\n          refNode.next = node;\n        }\n        node.parent = parent;\n        return node;\n      };\n      AstNode.prototype.getAll = function (name) {\n        var self = this;\n        var collection = [];\n        for (var node = self.firstChild; node; node = walk$2(node, self)) {\n          if (node.name === name) {\n            collection.push(node);\n          }\n        }\n        return collection;\n      };\n      AstNode.prototype.empty = function () {\n        var self = this;\n        if (self.firstChild) {\n          var nodes = [];\n          for (var node = self.firstChild; node; node = walk$2(node, self)) {\n            nodes.push(node);\n          }\n          var i = nodes.length;\n          while (i--) {\n            var node = nodes[i];\n            node.parent = node.firstChild = node.lastChild = node.next = node.prev = null;\n          }\n        }\n        self.firstChild = self.lastChild = null;\n        return self;\n      };\n      AstNode.prototype.isEmpty = function (elements, whitespace, predicate) {\n        if (whitespace === void 0) {\n          whitespace = {};\n        }\n        var self = this;\n        var node = self.firstChild;\n        if (isNonEmptyElement(self)) {\n          return false;\n        }\n        if (node) {\n          do {\n            if (node.type === 1) {\n              if (node.attr('data-mce-bogus')) {\n                continue;\n              }\n              if (elements[node.name]) {\n                return false;\n              }\n              if (isNonEmptyElement(node)) {\n                return false;\n              }\n            }\n            if (node.type === 8) {\n              return false;\n            }\n            if (node.type === 3 && !isEmptyTextNode$1(node)) {\n              return false;\n            }\n            if (node.type === 3 && node.parent && whitespace[node.parent.name] && isWhitespaceText(node.value)) {\n              return false;\n            }\n            if (predicate && predicate(node)) {\n              return false;\n            }\n          } while (node = walk$2(node, self));\n        }\n        return true;\n      };\n      AstNode.prototype.walk = function (prev) {\n        return walk$2(this, null, prev);\n      };\n      return AstNode;\n    }();\n\n    var extractBase64DataUris = function (html) {\n      var dataImageUri = /data:[^;]+;base64,([a-z0-9\\+\\/=]+)/gi;\n      var chunks = [];\n      var uris = {};\n      var prefix = generate$1('img');\n      var matches;\n      var index = 0;\n      var count = 0;\n      while (matches = dataImageUri.exec(html)) {\n        var uri = matches[0];\n        var imageId = prefix + '_' + count++;\n        uris[imageId] = uri;\n        if (index < matches.index) {\n          chunks.push(html.substr(index, matches.index - index));\n        }\n        chunks.push(imageId);\n        index = matches.index + uri.length;\n      }\n      var re = new RegExp(prefix + '_[0-9]+', 'g');\n      if (index === 0) {\n        return {\n          prefix: prefix,\n          uris: uris,\n          html: html,\n          re: re\n        };\n      } else {\n        if (index < html.length) {\n          chunks.push(html.substr(index));\n        }\n        return {\n          prefix: prefix,\n          uris: uris,\n          html: chunks.join(''),\n          re: re\n        };\n      }\n    };\n    var restoreDataUris = function (html, result) {\n      return html.replace(result.re, function (imageId) {\n        return get$1(result.uris, imageId).getOr(imageId);\n      });\n    };\n    var parseDataUri = function (uri) {\n      var matches = /data:([^;]+);base64,([a-z0-9\\+\\/=]+)/i.exec(uri);\n      if (matches) {\n        return Optional.some({\n          type: matches[1],\n          data: decodeURIComponent(matches[2])\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n\n    var safeSvgDataUrlElements = [\n      'img',\n      'video'\n    ];\n    var isValidPrefixAttrName = function (name) {\n      return name.indexOf('data-') === 0 || name.indexOf('aria-') === 0;\n    };\n    var blockSvgDataUris = function (allowSvgDataUrls, tagName) {\n      var allowed = isNullable(allowSvgDataUrls) ? contains(safeSvgDataUrlElements, tagName) : allowSvgDataUrls;\n      return !allowed;\n    };\n    var isInvalidUri = function (settings, uri, tagName) {\n      if (settings.allow_html_data_urls) {\n        return false;\n      } else if (/^data:image\\//i.test(uri)) {\n        return blockSvgDataUris(settings.allow_svg_data_urls, tagName) && /^data:image\\/svg\\+xml/i.test(uri);\n      } else {\n        return /^data:/i.test(uri);\n      }\n    };\n    var findEndTagIndex = function (schema, html, startIndex) {\n      var count = 1, index, matches;\n      var shortEndedElements = schema.getShortEndedElements();\n      var tokenRegExp = /<([!?\\/])?([A-Za-z0-9\\-_:.]+)(\\s(?:[^'\">]+(?:\"[^\"]*\"|'[^']*'))*[^\"'>]*(?:\"[^\">]*|'[^'>]*)?|\\s*|\\/)>/g;\n      tokenRegExp.lastIndex = index = startIndex;\n      while (matches = tokenRegExp.exec(html)) {\n        index = tokenRegExp.lastIndex;\n        if (matches[1] === '/') {\n          count--;\n        } else if (!matches[1]) {\n          if (matches[2] in shortEndedElements) {\n            continue;\n          }\n          count++;\n        }\n        if (count === 0) {\n          break;\n        }\n      }\n      return index;\n    };\n    var isConditionalComment = function (html, startIndex) {\n      return /^\\s*\\[if [\\w\\W]+\\]>.*<!\\[endif\\](--!?)?>/.test(html.substr(startIndex));\n    };\n    var findCommentEndIndex = function (html, isBogus, startIndex) {\n      if (startIndex === void 0) {\n        startIndex = 0;\n      }\n      var lcHtml = html.toLowerCase();\n      if (lcHtml.indexOf('[if ', startIndex) !== -1 && isConditionalComment(lcHtml, startIndex)) {\n        var endIfIndex = lcHtml.indexOf('[endif]', startIndex);\n        return lcHtml.indexOf('>', endIfIndex);\n      } else {\n        if (isBogus) {\n          var endIndex = lcHtml.indexOf('>', startIndex);\n          return endIndex !== -1 ? endIndex : lcHtml.length;\n        } else {\n          var endCommentRegexp = /--!?>/g;\n          endCommentRegexp.lastIndex = startIndex;\n          var match = endCommentRegexp.exec(html);\n          return match ? match.index + match[0].length : lcHtml.length;\n        }\n      }\n    };\n    var checkBogusAttribute = function (regExp, attrString) {\n      var matches = regExp.exec(attrString);\n      if (matches) {\n        var name_1 = matches[1];\n        var value = matches[2];\n        return typeof name_1 === 'string' && name_1.toLowerCase() === 'data-mce-bogus' ? value : null;\n      } else {\n        return null;\n      }\n    };\n    var SaxParser = function (settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      settings = settings || {};\n      if (settings.fix_self_closing !== false) {\n        settings.fix_self_closing = true;\n      }\n      var comment = settings.comment ? settings.comment : noop;\n      var cdata = settings.cdata ? settings.cdata : noop;\n      var text = settings.text ? settings.text : noop;\n      var start = settings.start ? settings.start : noop;\n      var end = settings.end ? settings.end : noop;\n      var pi = settings.pi ? settings.pi : noop;\n      var doctype = settings.doctype ? settings.doctype : noop;\n      var parseInternal = function (base64Extract, format) {\n        if (format === void 0) {\n          format = 'html';\n        }\n        var html = base64Extract.html;\n        var matches, index = 0, value, endRegExp;\n        var stack = [];\n        var attrList, i, textData, name;\n        var isInternalElement, isShortEnded;\n        var elementRule, isValidElement, attr, attribsValue, validAttributesMap, validAttributePatterns;\n        var attributesRequired, attributesDefault, attributesForced;\n        var anyAttributesRequired, attrValue, idCount = 0;\n        var decode = Entities.decode;\n        var filteredUrlAttrs = Tools.makeMap('src,href,data,background,action,formaction,poster,xlink:href');\n        var scriptUriRegExp = /((java|vb)script|mhtml):/i;\n        var parsingMode = format === 'html' ? 0 : 1;\n        var processEndTag = function (name) {\n          var pos, i;\n          pos = stack.length;\n          while (pos--) {\n            if (stack[pos].name === name) {\n              break;\n            }\n          }\n          if (pos >= 0) {\n            for (i = stack.length - 1; i >= pos; i--) {\n              name = stack[i];\n              if (name.valid) {\n                end(name.name);\n              }\n            }\n            stack.length = pos;\n          }\n        };\n        var processText = function (value, raw) {\n          return text(restoreDataUris(value, base64Extract), raw);\n        };\n        var processComment = function (value) {\n          if (value === '') {\n            return;\n          }\n          if (value.charAt(0) === '>') {\n            value = ' ' + value;\n          }\n          if (!settings.allow_conditional_comments && value.substr(0, 3).toLowerCase() === '[if') {\n            value = ' ' + value;\n          }\n          comment(restoreDataUris(value, base64Extract));\n        };\n        var processAttr = function (value) {\n          return restoreDataUris(value, base64Extract);\n        };\n        var processMalformedComment = function (value, startIndex) {\n          var startTag = value || '';\n          var isBogus = !startsWith(startTag, '--');\n          var endIndex = findCommentEndIndex(html, isBogus, startIndex);\n          value = html.substr(startIndex, endIndex - startIndex);\n          processComment(isBogus ? startTag + value : value);\n          return endIndex + 1;\n        };\n        var parseAttribute = function (tagName, name, value, val2, val3) {\n          var attrRule, i;\n          var trimRegExp = /[\\s\\u0000-\\u001F]+/g;\n          name = name.toLowerCase();\n          value = processAttr(name in fillAttrsMap ? name : decode(value || val2 || val3 || ''));\n          if (validate && !isInternalElement && isValidPrefixAttrName(name) === false) {\n            attrRule = validAttributesMap[name];\n            if (!attrRule && validAttributePatterns) {\n              i = validAttributePatterns.length;\n              while (i--) {\n                attrRule = validAttributePatterns[i];\n                if (attrRule.pattern.test(name)) {\n                  break;\n                }\n              }\n              if (i === -1) {\n                attrRule = null;\n              }\n            }\n            if (!attrRule) {\n              return;\n            }\n            if (attrRule.validValues && !(value in attrRule.validValues)) {\n              return;\n            }\n          }\n          if (filteredUrlAttrs[name] && !settings.allow_script_urls) {\n            var uri = value.replace(trimRegExp, '');\n            try {\n              uri = decodeURIComponent(uri);\n            } catch (ex) {\n              uri = unescape(uri);\n            }\n            if (scriptUriRegExp.test(uri)) {\n              return;\n            }\n            if (isInvalidUri(settings, uri, tagName)) {\n              return;\n            }\n          }\n          if (isInternalElement && (name in filteredUrlAttrs || name.indexOf('on') === 0)) {\n            return;\n          }\n          attrList.map[name] = value;\n          attrList.push({\n            name: name,\n            value: value\n          });\n        };\n        var tokenRegExp = new RegExp('<(?:' + '(?:!--([\\\\w\\\\W]*?)--!?>)|' + '(?:!\\\\[CDATA\\\\[([\\\\w\\\\W]*?)\\\\]\\\\]>)|' + '(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\\\w\\\\W]*?)>)|' + '(?:!(--)?)|' + '(?:\\\\?([^\\\\s\\\\/<>]+) ?([\\\\w\\\\W]*?)[?/]>)|' + '(?:\\\\/([A-Za-z][A-Za-z0-9\\\\-_\\\\:\\\\.]*)>)|' + '(?:([A-Za-z][A-Za-z0-9\\\\-_:.]*)(\\\\s(?:[^\\'\">]+(?:\"[^\"]*\"|\\'[^\\']*\\'))*[^\"\\'>]*(?:\"[^\">]*|\\'[^\\'>]*)?|\\\\s*|\\\\/)>)' + ')', 'g');\n        var attrRegExp = /([\\w:\\-]+)(?:\\s*=\\s*(?:(?:\\\"((?:[^\\\"])*)\\\")|(?:\\'((?:[^\\'])*)\\')|([^>\\s]+)))?/g;\n        var shortEndedElements = schema.getShortEndedElements();\n        var selfClosing = settings.self_closing_elements || schema.getSelfClosingElements();\n        var fillAttrsMap = schema.getBoolAttrs();\n        var validate = settings.validate;\n        var removeInternalElements = settings.remove_internals;\n        var fixSelfClosing = settings.fix_self_closing;\n        var specialElements = schema.getSpecialElements();\n        var processHtml = html + '>';\n        while (matches = tokenRegExp.exec(processHtml)) {\n          var matchText = matches[0];\n          if (index < matches.index) {\n            processText(decode(html.substr(index, matches.index - index)));\n          }\n          if (value = matches[7]) {\n            value = value.toLowerCase();\n            if (value.charAt(0) === ':') {\n              value = value.substr(1);\n            }\n            processEndTag(value);\n          } else if (value = matches[8]) {\n            if (matches.index + matchText.length > html.length) {\n              processText(decode(html.substr(matches.index)));\n              index = matches.index + matchText.length;\n              continue;\n            }\n            value = value.toLowerCase();\n            if (value.charAt(0) === ':') {\n              value = value.substr(1);\n            }\n            isShortEnded = value in shortEndedElements;\n            if (fixSelfClosing && selfClosing[value] && stack.length > 0 && stack[stack.length - 1].name === value) {\n              processEndTag(value);\n            }\n            var bogusValue = checkBogusAttribute(attrRegExp, matches[9]);\n            if (bogusValue !== null) {\n              if (bogusValue === 'all') {\n                index = findEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                tokenRegExp.lastIndex = index;\n                continue;\n              }\n              isValidElement = false;\n            }\n            if (!validate || (elementRule = schema.getElementRule(value))) {\n              isValidElement = true;\n              if (validate) {\n                validAttributesMap = elementRule.attributes;\n                validAttributePatterns = elementRule.attributePatterns;\n              }\n              if (attribsValue = matches[9]) {\n                isInternalElement = attribsValue.indexOf('data-mce-type') !== -1;\n                if (isInternalElement && removeInternalElements) {\n                  isValidElement = false;\n                }\n                attrList = [];\n                attrList.map = {};\n                attribsValue.replace(attrRegExp, function (match, name, val, val2, val3) {\n                  parseAttribute(value, name, val, val2, val3);\n                  return '';\n                });\n              } else {\n                attrList = [];\n                attrList.map = {};\n              }\n              if (validate && !isInternalElement) {\n                attributesRequired = elementRule.attributesRequired;\n                attributesDefault = elementRule.attributesDefault;\n                attributesForced = elementRule.attributesForced;\n                anyAttributesRequired = elementRule.removeEmptyAttrs;\n                if (anyAttributesRequired && !attrList.length) {\n                  isValidElement = false;\n                }\n                if (attributesForced) {\n                  i = attributesForced.length;\n                  while (i--) {\n                    attr = attributesForced[i];\n                    name = attr.name;\n                    attrValue = attr.value;\n                    if (attrValue === '{$uid}') {\n                      attrValue = 'mce_' + idCount++;\n                    }\n                    attrList.map[name] = attrValue;\n                    attrList.push({\n                      name: name,\n                      value: attrValue\n                    });\n                  }\n                }\n                if (attributesDefault) {\n                  i = attributesDefault.length;\n                  while (i--) {\n                    attr = attributesDefault[i];\n                    name = attr.name;\n                    if (!(name in attrList.map)) {\n                      attrValue = attr.value;\n                      if (attrValue === '{$uid}') {\n                        attrValue = 'mce_' + idCount++;\n                      }\n                      attrList.map[name] = attrValue;\n                      attrList.push({\n                        name: name,\n                        value: attrValue\n                      });\n                    }\n                  }\n                }\n                if (attributesRequired) {\n                  i = attributesRequired.length;\n                  while (i--) {\n                    if (attributesRequired[i] in attrList.map) {\n                      break;\n                    }\n                  }\n                  if (i === -1) {\n                    isValidElement = false;\n                  }\n                }\n                if (attr = attrList.map['data-mce-bogus']) {\n                  if (attr === 'all') {\n                    index = findEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                    tokenRegExp.lastIndex = index;\n                    continue;\n                  }\n                  isValidElement = false;\n                }\n              }\n              if (isValidElement) {\n                start(value, attrList, isShortEnded);\n              }\n            } else {\n              isValidElement = false;\n            }\n            if (endRegExp = specialElements[value]) {\n              endRegExp.lastIndex = index = matches.index + matchText.length;\n              if (matches = endRegExp.exec(html)) {\n                if (isValidElement) {\n                  textData = html.substr(index, matches.index - index);\n                }\n                index = matches.index + matches[0].length;\n              } else {\n                textData = html.substr(index);\n                index = html.length;\n              }\n              if (isValidElement) {\n                if (textData.length > 0) {\n                  processText(textData, true);\n                }\n                end(value);\n              }\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n            if (!isShortEnded) {\n              if (!attribsValue || attribsValue.indexOf('/') !== attribsValue.length - 1) {\n                stack.push({\n                  name: value,\n                  valid: isValidElement\n                });\n              } else if (isValidElement) {\n                end(value);\n              }\n            }\n          } else if (value = matches[1]) {\n            processComment(value);\n          } else if (value = matches[2]) {\n            var isValidCdataSection = parsingMode === 1 || settings.preserve_cdata || stack.length > 0 && schema.isValidChild(stack[stack.length - 1].name, '#cdata');\n            if (isValidCdataSection) {\n              cdata(value);\n            } else {\n              index = processMalformedComment('', matches.index + 2);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n          } else if (value = matches[3]) {\n            doctype(value);\n          } else if ((value = matches[4]) || matchText === '<!') {\n            index = processMalformedComment(value, matches.index + matchText.length);\n            tokenRegExp.lastIndex = index;\n            continue;\n          } else if (value = matches[5]) {\n            if (parsingMode === 1) {\n              pi(value, matches[6]);\n            } else {\n              index = processMalformedComment('?', matches.index + 2);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n          }\n          index = matches.index + matchText.length;\n        }\n        if (index < html.length) {\n          processText(decode(html.substr(index)));\n        }\n        for (i = stack.length - 1; i >= 0; i--) {\n          value = stack[i];\n          if (value.valid) {\n            end(value.name);\n          }\n        }\n      };\n      var parse = function (html, format) {\n        if (format === void 0) {\n          format = 'html';\n        }\n        parseInternal(extractBase64DataUris(html), format);\n      };\n      return { parse: parse };\n    };\n    SaxParser.findEndTag = findEndTagIndex;\n\n    var trimHtml = function (tempAttrs, html) {\n      var trimContentRegExp = new RegExp(['\\\\s?(' + tempAttrs.join('|') + ')=\"[^\"]+\"'].join('|'), 'gi');\n      return html.replace(trimContentRegExp, '');\n    };\n    var trimInternal = function (serializer, html) {\n      var content = html;\n      var bogusAllRegExp = /<(\\w+) [^>]*data-mce-bogus=\"all\"[^>]*>/g;\n      var endTagIndex, index, matchLength, matches;\n      var schema = serializer.schema;\n      content = trimHtml(serializer.getTempAttrs(), content);\n      var shortEndedElements = schema.getShortEndedElements();\n      while (matches = bogusAllRegExp.exec(content)) {\n        index = bogusAllRegExp.lastIndex;\n        matchLength = matches[0].length;\n        if (shortEndedElements[matches[1]]) {\n          endTagIndex = index;\n        } else {\n          endTagIndex = SaxParser.findEndTag(schema, content, index);\n        }\n        content = content.substring(0, index - matchLength) + content.substring(endTagIndex);\n        bogusAllRegExp.lastIndex = index - matchLength;\n      }\n      return trim$2(content);\n    };\n    var trimExternal = trimInternal;\n\n    var trimEmptyContents = function (editor, html) {\n      var blockName = getForcedRootBlock(editor);\n      var emptyRegExp = new RegExp('^(<' + blockName + '[^>]*>(&nbsp;|&#160;|\\\\s|\\xA0|<br \\\\/>|)<\\\\/' + blockName + '>[\\r\\n]*|<br \\\\/>[\\r\\n]*)$');\n      return html.replace(emptyRegExp, '');\n    };\n    var getContentFromBody = function (editor, args, format, body) {\n      var content;\n      args.format = format;\n      args.get = true;\n      args.getInner = true;\n      if (!args.no_events) {\n        editor.fire('BeforeGetContent', args);\n      }\n      if (args.format === 'raw') {\n        content = Tools.trim(trimExternal(editor.serializer, body.innerHTML));\n      } else if (args.format === 'text') {\n        content = editor.dom.isEmpty(body) ? '' : trim$2(body.innerText || body.textContent);\n      } else if (args.format === 'tree') {\n        content = editor.serializer.serialize(body, args);\n      } else {\n        content = trimEmptyContents(editor, editor.serializer.serialize(body, args));\n      }\n      if (!contains([\n          'text',\n          'tree'\n        ], args.format) && !isWsPreserveElement(SugarElement.fromDom(body))) {\n        args.content = Tools.trim(content);\n      } else {\n        args.content = content;\n      }\n      if (!args.no_events) {\n        editor.fire('GetContent', args);\n      }\n      return args.content;\n    };\n    var getContentInternal = function (editor, args, format) {\n      return Optional.from(editor.getBody()).fold(constant(args.format === 'tree' ? new AstNode('body', 11) : ''), function (body) {\n        return getContentFromBody(editor, args, format, body);\n      });\n    };\n\n    var each$7 = Tools.each;\n    var ElementUtils = function (dom) {\n      var compare = function (node1, node2) {\n        if (node1.nodeName !== node2.nodeName) {\n          return false;\n        }\n        var getAttribs = function (node) {\n          var attribs = {};\n          each$7(dom.getAttribs(node), function (attr) {\n            var name = attr.nodeName.toLowerCase();\n            if (name.indexOf('_') !== 0 && name !== 'style' && name.indexOf('data-') !== 0) {\n              attribs[name] = dom.getAttrib(node, name);\n            }\n          });\n          return attribs;\n        };\n        var compareObjects = function (obj1, obj2) {\n          var value, name;\n          for (name in obj1) {\n            if (obj1.hasOwnProperty(name)) {\n              value = obj2[name];\n              if (typeof value === 'undefined') {\n                return false;\n              }\n              if (obj1[name] !== value) {\n                return false;\n              }\n              delete obj2[name];\n            }\n          }\n          for (name in obj2) {\n            if (obj2.hasOwnProperty(name)) {\n              return false;\n            }\n          }\n          return true;\n        };\n        if (!compareObjects(getAttribs(node1), getAttribs(node2))) {\n          return false;\n        }\n        if (!compareObjects(dom.parseStyle(dom.getAttrib(node1, 'style')), dom.parseStyle(dom.getAttrib(node2, 'style')))) {\n          return false;\n        }\n        return !isBookmarkNode$1(node1) && !isBookmarkNode$1(node2);\n      };\n      return { compare: compare };\n    };\n\n    var makeMap$3 = Tools.makeMap;\n    var Writer = function (settings) {\n      var html = [];\n      settings = settings || {};\n      var indent = settings.indent;\n      var indentBefore = makeMap$3(settings.indent_before || '');\n      var indentAfter = makeMap$3(settings.indent_after || '');\n      var encode = Entities.getEncodeFunc(settings.entity_encoding || 'raw', settings.entities);\n      var htmlOutput = settings.element_format === 'html';\n      return {\n        start: function (name, attrs, empty) {\n          var i, l, attr, value;\n          if (indent && indentBefore[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n          html.push('<', name);\n          if (attrs) {\n            for (i = 0, l = attrs.length; i < l; i++) {\n              attr = attrs[i];\n              html.push(' ', attr.name, '=\"', encode(attr.value, true), '\"');\n            }\n          }\n          if (!empty || htmlOutput) {\n            html[html.length] = '>';\n          } else {\n            html[html.length] = ' />';\n          }\n          if (empty && indent && indentAfter[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n        },\n        end: function (name) {\n          var value;\n          html.push('</', name, '>');\n          if (indent && indentAfter[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n        },\n        text: function (text, raw) {\n          if (text.length > 0) {\n            html[html.length] = raw ? text : encode(text);\n          }\n        },\n        cdata: function (text) {\n          html.push('<![CDATA[', text, ']]>');\n        },\n        comment: function (text) {\n          html.push('<!--', text, '-->');\n        },\n        pi: function (name, text) {\n          if (text) {\n            html.push('<?', name, ' ', encode(text), '?>');\n          } else {\n            html.push('<?', name, '?>');\n          }\n          if (indent) {\n            html.push('\\n');\n          }\n        },\n        doctype: function (text) {\n          html.push('<!DOCTYPE', text, '>', indent ? '\\n' : '');\n        },\n        reset: function () {\n          html.length = 0;\n        },\n        getContent: function () {\n          return html.join('').replace(/\\n$/, '');\n        }\n      };\n    };\n\n    var HtmlSerializer = function (settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      var writer = Writer(settings);\n      settings = settings || {};\n      settings.validate = 'validate' in settings ? settings.validate : true;\n      var serialize = function (node) {\n        var validate = settings.validate;\n        var handlers = {\n          3: function (node) {\n            writer.text(node.value, node.raw);\n          },\n          8: function (node) {\n            writer.comment(node.value);\n          },\n          7: function (node) {\n            writer.pi(node.name, node.value);\n          },\n          10: function (node) {\n            writer.doctype(node.value);\n          },\n          4: function (node) {\n            writer.cdata(node.value);\n          },\n          11: function (node) {\n            if (node = node.firstChild) {\n              do {\n                walk(node);\n              } while (node = node.next);\n            }\n          }\n        };\n        writer.reset();\n        var walk = function (node) {\n          var handler = handlers[node.type];\n          var name, isEmpty, attrs, attrName, attrValue, sortedAttrs, i, l, elementRule;\n          if (!handler) {\n            name = node.name;\n            isEmpty = node.shortEnded;\n            attrs = node.attributes;\n            if (validate && attrs && attrs.length > 1) {\n              sortedAttrs = [];\n              sortedAttrs.map = {};\n              elementRule = schema.getElementRule(node.name);\n              if (elementRule) {\n                for (i = 0, l = elementRule.attributesOrder.length; i < l; i++) {\n                  attrName = elementRule.attributesOrder[i];\n                  if (attrName in attrs.map) {\n                    attrValue = attrs.map[attrName];\n                    sortedAttrs.map[attrName] = attrValue;\n                    sortedAttrs.push({\n                      name: attrName,\n                      value: attrValue\n                    });\n                  }\n                }\n                for (i = 0, l = attrs.length; i < l; i++) {\n                  attrName = attrs[i].name;\n                  if (!(attrName in sortedAttrs.map)) {\n                    attrValue = attrs.map[attrName];\n                    sortedAttrs.map[attrName] = attrValue;\n                    sortedAttrs.push({\n                      name: attrName,\n                      value: attrValue\n                    });\n                  }\n                }\n                attrs = sortedAttrs;\n              }\n            }\n            writer.start(node.name, attrs, isEmpty);\n            if (!isEmpty) {\n              if (node = node.firstChild) {\n                do {\n                  walk(node);\n                } while (node = node.next);\n              }\n              writer.end(name);\n            }\n          } else {\n            handler(node);\n          }\n        };\n        if (node.type === 1 && !settings.inner) {\n          walk(node);\n        } else {\n          handlers[11](node);\n        }\n        return writer.getContent();\n      };\n      return { serialize: serialize };\n    };\n\n    var isChar = function (forward, predicate, pos) {\n      return Optional.from(pos.container()).filter(isText$1).exists(function (text) {\n        var delta = forward ? 0 : -1;\n        return predicate(text.data.charAt(pos.offset() + delta));\n      });\n    };\n    var isBeforeSpace = curry(isChar, true, isWhiteSpace$1);\n    var isAfterSpace = curry(isChar, false, isWhiteSpace$1);\n    var isEmptyText = function (pos) {\n      var container = pos.container();\n      return isText$1(container) && (container.data.length === 0 || isZwsp$1(container.data) && BookmarkManager.isBookmarkNode(container.parentNode));\n    };\n    var matchesElementPosition = function (before, predicate) {\n      return function (pos) {\n        return Optional.from(getChildNodeAtRelativeOffset(before ? 0 : -1, pos)).filter(predicate).isSome();\n      };\n    };\n    var isImageBlock = function (node) {\n      return isImg(node) && get$5(SugarElement.fromDom(node), 'display') === 'block';\n    };\n    var isCefNode = function (node) {\n      return isContentEditableFalse(node) && !isBogusAll(node);\n    };\n    var isBeforeImageBlock = matchesElementPosition(true, isImageBlock);\n    var isAfterImageBlock = matchesElementPosition(false, isImageBlock);\n    var isBeforeMedia = matchesElementPosition(true, isMedia);\n    var isAfterMedia = matchesElementPosition(false, isMedia);\n    var isBeforeTable = matchesElementPosition(true, isTable);\n    var isAfterTable = matchesElementPosition(false, isTable);\n    var isBeforeContentEditableFalse = matchesElementPosition(true, isCefNode);\n    var isAfterContentEditableFalse = matchesElementPosition(false, isCefNode);\n\n    var getLastChildren$1 = function (elm) {\n      var children = [];\n      var rawNode = elm.dom;\n      while (rawNode) {\n        children.push(SugarElement.fromDom(rawNode));\n        rawNode = rawNode.lastChild;\n      }\n      return children;\n    };\n    var removeTrailingBr = function (elm) {\n      var allBrs = descendants$1(elm, 'br');\n      var brs = filter(getLastChildren$1(elm).slice(-1), isBr$1);\n      if (allBrs.length === brs.length) {\n        each(brs, remove);\n      }\n    };\n    var fillWithPaddingBr = function (elm) {\n      empty(elm);\n      append(elm, SugarElement.fromHtml('<br data-mce-bogus=\"1\">'));\n    };\n    var trimBlockTrailingBr = function (elm) {\n      lastChild(elm).each(function (lastChild) {\n        prevSibling(lastChild).each(function (lastChildPrevSibling) {\n          if (isBlock(elm) && isBr$1(lastChild) && isBlock(lastChildPrevSibling)) {\n            remove(lastChild);\n          }\n        });\n      });\n    };\n\n    var dropLast = function (xs) {\n      return xs.slice(0, -1);\n    };\n    var parentsUntil$1 = function (start, root, predicate) {\n      if (contains$2(root, start)) {\n        return dropLast(parents(start, function (elm) {\n          return predicate(elm) || eq$2(elm, root);\n        }));\n      } else {\n        return [];\n      }\n    };\n    var parents$1 = function (start, root) {\n      return parentsUntil$1(start, root, never);\n    };\n    var parentsAndSelf = function (start, root) {\n      return [start].concat(parents$1(start, root));\n    };\n\n    var navigateIgnoreEmptyTextNodes = function (forward, root, from) {\n      return navigateIgnore(forward, root, from, isEmptyText);\n    };\n    var getClosestBlock = function (root, pos) {\n      return find(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock);\n    };\n    var isAtBeforeAfterBlockBoundary = function (forward, root, pos) {\n      return navigateIgnoreEmptyTextNodes(forward, root.dom, pos).forall(function (newPos) {\n        return getClosestBlock(root, pos).fold(function () {\n          return isInSameBlock(newPos, pos, root.dom) === false;\n        }, function (fromBlock) {\n          return isInSameBlock(newPos, pos, root.dom) === false && contains$2(fromBlock, SugarElement.fromDom(newPos.container()));\n        });\n      });\n    };\n    var isAtBlockBoundary$1 = function (forward, root, pos) {\n      return getClosestBlock(root, pos).fold(function () {\n        return navigateIgnoreEmptyTextNodes(forward, root.dom, pos).forall(function (newPos) {\n          return isInSameBlock(newPos, pos, root.dom) === false;\n        });\n      }, function (parent) {\n        return navigateIgnoreEmptyTextNodes(forward, parent.dom, pos).isNone();\n      });\n    };\n    var isAtStartOfBlock = curry(isAtBlockBoundary$1, false);\n    var isAtEndOfBlock = curry(isAtBlockBoundary$1, true);\n    var isBeforeBlock = curry(isAtBeforeAfterBlockBoundary, false);\n    var isAfterBlock = curry(isAtBeforeAfterBlockBoundary, true);\n\n    var isBr$5 = function (pos) {\n      return getElementFromPosition(pos).exists(isBr$1);\n    };\n    var findBr = function (forward, root, pos) {\n      var parentBlocks = filter(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock);\n      var scope = head(parentBlocks).getOr(root);\n      return fromPosition(forward, scope.dom, pos).filter(isBr$5);\n    };\n    var isBeforeBr = function (root, pos) {\n      return getElementFromPosition(pos).exists(isBr$1) || findBr(true, root, pos).isSome();\n    };\n    var isAfterBr = function (root, pos) {\n      return getElementFromPrevPosition(pos).exists(isBr$1) || findBr(false, root, pos).isSome();\n    };\n    var findPreviousBr = curry(findBr, false);\n    var findNextBr = curry(findBr, true);\n\n    var isInMiddleOfText = function (pos) {\n      return CaretPosition.isTextPosition(pos) && !pos.isAtStart() && !pos.isAtEnd();\n    };\n    var getClosestBlock$1 = function (root, pos) {\n      var parentBlocks = filter(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock);\n      return head(parentBlocks).getOr(root);\n    };\n    var hasSpaceBefore = function (root, pos) {\n      if (isInMiddleOfText(pos)) {\n        return isAfterSpace(pos);\n      } else {\n        return isAfterSpace(pos) || prevPosition(getClosestBlock$1(root, pos).dom, pos).exists(isAfterSpace);\n      }\n    };\n    var hasSpaceAfter = function (root, pos) {\n      if (isInMiddleOfText(pos)) {\n        return isBeforeSpace(pos);\n      } else {\n        return isBeforeSpace(pos) || nextPosition(getClosestBlock$1(root, pos).dom, pos).exists(isBeforeSpace);\n      }\n    };\n    var isPreValue = function (value) {\n      return contains([\n        'pre',\n        'pre-wrap'\n      ], value);\n    };\n    var isInPre = function (pos) {\n      return getElementFromPosition(pos).bind(function (elm) {\n        return closest(elm, isElement);\n      }).exists(function (elm) {\n        return isPreValue(get$5(elm, 'white-space'));\n      });\n    };\n    var isAtBeginningOfBody = function (root, pos) {\n      return prevPosition(root.dom, pos).isNone();\n    };\n    var isAtEndOfBody = function (root, pos) {\n      return nextPosition(root.dom, pos).isNone();\n    };\n    var isAtLineBoundary = function (root, pos) {\n      return isAtBeginningOfBody(root, pos) || isAtEndOfBody(root, pos) || isAtStartOfBlock(root, pos) || isAtEndOfBlock(root, pos) || isAfterBr(root, pos) || isBeforeBr(root, pos);\n    };\n    var needsToHaveNbsp = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtLineBoundary(root, pos) || hasSpaceBefore(root, pos) || hasSpaceAfter(root, pos);\n      }\n    };\n    var needsToBeNbspLeft = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtStartOfBlock(root, pos) || isBeforeBlock(root, pos) || isAfterBr(root, pos) || hasSpaceBefore(root, pos);\n      }\n    };\n    var leanRight = function (pos) {\n      var container = pos.container();\n      var offset = pos.offset();\n      if (isText$1(container) && offset < container.data.length) {\n        return CaretPosition(container, offset + 1);\n      } else {\n        return pos;\n      }\n    };\n    var needsToBeNbspRight = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtEndOfBlock(root, pos) || isAfterBlock(root, pos) || isBeforeBr(root, pos) || hasSpaceAfter(root, pos);\n      }\n    };\n    var needsToBeNbsp = function (root, pos) {\n      return needsToBeNbspLeft(root, pos) || needsToBeNbspRight(root, leanRight(pos));\n    };\n    var isNbspAt = function (text, offset) {\n      return isNbsp(text.charAt(offset));\n    };\n    var hasNbsp = function (pos) {\n      var container = pos.container();\n      return isText$1(container) && contains$1(container.data, nbsp);\n    };\n    var normalizeNbspMiddle = function (text) {\n      var chars = text.split('');\n      return map(chars, function (chr, i) {\n        if (isNbsp(chr) && i > 0 && i < chars.length - 1 && isContent$1(chars[i - 1]) && isContent$1(chars[i + 1])) {\n          return ' ';\n        } else {\n          return chr;\n        }\n      }).join('');\n    };\n    var normalizeNbspAtStart = function (root, node) {\n      var text = node.data;\n      var firstPos = CaretPosition(node, 0);\n      if (isNbspAt(text, 0) && !needsToBeNbsp(root, firstPos)) {\n        node.data = ' ' + text.slice(1);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbspInMiddleOfTextNode = function (node) {\n      var text = node.data;\n      var newText = normalizeNbspMiddle(text);\n      if (newText !== text) {\n        node.data = newText;\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbspAtEnd = function (root, node) {\n      var text = node.data;\n      var lastPos = CaretPosition(node, text.length - 1);\n      if (isNbspAt(text, text.length - 1) && !needsToBeNbsp(root, lastPos)) {\n        node.data = text.slice(0, -1) + ' ';\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbsps = function (root, pos) {\n      return Optional.some(pos).filter(hasNbsp).bind(function (pos) {\n        var container = pos.container();\n        var normalized = normalizeNbspAtStart(root, container) || normalizeNbspInMiddleOfTextNode(container) || normalizeNbspAtEnd(root, container);\n        return normalized ? Optional.some(pos) : Optional.none();\n      });\n    };\n    var normalizeNbspsInEditor = function (editor) {\n      var root = SugarElement.fromDom(editor.getBody());\n      if (editor.selection.isCollapsed()) {\n        normalizeNbsps(root, CaretPosition.fromRangeStart(editor.selection.getRng())).each(function (pos) {\n          editor.selection.setRng(pos.toRange());\n        });\n      }\n    };\n\n    var normalizeContent = function (content, isStartOfContent, isEndOfContent) {\n      var result = foldl(content, function (acc, c) {\n        if (isWhiteSpace$1(c) || isNbsp(c)) {\n          if (acc.previousCharIsSpace || acc.str === '' && isStartOfContent || acc.str.length === content.length - 1 && isEndOfContent) {\n            return {\n              previousCharIsSpace: false,\n              str: acc.str + nbsp\n            };\n          } else {\n            return {\n              previousCharIsSpace: true,\n              str: acc.str + ' '\n            };\n          }\n        } else {\n          return {\n            previousCharIsSpace: false,\n            str: acc.str + c\n          };\n        }\n      }, {\n        previousCharIsSpace: false,\n        str: ''\n      });\n      return result.str;\n    };\n    var normalize$1 = function (node, offset, count) {\n      if (count === 0) {\n        return;\n      }\n      var elm = SugarElement.fromDom(node);\n      var root = ancestor(elm, isBlock).getOr(elm);\n      var whitespace = node.data.slice(offset, offset + count);\n      var isEndOfContent = offset + count >= node.data.length && needsToBeNbspRight(root, CaretPosition(node, node.data.length));\n      var isStartOfContent = offset === 0 && needsToBeNbspLeft(root, CaretPosition(node, 0));\n      node.replaceData(offset, count, normalizeContent(whitespace, isStartOfContent, isEndOfContent));\n    };\n    var normalizeWhitespaceAfter = function (node, offset) {\n      var content = node.data.slice(offset);\n      var whitespaceCount = content.length - lTrim(content).length;\n      return normalize$1(node, offset, whitespaceCount);\n    };\n    var normalizeWhitespaceBefore = function (node, offset) {\n      var content = node.data.slice(0, offset);\n      var whitespaceCount = content.length - rTrim(content).length;\n      return normalize$1(node, offset - whitespaceCount, whitespaceCount);\n    };\n    var mergeTextNodes = function (prevNode, nextNode, normalizeWhitespace, mergeToPrev) {\n      if (mergeToPrev === void 0) {\n        mergeToPrev = true;\n      }\n      var whitespaceOffset = rTrim(prevNode.data).length;\n      var newNode = mergeToPrev ? prevNode : nextNode;\n      var removeNode = mergeToPrev ? nextNode : prevNode;\n      if (mergeToPrev) {\n        newNode.appendData(removeNode.data);\n      } else {\n        newNode.insertData(0, removeNode.data);\n      }\n      remove(SugarElement.fromDom(removeNode));\n      if (normalizeWhitespace) {\n        normalizeWhitespaceAfter(newNode, whitespaceOffset);\n      }\n      return newNode;\n    };\n\n    var needsReposition = function (pos, elm) {\n      var container = pos.container();\n      var offset = pos.offset();\n      return CaretPosition.isTextPosition(pos) === false && container === elm.parentNode && offset > CaretPosition.before(elm).offset();\n    };\n    var reposition = function (elm, pos) {\n      return needsReposition(pos, elm) ? CaretPosition(pos.container(), pos.offset() - 1) : pos;\n    };\n    var beforeOrStartOf = function (node) {\n      return isText$1(node) ? CaretPosition(node, 0) : CaretPosition.before(node);\n    };\n    var afterOrEndOf = function (node) {\n      return isText$1(node) ? CaretPosition(node, node.data.length) : CaretPosition.after(node);\n    };\n    var getPreviousSiblingCaretPosition = function (elm) {\n      if (isCaretCandidate(elm.previousSibling)) {\n        return Optional.some(afterOrEndOf(elm.previousSibling));\n      } else {\n        return elm.previousSibling ? lastPositionIn(elm.previousSibling) : Optional.none();\n      }\n    };\n    var getNextSiblingCaretPosition = function (elm) {\n      if (isCaretCandidate(elm.nextSibling)) {\n        return Optional.some(beforeOrStartOf(elm.nextSibling));\n      } else {\n        return elm.nextSibling ? firstPositionIn(elm.nextSibling) : Optional.none();\n      }\n    };\n    var findCaretPositionBackwardsFromElm = function (rootElement, elm) {\n      var startPosition = CaretPosition.before(elm.previousSibling ? elm.previousSibling : elm.parentNode);\n      return prevPosition(rootElement, startPosition).fold(function () {\n        return nextPosition(rootElement, CaretPosition.after(elm));\n      }, Optional.some);\n    };\n    var findCaretPositionForwardsFromElm = function (rootElement, elm) {\n      return nextPosition(rootElement, CaretPosition.after(elm)).fold(function () {\n        return prevPosition(rootElement, CaretPosition.before(elm));\n      }, Optional.some);\n    };\n    var findCaretPositionBackwards = function (rootElement, elm) {\n      return getPreviousSiblingCaretPosition(elm).orThunk(function () {\n        return getNextSiblingCaretPosition(elm);\n      }).orThunk(function () {\n        return findCaretPositionBackwardsFromElm(rootElement, elm);\n      });\n    };\n    var findCaretPositionForward = function (rootElement, elm) {\n      return getNextSiblingCaretPosition(elm).orThunk(function () {\n        return getPreviousSiblingCaretPosition(elm);\n      }).orThunk(function () {\n        return findCaretPositionForwardsFromElm(rootElement, elm);\n      });\n    };\n    var findCaretPosition$1 = function (forward, rootElement, elm) {\n      return forward ? findCaretPositionForward(rootElement, elm) : findCaretPositionBackwards(rootElement, elm);\n    };\n    var findCaretPosOutsideElmAfterDelete = function (forward, rootElement, elm) {\n      return findCaretPosition$1(forward, rootElement, elm).map(curry(reposition, elm));\n    };\n    var setSelection = function (editor, forward, pos) {\n      pos.fold(function () {\n        editor.focus();\n      }, function (pos) {\n        editor.selection.setRng(pos.toRange(), forward);\n      });\n    };\n    var eqRawNode = function (rawNode) {\n      return function (elm) {\n        return elm.dom === rawNode;\n      };\n    };\n    var isBlock$2 = function (editor, elm) {\n      return elm && has(editor.schema.getBlockElements(), name(elm));\n    };\n    var paddEmptyBlock = function (elm) {\n      if (isEmpty(elm)) {\n        var br = SugarElement.fromHtml('<br data-mce-bogus=\"1\">');\n        empty(elm);\n        append(elm, br);\n        return Optional.some(CaretPosition.before(br.dom));\n      } else {\n        return Optional.none();\n      }\n    };\n    var deleteNormalized = function (elm, afterDeletePosOpt, normalizeWhitespace) {\n      var prevTextOpt = prevSibling(elm).filter(isText);\n      var nextTextOpt = nextSibling(elm).filter(isText);\n      remove(elm);\n      return lift3(prevTextOpt, nextTextOpt, afterDeletePosOpt, function (prev, next, pos) {\n        var prevNode = prev.dom, nextNode = next.dom;\n        var offset = prevNode.data.length;\n        mergeTextNodes(prevNode, nextNode, normalizeWhitespace);\n        return pos.container() === nextNode ? CaretPosition(prevNode, offset) : pos;\n      }).orThunk(function () {\n        if (normalizeWhitespace) {\n          prevTextOpt.each(function (elm) {\n            return normalizeWhitespaceBefore(elm.dom, elm.dom.length);\n          });\n          nextTextOpt.each(function (elm) {\n            return normalizeWhitespaceAfter(elm.dom, 0);\n          });\n        }\n        return afterDeletePosOpt;\n      });\n    };\n    var isInlineElement = function (editor, element) {\n      return has(editor.schema.getTextInlineElements(), name(element));\n    };\n    var deleteElement = function (editor, forward, elm, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var afterDeletePos = findCaretPosOutsideElmAfterDelete(forward, editor.getBody(), elm.dom);\n      var parentBlock = ancestor(elm, curry(isBlock$2, editor), eqRawNode(editor.getBody()));\n      var normalizedAfterDeletePos = deleteNormalized(elm, afterDeletePos, isInlineElement(editor, elm));\n      if (editor.dom.isEmpty(editor.getBody())) {\n        editor.setContent('');\n        editor.selection.setCursorLocation();\n      } else {\n        parentBlock.bind(paddEmptyBlock).fold(function () {\n          if (moveCaret) {\n            setSelection(editor, forward, normalizedAfterDeletePos);\n          }\n        }, function (paddPos) {\n          if (moveCaret) {\n            setSelection(editor, forward, Optional.some(paddPos));\n          }\n        });\n      }\n    };\n\n    var tableCellRng = function (start, end) {\n      return {\n        start: start,\n        end: end\n      };\n    };\n    var tableSelection = function (rng, table, cells) {\n      return {\n        rng: rng,\n        table: table,\n        cells: cells\n      };\n    };\n    var deleteAction = Adt.generate([\n      { removeTable: ['element'] },\n      { emptyCells: ['cells'] },\n      {\n        deleteCellSelection: [\n          'rng',\n          'cell'\n        ]\n      }\n    ]);\n    var isRootFromElement = function (root) {\n      return function (cur) {\n        return eq$2(root, cur);\n      };\n    };\n    var getClosestCell = function (container, isRoot) {\n      return closest$1(SugarElement.fromDom(container), 'td,th', isRoot);\n    };\n    var getClosestTable = function (cell, isRoot) {\n      return ancestor$1(cell, 'table', isRoot);\n    };\n    var isExpandedCellRng = function (cellRng) {\n      return !eq$2(cellRng.start, cellRng.end);\n    };\n    var getTableFromCellRng = function (cellRng, isRoot) {\n      return getClosestTable(cellRng.start, isRoot).bind(function (startParentTable) {\n        return getClosestTable(cellRng.end, isRoot).bind(function (endParentTable) {\n          return someIf(eq$2(startParentTable, endParentTable), startParentTable);\n        });\n      });\n    };\n    var isSingleCellTable = function (cellRng, isRoot) {\n      return !isExpandedCellRng(cellRng) && getTableFromCellRng(cellRng, isRoot).exists(function (table) {\n        var rows = table.dom.rows;\n        return rows.length === 1 && rows[0].cells.length === 1;\n      });\n    };\n    var getTableCells = function (table) {\n      return descendants$1(table, 'td,th');\n    };\n    var getCellRng = function (rng, isRoot) {\n      var startCell = getClosestCell(rng.startContainer, isRoot);\n      var endCell = getClosestCell(rng.endContainer, isRoot);\n      return lift2(startCell, endCell, tableCellRng);\n    };\n    var getCellRangeFromStartTable = function (cellRng, isRoot) {\n      return getClosestTable(cellRng.start, isRoot).bind(function (table) {\n        return last(getTableCells(table)).map(function (endCell) {\n          return tableCellRng(cellRng.start, endCell);\n        });\n      });\n    };\n    var partialSelection = function (isRoot, rng) {\n      var startCell = getClosestCell(rng.startContainer, isRoot);\n      var endCell = getClosestCell(rng.endContainer, isRoot);\n      return rng.collapsed ? Optional.none() : lift2(startCell, endCell, tableCellRng).fold(function () {\n        return startCell.fold(function () {\n          return endCell.bind(function (endCell) {\n            return getClosestTable(endCell, isRoot).bind(function (table) {\n              return head(getTableCells(table)).map(function (startCell) {\n                return tableCellRng(startCell, endCell);\n              });\n            });\n          });\n        }, function (startCell) {\n          return getClosestTable(startCell, isRoot).bind(function (table) {\n            return last(getTableCells(table)).map(function (endCell) {\n              return tableCellRng(startCell, endCell);\n            });\n          });\n        });\n      }, function (cellRng) {\n        return isWithinSameTable(isRoot, cellRng) ? Optional.none() : getCellRangeFromStartTable(cellRng, isRoot);\n      });\n    };\n    var isWithinSameTable = function (isRoot, cellRng) {\n      return getTableFromCellRng(cellRng, isRoot).isSome();\n    };\n    var getTableSelectionFromCellRng = function (cellRng, isRoot) {\n      return getTableFromCellRng(cellRng, isRoot).map(function (table) {\n        return tableSelection(cellRng, table, getTableCells(table));\n      });\n    };\n    var getTableSelection = function (optCellRng, rng, isRoot) {\n      return optCellRng.filter(function (cellRng) {\n        return isExpandedCellRng(cellRng) && isWithinSameTable(isRoot, cellRng);\n      }).orThunk(function () {\n        return partialSelection(isRoot, rng);\n      }).bind(function (cRng) {\n        return getTableSelectionFromCellRng(cRng, isRoot);\n      });\n    };\n    var getCellIndex = function (cells, cell) {\n      return findIndex(cells, function (x) {\n        return eq$2(x, cell);\n      });\n    };\n    var getSelectedCells = function (tableSelection) {\n      return lift2(getCellIndex(tableSelection.cells, tableSelection.rng.start), getCellIndex(tableSelection.cells, tableSelection.rng.end), function (startIndex, endIndex) {\n        return tableSelection.cells.slice(startIndex, endIndex + 1);\n      });\n    };\n    var isSingleCellTableContentSelected = function (optCellRng, rng, isRoot) {\n      return optCellRng.filter(function (cellRng) {\n        return isSingleCellTable(cellRng, isRoot) && hasAllContentsSelected(cellRng.start, rng);\n      }).map(function (cellRng) {\n        return cellRng.start;\n      });\n    };\n    var getAction = function (tableSelection) {\n      return getSelectedCells(tableSelection).map(function (selected) {\n        var cells = tableSelection.cells;\n        return selected.length === cells.length ? deleteAction.removeTable(tableSelection.table) : deleteAction.emptyCells(selected);\n      });\n    };\n    var getActionFromRange = function (root, rng) {\n      var isRoot = isRootFromElement(root);\n      var optCellRng = getCellRng(rng, isRoot);\n      return isSingleCellTableContentSelected(optCellRng, rng, isRoot).map(function (cell) {\n        return deleteAction.deleteCellSelection(rng, cell);\n      }).orThunk(function () {\n        return getTableSelection(optCellRng, rng, isRoot).bind(getAction);\n      });\n    };\n\n    var freefallRtl = function (root) {\n      var child = isComment(root) ? prevSibling(root) : lastChild(root);\n      return child.bind(freefallRtl).orThunk(function () {\n        return Optional.some(root);\n      });\n    };\n    var emptyCells = function (editor, cells) {\n      each(cells, fillWithPaddingBr);\n      editor.selection.setCursorLocation(cells[0].dom, 0);\n      return true;\n    };\n    var deleteCellContents = function (editor, rng, cell) {\n      rng.deleteContents();\n      var lastNode = freefallRtl(cell).getOr(cell);\n      var lastBlock = SugarElement.fromDom(editor.dom.getParent(lastNode.dom, editor.dom.isBlock));\n      if (isEmpty(lastBlock)) {\n        fillWithPaddingBr(lastBlock);\n        editor.selection.setCursorLocation(lastBlock.dom, 0);\n      }\n      if (!eq$2(cell, lastBlock)) {\n        var additionalCleanupNodes = parent(lastBlock).is(cell) ? [] : siblings(lastBlock);\n        each(additionalCleanupNodes.concat(children(cell)), function (node) {\n          if (!eq$2(node, lastBlock) && !contains$2(node, lastBlock)) {\n            remove(node);\n          }\n        });\n      }\n      return true;\n    };\n    var deleteTableElement = function (editor, table) {\n      deleteElement(editor, false, table);\n      return true;\n    };\n    var deleteCellRange = function (editor, rootElm, rng) {\n      return getActionFromRange(rootElm, rng).map(function (action) {\n        return action.fold(curry(deleteTableElement, editor), curry(emptyCells, editor), curry(deleteCellContents, editor));\n      });\n    };\n    var deleteCaptionRange = function (editor, caption) {\n      return emptyElement(editor, caption);\n    };\n    var deleteTableRange = function (editor, rootElm, rng, startElm) {\n      return getParentCaption(rootElm, startElm).fold(function () {\n        return deleteCellRange(editor, rootElm, rng);\n      }, function (caption) {\n        return deleteCaptionRange(editor, caption);\n      }).getOr(false);\n    };\n    var deleteRange = function (editor, startElm) {\n      var rootNode = SugarElement.fromDom(editor.getBody());\n      var rng = editor.selection.getRng();\n      var selectedCells = getCellsFromEditor(editor);\n      return selectedCells.length !== 0 ? emptyCells(editor, selectedCells) : deleteTableRange(editor, rootNode, rng, startElm);\n    };\n    var getParentCell = function (rootElm, elm) {\n      return find(parentsAndSelf(elm, rootElm), isTableCell$1);\n    };\n    var getParentCaption = function (rootElm, elm) {\n      return find(parentsAndSelf(elm, rootElm), function (elm) {\n        return name(elm) === 'caption';\n      });\n    };\n    var deleteBetweenCells = function (editor, rootElm, forward, fromCell, from) {\n      return navigate(forward, editor.getBody(), from).bind(function (to) {\n        return getParentCell(rootElm, SugarElement.fromDom(to.getNode())).map(function (toCell) {\n          return eq$2(toCell, fromCell) === false;\n        });\n      });\n    };\n    var emptyElement = function (editor, elm) {\n      fillWithPaddingBr(elm);\n      editor.selection.setCursorLocation(elm.dom, 0);\n      return Optional.some(true);\n    };\n    var isDeleteOfLastCharPos = function (fromCaption, forward, from, to) {\n      return firstPositionIn(fromCaption.dom).bind(function (first) {\n        return lastPositionIn(fromCaption.dom).map(function (last) {\n          return forward ? from.isEqual(first) && to.isEqual(last) : from.isEqual(last) && to.isEqual(first);\n        });\n      }).getOr(true);\n    };\n    var emptyCaretCaption = function (editor, elm) {\n      return emptyElement(editor, elm);\n    };\n    var validateCaretCaption = function (rootElm, fromCaption, to) {\n      return getParentCaption(rootElm, SugarElement.fromDom(to.getNode())).map(function (toCaption) {\n        return eq$2(toCaption, fromCaption) === false;\n      });\n    };\n    var deleteCaretInsideCaption = function (editor, rootElm, forward, fromCaption, from) {\n      return navigate(forward, editor.getBody(), from).bind(function (to) {\n        return isDeleteOfLastCharPos(fromCaption, forward, from, to) ? emptyCaretCaption(editor, fromCaption) : validateCaretCaption(rootElm, fromCaption, to);\n      }).or(Optional.some(true));\n    };\n    var deleteCaretCells = function (editor, forward, rootElm, startElm) {\n      var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return getParentCell(rootElm, startElm).bind(function (fromCell) {\n        return isEmpty(fromCell) ? emptyElement(editor, fromCell) : deleteBetweenCells(editor, rootElm, forward, fromCell, from);\n      }).getOr(false);\n    };\n    var deleteCaretCaption = function (editor, forward, rootElm, fromCaption) {\n      var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return isEmpty(fromCaption) ? emptyElement(editor, fromCaption) : deleteCaretInsideCaption(editor, rootElm, forward, fromCaption, from);\n    };\n    var isNearTable = function (forward, pos) {\n      return forward ? isBeforeTable(pos) : isAfterTable(pos);\n    };\n    var isBeforeOrAfterTable = function (editor, forward) {\n      var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return isNearTable(forward, fromPos) || fromPosition(forward, editor.getBody(), fromPos).exists(function (pos) {\n        return isNearTable(forward, pos);\n      });\n    };\n    var deleteCaret = function (editor, forward, startElm) {\n      var rootElm = SugarElement.fromDom(editor.getBody());\n      return getParentCaption(rootElm, startElm).fold(function () {\n        return deleteCaretCells(editor, forward, rootElm, startElm) || isBeforeOrAfterTable(editor, forward);\n      }, function (fromCaption) {\n        return deleteCaretCaption(editor, forward, rootElm, fromCaption).getOr(false);\n      });\n    };\n    var backspaceDelete = function (editor, forward) {\n      var startElm = SugarElement.fromDom(editor.selection.getStart(true));\n      var cells = getCellsFromEditor(editor);\n      return editor.selection.isCollapsed() && cells.length === 0 ? deleteCaret(editor, forward, startElm) : deleteRange(editor, startElm);\n    };\n\n    var createRange$1 = function (sc, so, ec, eo) {\n      var rng = document.createRange();\n      rng.setStart(sc, so);\n      rng.setEnd(ec, eo);\n      return rng;\n    };\n    var normalizeBlockSelectionRange = function (rng) {\n      var startPos = CaretPosition.fromRangeStart(rng);\n      var endPos = CaretPosition.fromRangeEnd(rng);\n      var rootNode = rng.commonAncestorContainer;\n      return fromPosition(false, rootNode, endPos).map(function (newEndPos) {\n        if (!isInSameBlock(startPos, endPos, rootNode) && isInSameBlock(startPos, newEndPos, rootNode)) {\n          return createRange$1(startPos.container(), startPos.offset(), newEndPos.container(), newEndPos.offset());\n        } else {\n          return rng;\n        }\n      }).getOr(rng);\n    };\n    var normalize$2 = function (rng) {\n      return rng.collapsed ? rng : normalizeBlockSelectionRange(rng);\n    };\n\n    var hasOnlyOneChild = function (node) {\n      return node.firstChild && node.firstChild === node.lastChild;\n    };\n    var isPaddingNode = function (node) {\n      return node.name === 'br' || node.value === nbsp;\n    };\n    var isPaddedEmptyBlock = function (schema, node) {\n      var blockElements = schema.getBlockElements();\n      return blockElements[node.name] && hasOnlyOneChild(node) && isPaddingNode(node.firstChild);\n    };\n    var isEmptyFragmentElement = function (schema, node) {\n      var nonEmptyElements = schema.getNonEmptyElements();\n      return node && (node.isEmpty(nonEmptyElements) || isPaddedEmptyBlock(schema, node));\n    };\n    var isListFragment = function (schema, fragment) {\n      var firstChild = fragment.firstChild;\n      var lastChild = fragment.lastChild;\n      if (firstChild && firstChild.name === 'meta') {\n        firstChild = firstChild.next;\n      }\n      if (lastChild && lastChild.attr('id') === 'mce_marker') {\n        lastChild = lastChild.prev;\n      }\n      if (isEmptyFragmentElement(schema, lastChild)) {\n        lastChild = lastChild.prev;\n      }\n      if (!firstChild || firstChild !== lastChild) {\n        return false;\n      }\n      return firstChild.name === 'ul' || firstChild.name === 'ol';\n    };\n    var cleanupDomFragment = function (domFragment) {\n      var firstChild = domFragment.firstChild;\n      var lastChild = domFragment.lastChild;\n      if (firstChild && firstChild.nodeName === 'META') {\n        firstChild.parentNode.removeChild(firstChild);\n      }\n      if (lastChild && lastChild.id === 'mce_marker') {\n        lastChild.parentNode.removeChild(lastChild);\n      }\n      return domFragment;\n    };\n    var toDomFragment = function (dom, serializer, fragment) {\n      var html = serializer.serialize(fragment);\n      var domFragment = dom.createFragment(html);\n      return cleanupDomFragment(domFragment);\n    };\n    var listItems$1 = function (elm) {\n      return Tools.grep(elm.childNodes, function (child) {\n        return child.nodeName === 'LI';\n      });\n    };\n    var isPadding = function (node) {\n      return node.data === nbsp || isBr(node);\n    };\n    var isListItemPadded = function (node) {\n      return node && node.firstChild && node.firstChild === node.lastChild && isPadding(node.firstChild);\n    };\n    var isEmptyOrPadded = function (elm) {\n      return !elm.firstChild || isListItemPadded(elm);\n    };\n    var trimListItems = function (elms) {\n      return elms.length > 0 && isEmptyOrPadded(elms[elms.length - 1]) ? elms.slice(0, -1) : elms;\n    };\n    var getParentLi = function (dom, node) {\n      var parentBlock = dom.getParent(node, dom.isBlock);\n      return parentBlock && parentBlock.nodeName === 'LI' ? parentBlock : null;\n    };\n    var isParentBlockLi = function (dom, node) {\n      return !!getParentLi(dom, node);\n    };\n    var getSplit = function (parentNode, rng) {\n      var beforeRng = rng.cloneRange();\n      var afterRng = rng.cloneRange();\n      beforeRng.setStartBefore(parentNode);\n      afterRng.setEndAfter(parentNode);\n      return [\n        beforeRng.cloneContents(),\n        afterRng.cloneContents()\n      ];\n    };\n    var findFirstIn = function (node, rootNode) {\n      var caretPos = CaretPosition.before(node);\n      var caretWalker = CaretWalker(rootNode);\n      var newCaretPos = caretWalker.next(caretPos);\n      return newCaretPos ? newCaretPos.toRange() : null;\n    };\n    var findLastOf = function (node, rootNode) {\n      var caretPos = CaretPosition.after(node);\n      var caretWalker = CaretWalker(rootNode);\n      var newCaretPos = caretWalker.prev(caretPos);\n      return newCaretPos ? newCaretPos.toRange() : null;\n    };\n    var insertMiddle = function (target, elms, rootNode, rng) {\n      var parts = getSplit(target, rng);\n      var parentElm = target.parentNode;\n      parentElm.insertBefore(parts[0], target);\n      Tools.each(elms, function (li) {\n        parentElm.insertBefore(li, target);\n      });\n      parentElm.insertBefore(parts[1], target);\n      parentElm.removeChild(target);\n      return findLastOf(elms[elms.length - 1], rootNode);\n    };\n    var insertBefore = function (target, elms, rootNode) {\n      var parentElm = target.parentNode;\n      Tools.each(elms, function (elm) {\n        parentElm.insertBefore(elm, target);\n      });\n      return findFirstIn(target, rootNode);\n    };\n    var insertAfter = function (target, elms, rootNode, dom) {\n      dom.insertAfter(elms.reverse(), target);\n      return findLastOf(elms[0], rootNode);\n    };\n    var insertAtCaret = function (serializer, dom, rng, fragment) {\n      var domFragment = toDomFragment(dom, serializer, fragment);\n      var liTarget = getParentLi(dom, rng.startContainer);\n      var liElms = trimListItems(listItems$1(domFragment.firstChild));\n      var BEGINNING = 1, END = 2;\n      var rootNode = dom.getRoot();\n      var isAt = function (location) {\n        var caretPos = CaretPosition.fromRangeStart(rng);\n        var caretWalker = CaretWalker(dom.getRoot());\n        var newPos = location === BEGINNING ? caretWalker.prev(caretPos) : caretWalker.next(caretPos);\n        return newPos ? getParentLi(dom, newPos.getNode()) !== liTarget : true;\n      };\n      if (isAt(BEGINNING)) {\n        return insertBefore(liTarget, liElms, rootNode);\n      } else if (isAt(END)) {\n        return insertAfter(liTarget, liElms, rootNode, dom);\n      }\n      return insertMiddle(liTarget, liElms, rootNode, rng);\n    };\n\n    var trimOrPadLeftRight = function (dom, rng, html) {\n      var root = SugarElement.fromDom(dom.getRoot());\n      if (needsToBeNbspLeft(root, CaretPosition.fromRangeStart(rng))) {\n        html = html.replace(/^ /, '&nbsp;');\n      } else {\n        html = html.replace(/^&nbsp;/, ' ');\n      }\n      if (needsToBeNbspRight(root, CaretPosition.fromRangeEnd(rng))) {\n        html = html.replace(/(&nbsp;| )(<br( \\/)>)?$/, '&nbsp;');\n      } else {\n        html = html.replace(/&nbsp;(<br( \\/)?>)?$/, ' ');\n      }\n      return html;\n    };\n\n    var isTableCell$4 = isTableCell;\n    var isTableCellContentSelected = function (dom, rng, cell) {\n      if (cell !== null) {\n        var endCell = dom.getParent(rng.endContainer, isTableCell$4);\n        return cell === endCell && hasAllContentsSelected(SugarElement.fromDom(cell), rng);\n      } else {\n        return false;\n      }\n    };\n    var validInsertion = function (editor, value, parentNode) {\n      if (parentNode.getAttribute('data-mce-bogus') === 'all') {\n        parentNode.parentNode.insertBefore(editor.dom.createFragment(value), parentNode);\n      } else {\n        var node = parentNode.firstChild;\n        var node2 = parentNode.lastChild;\n        if (!node || node === node2 && node.nodeName === 'BR') {\n          editor.dom.setHTML(parentNode, value);\n        } else {\n          editor.selection.setContent(value);\n        }\n      }\n    };\n    var trimBrsFromTableCell = function (dom, elm) {\n      Optional.from(dom.getParent(elm, 'td,th')).map(SugarElement.fromDom).each(trimBlockTrailingBr);\n    };\n    var reduceInlineTextElements = function (editor, merge) {\n      var textInlineElements = editor.schema.getTextInlineElements();\n      var dom = editor.dom;\n      if (merge) {\n        var root_1 = editor.getBody(), elementUtils_1 = ElementUtils(dom);\n        Tools.each(dom.select('*[data-mce-fragment]'), function (node) {\n          for (var testNode = node.parentNode; testNode && testNode !== root_1; testNode = testNode.parentNode) {\n            if (textInlineElements[node.nodeName.toLowerCase()] && elementUtils_1.compare(testNode, node)) {\n              dom.remove(node, true);\n            }\n          }\n        });\n      }\n    };\n    var markFragmentElements = function (fragment) {\n      var node = fragment;\n      while (node = node.walk()) {\n        if (node.type === 1) {\n          node.attr('data-mce-fragment', '1');\n        }\n      }\n    };\n    var unmarkFragmentElements = function (elm) {\n      Tools.each(elm.getElementsByTagName('*'), function (elm) {\n        elm.removeAttribute('data-mce-fragment');\n      });\n    };\n    var isPartOfFragment = function (node) {\n      return !!node.getAttribute('data-mce-fragment');\n    };\n    var canHaveChildren = function (editor, node) {\n      return node && !editor.schema.getShortEndedElements()[node.nodeName];\n    };\n    var moveSelectionToMarker = function (editor, marker) {\n      var nextRng;\n      var dom = editor.dom, selection = editor.selection;\n      var node2;\n      var getContentEditableFalseParent = function (node) {\n        var root = editor.getBody();\n        for (; node && node !== root; node = node.parentNode) {\n          if (dom.getContentEditable(node) === 'false') {\n            return node;\n          }\n        }\n        return null;\n      };\n      if (!marker) {\n        return;\n      }\n      selection.scrollIntoView(marker);\n      var parentEditableFalseElm = getContentEditableFalseParent(marker);\n      if (parentEditableFalseElm) {\n        dom.remove(marker);\n        selection.select(parentEditableFalseElm);\n        return;\n      }\n      var rng = dom.createRng();\n      var node = marker.previousSibling;\n      if (node && node.nodeType === 3) {\n        rng.setStart(node, node.nodeValue.length);\n        if (!Env.ie) {\n          node2 = marker.nextSibling;\n          if (node2 && node2.nodeType === 3) {\n            node.appendData(node2.data);\n            node2.parentNode.removeChild(node2);\n          }\n        }\n      } else {\n        rng.setStartBefore(marker);\n        rng.setEndBefore(marker);\n      }\n      var findNextCaretRng = function (rng) {\n        var caretPos = CaretPosition.fromRangeStart(rng);\n        var caretWalker = CaretWalker(editor.getBody());\n        caretPos = caretWalker.next(caretPos);\n        if (caretPos) {\n          return caretPos.toRange();\n        }\n      };\n      var parentBlock = dom.getParent(marker, dom.isBlock);\n      dom.remove(marker);\n      if (parentBlock && dom.isEmpty(parentBlock)) {\n        editor.$(parentBlock).empty();\n        rng.setStart(parentBlock, 0);\n        rng.setEnd(parentBlock, 0);\n        if (!isTableCell$4(parentBlock) && !isPartOfFragment(parentBlock) && (nextRng = findNextCaretRng(rng))) {\n          rng = nextRng;\n          dom.remove(parentBlock);\n        } else {\n          dom.add(parentBlock, dom.create('br', { 'data-mce-bogus': '1' }));\n        }\n      }\n      selection.setRng(rng);\n    };\n    var deleteSelectedContent = function (editor) {\n      var dom = editor.dom;\n      var rng = normalize$2(editor.selection.getRng());\n      editor.selection.setRng(rng);\n      var startCell = dom.getParent(rng.startContainer, isTableCell$4);\n      if (isTableCellContentSelected(dom, rng, startCell)) {\n        deleteCellContents(editor, rng, SugarElement.fromDom(startCell));\n      } else {\n        editor.getDoc().execCommand('Delete', false, null);\n      }\n    };\n    var insertHtmlAtCaret = function (editor, value, details) {\n      var parentNode, rootNode, args;\n      var marker, rng, node;\n      var selection = editor.selection, dom = editor.dom;\n      if (/^ | $/.test(value)) {\n        value = trimOrPadLeftRight(dom, selection.getRng(), value);\n      }\n      var parser = editor.parser;\n      var merge = details.merge;\n      var serializer = HtmlSerializer({ validate: shouldValidate(editor) }, editor.schema);\n      var bookmarkHtml = '<span id=\"mce_marker\" data-mce-type=\"bookmark\">&#xFEFF;</span>';\n      args = {\n        content: value,\n        format: 'html',\n        selection: true,\n        paste: details.paste\n      };\n      args = editor.fire('BeforeSetContent', args);\n      if (args.isDefaultPrevented()) {\n        editor.fire('SetContent', {\n          content: args.content,\n          format: 'html',\n          selection: true,\n          paste: details.paste\n        });\n        return;\n      }\n      value = args.content;\n      if (value.indexOf('{$caret}') === -1) {\n        value += '{$caret}';\n      }\n      value = value.replace(/\\{\\$caret\\}/, bookmarkHtml);\n      rng = selection.getRng();\n      var caretElement = rng.startContainer || (rng.parentElement ? rng.parentElement() : null);\n      var body = editor.getBody();\n      if (caretElement === body && selection.isCollapsed()) {\n        if (dom.isBlock(body.firstChild) && canHaveChildren(editor, body.firstChild) && dom.isEmpty(body.firstChild)) {\n          rng = dom.createRng();\n          rng.setStart(body.firstChild, 0);\n          rng.setEnd(body.firstChild, 0);\n          selection.setRng(rng);\n        }\n      }\n      if (!selection.isCollapsed()) {\n        deleteSelectedContent(editor);\n      }\n      parentNode = selection.getNode();\n      var parserArgs = {\n        context: parentNode.nodeName.toLowerCase(),\n        data: details.data,\n        insert: true\n      };\n      var fragment = parser.parse(value, parserArgs);\n      if (details.paste === true && isListFragment(editor.schema, fragment) && isParentBlockLi(dom, parentNode)) {\n        rng = insertAtCaret(serializer, dom, selection.getRng(), fragment);\n        selection.setRng(rng);\n        editor.fire('SetContent', args);\n        return;\n      }\n      markFragmentElements(fragment);\n      node = fragment.lastChild;\n      if (node.attr('id') === 'mce_marker') {\n        marker = node;\n        for (node = node.prev; node; node = node.walk(true)) {\n          if (node.type === 3 || !dom.isBlock(node.name)) {\n            if (editor.schema.isValidChild(node.parent.name, 'span')) {\n              node.parent.insert(marker, node, node.name === 'br');\n            }\n            break;\n          }\n        }\n      }\n      editor._selectionOverrides.showBlockCaretContainer(parentNode);\n      if (!parserArgs.invalid) {\n        value = serializer.serialize(fragment);\n        validInsertion(editor, value, parentNode);\n      } else {\n        editor.selection.setContent(bookmarkHtml);\n        parentNode = selection.getNode();\n        rootNode = editor.getBody();\n        if (parentNode.nodeType === 9) {\n          parentNode = node = rootNode;\n        } else {\n          node = parentNode;\n        }\n        while (node !== rootNode) {\n          parentNode = node;\n          node = node.parentNode;\n        }\n        value = parentNode === rootNode ? rootNode.innerHTML : dom.getOuterHTML(parentNode);\n        value = serializer.serialize(parser.parse(value.replace(/<span (id=\"mce_marker\"|id=mce_marker).+?<\\/span>/i, function () {\n          return serializer.serialize(fragment);\n        })));\n        if (parentNode === rootNode) {\n          dom.setHTML(rootNode, value);\n        } else {\n          dom.setOuterHTML(parentNode, value);\n        }\n      }\n      reduceInlineTextElements(editor, merge);\n      moveSelectionToMarker(editor, dom.get('mce_marker'));\n      unmarkFragmentElements(editor.getBody());\n      trimBrsFromTableCell(dom, selection.getStart());\n      editor.fire('SetContent', args);\n      editor.addVisual();\n    };\n\n    var traverse = function (node, fn) {\n      fn(node);\n      if (node.firstChild) {\n        traverse(node.firstChild, fn);\n      }\n      if (node.next) {\n        traverse(node.next, fn);\n      }\n    };\n    var findMatchingNodes = function (nodeFilters, attributeFilters, node) {\n      var nodeMatches = {};\n      var attrMatches = {};\n      var matches = [];\n      if (node.firstChild) {\n        traverse(node.firstChild, function (node) {\n          each(nodeFilters, function (filter) {\n            if (filter.name === node.name) {\n              if (nodeMatches[filter.name]) {\n                nodeMatches[filter.name].nodes.push(node);\n              } else {\n                nodeMatches[filter.name] = {\n                  filter: filter,\n                  nodes: [node]\n                };\n              }\n            }\n          });\n          each(attributeFilters, function (filter) {\n            if (typeof node.attr(filter.name) === 'string') {\n              if (attrMatches[filter.name]) {\n                attrMatches[filter.name].nodes.push(node);\n              } else {\n                attrMatches[filter.name] = {\n                  filter: filter,\n                  nodes: [node]\n                };\n              }\n            }\n          });\n        });\n      }\n      for (var name_1 in nodeMatches) {\n        if (nodeMatches.hasOwnProperty(name_1)) {\n          matches.push(nodeMatches[name_1]);\n        }\n      }\n      for (var name_2 in attrMatches) {\n        if (attrMatches.hasOwnProperty(name_2)) {\n          matches.push(attrMatches[name_2]);\n        }\n      }\n      return matches;\n    };\n    var filter$3 = function (nodeFilters, attributeFilters, node) {\n      var matches = findMatchingNodes(nodeFilters, attributeFilters, node);\n      each(matches, function (match) {\n        each(match.filter.callbacks, function (callback) {\n          callback(match.nodes, match.filter.name, {});\n        });\n      });\n    };\n\n    var defaultFormat = 'html';\n    var isTreeNode = function (content) {\n      return content instanceof AstNode;\n    };\n    var moveSelection = function (editor) {\n      if (hasFocus$1(editor)) {\n        firstPositionIn(editor.getBody()).each(function (pos) {\n          var node = pos.getNode();\n          var caretPos = isTable(node) ? firstPositionIn(node).getOr(pos) : pos;\n          editor.selection.setRng(caretPos.toRange());\n        });\n      }\n    };\n    var setEditorHtml = function (editor, html) {\n      editor.dom.setHTML(editor.getBody(), html);\n      moveSelection(editor);\n    };\n    var setContentString = function (editor, body, content, args) {\n      var forcedRootBlockName, padd;\n      if (content.length === 0 || /^\\s+$/.test(content)) {\n        padd = '<br data-mce-bogus=\"1\">';\n        if (body.nodeName === 'TABLE') {\n          content = '<tr><td>' + padd + '</td></tr>';\n        } else if (/^(UL|OL)$/.test(body.nodeName)) {\n          content = '<li>' + padd + '</li>';\n        }\n        forcedRootBlockName = getForcedRootBlock(editor);\n        if (forcedRootBlockName && editor.schema.isValidChild(body.nodeName.toLowerCase(), forcedRootBlockName.toLowerCase())) {\n          content = padd;\n          content = editor.dom.createHTML(forcedRootBlockName, getForcedRootBlockAttrs(editor), content);\n        } else if (!content) {\n          content = '<br data-mce-bogus=\"1\">';\n        }\n        setEditorHtml(editor, content);\n        editor.fire('SetContent', args);\n      } else {\n        if (args.format !== 'raw') {\n          content = HtmlSerializer({ validate: editor.validate }, editor.schema).serialize(editor.parser.parse(content, {\n            isRootContent: true,\n            insert: true\n          }));\n        }\n        args.content = isWsPreserveElement(SugarElement.fromDom(body)) ? content : Tools.trim(content);\n        setEditorHtml(editor, args.content);\n        if (!args.no_events) {\n          editor.fire('SetContent', args);\n        }\n      }\n      return args.content;\n    };\n    var setContentTree = function (editor, body, content, args) {\n      filter$3(editor.parser.getNodeFilters(), editor.parser.getAttributeFilters(), content);\n      var html = HtmlSerializer({ validate: editor.validate }, editor.schema).serialize(content);\n      args.content = isWsPreserveElement(SugarElement.fromDom(body)) ? html : Tools.trim(html);\n      setEditorHtml(editor, args.content);\n      if (!args.no_events) {\n        editor.fire('SetContent', args);\n      }\n      return content;\n    };\n    var setContentInternal = function (editor, content, args) {\n      args.format = args.format ? args.format : defaultFormat;\n      args.set = true;\n      args.content = isTreeNode(content) ? '' : content;\n      if (!args.no_events) {\n        editor.fire('BeforeSetContent', args);\n      }\n      if (!isTreeNode(content)) {\n        content = args.content;\n      }\n      return Optional.from(editor.getBody()).fold(constant(content), function (body) {\n        return isTreeNode(content) ? setContentTree(editor, body, content, args) : setContentString(editor, body, content, args);\n      });\n    };\n\n    var sibling$2 = function (scope, predicate) {\n      return sibling(scope, predicate).isSome();\n    };\n\n    var ensureIsRoot = function (isRoot) {\n      return isFunction(isRoot) ? isRoot : never;\n    };\n    var ancestor$3 = function (scope, transform, isRoot) {\n      var element = scope.dom;\n      var stop = ensureIsRoot(isRoot);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        var transformed = transform(el);\n        if (transformed.isSome()) {\n          return transformed;\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest$2 = function (scope, transform, isRoot) {\n      var current = transform(scope);\n      var stop = ensureIsRoot(isRoot);\n      return current.orThunk(function () {\n        return stop(scope) ? Optional.none() : ancestor$3(scope, transform, stop);\n      });\n    };\n\n    var isEq$2 = isEq;\n    var matchesUnInheritedFormatSelector = function (ed, node, name) {\n      var formatList = ed.formatter.get(name);\n      if (formatList) {\n        for (var i = 0; i < formatList.length; i++) {\n          if (formatList[i].inherit === false && ed.dom.is(node, formatList[i].selector)) {\n            return true;\n          }\n        }\n      }\n      return false;\n    };\n    var matchParents = function (editor, node, name, vars) {\n      var root = editor.dom.getRoot();\n      if (node === root) {\n        return false;\n      }\n      node = editor.dom.getParent(node, function (node) {\n        if (matchesUnInheritedFormatSelector(editor, node, name)) {\n          return true;\n        }\n        return node.parentNode === root || !!matchNode(editor, node, name, vars, true);\n      });\n      return matchNode(editor, node, name, vars);\n    };\n    var matchName = function (dom, node, format) {\n      if (isEq$2(node, format.inline)) {\n        return true;\n      }\n      if (isEq$2(node, format.block)) {\n        return true;\n      }\n      if (format.selector) {\n        return node.nodeType === 1 && dom.is(node, format.selector);\n      }\n    };\n    var matchItems = function (dom, node, format, itemName, similar, vars) {\n      var key, value;\n      var items = format[itemName];\n      var i;\n      if (format.onmatch) {\n        return format.onmatch(node, format, itemName);\n      }\n      if (items) {\n        if (typeof items.length === 'undefined') {\n          for (key in items) {\n            if (items.hasOwnProperty(key)) {\n              if (itemName === 'attributes') {\n                value = dom.getAttrib(node, key);\n              } else {\n                value = getStyle(dom, node, key);\n              }\n              if (similar && !value && !format.exact) {\n                return;\n              }\n              if ((!similar || format.exact) && !isEq$2(value, normalizeStyleValue(dom, replaceVars(items[key], vars), key))) {\n                return;\n              }\n            }\n          }\n        } else {\n          for (i = 0; i < items.length; i++) {\n            if (itemName === 'attributes' ? dom.getAttrib(node, items[i]) : getStyle(dom, node, items[i])) {\n              return format;\n            }\n          }\n        }\n      }\n      return format;\n    };\n    var matchNode = function (ed, node, name, vars, similar) {\n      var formatList = ed.formatter.get(name);\n      var format, i, x, classes;\n      var dom = ed.dom;\n      if (formatList && node) {\n        for (i = 0; i < formatList.length; i++) {\n          format = formatList[i];\n          if (matchName(ed.dom, node, format) && matchItems(dom, node, format, 'attributes', similar, vars) && matchItems(dom, node, format, 'styles', similar, vars)) {\n            if (classes = format.classes) {\n              for (x = 0; x < classes.length; x++) {\n                if (!ed.dom.hasClass(node, classes[x])) {\n                  return;\n                }\n              }\n            }\n            return format;\n          }\n        }\n      }\n    };\n    var match = function (editor, name, vars, node) {\n      if (node) {\n        return matchParents(editor, node, name, vars);\n      }\n      node = editor.selection.getNode();\n      if (matchParents(editor, node, name, vars)) {\n        return true;\n      }\n      var startNode = editor.selection.getStart();\n      if (startNode !== node) {\n        if (matchParents(editor, startNode, name, vars)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var matchAll = function (editor, names, vars) {\n      var matchedFormatNames = [];\n      var checkedMap = {};\n      var startElement = editor.selection.getStart();\n      editor.dom.getParent(startElement, function (node) {\n        for (var i = 0; i < names.length; i++) {\n          var name_1 = names[i];\n          if (!checkedMap[name_1] && matchNode(editor, node, name_1, vars)) {\n            checkedMap[name_1] = true;\n            matchedFormatNames.push(name_1);\n          }\n        }\n      }, editor.dom.getRoot());\n      return matchedFormatNames;\n    };\n    var closest$3 = function (editor, names) {\n      var isRoot = function (elm) {\n        return eq$2(elm, SugarElement.fromDom(editor.getBody()));\n      };\n      var match = function (elm, name) {\n        return matchNode(editor, elm.dom, name) ? Optional.some(name) : Optional.none();\n      };\n      return Optional.from(editor.selection.getStart(true)).bind(function (rawElm) {\n        return closest$2(SugarElement.fromDom(rawElm), function (elm) {\n          return findMap(names, function (name) {\n            return match(elm, name);\n          });\n        }, isRoot);\n      }).getOrNull();\n    };\n    var canApply = function (editor, name) {\n      var formatList = editor.formatter.get(name);\n      var startNode, parents, i, x, selector;\n      var dom = editor.dom;\n      if (formatList) {\n        startNode = editor.selection.getStart();\n        parents = getParents$1(dom, startNode);\n        for (x = formatList.length - 1; x >= 0; x--) {\n          selector = formatList[x].selector;\n          if (!selector || formatList[x].defaultBlock) {\n            return true;\n          }\n          for (i = parents.length - 1; i >= 0; i--) {\n            if (dom.is(parents[i], selector)) {\n              return true;\n            }\n          }\n        }\n      }\n      return false;\n    };\n    var matchAllOnNode = function (editor, node, formatNames) {\n      return foldl(formatNames, function (acc, name) {\n        var matchSimilar = isVariableFormatName(editor, name);\n        if (editor.formatter.matchNode(node, name, {}, matchSimilar)) {\n          return acc.concat([name]);\n        } else {\n          return acc;\n        }\n      }, []);\n    };\n\n    var ZWSP$1 = ZWSP, CARET_ID$1 = '_mce_caret';\n    var importNode = function (ownerDocument, node) {\n      return ownerDocument.importNode(node, true);\n    };\n    var getEmptyCaretContainers = function (node) {\n      var nodes = [];\n      while (node) {\n        if (node.nodeType === 3 && node.nodeValue !== ZWSP$1 || node.childNodes.length > 1) {\n          return [];\n        }\n        if (node.nodeType === 1) {\n          nodes.push(node);\n        }\n        node = node.firstChild;\n      }\n      return nodes;\n    };\n    var isCaretContainerEmpty = function (node) {\n      return getEmptyCaretContainers(node).length > 0;\n    };\n    var findFirstTextNode = function (node) {\n      if (node) {\n        var walker = new DomTreeWalker(node, node);\n        for (node = walker.current(); node; node = walker.next()) {\n          if (isText$1(node)) {\n            return node;\n          }\n        }\n      }\n      return null;\n    };\n    var createCaretContainer = function (fill) {\n      var caretContainer = SugarElement.fromTag('span');\n      setAll(caretContainer, {\n        'id': CARET_ID$1,\n        'data-mce-bogus': '1',\n        'data-mce-type': 'format-caret'\n      });\n      if (fill) {\n        append(caretContainer, SugarElement.fromText(ZWSP$1));\n      }\n      return caretContainer;\n    };\n    var trimZwspFromCaretContainer = function (caretContainerNode) {\n      var textNode = findFirstTextNode(caretContainerNode);\n      if (textNode && textNode.nodeValue.charAt(0) === ZWSP$1) {\n        textNode.deleteData(0, 1);\n      }\n      return textNode;\n    };\n    var removeCaretContainerNode = function (editor, node, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var dom = editor.dom, selection = editor.selection;\n      if (isCaretContainerEmpty(node)) {\n        deleteElement(editor, false, SugarElement.fromDom(node), moveCaret);\n      } else {\n        var rng = selection.getRng();\n        var block = dom.getParent(node, dom.isBlock);\n        var startContainer = rng.startContainer;\n        var startOffset = rng.startOffset;\n        var endContainer = rng.endContainer;\n        var endOffset = rng.endOffset;\n        var textNode = trimZwspFromCaretContainer(node);\n        dom.remove(node, true);\n        if (startContainer === textNode && startOffset > 0) {\n          rng.setStart(textNode, startOffset - 1);\n        }\n        if (endContainer === textNode && endOffset > 0) {\n          rng.setEnd(textNode, endOffset - 1);\n        }\n        if (block && dom.isEmpty(block)) {\n          fillWithPaddingBr(SugarElement.fromDom(block));\n        }\n        selection.setRng(rng);\n      }\n    };\n    var removeCaretContainer = function (editor, node, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var dom = editor.dom, selection = editor.selection;\n      if (!node) {\n        node = getParentCaretContainer(editor.getBody(), selection.getStart());\n        if (!node) {\n          while (node = dom.get(CARET_ID$1)) {\n            removeCaretContainerNode(editor, node, false);\n          }\n        }\n      } else {\n        removeCaretContainerNode(editor, node, moveCaret);\n      }\n    };\n    var insertCaretContainerNode = function (editor, caretContainer, formatNode) {\n      var dom = editor.dom, block = dom.getParent(formatNode, curry(isTextBlock$1, editor));\n      if (block && dom.isEmpty(block)) {\n        formatNode.parentNode.replaceChild(caretContainer, formatNode);\n      } else {\n        removeTrailingBr(SugarElement.fromDom(formatNode));\n        if (dom.isEmpty(formatNode)) {\n          formatNode.parentNode.replaceChild(caretContainer, formatNode);\n        } else {\n          dom.insertAfter(caretContainer, formatNode);\n        }\n      }\n    };\n    var appendNode = function (parentNode, node) {\n      parentNode.appendChild(node);\n      return node;\n    };\n    var insertFormatNodesIntoCaretContainer = function (formatNodes, caretContainer) {\n      var innerMostFormatNode = foldr(formatNodes, function (parentNode, formatNode) {\n        return appendNode(parentNode, formatNode.cloneNode(false));\n      }, caretContainer);\n      return appendNode(innerMostFormatNode, innerMostFormatNode.ownerDocument.createTextNode(ZWSP$1));\n    };\n    var cleanFormatNode = function (editor, caretContainer, formatNode, name, vars, similar) {\n      var formatter = editor.formatter;\n      var dom = editor.dom;\n      var validFormats = filter(keys(formatter.get()), function (formatName) {\n        return formatName !== name && !contains$1(formatName, 'removeformat');\n      });\n      var matchedFormats = matchAllOnNode(editor, formatNode, validFormats);\n      var uniqueFormats = filter(matchedFormats, function (fmtName) {\n        return !areSimilarFormats(editor, fmtName, name);\n      });\n      if (uniqueFormats.length > 0) {\n        var clonedFormatNode = formatNode.cloneNode(false);\n        dom.add(caretContainer, clonedFormatNode);\n        formatter.remove(name, vars, clonedFormatNode, similar);\n        dom.remove(clonedFormatNode);\n        return Optional.some(clonedFormatNode);\n      } else {\n        return Optional.none();\n      }\n    };\n    var applyCaretFormat = function (editor, name, vars) {\n      var caretContainer, textNode;\n      var selection = editor.selection;\n      var selectionRng = selection.getRng();\n      var offset = selectionRng.startOffset;\n      var container = selectionRng.startContainer;\n      var text = container.nodeValue;\n      caretContainer = getParentCaretContainer(editor.getBody(), selection.getStart());\n      if (caretContainer) {\n        textNode = findFirstTextNode(caretContainer);\n      }\n      var wordcharRegex = /[^\\s\\u00a0\\u00ad\\u200b\\ufeff]/;\n      if (text && offset > 0 && offset < text.length && wordcharRegex.test(text.charAt(offset)) && wordcharRegex.test(text.charAt(offset - 1))) {\n        var bookmark = selection.getBookmark();\n        selectionRng.collapse(true);\n        var rng = expandRng(editor, selectionRng, editor.formatter.get(name));\n        rng = split$1(rng);\n        editor.formatter.apply(name, vars, rng);\n        selection.moveToBookmark(bookmark);\n      } else {\n        if (!caretContainer || textNode.nodeValue !== ZWSP$1) {\n          caretContainer = importNode(editor.getDoc(), createCaretContainer(true).dom);\n          textNode = caretContainer.firstChild;\n          selectionRng.insertNode(caretContainer);\n          offset = 1;\n          editor.formatter.apply(name, vars, caretContainer);\n        } else {\n          editor.formatter.apply(name, vars, caretContainer);\n        }\n        selection.setCursorLocation(textNode, offset);\n      }\n    };\n    var removeCaretFormat = function (editor, name, vars, similar) {\n      var dom = editor.dom;\n      var selection = editor.selection;\n      var hasContentAfter, node, formatNode;\n      var parents = [];\n      var rng = selection.getRng();\n      var container = rng.startContainer;\n      var offset = rng.startOffset;\n      node = container;\n      if (container.nodeType === 3) {\n        if (offset !== container.nodeValue.length) {\n          hasContentAfter = true;\n        }\n        node = node.parentNode;\n      }\n      while (node) {\n        if (matchNode(editor, node, name, vars, similar)) {\n          formatNode = node;\n          break;\n        }\n        if (node.nextSibling) {\n          hasContentAfter = true;\n        }\n        parents.push(node);\n        node = node.parentNode;\n      }\n      if (!formatNode) {\n        return;\n      }\n      if (hasContentAfter) {\n        var bookmark = selection.getBookmark();\n        rng.collapse(true);\n        var expandedRng = expandRng(editor, rng, editor.formatter.get(name), true);\n        expandedRng = split$1(expandedRng);\n        editor.formatter.remove(name, vars, expandedRng, similar);\n        selection.moveToBookmark(bookmark);\n      } else {\n        var caretContainer = getParentCaretContainer(editor.getBody(), formatNode);\n        var newCaretContainer = createCaretContainer(false).dom;\n        insertCaretContainerNode(editor, newCaretContainer, caretContainer !== null ? caretContainer : formatNode);\n        var cleanedFormatNode = cleanFormatNode(editor, newCaretContainer, formatNode, name, vars, similar);\n        var caretTextNode = insertFormatNodesIntoCaretContainer(parents.concat(cleanedFormatNode.toArray()), newCaretContainer);\n        removeCaretContainerNode(editor, caretContainer, false);\n        selection.setCursorLocation(caretTextNode, 1);\n        if (dom.isEmpty(formatNode)) {\n          dom.remove(formatNode);\n        }\n      }\n    };\n    var disableCaretContainer = function (editor, keyCode) {\n      var selection = editor.selection, body = editor.getBody();\n      removeCaretContainer(editor, null, false);\n      if ((keyCode === 8 || keyCode === 46) && selection.isCollapsed() && selection.getStart().innerHTML === ZWSP$1) {\n        removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n      }\n      if (keyCode === 37 || keyCode === 39) {\n        removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n      }\n    };\n    var setup$3 = function (editor) {\n      editor.on('mouseup keydown', function (e) {\n        disableCaretContainer(editor, e.keyCode);\n      });\n    };\n    var replaceWithCaretFormat = function (targetNode, formatNodes) {\n      var caretContainer = createCaretContainer(false);\n      var innerMost = insertFormatNodesIntoCaretContainer(formatNodes, caretContainer.dom);\n      before(SugarElement.fromDom(targetNode), caretContainer);\n      remove(SugarElement.fromDom(targetNode));\n      return CaretPosition(innerMost, 0);\n    };\n    var isFormatElement = function (editor, element) {\n      var inlineElements = editor.schema.getTextInlineElements();\n      return inlineElements.hasOwnProperty(name(element)) && !isCaretNode(element.dom) && !isBogus(element.dom);\n    };\n    var isEmptyCaretFormatElement = function (element) {\n      return isCaretNode(element.dom) && isCaretContainerEmpty(element.dom);\n    };\n\n    var postProcessHooks = {};\n    var filter$4 = filter$2;\n    var each$8 = each$2;\n    var addPostProcessHook = function (name, hook) {\n      var hooks = postProcessHooks[name];\n      if (!hooks) {\n        postProcessHooks[name] = [];\n      }\n      postProcessHooks[name].push(hook);\n    };\n    var postProcess = function (name, editor) {\n      each$8(postProcessHooks[name], function (hook) {\n        hook(editor);\n      });\n    };\n    addPostProcessHook('pre', function (editor) {\n      var rng = editor.selection.getRng();\n      var blocks;\n      var hasPreSibling = function (pre) {\n        return isPre(pre.previousSibling) && indexOf$1(blocks, pre.previousSibling) !== -1;\n      };\n      var joinPre = function (pre1, pre2) {\n        DomQuery(pre2).remove();\n        DomQuery(pre1).append('<br><br>').append(pre2.childNodes);\n      };\n      var isPre = matchNodeNames(['pre']);\n      if (!rng.collapsed) {\n        blocks = editor.selection.getSelectedBlocks();\n        each$8(filter$4(filter$4(blocks, isPre), hasPreSibling), function (pre) {\n          joinPre(pre.previousSibling, pre);\n        });\n      }\n    });\n\n    var each$9 = Tools.each;\n    var isElementNode = function (node) {\n      return isElement$1(node) && !isBookmarkNode$1(node) && !isCaretNode(node) && !isBogus(node);\n    };\n    var findElementSibling = function (node, siblingName) {\n      var sibling;\n      for (sibling = node; sibling; sibling = sibling[siblingName]) {\n        if (isText$1(sibling) && sibling.nodeValue.length !== 0) {\n          return node;\n        }\n        if (isElement$1(sibling) && !isBookmarkNode$1(sibling)) {\n          return sibling;\n        }\n      }\n      return node;\n    };\n    var mergeSiblingsNodes = function (dom, prev, next) {\n      var sibling, tmpSibling;\n      var elementUtils = ElementUtils(dom);\n      if (prev && next) {\n        prev = findElementSibling(prev, 'previousSibling');\n        next = findElementSibling(next, 'nextSibling');\n        if (elementUtils.compare(prev, next)) {\n          for (sibling = prev.nextSibling; sibling && sibling !== next;) {\n            tmpSibling = sibling;\n            sibling = sibling.nextSibling;\n            prev.appendChild(tmpSibling);\n          }\n          dom.remove(next);\n          Tools.each(Tools.grep(next.childNodes), function (node) {\n            prev.appendChild(node);\n          });\n          return prev;\n        }\n      }\n      return next;\n    };\n    var mergeSiblings = function (dom, format, vars, node) {\n      if (node && format.merge_siblings !== false) {\n        var newNode = mergeSiblingsNodes(dom, getNonWhiteSpaceSibling(node), node);\n        mergeSiblingsNodes(dom, newNode, getNonWhiteSpaceSibling(newNode, true));\n      }\n    };\n    var clearChildStyles = function (dom, format, node) {\n      if (format.clear_child_styles) {\n        var selector = format.links ? '*:not(a)' : '*';\n        each$9(dom.select(selector, node), function (node) {\n          if (isElementNode(node)) {\n            each$9(format.styles, function (value, name) {\n              dom.setStyle(node, name, '');\n            });\n          }\n        });\n      }\n    };\n    var processChildElements = function (node, filter, process) {\n      each$9(node.childNodes, function (node) {\n        if (isElementNode(node)) {\n          if (filter(node)) {\n            process(node);\n          }\n          if (node.hasChildNodes()) {\n            processChildElements(node, filter, process);\n          }\n        }\n      });\n    };\n    var unwrapEmptySpan = function (dom, node) {\n      if (node.nodeName === 'SPAN' && dom.getAttribs(node).length === 0) {\n        dom.remove(node, true);\n      }\n    };\n    var hasStyle = function (dom, name) {\n      return function (node) {\n        return !!(node && getStyle(dom, node, name));\n      };\n    };\n    var applyStyle = function (dom, name, value) {\n      return function (node) {\n        dom.setStyle(node, name, value);\n        if (node.getAttribute('style') === '') {\n          node.removeAttribute('style');\n        }\n        unwrapEmptySpan(dom, node);\n      };\n    };\n\n    var removeResult = Adt.generate([\n      { keep: [] },\n      { rename: ['name'] },\n      { removed: [] }\n    ]);\n    var MCE_ATTR_RE = /^(src|href|style)$/;\n    var each$a = Tools.each;\n    var isEq$3 = isEq;\n    var isTableCellOrRow = function (node) {\n      return /^(TR|TH|TD)$/.test(node.nodeName);\n    };\n    var isChildOfInlineParent = function (dom, node, parent) {\n      return dom.isChildOf(node, parent) && node !== parent && !dom.isBlock(parent);\n    };\n    var getContainer = function (ed, rng, start) {\n      var container, offset;\n      container = rng[start ? 'startContainer' : 'endContainer'];\n      offset = rng[start ? 'startOffset' : 'endOffset'];\n      if (isElement$1(container)) {\n        var lastIdx = container.childNodes.length - 1;\n        if (!start && offset) {\n          offset--;\n        }\n        container = container.childNodes[offset > lastIdx ? lastIdx : offset];\n      }\n      if (isText$1(container) && start && offset >= container.nodeValue.length) {\n        container = new DomTreeWalker(container, ed.getBody()).next() || container;\n      }\n      if (isText$1(container) && !start && offset === 0) {\n        container = new DomTreeWalker(container, ed.getBody()).prev() || container;\n      }\n      return container;\n    };\n    var normalizeTableSelection = function (node, start) {\n      var prop = start ? 'firstChild' : 'lastChild';\n      if (isTableCellOrRow(node) && node[prop]) {\n        var childNode = node[prop];\n        if (node.nodeName === 'TR') {\n          return childNode[prop] || childNode;\n        } else {\n          return childNode;\n        }\n      }\n      return node;\n    };\n    var wrap$2 = function (dom, node, name, attrs) {\n      var wrapper = dom.create(name, attrs);\n      node.parentNode.insertBefore(wrapper, node);\n      wrapper.appendChild(node);\n      return wrapper;\n    };\n    var wrapWithSiblings = function (dom, node, next, name, attrs) {\n      var start = SugarElement.fromDom(node);\n      var wrapper = SugarElement.fromDom(dom.create(name, attrs));\n      var siblings = next ? nextSiblings(start) : prevSiblings(start);\n      append$1(wrapper, siblings);\n      if (next) {\n        before(start, wrapper);\n        prepend(wrapper, start);\n      } else {\n        after(start, wrapper);\n        append(wrapper, start);\n      }\n      return wrapper.dom;\n    };\n    var matchName$1 = function (dom, node, format) {\n      if (isEq$3(node, format.inline)) {\n        return true;\n      }\n      if (isEq$3(node, format.block)) {\n        return true;\n      }\n      if (format.selector) {\n        return isElement$1(node) && dom.is(node, format.selector);\n      }\n    };\n    var isColorFormatAndAnchor = function (node, format) {\n      return format.links && node.nodeName === 'A';\n    };\n    var find$3 = function (dom, node, next, inc) {\n      node = getNonWhiteSpaceSibling(node, next, inc);\n      return !node || (node.nodeName === 'BR' || dom.isBlock(node));\n    };\n    var removeNode$1 = function (ed, node, format) {\n      var parentNode = node.parentNode;\n      var rootBlockElm;\n      var dom = ed.dom, forcedRootBlock = getForcedRootBlock(ed);\n      if (format.block) {\n        if (!forcedRootBlock) {\n          if (dom.isBlock(node) && !dom.isBlock(parentNode)) {\n            if (!find$3(dom, node, false) && !find$3(dom, node.firstChild, true, true)) {\n              node.insertBefore(dom.create('br'), node.firstChild);\n            }\n            if (!find$3(dom, node, true) && !find$3(dom, node.lastChild, false, true)) {\n              node.appendChild(dom.create('br'));\n            }\n          }\n        } else {\n          if (parentNode === dom.getRoot()) {\n            if (!format.list_block || !isEq$3(node, format.list_block)) {\n              each(from$1(node.childNodes), function (node) {\n                if (isValid(ed, forcedRootBlock, node.nodeName.toLowerCase())) {\n                  if (!rootBlockElm) {\n                    rootBlockElm = wrap$2(dom, node, forcedRootBlock);\n                    dom.setAttribs(rootBlockElm, ed.settings.forced_root_block_attrs);\n                  } else {\n                    rootBlockElm.appendChild(node);\n                  }\n                } else {\n                  rootBlockElm = 0;\n                }\n              });\n            }\n          }\n        }\n      }\n      if (format.selector && format.inline && !isEq$3(format.inline, node)) {\n        return;\n      }\n      dom.remove(node, true);\n    };\n    var removeFormatInternal = function (ed, format, vars, node, compareNode) {\n      var stylesModified;\n      var dom = ed.dom;\n      if (!matchName$1(dom, node, format) && !isColorFormatAndAnchor(node, format)) {\n        return removeResult.keep();\n      }\n      var elm = node;\n      if (format.inline && format.remove === 'all' && isArray(format.preserve_attributes)) {\n        var attrsToPreserve = filter(dom.getAttribs(elm), function (attr) {\n          return contains(format.preserve_attributes, attr.name.toLowerCase());\n        });\n        dom.removeAllAttribs(elm);\n        each(attrsToPreserve, function (attr) {\n          return dom.setAttrib(elm, attr.name, attr.value);\n        });\n        if (attrsToPreserve.length > 0) {\n          return removeResult.rename('span');\n        }\n      }\n      if (format.remove !== 'all') {\n        each$a(format.styles, function (value, name) {\n          value = normalizeStyleValue(dom, replaceVars(value, vars), name + '');\n          if (isNumber(name)) {\n            name = value;\n            compareNode = null;\n          }\n          if (format.remove_similar || (!compareNode || isEq$3(getStyle(dom, compareNode, name), value))) {\n            dom.setStyle(elm, name, '');\n          }\n          stylesModified = true;\n        });\n        if (stylesModified && dom.getAttrib(elm, 'style') === '') {\n          elm.removeAttribute('style');\n          elm.removeAttribute('data-mce-style');\n        }\n        each$a(format.attributes, function (value, name) {\n          var valueOut;\n          value = replaceVars(value, vars);\n          if (isNumber(name)) {\n            name = value;\n            compareNode = null;\n          }\n          if (format.remove_similar || (!compareNode || isEq$3(dom.getAttrib(compareNode, name), value))) {\n            if (name === 'class') {\n              value = dom.getAttrib(elm, name);\n              if (value) {\n                valueOut = '';\n                each(value.split(/\\s+/), function (cls) {\n                  if (/mce\\-\\w+/.test(cls)) {\n                    valueOut += (valueOut ? ' ' : '') + cls;\n                  }\n                });\n                if (valueOut) {\n                  dom.setAttrib(elm, name, valueOut);\n                  return;\n                }\n              }\n            }\n            if (name === 'class') {\n              elm.removeAttribute('className');\n            }\n            if (MCE_ATTR_RE.test(name)) {\n              elm.removeAttribute('data-mce-' + name);\n            }\n            elm.removeAttribute(name);\n          }\n        });\n        each$a(format.classes, function (value) {\n          value = replaceVars(value, vars);\n          if (!compareNode || dom.hasClass(compareNode, value)) {\n            dom.removeClass(elm, value);\n          }\n        });\n        var attrs = dom.getAttribs(elm);\n        for (var i = 0; i < attrs.length; i++) {\n          var attrName = attrs[i].nodeName;\n          if (attrName.indexOf('_') !== 0 && attrName.indexOf('data-') !== 0) {\n            return removeResult.keep();\n          }\n        }\n      }\n      if (format.remove !== 'none') {\n        removeNode$1(ed, elm, format);\n        return removeResult.removed();\n      }\n      return removeResult.keep();\n    };\n    var removeFormat = function (ed, format, vars, node, compareNode) {\n      return removeFormatInternal(ed, format, vars, node, compareNode).fold(never, function (newName) {\n        ed.dom.rename(node, newName);\n        return true;\n      }, always);\n    };\n    var findFormatRoot = function (editor, container, name, vars, similar) {\n      var formatRoot;\n      each(getParents$1(editor.dom, container.parentNode).reverse(), function (parent) {\n        if (!formatRoot && parent.id !== '_start' && parent.id !== '_end') {\n          var format = matchNode(editor, parent, name, vars, similar);\n          if (format && format.split !== false) {\n            formatRoot = parent;\n          }\n        }\n      });\n      return formatRoot;\n    };\n    var removeFormatFromClone = function (editor, format, vars, clone) {\n      return removeFormatInternal(editor, format, vars, clone, clone).fold(constant(clone), function (newName) {\n        var fragment = editor.dom.createFragment();\n        fragment.appendChild(clone);\n        return editor.dom.rename(clone, newName);\n      }, constant(null));\n    };\n    var wrapAndSplit = function (editor, formatList, formatRoot, container, target, split, format, vars) {\n      var clone, lastClone, firstClone;\n      var dom = editor.dom;\n      if (formatRoot) {\n        var formatRootParent = formatRoot.parentNode;\n        for (var parent_1 = container.parentNode; parent_1 && parent_1 !== formatRootParent; parent_1 = parent_1.parentNode) {\n          clone = dom.clone(parent_1, false);\n          for (var i = 0; i < formatList.length; i++) {\n            clone = removeFormatFromClone(editor, formatList[i], vars, clone);\n            if (clone === null) {\n              break;\n            }\n          }\n          if (clone) {\n            if (lastClone) {\n              clone.appendChild(lastClone);\n            }\n            if (!firstClone) {\n              firstClone = clone;\n            }\n            lastClone = clone;\n          }\n        }\n        if (split && (!format.mixed || !dom.isBlock(formatRoot))) {\n          container = dom.split(formatRoot, container);\n        }\n        if (lastClone) {\n          target.parentNode.insertBefore(lastClone, target);\n          firstClone.appendChild(target);\n          if (format.inline) {\n            mergeSiblings(dom, format, vars, lastClone);\n          }\n        }\n      }\n      return container;\n    };\n    var remove$6 = function (ed, name, vars, node, similar) {\n      var formatList = ed.formatter.get(name);\n      var format = formatList[0];\n      var contentEditable = true;\n      var dom = ed.dom;\n      var selection = ed.selection;\n      var splitToFormatRoot = function (container) {\n        var formatRoot = findFormatRoot(ed, container, name, vars, similar);\n        return wrapAndSplit(ed, formatList, formatRoot, container, container, true, format, vars);\n      };\n      var isRemoveBookmarkNode = function (node) {\n        return isBookmarkNode$1(node) && isElement$1(node) && (node.id === '_start' || node.id === '_end');\n      };\n      var process = function (node) {\n        var lastContentEditable, hasContentEditableState;\n        if (isElement$1(node) && dom.getContentEditable(node)) {\n          lastContentEditable = contentEditable;\n          contentEditable = dom.getContentEditable(node) === 'true';\n          hasContentEditableState = true;\n        }\n        var children = from$1(node.childNodes);\n        if (contentEditable && !hasContentEditableState) {\n          for (var i = 0; i < formatList.length; i++) {\n            if (removeFormat(ed, formatList[i], vars, node, node)) {\n              break;\n            }\n          }\n        }\n        if (format.deep) {\n          if (children.length) {\n            for (var i = 0; i < children.length; i++) {\n              process(children[i]);\n            }\n            if (hasContentEditableState) {\n              contentEditable = lastContentEditable;\n            }\n          }\n        }\n      };\n      var unwrap = function (start) {\n        var node = dom.get(start ? '_start' : '_end');\n        var out = node[start ? 'firstChild' : 'lastChild'];\n        if (isRemoveBookmarkNode(out)) {\n          out = out[start ? 'firstChild' : 'lastChild'];\n        }\n        if (isText$1(out) && out.data.length === 0) {\n          out = start ? node.previousSibling || node.nextSibling : node.nextSibling || node.previousSibling;\n        }\n        dom.remove(node, true);\n        return out;\n      };\n      var removeRngStyle = function (rng) {\n        var startContainer, endContainer;\n        var expandedRng = expandRng(ed, rng, formatList, rng.collapsed);\n        if (format.split) {\n          expandedRng = split$1(expandedRng);\n          startContainer = getContainer(ed, expandedRng, true);\n          endContainer = getContainer(ed, expandedRng);\n          if (startContainer !== endContainer) {\n            startContainer = normalizeTableSelection(startContainer, true);\n            endContainer = normalizeTableSelection(endContainer, false);\n            if (isChildOfInlineParent(dom, startContainer, endContainer)) {\n              var marker = Optional.from(startContainer.firstChild).getOr(startContainer);\n              splitToFormatRoot(wrapWithSiblings(dom, marker, true, 'span', {\n                'id': '_start',\n                'data-mce-type': 'bookmark'\n              }));\n              unwrap(true);\n              return;\n            }\n            if (isChildOfInlineParent(dom, endContainer, startContainer)) {\n              var marker = Optional.from(endContainer.lastChild).getOr(endContainer);\n              splitToFormatRoot(wrapWithSiblings(dom, marker, false, 'span', {\n                'id': '_end',\n                'data-mce-type': 'bookmark'\n              }));\n              unwrap(false);\n              return;\n            }\n            startContainer = wrap$2(dom, startContainer, 'span', {\n              'id': '_start',\n              'data-mce-type': 'bookmark'\n            });\n            endContainer = wrap$2(dom, endContainer, 'span', {\n              'id': '_end',\n              'data-mce-type': 'bookmark'\n            });\n            var newRng = dom.createRng();\n            newRng.setStartAfter(startContainer);\n            newRng.setEndBefore(endContainer);\n            walk$1(dom, newRng, function (nodes) {\n              each(nodes, function (n) {\n                if (!isBookmarkNode$1(n) && !isBookmarkNode$1(n.parentNode)) {\n                  splitToFormatRoot(n);\n                }\n              });\n            });\n            splitToFormatRoot(startContainer);\n            splitToFormatRoot(endContainer);\n            startContainer = unwrap(true);\n            endContainer = unwrap();\n          } else {\n            startContainer = endContainer = splitToFormatRoot(startContainer);\n          }\n          expandedRng.startContainer = startContainer.parentNode ? startContainer.parentNode : startContainer;\n          expandedRng.startOffset = dom.nodeIndex(startContainer);\n          expandedRng.endContainer = endContainer.parentNode ? endContainer.parentNode : endContainer;\n          expandedRng.endOffset = dom.nodeIndex(endContainer) + 1;\n        }\n        walk$1(dom, expandedRng, function (nodes) {\n          each(nodes, function (node) {\n            process(node);\n            var textDecorations = [\n              'underline',\n              'line-through',\n              'overline'\n            ];\n            each(textDecorations, function (decoration) {\n              if (isElement$1(node) && ed.dom.getStyle(node, 'text-decoration') === decoration && node.parentNode && getTextDecoration(dom, node.parentNode) === decoration) {\n                removeFormat(ed, {\n                  deep: false,\n                  exact: true,\n                  inline: 'span',\n                  styles: { textDecoration: decoration }\n                }, null, node);\n              }\n            });\n          });\n        });\n      };\n      if (node) {\n        if (isNode(node)) {\n          var rng = dom.createRng();\n          rng.setStartBefore(node);\n          rng.setEndAfter(node);\n          removeRngStyle(rng);\n        } else {\n          removeRngStyle(node);\n        }\n        return;\n      }\n      if (dom.getContentEditable(selection.getNode()) === 'false') {\n        node = selection.getNode();\n        for (var i = 0; i < formatList.length; i++) {\n          if (formatList[i].ceFalseOverride) {\n            if (removeFormat(ed, formatList[i], vars, node, node)) {\n              break;\n            }\n          }\n        }\n        return;\n      }\n      if (!selection.isCollapsed() || !format.inline || getCellsFromEditor(ed).length) {\n        preserve(selection, true, function () {\n          runOnRanges(ed, removeRngStyle);\n        });\n        if (format.inline && match(ed, name, vars, selection.getStart())) {\n          moveStart(dom, selection, selection.getRng());\n        }\n        ed.nodeChanged();\n      } else {\n        removeCaretFormat(ed, name, vars, similar);\n      }\n    };\n\n    var each$b = Tools.each;\n    var mergeTextDecorationsAndColor = function (dom, format, vars, node) {\n      var processTextDecorationsAndColor = function (n) {\n        if (n.nodeType === 1 && n.parentNode && n.parentNode.nodeType === 1) {\n          var textDecoration = getTextDecoration(dom, n.parentNode);\n          if (dom.getStyle(n, 'color') && textDecoration) {\n            dom.setStyle(n, 'text-decoration', textDecoration);\n          } else if (dom.getStyle(n, 'text-decoration') === textDecoration) {\n            dom.setStyle(n, 'text-decoration', null);\n          }\n        }\n      };\n      if (format.styles && (format.styles.color || format.styles.textDecoration)) {\n        Tools.walk(node, processTextDecorationsAndColor, 'childNodes');\n        processTextDecorationsAndColor(node);\n      }\n    };\n    var mergeBackgroundColorAndFontSize = function (dom, format, vars, node) {\n      if (format.styles && format.styles.backgroundColor) {\n        processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'backgroundColor', replaceVars(format.styles.backgroundColor, vars)));\n      }\n    };\n    var mergeSubSup = function (dom, format, vars, node) {\n      if (format.inline === 'sub' || format.inline === 'sup') {\n        processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'fontSize', ''));\n        dom.remove(dom.select(format.inline === 'sup' ? 'sub' : 'sup', node), true);\n      }\n    };\n    var mergeWithChildren = function (editor, formatList, vars, node) {\n      each$b(formatList, function (format) {\n        each$b(editor.dom.select(format.inline, node), function (child) {\n          if (!isElementNode(child)) {\n            return;\n          }\n          removeFormat(editor, format, vars, child, format.exact ? child : null);\n        });\n        clearChildStyles(editor.dom, format, node);\n      });\n    };\n    var mergeWithParents = function (editor, format, name, vars, node) {\n      if (matchNode(editor, node.parentNode, name, vars)) {\n        if (removeFormat(editor, format, vars, node)) {\n          return;\n        }\n      }\n      if (format.merge_with_parents) {\n        editor.dom.getParent(node.parentNode, function (parent) {\n          if (matchNode(editor, parent, name, vars)) {\n            removeFormat(editor, format, vars, node);\n            return true;\n          }\n        });\n      }\n    };\n\n    var each$c = Tools.each;\n    var hasFormatProperty = function (format, prop) {\n      return hasNonNullableKey(format, prop);\n    };\n    var isElementNode$1 = function (node) {\n      return node && node.nodeType === 1 && !isBookmarkNode$1(node) && !isCaretNode(node) && !isBogus(node);\n    };\n    var canFormatBR = function (editor, format, node, parentName) {\n      if (canFormatEmptyLines(editor) && isInlineFormat(format)) {\n        var validBRParentElements = __assign(__assign({}, editor.schema.getTextBlockElements()), {\n          td: {},\n          th: {},\n          li: {},\n          dt: {},\n          dd: {},\n          figcaption: {},\n          caption: {},\n          details: {},\n          summary: {}\n        });\n        var hasCaretNodeSibling = sibling$2(SugarElement.fromDom(node), function (sibling) {\n          return isCaretNode(sibling.dom);\n        });\n        return hasNonNullableKey(validBRParentElements, parentName) && isEmpty(SugarElement.fromDom(node.parentNode), false) && !hasCaretNodeSibling;\n      } else {\n        return false;\n      }\n    };\n    var applyFormat = function (ed, name, vars, node) {\n      var formatList = ed.formatter.get(name);\n      var format = formatList[0];\n      var isCollapsed = !node && ed.selection.isCollapsed();\n      var dom = ed.dom;\n      var selection = ed.selection;\n      var setElementFormat = function (elm, fmt) {\n        fmt = fmt || format;\n        if (elm) {\n          if (fmt.onformat) {\n            fmt.onformat(elm, fmt, vars, node);\n          }\n          each$c(fmt.styles, function (value, name) {\n            dom.setStyle(elm, name, replaceVars(value, vars));\n          });\n          if (fmt.styles) {\n            var styleVal = dom.getAttrib(elm, 'style');\n            if (styleVal) {\n              dom.setAttrib(elm, 'data-mce-style', styleVal);\n            }\n          }\n          each$c(fmt.attributes, function (value, name) {\n            dom.setAttrib(elm, name, replaceVars(value, vars));\n          });\n          each$c(fmt.classes, function (value) {\n            value = replaceVars(value, vars);\n            if (!dom.hasClass(elm, value)) {\n              dom.addClass(elm, value);\n            }\n          });\n        }\n      };\n      var applyNodeStyle = function (formatList, node) {\n        var found = false;\n        if (!isSelectorFormat(format)) {\n          return false;\n        }\n        each$c(formatList, function (format) {\n          if ('collapsed' in format && format.collapsed !== isCollapsed) {\n            return;\n          }\n          if (dom.is(node, format.selector) && !isCaretNode(node)) {\n            setElementFormat(node, format);\n            found = true;\n            return false;\n          }\n        });\n        return found;\n      };\n      var applyRngStyle = function (dom, rng, bookmark, nodeSpecific) {\n        var newWrappers = [];\n        var contentEditable = true;\n        var wrapName = format.inline || format.block;\n        var wrapElm = dom.create(wrapName);\n        setElementFormat(wrapElm);\n        walk$1(dom, rng, function (nodes) {\n          var currentWrapElm;\n          var process = function (node) {\n            var hasContentEditableState = false;\n            var lastContentEditable = contentEditable;\n            var nodeName = node.nodeName.toLowerCase();\n            var parentName = node.parentNode.nodeName.toLowerCase();\n            if (isElement$1(node) && dom.getContentEditable(node)) {\n              lastContentEditable = contentEditable;\n              contentEditable = dom.getContentEditable(node) === 'true';\n              hasContentEditableState = true;\n            }\n            if (isBr(node) && !canFormatBR(ed, format, node, parentName)) {\n              currentWrapElm = null;\n              if (isBlockFormat(format)) {\n                dom.remove(node);\n              }\n              return;\n            }\n            if (format.wrapper && matchNode(ed, node, name, vars)) {\n              currentWrapElm = null;\n              return;\n            }\n            if (contentEditable && !hasContentEditableState && isBlockFormat(format) && !format.wrapper && isTextBlock$1(ed, nodeName) && isValid(ed, parentName, wrapName)) {\n              var elm = dom.rename(node, wrapName);\n              setElementFormat(elm);\n              newWrappers.push(elm);\n              currentWrapElm = null;\n              return;\n            }\n            if (isSelectorFormat(format)) {\n              var found = applyNodeStyle(formatList, node);\n              if (!hasFormatProperty(format, 'inline') || found) {\n                currentWrapElm = null;\n                return;\n              }\n            }\n            if (contentEditable && !hasContentEditableState && isValid(ed, wrapName, nodeName) && isValid(ed, parentName, wrapName) && !(!nodeSpecific && node.nodeType === 3 && node.nodeValue.length === 1 && node.nodeValue.charCodeAt(0) === 65279) && !isCaretNode(node) && (!hasFormatProperty(format, 'inline') || !dom.isBlock(node))) {\n              if (!currentWrapElm) {\n                currentWrapElm = dom.clone(wrapElm, false);\n                node.parentNode.insertBefore(currentWrapElm, node);\n                newWrappers.push(currentWrapElm);\n              }\n              currentWrapElm.appendChild(node);\n            } else {\n              currentWrapElm = null;\n              each$c(Tools.grep(node.childNodes), process);\n              if (hasContentEditableState) {\n                contentEditable = lastContentEditable;\n              }\n              currentWrapElm = null;\n            }\n          };\n          each$c(nodes, process);\n        });\n        if (format.links === true) {\n          each$c(newWrappers, function (node) {\n            var process = function (node) {\n              if (node.nodeName === 'A') {\n                setElementFormat(node, format);\n              }\n              each$c(Tools.grep(node.childNodes), process);\n            };\n            process(node);\n          });\n        }\n        each$c(newWrappers, function (node) {\n          var getChildCount = function (node) {\n            var count = 0;\n            each$c(node.childNodes, function (node) {\n              if (!isEmptyTextNode(node) && !isBookmarkNode$1(node)) {\n                count++;\n              }\n            });\n            return count;\n          };\n          var getChildElementNode = function (root) {\n            var child = false;\n            each$c(root.childNodes, function (node) {\n              if (isElementNode$1(node)) {\n                child = node;\n                return false;\n              }\n            });\n            return child;\n          };\n          var mergeStyles = function (node) {\n            var clone;\n            var child = getChildElementNode(node);\n            if (child && !isBookmarkNode$1(child) && matchName(dom, child, format)) {\n              clone = dom.clone(child, false);\n              setElementFormat(clone);\n              dom.replace(clone, node, true);\n              dom.remove(child, true);\n            }\n            return clone || node;\n          };\n          var childCount = getChildCount(node);\n          if ((newWrappers.length > 1 || !dom.isBlock(node)) && childCount === 0) {\n            dom.remove(node, true);\n            return;\n          }\n          if (isInlineFormat(format) || format.wrapper) {\n            if (!format.exact && childCount === 1) {\n              node = mergeStyles(node);\n            }\n            mergeWithChildren(ed, formatList, vars, node);\n            mergeWithParents(ed, format, name, vars, node);\n            mergeBackgroundColorAndFontSize(dom, format, vars, node);\n            mergeTextDecorationsAndColor(dom, format, vars, node);\n            mergeSubSup(dom, format, vars, node);\n            mergeSiblings(dom, format, vars, node);\n          }\n        });\n      };\n      if (dom.getContentEditable(selection.getNode()) === 'false') {\n        node = selection.getNode();\n        for (var i = 0, l = formatList.length; i < l; i++) {\n          var formatItem = formatList[i];\n          if (formatItem.ceFalseOverride && isSelectorFormat(formatItem) && dom.is(node, formatItem.selector)) {\n            setElementFormat(node, formatItem);\n            return;\n          }\n        }\n        return;\n      }\n      if (format) {\n        if (node) {\n          if (isNode(node)) {\n            if (!applyNodeStyle(formatList, node)) {\n              var rng = dom.createRng();\n              rng.setStartBefore(node);\n              rng.setEndAfter(node);\n              applyRngStyle(dom, expandRng(ed, rng, formatList), null, true);\n            }\n          } else {\n            applyRngStyle(dom, node, null, true);\n          }\n        } else {\n          if (!isCollapsed || !isInlineFormat(format) || getCellsFromEditor(ed).length) {\n            var curSelNode = selection.getNode();\n            var firstFormat = formatList[0];\n            if (!ed.settings.forced_root_block && firstFormat.defaultBlock && !dom.getParent(curSelNode, dom.isBlock)) {\n              applyFormat(ed, firstFormat.defaultBlock);\n            }\n            selection.setRng(normalize$2(selection.getRng()));\n            preserve(selection, true, function (bookmark) {\n              runOnRanges(ed, function (selectionRng, fake) {\n                var expandedRng = fake ? selectionRng : expandRng(ed, selectionRng, formatList);\n                applyRngStyle(dom, expandedRng);\n              });\n            });\n            moveStart(dom, selection, selection.getRng());\n            ed.nodeChanged();\n          } else {\n            applyCaretFormat(ed, name, vars);\n          }\n        }\n        postProcess(name, ed);\n      }\n    };\n\n    var setup$4 = function (registeredFormatListeners, editor) {\n      var currentFormats = Cell({});\n      registeredFormatListeners.set({});\n      editor.on('NodeChange', function (e) {\n        updateAndFireChangeCallbacks(editor, e.element, currentFormats, registeredFormatListeners.get());\n      });\n    };\n    var updateAndFireChangeCallbacks = function (editor, elm, currentFormats, formatChangeData) {\n      var formatsList = keys(currentFormats.get());\n      var newFormats = {};\n      var matchedFormats = {};\n      var parents = filter(getParents$1(editor.dom, elm), function (node) {\n        return node.nodeType === 1 && !node.getAttribute('data-mce-bogus');\n      });\n      each$1(formatChangeData, function (data, format) {\n        Tools.each(parents, function (node) {\n          if (editor.formatter.matchNode(node, format, {}, data.similar)) {\n            if (formatsList.indexOf(format) === -1) {\n              each(data.callbacks, function (callback) {\n                callback(true, {\n                  node: node,\n                  format: format,\n                  parents: parents\n                });\n              });\n              newFormats[format] = data.callbacks;\n            }\n            matchedFormats[format] = data.callbacks;\n            return false;\n          }\n          if (matchesUnInheritedFormatSelector(editor, node, format)) {\n            return false;\n          }\n        });\n      });\n      var remainingFormats = filterRemainingFormats(currentFormats.get(), matchedFormats, elm, parents);\n      currentFormats.set(__assign(__assign({}, newFormats), remainingFormats));\n    };\n    var filterRemainingFormats = function (currentFormats, matchedFormats, elm, parents) {\n      return bifilter(currentFormats, function (callbacks, format) {\n        if (!has(matchedFormats, format)) {\n          each(callbacks, function (callback) {\n            callback(false, {\n              node: elm,\n              format: format,\n              parents: parents\n            });\n          });\n          return false;\n        } else {\n          return true;\n        }\n      }).t;\n    };\n    var addListeners = function (registeredFormatListeners, formats, callback, similar) {\n      var formatChangeItems = registeredFormatListeners.get();\n      each(formats.split(','), function (format) {\n        if (!formatChangeItems[format]) {\n          formatChangeItems[format] = {\n            similar: similar,\n            callbacks: []\n          };\n        }\n        formatChangeItems[format].callbacks.push(callback);\n      });\n      registeredFormatListeners.set(formatChangeItems);\n    };\n    var removeListeners = function (registeredFormatListeners, formats, callback) {\n      var formatChangeItems = registeredFormatListeners.get();\n      each(formats.split(','), function (format) {\n        formatChangeItems[format].callbacks = filter(formatChangeItems[format].callbacks, function (c) {\n          return c !== callback;\n        });\n        if (formatChangeItems[format].callbacks.length === 0) {\n          delete formatChangeItems[format];\n        }\n      });\n      registeredFormatListeners.set(formatChangeItems);\n    };\n    var formatChangedInternal = function (editor, registeredFormatListeners, formats, callback, similar) {\n      if (registeredFormatListeners.get() === null) {\n        setup$4(registeredFormatListeners, editor);\n      }\n      addListeners(registeredFormatListeners, formats, callback, similar);\n      return {\n        unbind: function () {\n          return removeListeners(registeredFormatListeners, formats, callback);\n        }\n      };\n    };\n\n    var toggle = function (editor, name, vars, node) {\n      var fmt = editor.formatter.get(name);\n      if (match(editor, name, vars, node) && (!('toggle' in fmt[0]) || fmt[0].toggle)) {\n        remove$6(editor, name, vars, node);\n      } else {\n        applyFormat(editor, name, vars, node);\n      }\n    };\n\n    var fromElements = function (elements, scope) {\n      var doc = scope || document;\n      var fragment = doc.createDocumentFragment();\n      each(elements, function (element) {\n        fragment.appendChild(element.dom);\n      });\n      return SugarElement.fromDom(fragment);\n    };\n\n    var tableModel = function (element, width, rows) {\n      return {\n        element: element,\n        width: width,\n        rows: rows\n      };\n    };\n    var tableRow = function (element, cells) {\n      return {\n        element: element,\n        cells: cells\n      };\n    };\n    var cellPosition = function (x, y) {\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var getSpan = function (td, key) {\n      var value = parseInt(get$4(td, key), 10);\n      return isNaN(value) ? 1 : value;\n    };\n    var fillout = function (table, x, y, tr, td) {\n      var rowspan = getSpan(td, 'rowspan');\n      var colspan = getSpan(td, 'colspan');\n      var rows = table.rows;\n      for (var y2 = y; y2 < y + rowspan; y2++) {\n        if (!rows[y2]) {\n          rows[y2] = tableRow(deep(tr), []);\n        }\n        for (var x2 = x; x2 < x + colspan; x2++) {\n          var cells = rows[y2].cells;\n          cells[x2] = y2 === y && x2 === x ? td : shallow(td);\n        }\n      }\n    };\n    var cellExists = function (table, x, y) {\n      var rows = table.rows;\n      var cells = rows[y] ? rows[y].cells : [];\n      return !!cells[x];\n    };\n    var skipCellsX = function (table, x, y) {\n      while (cellExists(table, x, y)) {\n        x++;\n      }\n      return x;\n    };\n    var getWidth = function (rows) {\n      return foldl(rows, function (acc, row) {\n        return row.cells.length > acc ? row.cells.length : acc;\n      }, 0);\n    };\n    var findElementPos = function (table, element) {\n      var rows = table.rows;\n      for (var y = 0; y < rows.length; y++) {\n        var cells = rows[y].cells;\n        for (var x = 0; x < cells.length; x++) {\n          if (eq$2(cells[x], element)) {\n            return Optional.some(cellPosition(x, y));\n          }\n        }\n      }\n      return Optional.none();\n    };\n    var extractRows = function (table, sx, sy, ex, ey) {\n      var newRows = [];\n      var rows = table.rows;\n      for (var y = sy; y <= ey; y++) {\n        var cells = rows[y].cells;\n        var slice = sx < ex ? cells.slice(sx, ex + 1) : cells.slice(ex, sx + 1);\n        newRows.push(tableRow(rows[y].element, slice));\n      }\n      return newRows;\n    };\n    var subTable = function (table, startPos, endPos) {\n      var sx = startPos.x, sy = startPos.y;\n      var ex = endPos.x, ey = endPos.y;\n      var newRows = sy < ey ? extractRows(table, sx, sy, ex, ey) : extractRows(table, sx, ey, ex, sy);\n      return tableModel(table.element, getWidth(newRows), newRows);\n    };\n    var createDomTable = function (table, rows) {\n      var tableElement = shallow(table.element);\n      var tableBody = SugarElement.fromTag('tbody');\n      append$1(tableBody, rows);\n      append(tableElement, tableBody);\n      return tableElement;\n    };\n    var modelRowsToDomRows = function (table) {\n      return map(table.rows, function (row) {\n        var cells = map(row.cells, function (cell) {\n          var td = deep(cell);\n          remove$1(td, 'colspan');\n          remove$1(td, 'rowspan');\n          return td;\n        });\n        var tr = shallow(row.element);\n        append$1(tr, cells);\n        return tr;\n      });\n    };\n    var fromDom$1 = function (tableElm) {\n      var table = tableModel(shallow(tableElm), 0, []);\n      each(descendants$1(tableElm, 'tr'), function (tr, y) {\n        each(descendants$1(tr, 'td,th'), function (td, x) {\n          fillout(table, skipCellsX(table, x, y), y, tr, td);\n        });\n      });\n      return tableModel(table.element, getWidth(table.rows), table.rows);\n    };\n    var toDom = function (table) {\n      return createDomTable(table, modelRowsToDomRows(table));\n    };\n    var subsection = function (table, startElement, endElement) {\n      return findElementPos(table, startElement).bind(function (startPos) {\n        return findElementPos(table, endElement).map(function (endPos) {\n          return subTable(table, startPos, endPos);\n        });\n      });\n    };\n\n    var findParentListContainer = function (parents) {\n      return find(parents, function (elm) {\n        return name(elm) === 'ul' || name(elm) === 'ol';\n      });\n    };\n    var getFullySelectedListWrappers = function (parents, rng) {\n      return find(parents, function (elm) {\n        return name(elm) === 'li' && hasAllContentsSelected(elm, rng);\n      }).fold(constant([]), function (_li) {\n        return findParentListContainer(parents).map(function (listCont) {\n          var listElm = SugarElement.fromTag(name(listCont));\n          var listStyles = filter$1(getAllRaw(listCont), function (_style, name) {\n            return startsWith(name, 'list-style');\n          });\n          setAll$1(listElm, listStyles);\n          return [\n            SugarElement.fromTag('li'),\n            listElm\n          ];\n        }).getOr([]);\n      });\n    };\n    var wrap$3 = function (innerElm, elms) {\n      var wrapped = foldl(elms, function (acc, elm) {\n        append(elm, acc);\n        return elm;\n      }, innerElm);\n      return elms.length > 0 ? fromElements([wrapped]) : wrapped;\n    };\n    var directListWrappers = function (commonAnchorContainer) {\n      if (isListItem(commonAnchorContainer)) {\n        return parent(commonAnchorContainer).filter(isList).fold(constant([]), function (listElm) {\n          return [\n            commonAnchorContainer,\n            listElm\n          ];\n        });\n      } else {\n        return isList(commonAnchorContainer) ? [commonAnchorContainer] : [];\n      }\n    };\n    var getWrapElements = function (rootNode, rng) {\n      var commonAnchorContainer = SugarElement.fromDom(rng.commonAncestorContainer);\n      var parents = parentsAndSelf(commonAnchorContainer, rootNode);\n      var wrapElements = filter(parents, function (elm) {\n        return isInline(elm) || isHeading(elm);\n      });\n      var listWrappers = getFullySelectedListWrappers(parents, rng);\n      var allWrappers = wrapElements.concat(listWrappers.length ? listWrappers : directListWrappers(commonAnchorContainer));\n      return map(allWrappers, shallow);\n    };\n    var emptyFragment = function () {\n      return fromElements([]);\n    };\n    var getFragmentFromRange = function (rootNode, rng) {\n      return wrap$3(SugarElement.fromDom(rng.cloneContents()), getWrapElements(rootNode, rng));\n    };\n    var getParentTable = function (rootElm, cell) {\n      return ancestor$1(cell, 'table', curry(eq$2, rootElm));\n    };\n    var getTableFragment = function (rootNode, selectedTableCells) {\n      return getParentTable(rootNode, selectedTableCells[0]).bind(function (tableElm) {\n        var firstCell = selectedTableCells[0];\n        var lastCell = selectedTableCells[selectedTableCells.length - 1];\n        var fullTableModel = fromDom$1(tableElm);\n        return subsection(fullTableModel, firstCell, lastCell).map(function (sectionedTableModel) {\n          return fromElements([toDom(sectionedTableModel)]);\n        });\n      }).getOrThunk(emptyFragment);\n    };\n    var getSelectionFragment = function (rootNode, ranges) {\n      return ranges.length > 0 && ranges[0].collapsed ? emptyFragment() : getFragmentFromRange(rootNode, ranges[0]);\n    };\n    var read$1 = function (rootNode, ranges) {\n      var selectedCells = getCellsFromElementOrRanges(ranges, rootNode);\n      return selectedCells.length > 0 ? getTableFragment(rootNode, selectedCells) : getSelectionFragment(rootNode, ranges);\n    };\n\n    var trimLeadingCollapsibleText = function (text) {\n      return text.replace(/^[ \\f\\n\\r\\t\\v]+/, '');\n    };\n    var isCollapsibleWhitespace = function (text, index) {\n      return index >= 0 && index < text.length && isWhiteSpace$1(text.charAt(index));\n    };\n    var getInnerText = function (bin, shouldTrim) {\n      var text = trim$2(bin.innerText);\n      return shouldTrim ? trimLeadingCollapsibleText(text) : text;\n    };\n    var getContextNodeName = function (parentBlockOpt) {\n      return parentBlockOpt.map(function (block) {\n        return block.nodeName;\n      }).getOr('div').toLowerCase();\n    };\n    var getTextContent = function (editor) {\n      return Optional.from(editor.selection.getRng()).map(function (rng) {\n        var parentBlockOpt = Optional.from(editor.dom.getParent(rng.commonAncestorContainer, editor.dom.isBlock));\n        var body = editor.getBody();\n        var contextNodeName = getContextNodeName(parentBlockOpt);\n        var shouldTrimSpaces = Env.browser.isIE() && contextNodeName !== 'pre';\n        var bin = editor.dom.add(body, contextNodeName, {\n          'data-mce-bogus': 'all',\n          'style': 'overflow: hidden; opacity: 0;'\n        }, rng.cloneContents());\n        var text = getInnerText(bin, shouldTrimSpaces);\n        var nonRenderedText = trim$2(bin.textContent);\n        editor.dom.remove(bin);\n        if (isCollapsibleWhitespace(nonRenderedText, 0) || isCollapsibleWhitespace(nonRenderedText, nonRenderedText.length - 1)) {\n          var parentBlock = parentBlockOpt.getOr(body);\n          var parentBlockText = getInnerText(parentBlock, shouldTrimSpaces);\n          var textIndex = parentBlockText.indexOf(text);\n          if (textIndex === -1) {\n            return text;\n          } else {\n            var hasProceedingSpace = isCollapsibleWhitespace(parentBlockText, textIndex - 1);\n            var hasTrailingSpace = isCollapsibleWhitespace(parentBlockText, textIndex + text.length);\n            return (hasProceedingSpace ? ' ' : '') + text + (hasTrailingSpace ? ' ' : '');\n          }\n        } else {\n          return text;\n        }\n      }).getOr('');\n    };\n    var getSerializedContent = function (editor, args) {\n      var rng = editor.selection.getRng(), tmpElm = editor.dom.create('body');\n      var sel = editor.selection.getSel();\n      var ranges = processRanges(editor, getRanges(sel));\n      var fragment = args.contextual ? read$1(SugarElement.fromDom(editor.getBody()), ranges).dom : rng.cloneContents();\n      if (fragment) {\n        tmpElm.appendChild(fragment);\n      }\n      return editor.selection.serializer.serialize(tmpElm, args);\n    };\n    var getSelectedContentInternal = function (editor, format, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      args.get = true;\n      args.format = format;\n      args.selection = true;\n      args = editor.fire('BeforeGetContent', args);\n      if (args.isDefaultPrevented()) {\n        editor.fire('GetContent', args);\n        return args.content;\n      }\n      if (args.format === 'text') {\n        return getTextContent(editor);\n      } else {\n        args.getInner = true;\n        var content = getSerializedContent(editor, args);\n        if (args.format === 'tree') {\n          return content;\n        } else {\n          args.content = editor.selection.isCollapsed() ? '' : content;\n          editor.fire('GetContent', args);\n          return args.content;\n        }\n      }\n    };\n\n    var KEEP = 0, INSERT = 1, DELETE = 2;\n    var diff = function (left, right) {\n      var size = left.length + right.length + 2;\n      var vDown = new Array(size);\n      var vUp = new Array(size);\n      var snake = function (start, end, diag) {\n        return {\n          start: start,\n          end: end,\n          diag: diag\n        };\n      };\n      var buildScript = function (start1, end1, start2, end2, script) {\n        var middle = getMiddleSnake(start1, end1, start2, end2);\n        if (middle === null || middle.start === end1 && middle.diag === end1 - end2 || middle.end === start1 && middle.diag === start1 - start2) {\n          var i = start1;\n          var j = start2;\n          while (i < end1 || j < end2) {\n            if (i < end1 && j < end2 && left[i] === right[j]) {\n              script.push([\n                KEEP,\n                left[i]\n              ]);\n              ++i;\n              ++j;\n            } else {\n              if (end1 - start1 > end2 - start2) {\n                script.push([\n                  DELETE,\n                  left[i]\n                ]);\n                ++i;\n              } else {\n                script.push([\n                  INSERT,\n                  right[j]\n                ]);\n                ++j;\n              }\n            }\n          }\n        } else {\n          buildScript(start1, middle.start, start2, middle.start - middle.diag, script);\n          for (var i2 = middle.start; i2 < middle.end; ++i2) {\n            script.push([\n              KEEP,\n              left[i2]\n            ]);\n          }\n          buildScript(middle.end, end1, middle.end - middle.diag, end2, script);\n        }\n      };\n      var buildSnake = function (start, diag, end1, end2) {\n        var end = start;\n        while (end - diag < end2 && end < end1 && left[end] === right[end - diag]) {\n          ++end;\n        }\n        return snake(start, end, diag);\n      };\n      var getMiddleSnake = function (start1, end1, start2, end2) {\n        var m = end1 - start1;\n        var n = end2 - start2;\n        if (m === 0 || n === 0) {\n          return null;\n        }\n        var delta = m - n;\n        var sum = n + m;\n        var offset = (sum % 2 === 0 ? sum : sum + 1) / 2;\n        vDown[1 + offset] = start1;\n        vUp[1 + offset] = end1 + 1;\n        var d, k, i, x, y;\n        for (d = 0; d <= offset; ++d) {\n          for (k = -d; k <= d; k += 2) {\n            i = k + offset;\n            if (k === -d || k !== d && vDown[i - 1] < vDown[i + 1]) {\n              vDown[i] = vDown[i + 1];\n            } else {\n              vDown[i] = vDown[i - 1] + 1;\n            }\n            x = vDown[i];\n            y = x - start1 + start2 - k;\n            while (x < end1 && y < end2 && left[x] === right[y]) {\n              vDown[i] = ++x;\n              ++y;\n            }\n            if (delta % 2 !== 0 && delta - d <= k && k <= delta + d) {\n              if (vUp[i - delta] <= vDown[i]) {\n                return buildSnake(vUp[i - delta], k + start1 - start2, end1, end2);\n              }\n            }\n          }\n          for (k = delta - d; k <= delta + d; k += 2) {\n            i = k + offset - delta;\n            if (k === delta - d || k !== delta + d && vUp[i + 1] <= vUp[i - 1]) {\n              vUp[i] = vUp[i + 1] - 1;\n            } else {\n              vUp[i] = vUp[i - 1];\n            }\n            x = vUp[i] - 1;\n            y = x - start1 + start2 - k;\n            while (x >= start1 && y >= start2 && left[x] === right[y]) {\n              vUp[i] = x--;\n              y--;\n            }\n            if (delta % 2 === 0 && -d <= k && k <= d) {\n              if (vUp[i] <= vDown[i + delta]) {\n                return buildSnake(vUp[i], k + start1 - start2, end1, end2);\n              }\n            }\n          }\n        }\n      };\n      var script = [];\n      buildScript(0, left.length, 0, right.length, script);\n      return script;\n    };\n\n    var getOuterHtml = function (elm) {\n      if (isElement$1(elm)) {\n        return elm.outerHTML;\n      } else if (isText$1(elm)) {\n        return Entities.encodeRaw(elm.data, false);\n      } else if (isComment$1(elm)) {\n        return '<!--' + elm.data + '-->';\n      }\n      return '';\n    };\n    var createFragment$1 = function (html) {\n      var node;\n      var container = document.createElement('div');\n      var frag = document.createDocumentFragment();\n      if (html) {\n        container.innerHTML = html;\n      }\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n      return frag;\n    };\n    var insertAt = function (elm, html, index) {\n      var fragment = createFragment$1(html);\n      if (elm.hasChildNodes() && index < elm.childNodes.length) {\n        var target = elm.childNodes[index];\n        target.parentNode.insertBefore(fragment, target);\n      } else {\n        elm.appendChild(fragment);\n      }\n    };\n    var removeAt = function (elm, index) {\n      if (elm.hasChildNodes() && index < elm.childNodes.length) {\n        var target = elm.childNodes[index];\n        target.parentNode.removeChild(target);\n      }\n    };\n    var applyDiff = function (diff, elm) {\n      var index = 0;\n      each(diff, function (action) {\n        if (action[0] === KEEP) {\n          index++;\n        } else if (action[0] === INSERT) {\n          insertAt(elm, action[1], index);\n          index++;\n        } else if (action[0] === DELETE) {\n          removeAt(elm, index);\n        }\n      });\n    };\n    var read$2 = function (elm) {\n      return filter(map(from$1(elm.childNodes), getOuterHtml), function (item) {\n        return item.length > 0;\n      });\n    };\n    var write = function (fragments, elm) {\n      var currentFragments = map(from$1(elm.childNodes), getOuterHtml);\n      applyDiff(diff(currentFragments, fragments), elm);\n      return elm;\n    };\n\n    var undoLevelDocument = Cell(Optional.none());\n    var lazyTempDocument = function () {\n      return undoLevelDocument.get().getOrThunk(function () {\n        var doc = document.implementation.createHTMLDocument('undo');\n        undoLevelDocument.set(Optional.some(doc));\n        return doc;\n      });\n    };\n    var hasIframes = function (html) {\n      return html.indexOf('</iframe>') !== -1;\n    };\n    var createFragmentedLevel = function (fragments) {\n      return {\n        type: 'fragmented',\n        fragments: fragments,\n        content: '',\n        bookmark: null,\n        beforeBookmark: null\n      };\n    };\n    var createCompleteLevel = function (content) {\n      return {\n        type: 'complete',\n        fragments: null,\n        content: content,\n        bookmark: null,\n        beforeBookmark: null\n      };\n    };\n    var createFromEditor = function (editor) {\n      var fragments = read$2(editor.getBody());\n      var trimmedFragments = bind(fragments, function (html) {\n        var trimmed = trimInternal(editor.serializer, html);\n        return trimmed.length > 0 ? [trimmed] : [];\n      });\n      var content = trimmedFragments.join('');\n      return hasIframes(content) ? createFragmentedLevel(trimmedFragments) : createCompleteLevel(content);\n    };\n    var applyToEditor = function (editor, level, before) {\n      if (level.type === 'fragmented') {\n        write(level.fragments, editor.getBody());\n      } else {\n        editor.setContent(level.content, { format: 'raw' });\n      }\n      editor.selection.moveToBookmark(before ? level.beforeBookmark : level.bookmark);\n    };\n    var getLevelContent = function (level) {\n      return level.type === 'fragmented' ? level.fragments.join('') : level.content;\n    };\n    var getCleanLevelContent = function (level) {\n      var elm = SugarElement.fromTag('body', lazyTempDocument());\n      set$1(elm, getLevelContent(level));\n      each(descendants$1(elm, '*[data-mce-bogus]'), unwrap);\n      return get$7(elm);\n    };\n    var hasEqualContent = function (level1, level2) {\n      return getLevelContent(level1) === getLevelContent(level2);\n    };\n    var hasEqualCleanedContent = function (level1, level2) {\n      return getCleanLevelContent(level1) === getCleanLevelContent(level2);\n    };\n    var isEq$4 = function (level1, level2) {\n      if (!level1 || !level2) {\n        return false;\n      } else if (hasEqualContent(level1, level2)) {\n        return true;\n      } else {\n        return hasEqualCleanedContent(level1, level2);\n      }\n    };\n\n    var isUnlocked = function (locks) {\n      return locks.get() === 0;\n    };\n\n    var setTyping = function (undoManager, typing, locks) {\n      if (isUnlocked(locks)) {\n        undoManager.typing = typing;\n      }\n    };\n    var endTyping = function (undoManager, locks) {\n      if (undoManager.typing) {\n        setTyping(undoManager, false, locks);\n        undoManager.add();\n      }\n    };\n    var endTypingLevelIgnoreLocks = function (undoManager) {\n      if (undoManager.typing) {\n        undoManager.typing = false;\n        undoManager.add();\n      }\n    };\n\n    var beforeChange = function (editor, locks, beforeBookmark) {\n      if (isUnlocked(locks)) {\n        beforeBookmark.set(Optional.some(getUndoBookmark(editor.selection)));\n      }\n    };\n    var addUndoLevel = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n      var currentLevel = createFromEditor(editor);\n      level = level || {};\n      level = Tools.extend(level, currentLevel);\n      if (isUnlocked(locks) === false || editor.removed) {\n        return null;\n      }\n      var lastLevel = undoManager.data[index.get()];\n      if (editor.fire('BeforeAddUndo', {\n          level: level,\n          lastLevel: lastLevel,\n          originalEvent: event\n        }).isDefaultPrevented()) {\n        return null;\n      }\n      if (lastLevel && isEq$4(lastLevel, level)) {\n        return null;\n      }\n      if (undoManager.data[index.get()]) {\n        beforeBookmark.get().each(function (bm) {\n          undoManager.data[index.get()].beforeBookmark = bm;\n        });\n      }\n      var customUndoRedoLevels = getCustomUndoRedoLevels(editor);\n      if (customUndoRedoLevels) {\n        if (undoManager.data.length > customUndoRedoLevels) {\n          for (var i = 0; i < undoManager.data.length - 1; i++) {\n            undoManager.data[i] = undoManager.data[i + 1];\n          }\n          undoManager.data.length--;\n          index.set(undoManager.data.length);\n        }\n      }\n      level.bookmark = getUndoBookmark(editor.selection);\n      if (index.get() < undoManager.data.length - 1) {\n        undoManager.data.length = index.get() + 1;\n      }\n      undoManager.data.push(level);\n      index.set(undoManager.data.length - 1);\n      var args = {\n        level: level,\n        lastLevel: lastLevel,\n        originalEvent: event\n      };\n      if (index.get() > 0) {\n        editor.setDirty(true);\n        editor.fire('AddUndo', args);\n        editor.fire('change', args);\n      } else {\n        editor.fire('AddUndo', args);\n      }\n      return level;\n    };\n    var clear = function (editor, undoManager, index) {\n      undoManager.data = [];\n      index.set(0);\n      undoManager.typing = false;\n      editor.fire('ClearUndos');\n    };\n    var extra = function (editor, undoManager, index, callback1, callback2) {\n      if (undoManager.transact(callback1)) {\n        var bookmark = undoManager.data[index.get()].bookmark;\n        var lastLevel = undoManager.data[index.get() - 1];\n        applyToEditor(editor, lastLevel, true);\n        if (undoManager.transact(callback2)) {\n          undoManager.data[index.get() - 1].beforeBookmark = bookmark;\n        }\n      }\n    };\n    var redo = function (editor, index, data) {\n      var level;\n      if (index.get() < data.length - 1) {\n        index.set(index.get() + 1);\n        level = data[index.get()];\n        applyToEditor(editor, level, false);\n        editor.setDirty(true);\n        editor.fire('Redo', { level: level });\n      }\n      return level;\n    };\n    var undo = function (editor, undoManager, locks, index) {\n      var level;\n      if (undoManager.typing) {\n        undoManager.add();\n        undoManager.typing = false;\n        setTyping(undoManager, false, locks);\n      }\n      if (index.get() > 0) {\n        index.set(index.get() - 1);\n        level = undoManager.data[index.get()];\n        applyToEditor(editor, level, true);\n        editor.setDirty(true);\n        editor.fire('Undo', { level: level });\n      }\n      return level;\n    };\n    var reset = function (undoManager) {\n      undoManager.clear();\n      undoManager.add();\n    };\n    var hasUndo = function (editor, undoManager, index) {\n      return index.get() > 0 || undoManager.typing && undoManager.data[0] && !isEq$4(createFromEditor(editor), undoManager.data[0]);\n    };\n    var hasRedo = function (undoManager, index) {\n      return index.get() < undoManager.data.length - 1 && !undoManager.typing;\n    };\n    var transact = function (undoManager, locks, callback) {\n      endTyping(undoManager, locks);\n      undoManager.beforeChange();\n      undoManager.ignore(callback);\n      return undoManager.add();\n    };\n    var ignore = function (locks, callback) {\n      try {\n        locks.set(locks.get() + 1);\n        callback();\n      } finally {\n        locks.set(locks.get() - 1);\n      }\n    };\n\n    var addVisualInternal = function (editor, elm) {\n      var dom = editor.dom;\n      var scope = isNonNullable(elm) ? elm : editor.getBody();\n      if (isUndefined(editor.hasVisual)) {\n        editor.hasVisual = isVisualAidsEnabled(editor);\n      }\n      each(dom.select('table,a', scope), function (matchedElm) {\n        switch (matchedElm.nodeName) {\n        case 'TABLE':\n          var cls = getVisualAidsTableClass(editor);\n          var value = dom.getAttrib(matchedElm, 'border');\n          if ((!value || value === '0') && editor.hasVisual) {\n            dom.addClass(matchedElm, cls);\n          } else {\n            dom.removeClass(matchedElm, cls);\n          }\n          break;\n        case 'A':\n          if (!dom.getAttrib(matchedElm, 'href')) {\n            var value_1 = dom.getAttrib(matchedElm, 'name') || matchedElm.id;\n            var cls_1 = getVisualAidsAnchorClass(editor);\n            if (value_1 && editor.hasVisual) {\n              dom.addClass(matchedElm, cls_1);\n            } else {\n              dom.removeClass(matchedElm, cls_1);\n            }\n          }\n          break;\n        }\n      });\n      editor.fire('VisualAid', {\n        element: elm,\n        hasVisual: editor.hasVisual\n      });\n    };\n\n    var makePlainAdaptor = function (editor) {\n      return {\n        undoManager: {\n          beforeChange: function (locks, beforeBookmark) {\n            return beforeChange(editor, locks, beforeBookmark);\n          },\n          addUndoLevel: function (undoManager, index, locks, beforeBookmark, level, event) {\n            return addUndoLevel(editor, undoManager, index, locks, beforeBookmark, level, event);\n          },\n          undo: function (undoManager, locks, index) {\n            return undo(editor, undoManager, locks, index);\n          },\n          redo: function (index, data) {\n            return redo(editor, index, data);\n          },\n          clear: function (undoManager, index) {\n            return clear(editor, undoManager, index);\n          },\n          reset: function (undoManager) {\n            return reset(undoManager);\n          },\n          hasUndo: function (undoManager, index) {\n            return hasUndo(editor, undoManager, index);\n          },\n          hasRedo: function (undoManager, index) {\n            return hasRedo(undoManager, index);\n          },\n          transact: function (undoManager, locks, callback) {\n            return transact(undoManager, locks, callback);\n          },\n          ignore: function (locks, callback) {\n            return ignore(locks, callback);\n          },\n          extra: function (undoManager, index, callback1, callback2) {\n            return extra(editor, undoManager, index, callback1, callback2);\n          }\n        },\n        formatter: {\n          match: function (name, vars, node) {\n            return match(editor, name, vars, node);\n          },\n          matchAll: function (names, vars) {\n            return matchAll(editor, names, vars);\n          },\n          matchNode: function (node, name, vars, similar) {\n            return matchNode(editor, node, name, vars, similar);\n          },\n          canApply: function (name) {\n            return canApply(editor, name);\n          },\n          closest: function (names) {\n            return closest$3(editor, names);\n          },\n          apply: function (name, vars, node) {\n            return applyFormat(editor, name, vars, node);\n          },\n          remove: function (name, vars, node, similar) {\n            return remove$6(editor, name, vars, node, similar);\n          },\n          toggle: function (name, vars, node) {\n            return toggle(editor, name, vars, node);\n          },\n          formatChanged: function (registeredFormatListeners, formats, callback, similar) {\n            return formatChangedInternal(editor, registeredFormatListeners, formats, callback, similar);\n          }\n        },\n        editor: {\n          getContent: function (args, format) {\n            return getContentInternal(editor, args, format);\n          },\n          setContent: function (content, args) {\n            return setContentInternal(editor, content, args);\n          },\n          insertContent: function (value, details) {\n            return insertHtmlAtCaret(editor, value, details);\n          },\n          addVisual: function (elm) {\n            return addVisualInternal(editor, elm);\n          }\n        },\n        selection: {\n          getContent: function (format, args) {\n            return getSelectedContentInternal(editor, format, args);\n          }\n        },\n        raw: {\n          getModel: function () {\n            return Optional.none();\n          }\n        }\n      };\n    };\n    var makeRtcAdaptor = function (rtcEditor) {\n      var defaultVars = function (vars) {\n        return isObject(vars) ? vars : {};\n      };\n      var unsupported = die('Unimplemented feature for rtc');\n      var undoManager = rtcEditor.undoManager, formatter = rtcEditor.formatter, editor = rtcEditor.editor, selection = rtcEditor.selection, raw = rtcEditor.raw;\n      var ignore = noop;\n      return {\n        undoManager: {\n          beforeChange: ignore,\n          addUndoLevel: unsupported,\n          undo: function () {\n            return undoManager.undo();\n          },\n          redo: function () {\n            return undoManager.redo();\n          },\n          clear: function () {\n            return undoManager.clear();\n          },\n          reset: function () {\n            return undoManager.reset();\n          },\n          hasUndo: function () {\n            return undoManager.hasUndo();\n          },\n          hasRedo: function () {\n            return undoManager.hasRedo();\n          },\n          transact: function (_undoManager, _locks, fn) {\n            return undoManager.transact(fn);\n          },\n          ignore: function (_locks, callback) {\n            return undoManager.ignore(callback);\n          },\n          extra: function (_undoManager, _index, callback1, callback2) {\n            return undoManager.extra(callback1, callback2);\n          }\n        },\n        formatter: {\n          match: function (name, vars, _node) {\n            return formatter.match(name, defaultVars(vars));\n          },\n          matchAll: unsupported,\n          matchNode: unsupported,\n          canApply: function (name) {\n            return formatter.canApply(name);\n          },\n          closest: function (names) {\n            return formatter.closest(names);\n          },\n          apply: function (name, vars, _node) {\n            return formatter.apply(name, defaultVars(vars));\n          },\n          remove: function (name, vars, _node, _similar) {\n            return formatter.remove(name, defaultVars(vars));\n          },\n          toggle: function (name, vars, _node) {\n            return formatter.toggle(name, defaultVars(vars));\n          },\n          formatChanged: function (_rfl, formats, callback, similar) {\n            return formatter.formatChanged(formats, callback, similar);\n          }\n        },\n        editor: {\n          getContent: function (args, _format) {\n            return editor.getContent(args);\n          },\n          setContent: function (content, args) {\n            return editor.setContent(content, args);\n          },\n          insertContent: function (content, _details) {\n            return editor.insertContent(content);\n          },\n          addVisual: ignore\n        },\n        selection: {\n          getContent: function (_format, args) {\n            return selection.getContent(args);\n          }\n        },\n        raw: {\n          getModel: function () {\n            return Optional.some(raw.getRawModel());\n          }\n        }\n      };\n    };\n    var makeNoopAdaptor = function () {\n      var nul = constant(null);\n      var empty = constant('');\n      return {\n        undoManager: {\n          beforeChange: noop,\n          addUndoLevel: nul,\n          undo: nul,\n          redo: nul,\n          clear: noop,\n          reset: noop,\n          hasUndo: never,\n          hasRedo: never,\n          transact: nul,\n          ignore: noop,\n          extra: noop\n        },\n        formatter: {\n          match: never,\n          matchAll: constant([]),\n          matchNode: never,\n          canApply: never,\n          closest: empty,\n          apply: noop,\n          remove: noop,\n          toggle: noop,\n          formatChanged: constant({ unbind: noop })\n        },\n        editor: {\n          getContent: empty,\n          setContent: empty,\n          insertContent: noop,\n          addVisual: noop\n        },\n        selection: { getContent: empty },\n        raw: { getModel: constant(Optional.none()) }\n      };\n    };\n    var isRtc = function (editor) {\n      return has(editor.plugins, 'rtc');\n    };\n    var setup$5 = function (editor) {\n      var editorCast = editor;\n      return get$1(editor.plugins, 'rtc').fold(function () {\n        editorCast.rtcInstance = makePlainAdaptor(editor);\n        return Optional.none();\n      }, function (rtc) {\n        return Optional.some(rtc.setup().then(function (rtcEditor) {\n          editorCast.rtcInstance = makeRtcAdaptor(rtcEditor);\n          return rtcEditor.rtc.isRemote;\n        }, function (err) {\n          editorCast.rtcInstance = makeNoopAdaptor();\n          return promiseObj.reject(err);\n        }));\n      });\n    };\n    var getRtcInstanceWithFallback = function (editor) {\n      return editor.rtcInstance ? editor.rtcInstance : makePlainAdaptor(editor);\n    };\n    var getRtcInstanceWithError = function (editor) {\n      var rtcInstance = editor.rtcInstance;\n      if (!rtcInstance) {\n        throw new Error('Failed to get RTC instance not yet initialized.');\n      } else {\n        return rtcInstance;\n      }\n    };\n    var beforeChange$1 = function (editor, locks, beforeBookmark) {\n      getRtcInstanceWithError(editor).undoManager.beforeChange(locks, beforeBookmark);\n    };\n    var addUndoLevel$1 = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n      return getRtcInstanceWithError(editor).undoManager.addUndoLevel(undoManager, index, locks, beforeBookmark, level, event);\n    };\n    var undo$1 = function (editor, undoManager, locks, index) {\n      return getRtcInstanceWithError(editor).undoManager.undo(undoManager, locks, index);\n    };\n    var redo$1 = function (editor, index, data) {\n      return getRtcInstanceWithError(editor).undoManager.redo(index, data);\n    };\n    var clear$1 = function (editor, undoManager, index) {\n      getRtcInstanceWithError(editor).undoManager.clear(undoManager, index);\n    };\n    var reset$1 = function (editor, undoManager) {\n      getRtcInstanceWithError(editor).undoManager.reset(undoManager);\n    };\n    var hasUndo$1 = function (editor, undoManager, index) {\n      return getRtcInstanceWithError(editor).undoManager.hasUndo(undoManager, index);\n    };\n    var hasRedo$1 = function (editor, undoManager, index) {\n      return getRtcInstanceWithError(editor).undoManager.hasRedo(undoManager, index);\n    };\n    var transact$1 = function (editor, undoManager, locks, callback) {\n      return getRtcInstanceWithError(editor).undoManager.transact(undoManager, locks, callback);\n    };\n    var ignore$1 = function (editor, locks, callback) {\n      getRtcInstanceWithError(editor).undoManager.ignore(locks, callback);\n    };\n    var extra$1 = function (editor, undoManager, index, callback1, callback2) {\n      getRtcInstanceWithError(editor).undoManager.extra(undoManager, index, callback1, callback2);\n    };\n    var matchFormat = function (editor, name, vars, node) {\n      return getRtcInstanceWithError(editor).formatter.match(name, vars, node);\n    };\n    var matchAllFormats = function (editor, names, vars) {\n      return getRtcInstanceWithError(editor).formatter.matchAll(names, vars);\n    };\n    var matchNodeFormat = function (editor, node, name, vars, similar) {\n      return getRtcInstanceWithError(editor).formatter.matchNode(node, name, vars, similar);\n    };\n    var canApplyFormat = function (editor, name) {\n      return getRtcInstanceWithError(editor).formatter.canApply(name);\n    };\n    var closestFormat = function (editor, names) {\n      return getRtcInstanceWithError(editor).formatter.closest(names);\n    };\n    var applyFormat$1 = function (editor, name, vars, node) {\n      getRtcInstanceWithError(editor).formatter.apply(name, vars, node);\n    };\n    var removeFormat$1 = function (editor, name, vars, node, similar) {\n      getRtcInstanceWithError(editor).formatter.remove(name, vars, node, similar);\n    };\n    var toggleFormat = function (editor, name, vars, node) {\n      getRtcInstanceWithError(editor).formatter.toggle(name, vars, node);\n    };\n    var formatChanged = function (editor, registeredFormatListeners, formats, callback, similar) {\n      if (similar === void 0) {\n        similar = false;\n      }\n      return getRtcInstanceWithError(editor).formatter.formatChanged(registeredFormatListeners, formats, callback, similar);\n    };\n    var getContent = function (editor, args, format) {\n      return getRtcInstanceWithFallback(editor).editor.getContent(args, format);\n    };\n    var setContent = function (editor, content, args) {\n      return getRtcInstanceWithFallback(editor).editor.setContent(content, args);\n    };\n    var insertContent = function (editor, value, details) {\n      return getRtcInstanceWithFallback(editor).editor.insertContent(value, details);\n    };\n    var getSelectedContent = function (editor, format, args) {\n      return getRtcInstanceWithError(editor).selection.getContent(format, args);\n    };\n    var addVisual = function (editor, elm) {\n      return getRtcInstanceWithError(editor).editor.addVisual(elm);\n    };\n\n    var getContent$1 = function (editor, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      var format = args.format ? args.format : 'html';\n      return getSelectedContent(editor, format, args);\n    };\n\n    var removeEmpty = function (text) {\n      if (text.dom.length === 0) {\n        remove(text);\n        return Optional.none();\n      } else {\n        return Optional.some(text);\n      }\n    };\n    var walkPastBookmark = function (node, start) {\n      return node.filter(function (elm) {\n        return BookmarkManager.isBookmarkNode(elm.dom);\n      }).bind(start ? nextSibling : prevSibling);\n    };\n    var merge = function (outer, inner, rng, start) {\n      var outerElm = outer.dom;\n      var innerElm = inner.dom;\n      var oldLength = start ? outerElm.length : innerElm.length;\n      if (start) {\n        mergeTextNodes(outerElm, innerElm, false, !start);\n        rng.setStart(innerElm, oldLength);\n      } else {\n        mergeTextNodes(innerElm, outerElm, false, !start);\n        rng.setEnd(innerElm, oldLength);\n      }\n    };\n    var normalizeTextIfRequired = function (inner, start) {\n      parent(inner).each(function (root) {\n        var text = inner.dom;\n        if (start && needsToBeNbspLeft(root, CaretPosition(text, 0))) {\n          normalizeWhitespaceAfter(text, 0);\n        } else if (!start && needsToBeNbspRight(root, CaretPosition(text, text.length))) {\n          normalizeWhitespaceBefore(text, text.length);\n        }\n      });\n    };\n    var mergeAndNormalizeText = function (outerNode, innerNode, rng, start) {\n      outerNode.bind(function (outer) {\n        var normalizer = start ? normalizeWhitespaceBefore : normalizeWhitespaceAfter;\n        normalizer(outer.dom, start ? outer.dom.length : 0);\n        return innerNode.filter(isText).map(function (inner) {\n          return merge(outer, inner, rng, start);\n        });\n      }).orThunk(function () {\n        var innerTextNode = walkPastBookmark(innerNode, start).or(innerNode).filter(isText);\n        return innerTextNode.map(function (inner) {\n          return normalizeTextIfRequired(inner, start);\n        });\n      });\n    };\n    var rngSetContent = function (rng, fragment) {\n      var firstChild = Optional.from(fragment.firstChild).map(SugarElement.fromDom);\n      var lastChild = Optional.from(fragment.lastChild).map(SugarElement.fromDom);\n      rng.deleteContents();\n      rng.insertNode(fragment);\n      var prevText = firstChild.bind(prevSibling).filter(isText).bind(removeEmpty);\n      var nextText = lastChild.bind(nextSibling).filter(isText).bind(removeEmpty);\n      mergeAndNormalizeText(prevText, firstChild, rng, true);\n      mergeAndNormalizeText(nextText, lastChild, rng, false);\n      rng.collapse(false);\n    };\n    var setupArgs = function (args, content) {\n      return __assign(__assign({ format: 'html' }, args), {\n        set: true,\n        selection: true,\n        content: content\n      });\n    };\n    var cleanContent = function (editor, args) {\n      if (args.format !== 'raw') {\n        var rng = editor.selection.getRng();\n        var contextBlock = editor.dom.getParent(rng.commonAncestorContainer, editor.dom.isBlock);\n        var contextArgs = contextBlock ? { context: contextBlock.nodeName.toLowerCase() } : {};\n        var node = editor.parser.parse(args.content, __assign(__assign({\n          isRootContent: true,\n          forced_root_block: false\n        }, contextArgs), args));\n        return HtmlSerializer({ validate: editor.validate }, editor.schema).serialize(node);\n      } else {\n        return args.content;\n      }\n    };\n    var setContent$1 = function (editor, content, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      var contentArgs = setupArgs(args, content);\n      if (!contentArgs.no_events) {\n        contentArgs = editor.fire('BeforeSetContent', contentArgs);\n        if (contentArgs.isDefaultPrevented()) {\n          editor.fire('SetContent', contentArgs);\n          return;\n        }\n      }\n      args.content = cleanContent(editor, contentArgs);\n      var rng = editor.selection.getRng();\n      rngSetContent(rng, rng.createContextualFragment(args.content));\n      editor.selection.setRng(rng);\n      scrollRangeIntoView(editor, rng);\n      if (!contentArgs.no_events) {\n        editor.fire('SetContent', contentArgs);\n      }\n    };\n\n    var deleteFromCallbackMap = function (callbackMap, selector, callback) {\n      if (callbackMap && callbackMap.hasOwnProperty(selector)) {\n        var newCallbacks = filter(callbackMap[selector], function (cb) {\n          return cb !== callback;\n        });\n        if (newCallbacks.length === 0) {\n          delete callbackMap[selector];\n        } else {\n          callbackMap[selector] = newCallbacks;\n        }\n      }\n    };\n    function SelectorChanged (dom, editor) {\n      var selectorChangedData;\n      var currentSelectors;\n      return {\n        selectorChangedWithUnbind: function (selector, callback) {\n          if (!selectorChangedData) {\n            selectorChangedData = {};\n            currentSelectors = {};\n            editor.on('NodeChange', function (e) {\n              var node = e.element, parents = dom.getParents(node, null, dom.getRoot()), matchedSelectors = {};\n              Tools.each(selectorChangedData, function (callbacks, selector) {\n                Tools.each(parents, function (node) {\n                  if (dom.is(node, selector)) {\n                    if (!currentSelectors[selector]) {\n                      Tools.each(callbacks, function (callback) {\n                        callback(true, {\n                          node: node,\n                          selector: selector,\n                          parents: parents\n                        });\n                      });\n                      currentSelectors[selector] = callbacks;\n                    }\n                    matchedSelectors[selector] = callbacks;\n                    return false;\n                  }\n                });\n              });\n              Tools.each(currentSelectors, function (callbacks, selector) {\n                if (!matchedSelectors[selector]) {\n                  delete currentSelectors[selector];\n                  Tools.each(callbacks, function (callback) {\n                    callback(false, {\n                      node: node,\n                      selector: selector,\n                      parents: parents\n                    });\n                  });\n                }\n              });\n            });\n          }\n          if (!selectorChangedData[selector]) {\n            selectorChangedData[selector] = [];\n          }\n          selectorChangedData[selector].push(callback);\n          return {\n            unbind: function () {\n              deleteFromCallbackMap(selectorChangedData, selector, callback);\n              deleteFromCallbackMap(currentSelectors, selector, callback);\n            }\n          };\n        }\n      };\n    }\n\n    var isNativeIeSelection = function (rng) {\n      return !!rng.select;\n    };\n    var isAttachedToDom = function (node) {\n      return !!(node && node.ownerDocument) && contains$2(SugarElement.fromDom(node.ownerDocument), SugarElement.fromDom(node));\n    };\n    var isValidRange = function (rng) {\n      if (!rng) {\n        return false;\n      } else if (isNativeIeSelection(rng)) {\n        return true;\n      } else {\n        return isAttachedToDom(rng.startContainer) && isAttachedToDom(rng.endContainer);\n      }\n    };\n    var EditorSelection = function (dom, win, serializer, editor) {\n      var selectedRange;\n      var explicitRange;\n      var selectorChangedWithUnbind = SelectorChanged(dom, editor).selectorChangedWithUnbind;\n      var setCursorLocation = function (node, offset) {\n        var rng = dom.createRng();\n        if (isNonNullable(node) && isNonNullable(offset)) {\n          rng.setStart(node, offset);\n          rng.setEnd(node, offset);\n          setRng(rng);\n          collapse(false);\n        } else {\n          moveEndPoint$1(dom, rng, editor.getBody(), true);\n          setRng(rng);\n        }\n      };\n      var getContent = function (args) {\n        return getContent$1(editor, args);\n      };\n      var setContent = function (content, args) {\n        return setContent$1(editor, content, args);\n      };\n      var getStart = function (real) {\n        return getStart$2(editor.getBody(), getRng$1(), real);\n      };\n      var getEnd$1 = function (real) {\n        return getEnd(editor.getBody(), getRng$1(), real);\n      };\n      var getBookmark = function (type, normalized) {\n        return bookmarkManager.getBookmark(type, normalized);\n      };\n      var moveToBookmark = function (bookmark) {\n        return bookmarkManager.moveToBookmark(bookmark);\n      };\n      var select = function (node, content) {\n        select$1(dom, node, content).each(setRng);\n        return node;\n      };\n      var isCollapsed = function () {\n        var rng = getRng$1(), sel = getSel();\n        if (!rng || rng.item) {\n          return false;\n        }\n        if (rng.compareEndPoints) {\n          return rng.compareEndPoints('StartToEnd', rng) === 0;\n        }\n        return !sel || rng.collapsed;\n      };\n      var collapse = function (toStart) {\n        var rng = getRng$1();\n        rng.collapse(!!toStart);\n        setRng(rng);\n      };\n      var getSel = function () {\n        return win.getSelection ? win.getSelection() : win.document.selection;\n      };\n      var getRng$1 = function () {\n        var selection, rng, elm;\n        var tryCompareBoundaryPoints = function (how, sourceRange, destinationRange) {\n          try {\n            return sourceRange.compareBoundaryPoints(how, destinationRange);\n          } catch (ex) {\n            return -1;\n          }\n        };\n        var doc = win.document;\n        if (editor.bookmark !== undefined && hasFocus$1(editor) === false) {\n          var bookmark = getRng(editor);\n          if (bookmark.isSome()) {\n            return bookmark.map(function (r) {\n              return processRanges(editor, [r])[0];\n            }).getOr(doc.createRange());\n          }\n        }\n        try {\n          if ((selection = getSel()) && !isRestrictedNode(selection.anchorNode)) {\n            if (selection.rangeCount > 0) {\n              rng = selection.getRangeAt(0);\n            } else {\n              rng = selection.createRange ? selection.createRange() : doc.createRange();\n            }\n            rng = processRanges(editor, [rng])[0];\n          }\n        } catch (ex) {\n        }\n        if (!rng) {\n          rng = doc.createRange ? doc.createRange() : doc.body.createTextRange();\n        }\n        if (rng.setStart && rng.startContainer.nodeType === 9 && rng.collapsed) {\n          elm = dom.getRoot();\n          rng.setStart(elm, 0);\n          rng.setEnd(elm, 0);\n        }\n        if (selectedRange && explicitRange) {\n          if (tryCompareBoundaryPoints(rng.START_TO_START, rng, selectedRange) === 0 && tryCompareBoundaryPoints(rng.END_TO_END, rng, selectedRange) === 0) {\n            rng = explicitRange;\n          } else {\n            selectedRange = null;\n            explicitRange = null;\n          }\n        }\n        return rng;\n      };\n      var setRng = function (rng, forward) {\n        var node;\n        if (!isValidRange(rng)) {\n          return;\n        }\n        var ieRange = isNativeIeSelection(rng) ? rng : null;\n        if (ieRange) {\n          explicitRange = null;\n          try {\n            ieRange.select();\n          } catch (ex) {\n          }\n          return;\n        }\n        var sel = getSel();\n        var evt = editor.fire('SetSelectionRange', {\n          range: rng,\n          forward: forward\n        });\n        rng = evt.range;\n        if (sel) {\n          explicitRange = rng;\n          try {\n            sel.removeAllRanges();\n            sel.addRange(rng);\n          } catch (ex) {\n          }\n          if (forward === false && sel.extend) {\n            sel.collapse(rng.endContainer, rng.endOffset);\n            sel.extend(rng.startContainer, rng.startOffset);\n          }\n          selectedRange = sel.rangeCount > 0 ? sel.getRangeAt(0) : null;\n        }\n        if (!rng.collapsed && rng.startContainer === rng.endContainer && sel.setBaseAndExtent && !Env.ie) {\n          if (rng.endOffset - rng.startOffset < 2) {\n            if (rng.startContainer.hasChildNodes()) {\n              node = rng.startContainer.childNodes[rng.startOffset];\n              if (node && node.tagName === 'IMG') {\n                sel.setBaseAndExtent(rng.startContainer, rng.startOffset, rng.endContainer, rng.endOffset);\n                if (sel.anchorNode !== rng.startContainer || sel.focusNode !== rng.endContainer) {\n                  sel.setBaseAndExtent(node, 0, node, 1);\n                }\n              }\n            }\n          }\n        }\n        editor.fire('AfterSetSelectionRange', {\n          range: rng,\n          forward: forward\n        });\n      };\n      var setNode = function (elm) {\n        setContent(dom.getOuterHTML(elm));\n        return elm;\n      };\n      var getNode = function () {\n        return getNode$1(editor.getBody(), getRng$1());\n      };\n      var getSelectedBlocks$1 = function (startElm, endElm) {\n        return getSelectedBlocks(dom, getRng$1(), startElm, endElm);\n      };\n      var isForward = function () {\n        var sel = getSel();\n        var anchorNode = sel === null || sel === void 0 ? void 0 : sel.anchorNode;\n        var focusNode = sel === null || sel === void 0 ? void 0 : sel.focusNode;\n        if (!sel || !anchorNode || !focusNode || isRestrictedNode(anchorNode) || isRestrictedNode(focusNode)) {\n          return true;\n        }\n        var anchorRange = dom.createRng();\n        anchorRange.setStart(anchorNode, sel.anchorOffset);\n        anchorRange.collapse(true);\n        var focusRange = dom.createRng();\n        focusRange.setStart(focusNode, sel.focusOffset);\n        focusRange.collapse(true);\n        return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START, focusRange) <= 0;\n      };\n      var normalize$1 = function () {\n        var rng = getRng$1();\n        var sel = getSel();\n        if (!hasMultipleRanges(sel) && hasAnyRanges(editor)) {\n          var normRng = normalize(dom, rng);\n          normRng.each(function (normRng) {\n            setRng(normRng, isForward());\n          });\n          return normRng.getOr(rng);\n        }\n        return rng;\n      };\n      var selectorChanged = function (selector, callback) {\n        selectorChangedWithUnbind(selector, callback);\n        return exports;\n      };\n      var getScrollContainer = function () {\n        var scrollContainer;\n        var node = dom.getRoot();\n        while (node && node.nodeName !== 'BODY') {\n          if (node.scrollHeight > node.clientHeight) {\n            scrollContainer = node;\n            break;\n          }\n          node = node.parentNode;\n        }\n        return scrollContainer;\n      };\n      var scrollIntoView = function (elm, alignToTop) {\n        return scrollElementIntoView(editor, elm, alignToTop);\n      };\n      var placeCaretAt = function (clientX, clientY) {\n        return setRng(fromPoint$1(clientX, clientY, editor.getDoc()));\n      };\n      var getBoundingClientRect = function () {\n        var rng = getRng$1();\n        return rng.collapsed ? CaretPosition.fromRangeStart(rng).getClientRects()[0] : rng.getBoundingClientRect();\n      };\n      var destroy = function () {\n        win = selectedRange = explicitRange = null;\n        controlSelection.destroy();\n      };\n      var exports = {\n        bookmarkManager: null,\n        controlSelection: null,\n        dom: dom,\n        win: win,\n        serializer: serializer,\n        editor: editor,\n        collapse: collapse,\n        setCursorLocation: setCursorLocation,\n        getContent: getContent,\n        setContent: setContent,\n        getBookmark: getBookmark,\n        moveToBookmark: moveToBookmark,\n        select: select,\n        isCollapsed: isCollapsed,\n        isForward: isForward,\n        setNode: setNode,\n        getNode: getNode,\n        getSel: getSel,\n        setRng: setRng,\n        getRng: getRng$1,\n        getStart: getStart,\n        getEnd: getEnd$1,\n        getSelectedBlocks: getSelectedBlocks$1,\n        normalize: normalize$1,\n        selectorChanged: selectorChanged,\n        selectorChangedWithUnbind: selectorChangedWithUnbind,\n        getScrollContainer: getScrollContainer,\n        scrollIntoView: scrollIntoView,\n        placeCaretAt: placeCaretAt,\n        getBoundingClientRect: getBoundingClientRect,\n        destroy: destroy\n      };\n      var bookmarkManager = BookmarkManager(exports);\n      var controlSelection = ControlSelection(exports, editor);\n      exports.bookmarkManager = bookmarkManager;\n      exports.controlSelection = controlSelection;\n      return exports;\n    };\n\n    var removeAttrs = function (node, names) {\n      each(names, function (name) {\n        node.attr(name, null);\n      });\n    };\n    var addFontToSpansFilter = function (domParser, styles, fontSizes) {\n      domParser.addNodeFilter('font', function (nodes) {\n        each(nodes, function (node) {\n          var props = styles.parse(node.attr('style'));\n          var color = node.attr('color');\n          var face = node.attr('face');\n          var size = node.attr('size');\n          if (color) {\n            props.color = color;\n          }\n          if (face) {\n            props['font-family'] = face;\n          }\n          if (size) {\n            props['font-size'] = fontSizes[parseInt(node.attr('size'), 10) - 1];\n          }\n          node.name = 'span';\n          node.attr('style', styles.serialize(props));\n          removeAttrs(node, [\n            'color',\n            'face',\n            'size'\n          ]);\n        });\n      });\n    };\n    var addStrikeToSpanFilter = function (domParser, styles) {\n      domParser.addNodeFilter('strike', function (nodes) {\n        each(nodes, function (node) {\n          var props = styles.parse(node.attr('style'));\n          props['text-decoration'] = 'line-through';\n          node.name = 'span';\n          node.attr('style', styles.serialize(props));\n        });\n      });\n    };\n    var addFilters = function (domParser, settings) {\n      var styles = Styles();\n      if (settings.convert_fonts_to_spans) {\n        addFontToSpansFilter(domParser, styles, Tools.explode(settings.font_size_legacy_values));\n      }\n      addStrikeToSpanFilter(domParser, styles);\n    };\n    var register$1 = function (domParser, settings) {\n      if (settings.inline_styles) {\n        addFilters(domParser, settings);\n      }\n    };\n\n    var blobUriToBlob = function (url) {\n      return new promiseObj(function (resolve, reject) {\n        var rejectWithError = function () {\n          reject('Cannot convert ' + url + ' to Blob. Resource might not exist or is inaccessible.');\n        };\n        try {\n          var xhr_1 = new XMLHttpRequest();\n          xhr_1.open('GET', url, true);\n          xhr_1.responseType = 'blob';\n          xhr_1.onload = function () {\n            if (xhr_1.status === 200) {\n              resolve(xhr_1.response);\n            } else {\n              rejectWithError();\n            }\n          };\n          xhr_1.onerror = rejectWithError;\n          xhr_1.send();\n        } catch (ex) {\n          rejectWithError();\n        }\n      });\n    };\n    var parseDataUri$1 = function (uri) {\n      var type;\n      var uriParts = decodeURIComponent(uri).split(',');\n      var matches = /data:([^;]+)/.exec(uriParts[0]);\n      if (matches) {\n        type = matches[1];\n      }\n      return {\n        type: type,\n        data: uriParts[1]\n      };\n    };\n    var buildBlob = function (type, data) {\n      var str;\n      try {\n        str = atob(data);\n      } catch (e) {\n        return Optional.none();\n      }\n      var arr = new Uint8Array(str.length);\n      for (var i = 0; i < arr.length; i++) {\n        arr[i] = str.charCodeAt(i);\n      }\n      return Optional.some(new Blob([arr], { type: type }));\n    };\n    var dataUriToBlob = function (uri) {\n      return new promiseObj(function (resolve) {\n        var _a = parseDataUri$1(uri), type = _a.type, data = _a.data;\n        buildBlob(type, data).fold(function () {\n          return resolve(new Blob([]));\n        }, resolve);\n      });\n    };\n    var uriToBlob = function (url) {\n      if (url.indexOf('blob:') === 0) {\n        return blobUriToBlob(url);\n      }\n      if (url.indexOf('data:') === 0) {\n        return dataUriToBlob(url);\n      }\n      return null;\n    };\n    var blobToDataUri = function (blob) {\n      return new promiseObj(function (resolve) {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n\n    var count = 0;\n    var uniqueId = function (prefix) {\n      return (prefix || 'blobid') + count++;\n    };\n    var imageToBlobInfo = function (blobCache, img, resolve, reject) {\n      var base64, blobInfo;\n      if (img.src.indexOf('blob:') === 0) {\n        blobInfo = blobCache.getByUri(img.src);\n        if (blobInfo) {\n          resolve({\n            image: img,\n            blobInfo: blobInfo\n          });\n        } else {\n          uriToBlob(img.src).then(function (blob) {\n            blobToDataUri(blob).then(function (dataUri) {\n              base64 = parseDataUri$1(dataUri).data;\n              blobInfo = blobCache.create(uniqueId(), blob, base64);\n              blobCache.add(blobInfo);\n              resolve({\n                image: img,\n                blobInfo: blobInfo\n              });\n            });\n          }, function (err) {\n            reject(err);\n          });\n        }\n        return;\n      }\n      var _a = parseDataUri$1(img.src), data = _a.data, type = _a.type;\n      base64 = data;\n      blobInfo = blobCache.getByData(base64, type);\n      if (blobInfo) {\n        resolve({\n          image: img,\n          blobInfo: blobInfo\n        });\n      } else {\n        uriToBlob(img.src).then(function (blob) {\n          blobInfo = blobCache.create(uniqueId(), blob, base64);\n          blobCache.add(blobInfo);\n          resolve({\n            image: img,\n            blobInfo: blobInfo\n          });\n        }, function (err) {\n          reject(err);\n        });\n      }\n    };\n    var getAllImages = function (elm) {\n      return elm ? from$1(elm.getElementsByTagName('img')) : [];\n    };\n    var ImageScanner = function (uploadStatus, blobCache) {\n      var cachedPromises = {};\n      var findAll = function (elm, predicate) {\n        if (!predicate) {\n          predicate = always;\n        }\n        var images = filter(getAllImages(elm), function (img) {\n          var src = img.src;\n          if (!Env.fileApi) {\n            return false;\n          }\n          if (img.hasAttribute('data-mce-bogus')) {\n            return false;\n          }\n          if (img.hasAttribute('data-mce-placeholder')) {\n            return false;\n          }\n          if (!src || src === Env.transparentSrc) {\n            return false;\n          }\n          if (src.indexOf('blob:') === 0) {\n            return !uploadStatus.isUploaded(src) && predicate(img);\n          }\n          if (src.indexOf('data:') === 0) {\n            return predicate(img);\n          }\n          return false;\n        });\n        var promises = map(images, function (img) {\n          if (cachedPromises[img.src] !== undefined) {\n            return new promiseObj(function (resolve) {\n              cachedPromises[img.src].then(function (imageInfo) {\n                if (typeof imageInfo === 'string') {\n                  return imageInfo;\n                }\n                resolve({\n                  image: img,\n                  blobInfo: imageInfo.blobInfo\n                });\n              });\n            });\n          }\n          var newPromise = new promiseObj(function (resolve, reject) {\n            imageToBlobInfo(blobCache, img, resolve, reject);\n          }).then(function (result) {\n            delete cachedPromises[result.image.src];\n            return result;\n          }).catch(function (error) {\n            delete cachedPromises[img.src];\n            return error;\n          });\n          cachedPromises[img.src] = newPromise;\n          return newPromise;\n        });\n        return promiseObj.all(promises);\n      };\n      return { findAll: findAll };\n    };\n\n    var paddEmptyNode = function (settings, args, blockElements, node) {\n      var brPreferred = settings.padd_empty_with_br || args.insert;\n      if (brPreferred && blockElements[node.name]) {\n        node.empty().append(new AstNode('br', 1)).shortEnded = true;\n      } else {\n        node.empty().append(new AstNode('#text', 3)).value = nbsp;\n      }\n    };\n    var isPaddedWithNbsp = function (node) {\n      return hasOnlyChild(node, '#text') && node.firstChild.value === nbsp;\n    };\n    var hasOnlyChild = function (node, name) {\n      return node && node.firstChild && node.firstChild === node.lastChild && node.firstChild.name === name;\n    };\n    var isPadded = function (schema, node) {\n      var rule = schema.getElementRule(node.name);\n      return rule && rule.paddEmpty;\n    };\n    var isEmpty$2 = function (schema, nonEmptyElements, whitespaceElements, node) {\n      return node.isEmpty(nonEmptyElements, whitespaceElements, function (node) {\n        return isPadded(schema, node);\n      });\n    };\n    var isLineBreakNode = function (node, blockElements) {\n      return node && (blockElements[node.name] || node.name === 'br');\n    };\n\n    var isBogusImage = function (img) {\n      return img.attr('data-mce-bogus');\n    };\n    var isInternalImageSource = function (img) {\n      return img.attr('src') === Env.transparentSrc || img.attr('data-mce-placeholder');\n    };\n    var isValidDataImg = function (img, settings) {\n      if (settings.images_dataimg_filter) {\n        var imgElem_1 = new Image();\n        imgElem_1.src = img.attr('src');\n        each$1(img.attributes.map, function (value, key) {\n          imgElem_1.setAttribute(key, value);\n        });\n        return settings.images_dataimg_filter(imgElem_1);\n      } else {\n        return true;\n      }\n    };\n    var registerBase64ImageFilter = function (parser, settings) {\n      var blobCache = settings.blob_cache;\n      var processImage = function (img) {\n        var inputSrc = img.attr('src');\n        if (isInternalImageSource(img) || isBogusImage(img)) {\n          return;\n        }\n        parseDataUri(inputSrc).filter(function () {\n          return isValidDataImg(img, settings);\n        }).bind(function (_a) {\n          var type = _a.type, data = _a.data;\n          return Optional.from(blobCache.getByData(data, type)).orThunk(function () {\n            return buildBlob(type, data).map(function (blob) {\n              var blobInfo = blobCache.create(uniqueId(), blob, data);\n              blobCache.add(blobInfo);\n              return blobInfo;\n            });\n          });\n        }).each(function (blobInfo) {\n          img.attr('src', blobInfo.blobUri());\n        });\n      };\n      if (blobCache) {\n        parser.addAttributeFilter('src', function (nodes) {\n          return each(nodes, processImage);\n        });\n      }\n    };\n    var register$2 = function (parser, settings) {\n      var schema = parser.schema;\n      if (settings.remove_trailing_brs) {\n        parser.addNodeFilter('br', function (nodes, _, args) {\n          var i;\n          var l = nodes.length;\n          var node;\n          var blockElements = Tools.extend({}, schema.getBlockElements());\n          var nonEmptyElements = schema.getNonEmptyElements();\n          var parent, lastParent, prev, prevName;\n          var whiteSpaceElements = schema.getWhiteSpaceElements();\n          var elementRule, textNode;\n          blockElements.body = 1;\n          for (i = 0; i < l; i++) {\n            node = nodes[i];\n            parent = node.parent;\n            if (blockElements[node.parent.name] && node === parent.lastChild) {\n              prev = node.prev;\n              while (prev) {\n                prevName = prev.name;\n                if (prevName !== 'span' || prev.attr('data-mce-type') !== 'bookmark') {\n                  if (prevName === 'br') {\n                    node = null;\n                  }\n                  break;\n                }\n                prev = prev.prev;\n              }\n              if (node) {\n                node.remove();\n                if (isEmpty$2(schema, nonEmptyElements, whiteSpaceElements, parent)) {\n                  elementRule = schema.getElementRule(parent.name);\n                  if (elementRule) {\n                    if (elementRule.removeEmpty) {\n                      parent.remove();\n                    } else if (elementRule.paddEmpty) {\n                      paddEmptyNode(settings, args, blockElements, parent);\n                    }\n                  }\n                }\n              }\n            } else {\n              lastParent = node;\n              while (parent && parent.firstChild === lastParent && parent.lastChild === lastParent) {\n                lastParent = parent;\n                if (blockElements[parent.name]) {\n                  break;\n                }\n                parent = parent.parent;\n              }\n              if (lastParent === parent && settings.padd_empty_with_br !== true) {\n                textNode = new AstNode('#text', 3);\n                textNode.value = nbsp;\n                node.replace(textNode);\n              }\n            }\n          }\n        });\n      }\n      parser.addAttributeFilter('href', function (nodes) {\n        var i = nodes.length;\n        var appendRel = function (rel) {\n          var parts = rel.split(' ').filter(function (p) {\n            return p.length > 0;\n          });\n          return parts.concat(['noopener']).sort().join(' ');\n        };\n        var addNoOpener = function (rel) {\n          var newRel = rel ? Tools.trim(rel) : '';\n          if (!/\\b(noopener)\\b/g.test(newRel)) {\n            return appendRel(newRel);\n          } else {\n            return newRel;\n          }\n        };\n        if (!settings.allow_unsafe_link_target) {\n          while (i--) {\n            var node = nodes[i];\n            if (node.name === 'a' && node.attr('target') === '_blank') {\n              node.attr('rel', addNoOpener(node.attr('rel')));\n            }\n          }\n        }\n      });\n      if (!settings.allow_html_in_named_anchor) {\n        parser.addAttributeFilter('id,name', function (nodes) {\n          var i = nodes.length, sibling, prevSibling, parent, node;\n          while (i--) {\n            node = nodes[i];\n            if (node.name === 'a' && node.firstChild && !node.attr('href')) {\n              parent = node.parent;\n              sibling = node.lastChild;\n              do {\n                prevSibling = sibling.prev;\n                parent.insert(sibling, node);\n                sibling = prevSibling;\n              } while (sibling);\n            }\n          }\n        });\n      }\n      if (settings.fix_list_elements) {\n        parser.addNodeFilter('ul,ol', function (nodes) {\n          var i = nodes.length, node, parentNode;\n          while (i--) {\n            node = nodes[i];\n            parentNode = node.parent;\n            if (parentNode.name === 'ul' || parentNode.name === 'ol') {\n              if (node.prev && node.prev.name === 'li') {\n                node.prev.append(node);\n              } else {\n                var li = new AstNode('li', 1);\n                li.attr('style', 'list-style-type: none');\n                node.wrap(li);\n              }\n            }\n          }\n        });\n      }\n      if (settings.validate && schema.getValidClasses()) {\n        parser.addAttributeFilter('class', function (nodes) {\n          var i = nodes.length, node, classList, ci, className, classValue;\n          var validClasses = schema.getValidClasses();\n          var validClassesMap, valid;\n          while (i--) {\n            node = nodes[i];\n            classList = node.attr('class').split(' ');\n            classValue = '';\n            for (ci = 0; ci < classList.length; ci++) {\n              className = classList[ci];\n              valid = false;\n              validClassesMap = validClasses['*'];\n              if (validClassesMap && validClassesMap[className]) {\n                valid = true;\n              }\n              validClassesMap = validClasses[node.name];\n              if (!valid && validClassesMap && validClassesMap[className]) {\n                valid = true;\n              }\n              if (valid) {\n                if (classValue) {\n                  classValue += ' ';\n                }\n                classValue += className;\n              }\n            }\n            if (!classValue.length) {\n              classValue = null;\n            }\n            node.attr('class', classValue);\n          }\n        });\n      }\n      registerBase64ImageFilter(parser, settings);\n    };\n\n    var makeMap$4 = Tools.makeMap, each$d = Tools.each, explode$2 = Tools.explode, extend$2 = Tools.extend;\n    var DomParser = function (settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      var nodeFilters = {};\n      var attributeFilters = [];\n      var matchedNodes = {};\n      var matchedAttributes = {};\n      settings = settings || {};\n      settings.validate = 'validate' in settings ? settings.validate : true;\n      settings.root_name = settings.root_name || 'body';\n      var fixInvalidChildren = function (nodes) {\n        var ni, node, parent, parents, newParent, currentNode, tempNode, childNode, i;\n        var sibling, nextNode;\n        var nonSplitableElements = makeMap$4('tr,td,th,tbody,thead,tfoot,table');\n        var nonEmptyElements = schema.getNonEmptyElements();\n        var whitespaceElements = schema.getWhiteSpaceElements();\n        var textBlockElements = schema.getTextBlockElements();\n        var specialElements = schema.getSpecialElements();\n        for (ni = 0; ni < nodes.length; ni++) {\n          node = nodes[ni];\n          if (!node.parent || node.fixed) {\n            continue;\n          }\n          if (textBlockElements[node.name] && node.parent.name === 'li') {\n            sibling = node.next;\n            while (sibling) {\n              if (textBlockElements[sibling.name]) {\n                sibling.name = 'li';\n                sibling.fixed = true;\n                node.parent.insert(sibling, node.parent);\n              } else {\n                break;\n              }\n              sibling = sibling.next;\n            }\n            node.unwrap(node);\n            continue;\n          }\n          parents = [node];\n          for (parent = node.parent; parent && !schema.isValidChild(parent.name, node.name) && !nonSplitableElements[parent.name]; parent = parent.parent) {\n            parents.push(parent);\n          }\n          if (parent && parents.length > 1) {\n            parents.reverse();\n            newParent = currentNode = filterNode(parents[0].clone());\n            for (i = 0; i < parents.length - 1; i++) {\n              if (schema.isValidChild(currentNode.name, parents[i].name)) {\n                tempNode = filterNode(parents[i].clone());\n                currentNode.append(tempNode);\n              } else {\n                tempNode = currentNode;\n              }\n              for (childNode = parents[i].firstChild; childNode && childNode !== parents[i + 1];) {\n                nextNode = childNode.next;\n                tempNode.append(childNode);\n                childNode = nextNode;\n              }\n              currentNode = tempNode;\n            }\n            if (!isEmpty$2(schema, nonEmptyElements, whitespaceElements, newParent)) {\n              parent.insert(newParent, parents[0], true);\n              parent.insert(node, newParent);\n            } else {\n              parent.insert(node, parents[0], true);\n            }\n            parent = parents[0];\n            if (isEmpty$2(schema, nonEmptyElements, whitespaceElements, parent) || hasOnlyChild(parent, 'br')) {\n              parent.empty().remove();\n            }\n          } else if (node.parent) {\n            if (node.name === 'li') {\n              sibling = node.prev;\n              if (sibling && (sibling.name === 'ul' || sibling.name === 'ol')) {\n                sibling.append(node);\n                continue;\n              }\n              sibling = node.next;\n              if (sibling && (sibling.name === 'ul' || sibling.name === 'ol')) {\n                sibling.insert(node, sibling.firstChild, true);\n                continue;\n              }\n              node.wrap(filterNode(new AstNode('ul', 1)));\n              continue;\n            }\n            if (schema.isValidChild(node.parent.name, 'div') && schema.isValidChild('div', node.name)) {\n              node.wrap(filterNode(new AstNode('div', 1)));\n            } else {\n              if (specialElements[node.name]) {\n                node.empty().remove();\n              } else {\n                node.unwrap();\n              }\n            }\n          }\n        }\n      };\n      var filterNode = function (node) {\n        var i, name, list;\n        name = node.name;\n        if (name in nodeFilters) {\n          list = matchedNodes[name];\n          if (list) {\n            list.push(node);\n          } else {\n            matchedNodes[name] = [node];\n          }\n        }\n        i = attributeFilters.length;\n        while (i--) {\n          name = attributeFilters[i].name;\n          if (name in node.attributes.map) {\n            list = matchedAttributes[name];\n            if (list) {\n              list.push(node);\n            } else {\n              matchedAttributes[name] = [node];\n            }\n          }\n        }\n        return node;\n      };\n      var addNodeFilter = function (name, callback) {\n        each$d(explode$2(name), function (name) {\n          var list = nodeFilters[name];\n          if (!list) {\n            nodeFilters[name] = list = [];\n          }\n          list.push(callback);\n        });\n      };\n      var getNodeFilters = function () {\n        var out = [];\n        for (var name_1 in nodeFilters) {\n          if (nodeFilters.hasOwnProperty(name_1)) {\n            out.push({\n              name: name_1,\n              callbacks: nodeFilters[name_1]\n            });\n          }\n        }\n        return out;\n      };\n      var addAttributeFilter = function (name, callback) {\n        each$d(explode$2(name), function (name) {\n          var i;\n          for (i = 0; i < attributeFilters.length; i++) {\n            if (attributeFilters[i].name === name) {\n              attributeFilters[i].callbacks.push(callback);\n              return;\n            }\n          }\n          attributeFilters.push({\n            name: name,\n            callbacks: [callback]\n          });\n        });\n      };\n      var getAttributeFilters = function () {\n        return [].concat(attributeFilters);\n      };\n      var parse = function (html, args) {\n        var nodes, i, l, fi, fl, list, name;\n        var invalidChildren = [];\n        var isInWhiteSpacePreservedElement;\n        var node;\n        var getRootBlockName = function (name) {\n          if (name === false) {\n            return '';\n          } else if (name === true) {\n            return 'p';\n          } else {\n            return name;\n          }\n        };\n        args = args || {};\n        matchedNodes = {};\n        matchedAttributes = {};\n        var blockElements = extend$2(makeMap$4('script,style,head,html,body,title,meta,param'), schema.getBlockElements());\n        var nonEmptyElements = schema.getNonEmptyElements();\n        var children = schema.children;\n        var validate = settings.validate;\n        var forcedRootBlockName = 'forced_root_block' in args ? args.forced_root_block : settings.forced_root_block;\n        var rootBlockName = getRootBlockName(forcedRootBlockName);\n        var whiteSpaceElements = schema.getWhiteSpaceElements();\n        var startWhiteSpaceRegExp = /^[ \\t\\r\\n]+/;\n        var endWhiteSpaceRegExp = /[ \\t\\r\\n]+$/;\n        var allWhiteSpaceRegExp = /[ \\t\\r\\n]+/g;\n        var isAllWhiteSpaceRegExp = /^[ \\t\\r\\n]+$/;\n        isInWhiteSpacePreservedElement = whiteSpaceElements.hasOwnProperty(args.context) || whiteSpaceElements.hasOwnProperty(settings.root_name);\n        var addRootBlocks = function () {\n          var node = rootNode.firstChild, next, rootBlockNode;\n          var trim = function (rootBlockNode) {\n            if (rootBlockNode) {\n              node = rootBlockNode.firstChild;\n              if (node && node.type === 3) {\n                node.value = node.value.replace(startWhiteSpaceRegExp, '');\n              }\n              node = rootBlockNode.lastChild;\n              if (node && node.type === 3) {\n                node.value = node.value.replace(endWhiteSpaceRegExp, '');\n              }\n            }\n          };\n          if (!schema.isValidChild(rootNode.name, rootBlockName.toLowerCase())) {\n            return;\n          }\n          while (node) {\n            next = node.next;\n            if (node.type === 3 || node.type === 1 && node.name !== 'p' && !blockElements[node.name] && !node.attr('data-mce-type')) {\n              if (!rootBlockNode) {\n                rootBlockNode = createNode(rootBlockName, 1);\n                rootBlockNode.attr(settings.forced_root_block_attrs);\n                rootNode.insert(rootBlockNode, node);\n                rootBlockNode.append(node);\n              } else {\n                rootBlockNode.append(node);\n              }\n            } else {\n              trim(rootBlockNode);\n              rootBlockNode = null;\n            }\n            node = next;\n          }\n          trim(rootBlockNode);\n        };\n        var createNode = function (name, type) {\n          var node = new AstNode(name, type);\n          var list;\n          if (name in nodeFilters) {\n            list = matchedNodes[name];\n            if (list) {\n              list.push(node);\n            } else {\n              matchedNodes[name] = [node];\n            }\n          }\n          return node;\n        };\n        var removeWhitespaceBefore = function (node) {\n          var textNode, textNodeNext, textVal, sibling;\n          var blockElements = schema.getBlockElements();\n          for (textNode = node.prev; textNode && textNode.type === 3;) {\n            textVal = textNode.value.replace(endWhiteSpaceRegExp, '');\n            if (textVal.length > 0) {\n              textNode.value = textVal;\n              return;\n            }\n            textNodeNext = textNode.next;\n            if (textNodeNext) {\n              if (textNodeNext.type === 3 && textNodeNext.value.length) {\n                textNode = textNode.prev;\n                continue;\n              }\n              if (!blockElements[textNodeNext.name] && textNodeNext.name !== 'script' && textNodeNext.name !== 'style') {\n                textNode = textNode.prev;\n                continue;\n              }\n            }\n            sibling = textNode.prev;\n            textNode.remove();\n            textNode = sibling;\n          }\n        };\n        var cloneAndExcludeBlocks = function (input) {\n          var name;\n          var output = {};\n          for (name in input) {\n            if (name !== 'li' && name !== 'p') {\n              output[name] = input[name];\n            }\n          }\n          return output;\n        };\n        var parser = SaxParser({\n          validate: validate,\n          allow_html_data_urls: settings.allow_html_data_urls,\n          allow_svg_data_urls: settings.allow_svg_data_urls,\n          allow_script_urls: settings.allow_script_urls,\n          allow_conditional_comments: settings.allow_conditional_comments,\n          preserve_cdata: settings.preserve_cdata,\n          self_closing_elements: cloneAndExcludeBlocks(schema.getSelfClosingElements()),\n          cdata: function (text) {\n            node.append(createNode('#cdata', 4)).value = text;\n          },\n          text: function (text, raw) {\n            var textNode;\n            if (!isInWhiteSpacePreservedElement) {\n              text = text.replace(allWhiteSpaceRegExp, ' ');\n              if (isLineBreakNode(node.lastChild, blockElements)) {\n                text = text.replace(startWhiteSpaceRegExp, '');\n              }\n            }\n            if (text.length !== 0) {\n              textNode = createNode('#text', 3);\n              textNode.raw = !!raw;\n              node.append(textNode).value = text;\n            }\n          },\n          comment: function (text) {\n            node.append(createNode('#comment', 8)).value = text;\n          },\n          pi: function (name, text) {\n            node.append(createNode(name, 7)).value = text;\n            removeWhitespaceBefore(node);\n          },\n          doctype: function (text) {\n            var newNode = node.append(createNode('#doctype', 10));\n            newNode.value = text;\n            removeWhitespaceBefore(node);\n          },\n          start: function (name, attrs, empty) {\n            var newNode, attrFiltersLen, attrName, parent;\n            var elementRule = validate ? schema.getElementRule(name) : {};\n            if (elementRule) {\n              newNode = createNode(elementRule.outputName || name, 1);\n              newNode.attributes = attrs;\n              newNode.shortEnded = empty;\n              node.append(newNode);\n              parent = children[node.name];\n              if (parent && children[newNode.name] && !parent[newNode.name]) {\n                invalidChildren.push(newNode);\n              }\n              attrFiltersLen = attributeFilters.length;\n              while (attrFiltersLen--) {\n                attrName = attributeFilters[attrFiltersLen].name;\n                if (attrName in attrs.map) {\n                  list = matchedAttributes[attrName];\n                  if (list) {\n                    list.push(newNode);\n                  } else {\n                    matchedAttributes[attrName] = [newNode];\n                  }\n                }\n              }\n              if (blockElements[name]) {\n                removeWhitespaceBefore(newNode);\n              }\n              if (!empty) {\n                node = newNode;\n              }\n              if (!isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n                isInWhiteSpacePreservedElement = true;\n              }\n            }\n          },\n          end: function (name) {\n            var textNode, text, sibling, tempNode;\n            var elementRule = validate ? schema.getElementRule(name) : {};\n            if (elementRule) {\n              if (blockElements[name]) {\n                if (!isInWhiteSpacePreservedElement) {\n                  textNode = node.firstChild;\n                  if (textNode && textNode.type === 3) {\n                    text = textNode.value.replace(startWhiteSpaceRegExp, '');\n                    if (text.length > 0) {\n                      textNode.value = text;\n                      textNode = textNode.next;\n                    } else {\n                      sibling = textNode.next;\n                      textNode.remove();\n                      textNode = sibling;\n                      while (textNode && textNode.type === 3) {\n                        text = textNode.value;\n                        sibling = textNode.next;\n                        if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                          textNode.remove();\n                          textNode = sibling;\n                        }\n                        textNode = sibling;\n                      }\n                    }\n                  }\n                  textNode = node.lastChild;\n                  if (textNode && textNode.type === 3) {\n                    text = textNode.value.replace(endWhiteSpaceRegExp, '');\n                    if (text.length > 0) {\n                      textNode.value = text;\n                      textNode = textNode.prev;\n                    } else {\n                      sibling = textNode.prev;\n                      textNode.remove();\n                      textNode = sibling;\n                      while (textNode && textNode.type === 3) {\n                        text = textNode.value;\n                        sibling = textNode.prev;\n                        if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                          textNode.remove();\n                          textNode = sibling;\n                        }\n                        textNode = sibling;\n                      }\n                    }\n                  }\n                }\n              }\n              if (isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n                isInWhiteSpacePreservedElement = false;\n              }\n              if (elementRule.removeEmpty && isEmpty$2(schema, nonEmptyElements, whiteSpaceElements, node)) {\n                tempNode = node.parent;\n                if (blockElements[node.name]) {\n                  node.empty().remove();\n                } else {\n                  node.unwrap();\n                }\n                node = tempNode;\n                return;\n              }\n              if (elementRule.paddEmpty && (isPaddedWithNbsp(node) || isEmpty$2(schema, nonEmptyElements, whiteSpaceElements, node))) {\n                paddEmptyNode(settings, args, blockElements, node);\n              }\n              node = node.parent;\n            }\n          }\n        }, schema);\n        var rootNode = node = new AstNode(args.context || settings.root_name, 11);\n        parser.parse(html, args.format);\n        if (validate && invalidChildren.length) {\n          if (!args.context) {\n            fixInvalidChildren(invalidChildren);\n          } else {\n            args.invalid = true;\n          }\n        }\n        if (rootBlockName && (rootNode.name === 'body' || args.isRootContent)) {\n          addRootBlocks();\n        }\n        if (!args.invalid) {\n          for (name in matchedNodes) {\n            if (!matchedNodes.hasOwnProperty(name)) {\n              continue;\n            }\n            list = nodeFilters[name];\n            nodes = matchedNodes[name];\n            fi = nodes.length;\n            while (fi--) {\n              if (!nodes[fi].parent) {\n                nodes.splice(fi, 1);\n              }\n            }\n            for (i = 0, l = list.length; i < l; i++) {\n              list[i](nodes, name, args);\n            }\n          }\n          for (i = 0, l = attributeFilters.length; i < l; i++) {\n            list = attributeFilters[i];\n            if (list.name in matchedAttributes) {\n              nodes = matchedAttributes[list.name];\n              fi = nodes.length;\n              while (fi--) {\n                if (!nodes[fi].parent) {\n                  nodes.splice(fi, 1);\n                }\n              }\n              for (fi = 0, fl = list.callbacks.length; fi < fl; fi++) {\n                list.callbacks[fi](nodes, list.name, args);\n              }\n            }\n          }\n        }\n        return rootNode;\n      };\n      var exports = {\n        schema: schema,\n        addAttributeFilter: addAttributeFilter,\n        getAttributeFilters: getAttributeFilters,\n        addNodeFilter: addNodeFilter,\n        getNodeFilters: getNodeFilters,\n        filterNode: filterNode,\n        parse: parse\n      };\n      register$2(exports, settings);\n      register$1(exports, settings);\n      return exports;\n    };\n\n    var register$3 = function (htmlParser, settings, dom) {\n      htmlParser.addAttributeFilter('data-mce-tabindex', function (nodes, name) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          node.attr('tabindex', node.attr('data-mce-tabindex'));\n          node.attr(name, null);\n        }\n      });\n      htmlParser.addAttributeFilter('src,href,style', function (nodes, name) {\n        var i = nodes.length, node, value;\n        var internalName = 'data-mce-' + name;\n        var urlConverter = settings.url_converter;\n        var urlConverterScope = settings.url_converter_scope;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr(internalName);\n          if (value !== undefined) {\n            node.attr(name, value.length > 0 ? value : null);\n            node.attr(internalName, null);\n          } else {\n            value = node.attr(name);\n            if (name === 'style') {\n              value = dom.serializeStyle(dom.parseStyle(value), node.name);\n            } else if (urlConverter) {\n              value = urlConverter.call(urlConverterScope, value, name, node.name);\n            }\n            node.attr(name, value.length > 0 ? value : null);\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('class', function (nodes) {\n        var i = nodes.length, node, value;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr('class');\n          if (value) {\n            value = node.attr('class').replace(/(?:^|\\s)mce-item-\\w+(?!\\S)/g, '');\n            node.attr('class', value.length > 0 ? value : null);\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('data-mce-type', function (nodes, name, args) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          if (node.attr('data-mce-type') === 'bookmark' && !args.cleanup) {\n            var hasChildren = Optional.from(node.firstChild).exists(function (firstChild) {\n              return !isZwsp$1(firstChild.value);\n            });\n            if (hasChildren) {\n              node.unwrap();\n            } else {\n              node.remove();\n            }\n          }\n        }\n      });\n      htmlParser.addNodeFilter('noscript', function (nodes) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i].firstChild;\n          if (node) {\n            node.value = Entities.decode(node.value);\n          }\n        }\n      });\n      htmlParser.addNodeFilter('script,style', function (nodes, name) {\n        var i = nodes.length, node, value, type;\n        var trim = function (value) {\n          return value.replace(/(<!--\\[CDATA\\[|\\]\\]-->)/g, '\\n').replace(/^[\\r\\n]*|[\\r\\n]*$/g, '').replace(/^\\s*((<!--)?(\\s*\\/\\/)?\\s*<!\\[CDATA\\[|(<!--\\s*)?\\/\\*\\s*<!\\[CDATA\\[\\s*\\*\\/|(\\/\\/)?\\s*<!--|\\/\\*\\s*<!--\\s*\\*\\/)\\s*[\\r\\n]*/gi, '').replace(/\\s*(\\/\\*\\s*\\]\\]>\\s*\\*\\/(-->)?|\\s*\\/\\/\\s*\\]\\]>(-->)?|\\/\\/\\s*(-->)?|\\]\\]>|\\/\\*\\s*-->\\s*\\*\\/|\\s*-->\\s*)\\s*$/g, '');\n        };\n        while (i--) {\n          node = nodes[i];\n          value = node.firstChild ? node.firstChild.value : '';\n          if (name === 'script') {\n            type = node.attr('type');\n            if (type) {\n              node.attr('type', type === 'mce-no/type' ? null : type.replace(/^mce\\-/, ''));\n            }\n            if (settings.element_format === 'xhtml' && value.length > 0) {\n              node.firstChild.value = '// <![CDATA[\\n' + trim(value) + '\\n// ]]>';\n            }\n          } else {\n            if (settings.element_format === 'xhtml' && value.length > 0) {\n              node.firstChild.value = '<!--\\n' + trim(value) + '\\n-->';\n            }\n          }\n        }\n      });\n      htmlParser.addNodeFilter('#comment', function (nodes) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          if (settings.preserve_cdata && node.value.indexOf('[CDATA[') === 0) {\n            node.name = '#cdata';\n            node.type = 4;\n            node.value = dom.decode(node.value.replace(/^\\[CDATA\\[|\\]\\]$/g, ''));\n          } else if (node.value.indexOf('mce:protected ') === 0) {\n            node.name = '#text';\n            node.type = 3;\n            node.raw = true;\n            node.value = unescape(node.value).substr(14);\n          }\n        }\n      });\n      htmlParser.addNodeFilter('xml:namespace,input', function (nodes, name) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          if (node.type === 7) {\n            node.remove();\n          } else if (node.type === 1) {\n            if (name === 'input' && !node.attr('type')) {\n              node.attr('type', 'text');\n            }\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('data-mce-type', function (nodes) {\n        each(nodes, function (node) {\n          if (node.attr('data-mce-type') === 'format-caret') {\n            if (node.isEmpty(htmlParser.schema.getNonEmptyElements())) {\n              node.remove();\n            } else {\n              node.unwrap();\n            }\n          }\n        });\n      });\n      htmlParser.addAttributeFilter('data-mce-src,data-mce-href,data-mce-style,' + 'data-mce-selected,data-mce-expando,' + 'data-mce-type,data-mce-resize,data-mce-placeholder', function (nodes, name) {\n        var i = nodes.length;\n        while (i--) {\n          nodes[i].attr(name, null);\n        }\n      });\n    };\n    var trimTrailingBr = function (rootNode) {\n      var isBr = function (node) {\n        return node && node.name === 'br';\n      };\n      var brNode1 = rootNode.lastChild;\n      if (isBr(brNode1)) {\n        var brNode2 = brNode1.prev;\n        if (isBr(brNode2)) {\n          brNode1.remove();\n          brNode2.remove();\n        }\n      }\n    };\n\n    var preProcess = function (editor, node, args) {\n      var doc, oldDoc;\n      var dom = editor.dom;\n      node = node.cloneNode(true);\n      var impl = document.implementation;\n      if (impl.createHTMLDocument) {\n        doc = impl.createHTMLDocument('');\n        Tools.each(node.nodeName === 'BODY' ? node.childNodes : [node], function (node) {\n          doc.body.appendChild(doc.importNode(node, true));\n        });\n        if (node.nodeName !== 'BODY') {\n          node = doc.body.firstChild;\n        } else {\n          node = doc.body;\n        }\n        oldDoc = dom.doc;\n        dom.doc = doc;\n      }\n      firePreProcess(editor, __assign(__assign({}, args), { node: node }));\n      if (oldDoc) {\n        dom.doc = oldDoc;\n      }\n      return node;\n    };\n    var shouldFireEvent = function (editor, args) {\n      return editor && editor.hasEventListeners('PreProcess') && !args.no_events;\n    };\n    var process = function (editor, node, args) {\n      return shouldFireEvent(editor, args) ? preProcess(editor, node, args) : node;\n    };\n\n    var addTempAttr = function (htmlParser, tempAttrs, name) {\n      if (Tools.inArray(tempAttrs, name) === -1) {\n        htmlParser.addAttributeFilter(name, function (nodes, name) {\n          var i = nodes.length;\n          while (i--) {\n            nodes[i].attr(name, null);\n          }\n        });\n        tempAttrs.push(name);\n      }\n    };\n    var postProcess$1 = function (editor, args, content) {\n      if (!args.no_events && editor) {\n        var outArgs = firePostProcess(editor, __assign(__assign({}, args), { content: content }));\n        return outArgs.content;\n      } else {\n        return content;\n      }\n    };\n    var getHtmlFromNode = function (dom, node, args) {\n      var html = trim$2(args.getInner ? node.innerHTML : dom.getOuterHTML(node));\n      return args.selection || isWsPreserveElement(SugarElement.fromDom(node)) ? html : Tools.trim(html);\n    };\n    var parseHtml = function (htmlParser, html, args) {\n      var parserArgs = args.selection ? __assign({ forced_root_block: false }, args) : args;\n      var rootNode = htmlParser.parse(html, parserArgs);\n      trimTrailingBr(rootNode);\n      return rootNode;\n    };\n    var serializeNode = function (settings, schema, node) {\n      var htmlSerializer = HtmlSerializer(settings, schema);\n      return htmlSerializer.serialize(node);\n    };\n    var toHtml = function (editor, settings, schema, rootNode, args) {\n      var content = serializeNode(settings, schema, rootNode);\n      return postProcess$1(editor, args, content);\n    };\n    var DomSerializerImpl = function (settings, editor) {\n      var tempAttrs = ['data-mce-selected'];\n      var dom = editor && editor.dom ? editor.dom : DOMUtils.DOM;\n      var schema = editor && editor.schema ? editor.schema : Schema(settings);\n      settings.entity_encoding = settings.entity_encoding || 'named';\n      settings.remove_trailing_brs = 'remove_trailing_brs' in settings ? settings.remove_trailing_brs : true;\n      var htmlParser = DomParser(settings, schema);\n      register$3(htmlParser, settings, dom);\n      var serialize = function (node, parserArgs) {\n        if (parserArgs === void 0) {\n          parserArgs = {};\n        }\n        var args = __assign({ format: 'html' }, parserArgs);\n        var targetNode = process(editor, node, args);\n        var html = getHtmlFromNode(dom, targetNode, args);\n        var rootNode = parseHtml(htmlParser, html, args);\n        return args.format === 'tree' ? rootNode : toHtml(editor, settings, schema, rootNode, args);\n      };\n      return {\n        schema: schema,\n        addNodeFilter: htmlParser.addNodeFilter,\n        addAttributeFilter: htmlParser.addAttributeFilter,\n        serialize: serialize,\n        addRules: function (rules) {\n          schema.addValidElements(rules);\n        },\n        setRules: function (rules) {\n          schema.setValidElements(rules);\n        },\n        addTempAttr: curry(addTempAttr, htmlParser, tempAttrs),\n        getTempAttrs: constant(tempAttrs),\n        getNodeFilters: htmlParser.getNodeFilters,\n        getAttributeFilters: htmlParser.getAttributeFilters\n      };\n    };\n\n    var DomSerializer = function (settings, editor) {\n      var domSerializer = DomSerializerImpl(settings, editor);\n      return {\n        schema: domSerializer.schema,\n        addNodeFilter: domSerializer.addNodeFilter,\n        addAttributeFilter: domSerializer.addAttributeFilter,\n        serialize: domSerializer.serialize,\n        addRules: domSerializer.addRules,\n        setRules: domSerializer.setRules,\n        addTempAttr: domSerializer.addTempAttr,\n        getTempAttrs: domSerializer.getTempAttrs,\n        getNodeFilters: domSerializer.getNodeFilters,\n        getAttributeFilters: domSerializer.getAttributeFilters\n      };\n    };\n\n    var defaultFormat$1 = 'html';\n    var getContent$2 = function (editor, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      var format = args.format ? args.format : defaultFormat$1;\n      return getContent(editor, args, format);\n    };\n\n    var setContent$2 = function (editor, content, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      return setContent(editor, content, args);\n    };\n\n    var DOM$3 = DOMUtils.DOM;\n    var restoreOriginalStyles = function (editor) {\n      DOM$3.setStyle(editor.id, 'display', editor.orgDisplay);\n    };\n    var safeDestroy = function (x) {\n      return Optional.from(x).each(function (x) {\n        return x.destroy();\n      });\n    };\n    var clearDomReferences = function (editor) {\n      editor.contentAreaContainer = editor.formElement = editor.container = editor.editorContainer = null;\n      editor.bodyElement = editor.contentDocument = editor.contentWindow = null;\n      editor.iframeElement = editor.targetElm = null;\n      if (editor.selection) {\n        editor.selection = editor.selection.win = editor.selection.dom = editor.selection.dom.doc = null;\n      }\n    };\n    var restoreForm = function (editor) {\n      var form = editor.formElement;\n      if (form) {\n        if (form._mceOldSubmit) {\n          form.submit = form._mceOldSubmit;\n          form._mceOldSubmit = null;\n        }\n        DOM$3.unbind(form, 'submit reset', editor.formEventDelegate);\n      }\n    };\n    var remove$7 = function (editor) {\n      if (!editor.removed) {\n        var _selectionOverrides = editor._selectionOverrides, editorUpload = editor.editorUpload;\n        var body = editor.getBody();\n        var element = editor.getElement();\n        if (body) {\n          editor.save({ is_removing: true });\n        }\n        editor.removed = true;\n        editor.unbindAllNativeEvents();\n        if (editor.hasHiddenInput && element) {\n          DOM$3.remove(element.nextSibling);\n        }\n        fireRemove(editor);\n        editor.editorManager.remove(editor);\n        if (!editor.inline && body) {\n          restoreOriginalStyles(editor);\n        }\n        fireDetach(editor);\n        DOM$3.remove(editor.getContainer());\n        safeDestroy(_selectionOverrides);\n        safeDestroy(editorUpload);\n        editor.destroy();\n      }\n    };\n    var destroy = function (editor, automatic) {\n      var selection = editor.selection, dom = editor.dom;\n      if (editor.destroyed) {\n        return;\n      }\n      if (!automatic && !editor.removed) {\n        editor.remove();\n        return;\n      }\n      if (!automatic) {\n        editor.editorManager.off('beforeunload', editor._beforeUnload);\n        if (editor.theme && editor.theme.destroy) {\n          editor.theme.destroy();\n        }\n        safeDestroy(selection);\n        safeDestroy(dom);\n      }\n      restoreForm(editor);\n      clearDomReferences(editor);\n      editor.destroyed = true;\n    };\n\n    var hasOwnProperty$2 = Object.prototype.hasOwnProperty;\n    var deep$1 = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          objects[_i] = arguments[_i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty$2.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep$1);\n\n    var sectionResult = function (sections, settings) {\n      return {\n        sections: constant(sections),\n        settings: constant(settings)\n      };\n    };\n    var deviceDetection = detect$3().deviceType;\n    var isTouch = deviceDetection.isTouch();\n    var isPhone = deviceDetection.isPhone();\n    var isTablet = deviceDetection.isTablet();\n    var legacyMobilePlugins = [\n      'lists',\n      'autolink',\n      'autosave'\n    ];\n    var defaultTouchSettings = {\n      table_grid: false,\n      object_resizing: false,\n      resize: false\n    };\n    var normalizePlugins = function (plugins) {\n      var pluginNames = isArray(plugins) ? plugins.join(' ') : plugins;\n      var trimmedPlugins = map(isString(pluginNames) ? pluginNames.split(' ') : [], trim);\n      return filter(trimmedPlugins, function (item) {\n        return item.length > 0;\n      });\n    };\n    var filterLegacyMobilePlugins = function (plugins) {\n      return filter(plugins, curry(contains, legacyMobilePlugins));\n    };\n    var extractSections = function (keys, settings) {\n      var result = bifilter(settings, function (value, key) {\n        return contains(keys, key);\n      });\n      return sectionResult(result.t, result.f);\n    };\n    var getSection = function (sectionResult, name, defaults) {\n      if (defaults === void 0) {\n        defaults = {};\n      }\n      var sections = sectionResult.sections();\n      var sectionSettings = sections.hasOwnProperty(name) ? sections[name] : {};\n      return Tools.extend({}, defaults, sectionSettings);\n    };\n    var hasSection = function (sectionResult, name) {\n      return sectionResult.sections().hasOwnProperty(name);\n    };\n    var isSectionTheme = function (sectionResult, name, theme) {\n      var section = sectionResult.sections();\n      return hasSection(sectionResult, name) && section[name].theme === theme;\n    };\n    var getSectionConfig = function (sectionResult, name) {\n      return hasSection(sectionResult, name) ? sectionResult.sections()[name] : {};\n    };\n    var getToolbarMode = function (settings, defaultVal) {\n      return get$1(settings, 'toolbar_mode').orThunk(function () {\n        return get$1(settings, 'toolbar_drawer').map(function (val) {\n          return val === false ? 'wrap' : val;\n        });\n      }).getOr(defaultVal);\n    };\n    var getDefaultSettings = function (settings, id, documentBaseUrl, isTouch, editor) {\n      var baseDefaults = {\n        id: id,\n        theme: 'silver',\n        toolbar_mode: getToolbarMode(settings, 'floating'),\n        plugins: '',\n        document_base_url: documentBaseUrl,\n        add_form_submit_trigger: true,\n        submit_patch: true,\n        add_unload_trigger: true,\n        convert_urls: true,\n        relative_urls: true,\n        remove_script_host: true,\n        object_resizing: true,\n        doctype: '<!DOCTYPE html>',\n        visual: true,\n        font_size_legacy_values: 'xx-small,small,medium,large,x-large,xx-large,300%',\n        forced_root_block: 'p',\n        hidden_input: true,\n        inline_styles: true,\n        convert_fonts_to_spans: true,\n        indent: true,\n        indent_before: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n        indent_after: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n        entity_encoding: 'named',\n        url_converter: editor.convertURL,\n        url_converter_scope: editor\n      };\n      return __assign(__assign({}, baseDefaults), isTouch ? defaultTouchSettings : {});\n    };\n    var getDefaultMobileSettings = function (mobileSettings, isPhone) {\n      var defaultMobileSettings = {\n        resize: false,\n        toolbar_mode: getToolbarMode(mobileSettings, 'scrolling'),\n        toolbar_sticky: false\n      };\n      var defaultPhoneSettings = { menubar: false };\n      return __assign(__assign(__assign({}, defaultTouchSettings), defaultMobileSettings), isPhone ? defaultPhoneSettings : {});\n    };\n    var getExternalPlugins$1 = function (overrideSettings, settings) {\n      var userDefinedExternalPlugins = settings.external_plugins ? settings.external_plugins : {};\n      if (overrideSettings && overrideSettings.external_plugins) {\n        return Tools.extend({}, overrideSettings.external_plugins, userDefinedExternalPlugins);\n      } else {\n        return userDefinedExternalPlugins;\n      }\n    };\n    var combinePlugins = function (forcedPlugins, plugins) {\n      return [].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins));\n    };\n    var getPlatformPlugins = function (isMobileDevice, sectionResult, desktopPlugins, mobilePlugins) {\n      if (isMobileDevice && isSectionTheme(sectionResult, 'mobile', 'mobile')) {\n        return filterLegacyMobilePlugins(mobilePlugins);\n      } else if (isMobileDevice && hasSection(sectionResult, 'mobile')) {\n        return mobilePlugins;\n      } else {\n        return desktopPlugins;\n      }\n    };\n    var processPlugins = function (isMobileDevice, sectionResult, defaultOverrideSettings, settings) {\n      var forcedPlugins = normalizePlugins(defaultOverrideSettings.forced_plugins);\n      var desktopPlugins = normalizePlugins(settings.plugins);\n      var mobileConfig = getSectionConfig(sectionResult, 'mobile');\n      var mobilePlugins = mobileConfig.plugins ? normalizePlugins(mobileConfig.plugins) : desktopPlugins;\n      var platformPlugins = getPlatformPlugins(isMobileDevice, sectionResult, desktopPlugins, mobilePlugins);\n      var combinedPlugins = combinePlugins(forcedPlugins, platformPlugins);\n      if (Env.browser.isIE() && contains(combinedPlugins, 'rtc')) {\n        throw new Error('RTC plugin is not supported on IE 11.');\n      }\n      return Tools.extend(settings, { plugins: combinedPlugins.join(' ') });\n    };\n    var isOnMobile = function (isMobileDevice, sectionResult) {\n      return isMobileDevice && hasSection(sectionResult, 'mobile');\n    };\n    var combineSettings = function (isMobileDevice, isPhone, defaultSettings, defaultOverrideSettings, settings) {\n      var defaultDeviceSettings = isMobileDevice ? { mobile: getDefaultMobileSettings(settings.mobile || {}, isPhone) } : {};\n      var sectionResult = extractSections(['mobile'], deepMerge(defaultDeviceSettings, settings));\n      var extendedSettings = Tools.extend(defaultSettings, defaultOverrideSettings, sectionResult.settings(), isOnMobile(isMobileDevice, sectionResult) ? getSection(sectionResult, 'mobile') : {}, {\n        validate: true,\n        external_plugins: getExternalPlugins$1(defaultOverrideSettings, sectionResult.settings())\n      });\n      return processPlugins(isMobileDevice, sectionResult, defaultOverrideSettings, extendedSettings);\n    };\n    var getEditorSettings = function (editor, id, documentBaseUrl, defaultOverrideSettings, settings) {\n      var defaultSettings = getDefaultSettings(settings, id, documentBaseUrl, isTouch, editor);\n      return combineSettings(isPhone || isTablet, isPhone, defaultSettings, defaultOverrideSettings, settings);\n    };\n    var getFiltered = function (predicate, editor, name) {\n      return Optional.from(editor.settings[name]).filter(predicate);\n    };\n    var getParamObject = function (value) {\n      var output = {};\n      if (typeof value === 'string') {\n        each(value.indexOf('=') > 0 ? value.split(/[;,](?![^=;,]*(?:[;,]|$))/) : value.split(','), function (val) {\n          var arr = val.split('=');\n          if (arr.length > 1) {\n            output[Tools.trim(arr[0])] = Tools.trim(arr[1]);\n          } else {\n            output[Tools.trim(arr[0])] = Tools.trim(arr[0]);\n          }\n        });\n      } else {\n        output = value;\n      }\n      return output;\n    };\n    var isArrayOf = function (p) {\n      return function (a) {\n        return isArray(a) && forall(a, p);\n      };\n    };\n    var getParam = function (editor, name, defaultVal, type) {\n      var value = name in editor.settings ? editor.settings[name] : defaultVal;\n      if (type === 'hash') {\n        return getParamObject(value);\n      } else if (type === 'string') {\n        return getFiltered(isString, editor, name).getOr(defaultVal);\n      } else if (type === 'number') {\n        return getFiltered(isNumber, editor, name).getOr(defaultVal);\n      } else if (type === 'boolean') {\n        return getFiltered(isBoolean, editor, name).getOr(defaultVal);\n      } else if (type === 'object') {\n        return getFiltered(isObject, editor, name).getOr(defaultVal);\n      } else if (type === 'array') {\n        return getFiltered(isArray, editor, name).getOr(defaultVal);\n      } else if (type === 'string[]') {\n        return getFiltered(isArrayOf(isString), editor, name).getOr(defaultVal);\n      } else if (type === 'function') {\n        return getFiltered(isFunction, editor, name).getOr(defaultVal);\n      } else {\n        return value;\n      }\n    };\n\n    var CreateIconManager = function () {\n      var lookup = {};\n      var add = function (id, iconPack) {\n        lookup[id] = iconPack;\n      };\n      var get = function (id) {\n        if (lookup[id]) {\n          return lookup[id];\n        }\n        return { icons: {} };\n      };\n      var has$1 = function (id) {\n        return has(lookup, id);\n      };\n      return {\n        add: add,\n        get: get,\n        has: has$1\n      };\n    };\n    var IconManager = CreateIconManager();\n\n    var getProp = function (propName, elm) {\n      var rawElm = elm.dom;\n      return rawElm[propName];\n    };\n    var getComputedSizeProp = function (propName, elm) {\n      return parseInt(get$5(elm, propName), 10);\n    };\n    var getClientWidth = curry(getProp, 'clientWidth');\n    var getClientHeight = curry(getProp, 'clientHeight');\n    var getMarginTop = curry(getComputedSizeProp, 'margin-top');\n    var getMarginLeft = curry(getComputedSizeProp, 'margin-left');\n    var getBoundingClientRect$1 = function (elm) {\n      return elm.dom.getBoundingClientRect();\n    };\n    var isInsideElementContentArea = function (bodyElm, clientX, clientY) {\n      var clientWidth = getClientWidth(bodyElm);\n      var clientHeight = getClientHeight(bodyElm);\n      return clientX >= 0 && clientY >= 0 && clientX <= clientWidth && clientY <= clientHeight;\n    };\n    var transpose = function (inline, elm, clientX, clientY) {\n      var clientRect = getBoundingClientRect$1(elm);\n      var deltaX = inline ? clientRect.left + elm.dom.clientLeft + getMarginLeft(elm) : 0;\n      var deltaY = inline ? clientRect.top + elm.dom.clientTop + getMarginTop(elm) : 0;\n      var x = clientX - deltaX;\n      var y = clientY - deltaY;\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var isXYInContentArea = function (editor, clientX, clientY) {\n      var bodyElm = SugarElement.fromDom(editor.getBody());\n      var targetElm = editor.inline ? bodyElm : documentElement(bodyElm);\n      var transposedPoint = transpose(editor.inline, targetElm, clientX, clientY);\n      return isInsideElementContentArea(targetElm, transposedPoint.x, transposedPoint.y);\n    };\n    var fromDomSafe = function (node) {\n      return Optional.from(node).map(SugarElement.fromDom);\n    };\n    var isEditorAttachedToDom = function (editor) {\n      var rawContainer = editor.inline ? editor.getBody() : editor.getContentAreaContainer();\n      return fromDomSafe(rawContainer).map(inBody).getOr(false);\n    };\n\n    var NotificationManagerImpl = function () {\n      var unimplemented = function () {\n        throw new Error('Theme did not provide a NotificationManager implementation.');\n      };\n      return {\n        open: unimplemented,\n        close: unimplemented,\n        reposition: unimplemented,\n        getArgs: unimplemented\n      };\n    };\n\n    var NotificationManager = function (editor) {\n      var notifications = [];\n      var getImplementation = function () {\n        var theme = editor.theme;\n        return theme && theme.getNotificationManagerImpl ? theme.getNotificationManagerImpl() : NotificationManagerImpl();\n      };\n      var getTopNotification = function () {\n        return Optional.from(notifications[0]);\n      };\n      var isEqual = function (a, b) {\n        return a.type === b.type && a.text === b.text && !a.progressBar && !a.timeout && !b.progressBar && !b.timeout;\n      };\n      var reposition = function () {\n        if (notifications.length > 0) {\n          getImplementation().reposition(notifications);\n        }\n      };\n      var addNotification = function (notification) {\n        notifications.push(notification);\n      };\n      var closeNotification = function (notification) {\n        findIndex(notifications, function (otherNotification) {\n          return otherNotification === notification;\n        }).each(function (index) {\n          notifications.splice(index, 1);\n        });\n      };\n      var open = function (spec, fireEvent) {\n        if (fireEvent === void 0) {\n          fireEvent = true;\n        }\n        if (editor.removed || !isEditorAttachedToDom(editor)) {\n          return;\n        }\n        if (fireEvent) {\n          editor.fire('BeforeOpenNotification', { notification: spec });\n        }\n        return find(notifications, function (notification) {\n          return isEqual(getImplementation().getArgs(notification), spec);\n        }).getOrThunk(function () {\n          editor.editorManager.setActive(editor);\n          var notification = getImplementation().open(spec, function () {\n            closeNotification(notification);\n            reposition();\n            getTopNotification().fold(function () {\n              return editor.focus();\n            }, function (top) {\n              return focus(SugarElement.fromDom(top.getEl()));\n            });\n          });\n          addNotification(notification);\n          reposition();\n          editor.fire('OpenNotification', __assign({}, notification));\n          return notification;\n        });\n      };\n      var close = function () {\n        getTopNotification().each(function (notification) {\n          getImplementation().close(notification);\n          closeNotification(notification);\n          reposition();\n        });\n      };\n      var getNotifications = function () {\n        return notifications;\n      };\n      var registerEvents = function (editor) {\n        editor.on('SkinLoaded', function () {\n          var serviceMessage = getServiceMessage(editor);\n          if (serviceMessage) {\n            open({\n              text: serviceMessage,\n              type: 'warning',\n              timeout: 0\n            }, false);\n          }\n        });\n        editor.on('ResizeEditor ResizeWindow NodeChange', function () {\n          Delay.requestAnimationFrame(reposition);\n        });\n        editor.on('remove', function () {\n          each(notifications.slice(), function (notification) {\n            getImplementation().close(notification);\n          });\n        });\n      };\n      registerEvents(editor);\n      return {\n        open: open,\n        close: close,\n        getNotifications: getNotifications\n      };\n    };\n\n    var PluginManager = AddOnManager.PluginManager;\n\n    var ThemeManager = AddOnManager.ThemeManager;\n\n    function WindowManagerImpl () {\n      var unimplemented = function () {\n        throw new Error('Theme did not provide a WindowManager implementation.');\n      };\n      return {\n        open: unimplemented,\n        openUrl: unimplemented,\n        alert: unimplemented,\n        confirm: unimplemented,\n        close: unimplemented,\n        getParams: unimplemented,\n        setParams: unimplemented\n      };\n    }\n\n    var WindowManager = function (editor) {\n      var dialogs = [];\n      var getImplementation = function () {\n        var theme = editor.theme;\n        return theme && theme.getWindowManagerImpl ? theme.getWindowManagerImpl() : WindowManagerImpl();\n      };\n      var funcBind = function (scope, f) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          return f ? f.apply(scope, args) : undefined;\n        };\n      };\n      var fireOpenEvent = function (dialog) {\n        editor.fire('OpenWindow', { dialog: dialog });\n      };\n      var fireCloseEvent = function (dialog) {\n        editor.fire('CloseWindow', { dialog: dialog });\n      };\n      var addDialog = function (dialog) {\n        dialogs.push(dialog);\n        fireOpenEvent(dialog);\n      };\n      var closeDialog = function (dialog) {\n        fireCloseEvent(dialog);\n        dialogs = filter(dialogs, function (otherDialog) {\n          return otherDialog !== dialog;\n        });\n        if (dialogs.length === 0) {\n          editor.focus();\n        }\n      };\n      var getTopDialog = function () {\n        return Optional.from(dialogs[dialogs.length - 1]);\n      };\n      var storeSelectionAndOpenDialog = function (openDialog) {\n        editor.editorManager.setActive(editor);\n        store(editor);\n        var dialog = openDialog();\n        addDialog(dialog);\n        return dialog;\n      };\n      var open = function (args, params) {\n        return storeSelectionAndOpenDialog(function () {\n          return getImplementation().open(args, params, closeDialog);\n        });\n      };\n      var openUrl = function (args) {\n        return storeSelectionAndOpenDialog(function () {\n          return getImplementation().openUrl(args, closeDialog);\n        });\n      };\n      var alert = function (message, callback, scope) {\n        var windowManagerImpl = getImplementation();\n        windowManagerImpl.alert(message, funcBind(scope ? scope : windowManagerImpl, callback));\n      };\n      var confirm = function (message, callback, scope) {\n        var windowManagerImpl = getImplementation();\n        windowManagerImpl.confirm(message, funcBind(scope ? scope : windowManagerImpl, callback));\n      };\n      var close = function () {\n        getTopDialog().each(function (dialog) {\n          getImplementation().close(dialog);\n          closeDialog(dialog);\n        });\n      };\n      editor.on('remove', function () {\n        each(dialogs, function (dialog) {\n          getImplementation().close(dialog);\n        });\n      });\n      return {\n        open: open,\n        openUrl: openUrl,\n        alert: alert,\n        confirm: confirm,\n        close: close\n      };\n    };\n\n    var displayNotification = function (editor, message) {\n      editor.notificationManager.open({\n        type: 'error',\n        text: message\n      });\n    };\n    var displayError = function (editor, message) {\n      if (editor._skinLoaded) {\n        displayNotification(editor, message);\n      } else {\n        editor.on('SkinLoaded', function () {\n          displayNotification(editor, message);\n        });\n      }\n    };\n    var uploadError = function (editor, message) {\n      displayError(editor, I18n.translate([\n        'Failed to upload image: {0}',\n        message\n      ]));\n    };\n    var logError = function (editor, errorType, msg) {\n      fireError(editor, errorType, { message: msg });\n      console.error(msg);\n    };\n    var createLoadError = function (type, url, name) {\n      return name ? 'Failed to load ' + type + ': ' + name + ' from url ' + url : 'Failed to load ' + type + ' url: ' + url;\n    };\n    var pluginLoadError = function (editor, url, name) {\n      logError(editor, 'PluginLoadError', createLoadError('plugin', url, name));\n    };\n    var iconsLoadError = function (editor, url, name) {\n      logError(editor, 'IconsLoadError', createLoadError('icons', url, name));\n    };\n    var languageLoadError = function (editor, url, name) {\n      logError(editor, 'LanguageLoadError', createLoadError('language', url, name));\n    };\n    var pluginInitError = function (editor, name, err) {\n      var message = I18n.translate([\n        'Failed to initialize plugin: {0}',\n        name\n      ]);\n      fireError(editor, 'PluginLoadError', { message: message });\n      initError(message, err);\n      displayError(editor, message);\n    };\n    var initError = function (message) {\n      var x = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n      var console = window.console;\n      if (console) {\n        if (console.error) {\n          console.error.apply(console, __spreadArrays([message], x));\n        } else {\n          console.log.apply(console, __spreadArrays([message], x));\n        }\n      }\n    };\n\n    var isContentCssSkinName = function (url) {\n      return /^[a-z0-9\\-]+$/i.test(url);\n    };\n    var getContentCssUrls = function (editor) {\n      return transformToUrls(editor, getContentCss(editor));\n    };\n    var getFontCssUrls = function (editor) {\n      return transformToUrls(editor, getFontCss(editor));\n    };\n    var transformToUrls = function (editor, cssLinks) {\n      var skinUrl = editor.editorManager.baseURL + '/skins/content';\n      var suffix = editor.editorManager.suffix;\n      var contentCssFile = 'content' + suffix + '.css';\n      var inline = editor.inline === true;\n      return map(cssLinks, function (url) {\n        if (isContentCssSkinName(url) && !inline) {\n          return skinUrl + '/' + url + '/' + contentCssFile;\n        } else {\n          return editor.documentBaseURI.toAbsolute(url);\n        }\n      });\n    };\n    var appendContentCssFromSettings = function (editor) {\n      editor.contentCSS = editor.contentCSS.concat(getContentCssUrls(editor), getFontCssUrls(editor));\n    };\n\n    var UploadStatus = function () {\n      var PENDING = 1, UPLOADED = 2;\n      var blobUriStatuses = {};\n      var createStatus = function (status, resultUri) {\n        return {\n          status: status,\n          resultUri: resultUri\n        };\n      };\n      var hasBlobUri = function (blobUri) {\n        return blobUri in blobUriStatuses;\n      };\n      var getResultUri = function (blobUri) {\n        var result = blobUriStatuses[blobUri];\n        return result ? result.resultUri : null;\n      };\n      var isPending = function (blobUri) {\n        return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === PENDING : false;\n      };\n      var isUploaded = function (blobUri) {\n        return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === UPLOADED : false;\n      };\n      var markPending = function (blobUri) {\n        blobUriStatuses[blobUri] = createStatus(PENDING, null);\n      };\n      var markUploaded = function (blobUri, resultUri) {\n        blobUriStatuses[blobUri] = createStatus(UPLOADED, resultUri);\n      };\n      var removeFailed = function (blobUri) {\n        delete blobUriStatuses[blobUri];\n      };\n      var destroy = function () {\n        blobUriStatuses = {};\n      };\n      return {\n        hasBlobUri: hasBlobUri,\n        getResultUri: getResultUri,\n        isPending: isPending,\n        isUploaded: isUploaded,\n        markPending: markPending,\n        markUploaded: markUploaded,\n        removeFailed: removeFailed,\n        destroy: destroy\n      };\n    };\n\n    var count$1 = 0;\n    var seed = function () {\n      var rnd = function () {\n        return Math.round(Math.random() * 4294967295).toString(36);\n      };\n      var now = new Date().getTime();\n      return 's' + now.toString(36) + rnd() + rnd() + rnd();\n    };\n    var uuid = function (prefix) {\n      return prefix + count$1++ + seed();\n    };\n\n    var BlobCache = function () {\n      var cache = [];\n      var mimeToExt = function (mime) {\n        var mimes = {\n          'image/jpeg': 'jpg',\n          'image/jpg': 'jpg',\n          'image/gif': 'gif',\n          'image/png': 'png',\n          'image/apng': 'apng',\n          'image/avif': 'avif',\n          'image/svg+xml': 'svg',\n          'image/webp': 'webp',\n          'image/bmp': 'bmp',\n          'image/tiff': 'tiff'\n        };\n        return mimes[mime.toLowerCase()] || 'dat';\n      };\n      var create = function (o, blob, base64, name, filename) {\n        if (isString(o)) {\n          var id = o;\n          return toBlobInfo({\n            id: id,\n            name: name,\n            filename: filename,\n            blob: blob,\n            base64: base64\n          });\n        } else if (isObject(o)) {\n          return toBlobInfo(o);\n        } else {\n          throw new Error('Unknown input type');\n        }\n      };\n      var toBlobInfo = function (o) {\n        if (!o.blob || !o.base64) {\n          throw new Error('blob and base64 representations of the image are required for BlobInfo to be created');\n        }\n        var id = o.id || uuid('blobid');\n        var name = o.name || id;\n        var blob = o.blob;\n        return {\n          id: constant(id),\n          name: constant(name),\n          filename: constant(o.filename || name + '.' + mimeToExt(blob.type)),\n          blob: constant(blob),\n          base64: constant(o.base64),\n          blobUri: constant(o.blobUri || URL.createObjectURL(blob)),\n          uri: constant(o.uri)\n        };\n      };\n      var add = function (blobInfo) {\n        if (!get(blobInfo.id())) {\n          cache.push(blobInfo);\n        }\n      };\n      var findFirst = function (predicate) {\n        return find(cache, predicate).getOrUndefined();\n      };\n      var get = function (id) {\n        return findFirst(function (cachedBlobInfo) {\n          return cachedBlobInfo.id() === id;\n        });\n      };\n      var getByUri = function (blobUri) {\n        return findFirst(function (blobInfo) {\n          return blobInfo.blobUri() === blobUri;\n        });\n      };\n      var getByData = function (base64, type) {\n        return findFirst(function (blobInfo) {\n          return blobInfo.base64() === base64 && blobInfo.blob().type === type;\n        });\n      };\n      var removeByUri = function (blobUri) {\n        cache = filter(cache, function (blobInfo) {\n          if (blobInfo.blobUri() === blobUri) {\n            URL.revokeObjectURL(blobInfo.blobUri());\n            return false;\n          }\n          return true;\n        });\n      };\n      var destroy = function () {\n        each(cache, function (cachedBlobInfo) {\n          URL.revokeObjectURL(cachedBlobInfo.blobUri());\n        });\n        cache = [];\n      };\n      return {\n        create: create,\n        add: add,\n        get: get,\n        getByUri: getByUri,\n        getByData: getByData,\n        findFirst: findFirst,\n        removeByUri: removeByUri,\n        destroy: destroy\n      };\n    };\n\n    var Uploader = function (uploadStatus, settings) {\n      var pendingPromises = {};\n      var pathJoin = function (path1, path2) {\n        if (path1) {\n          return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n        }\n        return path2;\n      };\n      var defaultHandler = function (blobInfo, success, failure, progress) {\n        var xhr = new XMLHttpRequest();\n        xhr.open('POST', settings.url);\n        xhr.withCredentials = settings.credentials;\n        xhr.upload.onprogress = function (e) {\n          progress(e.loaded / e.total * 100);\n        };\n        xhr.onerror = function () {\n          failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n        };\n        xhr.onload = function () {\n          if (xhr.status < 200 || xhr.status >= 300) {\n            failure('HTTP Error: ' + xhr.status);\n            return;\n          }\n          var json = JSON.parse(xhr.responseText);\n          if (!json || typeof json.location !== 'string') {\n            failure('Invalid JSON: ' + xhr.responseText);\n            return;\n          }\n          success(pathJoin(settings.basePath, json.location));\n        };\n        var formData = new FormData();\n        formData.append('file', blobInfo.blob(), blobInfo.filename());\n        xhr.send(formData);\n      };\n      var noUpload = function () {\n        return new promiseObj(function (resolve) {\n          resolve([]);\n        });\n      };\n      var handlerSuccess = function (blobInfo, url) {\n        return {\n          url: url,\n          blobInfo: blobInfo,\n          status: true\n        };\n      };\n      var handlerFailure = function (blobInfo, message, options) {\n        return {\n          url: '',\n          blobInfo: blobInfo,\n          status: false,\n          error: {\n            message: message,\n            options: options\n          }\n        };\n      };\n      var resolvePending = function (blobUri, result) {\n        Tools.each(pendingPromises[blobUri], function (resolve) {\n          resolve(result);\n        });\n        delete pendingPromises[blobUri];\n      };\n      var uploadBlobInfo = function (blobInfo, handler, openNotification) {\n        uploadStatus.markPending(blobInfo.blobUri());\n        return new promiseObj(function (resolve) {\n          var notification, progress;\n          try {\n            var closeNotification_1 = function () {\n              if (notification) {\n                notification.close();\n                progress = noop;\n              }\n            };\n            var success = function (url) {\n              closeNotification_1();\n              uploadStatus.markUploaded(blobInfo.blobUri(), url);\n              resolvePending(blobInfo.blobUri(), handlerSuccess(blobInfo, url));\n              resolve(handlerSuccess(blobInfo, url));\n            };\n            var failure = function (error, options) {\n              var failureOptions = options ? options : {};\n              closeNotification_1();\n              uploadStatus.removeFailed(blobInfo.blobUri());\n              resolvePending(blobInfo.blobUri(), handlerFailure(blobInfo, error, failureOptions));\n              resolve(handlerFailure(blobInfo, error, failureOptions));\n            };\n            progress = function (percent) {\n              if (percent < 0 || percent > 100) {\n                return;\n              }\n              Optional.from(notification).orThunk(function () {\n                return Optional.from(openNotification).map(apply);\n              }).each(function (n) {\n                notification = n;\n                n.progressBar.value(percent);\n              });\n            };\n            handler(blobInfo, success, failure, progress);\n          } catch (ex) {\n            resolve(handlerFailure(blobInfo, ex.message, {}));\n          }\n        });\n      };\n      var isDefaultHandler = function (handler) {\n        return handler === defaultHandler;\n      };\n      var pendingUploadBlobInfo = function (blobInfo) {\n        var blobUri = blobInfo.blobUri();\n        return new promiseObj(function (resolve) {\n          pendingPromises[blobUri] = pendingPromises[blobUri] || [];\n          pendingPromises[blobUri].push(resolve);\n        });\n      };\n      var uploadBlobs = function (blobInfos, openNotification) {\n        blobInfos = Tools.grep(blobInfos, function (blobInfo) {\n          return !uploadStatus.isUploaded(blobInfo.blobUri());\n        });\n        return promiseObj.all(Tools.map(blobInfos, function (blobInfo) {\n          return uploadStatus.isPending(blobInfo.blobUri()) ? pendingUploadBlobInfo(blobInfo) : uploadBlobInfo(blobInfo, settings.handler, openNotification);\n        }));\n      };\n      var upload = function (blobInfos, openNotification) {\n        return !settings.url && isDefaultHandler(settings.handler) ? noUpload() : uploadBlobs(blobInfos, openNotification);\n      };\n      if (isFunction(settings.handler) === false) {\n        settings.handler = defaultHandler;\n      }\n      return { upload: upload };\n    };\n\n    var openNotification = function (editor) {\n      return function () {\n        return editor.notificationManager.open({\n          text: editor.translate('Image uploading...'),\n          type: 'info',\n          timeout: -1,\n          progressBar: true\n        });\n      };\n    };\n    var createUploader = function (editor, uploadStatus) {\n      return Uploader(uploadStatus, {\n        url: getImageUploadUrl(editor),\n        basePath: getImageUploadBasePath(editor),\n        credentials: getImagesUploadCredentials(editor),\n        handler: getImagesUploadHandler(editor)\n      });\n    };\n    var ImageUploader = function (editor) {\n      var uploadStatus = UploadStatus();\n      var uploader = createUploader(editor, uploadStatus);\n      return {\n        upload: function (blobInfos, showNotification) {\n          if (showNotification === void 0) {\n            showNotification = true;\n          }\n          return uploader.upload(blobInfos, showNotification ? openNotification(editor) : undefined);\n        }\n      };\n    };\n\n    var UploadChangeHandler = function (editor) {\n      var lastChangedLevel = Cell(null);\n      editor.on('change AddUndo', function (e) {\n        lastChangedLevel.set(__assign({}, e.level));\n      });\n      var fireIfChanged = function () {\n        var data = editor.undoManager.data;\n        last(data).filter(function (level) {\n          return !isEq$4(lastChangedLevel.get(), level);\n        }).each(function (level) {\n          editor.setDirty(true);\n          editor.fire('change', {\n            level: level,\n            lastLevel: get(data, data.length - 2).getOrNull()\n          });\n        });\n      };\n      return { fireIfChanged: fireIfChanged };\n    };\n    var EditorUpload = function (editor) {\n      var blobCache = BlobCache();\n      var uploader, imageScanner;\n      var uploadStatus = UploadStatus();\n      var urlFilters = [];\n      var changeHandler = UploadChangeHandler(editor);\n      var aliveGuard = function (callback) {\n        return function (result) {\n          if (editor.selection) {\n            return callback(result);\n          }\n          return [];\n        };\n      };\n      var cacheInvalidator = function (url) {\n        return url + (url.indexOf('?') === -1 ? '?' : '&') + new Date().getTime();\n      };\n      var replaceString = function (content, search, replace) {\n        var index = 0;\n        do {\n          index = content.indexOf(search, index);\n          if (index !== -1) {\n            content = content.substring(0, index) + replace + content.substr(index + search.length);\n            index += replace.length - search.length + 1;\n          }\n        } while (index !== -1);\n        return content;\n      };\n      var replaceImageUrl = function (content, targetUrl, replacementUrl) {\n        var replacementString = 'src=\"' + replacementUrl + '\"' + (replacementUrl === Env.transparentSrc ? ' data-mce-placeholder=\"1\"' : '');\n        content = replaceString(content, 'src=\"' + targetUrl + '\"', replacementString);\n        content = replaceString(content, 'data-mce-src=\"' + targetUrl + '\"', 'data-mce-src=\"' + replacementUrl + '\"');\n        return content;\n      };\n      var replaceUrlInUndoStack = function (targetUrl, replacementUrl) {\n        each(editor.undoManager.data, function (level) {\n          if (level.type === 'fragmented') {\n            level.fragments = map(level.fragments, function (fragment) {\n              return replaceImageUrl(fragment, targetUrl, replacementUrl);\n            });\n          } else {\n            level.content = replaceImageUrl(level.content, targetUrl, replacementUrl);\n          }\n        });\n      };\n      var replaceImageUriInView = function (image, resultUri) {\n        var src = editor.convertURL(resultUri, 'src');\n        replaceUrlInUndoStack(image.src, resultUri);\n        editor.$(image).attr({\n          'src': shouldReuseFileName(editor) ? cacheInvalidator(resultUri) : resultUri,\n          'data-mce-src': src\n        });\n      };\n      var uploadImages = function (callback) {\n        if (!uploader) {\n          uploader = createUploader(editor, uploadStatus);\n        }\n        return scanForImages().then(aliveGuard(function (imageInfos) {\n          var blobInfos = map(imageInfos, function (imageInfo) {\n            return imageInfo.blobInfo;\n          });\n          return uploader.upload(blobInfos, openNotification(editor)).then(aliveGuard(function (result) {\n            var imagesToRemove = [];\n            var filteredResult = map(result, function (uploadInfo, index) {\n              var blobInfo = imageInfos[index].blobInfo;\n              var image = imageInfos[index].image;\n              if (uploadInfo.status && shouldReplaceBlobUris(editor)) {\n                blobCache.removeByUri(image.src);\n                replaceImageUriInView(image, uploadInfo.url);\n              } else if (uploadInfo.error) {\n                if (uploadInfo.error.options.remove) {\n                  replaceUrlInUndoStack(image.getAttribute('src'), Env.transparentSrc);\n                  imagesToRemove.push(image);\n                }\n                uploadError(editor, uploadInfo.error.message);\n              }\n              return {\n                element: image,\n                status: uploadInfo.status,\n                uploadUri: uploadInfo.url,\n                blobInfo: blobInfo\n              };\n            });\n            if (filteredResult.length > 0) {\n              changeHandler.fireIfChanged();\n            }\n            if (imagesToRemove.length > 0) {\n              if (isRtc(editor)) {\n                console.error('Removing images on failed uploads is currently unsupported for RTC');\n              } else {\n                editor.undoManager.transact(function () {\n                  each(imagesToRemove, function (element) {\n                    editor.dom.remove(element);\n                    blobCache.removeByUri(element.src);\n                  });\n                });\n              }\n            }\n            if (callback) {\n              callback(filteredResult);\n            }\n            return filteredResult;\n          }));\n        }));\n      };\n      var uploadImagesAuto = function (callback) {\n        if (isAutomaticUploadsEnabled(editor)) {\n          return uploadImages(callback);\n        }\n      };\n      var isValidDataUriImage = function (imgElm) {\n        if (forall(urlFilters, function (filter) {\n            return filter(imgElm);\n          }) === false) {\n          return false;\n        }\n        if (imgElm.getAttribute('src').indexOf('data:') === 0) {\n          var dataImgFilter = getImagesDataImgFilter(editor);\n          return dataImgFilter(imgElm);\n        }\n        return true;\n      };\n      var addFilter = function (filter) {\n        urlFilters.push(filter);\n      };\n      var scanForImages = function () {\n        if (!imageScanner) {\n          imageScanner = ImageScanner(uploadStatus, blobCache);\n        }\n        return imageScanner.findAll(editor.getBody(), isValidDataUriImage).then(aliveGuard(function (result) {\n          result = filter(result, function (resultItem) {\n            if (typeof resultItem === 'string') {\n              displayError(editor, resultItem);\n              return false;\n            }\n            return true;\n          });\n          each(result, function (resultItem) {\n            replaceUrlInUndoStack(resultItem.image.src, resultItem.blobInfo.blobUri());\n            resultItem.image.src = resultItem.blobInfo.blobUri();\n            resultItem.image.removeAttribute('data-mce-src');\n          });\n          return result;\n        }));\n      };\n      var destroy = function () {\n        blobCache.destroy();\n        uploadStatus.destroy();\n        imageScanner = uploader = null;\n      };\n      var replaceBlobUris = function (content) {\n        return content.replace(/src=\"(blob:[^\"]+)\"/g, function (match, blobUri) {\n          var resultUri = uploadStatus.getResultUri(blobUri);\n          if (resultUri) {\n            return 'src=\"' + resultUri + '\"';\n          }\n          var blobInfo = blobCache.getByUri(blobUri);\n          if (!blobInfo) {\n            blobInfo = foldl(editor.editorManager.get(), function (result, editor) {\n              return result || editor.editorUpload && editor.editorUpload.blobCache.getByUri(blobUri);\n            }, null);\n          }\n          if (blobInfo) {\n            var blob = blobInfo.blob();\n            return 'src=\"data:' + blob.type + ';base64,' + blobInfo.base64() + '\"';\n          }\n          return match;\n        });\n      };\n      editor.on('SetContent', function () {\n        if (isAutomaticUploadsEnabled(editor)) {\n          uploadImagesAuto();\n        } else {\n          scanForImages();\n        }\n      });\n      editor.on('RawSaveContent', function (e) {\n        e.content = replaceBlobUris(e.content);\n      });\n      editor.on('GetContent', function (e) {\n        if (e.source_view || e.format === 'raw' || e.format === 'tree') {\n          return;\n        }\n        e.content = replaceBlobUris(e.content);\n      });\n      editor.on('PostRender', function () {\n        editor.parser.addNodeFilter('img', function (images) {\n          each(images, function (img) {\n            var src = img.attr('src');\n            if (blobCache.getByUri(src)) {\n              return;\n            }\n            var resultUri = uploadStatus.getResultUri(src);\n            if (resultUri) {\n              img.attr('src', resultUri);\n            }\n          });\n        });\n      });\n      return {\n        blobCache: blobCache,\n        addFilter: addFilter,\n        uploadImages: uploadImages,\n        uploadImagesAuto: uploadImagesAuto,\n        scanForImages: scanForImages,\n        destroy: destroy\n      };\n    };\n\n    var get$a = function (dom) {\n      var formats = {\n        valigntop: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'top' }\n          }],\n        valignmiddle: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'middle' }\n          }],\n        valignbottom: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'bottom' }\n          }],\n        alignleft: [\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-left',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'left' },\n            inherit: false,\n            preview: false,\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'img,table',\n            collapsed: false,\n            styles: { float: 'left' },\n            preview: 'font-family font-size'\n          }\n        ],\n        aligncenter: [\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'center' },\n            inherit: false,\n            preview: 'font-family font-size',\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-center',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'img',\n            collapsed: false,\n            styles: {\n              display: 'block',\n              marginLeft: 'auto',\n              marginRight: 'auto'\n            },\n            preview: false\n          },\n          {\n            selector: 'table',\n            collapsed: false,\n            styles: {\n              marginLeft: 'auto',\n              marginRight: 'auto'\n            },\n            preview: 'font-family font-size'\n          }\n        ],\n        alignright: [\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-right',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'right' },\n            inherit: false,\n            preview: 'font-family font-size',\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'img,table',\n            collapsed: false,\n            styles: { float: 'right' },\n            preview: 'font-family font-size'\n          }\n        ],\n        alignjustify: [{\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'justify' },\n            inherit: false,\n            defaultBlock: 'div',\n            preview: 'font-family font-size'\n          }],\n        bold: [\n          {\n            inline: 'strong',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          },\n          {\n            inline: 'span',\n            styles: { fontWeight: 'bold' }\n          },\n          {\n            inline: 'b',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          }\n        ],\n        italic: [\n          {\n            inline: 'em',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          },\n          {\n            inline: 'span',\n            styles: { fontStyle: 'italic' }\n          },\n          {\n            inline: 'i',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          }\n        ],\n        underline: [\n          {\n            inline: 'span',\n            styles: { textDecoration: 'underline' },\n            exact: true\n          },\n          {\n            inline: 'u',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          }\n        ],\n        strikethrough: [\n          {\n            inline: 'span',\n            styles: { textDecoration: 'line-through' },\n            exact: true\n          },\n          {\n            inline: 'strike',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          },\n          {\n            inline: 's',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          }\n        ],\n        forecolor: {\n          inline: 'span',\n          styles: { color: '%value' },\n          links: true,\n          remove_similar: true,\n          clear_child_styles: true\n        },\n        hilitecolor: {\n          inline: 'span',\n          styles: { backgroundColor: '%value' },\n          links: true,\n          remove_similar: true,\n          clear_child_styles: true\n        },\n        fontname: {\n          inline: 'span',\n          toggle: false,\n          styles: { fontFamily: '%value' },\n          clear_child_styles: true\n        },\n        fontsize: {\n          inline: 'span',\n          toggle: false,\n          styles: { fontSize: '%value' },\n          clear_child_styles: true\n        },\n        lineheight: {\n          selector: 'h1,h2,h3,h4,h5,h6,p,li,td,th,div',\n          defaultBlock: 'p',\n          styles: { lineHeight: '%value' }\n        },\n        fontsize_class: {\n          inline: 'span',\n          attributes: { class: '%value' }\n        },\n        blockquote: {\n          block: 'blockquote',\n          wrapper: true,\n          remove: 'all'\n        },\n        subscript: { inline: 'sub' },\n        superscript: { inline: 'sup' },\n        code: { inline: 'code' },\n        link: {\n          inline: 'a',\n          selector: 'a',\n          remove: 'all',\n          split: true,\n          deep: true,\n          onmatch: function (node, _fmt, _itemName) {\n            return isElement$1(node) && node.hasAttribute('href');\n          },\n          onformat: function (elm, _fmt, vars) {\n            Tools.each(vars, function (value, key) {\n              dom.setAttrib(elm, key, value);\n            });\n          }\n        },\n        removeformat: [\n          {\n            selector: 'b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins',\n            remove: 'all',\n            split: true,\n            expand: false,\n            block_expand: true,\n            deep: true\n          },\n          {\n            selector: 'span',\n            attributes: [\n              'style',\n              'class'\n            ],\n            remove: 'empty',\n            split: true,\n            expand: false,\n            deep: true\n          },\n          {\n            selector: '*',\n            attributes: [\n              'style',\n              'class'\n            ],\n            split: false,\n            expand: false,\n            deep: true\n          }\n        ]\n      };\n      Tools.each('p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp'.split(/\\s/), function (name) {\n        formats[name] = {\n          block: name,\n          remove: 'all'\n        };\n      });\n      return formats;\n    };\n\n    var FormatRegistry = function (editor) {\n      var formats = {};\n      var get = function (name) {\n        return name ? formats[name] : formats;\n      };\n      var has$1 = function (name) {\n        return has(formats, name);\n      };\n      var register = function (name, format) {\n        if (name) {\n          if (typeof name !== 'string') {\n            Tools.each(name, function (format, name) {\n              register(name, format);\n            });\n          } else {\n            if (!isArray(format)) {\n              format = [format];\n            }\n            Tools.each(format, function (format) {\n              if (typeof format.deep === 'undefined') {\n                format.deep = !format.selector;\n              }\n              if (typeof format.split === 'undefined') {\n                format.split = !format.selector || format.inline;\n              }\n              if (typeof format.remove === 'undefined' && format.selector && !format.inline) {\n                format.remove = 'none';\n              }\n              if (format.selector && format.inline) {\n                format.mixed = true;\n                format.block_expand = true;\n              }\n              if (typeof format.classes === 'string') {\n                format.classes = format.classes.split(/\\s+/);\n              }\n            });\n            formats[name] = format;\n          }\n        }\n      };\n      var unregister = function (name) {\n        if (name && formats[name]) {\n          delete formats[name];\n        }\n        return formats;\n      };\n      register(get$a(editor.dom));\n      register(getFormats(editor));\n      return {\n        get: get,\n        has: has$1,\n        register: register,\n        unregister: unregister\n      };\n    };\n\n    var each$e = Tools.each;\n    var dom = DOMUtils.DOM;\n    var parsedSelectorToHtml = function (ancestry, editor) {\n      var elm, item, fragment;\n      var schema = editor && editor.schema || Schema({});\n      var decorate = function (elm, item) {\n        if (item.classes.length) {\n          dom.addClass(elm, item.classes.join(' '));\n        }\n        dom.setAttribs(elm, item.attrs);\n      };\n      var createElement = function (sItem) {\n        item = typeof sItem === 'string' ? {\n          name: sItem,\n          classes: [],\n          attrs: {}\n        } : sItem;\n        var elm = dom.create(item.name);\n        decorate(elm, item);\n        return elm;\n      };\n      var getRequiredParent = function (elm, candidate) {\n        var name = typeof elm !== 'string' ? elm.nodeName.toLowerCase() : elm;\n        var elmRule = schema.getElementRule(name);\n        var parentsRequired = elmRule && elmRule.parentsRequired;\n        if (parentsRequired && parentsRequired.length) {\n          return candidate && Tools.inArray(parentsRequired, candidate) !== -1 ? candidate : parentsRequired[0];\n        } else {\n          return false;\n        }\n      };\n      var wrapInHtml = function (elm, ancestry, siblings) {\n        var parent, parentCandidate;\n        var ancestor = ancestry.length > 0 && ancestry[0];\n        var ancestorName = ancestor && ancestor.name;\n        var parentRequired = getRequiredParent(elm, ancestorName);\n        if (parentRequired) {\n          if (ancestorName === parentRequired) {\n            parentCandidate = ancestry[0];\n            ancestry = ancestry.slice(1);\n          } else {\n            parentCandidate = parentRequired;\n          }\n        } else if (ancestor) {\n          parentCandidate = ancestry[0];\n          ancestry = ancestry.slice(1);\n        } else if (!siblings) {\n          return elm;\n        }\n        if (parentCandidate) {\n          parent = createElement(parentCandidate);\n          parent.appendChild(elm);\n        }\n        if (siblings) {\n          if (!parent) {\n            parent = dom.create('div');\n            parent.appendChild(elm);\n          }\n          Tools.each(siblings, function (sibling) {\n            var siblingElm = createElement(sibling);\n            parent.insertBefore(siblingElm, elm);\n          });\n        }\n        return wrapInHtml(parent, ancestry, parentCandidate && parentCandidate.siblings);\n      };\n      if (ancestry && ancestry.length) {\n        item = ancestry[0];\n        elm = createElement(item);\n        fragment = dom.create('div');\n        fragment.appendChild(wrapInHtml(elm, ancestry.slice(1), item.siblings));\n        return fragment;\n      } else {\n        return '';\n      }\n    };\n    var parseSelectorItem = function (item) {\n      var tagName;\n      var obj = {\n        classes: [],\n        attrs: {}\n      };\n      item = obj.selector = Tools.trim(item);\n      if (item !== '*') {\n        tagName = item.replace(/(?:([#\\.]|::?)([\\w\\-]+)|(\\[)([^\\]]+)\\]?)/g, function ($0, $1, $2, $3, $4) {\n          switch ($1) {\n          case '#':\n            obj.attrs.id = $2;\n            break;\n          case '.':\n            obj.classes.push($2);\n            break;\n          case ':':\n            if (Tools.inArray('checked disabled enabled read-only required'.split(' '), $2) !== -1) {\n              obj.attrs[$2] = $2;\n            }\n            break;\n          }\n          if ($3 === '[') {\n            var m = $4.match(/([\\w\\-]+)(?:\\=\\\"([^\\\"]+))?/);\n            if (m) {\n              obj.attrs[m[1]] = m[2];\n            }\n          }\n          return '';\n        });\n      }\n      obj.name = tagName || 'div';\n      return obj;\n    };\n    var parseSelector = function (selector) {\n      if (!selector || typeof selector !== 'string') {\n        return [];\n      }\n      selector = selector.split(/\\s*,\\s*/)[0];\n      selector = selector.replace(/\\s*(~\\+|~|\\+|>)\\s*/g, '$1');\n      return Tools.map(selector.split(/(?:>|\\s+(?![^\\[\\]]+\\]))/), function (item) {\n        var siblings = Tools.map(item.split(/(?:~\\+|~|\\+)/), parseSelectorItem);\n        var obj = siblings.pop();\n        if (siblings.length) {\n          obj.siblings = siblings;\n        }\n        return obj;\n      }).reverse();\n    };\n    var getCssText = function (editor, format) {\n      var name, previewFrag;\n      var previewCss = '', parentFontSize;\n      var previewStyles = getPreviewStyles(editor);\n      if (previewStyles === '') {\n        return '';\n      }\n      var removeVars = function (val) {\n        return val.replace(/%(\\w+)/g, '');\n      };\n      if (typeof format === 'string') {\n        format = editor.formatter.get(format);\n        if (!format) {\n          return;\n        }\n        format = format[0];\n      }\n      if ('preview' in format) {\n        var previewOpt = get$1(format, 'preview');\n        if (previewOpt.is(false)) {\n          return '';\n        } else {\n          previewStyles = previewOpt.getOr(previewStyles);\n        }\n      }\n      name = format.block || format.inline || 'span';\n      var items = parseSelector(format.selector);\n      if (items.length) {\n        if (!items[0].name) {\n          items[0].name = name;\n        }\n        name = format.selector;\n        previewFrag = parsedSelectorToHtml(items, editor);\n      } else {\n        previewFrag = parsedSelectorToHtml([name], editor);\n      }\n      var previewElm = dom.select(name, previewFrag)[0] || previewFrag.firstChild;\n      each$e(format.styles, function (value, name) {\n        var newValue = removeVars(value);\n        if (newValue) {\n          dom.setStyle(previewElm, name, newValue);\n        }\n      });\n      each$e(format.attributes, function (value, name) {\n        var newValue = removeVars(value);\n        if (newValue) {\n          dom.setAttrib(previewElm, name, newValue);\n        }\n      });\n      each$e(format.classes, function (value) {\n        var newValue = removeVars(value);\n        if (!dom.hasClass(previewElm, newValue)) {\n          dom.addClass(previewElm, newValue);\n        }\n      });\n      editor.fire('PreviewFormats');\n      dom.setStyles(previewFrag, {\n        position: 'absolute',\n        left: -65535\n      });\n      editor.getBody().appendChild(previewFrag);\n      parentFontSize = dom.getStyle(editor.getBody(), 'fontSize', true);\n      parentFontSize = /px$/.test(parentFontSize) ? parseInt(parentFontSize, 10) : 0;\n      each$e(previewStyles.split(' '), function (name) {\n        var value = dom.getStyle(previewElm, name, true);\n        if (name === 'background-color' && /transparent|rgba\\s*\\([^)]+,\\s*0\\)/.test(value)) {\n          value = dom.getStyle(editor.getBody(), name, true);\n          if (dom.toHex(value).toLowerCase() === '#ffffff') {\n            return;\n          }\n        }\n        if (name === 'color') {\n          if (dom.toHex(value).toLowerCase() === '#000000') {\n            return;\n          }\n        }\n        if (name === 'font-size') {\n          if (/em|%$/.test(value)) {\n            if (parentFontSize === 0) {\n              return;\n            }\n            var numValue = parseFloat(value) / (/%$/.test(value) ? 100 : 1);\n            value = numValue * parentFontSize + 'px';\n          }\n        }\n        if (name === 'border' && value) {\n          previewCss += 'padding:0 2px;';\n        }\n        previewCss += name + ':' + value + ';';\n      });\n      editor.fire('AfterPreviewFormats');\n      dom.remove(previewFrag);\n      return previewCss;\n    };\n\n    var setup$6 = function (editor) {\n      editor.addShortcut('meta+b', '', 'Bold');\n      editor.addShortcut('meta+i', '', 'Italic');\n      editor.addShortcut('meta+u', '', 'Underline');\n      for (var i = 1; i <= 6; i++) {\n        editor.addShortcut('access+' + i, '', [\n          'FormatBlock',\n          false,\n          'h' + i\n        ]);\n      }\n      editor.addShortcut('access+7', '', [\n        'FormatBlock',\n        false,\n        'p'\n      ]);\n      editor.addShortcut('access+8', '', [\n        'FormatBlock',\n        false,\n        'div'\n      ]);\n      editor.addShortcut('access+9', '', [\n        'FormatBlock',\n        false,\n        'address'\n      ]);\n    };\n\n    var Formatter = function (editor) {\n      var formats = FormatRegistry(editor);\n      var formatChangeState = Cell(null);\n      setup$6(editor);\n      setup$3(editor);\n      return {\n        get: formats.get,\n        has: formats.has,\n        register: formats.register,\n        unregister: formats.unregister,\n        apply: function (name, vars, node) {\n          applyFormat$1(editor, name, vars, node);\n        },\n        remove: function (name, vars, node, similar) {\n          removeFormat$1(editor, name, vars, node, similar);\n        },\n        toggle: function (name, vars, node) {\n          toggleFormat(editor, name, vars, node);\n        },\n        match: function (name, vars, node) {\n          return matchFormat(editor, name, vars, node);\n        },\n        closest: function (names) {\n          return closestFormat(editor, names);\n        },\n        matchAll: function (names, vars) {\n          return matchAllFormats(editor, names, vars);\n        },\n        matchNode: function (node, names, vars, similar) {\n          return matchNodeFormat(editor, node, names, vars, similar);\n        },\n        canApply: function (name) {\n          return canApplyFormat(editor, name);\n        },\n        formatChanged: function (formats, callback, similar) {\n          return formatChanged(editor, formatChangeState, formats, callback, similar);\n        },\n        getCssText: curry(getCssText, editor)\n      };\n    };\n\n    var registerEvents$1 = function (editor, undoManager, locks) {\n      var isFirstTypedCharacter = Cell(false);\n      var addNonTypingUndoLevel = function (e) {\n        setTyping(undoManager, false, locks);\n        undoManager.add({}, e);\n      };\n      editor.on('init', function () {\n        undoManager.add();\n      });\n      editor.on('BeforeExecCommand', function (e) {\n        var cmd = e.command.toLowerCase();\n        if (cmd !== 'undo' && cmd !== 'redo' && cmd !== 'mcerepaint') {\n          endTyping(undoManager, locks);\n          undoManager.beforeChange();\n        }\n      });\n      editor.on('ExecCommand', function (e) {\n        var cmd = e.command.toLowerCase();\n        if (cmd !== 'undo' && cmd !== 'redo' && cmd !== 'mcerepaint') {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      editor.on('ObjectResizeStart cut', function () {\n        undoManager.beforeChange();\n      });\n      editor.on('SaveContent ObjectResized blur', addNonTypingUndoLevel);\n      editor.on('dragend', addNonTypingUndoLevel);\n      editor.on('keyup', function (e) {\n        var keyCode = e.keyCode;\n        if (e.isDefaultPrevented()) {\n          return;\n        }\n        if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45 || e.ctrlKey) {\n          addNonTypingUndoLevel();\n          editor.nodeChanged();\n        }\n        if (keyCode === 46 || keyCode === 8) {\n          editor.nodeChanged();\n        }\n        if (isFirstTypedCharacter.get() && undoManager.typing && isEq$4(createFromEditor(editor), undoManager.data[0]) === false) {\n          if (editor.isDirty() === false) {\n            editor.setDirty(true);\n            editor.fire('change', {\n              level: undoManager.data[0],\n              lastLevel: null\n            });\n          }\n          editor.fire('TypingUndo');\n          isFirstTypedCharacter.set(false);\n          editor.nodeChanged();\n        }\n      });\n      editor.on('keydown', function (e) {\n        var keyCode = e.keyCode;\n        if (e.isDefaultPrevented()) {\n          return;\n        }\n        if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45) {\n          if (undoManager.typing) {\n            addNonTypingUndoLevel(e);\n          }\n          return;\n        }\n        var modKey = e.ctrlKey && !e.altKey || e.metaKey;\n        if ((keyCode < 16 || keyCode > 20) && keyCode !== 224 && keyCode !== 91 && !undoManager.typing && !modKey) {\n          undoManager.beforeChange();\n          setTyping(undoManager, true, locks);\n          undoManager.add({}, e);\n          isFirstTypedCharacter.set(true);\n        }\n      });\n      editor.on('mousedown', function (e) {\n        if (undoManager.typing) {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      var isInsertReplacementText = function (event) {\n        return event.inputType === 'insertReplacementText';\n      };\n      var isInsertTextDataNull = function (event) {\n        return event.inputType === 'insertText' && event.data === null;\n      };\n      var isInsertFromPasteOrDrop = function (event) {\n        return event.inputType === 'insertFromPaste' || event.inputType === 'insertFromDrop';\n      };\n      editor.on('input', function (e) {\n        if (e.inputType && (isInsertReplacementText(e) || isInsertTextDataNull(e) || isInsertFromPasteOrDrop(e))) {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      editor.on('AddUndo Undo Redo ClearUndos', function (e) {\n        if (!e.isDefaultPrevented()) {\n          editor.nodeChanged();\n        }\n      });\n    };\n    var addKeyboardShortcuts = function (editor) {\n      editor.addShortcut('meta+z', '', 'Undo');\n      editor.addShortcut('meta+y,meta+shift+z', '', 'Redo');\n    };\n\n    var UndoManager = function (editor) {\n      var beforeBookmark = Cell(Optional.none());\n      var locks = Cell(0);\n      var index = Cell(0);\n      var undoManager = {\n        data: [],\n        typing: false,\n        beforeChange: function () {\n          beforeChange$1(editor, locks, beforeBookmark);\n        },\n        add: function (level, event) {\n          return addUndoLevel$1(editor, undoManager, index, locks, beforeBookmark, level, event);\n        },\n        undo: function () {\n          return undo$1(editor, undoManager, locks, index);\n        },\n        redo: function () {\n          return redo$1(editor, index, undoManager.data);\n        },\n        clear: function () {\n          clear$1(editor, undoManager, index);\n        },\n        reset: function () {\n          reset$1(editor, undoManager);\n        },\n        hasUndo: function () {\n          return hasUndo$1(editor, undoManager, index);\n        },\n        hasRedo: function () {\n          return hasRedo$1(editor, undoManager, index);\n        },\n        transact: function (callback) {\n          return transact$1(editor, undoManager, locks, callback);\n        },\n        ignore: function (callback) {\n          ignore$1(editor, locks, callback);\n        },\n        extra: function (callback1, callback2) {\n          extra$1(editor, undoManager, index, callback1, callback2);\n        }\n      };\n      if (!isRtc(editor)) {\n        registerEvents$1(editor, undoManager, locks);\n      }\n      addKeyboardShortcuts(editor);\n      return undoManager;\n    };\n\n    var nonTypingKeycodes = [\n      9,\n      27,\n      VK.HOME,\n      VK.END,\n      19,\n      20,\n      44,\n      144,\n      145,\n      33,\n      34,\n      45,\n      16,\n      17,\n      18,\n      91,\n      92,\n      93,\n      VK.DOWN,\n      VK.UP,\n      VK.LEFT,\n      VK.RIGHT\n    ].concat(Env.browser.isFirefox() ? [224] : []);\n    var placeholderAttr = 'data-mce-placeholder';\n    var isKeyboardEvent = function (e) {\n      return e.type === 'keydown' || e.type === 'keyup';\n    };\n    var isDeleteEvent = function (e) {\n      var keyCode = e.keyCode;\n      return keyCode === VK.BACKSPACE || keyCode === VK.DELETE;\n    };\n    var isNonTypingKeyboardEvent = function (e) {\n      if (isKeyboardEvent(e)) {\n        var keyCode = e.keyCode;\n        return !isDeleteEvent(e) && (VK.metaKeyPressed(e) || e.altKey || keyCode >= 112 && keyCode <= 123 || contains(nonTypingKeycodes, keyCode));\n      } else {\n        return false;\n      }\n    };\n    var isTypingKeyboardEvent = function (e) {\n      return isKeyboardEvent(e) && !(isDeleteEvent(e) || e.type === 'keyup' && e.keyCode === 229);\n    };\n    var isVisuallyEmpty = function (dom, rootElm, forcedRootBlock) {\n      if (isEmpty(SugarElement.fromDom(rootElm), false)) {\n        var isForcedRootBlockFalse = forcedRootBlock === '';\n        var firstElement = rootElm.firstElementChild;\n        if (!firstElement) {\n          return true;\n        } else if (dom.getStyle(rootElm.firstElementChild, 'padding-left') || dom.getStyle(rootElm.firstElementChild, 'padding-right')) {\n          return false;\n        } else {\n          return isForcedRootBlockFalse ? !dom.isBlock(firstElement) : forcedRootBlock === firstElement.nodeName.toLowerCase();\n        }\n      } else {\n        return false;\n      }\n    };\n    var setup$7 = function (editor) {\n      var dom = editor.dom;\n      var rootBlock = getForcedRootBlock(editor);\n      var placeholder = getPlaceholder(editor);\n      var updatePlaceholder = function (e, initial) {\n        if (isNonTypingKeyboardEvent(e)) {\n          return;\n        }\n        var body = editor.getBody();\n        var showPlaceholder = isTypingKeyboardEvent(e) ? false : isVisuallyEmpty(dom, body, rootBlock);\n        var isPlaceholderShown = dom.getAttrib(body, placeholderAttr) !== '';\n        if (isPlaceholderShown !== showPlaceholder || initial) {\n          dom.setAttrib(body, placeholderAttr, showPlaceholder ? placeholder : null);\n          dom.setAttrib(body, 'aria-placeholder', showPlaceholder ? placeholder : null);\n          firePlaceholderToggle(editor, showPlaceholder);\n          editor.on(showPlaceholder ? 'keydown' : 'keyup', updatePlaceholder);\n          editor.off(showPlaceholder ? 'keyup' : 'keydown', updatePlaceholder);\n        }\n      };\n      if (placeholder) {\n        editor.on('init', function (e) {\n          updatePlaceholder(e, true);\n          editor.on('change SetContent ExecCommand', updatePlaceholder);\n          editor.on('paste', function (e) {\n            return Delay.setEditorTimeout(editor, function () {\n              return updatePlaceholder(e);\n            });\n          });\n        });\n      }\n    };\n\n    var strongRtl = /[\\u0591-\\u07FF\\uFB1D-\\uFDFF\\uFE70-\\uFEFC]/;\n    var hasStrongRtl = function (text) {\n      return strongRtl.test(text);\n    };\n\n    var isInlineTarget = function (editor, elm) {\n      return is$1(SugarElement.fromDom(elm), getInlineBoundarySelector(editor));\n    };\n    var isRtl$1 = function (element) {\n      return DOMUtils.DOM.getStyle(element, 'direction', true) === 'rtl' || hasStrongRtl(element.textContent);\n    };\n    var findInlineParents = function (isInlineTarget, rootNode, pos) {\n      return filter(DOMUtils.DOM.getParents(pos.container(), '*', rootNode), isInlineTarget);\n    };\n    var findRootInline = function (isInlineTarget, rootNode, pos) {\n      var parents = findInlineParents(isInlineTarget, rootNode, pos);\n      return Optional.from(parents[parents.length - 1]);\n    };\n    var hasSameParentBlock = function (rootNode, node1, node2) {\n      var block1 = getParentBlock(node1, rootNode);\n      var block2 = getParentBlock(node2, rootNode);\n      return block1 && block1 === block2;\n    };\n    var isAtZwsp = function (pos) {\n      return isBeforeInline(pos) || isAfterInline(pos);\n    };\n    var normalizePosition = function (forward, pos) {\n      if (!pos) {\n        return pos;\n      }\n      var container = pos.container(), offset = pos.offset();\n      if (forward) {\n        if (isCaretContainerInline(container)) {\n          if (isText$1(container.nextSibling)) {\n            return CaretPosition(container.nextSibling, 0);\n          } else {\n            return CaretPosition.after(container);\n          }\n        } else {\n          return isBeforeInline(pos) ? CaretPosition(container, offset + 1) : pos;\n        }\n      } else {\n        if (isCaretContainerInline(container)) {\n          if (isText$1(container.previousSibling)) {\n            return CaretPosition(container.previousSibling, container.previousSibling.data.length);\n          } else {\n            return CaretPosition.before(container);\n          }\n        } else {\n          return isAfterInline(pos) ? CaretPosition(container, offset - 1) : pos;\n        }\n      }\n    };\n    var normalizeForwards = curry(normalizePosition, true);\n    var normalizeBackwards = curry(normalizePosition, false);\n\n    var isBeforeRoot = function (rootNode) {\n      return function (elm) {\n        return eq$2(rootNode, SugarElement.fromDom(elm.dom.parentNode));\n      };\n    };\n    var getParentBlock$1 = function (rootNode, elm) {\n      return contains$2(rootNode, elm) ? closest(elm, function (element) {\n        return isTextBlock(element) || isListItem(element);\n      }, isBeforeRoot(rootNode)) : Optional.none();\n    };\n    var placeCaretInEmptyBody = function (editor) {\n      var body = editor.getBody();\n      var node = body.firstChild && editor.dom.isBlock(body.firstChild) ? body.firstChild : body;\n      editor.selection.setCursorLocation(node, 0);\n    };\n    var paddEmptyBody = function (editor) {\n      if (editor.dom.isEmpty(editor.getBody())) {\n        editor.setContent('');\n        placeCaretInEmptyBody(editor);\n      }\n    };\n    var willDeleteLastPositionInElement = function (forward, fromPos, elm) {\n      return lift2(firstPositionIn(elm), lastPositionIn(elm), function (firstPos, lastPos) {\n        var normalizedFirstPos = normalizePosition(true, firstPos);\n        var normalizedLastPos = normalizePosition(false, lastPos);\n        var normalizedFromPos = normalizePosition(false, fromPos);\n        if (forward) {\n          return nextPosition(elm, normalizedFromPos).exists(function (nextPos) {\n            return nextPos.isEqual(normalizedLastPos) && fromPos.isEqual(normalizedFirstPos);\n          });\n        } else {\n          return prevPosition(elm, normalizedFromPos).exists(function (prevPos) {\n            return prevPos.isEqual(normalizedFirstPos) && fromPos.isEqual(normalizedLastPos);\n          });\n        }\n      }).getOr(true);\n    };\n\n    var blockPosition = function (block, position) {\n      return {\n        block: block,\n        position: position\n      };\n    };\n    var blockBoundary = function (from, to) {\n      return {\n        from: from,\n        to: to\n      };\n    };\n    var getBlockPosition = function (rootNode, pos) {\n      var rootElm = SugarElement.fromDom(rootNode);\n      var containerElm = SugarElement.fromDom(pos.container());\n      return getParentBlock$1(rootElm, containerElm).map(function (block) {\n        return blockPosition(block, pos);\n      });\n    };\n    var isDifferentBlocks = function (blockBoundary) {\n      return eq$2(blockBoundary.from.block, blockBoundary.to.block) === false;\n    };\n    var hasSameParent = function (blockBoundary) {\n      return parent(blockBoundary.from.block).bind(function (parent1) {\n        return parent(blockBoundary.to.block).filter(function (parent2) {\n          return eq$2(parent1, parent2);\n        });\n      }).isSome();\n    };\n    var isEditable = function (blockBoundary) {\n      return isContentEditableFalse(blockBoundary.from.block.dom) === false && isContentEditableFalse(blockBoundary.to.block.dom) === false;\n    };\n    var skipLastBr = function (rootNode, forward, blockPosition) {\n      if (isBr(blockPosition.position.getNode()) && isEmpty(blockPosition.block) === false) {\n        return positionIn(false, blockPosition.block.dom).bind(function (lastPositionInBlock) {\n          if (lastPositionInBlock.isEqual(blockPosition.position)) {\n            return fromPosition(forward, rootNode, lastPositionInBlock).bind(function (to) {\n              return getBlockPosition(rootNode, to);\n            });\n          } else {\n            return Optional.some(blockPosition);\n          }\n        }).getOr(blockPosition);\n      } else {\n        return blockPosition;\n      }\n    };\n    var readFromRange = function (rootNode, forward, rng) {\n      var fromBlockPos = getBlockPosition(rootNode, CaretPosition.fromRangeStart(rng));\n      var toBlockPos = fromBlockPos.bind(function (blockPos) {\n        return fromPosition(forward, rootNode, blockPos.position).bind(function (to) {\n          return getBlockPosition(rootNode, to).map(function (blockPos) {\n            return skipLastBr(rootNode, forward, blockPos);\n          });\n        });\n      });\n      return lift2(fromBlockPos, toBlockPos, blockBoundary).filter(function (blockBoundary) {\n        return isDifferentBlocks(blockBoundary) && hasSameParent(blockBoundary) && isEditable(blockBoundary);\n      });\n    };\n    var read$3 = function (rootNode, forward, rng) {\n      return rng.collapsed ? readFromRange(rootNode, forward, rng) : Optional.none();\n    };\n\n    var getChildrenUntilBlockBoundary = function (block) {\n      var children$1 = children(block);\n      return findIndex(children$1, isBlock).fold(function () {\n        return children$1;\n      }, function (index) {\n        return children$1.slice(0, index);\n      });\n    };\n    var extractChildren = function (block) {\n      var children = getChildrenUntilBlockBoundary(block);\n      each(children, remove);\n      return children;\n    };\n    var removeEmptyRoot = function (rootNode, block) {\n      var parents = parentsAndSelf(block, rootNode);\n      return find(parents.reverse(), function (element) {\n        return isEmpty(element);\n      }).each(remove);\n    };\n    var isEmptyBefore = function (el) {\n      return filter(prevSiblings(el), function (el) {\n        return !isEmpty(el);\n      }).length === 0;\n    };\n    var nestedBlockMerge = function (rootNode, fromBlock, toBlock, insertionPoint) {\n      if (isEmpty(toBlock)) {\n        fillWithPaddingBr(toBlock);\n        return firstPositionIn(toBlock.dom);\n      }\n      if (isEmptyBefore(insertionPoint) && isEmpty(fromBlock)) {\n        before(insertionPoint, SugarElement.fromTag('br'));\n      }\n      var position = prevPosition(toBlock.dom, CaretPosition.before(insertionPoint.dom));\n      each(extractChildren(fromBlock), function (child) {\n        before(insertionPoint, child);\n      });\n      removeEmptyRoot(rootNode, fromBlock);\n      return position;\n    };\n    var sidelongBlockMerge = function (rootNode, fromBlock, toBlock) {\n      if (isEmpty(toBlock)) {\n        remove(toBlock);\n        if (isEmpty(fromBlock)) {\n          fillWithPaddingBr(fromBlock);\n        }\n        return firstPositionIn(fromBlock.dom);\n      }\n      var position = lastPositionIn(toBlock.dom);\n      each(extractChildren(fromBlock), function (child) {\n        append(toBlock, child);\n      });\n      removeEmptyRoot(rootNode, fromBlock);\n      return position;\n    };\n    var findInsertionPoint = function (toBlock, block) {\n      var parentsAndSelf$1 = parentsAndSelf(block, toBlock);\n      return Optional.from(parentsAndSelf$1[parentsAndSelf$1.length - 1]);\n    };\n    var getInsertionPoint = function (fromBlock, toBlock) {\n      return contains$2(toBlock, fromBlock) ? findInsertionPoint(toBlock, fromBlock) : Optional.none();\n    };\n    var trimBr = function (first, block) {\n      positionIn(first, block.dom).map(function (position) {\n        return position.getNode();\n      }).map(SugarElement.fromDom).filter(isBr$1).each(remove);\n    };\n    var mergeBlockInto = function (rootNode, fromBlock, toBlock) {\n      trimBr(true, fromBlock);\n      trimBr(false, toBlock);\n      return getInsertionPoint(fromBlock, toBlock).fold(curry(sidelongBlockMerge, rootNode, fromBlock, toBlock), curry(nestedBlockMerge, rootNode, fromBlock, toBlock));\n    };\n    var mergeBlocks = function (rootNode, forward, block1, block2) {\n      return forward ? mergeBlockInto(rootNode, block2, block1) : mergeBlockInto(rootNode, block1, block2);\n    };\n\n    var backspaceDelete$1 = function (editor, forward) {\n      var rootNode = SugarElement.fromDom(editor.getBody());\n      var position = read$3(rootNode.dom, forward, editor.selection.getRng()).bind(function (blockBoundary) {\n        return mergeBlocks(rootNode, forward, blockBoundary.from.block, blockBoundary.to.block);\n      });\n      position.each(function (pos) {\n        editor.selection.setRng(pos.toRange());\n      });\n      return position.isSome();\n    };\n\n    var deleteRangeMergeBlocks = function (rootNode, selection) {\n      var rng = selection.getRng();\n      return lift2(getParentBlock$1(rootNode, SugarElement.fromDom(rng.startContainer)), getParentBlock$1(rootNode, SugarElement.fromDom(rng.endContainer)), function (block1, block2) {\n        if (eq$2(block1, block2) === false) {\n          rng.deleteContents();\n          mergeBlocks(rootNode, true, block1, block2).each(function (pos) {\n            selection.setRng(pos.toRange());\n          });\n          return true;\n        } else {\n          return false;\n        }\n      }).getOr(false);\n    };\n    var isRawNodeInTable = function (root, rawNode) {\n      var node = SugarElement.fromDom(rawNode);\n      var isRoot = curry(eq$2, root);\n      return ancestor(node, isTableCell$1, isRoot).isSome();\n    };\n    var isSelectionInTable = function (root, rng) {\n      return isRawNodeInTable(root, rng.startContainer) || isRawNodeInTable(root, rng.endContainer);\n    };\n    var isEverythingSelected = function (root, rng) {\n      var noPrevious = prevPosition(root.dom, CaretPosition.fromRangeStart(rng)).isNone();\n      var noNext = nextPosition(root.dom, CaretPosition.fromRangeEnd(rng)).isNone();\n      return !isSelectionInTable(root, rng) && noPrevious && noNext;\n    };\n    var emptyEditor = function (editor) {\n      editor.setContent('');\n      editor.selection.setCursorLocation();\n      return true;\n    };\n    var deleteRange$1 = function (editor) {\n      var rootNode = SugarElement.fromDom(editor.getBody());\n      var rng = editor.selection.getRng();\n      return isEverythingSelected(rootNode, rng) ? emptyEditor(editor) : deleteRangeMergeBlocks(rootNode, editor.selection);\n    };\n    var backspaceDelete$2 = function (editor, _forward) {\n      return editor.selection.isCollapsed() ? false : deleteRange$1(editor);\n    };\n\n    var isContentEditableTrue$2 = isContentEditableTrue;\n    var isContentEditableFalse$7 = isContentEditableFalse;\n    var showCaret = function (direction, editor, node, before, scrollIntoView) {\n      return Optional.from(editor._selectionOverrides.showCaret(direction, node, before, scrollIntoView));\n    };\n    var getNodeRange = function (node) {\n      var rng = node.ownerDocument.createRange();\n      rng.selectNode(node);\n      return rng;\n    };\n    var selectNode = function (editor, node) {\n      var e = editor.fire('BeforeObjectSelected', { target: node });\n      if (e.isDefaultPrevented()) {\n        return Optional.none();\n      }\n      return Optional.some(getNodeRange(node));\n    };\n    var renderCaretAtRange = function (editor, range, scrollIntoView) {\n      var normalizedRange = normalizeRange(1, editor.getBody(), range);\n      var caretPosition = CaretPosition.fromRangeStart(normalizedRange);\n      var caretPositionNode = caretPosition.getNode();\n      if (isInlineFakeCaretTarget(caretPositionNode)) {\n        return showCaret(1, editor, caretPositionNode, !caretPosition.isAtEnd(), false);\n      }\n      var caretPositionBeforeNode = caretPosition.getNode(true);\n      if (isInlineFakeCaretTarget(caretPositionBeforeNode)) {\n        return showCaret(1, editor, caretPositionBeforeNode, false, false);\n      }\n      var ceRoot = editor.dom.getParent(caretPosition.getNode(), function (node) {\n        return isContentEditableFalse$7(node) || isContentEditableTrue$2(node);\n      });\n      if (isInlineFakeCaretTarget(ceRoot)) {\n        return showCaret(1, editor, ceRoot, false, scrollIntoView);\n      }\n      return Optional.none();\n    };\n    var renderRangeCaret = function (editor, range, scrollIntoView) {\n      return range.collapsed ? renderCaretAtRange(editor, range, scrollIntoView).getOr(range) : range;\n    };\n\n    var isBeforeBoundary = function (pos) {\n      return isBeforeContentEditableFalse(pos) || isBeforeMedia(pos);\n    };\n    var isAfterBoundary = function (pos) {\n      return isAfterContentEditableFalse(pos) || isAfterMedia(pos);\n    };\n    var trimEmptyTextNode$1 = function (dom, node) {\n      if (isText$1(node) && node.data.length === 0) {\n        dom.remove(node);\n      }\n    };\n    var deleteContentAndShowCaret = function (editor, range, node, direction, forward, peekCaretPosition) {\n      showCaret(direction, editor, peekCaretPosition.getNode(!forward), forward, true).each(function (caretRange) {\n        if (range.collapsed) {\n          var deleteRange = range.cloneRange();\n          if (forward) {\n            deleteRange.setEnd(caretRange.startContainer, caretRange.startOffset);\n          } else {\n            deleteRange.setStart(caretRange.endContainer, caretRange.endOffset);\n          }\n          deleteRange.deleteContents();\n        } else {\n          range.deleteContents();\n        }\n        editor.selection.setRng(caretRange);\n      });\n      trimEmptyTextNode$1(editor.dom, node);\n      return true;\n    };\n    var deleteBoundaryText = function (editor, forward) {\n      var range = editor.selection.getRng();\n      if (!isText$1(range.commonAncestorContainer)) {\n        return false;\n      }\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var caretWalker = CaretWalker(editor.getBody());\n      var getNextPosFn = curry(getVisualCaretPosition, forward ? caretWalker.next : caretWalker.prev);\n      var isBeforeFn = forward ? isBeforeBoundary : isAfterBoundary;\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      var nextCaretPosition = normalizePosition(forward, getNextPosFn(caretPosition));\n      if (!nextCaretPosition || !isMoveInsideSameBlock(caretPosition, nextCaretPosition)) {\n        return false;\n      } else if (isBeforeFn(nextCaretPosition)) {\n        return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, nextCaretPosition);\n      }\n      var peekCaretPosition = getNextPosFn(nextCaretPosition);\n      if (peekCaretPosition && isBeforeFn(peekCaretPosition)) {\n        if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n          return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, peekCaretPosition);\n        }\n      }\n      return false;\n    };\n    var backspaceDelete$3 = function (editor, forward) {\n      return deleteBoundaryText(editor, forward);\n    };\n\n    var isCompoundElement = function (node) {\n      return isTableCell$1(SugarElement.fromDom(node)) || isListItem(SugarElement.fromDom(node));\n    };\n    var DeleteAction = Adt.generate([\n      { remove: ['element'] },\n      { moveToElement: ['element'] },\n      { moveToPosition: ['position'] }\n    ]);\n    var isAtContentEditableBlockCaret = function (forward, from) {\n      var elm = from.getNode(forward === false);\n      var caretLocation = forward ? 'after' : 'before';\n      return isElement$1(elm) && elm.getAttribute('data-mce-caret') === caretLocation;\n    };\n    var isDeleteFromCefDifferentBlocks = function (root, forward, from, to) {\n      var inSameBlock = function (elm) {\n        return isInline(SugarElement.fromDom(elm)) && !isInSameBlock(from, to, root);\n      };\n      return getRelativeCefElm(!forward, from).fold(function () {\n        return getRelativeCefElm(forward, to).fold(never, inSameBlock);\n      }, inSameBlock);\n    };\n    var deleteEmptyBlockOrMoveToCef = function (root, forward, from, to) {\n      var toCefElm = to.getNode(forward === false);\n      return getParentBlock$1(SugarElement.fromDom(root), SugarElement.fromDom(from.getNode())).map(function (blockElm) {\n        return isEmpty(blockElm) ? DeleteAction.remove(blockElm.dom) : DeleteAction.moveToElement(toCefElm);\n      }).orThunk(function () {\n        return Optional.some(DeleteAction.moveToElement(toCefElm));\n      });\n    };\n    var findCefPosition = function (root, forward, from) {\n      return fromPosition(forward, root, from).bind(function (to) {\n        if (isCompoundElement(to.getNode())) {\n          return Optional.none();\n        } else if (isDeleteFromCefDifferentBlocks(root, forward, from, to)) {\n          return Optional.none();\n        } else if (forward && isContentEditableFalse(to.getNode())) {\n          return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n        } else if (forward === false && isContentEditableFalse(to.getNode(true))) {\n          return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n        } else if (forward && isAfterContentEditableFalse(from)) {\n          return Optional.some(DeleteAction.moveToPosition(to));\n        } else if (forward === false && isBeforeContentEditableFalse(from)) {\n          return Optional.some(DeleteAction.moveToPosition(to));\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var getContentEditableBlockAction = function (forward, elm) {\n      if (forward && isContentEditableFalse(elm.nextSibling)) {\n        return Optional.some(DeleteAction.moveToElement(elm.nextSibling));\n      } else if (forward === false && isContentEditableFalse(elm.previousSibling)) {\n        return Optional.some(DeleteAction.moveToElement(elm.previousSibling));\n      } else {\n        return Optional.none();\n      }\n    };\n    var skipMoveToActionFromInlineCefToContent = function (root, from, deleteAction) {\n      return deleteAction.fold(function (elm) {\n        return Optional.some(DeleteAction.remove(elm));\n      }, function (elm) {\n        return Optional.some(DeleteAction.moveToElement(elm));\n      }, function (to) {\n        if (isInSameBlock(from, to, root)) {\n          return Optional.none();\n        } else {\n          return Optional.some(DeleteAction.moveToPosition(to));\n        }\n      });\n    };\n    var getContentEditableAction = function (root, forward, from) {\n      if (isAtContentEditableBlockCaret(forward, from)) {\n        return getContentEditableBlockAction(forward, from.getNode(forward === false)).fold(function () {\n          return findCefPosition(root, forward, from);\n        }, Optional.some);\n      } else {\n        return findCefPosition(root, forward, from).bind(function (deleteAction) {\n          return skipMoveToActionFromInlineCefToContent(root, from, deleteAction);\n        });\n      }\n    };\n    var read$4 = function (root, forward, rng) {\n      var normalizedRange = normalizeRange(forward ? 1 : -1, root, rng);\n      var from = CaretPosition.fromRangeStart(normalizedRange);\n      var rootElement = SugarElement.fromDom(root);\n      if (forward === false && isAfterContentEditableFalse(from)) {\n        return Optional.some(DeleteAction.remove(from.getNode(true)));\n      } else if (forward && isBeforeContentEditableFalse(from)) {\n        return Optional.some(DeleteAction.remove(from.getNode()));\n      } else if (forward === false && isBeforeContentEditableFalse(from) && isAfterBr(rootElement, from)) {\n        return findPreviousBr(rootElement, from).map(function (br) {\n          return DeleteAction.remove(br.getNode());\n        });\n      } else if (forward && isAfterContentEditableFalse(from) && isBeforeBr(rootElement, from)) {\n        return findNextBr(rootElement, from).map(function (br) {\n          return DeleteAction.remove(br.getNode());\n        });\n      } else {\n        return getContentEditableAction(root, forward, from);\n      }\n    };\n\n    var deleteElement$1 = function (editor, forward) {\n      return function (element) {\n        editor._selectionOverrides.hideFakeCaret();\n        deleteElement(editor, forward, SugarElement.fromDom(element));\n        return true;\n      };\n    };\n    var moveToElement = function (editor, forward) {\n      return function (element) {\n        var pos = forward ? CaretPosition.before(element) : CaretPosition.after(element);\n        editor.selection.setRng(pos.toRange());\n        return true;\n      };\n    };\n    var moveToPosition = function (editor) {\n      return function (pos) {\n        editor.selection.setRng(pos.toRange());\n        return true;\n      };\n    };\n    var getAncestorCe = function (editor, node) {\n      return Optional.from(getContentEditableRoot(editor.getBody(), node));\n    };\n    var backspaceDeleteCaret = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      return getAncestorCe(editor, selectedNode).filter(isContentEditableFalse).fold(function () {\n        return read$4(editor.getBody(), forward, editor.selection.getRng()).exists(function (deleteAction) {\n          return deleteAction.fold(deleteElement$1(editor, forward), moveToElement(editor, forward), moveToPosition(editor));\n        });\n      }, always);\n    };\n    var deleteOffscreenSelection = function (rootElement) {\n      each(descendants$1(rootElement, '.mce-offscreen-selection'), remove);\n    };\n    var backspaceDeleteRange = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      if (isContentEditableFalse(selectedNode)) {\n        var hasCefAncestor = getAncestorCe(editor, selectedNode.parentNode).filter(isContentEditableFalse);\n        return hasCefAncestor.fold(function () {\n          deleteOffscreenSelection(SugarElement.fromDom(editor.getBody()));\n          deleteElement(editor, forward, SugarElement.fromDom(editor.selection.getNode()));\n          paddEmptyBody(editor);\n          return true;\n        }, always);\n      }\n      return false;\n    };\n    var paddEmptyElement = function (editor) {\n      var dom = editor.dom, selection = editor.selection;\n      var ceRoot = getContentEditableRoot(editor.getBody(), selection.getNode());\n      if (isContentEditableTrue(ceRoot) && dom.isBlock(ceRoot) && dom.isEmpty(ceRoot)) {\n        var br = dom.create('br', { 'data-mce-bogus': '1' });\n        dom.setHTML(ceRoot, '');\n        ceRoot.appendChild(br);\n        selection.setRng(CaretPosition.before(br).toRange());\n      }\n      return true;\n    };\n    var backspaceDelete$4 = function (editor, forward) {\n      if (editor.selection.isCollapsed()) {\n        return backspaceDeleteCaret(editor, forward);\n      } else {\n        return backspaceDeleteRange(editor, forward);\n      }\n    };\n\n    var deleteCaret$1 = function (editor, forward) {\n      var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return fromPosition(forward, editor.getBody(), fromPos).filter(function (pos) {\n        return forward ? isBeforeImageBlock(pos) : isAfterImageBlock(pos);\n      }).bind(function (pos) {\n        return Optional.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, pos));\n      }).exists(function (elm) {\n        editor.selection.select(elm);\n        return true;\n      });\n    };\n    var backspaceDelete$5 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret$1(editor, forward) : false;\n    };\n\n    var isText$8 = isText$1;\n    var startsWithCaretContainer$1 = function (node) {\n      return isText$8(node) && node.data[0] === ZWSP;\n    };\n    var endsWithCaretContainer$1 = function (node) {\n      return isText$8(node) && node.data[node.data.length - 1] === ZWSP;\n    };\n    var createZwsp = function (node) {\n      return node.ownerDocument.createTextNode(ZWSP);\n    };\n    var insertBefore$1 = function (node) {\n      if (isText$8(node.previousSibling)) {\n        if (endsWithCaretContainer$1(node.previousSibling)) {\n          return node.previousSibling;\n        } else {\n          node.previousSibling.appendData(ZWSP);\n          return node.previousSibling;\n        }\n      } else if (isText$8(node)) {\n        if (startsWithCaretContainer$1(node)) {\n          return node;\n        } else {\n          node.insertData(0, ZWSP);\n          return node;\n        }\n      } else {\n        var newNode = createZwsp(node);\n        node.parentNode.insertBefore(newNode, node);\n        return newNode;\n      }\n    };\n    var insertAfter$1 = function (node) {\n      if (isText$8(node.nextSibling)) {\n        if (startsWithCaretContainer$1(node.nextSibling)) {\n          return node.nextSibling;\n        } else {\n          node.nextSibling.insertData(0, ZWSP);\n          return node.nextSibling;\n        }\n      } else if (isText$8(node)) {\n        if (endsWithCaretContainer$1(node)) {\n          return node;\n        } else {\n          node.appendData(ZWSP);\n          return node;\n        }\n      } else {\n        var newNode = createZwsp(node);\n        if (node.nextSibling) {\n          node.parentNode.insertBefore(newNode, node.nextSibling);\n        } else {\n          node.parentNode.appendChild(newNode);\n        }\n        return newNode;\n      }\n    };\n    var insertInline$1 = function (before, node) {\n      return before ? insertBefore$1(node) : insertAfter$1(node);\n    };\n    var insertInlineBefore = curry(insertInline$1, true);\n    var insertInlineAfter = curry(insertInline$1, false);\n\n    var insertInlinePos = function (pos, before) {\n      if (isText$1(pos.container())) {\n        return insertInline$1(before, pos.container());\n      } else {\n        return insertInline$1(before, pos.getNode());\n      }\n    };\n    var isPosCaretContainer = function (pos, caret) {\n      var caretNode = caret.get();\n      return caretNode && pos.container() === caretNode && isCaretContainerInline(caretNode);\n    };\n    var renderCaret = function (caret, location) {\n      return location.fold(function (element) {\n        remove$5(caret.get());\n        var text = insertInlineBefore(element);\n        caret.set(text);\n        return Optional.some(CaretPosition(text, text.length - 1));\n      }, function (element) {\n        return firstPositionIn(element).map(function (pos) {\n          if (!isPosCaretContainer(pos, caret)) {\n            remove$5(caret.get());\n            var text = insertInlinePos(pos, true);\n            caret.set(text);\n            return CaretPosition(text, 1);\n          } else {\n            return CaretPosition(caret.get(), 1);\n          }\n        });\n      }, function (element) {\n        return lastPositionIn(element).map(function (pos) {\n          if (!isPosCaretContainer(pos, caret)) {\n            remove$5(caret.get());\n            var text = insertInlinePos(pos, false);\n            caret.set(text);\n            return CaretPosition(text, text.length - 1);\n          } else {\n            return CaretPosition(caret.get(), caret.get().length - 1);\n          }\n        });\n      }, function (element) {\n        remove$5(caret.get());\n        var text = insertInlineAfter(element);\n        caret.set(text);\n        return Optional.some(CaretPosition(text, 1));\n      });\n    };\n\n    var evaluateUntil = function (fns, args) {\n      for (var i = 0; i < fns.length; i++) {\n        var result = fns[i].apply(null, args);\n        if (result.isSome()) {\n          return result;\n        }\n      }\n      return Optional.none();\n    };\n\n    var Location = Adt.generate([\n      { before: ['element'] },\n      { start: ['element'] },\n      { end: ['element'] },\n      { after: ['element'] }\n    ]);\n    var rescope = function (rootNode, node) {\n      var parentBlock = getParentBlock(node, rootNode);\n      return parentBlock ? parentBlock : rootNode;\n    };\n    var before$4 = function (isInlineTarget, rootNode, pos) {\n      var nPos = normalizeForwards(pos);\n      var scope = rescope(rootNode, nPos.container());\n      return findRootInline(isInlineTarget, scope, nPos).fold(function () {\n        return nextPosition(scope, nPos).bind(curry(findRootInline, isInlineTarget, scope)).map(function (inline) {\n          return Location.before(inline);\n        });\n      }, Optional.none);\n    };\n    var isNotInsideFormatCaretContainer = function (rootNode, elm) {\n      return getParentCaretContainer(rootNode, elm) === null;\n    };\n    var findInsideRootInline = function (isInlineTarget, rootNode, pos) {\n      return findRootInline(isInlineTarget, rootNode, pos).filter(curry(isNotInsideFormatCaretContainer, rootNode));\n    };\n    var start = function (isInlineTarget, rootNode, pos) {\n      var nPos = normalizeBackwards(pos);\n      return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n        var prevPos = prevPosition(inline, nPos);\n        return prevPos.isNone() ? Optional.some(Location.start(inline)) : Optional.none();\n      });\n    };\n    var end = function (isInlineTarget, rootNode, pos) {\n      var nPos = normalizeForwards(pos);\n      return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n        var nextPos = nextPosition(inline, nPos);\n        return nextPos.isNone() ? Optional.some(Location.end(inline)) : Optional.none();\n      });\n    };\n    var after$3 = function (isInlineTarget, rootNode, pos) {\n      var nPos = normalizeBackwards(pos);\n      var scope = rescope(rootNode, nPos.container());\n      return findRootInline(isInlineTarget, scope, nPos).fold(function () {\n        return prevPosition(scope, nPos).bind(curry(findRootInline, isInlineTarget, scope)).map(function (inline) {\n          return Location.after(inline);\n        });\n      }, Optional.none);\n    };\n    var isValidLocation = function (location) {\n      return isRtl$1(getElement(location)) === false;\n    };\n    var readLocation = function (isInlineTarget, rootNode, pos) {\n      var location = evaluateUntil([\n        before$4,\n        start,\n        end,\n        after$3\n      ], [\n        isInlineTarget,\n        rootNode,\n        pos\n      ]);\n      return location.filter(isValidLocation);\n    };\n    var getElement = function (location) {\n      return location.fold(identity, identity, identity, identity);\n    };\n    var getName = function (location) {\n      return location.fold(constant('before'), constant('start'), constant('end'), constant('after'));\n    };\n    var outside = function (location) {\n      return location.fold(Location.before, Location.before, Location.after, Location.after);\n    };\n    var inside = function (location) {\n      return location.fold(Location.start, Location.start, Location.end, Location.end);\n    };\n    var isEq$5 = function (location1, location2) {\n      return getName(location1) === getName(location2) && getElement(location1) === getElement(location2);\n    };\n    var betweenInlines = function (forward, isInlineTarget, rootNode, from, to, location) {\n      return lift2(findRootInline(isInlineTarget, rootNode, from), findRootInline(isInlineTarget, rootNode, to), function (fromInline, toInline) {\n        if (fromInline !== toInline && hasSameParentBlock(rootNode, fromInline, toInline)) {\n          return Location.after(forward ? fromInline : toInline);\n        } else {\n          return location;\n        }\n      }).getOr(location);\n    };\n    var skipNoMovement = function (fromLocation, toLocation) {\n      return fromLocation.fold(always, function (fromLocation) {\n        return !isEq$5(fromLocation, toLocation);\n      });\n    };\n    var findLocationTraverse = function (forward, isInlineTarget, rootNode, fromLocation, pos) {\n      var from = normalizePosition(forward, pos);\n      var to = fromPosition(forward, rootNode, from).map(curry(normalizePosition, forward));\n      var location = to.fold(function () {\n        return fromLocation.map(outside);\n      }, function (to) {\n        return readLocation(isInlineTarget, rootNode, to).map(curry(betweenInlines, forward, isInlineTarget, rootNode, from, to)).filter(curry(skipNoMovement, fromLocation));\n      });\n      return location.filter(isValidLocation);\n    };\n    var findLocationSimple = function (forward, location) {\n      if (forward) {\n        return location.fold(compose(Optional.some, Location.start), Optional.none, compose(Optional.some, Location.after), Optional.none);\n      } else {\n        return location.fold(Optional.none, compose(Optional.some, Location.before), Optional.none, compose(Optional.some, Location.end));\n      }\n    };\n    var findLocation = function (forward, isInlineTarget, rootNode, pos) {\n      var from = normalizePosition(forward, pos);\n      var fromLocation = readLocation(isInlineTarget, rootNode, from);\n      return readLocation(isInlineTarget, rootNode, from).bind(curry(findLocationSimple, forward)).orThunk(function () {\n        return findLocationTraverse(forward, isInlineTarget, rootNode, fromLocation, pos);\n      });\n    };\n    var prevLocation = curry(findLocation, false);\n    var nextLocation = curry(findLocation, true);\n\n    var hasSelectionModifyApi = function (editor) {\n      return isFunction(editor.selection.getSel().modify);\n    };\n    var moveRel = function (forward, selection, pos) {\n      var delta = forward ? 1 : -1;\n      selection.setRng(CaretPosition(pos.container(), pos.offset() + delta).toRange());\n      selection.getSel().modify('move', forward ? 'forward' : 'backward', 'word');\n      return true;\n    };\n    var moveByWord = function (forward, editor) {\n      var rng = editor.selection.getRng();\n      var pos = forward ? CaretPosition.fromRangeEnd(rng) : CaretPosition.fromRangeStart(rng);\n      if (!hasSelectionModifyApi(editor)) {\n        return false;\n      } else if (forward && isBeforeInline(pos)) {\n        return moveRel(true, editor.selection, pos);\n      } else if (!forward && isAfterInline(pos)) {\n        return moveRel(false, editor.selection, pos);\n      } else {\n        return false;\n      }\n    };\n\n    var setCaretPosition = function (editor, pos) {\n      var rng = editor.dom.createRng();\n      rng.setStart(pos.container(), pos.offset());\n      rng.setEnd(pos.container(), pos.offset());\n      editor.selection.setRng(rng);\n    };\n    var setSelected = function (state, elm) {\n      if (state) {\n        elm.setAttribute('data-mce-selected', 'inline-boundary');\n      } else {\n        elm.removeAttribute('data-mce-selected');\n      }\n    };\n    var renderCaretLocation = function (editor, caret, location) {\n      return renderCaret(caret, location).map(function (pos) {\n        setCaretPosition(editor, pos);\n        return location;\n      });\n    };\n    var findLocation$1 = function (editor, caret, forward) {\n      var rootNode = editor.getBody();\n      var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      var location = findLocation(forward, isInlineTarget$1, rootNode, from);\n      return location.bind(function (location) {\n        return renderCaretLocation(editor, caret, location);\n      });\n    };\n    var toggleInlines = function (isInlineTarget, dom, elms) {\n      var inlineBoundaries = map(descendants$1(SugarElement.fromDom(dom.getRoot()), '*[data-mce-selected=\"inline-boundary\"]'), function (e) {\n        return e.dom;\n      });\n      var selectedInlines = filter(inlineBoundaries, isInlineTarget);\n      var targetInlines = filter(elms, isInlineTarget);\n      each(difference(selectedInlines, targetInlines), curry(setSelected, false));\n      each(difference(targetInlines, selectedInlines), curry(setSelected, true));\n    };\n    var safeRemoveCaretContainer = function (editor, caret) {\n      if (editor.selection.isCollapsed() && editor.composing !== true && caret.get()) {\n        var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n        if (CaretPosition.isTextPosition(pos) && isAtZwsp(pos) === false) {\n          setCaretPosition(editor, removeAndReposition(caret.get(), pos));\n          caret.set(null);\n        }\n      }\n    };\n    var renderInsideInlineCaret = function (isInlineTarget, editor, caret, elms) {\n      if (editor.selection.isCollapsed()) {\n        var inlines = filter(elms, isInlineTarget);\n        each(inlines, function (_inline) {\n          var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n          readLocation(isInlineTarget, editor.getBody(), pos).bind(function (location) {\n            return renderCaretLocation(editor, caret, location);\n          });\n        });\n      }\n    };\n    var move = function (editor, caret, forward) {\n      return isInlineBoundariesEnabled(editor) ? findLocation$1(editor, caret, forward).isSome() : false;\n    };\n    var moveWord = function (forward, editor, _caret) {\n      return isInlineBoundariesEnabled(editor) ? moveByWord(forward, editor) : false;\n    };\n    var setupSelectedState = function (editor) {\n      var caret = Cell(null);\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      editor.on('NodeChange', function (e) {\n        if (isInlineBoundariesEnabled(editor) && !(Env.browser.isIE() && e.initial)) {\n          toggleInlines(isInlineTarget$1, editor.dom, e.parents);\n          safeRemoveCaretContainer(editor, caret);\n          renderInsideInlineCaret(isInlineTarget$1, editor, caret, e.parents);\n        }\n      });\n      return caret;\n    };\n    var moveNextWord = curry(moveWord, true);\n    var movePrevWord = curry(moveWord, false);\n\n    var rangeFromPositions = function (from, to) {\n      var range = document.createRange();\n      range.setStart(from.container(), from.offset());\n      range.setEnd(to.container(), to.offset());\n      return range;\n    };\n    var hasOnlyTwoOrLessPositionsLeft = function (elm) {\n      return lift2(firstPositionIn(elm), lastPositionIn(elm), function (firstPos, lastPos) {\n        var normalizedFirstPos = normalizePosition(true, firstPos);\n        var normalizedLastPos = normalizePosition(false, lastPos);\n        return nextPosition(elm, normalizedFirstPos).forall(function (pos) {\n          return pos.isEqual(normalizedLastPos);\n        });\n      }).getOr(true);\n    };\n    var setCaretLocation = function (editor, caret) {\n      return function (location) {\n        return renderCaret(caret, location).exists(function (pos) {\n          setCaretPosition(editor, pos);\n          return true;\n        });\n      };\n    };\n    var deleteFromTo = function (editor, caret, from, to) {\n      var rootNode = editor.getBody();\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      editor.undoManager.ignore(function () {\n        editor.selection.setRng(rangeFromPositions(from, to));\n        editor.execCommand('Delete');\n        readLocation(isInlineTarget$1, rootNode, CaretPosition.fromRangeStart(editor.selection.getRng())).map(inside).map(setCaretLocation(editor, caret));\n      });\n      editor.nodeChanged();\n    };\n    var rescope$1 = function (rootNode, node) {\n      var parentBlock = getParentBlock(node, rootNode);\n      return parentBlock ? parentBlock : rootNode;\n    };\n    var backspaceDeleteCollapsed = function (editor, caret, forward, from) {\n      var rootNode = rescope$1(editor.getBody(), from.container());\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      var fromLocation = readLocation(isInlineTarget$1, rootNode, from);\n      return fromLocation.bind(function (location) {\n        if (forward) {\n          return location.fold(constant(Optional.some(inside(location))), Optional.none, constant(Optional.some(outside(location))), Optional.none);\n        } else {\n          return location.fold(Optional.none, constant(Optional.some(outside(location))), Optional.none, constant(Optional.some(inside(location))));\n        }\n      }).map(setCaretLocation(editor, caret)).getOrThunk(function () {\n        var toPosition = navigate(forward, rootNode, from);\n        var toLocation = toPosition.bind(function (pos) {\n          return readLocation(isInlineTarget$1, rootNode, pos);\n        });\n        return lift2(fromLocation, toLocation, function () {\n          return findRootInline(isInlineTarget$1, rootNode, from).exists(function (elm) {\n            if (hasOnlyTwoOrLessPositionsLeft(elm)) {\n              deleteElement(editor, forward, SugarElement.fromDom(elm));\n              return true;\n            } else {\n              return false;\n            }\n          });\n        }).orThunk(function () {\n          return toLocation.bind(function (_) {\n            return toPosition.map(function (to) {\n              if (forward) {\n                deleteFromTo(editor, caret, from, to);\n              } else {\n                deleteFromTo(editor, caret, to, from);\n              }\n              return true;\n            });\n          });\n        }).getOr(false);\n      });\n    };\n    var backspaceDelete$6 = function (editor, caret, forward) {\n      if (editor.selection.isCollapsed() && isInlineBoundariesEnabled(editor)) {\n        var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n        return backspaceDeleteCollapsed(editor, caret, forward, from);\n      }\n      return false;\n    };\n\n    var getParentInlines = function (rootElm, startElm) {\n      var parents = parentsAndSelf(startElm, rootElm);\n      return findIndex(parents, isBlock).fold(constant(parents), function (index) {\n        return parents.slice(0, index);\n      });\n    };\n    var hasOnlyOneChild$1 = function (elm) {\n      return children(elm).length === 1;\n    };\n    var deleteLastPosition = function (forward, editor, target, parentInlines) {\n      var isFormatElement$1 = curry(isFormatElement, editor);\n      var formatNodes = map(filter(parentInlines, isFormatElement$1), function (elm) {\n        return elm.dom;\n      });\n      if (formatNodes.length === 0) {\n        deleteElement(editor, forward, target);\n      } else {\n        var pos = replaceWithCaretFormat(target.dom, formatNodes);\n        editor.selection.setRng(pos.toRange());\n      }\n    };\n    var deleteCaret$2 = function (editor, forward) {\n      var rootElm = SugarElement.fromDom(editor.getBody());\n      var startElm = SugarElement.fromDom(editor.selection.getStart());\n      var parentInlines = filter(getParentInlines(rootElm, startElm), hasOnlyOneChild$1);\n      return last(parentInlines).exists(function (target) {\n        var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n        if (willDeleteLastPositionInElement(forward, fromPos, target.dom) && !isEmptyCaretFormatElement(target)) {\n          deleteLastPosition(forward, editor, target, parentInlines);\n          return true;\n        } else {\n          return false;\n        }\n      });\n    };\n    var backspaceDelete$7 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret$2(editor, forward) : false;\n    };\n\n    var deleteElement$2 = function (editor, forward, element) {\n      editor._selectionOverrides.hideFakeCaret();\n      deleteElement(editor, forward, SugarElement.fromDom(element));\n      return true;\n    };\n    var deleteCaret$3 = function (editor, forward) {\n      var isNearMedia = forward ? isBeforeMedia : isAfterMedia;\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var fromPos = getNormalizedRangeEndPoint(direction, editor.getBody(), editor.selection.getRng());\n      if (isNearMedia(fromPos)) {\n        return deleteElement$2(editor, forward, fromPos.getNode(!forward));\n      } else {\n        return Optional.from(normalizePosition(forward, fromPos)).filter(function (pos) {\n          return isNearMedia(pos) && isMoveInsideSameBlock(fromPos, pos);\n        }).exists(function (pos) {\n          return deleteElement$2(editor, forward, pos.getNode(!forward));\n        });\n      }\n    };\n    var deleteRange$2 = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      return isMedia(selectedNode) ? deleteElement$2(editor, forward, selectedNode) : false;\n    };\n    var backspaceDelete$8 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret$3(editor, forward) : deleteRange$2(editor, forward);\n    };\n\n    var isEditable$1 = function (target) {\n      return closest(target, function (elm) {\n        return isContentEditableTrue(elm.dom) || isContentEditableFalse(elm.dom);\n      }).exists(function (elm) {\n        return isContentEditableTrue(elm.dom);\n      });\n    };\n    var parseIndentValue = function (value) {\n      var number = parseInt(value, 10);\n      return isNaN(number) ? 0 : number;\n    };\n    var getIndentStyleName = function (useMargin, element) {\n      var indentStyleName = useMargin || isTable$1(element) ? 'margin' : 'padding';\n      var suffix = get$5(element, 'direction') === 'rtl' ? '-right' : '-left';\n      return indentStyleName + suffix;\n    };\n    var indentElement = function (dom, command, useMargin, value, unit, element) {\n      var indentStyleName = getIndentStyleName(useMargin, SugarElement.fromDom(element));\n      if (command === 'outdent') {\n        var styleValue = Math.max(0, parseIndentValue(element.style[indentStyleName]) - value);\n        dom.setStyle(element, indentStyleName, styleValue ? styleValue + unit : '');\n      } else {\n        var styleValue = parseIndentValue(element.style[indentStyleName]) + value + unit;\n        dom.setStyle(element, indentStyleName, styleValue);\n      }\n    };\n    var validateBlocks = function (editor, blocks) {\n      return forall(blocks, function (block) {\n        var indentStyleName = getIndentStyleName(shouldIndentUseMargin(editor), block);\n        var intentValue = getRaw(block, indentStyleName).map(parseIndentValue).getOr(0);\n        var contentEditable = editor.dom.getContentEditable(block.dom);\n        return contentEditable !== 'false' && intentValue > 0;\n      });\n    };\n    var canOutdent = function (editor) {\n      var blocks = getBlocksToIndent(editor);\n      return !editor.mode.isReadOnly() && (blocks.length > 1 || validateBlocks(editor, blocks));\n    };\n    var isListComponent = function (el) {\n      return isList(el) || isListItem(el);\n    };\n    var parentIsListComponent = function (el) {\n      return parent(el).map(isListComponent).getOr(false);\n    };\n    var getBlocksToIndent = function (editor) {\n      return filter(map(editor.selection.getSelectedBlocks(), SugarElement.fromDom), function (el) {\n        return !isListComponent(el) && !parentIsListComponent(el) && isEditable$1(el);\n      });\n    };\n    var handle = function (editor, command) {\n      var dom = editor.dom, selection = editor.selection, formatter = editor.formatter;\n      var indentation = getIndentation(editor);\n      var indentUnit = /[a-z%]+$/i.exec(indentation)[0];\n      var indentValue = parseInt(indentation, 10);\n      var useMargin = shouldIndentUseMargin(editor);\n      var forcedRootBlock = getForcedRootBlock(editor);\n      if (!editor.queryCommandState('InsertUnorderedList') && !editor.queryCommandState('InsertOrderedList')) {\n        if (forcedRootBlock === '' && !dom.getParent(selection.getNode(), dom.isBlock)) {\n          formatter.apply('div');\n        }\n      }\n      each(getBlocksToIndent(editor), function (block) {\n        indentElement(dom, command, useMargin, indentValue, indentUnit, block.dom);\n      });\n    };\n\n    var backspaceDelete$9 = function (editor, _forward) {\n      if (editor.selection.isCollapsed() && canOutdent(editor)) {\n        var dom = editor.dom;\n        var rng = editor.selection.getRng();\n        var pos = CaretPosition.fromRangeStart(rng);\n        var block = dom.getParent(rng.startContainer, dom.isBlock);\n        if (block !== null && isAtStartOfBlock(SugarElement.fromDom(block), pos)) {\n          handle(editor, 'outdent');\n          return true;\n        }\n      }\n      return false;\n    };\n\n    var nativeCommand = function (editor, command) {\n      editor.getDoc().execCommand(command, false, null);\n    };\n    var deleteCommand = function (editor, caret) {\n      if (backspaceDelete$9(editor)) {\n        return;\n      } else if (backspaceDelete$4(editor, false)) {\n        return;\n      } else if (backspaceDelete$3(editor, false)) {\n        return;\n      } else if (backspaceDelete$6(editor, caret, false)) {\n        return;\n      } else if (backspaceDelete$1(editor, false)) {\n        return;\n      } else if (backspaceDelete(editor)) {\n        return;\n      } else if (backspaceDelete$5(editor, false)) {\n        return;\n      } else if (backspaceDelete$8(editor, false)) {\n        return;\n      } else if (backspaceDelete$2(editor)) {\n        return;\n      } else if (backspaceDelete$7(editor, false)) {\n        return;\n      } else {\n        nativeCommand(editor, 'Delete');\n        paddEmptyBody(editor);\n      }\n    };\n    var forwardDeleteCommand = function (editor, caret) {\n      if (backspaceDelete$4(editor, true)) {\n        return;\n      } else if (backspaceDelete$3(editor, true)) {\n        return;\n      } else if (backspaceDelete$6(editor, caret, true)) {\n        return;\n      } else if (backspaceDelete$1(editor, true)) {\n        return;\n      } else if (backspaceDelete(editor)) {\n        return;\n      } else if (backspaceDelete$5(editor, true)) {\n        return;\n      } else if (backspaceDelete$8(editor, true)) {\n        return;\n      } else if (backspaceDelete$2(editor)) {\n        return;\n      } else if (backspaceDelete$7(editor, true)) {\n        return;\n      } else {\n        nativeCommand(editor, 'ForwardDelete');\n      }\n    };\n    var setup$8 = function (editor, caret) {\n      editor.addCommand('delete', function () {\n        deleteCommand(editor, caret);\n      });\n      editor.addCommand('forwardDelete', function () {\n        forwardDeleteCommand(editor, caret);\n      });\n    };\n\n    var SIGNIFICANT_MOVE = 5;\n    var LONGPRESS_DELAY = 400;\n    var getTouch = function (event) {\n      if (event.touches === undefined || event.touches.length !== 1) {\n        return Optional.none();\n      }\n      return Optional.some(event.touches[0]);\n    };\n    var isFarEnough = function (touch, data) {\n      var distX = Math.abs(touch.clientX - data.x);\n      var distY = Math.abs(touch.clientY - data.y);\n      return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n    };\n    var setup$9 = function (editor) {\n      var startData = Cell(Optional.none());\n      var longpressFired = Cell(false);\n      var debounceLongpress = last$2(function (e) {\n        editor.fire('longpress', __assign(__assign({}, e), { type: 'longpress' }));\n        longpressFired.set(true);\n      }, LONGPRESS_DELAY);\n      editor.on('touchstart', function (e) {\n        getTouch(e).each(function (touch) {\n          debounceLongpress.cancel();\n          var data = {\n            x: touch.clientX,\n            y: touch.clientY,\n            target: e.target\n          };\n          debounceLongpress.throttle(e);\n          longpressFired.set(false);\n          startData.set(Optional.some(data));\n        });\n      }, true);\n      editor.on('touchmove', function (e) {\n        debounceLongpress.cancel();\n        getTouch(e).each(function (touch) {\n          startData.get().each(function (data) {\n            if (isFarEnough(touch, data)) {\n              startData.set(Optional.none());\n              longpressFired.set(false);\n              editor.fire('longpresscancel');\n            }\n          });\n        });\n      }, true);\n      editor.on('touchend touchcancel', function (e) {\n        debounceLongpress.cancel();\n        if (e.type === 'touchcancel') {\n          return;\n        }\n        startData.get().filter(function (data) {\n          return data.target.isEqualNode(e.target);\n        }).each(function () {\n          if (longpressFired.get()) {\n            e.preventDefault();\n          } else {\n            editor.fire('tap', __assign(__assign({}, e), { type: 'tap' }));\n          }\n        });\n      }, true);\n    };\n\n    var isBlockElement = function (blockElements, node) {\n      return blockElements.hasOwnProperty(node.nodeName);\n    };\n    var isValidTarget = function (blockElements, node) {\n      if (isText$1(node)) {\n        return true;\n      } else if (isElement$1(node)) {\n        return !isBlockElement(blockElements, node) && !isBookmarkNode$1(node);\n      } else {\n        return false;\n      }\n    };\n    var hasBlockParent = function (blockElements, root, node) {\n      return exists(parents$1(SugarElement.fromDom(node), SugarElement.fromDom(root)), function (elm) {\n        return isBlockElement(blockElements, elm.dom);\n      });\n    };\n    var shouldRemoveTextNode = function (blockElements, node) {\n      if (isText$1(node)) {\n        if (node.nodeValue.length === 0) {\n          return true;\n        } else if (/^\\s+$/.test(node.nodeValue) && (!node.nextSibling || isBlockElement(blockElements, node.nextSibling))) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var addRootBlocks = function (editor) {\n      var dom = editor.dom, selection = editor.selection;\n      var schema = editor.schema, blockElements = schema.getBlockElements();\n      var node = selection.getStart();\n      var rootNode = editor.getBody();\n      var rootBlockNode, tempNode, wrapped;\n      var forcedRootBlock = getForcedRootBlock(editor);\n      if (!node || !isElement$1(node) || !forcedRootBlock) {\n        return;\n      }\n      var rootNodeName = rootNode.nodeName.toLowerCase();\n      if (!schema.isValidChild(rootNodeName, forcedRootBlock.toLowerCase()) || hasBlockParent(blockElements, rootNode, node)) {\n        return;\n      }\n      var rng = selection.getRng();\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n      var restoreSelection = hasFocus$1(editor);\n      node = rootNode.firstChild;\n      while (node) {\n        if (isValidTarget(blockElements, node)) {\n          if (shouldRemoveTextNode(blockElements, node)) {\n            tempNode = node;\n            node = node.nextSibling;\n            dom.remove(tempNode);\n            continue;\n          }\n          if (!rootBlockNode) {\n            rootBlockNode = dom.create(forcedRootBlock, getForcedRootBlockAttrs(editor));\n            node.parentNode.insertBefore(rootBlockNode, node);\n            wrapped = true;\n          }\n          tempNode = node;\n          node = node.nextSibling;\n          rootBlockNode.appendChild(tempNode);\n        } else {\n          rootBlockNode = null;\n          node = node.nextSibling;\n        }\n      }\n      if (wrapped && restoreSelection) {\n        rng.setStart(startContainer, startOffset);\n        rng.setEnd(endContainer, endOffset);\n        selection.setRng(rng);\n        editor.nodeChanged();\n      }\n    };\n    var setup$a = function (editor) {\n      if (getForcedRootBlock(editor)) {\n        editor.on('NodeChange', curry(addRootBlocks, editor));\n      }\n    };\n\n    var findBlockCaretContainer = function (editor) {\n      return descendant(SugarElement.fromDom(editor.getBody()), '*[data-mce-caret]').fold(constant(null), function (elm) {\n        return elm.dom;\n      });\n    };\n    var removeIeControlRect = function (editor) {\n      editor.selection.setRng(editor.selection.getRng());\n    };\n    var showBlockCaretContainer = function (editor, blockCaretContainer) {\n      if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n        showCaretContainerBlock(blockCaretContainer);\n        removeIeControlRect(editor);\n        editor.selection.scrollIntoView(blockCaretContainer);\n      }\n    };\n    var handleBlockContainer = function (editor, e) {\n      var blockCaretContainer = findBlockCaretContainer(editor);\n      if (!blockCaretContainer) {\n        return;\n      }\n      if (e.type === 'compositionstart') {\n        e.preventDefault();\n        e.stopPropagation();\n        showBlockCaretContainer(editor, blockCaretContainer);\n        return;\n      }\n      if (hasContent(blockCaretContainer)) {\n        showBlockCaretContainer(editor, blockCaretContainer);\n        editor.undoManager.add();\n      }\n    };\n    var setup$b = function (editor) {\n      editor.on('keyup compositionstart', curry(handleBlockContainer, editor));\n    };\n\n    var BreakType;\n    (function (BreakType) {\n      BreakType[BreakType['Br'] = 0] = 'Br';\n      BreakType[BreakType['Block'] = 1] = 'Block';\n      BreakType[BreakType['Wrap'] = 2] = 'Wrap';\n      BreakType[BreakType['Eol'] = 3] = 'Eol';\n    }(BreakType || (BreakType = {})));\n    var flip = function (direction, positions) {\n      return direction === HDirection.Backwards ? reverse(positions) : positions;\n    };\n    var walk$3 = function (direction, caretWalker, pos) {\n      return direction === HDirection.Forwards ? caretWalker.next(pos) : caretWalker.prev(pos);\n    };\n    var getBreakType = function (scope, direction, currentPos, nextPos) {\n      if (isBr(nextPos.getNode(direction === HDirection.Forwards))) {\n        return BreakType.Br;\n      } else if (isInSameBlock(currentPos, nextPos) === false) {\n        return BreakType.Block;\n      } else {\n        return BreakType.Wrap;\n      }\n    };\n    var getPositionsUntil = function (predicate, direction, scope, start) {\n      var caretWalker = CaretWalker(scope);\n      var currentPos = start, nextPos;\n      var positions = [];\n      while (currentPos) {\n        nextPos = walk$3(direction, caretWalker, currentPos);\n        if (!nextPos) {\n          break;\n        }\n        if (isBr(nextPos.getNode(false))) {\n          if (direction === HDirection.Forwards) {\n            return {\n              positions: flip(direction, positions).concat([nextPos]),\n              breakType: BreakType.Br,\n              breakAt: Optional.some(nextPos)\n            };\n          } else {\n            return {\n              positions: flip(direction, positions),\n              breakType: BreakType.Br,\n              breakAt: Optional.some(nextPos)\n            };\n          }\n        }\n        if (!nextPos.isVisible()) {\n          currentPos = nextPos;\n          continue;\n        }\n        if (predicate(currentPos, nextPos)) {\n          var breakType = getBreakType(scope, direction, currentPos, nextPos);\n          return {\n            positions: flip(direction, positions),\n            breakType: breakType,\n            breakAt: Optional.some(nextPos)\n          };\n        }\n        positions.push(nextPos);\n        currentPos = nextPos;\n      }\n      return {\n        positions: flip(direction, positions),\n        breakType: BreakType.Eol,\n        breakAt: Optional.none()\n      };\n    };\n    var getAdjacentLinePositions = function (direction, getPositionsUntilBreak, scope, start) {\n      return getPositionsUntilBreak(scope, start).breakAt.map(function (pos) {\n        var positions = getPositionsUntilBreak(scope, pos).positions;\n        return direction === HDirection.Backwards ? positions.concat(pos) : [pos].concat(positions);\n      }).getOr([]);\n    };\n    var findClosestHorizontalPositionFromPoint = function (positions, x) {\n      return foldl(positions, function (acc, newPos) {\n        return acc.fold(function () {\n          return Optional.some(newPos);\n        }, function (lastPos) {\n          return lift2(head(lastPos.getClientRects()), head(newPos.getClientRects()), function (lastRect, newRect) {\n            var lastDist = Math.abs(x - lastRect.left);\n            var newDist = Math.abs(x - newRect.left);\n            return newDist <= lastDist ? newPos : lastPos;\n          }).or(acc);\n        });\n      }, Optional.none());\n    };\n    var findClosestHorizontalPosition = function (positions, pos) {\n      return head(pos.getClientRects()).bind(function (targetRect) {\n        return findClosestHorizontalPositionFromPoint(positions, targetRect.left);\n      });\n    };\n    var getPositionsUntilPreviousLine = curry(getPositionsUntil, CaretPosition.isAbove, -1);\n    var getPositionsUntilNextLine = curry(getPositionsUntil, CaretPosition.isBelow, 1);\n    var isAtFirstLine = function (scope, pos) {\n      return getPositionsUntilPreviousLine(scope, pos).breakAt.isNone();\n    };\n    var isAtLastLine = function (scope, pos) {\n      return getPositionsUntilNextLine(scope, pos).breakAt.isNone();\n    };\n    var getPositionsAbove = curry(getAdjacentLinePositions, -1, getPositionsUntilPreviousLine);\n    var getPositionsBelow = curry(getAdjacentLinePositions, 1, getPositionsUntilNextLine);\n    var getFirstLinePositions = function (scope) {\n      return firstPositionIn(scope).map(function (pos) {\n        return [pos].concat(getPositionsUntilNextLine(scope, pos).positions);\n      }).getOr([]);\n    };\n    var getLastLinePositions = function (scope) {\n      return lastPositionIn(scope).map(function (pos) {\n        return getPositionsUntilPreviousLine(scope, pos).positions.concat(pos);\n      }).getOr([]);\n    };\n\n    var getNodeClientRects = function (node) {\n      var toArrayWithNode = function (clientRects) {\n        return map(clientRects, function (clientRect) {\n          clientRect = clone$2(clientRect);\n          clientRect.node = node;\n          return clientRect;\n        });\n      };\n      if (isElement$1(node)) {\n        return toArrayWithNode(node.getClientRects());\n      }\n      if (isText$1(node)) {\n        var rng = node.ownerDocument.createRange();\n        rng.setStart(node, 0);\n        rng.setEnd(node, node.data.length);\n        return toArrayWithNode(rng.getClientRects());\n      }\n    };\n    var getClientRects = function (nodes) {\n      return bind(nodes, getNodeClientRects);\n    };\n\n    var VDirection;\n    (function (VDirection) {\n      VDirection[VDirection['Up'] = -1] = 'Up';\n      VDirection[VDirection['Down'] = 1] = 'Down';\n    }(VDirection || (VDirection = {})));\n    var findUntil$1 = function (direction, root, predicateFn, node) {\n      while (node = findNode(node, direction, isEditableCaretCandidate, root)) {\n        if (predicateFn(node)) {\n          return;\n        }\n      }\n    };\n    var walkUntil = function (direction, isAboveFn, isBeflowFn, root, predicateFn, caretPosition) {\n      var line = 0;\n      var result = [];\n      var add = function (node) {\n        var i, clientRect, clientRects;\n        clientRects = getClientRects([node]);\n        if (direction === -1) {\n          clientRects = clientRects.reverse();\n        }\n        for (i = 0; i < clientRects.length; i++) {\n          clientRect = clientRects[i];\n          if (isBeflowFn(clientRect, targetClientRect)) {\n            continue;\n          }\n          if (result.length > 0 && isAboveFn(clientRect, last$1(result))) {\n            line++;\n          }\n          clientRect.line = line;\n          if (predicateFn(clientRect)) {\n            return true;\n          }\n          result.push(clientRect);\n        }\n      };\n      var targetClientRect = last$1(caretPosition.getClientRects());\n      if (!targetClientRect) {\n        return result;\n      }\n      var node = caretPosition.getNode();\n      add(node);\n      findUntil$1(direction, root, add, node);\n      return result;\n    };\n    var aboveLineNumber = function (lineNumber, clientRect) {\n      return clientRect.line > lineNumber;\n    };\n    var isLineNumber = function (lineNumber, clientRect) {\n      return clientRect.line === lineNumber;\n    };\n    var upUntil = curry(walkUntil, VDirection.Up, isAbove, isBelow);\n    var downUntil = curry(walkUntil, VDirection.Down, isBelow, isAbove);\n    var positionsUntil = function (direction, root, predicateFn, node) {\n      var caretWalker = CaretWalker(root);\n      var walkFn, isBelowFn, isAboveFn, caretPosition;\n      var result = [];\n      var line = 0, clientRect;\n      var getClientRect = function (caretPosition) {\n        if (direction === 1) {\n          return last$1(caretPosition.getClientRects());\n        }\n        return last$1(caretPosition.getClientRects());\n      };\n      if (direction === 1) {\n        walkFn = caretWalker.next;\n        isBelowFn = isBelow;\n        isAboveFn = isAbove;\n        caretPosition = CaretPosition.after(node);\n      } else {\n        walkFn = caretWalker.prev;\n        isBelowFn = isAbove;\n        isAboveFn = isBelow;\n        caretPosition = CaretPosition.before(node);\n      }\n      var targetClientRect = getClientRect(caretPosition);\n      do {\n        if (!caretPosition.isVisible()) {\n          continue;\n        }\n        clientRect = getClientRect(caretPosition);\n        if (isAboveFn(clientRect, targetClientRect)) {\n          continue;\n        }\n        if (result.length > 0 && isBelowFn(clientRect, last$1(result))) {\n          line++;\n        }\n        clientRect = clone$2(clientRect);\n        clientRect.position = caretPosition;\n        clientRect.line = line;\n        if (predicateFn(clientRect)) {\n          return result;\n        }\n        result.push(clientRect);\n      } while (caretPosition = walkFn(caretPosition));\n      return result;\n    };\n    var isAboveLine = function (lineNumber) {\n      return function (clientRect) {\n        return aboveLineNumber(lineNumber, clientRect);\n      };\n    };\n    var isLine = function (lineNumber) {\n      return function (clientRect) {\n        return isLineNumber(lineNumber, clientRect);\n      };\n    };\n\n    var isContentEditableFalse$8 = isContentEditableFalse;\n    var findNode$1 = findNode;\n    var distanceToRectLeft = function (clientRect, clientX) {\n      return Math.abs(clientRect.left - clientX);\n    };\n    var distanceToRectRight = function (clientRect, clientX) {\n      return Math.abs(clientRect.right - clientX);\n    };\n    var isInsideX = function (clientX, clientRect) {\n      return clientX >= clientRect.left && clientX <= clientRect.right;\n    };\n    var isInsideY = function (clientY, clientRect) {\n      return clientY >= clientRect.top && clientY <= clientRect.bottom;\n    };\n    var findClosestClientRect = function (clientRects, clientX) {\n      return reduce(clientRects, function (oldClientRect, clientRect) {\n        var oldDistance = Math.min(distanceToRectLeft(oldClientRect, clientX), distanceToRectRight(oldClientRect, clientX));\n        var newDistance = Math.min(distanceToRectLeft(clientRect, clientX), distanceToRectRight(clientRect, clientX));\n        if (isInsideX(clientX, clientRect)) {\n          return clientRect;\n        }\n        if (isInsideX(clientX, oldClientRect)) {\n          return oldClientRect;\n        }\n        if (newDistance === oldDistance && isContentEditableFalse$8(clientRect.node)) {\n          return clientRect;\n        }\n        if (newDistance < oldDistance) {\n          return clientRect;\n        }\n        return oldClientRect;\n      });\n    };\n    var walkUntil$1 = function (direction, root, predicateFn, startNode, includeChildren) {\n      var node = findNode$1(startNode, direction, isEditableCaretCandidate, root, !includeChildren);\n      do {\n        if (!node || predicateFn(node)) {\n          return;\n        }\n      } while (node = findNode$1(node, direction, isEditableCaretCandidate, root));\n    };\n    var findLineNodeRects = function (root, targetNodeRect, includeChildren) {\n      if (includeChildren === void 0) {\n        includeChildren = true;\n      }\n      var clientRects = [];\n      var collect = function (checkPosFn, node) {\n        var lineRects = filter(getClientRects([node]), function (clientRect) {\n          return !checkPosFn(clientRect, targetNodeRect);\n        });\n        clientRects = clientRects.concat(lineRects);\n        return lineRects.length === 0;\n      };\n      clientRects.push(targetNodeRect);\n      walkUntil$1(VDirection.Up, root, curry(collect, isAbove), targetNodeRect.node, includeChildren);\n      walkUntil$1(VDirection.Down, root, curry(collect, isBelow), targetNodeRect.node, includeChildren);\n      return clientRects;\n    };\n    var getFakeCaretTargets = function (root) {\n      return filter(from$1(root.getElementsByTagName('*')), isFakeCaretTarget);\n    };\n    var caretInfo = function (clientRect, clientX) {\n      return {\n        node: clientRect.node,\n        before: distanceToRectLeft(clientRect, clientX) < distanceToRectRight(clientRect, clientX)\n      };\n    };\n    var closestFakeCaret = function (root, clientX, clientY) {\n      var fakeTargetNodeRects = getClientRects(getFakeCaretTargets(root));\n      var targetNodeRects = filter(fakeTargetNodeRects, curry(isInsideY, clientY));\n      var closestNodeRect = findClosestClientRect(targetNodeRects, clientX);\n      if (closestNodeRect) {\n        var includeChildren = !isTable(closestNodeRect.node) && !isMedia(closestNodeRect.node);\n        closestNodeRect = findClosestClientRect(findLineNodeRects(root, closestNodeRect, includeChildren), clientX);\n        if (closestNodeRect && isFakeCaretTarget(closestNodeRect.node)) {\n          return caretInfo(closestNodeRect, clientX);\n        }\n      }\n      return null;\n    };\n\n    var moveToRange = function (editor, rng) {\n      editor.selection.setRng(rng);\n      scrollRangeIntoView(editor, editor.selection.getRng());\n    };\n    var renderRangeCaretOpt = function (editor, range, scrollIntoView) {\n      return Optional.some(renderRangeCaret(editor, range, scrollIntoView));\n    };\n    var moveHorizontally = function (editor, direction, range, isBefore, isAfter, isElement) {\n      var forwards = direction === HDirection.Forwards;\n      var caretWalker = CaretWalker(editor.getBody());\n      var getNextPosFn = curry(getVisualCaretPosition, forwards ? caretWalker.next : caretWalker.prev);\n      var isBeforeFn = forwards ? isBefore : isAfter;\n      if (!range.collapsed) {\n        var node = getSelectedNode(range);\n        if (isElement(node)) {\n          return showCaret(direction, editor, node, direction === HDirection.Backwards, false);\n        }\n      }\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      if (isBeforeFn(caretPosition)) {\n        return selectNode(editor, caretPosition.getNode(!forwards));\n      }\n      var nextCaretPosition = normalizePosition(forwards, getNextPosFn(caretPosition));\n      var rangeIsInContainerBlock = isRangeInCaretContainerBlock(range);\n      if (!nextCaretPosition) {\n        return rangeIsInContainerBlock ? Optional.some(range) : Optional.none();\n      }\n      if (isBeforeFn(nextCaretPosition)) {\n        return showCaret(direction, editor, nextCaretPosition.getNode(!forwards), forwards, false);\n      }\n      var peekCaretPosition = getNextPosFn(nextCaretPosition);\n      if (peekCaretPosition && isBeforeFn(peekCaretPosition)) {\n        if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n          return showCaret(direction, editor, peekCaretPosition.getNode(!forwards), forwards, false);\n        }\n      }\n      if (rangeIsInContainerBlock) {\n        return renderRangeCaretOpt(editor, nextCaretPosition.toRange(), false);\n      }\n      return Optional.none();\n    };\n    var moveVertically = function (editor, direction, range, isBefore, isAfter, isElement) {\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      var caretClientRect = last$1(caretPosition.getClientRects());\n      var forwards = direction === VDirection.Down;\n      if (!caretClientRect) {\n        return Optional.none();\n      }\n      var walkerFn = forwards ? downUntil : upUntil;\n      var linePositions = walkerFn(editor.getBody(), isAboveLine(1), caretPosition);\n      var nextLinePositions = filter(linePositions, isLine(1));\n      var clientX = caretClientRect.left;\n      var nextLineRect = findClosestClientRect(nextLinePositions, clientX);\n      if (nextLineRect && isElement(nextLineRect.node)) {\n        var dist1 = Math.abs(clientX - nextLineRect.left);\n        var dist2 = Math.abs(clientX - nextLineRect.right);\n        return showCaret(direction, editor, nextLineRect.node, dist1 < dist2, false);\n      }\n      var currentNode;\n      if (isBefore(caretPosition)) {\n        currentNode = caretPosition.getNode();\n      } else if (isAfter(caretPosition)) {\n        currentNode = caretPosition.getNode(true);\n      } else {\n        currentNode = getSelectedNode(range);\n      }\n      if (currentNode) {\n        var caretPositions = positionsUntil(direction, editor.getBody(), isAboveLine(1), currentNode);\n        var closestNextLineRect = findClosestClientRect(filter(caretPositions, isLine(1)), clientX);\n        if (closestNextLineRect) {\n          return renderRangeCaretOpt(editor, closestNextLineRect.position.toRange(), false);\n        }\n        closestNextLineRect = last$1(filter(caretPositions, isLine(0)));\n        if (closestNextLineRect) {\n          return renderRangeCaretOpt(editor, closestNextLineRect.position.toRange(), false);\n        }\n      }\n      if (nextLinePositions.length === 0) {\n        return getLineEndPoint(editor, forwards).filter(forwards ? isAfter : isBefore).map(function (pos) {\n          return renderRangeCaret(editor, pos.toRange(), false);\n        });\n      }\n      return Optional.none();\n    };\n    var getLineEndPoint = function (editor, forward) {\n      var rng = editor.selection.getRng();\n      var body = editor.getBody();\n      if (forward) {\n        var from = CaretPosition.fromRangeEnd(rng);\n        var result = getPositionsUntilNextLine(body, from);\n        return last(result.positions);\n      } else {\n        var from = CaretPosition.fromRangeStart(rng);\n        var result = getPositionsUntilPreviousLine(body, from);\n        return head(result.positions);\n      }\n    };\n    var moveToLineEndPoint = function (editor, forward, isElementPosition) {\n      return getLineEndPoint(editor, forward).filter(isElementPosition).exists(function (pos) {\n        editor.selection.setRng(pos.toRange());\n        return true;\n      });\n    };\n\n    var isContentEditableFalse$9 = isContentEditableFalse;\n    var moveToCeFalseHorizontally = function (direction, editor, range) {\n      return moveHorizontally(editor, direction, range, isBeforeContentEditableFalse, isAfterContentEditableFalse, isContentEditableFalse$9);\n    };\n    var moveToCeFalseVertically = function (direction, editor, range) {\n      var isBefore = function (caretPosition) {\n        return isBeforeContentEditableFalse(caretPosition) || isBeforeTable(caretPosition);\n      };\n      var isAfter = function (caretPosition) {\n        return isAfterContentEditableFalse(caretPosition) || isAfterTable(caretPosition);\n      };\n      return moveVertically(editor, direction, range, isBefore, isAfter, isContentEditableFalse$9);\n    };\n    var createTextBlock = function (editor) {\n      var textBlock = editor.dom.create(getForcedRootBlock(editor));\n      if (!Env.ie || Env.ie >= 11) {\n        textBlock.innerHTML = '<br data-mce-bogus=\"1\">';\n      }\n      return textBlock;\n    };\n    var exitPreBlock = function (editor, direction, range) {\n      var caretWalker = CaretWalker(editor.getBody());\n      var getVisualCaretPosition$1 = curry(getVisualCaretPosition, direction === 1 ? caretWalker.next : caretWalker.prev);\n      if (range.collapsed && hasForcedRootBlock(editor)) {\n        var pre = editor.dom.getParent(range.startContainer, 'PRE');\n        if (!pre) {\n          return;\n        }\n        var caretPos = getVisualCaretPosition$1(CaretPosition.fromRangeStart(range));\n        if (!caretPos) {\n          var newBlock = createTextBlock(editor);\n          if (direction === 1) {\n            editor.$(pre).after(newBlock);\n          } else {\n            editor.$(pre).before(newBlock);\n          }\n          editor.selection.select(newBlock, true);\n          editor.selection.collapse();\n        }\n      }\n    };\n    var getHorizontalRange = function (editor, forward) {\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var range = editor.selection.getRng();\n      return moveToCeFalseHorizontally(direction, editor, range).orThunk(function () {\n        exitPreBlock(editor, direction, range);\n        return Optional.none();\n      });\n    };\n    var getVerticalRange = function (editor, down) {\n      var direction = down ? 1 : -1;\n      var range = editor.selection.getRng();\n      return moveToCeFalseVertically(direction, editor, range).orThunk(function () {\n        exitPreBlock(editor, direction, range);\n        return Optional.none();\n      });\n    };\n    var moveH = function (editor, forward) {\n      return getHorizontalRange(editor, forward).exists(function (newRange) {\n        moveToRange(editor, newRange);\n        return true;\n      });\n    };\n    var moveV = function (editor, down) {\n      return getVerticalRange(editor, down).exists(function (newRange) {\n        moveToRange(editor, newRange);\n        return true;\n      });\n    };\n    var moveToLineEndPoint$1 = function (editor, forward) {\n      var isCefPosition = forward ? isAfterContentEditableFalse : isBeforeContentEditableFalse;\n      return moveToLineEndPoint(editor, forward, isCefPosition);\n    };\n\n    var isTarget = function (node) {\n      return contains(['figcaption'], name(node));\n    };\n    var rangeBefore = function (target) {\n      var rng = document.createRange();\n      rng.setStartBefore(target.dom);\n      rng.setEndBefore(target.dom);\n      return rng;\n    };\n    var insertElement = function (root, elm, forward) {\n      if (forward) {\n        append(root, elm);\n      } else {\n        prepend(root, elm);\n      }\n    };\n    var insertBr = function (root, forward) {\n      var br = SugarElement.fromTag('br');\n      insertElement(root, br, forward);\n      return rangeBefore(br);\n    };\n    var insertBlock$1 = function (root, forward, blockName, attrs) {\n      var block = SugarElement.fromTag(blockName);\n      var br = SugarElement.fromTag('br');\n      setAll(block, attrs);\n      append(block, br);\n      insertElement(root, block, forward);\n      return rangeBefore(br);\n    };\n    var insertEmptyLine = function (root, rootBlockName, attrs, forward) {\n      if (rootBlockName === '') {\n        return insertBr(root, forward);\n      } else {\n        return insertBlock$1(root, forward, rootBlockName, attrs);\n      }\n    };\n    var getClosestTargetBlock = function (pos, root) {\n      var isRoot = curry(eq$2, root);\n      return closest(SugarElement.fromDom(pos.container()), isBlock, isRoot).filter(isTarget);\n    };\n    var isAtFirstOrLastLine = function (root, forward, pos) {\n      return forward ? isAtLastLine(root.dom, pos) : isAtFirstLine(root.dom, pos);\n    };\n    var moveCaretToNewEmptyLine = function (editor, forward) {\n      var root = SugarElement.fromDom(editor.getBody());\n      var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n      var rootBlock = getForcedRootBlock(editor);\n      var rootBlockAttrs = getForcedRootBlockAttrs(editor);\n      return getClosestTargetBlock(pos, root).exists(function () {\n        if (isAtFirstOrLastLine(root, forward, pos)) {\n          var rng = insertEmptyLine(root, rootBlock, rootBlockAttrs, forward);\n          editor.selection.setRng(rng);\n          return true;\n        } else {\n          return false;\n        }\n      });\n    };\n    var moveV$1 = function (editor, forward) {\n      if (editor.selection.isCollapsed()) {\n        return moveCaretToNewEmptyLine(editor, forward);\n      } else {\n        return false;\n      }\n    };\n\n    var defaultPatterns = function (patterns) {\n      return map(patterns, function (pattern) {\n        return __assign({\n          shiftKey: false,\n          altKey: false,\n          ctrlKey: false,\n          metaKey: false,\n          keyCode: 0,\n          action: noop\n        }, pattern);\n      });\n    };\n    var matchesEvent = function (pattern, evt) {\n      return evt.keyCode === pattern.keyCode && evt.shiftKey === pattern.shiftKey && evt.altKey === pattern.altKey && evt.ctrlKey === pattern.ctrlKey && evt.metaKey === pattern.metaKey;\n    };\n    var match$1 = function (patterns, evt) {\n      return bind(defaultPatterns(patterns), function (pattern) {\n        return matchesEvent(pattern, evt) ? [pattern] : [];\n      });\n    };\n    var action = function (f) {\n      var x = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n      return function () {\n        return f.apply(null, x);\n      };\n    };\n    var execute = function (patterns, evt) {\n      return find(match$1(patterns, evt), function (pattern) {\n        return pattern.action();\n      });\n    };\n\n    var moveH$1 = function (editor, forward) {\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var range = editor.selection.getRng();\n      return moveHorizontally(editor, direction, range, isBeforeMedia, isAfterMedia, isMedia).exists(function (newRange) {\n        moveToRange(editor, newRange);\n        return true;\n      });\n    };\n    var moveV$2 = function (editor, down) {\n      var direction = down ? 1 : -1;\n      var range = editor.selection.getRng();\n      return moveVertically(editor, direction, range, isBeforeMedia, isAfterMedia, isMedia).exists(function (newRange) {\n        moveToRange(editor, newRange);\n        return true;\n      });\n    };\n    var moveToLineEndPoint$2 = function (editor, forward) {\n      var isNearMedia = forward ? isAfterMedia : isBeforeMedia;\n      return moveToLineEndPoint(editor, forward, isNearMedia);\n    };\n\n    var deflate = function (rect, delta) {\n      return {\n        left: rect.left - delta,\n        top: rect.top - delta,\n        right: rect.right + delta * 2,\n        bottom: rect.bottom + delta * 2,\n        width: rect.width + delta,\n        height: rect.height + delta\n      };\n    };\n    var getCorners = function (getYAxisValue, tds) {\n      return bind(tds, function (td) {\n        var rect = deflate(clone$2(td.getBoundingClientRect()), -1);\n        return [\n          {\n            x: rect.left,\n            y: getYAxisValue(rect),\n            cell: td\n          },\n          {\n            x: rect.right,\n            y: getYAxisValue(rect),\n            cell: td\n          }\n        ];\n      });\n    };\n    var findClosestCorner = function (corners, x, y) {\n      return foldl(corners, function (acc, newCorner) {\n        return acc.fold(function () {\n          return Optional.some(newCorner);\n        }, function (oldCorner) {\n          var oldDist = Math.sqrt(Math.abs(oldCorner.x - x) + Math.abs(oldCorner.y - y));\n          var newDist = Math.sqrt(Math.abs(newCorner.x - x) + Math.abs(newCorner.y - y));\n          return Optional.some(newDist < oldDist ? newCorner : oldCorner);\n        });\n      }, Optional.none());\n    };\n    var getClosestCell$1 = function (getYAxisValue, isTargetCorner, table, x, y) {\n      var cells = descendants$1(SugarElement.fromDom(table), 'td,th,caption').map(function (e) {\n        return e.dom;\n      });\n      var corners = filter(getCorners(getYAxisValue, cells), function (corner) {\n        return isTargetCorner(corner, y);\n      });\n      return findClosestCorner(corners, x, y).map(function (corner) {\n        return corner.cell;\n      });\n    };\n    var getBottomValue = function (rect) {\n      return rect.bottom;\n    };\n    var getTopValue = function (rect) {\n      return rect.top;\n    };\n    var isAbove$1 = function (corner, y) {\n      return corner.y < y;\n    };\n    var isBelow$1 = function (corner, y) {\n      return corner.y > y;\n    };\n    var getClosestCellAbove = curry(getClosestCell$1, getBottomValue, isAbove$1);\n    var getClosestCellBelow = curry(getClosestCell$1, getTopValue, isBelow$1);\n    var findClosestPositionInAboveCell = function (table, pos) {\n      return head(pos.getClientRects()).bind(function (rect) {\n        return getClosestCellAbove(table, rect.left, rect.top);\n      }).bind(function (cell) {\n        return findClosestHorizontalPosition(getLastLinePositions(cell), pos);\n      });\n    };\n    var findClosestPositionInBelowCell = function (table, pos) {\n      return last(pos.getClientRects()).bind(function (rect) {\n        return getClosestCellBelow(table, rect.left, rect.top);\n      }).bind(function (cell) {\n        return findClosestHorizontalPosition(getFirstLinePositions(cell), pos);\n      });\n    };\n\n    var hasNextBreak = function (getPositionsUntil, scope, lineInfo) {\n      return lineInfo.breakAt.exists(function (breakPos) {\n        return getPositionsUntil(scope, breakPos).breakAt.isSome();\n      });\n    };\n    var startsWithWrapBreak = function (lineInfo) {\n      return lineInfo.breakType === BreakType.Wrap && lineInfo.positions.length === 0;\n    };\n    var startsWithBrBreak = function (lineInfo) {\n      return lineInfo.breakType === BreakType.Br && lineInfo.positions.length === 1;\n    };\n    var isAtTableCellLine = function (getPositionsUntil, scope, pos) {\n      var lineInfo = getPositionsUntil(scope, pos);\n      if (startsWithWrapBreak(lineInfo) || !isBr(pos.getNode()) && startsWithBrBreak(lineInfo)) {\n        return !hasNextBreak(getPositionsUntil, scope, lineInfo);\n      } else {\n        return lineInfo.breakAt.isNone();\n      }\n    };\n    var isAtFirstTableCellLine = curry(isAtTableCellLine, getPositionsUntilPreviousLine);\n    var isAtLastTableCellLine = curry(isAtTableCellLine, getPositionsUntilNextLine);\n    var isCaretAtStartOrEndOfTable = function (forward, rng, table) {\n      var caretPos = CaretPosition.fromRangeStart(rng);\n      return positionIn(!forward, table).exists(function (pos) {\n        return pos.isEqual(caretPos);\n      });\n    };\n    var navigateHorizontally = function (editor, forward, table, _td) {\n      var rng = editor.selection.getRng();\n      var direction = forward ? 1 : -1;\n      if (isFakeCaretTableBrowser() && isCaretAtStartOrEndOfTable(forward, rng, table)) {\n        showCaret(direction, editor, table, !forward, false).each(function (newRng) {\n          moveToRange(editor, newRng);\n        });\n        return true;\n      }\n      return false;\n    };\n    var getClosestAbovePosition = function (root, table, start) {\n      return findClosestPositionInAboveCell(table, start).orThunk(function () {\n        return head(start.getClientRects()).bind(function (rect) {\n          return findClosestHorizontalPositionFromPoint(getPositionsAbove(root, CaretPosition.before(table)), rect.left);\n        });\n      }).getOr(CaretPosition.before(table));\n    };\n    var getClosestBelowPosition = function (root, table, start) {\n      return findClosestPositionInBelowCell(table, start).orThunk(function () {\n        return head(start.getClientRects()).bind(function (rect) {\n          return findClosestHorizontalPositionFromPoint(getPositionsBelow(root, CaretPosition.after(table)), rect.left);\n        });\n      }).getOr(CaretPosition.after(table));\n    };\n    var getTable = function (previous, pos) {\n      var node = pos.getNode(previous);\n      return isElement$1(node) && node.nodeName === 'TABLE' ? Optional.some(node) : Optional.none();\n    };\n    var renderBlock = function (down, editor, table, pos) {\n      var forcedRootBlock = getForcedRootBlock(editor);\n      if (forcedRootBlock) {\n        editor.undoManager.transact(function () {\n          var element = SugarElement.fromTag(forcedRootBlock);\n          setAll(element, getForcedRootBlockAttrs(editor));\n          append(element, SugarElement.fromTag('br'));\n          if (down) {\n            after(SugarElement.fromDom(table), element);\n          } else {\n            before(SugarElement.fromDom(table), element);\n          }\n          var rng = editor.dom.createRng();\n          rng.setStart(element.dom, 0);\n          rng.setEnd(element.dom, 0);\n          moveToRange(editor, rng);\n        });\n      } else {\n        moveToRange(editor, pos.toRange());\n      }\n    };\n    var moveCaret = function (editor, down, pos) {\n      var table = down ? getTable(true, pos) : getTable(false, pos);\n      var last = down === false;\n      table.fold(function () {\n        return moveToRange(editor, pos.toRange());\n      }, function (table) {\n        return positionIn(last, editor.getBody()).filter(function (lastPos) {\n          return lastPos.isEqual(pos);\n        }).fold(function () {\n          return moveToRange(editor, pos.toRange());\n        }, function (_) {\n          return renderBlock(down, editor, table, pos);\n        });\n      });\n    };\n    var navigateVertically = function (editor, down, table, td) {\n      var rng = editor.selection.getRng();\n      var pos = CaretPosition.fromRangeStart(rng);\n      var root = editor.getBody();\n      if (!down && isAtFirstTableCellLine(td, pos)) {\n        var newPos = getClosestAbovePosition(root, table, pos);\n        moveCaret(editor, down, newPos);\n        return true;\n      } else if (down && isAtLastTableCellLine(td, pos)) {\n        var newPos = getClosestBelowPosition(root, table, pos);\n        moveCaret(editor, down, newPos);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var move$1 = function (editor, forward, mover) {\n      return Optional.from(editor.dom.getParent(editor.selection.getNode(), 'td,th')).bind(function (td) {\n        return Optional.from(editor.dom.getParent(td, 'table')).map(function (table) {\n          return mover(editor, forward, table, td);\n        });\n      }).getOr(false);\n    };\n    var moveH$2 = function (editor, forward) {\n      return move$1(editor, forward, navigateHorizontally);\n    };\n    var moveV$3 = function (editor, forward) {\n      return move$1(editor, forward, navigateVertically);\n    };\n\n    var executeKeydownOverride = function (editor, caret, evt) {\n      var os = detect$3().os;\n      execute([\n        {\n          keyCode: VK.RIGHT,\n          action: action(moveH, editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: action(moveH, editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: action(moveV, editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: action(moveV, editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: action(moveH$2, editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: action(moveH$2, editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: action(moveV$3, editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: action(moveV$3, editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: action(moveH$1, editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: action(moveH$1, editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: action(moveV$2, editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: action(moveV$2, editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: action(move, editor, caret, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: action(move, editor, caret, false)\n        },\n        {\n          keyCode: VK.RIGHT,\n          ctrlKey: !os.isOSX(),\n          altKey: os.isOSX(),\n          action: action(moveNextWord, editor, caret)\n        },\n        {\n          keyCode: VK.LEFT,\n          ctrlKey: !os.isOSX(),\n          altKey: os.isOSX(),\n          action: action(movePrevWord, editor, caret)\n        },\n        {\n          keyCode: VK.UP,\n          action: action(moveV$1, editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: action(moveV$1, editor, true)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$c = function (editor, caret) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride(editor, caret, evt);\n        }\n      });\n    };\n\n    var executeKeydownOverride$1 = function (editor, caret, evt) {\n      execute([\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$9, editor, false)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$4, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$4, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$3, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$3, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$6, editor, caret, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$6, editor, caret, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$5, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$5, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$8, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$8, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$2, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$2, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$1, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$1, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$7, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$7, editor, true)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var executeKeyupOverride = function (editor, evt) {\n      execute([\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(paddEmptyElement, editor)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(paddEmptyElement, editor)\n        }\n      ], evt);\n    };\n    var setup$d = function (editor, caret) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$1(editor, caret, evt);\n        }\n      });\n      editor.on('keyup', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeyupOverride(editor, evt);\n        }\n      });\n    };\n\n    var firstNonWhiteSpaceNodeSibling = function (node) {\n      while (node) {\n        if (node.nodeType === 1 || node.nodeType === 3 && node.data && /[\\r\\n\\s]/.test(node.data)) {\n          return node;\n        }\n        node = node.nextSibling;\n      }\n    };\n    var moveToCaretPosition = function (editor, root) {\n      var node, lastNode = root;\n      var dom = editor.dom;\n      var moveCaretBeforeOnEnterElementsMap = editor.schema.getMoveCaretBeforeOnEnterElements();\n      if (!root) {\n        return;\n      }\n      if (/^(LI|DT|DD)$/.test(root.nodeName)) {\n        var firstChild = firstNonWhiteSpaceNodeSibling(root.firstChild);\n        if (firstChild && /^(UL|OL|DL)$/.test(firstChild.nodeName)) {\n          root.insertBefore(dom.doc.createTextNode(nbsp), root.firstChild);\n        }\n      }\n      var rng = dom.createRng();\n      root.normalize();\n      if (root.hasChildNodes()) {\n        var walker = new DomTreeWalker(root, root);\n        while (node = walker.current()) {\n          if (isText$1(node)) {\n            rng.setStart(node, 0);\n            rng.setEnd(node, 0);\n            break;\n          }\n          if (moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]) {\n            rng.setStartBefore(node);\n            rng.setEndBefore(node);\n            break;\n          }\n          lastNode = node;\n          node = walker.next();\n        }\n        if (!node) {\n          rng.setStart(lastNode, 0);\n          rng.setEnd(lastNode, 0);\n        }\n      } else {\n        if (isBr(root)) {\n          if (root.nextSibling && dom.isBlock(root.nextSibling)) {\n            rng.setStartBefore(root);\n            rng.setEndBefore(root);\n          } else {\n            rng.setStartAfter(root);\n            rng.setEndAfter(root);\n          }\n        } else {\n          rng.setStart(root, 0);\n          rng.setEnd(root, 0);\n        }\n      }\n      editor.selection.setRng(rng);\n      scrollRangeIntoView(editor, rng);\n    };\n    var getEditableRoot = function (dom, node) {\n      var root = dom.getRoot();\n      var parent, editableRoot;\n      parent = node;\n      while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n        if (dom.getContentEditable(parent) === 'true') {\n          editableRoot = parent;\n        }\n        parent = parent.parentNode;\n      }\n      return parent !== root ? editableRoot : root;\n    };\n    var getParentBlock$2 = function (editor) {\n      return Optional.from(editor.dom.getParent(editor.selection.getStart(true), editor.dom.isBlock));\n    };\n    var getParentBlockName = function (editor) {\n      return getParentBlock$2(editor).fold(constant(''), function (parentBlock) {\n        return parentBlock.nodeName.toUpperCase();\n      });\n    };\n    var isListItemParentBlock = function (editor) {\n      return getParentBlock$2(editor).filter(function (elm) {\n        return isListItem(SugarElement.fromDom(elm));\n      }).isSome();\n    };\n\n    var hasFirstChild = function (elm, name) {\n      return elm.firstChild && elm.firstChild.nodeName === name;\n    };\n    var isFirstChild = function (elm) {\n      var _a;\n      return ((_a = elm.parentNode) === null || _a === void 0 ? void 0 : _a.firstChild) === elm;\n    };\n    var hasParent$1 = function (elm, parentName) {\n      return elm && elm.parentNode && elm.parentNode.nodeName === parentName;\n    };\n    var isListBlock = function (elm) {\n      return elm && /^(OL|UL|LI)$/.test(elm.nodeName);\n    };\n    var isNestedList = function (elm) {\n      return isListBlock(elm) && isListBlock(elm.parentNode);\n    };\n    var getContainerBlock = function (containerBlock) {\n      var containerBlockParent = containerBlock.parentNode;\n      if (/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)) {\n        return containerBlockParent;\n      }\n      return containerBlock;\n    };\n    var isFirstOrLastLi = function (containerBlock, parentBlock, first) {\n      var node = containerBlock[first ? 'firstChild' : 'lastChild'];\n      while (node) {\n        if (isElement$1(node)) {\n          break;\n        }\n        node = node[first ? 'nextSibling' : 'previousSibling'];\n      }\n      return node === parentBlock;\n    };\n    var insert = function (editor, createNewBlock, containerBlock, parentBlock, newBlockName) {\n      var dom = editor.dom;\n      var rng = editor.selection.getRng();\n      if (containerBlock === editor.getBody()) {\n        return;\n      }\n      if (isNestedList(containerBlock)) {\n        newBlockName = 'LI';\n      }\n      var newBlock = newBlockName ? createNewBlock(newBlockName) : dom.create('BR');\n      if (isFirstOrLastLi(containerBlock, parentBlock, true) && isFirstOrLastLi(containerBlock, parentBlock, false)) {\n        if (hasParent$1(containerBlock, 'LI')) {\n          var containerBlockParent = getContainerBlock(containerBlock);\n          dom.insertAfter(newBlock, containerBlockParent);\n          if (isFirstChild(containerBlock)) {\n            dom.remove(containerBlockParent);\n          } else {\n            dom.remove(containerBlock);\n          }\n        } else {\n          dom.replace(newBlock, containerBlock);\n        }\n      } else if (isFirstOrLastLi(containerBlock, parentBlock, true)) {\n        if (hasParent$1(containerBlock, 'LI')) {\n          dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n          newBlock.appendChild(dom.doc.createTextNode(' '));\n          newBlock.appendChild(containerBlock);\n        } else {\n          containerBlock.parentNode.insertBefore(newBlock, containerBlock);\n        }\n        dom.remove(parentBlock);\n      } else if (isFirstOrLastLi(containerBlock, parentBlock, false)) {\n        dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n        dom.remove(parentBlock);\n      } else {\n        containerBlock = getContainerBlock(containerBlock);\n        var tmpRng = rng.cloneRange();\n        tmpRng.setStartAfter(parentBlock);\n        tmpRng.setEndAfter(containerBlock);\n        var fragment = tmpRng.extractContents();\n        if (newBlockName === 'LI' && hasFirstChild(fragment, 'LI')) {\n          newBlock = fragment.firstChild;\n          dom.insertAfter(fragment, containerBlock);\n        } else {\n          dom.insertAfter(fragment, containerBlock);\n          dom.insertAfter(newBlock, containerBlock);\n        }\n        dom.remove(parentBlock);\n      }\n      moveToCaretPosition(editor, newBlock);\n    };\n\n    var trimZwsp = function (fragment) {\n      each(descendants(SugarElement.fromDom(fragment), isText), function (text) {\n        var rawNode = text.dom;\n        rawNode.nodeValue = trim$2(rawNode.nodeValue);\n      });\n    };\n    var isEmptyAnchor = function (dom, elm) {\n      return elm && elm.nodeName === 'A' && dom.isEmpty(elm);\n    };\n    var isTableCell$5 = function (node) {\n      return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n    };\n    var emptyBlock = function (elm) {\n      elm.innerHTML = '<br data-mce-bogus=\"1\">';\n    };\n    var containerAndSiblingName = function (container, nodeName) {\n      return container.nodeName === nodeName || container.previousSibling && container.previousSibling.nodeName === nodeName;\n    };\n    var canSplitBlock = function (dom, node) {\n      return node && dom.isBlock(node) && !/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName) && !/^(fixed|absolute)/i.test(node.style.position) && dom.getContentEditable(node) !== 'true';\n    };\n    var trimInlineElementsOnLeftSideOfBlock = function (dom, nonEmptyElementsMap, block) {\n      var node = block;\n      var firstChilds = [];\n      var i;\n      if (!node) {\n        return;\n      }\n      while (node = node.firstChild) {\n        if (dom.isBlock(node)) {\n          return;\n        }\n        if (isElement$1(node) && !nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n          firstChilds.push(node);\n        }\n      }\n      i = firstChilds.length;\n      while (i--) {\n        node = firstChilds[i];\n        if (!node.hasChildNodes() || node.firstChild === node.lastChild && node.firstChild.nodeValue === '') {\n          dom.remove(node);\n        } else {\n          if (isEmptyAnchor(dom, node)) {\n            dom.remove(node);\n          }\n        }\n      }\n    };\n    var normalizeZwspOffset = function (start, container, offset) {\n      if (isText$1(container) === false) {\n        return offset;\n      } else if (start) {\n        return offset === 1 && container.data.charAt(offset - 1) === ZWSP ? 0 : offset;\n      } else {\n        return offset === container.data.length - 1 && container.data.charAt(offset) === ZWSP ? container.data.length : offset;\n      }\n    };\n    var includeZwspInRange = function (rng) {\n      var newRng = rng.cloneRange();\n      newRng.setStart(rng.startContainer, normalizeZwspOffset(true, rng.startContainer, rng.startOffset));\n      newRng.setEnd(rng.endContainer, normalizeZwspOffset(false, rng.endContainer, rng.endOffset));\n      return newRng;\n    };\n    var trimLeadingLineBreaks = function (node) {\n      do {\n        if (isText$1(node)) {\n          node.nodeValue = node.nodeValue.replace(/^[\\r\\n]+/, '');\n        }\n        node = node.firstChild;\n      } while (node);\n    };\n    var getEditableRoot$1 = function (dom, node) {\n      var root = dom.getRoot();\n      var parent, editableRoot;\n      parent = node;\n      while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n        if (dom.getContentEditable(parent) === 'true') {\n          editableRoot = parent;\n        }\n        parent = parent.parentNode;\n      }\n      return parent !== root ? editableRoot : root;\n    };\n    var applyAttributes = function (editor, node, forcedRootBlockAttrs) {\n      var dom = editor.dom;\n      Optional.from(forcedRootBlockAttrs.style).map(dom.parseStyle).each(function (attrStyles) {\n        var currentStyles = getAllRaw(SugarElement.fromDom(node));\n        var newStyles = __assign(__assign({}, currentStyles), attrStyles);\n        dom.setStyles(node, newStyles);\n      });\n      var attrClassesOpt = Optional.from(forcedRootBlockAttrs.class).map(function (attrClasses) {\n        return attrClasses.split(/\\s+/);\n      });\n      var currentClassesOpt = Optional.from(node.className).map(function (currentClasses) {\n        return filter(currentClasses.split(/\\s+/), function (clazz) {\n          return clazz !== '';\n        });\n      });\n      lift2(attrClassesOpt, currentClassesOpt, function (attrClasses, currentClasses) {\n        var filteredClasses = filter(currentClasses, function (clazz) {\n          return !contains(attrClasses, clazz);\n        });\n        var newClasses = __spreadArrays(attrClasses, filteredClasses);\n        dom.setAttrib(node, 'class', newClasses.join(' '));\n      });\n      var appliedAttrs = [\n        'style',\n        'class'\n      ];\n      var remainingAttrs = filter$1(forcedRootBlockAttrs, function (_, attrs) {\n        return !contains(appliedAttrs, attrs);\n      });\n      dom.setAttribs(node, remainingAttrs);\n    };\n    var setForcedBlockAttrs = function (editor, node) {\n      var forcedRootBlockName = getForcedRootBlock(editor);\n      if (forcedRootBlockName && forcedRootBlockName.toLowerCase() === node.tagName.toLowerCase()) {\n        var forcedRootBlockAttrs = getForcedRootBlockAttrs(editor);\n        applyAttributes(editor, node, forcedRootBlockAttrs);\n      }\n    };\n    var wrapSelfAndSiblingsInDefaultBlock = function (editor, newBlockName, rng, container, offset) {\n      var newBlock, parentBlock, startNode, node, next, rootBlockName;\n      var blockName = newBlockName || 'P';\n      var dom = editor.dom, editableRoot = getEditableRoot$1(dom, container);\n      parentBlock = dom.getParent(container, dom.isBlock);\n      if (!parentBlock || !canSplitBlock(dom, parentBlock)) {\n        parentBlock = parentBlock || editableRoot;\n        if (parentBlock === editor.getBody() || isTableCell$5(parentBlock)) {\n          rootBlockName = parentBlock.nodeName.toLowerCase();\n        } else {\n          rootBlockName = parentBlock.parentNode.nodeName.toLowerCase();\n        }\n        if (!parentBlock.hasChildNodes()) {\n          newBlock = dom.create(blockName);\n          setForcedBlockAttrs(editor, newBlock);\n          parentBlock.appendChild(newBlock);\n          rng.setStart(newBlock, 0);\n          rng.setEnd(newBlock, 0);\n          return newBlock;\n        }\n        node = container;\n        while (node.parentNode !== parentBlock) {\n          node = node.parentNode;\n        }\n        while (node && !dom.isBlock(node)) {\n          startNode = node;\n          node = node.previousSibling;\n        }\n        if (startNode && editor.schema.isValidChild(rootBlockName, blockName.toLowerCase())) {\n          newBlock = dom.create(blockName);\n          setForcedBlockAttrs(editor, newBlock);\n          startNode.parentNode.insertBefore(newBlock, startNode);\n          node = startNode;\n          while (node && !dom.isBlock(node)) {\n            next = node.nextSibling;\n            newBlock.appendChild(node);\n            node = next;\n          }\n          rng.setStart(container, offset);\n          rng.setEnd(container, offset);\n        }\n      }\n      return container;\n    };\n    var addBrToBlockIfNeeded = function (dom, block) {\n      block.normalize();\n      var lastChild = block.lastChild;\n      if (!lastChild || /^(left|right)$/gi.test(dom.getStyle(lastChild, 'float', true))) {\n        dom.add(block, 'br');\n      }\n    };\n    var insert$1 = function (editor, evt) {\n      var tmpRng, container, offset, parentBlock;\n      var newBlock, fragment, containerBlock, parentBlockName, newBlockName, isAfterLastNodeInContainer;\n      var dom = editor.dom;\n      var schema = editor.schema, nonEmptyElementsMap = schema.getNonEmptyElements();\n      var rng = editor.selection.getRng();\n      var createNewBlock = function (name) {\n        var node = container, block, clonedNode, caretNode;\n        var textInlineElements = schema.getTextInlineElements();\n        if (name || parentBlockName === 'TABLE' || parentBlockName === 'HR') {\n          block = dom.create(name || newBlockName);\n        } else {\n          block = parentBlock.cloneNode(false);\n        }\n        caretNode = block;\n        if (shouldKeepStyles(editor) === false) {\n          dom.setAttrib(block, 'style', null);\n          dom.setAttrib(block, 'class', null);\n        } else {\n          do {\n            if (textInlineElements[node.nodeName]) {\n              if (isCaretNode(node) || isBookmarkNode$1(node)) {\n                continue;\n              }\n              clonedNode = node.cloneNode(false);\n              dom.setAttrib(clonedNode, 'id', '');\n              if (block.hasChildNodes()) {\n                clonedNode.appendChild(block.firstChild);\n                block.appendChild(clonedNode);\n              } else {\n                caretNode = clonedNode;\n                block.appendChild(clonedNode);\n              }\n            }\n          } while ((node = node.parentNode) && node !== editableRoot);\n        }\n        setForcedBlockAttrs(editor, block);\n        emptyBlock(caretNode);\n        return block;\n      };\n      var isCaretAtStartOrEndOfBlock = function (start) {\n        var node, name;\n        var normalizedOffset = normalizeZwspOffset(start, container, offset);\n        if (isText$1(container) && (start ? normalizedOffset > 0 : normalizedOffset < container.nodeValue.length)) {\n          return false;\n        }\n        if (container.parentNode === parentBlock && isAfterLastNodeInContainer && !start) {\n          return true;\n        }\n        if (start && isElement$1(container) && container === parentBlock.firstChild) {\n          return true;\n        }\n        if (containerAndSiblingName(container, 'TABLE') || containerAndSiblingName(container, 'HR')) {\n          return isAfterLastNodeInContainer && !start || !isAfterLastNodeInContainer && start;\n        }\n        var walker = new DomTreeWalker(container, parentBlock);\n        if (isText$1(container)) {\n          if (start && normalizedOffset === 0) {\n            walker.prev();\n          } else if (!start && normalizedOffset === container.nodeValue.length) {\n            walker.next();\n          }\n        }\n        while (node = walker.current()) {\n          if (isElement$1(node)) {\n            if (!node.getAttribute('data-mce-bogus')) {\n              name = node.nodeName.toLowerCase();\n              if (nonEmptyElementsMap[name] && name !== 'br') {\n                return false;\n              }\n            }\n          } else if (isText$1(node) && !isWhitespaceText(node.nodeValue)) {\n            return false;\n          }\n          if (start) {\n            walker.prev();\n          } else {\n            walker.next();\n          }\n        }\n        return true;\n      };\n      var insertNewBlockAfter = function () {\n        if (/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName) && containerBlockName !== 'HGROUP') {\n          newBlock = createNewBlock(newBlockName);\n        } else {\n          newBlock = createNewBlock();\n        }\n        if (shouldEndContainerOnEmptyBlock(editor) && canSplitBlock(dom, containerBlock) && dom.isEmpty(parentBlock)) {\n          newBlock = dom.split(containerBlock, parentBlock);\n        } else {\n          dom.insertAfter(newBlock, parentBlock);\n        }\n        moveToCaretPosition(editor, newBlock);\n      };\n      normalize(dom, rng).each(function (normRng) {\n        rng.setStart(normRng.startContainer, normRng.startOffset);\n        rng.setEnd(normRng.endContainer, normRng.endOffset);\n      });\n      container = rng.startContainer;\n      offset = rng.startOffset;\n      newBlockName = getForcedRootBlock(editor);\n      var shiftKey = !!(evt && evt.shiftKey);\n      var ctrlKey = !!(evt && evt.ctrlKey);\n      if (isElement$1(container) && container.hasChildNodes()) {\n        isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n        if (isAfterLastNodeInContainer && isText$1(container)) {\n          offset = container.nodeValue.length;\n        } else {\n          offset = 0;\n        }\n      }\n      var editableRoot = getEditableRoot$1(dom, container);\n      if (!editableRoot) {\n        return;\n      }\n      if (newBlockName && !shiftKey || !newBlockName && shiftKey) {\n        container = wrapSelfAndSiblingsInDefaultBlock(editor, newBlockName, rng, container, offset);\n      }\n      parentBlock = dom.getParent(container, dom.isBlock);\n      containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n      parentBlockName = parentBlock ? parentBlock.nodeName.toUpperCase() : '';\n      var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n      if (containerBlockName === 'LI' && !ctrlKey) {\n        parentBlock = containerBlock;\n        containerBlock = containerBlock.parentNode;\n        parentBlockName = containerBlockName;\n      }\n      if (/^(LI|DT|DD)$/.test(parentBlockName)) {\n        if (dom.isEmpty(parentBlock)) {\n          insert(editor, createNewBlock, containerBlock, parentBlock, newBlockName);\n          return;\n        }\n      }\n      if (newBlockName && parentBlock === editor.getBody()) {\n        return;\n      }\n      newBlockName = newBlockName || 'P';\n      if (isCaretContainerBlock(parentBlock)) {\n        newBlock = showCaretContainerBlock(parentBlock);\n        if (dom.isEmpty(parentBlock)) {\n          emptyBlock(parentBlock);\n        }\n        setForcedBlockAttrs(editor, newBlock);\n        moveToCaretPosition(editor, newBlock);\n      } else if (isCaretAtStartOrEndOfBlock()) {\n        insertNewBlockAfter();\n      } else if (isCaretAtStartOrEndOfBlock(true)) {\n        newBlock = parentBlock.parentNode.insertBefore(createNewBlock(), parentBlock);\n        moveToCaretPosition(editor, containerAndSiblingName(parentBlock, 'HR') ? newBlock : parentBlock);\n      } else {\n        tmpRng = includeZwspInRange(rng).cloneRange();\n        tmpRng.setEndAfter(parentBlock);\n        fragment = tmpRng.extractContents();\n        trimZwsp(fragment);\n        trimLeadingLineBreaks(fragment);\n        newBlock = fragment.firstChild;\n        dom.insertAfter(fragment, parentBlock);\n        trimInlineElementsOnLeftSideOfBlock(dom, nonEmptyElementsMap, newBlock);\n        addBrToBlockIfNeeded(dom, parentBlock);\n        if (dom.isEmpty(parentBlock)) {\n          emptyBlock(parentBlock);\n        }\n        newBlock.normalize();\n        if (dom.isEmpty(newBlock)) {\n          dom.remove(newBlock);\n          insertNewBlockAfter();\n        } else {\n          setForcedBlockAttrs(editor, newBlock);\n          moveToCaretPosition(editor, newBlock);\n        }\n      }\n      dom.setAttrib(newBlock, 'id', '');\n      editor.fire('NewBlock', { newBlock: newBlock });\n    };\n\n    var hasRightSideContent = function (schema, container, parentBlock) {\n      var walker = new DomTreeWalker(container, parentBlock);\n      var node;\n      var nonEmptyElementsMap = schema.getNonEmptyElements();\n      while (node = walker.next()) {\n        if (nonEmptyElementsMap[node.nodeName.toLowerCase()] || node.length > 0) {\n          return true;\n        }\n      }\n    };\n    var moveSelectionToBr = function (editor, brElm, extraBr) {\n      var rng = editor.dom.createRng();\n      if (!extraBr) {\n        rng.setStartAfter(brElm);\n        rng.setEndAfter(brElm);\n      } else {\n        rng.setStartBefore(brElm);\n        rng.setEndBefore(brElm);\n      }\n      editor.selection.setRng(rng);\n      scrollRangeIntoView(editor, rng);\n    };\n    var insertBrAtCaret = function (editor, evt) {\n      var selection = editor.selection;\n      var dom = editor.dom;\n      var rng = selection.getRng();\n      var brElm;\n      var extraBr;\n      normalize(dom, rng).each(function (normRng) {\n        rng.setStart(normRng.startContainer, normRng.startOffset);\n        rng.setEnd(normRng.endContainer, normRng.endOffset);\n      });\n      var offset = rng.startOffset;\n      var container = rng.startContainer;\n      if (container.nodeType === 1 && container.hasChildNodes()) {\n        var isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n        if (isAfterLastNodeInContainer && container.nodeType === 3) {\n          offset = container.nodeValue.length;\n        } else {\n          offset = 0;\n        }\n      }\n      var parentBlock = dom.getParent(container, dom.isBlock);\n      var containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n      var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n      var isControlKey = !!(evt && evt.ctrlKey);\n      if (containerBlockName === 'LI' && !isControlKey) {\n        parentBlock = containerBlock;\n      }\n      if (container && container.nodeType === 3 && offset >= container.nodeValue.length) {\n        if (!hasRightSideContent(editor.schema, container, parentBlock)) {\n          brElm = dom.create('br');\n          rng.insertNode(brElm);\n          rng.setStartAfter(brElm);\n          rng.setEndAfter(brElm);\n          extraBr = true;\n        }\n      }\n      brElm = dom.create('br');\n      rangeInsertNode(dom, rng, brElm);\n      moveSelectionToBr(editor, brElm, extraBr);\n      editor.undoManager.add();\n    };\n    var insertBrBefore = function (editor, inline) {\n      var br = SugarElement.fromTag('br');\n      before(SugarElement.fromDom(inline), br);\n      editor.undoManager.add();\n    };\n    var insertBrAfter = function (editor, inline) {\n      if (!hasBrAfter(editor.getBody(), inline)) {\n        after(SugarElement.fromDom(inline), SugarElement.fromTag('br'));\n      }\n      var br = SugarElement.fromTag('br');\n      after(SugarElement.fromDom(inline), br);\n      moveSelectionToBr(editor, br.dom, false);\n      editor.undoManager.add();\n    };\n    var isBeforeBr$1 = function (pos) {\n      return isBr(pos.getNode());\n    };\n    var hasBrAfter = function (rootNode, startNode) {\n      if (isBeforeBr$1(CaretPosition.after(startNode))) {\n        return true;\n      } else {\n        return nextPosition(rootNode, CaretPosition.after(startNode)).map(function (pos) {\n          return isBr(pos.getNode());\n        }).getOr(false);\n      }\n    };\n    var isAnchorLink = function (elm) {\n      return elm && elm.nodeName === 'A' && 'href' in elm;\n    };\n    var isInsideAnchor = function (location) {\n      return location.fold(never, isAnchorLink, isAnchorLink, never);\n    };\n    var readInlineAnchorLocation = function (editor) {\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      var position = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return readLocation(isInlineTarget$1, editor.getBody(), position).filter(isInsideAnchor);\n    };\n    var insertBrOutsideAnchor = function (editor, location) {\n      location.fold(noop, curry(insertBrBefore, editor), curry(insertBrAfter, editor), noop);\n    };\n    var insert$2 = function (editor, evt) {\n      var anchorLocation = readInlineAnchorLocation(editor);\n      if (anchorLocation.isSome()) {\n        anchorLocation.each(curry(insertBrOutsideAnchor, editor));\n      } else {\n        insertBrAtCaret(editor, evt);\n      }\n    };\n\n    var matchesSelector = function (editor, selector) {\n      return getParentBlock$2(editor).filter(function (parentBlock) {\n        return selector.length > 0 && is$1(SugarElement.fromDom(parentBlock), selector);\n      }).isSome();\n    };\n    var shouldInsertBr = function (editor) {\n      return matchesSelector(editor, getBrNewLineSelector(editor));\n    };\n    var shouldBlockNewLine = function (editor) {\n      return matchesSelector(editor, getNoNewLineSelector(editor));\n    };\n\n    var newLineAction = Adt.generate([\n      { br: [] },\n      { block: [] },\n      { none: [] }\n    ]);\n    var shouldBlockNewLine$1 = function (editor, _shiftKey) {\n      return shouldBlockNewLine(editor);\n    };\n    var isBrMode = function (requiredState) {\n      return function (editor, _shiftKey) {\n        var brMode = getForcedRootBlock(editor) === '';\n        return brMode === requiredState;\n      };\n    };\n    var inListBlock = function (requiredState) {\n      return function (editor, _shiftKey) {\n        return isListItemParentBlock(editor) === requiredState;\n      };\n    };\n    var inBlock = function (blockName, requiredState) {\n      return function (editor, _shiftKey) {\n        var state = getParentBlockName(editor) === blockName.toUpperCase();\n        return state === requiredState;\n      };\n    };\n    var inPreBlock = function (requiredState) {\n      return inBlock('pre', requiredState);\n    };\n    var inSummaryBlock = function () {\n      return inBlock('summary', true);\n    };\n    var shouldPutBrInPre$1 = function (requiredState) {\n      return function (editor, _shiftKey) {\n        return shouldPutBrInPre(editor) === requiredState;\n      };\n    };\n    var inBrContext = function (editor, _shiftKey) {\n      return shouldInsertBr(editor);\n    };\n    var hasShiftKey = function (_editor, shiftKey) {\n      return shiftKey;\n    };\n    var canInsertIntoEditableRoot = function (editor) {\n      var forcedRootBlock = getForcedRootBlock(editor);\n      var rootEditable = getEditableRoot(editor.dom, editor.selection.getStart());\n      return rootEditable && editor.schema.isValidChild(rootEditable.nodeName, forcedRootBlock ? forcedRootBlock : 'P');\n    };\n    var match$2 = function (predicates, action) {\n      return function (editor, shiftKey) {\n        var isMatch = foldl(predicates, function (res, p) {\n          return res && p(editor, shiftKey);\n        }, true);\n        return isMatch ? Optional.some(action) : Optional.none();\n      };\n    };\n    var getAction$1 = function (editor, evt) {\n      return evaluateUntil([\n        match$2([shouldBlockNewLine$1], newLineAction.none()),\n        match$2([inSummaryBlock()], newLineAction.br()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(false),\n          hasShiftKey\n        ], newLineAction.br()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(false)\n        ], newLineAction.block()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(true),\n          hasShiftKey\n        ], newLineAction.block()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(true)\n        ], newLineAction.br()),\n        match$2([\n          inListBlock(true),\n          hasShiftKey\n        ], newLineAction.br()),\n        match$2([inListBlock(true)], newLineAction.block()),\n        match$2([\n          isBrMode(true),\n          hasShiftKey,\n          canInsertIntoEditableRoot\n        ], newLineAction.block()),\n        match$2([isBrMode(true)], newLineAction.br()),\n        match$2([inBrContext], newLineAction.br()),\n        match$2([\n          isBrMode(false),\n          hasShiftKey\n        ], newLineAction.br()),\n        match$2([canInsertIntoEditableRoot], newLineAction.block())\n      ], [\n        editor,\n        !!(evt && evt.shiftKey)\n      ]).getOr(newLineAction.none());\n    };\n\n    var insert$3 = function (editor, evt) {\n      getAction$1(editor, evt).fold(function () {\n        insert$2(editor, evt);\n      }, function () {\n        insert$1(editor, evt);\n      }, noop);\n    };\n\n    var handleEnterKeyEvent = function (editor, event) {\n      if (event.isDefaultPrevented()) {\n        return;\n      }\n      event.preventDefault();\n      endTypingLevelIgnoreLocks(editor.undoManager);\n      editor.undoManager.transact(function () {\n        if (editor.selection.isCollapsed() === false) {\n          editor.execCommand('Delete');\n        }\n        insert$3(editor, event);\n      });\n    };\n    var setup$e = function (editor) {\n      editor.on('keydown', function (event) {\n        if (event.keyCode === VK.ENTER) {\n          handleEnterKeyEvent(editor, event);\n        }\n      });\n    };\n\n    var executeKeydownOverride$2 = function (editor, evt) {\n      execute([\n        {\n          keyCode: VK.END,\n          action: action(moveToLineEndPoint$1, editor, true)\n        },\n        {\n          keyCode: VK.HOME,\n          action: action(moveToLineEndPoint$1, editor, false)\n        },\n        {\n          keyCode: VK.END,\n          action: action(moveToLineEndPoint$2, editor, true)\n        },\n        {\n          keyCode: VK.HOME,\n          action: action(moveToLineEndPoint$2, editor, false)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$f = function (editor) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$2(editor, evt);\n        }\n      });\n    };\n\n    var browser$4 = detect$3().browser;\n    var setupIeInput = function (editor) {\n      var keypressThrotter = first(function () {\n        if (!editor.composing) {\n          normalizeNbspsInEditor(editor);\n        }\n      }, 0);\n      if (browser$4.isIE()) {\n        editor.on('keypress', function (_e) {\n          keypressThrotter.throttle();\n        });\n        editor.on('remove', function (_e) {\n          keypressThrotter.cancel();\n        });\n      }\n    };\n    var setup$g = function (editor) {\n      setupIeInput(editor);\n      editor.on('input', function (e) {\n        if (e.isComposing === false) {\n          normalizeNbspsInEditor(editor);\n        }\n      });\n    };\n\n    var insertTextAtPosition = function (text, pos) {\n      var container = pos.container();\n      var offset = pos.offset();\n      if (isText$1(container)) {\n        container.insertData(offset, text);\n        return Optional.some(CaretPosition(container, offset + text.length));\n      } else {\n        return getElementFromPosition(pos).map(function (elm) {\n          var textNode = SugarElement.fromText(text);\n          if (pos.isAtEnd()) {\n            after(elm, textNode);\n          } else {\n            before(elm, textNode);\n          }\n          return CaretPosition(textNode.dom, text.length);\n        });\n      }\n    };\n    var insertNbspAtPosition = curry(insertTextAtPosition, nbsp);\n    var insertSpaceAtPosition = curry(insertTextAtPosition, ' ');\n\n    var locationToCaretPosition = function (root) {\n      return function (location) {\n        return location.fold(function (element) {\n          return prevPosition(root.dom, CaretPosition.before(element));\n        }, function (element) {\n          return firstPositionIn(element);\n        }, function (element) {\n          return lastPositionIn(element);\n        }, function (element) {\n          return nextPosition(root.dom, CaretPosition.after(element));\n        });\n      };\n    };\n    var insertInlineBoundarySpaceOrNbsp = function (root, pos) {\n      return function (checkPos) {\n        return needsToHaveNbsp(root, checkPos) ? insertNbspAtPosition(pos) : insertSpaceAtPosition(pos);\n      };\n    };\n    var setSelection$1 = function (editor) {\n      return function (pos) {\n        editor.selection.setRng(pos.toRange());\n        editor.nodeChanged();\n        return true;\n      };\n    };\n    var insertSpaceOrNbspAtSelection = function (editor) {\n      var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n      var root = SugarElement.fromDom(editor.getBody());\n      if (editor.selection.isCollapsed()) {\n        var isInlineTarget$1 = curry(isInlineTarget, editor);\n        var caretPosition = CaretPosition.fromRangeStart(editor.selection.getRng());\n        return readLocation(isInlineTarget$1, editor.getBody(), caretPosition).bind(locationToCaretPosition(root)).bind(insertInlineBoundarySpaceOrNbsp(root, pos)).exists(setSelection$1(editor));\n      } else {\n        return false;\n      }\n    };\n\n    var executeKeydownOverride$3 = function (editor, evt) {\n      execute([{\n          keyCode: VK.SPACEBAR,\n          action: action(insertSpaceOrNbspAtSelection, editor)\n        }], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$h = function (editor) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$3(editor, evt);\n        }\n      });\n    };\n\n    var registerKeyboardOverrides = function (editor) {\n      var caret = setupSelectedState(editor);\n      setup$b(editor);\n      setup$c(editor, caret);\n      setup$d(editor, caret);\n      setup$e(editor);\n      setup$h(editor);\n      setup$g(editor);\n      setup$f(editor);\n      return caret;\n    };\n    var setup$i = function (editor) {\n      if (!isRtc(editor)) {\n        return registerKeyboardOverrides(editor);\n      } else {\n        return Cell(null);\n      }\n    };\n\n    var NodeChange = function () {\n      function NodeChange(editor) {\n        this.lastPath = [];\n        this.editor = editor;\n        var lastRng;\n        var self = this;\n        if (!('onselectionchange' in editor.getDoc())) {\n          editor.on('NodeChange click mouseup keyup focus', function (e) {\n            var nativeRng = editor.selection.getRng();\n            var fakeRng = {\n              startContainer: nativeRng.startContainer,\n              startOffset: nativeRng.startOffset,\n              endContainer: nativeRng.endContainer,\n              endOffset: nativeRng.endOffset\n            };\n            if (e.type === 'nodechange' || !isEq$1(fakeRng, lastRng)) {\n              editor.fire('SelectionChange');\n            }\n            lastRng = fakeRng;\n          });\n        }\n        editor.on('contextmenu', function () {\n          editor.fire('SelectionChange');\n        });\n        editor.on('SelectionChange', function () {\n          var startElm = editor.selection.getStart(true);\n          if (!startElm || !Env.range && editor.selection.isCollapsed()) {\n            return;\n          }\n          if (hasAnyRanges(editor) && !self.isSameElementPath(startElm) && editor.dom.isChildOf(startElm, editor.getBody())) {\n            editor.nodeChanged({ selectionChange: true });\n          }\n        });\n        editor.on('mouseup', function (e) {\n          if (!e.isDefaultPrevented() && hasAnyRanges(editor)) {\n            if (editor.selection.getNode().nodeName === 'IMG') {\n              Delay.setEditorTimeout(editor, function () {\n                editor.nodeChanged();\n              });\n            } else {\n              editor.nodeChanged();\n            }\n          }\n        });\n      }\n      NodeChange.prototype.nodeChanged = function (args) {\n        var selection = this.editor.selection;\n        var node, parents, root;\n        if (this.editor.initialized && selection && !shouldDisableNodeChange(this.editor) && !this.editor.mode.isReadOnly()) {\n          root = this.editor.getBody();\n          node = selection.getStart(true) || root;\n          if (node.ownerDocument !== this.editor.getDoc() || !this.editor.dom.isChildOf(node, root)) {\n            node = root;\n          }\n          parents = [];\n          this.editor.dom.getParent(node, function (node) {\n            if (node === root) {\n              return true;\n            }\n            parents.push(node);\n          });\n          args = args || {};\n          args.element = node;\n          args.parents = parents;\n          this.editor.fire('NodeChange', args);\n        }\n      };\n      NodeChange.prototype.isSameElementPath = function (startElm) {\n        var i;\n        var currentPath = this.editor.$(startElm).parentsUntil(this.editor.getBody()).add(startElm);\n        if (currentPath.length === this.lastPath.length) {\n          for (i = currentPath.length; i >= 0; i--) {\n            if (currentPath[i] !== this.lastPath[i]) {\n              break;\n            }\n          }\n          if (i === -1) {\n            this.lastPath = currentPath;\n            return true;\n          }\n        }\n        this.lastPath = currentPath;\n        return false;\n      };\n      return NodeChange;\n    }();\n\n    var preventSummaryToggle = function (editor) {\n      editor.on('click', function (e) {\n        if (editor.dom.getParent(e.target, 'details')) {\n          e.preventDefault();\n        }\n      });\n    };\n    var filterDetails = function (editor) {\n      editor.parser.addNodeFilter('details', function (elms) {\n        each(elms, function (details) {\n          details.attr('data-mce-open', details.attr('open'));\n          details.attr('open', 'open');\n        });\n      });\n      editor.serializer.addNodeFilter('details', function (elms) {\n        each(elms, function (details) {\n          var open = details.attr('data-mce-open');\n          details.attr('open', isString(open) ? open : null);\n          details.attr('data-mce-open', null);\n        });\n      });\n    };\n    var setup$j = function (editor) {\n      preventSummaryToggle(editor);\n      filterDetails(editor);\n    };\n\n    var isTextBlockNode = function (node) {\n      return isElement$1(node) && isTextBlock(SugarElement.fromDom(node));\n    };\n    var normalizeSelection$1 = function (editor) {\n      var rng = editor.selection.getRng();\n      var startPos = CaretPosition.fromRangeStart(rng);\n      var endPos = CaretPosition.fromRangeEnd(rng);\n      if (CaretPosition.isElementPosition(startPos)) {\n        var container = startPos.container();\n        if (isTextBlockNode(container)) {\n          firstPositionIn(container).each(function (pos) {\n            return rng.setStart(pos.container(), pos.offset());\n          });\n        }\n      }\n      if (CaretPosition.isElementPosition(endPos)) {\n        var container = startPos.container();\n        if (isTextBlockNode(container)) {\n          lastPositionIn(container).each(function (pos) {\n            return rng.setEnd(pos.container(), pos.offset());\n          });\n        }\n      }\n      editor.selection.setRng(normalize$2(rng));\n    };\n    var setup$k = function (editor) {\n      editor.on('click', function (e) {\n        if (e.detail >= 3) {\n          normalizeSelection$1(editor);\n        }\n      });\n    };\n\n    var value$1 = function () {\n      var subject = Cell(Optional.none());\n      var clear = function () {\n        return subject.set(Optional.none());\n      };\n      var set = function (s) {\n        return subject.set(Optional.some(s));\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var on = function (f) {\n        return subject.get().each(f);\n      };\n      return {\n        clear: clear,\n        set: set,\n        isSet: isSet,\n        on: on\n      };\n    };\n\n    var getAbsolutePosition = function (elm) {\n      var clientRect = elm.getBoundingClientRect();\n      var doc = elm.ownerDocument;\n      var docElem = doc.documentElement;\n      var win = doc.defaultView;\n      return {\n        top: clientRect.top + win.pageYOffset - docElem.clientTop,\n        left: clientRect.left + win.pageXOffset - docElem.clientLeft\n      };\n    };\n    var getBodyPosition = function (editor) {\n      return editor.inline ? getAbsolutePosition(editor.getBody()) : {\n        left: 0,\n        top: 0\n      };\n    };\n    var getScrollPosition = function (editor) {\n      var body = editor.getBody();\n      return editor.inline ? {\n        left: body.scrollLeft,\n        top: body.scrollTop\n      } : {\n        left: 0,\n        top: 0\n      };\n    };\n    var getBodyScroll = function (editor) {\n      var body = editor.getBody(), docElm = editor.getDoc().documentElement;\n      var inlineScroll = {\n        left: body.scrollLeft,\n        top: body.scrollTop\n      };\n      var iframeScroll = {\n        left: body.scrollLeft || docElm.scrollLeft,\n        top: body.scrollTop || docElm.scrollTop\n      };\n      return editor.inline ? inlineScroll : iframeScroll;\n    };\n    var getMousePosition = function (editor, event) {\n      if (event.target.ownerDocument !== editor.getDoc()) {\n        var iframePosition = getAbsolutePosition(editor.getContentAreaContainer());\n        var scrollPosition = getBodyScroll(editor);\n        return {\n          left: event.pageX - iframePosition.left + scrollPosition.left,\n          top: event.pageY - iframePosition.top + scrollPosition.top\n        };\n      }\n      return {\n        left: event.pageX,\n        top: event.pageY\n      };\n    };\n    var calculatePosition = function (bodyPosition, scrollPosition, mousePosition) {\n      return {\n        pageX: mousePosition.left - bodyPosition.left + scrollPosition.left,\n        pageY: mousePosition.top - bodyPosition.top + scrollPosition.top\n      };\n    };\n    var calc = function (editor, event) {\n      return calculatePosition(getBodyPosition(editor), getScrollPosition(editor), getMousePosition(editor, event));\n    };\n\n    var isContentEditableFalse$a = isContentEditableFalse, isContentEditableTrue$3 = isContentEditableTrue;\n    var isDraggable = function (rootElm, elm) {\n      return isContentEditableFalse$a(elm) && elm !== rootElm;\n    };\n    var isValidDropTarget = function (editor, targetElement, dragElement) {\n      if (targetElement === dragElement || editor.dom.isChildOf(targetElement, dragElement)) {\n        return false;\n      }\n      return !isContentEditableFalse$a(targetElement);\n    };\n    var cloneElement = function (elm) {\n      var cloneElm = elm.cloneNode(true);\n      cloneElm.removeAttribute('data-mce-selected');\n      return cloneElm;\n    };\n    var createGhost = function (editor, elm, width, height) {\n      var dom = editor.dom;\n      var clonedElm = elm.cloneNode(true);\n      dom.setStyles(clonedElm, {\n        width: width,\n        height: height\n      });\n      dom.setAttrib(clonedElm, 'data-mce-selected', null);\n      var ghostElm = dom.create('div', {\n        'class': 'mce-drag-container',\n        'data-mce-bogus': 'all',\n        'unselectable': 'on',\n        'contenteditable': 'false'\n      });\n      dom.setStyles(ghostElm, {\n        position: 'absolute',\n        opacity: 0.5,\n        overflow: 'hidden',\n        border: 0,\n        padding: 0,\n        margin: 0,\n        width: width,\n        height: height\n      });\n      dom.setStyles(clonedElm, {\n        margin: 0,\n        boxSizing: 'border-box'\n      });\n      ghostElm.appendChild(clonedElm);\n      return ghostElm;\n    };\n    var appendGhostToBody = function (ghostElm, bodyElm) {\n      if (ghostElm.parentNode !== bodyElm) {\n        bodyElm.appendChild(ghostElm);\n      }\n    };\n    var moveGhost = function (ghostElm, position, width, height, maxX, maxY) {\n      var overflowX = 0, overflowY = 0;\n      ghostElm.style.left = position.pageX + 'px';\n      ghostElm.style.top = position.pageY + 'px';\n      if (position.pageX + width > maxX) {\n        overflowX = position.pageX + width - maxX;\n      }\n      if (position.pageY + height > maxY) {\n        overflowY = position.pageY + height - maxY;\n      }\n      ghostElm.style.width = width - overflowX + 'px';\n      ghostElm.style.height = height - overflowY + 'px';\n    };\n    var removeElement = function (elm) {\n      if (elm && elm.parentNode) {\n        elm.parentNode.removeChild(elm);\n      }\n    };\n    var isLeftMouseButtonPressed = function (e) {\n      return e.button === 0;\n    };\n    var applyRelPos = function (state, position) {\n      return {\n        pageX: position.pageX - state.relX,\n        pageY: position.pageY + 5\n      };\n    };\n    var start$1 = function (state, editor) {\n      return function (e) {\n        if (isLeftMouseButtonPressed(e)) {\n          var ceElm = find(editor.dom.getParents(e.target), or(isContentEditableFalse$a, isContentEditableTrue$3)).getOr(null);\n          if (isDraggable(editor.getBody(), ceElm)) {\n            var elmPos = editor.dom.getPos(ceElm);\n            var bodyElm = editor.getBody();\n            var docElm = editor.getDoc().documentElement;\n            state.set({\n              element: ceElm,\n              dragging: false,\n              screenX: e.screenX,\n              screenY: e.screenY,\n              maxX: (editor.inline ? bodyElm.scrollWidth : docElm.offsetWidth) - 2,\n              maxY: (editor.inline ? bodyElm.scrollHeight : docElm.offsetHeight) - 2,\n              relX: e.pageX - elmPos.x,\n              relY: e.pageY - elmPos.y,\n              width: ceElm.offsetWidth,\n              height: ceElm.offsetHeight,\n              ghost: createGhost(editor, ceElm, ceElm.offsetWidth, ceElm.offsetHeight)\n            });\n          }\n        }\n      };\n    };\n    var move$2 = function (state, editor) {\n      var throttledPlaceCaretAt = Delay.throttle(function (clientX, clientY) {\n        editor._selectionOverrides.hideFakeCaret();\n        editor.selection.placeCaretAt(clientX, clientY);\n      }, 0);\n      editor.on('remove', throttledPlaceCaretAt.stop);\n      return function (e) {\n        return state.on(function (state) {\n          var movement = Math.max(Math.abs(e.screenX - state.screenX), Math.abs(e.screenY - state.screenY));\n          if (!state.dragging && movement > 10) {\n            var args = editor.fire('dragstart', { target: state.element });\n            if (args.isDefaultPrevented()) {\n              return;\n            }\n            state.dragging = true;\n            editor.focus();\n          }\n          if (state.dragging) {\n            var targetPos = applyRelPos(state, calc(editor, e));\n            appendGhostToBody(state.ghost, editor.getBody());\n            moveGhost(state.ghost, targetPos, state.width, state.height, state.maxX, state.maxY);\n            throttledPlaceCaretAt(e.clientX, e.clientY);\n          }\n        });\n      };\n    };\n    var getRawTarget = function (selection) {\n      var rng = selection.getSel().getRangeAt(0);\n      var startContainer = rng.startContainer;\n      return startContainer.nodeType === 3 ? startContainer.parentNode : startContainer;\n    };\n    var drop = function (state, editor) {\n      return function (e) {\n        state.on(function (state) {\n          if (state.dragging) {\n            if (isValidDropTarget(editor, getRawTarget(editor.selection), state.element)) {\n              var targetClone_1 = cloneElement(state.element);\n              var args = editor.fire('drop', {\n                clientX: e.clientX,\n                clientY: e.clientY\n              });\n              if (!args.isDefaultPrevented()) {\n                editor.undoManager.transact(function () {\n                  removeElement(state.element);\n                  editor.insertContent(editor.dom.getOuterHTML(targetClone_1));\n                  editor._selectionOverrides.hideFakeCaret();\n                });\n              }\n            }\n          }\n        });\n        removeDragState(state);\n      };\n    };\n    var stop = function (state, editor) {\n      return function () {\n        state.on(function (state) {\n          if (state.dragging) {\n            editor.fire('dragend');\n          }\n        });\n        removeDragState(state);\n      };\n    };\n    var removeDragState = function (state) {\n      state.on(function (state) {\n        removeElement(state.ghost);\n      });\n      state.clear();\n    };\n    var bindFakeDragEvents = function (editor) {\n      var state = value$1();\n      var pageDom = DOMUtils.DOM;\n      var rootDocument = document;\n      var dragStartHandler = start$1(state, editor);\n      var dragHandler = move$2(state, editor);\n      var dropHandler = drop(state, editor);\n      var dragEndHandler = stop(state, editor);\n      editor.on('mousedown', dragStartHandler);\n      editor.on('mousemove', dragHandler);\n      editor.on('mouseup', dropHandler);\n      pageDom.bind(rootDocument, 'mousemove', dragHandler);\n      pageDom.bind(rootDocument, 'mouseup', dragEndHandler);\n      editor.on('remove', function () {\n        pageDom.unbind(rootDocument, 'mousemove', dragHandler);\n        pageDom.unbind(rootDocument, 'mouseup', dragEndHandler);\n      });\n    };\n    var blockIeDrop = function (editor) {\n      editor.on('drop', function (e) {\n        var realTarget = typeof e.clientX !== 'undefined' ? editor.getDoc().elementFromPoint(e.clientX, e.clientY) : null;\n        if (isContentEditableFalse$a(realTarget) || editor.dom.getContentEditableParent(realTarget) === 'false') {\n          e.preventDefault();\n        }\n      });\n    };\n    var blockUnsupportedFileDrop = function (editor) {\n      var preventFileDrop = function (e) {\n        if (!e.isDefaultPrevented()) {\n          var dataTransfer = e.dataTransfer;\n          if (dataTransfer && (contains(dataTransfer.types, 'Files') || dataTransfer.files.length > 0)) {\n            e.preventDefault();\n            if (e.type === 'drop') {\n              displayError(editor, 'Dropped file type is not supported');\n            }\n          }\n        }\n      };\n      var preventFileDropIfUIElement = function (e) {\n        if (isUIElement(editor, e.target)) {\n          preventFileDrop(e);\n        }\n      };\n      var setup = function () {\n        var pageDom = DOMUtils.DOM;\n        var dom = editor.dom;\n        var doc = document;\n        var editorRoot = editor.inline ? editor.getBody() : editor.getDoc();\n        var eventNames = [\n          'drop',\n          'dragover'\n        ];\n        each(eventNames, function (name) {\n          pageDom.bind(doc, name, preventFileDropIfUIElement);\n          dom.bind(editorRoot, name, preventFileDrop);\n        });\n        editor.on('remove', function () {\n          each(eventNames, function (name) {\n            pageDom.unbind(doc, name, preventFileDropIfUIElement);\n            dom.unbind(editorRoot, name, preventFileDrop);\n          });\n        });\n      };\n      editor.on('init', function () {\n        Delay.setEditorTimeout(editor, setup, 0);\n      });\n    };\n    var init = function (editor) {\n      bindFakeDragEvents(editor);\n      blockIeDrop(editor);\n      if (shouldBlockUnsupportedDrop(editor)) {\n        blockUnsupportedFileDrop(editor);\n      }\n    };\n\n    var setup$l = function (editor) {\n      var renderFocusCaret = first(function () {\n        if (!editor.removed && editor.getBody().contains(document.activeElement)) {\n          var rng = editor.selection.getRng();\n          if (rng.collapsed) {\n            var caretRange = renderRangeCaret(editor, rng, false);\n            editor.selection.setRng(caretRange);\n          }\n        }\n      }, 0);\n      editor.on('focus', function () {\n        renderFocusCaret.throttle();\n      });\n      editor.on('blur', function () {\n        renderFocusCaret.cancel();\n      });\n    };\n\n    var setup$m = function (editor) {\n      editor.on('init', function () {\n        editor.on('focusin', function (e) {\n          var target = e.target;\n          if (isMedia(target)) {\n            var ceRoot = getContentEditableRoot(editor.getBody(), target);\n            var node = isContentEditableFalse(ceRoot) ? ceRoot : target;\n            if (editor.selection.getNode() !== node) {\n              selectNode(editor, node).each(function (rng) {\n                return editor.selection.setRng(rng);\n              });\n            }\n          }\n        });\n      });\n    };\n\n    var isContentEditableTrue$4 = isContentEditableTrue;\n    var isContentEditableFalse$b = isContentEditableFalse;\n    var getContentEditableRoot$1 = function (editor, node) {\n      return getContentEditableRoot(editor.getBody(), node);\n    };\n    var SelectionOverrides = function (editor) {\n      var selection = editor.selection, dom = editor.dom;\n      var isBlock = dom.isBlock;\n      var rootNode = editor.getBody();\n      var fakeCaret = FakeCaret(editor, rootNode, isBlock, function () {\n        return hasFocus$1(editor);\n      });\n      var realSelectionId = 'sel-' + dom.uniqueId();\n      var elementSelectionAttr = 'data-mce-selected';\n      var selectedElement;\n      var isFakeSelectionElement = function (node) {\n        return dom.hasClass(node, 'mce-offscreen-selection');\n      };\n      var isFakeSelectionTargetElement = function (node) {\n        return node !== rootNode && (isContentEditableFalse$b(node) || isMedia(node)) && dom.isChildOf(node, rootNode);\n      };\n      var isNearFakeSelectionElement = function (pos) {\n        return isBeforeContentEditableFalse(pos) || isAfterContentEditableFalse(pos) || isBeforeMedia(pos) || isAfterMedia(pos);\n      };\n      var getRealSelectionElement = function () {\n        var container = dom.get(realSelectionId);\n        return container ? container.getElementsByTagName('*')[0] : container;\n      };\n      var setRange = function (range) {\n        if (range) {\n          selection.setRng(range);\n        }\n      };\n      var getRange = selection.getRng;\n      var showCaret = function (direction, node, before, scrollIntoView) {\n        if (scrollIntoView === void 0) {\n          scrollIntoView = true;\n        }\n        var e = editor.fire('ShowCaret', {\n          target: node,\n          direction: direction,\n          before: before\n        });\n        if (e.isDefaultPrevented()) {\n          return null;\n        }\n        if (scrollIntoView) {\n          selection.scrollIntoView(node, direction === -1);\n        }\n        return fakeCaret.show(before, node);\n      };\n      var showBlockCaretContainer = function (blockCaretContainer) {\n        if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n          showCaretContainerBlock(blockCaretContainer);\n          setRange(getRange());\n          selection.scrollIntoView(blockCaretContainer);\n        }\n      };\n      var registerEvents = function () {\n        editor.on('mouseup', function (e) {\n          var range = getRange();\n          if (range.collapsed && isXYInContentArea(editor, e.clientX, e.clientY)) {\n            renderCaretAtRange(editor, range, false).each(setRange);\n          }\n        });\n        editor.on('click', function (e) {\n          var contentEditableRoot = getContentEditableRoot$1(editor, e.target);\n          if (contentEditableRoot) {\n            if (isContentEditableFalse$b(contentEditableRoot)) {\n              e.preventDefault();\n              editor.focus();\n            }\n            if (isContentEditableTrue$4(contentEditableRoot)) {\n              if (dom.isChildOf(contentEditableRoot, selection.getNode())) {\n                removeElementSelection();\n              }\n            }\n          }\n        });\n        editor.on('blur NewBlock', removeElementSelection);\n        editor.on('ResizeWindow FullscreenStateChanged', fakeCaret.reposition);\n        var hasNormalCaretPosition = function (elm) {\n          var caretWalker = CaretWalker(elm);\n          if (!elm.firstChild) {\n            return false;\n          }\n          var startPos = CaretPosition.before(elm.firstChild);\n          var newPos = caretWalker.next(startPos);\n          return newPos && !isNearFakeSelectionElement(newPos);\n        };\n        var isInSameBlock = function (node1, node2) {\n          var block1 = dom.getParent(node1, isBlock);\n          var block2 = dom.getParent(node2, isBlock);\n          return block1 === block2;\n        };\n        var hasBetterMouseTarget = function (targetNode, caretNode) {\n          var targetBlock = dom.getParent(targetNode, isBlock);\n          var caretBlock = dom.getParent(caretNode, isBlock);\n          if (targetBlock && targetNode !== caretBlock && dom.isChildOf(targetBlock, caretBlock) && isContentEditableFalse$b(getContentEditableRoot$1(editor, targetBlock)) === false) {\n            return true;\n          }\n          return targetBlock && !isInSameBlock(targetBlock, caretBlock) && hasNormalCaretPosition(targetBlock);\n        };\n        editor.on('tap', function (e) {\n          var targetElm = e.target;\n          var contentEditableRoot = getContentEditableRoot$1(editor, targetElm);\n          if (isContentEditableFalse$b(contentEditableRoot)) {\n            e.preventDefault();\n            selectNode(editor, contentEditableRoot).each(setElementSelection);\n          } else if (isFakeSelectionTargetElement(targetElm)) {\n            selectNode(editor, targetElm).each(setElementSelection);\n          }\n        }, true);\n        editor.on('mousedown', function (e) {\n          var targetElm = e.target;\n          if (targetElm !== rootNode && targetElm.nodeName !== 'HTML' && !dom.isChildOf(targetElm, rootNode)) {\n            return;\n          }\n          if (isXYInContentArea(editor, e.clientX, e.clientY) === false) {\n            return;\n          }\n          var contentEditableRoot = getContentEditableRoot$1(editor, targetElm);\n          if (contentEditableRoot) {\n            if (isContentEditableFalse$b(contentEditableRoot)) {\n              e.preventDefault();\n              selectNode(editor, contentEditableRoot).each(setElementSelection);\n            } else {\n              removeElementSelection();\n              if (!(isContentEditableTrue$4(contentEditableRoot) && e.shiftKey) && !isXYWithinRange(e.clientX, e.clientY, selection.getRng())) {\n                hideFakeCaret();\n                selection.placeCaretAt(e.clientX, e.clientY);\n              }\n            }\n          } else if (isFakeSelectionTargetElement(targetElm)) {\n            selectNode(editor, targetElm).each(setElementSelection);\n          } else if (isFakeCaretTarget(targetElm) === false) {\n            removeElementSelection();\n            hideFakeCaret();\n            var fakeCaretInfo = closestFakeCaret(rootNode, e.clientX, e.clientY);\n            if (fakeCaretInfo) {\n              if (!hasBetterMouseTarget(targetElm, fakeCaretInfo.node)) {\n                e.preventDefault();\n                var range = showCaret(1, fakeCaretInfo.node, fakeCaretInfo.before, false);\n                editor.getBody().focus();\n                setRange(range);\n              }\n            }\n          }\n        });\n        editor.on('keypress', function (e) {\n          if (VK.modifierPressed(e)) {\n            return;\n          }\n          if (isContentEditableFalse$b(selection.getNode())) {\n            e.preventDefault();\n          }\n        });\n        editor.on('GetSelectionRange', function (e) {\n          var rng = e.range;\n          if (selectedElement) {\n            if (!selectedElement.parentNode) {\n              selectedElement = null;\n              return;\n            }\n            rng = rng.cloneRange();\n            rng.selectNode(selectedElement);\n            e.range = rng;\n          }\n        });\n        editor.on('SetSelectionRange', function (e) {\n          e.range = normalizeShortEndedElementSelection(e.range);\n          var rng = setElementSelection(e.range, e.forward);\n          if (rng) {\n            e.range = rng;\n          }\n        });\n        var isPasteBin = function (node) {\n          return node.id === 'mcepastebin';\n        };\n        editor.on('AfterSetSelectionRange', function (e) {\n          var rng = e.range;\n          var parentNode = rng.startContainer.parentNode;\n          if (!isRangeInCaretContainer(rng) && !isPasteBin(parentNode)) {\n            hideFakeCaret();\n          }\n          if (!isFakeSelectionElement(parentNode)) {\n            removeElementSelection();\n          }\n        });\n        editor.on('copy', function (e) {\n          var clipboardData = e.clipboardData;\n          if (!e.isDefaultPrevented() && e.clipboardData && !Env.ie) {\n            var realSelectionElement = getRealSelectionElement();\n            if (realSelectionElement) {\n              e.preventDefault();\n              clipboardData.clearData();\n              clipboardData.setData('text/html', realSelectionElement.outerHTML);\n              clipboardData.setData('text/plain', realSelectionElement.outerText || realSelectionElement.innerText);\n            }\n          }\n        });\n        init(editor);\n        setup$l(editor);\n        setup$m(editor);\n      };\n      var isWithinCaretContainer = function (node) {\n        return isCaretContainer(node) || startsWithCaretContainer(node) || endsWithCaretContainer(node);\n      };\n      var isRangeInCaretContainer = function (rng) {\n        return isWithinCaretContainer(rng.startContainer) || isWithinCaretContainer(rng.endContainer);\n      };\n      var normalizeShortEndedElementSelection = function (rng) {\n        var shortEndedElements = editor.schema.getShortEndedElements();\n        var newRng = dom.createRng();\n        var startContainer = rng.startContainer;\n        var startOffset = rng.startOffset;\n        var endContainer = rng.endContainer;\n        var endOffset = rng.endOffset;\n        if (has(shortEndedElements, startContainer.nodeName.toLowerCase())) {\n          if (startOffset === 0) {\n            newRng.setStartBefore(startContainer);\n          } else {\n            newRng.setStartAfter(startContainer);\n          }\n        } else {\n          newRng.setStart(startContainer, startOffset);\n        }\n        if (has(shortEndedElements, endContainer.nodeName.toLowerCase())) {\n          if (endOffset === 0) {\n            newRng.setEndBefore(endContainer);\n          } else {\n            newRng.setEndAfter(endContainer);\n          }\n        } else {\n          newRng.setEnd(endContainer, endOffset);\n        }\n        return newRng;\n      };\n      var setupOffscreenSelection = function (node, targetClone, origTargetClone) {\n        var $ = editor.$;\n        var $realSelectionContainer = descendant(SugarElement.fromDom(editor.getBody()), '#' + realSelectionId).fold(function () {\n          return $([]);\n        }, function (elm) {\n          return $([elm.dom]);\n        });\n        if ($realSelectionContainer.length === 0) {\n          $realSelectionContainer = $('<div data-mce-bogus=\"all\" class=\"mce-offscreen-selection\"></div>').attr('id', realSelectionId);\n          $realSelectionContainer.appendTo(editor.getBody());\n        }\n        var newRange = dom.createRng();\n        if (targetClone === origTargetClone && Env.ie) {\n          $realSelectionContainer.empty().append('<p style=\"font-size: 0\" data-mce-bogus=\"all\">\\xA0</p>').append(targetClone);\n          newRange.setStartAfter($realSelectionContainer[0].firstChild.firstChild);\n          newRange.setEndAfter(targetClone);\n        } else {\n          $realSelectionContainer.empty().append(nbsp).append(targetClone).append(nbsp);\n          newRange.setStart($realSelectionContainer[0].firstChild, 1);\n          newRange.setEnd($realSelectionContainer[0].lastChild, 0);\n        }\n        $realSelectionContainer.css({ top: dom.getPos(node, editor.getBody()).y });\n        $realSelectionContainer[0].focus();\n        var sel = selection.getSel();\n        sel.removeAllRanges();\n        sel.addRange(newRange);\n        return newRange;\n      };\n      var selectElement = function (elm) {\n        var targetClone = elm.cloneNode(true);\n        var e = editor.fire('ObjectSelected', {\n          target: elm,\n          targetClone: targetClone\n        });\n        if (e.isDefaultPrevented()) {\n          return null;\n        }\n        var range = setupOffscreenSelection(elm, e.targetClone, targetClone);\n        var nodeElm = SugarElement.fromDom(elm);\n        each(descendants$1(SugarElement.fromDom(editor.getBody()), '*[data-mce-selected]'), function (elm) {\n          if (!eq$2(nodeElm, elm)) {\n            remove$1(elm, elementSelectionAttr);\n          }\n        });\n        if (!dom.getAttrib(elm, elementSelectionAttr)) {\n          elm.setAttribute(elementSelectionAttr, '1');\n        }\n        selectedElement = elm;\n        hideFakeCaret();\n        return range;\n      };\n      var setElementSelection = function (range, forward) {\n        if (!range) {\n          return null;\n        }\n        if (range.collapsed) {\n          if (!isRangeInCaretContainer(range)) {\n            var dir = forward ? 1 : -1;\n            var caretPosition = getNormalizedRangeEndPoint(dir, rootNode, range);\n            var beforeNode = caretPosition.getNode(!forward);\n            if (isFakeCaretTarget(beforeNode)) {\n              return showCaret(dir, beforeNode, forward ? !caretPosition.isAtEnd() : false, false);\n            }\n            var afterNode = caretPosition.getNode(forward);\n            if (isFakeCaretTarget(afterNode)) {\n              return showCaret(dir, afterNode, forward ? false : !caretPosition.isAtEnd(), false);\n            }\n          }\n          return null;\n        }\n        var startContainer = range.startContainer;\n        var startOffset = range.startOffset;\n        var endOffset = range.endOffset;\n        if (startContainer.nodeType === 3 && startOffset === 0 && isContentEditableFalse$b(startContainer.parentNode)) {\n          startContainer = startContainer.parentNode;\n          startOffset = dom.nodeIndex(startContainer);\n          startContainer = startContainer.parentNode;\n        }\n        if (startContainer.nodeType !== 1) {\n          return null;\n        }\n        if (endOffset === startOffset + 1 && startContainer === range.endContainer) {\n          var node = startContainer.childNodes[startOffset];\n          if (isFakeSelectionTargetElement(node)) {\n            return selectElement(node);\n          }\n        }\n        return null;\n      };\n      var removeElementSelection = function () {\n        if (selectedElement) {\n          selectedElement.removeAttribute(elementSelectionAttr);\n        }\n        descendant(SugarElement.fromDom(editor.getBody()), '#' + realSelectionId).each(remove);\n        selectedElement = null;\n      };\n      var destroy = function () {\n        fakeCaret.destroy();\n        selectedElement = null;\n      };\n      var hideFakeCaret = function () {\n        fakeCaret.hide();\n      };\n      if (Env.ceFalse) {\n        registerEvents();\n      }\n      return {\n        showCaret: showCaret,\n        showBlockCaretContainer: showBlockCaretContainer,\n        hideFakeCaret: hideFakeCaret,\n        destroy: destroy\n      };\n    };\n\n    var Quirks = function (editor) {\n      var each = Tools.each;\n      var BACKSPACE = VK.BACKSPACE, DELETE = VK.DELETE, dom = editor.dom, selection = editor.selection, parser = editor.parser;\n      var isGecko = Env.gecko, isIE = Env.ie, isWebKit = Env.webkit;\n      var mceInternalUrlPrefix = 'data:text/mce-internal,';\n      var mceInternalDataType = isIE ? 'Text' : 'URL';\n      var setEditorCommandState = function (cmd, state) {\n        try {\n          editor.getDoc().execCommand(cmd, false, state);\n        } catch (ex) {\n        }\n      };\n      var isDefaultPrevented = function (e) {\n        return e.isDefaultPrevented();\n      };\n      var setMceInternalContent = function (e) {\n        var selectionHtml, internalContent;\n        if (e.dataTransfer) {\n          if (editor.selection.isCollapsed() && e.target.tagName === 'IMG') {\n            selection.select(e.target);\n          }\n          selectionHtml = editor.selection.getContent();\n          if (selectionHtml.length > 0) {\n            internalContent = mceInternalUrlPrefix + escape(editor.id) + ',' + escape(selectionHtml);\n            e.dataTransfer.setData(mceInternalDataType, internalContent);\n          }\n        }\n      };\n      var getMceInternalContent = function (e) {\n        var internalContent;\n        if (e.dataTransfer) {\n          internalContent = e.dataTransfer.getData(mceInternalDataType);\n          if (internalContent && internalContent.indexOf(mceInternalUrlPrefix) >= 0) {\n            internalContent = internalContent.substr(mceInternalUrlPrefix.length).split(',');\n            return {\n              id: unescape(internalContent[0]),\n              html: unescape(internalContent[1])\n            };\n          }\n        }\n        return null;\n      };\n      var insertClipboardContents = function (content, internal) {\n        if (editor.queryCommandSupported('mceInsertClipboardContent')) {\n          editor.execCommand('mceInsertClipboardContent', false, {\n            content: content,\n            internal: internal\n          });\n        } else {\n          editor.execCommand('mceInsertContent', false, content);\n        }\n      };\n      var emptyEditorWhenDeleting = function () {\n        var serializeRng = function (rng) {\n          var body = dom.create('body');\n          var contents = rng.cloneContents();\n          body.appendChild(contents);\n          return selection.serializer.serialize(body, { format: 'html' });\n        };\n        var allContentsSelected = function (rng) {\n          var selection = serializeRng(rng);\n          var allRng = dom.createRng();\n          allRng.selectNode(editor.getBody());\n          var allSelection = serializeRng(allRng);\n          return selection === allSelection;\n        };\n        editor.on('keydown', function (e) {\n          var keyCode = e.keyCode;\n          var isCollapsed, body;\n          if (!isDefaultPrevented(e) && (keyCode === DELETE || keyCode === BACKSPACE)) {\n            isCollapsed = editor.selection.isCollapsed();\n            body = editor.getBody();\n            if (isCollapsed && !dom.isEmpty(body)) {\n              return;\n            }\n            if (!isCollapsed && !allContentsSelected(editor.selection.getRng())) {\n              return;\n            }\n            e.preventDefault();\n            editor.setContent('');\n            if (body.firstChild && dom.isBlock(body.firstChild)) {\n              editor.selection.setCursorLocation(body.firstChild, 0);\n            } else {\n              editor.selection.setCursorLocation(body, 0);\n            }\n            editor.nodeChanged();\n          }\n        });\n      };\n      var selectAll = function () {\n        editor.shortcuts.add('meta+a', null, 'SelectAll');\n      };\n      var inputMethodFocus = function () {\n        if (!editor.inline) {\n          dom.bind(editor.getDoc(), 'mousedown mouseup', function (e) {\n            var rng;\n            if (e.target === editor.getDoc().documentElement) {\n              rng = selection.getRng();\n              editor.getBody().focus();\n              if (e.type === 'mousedown') {\n                if (isCaretContainer(rng.startContainer)) {\n                  return;\n                }\n                selection.placeCaretAt(e.clientX, e.clientY);\n              } else {\n                selection.setRng(rng);\n              }\n            }\n          });\n        }\n      };\n      var removeHrOnBackspace = function () {\n        editor.on('keydown', function (e) {\n          if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n            if (!editor.getBody().getElementsByTagName('hr').length) {\n              return;\n            }\n            if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n              var node = selection.getNode();\n              var previousSibling = node.previousSibling;\n              if (node.nodeName === 'HR') {\n                dom.remove(node);\n                e.preventDefault();\n                return;\n              }\n              if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'hr') {\n                dom.remove(previousSibling);\n                e.preventDefault();\n              }\n            }\n          }\n        });\n      };\n      var focusBody = function () {\n        if (!Range.prototype.getClientRects) {\n          editor.on('mousedown', function (e) {\n            if (!isDefaultPrevented(e) && e.target.nodeName === 'HTML') {\n              var body_1 = editor.getBody();\n              body_1.blur();\n              Delay.setEditorTimeout(editor, function () {\n                body_1.focus();\n              });\n            }\n          });\n        }\n      };\n      var selectControlElements = function () {\n        editor.on('click', function (e) {\n          var target = e.target;\n          if (/^(IMG|HR)$/.test(target.nodeName) && dom.getContentEditableParent(target) !== 'false') {\n            e.preventDefault();\n            editor.selection.select(target);\n            editor.nodeChanged();\n          }\n          if (target.nodeName === 'A' && dom.hasClass(target, 'mce-item-anchor')) {\n            e.preventDefault();\n            selection.select(target);\n          }\n        });\n      };\n      var removeStylesWhenDeletingAcrossBlockElements = function () {\n        var getAttributeApplyFunction = function () {\n          var template = dom.getAttribs(selection.getStart().cloneNode(false));\n          return function () {\n            var target = selection.getStart();\n            if (target !== editor.getBody()) {\n              dom.setAttrib(target, 'style', null);\n              each(template, function (attr) {\n                target.setAttributeNode(attr.cloneNode(true));\n              });\n            }\n          };\n        };\n        var isSelectionAcrossElements = function () {\n          return !selection.isCollapsed() && dom.getParent(selection.getStart(), dom.isBlock) !== dom.getParent(selection.getEnd(), dom.isBlock);\n        };\n        editor.on('keypress', function (e) {\n          var applyAttributes;\n          if (!isDefaultPrevented(e) && (e.keyCode === 8 || e.keyCode === 46) && isSelectionAcrossElements()) {\n            applyAttributes = getAttributeApplyFunction();\n            editor.getDoc().execCommand('delete', false, null);\n            applyAttributes();\n            e.preventDefault();\n            return false;\n          }\n        });\n        dom.bind(editor.getDoc(), 'cut', function (e) {\n          var applyAttributes;\n          if (!isDefaultPrevented(e) && isSelectionAcrossElements()) {\n            applyAttributes = getAttributeApplyFunction();\n            Delay.setEditorTimeout(editor, function () {\n              applyAttributes();\n            });\n          }\n        });\n      };\n      var disableBackspaceIntoATable = function () {\n        editor.on('keydown', function (e) {\n          if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n            if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n              var previousSibling = selection.getNode().previousSibling;\n              if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'table') {\n                e.preventDefault();\n                return false;\n              }\n            }\n          }\n        });\n      };\n      var removeBlockQuoteOnBackSpace = function () {\n        editor.on('keydown', function (e) {\n          var rng, parent;\n          if (isDefaultPrevented(e) || e.keyCode !== VK.BACKSPACE) {\n            return;\n          }\n          rng = selection.getRng();\n          var container = rng.startContainer;\n          var offset = rng.startOffset;\n          var root = dom.getRoot();\n          parent = container;\n          if (!rng.collapsed || offset !== 0) {\n            return;\n          }\n          while (parent && parent.parentNode && parent.parentNode.firstChild === parent && parent.parentNode !== root) {\n            parent = parent.parentNode;\n          }\n          if (parent.tagName === 'BLOCKQUOTE') {\n            editor.formatter.toggle('blockquote', null, parent);\n            rng = dom.createRng();\n            rng.setStart(container, 0);\n            rng.setEnd(container, 0);\n            selection.setRng(rng);\n          }\n        });\n      };\n      var setGeckoEditingOptions = function () {\n        var setOpts = function () {\n          setEditorCommandState('StyleWithCSS', false);\n          setEditorCommandState('enableInlineTableEditing', false);\n          if (!getObjectResizing(editor)) {\n            setEditorCommandState('enableObjectResizing', false);\n          }\n        };\n        if (!isReadOnly(editor)) {\n          editor.on('BeforeExecCommand mousedown', setOpts);\n        }\n      };\n      var addBrAfterLastLinks = function () {\n        var fixLinks = function () {\n          each(dom.select('a'), function (node) {\n            var parentNode = node.parentNode;\n            var root = dom.getRoot();\n            if (parentNode.lastChild === node) {\n              while (parentNode && !dom.isBlock(parentNode)) {\n                if (parentNode.parentNode.lastChild !== parentNode || parentNode === root) {\n                  return;\n                }\n                parentNode = parentNode.parentNode;\n              }\n              dom.add(parentNode, 'br', { 'data-mce-bogus': 1 });\n            }\n          });\n        };\n        editor.on('SetContent ExecCommand', function (e) {\n          if (e.type === 'setcontent' || e.command === 'mceInsertLink') {\n            fixLinks();\n          }\n        });\n      };\n      var setDefaultBlockType = function () {\n        if (getForcedRootBlock(editor)) {\n          editor.on('init', function () {\n            setEditorCommandState('DefaultParagraphSeparator', getForcedRootBlock(editor));\n          });\n        }\n      };\n      var normalizeSelection = function () {\n        editor.on('keyup focusin mouseup', function (e) {\n          if (!VK.modifierPressed(e)) {\n            selection.normalize();\n          }\n        }, true);\n      };\n      var showBrokenImageIcon = function () {\n        editor.contentStyles.push('img:-moz-broken {' + '-moz-force-broken-image-icon:1;' + 'min-width:24px;' + 'min-height:24px' + '}');\n      };\n      var restoreFocusOnKeyDown = function () {\n        if (!editor.inline) {\n          editor.on('keydown', function () {\n            if (document.activeElement === document.body) {\n              editor.getWin().focus();\n            }\n          });\n        }\n      };\n      var bodyHeight = function () {\n        if (!editor.inline) {\n          editor.contentStyles.push('body {min-height: 150px}');\n          editor.on('click', function (e) {\n            var rng;\n            if (e.target.nodeName === 'HTML') {\n              if (Env.ie > 11) {\n                editor.getBody().focus();\n                return;\n              }\n              rng = editor.selection.getRng();\n              editor.getBody().focus();\n              editor.selection.setRng(rng);\n              editor.selection.normalize();\n              editor.nodeChanged();\n            }\n          });\n        }\n      };\n      var blockCmdArrowNavigation = function () {\n        if (Env.mac) {\n          editor.on('keydown', function (e) {\n            if (VK.metaKeyPressed(e) && !e.shiftKey && (e.keyCode === 37 || e.keyCode === 39)) {\n              e.preventDefault();\n              var selection_1 = editor.selection.getSel();\n              selection_1.modify('move', e.keyCode === 37 ? 'backward' : 'forward', 'lineboundary');\n            }\n          });\n        }\n      };\n      var disableAutoUrlDetect = function () {\n        setEditorCommandState('AutoUrlDetect', false);\n      };\n      var tapLinksAndImages = function () {\n        editor.on('click', function (e) {\n          var elm = e.target;\n          do {\n            if (elm.tagName === 'A') {\n              e.preventDefault();\n              return;\n            }\n          } while (elm = elm.parentNode);\n        });\n        editor.contentStyles.push('.mce-content-body {-webkit-touch-callout: none}');\n      };\n      var blockFormSubmitInsideEditor = function () {\n        editor.on('init', function () {\n          editor.dom.bind(editor.getBody(), 'submit', function (e) {\n            e.preventDefault();\n          });\n        });\n      };\n      var removeAppleInterchangeBrs = function () {\n        parser.addNodeFilter('br', function (nodes) {\n          var i = nodes.length;\n          while (i--) {\n            if (nodes[i].attr('class') === 'Apple-interchange-newline') {\n              nodes[i].remove();\n            }\n          }\n        });\n      };\n      var ieInternalDragAndDrop = function () {\n        editor.on('dragstart', function (e) {\n          setMceInternalContent(e);\n        });\n        editor.on('drop', function (e) {\n          if (!isDefaultPrevented(e)) {\n            var internalContent = getMceInternalContent(e);\n            if (internalContent && internalContent.id !== editor.id) {\n              e.preventDefault();\n              var rng = fromPoint$1(e.x, e.y, editor.getDoc());\n              selection.setRng(rng);\n              insertClipboardContents(internalContent.html, true);\n            }\n          }\n        });\n      };\n      var refreshContentEditable = noop;\n      var isHidden = function () {\n        if (!isGecko || editor.removed) {\n          return false;\n        }\n        var sel = editor.selection.getSel();\n        return !sel || !sel.rangeCount || sel.rangeCount === 0;\n      };\n      removeBlockQuoteOnBackSpace();\n      emptyEditorWhenDeleting();\n      if (!Env.windowsPhone) {\n        normalizeSelection();\n      }\n      if (isWebKit) {\n        inputMethodFocus();\n        selectControlElements();\n        setDefaultBlockType();\n        blockFormSubmitInsideEditor();\n        disableBackspaceIntoATable();\n        removeAppleInterchangeBrs();\n        if (Env.iOS) {\n          restoreFocusOnKeyDown();\n          bodyHeight();\n          tapLinksAndImages();\n        } else {\n          selectAll();\n        }\n      }\n      if (Env.ie >= 11) {\n        bodyHeight();\n        disableBackspaceIntoATable();\n      }\n      if (Env.ie) {\n        selectAll();\n        disableAutoUrlDetect();\n        ieInternalDragAndDrop();\n      }\n      if (isGecko) {\n        removeHrOnBackspace();\n        focusBody();\n        removeStylesWhenDeletingAcrossBlockElements();\n        setGeckoEditingOptions();\n        addBrAfterLastLinks();\n        showBrokenImageIcon();\n        blockCmdArrowNavigation();\n        disableBackspaceIntoATable();\n      }\n      return {\n        refreshContentEditable: refreshContentEditable,\n        isHidden: isHidden\n      };\n    };\n\n    var DOM$4 = DOMUtils.DOM;\n    var appendStyle = function (editor, text) {\n      var body = SugarElement.fromDom(editor.getBody());\n      var container = getStyleContainer(getRootNode(body));\n      var style = SugarElement.fromTag('style');\n      set(style, 'type', 'text/css');\n      append(style, SugarElement.fromText(text));\n      append(container, style);\n      editor.on('remove', function () {\n        remove(style);\n      });\n    };\n    var getRootName = function (editor) {\n      return editor.inline ? editor.getElement().nodeName.toLowerCase() : undefined;\n    };\n    var removeUndefined = function (obj) {\n      return filter$1(obj, function (v) {\n        return isUndefined(v) === false;\n      });\n    };\n    var mkParserSettings = function (editor) {\n      var settings = editor.settings;\n      var blobCache = editor.editorUpload.blobCache;\n      return removeUndefined({\n        allow_conditional_comments: settings.allow_conditional_comments,\n        allow_html_data_urls: settings.allow_html_data_urls,\n        allow_svg_data_urls: settings.allow_svg_data_urls,\n        allow_html_in_named_anchor: settings.allow_html_in_named_anchor,\n        allow_script_urls: settings.allow_script_urls,\n        allow_unsafe_link_target: settings.allow_unsafe_link_target,\n        convert_fonts_to_spans: settings.convert_fonts_to_spans,\n        fix_list_elements: settings.fix_list_elements,\n        font_size_legacy_values: settings.font_size_legacy_values,\n        forced_root_block: settings.forced_root_block,\n        forced_root_block_attrs: settings.forced_root_block_attrs,\n        padd_empty_with_br: settings.padd_empty_with_br,\n        preserve_cdata: settings.preserve_cdata,\n        remove_trailing_brs: settings.remove_trailing_brs,\n        inline_styles: settings.inline_styles,\n        root_name: getRootName(editor),\n        validate: true,\n        blob_cache: blobCache,\n        images_dataimg_filter: settings.images_dataimg_filter\n      });\n    };\n    var mkSerializerSettings = function (editor) {\n      var settings = editor.settings;\n      return __assign(__assign({}, mkParserSettings(editor)), removeUndefined({\n        url_converter: settings.url_converter,\n        url_converter_scope: settings.url_converter_scope,\n        element_format: settings.element_format,\n        entities: settings.entities,\n        entity_encoding: settings.entity_encoding,\n        indent: settings.indent,\n        indent_after: settings.indent_after,\n        indent_before: settings.indent_before,\n        block_elements: settings.block_elements,\n        boolean_attributes: settings.boolean_attributes,\n        custom_elements: settings.custom_elements,\n        extended_valid_elements: settings.extended_valid_elements,\n        invalid_elements: settings.invalid_elements,\n        invalid_styles: settings.invalid_styles,\n        move_caret_before_on_enter_elements: settings.move_caret_before_on_enter_elements,\n        non_empty_elements: settings.non_empty_elements,\n        schema: settings.schema,\n        self_closing_elements: settings.self_closing_elements,\n        short_ended_elements: settings.short_ended_elements,\n        special: settings.special,\n        text_block_elements: settings.text_block_elements,\n        text_inline_elements: settings.text_inline_elements,\n        valid_children: settings.valid_children,\n        valid_classes: settings.valid_classes,\n        valid_elements: settings.valid_elements,\n        valid_styles: settings.valid_styles,\n        verify_html: settings.verify_html,\n        whitespace_elements: settings.whitespace_elements\n      }));\n    };\n    var createParser = function (editor) {\n      var parser = DomParser(mkParserSettings(editor), editor.schema);\n      parser.addAttributeFilter('src,href,style,tabindex', function (nodes, name) {\n        var i = nodes.length, node, value;\n        var dom = editor.dom;\n        var internalName = 'data-mce-' + name;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr(name);\n          if (value && !node.attr(internalName)) {\n            if (value.indexOf('data:') === 0 || value.indexOf('blob:') === 0) {\n              continue;\n            }\n            if (name === 'style') {\n              value = dom.serializeStyle(dom.parseStyle(value), node.name);\n              if (!value.length) {\n                value = null;\n              }\n              node.attr(internalName, value);\n              node.attr(name, value);\n            } else if (name === 'tabindex') {\n              node.attr(internalName, value);\n              node.attr(name, null);\n            } else {\n              node.attr(internalName, editor.convertURL(value, name, node.name));\n            }\n          }\n        }\n      });\n      parser.addNodeFilter('script', function (nodes) {\n        var i = nodes.length;\n        while (i--) {\n          var node = nodes[i];\n          var type = node.attr('type') || 'no/type';\n          if (type.indexOf('mce-') !== 0) {\n            node.attr('type', 'mce-' + type);\n          }\n        }\n      });\n      if (editor.settings.preserve_cdata) {\n        parser.addNodeFilter('#cdata', function (nodes) {\n          var i = nodes.length;\n          while (i--) {\n            var node = nodes[i];\n            node.type = 8;\n            node.name = '#comment';\n            node.value = '[CDATA[' + editor.dom.encode(node.value) + ']]';\n          }\n        });\n      }\n      parser.addNodeFilter('p,h1,h2,h3,h4,h5,h6,div', function (nodes) {\n        var i = nodes.length;\n        var nonEmptyElements = editor.schema.getNonEmptyElements();\n        while (i--) {\n          var node = nodes[i];\n          if (node.isEmpty(nonEmptyElements) && node.getAll('br').length === 0) {\n            node.append(new AstNode('br', 1)).shortEnded = true;\n          }\n        }\n      });\n      return parser;\n    };\n    var autoFocus = function (editor) {\n      if (editor.settings.auto_focus) {\n        Delay.setEditorTimeout(editor, function () {\n          var focusEditor;\n          if (editor.settings.auto_focus === true) {\n            focusEditor = editor;\n          } else {\n            focusEditor = editor.editorManager.get(editor.settings.auto_focus);\n          }\n          if (!focusEditor.destroyed) {\n            focusEditor.focus();\n          }\n        }, 100);\n      }\n    };\n    var moveSelectionToFirstCaretPosition = function (editor) {\n      var root = editor.dom.getRoot();\n      if (!editor.inline && (!hasAnyRanges(editor) || editor.selection.getStart(true) === root)) {\n        firstPositionIn(root).each(function (pos) {\n          var node = pos.getNode();\n          var caretPos = isTable(node) ? firstPositionIn(node).getOr(pos) : pos;\n          if (Env.browser.isIE()) {\n            storeNative(editor, caretPos.toRange());\n          } else {\n            editor.selection.setRng(caretPos.toRange());\n          }\n        });\n      }\n    };\n    var initEditor = function (editor) {\n      editor.bindPendingEventDelegates();\n      editor.initialized = true;\n      fireInit(editor);\n      editor.focus(true);\n      moveSelectionToFirstCaretPosition(editor);\n      editor.nodeChanged({ initial: true });\n      editor.execCallback('init_instance_callback', editor);\n      autoFocus(editor);\n    };\n    var getStyleSheetLoader = function (editor) {\n      return editor.inline ? editor.ui.styleSheetLoader : editor.dom.styleSheetLoader;\n    };\n    var makeStylesheetLoadingPromises = function (editor, css, framedFonts) {\n      var promises = [new promiseObj(function (resolve, reject) {\n          return getStyleSheetLoader(editor).loadAll(css, resolve, reject);\n        })];\n      if (editor.inline) {\n        return promises;\n      } else {\n        return promises.concat([new promiseObj(function (resolve, reject) {\n            return editor.ui.styleSheetLoader.loadAll(framedFonts, resolve, reject);\n          })]);\n      }\n    };\n    var loadContentCss = function (editor, css) {\n      var styleSheetLoader = getStyleSheetLoader(editor);\n      var fontCss = getFontCss(editor);\n      var removeCss = function () {\n        styleSheetLoader.unloadAll(css);\n        if (!editor.inline) {\n          editor.ui.styleSheetLoader.unloadAll(fontCss);\n        }\n      };\n      var loaded = function () {\n        if (editor.removed) {\n          removeCss();\n        } else {\n          editor.on('remove', removeCss);\n          initEditor(editor);\n        }\n      };\n      promiseObj.all(makeStylesheetLoadingPromises(editor, css, fontCss)).then(loaded).catch(loaded);\n    };\n    var preInit = function (editor, rtcMode) {\n      var settings = editor.settings, doc = editor.getDoc(), body = editor.getBody();\n      if (!settings.browser_spellcheck && !settings.gecko_spellcheck) {\n        doc.body.spellcheck = false;\n        DOM$4.setAttrib(body, 'spellcheck', 'false');\n      }\n      editor.quirks = Quirks(editor);\n      firePostRender(editor);\n      var directionality = getDirectionality(editor);\n      if (directionality !== undefined) {\n        body.dir = directionality;\n      }\n      if (settings.protect) {\n        editor.on('BeforeSetContent', function (e) {\n          Tools.each(settings.protect, function (pattern) {\n            e.content = e.content.replace(pattern, function (str) {\n              return '<!--mce:protected ' + escape(str) + '-->';\n            });\n          });\n        });\n      }\n      editor.on('SetContent', function () {\n        editor.addVisual(editor.getBody());\n      });\n      if (rtcMode === false) {\n        editor.load({\n          initial: true,\n          format: 'html'\n        });\n      }\n      editor.startContent = editor.getContent({ format: 'raw' });\n      editor.on('compositionstart compositionend', function (e) {\n        editor.composing = e.type === 'compositionstart';\n      });\n      if (editor.contentStyles.length > 0) {\n        var contentCssText_1 = '';\n        Tools.each(editor.contentStyles, function (style) {\n          contentCssText_1 += style + '\\r\\n';\n        });\n        editor.dom.addStyle(contentCssText_1);\n      }\n      loadContentCss(editor, editor.contentCSS);\n      if (settings.content_style) {\n        appendStyle(editor, settings.content_style);\n      }\n    };\n    var initContentBody = function (editor, skipWrite) {\n      var settings = editor.settings;\n      var targetElm = editor.getElement();\n      var doc = editor.getDoc();\n      if (!settings.inline) {\n        editor.getElement().style.visibility = editor.orgVisibility;\n      }\n      if (!skipWrite && !editor.inline) {\n        doc.open();\n        doc.write(editor.iframeHTML);\n        doc.close();\n      }\n      if (editor.inline) {\n        DOM$4.addClass(targetElm, 'mce-content-body');\n        editor.contentDocument = doc = document;\n        editor.contentWindow = window;\n        editor.bodyElement = targetElm;\n        editor.contentAreaContainer = targetElm;\n      }\n      var body = editor.getBody();\n      body.disabled = true;\n      editor.readonly = !!settings.readonly;\n      if (!editor.readonly) {\n        if (editor.inline && DOM$4.getStyle(body, 'position', true) === 'static') {\n          body.style.position = 'relative';\n        }\n        body.contentEditable = editor.getParam('content_editable_state', true);\n      }\n      body.disabled = false;\n      editor.editorUpload = EditorUpload(editor);\n      editor.schema = Schema(settings);\n      editor.dom = DOMUtils(doc, {\n        keep_values: true,\n        url_converter: editor.convertURL,\n        url_converter_scope: editor,\n        hex_colors: settings.force_hex_style_colors,\n        update_styles: true,\n        root_element: editor.inline ? editor.getBody() : null,\n        collect: function () {\n          return editor.inline;\n        },\n        schema: editor.schema,\n        contentCssCors: shouldUseContentCssCors(editor),\n        referrerPolicy: getReferrerPolicy(editor),\n        onSetAttrib: function (e) {\n          editor.fire('SetAttrib', e);\n        }\n      });\n      editor.parser = createParser(editor);\n      editor.serializer = DomSerializer(mkSerializerSettings(editor), editor);\n      editor.selection = EditorSelection(editor.dom, editor.getWin(), editor.serializer, editor);\n      editor.annotator = Annotator(editor);\n      editor.formatter = Formatter(editor);\n      editor.undoManager = UndoManager(editor);\n      editor._nodeChangeDispatcher = new NodeChange(editor);\n      editor._selectionOverrides = SelectionOverrides(editor);\n      setup$9(editor);\n      setup$j(editor);\n      if (!isRtc(editor)) {\n        setup$k(editor);\n      }\n      var caret = setup$i(editor);\n      setup$8(editor, caret);\n      setup$a(editor);\n      setup$7(editor);\n      firePreInit(editor);\n      setup$5(editor).fold(function () {\n        preInit(editor, false);\n      }, function (loadingRtc) {\n        editor.setProgressState(true);\n        loadingRtc.then(function (rtcMode) {\n          editor.setProgressState(false);\n          preInit(editor, rtcMode);\n        }, function (err) {\n          editor.notificationManager.open({\n            type: 'error',\n            text: String(err)\n          });\n          preInit(editor, true);\n        });\n      });\n    };\n\n    var DOM$5 = DOMUtils.DOM;\n    var relaxDomain = function (editor, ifr) {\n      if (document.domain !== window.location.hostname && Env.browser.isIE()) {\n        var bodyUuid = uuid('mce');\n        editor[bodyUuid] = function () {\n          initContentBody(editor);\n        };\n        var domainRelaxUrl = 'javascript:(function(){' + 'document.open();document.domain=\"' + document.domain + '\";' + 'var ed = window.parent.tinymce.get(\"' + editor.id + '\");document.write(ed.iframeHTML);' + 'document.close();ed.' + bodyUuid + '(true);})()';\n        DOM$5.setAttrib(ifr, 'src', domainRelaxUrl);\n        return true;\n      }\n      return false;\n    };\n    var createIframeElement = function (id, title, height, customAttrs) {\n      var iframe = SugarElement.fromTag('iframe');\n      setAll(iframe, customAttrs);\n      setAll(iframe, {\n        id: id + '_ifr',\n        frameBorder: '0',\n        allowTransparency: 'true',\n        title: title\n      });\n      add$3(iframe, 'tox-edit-area__iframe');\n      return iframe;\n    };\n    var getIframeHtml = function (editor) {\n      var iframeHTML = getDocType(editor) + '<html><head>';\n      if (getDocumentBaseUrl(editor) !== editor.documentBaseUrl) {\n        iframeHTML += '<base href=\"' + editor.documentBaseURI.getURI() + '\" />';\n      }\n      iframeHTML += '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />';\n      var bodyId = getBodyId(editor);\n      var bodyClass = getBodyClass(editor);\n      if (getContentSecurityPolicy(editor)) {\n        iframeHTML += '<meta http-equiv=\"Content-Security-Policy\" content=\"' + getContentSecurityPolicy(editor) + '\" />';\n      }\n      iframeHTML += '</head><body id=\"' + bodyId + '\" class=\"mce-content-body ' + bodyClass + '\" data-id=\"' + editor.id + '\"><br></body></html>';\n      return iframeHTML;\n    };\n    var createIframe = function (editor, o) {\n      var title = editor.editorManager.translate('Rich Text Area. Press ALT-0 for help.');\n      var ifr = createIframeElement(editor.id, title, o.height, getIframeAttrs(editor)).dom;\n      ifr.onload = function () {\n        ifr.onload = null;\n        editor.fire('load');\n      };\n      var isDomainRelaxed = relaxDomain(editor, ifr);\n      editor.contentAreaContainer = o.iframeContainer;\n      editor.iframeElement = ifr;\n      editor.iframeHTML = getIframeHtml(editor);\n      DOM$5.add(o.iframeContainer, ifr);\n      return isDomainRelaxed;\n    };\n    var init$1 = function (editor, boxInfo) {\n      var isDomainRelaxed = createIframe(editor, boxInfo);\n      if (boxInfo.editorContainer) {\n        DOM$5.get(boxInfo.editorContainer).style.display = editor.orgDisplay;\n        editor.hidden = DOM$5.isHidden(boxInfo.editorContainer);\n      }\n      editor.getElement().style.display = 'none';\n      DOM$5.setAttrib(editor.id, 'aria-hidden', 'true');\n      if (!isDomainRelaxed) {\n        initContentBody(editor);\n      }\n    };\n\n    var DOM$6 = DOMUtils.DOM;\n    var initPlugin = function (editor, initializedPlugins, plugin) {\n      var Plugin = PluginManager.get(plugin);\n      var pluginUrl = PluginManager.urls[plugin] || editor.documentBaseUrl.replace(/\\/$/, '');\n      plugin = Tools.trim(plugin);\n      if (Plugin && Tools.inArray(initializedPlugins, plugin) === -1) {\n        Tools.each(PluginManager.dependencies(plugin), function (dep) {\n          initPlugin(editor, initializedPlugins, dep);\n        });\n        if (editor.plugins[plugin]) {\n          return;\n        }\n        try {\n          var pluginInstance = new Plugin(editor, pluginUrl, editor.$);\n          editor.plugins[plugin] = pluginInstance;\n          if (pluginInstance.init) {\n            pluginInstance.init(editor, pluginUrl);\n            initializedPlugins.push(plugin);\n          }\n        } catch (e) {\n          pluginInitError(editor, plugin, e);\n        }\n      }\n    };\n    var trimLegacyPrefix = function (name) {\n      return name.replace(/^\\-/, '');\n    };\n    var initPlugins = function (editor) {\n      var initializedPlugins = [];\n      Tools.each(getPlugins(editor).split(/[ ,]/), function (name) {\n        initPlugin(editor, initializedPlugins, trimLegacyPrefix(name));\n      });\n    };\n    var initIcons = function (editor) {\n      var iconPackName = Tools.trim(getIconPackName(editor));\n      var currentIcons = editor.ui.registry.getAll().icons;\n      var loadIcons = __assign(__assign({}, IconManager.get('default').icons), IconManager.get(iconPackName).icons);\n      each$1(loadIcons, function (svgData, icon) {\n        if (!has(currentIcons, icon)) {\n          editor.ui.registry.addIcon(icon, svgData);\n        }\n      });\n    };\n    var initTheme = function (editor) {\n      var theme = getTheme(editor);\n      if (isString(theme)) {\n        editor.settings.theme = trimLegacyPrefix(theme);\n        var Theme = ThemeManager.get(theme);\n        editor.theme = new Theme(editor, ThemeManager.urls[theme]);\n        if (editor.theme.init) {\n          editor.theme.init(editor, ThemeManager.urls[theme] || editor.documentBaseUrl.replace(/\\/$/, ''), editor.$);\n        }\n      } else {\n        editor.theme = {};\n      }\n    };\n    var renderFromLoadedTheme = function (editor) {\n      return editor.theme.renderUI();\n    };\n    var renderFromThemeFunc = function (editor) {\n      var elm = editor.getElement();\n      var theme = getTheme(editor);\n      var info = theme(editor, elm);\n      if (info.editorContainer.nodeType) {\n        info.editorContainer.id = info.editorContainer.id || editor.id + '_parent';\n      }\n      if (info.iframeContainer && info.iframeContainer.nodeType) {\n        info.iframeContainer.id = info.iframeContainer.id || editor.id + '_iframecontainer';\n      }\n      info.height = info.iframeHeight ? info.iframeHeight : elm.offsetHeight;\n      return info;\n    };\n    var createThemeFalseResult = function (element) {\n      return {\n        editorContainer: element,\n        iframeContainer: element,\n        api: {}\n      };\n    };\n    var renderThemeFalseIframe = function (targetElement) {\n      var iframeContainer = DOM$6.create('div');\n      DOM$6.insertAfter(iframeContainer, targetElement);\n      return createThemeFalseResult(iframeContainer);\n    };\n    var renderThemeFalse = function (editor) {\n      var targetElement = editor.getElement();\n      return editor.inline ? createThemeFalseResult(null) : renderThemeFalseIframe(targetElement);\n    };\n    var renderThemeUi = function (editor) {\n      var elm = editor.getElement();\n      editor.orgDisplay = elm.style.display;\n      if (isString(getTheme(editor))) {\n        return renderFromLoadedTheme(editor);\n      } else if (isFunction(getTheme(editor))) {\n        return renderFromThemeFunc(editor);\n      } else {\n        return renderThemeFalse(editor);\n      }\n    };\n    var augmentEditorUiApi = function (editor, api) {\n      var uiApiFacade = {\n        show: Optional.from(api.show).getOr(noop),\n        hide: Optional.from(api.hide).getOr(noop),\n        disable: Optional.from(api.disable).getOr(noop),\n        isDisabled: Optional.from(api.isDisabled).getOr(never),\n        enable: function () {\n          if (!editor.mode.isReadOnly()) {\n            Optional.from(api.enable).map(call);\n          }\n        }\n      };\n      editor.ui = __assign(__assign({}, editor.ui), uiApiFacade);\n    };\n    var init$2 = function (editor) {\n      editor.fire('ScriptsLoaded');\n      initIcons(editor);\n      initTheme(editor);\n      initPlugins(editor);\n      var renderInfo = renderThemeUi(editor);\n      augmentEditorUiApi(editor, Optional.from(renderInfo.api).getOr({}));\n      var boxInfo = {\n        editorContainer: renderInfo.editorContainer,\n        iframeContainer: renderInfo.iframeContainer\n      };\n      editor.editorContainer = boxInfo.editorContainer ? boxInfo.editorContainer : null;\n      appendContentCssFromSettings(editor);\n      if (editor.inline) {\n        return initContentBody(editor);\n      } else {\n        return init$1(editor, boxInfo);\n      }\n    };\n\n    var DOM$7 = DOMUtils.DOM;\n    var hasSkipLoadPrefix = function (name) {\n      return name.charAt(0) === '-';\n    };\n    var loadLanguage = function (scriptLoader, editor) {\n      var languageCode = getLanguageCode(editor);\n      var languageUrl = getLanguageUrl(editor);\n      if (I18n.hasCode(languageCode) === false && languageCode !== 'en') {\n        var url_1 = languageUrl !== '' ? languageUrl : editor.editorManager.baseURL + '/langs/' + languageCode + '.js';\n        scriptLoader.add(url_1, noop, undefined, function () {\n          languageLoadError(editor, url_1, languageCode);\n        });\n      }\n    };\n    var loadTheme = function (scriptLoader, editor, suffix, callback) {\n      var theme = getTheme(editor);\n      if (isString(theme)) {\n        if (!hasSkipLoadPrefix(theme) && !ThemeManager.urls.hasOwnProperty(theme)) {\n          var themeUrl = getThemeUrl(editor);\n          if (themeUrl) {\n            ThemeManager.load(theme, editor.documentBaseURI.toAbsolute(themeUrl));\n          } else {\n            ThemeManager.load(theme, 'themes/' + theme + '/theme' + suffix + '.js');\n          }\n        }\n        scriptLoader.loadQueue(function () {\n          ThemeManager.waitFor(theme, callback);\n        });\n      } else {\n        callback();\n      }\n    };\n    var getIconsUrlMetaFromUrl = function (editor) {\n      return Optional.from(getIconsUrl(editor)).filter(function (url) {\n        return url.length > 0;\n      }).map(function (url) {\n        return {\n          url: url,\n          name: Optional.none()\n        };\n      });\n    };\n    var getIconsUrlMetaFromName = function (editor, name, suffix) {\n      return Optional.from(name).filter(function (name) {\n        return name.length > 0 && !IconManager.has(name);\n      }).map(function (name) {\n        return {\n          url: editor.editorManager.baseURL + '/icons/' + name + '/icons' + suffix + '.js',\n          name: Optional.some(name)\n        };\n      });\n    };\n    var loadIcons = function (scriptLoader, editor, suffix) {\n      var defaultIconsUrl = getIconsUrlMetaFromName(editor, 'default', suffix);\n      var customIconsUrl = getIconsUrlMetaFromUrl(editor).orThunk(function () {\n        return getIconsUrlMetaFromName(editor, getIconPackName(editor), '');\n      });\n      each(cat([\n        defaultIconsUrl,\n        customIconsUrl\n      ]), function (urlMeta) {\n        scriptLoader.add(urlMeta.url, noop, undefined, function () {\n          iconsLoadError(editor, urlMeta.url, urlMeta.name.getOrUndefined());\n        });\n      });\n    };\n    var loadPlugins = function (editor, suffix) {\n      Tools.each(getExternalPlugins(editor), function (url, name) {\n        PluginManager.load(name, url, noop, undefined, function () {\n          pluginLoadError(editor, url, name);\n        });\n        editor.settings.plugins += ' ' + name;\n      });\n      Tools.each(getPlugins(editor).split(/[ ,]/), function (plugin) {\n        plugin = Tools.trim(plugin);\n        if (plugin && !PluginManager.urls[plugin]) {\n          if (hasSkipLoadPrefix(plugin)) {\n            plugin = plugin.substr(1, plugin.length);\n            var dependencies = PluginManager.dependencies(plugin);\n            Tools.each(dependencies, function (depPlugin) {\n              var defaultSettings = {\n                prefix: 'plugins/',\n                resource: depPlugin,\n                suffix: '/plugin' + suffix + '.js'\n              };\n              var dep = PluginManager.createUrl(defaultSettings, depPlugin);\n              PluginManager.load(dep.resource, dep, noop, undefined, function () {\n                pluginLoadError(editor, dep.prefix + dep.resource + dep.suffix, dep.resource);\n              });\n            });\n          } else {\n            var url_2 = {\n              prefix: 'plugins/',\n              resource: plugin,\n              suffix: '/plugin' + suffix + '.js'\n            };\n            PluginManager.load(plugin, url_2, noop, undefined, function () {\n              pluginLoadError(editor, url_2.prefix + url_2.resource + url_2.suffix, plugin);\n            });\n          }\n        }\n      });\n    };\n    var loadScripts = function (editor, suffix) {\n      var scriptLoader = ScriptLoader.ScriptLoader;\n      loadTheme(scriptLoader, editor, suffix, function () {\n        loadLanguage(scriptLoader, editor);\n        loadIcons(scriptLoader, editor, suffix);\n        loadPlugins(editor, suffix);\n        scriptLoader.loadQueue(function () {\n          if (!editor.removed) {\n            init$2(editor);\n          }\n        }, editor, function () {\n          if (!editor.removed) {\n            init$2(editor);\n          }\n        });\n      });\n    };\n    var getStyleSheetLoader$1 = function (element, editor) {\n      return instance.forElement(element, {\n        contentCssCors: hasContentCssCors(editor),\n        referrerPolicy: getReferrerPolicy(editor)\n      });\n    };\n    var render = function (editor) {\n      var id = editor.id;\n      I18n.setCode(getLanguageCode(editor));\n      var readyHandler = function () {\n        DOM$7.unbind(window, 'ready', readyHandler);\n        editor.render();\n      };\n      if (!EventUtils.Event.domLoaded) {\n        DOM$7.bind(window, 'ready', readyHandler);\n        return;\n      }\n      if (!editor.getElement()) {\n        return;\n      }\n      if (!Env.contentEditable) {\n        return;\n      }\n      var element = SugarElement.fromDom(editor.getElement());\n      var snapshot = clone(element);\n      editor.on('remove', function () {\n        eachr(element.dom.attributes, function (attr) {\n          return remove$1(element, attr.name);\n        });\n        setAll(element, snapshot);\n      });\n      editor.ui.styleSheetLoader = getStyleSheetLoader$1(element, editor);\n      if (!isInline$1(editor)) {\n        editor.orgVisibility = editor.getElement().style.visibility;\n        editor.getElement().style.visibility = 'hidden';\n      } else {\n        editor.inline = true;\n      }\n      var form = editor.getElement().form || DOM$7.getParent(id, 'form');\n      if (form) {\n        editor.formElement = form;\n        if (hasHiddenInput(editor) && !isTextareaOrInput(editor.getElement())) {\n          DOM$7.insertAfter(DOM$7.create('input', {\n            type: 'hidden',\n            name: id\n          }), id);\n          editor.hasHiddenInput = true;\n        }\n        editor.formEventDelegate = function (e) {\n          editor.fire(e.type, e);\n        };\n        DOM$7.bind(form, 'submit reset', editor.formEventDelegate);\n        editor.on('reset', function () {\n          editor.resetContent();\n        });\n        if (shouldPatchSubmit(editor) && !form.submit.nodeType && !form.submit.length && !form._mceOldSubmit) {\n          form._mceOldSubmit = form.submit;\n          form.submit = function () {\n            editor.editorManager.triggerSave();\n            editor.setDirty(false);\n            return form._mceOldSubmit(form);\n          };\n        }\n      }\n      editor.windowManager = WindowManager(editor);\n      editor.notificationManager = NotificationManager(editor);\n      if (isEncodingXml(editor)) {\n        editor.on('GetContent', function (e) {\n          if (e.save) {\n            e.content = DOM$7.encode(e.content);\n          }\n        });\n      }\n      if (shouldAddFormSubmitTrigger(editor)) {\n        editor.on('submit', function () {\n          if (editor.initialized) {\n            editor.save();\n          }\n        });\n      }\n      if (shouldAddUnloadTrigger(editor)) {\n        editor._beforeUnload = function () {\n          if (editor.initialized && !editor.destroyed && !editor.isHidden()) {\n            editor.save({\n              format: 'raw',\n              no_events: true,\n              set_dirty: false\n            });\n          }\n        };\n        editor.editorManager.on('BeforeUnload', editor._beforeUnload);\n      }\n      editor.editorManager.add(editor);\n      loadScripts(editor, editor.suffix);\n    };\n\n    var addVisual$1 = function (editor, elm) {\n      return addVisual(editor, elm);\n    };\n\n    var legacyPropNames = {\n      'font-size': 'size',\n      'font-family': 'face'\n    };\n    var getSpecifiedFontProp = function (propName, rootElm, elm) {\n      var getProperty = function (elm) {\n        return getRaw(elm, propName).orThunk(function () {\n          if (name(elm) === 'font') {\n            return get$1(legacyPropNames, propName).bind(function (legacyPropName) {\n              return getOpt(elm, legacyPropName);\n            });\n          } else {\n            return Optional.none();\n          }\n        });\n      };\n      var isRoot = function (elm) {\n        return eq$2(SugarElement.fromDom(rootElm), elm);\n      };\n      return closest$2(SugarElement.fromDom(elm), function (elm) {\n        return getProperty(elm);\n      }, isRoot);\n    };\n    var normalizeFontFamily = function (fontFamily) {\n      return fontFamily.replace(/[\\'\\\"\\\\]/g, '').replace(/,\\s+/g, ',');\n    };\n    var getComputedFontProp = function (propName, elm) {\n      return Optional.from(DOMUtils.DOM.getStyle(elm, propName, true));\n    };\n    var getFontProp = function (propName) {\n      return function (rootElm, elm) {\n        return Optional.from(elm).map(SugarElement.fromDom).filter(isElement).bind(function (element) {\n          return getSpecifiedFontProp(propName, rootElm, element.dom).or(getComputedFontProp(propName, element.dom));\n        }).getOr('');\n      };\n    };\n    var getFontSize = getFontProp('font-size');\n    var getFontFamily = compose(normalizeFontFamily, getFontProp('font-family'));\n\n    var findFirstCaretElement = function (editor) {\n      return firstPositionIn(editor.getBody()).map(function (caret) {\n        var container = caret.container();\n        return isText$1(container) ? container.parentNode : container;\n      });\n    };\n    var getCaretElement = function (editor) {\n      return Optional.from(editor.selection.getRng()).bind(function (rng) {\n        var root = editor.getBody();\n        var atStartOfNode = rng.startContainer === root && rng.startOffset === 0;\n        return atStartOfNode ? Optional.none() : Optional.from(editor.selection.getStart(true));\n      });\n    };\n    var mapRange = function (editor, mapper) {\n      return getCaretElement(editor).orThunk(curry(findFirstCaretElement, editor)).map(SugarElement.fromDom).filter(isElement).map(mapper);\n    };\n\n    var fromFontSizeNumber = function (editor, value) {\n      if (/^[0-9.]+$/.test(value)) {\n        var fontSizeNumber = parseInt(value, 10);\n        if (fontSizeNumber >= 1 && fontSizeNumber <= 7) {\n          var fontSizes = getFontStyleValues(editor);\n          var fontClasses = getFontSizeClasses(editor);\n          if (fontClasses) {\n            return fontClasses[fontSizeNumber - 1] || value;\n          } else {\n            return fontSizes[fontSizeNumber - 1] || value;\n          }\n        } else {\n          return value;\n        }\n      } else {\n        return value;\n      }\n    };\n    var normalizeFontNames = function (font) {\n      var fonts = font.split(/\\s*,\\s*/);\n      return map(fonts, function (font) {\n        if (font.indexOf(' ') !== -1 && !(startsWith(font, '\"') || startsWith(font, '\\''))) {\n          return '\\'' + font + '\\'';\n        } else {\n          return font;\n        }\n      }).join(',');\n    };\n    var fontNameAction = function (editor, value) {\n      var font = fromFontSizeNumber(editor, value);\n      editor.formatter.toggle('fontname', { value: normalizeFontNames(font) });\n      editor.nodeChanged();\n    };\n    var fontNameQuery = function (editor) {\n      return mapRange(editor, function (elm) {\n        return getFontFamily(editor.getBody(), elm.dom);\n      }).getOr('');\n    };\n    var fontSizeAction = function (editor, value) {\n      editor.formatter.toggle('fontsize', { value: fromFontSizeNumber(editor, value) });\n      editor.nodeChanged();\n    };\n    var fontSizeQuery = function (editor) {\n      return mapRange(editor, function (elm) {\n        return getFontSize(editor.getBody(), elm.dom);\n      }).getOr('');\n    };\n\n    var lineHeightQuery = function (editor) {\n      return mapRange(editor, function (elm) {\n        var root = SugarElement.fromDom(editor.getBody());\n        var specifiedStyle = closest$2(elm, function (elm) {\n          return getRaw(elm, 'line-height');\n        }, curry(eq$2, root));\n        var computedStyle = function () {\n          var lineHeight = parseFloat(get$5(elm, 'line-height'));\n          var fontSize = parseFloat(get$5(elm, 'font-size'));\n          return String(lineHeight / fontSize);\n        };\n        return specifiedStyle.getOrThunk(computedStyle);\n      }).getOr('');\n    };\n    var lineHeightAction = function (editor, lineHeight) {\n      editor.undoManager.transact(function () {\n        editor.formatter.toggle('lineheight', { value: String(lineHeight) });\n        editor.nodeChanged();\n      });\n    };\n\n    var processValue = function (value) {\n      var details;\n      if (typeof value !== 'string') {\n        details = Tools.extend({\n          paste: value.paste,\n          data: { paste: value.paste }\n        }, value);\n        return {\n          content: value.content,\n          details: details\n        };\n      }\n      return {\n        content: value,\n        details: {}\n      };\n    };\n    var insertAtCaret$1 = function (editor, value) {\n      var result = processValue(value);\n      insertContent(editor, result.content, result.details);\n    };\n\n    var each$f = Tools.each;\n    var map$3 = Tools.map, inArray$2 = Tools.inArray;\n    var EditorCommands = function () {\n      function EditorCommands(editor) {\n        this.commands = {\n          state: {},\n          exec: {},\n          value: {}\n        };\n        this.editor = editor;\n        this.setupCommands(editor);\n      }\n      EditorCommands.prototype.execCommand = function (command, ui, value, args) {\n        var func, state = false;\n        var self = this;\n        if (self.editor.removed) {\n          return;\n        }\n        if (!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command) && (!args || !args.skip_focus)) {\n          self.editor.focus();\n        } else {\n          restore(self.editor);\n        }\n        args = self.editor.fire('BeforeExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        if (args.isDefaultPrevented()) {\n          return false;\n        }\n        var customCommand = command.toLowerCase();\n        if (func = self.commands.exec[customCommand]) {\n          func(customCommand, ui, value);\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        each$f(this.editor.plugins, function (p) {\n          if (p.execCommand && p.execCommand(command, ui, value)) {\n            self.editor.fire('ExecCommand', {\n              command: command,\n              ui: ui,\n              value: value\n            });\n            state = true;\n            return false;\n          }\n        });\n        if (state) {\n          return state;\n        }\n        if (self.editor.theme && self.editor.theme.execCommand && self.editor.theme.execCommand(command, ui, value)) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        try {\n          state = self.editor.getDoc().execCommand(command, ui, value);\n        } catch (ex) {\n        }\n        if (state) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        return false;\n      };\n      EditorCommands.prototype.queryCommandState = function (command) {\n        var func;\n        if (this.editor.quirks.isHidden() || this.editor.removed) {\n          return;\n        }\n        command = command.toLowerCase();\n        if (func = this.commands.state[command]) {\n          return func(command);\n        }\n        try {\n          return this.editor.getDoc().queryCommandState(command);\n        } catch (ex) {\n        }\n        return false;\n      };\n      EditorCommands.prototype.queryCommandValue = function (command) {\n        var func;\n        if (this.editor.quirks.isHidden() || this.editor.removed) {\n          return;\n        }\n        command = command.toLowerCase();\n        if (func = this.commands.value[command]) {\n          return func(command);\n        }\n        try {\n          return this.editor.getDoc().queryCommandValue(command);\n        } catch (ex) {\n        }\n      };\n      EditorCommands.prototype.addCommands = function (commandList, type) {\n        if (type === void 0) {\n          type = 'exec';\n        }\n        var self = this;\n        each$f(commandList, function (callback, command) {\n          each$f(command.toLowerCase().split(','), function (command) {\n            self.commands[type][command] = callback;\n          });\n        });\n      };\n      EditorCommands.prototype.addCommand = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.exec[command] = function (command, ui, value, args) {\n          return callback.call(scope || _this.editor, ui, value, args);\n        };\n      };\n      EditorCommands.prototype.queryCommandSupported = function (command) {\n        command = command.toLowerCase();\n        if (this.commands.exec[command]) {\n          return true;\n        }\n        try {\n          return this.editor.getDoc().queryCommandSupported(command);\n        } catch (ex) {\n        }\n        return false;\n      };\n      EditorCommands.prototype.addQueryStateHandler = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.state[command] = function () {\n          return callback.call(scope || _this.editor);\n        };\n      };\n      EditorCommands.prototype.addQueryValueHandler = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.value[command] = function () {\n          return callback.call(scope || _this.editor);\n        };\n      };\n      EditorCommands.prototype.hasCustomCommand = function (command) {\n        command = command.toLowerCase();\n        return !!this.commands.exec[command];\n      };\n      EditorCommands.prototype.execNativeCommand = function (command, ui, value) {\n        if (ui === undefined) {\n          ui = false;\n        }\n        if (value === undefined) {\n          value = null;\n        }\n        return this.editor.getDoc().execCommand(command, ui, value);\n      };\n      EditorCommands.prototype.isFormatMatch = function (name) {\n        return this.editor.formatter.match(name);\n      };\n      EditorCommands.prototype.toggleFormat = function (name, value) {\n        this.editor.formatter.toggle(name, value ? { value: value } : undefined);\n        this.editor.nodeChanged();\n      };\n      EditorCommands.prototype.storeSelection = function (type) {\n        this.selectionBookmark = this.editor.selection.getBookmark(type);\n      };\n      EditorCommands.prototype.restoreSelection = function () {\n        this.editor.selection.moveToBookmark(this.selectionBookmark);\n      };\n      EditorCommands.prototype.setupCommands = function (editor) {\n        var self = this;\n        this.addCommands({\n          'mceResetDesignMode,mceBeginUndoLevel': noop,\n          'mceEndUndoLevel,mceAddUndoLevel': function () {\n            editor.undoManager.add();\n          },\n          'Cut,Copy,Paste': function (command) {\n            var doc = editor.getDoc();\n            var failed;\n            try {\n              self.execNativeCommand(command);\n            } catch (ex) {\n              failed = true;\n            }\n            if (command === 'paste' && !doc.queryCommandEnabled(command)) {\n              failed = true;\n            }\n            if (failed || !doc.queryCommandSupported(command)) {\n              var msg = editor.translate('Your browser doesn\\'t support direct access to the clipboard. ' + 'Please use the Ctrl+X/C/V keyboard shortcuts instead.');\n              if (Env.mac) {\n                msg = msg.replace(/Ctrl\\+/g, '\\u2318+');\n              }\n              editor.notificationManager.open({\n                text: msg,\n                type: 'error'\n              });\n            }\n          },\n          'unlink': function () {\n            if (editor.selection.isCollapsed()) {\n              var elm = editor.dom.getParent(editor.selection.getStart(), 'a');\n              if (elm) {\n                editor.dom.remove(elm, true);\n              }\n              return;\n            }\n            editor.formatter.remove('link');\n          },\n          'JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone': function (command) {\n            var align = command.substring(7);\n            if (align === 'full') {\n              align = 'justify';\n            }\n            each$f('left,center,right,justify'.split(','), function (name) {\n              if (align !== name) {\n                editor.formatter.remove('align' + name);\n              }\n            });\n            if (align !== 'none') {\n              self.toggleFormat('align' + align);\n            }\n          },\n          'InsertUnorderedList,InsertOrderedList': function (command) {\n            var listParent;\n            self.execNativeCommand(command);\n            var listElm = editor.dom.getParent(editor.selection.getNode(), 'ol,ul');\n            if (listElm) {\n              listParent = listElm.parentNode;\n              if (/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)) {\n                self.storeSelection();\n                editor.dom.split(listParent, listElm);\n                self.restoreSelection();\n              }\n            }\n          },\n          'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n            self.toggleFormat(command);\n          },\n          'ForeColor,HiliteColor': function (command, ui, value) {\n            self.toggleFormat(command, value);\n          },\n          'FontName': function (command, ui, value) {\n            fontNameAction(editor, value);\n          },\n          'FontSize': function (command, ui, value) {\n            fontSizeAction(editor, value);\n          },\n          'LineHeight': function (command, ui, value) {\n            lineHeightAction(editor, value);\n          },\n          'RemoveFormat': function (command) {\n            editor.formatter.remove(command);\n          },\n          'mceBlockQuote': function () {\n            self.toggleFormat('blockquote');\n          },\n          'FormatBlock': function (command, ui, value) {\n            return self.toggleFormat(value || 'p');\n          },\n          'mceCleanup': function () {\n            var bookmark = editor.selection.getBookmark();\n            editor.setContent(editor.getContent());\n            editor.selection.moveToBookmark(bookmark);\n          },\n          'mceRemoveNode': function (command, ui, value) {\n            var node = value || editor.selection.getNode();\n            if (node !== editor.getBody()) {\n              self.storeSelection();\n              editor.dom.remove(node, true);\n              self.restoreSelection();\n            }\n          },\n          'mceSelectNodeDepth': function (command, ui, value) {\n            var counter = 0;\n            editor.dom.getParent(editor.selection.getNode(), function (node) {\n              if (node.nodeType === 1 && counter++ === value) {\n                editor.selection.select(node);\n                return false;\n              }\n            }, editor.getBody());\n          },\n          'mceSelectNode': function (command, ui, value) {\n            editor.selection.select(value);\n          },\n          'mceInsertContent': function (command, ui, value) {\n            insertAtCaret$1(editor, value);\n          },\n          'mceInsertRawHTML': function (command, ui, value) {\n            editor.selection.setContent('tiny_mce_marker');\n            var content = editor.getContent();\n            editor.setContent(content.replace(/tiny_mce_marker/g, function () {\n              return value;\n            }));\n          },\n          'mceInsertNewLine': function (command, ui, value) {\n            insert$3(editor, value);\n          },\n          'mceToggleFormat': function (command, ui, value) {\n            self.toggleFormat(value);\n          },\n          'mceSetContent': function (command, ui, value) {\n            editor.setContent(value);\n          },\n          'Indent,Outdent': function (command) {\n            handle(editor, command);\n          },\n          'mceRepaint': noop,\n          'InsertHorizontalRule': function () {\n            editor.execCommand('mceInsertContent', false, '<hr />');\n          },\n          'mceToggleVisualAid': function () {\n            editor.hasVisual = !editor.hasVisual;\n            editor.addVisual();\n          },\n          'mceReplaceContent': function (command, ui, value) {\n            editor.execCommand('mceInsertContent', false, value.replace(/\\{\\$selection\\}/g, editor.selection.getContent({ format: 'text' })));\n          },\n          'mceInsertLink': function (command, ui, value) {\n            if (typeof value === 'string') {\n              value = { href: value };\n            }\n            var anchor = editor.dom.getParent(editor.selection.getNode(), 'a');\n            value.href = value.href.replace(/ /g, '%20');\n            if (!anchor || !value.href) {\n              editor.formatter.remove('link');\n            }\n            if (value.href) {\n              editor.formatter.apply('link', value, anchor);\n            }\n          },\n          'selectAll': function () {\n            var editingHost = editor.dom.getParent(editor.selection.getStart(), isContentEditableTrue);\n            if (editingHost) {\n              var rng = editor.dom.createRng();\n              rng.selectNodeContents(editingHost);\n              editor.selection.setRng(rng);\n            }\n          },\n          'mceNewDocument': function () {\n            editor.setContent('');\n          },\n          'InsertLineBreak': function (command, ui, value) {\n            insert$2(editor, value);\n            return true;\n          }\n        });\n        var alignStates = function (name) {\n          return function () {\n            var selection = editor.selection;\n            var nodes = selection.isCollapsed() ? [editor.dom.getParent(selection.getNode(), editor.dom.isBlock)] : selection.getSelectedBlocks();\n            var matches = map$3(nodes, function (node) {\n              return !!editor.formatter.matchNode(node, name);\n            });\n            return inArray$2(matches, true) !== -1;\n          };\n        };\n        self.addCommands({\n          'JustifyLeft': alignStates('alignleft'),\n          'JustifyCenter': alignStates('aligncenter'),\n          'JustifyRight': alignStates('alignright'),\n          'JustifyFull': alignStates('alignjustify'),\n          'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n            return self.isFormatMatch(command);\n          },\n          'mceBlockQuote': function () {\n            return self.isFormatMatch('blockquote');\n          },\n          'Outdent': function () {\n            return canOutdent(editor);\n          },\n          'InsertUnorderedList,InsertOrderedList': function (command) {\n            var list = editor.dom.getParent(editor.selection.getNode(), 'ul,ol');\n            return list && (command === 'insertunorderedlist' && list.tagName === 'UL' || command === 'insertorderedlist' && list.tagName === 'OL');\n          }\n        }, 'state');\n        self.addCommands({\n          Undo: function () {\n            editor.undoManager.undo();\n          },\n          Redo: function () {\n            editor.undoManager.redo();\n          }\n        });\n        self.addQueryValueHandler('FontName', function () {\n          return fontNameQuery(editor);\n        }, this);\n        self.addQueryValueHandler('FontSize', function () {\n          return fontSizeQuery(editor);\n        }, this);\n        self.addQueryValueHandler('LineHeight', function () {\n          return lineHeightQuery(editor);\n        }, this);\n      };\n      return EditorCommands;\n    }();\n\n    var internalContentEditableAttr = 'data-mce-contenteditable';\n    var toggleClass = function (elm, cls, state) {\n      if (has$2(elm, cls) && state === false) {\n        remove$4(elm, cls);\n      } else if (state) {\n        add$3(elm, cls);\n      }\n    };\n    var setEditorCommandState = function (editor, cmd, state) {\n      try {\n        editor.getDoc().execCommand(cmd, false, String(state));\n      } catch (ex) {\n      }\n    };\n    var setContentEditable = function (elm, state) {\n      elm.dom.contentEditable = state ? 'true' : 'false';\n    };\n    var switchOffContentEditableTrue = function (elm) {\n      each(descendants$1(elm, '*[contenteditable=\"true\"]'), function (elm) {\n        set(elm, internalContentEditableAttr, 'true');\n        setContentEditable(elm, false);\n      });\n    };\n    var switchOnContentEditableTrue = function (elm) {\n      each(descendants$1(elm, '*[' + internalContentEditableAttr + '=\"true\"]'), function (elm) {\n        remove$1(elm, internalContentEditableAttr);\n        setContentEditable(elm, true);\n      });\n    };\n    var removeFakeSelection = function (editor) {\n      Optional.from(editor.selection.getNode()).each(function (elm) {\n        elm.removeAttribute('data-mce-selected');\n      });\n    };\n    var restoreFakeSelection = function (editor) {\n      editor.selection.setRng(editor.selection.getRng());\n    };\n    var toggleReadOnly = function (editor, state) {\n      var body = SugarElement.fromDom(editor.getBody());\n      toggleClass(body, 'mce-content-readonly', state);\n      if (state) {\n        editor.selection.controlSelection.hideResizeRect();\n        editor._selectionOverrides.hideFakeCaret();\n        removeFakeSelection(editor);\n        editor.readonly = true;\n        setContentEditable(body, false);\n        switchOffContentEditableTrue(body);\n      } else {\n        editor.readonly = false;\n        setContentEditable(body, true);\n        switchOnContentEditableTrue(body);\n        setEditorCommandState(editor, 'StyleWithCSS', false);\n        setEditorCommandState(editor, 'enableInlineTableEditing', false);\n        setEditorCommandState(editor, 'enableObjectResizing', false);\n        if (hasEditorOrUiFocus(editor)) {\n          editor.focus();\n        }\n        restoreFakeSelection(editor);\n        editor.nodeChanged();\n      }\n    };\n    var isReadOnly$1 = function (editor) {\n      return editor.readonly;\n    };\n    var registerFilters = function (editor) {\n      editor.parser.addAttributeFilter('contenteditable', function (nodes) {\n        if (isReadOnly$1(editor)) {\n          each(nodes, function (node) {\n            node.attr(internalContentEditableAttr, node.attr('contenteditable'));\n            node.attr('contenteditable', 'false');\n          });\n        }\n      });\n      editor.serializer.addAttributeFilter(internalContentEditableAttr, function (nodes) {\n        if (isReadOnly$1(editor)) {\n          each(nodes, function (node) {\n            node.attr('contenteditable', node.attr(internalContentEditableAttr));\n          });\n        }\n      });\n      editor.serializer.addTempAttr(internalContentEditableAttr);\n    };\n    var registerReadOnlyContentFilters = function (editor) {\n      if (editor.serializer) {\n        registerFilters(editor);\n      } else {\n        editor.on('PreInit', function () {\n          registerFilters(editor);\n        });\n      }\n    };\n    var isClickEvent = function (e) {\n      return e.type === 'click';\n    };\n    var getAnchorHrefOpt = function (editor, elm) {\n      var isRoot = function (elm) {\n        return eq$2(elm, SugarElement.fromDom(editor.getBody()));\n      };\n      return closest$1(elm, 'a', isRoot).bind(function (a) {\n        return getOpt(a, 'href');\n      });\n    };\n    var processReadonlyEvents = function (editor, e) {\n      if (isClickEvent(e) && !VK.metaKeyPressed(e)) {\n        var elm = SugarElement.fromDom(e.target);\n        getAnchorHrefOpt(editor, elm).each(function (href) {\n          e.preventDefault();\n          if (/^#/.test(href)) {\n            var targetEl = editor.dom.select(href + ',[name=\"' + removeLeading(href, '#') + '\"]');\n            if (targetEl.length) {\n              editor.selection.scrollIntoView(targetEl[0], true);\n            }\n          } else {\n            window.open(href, '_blank', 'rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes');\n          }\n        });\n      }\n    };\n    var registerReadOnlySelectionBlockers = function (editor) {\n      editor.on('ShowCaret', function (e) {\n        if (isReadOnly$1(editor)) {\n          e.preventDefault();\n        }\n      });\n      editor.on('ObjectSelected', function (e) {\n        if (isReadOnly$1(editor)) {\n          e.preventDefault();\n        }\n      });\n    };\n\n    var nativeEvents = Tools.makeMap('focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange ' + 'mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover ' + 'draggesture dragdrop drop drag submit ' + 'compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel', ' ');\n    var EventDispatcher = function () {\n      function EventDispatcher(settings) {\n        this.bindings = {};\n        this.settings = settings || {};\n        this.scope = this.settings.scope || this;\n        this.toggleEvent = this.settings.toggleEvent || never;\n      }\n      EventDispatcher.isNative = function (name) {\n        return !!nativeEvents[name.toLowerCase()];\n      };\n      EventDispatcher.prototype.fire = function (nameIn, argsIn) {\n        var name = nameIn.toLowerCase();\n        var args = argsIn || {};\n        args.type = name;\n        if (!args.target) {\n          args.target = this.scope;\n        }\n        if (!args.preventDefault) {\n          args.preventDefault = function () {\n            args.isDefaultPrevented = always;\n          };\n          args.stopPropagation = function () {\n            args.isPropagationStopped = always;\n          };\n          args.stopImmediatePropagation = function () {\n            args.isImmediatePropagationStopped = always;\n          };\n          args.isDefaultPrevented = never;\n          args.isPropagationStopped = never;\n          args.isImmediatePropagationStopped = never;\n        }\n        if (this.settings.beforeFire) {\n          this.settings.beforeFire(args);\n        }\n        var handlers = this.bindings[name];\n        if (handlers) {\n          for (var i = 0, l = handlers.length; i < l; i++) {\n            var callback = handlers[i];\n            if (callback.once) {\n              this.off(name, callback.func);\n            }\n            if (args.isImmediatePropagationStopped()) {\n              args.stopPropagation();\n              return args;\n            }\n            if (callback.func.call(this.scope, args) === false) {\n              args.preventDefault();\n              return args;\n            }\n          }\n        }\n        return args;\n      };\n      EventDispatcher.prototype.on = function (name, callback, prepend, extra) {\n        if (callback === false) {\n          callback = never;\n        }\n        if (callback) {\n          var wrappedCallback = { func: callback };\n          if (extra) {\n            Tools.extend(wrappedCallback, extra);\n          }\n          var names = name.toLowerCase().split(' ');\n          var i = names.length;\n          while (i--) {\n            var currentName = names[i];\n            var handlers = this.bindings[currentName];\n            if (!handlers) {\n              handlers = this.bindings[currentName] = [];\n              this.toggleEvent(currentName, true);\n            }\n            if (prepend) {\n              handlers.unshift(wrappedCallback);\n            } else {\n              handlers.push(wrappedCallback);\n            }\n          }\n        }\n        return this;\n      };\n      EventDispatcher.prototype.off = function (name, callback) {\n        var _this = this;\n        if (name) {\n          var names = name.toLowerCase().split(' ');\n          var i = names.length;\n          while (i--) {\n            var currentName = names[i];\n            var handlers = this.bindings[currentName];\n            if (!currentName) {\n              each$1(this.bindings, function (_value, bindingName) {\n                _this.toggleEvent(bindingName, false);\n                delete _this.bindings[bindingName];\n              });\n              return this;\n            }\n            if (handlers) {\n              if (!callback) {\n                handlers.length = 0;\n              } else {\n                var hi = handlers.length;\n                while (hi--) {\n                  if (handlers[hi].func === callback) {\n                    handlers = handlers.slice(0, hi).concat(handlers.slice(hi + 1));\n                    this.bindings[currentName] = handlers;\n                  }\n                }\n              }\n              if (!handlers.length) {\n                this.toggleEvent(name, false);\n                delete this.bindings[currentName];\n              }\n            }\n          }\n        } else {\n          each$1(this.bindings, function (_value, name) {\n            _this.toggleEvent(name, false);\n          });\n          this.bindings = {};\n        }\n        return this;\n      };\n      EventDispatcher.prototype.once = function (name, callback, prepend) {\n        return this.on(name, callback, prepend, { once: true });\n      };\n      EventDispatcher.prototype.has = function (name) {\n        name = name.toLowerCase();\n        return !(!this.bindings[name] || this.bindings[name].length === 0);\n      };\n      return EventDispatcher;\n    }();\n\n    var getEventDispatcher = function (obj) {\n      if (!obj._eventDispatcher) {\n        obj._eventDispatcher = new EventDispatcher({\n          scope: obj,\n          toggleEvent: function (name, state) {\n            if (EventDispatcher.isNative(name) && obj.toggleNativeEvent) {\n              obj.toggleNativeEvent(name, state);\n            }\n          }\n        });\n      }\n      return obj._eventDispatcher;\n    };\n    var Observable = {\n      fire: function (name, args, bubble) {\n        var self = this;\n        if (self.removed && name !== 'remove' && name !== 'detach') {\n          return args;\n        }\n        var dispatcherArgs = getEventDispatcher(self).fire(name, args);\n        if (bubble !== false && self.parent) {\n          var parent_1 = self.parent();\n          while (parent_1 && !dispatcherArgs.isPropagationStopped()) {\n            parent_1.fire(name, dispatcherArgs, false);\n            parent_1 = parent_1.parent();\n          }\n        }\n        return dispatcherArgs;\n      },\n      on: function (name, callback, prepend) {\n        return getEventDispatcher(this).on(name, callback, prepend);\n      },\n      off: function (name, callback) {\n        return getEventDispatcher(this).off(name, callback);\n      },\n      once: function (name, callback) {\n        return getEventDispatcher(this).once(name, callback);\n      },\n      hasEventListeners: function (name) {\n        return getEventDispatcher(this).has(name);\n      }\n    };\n\n    var DOM$8 = DOMUtils.DOM;\n    var customEventRootDelegates;\n    var getEventTarget = function (editor, eventName) {\n      if (eventName === 'selectionchange') {\n        return editor.getDoc();\n      }\n      if (!editor.inline && /^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)) {\n        return editor.getDoc().documentElement;\n      }\n      var eventRoot = getEventRoot(editor);\n      if (eventRoot) {\n        if (!editor.eventRoot) {\n          editor.eventRoot = DOM$8.select(eventRoot)[0];\n        }\n        return editor.eventRoot;\n      }\n      return editor.getBody();\n    };\n    var isListening = function (editor) {\n      return !editor.hidden && !isReadOnly$1(editor);\n    };\n    var fireEvent = function (editor, eventName, e) {\n      if (isListening(editor)) {\n        editor.fire(eventName, e);\n      } else if (isReadOnly$1(editor)) {\n        processReadonlyEvents(editor, e);\n      }\n    };\n    var bindEventDelegate = function (editor, eventName) {\n      var delegate;\n      if (!editor.delegates) {\n        editor.delegates = {};\n      }\n      if (editor.delegates[eventName] || editor.removed) {\n        return;\n      }\n      var eventRootElm = getEventTarget(editor, eventName);\n      if (getEventRoot(editor)) {\n        if (!customEventRootDelegates) {\n          customEventRootDelegates = {};\n          editor.editorManager.on('removeEditor', function () {\n            if (!editor.editorManager.activeEditor) {\n              if (customEventRootDelegates) {\n                each$1(customEventRootDelegates, function (_value, name) {\n                  editor.dom.unbind(getEventTarget(editor, name));\n                });\n                customEventRootDelegates = null;\n              }\n            }\n          });\n        }\n        if (customEventRootDelegates[eventName]) {\n          return;\n        }\n        delegate = function (e) {\n          var target = e.target;\n          var editors = editor.editorManager.get();\n          var i = editors.length;\n          while (i--) {\n            var body = editors[i].getBody();\n            if (body === target || DOM$8.isChildOf(target, body)) {\n              fireEvent(editors[i], eventName, e);\n            }\n          }\n        };\n        customEventRootDelegates[eventName] = delegate;\n        DOM$8.bind(eventRootElm, eventName, delegate);\n      } else {\n        delegate = function (e) {\n          fireEvent(editor, eventName, e);\n        };\n        DOM$8.bind(eventRootElm, eventName, delegate);\n        editor.delegates[eventName] = delegate;\n      }\n    };\n    var EditorObservable = __assign(__assign({}, Observable), {\n      bindPendingEventDelegates: function () {\n        var self = this;\n        Tools.each(self._pendingNativeEvents, function (name) {\n          bindEventDelegate(self, name);\n        });\n      },\n      toggleNativeEvent: function (name, state) {\n        var self = this;\n        if (name === 'focus' || name === 'blur') {\n          return;\n        }\n        if (state) {\n          if (self.initialized) {\n            bindEventDelegate(self, name);\n          } else {\n            if (!self._pendingNativeEvents) {\n              self._pendingNativeEvents = [name];\n            } else {\n              self._pendingNativeEvents.push(name);\n            }\n          }\n        } else if (self.initialized) {\n          self.dom.unbind(getEventTarget(self, name), name, self.delegates[name]);\n          delete self.delegates[name];\n        }\n      },\n      unbindAllNativeEvents: function () {\n        var self = this;\n        var body = self.getBody();\n        var dom = self.dom;\n        if (self.delegates) {\n          each$1(self.delegates, function (value, name) {\n            self.dom.unbind(getEventTarget(self, name), name, value);\n          });\n          delete self.delegates;\n        }\n        if (!self.inline && body && dom) {\n          body.onload = null;\n          dom.unbind(self.getWin());\n          dom.unbind(self.getDoc());\n        }\n        if (dom) {\n          dom.unbind(body);\n          dom.unbind(self.getContainer());\n        }\n      }\n    });\n\n    var defaultModes = [\n      'design',\n      'readonly'\n    ];\n    var switchToMode = function (editor, activeMode, availableModes, mode) {\n      var oldMode = availableModes[activeMode.get()];\n      var newMode = availableModes[mode];\n      try {\n        newMode.activate();\n      } catch (e) {\n        console.error('problem while activating editor mode ' + mode + ':', e);\n        return;\n      }\n      oldMode.deactivate();\n      if (oldMode.editorReadOnly !== newMode.editorReadOnly) {\n        toggleReadOnly(editor, newMode.editorReadOnly);\n      }\n      activeMode.set(mode);\n      fireSwitchMode(editor, mode);\n    };\n    var setMode = function (editor, availableModes, activeMode, mode) {\n      if (mode === activeMode.get()) {\n        return;\n      } else if (!has(availableModes, mode)) {\n        throw new Error('Editor mode \\'' + mode + '\\' is invalid');\n      }\n      if (editor.initialized) {\n        switchToMode(editor, activeMode, availableModes, mode);\n      } else {\n        editor.on('init', function () {\n          return switchToMode(editor, activeMode, availableModes, mode);\n        });\n      }\n    };\n    var registerMode = function (availableModes, mode, api) {\n      var _a;\n      if (contains(defaultModes, mode)) {\n        throw new Error('Cannot override default mode ' + mode);\n      }\n      return __assign(__assign({}, availableModes), (_a = {}, _a[mode] = __assign(__assign({}, api), {\n        deactivate: function () {\n          try {\n            api.deactivate();\n          } catch (e) {\n            console.error('problem while deactivating editor mode ' + mode + ':', e);\n          }\n        }\n      }), _a));\n    };\n\n    var create$5 = function (editor) {\n      var activeMode = Cell('design');\n      var availableModes = Cell({\n        design: {\n          activate: noop,\n          deactivate: noop,\n          editorReadOnly: false\n        },\n        readonly: {\n          activate: noop,\n          deactivate: noop,\n          editorReadOnly: true\n        }\n      });\n      registerReadOnlyContentFilters(editor);\n      registerReadOnlySelectionBlockers(editor);\n      return {\n        isReadOnly: function () {\n          return isReadOnly$1(editor);\n        },\n        set: function (mode) {\n          return setMode(editor, availableModes.get(), activeMode, mode);\n        },\n        get: function () {\n          return activeMode.get();\n        },\n        register: function (mode, api) {\n          availableModes.set(registerMode(availableModes.get(), mode, api));\n        }\n      };\n    };\n\n    var each$g = Tools.each, explode$3 = Tools.explode;\n    var keyCodeLookup = {\n      f1: 112,\n      f2: 113,\n      f3: 114,\n      f4: 115,\n      f5: 116,\n      f6: 117,\n      f7: 118,\n      f8: 119,\n      f9: 120,\n      f10: 121,\n      f11: 122,\n      f12: 123\n    };\n    var modifierNames = Tools.makeMap('alt,ctrl,shift,meta,access');\n    var parseShortcut = function (pattern) {\n      var key;\n      var shortcut = {};\n      each$g(explode$3(pattern.toLowerCase(), '+'), function (value) {\n        if (value in modifierNames) {\n          shortcut[value] = true;\n        } else {\n          if (/^[0-9]{2,}$/.test(value)) {\n            shortcut.keyCode = parseInt(value, 10);\n          } else {\n            shortcut.charCode = value.charCodeAt(0);\n            shortcut.keyCode = keyCodeLookup[value] || value.toUpperCase().charCodeAt(0);\n          }\n        }\n      });\n      var id = [shortcut.keyCode];\n      for (key in modifierNames) {\n        if (shortcut[key]) {\n          id.push(key);\n        } else {\n          shortcut[key] = false;\n        }\n      }\n      shortcut.id = id.join(',');\n      if (shortcut.access) {\n        shortcut.alt = true;\n        if (Env.mac) {\n          shortcut.ctrl = true;\n        } else {\n          shortcut.shift = true;\n        }\n      }\n      if (shortcut.meta) {\n        if (Env.mac) {\n          shortcut.meta = true;\n        } else {\n          shortcut.ctrl = true;\n          shortcut.meta = false;\n        }\n      }\n      return shortcut;\n    };\n    var Shortcuts = function () {\n      function Shortcuts(editor) {\n        this.shortcuts = {};\n        this.pendingPatterns = [];\n        this.editor = editor;\n        var self = this;\n        editor.on('keyup keypress keydown', function (e) {\n          if ((self.hasModifier(e) || self.isFunctionKey(e)) && !e.isDefaultPrevented()) {\n            each$g(self.shortcuts, function (shortcut) {\n              if (self.matchShortcut(e, shortcut)) {\n                self.pendingPatterns = shortcut.subpatterns.slice(0);\n                if (e.type === 'keydown') {\n                  self.executeShortcutAction(shortcut);\n                }\n                return true;\n              }\n            });\n            if (self.matchShortcut(e, self.pendingPatterns[0])) {\n              if (self.pendingPatterns.length === 1) {\n                if (e.type === 'keydown') {\n                  self.executeShortcutAction(self.pendingPatterns[0]);\n                }\n              }\n              self.pendingPatterns.shift();\n            }\n          }\n        });\n      }\n      Shortcuts.prototype.add = function (pattern, desc, cmdFunc, scope) {\n        var self = this;\n        var func = self.normalizeCommandFunc(cmdFunc);\n        each$g(explode$3(Tools.trim(pattern)), function (pattern) {\n          var shortcut = self.createShortcut(pattern, desc, func, scope);\n          self.shortcuts[shortcut.id] = shortcut;\n        });\n        return true;\n      };\n      Shortcuts.prototype.remove = function (pattern) {\n        var shortcut = this.createShortcut(pattern);\n        if (this.shortcuts[shortcut.id]) {\n          delete this.shortcuts[shortcut.id];\n          return true;\n        }\n        return false;\n      };\n      Shortcuts.prototype.normalizeCommandFunc = function (cmdFunc) {\n        var self = this;\n        var cmd = cmdFunc;\n        if (typeof cmd === 'string') {\n          return function () {\n            self.editor.execCommand(cmd, false, null);\n          };\n        } else if (Tools.isArray(cmd)) {\n          return function () {\n            self.editor.execCommand(cmd[0], cmd[1], cmd[2]);\n          };\n        } else {\n          return cmd;\n        }\n      };\n      Shortcuts.prototype.createShortcut = function (pattern, desc, cmdFunc, scope) {\n        var shortcuts = Tools.map(explode$3(pattern, '>'), parseShortcut);\n        shortcuts[shortcuts.length - 1] = Tools.extend(shortcuts[shortcuts.length - 1], {\n          func: cmdFunc,\n          scope: scope || this.editor\n        });\n        return Tools.extend(shortcuts[0], {\n          desc: this.editor.translate(desc),\n          subpatterns: shortcuts.slice(1)\n        });\n      };\n      Shortcuts.prototype.hasModifier = function (e) {\n        return e.altKey || e.ctrlKey || e.metaKey;\n      };\n      Shortcuts.prototype.isFunctionKey = function (e) {\n        return e.type === 'keydown' && e.keyCode >= 112 && e.keyCode <= 123;\n      };\n      Shortcuts.prototype.matchShortcut = function (e, shortcut) {\n        if (!shortcut) {\n          return false;\n        }\n        if (shortcut.ctrl !== e.ctrlKey || shortcut.meta !== e.metaKey) {\n          return false;\n        }\n        if (shortcut.alt !== e.altKey || shortcut.shift !== e.shiftKey) {\n          return false;\n        }\n        if (e.keyCode === shortcut.keyCode || e.charCode && e.charCode === shortcut.charCode) {\n          e.preventDefault();\n          return true;\n        }\n        return false;\n      };\n      Shortcuts.prototype.executeShortcutAction = function (shortcut) {\n        return shortcut.func ? shortcut.func.call(shortcut.scope) : null;\n      };\n      return Shortcuts;\n    }();\n\n    var create$6 = function () {\n      var buttons = {};\n      var menuItems = {};\n      var popups = {};\n      var icons = {};\n      var contextMenus = {};\n      var contextToolbars = {};\n      var sidebars = {};\n      var add = function (collection, type) {\n        return function (name, spec) {\n          return collection[name.toLowerCase()] = __assign(__assign({}, spec), { type: type });\n        };\n      };\n      var addIcon = function (name, svgData) {\n        return icons[name.toLowerCase()] = svgData;\n      };\n      return {\n        addButton: add(buttons, 'button'),\n        addGroupToolbarButton: add(buttons, 'grouptoolbarbutton'),\n        addToggleButton: add(buttons, 'togglebutton'),\n        addMenuButton: add(buttons, 'menubutton'),\n        addSplitButton: add(buttons, 'splitbutton'),\n        addMenuItem: add(menuItems, 'menuitem'),\n        addNestedMenuItem: add(menuItems, 'nestedmenuitem'),\n        addToggleMenuItem: add(menuItems, 'togglemenuitem'),\n        addAutocompleter: add(popups, 'autocompleter'),\n        addContextMenu: add(contextMenus, 'contextmenu'),\n        addContextToolbar: add(contextToolbars, 'contexttoolbar'),\n        addContextForm: add(contextToolbars, 'contextform'),\n        addSidebar: add(sidebars, 'sidebar'),\n        addIcon: addIcon,\n        getAll: function () {\n          return {\n            buttons: buttons,\n            menuItems: menuItems,\n            icons: icons,\n            popups: popups,\n            contextMenus: contextMenus,\n            contextToolbars: contextToolbars,\n            sidebars: sidebars\n          };\n        }\n      };\n    };\n\n    var registry = function () {\n      var bridge = create$6();\n      return {\n        addAutocompleter: bridge.addAutocompleter,\n        addButton: bridge.addButton,\n        addContextForm: bridge.addContextForm,\n        addContextMenu: bridge.addContextMenu,\n        addContextToolbar: bridge.addContextToolbar,\n        addIcon: bridge.addIcon,\n        addMenuButton: bridge.addMenuButton,\n        addMenuItem: bridge.addMenuItem,\n        addNestedMenuItem: bridge.addNestedMenuItem,\n        addSidebar: bridge.addSidebar,\n        addSplitButton: bridge.addSplitButton,\n        addToggleButton: bridge.addToggleButton,\n        addGroupToolbarButton: bridge.addGroupToolbarButton,\n        addToggleMenuItem: bridge.addToggleMenuItem,\n        getAll: bridge.getAll\n      };\n    };\n\n    var each$h = Tools.each, trim$4 = Tools.trim;\n    var queryParts = 'source protocol authority userInfo user password host port relative path directory file query anchor'.split(' ');\n    var DEFAULT_PORTS = {\n      ftp: 21,\n      http: 80,\n      https: 443,\n      mailto: 25\n    };\n    var URI = function () {\n      function URI(url, settings) {\n        url = trim$4(url);\n        this.settings = settings || {};\n        var baseUri = this.settings.base_uri;\n        var self = this;\n        if (/^([\\w\\-]+):([^\\/]{2})/i.test(url) || /^\\s*#/.test(url)) {\n          self.source = url;\n          return;\n        }\n        var isProtocolRelative = url.indexOf('//') === 0;\n        if (url.indexOf('/') === 0 && !isProtocolRelative) {\n          url = (baseUri ? baseUri.protocol || 'http' : 'http') + '://mce_host' + url;\n        }\n        if (!/^[\\w\\-]*:?\\/\\//.test(url)) {\n          var baseUrl = this.settings.base_uri ? this.settings.base_uri.path : new URI(document.location.href).directory;\n          if (this.settings.base_uri && this.settings.base_uri.protocol == '') {\n            url = '//mce_host' + self.toAbsPath(baseUrl, url);\n          } else {\n            var match = /([^#?]*)([#?]?.*)/.exec(url);\n            url = (baseUri && baseUri.protocol || 'http') + '://mce_host' + self.toAbsPath(baseUrl, match[1]) + match[2];\n          }\n        }\n        url = url.replace(/@@/g, '(mce_at)');\n        var urlMatch = /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@\\/]*):?([^:@\\/]*))?@)?(\\[[a-zA-Z0-9:.%]+\\]|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(url);\n        each$h(queryParts, function (v, i) {\n          var part = urlMatch[i];\n          if (part) {\n            part = part.replace(/\\(mce_at\\)/g, '@@');\n          }\n          self[v] = part;\n        });\n        if (baseUri) {\n          if (!self.protocol) {\n            self.protocol = baseUri.protocol;\n          }\n          if (!self.userInfo) {\n            self.userInfo = baseUri.userInfo;\n          }\n          if (!self.port && self.host === 'mce_host') {\n            self.port = baseUri.port;\n          }\n          if (!self.host || self.host === 'mce_host') {\n            self.host = baseUri.host;\n          }\n          self.source = '';\n        }\n        if (isProtocolRelative) {\n          self.protocol = '';\n        }\n      }\n      URI.parseDataUri = function (uri) {\n        var type;\n        var uriComponents = decodeURIComponent(uri).split(',');\n        var matches = /data:([^;]+)/.exec(uriComponents[0]);\n        if (matches) {\n          type = matches[1];\n        }\n        return {\n          type: type,\n          data: uriComponents[1]\n        };\n      };\n      URI.getDocumentBaseUrl = function (loc) {\n        var baseUrl;\n        if (loc.protocol.indexOf('http') !== 0 && loc.protocol !== 'file:') {\n          baseUrl = loc.href;\n        } else {\n          baseUrl = loc.protocol + '//' + loc.host + loc.pathname;\n        }\n        if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(baseUrl)) {\n          baseUrl = baseUrl.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n          if (!/[\\/\\\\]$/.test(baseUrl)) {\n            baseUrl += '/';\n          }\n        }\n        return baseUrl;\n      };\n      URI.prototype.setPath = function (path) {\n        var pathMatch = /^(.*?)\\/?(\\w+)?$/.exec(path);\n        this.path = pathMatch[0];\n        this.directory = pathMatch[1];\n        this.file = pathMatch[2];\n        this.source = '';\n        this.getURI();\n      };\n      URI.prototype.toRelative = function (uri) {\n        var output;\n        if (uri === './') {\n          return uri;\n        }\n        var relativeUri = new URI(uri, { base_uri: this });\n        if (relativeUri.host !== 'mce_host' && this.host !== relativeUri.host && relativeUri.host || this.port !== relativeUri.port || this.protocol !== relativeUri.protocol && relativeUri.protocol !== '') {\n          return relativeUri.getURI();\n        }\n        var tu = this.getURI(), uu = relativeUri.getURI();\n        if (tu === uu || tu.charAt(tu.length - 1) === '/' && tu.substr(0, tu.length - 1) === uu) {\n          return tu;\n        }\n        output = this.toRelPath(this.path, relativeUri.path);\n        if (relativeUri.query) {\n          output += '?' + relativeUri.query;\n        }\n        if (relativeUri.anchor) {\n          output += '#' + relativeUri.anchor;\n        }\n        return output;\n      };\n      URI.prototype.toAbsolute = function (uri, noHost) {\n        var absoluteUri = new URI(uri, { base_uri: this });\n        return absoluteUri.getURI(noHost && this.isSameOrigin(absoluteUri));\n      };\n      URI.prototype.isSameOrigin = function (uri) {\n        if (this.host == uri.host && this.protocol == uri.protocol) {\n          if (this.port == uri.port) {\n            return true;\n          }\n          var defaultPort = DEFAULT_PORTS[this.protocol];\n          if (defaultPort && (this.port || defaultPort) == (uri.port || defaultPort)) {\n            return true;\n          }\n        }\n        return false;\n      };\n      URI.prototype.toRelPath = function (base, path) {\n        var breakPoint = 0, out = '', i, l;\n        var normalizedBase = base.substring(0, base.lastIndexOf('/')).split('/');\n        var items = path.split('/');\n        if (normalizedBase.length >= items.length) {\n          for (i = 0, l = normalizedBase.length; i < l; i++) {\n            if (i >= items.length || normalizedBase[i] !== items[i]) {\n              breakPoint = i + 1;\n              break;\n            }\n          }\n        }\n        if (normalizedBase.length < items.length) {\n          for (i = 0, l = items.length; i < l; i++) {\n            if (i >= normalizedBase.length || normalizedBase[i] !== items[i]) {\n              breakPoint = i + 1;\n              break;\n            }\n          }\n        }\n        if (breakPoint === 1) {\n          return path;\n        }\n        for (i = 0, l = normalizedBase.length - (breakPoint - 1); i < l; i++) {\n          out += '../';\n        }\n        for (i = breakPoint - 1, l = items.length; i < l; i++) {\n          if (i !== breakPoint - 1) {\n            out += '/' + items[i];\n          } else {\n            out += items[i];\n          }\n        }\n        return out;\n      };\n      URI.prototype.toAbsPath = function (base, path) {\n        var i, nb = 0, o = [], outPath;\n        var tr = /\\/$/.test(path) ? '/' : '';\n        var normalizedBase = base.split('/');\n        var normalizedPath = path.split('/');\n        each$h(normalizedBase, function (k) {\n          if (k) {\n            o.push(k);\n          }\n        });\n        normalizedBase = o;\n        for (i = normalizedPath.length - 1, o = []; i >= 0; i--) {\n          if (normalizedPath[i].length === 0 || normalizedPath[i] === '.') {\n            continue;\n          }\n          if (normalizedPath[i] === '..') {\n            nb++;\n            continue;\n          }\n          if (nb > 0) {\n            nb--;\n            continue;\n          }\n          o.push(normalizedPath[i]);\n        }\n        i = normalizedBase.length - nb;\n        if (i <= 0) {\n          outPath = reverse(o).join('/');\n        } else {\n          outPath = normalizedBase.slice(0, i).join('/') + '/' + reverse(o).join('/');\n        }\n        if (outPath.indexOf('/') !== 0) {\n          outPath = '/' + outPath;\n        }\n        if (tr && outPath.lastIndexOf('/') !== outPath.length - 1) {\n          outPath += tr;\n        }\n        return outPath;\n      };\n      URI.prototype.getURI = function (noProtoHost) {\n        if (noProtoHost === void 0) {\n          noProtoHost = false;\n        }\n        var s;\n        if (!this.source || noProtoHost) {\n          s = '';\n          if (!noProtoHost) {\n            if (this.protocol) {\n              s += this.protocol + '://';\n            } else {\n              s += '//';\n            }\n            if (this.userInfo) {\n              s += this.userInfo + '@';\n            }\n            if (this.host) {\n              s += this.host;\n            }\n            if (this.port) {\n              s += ':' + this.port;\n            }\n          }\n          if (this.path) {\n            s += this.path;\n          }\n          if (this.query) {\n            s += '?' + this.query;\n          }\n          if (this.anchor) {\n            s += '#' + this.anchor;\n          }\n          this.source = s;\n        }\n        return this.source;\n      };\n      return URI;\n    }();\n\n    var DOM$9 = DOMUtils.DOM;\n    var extend$3 = Tools.extend, each$i = Tools.each;\n    var resolve$3 = Tools.resolve;\n    var ie$1 = Env.ie;\n    var Editor = function () {\n      function Editor(id, settings, editorManager) {\n        var _this = this;\n        this.plugins = {};\n        this.contentCSS = [];\n        this.contentStyles = [];\n        this.loadedCSS = {};\n        this.isNotDirty = false;\n        this.editorManager = editorManager;\n        this.documentBaseUrl = editorManager.documentBaseURL;\n        extend$3(this, EditorObservable);\n        this.settings = getEditorSettings(this, id, this.documentBaseUrl, editorManager.defaultSettings, settings);\n        if (this.settings.suffix) {\n          editorManager.suffix = this.settings.suffix;\n        }\n        this.suffix = editorManager.suffix;\n        if (this.settings.base_url) {\n          editorManager._setBaseUrl(this.settings.base_url);\n        }\n        this.baseUri = editorManager.baseURI;\n        if (this.settings.referrer_policy) {\n          ScriptLoader.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy);\n          DOMUtils.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy);\n        }\n        AddOnManager.languageLoad = this.settings.language_load;\n        AddOnManager.baseURL = editorManager.baseURL;\n        this.id = id;\n        this.setDirty(false);\n        this.documentBaseURI = new URI(this.settings.document_base_url, { base_uri: this.baseUri });\n        this.baseURI = this.baseUri;\n        this.inline = !!this.settings.inline;\n        this.shortcuts = new Shortcuts(this);\n        this.editorCommands = new EditorCommands(this);\n        if (this.settings.cache_suffix) {\n          Env.cacheSuffix = this.settings.cache_suffix.replace(/^[\\?\\&]+/, '');\n        }\n        this.ui = {\n          registry: registry(),\n          styleSheetLoader: undefined,\n          show: noop,\n          hide: noop,\n          enable: noop,\n          disable: noop,\n          isDisabled: never\n        };\n        var self = this;\n        var modeInstance = create$5(self);\n        this.mode = modeInstance;\n        this.setMode = modeInstance.set;\n        editorManager.fire('SetupEditor', { editor: this });\n        this.execCallback('setup', this);\n        this.$ = DomQuery.overrideDefaults(function () {\n          return {\n            context: _this.inline ? _this.getBody() : _this.getDoc(),\n            element: _this.getBody()\n          };\n        });\n      }\n      Editor.prototype.render = function () {\n        render(this);\n      };\n      Editor.prototype.focus = function (skipFocus) {\n        focus$1(this, skipFocus);\n      };\n      Editor.prototype.hasFocus = function () {\n        return hasFocus$1(this);\n      };\n      Editor.prototype.execCallback = function (name) {\n        var x = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          x[_i - 1] = arguments[_i];\n        }\n        var self = this;\n        var callback = self.settings[name], scope;\n        if (!callback) {\n          return;\n        }\n        if (self.callbackLookup && (scope = self.callbackLookup[name])) {\n          callback = scope.func;\n          scope = scope.scope;\n        }\n        if (typeof callback === 'string') {\n          scope = callback.replace(/\\.\\w+$/, '');\n          scope = scope ? resolve$3(scope) : 0;\n          callback = resolve$3(callback);\n          self.callbackLookup = self.callbackLookup || {};\n          self.callbackLookup[name] = {\n            func: callback,\n            scope: scope\n          };\n        }\n        return callback.apply(scope || self, x);\n      };\n      Editor.prototype.translate = function (text) {\n        return I18n.translate(text);\n      };\n      Editor.prototype.getParam = function (name, defaultVal, type) {\n        return getParam(this, name, defaultVal, type);\n      };\n      Editor.prototype.hasPlugin = function (name, loaded) {\n        var hasPlugin = contains(getPlugins(this).split(/[ ,]/), name);\n        if (hasPlugin) {\n          return loaded ? PluginManager.get(name) !== undefined : true;\n        } else {\n          return false;\n        }\n      };\n      Editor.prototype.nodeChanged = function (args) {\n        this._nodeChangeDispatcher.nodeChanged(args);\n      };\n      Editor.prototype.addCommand = function (name, callback, scope) {\n        this.editorCommands.addCommand(name, callback, scope);\n      };\n      Editor.prototype.addQueryStateHandler = function (name, callback, scope) {\n        this.editorCommands.addQueryStateHandler(name, callback, scope);\n      };\n      Editor.prototype.addQueryValueHandler = function (name, callback, scope) {\n        this.editorCommands.addQueryValueHandler(name, callback, scope);\n      };\n      Editor.prototype.addShortcut = function (pattern, desc, cmdFunc, scope) {\n        this.shortcuts.add(pattern, desc, cmdFunc, scope);\n      };\n      Editor.prototype.execCommand = function (cmd, ui, value, args) {\n        return this.editorCommands.execCommand(cmd, ui, value, args);\n      };\n      Editor.prototype.queryCommandState = function (cmd) {\n        return this.editorCommands.queryCommandState(cmd);\n      };\n      Editor.prototype.queryCommandValue = function (cmd) {\n        return this.editorCommands.queryCommandValue(cmd);\n      };\n      Editor.prototype.queryCommandSupported = function (cmd) {\n        return this.editorCommands.queryCommandSupported(cmd);\n      };\n      Editor.prototype.show = function () {\n        var self = this;\n        if (self.hidden) {\n          self.hidden = false;\n          if (self.inline) {\n            self.getBody().contentEditable = 'true';\n          } else {\n            DOM$9.show(self.getContainer());\n            DOM$9.hide(self.id);\n          }\n          self.load();\n          self.fire('show');\n        }\n      };\n      Editor.prototype.hide = function () {\n        var self = this, doc = self.getDoc();\n        if (!self.hidden) {\n          if (ie$1 && doc && !self.inline) {\n            doc.execCommand('SelectAll');\n          }\n          self.save();\n          if (self.inline) {\n            self.getBody().contentEditable = 'false';\n            if (self === self.editorManager.focusedEditor) {\n              self.editorManager.focusedEditor = null;\n            }\n          } else {\n            DOM$9.hide(self.getContainer());\n            DOM$9.setStyle(self.id, 'display', self.orgDisplay);\n          }\n          self.hidden = true;\n          self.fire('hide');\n        }\n      };\n      Editor.prototype.isHidden = function () {\n        return !!this.hidden;\n      };\n      Editor.prototype.setProgressState = function (state, time) {\n        this.fire('ProgressState', {\n          state: state,\n          time: time\n        });\n      };\n      Editor.prototype.load = function (args) {\n        var self = this;\n        var elm = self.getElement(), html;\n        if (self.removed) {\n          return '';\n        }\n        if (elm) {\n          args = args || {};\n          args.load = true;\n          var value = isTextareaOrInput(elm) ? elm.value : elm.innerHTML;\n          html = self.setContent(value, args);\n          args.element = elm;\n          if (!args.no_events) {\n            self.fire('LoadContent', args);\n          }\n          args.element = elm = null;\n          return html;\n        }\n      };\n      Editor.prototype.save = function (args) {\n        var self = this;\n        var elm = self.getElement(), html, form;\n        if (!elm || !self.initialized || self.removed) {\n          return;\n        }\n        args = args || {};\n        args.save = true;\n        args.element = elm;\n        html = args.content = self.getContent(args);\n        if (!args.no_events) {\n          self.fire('SaveContent', args);\n        }\n        if (args.format === 'raw') {\n          self.fire('RawSaveContent', args);\n        }\n        html = args.content;\n        if (!isTextareaOrInput(elm)) {\n          if (args.is_removing || !self.inline) {\n            elm.innerHTML = html;\n          }\n          if (form = DOM$9.getParent(self.id, 'form')) {\n            each$i(form.elements, function (elm) {\n              if (elm.name === self.id) {\n                elm.value = html;\n                return false;\n              }\n            });\n          }\n        } else {\n          elm.value = html;\n        }\n        args.element = elm = null;\n        if (args.set_dirty !== false) {\n          self.setDirty(false);\n        }\n        return html;\n      };\n      Editor.prototype.setContent = function (content, args) {\n        return setContent$2(this, content, args);\n      };\n      Editor.prototype.getContent = function (args) {\n        return getContent$2(this, args);\n      };\n      Editor.prototype.insertContent = function (content, args) {\n        if (args) {\n          content = extend$3({ content: content }, args);\n        }\n        this.execCommand('mceInsertContent', false, content);\n      };\n      Editor.prototype.resetContent = function (initialContent) {\n        if (initialContent === undefined) {\n          setContent$2(this, this.startContent, { format: 'raw' });\n        } else {\n          setContent$2(this, initialContent);\n        }\n        this.undoManager.reset();\n        this.setDirty(false);\n        this.nodeChanged();\n      };\n      Editor.prototype.isDirty = function () {\n        return !this.isNotDirty;\n      };\n      Editor.prototype.setDirty = function (state) {\n        var oldState = !this.isNotDirty;\n        this.isNotDirty = !state;\n        if (state && state !== oldState) {\n          this.fire('dirty');\n        }\n      };\n      Editor.prototype.getContainer = function () {\n        var self = this;\n        if (!self.container) {\n          self.container = DOM$9.get(self.editorContainer || self.id + '_parent');\n        }\n        return self.container;\n      };\n      Editor.prototype.getContentAreaContainer = function () {\n        return this.contentAreaContainer;\n      };\n      Editor.prototype.getElement = function () {\n        if (!this.targetElm) {\n          this.targetElm = DOM$9.get(this.id);\n        }\n        return this.targetElm;\n      };\n      Editor.prototype.getWin = function () {\n        var self = this;\n        var elm;\n        if (!self.contentWindow) {\n          elm = self.iframeElement;\n          if (elm) {\n            self.contentWindow = elm.contentWindow;\n          }\n        }\n        return self.contentWindow;\n      };\n      Editor.prototype.getDoc = function () {\n        var self = this;\n        var win;\n        if (!self.contentDocument) {\n          win = self.getWin();\n          if (win) {\n            self.contentDocument = win.document;\n          }\n        }\n        return self.contentDocument;\n      };\n      Editor.prototype.getBody = function () {\n        var doc = this.getDoc();\n        return this.bodyElement || (doc ? doc.body : null);\n      };\n      Editor.prototype.convertURL = function (url, name, elm) {\n        var self = this, settings = self.settings;\n        if (settings.urlconverter_callback) {\n          return self.execCallback('urlconverter_callback', url, elm, true, name);\n        }\n        if (!settings.convert_urls || elm && elm.nodeName === 'LINK' || url.indexOf('file:') === 0 || url.length === 0) {\n          return url;\n        }\n        if (settings.relative_urls) {\n          return self.documentBaseURI.toRelative(url);\n        }\n        url = self.documentBaseURI.toAbsolute(url, settings.remove_script_host);\n        return url;\n      };\n      Editor.prototype.addVisual = function (elm) {\n        addVisual$1(this, elm);\n      };\n      Editor.prototype.remove = function () {\n        remove$7(this);\n      };\n      Editor.prototype.destroy = function (automatic) {\n        destroy(this, automatic);\n      };\n      Editor.prototype.uploadImages = function (callback) {\n        return this.editorUpload.uploadImages(callback);\n      };\n      Editor.prototype._scanForImages = function () {\n        return this.editorUpload.scanForImages();\n      };\n      Editor.prototype.addButton = function () {\n        throw new Error('editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead');\n      };\n      Editor.prototype.addSidebar = function () {\n        throw new Error('editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead');\n      };\n      Editor.prototype.addMenuItem = function () {\n        throw new Error('editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead');\n      };\n      Editor.prototype.addContextToolbar = function () {\n        throw new Error('editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead');\n      };\n      return Editor;\n    }();\n\n    var DOM$a = DOMUtils.DOM;\n    var explode$4 = Tools.explode, each$j = Tools.each, extend$4 = Tools.extend;\n    var instanceCounter = 0, boundGlobalEvents = false;\n    var beforeUnloadDelegate;\n    var legacyEditors = [];\n    var editors = [];\n    var isValidLegacyKey = function (id) {\n      return id !== 'length';\n    };\n    var globalEventDelegate = function (e) {\n      var type = e.type;\n      each$j(EditorManager.get(), function (editor) {\n        switch (type) {\n        case 'scroll':\n          editor.fire('ScrollWindow', e);\n          break;\n        case 'resize':\n          editor.fire('ResizeWindow', e);\n          break;\n        }\n      });\n    };\n    var toggleGlobalEvents = function (state) {\n      if (state !== boundGlobalEvents) {\n        if (state) {\n          DomQuery(window).on('resize scroll', globalEventDelegate);\n        } else {\n          DomQuery(window).off('resize scroll', globalEventDelegate);\n        }\n        boundGlobalEvents = state;\n      }\n    };\n    var removeEditorFromList = function (targetEditor) {\n      var oldEditors = editors;\n      delete legacyEditors[targetEditor.id];\n      for (var i = 0; i < legacyEditors.length; i++) {\n        if (legacyEditors[i] === targetEditor) {\n          legacyEditors.splice(i, 1);\n          break;\n        }\n      }\n      editors = filter(editors, function (editor) {\n        return targetEditor !== editor;\n      });\n      if (EditorManager.activeEditor === targetEditor) {\n        EditorManager.activeEditor = editors.length > 0 ? editors[0] : null;\n      }\n      if (EditorManager.focusedEditor === targetEditor) {\n        EditorManager.focusedEditor = null;\n      }\n      return oldEditors.length !== editors.length;\n    };\n    var purgeDestroyedEditor = function (editor) {\n      if (editor && editor.initialized && !(editor.getContainer() || editor.getBody()).parentNode) {\n        removeEditorFromList(editor);\n        editor.unbindAllNativeEvents();\n        editor.destroy(true);\n        editor.removed = true;\n        editor = null;\n      }\n      return editor;\n    };\n    var isQuirksMode = document.compatMode !== 'CSS1Compat';\n    var EditorManager = __assign(__assign({}, Observable), {\n      baseURI: null,\n      baseURL: null,\n      defaultSettings: {},\n      documentBaseURL: null,\n      suffix: null,\n      $: DomQuery,\n      majorVersion: '5',\n      minorVersion: '7.1',\n      releaseDate: '2021-03-17',\n      editors: legacyEditors,\n      i18n: I18n,\n      activeEditor: null,\n      focusedEditor: null,\n      settings: {},\n      setup: function () {\n        var self = this;\n        var baseURL, documentBaseURL, suffix = '';\n        documentBaseURL = URI.getDocumentBaseUrl(document.location);\n        if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(documentBaseURL)) {\n          documentBaseURL = documentBaseURL.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n          if (!/[\\/\\\\]$/.test(documentBaseURL)) {\n            documentBaseURL += '/';\n          }\n        }\n        var preInit = window.tinymce || window.tinyMCEPreInit;\n        if (preInit) {\n          baseURL = preInit.base || preInit.baseURL;\n          suffix = preInit.suffix;\n        } else {\n          var scripts = document.getElementsByTagName('script');\n          for (var i = 0; i < scripts.length; i++) {\n            var src = scripts[i].src || '';\n            if (src === '') {\n              continue;\n            }\n            var srcScript = src.substring(src.lastIndexOf('/'));\n            if (/tinymce(\\.full|\\.jquery|)(\\.min|\\.dev|)\\.js/.test(src)) {\n              if (srcScript.indexOf('.min') !== -1) {\n                suffix = '.min';\n              }\n              baseURL = src.substring(0, src.lastIndexOf('/'));\n              break;\n            }\n          }\n          if (!baseURL && document.currentScript) {\n            var src = document.currentScript.src;\n            if (src.indexOf('.min') !== -1) {\n              suffix = '.min';\n            }\n            baseURL = src.substring(0, src.lastIndexOf('/'));\n          }\n        }\n        self.baseURL = new URI(documentBaseURL).toAbsolute(baseURL);\n        self.documentBaseURL = documentBaseURL;\n        self.baseURI = new URI(self.baseURL);\n        self.suffix = suffix;\n        setup$2(self);\n      },\n      overrideDefaults: function (defaultSettings) {\n        var baseUrl = defaultSettings.base_url;\n        if (baseUrl) {\n          this._setBaseUrl(baseUrl);\n        }\n        var suffix = defaultSettings.suffix;\n        if (defaultSettings.suffix) {\n          this.suffix = suffix;\n        }\n        this.defaultSettings = defaultSettings;\n        var pluginBaseUrls = defaultSettings.plugin_base_urls;\n        if (pluginBaseUrls !== undefined) {\n          each$1(pluginBaseUrls, function (pluginBaseUrl, pluginName) {\n            AddOnManager.PluginManager.urls[pluginName] = pluginBaseUrl;\n          });\n        }\n      },\n      init: function (settings) {\n        var self = this;\n        var result;\n        var invalidInlineTargets = Tools.makeMap('area base basefont br col frame hr img input isindex link meta param embed source wbr track ' + 'colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu', ' ');\n        var isInvalidInlineTarget = function (settings, elm) {\n          return settings.inline && elm.tagName.toLowerCase() in invalidInlineTargets;\n        };\n        var createId = function (elm) {\n          var id = elm.id;\n          if (!id) {\n            id = get$1(elm, 'name').filter(function (name) {\n              return !DOM$a.get(name);\n            }).getOrThunk(DOM$a.uniqueId);\n            elm.setAttribute('id', id);\n          }\n          return id;\n        };\n        var execCallback = function (name) {\n          var callback = settings[name];\n          if (!callback) {\n            return;\n          }\n          return callback.apply(self, []);\n        };\n        var hasClass = function (elm, className) {\n          return className.constructor === RegExp ? className.test(elm.className) : DOM$a.hasClass(elm, className);\n        };\n        var findTargets = function (settings) {\n          var targets = [];\n          if (Env.browser.isIE() && Env.browser.version.major < 11) {\n            initError('TinyMCE does not support the browser you are using. For a list of supported' + ' browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/');\n            return [];\n          } else if (isQuirksMode) {\n            initError('Failed to initialize the editor as the document is not in standards mode. ' + 'TinyMCE requires standards mode.');\n            return [];\n          }\n          if (settings.types) {\n            each$j(settings.types, function (type) {\n              targets = targets.concat(DOM$a.select(type.selector));\n            });\n            return targets;\n          } else if (settings.selector) {\n            return DOM$a.select(settings.selector);\n          } else if (settings.target) {\n            return [settings.target];\n          }\n          switch (settings.mode) {\n          case 'exact':\n            var l = settings.elements || '';\n            if (l.length > 0) {\n              each$j(explode$4(l), function (id) {\n                var elm = DOM$a.get(id);\n                if (elm) {\n                  targets.push(elm);\n                } else {\n                  each$j(document.forms, function (f) {\n                    each$j(f.elements, function (e) {\n                      if (e.name === id) {\n                        id = 'mce_editor_' + instanceCounter++;\n                        DOM$a.setAttrib(e, 'id', id);\n                        targets.push(e);\n                      }\n                    });\n                  });\n                }\n              });\n            }\n            break;\n          case 'textareas':\n          case 'specific_textareas':\n            each$j(DOM$a.select('textarea'), function (elm) {\n              if (settings.editor_deselector && hasClass(elm, settings.editor_deselector)) {\n                return;\n              }\n              if (!settings.editor_selector || hasClass(elm, settings.editor_selector)) {\n                targets.push(elm);\n              }\n            });\n            break;\n          }\n          return targets;\n        };\n        var provideResults = function (editors) {\n          result = editors;\n        };\n        var initEditors = function () {\n          var initCount = 0;\n          var editors = [];\n          var targets;\n          var createEditor = function (id, settings, targetElm) {\n            var editor = new Editor(id, settings, self);\n            editors.push(editor);\n            editor.on('init', function () {\n              if (++initCount === targets.length) {\n                provideResults(editors);\n              }\n            });\n            editor.targetElm = editor.targetElm || targetElm;\n            editor.render();\n          };\n          DOM$a.unbind(window, 'ready', initEditors);\n          execCallback('onpageload');\n          targets = DomQuery.unique(findTargets(settings));\n          if (settings.types) {\n            each$j(settings.types, function (type) {\n              Tools.each(targets, function (elm) {\n                if (DOM$a.is(elm, type.selector)) {\n                  createEditor(createId(elm), extend$4({}, settings, type), elm);\n                  return false;\n                }\n                return true;\n              });\n            });\n            return;\n          }\n          Tools.each(targets, function (elm) {\n            purgeDestroyedEditor(self.get(elm.id));\n          });\n          targets = Tools.grep(targets, function (elm) {\n            return !self.get(elm.id);\n          });\n          if (targets.length === 0) {\n            provideResults([]);\n          } else {\n            each$j(targets, function (elm) {\n              if (isInvalidInlineTarget(settings, elm)) {\n                initError('Could not initialize inline editor on invalid inline target element', elm);\n              } else {\n                createEditor(createId(elm), settings, elm);\n              }\n            });\n          }\n        };\n        self.settings = settings;\n        DOM$a.bind(window, 'ready', initEditors);\n        return new promiseObj(function (resolve) {\n          if (result) {\n            resolve(result);\n          } else {\n            provideResults = function (editors) {\n              resolve(editors);\n            };\n          }\n        });\n      },\n      get: function (id) {\n        if (arguments.length === 0) {\n          return editors.slice(0);\n        } else if (isString(id)) {\n          return find(editors, function (editor) {\n            return editor.id === id;\n          }).getOr(null);\n        } else if (isNumber(id)) {\n          return editors[id] ? editors[id] : null;\n        } else {\n          return null;\n        }\n      },\n      add: function (editor) {\n        var self = this;\n        var existingEditor = legacyEditors[editor.id];\n        if (existingEditor === editor) {\n          return editor;\n        }\n        if (self.get(editor.id) === null) {\n          if (isValidLegacyKey(editor.id)) {\n            legacyEditors[editor.id] = editor;\n          }\n          legacyEditors.push(editor);\n          editors.push(editor);\n        }\n        toggleGlobalEvents(true);\n        self.activeEditor = editor;\n        self.fire('AddEditor', { editor: editor });\n        if (!beforeUnloadDelegate) {\n          beforeUnloadDelegate = function (e) {\n            var event = self.fire('BeforeUnload');\n            if (event.returnValue) {\n              e.preventDefault();\n              e.returnValue = event.returnValue;\n              return event.returnValue;\n            }\n          };\n          window.addEventListener('beforeunload', beforeUnloadDelegate);\n        }\n        return editor;\n      },\n      createEditor: function (id, settings) {\n        return this.add(new Editor(id, settings, this));\n      },\n      remove: function (selector) {\n        var self = this;\n        var i, editor;\n        if (!selector) {\n          for (i = editors.length - 1; i >= 0; i--) {\n            self.remove(editors[i]);\n          }\n          return;\n        }\n        if (isString(selector)) {\n          each$j(DOM$a.select(selector), function (elm) {\n            editor = self.get(elm.id);\n            if (editor) {\n              self.remove(editor);\n            }\n          });\n          return;\n        }\n        editor = selector;\n        if (isNull(self.get(editor.id))) {\n          return null;\n        }\n        if (removeEditorFromList(editor)) {\n          self.fire('RemoveEditor', { editor: editor });\n        }\n        if (editors.length === 0) {\n          window.removeEventListener('beforeunload', beforeUnloadDelegate);\n        }\n        editor.remove();\n        toggleGlobalEvents(editors.length > 0);\n        return editor;\n      },\n      execCommand: function (cmd, ui, value) {\n        var self = this, editor = self.get(value);\n        switch (cmd) {\n        case 'mceAddEditor':\n          if (!self.get(value)) {\n            new Editor(value, self.settings, self).render();\n          }\n          return true;\n        case 'mceRemoveEditor':\n          if (editor) {\n            editor.remove();\n          }\n          return true;\n        case 'mceToggleEditor':\n          if (!editor) {\n            self.execCommand('mceAddEditor', false, value);\n            return true;\n          }\n          if (editor.isHidden()) {\n            editor.show();\n          } else {\n            editor.hide();\n          }\n          return true;\n        }\n        if (self.activeEditor) {\n          return self.activeEditor.execCommand(cmd, ui, value);\n        }\n        return false;\n      },\n      triggerSave: function () {\n        each$j(editors, function (editor) {\n          editor.save();\n        });\n      },\n      addI18n: function (code, items) {\n        I18n.add(code, items);\n      },\n      translate: function (text) {\n        return I18n.translate(text);\n      },\n      setActive: function (editor) {\n        var activeEditor = this.activeEditor;\n        if (this.activeEditor !== editor) {\n          if (activeEditor) {\n            activeEditor.fire('deactivate', { relatedTarget: editor });\n          }\n          editor.fire('activate', { relatedTarget: activeEditor });\n        }\n        this.activeEditor = editor;\n      },\n      _setBaseUrl: function (baseUrl) {\n        this.baseURL = new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\\/+$/, ''));\n        this.baseURI = new URI(this.baseURL);\n      }\n    });\n    EditorManager.setup();\n\n    var min = Math.min, max = Math.max, round$1 = Math.round;\n    var relativePosition = function (rect, targetRect, rel) {\n      var x = targetRect.x;\n      var y = targetRect.y;\n      var w = rect.w;\n      var h = rect.h;\n      var targetW = targetRect.w;\n      var targetH = targetRect.h;\n      var relChars = (rel || '').split('');\n      if (relChars[0] === 'b') {\n        y += targetH;\n      }\n      if (relChars[1] === 'r') {\n        x += targetW;\n      }\n      if (relChars[0] === 'c') {\n        y += round$1(targetH / 2);\n      }\n      if (relChars[1] === 'c') {\n        x += round$1(targetW / 2);\n      }\n      if (relChars[3] === 'b') {\n        y -= h;\n      }\n      if (relChars[4] === 'r') {\n        x -= w;\n      }\n      if (relChars[3] === 'c') {\n        y -= round$1(h / 2);\n      }\n      if (relChars[4] === 'c') {\n        x -= round$1(w / 2);\n      }\n      return create$7(x, y, w, h);\n    };\n    var findBestRelativePosition = function (rect, targetRect, constrainRect, rels) {\n      var pos, i;\n      for (i = 0; i < rels.length; i++) {\n        pos = relativePosition(rect, targetRect, rels[i]);\n        if (pos.x >= constrainRect.x && pos.x + pos.w <= constrainRect.w + constrainRect.x && pos.y >= constrainRect.y && pos.y + pos.h <= constrainRect.h + constrainRect.y) {\n          return rels[i];\n        }\n      }\n      return null;\n    };\n    var inflate = function (rect, w, h) {\n      return create$7(rect.x - w, rect.y - h, rect.w + w * 2, rect.h + h * 2);\n    };\n    var intersect = function (rect, cropRect) {\n      var x1 = max(rect.x, cropRect.x);\n      var y1 = max(rect.y, cropRect.y);\n      var x2 = min(rect.x + rect.w, cropRect.x + cropRect.w);\n      var y2 = min(rect.y + rect.h, cropRect.y + cropRect.h);\n      if (x2 - x1 < 0 || y2 - y1 < 0) {\n        return null;\n      }\n      return create$7(x1, y1, x2 - x1, y2 - y1);\n    };\n    var clamp$1 = function (rect, clampRect, fixedSize) {\n      var x1 = rect.x;\n      var y1 = rect.y;\n      var x2 = rect.x + rect.w;\n      var y2 = rect.y + rect.h;\n      var cx2 = clampRect.x + clampRect.w;\n      var cy2 = clampRect.y + clampRect.h;\n      var underflowX1 = max(0, clampRect.x - x1);\n      var underflowY1 = max(0, clampRect.y - y1);\n      var overflowX2 = max(0, x2 - cx2);\n      var overflowY2 = max(0, y2 - cy2);\n      x1 += underflowX1;\n      y1 += underflowY1;\n      if (fixedSize) {\n        x2 += underflowX1;\n        y2 += underflowY1;\n        x1 -= overflowX2;\n        y1 -= overflowY2;\n      }\n      x2 -= overflowX2;\n      y2 -= overflowY2;\n      return create$7(x1, y1, x2 - x1, y2 - y1);\n    };\n    var create$7 = function (x, y, w, h) {\n      return {\n        x: x,\n        y: y,\n        w: w,\n        h: h\n      };\n    };\n    var fromClientRect = function (clientRect) {\n      return create$7(clientRect.left, clientRect.top, clientRect.width, clientRect.height);\n    };\n    var Rect = {\n      inflate: inflate,\n      relativePosition: relativePosition,\n      findBestRelativePosition: findBestRelativePosition,\n      intersect: intersect,\n      clamp: clamp$1,\n      create: create$7,\n      fromClientRect: fromClientRect\n    };\n\n    var awaiter = function (resolveCb, rejectCb, timeout) {\n      if (timeout === void 0) {\n        timeout = 1000;\n      }\n      var done = false;\n      var timer = null;\n      var complete = function (completer) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          if (!done) {\n            done = true;\n            if (timer !== null) {\n              clearTimeout(timer);\n              timer = null;\n            }\n            completer.apply(null, args);\n          }\n        };\n      };\n      var resolve = complete(resolveCb);\n      var reject = complete(rejectCb);\n      var start = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!done && timer === null) {\n          timer = setTimeout(function () {\n            return reject.apply(null, args);\n          }, timeout);\n        }\n      };\n      return {\n        start: start,\n        resolve: resolve,\n        reject: reject\n      };\n    };\n    var create$8 = function () {\n      var tasks = {};\n      var resultFns = {};\n      var load = function (id, url) {\n        var loadErrMsg = 'Script at URL \"' + url + '\" failed to load';\n        var runErrMsg = 'Script at URL \"' + url + '\" did not call `tinymce.Resource.add(\\'' + id + '\\', data)` within 1 second';\n        if (tasks[id] !== undefined) {\n          return tasks[id];\n        } else {\n          var task = new promiseObj(function (resolve, reject) {\n            var waiter = awaiter(resolve, reject);\n            resultFns[id] = waiter.resolve;\n            ScriptLoader.ScriptLoader.loadScript(url, function () {\n              return waiter.start(runErrMsg);\n            }, function () {\n              return waiter.reject(loadErrMsg);\n            });\n          });\n          tasks[id] = task;\n          return task;\n        }\n      };\n      var add = function (id, data) {\n        if (resultFns[id] !== undefined) {\n          resultFns[id](data);\n          delete resultFns[id];\n        }\n        tasks[id] = promiseObj.resolve(data);\n      };\n      return {\n        load: load,\n        add: add\n      };\n    };\n    var Resource = create$8();\n\n    var each$k = Tools.each, extend$5 = Tools.extend;\n    var extendClass, initializing;\n    var Class = function () {\n    };\n    Class.extend = extendClass = function (props) {\n      var self = this;\n      var _super = self.prototype;\n      var Class = function () {\n        var i, mixins, mixin;\n        var self = this;\n        if (!initializing) {\n          if (self.init) {\n            self.init.apply(self, arguments);\n          }\n          mixins = self.Mixins;\n          if (mixins) {\n            i = mixins.length;\n            while (i--) {\n              mixin = mixins[i];\n              if (mixin.init) {\n                mixin.init.apply(self, arguments);\n              }\n            }\n          }\n        }\n      };\n      var dummy = function () {\n        return this;\n      };\n      var createMethod = function (name, fn) {\n        return function () {\n          var self = this;\n          var tmp = self._super;\n          self._super = _super[name];\n          var ret = fn.apply(self, arguments);\n          self._super = tmp;\n          return ret;\n        };\n      };\n      initializing = true;\n      var prototype = new self();\n      initializing = false;\n      if (props.Mixins) {\n        each$k(props.Mixins, function (mixin) {\n          for (var name_1 in mixin) {\n            if (name_1 !== 'init') {\n              props[name_1] = mixin[name_1];\n            }\n          }\n        });\n        if (_super.Mixins) {\n          props.Mixins = _super.Mixins.concat(props.Mixins);\n        }\n      }\n      if (props.Methods) {\n        each$k(props.Methods.split(','), function (name) {\n          props[name] = dummy;\n        });\n      }\n      if (props.Properties) {\n        each$k(props.Properties.split(','), function (name) {\n          var fieldName = '_' + name;\n          props[name] = function (value) {\n            var self = this;\n            if (value !== undefined) {\n              self[fieldName] = value;\n              return self;\n            }\n            return self[fieldName];\n          };\n        });\n      }\n      if (props.Statics) {\n        each$k(props.Statics, function (func, name) {\n          Class[name] = func;\n        });\n      }\n      if (props.Defaults && _super.Defaults) {\n        props.Defaults = extend$5({}, _super.Defaults, props.Defaults);\n      }\n      each$1(props, function (member, name) {\n        if (typeof member === 'function' && _super[name]) {\n          prototype[name] = createMethod(name, member);\n        } else {\n          prototype[name] = member;\n        }\n      });\n      Class.prototype = prototype;\n      Class.constructor = Class;\n      Class.extend = extendClass;\n      return Class;\n    };\n\n    var min$1 = Math.min, max$1 = Math.max, round$2 = Math.round;\n    var Color = function (value) {\n      var self = {};\n      var r = 0, g = 0, b = 0;\n      var rgb2hsv = function (r, g, b) {\n        var h, s, v;\n        h = 0;\n        s = 0;\n        v = 0;\n        r = r / 255;\n        g = g / 255;\n        b = b / 255;\n        var minRGB = min$1(r, min$1(g, b));\n        var maxRGB = max$1(r, max$1(g, b));\n        if (minRGB === maxRGB) {\n          v = minRGB;\n          return {\n            h: 0,\n            s: 0,\n            v: v * 100\n          };\n        }\n        var d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n        h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n        h = 60 * (h - d / (maxRGB - minRGB));\n        s = (maxRGB - minRGB) / maxRGB;\n        v = maxRGB;\n        return {\n          h: round$2(h),\n          s: round$2(s * 100),\n          v: round$2(v * 100)\n        };\n      };\n      var hsvToRgb = function (hue, saturation, brightness) {\n        hue = (parseInt(hue, 10) || 0) % 360;\n        saturation = parseInt(saturation, 10) / 100;\n        brightness = parseInt(brightness, 10) / 100;\n        saturation = max$1(0, min$1(saturation, 1));\n        brightness = max$1(0, min$1(brightness, 1));\n        if (saturation === 0) {\n          r = g = b = round$2(255 * brightness);\n          return;\n        }\n        var side = hue / 60;\n        var chroma = brightness * saturation;\n        var x = chroma * (1 - Math.abs(side % 2 - 1));\n        var match = brightness - chroma;\n        switch (Math.floor(side)) {\n        case 0:\n          r = chroma;\n          g = x;\n          b = 0;\n          break;\n        case 1:\n          r = x;\n          g = chroma;\n          b = 0;\n          break;\n        case 2:\n          r = 0;\n          g = chroma;\n          b = x;\n          break;\n        case 3:\n          r = 0;\n          g = x;\n          b = chroma;\n          break;\n        case 4:\n          r = x;\n          g = 0;\n          b = chroma;\n          break;\n        case 5:\n          r = chroma;\n          g = 0;\n          b = x;\n          break;\n        default:\n          r = g = b = 0;\n        }\n        r = round$2(255 * (r + match));\n        g = round$2(255 * (g + match));\n        b = round$2(255 * (b + match));\n      };\n      var toHex = function () {\n        var hex = function (val) {\n          val = parseInt(val, 10).toString(16);\n          return val.length > 1 ? val : '0' + val;\n        };\n        return '#' + hex(r) + hex(g) + hex(b);\n      };\n      var toRgb = function () {\n        return {\n          r: r,\n          g: g,\n          b: b\n        };\n      };\n      var toHsv = function () {\n        return rgb2hsv(r, g, b);\n      };\n      var parse = function (value) {\n        var matches;\n        if (typeof value === 'object') {\n          if ('r' in value) {\n            r = value.r;\n            g = value.g;\n            b = value.b;\n          } else if ('v' in value) {\n            hsvToRgb(value.h, value.s, value.v);\n          }\n        } else {\n          if (matches = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)[^\\)]*\\)/gi.exec(value)) {\n            r = parseInt(matches[1], 10);\n            g = parseInt(matches[2], 10);\n            b = parseInt(matches[3], 10);\n          } else if (matches = /#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value)) {\n            r = parseInt(matches[1], 16);\n            g = parseInt(matches[2], 16);\n            b = parseInt(matches[3], 16);\n          } else if (matches = /#([0-F])([0-F])([0-F])/gi.exec(value)) {\n            r = parseInt(matches[1] + matches[1], 16);\n            g = parseInt(matches[2] + matches[2], 16);\n            b = parseInt(matches[3] + matches[3], 16);\n          }\n        }\n        r = r < 0 ? 0 : r > 255 ? 255 : r;\n        g = g < 0 ? 0 : g > 255 ? 255 : g;\n        b = b < 0 ? 0 : b > 255 ? 255 : b;\n        return self;\n      };\n      if (value) {\n        parse(value);\n      }\n      self.toRgb = toRgb;\n      self.toHsv = toHsv;\n      self.toHex = toHex;\n      self.parse = parse;\n      return self;\n    };\n\n    var serialize = function (obj) {\n      var data = JSON.stringify(obj);\n      if (!isString(data)) {\n        return data;\n      }\n      return data.replace(/[\\u0080-\\uFFFF]/g, function (match) {\n        var hexCode = match.charCodeAt(0).toString(16);\n        return '\\\\u' + '0000'.substring(hexCode.length) + hexCode;\n      });\n    };\n    var JSONUtils = {\n      serialize: serialize,\n      parse: function (text) {\n        try {\n          return JSON.parse(text);\n        } catch (ex) {\n        }\n      }\n    };\n\n    var JSONP = {\n      callbacks: {},\n      count: 0,\n      send: function (settings) {\n        var self = this, dom = DOMUtils.DOM, count = settings.count !== undefined ? settings.count : self.count;\n        var id = 'tinymce_jsonp_' + count;\n        self.callbacks[count] = function (json) {\n          dom.remove(id);\n          delete self.callbacks[count];\n          settings.callback(json);\n        };\n        dom.add(dom.doc.body, 'script', {\n          id: id,\n          src: settings.url,\n          type: 'text/javascript'\n        });\n        self.count++;\n      }\n    };\n\n    var XHR = __assign(__assign({}, Observable), {\n      send: function (settings) {\n        var xhr, count = 0;\n        var ready = function () {\n          if (!settings.async || xhr.readyState === 4 || count++ > 10000) {\n            if (settings.success && count < 10000 && xhr.status === 200) {\n              settings.success.call(settings.success_scope, '' + xhr.responseText, xhr, settings);\n            } else if (settings.error) {\n              settings.error.call(settings.error_scope, count > 10000 ? 'TIMED_OUT' : 'GENERAL', xhr, settings);\n            }\n            xhr = null;\n          } else {\n            Delay.setTimeout(ready, 10);\n          }\n        };\n        settings.scope = settings.scope || this;\n        settings.success_scope = settings.success_scope || settings.scope;\n        settings.error_scope = settings.error_scope || settings.scope;\n        settings.async = settings.async !== false;\n        settings.data = settings.data || '';\n        XHR.fire('beforeInitialize', { settings: settings });\n        xhr = new XMLHttpRequest();\n        if (xhr.overrideMimeType) {\n          xhr.overrideMimeType(settings.content_type);\n        }\n        xhr.open(settings.type || (settings.data ? 'POST' : 'GET'), settings.url, settings.async);\n        if (settings.crossDomain) {\n          xhr.withCredentials = true;\n        }\n        if (settings.content_type) {\n          xhr.setRequestHeader('Content-Type', settings.content_type);\n        }\n        if (settings.requestheaders) {\n          Tools.each(settings.requestheaders, function (header) {\n            xhr.setRequestHeader(header.key, header.value);\n          });\n        }\n        xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n        xhr = XHR.fire('beforeSend', {\n          xhr: xhr,\n          settings: settings\n        }).xhr;\n        xhr.send(settings.data);\n        if (!settings.async) {\n          return ready();\n        }\n        Delay.setTimeout(ready, 10);\n      }\n    });\n\n    var extend$6 = Tools.extend;\n    var JSONRequest = function () {\n      function JSONRequest(settings) {\n        this.settings = extend$6({}, settings);\n        this.count = 0;\n      }\n      JSONRequest.sendRPC = function (o) {\n        return new JSONRequest().send(o);\n      };\n      JSONRequest.prototype.send = function (args) {\n        var ecb = args.error, scb = args.success;\n        var xhrArgs = extend$6(this.settings, args);\n        xhrArgs.success = function (c, x) {\n          c = JSONUtils.parse(c);\n          if (typeof c === 'undefined') {\n            c = { error: 'JSON Parse error.' };\n          }\n          if (c.error) {\n            ecb.call(xhrArgs.error_scope || xhrArgs.scope, c.error, x);\n          } else {\n            scb.call(xhrArgs.success_scope || xhrArgs.scope, c.result);\n          }\n        };\n        xhrArgs.error = function (ty, x) {\n          if (ecb) {\n            ecb.call(xhrArgs.error_scope || xhrArgs.scope, ty, x);\n          }\n        };\n        xhrArgs.data = JSONUtils.serialize({\n          id: args.id || 'c' + this.count++,\n          method: args.method,\n          params: args.params\n        });\n        xhrArgs.content_type = 'application/json';\n        XHR.send(xhrArgs);\n      };\n      return JSONRequest;\n    }();\n\n    var create$9 = function () {\n      return function () {\n        var data = {};\n        var keys = [];\n        var storage = {\n          getItem: function (key) {\n            var item = data[key];\n            return item ? item : null;\n          },\n          setItem: function (key, value) {\n            keys.push(key);\n            data[key] = String(value);\n          },\n          key: function (index) {\n            return keys[index];\n          },\n          removeItem: function (key) {\n            keys = keys.filter(function (k) {\n              return k === key;\n            });\n            delete data[key];\n          },\n          clear: function () {\n            keys = [];\n            data = {};\n          },\n          length: 0\n        };\n        Object.defineProperty(storage, 'length', {\n          get: function () {\n            return keys.length;\n          },\n          configurable: false,\n          enumerable: false\n        });\n        return storage;\n      }();\n    };\n\n    var localStorage;\n    try {\n      var test = '__storage_test__';\n      localStorage = window.localStorage;\n      localStorage.setItem(test, test);\n      localStorage.removeItem(test);\n    } catch (e) {\n      localStorage = create$9();\n    }\n    var LocalStorage = localStorage;\n\n    var publicApi = {\n      geom: { Rect: Rect },\n      util: {\n        Promise: promiseObj,\n        Delay: Delay,\n        Tools: Tools,\n        VK: VK,\n        URI: URI,\n        Class: Class,\n        EventDispatcher: EventDispatcher,\n        Observable: Observable,\n        I18n: I18n,\n        XHR: XHR,\n        JSON: JSONUtils,\n        JSONRequest: JSONRequest,\n        JSONP: JSONP,\n        LocalStorage: LocalStorage,\n        Color: Color,\n        ImageUploader: ImageUploader\n      },\n      dom: {\n        EventUtils: EventUtils,\n        Sizzle: Sizzle,\n        DomQuery: DomQuery,\n        TreeWalker: DomTreeWalker,\n        TextSeeker: TextSeeker,\n        DOMUtils: DOMUtils,\n        ScriptLoader: ScriptLoader,\n        RangeUtils: RangeUtils,\n        Serializer: DomSerializer,\n        StyleSheetLoader: StyleSheetLoader,\n        ControlSelection: ControlSelection,\n        BookmarkManager: BookmarkManager,\n        Selection: EditorSelection,\n        Event: EventUtils.Event\n      },\n      html: {\n        Styles: Styles,\n        Entities: Entities,\n        Node: AstNode,\n        Schema: Schema,\n        SaxParser: SaxParser,\n        DomParser: DomParser,\n        Writer: Writer,\n        Serializer: HtmlSerializer\n      },\n      Env: Env,\n      AddOnManager: AddOnManager,\n      Annotator: Annotator,\n      Formatter: Formatter,\n      UndoManager: UndoManager,\n      EditorCommands: EditorCommands,\n      WindowManager: WindowManager,\n      NotificationManager: NotificationManager,\n      EditorObservable: EditorObservable,\n      Shortcuts: Shortcuts,\n      Editor: Editor,\n      FocusManager: FocusManager,\n      EditorManager: EditorManager,\n      DOM: DOMUtils.DOM,\n      ScriptLoader: ScriptLoader.ScriptLoader,\n      PluginManager: PluginManager,\n      ThemeManager: ThemeManager,\n      IconManager: IconManager,\n      Resource: Resource,\n      trim: Tools.trim,\n      isArray: Tools.isArray,\n      is: Tools.is,\n      toArray: Tools.toArray,\n      makeMap: Tools.makeMap,\n      each: Tools.each,\n      map: Tools.map,\n      grep: Tools.grep,\n      inArray: Tools.inArray,\n      extend: Tools.extend,\n      create: Tools.create,\n      walk: Tools.walk,\n      createNS: Tools.createNS,\n      resolve: Tools.resolve,\n      explode: Tools.explode,\n      _addCacheSuffix: Tools._addCacheSuffix,\n      isOpera: Env.opera,\n      isWebKit: Env.webkit,\n      isIE: Env.ie,\n      isGecko: Env.gecko,\n      isMac: Env.mac\n    };\n    var tinymce = Tools.extend(EditorManager, publicApi);\n\n    var exportToModuleLoaders = function (tinymce) {\n      if (typeof module === 'object') {\n        try {\n          module.exports = tinymce;\n        } catch (_) {\n        }\n      }\n    };\n    var exportToWindowGlobal = function (tinymce) {\n      window.tinymce = tinymce;\n      window.tinyMCE = tinymce;\n    };\n    exportToWindowGlobal(tinymce);\n    exportToModuleLoaders(tinymce);\n\n}());\n"]},"metadata":{},"sourceType":"script"}